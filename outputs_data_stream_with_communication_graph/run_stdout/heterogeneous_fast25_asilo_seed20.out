[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44903
[S3] → join 127.0.0.1:44902
[S4] → join 127.0.0.1:44902
[S5] → join 127.0.0.1:44902
[S6] → join 127.0.0.1:44902
[S7] → join 127.0.0.1:44902
[S8] → join 127.0.0.1:44902
[S9] → join 127.0.0.1:44902
[S10] → join 127.0.0.1:44902
[S11] → join 127.0.0.1:44902
[S13] → join 127.0.0.1:44902
[S14] → join 127.0.0.1:44902
[S15] → join 127.0.0.1:44902
[S16] → join 127.0.0.1:44902
[S17] → join 127.0.0.1:44902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.187208 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.140635 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.141353 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.171946 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.150753 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.076649 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.101645 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.180645 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.160187 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.170289 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.151830 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.150940 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.126502 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.171983 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.163034 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S8
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S11
[S5] + discovered S7
[S5] + discovered S10
[S6] + discovered S2
[S5] + discovered S8
[S6] + discovered S5
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S9
[S6] + discovered S4
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S16
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S14
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S9
[S6] + discovered S11
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S7
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S8
[S8] + discovered S3
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S15
[S9] + discovered S8
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S5
[S9] + discovered S3
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S13
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S4
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S10
[S10] + discovered S7
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S3
[S10] + discovered S14
[S11] + discovered S7
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S10
[S10] + discovered S13
[S11] + discovered S8
[S10] + discovered S11
[S10] + discovered S15
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S4
[S13] + discovered S11
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S6
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S9
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S10
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S2
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S11
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S4
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S13
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S10
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S11
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S6
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S13
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:44902
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:44914
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:44911
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:44905
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:44912
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S2] START round=1 head_norm_before_train=1.184534 (no previous merge yet)
[S2] round=1 local utility u=0.279489 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.9763502861103048, 'loss_val': 1.324115979812847, 'psi': 0.475606394477262}-{'f1_val': 0.1417771333885667, 'auprc': 0.8023577108279136, 'loss_val': 1.3611163730580684, 'psi': 0.4060093643643055}
[S3] START round=1 head_norm_before_train=1.161720 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8506060960702054, 'loss_val': 1.276435703299756, 'psi': 0.42414647779654646}-{'f1_val': 0.3314698712637818, 'auprc': 0.7877014428741844, 'loss_val': 1.3489261870800242, 'psi': 0.5139624999079428}
[S4] START round=1 head_norm_before_train=1.151792 (no previous merge yet)
[S4] round=1 local utility u=0.045399 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7387555513370088, 'loss_val': 1.3245641866981466, 'psi': 0.379638197871914}-{'f1_val': 0.14022662889518414, 'auprc': 0.7197693263567808, 'loss_val': 1.358403578747085, 'psi': 0.3720437078798228}
[S5] START round=1 head_norm_before_train=1.197998 (no previous merge yet)
[S5] round=1 local utility u=0.026809 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7292946071415818, 'loss_val': 1.2531758987241979, 'psi': 0.37707498571377557}-{'f1_val': 0.14226190476190476, 'auprc': 0.7292563317901393, 'loss_val': 1.3066788784685603, 'psi': 0.3770596755731986}
[S6] START round=1 head_norm_before_train=1.163077 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14342459022093504, 'auprc': 0.9334110064266634, 'loss_val': 1.3041571320354586, 'psi': 0.4594191567032264}-{'f1_val': 0.37090766271711517, 'auprc': 0.9706271685919983, 'loss_val': 1.3409734564599594, 'psi': 0.6107954650670684}
[S7] START round=1 head_norm_before_train=1.087728 (no previous merge yet)
[S7] round=1 local utility u=0.035272 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.8001314456467694, 'loss_val': 1.2759284803302917, 'psi': 0.4052866718961628}-{'f1_val': 0.14205682272909165, 'auprc': 0.7941674629405295, 'loss_val': 1.328579773506925, 'psi': 0.4029010788136668}
[S8] START round=1 head_norm_before_train=1.104919 (no previous merge yet)
[S8] round=1 local utility u=0.906568 metrics={'f1_val': 0.391794629690293, 'auprc': 0.7494926859639014, 'loss_val': 1.332727602656619, 'psi': 0.5348738521997364}-{'f1_val': 0.10450549450549451, 'auprc': 0.7333368346789517, 'loss_val': 1.3736621817521595, 'psi': 0.35603803057487743}
[S9] START round=1 head_norm_before_train=1.202662 (no previous merge yet)
[S9] round=1 local utility u=0.459536 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9239934062829767, 'loss_val': 1.2278706737016265, 'psi': 0.4544361367971883}-{'f1_val': 0.141397957139996, 'auprc': 0.6437562486437685, 'loss_val': 1.3062309284452898, 'psi': 0.342341273741505}
[S10] START round=1 head_norm_before_train=1.169068 (no previous merge yet)
[S10] round=1 local utility u=0.861064 metrics={'f1_val': 0.41642217334168796, 'auprc': 0.7814257295421788, 'loss_val': 1.310413674269632, 'psi': 0.5624235958218844}-{'f1_val': 0.13848501113962397, 'auprc': 0.7743015180647148, 'loss_val': 1.343546670968094, 'psi': 0.39281161390966035}
[S11] START round=1 head_norm_before_train=1.177039 (no previous merge yet)
[S11] round=1 local utility u=0.280822 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7523534403852417, 'loss_val': 1.311319701418817, 'psi': 0.385189586177963}-{'f1_val': 0.14041368337311058, 'auprc': 0.5760280480605524, 'loss_val': 1.343987061267055, 'psi': 0.3146594292480873}
[S13] START round=1 head_norm_before_train=1.155726 (no previous merge yet)
[S13] round=1 local utility u=0.130152 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6872529694388283, 'loss_val': 1.3209533312154622, 'psi': 0.3591326453217632}-{'f1_val': 0.16952080745120301, 'auprc': 0.5555835047203237, 'loss_val': 1.3610591349241132, 'psi': 0.3239458863588513}
[S14] START round=1 head_norm_before_train=1.155737 (no previous merge yet)
[S14] round=1 local utility u=0.177869 metrics={'f1_val': 0.1038107752956636, 'auprc': 0.5077929198809115, 'loss_val': 1.3548056293409325, 'psi': 0.26540363312976273}-{'f1_val': 0.1038107752956636, 'auprc': 0.396297392045775, 'loss_val': 1.376057038231857, 'psi': 0.22080542199570818}
[S15] START round=1 head_norm_before_train=1.134887 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.771944828887461, 'loss_val': 1.3309453310009036, 'psi': 0.3926181223719194}-{'f1_val': 0.42452348500733905, 'auprc': 0.7750353580417897, 'loss_val': 1.360649049646864, 'psi': 0.5647282342211193}
[S16] START round=1 head_norm_before_train=1.176130 (no previous merge yet)
[S16] round=1 local utility u=0.221251 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.718090140753438, 'loss_val': 1.329427648626657, 'psi': 0.3716185264208971}-{'f1_val': 0.07654723127035831, 'auprc': 0.706564002037457, 'loss_val': 1.3528094244217121, 'psi': 0.32855393957719775}
[S17] START round=1 head_norm_before_train=1.171102 (no previous merge yet)
[S17] round=1 local utility u=0.226447 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7858412363234756, 'loss_val': 1.3207133489189233, 'psi': 0.3989058725198209}-{'f1_val': 0.14094896331738438, 'auprc': 0.644491219423162, 'loss_val': 1.349557412599238, 'psi': 0.34236586575969546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:44902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=0.0144
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.0557
[S13] RECEIVED delta(kind=head bytes=1790) from S2
[S13] cosine check vs S2: cos=0.0646
[S6] RECEIVED delta(kind=head bytes=1795) from S9
[S6] cosine check vs S9: cos=0.0615
[S9] RECEIVED delta(kind=head bytes=1793) from S16
[S9] cosine check vs S16: cos=0.0152
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.0525
[S3] RECEIVED delta(kind=head bytes=1789) from S14
[S3] cosine check vs S14: cos=0.0380
[S17] RECEIVED delta(kind=head bytes=1794) from S10
[S17] cosine check vs S10: cos=0.0688
[S2] RECEIVED delta(kind=head bytes=1789) from S7
[S2] cosine check vs S7: cos=0.0132
[S17] RECEIVED delta(kind=head bytes=1787) from S4
[S17] cosine check vs S4: cos=-0.0548
[S17] DROPPED delta from S4 (cos=-0.0548 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=0.0053
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:44907
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=-0.0765
[S6] DROPPED delta from S17 (cos=-0.0765 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.208999
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.237230e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.855611 delta_norm=0.823723
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1434 head_norm=1.183019
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.009407e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.4147 head_norm=0.734956 delta_norm=0.700941
[S6] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.190857
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.290761e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1672 head_norm=0.841125 delta_norm=0.829076
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.245685
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.449659e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.779003 delta_norm=0.744966
[S9] aggregate: ACCEPT kept=['S16', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.193580
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.151879e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.825983 delta_norm=0.815188
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.171144
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.086603e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.862655 delta_norm=0.808660
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.153325
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.063541e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.852569 delta_norm=0.806354
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.190377
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.105856e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.868374 delta_norm=0.810586
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.825983 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6652611782623843, 'loss_val': 1.310914395137953, 'psi': 0.3511707513380938}-{'f1_val': 0.1417771333885667, 'auprc': 0.9763502861103048, 'loss_val': 1.324115979812847, 'psi': 0.475606394477262}
[S3] START round=2 head_norm_before_train=0.855611 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8152635748232856, 'loss_val': 1.23518169553145, 'psi': 0.4100094692977785}-{'f1_val': 0.13984006561410703, 'auprc': 0.8506060960702054, 'loss_val': 1.276435703299756, 'psi': 0.42414647779654646}
[S4] START round=2 head_norm_before_train=1.171596 (no previous merge yet)
[S4] round=2 local utility u=0.029239 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7437587709244309, 'loss_val': 1.2810963602730145, 'psi': 0.38163948570688283}-{'f1_val': 0.14022662889518414, 'auprc': 0.7387555513370088, 'loss_val': 1.3245641866981466, 'psi': 0.379638197871914}
[S5] START round=2 head_norm_before_train=1.241634 (no previous merge yet)
[S5] round=2 local utility u=0.085942 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701145343050474, 'loss_val': 1.2037514552718014, 'psi': 0.39340295657916186}-{'f1_val': 0.14226190476190476, 'auprc': 0.7292946071415818, 'loss_val': 1.2531758987241979, 'psi': 0.37707498571377557}
[S6] START round=2 head_norm_before_train=0.734956 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8624239111086056, 'loss_val': 1.3140368104200033, 'psi': 0.4298253336742115}-{'f1_val': 0.14342459022093504, 'auprc': 0.9334110064266634, 'loss_val': 1.3041571320354586, 'psi': 0.4594191567032264}
[S7] START round=2 head_norm_before_train=1.126467 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7754019973486901, 'loss_val': 1.2145988376405072, 'psi': 0.39539489257693106}-{'f1_val': 0.14205682272909165, 'auprc': 0.8001314456467694, 'loss_val': 1.2759284803302917, 'psi': 0.4052866718961628}
[S8] START round=2 head_norm_before_train=1.119374 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7321847986155543, 'loss_val': 1.279020119121982, 'psi': 0.37684750888199603}-{'f1_val': 0.391794629690293, 'auprc': 0.7494926859639014, 'loss_val': 1.332727602656619, 'psi': 0.5348738521997364}
[S9] START round=2 head_norm_before_train=0.779003 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7838998260777528, 'loss_val': 1.1885917836975122, 'psi': 0.39839870471509875}-{'f1_val': 0.141397957139996, 'auprc': 0.9239934062829767, 'loss_val': 1.2278706737016265, 'psi': 0.4544361367971883}
[S10] START round=2 head_norm_before_train=1.185431 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7823996038149731, 'loss_val': 1.268380957093462, 'psi': 0.3961328240510236}-{'f1_val': 0.41642217334168796, 'auprc': 0.7814257295421788, 'loss_val': 1.310413674269632, 'psi': 0.5624235958218844}
[S11] START round=2 head_norm_before_train=1.193317 (no previous merge yet)
[S11] round=2 local utility u=0.068720 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7868481221678644, 'loss_val': 1.277363123144945, 'psi': 0.3989874588910121}-{'f1_val': 0.14041368337311058, 'auprc': 0.7523534403852417, 'loss_val': 1.311319701418817, 'psi': 0.385189586177963}
[S13] START round=2 head_norm_before_train=0.862655 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6754354004754062, 'loss_val': 1.3122666599480906, 'psi': 0.35440561773639434}-{'f1_val': 0.1403857625770531, 'auprc': 0.6872529694388283, 'loss_val': 1.3209533312154622, 'psi': 0.3591326453217632}
[S14] START round=2 head_norm_before_train=1.165976 (no previous merge yet)
[S14] round=2 local utility u=0.146036 metrics={'f1_val': 0.14046955829685634, 'auprc': 0.5242732093903555, 'loss_val': 1.332126227348949, 'psi': 0.293991018734256}-{'f1_val': 0.1038107752956636, 'auprc': 0.5077929198809115, 'loss_val': 1.3548056293409325, 'psi': 0.26540363312976273}
[S15] START round=2 head_norm_before_train=0.852569 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.004888 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7727018812822233, 'loss_val': 1.3234406662576903, 'psi': 0.39292094332982436}-{'f1_val': 0.13973365136155833, 'auprc': 0.771944828887461, 'loss_val': 1.3309453310009036, 'psi': 0.3926181223719194}
[S16] START round=2 head_norm_before_train=0.841125 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.092053 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7810156157929976, 'loss_val': 1.3340989985383174, 'psi': 0.396788716436721}-{'f1_val': 0.14063745019920318, 'auprc': 0.718090140753438, 'loss_val': 1.329427648626657, 'psi': 0.3716185264208971}
[S17] START round=2 head_norm_before_train=0.868374 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.013564 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7916979462674819, 'loss_val': 1.3111552479112631, 'psi': 0.4012485564974234}-{'f1_val': 0.14094896331738438, 'auprc': 0.7858412363234756, 'loss_val': 1.3207133489189233, 'psi': 0.3989058725198209}
[S16] not sending this round → trigger blocked (psi=0.397)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.294)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.399)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.382)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.393)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] cosine check vs S15: cos=0.7202
[S17] not sending this round → trigger blocked (psi=0.401)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.214073
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.211677e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.969862 delta_norm=0.421168
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.841890 cos_to_last_merge=0.9964 (last merge round=1)
[S2] round=3 local utility u=0.208858 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7901710470282886, 'loss_val': 1.2679271807153534, 'psi': 0.40113469884445546}-{'f1_val': 0.1417771333885667, 'auprc': 0.6652611782623843, 'loss_val': 1.310914395137953, 'psi': 0.3511707513380938}
[S3] START round=3 head_norm_before_train=0.906275 cos_to_last_merge=0.9921 (last merge round=1)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.4227428674058971, 'auprc': 0.9039630121974827, 'loss_val': 1.041356152821917, 'psi': 0.6152309253225314}-{'f1_val': 0.13984006561410703, 'auprc': 0.8152635748232856, 'loss_val': 1.23518169553145, 'psi': 0.4100094692977785}
[S4] START round=3 head_norm_before_train=1.202298 (no previous merge yet)
[S4] round=3 local utility u=0.082851 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7806508599876572, 'loss_val': 1.2260715426990894, 'psi': 0.39639632133217334}-{'f1_val': 0.14022662889518414, 'auprc': 0.7437587709244309, 'loss_val': 1.2810963602730145, 'psi': 0.38163948570688283}
[S5] START round=3 head_norm_before_train=1.275987 (no previous merge yet)
[S5] round=3 local utility u=0.061353 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7777663943591231, 'loss_val': 1.1040017499140893, 'psi': 0.3964637006007921}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701145343050474, 'loss_val': 1.2037514552718014, 'psi': 0.39340295657916186}
[S6] START round=3 head_norm_before_train=0.759594 cos_to_last_merge=0.9965 (last merge round=1)
[S6] round=3 local utility u=0.024447 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8638252015194263, 'loss_val': 1.2693457633884968, 'psi': 0.4303858498385398}-{'f1_val': 0.14142628205128205, 'auprc': 0.8624239111086056, 'loss_val': 1.3140368104200033, 'psi': 0.4298253336742115}
[S7] START round=3 head_norm_before_train=1.173030 (no previous merge yet)
[S7] round=3 local utility u=0.051836 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774767726690119, 'loss_val': 1.1171514218876075, 'psi': 0.3962248027050598}-{'f1_val': 0.14205682272909165, 'auprc': 0.7754019973486901, 'loss_val': 1.2145988376405072, 'psi': 0.39539489257693106}
[S8] START round=3 head_norm_before_train=1.144538 (no previous merge yet)
[S8] round=3 local utility u=0.074073 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7638661736595178, 'loss_val': 1.225918417808296, 'psi': 0.38952005889958147}-{'f1_val': 0.13995598239295717, 'auprc': 0.7321847986155543, 'loss_val': 1.279020119121982, 'psi': 0.37684750888199603}
[S9] START round=3 head_norm_before_train=0.834309 cos_to_last_merge=0.9927 (last merge round=1)
[S9] round=3 local utility u=0.073524 metrics={'f1_val': 0.18310737634327717, 'auprc': 0.6872635912990759, 'loss_val': 1.0018916306468275, 'psi': 0.3847698623255966}-{'f1_val': 0.141397957139996, 'auprc': 0.7838998260777528, 'loss_val': 1.1885917836975122, 'psi': 0.39839870471509875}
[S10] START round=3 head_norm_before_train=1.210259 (no previous merge yet)
[S10] round=3 local utility u=0.022686 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7816859657391059, 'loss_val': 1.2208679040699462, 'psi': 0.3958473688206767}-{'f1_val': 0.13862163754172394, 'auprc': 0.7823996038149731, 'loss_val': 1.268380957093462, 'psi': 0.3961328240510236}
[S11] START round=3 head_norm_before_train=0.969862 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7656620490822226, 'loss_val': 1.2507323344954384, 'psi': 0.3905130296567554}-{'f1_val': 0.14041368337311058, 'auprc': 0.7868481221678644, 'loss_val': 1.277363123144945, 'psi': 0.3989874588910121}
[S13] START round=3 head_norm_before_train=0.881859 cos_to_last_merge=0.9975 (last merge round=1)
[S13] round=3 local utility u=0.061605 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7069821069891992, 'loss_val': 1.2836970901427338, 'psi': 0.3670243003419115}-{'f1_val': 0.1403857625770531, 'auprc': 0.6754354004754062, 'loss_val': 1.3122666599480906, 'psi': 0.35440561773639434}
[S14] START round=3 head_norm_before_train=1.182039 (no previous merge yet)
[S14] round=3 local utility u=0.255052 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.68646133163516, 'loss_val': 1.3079163208944298, 'psi': 0.35879924438368627}-{'f1_val': 0.14046955829685634, 'auprc': 0.5242732093903555, 'loss_val': 1.332126227348949, 'psi': 0.293991018734256}
[S15] START round=3 head_norm_before_train=0.872958 cos_to_last_merge=0.9969 (last merge round=1)
[S15] round=3 local utility u=0.014001 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7717650162236793, 'loss_val': 1.2926288816941192, 'psi': 0.3925461973064068}-{'f1_val': 0.13973365136155833, 'auprc': 0.7727018812822233, 'loss_val': 1.3234406662576903, 'psi': 0.39292094332982436}
[S16] START round=3 head_norm_before_train=0.864140 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.062153 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8073889942247221, 'loss_val': 1.288912134809348, 'psi': 0.40733806780941073}-{'f1_val': 0.14063745019920318, 'auprc': 0.7810156157929976, 'loss_val': 1.3340989985383174, 'psi': 0.396788716436721}
[S17] START round=3 head_norm_before_train=0.891283 cos_to_last_merge=0.9968 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5783821058281379, 'loss_val': 1.2696279113312021, 'psi': 0.3159222203216858}-{'f1_val': 0.14094896331738438, 'auprc': 0.7916979462674819, 'loss_val': 1.3111552479112631, 'psi': 0.4012485564974234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S15] not sending this round → trigger blocked (psi=0.393)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=-0.0907
[S9] DROPPED delta from S8 (cos=-0.0907 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.1863
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.0204
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.1080
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] cosine check vs S16: cos=-0.0470
[S14] DROPPED delta from S16 (cos=-0.0470 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=0.3325
[S8] RECEIVED delta(kind=head bytes=1791) from S14
[S8] cosine check vs S14: cos=0.0135
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.0389
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.0269
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.0687
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=0.0375
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.0603
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.998011
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.710444e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.817942 delta_norm=0.771044
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.4227 head_norm=0.962892
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.556279e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1727 head_norm=0.784910 delta_norm=0.755628
[S3] aggregate: ROLLBACK (f1_val pre=0.423 post=0.173 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.867729
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.414827e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1048 head_norm=0.654643 delta_norm=0.641483
[S2] aggregate: ROLLBACK (f1_val pre=0.142 post=0.105 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=1.171503
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.337330e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.752242 delta_norm=0.633733
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.898176
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.090640e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.683919 delta_norm=0.609064
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1831 head_norm=0.892562
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.530161e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1755 head_norm=0.772486 delta_norm=0.753016
[S9] aggregate: ROLLBACK (f1_val pre=0.183 post=0.176 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.237283
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.399945e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.790083 delta_norm=0.739995
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.900465
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.905508e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.658137 delta_norm=0.590551
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.654643 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.14803200692041524, 'auprc': 0.6489577150106931, 'loss_val': 1.2833221380705224, 'psi': 0.3484022901565264}-{'f1_val': 0.1417771333885667, 'auprc': 0.7901710470282886, 'loss_val': 1.2679271807153534, 'psi': 0.40113469884445546}
[S3] START round=4 head_norm_before_train=0.784910 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.976704 metrics={'f1_val': 0.6995739279432054, 'auprc': 0.9443743073486769, 'loss_val': 0.870168829372519, 'psi': 0.797494079705394}-{'f1_val': 0.4227428674058971, 'auprc': 0.9039630121974827, 'loss_val': 1.041356152821917, 'psi': 0.6152309253225314}
[S4] START round=4 head_norm_before_train=1.237357 (no previous merge yet)
[S4] round=4 local utility u=0.040386 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.783018382772798, 'loss_val': 1.1524027553222926, 'psi': 0.3973433304462297}-{'f1_val': 0.14022662889518414, 'auprc': 0.7806508599876572, 'loss_val': 1.2260715426990894, 'psi': 0.39639632133217334}
[S5] START round=4 head_norm_before_train=1.312421 (no previous merge yet)
[S5] round=4 local utility u=1.000000 metrics={'f1_val': 0.7152790936266143, 'auprc': 0.7778211527145479, 'loss_val': 0.932454239008502, 'psi': 0.7402959172617878}-{'f1_val': 0.14226190476190476, 'auprc': 0.7777663943591231, 'loss_val': 1.1040017499140893, 'psi': 0.3964637006007921}
[S6] START round=4 head_norm_before_train=0.794728 cos_to_last_merge=0.9872 (last merge round=1)
[S6] round=4 local utility u=0.014134 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.860113546829889, 'loss_val': 1.2299425379804398, 'psi': 0.42890118796272486}-{'f1_val': 0.14142628205128205, 'auprc': 0.8638252015194263, 'loss_val': 1.2693457633884968, 'psi': 0.4303858498385398}
[S7] START round=4 head_norm_before_train=1.202893 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.7150867095273008, 'auprc': 0.7770224219274251, 'loss_val': 0.9649246532212662, 'psi': 0.7398609944873505}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774767726690119, 'loss_val': 1.1171514218876075, 'psi': 0.3962248027050598}
[S8] START round=4 head_norm_before_train=0.752242 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.014667 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7714689524480427, 'loss_val': 1.2193934942151816, 'psi': 0.39256117041499144}-{'f1_val': 0.13995598239295717, 'auprc': 0.7638661736595178, 'loss_val': 1.225918417808296, 'psi': 0.38952005889958147}
[S9] START round=4 head_norm_before_train=0.772486 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.823404 metrics={'f1_val': 0.4379534195130567, 'auprc': 0.6687624877501421, 'loss_val': 0.8286575479933166, 'psi': 0.5302770468078909}-{'f1_val': 0.18310737634327717, 'auprc': 0.6872635912990759, 'loss_val': 1.0018916306468275, 'psi': 0.3847698623255966}
[S10] START round=4 head_norm_before_train=0.790083 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7767477738684412, 'loss_val': 1.2367795457836894, 'psi': 0.39387209207241086}-{'f1_val': 0.13862163754172394, 'auprc': 0.7816859657391059, 'loss_val': 1.2208679040699462, 'psi': 0.3958473688206767}
[S11] START round=4 head_norm_before_train=0.817942 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7659174350813521, 'loss_val': 1.2535047724623396, 'psi': 0.3906151840564072}-{'f1_val': 0.14041368337311058, 'auprc': 0.7656620490822226, 'loss_val': 1.2507323344954384, 'psi': 0.3905130296567554}
[S13] START round=4 head_norm_before_train=0.901541 cos_to_last_merge=0.9924 (last merge round=1)
[S13] round=4 local utility u=0.020005 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7147271964765309, 'loss_val': 1.2669231058121404, 'psi': 0.37012233613684425}-{'f1_val': 0.1403857625770531, 'auprc': 0.7069821069891992, 'loss_val': 1.2836970901427338, 'psi': 0.3670243003419115}
[S14] START round=4 head_norm_before_train=1.203307 (no previous merge yet)
[S14] round=4 local utility u=0.120858 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7569925373028622, 'loss_val': 1.2777934333750358, 'psi': 0.38701172665076716}-{'f1_val': 0.14035785288270378, 'auprc': 0.68646133163516, 'loss_val': 1.3079163208944298, 'psi': 0.35879924438368627}
[S15] START round=4 head_norm_before_train=0.658137 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000541 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7718415491227176, 'loss_val': 1.2917762422392969, 'psi': 0.39257681046602205}-{'f1_val': 0.13973365136155833, 'auprc': 0.7717650162236793, 'loss_val': 1.2926288816941192, 'psi': 0.3925461973064068}
[S16] START round=4 head_norm_before_train=0.683919 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7652550591957936, 'loss_val': 1.2782093986690246, 'psi': 0.39048449379783934}-{'f1_val': 0.14063745019920318, 'auprc': 0.8073889942247221, 'loss_val': 1.288912134809348, 'psi': 0.40733806780941073}
[S17] START round=4 head_norm_before_train=0.924183 cos_to_last_merge=0.9886 (last merge round=1)
[S17] round=4 local utility u=0.017839 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5638946546376211, 'loss_val': 1.1904879277154152, 'psi': 0.3101272398454791}-{'f1_val': 0.14094896331738438, 'auprc': 0.5783821058281379, 'loss_val': 1.2696279113312021, 'psi': 0.3159222203216858}
[S5] not sending this round → trigger blocked (psi=0.740)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.387)
[S4] not sending this round → trigger blocked (psi=0.397)
[S6] not sending this round → trigger blocked (psi=0.429)
[S9] not sending this round → trigger blocked (psi=0.530)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.370)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S8] not sending this round → trigger blocked (psi=0.393)
[S7] not sending this round → trigger blocked (psi=0.740)
[S3] not sending this round → trigger blocked (psi=0.797)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=-0.0083
[S5] DROPPED delta from S15 (cos=-0.0083 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.0963
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.6996 head_norm=0.849047
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.123372e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.3922 head_norm=0.673913 delta_norm=0.612337
[S3] aggregate: ROLLBACK (f1_val pre=0.700 post=0.392 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=0.675418 cos_to_last_merge=0.9941 (last merge round=3)
[S2] round=5 local utility u=0.170012 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7522216199639369, 'loss_val': 1.2155613203273112, 'psi': 0.38595492801871484}-{'f1_val': 0.14803200692041524, 'auprc': 0.6489577150106931, 'loss_val': 1.2833221380705224, 'psi': 0.3484022901565264}
[S3] START round=5 head_norm_before_train=0.673913 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.8939126344490529, 'loss_val': 0.8000554258940488, 'psi': 0.5985901359289456}-{'f1_val': 0.6995739279432054, 'auprc': 0.9443743073486769, 'loss_val': 0.870168829372519, 'psi': 0.797494079705394}
[S4] START round=5 head_norm_before_train=1.272036 (no previous merge yet)
[S4] round=5 local utility u=0.877036 metrics={'f1_val': 0.41213385650606815, 'auprc': 0.7826371042451528, 'loss_val': 1.0286312012205847, 'psi': 0.560335155601702}-{'f1_val': 0.14022662889518414, 'auprc': 0.783018382772798, 'loss_val': 1.1524027553222926, 'psi': 0.3973433304462297}
[S5] START round=5 head_norm_before_train=1.362247 (no previous merge yet)
[S5] round=5 local utility u=0.088655 metrics={'f1_val': 0.7016397266447306, 'auprc': 0.7774850656380766, 'loss_val': 0.6722998019507218, 'psi': 0.731977862242069}-{'f1_val': 0.7152790936266143, 'auprc': 0.7778211527145479, 'loss_val': 0.932454239008502, 'psi': 0.7402959172617878}
[S6] START round=5 head_norm_before_train=0.838416 cos_to_last_merge=0.9748 (last merge round=1)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8196299005391483, 'loss_val': 1.1837056767529195, 'psi': 0.41270772944642853}-{'f1_val': 0.14142628205128205, 'auprc': 0.860113546829889, 'loss_val': 1.2299425379804398, 'psi': 0.42890118796272486}
[S7] START round=5 head_norm_before_train=1.248116 (no previous merge yet)
[S7] round=5 local utility u=0.138347 metrics={'f1_val': 0.7142026337939525, 'auprc': 0.7942884593749056, 'loss_val': 0.734723472839231, 'psi': 0.7462369640263338}-{'f1_val': 0.7150867095273008, 'auprc': 0.7770224219274251, 'loss_val': 0.9649246532212662, 'psi': 0.7398609944873505}
[S8] START round=5 head_norm_before_train=0.781855 cos_to_last_merge=0.9972 (last merge round=3)
[S8] round=5 local utility u=0.037318 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7771092636755151, 'loss_val': 1.1616785845768907, 'psi': 0.3948172949059804}-{'f1_val': 0.13995598239295717, 'auprc': 0.7714689524480427, 'loss_val': 1.2193934942151816, 'psi': 0.39256117041499144}
[S9] START round=5 head_norm_before_train=0.840001 cos_to_last_merge=0.9873 (last merge round=3)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9995778093640768, 'loss_val': 0.5065406436357683, 'psi': 0.8206499243771362}-{'f1_val': 0.4379534195130567, 'auprc': 0.6687624877501421, 'loss_val': 0.8286575479933166, 'psi': 0.5302770468078909}
[S10] START round=5 head_norm_before_train=0.819711 cos_to_last_merge=0.9965 (last merge round=3)
[S10] round=5 local utility u=0.046783 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763978632861664, 'loss_val': 1.142164570838739, 'psi': 0.39373212783950096}-{'f1_val': 0.13862163754172394, 'auprc': 0.7767477738684412, 'loss_val': 1.2367795457836894, 'psi': 0.39387209207241086}
[S11] START round=5 head_norm_before_train=0.840044 cos_to_last_merge=0.9966 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6130959728785546, 'loss_val': 1.1886683661791058, 'psi': 0.32948659917528816}-{'f1_val': 0.14041368337311058, 'auprc': 0.7659174350813521, 'loss_val': 1.2535047724623396, 'psi': 0.3906151840564072}
[S13] START round=5 head_norm_before_train=0.912579 cos_to_last_merge=0.9875 (last merge round=1)
[S13] round=5 local utility u=0.011165 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7164070138797776, 'loss_val': 1.249633003864847, 'psi': 0.3707942630981429}-{'f1_val': 0.1403857625770531, 'auprc': 0.7147271964765309, 'loss_val': 1.2669231058121404, 'psi': 0.37012233613684425}
[S14] START round=5 head_norm_before_train=1.231679 (no previous merge yet)
[S14] round=5 local utility u=0.062428 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7854049867906014, 'loss_val': 1.2381754024896596, 'psi': 0.39837670644586287}-{'f1_val': 0.14035785288270378, 'auprc': 0.7569925373028622, 'loss_val': 1.2777934333750358, 'psi': 0.38701172665076716}
[S15] START round=5 head_norm_before_train=0.688653 cos_to_last_merge=0.9959 (last merge round=3)
[S15] round=5 local utility u=0.030232 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766028651936927, 'loss_val': 1.245595521999341, 'psi': 0.3944813368944121}-{'f1_val': 0.13973365136155833, 'auprc': 0.7718415491227176, 'loss_val': 1.2917762422392969, 'psi': 0.39257681046602205}
[S16] START round=5 head_norm_before_train=0.714638 cos_to_last_merge=0.9948 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5159170202175374, 'loss_val': 1.2067033788628052, 'psi': 0.29074927820653684}-{'f1_val': 0.14063745019920318, 'auprc': 0.7652550591957936, 'loss_val': 1.2782093986690246, 'psi': 0.39048449379783934}
[S17] START round=5 head_norm_before_train=0.968168 cos_to_last_merge=0.9761 (last merge round=1)
[S17] round=5 local utility u=0.242644 metrics={'f1_val': 0.20108121483252353, 'auprc': 0.56671066526771, 'loss_val': 1.074441540014928, 'psi': 0.3473329950065981}-{'f1_val': 0.14094896331738438, 'auprc': 0.5638946546376211, 'loss_val': 1.1904879277154152, 'psi': 0.3101272398454791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:44911
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S8] → sending delta(kind=head bytes=1784) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1784 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.4090
[S16] RECEIVED delta(kind=head bytes=1790) from S9
[S16] cosine check vs S9: cos=0.3804
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=0.4846
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0062
[S5] DROPPED delta from S15 (cos=-0.0062 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.7409
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.5689
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=0.5567
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.4120
[S9] RECEIVED delta(kind=head bytes=1784) from S8
[S9] cosine check vs S8: cos=0.0161
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.5717
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.7252
[S6] ⇄ pheromone p=0.333 → S8@127.0.0.1:44909
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.872352
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.421331e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.020388 delta_norm=0.442133
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.358 → S15@127.0.0.1:44915
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.4017 head_norm=0.771841
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.779272e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4045 head_norm=0.753698 delta_norm=0.277927
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.612 → S2@127.0.0.1:44902
[S2] ⇄ pheromone p=0.411 → S15@127.0.0.1:44915
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7014 head_norm=0.942785
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.389374e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7014 head_norm=0.651754 delta_norm=0.438937
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.706 → S16@127.0.0.1:44916
[S5] ⇄ pheromone p=0.524 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.352 → S10@127.0.0.1:44911
[S4] ⇄ pheromone p=0.527 → S11@127.0.0.1:44912
[S14] ⇄ pheromone p=0.422 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.525 → S3@127.0.0.1:44903
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.725427
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.641158e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.617841 delta_norm=0.364116
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.336 → S5@127.0.0.1:44905
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.861150
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.144526e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.2620 head_norm=0.789171 delta_norm=0.414453
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.410 → S9@127.0.0.1:44910
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.809594
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.929406e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.4225 head_norm=0.878963 delta_norm=0.592941
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.421 → S9@127.0.0.1:44910
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.752153
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.714801e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.762077 delta_norm=0.371480
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.363 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.399 → S3@127.0.0.1:44903
[S2] START round=6 head_norm_before_train=0.708782 cos_to_last_merge=0.9764 (last merge round=3)
[S2] round=6 local utility u=0.040220 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7612099161440521, 'loss_val': 1.162086409028425, 'psi': 0.3895502464907609}-{'f1_val': 0.1417771333885667, 'auprc': 0.7522216199639369, 'loss_val': 1.2155613203273112, 'psi': 0.38595492801871484}
[S3] START round=6 head_norm_before_train=0.753698 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.715169 metrics={'f1_val': 0.5754719895974604, 'auprc': 0.9929112621597087, 'loss_val': 0.709293483044527, 'psi': 0.7424476986223597}-{'f1_val': 0.401708470248874, 'auprc': 0.8939126344490529, 'loss_val': 0.8000554258940488, 'psi': 0.5985901359289456}
[S4] START round=6 head_norm_before_train=1.308567 (no previous merge yet)
[S4] round=6 local utility u=0.861642 metrics={'f1_val': 0.6745259871425227, 'auprc': 0.7730072430910382, 'loss_val': 0.85080986937417, 'psi': 0.7139184895219288}-{'f1_val': 0.41213385650606815, 'auprc': 0.7826371042451528, 'loss_val': 1.0286312012205847, 'psi': 0.560335155601702}
[S5] START round=6 head_norm_before_train=1.431881 (no previous merge yet)
[S5] round=6 local utility u=0.129522 metrics={'f1_val': 0.7138844178870657, 'auprc': 0.7927977608485144, 'loss_val': 0.5326628338892451, 'psi': 0.7454497550716452}-{'f1_val': 0.7016397266447306, 'auprc': 0.7774850656380766, 'loss_val': 0.6722998019507218, 'psi': 0.731977862242069}
[S6] START round=6 head_norm_before_train=0.875311 cos_to_last_merge=0.9638 (last merge round=1)
[S6] round=6 local utility u=0.672414 metrics={'f1_val': 0.34679676998442077, 'auprc': 0.8153231936140364, 'loss_val': 1.0581801409883365, 'psi': 0.5342073394362671}-{'f1_val': 0.14142628205128205, 'auprc': 0.8196299005391483, 'loss_val': 1.1837056767529195, 'psi': 0.41270772944642853}
[S7] START round=6 head_norm_before_train=1.312592 (no previous merge yet)
[S7] round=6 local utility u=0.346168 metrics={'f1_val': 0.7142685888878759, 'auprc': 0.9977131353577213, 'loss_val': 0.6530577803774685, 'psi': 0.8276464074758141}-{'f1_val': 0.7142026337939525, 'auprc': 0.7942884593749056, 'loss_val': 0.734723472839231, 'psi': 0.7462369640263338}
[S8] START round=6 head_norm_before_train=0.878963 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7145237961103252, 'auprc': 0.7771112712817848, 'loss_val': 1.1629343142069057, 'psi': 0.739558786178909}-{'f1_val': 0.13995598239295717, 'auprc': 0.7771092636755151, 'loss_val': 1.1616785845768907, 'psi': 0.3948172949059804}
[S9] START round=6 head_norm_before_train=0.651754 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.000931 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979237515588573, 'loss_val': 0.4992710596483507, 'psi': 0.819943790748081}-{'f1_val': 0.7013646677191758, 'auprc': 0.9995778093640768, 'loss_val': 0.5065406436357683, 'psi': 0.8206499243771362}
[S10] START round=6 head_norm_before_train=0.789171 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.638199 metrics={'f1_val': 0.4157904658747533, 'auprc': 0.6421639532674258, 'loss_val': 1.126078796840678, 'psi': 0.5063398608318224}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763978632861664, 'loss_val': 1.142164570838739, 'psi': 0.39373212783950096}
[S11] START round=6 head_norm_before_train=1.020388 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.298026 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7950364007598418, 'loss_val': 1.1384382409781366, 'psi': 0.4022627703278031}-{'f1_val': 0.14041368337311058, 'auprc': 0.6130959728785546, 'loss_val': 1.1886683661791058, 'psi': 0.32948659917528816}
[S13] START round=6 head_norm_before_train=0.920623 cos_to_last_merge=0.9830 (last merge round=1)
[S13] round=6 local utility u=0.025554 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7198286590477961, 'loss_val': 1.2087905020802703, 'psi': 0.3721629211653503}-{'f1_val': 0.1403857625770531, 'auprc': 0.7164070138797776, 'loss_val': 1.249633003864847, 'psi': 0.3707942630981429}
[S14] START round=6 head_norm_before_train=1.262089 (no previous merge yet)
[S14] round=6 local utility u=0.338809 metrics={'f1_val': 0.21315708430024508, 'auprc': 0.8433376375184561, 'loss_val': 1.1711499190239254, 'psi': 0.4652293055875295}-{'f1_val': 0.14035785288270378, 'auprc': 0.7854049867906014, 'loss_val': 1.2381754024896596, 'psi': 0.39837670644586287}
[S15] START round=6 head_norm_before_train=0.617841 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.017304 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7773261504489088, 'loss_val': 1.213156978343232, 'psi': 0.39477065099649855}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766028651936927, 'loss_val': 1.245595521999341, 'psi': 0.3944813368944121}
[S16] START round=6 head_norm_before_train=0.762077 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.813426 metrics={'f1_val': 0.4158588189228392, 'auprc': 0.4873417015434298, 'loss_val': 1.1454529102028967, 'psi': 0.44445197197107544}-{'f1_val': 0.14063745019920318, 'auprc': 0.5159170202175374, 'loss_val': 1.2067033788628052, 'psi': 0.29074927820653684}
[S17] START round=6 head_norm_before_train=1.013388 cos_to_last_merge=0.9626 (last merge round=1)
[S17] round=6 local utility u=0.741066 metrics={'f1_val': 0.39202413421260673, 'auprc': 0.6349825115264842, 'loss_val': 0.9427822715626395, 'psi': 0.4892074851381577}-{'f1_val': 0.20108121483252353, 'auprc': 0.56671066526771, 'loss_val': 1.074441540014928, 'psi': 0.3473329950065981}
[S5] not sending this round → trigger blocked (psi=0.745)
[S8] not sending this round → trigger blocked (psi=0.740)
[S2] not sending this round → trigger blocked (psi=0.390)
[S10] not sending this round → trigger blocked (psi=0.506)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:44902
[S9] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → trigger blocked (psi=0.465)
[S15] not sending this round → trigger blocked (psi=0.395)
[S7] not sending this round → trigger blocked (psi=0.828)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:44909
[S4] not sending this round → trigger blocked (psi=0.714)
[S13] not sending this round → trigger blocked (psi=0.372)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:44915
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1786) from S6
[S8] cosine check vs S6: cos=0.2893
[S15] RECEIVED delta(kind=head bytes=1793) from S11
[S15] cosine check vs S11: cos=0.1177
[S2] RECEIVED delta(kind=head bytes=1793) from S3
[S2] cosine check vs S3: cos=0.5046
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.0526
[S17] not sending this round → trigger blocked (psi=0.489)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.736065
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.971237e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.687508 delta_norm=0.397124
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7145 head_norm=0.896671
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.399303e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.7148 head_norm=0.727213 delta_norm=0.539930
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.2132 head_norm=1.292144
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.388944e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.2694 head_norm=0.774277 delta_norm=0.738894
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.653467
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.807076e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1657 head_norm=0.645941 delta_norm=0.580708
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.687508 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.661293 metrics={'f1_val': 0.3499350768740163, 'auprc': 0.7802666959394025, 'loss_val': 1.1456175837368117, 'psi': 0.5220677245001708}-{'f1_val': 0.1417771333885667, 'auprc': 0.7612099161440521, 'loss_val': 1.162086409028425, 'psi': 0.3895502464907609}
[S3] START round=7 head_norm_before_train=0.847914 cos_to_last_merge=0.9821 (last merge round=5)
[S3] round=7 local utility u=0.479638 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9977954965185115, 'loss_val': 0.5168276651554882, 'psi': 0.8196172396226911}-{'f1_val': 0.5754719895974604, 'auprc': 0.9929112621597087, 'loss_val': 0.709293483044527, 'psi': 0.7424476986223597}
[S4] START round=7 head_norm_before_train=1.346313 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6689081809799005, 'auprc': 0.6628080934526897, 'loss_val': 0.6738700900081783, 'psi': 0.666468145969016}-{'f1_val': 0.6745259871425227, 'auprc': 0.7730072430910382, 'loss_val': 0.85080986937417, 'psi': 0.7139184895219288}
[S5] START round=7 head_norm_before_train=1.495595 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7317262115586078, 'loss_val': 0.3788650608465004, 'psi': 0.7132042781593697}-{'f1_val': 0.7138844178870657, 'auprc': 0.7927977608485144, 'loss_val': 0.5326628338892451, 'psi': 0.7454497550716452}
[S6] START round=7 head_norm_before_train=0.914718 cos_to_last_merge=0.9524 (last merge round=1)
[S6] round=7 local utility u=0.130736 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.7029792106389523, 'loss_val': 0.878822641687436, 'psi': 0.531184371988888}-{'f1_val': 0.34679676998442077, 'auprc': 0.8153231936140364, 'loss_val': 1.0581801409883365, 'psi': 0.5342073394362671}
[S7] START round=7 head_norm_before_train=1.359082 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.7001397550937472, 'auprc': 0.8825801425114468, 'loss_val': 0.5667531105422172, 'psi': 0.773115910060827}-{'f1_val': 0.7142685888878759, 'auprc': 0.9977131353577213, 'loss_val': 0.6530577803774685, 'psi': 0.8276464074758141}
[S8] START round=7 head_norm_before_train=0.727213 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.6916919575650324, 'auprc': 0.7769409181391611, 'loss_val': 1.069675830604288, 'psi': 0.7257915417946839}-{'f1_val': 0.7145237961103252, 'auprc': 0.7771112712817848, 'loss_val': 1.1629343142069057, 'psi': 0.739558786178909}
[S9] START round=7 head_norm_before_train=0.759450 cos_to_last_merge=0.9773 (last merge round=5)
[S9] round=7 local utility u=0.066528 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9977611522101445, 'loss_val': 0.36572747849918297, 'psi': 0.8198787510085959}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979237515588573, 'loss_val': 0.4992710596483507, 'psi': 0.819943790748081}
[S10] START round=7 head_norm_before_train=0.819113 cos_to_last_merge=0.9952 (last merge round=5)
[S10] round=7 local utility u=0.101530 metrics={'f1_val': 0.4168455130671376, 'auprc': 0.6514126695336024, 'loss_val': 0.9570961043969162, 'psi': 0.5106723756537235}-{'f1_val': 0.4157904658747533, 'auprc': 0.6421639532674258, 'loss_val': 1.126078796840678, 'psi': 0.5063398608318224}
[S11] START round=7 head_norm_before_train=1.040146 cos_to_last_merge=0.9971 (last merge round=5)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.41559855532256573, 'auprc': 0.9589307013173877, 'loss_val': 1.0116383157538082, 'psi': 0.6329314137204944}-{'f1_val': 0.14041368337311058, 'auprc': 0.7950364007598418, 'loss_val': 1.1384382409781366, 'psi': 0.4022627703278031}
[S13] START round=7 head_norm_before_train=0.941355 cos_to_last_merge=0.9757 (last merge round=1)
[S13] round=7 local utility u=0.744805 metrics={'f1_val': 0.37685827003020245, 'auprc': 0.7209606778903619, 'loss_val': 1.1414122439728054, 'psi': 0.5144992331742663}-{'f1_val': 0.1403857625770531, 'auprc': 0.7198286590477961, 'loss_val': 1.2087905020802703, 'psi': 0.3721629211653503}
[S14] START round=7 head_norm_before_train=0.774277 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.652622 metrics={'f1_val': 0.4171053288914949, 'auprc': 0.8654326511575461, 'loss_val': 1.1558802660904937, 'psi': 0.5964362577979154}-{'f1_val': 0.21315708430024508, 'auprc': 0.8433376375184561, 'loss_val': 1.1711499190239254, 'psi': 0.4652293055875295}
[S15] START round=7 head_norm_before_train=0.645941 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.763182 metrics={'f1_val': 0.37715384172927424, 'auprc': 0.784554763801859, 'loss_val': 1.1329993582542601, 'psi': 0.5401142105583081}-{'f1_val': 0.13973365136155833, 'auprc': 0.7773261504489088, 'loss_val': 1.213156978343232, 'psi': 0.39477065099649855}
[S16] START round=7 head_norm_before_train=0.788227 cos_to_last_merge=0.9935 (last merge round=5)
[S16] round=7 local utility u=0.036572 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.47853628447726865, 'loss_val': 1.0536902384004136, 'psi': 0.44170954266008083}-{'f1_val': 0.4158588189228392, 'auprc': 0.4873417015434298, 'loss_val': 1.1454529102028967, 'psi': 0.44445197197107544}
[S17] START round=7 head_norm_before_train=1.068210 cos_to_last_merge=0.9465 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=7 local utility u=0.132958 metrics={'f1_val': 0.35435902745204095, 'auprc': 0.7800580358483603, 'loss_val': 0.8861020291295315, 'psi': 0.5246386308105687}-{'f1_val': 0.39202413421260673, 'auprc': 0.6349825115264842, 'loss_val': 0.9427822715626395, 'psi': 0.4892074851381577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[S16] not sending this round → trigger blocked (psi=0.442)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.531)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.633)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.2910
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.0389
[S16] RECEIVED delta(kind=head bytes=1788) from S9
[S16] cosine check vs S9: cos=0.4928
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.8237
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.5010
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.4322
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.6433
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7009 head_norm=1.552090
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.369180e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7009 head_norm=0.861426 delta_norm=0.836918
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.6917 head_norm=0.759817
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.940306e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7154 head_norm=0.682277 delta_norm=0.394031
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.7008 head_norm=0.952194
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.454086e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7006 head_norm=0.941926 delta_norm=0.445409
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=0.830324
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.323044e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4172 head_norm=0.740750 delta_norm=0.432304
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4168 head_norm=0.859659
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.761433e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.3947 head_norm=0.872678 delta_norm=0.276143
[S10] aggregate: ROLLBACK (f1_val pre=0.417 post=0.395 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.3772 head_norm=0.689921
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.177889e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3280 head_norm=0.563669 delta_norm=0.417789
[S15] aggregate: ROLLBACK (f1_val pre=0.377 post=0.328 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7013 head_norm=0.884171
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.647113e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7013 head_norm=0.737855 delta_norm=0.464711
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.713127 cos_to_last_merge=0.9965 (last merge round=6)
[S2] round=8 local utility u=0.186129 metrics={'f1_val': 0.41659826703217306, 'auprc': 0.74444696241512, 'loss_val': 1.065880476990282, 'psi': 0.5477377451853518}-{'f1_val': 0.3499350768740163, 'auprc': 0.7802666959394025, 'loss_val': 1.1456175837368117, 'psi': 0.5220677245001708}
[S3] START round=8 head_norm_before_train=0.941926 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.019134 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9977025131252127, 'loss_val': 0.47584690136053187, 'psi': 0.8193367220028791}-{'f1_val': 0.7008317350254774, 'auprc': 0.9977954965185115, 'loss_val': 0.5168276651554882, 'psi': 0.8196172396226911}
[S4] START round=8 head_norm_before_train=1.394643 (no previous merge yet)
[S4] round=8 local utility u=0.041277 metrics={'f1_val': 0.6650049762332704, 'auprc': 0.6613017229289869, 'loss_val': 0.5633779801786325, 'psi': 0.663523674911557}-{'f1_val': 0.6689081809799005, 'auprc': 0.6628080934526897, 'loss_val': 0.6738700900081783, 'psi': 0.666468145969016}
[S5] START round=8 head_norm_before_train=0.861426 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.076168 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.792917738823856, 'loss_val': 0.4086161415204918, 'psi': 0.737532131127147}-{'f1_val': 0.7008563225598777, 'auprc': 0.7317262115586078, 'loss_val': 0.3788650608465004, 'psi': 0.7132042781593697}
[S6] START round=8 head_norm_before_train=0.950714 cos_to_last_merge=0.9410 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=8 local utility u=0.221385 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.8082108482749578, 'loss_val': 0.7553565723282738, 'psi': 0.5736379608842314}-{'f1_val': 0.4166544795555117, 'auprc': 0.7029792106389523, 'loss_val': 0.878822641687436, 'psi': 0.531184371988888}
[S7] START round=8 head_norm_before_train=1.399806 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6253204033555756, 'auprc': 0.7816042207891459, 'loss_val': 0.6580009183639054, 'psi': 0.6878339303290038}-{'f1_val': 0.7001397550937472, 'auprc': 0.8825801425114468, 'loss_val': 0.5667531105422172, 'psi': 0.773115910060827}
[S8] START round=8 head_norm_before_train=0.682277 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.084799 metrics={'f1_val': 0.7148118385281752, 'auprc': 0.7768884311521695, 'loss_val': 1.0386404313532693, 'psi': 0.7396424755777729}-{'f1_val': 0.6916919575650324, 'auprc': 0.7769409181391611, 'loss_val': 1.069675830604288, 'psi': 0.7257915417946839}
[S9] START round=8 head_norm_before_train=0.737855 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9983249800755725, 'loss_val': 0.4060772491273448, 'psi': 0.8199540859028357}-{'f1_val': 0.7012904835408967, 'auprc': 0.9977611522101445, 'loss_val': 0.36572747849918297, 'psi': 0.8198787510085959}
[S10] START round=8 head_norm_before_train=0.872678 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.3850021942862182, 'auprc': 0.6630345967792269, 'loss_val': 0.9122711913240997, 'psi': 0.4962151552834217}-{'f1_val': 0.4168455130671376, 'auprc': 0.6514126695336024, 'loss_val': 0.9570961043969162, 'psi': 0.5106723756537235}
[S11] START round=8 head_norm_before_train=1.068027 cos_to_last_merge=0.9895 (last merge round=5)
[S11] round=8 local utility u=0.070239 metrics={'f1_val': 0.396484976660716, 'auprc': 0.996829190316897, 'loss_val': 0.870173465558489, 'psi': 0.6366226621231884}-{'f1_val': 0.41559855532256573, 'auprc': 0.9589307013173877, 'loss_val': 1.0116383157538082, 'psi': 0.6329314137204944}
[S13] START round=8 head_norm_before_train=0.967796 cos_to_last_merge=0.9672 (last merge round=1)
[S13] round=8 local utility u=0.181578 metrics={'f1_val': 0.4162370592043806, 'auprc': 0.7277443377897579, 'loss_val': 1.0348790754748383, 'psi': 0.5408399706385315}-{'f1_val': 0.37685827003020245, 'auprc': 0.7209606778903619, 'loss_val': 1.1414122439728054, 'psi': 0.5144992331742663}
[S14] START round=8 head_norm_before_train=0.814987 cos_to_last_merge=0.9977 (last merge round=6)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.2627579081390975, 'auprc': 0.8653883255517764, 'loss_val': 1.000376491594827, 'psi': 0.503810075104169}-{'f1_val': 0.4171053288914949, 'auprc': 0.8654326511575461, 'loss_val': 1.1558802660904937, 'psi': 0.5964362577979154}
[S15] START round=8 head_norm_before_train=0.563669 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.036526 metrics={'f1_val': 0.38559038584277866, 'auprc': 0.7711679289126834, 'loss_val': 1.0704063330349054, 'psi': 0.5398214030707406}-{'f1_val': 0.37715384172927424, 'auprc': 0.784554763801859, 'loss_val': 1.1329993582542601, 'psi': 0.5401142105583081}
[S16] START round=8 head_norm_before_train=0.740750 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.35158855709054404, 'auprc': 0.4811722996090526, 'loss_val': 1.1152604397468835, 'psi': 0.40342205409794746}-{'f1_val': 0.4171583814486223, 'auprc': 0.47853628447726865, 'loss_val': 1.0536902384004136, 'psi': 0.44170954266008083}
[S17] START round=8 head_norm_before_train=1.124525 cos_to_last_merge=0.9294 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.31590083568289773, 'auprc': 0.7738812462365172, 'loss_val': 1.1711351500666525, 'psi': 0.4990929999043455}-{'f1_val': 0.35435902745204095, 'auprc': 0.7800580358483603, 'loss_val': 0.8861020291295315, 'psi': 0.5246386308105687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S13] not sending this round → trigger blocked (psi=0.541)
[S2] not sending this round → trigger blocked (psi=0.548)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S15] not sending this round → trigger blocked (psi=0.540)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.4682
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.4602
[S8] RECEIVED delta(kind=head bytes=1791) from S6
[S8] cosine check vs S6: cos=0.4865
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.8907
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.2798
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.6911
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4166 head_norm=0.747445
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.722171e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4001 head_norm=0.818555 delta_norm=0.372217
[S2] aggregate: ROLLBACK (f1_val pre=0.417 post=0.400 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.3856 head_norm=0.612705
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.910343e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3837 head_norm=0.747272 delta_norm=0.491034
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7010 head_norm=0.844943
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.699049e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7010 head_norm=0.623638 delta_norm=0.469905
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3516 head_norm=0.777214
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.570025e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3338 head_norm=0.742442 delta_norm=0.457002
[S16] aggregate: ROLLBACK (f1_val pre=0.352 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=1.106188
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.426820e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3964 head_norm=1.243897 delta_norm=0.342682
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7148 head_norm=0.711014
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.508532e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7145 head_norm=0.740923 delta_norm=0.450853
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.818555 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.072615 metrics={'f1_val': 0.41689240648099757, 'auprc': 0.7743235254845364, 'loss_val': 1.0120455556709924, 'psi': 0.5598648540824132}-{'f1_val': 0.41659826703217306, 'auprc': 0.74444696241512, 'loss_val': 1.065880476990282, 'psi': 0.5477377451853518}
[S3] START round=9 head_norm_before_train=1.028825 cos_to_last_merge=0.9901 (last merge round=7)
[S3] round=9 local utility u=0.042149 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9975476519920806, 'loss_val': 0.39063358054861796, 'psi': 0.8192298036644701}-{'f1_val': 0.7004261945879899, 'auprc': 0.9977025131252127, 'loss_val': 0.47584690136053187, 'psi': 0.8193367220028791}
[S4] START round=9 head_norm_before_train=1.451127 (no previous merge yet)
[S4] round=9 local utility u=0.272341 metrics={'f1_val': 0.6642428108308859, 'auprc': 0.8219039728793862, 'loss_val': 0.4959299168251796, 'psi': 0.7273072756502861}-{'f1_val': 0.6650049762332704, 'auprc': 0.6613017229289869, 'loss_val': 0.5633779801786325, 'psi': 0.663523674911557}
[S5] START round=9 head_norm_before_train=0.957122 cos_to_last_merge=0.9945 (last merge round=7)
[S5] round=9 local utility u=0.032234 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.794469703626481, 'loss_val': 0.3488050096069192, 'psi': 0.738152917048197}-{'f1_val': 0.7006083926626743, 'auprc': 0.792917738823856, 'loss_val': 0.4086161415204918, 'psi': 0.737532131127147}
[S6] START round=9 head_norm_before_train=0.999464 cos_to_last_merge=0.9268 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=9 local utility u=0.056044 metrics={'f1_val': 0.4164909323537405, 'auprc': 0.7949797644657149, 'loss_val': 0.5989856164678907, 'psi': 0.5678864651985303}-{'f1_val': 0.4172560359570804, 'auprc': 0.8082108482749578, 'loss_val': 0.7553565723282738, 'psi': 0.5736379608842314}
[S7] START round=9 head_norm_before_train=1.431351 (no previous merge yet)
[S7] round=9 local utility u=0.420634 metrics={'f1_val': 0.6945619976432517, 'auprc': 0.8521776422398692, 'loss_val': 0.44390341623249496, 'psi': 0.7576082554818987}-{'f1_val': 0.6253204033555756, 'auprc': 0.7816042207891459, 'loss_val': 0.6580009183639054, 'psi': 0.6878339303290038}
[S8] START round=9 head_norm_before_train=0.740923 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7617678815678586, 'loss_val': 0.9600818760445612, 'psi': 0.5284265729404494}-{'f1_val': 0.7148118385281752, 'auprc': 0.7768884311521695, 'loss_val': 1.0386404313532693, 'psi': 0.7396424755777729}
[S9] START round=9 head_norm_before_train=0.623638 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9901906236714243, 'loss_val': 0.4312310826404344, 'psi': 0.8167003433411764}-{'f1_val': 0.7010401564543445, 'auprc': 0.9983249800755725, 'loss_val': 0.4060772491273448, 'psi': 0.8199540859028357}
[S10] START round=9 head_norm_before_train=0.907766 cos_to_last_merge=0.9943 (last merge round=7)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6758230138735105, 'auprc': 0.9365613260800485, 'loss_val': 0.7627642827636139, 'psi': 0.7801183387561257}-{'f1_val': 0.3850021942862182, 'auprc': 0.6630345967792269, 'loss_val': 0.9122711913240997, 'psi': 0.4962151552834217}
[S11] START round=9 head_norm_before_train=1.243897 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.051126 metrics={'f1_val': 0.3972692472692473, 'auprc': 0.9928818733332594, 'loss_val': 0.760784911587059, 'psi': 0.6355142976948521}-{'f1_val': 0.396484976660716, 'auprc': 0.996829190316897, 'loss_val': 0.870173465558489, 'psi': 0.6366226621231884}
[S13] START round=9 head_norm_before_train=1.001713 cos_to_last_merge=0.9568 (last merge round=1)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3775703091612105, 'auprc': 0.7379558888785485, 'loss_val': 0.9171917200043668, 'psi': 0.5217245410481457}-{'f1_val': 0.4162370592043806, 'auprc': 0.7277443377897579, 'loss_val': 1.0348790754748383, 'psi': 0.5408399706385315}
[S14] START round=9 head_norm_before_train=0.863279 cos_to_last_merge=0.9913 (last merge round=6)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.7020620161542324, 'auprc': 0.9935927768740495, 'loss_val': 0.7945325853329214, 'psi': 0.8186743204421592}-{'f1_val': 0.2627579081390975, 'auprc': 0.8653883255517764, 'loss_val': 1.000376491594827, 'psi': 0.503810075104169}
[S15] START round=9 head_norm_before_train=0.747272 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.387793901823105, 'auprc': 0.6336397588315024, 'loss_val': 0.936696690224743, 'psi': 0.486132244626464}-{'f1_val': 0.38559038584277866, 'auprc': 0.7711679289126834, 'loss_val': 1.0704063330349054, 'psi': 0.5398214030707406}
[S16] START round=9 head_norm_before_train=0.742442 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.498610 metrics={'f1_val': 0.39412383390848826, 'auprc': 0.7178192055085035, 'loss_val': 1.083193648460319, 'psi': 0.5236019825484943}-{'f1_val': 0.35158855709054404, 'auprc': 0.4811722996090526, 'loss_val': 1.1152604397468835, 'psi': 0.40342205409794746}
[S17] START round=9 head_norm_before_train=1.172792 cos_to_last_merge=0.9137 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=9 local utility u=0.160067 metrics={'f1_val': 0.35169023861171367, 'auprc': 0.7366986125886655, 'loss_val': 0.9541896292806401, 'psi': 0.5056935882024944}-{'f1_val': 0.31590083568289773, 'auprc': 0.7738812462365172, 'loss_val': 1.1711351500666525, 'psi': 0.4990929999043455}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.727)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.738)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S11] not sending this round → trigger blocked (psi=0.636)
[S3] not sending this round → trigger blocked (psi=0.819)
[S6] not sending this round → trigger blocked (psi=0.568)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.4403
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.2823
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] cosine check vs S2: cos=0.2122
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.4841
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.4654
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.8378
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7010 head_norm=0.748544
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.491302e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7010 head_norm=0.731056 delta_norm=0.449130
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3729 head_norm=0.777428
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.539344e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7145 head_norm=0.722432 delta_norm=0.453934
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7004 head_norm=1.115924
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.751931e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7004 head_norm=0.968563 delta_norm=0.375193
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.7021 head_norm=0.922786
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.367830e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.7021 head_norm=0.734336 delta_norm=0.436783
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3878 head_norm=0.798002
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.168485e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4378 head_norm=0.640835 delta_norm=0.516849
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.847818 cos_to_last_merge=0.9957 (last merge round=8)
[S2] round=10 local utility u=0.785333 metrics={'f1_val': 0.6555051294051374, 'auprc': 0.7765086174267712, 'loss_val': 0.8796109077868876, 'psi': 0.703906524613791}-{'f1_val': 0.41689240648099757, 'auprc': 0.7743235254845364, 'loss_val': 1.0120455556709924, 'psi': 0.5598648540824132}
[S3] START round=10 head_norm_before_train=0.968563 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9929783786353406, 'loss_val': 0.4000198824814075, 'psi': 0.8175549529542596}-{'f1_val': 0.7003512381127298, 'auprc': 0.9975476519920806, 'loss_val': 0.39063358054861796, 'psi': 0.8192298036644701}
[S4] START round=10 head_norm_before_train=1.507398 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6626087128926976, 'auprc': 0.8101589154667895, 'loss_val': 0.45409169779274194, 'psi': 0.7216287939223345}-{'f1_val': 0.6642428108308859, 'auprc': 0.8219039728793862, 'loss_val': 0.4959299168251796, 'psi': 0.7273072756502861}
[S5] START round=10 head_norm_before_train=1.046102 cos_to_last_merge=0.9846 (last merge round=7)
[S5] round=10 local utility u=0.241211 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9411977896771291, 'loss_val': 0.3080553475762291, 'psi': 0.7969929094067782}-{'f1_val': 0.7006083926626743, 'auprc': 0.794469703626481, 'loss_val': 0.3488050096069192, 'psi': 0.738152917048197}
[S6] START round=10 head_norm_before_train=1.042605 cos_to_last_merge=0.9134 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=10 local utility u=0.656574 metrics={'f1_val': 0.6281891556825594, 'auprc': 0.7877181546128813, 'loss_val': 0.5342415631612473, 'psi': 0.6920007552546882}-{'f1_val': 0.4164909323537405, 'auprc': 0.7949797644657149, 'loss_val': 0.5989856164678907, 'psi': 0.5678864651985303}
[S7] START round=10 head_norm_before_train=1.462193 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6376169883951404, 'auprc': 0.7820118733511792, 'loss_val': 0.5897675544915817, 'psi': 0.6953749423775559}-{'f1_val': 0.6945619976432517, 'auprc': 0.8521776422398692, 'loss_val': 0.44390341623249496, 'psi': 0.7576082554818987}
[S8] START round=10 head_norm_before_train=0.722432 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.951428 metrics={'f1_val': 0.6617266069622916, 'auprc': 0.7893496649808424, 'loss_val': 0.8731371488156181, 'psi': 0.7127758301697118}-{'f1_val': 0.3728657005221765, 'auprc': 0.7617678815678586, 'loss_val': 0.9600818760445612, 'psi': 0.5284265729404494}
[S9] START round=10 head_norm_before_train=0.731056 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.016601 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9971565127892554, 'loss_val': 0.41892621020075194, 'psi': 0.819486698988309}-{'f1_val': 0.7010401564543445, 'auprc': 0.9901906236714243, 'loss_val': 0.4312310826404344, 'psi': 0.8167003433411764}
[S10] START round=10 head_norm_before_train=0.954989 cos_to_last_merge=0.9791 (last merge round=7)
[S10] round=10 local utility u=0.233681 metrics={'f1_val': 0.7013704343360756, 'auprc': 0.9881094885166163, 'loss_val': 0.6033320154166584, 'psi': 0.816066056008292}-{'f1_val': 0.6758230138735105, 'auprc': 0.9365613260800485, 'loss_val': 0.7627642827636139, 'psi': 0.7801183387561257}
[S11] START round=10 head_norm_before_train=1.277113 cos_to_last_merge=0.9976 (last merge round=8)
[S11] round=10 local utility u=0.877659 metrics={'f1_val': 0.6980286183227438, 'auprc': 0.9409848319098434, 'loss_val': 0.654331384301974, 'psi': 0.7952111037575836}-{'f1_val': 0.3972692472692473, 'auprc': 0.9928818733332594, 'loss_val': 0.760784911587059, 'psi': 0.6355142976948521}
[S13] START round=10 head_norm_before_train=1.030121 cos_to_last_merge=0.9453 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=10 local utility u=0.434521 metrics={'f1_val': 0.5066882732800643, 'auprc': 0.7324111587480648, 'loss_val': 0.8062243102324518, 'psi': 0.5969774274672646}-{'f1_val': 0.3775703091612105, 'auprc': 0.7379558888785485, 'loss_val': 0.9171917200043668, 'psi': 0.5217245410481457}
[S14] START round=10 head_norm_before_train=0.734336 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.714236 metrics={'f1_val': 0.9299486831280295, 'auprc': 0.9947797579382951, 'loss_val': 0.7369406855427727, 'psi': 0.9558811130521356}-{'f1_val': 0.7020620161542324, 'auprc': 0.9935927768740495, 'loss_val': 0.7945325853329214, 'psi': 0.8186743204421592}
[S15] START round=10 head_norm_before_train=0.640835 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.644545 metrics={'f1_val': 0.5682484878265796, 'auprc': 0.6886101278022394, 'loss_val': 0.8952448214225495, 'psi': 0.6163931438168435}-{'f1_val': 0.387793901823105, 'auprc': 0.6336397588315024, 'loss_val': 0.936696690224743, 'psi': 0.486132244626464}
[S16] START round=10 head_norm_before_train=0.780080 cos_to_last_merge=0.9919 (last merge round=8)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.37621239843887794, 'auprc': 0.7151829888317702, 'loss_val': 1.027134130050212, 'psi': 0.5118006345960349}-{'f1_val': 0.39412383390848826, 'auprc': 0.7178192055085035, 'loss_val': 1.083193648460319, 'psi': 0.5236019825484943}
[S17] START round=10 head_norm_before_train=1.213109 cos_to_last_merge=0.8991 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=10 local utility u=0.609478 metrics={'f1_val': 0.5311319035211819, 'auprc': 0.7632747439754495, 'loss_val': 0.8916113454247869, 'psi': 0.6239890397028889}-{'f1_val': 0.35169023861171367, 'auprc': 0.7366986125886655, 'loss_val': 0.9541896292806401, 'psi': 0.5056935882024944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S2] not sending this round → trigger blocked (psi=0.704)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.816)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44916
[S14] not sending this round → trigger blocked (psi=0.956)
[S6] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S11
[S15] cosine check vs S11: cos=0.5000
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.8479
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.2415
[S16] RECEIVED delta(kind=head bytes=1794) from S9
[S16] cosine check vs S9: cos=0.4516
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=0.8171
[S9] RECEIVED delta(kind=head bytes=1792) from S8
[S9] cosine check vs S8: cos=0.4390
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.5233
[S17] not sending this round → trigger blocked (psi=0.624)
[S3] ⇄ pheromone p=0.317 → S2@127.0.0.1:44902
[S4] ⇄ pheromone p=0.292 → S11@127.0.0.1:44912
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7014 head_norm=1.011757
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.878274e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7001 head_norm=0.999119 delta_norm=0.287827
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.404 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=0.536 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.268 → S3@127.0.0.1:44903
[S2] ⇄ pheromone p=0.398 → S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.6617 head_norm=0.764178
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.741025e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3731 head_norm=0.812601 delta_norm=0.474102
[S8] aggregate: ROLLBACK (f1_val pre=0.662 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.421 → S9@127.0.0.1:44910
[S6] ⇄ pheromone p=0.346 → S8@127.0.0.1:44909
[S11] ⇄ pheromone p=0.437 → S15@127.0.0.1:44915
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7010 head_norm=0.836630
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.250054e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7010 head_norm=0.679212 delta_norm=0.425005
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.242 → S16@127.0.0.1:44916
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7009 head_norm=1.119466
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.828874e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7009 head_norm=0.726058 delta_norm=0.582887
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.246 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.304 → S10@127.0.0.1:44911
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.5682 head_norm=0.693276
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.709380e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.5445 head_norm=0.884739 delta_norm=0.570938
[S15] aggregate: ROLLBACK (f1_val pre=0.568 post=0.544 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.323 → S5@127.0.0.1:44905
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3762 head_norm=0.827393
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.141228e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3788 head_norm=0.761944 delta_norm=0.214123
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.269 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.353 → S3@127.0.0.1:44903
[S2] START round=11 head_norm_before_train=0.888585 cos_to_last_merge=0.9850 (last merge round=8)
[S2] round=11 local utility u=0.222217 metrics={'f1_val': 0.7125103146938945, 'auprc': 0.7772187331385346, 'loss_val': 0.7793388732000374, 'psi': 0.7383936820717505}-{'f1_val': 0.6555051294051374, 'auprc': 0.7765086174267712, 'loss_val': 0.8796109077868876, 'psi': 0.703906524613791}
[S3] START round=11 head_norm_before_train=1.053109 cos_to_last_merge=0.9949 (last merge round=9)
[S3] round=11 local utility u=0.050945 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9971786747818538, 'loss_val': 0.3111805433581689, 'psi': 0.8192800457119425}-{'f1_val': 0.7006060025002057, 'auprc': 0.9929783786353406, 'loss_val': 0.4000198824814075, 'psi': 0.8175549529542596}
[S4] START round=11 head_norm_before_train=1.559404 (no previous merge yet)
[S4] round=11 local utility u=0.197003 metrics={'f1_val': 0.6729442671845723, 'auprc': 0.9490455331571808, 'loss_val': 0.5387580181486441, 'psi': 0.7833847735736157}-{'f1_val': 0.6626087128926976, 'auprc': 0.8101589154667895, 'loss_val': 0.45409169779274194, 'psi': 0.7216287939223345}
[S5] START round=11 head_norm_before_train=0.726058 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7076596271015752, 'auprc': 0.7937046990371401, 'loss_val': 0.48793422796750785, 'psi': 0.7420776558758011}-{'f1_val': 0.7008563225598777, 'auprc': 0.9411977896771291, 'loss_val': 0.3080553475762291, 'psi': 0.7969929094067782}
[S6] START round=11 head_norm_before_train=1.089137 cos_to_last_merge=0.9003 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.900
[S6] round=11 local utility u=0.237803 metrics={'f1_val': 0.6862141143360867, 'auprc': 0.8019400036279375, 'loss_val': 0.44945103603134473, 'psi': 0.732504470052827}-{'f1_val': 0.6281891556825594, 'auprc': 0.7877181546128813, 'loss_val': 0.5342415631612473, 'psi': 0.6920007552546882}
[S7] START round=11 head_norm_before_train=1.493001 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6294627956852707, 'auprc': 0.7810086544724122, 'loss_val': 0.5971406167649088, 'psi': 0.6900811392001274}-{'f1_val': 0.6376169883951404, 'auprc': 0.7820118733511792, 'loss_val': 0.5897675544915817, 'psi': 0.6953749423775559}
[S8] START round=11 head_norm_before_train=0.812601 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.215902 metrics={'f1_val': 0.7141096062959231, 'auprc': 0.7896728332177276, 'loss_val': 0.7566013176683365, 'psi': 0.744334897064645}-{'f1_val': 0.6617266069622916, 'auprc': 0.7893496649808424, 'loss_val': 0.8731371488156181, 'psi': 0.7127758301697118}
[S9] START round=11 head_norm_before_train=0.679212 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.015382 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9978290867359461, 'loss_val': 0.3906244984075047, 'psi': 0.8198002385896481}-{'f1_val': 0.7010401564543445, 'auprc': 0.9971565127892554, 'loss_val': 0.41892621020075194, 'psi': 0.819486698988309}
[S10] START round=11 head_norm_before_train=0.999119 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.7002832779608037, 'auprc': 0.9753551505605799, 'loss_val': 0.565821451313509, 'psi': 0.8103120270007143}-{'f1_val': 0.7013704343360756, 'auprc': 0.9881094885166163, 'loss_val': 0.6033320154166584, 'psi': 0.816066056008292}
[S11] START round=11 head_norm_before_train=1.317890 cos_to_last_merge=0.9916 (last merge round=8)
[S11] round=11 local utility u=0.099389 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9436422334490533, 'loss_val': 0.48590829223153714, 'psi': 0.7985122563765001}-{'f1_val': 0.6980286183227438, 'auprc': 0.9409848319098434, 'loss_val': 0.654331384301974, 'psi': 0.7952111037575836}
[S13] START round=11 head_norm_before_train=1.067011 cos_to_last_merge=0.9306 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=11 local utility u=0.681703 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.7485212753203777, 'loss_val': 0.729979686612555, 'psi': 0.7273046715526446}-{'f1_val': 0.5066882732800643, 'auprc': 0.7324111587480648, 'loss_val': 0.8062243102324518, 'psi': 0.5969774274672646}
[S14] START round=11 head_norm_before_train=0.792017 cos_to_last_merge=0.9949 (last merge round=9)
[S14] round=11 local utility u=0.277099 metrics={'f1_val': 0.9980868056894548, 'auprc': 0.9947122191545339, 'loss_val': 0.5913690127816861, 'psi': 0.9967369710754865}-{'f1_val': 0.9299486831280295, 'auprc': 0.9947797579382951, 'loss_val': 0.7369406855427727, 'psi': 0.9558811130521356}
[S15] START round=11 head_norm_before_train=0.884739 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.5488789118309916, 'auprc': 0.6659369643361986, 'loss_val': 0.7333044473169984, 'psi': 0.5957021328330745}-{'f1_val': 0.5682484878265796, 'auprc': 0.6886101278022394, 'loss_val': 0.8952448214225495, 'psi': 0.6163931438168435}
[S16] START round=11 head_norm_before_train=0.761944 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.196676 metrics={'f1_val': 0.43051272293285037, 'auprc': 0.7277637734372515, 'loss_val': 0.9973256459893505, 'psi': 0.5494131431346108}-{'f1_val': 0.37621239843887794, 'auprc': 0.7151829888317702, 'loss_val': 1.027134130050212, 'psi': 0.5118006345960349}
[S17] START round=11 head_norm_before_train=1.244010 cos_to_last_merge=0.8878 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.888
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3756545357664335, 'auprc': 0.7744662230557265, 'loss_val': 0.8807142661502978, 'psi': 0.5351792106821507}-{'f1_val': 0.5311319035211819, 'auprc': 0.7632747439754495, 'loss_val': 0.8916113454247869, 'psi': 0.6239890397028889}
[S6] not sending this round → trigger blocked (psi=0.733)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S8] not sending this round → trigger blocked (psi=0.744)
[S11] not sending this round → trigger blocked (psi=0.799)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → trigger blocked (psi=0.727)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:44902
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.2676
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.7627
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9373
[S2] RECEIVED delta(kind=head bytes=1806) from S3
[S2] cosine check vs S3: cos=0.8776
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.3970
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=1.363292
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.867625e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7018 head_norm=1.457765 delta_norm=0.286762
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7141 head_norm=0.859072
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.730188e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7142 head_norm=0.719949 delta_norm=0.473019
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.5489 head_norm=0.933308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.657635e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6184 head_norm=0.744280 delta_norm=0.565763
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7125 head_norm=0.936493
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.748871e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7053 head_norm=1.005810 delta_norm=0.274887
[S2] aggregate: ROLLBACK (f1_val pre=0.713 post=0.705 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9981 head_norm=0.863795
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.892337e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9977 head_norm=0.785200 delta_norm=0.289234
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.005810 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.019893 metrics={'f1_val': 0.7123004355532008, 'auprc': 0.7774681439739485, 'loss_val': 0.7390418591591503, 'psi': 0.7383675189214999}-{'f1_val': 0.7125103146938945, 'auprc': 0.7772187331385346, 'loss_val': 0.7793388732000374, 'psi': 0.7383936820717505}
[S3] START round=12 head_norm_before_train=1.139042 cos_to_last_merge=0.9844 (last merge round=9)
[S3] round=12 local utility u=0.030919 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.995585313633157, 'loss_val': 0.2450139199996956, 'psi': 0.8186878476944426}-{'f1_val': 0.7006809596653347, 'auprc': 0.9971786747818538, 'loss_val': 0.3111805433581689, 'psi': 0.8192800457119425}
[S4] START round=12 head_norm_before_train=1.598767 (no previous merge yet)
[S4] round=12 local utility u=0.860155 metrics={'f1_val': 0.9540809673678611, 'auprc': 0.9471359201073517, 'loss_val': 0.49953932600116746, 'psi': 0.9513029484636574}-{'f1_val': 0.6729442671845723, 'auprc': 0.9490455331571808, 'loss_val': 0.5387580181486441, 'psi': 0.7833847735736157}
[S5] START round=12 head_norm_before_train=0.837019 cos_to_last_merge=0.9908 (last merge round=10)
[S5] round=12 local utility u=0.131827 metrics={'f1_val': 0.7006073928698142, 'auprc': 0.8487905777126507, 'loss_val': 0.34722512953668805, 'psi': 0.7598806668069489}-{'f1_val': 0.7076596271015752, 'auprc': 0.7937046990371401, 'loss_val': 0.48793422796750785, 'psi': 0.7420776558758011}
[S6] START round=12 head_norm_before_train=1.133650 cos_to_last_merge=0.8874 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6850803071073878, 'auprc': 0.7683896279855428, 'loss_val': 0.49375453386490914, 'psi': 0.7184040354586498}-{'f1_val': 0.6862141143360867, 'auprc': 0.8019400036279375, 'loss_val': 0.44945103603134473, 'psi': 0.732504470052827}
[S7] START round=12 head_norm_before_train=1.520465 (no previous merge yet)
[S7] round=12 local utility u=0.043200 metrics={'f1_val': 0.633801978433339, 'auprc': 0.7916223529028501, 'loss_val': 0.5686166371934336, 'psi': 0.6969301282211434}-{'f1_val': 0.6294627956852707, 'auprc': 0.7810086544724122, 'loss_val': 0.5971406167649088, 'psi': 0.6900811392001274}
[S8] START round=12 head_norm_before_train=0.719949 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.115009 metrics={'f1_val': 0.7011506828958344, 'auprc': 0.8734468885914116, 'loss_val': 0.7001521063645413, 'psi': 0.7700691651740652}-{'f1_val': 0.7141096062959231, 'auprc': 0.7896728332177276, 'loss_val': 0.7566013176683365, 'psi': 0.744334897064645}
[S9] START round=12 head_norm_before_train=0.795736 cos_to_last_merge=0.9851 (last merge round=10)
[S9] round=12 local utility u=0.039924 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981058710683997, 'loss_val': 0.3126634517286892, 'psi': 0.8200166385518979}-{'f1_val': 0.7011143398254496, 'auprc': 0.9978290867359461, 'loss_val': 0.3906244984075047, 'psi': 0.8198002385896481}
[S10] START round=12 head_norm_before_train=1.045049 cos_to_last_merge=0.9967 (last merge round=10)
[S10] round=12 local utility u=0.051414 metrics={'f1_val': 0.6888443325515965, 'auprc': 0.988326202246762, 'loss_val': 0.4332731454249589, 'psi': 0.8086370804296628}-{'f1_val': 0.7002832779608037, 'auprc': 0.9753551505605799, 'loss_val': 0.565821451313509, 'psi': 0.8103120270007143}
[S11] START round=12 head_norm_before_train=1.457765 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.028587 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9429862423432743, 'loss_val': 0.42821797477546475, 'psi': 0.798394962504849}-{'f1_val': 0.7017589383281313, 'auprc': 0.9436422334490533, 'loss_val': 0.48590829223153714, 'psi': 0.7985122563765001}
[S13] START round=12 head_norm_before_train=1.108443 cos_to_last_merge=0.9159 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6637159566497648, 'auprc': 0.745246538023483, 'loss_val': 0.6784189037860229, 'psi': 0.6963281891992521}-{'f1_val': 0.7131602690408223, 'auprc': 0.7485212753203777, 'loss_val': 0.729979686612555, 'psi': 0.7273046715526446}
[S14] START round=12 head_norm_before_train=0.785200 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.9972657600632533, 'auprc': 0.9944233391251001, 'loss_val': 0.5940061449663581, 'psi': 0.996128791687992}-{'f1_val': 0.9980868056894548, 'auprc': 0.9947122191545339, 'loss_val': 0.5913690127816861, 'psi': 0.9967369710754865}
[S15] START round=12 head_norm_before_train=0.744280 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.696017 metrics={'f1_val': 0.6992126803339516, 'auprc': 0.7992523383076868, 'loss_val': 0.6432185639159457, 'psi': 0.7392285435234457}-{'f1_val': 0.5488789118309916, 'auprc': 0.6659369643361986, 'loss_val': 0.7333044473169984, 'psi': 0.5957021328330745}
[S16] START round=12 head_norm_before_train=0.808856 cos_to_last_merge=0.9951 (last merge round=10)
[S16] round=12 local utility u=0.088003 metrics={'f1_val': 0.44023437596486503, 'auprc': 0.7389246992242432, 'loss_val': 0.9131317338934085, 'psi': 0.5597105052686162}-{'f1_val': 0.43051272293285037, 'auprc': 0.7277637734372515, 'loss_val': 0.9973256459893505, 'psi': 0.5494131431346108}
[S17] START round=12 head_norm_before_train=1.270048 cos_to_last_merge=0.8777 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=12 local utility u=0.093831 metrics={'f1_val': 0.40330248479068026, 'auprc': 0.777403928037848, 'loss_val': 0.8677532628930855, 'psi': 0.5529430620895474}-{'f1_val': 0.3756545357664335, 'auprc': 0.7744662230557265, 'loss_val': 0.8807142661502978, 'psi': 0.5351792106821507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:44905
[S3] not sending this round → trigger blocked (psi=0.819)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.738)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S4] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S16] not sending this round → trigger blocked (psi=0.560)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.4953
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=0.7889
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.7718
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.5800
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=0.4982
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.5356
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=0.5342
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.7298
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=1.214626
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.243710e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=1.071737 delta_norm=0.324371
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6992 head_norm=0.796463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.330730e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7016 head_norm=1.019976 delta_norm=0.633073
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=0.906987
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.729411e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=0.768731 delta_norm=0.272941
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=0.943753
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.248408e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=0.762903 delta_norm=0.424841
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4402 head_norm=0.863672
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.271745e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4405 head_norm=0.774781 delta_norm=0.227175
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.048796 cos_to_last_merge=0.9978 (last merge round=11)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6855335216551097, 'auprc': 0.724636894545396, 'loss_val': 0.625084995627687, 'psi': 0.7011748708112242}-{'f1_val': 0.7123004355532008, 'auprc': 0.7774681439739485, 'loss_val': 0.7390418591591503, 'psi': 0.7383675189214999}
[S3] START round=13 head_norm_before_train=1.071737 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9961084271680892, 'loss_val': 0.29535413209044237, 'psi': 0.8188519466664366}-{'f1_val': 0.7007562037352997, 'auprc': 0.995585313633157, 'loss_val': 0.2450139199996956, 'psi': 0.8186878476944426}
[S4] START round=13 head_norm_before_train=1.633580 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6659012757370367, 'auprc': 0.9305370813086127, 'loss_val': 0.43488414029126626, 'psi': 0.7717555979656672}-{'f1_val': 0.9540809673678611, 'auprc': 0.9471359201073517, 'loss_val': 0.49953932600116746, 'psi': 0.9513029484636574}
[S5] START round=13 head_norm_before_train=0.762903 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.024593 metrics={'f1_val': 0.7006070944832098, 'auprc': 0.8838876772577153, 'loss_val': 0.4033293312231021, 'psi': 0.7739193275930121}-{'f1_val': 0.7006073928698142, 'auprc': 0.8487905777126507, 'loss_val': 0.34722512953668805, 'psi': 0.7598806668069489}
[S6] START round=13 head_norm_before_train=1.173753 cos_to_last_merge=0.8759 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=13 local utility u=0.379510 metrics={'f1_val': 0.7003888776879597, 'auprc': 0.9542956341807746, 'loss_val': 0.3843042090721131, 'psi': 0.8019515802850856}-{'f1_val': 0.6850803071073878, 'auprc': 0.7683896279855428, 'loss_val': 0.49375453386490914, 'psi': 0.7184040354586498}
[S7] START round=13 head_norm_before_train=1.550588 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6292577936352503, 'auprc': 0.7924627192575013, 'loss_val': 0.5609496213623086, 'psi': 0.6945397638841506}-{'f1_val': 0.633801978433339, 'auprc': 0.7916223529028501, 'loss_val': 0.5686166371934336, 'psi': 0.6969301282211434}
[S8] START round=13 head_norm_before_train=0.768578 cos_to_last_merge=0.9934 (last merge round=11)
[S8] round=13 local utility u=0.294670 metrics={'f1_val': 0.7140451255766143, 'auprc': 0.9968055170442643, 'loss_val': 0.5582539828054923, 'psi': 0.8271492821636743}-{'f1_val': 0.7011506828958344, 'auprc': 0.8734468885914116, 'loss_val': 0.7001521063645413, 'psi': 0.7700691651740652}
[S9] START round=13 head_norm_before_train=0.768731 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9984777926306367, 'loss_val': 0.3216456848351979, 'psi': 0.8200152109248614}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981058710683997, 'loss_val': 0.3126634517286892, 'psi': 0.8200166385518979}
[S10] START round=13 head_norm_before_train=1.101743 cos_to_last_merge=0.9881 (last merge round=10)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6875732090601238, 'auprc': 0.9513370800441256, 'loss_val': 0.3626272067956798, 'psi': 0.7930787574537246}-{'f1_val': 0.6888443325515965, 'auprc': 0.988326202246762, 'loss_val': 0.4332731454249589, 'psi': 0.8086370804296628}
[S11] START round=13 head_norm_before_train=1.499304 cos_to_last_merge=0.9990 (last merge round=11)
[S11] round=13 local utility u=0.121072 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9951446261007284, 'loss_val': 0.34109807428748923, 'psi': 0.8191132134371701}-{'f1_val': 0.7020007759458987, 'auprc': 0.9429862423432743, 'loss_val': 0.42821797477546475, 'psi': 0.798394962504849}
[S13] START round=13 head_norm_before_train=1.146317 cos_to_last_merge=0.9045 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=13 local utility u=0.172514 metrics={'f1_val': 0.7130285068586637, 'auprc': 0.7352062433943908, 'loss_val': 0.5991459670590172, 'psi': 0.7218996014729545}-{'f1_val': 0.6637159566497648, 'auprc': 0.745246538023483, 'loss_val': 0.6784189037860229, 'psi': 0.6963281891992521}
[S14] START round=13 head_norm_before_train=0.850016 cos_to_last_merge=0.9934 (last merge round=11)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.8878268452430857, 'auprc': 0.9943142995124863, 'loss_val': 0.5117217741150842, 'psi': 0.930421826950846}-{'f1_val': 0.9972657600632533, 'auprc': 0.9944233391251001, 'loss_val': 0.5940061449663581, 'psi': 0.996128791687992}
[S15] START round=13 head_norm_before_train=1.019976 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.039439 metrics={'f1_val': 0.6952093127393666, 'auprc': 0.79951977012539, 'loss_val': 0.5411230364426566, 'psi': 0.736933495693776}-{'f1_val': 0.6992126803339516, 'auprc': 0.7992523383076868, 'loss_val': 0.6432185639159457, 'psi': 0.7392285435234457}
[S16] START round=13 head_norm_before_train=0.774781 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.446437 metrics={'f1_val': 0.5561116162353759, 'auprc': 0.7882692610331714, 'loss_val': 0.8635551136780242, 'psi': 0.6489746741544942}-{'f1_val': 0.44023437596486503, 'auprc': 0.7389246992242432, 'loss_val': 0.9131317338934085, 'psi': 0.5597105052686162}
[S17] START round=13 head_norm_before_train=1.295795 cos_to_last_merge=0.8695 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3573957345088743, 'auprc': 0.786500383740843, 'loss_val': 0.8472343335868311, 'psi': 0.5290375942016617}-{'f1_val': 0.40330248479068026, 'auprc': 0.777403928037848, 'loss_val': 0.8677532628930855, 'psi': 0.5529430620895474}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S8] not sending this round → trigger blocked (psi=0.827)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:44911
[S5] not sending this round → trigger blocked (psi=0.774)
[S15] not sending this round → trigger blocked (psi=0.737)
[S13] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.5721
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.8911
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.8843
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6876 head_norm=1.158296
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.814712e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6878 head_norm=1.134939 delta_norm=0.281471
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7140 head_norm=0.824495
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.974726e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7020 head_norm=0.902362 delta_norm=0.497473
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.8878 head_norm=0.918371
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.084232e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.8160 head_norm=0.847437 delta_norm=0.208423
[S14] aggregate: ROLLBACK (f1_val pre=0.888 post=0.816 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.096273 cos_to_last_merge=0.9925 (last merge round=11)
[S2] round=14 local utility u=0.197508 metrics={'f1_val': 0.6996835615678044, 'auprc': 0.7826530517276351, 'loss_val': 0.489018606079006, 'psi': 0.7328713576317367}-{'f1_val': 0.6855335216551097, 'auprc': 0.724636894545396, 'loss_val': 0.625084995627687, 'psi': 0.7011748708112242}
[S3] START round=14 head_norm_before_train=1.137276 cos_to_last_merge=0.9977 (last merge round=12)
[S3] round=14 local utility u=0.674524 metrics={'f1_val': 0.9148520826599871, 'auprc': 0.996811471213468, 'loss_val': 0.23344207778077014, 'psi': 0.9476358380813794}-{'f1_val': 0.7006809596653347, 'auprc': 0.9961084271680892, 'loss_val': 0.29535413209044237, 'psi': 0.8188519466664366}
[S4] START round=14 head_norm_before_train=1.666602 (no previous merge yet)
[S4] round=14 local utility u=0.883586 metrics={'f1_val': 0.9456577745660485, 'auprc': 0.9617063306042652, 'loss_val': 0.4397586718111331, 'psi': 0.9520771969813352}-{'f1_val': 0.6659012757370367, 'auprc': 0.9305370813086127, 'loss_val': 0.43488414029126626, 'psi': 0.7717555979656672}
[S5] START round=14 head_norm_before_train=0.870771 cos_to_last_merge=0.9863 (last merge round=12)
[S5] round=14 local utility u=0.214777 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.996642548921129, 'loss_val': 0.3120472643983782, 'psi': 0.8190220551660562}-{'f1_val': 0.7006070944832098, 'auprc': 0.8838876772577153, 'loss_val': 0.4033293312231021, 'psi': 0.7739193275930121}
[S6] START round=14 head_norm_before_train=1.201532 cos_to_last_merge=0.8685 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=14 local utility u=0.012216 metrics={'f1_val': 0.6951730811132092, 'auprc': 0.9571122426537187, 'loss_val': 0.3370264796032004, 'psi': 0.799948745729413}-{'f1_val': 0.7003888776879597, 'auprc': 0.9542956341807746, 'loss_val': 0.3843042090721131, 'psi': 0.8019515802850856}
[S7] START round=14 head_norm_before_train=1.580171 (no previous merge yet)
[S7] round=14 local utility u=0.355282 metrics={'f1_val': 0.6857679304061637, 'auprc': 0.8465099113481906, 'loss_val': 0.3515876578094367, 'psi': 0.7500647227829744}-{'f1_val': 0.6292577936352503, 'auprc': 0.7924627192575013, 'loss_val': 0.5609496213623086, 'psi': 0.6945397638841506}
[S8] START round=14 head_norm_before_train=0.902362 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7009086045093338, 'auprc': 0.9942679422206789, 'loss_val': 0.4971184996770681, 'psi': 0.8182523395938719}-{'f1_val': 0.7140451255766143, 'auprc': 0.9968055170442643, 'loss_val': 0.5582539828054923, 'psi': 0.8271492821636743}
[S9] START round=14 head_norm_before_train=0.864693 cos_to_last_merge=0.9942 (last merge round=12)
[S9] round=14 local utility u=0.030836 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9986177645640534, 'loss_val': 0.2608389523900249, 'psi': 0.8201157097208911}-{'f1_val': 0.7010401564543445, 'auprc': 0.9984777926306367, 'loss_val': 0.3216456848351979, 'psi': 0.8200152109248614}
[S10] START round=14 head_norm_before_train=1.134939 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.080830 metrics={'f1_val': 0.6996093488975941, 'auprc': 0.9886614372807677, 'loss_val': 0.38515776341520086, 'psi': 0.8152301842508636}-{'f1_val': 0.6875732090601238, 'auprc': 0.9513370800441256, 'loss_val': 0.3626272067956798, 'psi': 0.7930787574537246}
[S11] START round=14 head_norm_before_train=1.540420 cos_to_last_merge=0.9966 (last merge round=11)
[S11] round=14 local utility u=0.021897 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9979592387827998, 'loss_val': 0.305354889696965, 'psi': 0.8201997832652748}-{'f1_val': 0.7017589383281313, 'auprc': 0.9951446261007284, 'loss_val': 0.34109807428748923, 'psi': 0.8191132134371701}
[S13] START round=14 head_norm_before_train=1.180244 cos_to_last_merge=0.8947 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=14 local utility u=0.002711 metrics={'f1_val': 0.7117076967360673, 'auprc': 0.72754449022113, 'loss_val': 0.562814426726351, 'psi': 0.7180424141300923}-{'f1_val': 0.7130285068586637, 'auprc': 0.7352062433943908, 'loss_val': 0.5991459670590172, 'psi': 0.7218996014729545}
[S14] START round=14 head_norm_before_train=0.847437 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.335154 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.995543174219524, 'loss_val': 0.499120392739231, 'psi': 0.9963153177831365}-{'f1_val': 0.8878268452430857, 'auprc': 0.9943142995124863, 'loss_val': 0.5117217741150842, 'psi': 0.930421826950846}
[S15] START round=14 head_norm_before_train=1.064645 cos_to_last_merge=0.9974 (last merge round=12)
[S15] round=14 local utility u=0.055933 metrics={'f1_val': 0.6990576051082278, 'auprc': 0.799649193058692, 'loss_val': 0.45273482983850666, 'psi': 0.7392942402884135}-{'f1_val': 0.6952093127393666, 'auprc': 0.79951977012539, 'loss_val': 0.5411230364426566, 'psi': 0.736933495693776}
[S16] START round=14 head_norm_before_train=0.824484 cos_to_last_merge=0.9965 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.49496957549297954, 'auprc': 0.8074466591898128, 'loss_val': 0.7492238836467552, 'psi': 0.6199604089717128}-{'f1_val': 0.5561116162353759, 'auprc': 0.7882692610331714, 'loss_val': 0.8635551136780242, 'psi': 0.6489746741544942}
[S17] START round=14 head_norm_before_train=1.319442 cos_to_last_merge=0.8647 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.865
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.35406388426773305, 'auprc': 0.7720549925384228, 'loss_val': 0.9061098300430558, 'psi': 0.521260327576009}-{'f1_val': 0.3573957345088743, 'auprc': 0.786500383740843, 'loss_val': 0.8472343335868311, 'psi': 0.5290375942016617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S13] not sending this round → trigger blocked (psi=0.718)
[S6] not sending this round → trigger blocked (psi=0.800)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S9] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.6014
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.3736
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.6178
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.9069
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.7622
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=0.9218
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.2779
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.6418
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9647
[S16] RECEIVED delta(kind=head bytes=1788) from S9
[S16] cosine check vs S9: cos=0.6949
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7009 head_norm=0.952394
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.205787e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7550 head_norm=0.770481 delta_norm=0.520579
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=1.573891
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.250228e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.619354 delta_norm=0.225023
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6991 head_norm=1.109967
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.101746e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6989 head_norm=1.012664 delta_norm=0.210175
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7011 head_norm=0.953755
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.869261e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7011 head_norm=0.955985 delta_norm=0.486926
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=0.993304
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.481854e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=0.953137 delta_norm=0.448185
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.6997 head_norm=1.142078
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.557437e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6995 head_norm=1.147968 delta_norm=0.255744
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.9149 head_norm=1.209185
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.385900e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.9312 head_norm=1.266064 delta_norm=0.638590
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4950 head_norm=0.876982
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.991964e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4928 head_norm=0.813801 delta_norm=0.199196
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.147968 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.029194 metrics={'f1_val': 0.6994869488365228, 'auprc': 0.7967123990543056, 'loss_val': 0.4716299220370218, 'psi': 0.738377128923636}-{'f1_val': 0.6996835615678044, 'auprc': 0.7826530517276351, 'loss_val': 0.489018606079006, 'psi': 0.7328713576317367}
[S3] START round=15 head_norm_before_train=1.266064 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.157621 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9972487168021953, 'loss_val': 0.19532109606387998, 'psi': 0.9753916785823589}-{'f1_val': 0.9148520826599871, 'auprc': 0.996811471213468, 'loss_val': 0.23344207778077014, 'psi': 0.9476358380813794}
[S4] START round=15 head_norm_before_train=1.693739 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9387914878425291, 'auprc': 0.9198148431792745, 'loss_val': 0.4816266837808559, 'psi': 0.9312008299772273}-{'f1_val': 0.9456577745660485, 'auprc': 0.9617063306042652, 'loss_val': 0.4397586718111331, 'psi': 0.9520771969813352}
[S5] START round=15 head_norm_before_train=0.953137 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7011113551819586, 'auprc': 0.9141532040992589, 'loss_val': 0.3615456620742504, 'psi': 0.7863280947488787}-{'f1_val': 0.7006083926626743, 'auprc': 0.996642548921129, 'loss_val': 0.3120472643983782, 'psi': 0.8190220551660562}
[S6] START round=15 head_norm_before_train=1.227109 cos_to_last_merge=0.8624 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=15 local utility u=0.003403 metrics={'f1_val': 0.707965357556047, 'auprc': 0.9451385669649957, 'loss_val': 0.37105375119536177, 'psi': 0.8028346413196265}-{'f1_val': 0.6951730811132092, 'auprc': 0.9571122426537187, 'loss_val': 0.3370264796032004, 'psi': 0.799948745729413}
[S7] START round=15 head_norm_before_train=1.599782 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6436276523959963, 'auprc': 0.7927006878973402, 'loss_val': 0.5471999734811668, 'psi': 0.7032568665965339}-{'f1_val': 0.6857679304061637, 'auprc': 0.8465099113481906, 'loss_val': 0.3515876578094367, 'psi': 0.7500647227829744}
[S8] START round=15 head_norm_before_train=0.770481 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.271743 metrics={'f1_val': 0.7941658841060869, 'auprc': 0.9961208159033414, 'loss_val': 0.5187339770154203, 'psi': 0.8749478568249887}-{'f1_val': 0.7009086045093338, 'auprc': 0.9942679422206789, 'loss_val': 0.4971184996770681, 'psi': 0.8182523395938719}
[S9] START round=15 head_norm_before_train=0.955985 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9992241622172172, 'loss_val': 0.29360600127918257, 'psi': 0.8203582687821567}-{'f1_val': 0.7011143398254496, 'auprc': 0.9986177645640534, 'loss_val': 0.2608389523900249, 'psi': 0.8201157097208911}
[S10] START round=15 head_norm_before_train=1.179983 cos_to_last_merge=0.9980 (last merge round=13)
[S10] round=15 local utility u=0.061965 metrics={'f1_val': 0.699260083987036, 'auprc': 0.997360400391174, 'loss_val': 0.28522927925902475, 'psi': 0.8185002105486912}-{'f1_val': 0.6996093488975941, 'auprc': 0.9886614372807677, 'loss_val': 0.38515776341520086, 'psi': 0.8152301842508636}
[S11] START round=15 head_norm_before_train=1.619354 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.004554 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9981509673077895, 'loss_val': 0.296822533202237, 'psi': 0.8202764746752707}-{'f1_val': 0.7016934795869249, 'auprc': 0.9979592387827998, 'loss_val': 0.305354889696965, 'psi': 0.8201997832652748}
[S13] START round=15 head_norm_before_train=1.210098 cos_to_last_merge=0.8861 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6305768112032755, 'auprc': 0.7373998951731511, 'loss_val': 0.5846965672752009, 'psi': 0.6733060447912258}-{'f1_val': 0.7117076967360673, 'auprc': 0.72754449022113, 'loss_val': 0.562814426726351, 'psi': 0.7180424141300923}
[S14] START round=15 head_norm_before_train=0.906770 cos_to_last_merge=0.9957 (last merge round=13)
[S14] round=15 local utility u=0.049996 metrics={'f1_val': 0.9970198446089119, 'auprc': 0.9955048742981842, 'loss_val': 0.4001516415776848, 'psi': 0.9964138564846208}-{'f1_val': 0.9968300801588782, 'auprc': 0.995543174219524, 'loss_val': 0.499120392739231, 'psi': 0.9963153177831365}
[S15] START round=15 head_norm_before_train=1.012664 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000438 metrics={'f1_val': 0.7011987072828788, 'auprc': 0.798826626985805, 'loss_val': 0.46223807103453185, 'psi': 0.7402498751640493}-{'f1_val': 0.6990576051082278, 'auprc': 0.799649193058692, 'loss_val': 0.45273482983850666, 'psi': 0.7392942402884135}
[S16] START round=15 head_norm_before_train=0.813801 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.449459 metrics={'f1_val': 0.5881918316978975, 'auprc': 0.9069383814752505, 'loss_val': 0.7081135965231716, 'psi': 0.7156904516088387}-{'f1_val': 0.49496957549297954, 'auprc': 0.8074466591898128, 'loss_val': 0.7492238836467552, 'psi': 0.6199604089717128}
[S17] START round=15 head_norm_before_train=1.335231 cos_to_last_merge=0.8603 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.860
[S17] round=15 local utility u=0.141606 metrics={'f1_val': 0.44439031920804917, 'auprc': 0.6744168158955685, 'loss_val': 0.8719412955822797, 'psi': 0.5364009178830569}-{'f1_val': 0.35406388426773305, 'auprc': 0.7720549925384228, 'loss_val': 0.9061098300430558, 'psi': 0.521260327576009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S15] not sending this round → trigger blocked (psi=0.740)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.819)
[S11] not sending this round → trigger blocked (psi=0.820)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.975)
[S2] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.6115
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9169
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.5360
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.3515
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9970 head_norm=0.968643
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.936913e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9966 head_norm=0.897119 delta_norm=0.193691
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.262 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.149 → S3@127.0.0.1:44903
[S11] ⇄ pheromone p=0.174 → S15@127.0.0.1:44915
[S13] ⇄ pheromone p=0.178 → S10@127.0.0.1:44911
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.9608 head_norm=1.339250
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.644871e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.9604 head_norm=1.103577 delta_norm=0.764487
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.251 → S2@127.0.0.1:44902
[S5] ⇄ pheromone p=0.131 → S16@127.0.0.1:44916
[S10] ⇄ pheromone p=0.163 → S9@127.0.0.1:44910
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7011 head_norm=1.016913
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.512552e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7011 head_norm=0.807800 delta_norm=0.451255
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.089 → S16@127.0.0.1:44916
[S4] ⇄ pheromone p=0.341 → S11@127.0.0.1:44912
[S2] ⇄ pheromone p=0.188 → S15@127.0.0.1:44915
[S6] ⇄ pheromone p=0.184 → S8@127.0.0.1:44909
[S16] ⇄ pheromone p=0.260 → S14@127.0.0.1:44914
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7942 head_norm=0.823548
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.944319e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7011 head_norm=0.934170 delta_norm=0.494432
[S8] aggregate: ROLLBACK (f1_val pre=0.794 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.260 → S9@127.0.0.1:44910
[S15] ⇄ pheromone p=0.191 → S5@127.0.0.1:44905
[S17] ⇄ pheromone p=0.153 → S3@127.0.0.1:44903
[S2] START round=16 head_norm_before_train=1.189632 cos_to_last_merge=0.9979 (last merge round=14)
[S2] round=16 local utility u=0.021730 metrics={'f1_val': 0.7055241613995358, 'auprc': 0.7925656492588267, 'loss_val': 0.4519532265637807, 'psi': 0.7403407565432522}-{'f1_val': 0.6994869488365228, 'auprc': 0.7967123990543056, 'loss_val': 0.4716299220370218, 'psi': 0.738377128923636}
[S3] START round=16 head_norm_before_train=1.103577 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9958687637653431, 'loss_val': 0.21142833055871837, 'psi': 0.9748396973676179}-{'f1_val': 0.9608203197691346, 'auprc': 0.9972487168021953, 'loss_val': 0.19532109606387998, 'psi': 0.9753916785823589}
[S4] START round=16 head_norm_before_train=1.718760 (no previous merge yet)
[S4] round=16 local utility u=0.120150 metrics={'f1_val': 0.9434061185017985, 'auprc': 0.9431405131985988, 'loss_val': 0.33899142229405177, 'psi': 0.9432998763805185}-{'f1_val': 0.9387914878425291, 'auprc': 0.9198148431792745, 'loss_val': 0.4816266837808559, 'psi': 0.9312008299772273}
[S5] START round=16 head_norm_before_train=1.043364 cos_to_last_merge=0.9918 (last merge round=14)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013452551577593, 'auprc': 0.8925130106087523, 'loss_val': 0.33330298674189734, 'psi': 0.7778123573381566}-{'f1_val': 0.7011113551819586, 'auprc': 0.9141532040992589, 'loss_val': 0.3615456620742504, 'psi': 0.7863280947488787}
[S6] START round=16 head_norm_before_train=1.247414 cos_to_last_merge=0.8580 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=16 local utility u=0.153703 metrics={'f1_val': 0.748305289230768, 'auprc': 0.9551498063764299, 'loss_val': 0.33572008903933603, 'psi': 0.8310430960890327}-{'f1_val': 0.707965357556047, 'auprc': 0.9451385669649957, 'loss_val': 0.37105375119536177, 'psi': 0.8028346413196265}
[S7] START round=16 head_norm_before_train=1.613095 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.617549176192069, 'auprc': 0.7865651892388474, 'loss_val': 0.6133410500949217, 'psi': 0.6851555814107804}-{'f1_val': 0.6436276523959963, 'auprc': 0.7927006878973402, 'loss_val': 0.5471999734811668, 'psi': 0.7032568665965339}
[S8] START round=16 head_norm_before_train=0.934170 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005569767710973, 'auprc': 0.9977808940623177, 'loss_val': 0.4087383063711635, 'psi': 0.8194465436875855}-{'f1_val': 0.7941658841060869, 'auprc': 0.9961208159033414, 'loss_val': 0.5187339770154203, 'psi': 0.8749478568249887}
[S9] START round=16 head_norm_before_train=0.807800 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.012386 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9985947613613426, 'loss_val': 0.26694504768690314, 'psi': 0.8201065084398068}-{'f1_val': 0.7011143398254496, 'auprc': 0.9992241622172172, 'loss_val': 0.29360600127918257, 'psi': 0.8203582687821567}
[S10] START round=16 head_norm_before_train=1.222744 cos_to_last_merge=0.9932 (last merge round=13)
[S10] round=16 local utility u=0.832243 metrics={'f1_val': 0.9864323788213987, 'auprc': 0.9808821671061239, 'loss_val': 0.29434263914168013, 'psi': 0.9842122941352887}-{'f1_val': 0.699260083987036, 'auprc': 0.997360400391174, 'loss_val': 0.28522927925902475, 'psi': 0.8185002105486912}
[S11] START round=16 head_norm_before_train=1.646467 cos_to_last_merge=0.9997 (last merge round=14)
[S11] round=16 local utility u=0.020944 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9979815888142383, 'loss_val': 0.25403611049550645, 'psi': 0.8201696048642382}-{'f1_val': 0.7016934795869249, 'auprc': 0.9981509673077895, 'loss_val': 0.296822533202237, 'psi': 0.8202764746752707}
[S13] START round=16 head_norm_before_train=1.236368 cos_to_last_merge=0.8780 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=16 local utility u=0.071325 metrics={'f1_val': 0.6808510797474665, 'auprc': 0.6749878381358724, 'loss_val': 0.5564569612753214, 'psi': 0.6785057831028289}-{'f1_val': 0.6305768112032755, 'auprc': 0.7373998951731511, 'loss_val': 0.5846965672752009, 'psi': 0.6733060447912258}
[S14] START round=16 head_norm_before_train=0.897119 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9727037890224178, 'auprc': 0.9954882906025617, 'loss_val': 0.4022239889264938, 'psi': 0.9818175896544754}-{'f1_val': 0.9970198446089119, 'auprc': 0.9955048742981842, 'loss_val': 0.4001516415776848, 'psi': 0.9964138564846208}
[S15] START round=16 head_norm_before_train=1.058654 cos_to_last_merge=0.9980 (last merge round=14)
[S15] round=16 local utility u=0.199709 metrics={'f1_val': 0.6748155231540343, 'auprc': 0.9733174462337364, 'loss_val': 0.42799296122909597, 'psi': 0.7942162923859151}-{'f1_val': 0.7011987072828788, 'auprc': 0.798826626985805, 'loss_val': 0.46223807103453185, 'psi': 0.7402498751640493}
[S16] START round=16 head_norm_before_train=0.863950 cos_to_last_merge=0.9974 (last merge round=14)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.908309287360612, 'auprc': 0.9605848260791483, 'loss_val': 0.5506074900286547, 'psi': 0.9292195028480265}-{'f1_val': 0.5881918316978975, 'auprc': 0.9069383814752505, 'loss_val': 0.7081135965231716, 'psi': 0.7156904516088387}
[S17] START round=16 head_norm_before_train=1.345754 cos_to_last_merge=0.8550 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.855
[S17] round=16 local utility u=0.060883 metrics={'f1_val': 0.38448985606370806, 'auprc': 0.7944851081627248, 'loss_val': 0.7509766073704676, 'psi': 0.5484879569033148}-{'f1_val': 0.44439031920804917, 'auprc': 0.6744168158955685, 'loss_val': 0.8719412955822797, 'psi': 0.5364009178830569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S16] not sending this round → trigger blocked (psi=0.929)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:44912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.831)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:44911
[S4] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S11
[S15] cosine check vs S11: cos=0.8553
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.9840
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9217
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.8283
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.7952
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=0.3999
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.6413
[S17] not sending this round → trigger blocked (psi=0.548)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7013 head_norm=1.131643
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.285911e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7011 head_norm=1.071648 delta_norm=0.328591
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9864 head_norm=1.261359
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.495049e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9806 head_norm=1.236287 delta_norm=0.249505
[S10] aggregate: ROLLBACK (f1_val pre=0.986 post=0.981 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6748 head_norm=1.110040
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.806507e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6996 head_norm=1.049361 delta_norm=0.180651
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7011 head_norm=0.885168
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.853871e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9955 head_norm=0.975538 delta_norm=0.485387
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7016 head_norm=1.673160
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.561293e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7016 head_norm=1.698922 delta_norm=0.156129
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.9083 head_norm=0.920263
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.893217e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.9176 head_norm=0.855276 delta_norm=0.289322
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.235397 cos_to_last_merge=0.9921 (last merge round=14)
[S2] round=17 local utility u=0.039782 metrics={'f1_val': 0.6997283782255963, 'auprc': 0.8000442623213257, 'loss_val': 0.3600508984664371, 'psi': 0.7398547318638882}-{'f1_val': 0.7055241613995358, 'auprc': 0.7925656492588267, 'loss_val': 0.4519532265637807, 'psi': 0.7403407565432522}
[S3] START round=17 head_norm_before_train=1.197390 cos_to_last_merge=0.9950 (last merge round=15)
[S3] round=17 local utility u=0.077765 metrics={'f1_val': 0.9742375226641142, 'auprc': 0.9969658310926819, 'loss_val': 0.13969351092177773, 'psi': 0.9833288460355414}-{'f1_val': 0.9608203197691346, 'auprc': 0.9958687637653431, 'loss_val': 0.21142833055871837, 'psi': 0.9748396973676179}
[S4] START round=17 head_norm_before_train=1.738378 (no previous merge yet)
[S4] round=17 local utility u=0.074994 metrics={'f1_val': 0.9537304521136022, 'auprc': 0.9621070240105496, 'loss_val': 0.3078492862023388, 'psi': 0.9570810808723811}-{'f1_val': 0.9434061185017985, 'auprc': 0.9431405131985988, 'loss_val': 0.33899142229405177, 'psi': 0.9432998763805185}
[S5] START round=17 head_norm_before_train=1.071648 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7030433628412185, 'auprc': 0.8956610464131654, 'loss_val': 0.3559182000200859, 'psi': 0.7800904362699972}-{'f1_val': 0.7013452551577593, 'auprc': 0.8925130106087523, 'loss_val': 0.33330298674189734, 'psi': 0.7778123573381566}
[S6] START round=17 head_norm_before_train=1.267311 cos_to_last_merge=0.8539 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=17 local utility u=0.530096 metrics={'f1_val': 0.9355779818138663, 'auprc': 0.9443537411520644, 'loss_val': 0.36677666409345555, 'psi': 0.9390882855491456}-{'f1_val': 0.748305289230768, 'auprc': 0.9551498063764299, 'loss_val': 0.33572008903933603, 'psi': 0.8310430960890327}
[S7] START round=17 head_norm_before_train=1.627891 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.39830276281653854, 'auprc': 0.7778279719873462, 'loss_val': 1.220456719439512, 'psi': 0.5501128464848616}-{'f1_val': 0.617549176192069, 'auprc': 0.7865651892388474, 'loss_val': 0.6133410500949217, 'psi': 0.6851555814107804}
[S8] START round=17 head_norm_before_train=0.986663 cos_to_last_merge=0.9972 (last merge round=15)
[S8] round=17 local utility u=0.063772 metrics={'f1_val': 0.713916700902738, 'auprc': 0.995923147174156, 'loss_val': 0.35577957987077696, 'psi': 0.8267192794113052}-{'f1_val': 0.7005569767710973, 'auprc': 0.9977808940623177, 'loss_val': 0.4087383063711635, 'psi': 0.8194465436875855}
[S9] START round=17 head_norm_before_train=0.975538 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.884438 metrics={'f1_val': 0.9968787045289869, 'auprc': 0.9989188024862891, 'loss_val': 0.2736273653776617, 'psi': 0.9976947437119077}-{'f1_val': 0.7011143398254496, 'auprc': 0.9985947613613426, 'loss_val': 0.26694504768690314, 'psi': 0.8201065084398068}
[S10] START round=17 head_norm_before_train=1.236287 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.954457882139211, 'auprc': 0.9635617689510428, 'loss_val': 0.35129102042486554, 'psi': 0.9580994368639437}-{'f1_val': 0.9864323788213987, 'auprc': 0.9808821671061239, 'loss_val': 0.29434263914168013, 'psi': 0.9842122941352887}
[S11] START round=17 head_norm_before_train=1.698922 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.520949 metrics={'f1_val': 0.8712917882332923, 'auprc': 0.9980669149274518, 'loss_val': 0.23037517072488334, 'psi': 0.9220018389109561}-{'f1_val': 0.7016282822309048, 'auprc': 0.9979815888142383, 'loss_val': 0.25403611049550645, 'psi': 0.8201696048642382}
[S13] START round=17 head_norm_before_train=1.261067 cos_to_last_merge=0.8719 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.872
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5652569109491893, 'auprc': 0.7509084931531593, 'loss_val': 0.7010103689130052, 'psi': 0.6395175438307773}-{'f1_val': 0.6808510797474665, 'auprc': 0.6749878381358724, 'loss_val': 0.5564569612753214, 'psi': 0.6785057831028289}
[S14] START round=17 head_norm_before_train=0.957009 cos_to_last_merge=0.9967 (last merge round=15)
[S14] round=17 local utility u=0.113734 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.995902633994584, 'loss_val': 0.3217606880740554, 'psi': 0.9965595584924327}-{'f1_val': 0.9727037890224178, 'auprc': 0.9954882906025617, 'loss_val': 0.4022239889264938, 'psi': 0.9818175896544754}
[S15] START round=17 head_norm_before_train=1.049361 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7007438455271788, 'auprc': 0.8041134040007504, 'loss_val': 0.41707660582618455, 'psi': 0.7420916689166075}-{'f1_val': 0.6748155231540343, 'auprc': 0.9733174462337364, 'loss_val': 0.42799296122909597, 'psi': 0.7942162923859151}
[S16] START round=17 head_norm_before_train=0.855276 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.058127 metrics={'f1_val': 0.9030380032456558, 'auprc': 0.9780013905224252, 'loss_val': 0.45497449859813954, 'psi': 0.9330233581563635}-{'f1_val': 0.908309287360612, 'auprc': 0.9605848260791483, 'loss_val': 0.5506074900286547, 'psi': 0.9292195028480265}
[S17] START round=17 head_norm_before_train=1.360771 cos_to_last_merge=0.8497 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.850
[S17] round=17 local utility u=0.666360 metrics={'f1_val': 0.5446248192442802, 'auprc': 0.8758195388634475, 'loss_val': 0.6230705967345634, 'psi': 0.6771027070919471}-{'f1_val': 0.38448985606370806, 'auprc': 0.7944851081627248, 'loss_val': 0.7509766073704676, 'psi': 0.5484879569033148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S9] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.957)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:44902
[S11] not sending this round → trigger blocked (psi=0.922)
[S2] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44914
[S3] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1806) from S3
[S2] cosine check vs S3: cos=0.9147
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.3735
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9087
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.4281
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.9212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.7703
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9969 head_norm=1.043494
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.837813e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9956 head_norm=0.864421 delta_norm=0.583781
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.6997 head_norm=1.281077
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.651608e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.6992 head_norm=1.256178 delta_norm=0.265161
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9970 head_norm=1.017794
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.983738e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9966 head_norm=0.946735 delta_norm=0.198374
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7139 head_norm=1.042674
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.950649e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7129 head_norm=0.934390 delta_norm=0.195065
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.9742 head_norm=1.286635
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.544016e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.9611 head_norm=1.255543 delta_norm=0.454402
[S3] aggregate: ROLLBACK (f1_val pre=0.974 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.256178 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6944643127638035, 'auprc': 0.6606840519171713, 'loss_val': 0.41300159816172693, 'psi': 0.6809522084251506}-{'f1_val': 0.6997283782255963, 'auprc': 0.8000442623213257, 'loss_val': 0.3600508984664371, 'psi': 0.7398547318638882}
[S3] START round=18 head_norm_before_train=1.255543 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.9969880255434944, 'loss_val': 0.164388761434089, 'psi': 0.9827818792878766}-{'f1_val': 0.9742375226641142, 'auprc': 0.9969658310926819, 'loss_val': 0.13969351092177773, 'psi': 0.9833288460355414}
[S4] START round=18 head_norm_before_train=1.754284 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.949223896739029, 'auprc': 0.9051233801321519, 'loss_val': 0.3081134591051574, 'psi': 0.9315836900962782}-{'f1_val': 0.9537304521136022, 'auprc': 0.9621070240105496, 'loss_val': 0.3078492862023388, 'psi': 0.9570810808723811}
[S5] START round=18 head_norm_before_train=1.148100 cos_to_last_merge=0.9941 (last merge round=16)
[S5] round=18 local utility u=0.189995 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.991420266684342, 'loss_val': 0.24859582215312973, 'psi': 0.8169331422713414}-{'f1_val': 0.7030433628412185, 'auprc': 0.8956610464131654, 'loss_val': 0.3559182000200859, 'psi': 0.7800904362699972}
[S6] START round=18 head_norm_before_train=1.283166 cos_to_last_merge=0.8500 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7478301944217647, 'auprc': 0.8479608369105972, 'loss_val': 0.3849216767930245, 'psi': 0.7878824514172977}-{'f1_val': 0.9355779818138663, 'auprc': 0.9443537411520644, 'loss_val': 0.36677666409345555, 'psi': 0.9390882855491456}
[S7] START round=18 head_norm_before_train=1.642146 (no previous merge yet)
[S7] round=18 local utility u=1.000000 metrics={'f1_val': 0.6725789424658644, 'auprc': 0.8248190890961945, 'loss_val': 0.40260001286424263, 'psi': 0.7334750011179965}-{'f1_val': 0.39830276281653854, 'auprc': 0.7778279719873462, 'loss_val': 1.220456719439512, 'psi': 0.5501128464848616}
[S8] START round=18 head_norm_before_train=0.934390 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.851979 metrics={'f1_val': 0.9949617501392418, 'auprc': 0.9967132965153708, 'loss_val': 0.34046216120854944, 'psi': 0.9956623686896934}-{'f1_val': 0.713916700902738, 'auprc': 0.995923147174156, 'loss_val': 0.35577957987077696, 'psi': 0.8267192794113052}
[S9] START round=18 head_norm_before_train=0.864421 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000296 metrics={'f1_val': 0.9918759217110472, 'auprc': 0.9984655440788364, 'loss_val': 0.24165983875349725, 'psi': 0.9945117706581629}-{'f1_val': 0.9968787045289869, 'auprc': 0.9989188024862891, 'loss_val': 0.2736273653776617, 'psi': 0.9976947437119077}
[S10] START round=18 head_norm_before_train=1.259956 cos_to_last_merge=0.9995 (last merge round=16)
[S10] round=18 local utility u=0.172337 metrics={'f1_val': 0.9922818858191379, 'auprc': 0.98408333961335, 'loss_val': 0.29512479686100973, 'psi': 0.9890024673368227}-{'f1_val': 0.954457882139211, 'auprc': 0.9635617689510428, 'loss_val': 0.35129102042486554, 'psi': 0.9580994368639437}
[S11] START round=18 head_norm_before_train=1.724044 cos_to_last_merge=0.9997 (last merge round=16)
[S11] round=18 local utility u=0.270360 metrics={'f1_val': 0.9546920174580756, 'auprc': 0.9978287955384749, 'loss_val': 0.18934181270419706, 'psi': 0.9719467286902355}-{'f1_val': 0.8712917882332923, 'auprc': 0.9980669149274518, 'loss_val': 0.23037517072488334, 'psi': 0.9220018389109561}
[S13] START round=18 head_norm_before_train=1.290463 cos_to_last_merge=0.8643 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.864
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.39027222529410227, 'auprc': 0.5615959347986637, 'loss_val': 0.794373058472515, 'psi': 0.4588017090959268}-{'f1_val': 0.5652569109491893, 'auprc': 0.7509084931531593, 'loss_val': 0.7010103689130052, 'psi': 0.6395175438307773}
[S14] START round=18 head_norm_before_train=0.946735 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.007265 metrics={'f1_val': 0.997240356705793, 'auprc': 0.995462005873321, 'loss_val': 0.30736585536435496, 'psi': 0.9965290163728042}-{'f1_val': 0.9969975081576651, 'auprc': 0.995902633994584, 'loss_val': 0.3217606880740554, 'psi': 0.9965595584924327}
[S15] START round=18 head_norm_before_train=1.095553 cos_to_last_merge=0.9985 (last merge round=16)
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9903631294149148, 'auprc': 0.9947165222617185, 'loss_val': 0.24666624332831333, 'psi': 0.9921044865536363}-{'f1_val': 0.7007438455271788, 'auprc': 0.8041134040007504, 'loss_val': 0.41707660582618455, 'psi': 0.7420916689166075}
[S16] START round=18 head_norm_before_train=0.914010 cos_to_last_merge=0.9972 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8245486486330866, 'auprc': 0.8714179036384782, 'loss_val': 0.7294683698594848, 'psi': 0.8432963506352433}-{'f1_val': 0.9030380032456558, 'auprc': 0.9780013905224252, 'loss_val': 0.45497449859813954, 'psi': 0.9330233581563635}
[S17] START round=18 head_norm_before_train=1.382138 cos_to_last_merge=0.8445 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.845
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.46381422749506435, 'auprc': 0.9290228614612739, 'loss_val': 0.5991285585852134, 'psi': 0.6498976810815482}-{'f1_val': 0.5446248192442802, 'auprc': 0.8758195388634475, 'loss_val': 0.6230705967345634, 'psi': 0.6771027070919471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=0.3029
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.5201
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.8138
[S15] RECEIVED delta(kind=head bytes=1804) from S11
[S15] cosine check vs S11: cos=0.8228
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.8793
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.5564
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9733 head_norm=1.331640
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.887278e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9733 head_norm=1.206000 delta_norm=0.888728
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9919 head_norm=0.954681
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.461559e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9942 head_norm=0.989563 delta_norm=0.546156
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9904 head_norm=1.141441
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.196649e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9928 head_norm=1.383664 delta_norm=0.519665
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=1.213126
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.912573e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.141249 delta_norm=0.291257
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8245 head_norm=0.974159
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.802348e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8243 head_norm=0.874246 delta_norm=0.280235
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.291018 cos_to_last_merge=0.9992 (last merge round=17)
[S2] round=19 local utility u=0.117826 metrics={'f1_val': 0.6992436116856497, 'auprc': 0.7117374326555805, 'loss_val': 0.35918538977155007, 'psi': 0.7042411400736222}-{'f1_val': 0.6944643127638035, 'auprc': 0.6606840519171713, 'loss_val': 0.41300159816172693, 'psi': 0.6809522084251506}
[S3] START round=19 head_norm_before_train=1.206000 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.002297 metrics={'f1_val': 0.9721635215590747, 'auprc': 0.995901800348881, 'loss_val': 0.14965139160140326, 'psi': 0.9816588330749971}-{'f1_val': 0.9733111151174647, 'auprc': 0.9969880255434944, 'loss_val': 0.164388761434089, 'psi': 0.9827818792878766}
[S4] START round=19 head_norm_before_train=1.768866 (no previous merge yet)
[S4] round=19 local utility u=0.038508 metrics={'f1_val': 0.948104265321264, 'auprc': 0.9301118889266096, 'loss_val': 0.2993454829790255, 'psi': 0.9409073147634023}-{'f1_val': 0.949223896739029, 'auprc': 0.9051233801321519, 'loss_val': 0.3081134591051574, 'psi': 0.9315836900962782}
[S5] START round=19 head_norm_before_train=1.141249 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.708363752538316, 'auprc': 0.868901247559476, 'loss_val': 0.3980179607357728, 'psi': 0.7725787505467799}-{'f1_val': 0.7006083926626743, 'auprc': 0.991420266684342, 'loss_val': 0.24859582215312973, 'psi': 0.8169331422713414}
[S6] START round=19 head_norm_before_train=1.298145 cos_to_last_merge=0.8463 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=19 local utility u=0.764299 metrics={'f1_val': 0.9422129279141196, 'auprc': 0.9505790856806895, 'loss_val': 0.3304740913280053, 'psi': 0.9455593910207475}-{'f1_val': 0.7478301944217647, 'auprc': 0.8479608369105972, 'loss_val': 0.3849216767930245, 'psi': 0.7878824514172977}
[S7] START round=19 head_norm_before_train=1.647812 (no previous merge yet)
[S7] round=19 local utility u=0.132322 metrics={'f1_val': 0.6870637364906422, 'auprc': 0.8579757110131709, 'loss_val': 0.3243355487618943, 'psi': 0.7554285262996537}-{'f1_val': 0.6725789424658644, 'auprc': 0.8248190890961945, 'loss_val': 0.40260001286424263, 'psi': 0.7334750011179965}
[S8] START round=19 head_norm_before_train=0.985518 cos_to_last_merge=0.9982 (last merge round=17)
[S8] round=19 local utility u=0.034003 metrics={'f1_val': 0.9952482736021975, 'auprc': 0.9970659703835357, 'loss_val': 0.27523249565439994, 'psi': 0.9959753523147328}-{'f1_val': 0.9949617501392418, 'auprc': 0.9967132965153708, 'loss_val': 0.34046216120854944, 'psi': 0.9956623686896934}
[S9] START round=19 head_norm_before_train=0.989563 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.018823 metrics={'f1_val': 0.9968787045289869, 'auprc': 0.9986189007986557, 'loss_val': 0.2344905107636626, 'psi': 0.9975747830368543}-{'f1_val': 0.9918759217110472, 'auprc': 0.9984655440788364, 'loss_val': 0.24165983875349725, 'psi': 0.9945117706581629}
[S10] START round=19 head_norm_before_train=1.282040 cos_to_last_merge=0.9982 (last merge round=16)
[S10] round=19 local utility u=0.061145 metrics={'f1_val': 0.9923654114188125, 'auprc': 0.9976028741727201, 'loss_val': 0.2138941125634447, 'psi': 0.9944603965203755}-{'f1_val': 0.9922818858191379, 'auprc': 0.98408333961335, 'loss_val': 0.29512479686100973, 'psi': 0.9890024673368227}
[S11] START round=19 head_norm_before_train=1.751076 cos_to_last_merge=0.9985 (last merge round=16)
[S11] round=19 local utility u=0.040634 metrics={'f1_val': 0.9608575485973375, 'auprc': 0.9978441426405082, 'loss_val': 0.1451126186473652, 'psi': 0.9756521862146058}-{'f1_val': 0.9546920174580756, 'auprc': 0.9978287955384749, 'loss_val': 0.18934181270419706, 'psi': 0.9719467286902355}
[S13] START round=19 head_norm_before_train=1.310142 cos_to_last_merge=0.8595 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=19 local utility u=0.878821 metrics={'f1_val': 0.621546138497417, 'auprc': 0.6247850324520795, 'loss_val': 0.6139409521718334, 'psi': 0.622841696079282}-{'f1_val': 0.39027222529410227, 'auprc': 0.5615959347986637, 'loss_val': 0.794373058472515, 'psi': 0.4588017090959268}
[S14] START round=19 head_norm_before_train=1.010197 cos_to_last_merge=0.9975 (last merge round=17)
[S14] round=19 local utility u=0.042894 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9951651892059113, 'loss_val': 0.2206491705972249, 'psi': 0.9964064110247106}-{'f1_val': 0.997240356705793, 'auprc': 0.995462005873321, 'loss_val': 0.30736585536435496, 'psi': 0.9965290163728042}
[S15] START round=19 head_norm_before_train=1.383664 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6933981663391718, 'auprc': 0.7276387761536812, 'loss_val': 0.42859511884933355, 'psi': 0.7070944102649757}-{'f1_val': 0.9903631294149148, 'auprc': 0.9947165222617185, 'loss_val': 0.24666624332831333, 'psi': 0.9921044865536363}
[S16] START round=19 head_norm_before_train=0.874246 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.171824 metrics={'f1_val': 0.8308487754813374, 'auprc': 0.9192713356027091, 'loss_val': 0.5671813348938709, 'psi': 0.8662177995298861}-{'f1_val': 0.8245486486330866, 'auprc': 0.8714179036384782, 'loss_val': 0.7294683698594848, 'psi': 0.8432963506352433}
[S17] START round=19 head_norm_before_train=1.410065 cos_to_last_merge=0.8400 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=19 local utility u=0.176685 metrics={'f1_val': 0.5162867662844872, 'auprc': 0.9281820445060665, 'loss_val': 0.5580711582651194, 'psi': 0.6810448775731189}-{'f1_val': 0.46381422749506435, 'auprc': 0.9290228614612739, 'loss_val': 0.5991285585852134, 'psi': 0.6498976810815482}
[S11] not sending this round → trigger blocked (psi=0.976)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:44911
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[S7] not sending this round → trigger blocked (psi=0.755)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.8850
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.9193
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.1658
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9587
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=0.5011
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9860
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.5942
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.8561
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.4974
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9969 head_norm=1.068287
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.261335e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9956 head_norm=0.912377 delta_norm=0.526134
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.998 u=0.0188 p_local=0.1549 f1=0.997 auprc=0.999 bytes=16149
[S7] r=20 psi=0.755 u=0.1323 p_local=0.2475 f1=0.687 auprc=0.858 bytes=12563
[S5] r=20 psi=0.773 u=0.0000 p_local=0.0843 f1=0.708 auprc=0.869 bytes=14369
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9924 head_norm=1.303356
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.889511e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9921 head_norm=1.299459 delta_norm=0.188951
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.994 u=0.0611 p_local=0.1918 f1=0.992 auprc=0.998 bytes=16185
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9609 head_norm=1.777188
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.490579e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9946 head_norm=1.775876 delta_norm=0.149058
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.976 u=0.0406 p_local=0.1915 f1=0.961 auprc=0.998 bytes=14404
[S4] r=20 psi=0.941 u=0.0385 p_local=0.1694 f1=0.948 auprc=0.930 bytes=14385
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9972 head_norm=1.075537
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.141867e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9977 head_norm=0.978655 delta_norm=0.214187
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.996 u=0.0429 p_local=0.1315 f1=0.997 auprc=0.995 bytes=16169
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.6992 head_norm=1.327100
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.145085e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.6993 head_norm=1.271701 delta_norm=0.314509
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.704 u=0.1178 p_local=0.1080 f1=0.699 auprc=0.712 bytes=16191
[S6] r=20 psi=0.946 u=0.7643 p_local=0.3119 f1=0.942 auprc=0.951 bytes=14348
[S13] r=20 psi=0.623 u=0.8788 p_local=0.2559 f1=0.622 auprc=0.625 bytes=14376
[S16] r=20 psi=0.866 u=0.1718 p_local=0.2508 f1=0.831 auprc=0.919 bytes=16170
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9952 head_norm=1.037912
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.452435e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9964 head_norm=0.967787 delta_norm=0.145243
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.996 u=0.0340 p_local=0.2576 f1=0.995 auprc=0.997 bytes=16155
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9722 head_norm=1.292704
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.885232e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9612 head_norm=1.183738 delta_norm=0.688523
[S3] aggregate: ROLLBACK (f1_val pre=0.972 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S3] r=20 psi=0.982 u=0.0023 p_local=0.1131 f1=0.972 auprc=0.996 bytes=12604
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6934 head_norm=1.416587
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.866228e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6936 head_norm=1.047786 delta_norm=0.886623
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.707 u=0.0000 p_local=0.2588 f1=0.693 auprc=0.728 bytes=16195
[S17] r=20 psi=0.681 u=0.1767 p_local=0.1897 f1=0.516 auprc=0.928 bytes=16192
[S2] START round=20 head_norm_before_train=1.271701 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.026345 metrics={'f1_val': 0.7125791819694259, 'auprc': 0.7791223633583119, 'loss_val': 0.5886635389657596, 'psi': 0.7391964545249803}-{'f1_val': 0.6992436116856497, 'auprc': 0.7117374326555805, 'loss_val': 0.35918538977155007, 'psi': 0.7042411400736222}
[S3] START round=20 head_norm_before_train=1.183738 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.024330 metrics={'f1_val': 0.9818833816563692, 'auprc': 0.9959376881874895, 'loss_val': 0.15941842435550516, 'psi': 0.9875051042688173}-{'f1_val': 0.9721635215590747, 'auprc': 0.995901800348881, 'loss_val': 0.14965139160140326, 'psi': 0.9816588330749971}
[S4] START round=20 head_norm_before_train=1.787040 (no previous merge yet)
[S4] round=20 local utility u=0.062469 metrics={'f1_val': 0.9513518302180778, 'auprc': 0.9637916491903411, 'loss_val': 0.29493171466718554, 'psi': 0.9563277578069831}-{'f1_val': 0.948104265321264, 'auprc': 0.9301118889266096, 'loss_val': 0.2993454829790255, 'psi': 0.9409073147634023}
[S5] START round=20 head_norm_before_train=1.205531 cos_to_last_merge=0.9962 (last merge round=18)
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9973786309099358, 'loss_val': 0.22101283526784327, 'psi': 0.9970151731450562}-{'f1_val': 0.708363752538316, 'auprc': 0.868901247559476, 'loss_val': 0.3980179607357728, 'psi': 0.7725787505467799}
[S6] START round=20 head_norm_before_train=1.314178 cos_to_last_merge=0.8429 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=20 local utility u=0.094640 metrics={'f1_val': 0.9602908322976584, 'auprc': 0.9566831652405484, 'loss_val': 0.2679741175799341, 'psi': 0.9588477654748144}-{'f1_val': 0.9422129279141196, 'auprc': 0.9505790856806895, 'loss_val': 0.3304740913280053, 'psi': 0.9455593910207475}
[S7] START round=20 head_norm_before_train=1.654180 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6765830369658633, 'auprc': 0.8334753467955214, 'loss_val': 0.35965583133732304, 'psi': 0.7393399608977265}-{'f1_val': 0.6870637364906422, 'auprc': 0.8579757110131709, 'loss_val': 0.3243355487618943, 'psi': 0.7554285262996537}
[S8] START round=20 head_norm_before_train=0.967787 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.995160954146866, 'auprc': 0.9965641286414657, 'loss_val': 0.2765417243596757, 'psi': 0.9957222239447059}-{'f1_val': 0.9952482736021975, 'auprc': 0.9970659703835357, 'loss_val': 0.27523249565439994, 'psi': 0.9959753523147328}
[S9] START round=20 head_norm_before_train=0.912377 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.024701 metrics={'f1_val': 0.9968787045289869, 'auprc': 0.998508435282318, 'loss_val': 0.18475671089868134, 'psi': 0.9975305968303193}-{'f1_val': 0.9968787045289869, 'auprc': 0.9986189007986557, 'loss_val': 0.2344905107636626, 'psi': 0.9975747830368543}
[S10] START round=20 head_norm_before_train=1.299459 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9911086327016032, 'auprc': 0.9970047640595604, 'loss_val': 0.26248085935780263, 'psi': 0.993467085244786}-{'f1_val': 0.9923654114188125, 'auprc': 0.9976028741727201, 'loss_val': 0.2138941125634447, 'psi': 0.9944603965203755}
[S11] START round=20 head_norm_before_train=1.775876 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.103153 metrics={'f1_val': 0.9958050841232382, 'auprc': 0.9980226973764708, 'loss_val': 0.1490280748057124, 'psi': 0.9966921294245312}-{'f1_val': 0.9608575485973375, 'auprc': 0.9978441426405082, 'loss_val': 0.1451126186473652, 'psi': 0.9756521862146058}
[S13] START round=20 head_norm_before_train=1.322821 cos_to_last_merge=0.8561 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5711291020441935, 'auprc': 0.6423713859970541, 'loss_val': 0.7267946920006652, 'psi': 0.5996260156253377}-{'f1_val': 0.621546138497417, 'auprc': 0.6247850324520795, 'loss_val': 0.6139409521718334, 'psi': 0.622841696079282}
[S14] START round=20 head_norm_before_train=0.978655 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9953877790957624, 'loss_val': 0.23918926174150631, 'psi': 0.9966000733393403}-{'f1_val': 0.9972338922372435, 'auprc': 0.9951651892059113, 'loss_val': 0.2206491705972249, 'psi': 0.9964064110247106}
[S15] START round=20 head_norm_before_train=1.047786 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.673787 metrics={'f1_val': 0.7766237813539527, 'auprc': 0.989496866547101, 'loss_val': 0.36594842024679597, 'psi': 0.861773015431212}-{'f1_val': 0.6933981663391718, 'auprc': 0.7276387761536812, 'loss_val': 0.42859511884933355, 'psi': 0.7070944102649757}
[S16] START round=20 head_norm_before_train=0.922227 cos_to_last_merge=0.9983 (last merge round=18)
[S16] round=20 local utility u=0.452943 metrics={'f1_val': 0.9215383217118629, 'auprc': 0.9912219641770345, 'loss_val': 0.4212835680495437, 'psi': 0.9494117786979315}-{'f1_val': 0.8308487754813374, 'auprc': 0.9192713356027091, 'loss_val': 0.5671813348938709, 'psi': 0.8662177995298861}
[S17] START round=20 head_norm_before_train=1.442052 cos_to_last_merge=0.8355 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.45739538606152375, 'auprc': 0.9386798769140616, 'loss_val': 0.5814799424910585, 'psi': 0.6499091824025389}-{'f1_val': 0.5162867662844872, 'auprc': 0.9281820445060665, 'loss_val': 0.5580711582651194, 'psi': 0.6810448775731189}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.988)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:44905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.959)
[S4] not sending this round → trigger blocked (psi=0.956)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.739)
[S16] not sending this round → trigger blocked (psi=0.949)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.7918
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.6690
[S5] RECEIVED delta(kind=head bytes=1807) from S15
[S5] cosine check vs S15: cos=0.8363
[S15] RECEIVED delta(kind=head bytes=1805) from S11
[S15] cosine check vs S11: cos=0.6316
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.092 → S15@127.0.0.1:44915
[S4] ⇄ pheromone p=0.148 → S11@127.0.0.1:44912
[S10] ⇄ pheromone p=0.153 → S9@127.0.0.1:44910
[S6] ⇄ pheromone p=0.268 → S8@127.0.0.1:44909
[S3] ⇄ pheromone p=0.095 → S2@127.0.0.1:44902
[S8] ⇄ pheromone p=0.206 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=0.105 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.198 → S3@127.0.0.1:44903
[S13] ⇄ pheromone p=0.205 → S10@127.0.0.1:44911
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.9968 head_norm=1.262481
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.462498e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.9968 head_norm=1.121953 delta_norm=0.346250
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.267 → S16@127.0.0.1:44916
[S9] ⇄ pheromone p=0.129 → S16@127.0.0.1:44916
[S11] ⇄ pheromone p=0.174 → S15@127.0.0.1:44915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.7766 head_norm=1.078645
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.989307e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.7944 head_norm=1.309878 delta_norm=0.698931
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.342 → S5@127.0.0.1:44905
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9215 head_norm=0.973779
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.000589e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9247 head_norm=0.915800 delta_norm=0.200059
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.291 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.152 → S3@127.0.0.1:44903
[S2] START round=21 head_norm_before_train=1.306198 cos_to_last_merge=0.9989 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.69906089742899, 'auprc': 0.699932041059097, 'loss_val': 0.3535216584262489, 'psi': 0.6994093548810327}-{'f1_val': 0.7125791819694259, 'auprc': 0.7791223633583119, 'loss_val': 0.5886635389657596, 'psi': 0.7391964545249803}
[S3] START round=21 head_norm_before_train=1.260537 cos_to_last_merge=0.9968 (last merge round=19)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9963549049768925, 'loss_val': 0.164925965871667, 'psi': 0.9748845464121325}-{'f1_val': 0.9818833816563692, 'auprc': 0.9959376881874895, 'loss_val': 0.15941842435550516, 'psi': 0.9875051042688173}
[S4] START round=21 head_norm_before_train=1.805896 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9489369586458646, 'auprc': 0.9563483205889309, 'loss_val': 0.296018685704746, 'psi': 0.9519015034230911}-{'f1_val': 0.9513518302180778, 'auprc': 0.9637916491903411, 'loss_val': 0.29493171466718554, 'psi': 0.9563277578069831}
[S5] START round=21 head_norm_before_train=1.121953 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.8721253043292283, 'auprc': 0.9891633679968223, 'loss_val': 0.2946847250158901, 'psi': 0.9189405297962658}-{'f1_val': 0.9967728679684698, 'auprc': 0.9973786309099358, 'loss_val': 0.22101283526784327, 'psi': 0.9970151731450562}
[S6] START round=21 head_norm_before_train=1.335574 cos_to_last_merge=0.8382 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7833692613862546, 'auprc': 0.8086281271908589, 'loss_val': 0.4568161914025804, 'psi': 0.7934728077080964}-{'f1_val': 0.9602908322976584, 'auprc': 0.9566831652405484, 'loss_val': 0.2679741175799341, 'psi': 0.9588477654748144}
[S7] START round=21 head_norm_before_train=1.663684 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5730294319709364, 'auprc': 0.7806751616311272, 'loss_val': 0.788944096049739, 'psi': 0.6560877238350127}-{'f1_val': 0.6765830369658633, 'auprc': 0.8334753467955214, 'loss_val': 0.35965583133732304, 'psi': 0.7393399608977265}
[S8] START round=21 head_norm_before_train=1.017314 cos_to_last_merge=0.9987 (last merge round=19)
[S8] round=21 local utility u=0.017473 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9967775181253072, 'loss_val': 0.23526306169350383, 'psi': 0.9951102996702146}-{'f1_val': 0.995160954146866, 'auprc': 0.9965641286414657, 'loss_val': 0.2765417243596757, 'psi': 0.9957222239447059}
[S9] START round=21 head_norm_before_train=1.004980 cos_to_last_merge=0.9940 (last merge round=19)
[S9] round=21 local utility u=0.027660 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9982397289400138, 'loss_val': 0.12847434178003472, 'psi': 0.9974074428313598}-{'f1_val': 0.9968787045289869, 'auprc': 0.998508435282318, 'loss_val': 0.18475671089868134, 'psi': 0.9975305968303193}
[S10] START round=21 head_norm_before_train=1.314826 cos_to_last_merge=0.9997 (last merge round=19)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9924914830162053, 'auprc': 0.987547041339605, 'loss_val': 0.24616314839600556, 'psi': 0.9905137063455651}-{'f1_val': 0.9911086327016032, 'auprc': 0.9970047640595604, 'loss_val': 0.26248085935780263, 'psi': 0.993467085244786}
[S11] START round=21 head_norm_before_train=1.801415 cos_to_last_merge=0.9997 (last merge round=19)
[S11] round=21 local utility u=0.024926 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9980034772861789, 'loss_val': 0.10199809765380982, 'psi': 0.9969724079968451}-{'f1_val': 0.9958050841232382, 'auprc': 0.9980226973764708, 'loss_val': 0.1490280748057124, 'psi': 0.9966921294245312}
[S13] START round=21 head_norm_before_train=1.337607 cos_to_last_merge=0.8531 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=21 local utility u=0.147785 metrics={'f1_val': 0.5980696901508318, 'auprc': 0.6600194602449685, 'loss_val': 0.6458129953809714, 'psi': 0.6228495981884865}-{'f1_val': 0.5711291020441935, 'auprc': 0.6423713859970541, 'loss_val': 0.7267946920006652, 'psi': 0.5996260156253377}
[S14] START round=21 head_norm_before_train=1.039311 cos_to_last_merge=0.9977 (last merge round=19)
[S14] round=21 local utility u=0.026565 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968293343207928, 'loss_val': 0.18791933647914458, 'psi': 0.9969302386229162}-{'f1_val': 0.9974082695017256, 'auprc': 0.9953877790957624, 'loss_val': 0.23918926174150631, 'psi': 0.9966000733393403}
[S15] START round=21 head_norm_before_train=1.309878 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.076214 metrics={'f1_val': 0.7923906614402941, 'auprc': 0.9878050543098978, 'loss_val': 0.3030456942428022, 'psi': 0.8705564185881356}-{'f1_val': 0.7766237813539527, 'auprc': 0.989496866547101, 'loss_val': 0.36594842024679597, 'psi': 0.861773015431212}
[S16] START round=21 head_norm_before_train=0.915800 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.274691 metrics={'f1_val': 0.9894729063503842, 'auprc': 0.9952549241744153, 'loss_val': 0.2916076509142125, 'psi': 0.9917857134799966}-{'f1_val': 0.9215383217118629, 'auprc': 0.9912219641770345, 'loss_val': 0.4212835680495437, 'psi': 0.9494117786979315}
[S17] START round=21 head_norm_before_train=1.470644 cos_to_last_merge=0.8330 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=21 local utility u=0.300467 metrics={'f1_val': 0.5590718498024589, 'auprc': 0.9412833391562964, 'loss_val': 0.5984153079815959, 'psi': 0.711956445543994}-{'f1_val': 0.45739538606152375, 'auprc': 0.9386798769140616, 'loss_val': 0.5814799424910585, 'psi': 0.6499091824025389}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:44910
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:44911
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → trigger blocked (psi=0.871)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.9189
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.6745
[S9] RECEIVED delta(kind=head bytes=1788) from S8
[S9] cosine check vs S8: cos=0.8546
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=0.9817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.8370
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9606 head_norm=1.334792
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.114000e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9596 head_norm=1.356832 delta_norm=0.411400
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9925 head_norm=1.332261
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.291674e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9920 head_norm=1.337520 delta_norm=0.129167
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9969 head_norm=1.092214
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.910587e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9969 head_norm=1.038595 delta_norm=0.291059
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9970 head_norm=1.101902
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.183876e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9970 head_norm=1.015359 delta_norm=0.218388
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9940 head_norm=1.064828
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.373674e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9944 head_norm=0.991329 delta_norm=0.437367
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.342701 cos_to_last_merge=0.9960 (last merge round=19)
[S2] round=22 local utility u=0.068771 metrics={'f1_val': 0.6978033348684121, 'auprc': 0.7397092309428499, 'loss_val': 0.3277666802946898, 'psi': 0.7145656932981872}-{'f1_val': 0.69906089742899, 'auprc': 0.699932041059097, 'loss_val': 0.3535216584262489, 'psi': 0.6994093548810327}
[S3] START round=22 head_norm_before_train=1.356832 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.116358 metrics={'f1_val': 0.9964219183221354, 'auprc': 0.9963460510423946, 'loss_val': 0.14728942656392313, 'psi': 0.9963915714102392}-{'f1_val': 0.9605709740356257, 'auprc': 0.9963549049768925, 'loss_val': 0.164925965871667, 'psi': 0.9748845464121325}
[S4] START round=22 head_norm_before_train=1.818176 (no previous merge yet)
[S4] round=22 local utility u=0.037527 metrics={'f1_val': 0.9534694719465373, 'auprc': 0.9667190464148823, 'loss_val': 0.279270952511056, 'psi': 0.9587693017338753}-{'f1_val': 0.9489369586458646, 'auprc': 0.9563483205889309, 'loss_val': 0.296018685704746, 'psi': 0.9519015034230911}
[S5] START round=22 head_norm_before_train=1.172238 cos_to_last_merge=0.9973 (last merge round=20)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9854809868397062, 'loss_val': 0.3015594149137895, 'psi': 0.814557430333487}-{'f1_val': 0.8721253043292283, 'auprc': 0.9891633679968223, 'loss_val': 0.2946847250158901, 'psi': 0.9189405297962658}
[S6] START round=22 head_norm_before_train=1.356776 cos_to_last_merge=0.8329 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=22 local utility u=0.486397 metrics={'f1_val': 0.8459618715697963, 'auprc': 0.9501093878209546, 'loss_val': 0.2840221191867829, 'psi': 0.8876208780702596}-{'f1_val': 0.7833692613862546, 'auprc': 0.8086281271908589, 'loss_val': 0.4568161914025804, 'psi': 0.7934728077080964}
[S7] START round=22 head_norm_before_train=1.677896 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.46310549473301055, 'auprc': 0.7784853946980368, 'loss_val': 1.0737760678738992, 'psi': 0.589257454719021}-{'f1_val': 0.5730294319709364, 'auprc': 0.7806751616311272, 'loss_val': 0.788944096049739, 'psi': 0.6560877238350127}
[S8] START round=22 head_norm_before_train=0.991329 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.8394625265324809, 'auprc': 0.9855535447831588, 'loss_val': 0.30602230434083033, 'psi': 0.8978989338327521}-{'f1_val': 0.9939988207001527, 'auprc': 0.9967775181253072, 'loss_val': 0.23526306169350383, 'psi': 0.9951102996702146}
[S9] START round=22 head_norm_before_train=1.038595 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9985774426897124, 'loss_val': 0.13372438244316204, 'psi': 0.997045715279429}-{'f1_val': 0.9968525854255906, 'auprc': 0.9982397289400138, 'loss_val': 0.12847434178003472, 'psi': 0.9974074428313598}
[S10] START round=22 head_norm_before_train=1.337520 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.019383 metrics={'f1_val': 0.9942234314013502, 'auprc': 0.995972905768713, 'loss_val': 0.243067118898491, 'psi': 0.9949232211482953}-{'f1_val': 0.9924914830162053, 'auprc': 0.987547041339605, 'loss_val': 0.24616314839600556, 'psi': 0.9905137063455651}
[S11] START round=22 head_norm_before_train=1.827450 cos_to_last_merge=0.9989 (last merge round=19)
[S11] round=22 local utility u=0.015866 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9975337700451208, 'loss_val': 0.07133954740522827, 'psi': 0.9970328203727772}-{'f1_val': 0.9962850284706224, 'auprc': 0.9980034772861789, 'loss_val': 0.10199809765380982, 'psi': 0.9969724079968451}
[S13] START round=22 head_norm_before_train=1.355128 cos_to_last_merge=0.8493 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=22 local utility u=0.118736 metrics={'f1_val': 0.6213558024484394, 'auprc': 0.6713311974298328, 'loss_val': 0.5819924575768313, 'psi': 0.6413459604409968}-{'f1_val': 0.5980696901508318, 'auprc': 0.6600194602449685, 'loss_val': 0.6458129953809714, 'psi': 0.6228495981884865}
[S14] START round=22 head_norm_before_train=1.015359 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9967630443020825, 'loss_val': 0.23752149932539163, 'psi': 0.9965255165842237}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968293343207928, 'loss_val': 0.18791933647914458, 'psi': 0.9969302386229162}
[S15] START round=22 head_norm_before_train=1.345712 cos_to_last_merge=0.9993 (last merge round=20)
[S15] round=22 local utility u=0.459643 metrics={'f1_val': 0.9296028911758871, 'auprc': 0.9912376378177112, 'loss_val': 0.21732999296153332, 'psi': 0.9542567898326167}-{'f1_val': 0.7923906614402941, 'auprc': 0.9878050543098978, 'loss_val': 0.3030456942428022, 'psi': 0.8705564185881356}
[S16] START round=22 head_norm_before_train=0.971136 cos_to_last_merge=0.9975 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9292849000342969, 'auprc': 0.9946477466216663, 'loss_val': 0.36687504248347225, 'psi': 0.9554300386692446}-{'f1_val': 0.9894729063503842, 'auprc': 0.9952549241744153, 'loss_val': 0.2916076509142125, 'psi': 0.9917857134799966}
[S17] START round=22 head_norm_before_train=1.496266 cos_to_last_merge=0.8314 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.47943786619314244, 'auprc': 0.9284287546579677, 'loss_val': 0.5978968049697707, 'psi': 0.6590342215790725}-{'f1_val': 0.5590718498024589, 'auprc': 0.9412833391562964, 'loss_val': 0.5984153079815959, 'psi': 0.711956445543994}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[S13] not sending this round → trigger blocked (psi=0.641)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=0.5745
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] cosine check vs S2: cos=0.2783
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9408
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.8707
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9894
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] cosine check vs S10: cos=0.3516
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.7897
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7006 head_norm=1.226772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.404435e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7004 head_norm=1.262558 delta_norm=0.340444
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9960 head_norm=1.112644
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.114874e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9967 head_norm=1.019111 delta_norm=0.711487
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.8395 head_norm=1.033834
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.773999e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9888 head_norm=1.073699 delta_norm=0.577400
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6978 head_norm=1.376851
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.533181e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.6965 head_norm=1.321386 delta_norm=0.453318
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9967 head_norm=1.853882
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.344182e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9967 head_norm=1.834526 delta_norm=0.134418
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9296 head_norm=1.383813
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.567691e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9330 head_norm=1.240069 delta_norm=0.256769
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.321386 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.015986 metrics={'f1_val': 0.6976195113390002, 'auprc': 0.7599482449766043, 'loss_val': 0.3554091053433163, 'psi': 0.7225510047940418}-{'f1_val': 0.6978033348684121, 'auprc': 0.7397092309428499, 'loss_val': 0.3277666802946898, 'psi': 0.7145656932981872}
[S3] START round=23 head_norm_before_train=1.416827 cos_to_last_merge=0.9977 (last merge round=21)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9966298126741049, 'loss_val': 0.13105343874026948, 'psi': 0.9751202166865013}-{'f1_val': 0.9964219183221354, 'auprc': 0.9963460510423946, 'loss_val': 0.14728942656392313, 'psi': 0.9963915714102392}
[S4] START round=23 head_norm_before_train=1.824891 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9417601420456989, 'auprc': 0.9264335440323889, 'loss_val': 0.2974279472727173, 'psi': 0.9356295028403749}-{'f1_val': 0.9534694719465373, 'auprc': 0.9667190464148823, 'loss_val': 0.279270952511056, 'psi': 0.9587693017338753}
[S5] START round=23 head_norm_before_train=1.262558 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.007007 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9886272965392253, 'loss_val': 0.2969847236241745, 'psi': 0.8158159542132948}-{'f1_val': 0.7006083926626743, 'auprc': 0.9854809868397062, 'loss_val': 0.3015594149137895, 'psi': 0.814557430333487}
[S6] START round=23 head_norm_before_train=1.379720 cos_to_last_merge=0.8276 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6197880779641517, 'auprc': 0.8030032478513371, 'loss_val': 0.5669279620257919, 'psi': 0.6930741459190259}-{'f1_val': 0.8459618715697963, 'auprc': 0.9501093878209546, 'loss_val': 0.2840221191867829, 'psi': 0.8876208780702596}
[S7] START round=23 head_norm_before_train=1.689030 (no previous merge yet)
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6676719410724808, 'auprc': 0.8291822557716869, 'loss_val': 0.39095097857274774, 'psi': 0.7322760669521633}-{'f1_val': 0.46310549473301055, 'auprc': 0.7784853946980368, 'loss_val': 1.0737760678738992, 'psi': 0.589257454719021}
[S8] START round=23 head_norm_before_train=1.073699 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.401399 metrics={'f1_val': 0.972758216132941, 'auprc': 0.9972534404971354, 'loss_val': 0.3380982663201692, 'psi': 0.9825563058786189}-{'f1_val': 0.8394625265324809, 'auprc': 0.9855535447831588, 'loss_val': 0.30602230434083033, 'psi': 0.8978989338327521}
[S9] START round=23 head_norm_before_train=1.019111 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991013473113758, 'loss_val': 0.16855922156432543, 'psi': 0.9972529601108626}-{'f1_val': 0.9960245636725735, 'auprc': 0.9985774426897124, 'loss_val': 0.13372438244316204, 'psi': 0.997045715279429}
[S10] START round=23 head_norm_before_train=1.360745 cos_to_last_merge=0.9993 (last merge round=21)
[S10] round=23 local utility u=0.029086 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9956956449427725, 'loss_val': 0.18038339559409358, 'psi': 0.9944442658483759}-{'f1_val': 0.9942234314013502, 'auprc': 0.995972905768713, 'loss_val': 0.243067118898491, 'psi': 0.9949232211482953}
[S11] START round=23 head_norm_before_train=1.834526 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9962609975859212, 'auprc': 0.9970681126167549, 'loss_val': 0.08147689071817281, 'psi': 0.9965838435982547}-{'f1_val': 0.9966988539245482, 'auprc': 0.9975337700451208, 'loss_val': 0.07133954740522827, 'psi': 0.9970328203727772}
[S13] START round=23 head_norm_before_train=1.378592 cos_to_last_merge=0.8449 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6032444415658796, 'auprc': 0.6726635644008643, 'loss_val': 0.6749142327123516, 'psi': 0.6310120906998735}-{'f1_val': 0.6213558024484394, 'auprc': 0.6713311974298328, 'loss_val': 0.5819924575768313, 'psi': 0.6413459604409968}
[S14] START round=23 head_norm_before_train=1.059890 cos_to_last_merge=0.9988 (last merge round=21)
[S14] round=23 local utility u=0.021626 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9952949119918706, 'loss_val': 0.19611121401147164, 'psi': 0.9965629264977836}-{'f1_val': 0.9963671647723179, 'auprc': 0.9967630443020825, 'loss_val': 0.23752149932539163, 'psi': 0.9965255165842237}
[S15] START round=23 head_norm_before_train=1.240069 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7007438455271788, 'auprc': 0.8215521280815277, 'loss_val': 0.4081598974596042, 'psi': 0.7490671585489184}-{'f1_val': 0.9296028911758871, 'auprc': 0.9912376378177112, 'loss_val': 0.21732999296153332, 'psi': 0.9542567898326167}
[S16] START round=23 head_norm_before_train=1.032624 cos_to_last_merge=0.9911 (last merge round=20)
[S16] round=23 local utility u=0.058150 metrics={'f1_val': 0.9348270497282714, 'auprc': 0.9853968444300614, 'loss_val': 0.2560745462859079, 'psi': 0.9550549676089873}-{'f1_val': 0.9292849000342969, 'auprc': 0.9946477466216663, 'loss_val': 0.36687504248347225, 'psi': 0.9554300386692446}
[S17] START round=23 head_norm_before_train=1.519454 cos_to_last_merge=0.8295 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=23 local utility u=0.687480 metrics={'f1_val': 0.6762503084198361, 'auprc': 0.9634172831467256, 'loss_val': 0.5087773626006104, 'psi': 0.791117098310592}-{'f1_val': 0.47943786619314244, 'auprc': 0.9284287546579677, 'loss_val': 0.5978968049697707, 'psi': 0.6590342215790725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.723)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.6581
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9547
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.5995
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.5854
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.2493
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9272
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9608 head_norm=1.483471
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.225101e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9608 head_norm=1.246572 delta_norm=0.422510
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9960 head_norm=1.099243
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.039663e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9960 head_norm=0.985475 delta_norm=0.503966
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9728 head_norm=1.114428
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.978016e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9826 head_norm=0.994813 delta_norm=0.497802
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9974 head_norm=1.110392
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.658949e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9974 head_norm=1.088744 delta_norm=0.165895
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9348 head_norm=1.092153
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.004637e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9422 head_norm=1.085048 delta_norm=0.500464
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.350494 cos_to_last_merge=0.9994 (last merge round=22)
[S2] round=24 local utility u=0.015899 metrics={'f1_val': 0.7001265733320827, 'auprc': 0.7680841218793454, 'loss_val': 0.36306051750534074, 'psi': 0.7273095927509878}-{'f1_val': 0.6976195113390002, 'auprc': 0.7599482449766043, 'loss_val': 0.3554091053433163, 'psi': 0.7225510047940418}
[S3] START round=24 head_norm_before_train=1.246572 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.118241 metrics={'f1_val': 0.9967321454029545, 'auprc': 0.9966596226159159, 'loss_val': 0.11037026512450963, 'psi': 0.9967031362881391}-{'f1_val': 0.9607804860280988, 'auprc': 0.9966298126741049, 'loss_val': 0.13105343874026948, 'psi': 0.9751202166865013}
[S4] START round=24 head_norm_before_train=1.839327 (no previous merge yet)
[S4] round=24 local utility u=0.016872 metrics={'f1_val': 0.941575342802888, 'auprc': 0.9371018278528971, 'loss_val': 0.29457983758842343, 'psi': 0.9397859368228916}-{'f1_val': 0.9417601420456989, 'auprc': 0.9264335440323889, 'loss_val': 0.2974279472727173, 'psi': 0.9356295028403749}
[S5] START round=24 head_norm_before_train=1.289491 cos_to_last_merge=0.9992 (last merge round=22)
[S5] round=24 local utility u=0.023137 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.9889871903273079, 'loss_val': 0.25230930944109864, 'psi': 0.816011709012048}-{'f1_val': 0.7006083926626743, 'auprc': 0.9886272965392253, 'loss_val': 0.2969847236241745, 'psi': 0.8158159542132948}
[S6] START round=24 head_norm_before_train=1.402034 cos_to_last_merge=0.8234 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9474111280334386, 'auprc': 0.9765401515682343, 'loss_val': 0.19265850065928233, 'psi': 0.9590627374473568}-{'f1_val': 0.6197880779641517, 'auprc': 0.8030032478513371, 'loss_val': 0.5669279620257919, 'psi': 0.6930741459190259}
[S7] START round=24 head_norm_before_train=1.693688 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5403822014812968, 'auprc': 0.7783957612366218, 'loss_val': 0.7517892911256938, 'psi': 0.6355876253834267}-{'f1_val': 0.6676719410724808, 'auprc': 0.8291822557716869, 'loss_val': 0.39095097857274774, 'psi': 0.7322760669521633}
[S8] START round=24 head_norm_before_train=0.994813 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.8539706749320704, 'auprc': 0.9947766177426436, 'loss_val': 0.3017519547195118, 'psi': 0.9102930520562996}-{'f1_val': 0.972758216132941, 'auprc': 0.9972534404971354, 'loss_val': 0.3380982663201692, 'psi': 0.9825563058786189}
[S9] START round=24 head_norm_before_train=0.985475 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.014695 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9954273225505239, 'loss_val': 0.1331380436341907, 'psi': 0.9962824802755639}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991013473113758, 'loss_val': 0.16855922156432543, 'psi': 0.9972529601108626}
[S10] START round=24 head_norm_before_train=1.396691 cos_to_last_merge=0.9963 (last merge round=21)
[S10] round=24 local utility u=0.017153 metrics={'f1_val': 0.9933667052737687, 'auprc': 0.9948426767980991, 'loss_val': 0.14205903331214573, 'psi': 0.9939570938835008}-{'f1_val': 0.9936100131187782, 'auprc': 0.9956956449427725, 'loss_val': 0.18038339559409358, 'psi': 0.9944442658483759}
[S11] START round=24 head_norm_before_train=1.861897 cos_to_last_merge=0.9997 (last merge round=22)
[S11] round=24 local utility u=0.014302 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.998354187747588, 'loss_val': 0.05687580674299099, 'psi': 0.9971126921814086}-{'f1_val': 0.9962609975859212, 'auprc': 0.9970681126167549, 'loss_val': 0.08147689071817281, 'psi': 0.9965838435982547}
[S13] START round=24 head_norm_before_train=1.400694 cos_to_last_merge=0.8401 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.840
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5691803215339133, 'auprc': 0.6900854129359035, 'loss_val': 0.8059974681637248, 'psi': 0.6175423580947094}-{'f1_val': 0.6032444415658796, 'auprc': 0.6726635644008643, 'loss_val': 0.6749142327123516, 'psi': 0.6310120906998735}
[S14] START round=24 head_norm_before_train=1.088744 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.995240847101153, 'loss_val': 0.20691996238886767, 'psi': 0.9965413005414966}-{'f1_val': 0.9974082695017256, 'auprc': 0.9952949119918706, 'loss_val': 0.19611121401147164, 'psi': 0.9965629264977836}
[S15] START round=24 head_norm_before_train=1.277679 cos_to_last_merge=0.9993 (last merge round=22)
[S15] round=24 local utility u=0.260020 metrics={'f1_val': 0.7010056609658452, 'auprc': 0.9762743559761675, 'loss_val': 0.3538579341827212, 'psi': 0.8111131389699742}-{'f1_val': 0.7007438455271788, 'auprc': 0.8215521280815277, 'loss_val': 0.4081598974596042, 'psi': 0.7490671585489184}
[S16] START round=24 head_norm_before_train=1.085048 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8565722867668895, 'auprc': 0.9728618571913235, 'loss_val': 0.6654577472614746, 'psi': 0.903088114936663}-{'f1_val': 0.9348270497282714, 'auprc': 0.9853968444300614, 'loss_val': 0.2560745462859079, 'psi': 0.9550549676089873}
[S17] START round=24 head_norm_before_train=1.544525 cos_to_last_merge=0.8276 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5149288493261862, 'auprc': 0.7794535424638285, 'loss_val': 0.7376894790177897, 'psi': 0.6207387265812432}-{'f1_val': 0.6762503084198361, 'auprc': 0.9634172831467256, 'loss_val': 0.5087773626006104, 'psi': 0.791117098310592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44905
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=0.5137
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.9717
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.6587
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.5015
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] cosine check vs S11: cos=0.8843
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.3948
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9630
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9931
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.8540 head_norm=1.034713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.365881e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9487 head_norm=1.120692 delta_norm=0.536588
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7007 head_norm=1.321935
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.794078e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7007 head_norm=1.307308 delta_norm=0.179408
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7001 head_norm=1.381263
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.638264e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.6997 head_norm=1.337365 delta_norm=0.163826
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9963 head_norm=1.888114
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.114834e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9963 head_norm=1.869112 delta_norm=0.111483
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7010 head_norm=1.317183
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.862445e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7034 head_norm=1.222061 delta_norm=0.186245
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9969 head_norm=1.077991
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.406152e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9969 head_norm=1.099113 delta_norm=0.640615
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8566 head_norm=1.135659
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.531700e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8648 head_norm=0.959112 delta_norm=0.553170
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.337365 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6785381201546982, 'auprc': 0.7731666520599425, 'loss_val': 0.6303166112078694, 'psi': 0.716389532916796}-{'f1_val': 0.7001265733320827, 'auprc': 0.7680841218793454, 'loss_val': 0.36306051750534074, 'psi': 0.7273095927509878}
[S3] START round=25 head_norm_before_train=1.312585 cos_to_last_merge=0.9982 (last merge round=23)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9747179186294904, 'auprc': 0.9976862745819304, 'loss_val': 0.12403324848562582, 'psi': 0.9839052610104664}-{'f1_val': 0.9967321454029545, 'auprc': 0.9966596226159159, 'loss_val': 0.11037026512450963, 'psi': 0.9967031362881391}
[S4] START round=25 head_norm_before_train=1.856623 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9403224551099943, 'auprc': 0.9370328826738804, 'loss_val': 0.2979198144845727, 'psi': 0.9390066261355487}-{'f1_val': 0.941575342802888, 'auprc': 0.9371018278528971, 'loss_val': 0.29457983758842343, 'psi': 0.9397859368228916}
[S5] START round=25 head_norm_before_train=1.307308 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.868889 metrics={'f1_val': 0.9877540734614205, 'auprc': 0.9911222455466583, 'loss_val': 0.2432919850505878, 'psi': 0.9891013422955156}-{'f1_val': 0.7006947214685414, 'auprc': 0.9889871903273079, 'loss_val': 0.25230930944109864, 'psi': 0.816011709012048}
[S6] START round=25 head_norm_before_train=1.420255 cos_to_last_merge=0.8205 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6016995067368202, 'auprc': 0.7474720343391541, 'loss_val': 0.7503646038408404, 'psi': 0.6600085177777537}-{'f1_val': 0.9474111280334386, 'auprc': 0.9765401515682343, 'loss_val': 0.19265850065928233, 'psi': 0.9590627374473568}
[S7] START round=25 head_norm_before_train=1.698237 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4744660804090882, 'auprc': 0.7781732459523094, 'loss_val': 0.8262802872202226, 'psi': 0.5959489466263768}-{'f1_val': 0.5403822014812968, 'auprc': 0.7783957612366218, 'loss_val': 0.7517892911256938, 'psi': 0.6355876253834267}
[S8] START round=25 head_norm_before_train=1.120692 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.473047 metrics={'f1_val': 0.9930461454137609, 'auprc': 0.9967472096943621, 'loss_val': 0.1960221735672359, 'psi': 0.9945265711260014}-{'f1_val': 0.8539706749320704, 'auprc': 0.9947766177426436, 'loss_val': 0.3017519547195118, 'psi': 0.9102930520562996}
[S9] START round=25 head_norm_before_train=1.099113 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.99595444722552, 'loss_val': 0.14846976234824427, 'psi': 0.9964933301455623}-{'f1_val': 0.9968525854255906, 'auprc': 0.9954273225505239, 'loss_val': 0.1331380436341907, 'psi': 0.9962824802755639}
[S10] START round=25 head_norm_before_train=1.440420 cos_to_last_merge=0.9911 (last merge round=21)
[S10] round=25 local utility u=0.022786 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9940420832385729, 'loss_val': 0.10369483296763533, 'psi': 0.9945977452144749}-{'f1_val': 0.9933667052737687, 'auprc': 0.9948426767980991, 'loss_val': 0.14205903331214573, 'psi': 0.9939570938835008}
[S11] START round=25 head_norm_before_train=1.869112 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9986027756829674, 'loss_val': 0.059220795320780284, 'psi': 0.9972121273555604}-{'f1_val': 0.9962850284706224, 'auprc': 0.998354187747588, 'loss_val': 0.05687580674299099, 'psi': 0.9971126921814086}
[S13] START round=25 head_norm_before_train=1.421325 cos_to_last_merge=0.8358 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=25 local utility u=0.231603 metrics={'f1_val': 0.6177434277360996, 'auprc': 0.6728683787604285, 'loss_val': 0.5825183684515433, 'psi': 0.6397934081458312}-{'f1_val': 0.5691803215339133, 'auprc': 0.6900854129359035, 'loss_val': 0.8059974681637248, 'psi': 0.6175423580947094}
[S14] START round=25 head_norm_before_train=1.139002 cos_to_last_merge=0.9985 (last merge round=23)
[S14] round=25 local utility u=0.020842 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9950650785839594, 'loss_val': 0.16470843467256296, 'psi': 0.9964709931346192}-{'f1_val': 0.9974082695017256, 'auprc': 0.995240847101153, 'loss_val': 0.20691996238886767, 'psi': 0.9965413005414966}
[S15] START round=25 head_norm_before_train=1.222061 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.959740 metrics={'f1_val': 0.9866796456192696, 'auprc': 0.9907939027515299, 'loss_val': 0.1919794971363586, 'psi': 0.9883253484721737}-{'f1_val': 0.7010056609658452, 'auprc': 0.9762743559761675, 'loss_val': 0.3538579341827212, 'psi': 0.8111131389699742}
[S16] START round=25 head_norm_before_train=0.959112 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.220012 metrics={'f1_val': 0.8884157800992915, 'auprc': 0.9940750758825786, 'loss_val': 0.4801336991857547, 'psi': 0.9306794984126063}-{'f1_val': 0.8565722867668895, 'auprc': 0.9728618571913235, 'loss_val': 0.6654577472614746, 'psi': 0.903088114936663}
[S17] START round=25 head_norm_before_train=1.573059 cos_to_last_merge=0.8259 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=25 local utility u=0.554112 metrics={'f1_val': 0.6133757748058519, 'auprc': 0.9179450086308657, 'loss_val': 0.6356211929099701, 'psi': 0.7352034683358575}-{'f1_val': 0.5149288493261862, 'auprc': 0.7794535424638285, 'loss_val': 0.7376894790177897, 'psi': 0.6207387265812432}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:44911
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.988)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.6286
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.9360
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.5681
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9654
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.5194
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.8197
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9950 head_norm=1.478958
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.929995e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9950 head_norm=1.445304 delta_norm=0.193000
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.063 → S9@127.0.0.1:44910
[S4] ⇄ pheromone p=0.055 → S11@127.0.0.1:44912
[S11] ⇄ pheromone p=0.063 → S15@127.0.0.1:44915
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9747 head_norm=1.369426
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.578084e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9718 head_norm=1.414172 delta_norm=0.457808
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.062 → S2@127.0.0.1:44902
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9969 head_norm=1.178887
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.739611e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9969 head_norm=1.020411 delta_norm=0.573961
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.047 → S16@127.0.0.1:44916
[S7] ⇄ pheromone p=0.193 → S3@127.0.0.1:44903
[S6] ⇄ pheromone p=0.298 → S8@127.0.0.1:44909
[S2] ⇄ pheromone p=0.042 → S15@127.0.0.1:44915
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.190575
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.153574e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9970 head_norm=1.084824 delta_norm=0.215357
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.044 → S8@127.0.0.1:44909
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8884 head_norm=1.014384
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.281560e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8829 head_norm=1.064668 delta_norm=0.528156
[S16] aggregate: ROLLBACK (f1_val pre=0.888 post=0.883 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.169 → S14@127.0.0.1:44914
[S5] ⇄ pheromone p=0.266 → S16@127.0.0.1:44916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9930 head_norm=1.162568
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.469288e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9925 head_norm=1.041819 delta_norm=0.546929
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.215 → S9@127.0.0.1:44910
[S13] ⇄ pheromone p=0.138 → S10@127.0.0.1:44911
[S15] ⇄ pheromone p=0.399 → S5@127.0.0.1:44905
[S17] ⇄ pheromone p=0.273 → S3@127.0.0.1:44903
[S2] START round=26 head_norm_before_train=1.369282 cos_to_last_merge=0.9993 (last merge round=24)
[S2] round=26 local utility u=0.139818 metrics={'f1_val': 0.6971637039226404, 'auprc': 0.7480972313410403, 'loss_val': 0.3872266738976114, 'psi': 0.7175371148900004}-{'f1_val': 0.6785381201546982, 'auprc': 0.7731666520599425, 'loss_val': 0.6303166112078694, 'psi': 0.716389532916796}
[S3] START round=26 head_norm_before_train=1.414172 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9523655484453774, 'auprc': 0.9981055737775737, 'loss_val': 0.1862721511599557, 'psi': 0.9706615585782559}-{'f1_val': 0.9747179186294904, 'auprc': 0.9976862745819304, 'loss_val': 0.12403324848562582, 'psi': 0.9839052610104664}
[S4] START round=26 head_norm_before_train=1.871685 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9372912306530566, 'auprc': 0.9207639833016215, 'loss_val': 0.31385959645724665, 'psi': 0.9306803317124825}-{'f1_val': 0.9403224551099943, 'auprc': 0.9370328826738804, 'loss_val': 0.2979198144845727, 'psi': 0.9390066261355487}
[S5] START round=26 head_norm_before_train=1.340134 cos_to_last_merge=0.9989 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7147964886230799, 'auprc': 0.7770114084390984, 'loss_val': 0.533994839131563, 'psi': 0.7396824565494873}-{'f1_val': 0.9877540734614205, 'auprc': 0.9911222455466583, 'loss_val': 0.2432919850505878, 'psi': 0.9891013422955156}
[S6] START round=26 head_norm_before_train=1.436965 cos_to_last_merge=0.8184 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8811092746151279, 'auprc': 0.9674637770939877, 'loss_val': 0.27225006532879126, 'psi': 0.9156510756066718}-{'f1_val': 0.6016995067368202, 'auprc': 0.7474720343391541, 'loss_val': 0.7503646038408404, 'psi': 0.6600085177777537}
[S7] START round=26 head_norm_before_train=1.707810 (no previous merge yet)
[S7] round=26 local utility u=0.569845 metrics={'f1_val': 0.6166476192476159, 'auprc': 0.790530260900134, 'loss_val': 0.5767499991614168, 'psi': 0.6862006759086232}-{'f1_val': 0.4744660804090882, 'auprc': 0.7781732459523094, 'loss_val': 0.8262802872202226, 'psi': 0.5959489466263768}
[S8] START round=26 head_norm_before_train=1.041819 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9976809070521633, 'loss_val': 0.22136984759395498, 'psi': 0.9948086862998345}-{'f1_val': 0.9930461454137609, 'auprc': 0.9967472096943621, 'loss_val': 0.1960221735672359, 'psi': 0.9945265711260014}
[S9] START round=26 head_norm_before_train=1.020411 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.011344 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9954265946040889, 'loss_val': 0.12419909852663613, 'psi': 0.99628218909699}-{'f1_val': 0.9968525854255906, 'auprc': 0.99595444722552, 'loss_val': 0.14846976234824427, 'psi': 0.9964933301455623}
[S10] START round=26 head_norm_before_train=1.445304 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9952789467684864, 'loss_val': 0.12202178266427352, 'psi': 0.9950924906264402}-{'f1_val': 0.9949681865317428, 'auprc': 0.9940420832385729, 'loss_val': 0.10369483296763533, 'psi': 0.9945977452144749}
[S11] START round=26 head_norm_before_train=1.893573 cos_to_last_merge=0.9998 (last merge round=24)
[S11] round=26 local utility u=0.005407 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9982423815110526, 'loss_val': 0.047324920984713366, 'psi': 0.9970679696867946}-{'f1_val': 0.9962850284706224, 'auprc': 0.9986027756829674, 'loss_val': 0.059220795320780284, 'psi': 0.9972121273555604}
[S13] START round=26 head_norm_before_train=1.437007 cos_to_last_merge=0.8330 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5694977005748061, 'auprc': 0.6811248220898928, 'loss_val': 0.8212021980484657, 'psi': 0.6141485491808407}-{'f1_val': 0.6177434277360996, 'auprc': 0.6728683787604285, 'loss_val': 0.5825183684515433, 'psi': 0.6397934081458312}
[S14] START round=26 head_norm_before_train=1.084824 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9967661706012716, 'loss_val': 0.19769140360863205, 'psi': 0.9967729328119703}-{'f1_val': 0.9974082695017256, 'auprc': 0.9950650785839594, 'loss_val': 0.16470843467256296, 'psi': 0.9964709931346192}
[S15] START round=26 head_norm_before_train=1.263491 cos_to_last_merge=0.9992 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8195132347942495, 'auprc': 0.9901030568341131, 'loss_val': 0.25222247497732125, 'psi': 0.887749163610195}-{'f1_val': 0.9866796456192696, 'auprc': 0.9907939027515299, 'loss_val': 0.1919794971363586, 'psi': 0.9883253484721737}
[S16] START round=26 head_norm_before_train=1.064668 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8625956788825796, 'auprc': 0.9908601179907817, 'loss_val': 0.6090021926655373, 'psi': 0.9139014545258604}-{'f1_val': 0.8884157800992915, 'auprc': 0.9940750758825786, 'loss_val': 0.4801336991857547, 'psi': 0.9306794984126063}
[S17] START round=26 head_norm_before_train=1.594871 cos_to_last_merge=0.8246 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5744484028302865, 'auprc': 0.9282547725143819, 'loss_val': 0.8101381174519565, 'psi': 0.7159709507039247}-{'f1_val': 0.6133757748058519, 'auprc': 0.9179450086308657, 'loss_val': 0.6356211929099701, 'psi': 0.7352034683358575}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.4632
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.6713
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.2168
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.5326
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.8497
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9524 head_norm=1.456751
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.977445e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9843 head_norm=1.239949 delta_norm=0.997745
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.8195 head_norm=1.301027
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.485987e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.8280 head_norm=1.226269 delta_norm=0.148599
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9929 head_norm=1.084739
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.392688e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9925 head_norm=1.159570 delta_norm=0.539269
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8626 head_norm=1.116334
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.363114e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8749 head_norm=0.971121 delta_norm=0.536311
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.399287 cos_to_last_merge=0.9977 (last merge round=24)
[S2] round=27 local utility u=0.036184 metrics={'f1_val': 0.7032631000797838, 'auprc': 0.7908303232119637, 'loss_val': 0.47965381331727935, 'psi': 0.7382899893326558}-{'f1_val': 0.6971637039226404, 'auprc': 0.7480972313410403, 'loss_val': 0.3872266738976114, 'psi': 0.7175371148900004}
[S3] START round=27 head_norm_before_train=1.239949 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.030633 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9973222929357843, 'loss_val': 0.1731466352925274, 'psi': 0.9753972087911731}-{'f1_val': 0.9523655484453774, 'auprc': 0.9981055737775737, 'loss_val': 0.1862721511599557, 'psi': 0.9706615585782559}
[S4] START round=27 head_norm_before_train=1.887792 (no previous merge yet)
[S4] round=27 local utility u=0.003767 metrics={'f1_val': 0.9373036026370283, 'auprc': 0.9228595198073427, 'loss_val': 0.31268592456007643, 'psi': 0.9315259695051541}-{'f1_val': 0.9372912306530566, 'auprc': 0.9207639833016215, 'loss_val': 0.31385959645724665, 'psi': 0.9306803317124825}
[S5] START round=27 head_norm_before_train=1.385828 cos_to_last_merge=0.9953 (last merge round=24)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.9959201961697324, 'auprc': 0.9893413132357811, 'loss_val': 0.16769635029791355, 'psi': 0.9932886429961518}-{'f1_val': 0.7147964886230799, 'auprc': 0.7770114084390984, 'loss_val': 0.533994839131563, 'psi': 0.7396824565494873}
[S6] START round=27 head_norm_before_train=1.447124 cos_to_last_merge=0.8176 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8197408278592964, 'auprc': 0.9493848081466866, 'loss_val': 0.33205408787671326, 'psi': 0.8715984199742524}-{'f1_val': 0.8811092746151279, 'auprc': 0.9674637770939877, 'loss_val': 0.27225006532879126, 'psi': 0.9156510756066718}
[S7] START round=27 head_norm_before_train=1.715753 (no previous merge yet)
[S7] round=27 local utility u=0.303517 metrics={'f1_val': 0.6659461697082396, 'auprc': 0.8244463055756877, 'loss_val': 0.36725493060508935, 'psi': 0.7293462240552189}-{'f1_val': 0.6166476192476159, 'auprc': 0.790530260900134, 'loss_val': 0.5767499991614168, 'psi': 0.6862006759086232}
[S8] START round=27 head_norm_before_train=1.159570 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.026438 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9972184671151263, 'loss_val': 0.1679719426051785, 'psi': 0.9947103075970499}-{'f1_val': 0.9928938724649488, 'auprc': 0.9976809070521633, 'loss_val': 0.22136984759395498, 'psi': 0.9948086862998345}
[S9] START round=27 head_norm_before_train=1.102365 cos_to_last_merge=0.9964 (last merge round=25)
[S9] round=27 local utility u=0.003753 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9985802020461051, 'loss_val': 0.09862904672931073, 'psi': 0.9947911652886449}-{'f1_val': 0.9968525854255906, 'auprc': 0.9954265946040889, 'loss_val': 0.12419909852663613, 'psi': 0.99628218909699}
[S10] START round=27 head_norm_before_train=1.475857 cos_to_last_merge=0.9995 (last merge round=25)
[S10] round=27 local utility u=0.011520 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9959077214465443, 'loss_val': 0.09823460086278443, 'psi': 0.9950805526576543}-{'f1_val': 0.9949681865317428, 'auprc': 0.9952789467684864, 'loss_val': 0.12202178266427352, 'psi': 0.9950924906264402}
[S11] START round=27 head_norm_before_train=1.917750 cos_to_last_merge=0.9992 (last merge round=24)
[S11] round=27 local utility u=0.002602 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9979002806370096, 'loss_val': 0.04109547935300702, 'psi': 0.9969311293371773}-{'f1_val': 0.9962850284706224, 'auprc': 0.9982423815110526, 'loss_val': 0.047324920984713366, 'psi': 0.9970679696867946}
[S13] START round=27 head_norm_before_train=1.451550 cos_to_last_merge=0.8304 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5583399898287835, 'auprc': 0.6799678422289736, 'loss_val': 0.7990981653135055, 'psi': 0.6069911307888596}-{'f1_val': 0.5694977005748061, 'auprc': 0.6811248220898928, 'loss_val': 0.8212021980484657, 'psi': 0.6141485491808407}
[S14] START round=27 head_norm_before_train=1.133578 cos_to_last_merge=0.9985 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9915563358382661, 'auprc': 0.9941131295501462, 'loss_val': 0.16548752943255315, 'psi': 0.9925790533230181}-{'f1_val': 0.9967774409524363, 'auprc': 0.9967661706012716, 'loss_val': 0.19769140360863205, 'psi': 0.9967729328119703}
[S15] START round=27 head_norm_before_train=1.226269 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.747324531292878, 'auprc': 0.9877472406250188, 'loss_val': 0.3486958010930413, 'psi': 0.8434936150257344}-{'f1_val': 0.8195132347942495, 'auprc': 0.9901030568341131, 'loss_val': 0.25222247497732125, 'psi': 0.887749163610195}
[S16] START round=27 head_norm_before_train=0.971121 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.500753 metrics={'f1_val': 0.9763015979469046, 'auprc': 0.9930451636082888, 'loss_val': 0.29628649586228845, 'psi': 0.9829990242114582}-{'f1_val': 0.8625956788825796, 'auprc': 0.9908601179907817, 'loss_val': 0.6090021926655373, 'psi': 0.9139014545258604}
[S17] START round=27 head_norm_before_train=1.616322 cos_to_last_merge=0.8238 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=27 local utility u=0.159648 metrics={'f1_val': 0.6082318827336302, 'auprc': 0.9362544209550347, 'loss_val': 0.7175421677783133, 'psi': 0.739440898022192}-{'f1_val': 0.5744484028302865, 'auprc': 0.9282547725143819, 'loss_val': 0.8101381174519565, 'psi': 0.7159709507039247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S9] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:44902
[S11] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → trigger blocked (psi=0.738)
[S7] not sending this round → trigger blocked (psi=0.729)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9932
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.5401
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.6386
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9392
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.8502
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.8931
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.5335
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9963 head_norm=1.940803
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.145969e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.913684 delta_norm=0.114597
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9916 head_norm=1.186319
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.088251e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9949 head_norm=1.087046 delta_norm=0.208825
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7033 head_norm=1.428205
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.214886e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.7030 head_norm=1.326538 delta_norm=0.321489
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9923 head_norm=1.168965
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.444163e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9923 head_norm=1.065002 delta_norm=0.244416
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9763 head_norm=1.021373
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.522354e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9633 head_norm=1.111929 delta_norm=0.552235
[S16] aggregate: ROLLBACK (f1_val pre=0.976 post=0.963 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9608 head_norm=1.298593
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.249092e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9608 head_norm=1.288855 delta_norm=0.724909
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.326538 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6891991562630232, 'auprc': 0.8001345341236616, 'loss_val': 0.4581870118399232, 'psi': 0.7335733074072786}-{'f1_val': 0.7032631000797838, 'auprc': 0.7908303232119637, 'loss_val': 0.47965381331727935, 'psi': 0.7382899893326558}
[S3] START round=28 head_norm_before_train=1.288855 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.140290 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9981437500433645, 'loss_val': 0.11491060152185706, 'psi': 0.9977137775892804}-{'f1_val': 0.9607804860280988, 'auprc': 0.9973222929357843, 'loss_val': 0.1731466352925274, 'psi': 0.9753972087911731}
[S4] START round=28 head_norm_before_train=1.893125 (no previous merge yet)
[S4] round=28 local utility u=0.098226 metrics={'f1_val': 0.947120699164853, 'auprc': 0.9590398161646709, 'loss_val': 0.28367710278648145, 'psi': 0.9518883459647801}-{'f1_val': 0.9373036026370283, 'auprc': 0.9228595198073427, 'loss_val': 0.31268592456007643, 'psi': 0.9315259695051541}
[S5] START round=28 head_norm_before_train=1.428110 cos_to_last_merge=0.9907 (last merge round=24)
[S5] round=28 local utility u=0.040121 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9968472551140177, 'loss_val': 0.11245346978521102, 'psi': 0.9965391892237412}-{'f1_val': 0.9959201961697324, 'auprc': 0.9893413132357811, 'loss_val': 0.16769635029791355, 'psi': 0.9932886429961518}
[S6] START round=28 head_norm_before_train=1.456309 cos_to_last_merge=0.8168 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.599064522618048, 'auprc': 0.7542921830088336, 'loss_val': 0.805882278929332, 'psi': 0.6611555867743623}-{'f1_val': 0.8197408278592964, 'auprc': 0.9493848081466866, 'loss_val': 0.33205408787671326, 'psi': 0.8715984199742524}
[S7] START round=28 head_norm_before_train=1.722386 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6474699609520445, 'auprc': 0.796992467617176, 'loss_val': 0.5818808103528721, 'psi': 0.7072789636180972}-{'f1_val': 0.6659461697082396, 'auprc': 0.8244463055756877, 'loss_val': 0.36725493060508935, 'psi': 0.7293462240552189}
[S8] START round=28 head_norm_before_train=1.202147 cos_to_last_merge=0.9992 (last merge round=26)
[S8] round=28 local utility u=0.011551 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9975810272835992, 'loss_val': 0.14077370420814098, 'psi': 0.9943369551315067}-{'f1_val': 0.9930382012516658, 'auprc': 0.9972184671151263, 'loss_val': 0.1679719426051785, 'psi': 0.9947103075970499}
[S9] START round=28 head_norm_before_train=1.065002 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9939994926505127, 'loss_val': 0.11313853771366887, 'psi': 0.995465095567131}-{'f1_val': 0.9922651407836713, 'auprc': 0.9985802020461051, 'loss_val': 0.09862904672931073, 'psi': 0.9947911652886449}
[S10] START round=28 head_norm_before_train=1.511379 cos_to_last_merge=0.9978 (last merge round=25)
[S10] round=28 local utility u=0.006714 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9963252422809818, 'loss_val': 0.08054369818581639, 'psi': 0.9946961047836596}-{'f1_val': 0.9945291067983943, 'auprc': 0.9959077214465443, 'loss_val': 0.09823460086278443, 'psi': 0.9950805526576543}
[S11] START round=28 head_norm_before_train=1.913684 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9985177450299646, 'loss_val': 0.049030307271676656, 'psi': 0.9971781150943593}-{'f1_val': 0.9962850284706224, 'auprc': 0.9979002806370096, 'loss_val': 0.04109547935300702, 'psi': 0.9969311293371773}
[S13] START round=28 head_norm_before_train=1.466478 cos_to_last_merge=0.8269 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=28 local utility u=0.219193 metrics={'f1_val': 0.6085365199065962, 'auprc': 0.6566906572276197, 'loss_val': 0.5920588636784395, 'psi': 0.6277981748350057}-{'f1_val': 0.5583399898287835, 'auprc': 0.6799678422289736, 'loss_val': 0.7990981653135055, 'psi': 0.6069911307888596}
[S14] START round=28 head_norm_before_train=1.087046 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.003215 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.995510334807307, 'loss_val': 0.19211355342533154, 'psi': 0.9960244327863135}-{'f1_val': 0.9915563358382661, 'auprc': 0.9941131295501462, 'loss_val': 0.16548752943255315, 'psi': 0.9925790533230181}
[S15] START round=28 head_norm_before_train=1.263230 cos_to_last_merge=0.9994 (last merge round=26)
[S15] round=28 local utility u=0.659110 metrics={'f1_val': 0.9352961704496594, 'auprc': 0.9913433119239378, 'loss_val': 0.16909457586461588, 'psi': 0.9577150270393707}-{'f1_val': 0.747324531292878, 'auprc': 0.9877472406250188, 'loss_val': 0.3486958010930413, 'psi': 0.8434936150257344}
[S16] START round=28 head_norm_before_train=1.111929 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9329977101459914, 'auprc': 0.9905237862650669, 'loss_val': 0.38676968930215594, 'psi': 0.9560081405936216}-{'f1_val': 0.9763015979469046, 'auprc': 0.9930451636082888, 'loss_val': 0.29628649586228845, 'psi': 0.9829990242114582}
[S17] START round=28 head_norm_before_train=1.639188 cos_to_last_merge=0.8223 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5768779945483488, 'auprc': 0.8066098009014675, 'loss_val': 0.7245939563913726, 'psi': 0.6687707170895962}-{'f1_val': 0.6082318827336302, 'auprc': 0.9362544209550347, 'loss_val': 0.7175421677783133, 'psi': 0.739440898022192}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[S8] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → trigger blocked (psi=0.998)
[S14] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9399
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9734
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=0.6909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9922 head_norm=1.247643
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.713692e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9922 head_norm=1.096073 delta_norm=0.471369
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9936 head_norm=1.548341
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.779620e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9934 head_norm=1.504265 delta_norm=0.177962
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.9963 head_norm=1.456171
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.506497e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.9963 head_norm=1.359782 delta_norm=0.250650
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.353420 cos_to_last_merge=0.9996 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7101930733095837, 'auprc': 0.7844702447484085, 'loss_val': 0.5437955276332893, 'psi': 0.7399039418851137}-{'f1_val': 0.6891991562630232, 'auprc': 0.8001345341236616, 'loss_val': 0.4581870118399232, 'psi': 0.7335733074072786}
[S3] START round=29 head_norm_before_train=1.359800 cos_to_last_merge=0.9980 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9862238109976114, 'auprc': 0.9971582449140051, 'loss_val': 0.09266529269613569, 'psi': 0.9905975845641688}-{'f1_val': 0.9974271292865575, 'auprc': 0.9981437500433645, 'loss_val': 0.11491060152185706, 'psi': 0.9977137775892804}
[S4] START round=29 head_norm_before_train=1.892529 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9422624747051316, 'auprc': 0.9439654618753506, 'loss_val': 0.29395230618470997, 'psi': 0.9429436695732192}-{'f1_val': 0.947120699164853, 'auprc': 0.9590398161646709, 'loss_val': 0.28367710278648145, 'psi': 0.9518883459647801}
[S5] START round=29 head_norm_before_train=1.359782 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7592352730177588, 'auprc': 0.8734430968750819, 'loss_val': 0.40414253311114423, 'psi': 0.8049184025606881}-{'f1_val': 0.9963338119635569, 'auprc': 0.9968472551140177, 'loss_val': 0.11245346978521102, 'psi': 0.9965391892237412}
[S6] START round=29 head_norm_before_train=1.468301 cos_to_last_merge=0.8152 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8282077792794944, 'auprc': 0.9676943600765666, 'loss_val': 0.2900565769721037, 'psi': 0.8840024115983233}-{'f1_val': 0.599064522618048, 'auprc': 0.7542921830088336, 'loss_val': 0.805882278929332, 'psi': 0.6611555867743623}
[S7] START round=29 head_norm_before_train=1.739823 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5485156719306377, 'auprc': 0.7811647418473082, 'loss_val': 0.8340857544867786, 'psi': 0.6415752998973059}-{'f1_val': 0.6474699609520445, 'auprc': 0.796992467617176, 'loss_val': 0.5818808103528721, 'psi': 0.7072789636180972}
[S8] START round=29 head_norm_before_train=1.096073 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9980216093208341, 'loss_val': 0.16690190940541572, 'psi': 0.9952512087348}-{'f1_val': 0.992174240363445, 'auprc': 0.9975810272835992, 'loss_val': 0.14077370420814098, 'psi': 0.9943369551315067}
[S9] START round=29 head_norm_before_train=1.131537 cos_to_last_merge=0.9981 (last merge round=27)
[S9] round=29 local utility u=0.019808 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9985766201846928, 'loss_val': 0.08474838410165524, 'psi': 0.9970453862774212}-{'f1_val': 0.99644216417821, 'auprc': 0.9939994926505127, 'loss_val': 0.11313853771366887, 'psi': 0.995465095567131}
[S10] START round=29 head_norm_before_train=1.504265 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9963538853551949, 'loss_val': 0.09824383880534969, 'psi': 0.9953907196737015}-{'f1_val': 0.9936100131187782, 'auprc': 0.9963252422809818, 'loss_val': 0.08054369818581639, 'psi': 0.9946961047836596}
[S11] START round=29 head_norm_before_train=1.933193 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9985880173084901, 'loss_val': 0.05798457228967112, 'psi': 0.9969582260670078}-{'f1_val': 0.9962850284706224, 'auprc': 0.9985177450299646, 'loss_val': 0.049030307271676656, 'psi': 0.9971781150943593}
[S13] START round=29 head_norm_before_train=1.480408 cos_to_last_merge=0.8246 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.825
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5546103175522574, 'auprc': 0.665576039407872, 'loss_val': 0.8766152780962462, 'psi': 0.5989966062945032}-{'f1_val': 0.6085365199065962, 'auprc': 0.6566906572276197, 'loss_val': 0.5920588636784395, 'psi': 0.6277981748350057}
[S14] START round=29 head_norm_before_train=1.136010 cos_to_last_merge=0.9985 (last merge round=27)
[S14] round=29 local utility u=0.019611 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9950396888416817, 'loss_val': 0.1514804380810187, 'psi': 0.9958361744000634}-{'f1_val': 0.9963671647723179, 'auprc': 0.995510334807307, 'loss_val': 0.19211355342533154, 'psi': 0.9960244327863135}
[S15] START round=29 head_norm_before_train=1.305077 cos_to_last_merge=0.9975 (last merge round=26)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7772971059929645, 'auprc': 0.989768909753203, 'loss_val': 0.29863549936433953, 'psi': 0.86228582749706}-{'f1_val': 0.9352961704496594, 'auprc': 0.9913433119239378, 'loss_val': 0.16909457586461588, 'psi': 0.9577150270393707}
[S16] START round=29 head_norm_before_train=1.161893 cos_to_last_merge=0.9976 (last merge round=27)
[S16] round=29 local utility u=0.281572 metrics={'f1_val': 0.9913969155245994, 'auprc': 0.9903452670728776, 'loss_val': 0.17348568631722777, 'psi': 0.9909762561439107}-{'f1_val': 0.9329977101459914, 'auprc': 0.9905237862650669, 'loss_val': 0.38676968930215594, 'psi': 0.9560081405936216}
[S17] START round=29 head_norm_before_train=1.661254 cos_to_last_merge=0.8208 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=29 local utility u=0.119052 metrics={'f1_val': 0.571483714054708, 'auprc': 0.9264071695147629, 'loss_val': 0.8135156918816686, 'psi': 0.71345309623873}-{'f1_val': 0.5768779945483488, 'auprc': 0.8066098009014675, 'loss_val': 0.7245939563913726, 'psi': 0.6687707170895962}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.5286
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.8522
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.7420
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.8830
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9934 head_norm=1.144078
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.958424e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9930 head_norm=1.224826 delta_norm=0.495842
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.186253
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.266365e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.155147 delta_norm=0.326637
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9862 head_norm=1.431846
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.942864e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9836 head_norm=1.508453 delta_norm=0.394286
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9914 head_norm=1.214460
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.859293e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9897 head_norm=1.055003 delta_norm=0.585929
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.378220 cos_to_last_merge=0.9985 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7104905963315595, 'auprc': 0.7618682124207734, 'loss_val': 0.5360093645093454, 'psi': 0.731041642767245}-{'f1_val': 0.7101930733095837, 'auprc': 0.7844702447484085, 'loss_val': 0.5437955276332893, 'psi': 0.7399039418851137}
[S3] START round=30 head_norm_before_train=1.508453 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.036477 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9982159087225362, 'loss_val': 0.09010423526340464, 'psi': 0.997742641060949}-{'f1_val': 0.9862238109976114, 'auprc': 0.9971582449140051, 'loss_val': 0.09266529269613569, 'psi': 0.9905975845641688}
[S4] START round=30 head_norm_before_train=1.894332 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9406189778125111, 'auprc': 0.9394112932407401, 'loss_val': 0.2962861490587513, 'psi': 0.9401359039838026}-{'f1_val': 0.9422624747051316, 'auprc': 0.9439654618753506, 'loss_val': 0.29395230618470997, 'psi': 0.9429436695732192}
[S5] START round=30 head_norm_before_train=1.386237 cos_to_last_merge=0.9996 (last merge round=28)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9955433308152749, 'loss_val': 0.14845476011916459, 'psi': 0.9960176195042441}-{'f1_val': 0.7592352730177588, 'auprc': 0.8734430968750819, 'loss_val': 0.40414253311114423, 'psi': 0.8049184025606881}
[S6] START round=30 head_norm_before_train=1.477565 cos_to_last_merge=0.8149 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.794720621936845, 'auprc': 0.947915080929502, 'loss_val': 0.46951695831957607, 'psi': 0.8559984055339078}-{'f1_val': 0.8282077792794944, 'auprc': 0.9676943600765666, 'loss_val': 0.2900565769721037, 'psi': 0.8840024115983233}
[S7] START round=30 head_norm_before_train=1.753963 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.3913610440396236, 'auprc': 0.7773325522088148, 'loss_val': 1.335495277926207, 'psi': 0.5457496473073}-{'f1_val': 0.5485156719306377, 'auprc': 0.7811647418473082, 'loss_val': 0.8340857544867786, 'psi': 0.6415752998973059}
[S8] START round=30 head_norm_before_train=1.224826 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.012447 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.997386560139405, 'loss_val': 0.13490551494507771, 'psi': 0.9944774588050631}-{'f1_val': 0.9934042750107773, 'auprc': 0.9980216093208341, 'loss_val': 0.16690190940541572, 'psi': 0.9952512087348}
[S9] START round=30 head_norm_before_train=1.199072 cos_to_last_merge=0.9936 (last merge round=27)
[S9] round=30 local utility u=0.007863 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9956929004640748, 'loss_val': 0.06534017286052078, 'psi': 0.9963887114409842}-{'f1_val': 0.9960245636725735, 'auprc': 0.9985766201846928, 'loss_val': 0.08474838410165524, 'psi': 0.9970453862774212}
[S10] START round=30 head_norm_before_train=1.536187 cos_to_last_merge=0.9995 (last merge round=28)
[S10] round=30 local utility u=0.003282 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9937983015005657, 'loss_val': 0.08452399670385252, 'psi': 0.9944195363727514}-{'f1_val': 0.9947486092193725, 'auprc': 0.9963538853551949, 'loss_val': 0.09824383880534969, 'psi': 0.9953907196737015}
[S11] START round=30 head_norm_before_train=1.953011 cos_to_last_merge=0.9994 (last merge round=27)
[S11] round=30 local utility u=0.008651 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9986486401688552, 'loss_val': 0.040865244340502864, 'psi': 0.9969824752111538}-{'f1_val': 0.9958716985726862, 'auprc': 0.9985880173084901, 'loss_val': 0.05798457228967112, 'psi': 0.9969582260670078}
[S13] START round=30 head_norm_before_train=1.493717 cos_to_last_merge=0.8235 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.824
[S13] round=30 local utility u=0.393523 metrics={'f1_val': 0.6285727447264551, 'auprc': 0.6724777997232896, 'loss_val': 0.5540495960968573, 'psi': 0.6461347667251889}-{'f1_val': 0.5546103175522574, 'auprc': 0.665576039407872, 'loss_val': 0.8766152780962462, 'psi': 0.5989966062945032}
[S14] START round=30 head_norm_before_train=1.155147 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9945996882923434, 'loss_val': 0.18531536521446879, 'psi': 0.9960251753672031}-{'f1_val': 0.9963671647723179, 'auprc': 0.9950396888416817, 'loss_val': 0.1514804380810187, 'psi': 0.9958361744000634}
[S15] START round=30 head_norm_before_train=1.345110 cos_to_last_merge=0.9950 (last merge round=26)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6967177376353924, 'auprc': 0.7586725684740956, 'loss_val': 0.4657888763226214, 'psi': 0.7214996699708737}-{'f1_val': 0.7772971059929645, 'auprc': 0.989768909753203, 'loss_val': 0.29863549936433953, 'psi': 0.86228582749706}
[S16] START round=30 head_norm_before_train=1.055003 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9909588131647725, 'auprc': 0.9894149831464627, 'loss_val': 0.1886153633148766, 'psi': 0.9903412811574486}-{'f1_val': 0.9913969155245994, 'auprc': 0.9903452670728776, 'loss_val': 0.17348568631722777, 'psi': 0.9909762561439107}
[S17] START round=30 head_norm_before_train=1.676784 cos_to_last_merge=0.8200 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=30 local utility u=0.218307 metrics={'f1_val': 0.6056958090557263, 'auprc': 0.9534077159622589, 'loss_val': 0.6631753920120486, 'psi': 0.7447805718183393}-{'f1_val': 0.571483714054708, 'auprc': 0.9264071695147629, 'loss_val': 0.8135156918816686, 'psi': 0.71345309623873}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:44902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S9] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S3
[S2] cosine check vs S3: cos=0.8227
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.8284
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.9850
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.6269
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.6391
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.7665
[S17] not sending this round → trigger blocked (psi=0.745)
[S4] ⇄ pheromone p=0.031 → S11@127.0.0.1:44912
[S7] ⇄ pheromone p=0.141 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.018 → S8@127.0.0.1:44909
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.7105 head_norm=1.398541
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.475130e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.7051 head_norm=1.413080 delta_norm=0.447513
[S2] aggregate: ROLLBACK (f1_val pre=0.710 post=0.705 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.029 → S15@127.0.0.1:44915
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9969 head_norm=1.255468
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.259108e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9969 head_norm=1.136550 delta_norm=0.225911
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.021 → S16@127.0.0.1:44916
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6967 head_norm=1.384419
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.660821e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.6967 head_norm=1.606774 delta_norm=0.566082
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.215 → S5@127.0.0.1:44905
[S6] ⇄ pheromone p=0.339 → S8@127.0.0.1:44909
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9910 head_norm=1.105105
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.639010e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9905 head_norm=1.141373 delta_norm=0.563901
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.152 → S14@127.0.0.1:44914
[S3] ⇄ pheromone p=0.049 → S2@127.0.0.1:44902
[S5] ⇄ pheromone p=0.395 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.152 → S10@127.0.0.1:44911
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9948 head_norm=1.568341
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.368857e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9948 head_norm=1.530995 delta_norm=0.136886
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.023 → S9@127.0.0.1:44910
[S11] ⇄ pheromone p=0.023 → S15@127.0.0.1:44915
[S8] ⇄ pheromone p=0.077 → S9@127.0.0.1:44910
[S17] ⇄ pheromone p=0.169 → S3@127.0.0.1:44903
[S2] START round=31 head_norm_before_train=1.413080 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.702030810509016, 'auprc': 0.7476001832831503, 'loss_val': 0.5518812322406779, 'psi': 0.7202585596186697}-{'f1_val': 0.7104905963315595, 'auprc': 0.7618682124207734, 'loss_val': 0.5360093645093454, 'psi': 0.731041642767245}
[S3] START round=31 head_norm_before_train=1.561477 cos_to_last_merge=0.9989 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9717529106753171, 'auprc': 0.9986674372665488, 'loss_val': 0.09259096706783035, 'psi': 0.9825187213118097}-{'f1_val': 0.9974271292865575, 'auprc': 0.9982159087225362, 'loss_val': 0.09010423526340464, 'psi': 0.997742641060949}
[S4] START round=31 head_norm_before_train=1.894526 (no previous merge yet)
[S4] round=31 local utility u=0.076105 metrics={'f1_val': 0.9517667511524946, 'auprc': 0.9618879943672333, 'loss_val': 0.27839213820523606, 'psi': 0.9558152484383902}-{'f1_val': 0.9406189778125111, 'auprc': 0.9394112932407401, 'loss_val': 0.2962861490587513, 'psi': 0.9401359039838026}
[S5] START round=31 head_norm_before_train=1.421329 cos_to_last_merge=0.9980 (last merge round=28)
[S5] round=31 local utility u=0.013100 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9913779299960749, 'loss_val': 0.1097589629685562, 'psi': 0.9943514591765641}-{'f1_val': 0.9963338119635569, 'auprc': 0.9955433308152749, 'loss_val': 0.14845476011916459, 'psi': 0.9960176195042441}
[S6] START round=31 head_norm_before_train=1.485734 cos_to_last_merge=0.8144 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7202684886438372, 'auprc': 0.7894858590401929, 'loss_val': 0.6428988950127317, 'psi': 0.7479554368023795}-{'f1_val': 0.794720621936845, 'auprc': 0.947915080929502, 'loss_val': 0.46951695831957607, 'psi': 0.8559984055339078}
[S7] START round=31 head_norm_before_train=1.762685 (no previous merge yet)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.6772492888288417, 'auprc': 0.9391097674114013, 'loss_val': 0.2753862658161886, 'psi': 0.7819934802618655}-{'f1_val': 0.3913610440396236, 'auprc': 0.7773325522088148, 'loss_val': 1.335495277926207, 'psi': 0.5457496473073}
[S8] START round=31 head_norm_before_train=1.271015 cos_to_last_merge=0.9993 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.998220221099598, 'loss_val': 0.12254304837068629, 'psi': 0.992212744439977}-{'f1_val': 0.9925380579155019, 'auprc': 0.997386560139405, 'loss_val': 0.13490551494507771, 'psi': 0.9944774588050631}
[S9] START round=31 head_norm_before_train=1.136550 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9986726229969995, 'loss_val': 0.09499864802696081, 'psi': 0.9975806004541541}-{'f1_val': 0.9968525854255906, 'auprc': 0.9956929004640748, 'loss_val': 0.06534017286052078, 'psi': 0.9963887114409842}
[S10] START round=31 head_norm_before_train=1.530995 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9939558319194128, 'auprc': 0.9966390184990032, 'loss_val': 0.09354798268930331, 'psi': 0.995029106551249}-{'f1_val': 0.9948336929542084, 'auprc': 0.9937983015005657, 'loss_val': 0.08452399670385252, 'psi': 0.9944195363727514}
[S11] START round=31 head_norm_before_train=1.971733 cos_to_last_merge=0.9988 (last merge round=27)
[S11] round=31 local utility u=0.005306 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9985425914004566, 'loss_val': 0.032415647926079746, 'psi': 0.9971880536425561}-{'f1_val': 0.9958716985726862, 'auprc': 0.9986486401688552, 'loss_val': 0.040865244340502864, 'psi': 0.9969824752111538}
[S13] START round=31 head_norm_before_train=1.505216 cos_to_last_merge=0.8226 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5512128210667018, 'auprc': 0.6900492433874812, 'loss_val': 0.8481799341703617, 'psi': 0.6067473899950135}-{'f1_val': 0.6285727447264551, 'auprc': 0.6724777997232896, 'loss_val': 0.5540495960968573, 'psi': 0.6461347667251889}
[S14] START round=31 head_norm_before_train=1.199013 cos_to_last_merge=0.9986 (last merge round=29)
[S14] round=31 local utility u=0.024842 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9945044378543502, 'loss_val': 0.13794222092856975, 'psi': 0.9962467368427754}-{'f1_val': 0.9969755000837764, 'auprc': 0.9945996882923434, 'loss_val': 0.18531536521446879, 'psi': 0.9960251753672031}
[S15] START round=31 head_norm_before_train=1.606774 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9901057127777655, 'auprc': 0.9973524224618059, 'loss_val': 0.09283187605528656, 'psi': 0.9930043966513817}-{'f1_val': 0.6967177376353924, 'auprc': 0.7586725684740956, 'loss_val': 0.4657888763226214, 'psi': 0.7214996699708737}
[S16] START round=31 head_norm_before_train=1.141373 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8398858363950389, 'auprc': 0.8553253423266288, 'loss_val': 0.7031900755969571, 'psi': 0.8460616387676748}-{'f1_val': 0.9909588131647725, 'auprc': 0.9894149831464627, 'loss_val': 0.1886153633148766, 'psi': 0.9903412811574486}
[S17] START round=31 head_norm_before_train=1.693301 cos_to_last_merge=0.8185 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5640251989200904, 'auprc': 0.7753463262113196, 'loss_val': 0.9471419315922678, 'psi': 0.648553649836582}-{'f1_val': 0.6056958090557263, 'auprc': 0.9534077159622589, 'loss_val': 0.6631753920120486, 'psi': 0.7447805718183393}
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → trigger blocked (psi=0.994)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9925
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] cosine check vs S14: cos=0.5790
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.1768
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9292
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.9963 head_norm=1.460135
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.037421e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.9963 head_norm=1.520193 delta_norm=0.303742
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9963 head_norm=1.988463
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.276233e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9963 head_norm=1.937618 delta_norm=0.127623
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9718 head_norm=1.611450
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.084951e+00
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9722 head_norm=1.296244 delta_norm=1.084951
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9882 head_norm=1.315639
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.889482e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9882 head_norm=1.139234 delta_norm=0.588948
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.431321 cos_to_last_merge=0.9998 (last merge round=30)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6281887477934701, 'auprc': 0.7314893043231008, 'loss_val': 0.8919449642227131, 'psi': 0.6695089704053223}-{'f1_val': 0.702030810509016, 'auprc': 0.7476001832831503, 'loss_val': 0.5518812322406779, 'psi': 0.7202585596186697}
[S3] START round=32 head_norm_before_train=1.296244 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.032259 metrics={'f1_val': 0.9840442720458686, 'auprc': 0.9977542977033467, 'loss_val': 0.09908260966585392, 'psi': 0.9895282823088598}-{'f1_val': 0.9717529106753171, 'auprc': 0.9986674372665488, 'loss_val': 0.09259096706783035, 'psi': 0.9825187213118097}
[S4] START round=32 head_norm_before_train=1.894021 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9435998591222484, 'auprc': 0.9413123983542709, 'loss_val': 0.29259000560396214, 'psi': 0.9426848748150574}-{'f1_val': 0.9517667511524946, 'auprc': 0.9618879943672333, 'loss_val': 0.27839213820523606, 'psi': 0.9558152484383902}
[S5] START round=32 head_norm_before_train=1.520193 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9868646252881594, 'loss_val': 0.12569933584236595, 'psi': 0.9925461372933979}-{'f1_val': 0.9963338119635569, 'auprc': 0.9913779299960749, 'loss_val': 0.1097589629685562, 'psi': 0.9943514591765641}
[S6] START round=32 head_norm_before_train=1.494717 cos_to_last_merge=0.8134 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=32 local utility u=0.605203 metrics={'f1_val': 0.8039727394982088, 'auprc': 0.9399798386625291, 'loss_val': 0.38619958602055354, 'psi': 0.8583755791639369}-{'f1_val': 0.7202684886438372, 'auprc': 0.7894858590401929, 'loss_val': 0.6428988950127317, 'psi': 0.7479554368023795}
[S7] START round=32 head_norm_before_train=1.765776 (no previous merge yet)
[S7] round=32 local utility u=0.105131 metrics={'f1_val': 0.7015183382555773, 'auprc': 0.9566600733408082, 'loss_val': 0.26339009631799665, 'psi': 0.8035750322896696}-{'f1_val': 0.6772492888288417, 'auprc': 0.9391097674114013, 'loss_val': 0.2753862658161886, 'psi': 0.7819934802618655}
[S8] START round=32 head_norm_before_train=1.139234 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9980451093898517, 'loss_val': 0.15581617773629108, 'psi': 0.9949130411035519}-{'f1_val': 0.9882077600002297, 'auprc': 0.998220221099598, 'loss_val': 0.12254304837068629, 'psi': 0.992212744439977}
[S9] START round=32 head_norm_before_train=1.187613 cos_to_last_merge=0.9990 (last merge round=30)
[S9] round=32 local utility u=0.006758 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9955984615337256, 'loss_val': 0.0737622693257154, 'psi': 0.996501132120776}-{'f1_val': 0.9968525854255906, 'auprc': 0.9986726229969995, 'loss_val': 0.09499864802696081, 'psi': 0.9975806004541541}
[S10] START round=32 head_norm_before_train=1.562964 cos_to_last_merge=0.9993 (last merge round=30)
[S10] round=32 local utility u=0.013202 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9970556702056687, 'loss_val': 0.07234436573462161, 'psi': 0.9955907374673703}-{'f1_val': 0.9939558319194128, 'auprc': 0.9966390184990032, 'loss_val': 0.09354798268930331, 'psi': 0.995029106551249}
[S11] START round=32 head_norm_before_train=1.937618 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9985707603140908, 'loss_val': 0.0391789630441919, 'psi': 0.9971993212080098}-{'f1_val': 0.9962850284706224, 'auprc': 0.9985425914004566, 'loss_val': 0.032415647926079746, 'psi': 0.9971880536425561}
[S13] START round=32 head_norm_before_train=1.516508 cos_to_last_merge=0.8216 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.822
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5430222286212116, 'auprc': 0.636634522320489, 'loss_val': 0.9380454967705524, 'psi': 0.5804671461009225}-{'f1_val': 0.5512128210667018, 'auprc': 0.6900492433874812, 'loss_val': 0.8481799341703617, 'psi': 0.6067473899950135}
[S14] START round=32 head_norm_before_train=1.248408 cos_to_last_merge=0.9947 (last merge round=29)
[S14] round=32 local utility u=0.011635 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9960448657557402, 'loss_val': 0.11304625847408899, 'psi': 0.9962382451656868}-{'f1_val': 0.9974082695017256, 'auprc': 0.9945044378543502, 'loss_val': 0.13794222092856975, 'psi': 0.9962467368427754}
[S15] START round=32 head_norm_before_train=1.635389 cos_to_last_merge=0.9998 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.899186129321854, 'loss_val': 0.45271773023866213, 'psi': 0.7801727520720092}-{'f1_val': 0.9901057127777655, 'auprc': 0.9973524224618059, 'loss_val': 0.09283187605528656, 'psi': 0.9930043966513817}
[S16] START round=32 head_norm_before_train=1.188920 cos_to_last_merge=0.9985 (last merge round=30)
[S16] round=32 local utility u=0.933189 metrics={'f1_val': 0.9905210061866145, 'auprc': 0.9915323910369065, 'loss_val': 0.14924333614399854, 'psi': 0.9909255601267313}-{'f1_val': 0.8398858363950389, 'auprc': 0.8553253423266288, 'loss_val': 0.7031900755969571, 'psi': 0.8460616387676748}
[S17] START round=32 head_norm_before_train=1.711991 cos_to_last_merge=0.8175 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.4786624739143981, 'auprc': 0.7644358559170036, 'loss_val': 1.0796532907859142, 'psi': 0.5929718267154402}-{'f1_val': 0.5640251989200904, 'auprc': 0.7753463262113196, 'loss_val': 0.9471419315922678, 'psi': 0.648553649836582}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S16] → sending delta(kind=head bytes=1810) to S14@127.0.0.1:44914
[S7] not sending this round → trigger blocked (psi=0.804)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44910
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S14] not sending this round → trigger blocked (psi=0.996)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1810 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.7175
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.5393
[S14] RECEIVED delta(kind=head bytes=1810) from S16
[S14] cosine check vs S16: cos=0.9249
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=0.6957
[S2] RECEIVED delta(kind=head bytes=1803) from S3
[S2] cosine check vs S3: cos=0.8886
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9928 head_norm=1.186130
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.258504e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9930 head_norm=1.246841 delta_norm=0.525850
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.6282 head_norm=1.450407
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.344999e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.6268 head_norm=1.364914 delta_norm=0.334500
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9964 head_norm=1.293602
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.465073e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9964 head_norm=1.238737 delta_norm=0.246507
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9905 head_norm=1.231692
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.932619e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9910 head_norm=1.084340 delta_norm=0.593262
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9971 head_norm=1.240338
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.771956e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9971 head_norm=1.308081 delta_norm=0.577196
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.364914 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.551341068435625, 'auprc': 0.6553459370590345, 'loss_val': 1.1224805759980847, 'psi': 0.5929430158849889}-{'f1_val': 0.6281887477934701, 'auprc': 0.7314893043231008, 'loss_val': 0.8919449642227131, 'psi': 0.6695089704053223}
[S3] START round=33 head_norm_before_train=1.358704 cos_to_last_merge=0.9986 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9590523247935165, 'auprc': 0.9968541891833446, 'loss_val': 0.1460580210763226, 'psi': 0.9741730705494478}-{'f1_val': 0.9840442720458686, 'auprc': 0.9977542977033467, 'loss_val': 0.09908260966585392, 'psi': 0.9895282823088598}
[S4] START round=33 head_norm_before_train=1.899346 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9390454423825844, 'auprc': 0.9379100444429311, 'loss_val': 0.30133684945883793, 'psi': 0.938591283206723}-{'f1_val': 0.9435998591222484, 'auprc': 0.9413123983542709, 'loss_val': 0.29259000560396214, 'psi': 0.9426848748150574}
[S5] START round=33 head_norm_before_train=1.548116 cos_to_last_merge=0.9996 (last merge round=31)
[S5] round=33 local utility u=0.031152 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9975324526829927, 'loss_val': 0.09539791825904843, 'psi': 0.9968132682513311}-{'f1_val': 0.9963338119635569, 'auprc': 0.9868646252881594, 'loss_val': 0.12569933584236595, 'psi': 0.9925461372933979}
[S6] START round=33 head_norm_before_train=1.501785 cos_to_last_merge=0.8134 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7729670517272769, 'auprc': 0.8554158226253011, 'loss_val': 0.5646664947037497, 'psi': 0.8059465600864866}-{'f1_val': 0.8039727394982088, 'auprc': 0.9399798386625291, 'loss_val': 0.38619958602055354, 'psi': 0.8583755791639369}
[S7] START round=33 head_norm_before_train=1.769786 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6235884151560729, 'auprc': 0.8079594091249214, 'loss_val': 0.49025467763355307, 'psi': 0.6973368127436124}-{'f1_val': 0.7015183382555773, 'auprc': 0.9566600733408082, 'loss_val': 0.26339009631799665, 'psi': 0.8035750322896696}
[S8] START round=33 head_norm_before_train=1.246841 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.018464 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9985297061056246, 'loss_val': 0.11856666048461882, 'psi': 0.9949292640366416}-{'f1_val': 0.9928249955793521, 'auprc': 0.9980451093898517, 'loss_val': 0.15581617773629108, 'psi': 0.9949130411035519}
[S9] START round=33 head_norm_before_train=1.308081 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9989347758208608, 'loss_val': 0.1149309351155035, 'psi': 0.9969397966022062}-{'f1_val': 0.9971029125121428, 'auprc': 0.9955984615337256, 'loss_val': 0.0737622693257154, 'psi': 0.996501132120776}
[S10] START round=33 head_norm_before_train=1.596879 cos_to_last_merge=0.9976 (last merge round=30)
[S10] round=33 local utility u=0.004248 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9961388788531798, 'loss_val': 0.061098124279391125, 'psi': 0.9952240209263747}-{'f1_val': 0.994614115641838, 'auprc': 0.9970556702056687, 'loss_val': 0.07234436573462161, 'psi': 0.9955907374673703}
[S11] START round=33 head_norm_before_train=1.952760 cos_to_last_merge=0.9999 (last merge round=31)
[S11] round=33 local utility u=0.000558 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9986399300792931, 'loss_val': 0.03578954725964842, 'psi': 0.996978991175329}-{'f1_val': 0.9962850284706224, 'auprc': 0.9985707603140908, 'loss_val': 0.0391789630441919, 'psi': 0.9971993212080098}
[S13] START round=33 head_norm_before_train=1.526936 cos_to_last_merge=0.8198 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.820
[S13] round=33 local utility u=0.426495 metrics={'f1_val': 0.6196361662500398, 'auprc': 0.6422252383992376, 'loss_val': 0.561511299262076, 'psi': 0.6286717951097189}-{'f1_val': 0.5430222286212116, 'auprc': 0.636634522320489, 'loss_val': 0.9380454967705524, 'psi': 0.5804671461009225}
[S14] START round=33 head_norm_before_train=1.238737 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9944342357762952, 'loss_val': 0.1503263552051239, 'psi': 0.9958264133027369}-{'f1_val': 0.9963671647723179, 'auprc': 0.9960448657557402, 'loss_val': 0.11304625847408899, 'psi': 0.9962382451656868}
[S15] START round=33 head_norm_before_train=1.656503 cos_to_last_merge=0.9995 (last merge round=30)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9958217461321837, 'auprc': 0.9902300935953798, 'loss_val': 0.0584005066883743, 'psi': 0.9935850851174621}-{'f1_val': 0.7008305005721126, 'auprc': 0.899186129321854, 'loss_val': 0.45271773023866213, 'psi': 0.7801727520720092}
[S16] START round=33 head_norm_before_train=1.084340 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9903047297834456, 'auprc': 0.9940888801869481, 'loss_val': 0.18026527684671878, 'psi': 0.9918183899448465}-{'f1_val': 0.9905210061866145, 'auprc': 0.9915323910369065, 'loss_val': 0.14924333614399854, 'psi': 0.9909255601267313}
[S17] START round=33 head_norm_before_train=1.730445 cos_to_last_merge=0.8168 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=33 local utility u=0.659844 metrics={'f1_val': 0.5872077109123568, 'auprc': 0.9395611197381536, 'loss_val': 0.9366134913372476, 'psi': 0.7281490744426755}-{'f1_val': 0.4786624739143981, 'auprc': 0.7644358559170036, 'loss_val': 1.0796532907859142, 'psi': 0.5929718267154402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9832
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.4130
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.5864
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.9648
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=0.9762
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.5768
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9591 head_norm=1.420014
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.427701e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9608 head_norm=1.408019 delta_norm=0.742770
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9946 head_norm=1.628783
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.522195e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9944 head_norm=1.575635 delta_norm=0.152220
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9956 head_norm=1.358367
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.190381e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9956 head_norm=1.114892 delta_norm=0.719038
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9903 head_norm=1.124624
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.474778e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9899 head_norm=1.208741 delta_norm=0.647478
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9958 head_norm=1.671510
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.829287e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9958 head_norm=1.804024 delta_norm=0.282929
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.9963 head_norm=1.579806
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.832447e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.9963 head_norm=1.615947 delta_norm=0.183245
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.379331 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=34 local utility u=0.734238 metrics={'f1_val': 0.6648067011665689, 'auprc': 0.770347599225989, 'loss_val': 0.6798026013783202, 'psi': 0.7070230603903369}-{'f1_val': 0.551341068435625, 'auprc': 0.6553459370590345, 'loss_val': 1.1224805759980847, 'psi': 0.5929430158849889}
[S3] START round=34 head_norm_before_train=1.408019 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9106878039332857, 'auprc': 0.9981060575534879, 'loss_val': 0.19267650705244632, 'psi': 0.9456551053813667}-{'f1_val': 0.9590523247935165, 'auprc': 0.9968541891833446, 'loss_val': 0.1460580210763226, 'psi': 0.9741730705494478}
[S4] START round=34 head_norm_before_train=1.904121 (no previous merge yet)
[S4] round=34 local utility u=0.068526 metrics={'f1_val': 0.948214428283195, 'auprc': 0.9598858348689234, 'loss_val': 0.28522569857617175, 'psi': 0.9528829909174864}-{'f1_val': 0.9390454423825844, 'auprc': 0.9379100444429311, 'loss_val': 0.30133684945883793, 'psi': 0.938591283206723}
[S5] START round=34 head_norm_before_train=1.615947 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9951536577279526, 'loss_val': 0.09875989897544195, 'psi': 0.9958617502693151}-{'f1_val': 0.9963338119635569, 'auprc': 0.9975324526829927, 'loss_val': 0.09539791825904843, 'psi': 0.9968132682513311}
[S6] START round=34 head_norm_before_train=1.511105 cos_to_last_merge=0.8129 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=34 local utility u=0.368468 metrics={'f1_val': 0.8300280041923381, 'auprc': 0.9465267672622067, 'loss_val': 0.4434284449725952, 'psi': 0.8766275094202856}-{'f1_val': 0.7729670517272769, 'auprc': 0.8554158226253011, 'loss_val': 0.5646664947037497, 'psi': 0.8059465600864866}
[S7] START round=34 head_norm_before_train=1.778594 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6015977843767679, 'auprc': 0.795393855659956, 'loss_val': 0.742105459343862, 'psi': 0.6791162128900432}-{'f1_val': 0.6235884151560729, 'auprc': 0.8079594091249214, 'loss_val': 0.49025467763355307, 'psi': 0.6973368127436124}
[S8] START round=34 head_norm_before_train=1.294156 cos_to_last_merge=0.9993 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9836229587527714, 'auprc': 0.9986004810828484, 'loss_val': 0.1187401952402593, 'psi': 0.9896139676848021}-{'f1_val': 0.9925289693239863, 'auprc': 0.9985297061056246, 'loss_val': 0.11856666048461882, 'psi': 0.9949292640366416}
[S9] START round=34 head_norm_before_train=1.114892 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.009534 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9957057419691725, 'loss_val': 0.0936330780928827, 'psi': 0.9963938480430233}-{'f1_val': 0.9956098104564366, 'auprc': 0.9989347758208608, 'loss_val': 0.1149309351155035, 'psi': 0.9969397966022062}
[S10] START round=34 head_norm_before_train=1.575635 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9935173467861318, 'auprc': 0.9964229405667967, 'loss_val': 0.07900629209516771, 'psi': 0.9946795842983978}-{'f1_val': 0.994614115641838, 'auprc': 0.9961388788531798, 'loss_val': 0.061098124279391125, 'psi': 0.9952240209263747}
[S11] START round=34 head_norm_before_train=1.968543 cos_to_last_merge=0.9997 (last merge round=31)
[S11] round=34 local utility u=0.002370 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9986298954749748, 'loss_val': 0.03349863041532076, 'psi': 0.9972229752723634}-{'f1_val': 0.9958716985726862, 'auprc': 0.9986399300792931, 'loss_val': 0.03578954725964842, 'psi': 0.996978991175329}
[S13] START round=34 head_norm_before_train=1.535793 cos_to_last_merge=0.8183 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5568322670785653, 'auprc': 0.6253689071857654, 'loss_val': 1.1803484110855182, 'psi': 0.5842469231214453}-{'f1_val': 0.6196361662500398, 'auprc': 0.6422252383992376, 'loss_val': 0.561511299262076, 'psi': 0.6286717951097189}
[S14] START round=34 head_norm_before_train=1.277648 cos_to_last_merge=0.9991 (last merge round=32)
[S14] round=34 local utility u=0.018108 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.995813586572921, 'loss_val': 0.11838593537456883, 'psi': 0.9963918992006302}-{'f1_val': 0.996754531653698, 'auprc': 0.9944342357762952, 'loss_val': 0.1503263552051239, 'psi': 0.9958264133027369}
[S15] START round=34 head_norm_before_train=1.804024 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6973574743115082, 'auprc': 0.9476309755972312, 'loss_val': 0.42779211056217625, 'psi': 0.7974668748257974}-{'f1_val': 0.9958217461321837, 'auprc': 0.9902300935953798, 'loss_val': 0.0584005066883743, 'psi': 0.9935850851174621}
[S16] START round=34 head_norm_before_train=1.208741 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8508516972031784, 'auprc': 0.889047992516089, 'loss_val': 0.6320877740287391, 'psi': 0.8661302153283427}-{'f1_val': 0.9903047297834456, 'auprc': 0.9940888801869481, 'loss_val': 0.18026527684671878, 'psi': 0.9918183899448465}
[S17] START round=34 head_norm_before_train=1.746999 cos_to_last_merge=0.8165 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=34 local utility u=0.397713 metrics={'f1_val': 0.6466324637333967, 'auprc': 0.9777886430335652, 'loss_val': 0.6124192907833593, 'psi': 0.7790949354534641}-{'f1_val': 0.5872077109123568, 'auprc': 0.9395611197381536, 'loss_val': 0.9366134913372476, 'psi': 0.7281490744426755}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S6] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S6
[S8] cosine check vs S6: cos=0.9352
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.5365
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9921
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.5546
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] cosine check vs S2: cos=0.0704
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9949
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.9052
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.6974 head_norm=1.816425
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.925084e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.6958 head_norm=1.455662 delta_norm=0.492508
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9836 head_norm=1.336238
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.106715e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9822 head_norm=1.217875 delta_norm=0.210671
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9107 head_norm=1.464076
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.801158e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9031 head_norm=1.574704 delta_norm=0.380116
[S3] aggregate: ROLLBACK (f1_val pre=0.911 post=0.903 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9963 head_norm=1.983542
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.055787e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9963 head_norm=1.942992 delta_norm=0.105579
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.8509 head_norm=1.248298
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.854766e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.8551 head_norm=1.064678 delta_norm=0.585477
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.393540 cos_to_last_merge=0.9995 (last merge round=32)
[S2] round=35 local utility u=0.200656 metrics={'f1_val': 0.7127044635925586, 'auprc': 0.7582050057282563, 'loss_val': 0.5294495297522608, 'psi': 0.7309046804468377}-{'f1_val': 0.6648067011665689, 'auprc': 0.770347599225989, 'loss_val': 0.6798026013783202, 'psi': 0.7070230603903369}
[S3] START round=35 head_norm_before_train=1.574704 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.235715 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.9976959047776004, 'loss_val': 0.10397891683812831, 'psi': 0.9838873250797792}-{'f1_val': 0.9106878039332857, 'auprc': 0.9981060575534879, 'loss_val': 0.19267650705244632, 'psi': 0.9456551053813667}
[S4] START round=35 head_norm_before_train=1.907430 (no previous merge yet)
[S4] round=35 local utility u=0.009044 metrics={'f1_val': 0.949260276962345, 'auprc': 0.9635444727948901, 'loss_val': 0.2843894117335875, 'psi': 0.9549739552953631}-{'f1_val': 0.948214428283195, 'auprc': 0.9598858348689234, 'loss_val': 0.28522569857617175, 'psi': 0.9528829909174864}
[S5] START round=35 head_norm_before_train=1.651119 cos_to_last_merge=0.9993 (last merge round=33)
[S5] round=35 local utility u=0.014670 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9976360091237851, 'loss_val': 0.07686695961942779, 'psi': 0.9968546908276481}-{'f1_val': 0.9963338119635569, 'auprc': 0.9951536577279526, 'loss_val': 0.09875989897544195, 'psi': 0.9958617502693151}
[S6] START round=35 head_norm_before_train=1.523680 cos_to_last_merge=0.8116 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.812
[S6] round=35 local utility u=0.108197 metrics={'f1_val': 0.8468756734733317, 'auprc': 0.9485297166398098, 'loss_val': 0.3341288672392759, 'psi': 0.8875372907399229}-{'f1_val': 0.8300280041923381, 'auprc': 0.9465267672622067, 'loss_val': 0.4434284449725952, 'psi': 0.8766275094202856}
[S7] START round=35 head_norm_before_train=1.793562 (no previous merge yet)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.773337011753472, 'auprc': 0.9923876342495368, 'loss_val': 0.14578670223860488, 'psi': 0.8609572607518979}-{'f1_val': 0.6015977843767679, 'auprc': 0.795393855659956, 'loss_val': 0.742105459343862, 'psi': 0.6791162128900432}
[S8] START round=35 head_norm_before_train=1.217875 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.025739 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9947024881184414, 'loss_val': 0.12170619893505108, 'psi': 0.9946685742050025}-{'f1_val': 0.9836229587527714, 'auprc': 0.9986004810828484, 'loss_val': 0.1187401952402593, 'psi': 0.9896139676848021}
[S9] START round=35 head_norm_before_train=1.180846 cos_to_last_merge=0.9981 (last merge round=33)
[S9] round=35 local utility u=0.005604 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9933533655117094, 'loss_val': 0.07290454314499455, 'psi': 0.9952066447116097}-{'f1_val': 0.9968525854255906, 'auprc': 0.9957057419691725, 'loss_val': 0.0936330780928827, 'psi': 0.9963938480430233}
[S10] START round=35 head_norm_before_train=1.604380 cos_to_last_merge=0.9996 (last merge round=33)
[S10] round=35 local utility u=0.003747 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.995385782607308, 'loss_val': 0.06708572839315255, 'psi': 0.994133241788946}-{'f1_val': 0.9935173467861318, 'auprc': 0.9964229405667967, 'loss_val': 0.07900629209516771, 'psi': 0.9946795842983978}
[S11] START round=35 head_norm_before_train=1.942992 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9985190683247187, 'loss_val': 0.03940149231695761, 'psi': 0.997178644412261}-{'f1_val': 0.9962850284706224, 'auprc': 0.9986298954749748, 'loss_val': 0.03349863041532076, 'psi': 0.9972229752723634}
[S13] START round=35 head_norm_before_train=1.541630 cos_to_last_merge=0.8180 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=35 local utility u=0.092915 metrics={'f1_val': 0.5598979822123549, 'auprc': 0.6001984212625961, 'loss_val': 0.9374012937461272, 'psi': 0.5760181578324514}-{'f1_val': 0.5568322670785653, 'auprc': 0.6253689071857654, 'loss_val': 1.1803484110855182, 'psi': 0.5842469231214453}
[S14] START round=35 head_norm_before_train=1.313733 cos_to_last_merge=0.9972 (last merge round=32)
[S14] round=35 local utility u=0.006814 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9944778833706551, 'loss_val': 0.10307810598387535, 'psi': 0.9960903291469172}-{'f1_val': 0.9967774409524363, 'auprc': 0.995813586572921, 'loss_val': 0.11838593537456883, 'psi': 0.9963918992006302}
[S15] START round=35 head_norm_before_train=1.455662 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.374030 metrics={'f1_val': 0.7754787827068472, 'auprc': 0.9882753993680167, 'loss_val': 0.27039339327959755, 'psi': 0.860597429371315}-{'f1_val': 0.6973574743115082, 'auprc': 0.9476309755972312, 'loss_val': 0.42779211056217625, 'psi': 0.7974668748257974}
[S16] START round=35 head_norm_before_train=1.064678 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.652536 metrics={'f1_val': 0.9528932234327769, 'auprc': 0.9947078401910292, 'loss_val': 0.2562454239790747, 'psi': 0.9696190701360778}-{'f1_val': 0.8508516972031784, 'auprc': 0.889047992516089, 'loss_val': 0.6320877740287391, 'psi': 0.8661302153283427}
[S17] START round=35 head_norm_before_train=1.762056 cos_to_last_merge=0.8162 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6068424434796706, 'auprc': 0.959156941900847, 'loss_val': 0.8810517117556397, 'psi': 0.7477682428481411}-{'f1_val': 0.6466324637333967, 'auprc': 0.9777886430335652, 'loss_val': 0.6124192907833593, 'psi': 0.7790949354534641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.8932
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.1418
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.8594
[S2] RECEIVED delta(kind=head bytes=1805) from S3
[S2] cosine check vs S3: cos=0.8559
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.2729
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.9192
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9808
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9980
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=0.9887
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.6322
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.8415
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=0.5900
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.6520
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9963 head_norm=1.956997
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.418814e-02
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9963 head_norm=1.936770 delta_norm=0.064188
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.008 → S15@127.0.0.1:44915
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.9964 head_norm=1.236940
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.272943e-01
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.9964 head_norm=1.141175 delta_norm=0.227294
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.010 → S16@127.0.0.1:44916
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9946 head_norm=1.257373
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.223968e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9943 head_norm=1.196198 delta_norm=0.122397
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.033 → S9@127.0.0.1:44910
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.7755 head_norm=1.470980
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.686475e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.7727 head_norm=1.148971 delta_norm=0.868647
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.355 → S5@127.0.0.1:44905
[S13] ⇄ pheromone p=0.123 → S10@127.0.0.1:44911
[S6] ⇄ pheromone p=0.254 → S8@127.0.0.1:44909
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9933 head_norm=1.633881
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.270672e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9930 head_norm=1.585827 delta_norm=0.127067
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.010 → S9@127.0.0.1:44910
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9972 head_norm=1.348287
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.731430e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9972 head_norm=1.204838 delta_norm=0.273143
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.013 → S8@127.0.0.1:44909
[S4] ⇄ pheromone p=0.029 → S11@127.0.0.1:44912
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.7127 head_norm=1.409108
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.192335e-01
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.7067 head_norm=1.459687 delta_norm=0.419234
[S2] aggregate: ROLLBACK (f1_val pre=0.713 post=0.707 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.167 → S15@127.0.0.1:44915
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.9747 head_norm=1.620895
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.122927e+00
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.9636 head_norm=1.294194 delta_norm=1.122927
[S3] aggregate: ROLLBACK (f1_val pre=0.975 post=0.964 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.066 → S2@127.0.0.1:44902
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9529 head_norm=1.111127
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.916824e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9586 head_norm=1.104307 delta_norm=0.191682
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.276 → S14@127.0.0.1:44914
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.9963 head_norm=1.685910
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.879862e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.9963 head_norm=1.570891 delta_norm=0.187986
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.137 → S16@127.0.0.1:44916
[S7] ⇄ pheromone p=0.339 → S3@127.0.0.1:44903
[S17] ⇄ pheromone p=0.203 → S3@127.0.0.1:44903
[S2] START round=36 head_norm_before_train=1.459687 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6860341250104227, 'auprc': 0.759136555560121, 'loss_val': 0.5641459500401965, 'psi': 0.715275097230302}-{'f1_val': 0.7127044635925586, 'auprc': 0.7582050057282563, 'loss_val': 0.5294495297522608, 'psi': 0.7309046804468377}
[S3] START round=36 head_norm_before_train=1.294194 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.074812 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9982814182965305, 'loss_val': 0.0899432690586482, 'psi': 0.9975047139385763}-{'f1_val': 0.9746816052812316, 'auprc': 0.9976959047776004, 'loss_val': 0.10397891683812831, 'psi': 0.9838873250797792}
[S4] START round=36 head_norm_before_train=1.918479 (no previous merge yet)
[S4] round=36 local utility u=0.061414 metrics={'f1_val': 0.9570664239486889, 'auprc': 0.9839359538861923, 'loss_val': 0.269572705359988, 'psi': 0.9678142359236903}-{'f1_val': 0.949260276962345, 'auprc': 0.9635444727948901, 'loss_val': 0.2843894117335875, 'psi': 0.9549739552953631}
[S5] START round=36 head_norm_before_train=1.570891 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9885978726290506, 'loss_val': 0.10953183724180544, 'psi': 0.9929762491883508}-{'f1_val': 0.9963338119635569, 'auprc': 0.9976360091237851, 'loss_val': 0.07686695961942779, 'psi': 0.9968546908276481}
[S6] START round=36 head_norm_before_train=1.537356 cos_to_last_merge=0.8098 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.5839802391198986, 'auprc': 0.8000189739318424, 'loss_val': 0.8701087720759672, 'psi': 0.6703957330446761}-{'f1_val': 0.8468756734733317, 'auprc': 0.9485297166398098, 'loss_val': 0.3341288672392759, 'psi': 0.8875372907399229}
[S7] START round=36 head_norm_before_train=1.801251 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6353527784770584, 'auprc': 0.8150744265559786, 'loss_val': 0.4502966094051713, 'psi': 0.7072414377086265}-{'f1_val': 0.773337011753472, 'auprc': 0.9923876342495368, 'loss_val': 0.14578670223860488, 'psi': 0.8609572607518979}
[S8] START round=36 head_norm_before_train=1.196198 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.997821248509257, 'loss_val': 0.12671209406988526, 'psi': 0.9946458809980945}-{'f1_val': 0.9946459649293765, 'auprc': 0.9947024881184414, 'loss_val': 0.12170619893505108, 'psi': 0.9946685742050025}
[S9] START round=36 head_norm_before_train=1.141175 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9974830587010376, 'loss_val': 0.08976899425913368, 'psi': 0.9971047747357693}-{'f1_val': 0.99644216417821, 'auprc': 0.9933533655117094, 'loss_val': 0.07290454314499455, 'psi': 0.9952066447116097}
[S10] START round=36 head_norm_before_train=1.585827 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9928774807425635, 'auprc': 0.9939568079115695, 'loss_val': 0.08038423876187614, 'psi': 0.9933092116101659}-{'f1_val': 0.9932982145767046, 'auprc': 0.995385782607308, 'loss_val': 0.06708572839315255, 'psi': 0.994133241788946}
[S11] START round=36 head_norm_before_train=1.936770 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9986177201137956, 'loss_val': 0.041357728072220726, 'psi': 0.9972181051278917}-{'f1_val': 0.9962850284706224, 'auprc': 0.9985190683247187, 'loss_val': 0.03940149231695761, 'psi': 0.997178644412261}
[S13] START round=36 head_norm_before_train=1.546745 cos_to_last_merge=0.8187 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=36 local utility u=0.542876 metrics={'f1_val': 0.6361613663639382, 'auprc': 0.6944734878454737, 'loss_val': 0.5920556985666902, 'psi': 0.6594862149565524}-{'f1_val': 0.5598979822123549, 'auprc': 0.6001984212625961, 'loss_val': 0.9374012937461272, 'psi': 0.5760181578324514}
[S14] START round=36 head_norm_before_train=1.204838 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.993758077861964, 'loss_val': 0.12915931156617963, 'psi': 0.9955559501370044}-{'f1_val': 0.9971652929977585, 'auprc': 0.9944778833706551, 'loss_val': 0.10307810598387535, 'psi': 0.9960903291469172}
[S15] START round=36 head_norm_before_train=1.148971 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.696261 metrics={'f1_val': 0.9945011593043623, 'auprc': 0.9969713617664119, 'loss_val': 0.2180934018323485, 'psi': 0.9954892402891822}-{'f1_val': 0.7754787827068472, 'auprc': 0.9882753993680167, 'loss_val': 0.27039339327959755, 'psi': 0.860597429371315}
[S16] START round=36 head_norm_before_train=1.104307 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.144350 metrics={'f1_val': 0.9898700237451007, 'auprc': 0.9897301797424617, 'loss_val': 0.17447271910447024, 'psi': 0.9898140861440451}-{'f1_val': 0.9528932234327769, 'auprc': 0.9947078401910292, 'loss_val': 0.2562454239790747, 'psi': 0.9696190701360778}
[S17] START round=36 head_norm_before_train=1.774253 cos_to_last_merge=0.8158 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5307944025170264, 'auprc': 0.74508378544745, 'loss_val': 1.276640242296704, 'psi': 0.6165101556891959}-{'f1_val': 0.6068424434796706, 'auprc': 0.959156941900847, 'loss_val': 0.8810517117556397, 'psi': 0.7477682428481411}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.8762
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9743
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.8041
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9989
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.9945
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9968 head_norm=1.242277
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.427003e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9968 head_norm=1.190385 delta_norm=0.142700
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.9959 head_norm=1.600778
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.790002e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.9959 head_norm=1.320865 delta_norm=0.479000
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.6860 head_norm=1.471743
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.560581e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.6819 head_norm=1.368041 delta_norm=0.356058
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9963 head_norm=1.950823
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.560949e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9963 head_norm=1.941070 delta_norm=0.045609
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.9929 head_norm=1.613089
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.863234e-02
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.9933 head_norm=1.578883 delta_norm=0.088632
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.368041 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.039204 metrics={'f1_val': 0.6868833345744965, 'auprc': 0.7853119424399816, 'loss_val': 0.5693602797006241, 'psi': 0.7262547777206905}-{'f1_val': 0.6860341250104227, 'auprc': 0.759136555560121, 'loss_val': 0.5641459500401965, 'psi': 0.715275097230302}
[S3] START round=37 head_norm_before_train=1.352996 cos_to_last_merge=0.9987 (last merge round=35)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9976379412286429, 'loss_val': 0.14249716185143765, 'psi': 0.9755234681083165}-{'f1_val': 0.9969869110332736, 'auprc': 0.9982814182965305, 'loss_val': 0.0899432690586482, 'psi': 0.9975047139385763}
[S4] START round=37 head_norm_before_train=1.932345 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9509428593029288, 'auprc': 0.9724269404347412, 'loss_val': 0.2842979537773362, 'psi': 0.9595364917556538}-{'f1_val': 0.9570664239486889, 'auprc': 0.9839359538861923, 'loss_val': 0.269572705359988, 'psi': 0.9678142359236903}
[S5] START round=37 head_norm_before_train=1.320865 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.996879960797065, 'loss_val': 0.15666141646820964, 'psi': 0.9965522714969601}-{'f1_val': 0.995895166894551, 'auprc': 0.9885978726290506, 'loss_val': 0.10953183724180544, 'psi': 0.9929762491883508}
[S6] START round=37 head_norm_before_train=1.549451 cos_to_last_merge=0.8085 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=37 local utility u=0.514879 metrics={'f1_val': 0.6732139749921495, 'auprc': 0.9111161564249338, 'loss_val': 0.7090453716237595, 'psi': 0.7683748475652632}-{'f1_val': 0.5839802391198986, 'auprc': 0.8000189739318424, 'loss_val': 0.8701087720759672, 'psi': 0.6703957330446761}
[S7] START round=37 head_norm_before_train=1.803154 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.535148149545363, 'auprc': 0.7927400469191268, 'loss_val': 0.6944876302668432, 'psi': 0.6381849084948685}-{'f1_val': 0.6353527784770584, 'auprc': 0.8150744265559786, 'loss_val': 0.4502966094051713, 'psi': 0.7072414377086265}
[S8] START round=37 head_norm_before_train=1.232904 cos_to_last_merge=0.9995 (last merge round=35)
[S8] round=37 local utility u=0.007644 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9981930844104085, 'loss_val': 0.10823190991749072, 'psi': 0.9943638144618693}-{'f1_val': 0.9925289693239863, 'auprc': 0.997821248509257, 'loss_val': 0.12671209406988526, 'psi': 0.9946458809980945}
[S9] START round=37 head_norm_before_train=1.194743 cos_to_last_merge=0.9988 (last merge round=35)
[S9] round=37 local utility u=0.007214 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9953663853974241, 'loss_val': 0.06899067017831928, 'psi': 0.996258105414324}-{'f1_val': 0.9968525854255906, 'auprc': 0.9974830587010376, 'loss_val': 0.08976899425913368, 'psi': 0.9971047747357693}
[S10] START round=37 head_norm_before_train=1.578883 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9928774807425635, 'auprc': 0.9933385068427354, 'loss_val': 0.08480685228313303, 'psi': 0.9930618911826323}-{'f1_val': 0.9928774807425635, 'auprc': 0.9939568079115695, 'loss_val': 0.08038423876187614, 'psi': 0.9933092116101659}
[S11] START round=37 head_norm_before_train=1.941070 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000326 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9982590134156885, 'loss_val': 0.03962928028770668, 'psi': 0.9970746224486489}-{'f1_val': 0.9962850284706224, 'auprc': 0.9986177201137956, 'loss_val': 0.041357728072220726, 'psi': 0.9972181051278917}
[S13] START round=37 head_norm_before_train=1.548998 cos_to_last_merge=0.8188 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5587231594734346, 'auprc': 0.6052740918113784, 'loss_val': 1.207035616811533, 'psi': 0.5773435324086121}-{'f1_val': 0.6361613663639382, 'auprc': 0.6944734878454737, 'loss_val': 0.5920556985666902, 'psi': 0.6594862149565524}
[S14] START round=37 head_norm_before_train=1.190385 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9950831367312833, 'loss_val': 0.13702867387564652, 'psi': 0.9960864311421747}-{'f1_val': 0.996754531653698, 'auprc': 0.993758077861964, 'loss_val': 0.12915931156617963, 'psi': 0.9955559501370044}
[S15] START round=37 head_norm_before_train=1.177183 cos_to_last_merge=0.9992 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7000425947034489, 'auprc': 0.9679110656609466, 'loss_val': 0.40034660228955393, 'psi': 0.807189983086448}-{'f1_val': 0.9945011593043623, 'auprc': 0.9969713617664119, 'loss_val': 0.2180934018323485, 'psi': 0.9954892402891822}
[S16] START round=37 head_norm_before_train=1.153909 cos_to_last_merge=0.9980 (last merge round=35)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9384392230353018, 'auprc': 0.9931872722229096, 'loss_val': 0.25661787878680414, 'psi': 0.9603384427103449}-{'f1_val': 0.9898700237451007, 'auprc': 0.9897301797424617, 'loss_val': 0.17447271910447024, 'psi': 0.9898140861440451}
[S17] START round=37 head_norm_before_train=1.785246 cos_to_last_merge=0.8153 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=37 local utility u=0.443680 metrics={'f1_val': 0.5962667054379073, 'auprc': 0.8198478788699749, 'loss_val': 1.0064062746554125, 'psi': 0.6856991748107344}-{'f1_val': 0.5307944025170264, 'auprc': 0.74508378544745, 'loss_val': 1.276640242296704, 'psi': 0.6165101556891959}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.7806
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.8622
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=0.7744
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] cosine check vs S2: cos=0.7531
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.6129
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.5912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9969 head_norm=1.249492
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.181620e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9969 head_norm=1.190675 delta_norm=0.418162
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9608 head_norm=1.412373
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.449972e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9608 head_norm=1.433232 delta_norm=0.744997
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.7000 head_norm=1.216575
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.915872e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.7000 head_norm=1.182708 delta_norm=0.191587
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9384 head_norm=1.204261
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.125715e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9397 head_norm=1.155648 delta_norm=0.412571
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9918 head_norm=1.274325
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.967627e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9918 head_norm=1.368004 delta_norm=0.396763
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.380365 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=38 local utility u=0.094912 metrics={'f1_val': 0.7110829422314071, 'auprc': 0.7754091159754299, 'loss_val': 0.49502618471657833, 'psi': 0.7368134117290163}-{'f1_val': 0.6868833345744965, 'auprc': 0.7853119424399816, 'loss_val': 0.5693602797006241, 'psi': 0.7262547777206905}
[S3] START round=38 head_norm_before_train=1.433232 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.129134 metrics={'f1_val': 0.9952332925992696, 'auprc': 0.9987804402008591, 'loss_val': 0.09437397782710666, 'psi': 0.9966521516399054}-{'f1_val': 0.9607804860280988, 'auprc': 0.9976379412286429, 'loss_val': 0.14249716185143765, 'psi': 0.9755234681083165}
[S4] START round=38 head_norm_before_train=1.939509 (no previous merge yet)
[S4] round=38 local utility u=0.003698 metrics={'f1_val': 0.9562640164891321, 'auprc': 0.9617741633345016, 'loss_val': 0.27687019082078257, 'psi': 0.95846807522728}-{'f1_val': 0.9509428593029288, 'auprc': 0.9724269404347412, 'loss_val': 0.2842979537773362, 'psi': 0.9595364917556538}
[S5] START round=38 head_norm_before_train=1.358087 cos_to_last_merge=0.9989 (last merge round=36)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9114606047921807, 'auprc': 0.9871044290624756, 'loss_val': 0.2086895980928561, 'psi': 0.9417181345002987}-{'f1_val': 0.9963338119635569, 'auprc': 0.996879960797065, 'loss_val': 0.15666141646820964, 'psi': 0.9965522714969601}
[S6] START round=38 head_norm_before_train=1.560066 cos_to_last_merge=0.8071 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=38 local utility u=0.453778 metrics={'f1_val': 0.780299660465854, 'auprc': 0.9341743313884768, 'loss_val': 0.5131782362420264, 'psi': 0.841849528834903}-{'f1_val': 0.6732139749921495, 'auprc': 0.9111161564249338, 'loss_val': 0.7090453716237595, 'psi': 0.7683748475652632}
[S7] START round=38 head_norm_before_train=1.805941 (no previous merge yet)
[S7] round=38 local utility u=0.551283 metrics={'f1_val': 0.6490167868574007, 'auprc': 0.8350425627770384, 'loss_val': 0.4020416685870869, 'psi': 0.7234270972252558}-{'f1_val': 0.535148149545363, 'auprc': 0.7927400469191268, 'loss_val': 0.6944876302668432, 'psi': 0.6381849084948685}
[S8] START round=38 head_norm_before_train=1.368004 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9984988702800075, 'loss_val': 0.09921112063331401, 'psi': 0.9916817938844718}-{'f1_val': 0.9918109678295097, 'auprc': 0.9981930844104085, 'loss_val': 0.10823190991749072, 'psi': 0.9943638144618693}
[S9] START round=38 head_norm_before_train=1.190675 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.001633 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9979014100494373, 'loss_val': 0.07217814417860424, 'psi': 0.9971568711081098}-{'f1_val': 0.9968525854255906, 'auprc': 0.9953663853974241, 'loss_val': 0.06899067017831928, 'psi': 0.996258105414324}
[S10] START round=38 head_norm_before_train=1.608530 cos_to_last_merge=0.9994 (last merge round=36)
[S10] round=38 local utility u=0.009007 metrics={'f1_val': 0.9928774807425635, 'auprc': 0.9937819128234479, 'loss_val': 0.06812215544569619, 'psi': 0.9932392535749173}-{'f1_val': 0.9928774807425635, 'auprc': 0.9933385068427354, 'loss_val': 0.08480685228313303, 'psi': 0.9930618911826323}
[S11] START round=38 head_norm_before_train=1.957307 cos_to_last_merge=0.9998 (last merge round=36)
[S11] round=38 local utility u=0.002496 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9985675116833335, 'loss_val': 0.03556219018114478, 'psi': 0.9971980217557068}-{'f1_val': 0.9962850284706224, 'auprc': 0.9982590134156885, 'loss_val': 0.03962928028770668, 'psi': 0.9970746224486489}
[S13] START round=38 head_norm_before_train=1.554716 cos_to_last_merge=0.8187 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=38 local utility u=0.259472 metrics={'f1_val': 0.5902035955084028, 'auprc': 0.6407081384750534, 'loss_val': 0.9832759585385905, 'psi': 0.6104054126950631}-{'f1_val': 0.5587231594734346, 'auprc': 0.6052740918113784, 'loss_val': 1.207035616811533, 'psi': 0.5773435324086121}
[S14] START round=38 head_norm_before_train=1.230805 cos_to_last_merge=0.9991 (last merge round=36)
[S14] round=38 local utility u=0.020732 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9983405510446234, 'loss_val': 0.1051997822407979, 'psi': 0.9973757349172458}-{'f1_val': 0.9967552940827689, 'auprc': 0.9950831367312833, 'loss_val': 0.13702867387564652, 'psi': 0.9960864311421747}
[S15] START round=38 head_norm_before_train=1.182708 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.862202 metrics={'f1_val': 0.9393483497521811, 'auprc': 0.9913276926971378, 'loss_val': 0.1820268158228274, 'psi': 0.9601400869301637}-{'f1_val': 0.7000425947034489, 'auprc': 0.9679110656609466, 'loss_val': 0.40034660228955393, 'psi': 0.807189983086448}
[S16] START round=38 head_norm_before_train=1.155648 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9382396077557407, 'auprc': 0.9885284857325043, 'loss_val': 0.2703712971881431, 'psi': 0.9583551589464462}-{'f1_val': 0.9384392230353018, 'auprc': 0.9931872722229096, 'loss_val': 0.25661787878680414, 'psi': 0.9603384427103449}
[S17] START round=38 head_norm_before_train=1.795425 cos_to_last_merge=0.8149 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=38 local utility u=0.321097 metrics={'f1_val': 0.6229257156986203, 'auprc': 0.9739089078108815, 'loss_val': 0.9863484654551508, 'psi': 0.7633189925435248}-{'f1_val': 0.5962667054379073, 'auprc': 0.8198478788699749, 'loss_val': 1.0064062746554125, 'psi': 0.6856991748107344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] → sending delta(kind=head bytes=1809) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1809 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1809) from S10
[S13] cosine check vs S10: cos=0.9928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] cosine check vs S9: cos=0.8727
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.9579
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.9983
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.3400
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=0.9409
[S2] RECEIVED delta(kind=head bytes=1804) from S15
[S2] cosine check vs S15: cos=0.6515
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6490 head_norm=1.820411
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.594102e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6421 head_norm=1.356482 delta_norm=0.959410
[S7] aggregate: ROLLBACK (f1_val pre=0.649 post=0.642 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9871 head_norm=1.407264
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.436234e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9871 head_norm=1.283041 delta_norm=0.343623
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.7111 head_norm=1.394466
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.529189e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.7114 head_norm=1.193108 delta_norm=0.552919
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.5902 head_norm=1.562206
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.034605e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.5868 head_norm=1.597818 delta_norm=0.103461
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9563 head_norm=1.941864
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.904814e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9563 head_norm=1.956700 delta_norm=0.059048
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9952 head_norm=1.485640
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.136324e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9964 head_norm=1.424848 delta_norm=0.213632
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9382 head_norm=1.199108
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.159820e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9378 head_norm=1.218831 delta_norm=0.215982
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.193108 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.717468610084964, 'auprc': 0.772425626069144, 'loss_val': 0.5438328233106771, 'psi': 0.739451416478636}-{'f1_val': 0.7110829422314071, 'auprc': 0.7754091159754299, 'loss_val': 0.49502618471657833, 'psi': 0.7368134117290163}
[S3] START round=39 head_norm_before_train=1.424848 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9315810117892597, 'auprc': 0.9979816457779149, 'loss_val': 0.22870530020991428, 'psi': 0.9581412653847218}-{'f1_val': 0.9952332925992696, 'auprc': 0.9987804402008591, 'loss_val': 0.09437397782710666, 'psi': 0.9966521516399054}
[S4] START round=39 head_norm_before_train=1.956700 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.946468544217357, 'auprc': 0.9040831357590016, 'loss_val': 0.29547865519404914, 'psi': 0.9295143808340149}-{'f1_val': 0.9562640164891321, 'auprc': 0.9617741633345016, 'loss_val': 0.27687019082078257, 'psi': 0.95846807522728}
[S5] START round=39 head_norm_before_train=1.423636 cos_to_last_merge=0.9943 (last merge round=36)
[S5] round=39 local utility u=0.333348 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9979307721016965, 'loss_val': 0.08371098441962202, 'psi': 0.9969725960188127}-{'f1_val': 0.9114606047921807, 'auprc': 0.9871044290624756, 'loss_val': 0.2086895980928561, 'psi': 0.9417181345002987}
[S6] START round=39 head_norm_before_train=1.571306 cos_to_last_merge=0.8061 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6763788967799532, 'auprc': 0.9073786755781643, 'loss_val': 0.7840477466223481, 'psi': 0.7687788082992377}-{'f1_val': 0.780299660465854, 'auprc': 0.9341743313884768, 'loss_val': 0.5131782362420264, 'psi': 0.841849528834903}
[S7] START round=39 head_norm_before_train=1.356482 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.527508420305417, 'auprc': 0.787715182409394, 'loss_val': 0.8216519525994338, 'psi': 0.6315911251470079}-{'f1_val': 0.6490167868574007, 'auprc': 0.8350425627770384, 'loss_val': 0.4020416685870869, 'psi': 0.7234270972252558}
[S8] START round=39 head_norm_before_train=1.283041 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.023734 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9983909689071205, 'loss_val': 0.09280301097662615, 'psi': 0.9957769147074236}-{'f1_val': 0.9871370762874481, 'auprc': 0.9984988702800075, 'loss_val': 0.09921112063331401, 'psi': 0.9916817938844718}
[S9] START round=39 head_norm_before_train=1.244246 cos_to_last_merge=0.9990 (last merge round=37)
[S9] round=39 local utility u=0.008077 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981007475507953, 'loss_val': 0.05662287836230383, 'psi': 0.997236606108653}-{'f1_val': 0.9966605118138915, 'auprc': 0.9979014100494373, 'loss_val': 0.07217814417860424, 'psi': 0.9971568711081098}
[S10] START round=39 head_norm_before_train=1.639197 cos_to_last_merge=0.9977 (last merge round=36)
[S10] round=39 local utility u=0.007841 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.9943392166254993, 'loss_val': 0.05663712154763617, 'psi': 0.9937146153962225}-{'f1_val': 0.9928774807425635, 'auprc': 0.9937819128234479, 'loss_val': 0.06812215544569619, 'psi': 0.9932392535749173}
[S11] START round=39 head_norm_before_train=1.973192 cos_to_last_merge=0.9995 (last merge round=36)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9986490701352457, 'loss_val': 0.03709481374092347, 'psi': 0.99698264719771}-{'f1_val': 0.9962850284706224, 'auprc': 0.9985675116833335, 'loss_val': 0.03556219018114478, 'psi': 0.9971980217557068}
[S13] START round=39 head_norm_before_train=1.597818 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.346851 metrics={'f1_val': 0.6469683204391271, 'auprc': 0.6824291377148428, 'loss_val': 0.7553245032114432, 'psi': 0.6611526473494134}-{'f1_val': 0.5902035955084028, 'auprc': 0.6407081384750534, 'loss_val': 0.9832759585385905, 'psi': 0.6104054126950631}
[S14] START round=39 head_norm_before_train=1.275357 cos_to_last_merge=0.9965 (last merge round=36)
[S14] round=39 local utility u=0.010313 metrics={'f1_val': 0.996754531653698, 'auprc': 0.998241005264137, 'loss_val': 0.08440643408564681, 'psi': 0.9973491210978735}-{'f1_val': 0.9967325241656609, 'auprc': 0.9983405510446234, 'loss_val': 0.1051997822407979, 'psi': 0.9973757349172458}
[S15] START round=39 head_norm_before_train=1.230413 cos_to_last_merge=0.9988 (last merge round=37)
[S15] round=39 local utility u=0.201649 metrics={'f1_val': 0.995240660901568, 'auprc': 0.9931400184204716, 'loss_val': 0.11951911420180202, 'psi': 0.9944004039091294}-{'f1_val': 0.9393483497521811, 'auprc': 0.9913276926971378, 'loss_val': 0.1820268158228274, 'psi': 0.9601400869301637}
[S16] START round=39 head_norm_before_train=1.218831 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.239085 metrics={'f1_val': 0.990784718589554, 'auprc': 0.9883831880334334, 'loss_val': 0.1070351047392078, 'psi': 0.9898241063671057}-{'f1_val': 0.9382396077557407, 'auprc': 0.9885284857325043, 'loss_val': 0.2703712971881431, 'psi': 0.9583551589464462}
[S17] START round=39 head_norm_before_train=1.802520 cos_to_last_merge=0.8148 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=39 local utility u=0.063769 metrics={'f1_val': 0.6311834887215315, 'auprc': 0.9808348372028792, 'loss_val': 0.9291351710252941, 'psi': 0.7710440281140706}-{'f1_val': 0.6229257156986203, 'auprc': 0.9739089078108815, 'loss_val': 0.9863484654551508, 'psi': 0.7633189925435248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:44907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44905
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9849
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=0.8836
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9575
[S8] RECEIVED delta(kind=head bytes=1794) from S9
[S8] cosine check vs S9: cos=0.9575
[S5] RECEIVED delta(kind=head bytes=1793) from S16
[S5] cosine check vs S16: cos=0.6240
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=0.9963
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.8969
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.6470 head_norm=1.606137
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.691515e-02
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.6214 head_norm=1.635665 delta_norm=0.076915
[S13] aggregate: ROLLBACK (f1_val pre=0.647 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S13] r=40 psi=0.661 u=0.3469 p_local=0.2168 f1=0.647 auprc=0.682 bytes=30563
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.6764 head_norm=1.581420
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.531622e-01
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.6737 head_norm=1.412861 delta_norm=0.353162
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.769 u=0.0000 p_local=0.2425 f1=0.676 auprc=0.907 bytes=30526
[S7] r=40 psi=0.632 u=0.0000 p_local=0.2270 f1=0.528 auprc=0.788 bytes=21571
[S3] r=40 psi=0.958 u=0.0000 p_local=0.0555 f1=0.932 auprc=0.998 bytes=27014
[S4] r=40 psi=0.930 u=0.0000 p_local=0.0188 f1=0.946 auprc=0.904 bytes=28766
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=39 metric=0.7175 head_norm=1.216895
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.027418e-01
[S2] stored merged vector for next round verification (round=39)
[S2] DEBUG after merge:  round=39 metric=0.7188 head_norm=1.211686 delta_norm=0.302742
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] r=40 psi=0.739 u=0.0000 p_local=0.0886 f1=0.717 auprc=0.772 bytes=28791
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0039 f1=0.996 auprc=0.999 bytes=30600
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9952 head_norm=1.280171
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.236566e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9952 head_norm=1.364432 delta_norm=0.223657
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.994 u=0.2016 p_local=0.3951 f1=0.995 auprc=0.993 bytes=34224
[S14] r=40 psi=0.997 u=0.0103 p_local=0.0108 f1=0.997 auprc=0.998 bytes=32362
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9940 head_norm=1.319435
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.908705e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9940 head_norm=1.293717 delta_norm=0.190871
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.996 u=0.0237 p_local=0.0192 f1=0.994 auprc=0.998 bytes=32325
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.9963 head_norm=1.478025
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.019323e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.9963 head_norm=1.235451 delta_norm=0.601932
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.997 u=0.3333 p_local=0.1229 f1=0.996 auprc=0.998 bytes=28776
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9908 head_norm=1.262049
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.153395e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9908 head_norm=1.285200 delta_norm=0.115339
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.990 u=0.2391 p_local=0.1756 f1=0.991 auprc=0.988 bytes=32365
[S10] r=40 psi=0.994 u=0.0078 p_local=0.0072 f1=0.993 auprc=0.994 bytes=30596
[S9] r=40 psi=0.997 u=0.0081 p_local=0.0070 f1=0.997 auprc=0.998 bytes=34122
[S17] r=40 psi=0.771 u=0.0638 p_local=0.2042 f1=0.631 auprc=0.981 bytes=34201
[S2] START round=40 head_norm_before_train=1.211686 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.651331823904181, 'auprc': 0.7425673411860362, 'loss_val': 0.6163194707890911, 'psi': 0.6878260308169231}-{'f1_val': 0.717468610084964, 'auprc': 0.772425626069144, 'loss_val': 0.5438328233106771, 'psi': 0.739451416478636}
[S3] START round=40 head_norm_before_train=1.473630 cos_to_last_merge=0.9995 (last merge round=38)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.7209252831867832, 'auprc': 0.9840011346887172, 'loss_val': 0.4479649750249686, 'psi': 0.8261556237875568}-{'f1_val': 0.9315810117892597, 'auprc': 0.9979816457779149, 'loss_val': 0.22870530020991428, 'psi': 0.9581412653847218}
[S4] START round=40 head_norm_before_train=1.959949 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=40 local utility u=0.004251 metrics={'f1_val': 0.9406036472456429, 'auprc': 0.9239986841767084, 'loss_val': 0.31153454448763, 'psi': 0.9339616620180691}-{'f1_val': 0.946468544217357, 'auprc': 0.9040831357590016, 'loss_val': 0.29547865519404914, 'psi': 0.9295143808340149}
[S5] START round=40 head_norm_before_train=1.235451 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9884710396288103, 'loss_val': 0.15589959102091858, 'psi': 0.9931887030296582}-{'f1_val': 0.9963338119635569, 'auprc': 0.9979307721016965, 'loss_val': 0.08371098441962202, 'psi': 0.9969725960188127}
[S6] START round=40 head_norm_before_train=1.412861 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.734864 metrics={'f1_val': 0.8318792073886547, 'auprc': 0.9531435161302382, 'loss_val': 0.384615420278077, 'psi': 0.880384930885288}-{'f1_val': 0.6763788967799532, 'auprc': 0.9073786755781643, 'loss_val': 0.7840477466223481, 'psi': 0.7687788082992377}
[S7] START round=40 head_norm_before_train=1.387808 cos_to_last_merge=0.9996 (last merge round=38)
[S7] round=40 local utility u=0.164314 metrics={'f1_val': 0.5642884608085721, 'auprc': 0.795690455154433, 'loss_val': 0.7376298161702977, 'psi': 0.6568492585469164}-{'f1_val': 0.527508420305417, 'auprc': 0.787715182409394, 'loss_val': 0.8216519525994338, 'psi': 0.6315911251470079}
[S8] START round=40 head_norm_before_train=1.293717 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9599700569301723, 'auprc': 0.9985993693322939, 'loss_val': 0.18648536116703202, 'psi': 0.9754217818910209}-{'f1_val': 0.9940342119076258, 'auprc': 0.9983909689071205, 'loss_val': 0.09280301097662615, 'psi': 0.9957769147074236}
[S9] START round=40 head_norm_before_train=1.295903 cos_to_last_merge=0.9964 (last merge round=37)
[S9] round=40 local utility u=0.000040 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9949427725531451, 'loss_val': 0.04706841150998048, 'psi': 0.9959734161095929}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981007475507953, 'loss_val': 0.05662287836230383, 'psi': 0.997236606108653}
[S10] START round=40 head_norm_before_train=1.668220 cos_to_last_merge=0.9954 (last merge round=36)
[S10] round=40 local utility u=0.008374 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9944090844843544, 'loss_val': 0.04799367518439352, 'psi': 0.9945321031788446}-{'f1_val': 0.9932982145767046, 'auprc': 0.9943392166254993, 'loss_val': 0.05663712154763617, 'psi': 0.9937146153962225}
[S11] START round=40 head_norm_before_train=1.987146 cos_to_last_merge=0.9991 (last merge round=36)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9986577421209082, 'loss_val': 0.041944136064304, 'psi': 0.9969861159919751}-{'f1_val': 0.9958716985726862, 'auprc': 0.9986490701352457, 'loss_val': 0.03709481374092347, 'psi': 0.99698264719771}
[S13] START round=40 head_norm_before_train=1.635665 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5891364472746481, 'auprc': 0.6027973575389014, 'loss_val': 0.9691150653539002, 'psi': 0.5946008113803494}-{'f1_val': 0.6469683204391271, 'auprc': 0.6824291377148428, 'loss_val': 0.7553245032114432, 'psi': 0.6611526473494134}
[S14] START round=40 head_norm_before_train=1.318074 cos_to_last_merge=0.9930 (last merge round=36)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9640237483491745, 'auprc': 0.9962981679200729, 'loss_val': 0.09521969810497934, 'psi': 0.9769335161775339}-{'f1_val': 0.996754531653698, 'auprc': 0.998241005264137, 'loss_val': 0.08440643408564681, 'psi': 0.9973491210978735}
[S15] START round=40 head_norm_before_train=1.364432 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.013709 metrics={'f1_val': 0.9936222327465242, 'auprc': 0.9936816350487278, 'loss_val': 0.0840145600265252, 'psi': 0.9936459936674056}-{'f1_val': 0.995240660901568, 'auprc': 0.9931400184204716, 'loss_val': 0.11951911420180202, 'psi': 0.9944004039091294}
[S16] START round=40 head_norm_before_train=1.285200 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.010946 metrics={'f1_val': 0.9905655676273764, 'auprc': 0.990096267835773, 'loss_val': 0.08896719371196847, 'psi': 0.990377847710735}-{'f1_val': 0.990784718589554, 'auprc': 0.9883831880334334, 'loss_val': 0.1070351047392078, 'psi': 0.9898241063671057}
[S17] START round=40 head_norm_before_train=1.811810 cos_to_last_merge=0.8144 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5996636763457037, 'auprc': 0.9801771506167447, 'loss_val': 1.1200100499446344, 'psi': 0.7518690660541201}-{'f1_val': 0.6311834887215315, 'auprc': 0.9808348372028792, 'loss_val': 0.9291351710252941, 'psi': 0.7710440281140706}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=0.9282
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=0.9001
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9980
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] cosine check vs S9: cos=0.9852
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.6513 head_norm=1.237738
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.645399e-01
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.6594 head_norm=1.299509 delta_norm=0.264540
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.071 → S3@127.0.0.1:44903
[S3] ⇄ pheromone p=0.044 → S7@127.0.0.1:44908
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.9963 head_norm=1.278689
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.916186e-01
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.9963 head_norm=1.268042 delta_norm=0.291619
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.098 → S15@127.0.0.1:44915
[S7] ⇄ pheromone p=0.214 → S3@127.0.0.1:44903
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9600 head_norm=1.329535
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.149928e-01
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9612 head_norm=1.329592 delta_norm=0.114993
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.015 → S6@127.0.0.1:44907
[S10] ⇄ pheromone p=0.007 → S13@127.0.0.1:44913
[S11] ⇄ pheromone p=0.003 → S4@127.0.0.1:44904
[S9] ⇄ pheromone p=0.006 → S8@127.0.0.1:44909
[S16] ⇄ pheromone p=0.143 → S5@127.0.0.1:44905
[S15] ⇄ pheromone p=0.319 → S2@127.0.0.1:44902
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.5891 head_norm=1.644150
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.852874e-02
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.5919 head_norm=1.668126 delta_norm=0.058529
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.173 → S10@127.0.0.1:44911
[S14] ⇄ pheromone p=0.009 → S16@127.0.0.1:44916
[S2] START round=41 head_norm_before_train=1.299509 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.231492 metrics={'f1_val': 0.717692716182363, 'auprc': 0.763440512848987, 'loss_val': 0.6141209394829363, 'psi': 0.7359918348490125}-{'f1_val': 0.651331823904181, 'auprc': 0.7425673411860362, 'loss_val': 0.6163194707890911, 'psi': 0.6878260308169231}
[S3] START round=41 head_norm_before_train=1.511038 cos_to_last_merge=0.9986 (last merge round=38)
[S3] round=41 local utility u=0.866444 metrics={'f1_val': 0.956273782778326, 'auprc': 0.9911489856927826, 'loss_val': 0.14861117825483483, 'psi': 0.9702238639441086}-{'f1_val': 0.7209252831867832, 'auprc': 0.9840011346887172, 'loss_val': 0.4479649750249686, 'psi': 0.8261556237875568}
[S4] START round=41 head_norm_before_train=1.964883 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9354412679952072, 'auprc': 0.9007882351652781, 'loss_val': 0.3527651416207864, 'psi': 0.9215800548632356}-{'f1_val': 0.9406036472456429, 'auprc': 0.9239986841767084, 'loss_val': 0.31153454448763, 'psi': 0.9339616620180691}
[S5] START round=41 head_norm_before_train=1.268042 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.021680 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9961488769603327, 'loss_val': 0.13557325204325085, 'psi': 0.9962598379622671}-{'f1_val': 0.9963338119635569, 'auprc': 0.9884710396288103, 'loss_val': 0.15589959102091858, 'psi': 0.9931887030296582}
[S6] START round=41 head_norm_before_train=1.427622 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=41 local utility u=0.240775 metrics={'f1_val': 0.8819181777886426, 'auprc': 0.9686962403187807, 'loss_val': 0.2499577571284927, 'psi': 0.9166294028006978}-{'f1_val': 0.8318792073886547, 'auprc': 0.9531435161302382, 'loss_val': 0.384615420278077, 'psi': 0.880384930885288}
[S7] START round=41 head_norm_before_train=1.414739 cos_to_last_merge=0.9989 (last merge round=38)
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.9946499847495167, 'auprc': 0.99526918081223, 'loss_val': 0.16198122913435142, 'psi': 0.994897663174602}-{'f1_val': 0.5642884608085721, 'auprc': 0.795690455154433, 'loss_val': 0.7376298161702977, 'psi': 0.6568492585469164}
[S8] START round=41 head_norm_before_train=1.329592 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.148240 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9982548147043409, 'loss_val': 0.08432468271096281, 'psi': 0.994819307476128}-{'f1_val': 0.9599700569301723, 'auprc': 0.9985993693322939, 'loss_val': 0.18648536116703202, 'psi': 0.9754217818910209}
[S9] START round=41 head_norm_before_train=1.339557 cos_to_last_merge=0.9936 (last merge round=37)
[S9] round=41 local utility u=0.007921 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980864798131592, 'loss_val': 0.040656812967789335, 'psi': 0.9972308990135985}-{'f1_val': 0.9966605118138915, 'auprc': 0.9949427725531451, 'loss_val': 0.04706841150998048, 'psi': 0.9959734161095929}
[S10] START round=41 head_norm_before_train=1.693786 cos_to_last_merge=0.9931 (last merge round=36)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9944129591200672, 'auprc': 0.9904054212795265, 'loss_val': 0.04654226393227889, 'psi': 0.9928099439838509}-{'f1_val': 0.994614115641838, 'auprc': 0.9944090844843544, 'loss_val': 0.04799367518439352, 'psi': 0.9945321031788446}
[S11] START round=41 head_norm_before_train=1.998710 cos_to_last_merge=0.9986 (last merge round=36)
[S11] round=41 local utility u=0.002222 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987108738457728, 'loss_val': 0.0376588992881362, 'psi': 0.9970073686819209}-{'f1_val': 0.9958716985726862, 'auprc': 0.9986577421209082, 'loss_val': 0.041944136064304, 'psi': 0.9969861159919751}
[S13] START round=41 head_norm_before_train=1.668126 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.311987 metrics={'f1_val': 0.6043433070651919, 'auprc': 0.7335079592171176, 'loss_val': 0.8285134180512983, 'psi': 0.6560091679259622}-{'f1_val': 0.5891364472746481, 'auprc': 0.6027973575389014, 'loss_val': 0.9691150653539002, 'psi': 0.5946008113803494}
[S14] START round=41 head_norm_before_train=1.353653 cos_to_last_merge=0.9895 (last merge round=36)
[S14] round=41 local utility u=0.110026 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9956806235443133, 'loss_val': 0.0660551720238952, 'psi': 0.9959605537365276}-{'f1_val': 0.9640237483491745, 'auprc': 0.9962981679200729, 'loss_val': 0.09521969810497934, 'psi': 0.9769335161775339}
[S15] START round=41 head_norm_before_train=1.409047 cos_to_last_merge=0.9995 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9287374415389816, 'loss_val': 0.4349312440678097, 'psi': 0.7920464872365932}-{'f1_val': 0.9936222327465242, 'auprc': 0.9936816350487278, 'loss_val': 0.0840145600265252, 'psi': 0.9936459936674056}
[S16] START round=41 head_norm_before_train=1.323216 cos_to_last_merge=0.9996 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9657944374646938, 'auprc': 0.9939487928080548, 'loss_val': 0.13601416716978432, 'psi': 0.9770561796020382}-{'f1_val': 0.9905655676273764, 'auprc': 0.990096267835773, 'loss_val': 0.08896719371196847, 'psi': 0.990377847710735}
[S17] START round=41 head_norm_before_train=1.824927 cos_to_last_merge=0.8140 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6242917360310651, 'auprc': 0.8804641201200033, 'loss_val': 1.0605973265189637, 'psi': 0.7267606896666404}-{'f1_val': 0.5996636763457037, 'auprc': 0.9801771506167447, 'loss_val': 1.1200100499446344, 'psi': 0.7518690660541201}
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44904
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] cosine check vs S2: cos=0.9784
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.9982
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:44908
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9989
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.8958
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.8324
[S7] RECEIVED delta(kind=head bytes=1796) from S3
[S7] cosine check vs S3: cos=0.8324
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.8958
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] cosine check vs S9: cos=0.9938
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.8819 head_norm=1.447390
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.232968e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.8987 head_norm=1.367909 delta_norm=0.323297
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.9946 head_norm=1.439221
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.342105e-01
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.9941 head_norm=1.426485 delta_norm=0.434210
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9925 head_norm=1.362517
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.328981e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9925 head_norm=1.353711 delta_norm=0.132898
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S14
[S16] cosine check vs S14: cos=0.9929
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9563 head_norm=1.541247
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.342105e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9550 head_norm=1.426485 delta_norm=0.434210
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.8110
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9658 head_norm=1.355603
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.307671e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9692 head_norm=1.367634 delta_norm=0.083077
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.7009 head_norm=1.445671
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.354986e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.7009 head_norm=1.327522 delta_norm=0.235499
[S15] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.321795 cos_to_last_merge=0.9994 (last merge round=40)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6689278556482157, 'auprc': 0.7472303979458754, 'loss_val': 0.6433162911112768, 'psi': 0.7002488725672795}-{'f1_val': 0.717692716182363, 'auprc': 0.763440512848987, 'loss_val': 0.6141209394829363, 'psi': 0.7359918348490125}
[S3] START round=42 head_norm_before_train=1.426485 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.178961 metrics={'f1_val': 0.9967036075256503, 'auprc': 0.9981123015531712, 'loss_val': 0.054158503962360584, 'psi': 0.9972670851366586}-{'f1_val': 0.956273782778326, 'auprc': 0.9911489856927826, 'loss_val': 0.14861117825483483, 'psi': 0.9702238639441086}
[S4] START round=42 head_norm_before_train=1.969074 cos_to_last_merge=0.9998 (last merge round=38)
[S4] round=42 local utility u=0.066697 metrics={'f1_val': 0.9392901533658994, 'auprc': 0.9247692234591711, 'loss_val': 0.3144066277025262, 'psi': 0.933481781403208}-{'f1_val': 0.9354412679952072, 'auprc': 0.9007882351652781, 'loss_val': 0.3527651416207864, 'psi': 0.9215800548632356}
[S5] START round=42 head_norm_before_train=1.316859 cos_to_last_merge=0.9983 (last merge round=40)
[S5] round=42 local utility u=0.015449 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9924290778234095, 'loss_val': 0.09088339907863127, 'psi': 0.9945087312660944}-{'f1_val': 0.9963338119635569, 'auprc': 0.9961488769603327, 'loss_val': 0.13557325204325085, 'psi': 0.9962598379622671}
[S6] START round=42 head_norm_before_train=1.367909 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.628242983503956, 'auprc': 0.9136049070888417, 'loss_val': 0.7154719968592286, 'psi': 0.7423877529379104}-{'f1_val': 0.8819181777886426, 'auprc': 0.9686962403187807, 'loss_val': 0.2499577571284927, 'psi': 0.9166294028006978}
[S7] START round=42 head_norm_before_train=1.426485 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6575391484992953, 'auprc': 0.9498286857044558, 'loss_val': 0.42377174796436, 'psi': 0.7744549633813596}-{'f1_val': 0.9946499847495167, 'auprc': 0.99526918081223, 'loss_val': 0.16198122913435142, 'psi': 0.994897663174602}
[S8] START round=42 head_norm_before_train=1.353711 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.002936 metrics={'f1_val': 0.992174240363445, 'auprc': 0.99835134887277, 'loss_val': 0.07661439099684533, 'psi': 0.994645083767175}-{'f1_val': 0.9925289693239863, 'auprc': 0.9982548147043409, 'loss_val': 0.08432468271096281, 'psi': 0.994819307476128}
[S9] START round=42 head_norm_before_train=1.375976 cos_to_last_merge=0.9910 (last merge round=37)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9924950027606397, 'loss_val': 0.036566930131210734, 'psi': 0.9952597486115415}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980864798131592, 'loss_val': 0.040656812967789335, 'psi': 0.9972308990135985}
[S10] START round=42 head_norm_before_train=1.715498 cos_to_last_merge=0.9912 (last merge round=36)
[S10] round=42 local utility u=0.006799 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9922721343270311, 'loss_val': 0.04106801573137068, 'psi': 0.9938090695033375}-{'f1_val': 0.9944129591200672, 'auprc': 0.9904054212795265, 'loss_val': 0.04654226393227889, 'psi': 0.9928099439838509}
[S11] START round=42 head_norm_before_train=2.008552 cos_to_last_merge=0.9983 (last merge round=36)
[S11] round=42 local utility u=0.005408 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9990258580922476, 'loss_val': 0.03171897305631801, 'psi': 0.9975264621342783}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987108738457728, 'loss_val': 0.0376588992881362, 'psi': 0.9970073686819209}
[S13] START round=42 head_norm_before_train=1.674209 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5900953892344505, 'auprc': 0.6223727578254749, 'loss_val': 1.151061351206414, 'psi': 0.6030063366708602}-{'f1_val': 0.6043433070651919, 'auprc': 0.7335079592171176, 'loss_val': 0.8285134180512983, 'psi': 0.6560091679259622}
[S14] START round=42 head_norm_before_train=1.384554 cos_to_last_merge=0.9864 (last merge round=36)
[S14] round=42 local utility u=0.010081 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.998445325433233, 'loss_val': 0.05769852049292011, 'psi': 0.9974176446726898}-{'f1_val': 0.9961471738646706, 'auprc': 0.9956806235443133, 'loss_val': 0.0660551720238952, 'psi': 0.9959605537365276}
[S15] START round=42 head_norm_before_train=1.327522 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9912959703310669, 'loss_val': 0.08305932009182802, 'psi': 0.9940596993406176}-{'f1_val': 0.7009191843683342, 'auprc': 0.9287374415389816, 'loss_val': 0.4349312440678097, 'psi': 0.7920464872365932}
[S16] START round=42 head_norm_before_train=1.367634 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9248853828058897, 'auprc': 0.9916655858227867, 'loss_val': 0.31479966137144366, 'psi': 0.9515974640126486}-{'f1_val': 0.9657944374646938, 'auprc': 0.9939487928080548, 'loss_val': 0.13601416716978432, 'psi': 0.9770561796020382}
[S17] START round=42 head_norm_before_train=1.840903 cos_to_last_merge=0.8132 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6025622828222332, 'auprc': 0.8295724870161665, 'loss_val': 1.0074486256768638, 'psi': 0.6933663644998065}-{'f1_val': 0.6242917360310651, 'auprc': 0.8804641201200033, 'loss_val': 1.0605973265189637, 'psi': 0.7267606896666404}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:44913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44916
[S14] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9978
[S16] RECEIVED delta(kind=head bytes=1791) from S14
[S16] cosine check vs S14: cos=0.9971
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9978
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=0.9981
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=42 metric=0.9393 head_norm=1.970287
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.783524e-02
[S4] stored merged vector for next round verification (round=42)
[S4] DEBUG after merge:  round=42 metric=0.9393 head_norm=1.990402 delta_norm=0.067835
[S4] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9965 head_norm=2.016673
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.056248e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9965 head_norm=1.992366 delta_norm=0.070562
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=42 metric=0.9948 head_norm=1.734930
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.870206e-02
[S10] stored merged vector for next round verification (round=42)
[S10] DEBUG after merge:  round=42 metric=0.9948 head_norm=1.703829 delta_norm=0.058702
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9892
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9685
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44908
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.6689 head_norm=1.350681
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.701987e-01
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.6751 head_norm=1.344890 delta_norm=0.170199
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9249 head_norm=1.395698
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.452181e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9255 head_norm=1.403468 delta_norm=0.054522
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S3
[S7] cosine check vs S3: cos=0.9994
[S2] START round=43 head_norm_before_train=1.344890 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.233016 metrics={'f1_val': 0.7123186546025619, 'auprc': 0.7927254457701428, 'loss_val': 0.5741135511719188, 'psi': 0.7444813710695943}-{'f1_val': 0.6689278556482157, 'auprc': 0.7472303979458754, 'loss_val': 0.6433162911112768, 'psi': 0.7002488725672795}
[S3] START round=43 head_norm_before_train=1.459503 cos_to_last_merge=0.9998 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9912912861830576, 'loss_val': 0.1391148476428708, 'psi': 0.9731139669529247}-{'f1_val': 0.9967036075256503, 'auprc': 0.9981123015531712, 'loss_val': 0.054158503962360584, 'psi': 0.9972670851366586}
[S4] START round=43 head_norm_before_train=1.990402 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=43 local utility u=0.040078 metrics={'f1_val': 0.9451905822289954, 'auprc': 0.9373537726321854, 'loss_val': 0.30740595656384745, 'psi': 0.9420558583902714}-{'f1_val': 0.9392901533658994, 'auprc': 0.9247692234591711, 'loss_val': 0.3144066277025262, 'psi': 0.933481781403208}
[S5] START round=43 head_norm_before_train=1.391449 cos_to_last_merge=0.9918 (last merge round=40)
[S5] round=43 local utility u=0.006904 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9894843079501968, 'loss_val': 0.06824195969205196, 'psi': 0.9933308233168093}-{'f1_val': 0.995895166894551, 'auprc': 0.9924290778234095, 'loss_val': 0.09088339907863127, 'psi': 0.9945087312660944}
[S6] START round=43 head_norm_before_train=1.385286 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8846096861553999, 'auprc': 0.9574282196642628, 'loss_val': 0.2679578972470357, 'psi': 0.9137370995589451}-{'f1_val': 0.628242983503956, 'auprc': 0.9136049070888417, 'loss_val': 0.7154719968592286, 'psi': 0.7423877529379104}
[S7] START round=43 head_norm_before_train=1.444971 cos_to_last_merge=0.9998 (last merge round=41)
[S7] round=43 local utility u=0.404488 metrics={'f1_val': 0.7693394674066951, 'auprc': 0.9582315354837238, 'loss_val': 0.3108068171991392, 'psi': 0.8448962946375066}-{'f1_val': 0.6575391484992953, 'auprc': 0.9498286857044558, 'loss_val': 0.42377174796436, 'psi': 0.7744549633813596}
[S8] START round=43 head_norm_before_train=1.387109 cos_to_last_merge=0.9998 (last merge round=41)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9846567949518252, 'auprc': 0.9984630703689654, 'loss_val': 0.0837512887589248, 'psi': 0.9901793051186814}-{'f1_val': 0.992174240363445, 'auprc': 0.99835134887277, 'loss_val': 0.07661439099684533, 'psi': 0.994645083767175}
[S9] START round=43 head_norm_before_train=1.406894 cos_to_last_merge=0.9886 (last merge round=37)
[S9] round=43 local utility u=0.005361 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9949914851969923, 'loss_val': 0.03333387968897313, 'psi': 0.9962583415860826}-{'f1_val': 0.9971029125121428, 'auprc': 0.9924950027606397, 'loss_val': 0.036566930131210734, 'psi': 0.9952597486115415}
[S10] START round=43 head_norm_before_train=1.703829 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=43 local utility u=0.006346 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9972895673514551, 'loss_val': 0.0421103975351764, 'psi': 0.9956842963256849}-{'f1_val': 0.9948336929542084, 'auprc': 0.9922721343270311, 'loss_val': 0.04106801573137068, 'psi': 0.9938090695033375}
[S11] START round=43 head_norm_before_train=1.992366 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9987758124300741, 'loss_val': 0.03479321434584009, 'psi': 0.9972813420544031}-{'f1_val': 0.9965268648289654, 'auprc': 0.9990258580922476, 'loss_val': 0.03171897305631801, 'psi': 0.9975264621342783}
[S13] START round=43 head_norm_before_train=1.684935 cos_to_last_merge=0.9999 (last merge round=40)
[S13] round=43 local utility u=0.599222 metrics={'f1_val': 0.6932848759467, 'auprc': 0.7318952664868525, 'loss_val': 0.9003224944457582, 'psi': 0.7087290321627611}-{'f1_val': 0.5900953892344505, 'auprc': 0.6223727578254749, 'loss_val': 1.151061351206414, 'psi': 0.6030063366708602}
[S14] START round=43 head_norm_before_train=1.413301 cos_to_last_merge=0.9836 (last merge round=36)
[S14] round=43 local utility u=0.001743 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9967162755033065, 'loss_val': 0.050482593980915605, 'psi': 0.9968718102515884}-{'f1_val': 0.9967325241656609, 'auprc': 0.998445325433233, 'loss_val': 0.05769852049292011, 'psi': 0.9974176446726898}
[S15] START round=43 head_norm_before_train=1.360534 cos_to_last_merge=0.9997 (last merge round=41)
[S15] round=43 local utility u=0.008627 metrics={'f1_val': 0.9956544969023537, 'auprc': 0.9921912625203715, 'loss_val': 0.06700523201739625, 'psi': 0.9942692031495609}-{'f1_val': 0.9959021853469847, 'auprc': 0.9912959703310669, 'loss_val': 0.08305932009182802, 'psi': 0.9940596993406176}
[S16] START round=43 head_norm_before_train=1.403468 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.113407 metrics={'f1_val': 0.9407548625055236, 'auprc': 0.9888189662940415, 'loss_val': 0.17466313948625858, 'psi': 0.9599805040209308}-{'f1_val': 0.9248853828058897, 'auprc': 0.9916655858227867, 'loss_val': 0.31479966137144366, 'psi': 0.9515974640126486}
[S17] START round=43 head_norm_before_train=1.852135 cos_to_last_merge=0.8125 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5865996439934733, 'auprc': 0.9097218057360499, 'loss_val': 1.2449611061830492, 'psi': 0.715848508690504}-{'f1_val': 0.6025622828222332, 'auprc': 0.8295724870161665, 'loss_val': 1.0074486256768638, 'psi': 0.6933663644998065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9880
[S16] RECEIVED delta(kind=head bytes=1805) from S14
[S16] cosine check vs S14: cos=0.9986
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9974
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9989
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9989
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.9946 head_norm=1.722057
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.256314e-02
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.9946 head_norm=1.706866 delta_norm=0.042563
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.8846 head_norm=1.400934
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.072660e-01
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.8799 head_norm=1.389905 delta_norm=0.107266
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.6933 head_norm=1.692610
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.104800e-02
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.7187 head_norm=1.709845 delta_norm=0.051048
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.7693 head_norm=1.475640
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.219214e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.7487 head_norm=1.466987 delta_norm=0.042192
[S7] aggregate: ROLLBACK (f1_val pre=0.769 post=0.749 tol_abs=0.005 tol_rel=0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.9873
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.8866
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9415
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S9
[S8] cosine check vs S9: cos=0.9752
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9847 head_norm=1.416379
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.729949e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9843 head_norm=1.403930 delta_norm=0.047299
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9408 head_norm=1.426791
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.853766e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9408 head_norm=1.431535 delta_norm=0.038538
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.9959 head_norm=1.466183
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.480960e-01
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.9959 head_norm=1.425188 delta_norm=0.248096
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S15
[S2] cosine check vs S15: cos=0.9873
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9610 head_norm=1.497974
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.446798e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9610 head_norm=1.485851 delta_norm=0.054468
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.7123 head_norm=1.373026
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.106143e-01
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.7127 head_norm=1.379516 delta_norm=0.110614
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.9957 head_norm=1.394775
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.508337e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.9952 head_norm=1.369198 delta_norm=0.150834
[S15] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.379516 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.718128709470825, 'auprc': 0.7560496501739751, 'loss_val': 0.5865363929552484, 'psi': 0.7332970857520851}-{'f1_val': 0.7123186546025619, 'auprc': 0.7927254457701428, 'loss_val': 0.5741135511719188, 'psi': 0.7444813710695943}
[S3] START round=44 head_norm_before_train=1.485851 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.025245 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9978222264043022, 'loss_val': 0.10668957306242634, 'psi': 0.975573484408937}-{'f1_val': 0.960995754132836, 'auprc': 0.9912912861830576, 'loss_val': 0.1391148476428708, 'psi': 0.9731139669529247}
[S4] START round=44 head_norm_before_train=1.991708 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9436923666296458, 'auprc': 0.9296762892824547, 'loss_val': 0.3127890308409465, 'psi': 0.9380859356907694}-{'f1_val': 0.9451905822289954, 'auprc': 0.9373537726321854, 'loss_val': 0.30740595656384745, 'psi': 0.9420558583902714}
[S5] START round=44 head_norm_before_train=1.425188 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.002683 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9914761144775616, 'loss_val': 0.06885208357738837, 'psi': 0.9941275459277552}-{'f1_val': 0.995895166894551, 'auprc': 0.9894843079501968, 'loss_val': 0.06824195969205196, 'psi': 0.9933308233168093}
[S6] START round=44 head_norm_before_train=1.389905 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.8262391981882403, 'auprc': 0.966160008807563, 'loss_val': 0.33094021899765924, 'psi': 0.8822075224359693}-{'f1_val': 0.8846096861553999, 'auprc': 0.9574282196642628, 'loss_val': 0.2679578972470357, 'psi': 0.9137370995589451}
[S7] START round=44 head_norm_before_train=1.466987 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6175301799905439, 'auprc': 0.8264197252805742, 'loss_val': 0.5389114083348133, 'psi': 0.701085998106556}-{'f1_val': 0.7693394674066951, 'auprc': 0.9582315354837238, 'loss_val': 0.3108068171991392, 'psi': 0.8448962946375066}
[S8] START round=44 head_norm_before_train=1.403930 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.031374 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9967880206247526, 'loss_val': 0.06540141042988665, 'psi': 0.9944515317288702}-{'f1_val': 0.9846567949518252, 'auprc': 0.9984630703689654, 'loss_val': 0.0837512887589248, 'psi': 0.9901793051186814}
[S9] START round=44 head_norm_before_train=1.431353 cos_to_last_merge=0.9865 (last merge round=37)
[S9] round=44 local utility u=0.004136 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981273190375463, 'loss_val': 0.03181543122051655, 'psi': 0.9972472347033534}-{'f1_val': 0.9971029125121428, 'auprc': 0.9949914851969923, 'loss_val': 0.03333387968897313, 'psi': 0.9962583415860826}
[S10] START round=44 head_norm_before_train=1.706866 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9967502423567655, 'loss_val': 0.04328195505049948, 'psi': 0.9954685663278089}-{'f1_val': 0.994614115641838, 'auprc': 0.9972895673514551, 'loss_val': 0.0421103975351764, 'psi': 0.9956842963256849}
[S11] START round=44 head_norm_before_train=2.001129 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9989396662153527, 'loss_val': 0.03825604359961423, 'psi': 0.9974919853835202}-{'f1_val': 0.9962850284706224, 'auprc': 0.9987758124300741, 'loss_val': 0.03479321434584009, 'psi': 0.9972813420544031}
[S13] START round=44 head_norm_before_train=1.709845 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6060760336737847, 'auprc': 0.6806277387727206, 'loss_val': 1.0978747643522826, 'psi': 0.635896715713359}-{'f1_val': 0.6932848759467, 'auprc': 0.7318952664868525, 'loss_val': 0.9003224944457582, 'psi': 0.7087290321627611}
[S14] START round=44 head_norm_before_train=1.437296 cos_to_last_merge=0.9811 (last merge round=36)
[S14] round=44 local utility u=0.005351 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984725094636268, 'loss_val': 0.04504925056813083, 'psi': 0.9975743038357165}-{'f1_val': 0.9969755000837764, 'auprc': 0.9967162755033065, 'loss_val': 0.050482593980915605, 'psi': 0.9968718102515884}
[S15] START round=44 head_norm_before_train=1.369198 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9956708864033912, 'auprc': 0.9924111982664887, 'loss_val': 0.07327194957278725, 'psi': 0.9943670111486302}-{'f1_val': 0.9956544969023537, 'auprc': 0.9921912625203715, 'loss_val': 0.06700523201739625, 'psi': 0.9942692031495609}
[S16] START round=44 head_norm_before_train=1.431535 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.122185 metrics={'f1_val': 0.9748677445370533, 'auprc': 0.9872491172836739, 'loss_val': 0.1302606203527553, 'psi': 0.9798202936357016}-{'f1_val': 0.9407548625055236, 'auprc': 0.9888189662940415, 'loss_val': 0.17466313948625858, 'psi': 0.9599805040209308}
[S17] START round=44 head_norm_before_train=1.861551 cos_to_last_merge=0.8121 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5956788325758522, 'auprc': 0.8109440033998189, 'loss_val': 1.0106516783681856, 'psi': 0.6817849009054389}-{'f1_val': 0.5865996439934733, 'auprc': 0.9097218057360499, 'loss_val': 1.2449611061830492, 'psi': 0.715848508690504}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1797) from S14
[S16] cosine check vs S14: cos=0.9993
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S3
[S7] cosine check vs S3: cos=0.9985
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1795) from S9
[S8] cosine check vs S9: cos=0.9776
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=44 metric=0.9965 head_norm=2.011052
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.039047e-02
[S11] stored merged vector for next round verification (round=44)
[S11] DEBUG after merge:  round=44 metric=0.9961 head_norm=2.001299 delta_norm=0.020390
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=0.9946
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S5] sending update (kind=head size=1807 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1807) from S5
[S15] cosine check vs S5: cos=0.8902
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S16
[S5] cosine check vs S16: cos=0.9745
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9957 head_norm=1.402325
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.419056e-01
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9948 head_norm=1.407084 delta_norm=0.341906
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9929 head_norm=1.429877
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.530592e-01
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9929 head_norm=1.433686 delta_norm=0.153059
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.9959 head_norm=1.492331
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.675458e-01
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.9959 head_norm=1.461648 delta_norm=0.167546
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9749 head_norm=1.449799
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.827137e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9742 head_norm=1.453349 delta_norm=0.028271
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.407829 cos_to_last_merge=0.9991 (last merge round=43)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6946912573462587, 'auprc': 0.7634175477281191, 'loss_val': 0.6142215153879375, 'psi': 0.7221817734990028}-{'f1_val': 0.718128709470825, 'auprc': 0.7560496501739751, 'loss_val': 0.5865363929552484, 'psi': 0.7332970857520851}
[S3] START round=45 head_norm_before_train=1.519937 cos_to_last_merge=0.9998 (last merge round=43)
[S3] round=45 local utility u=0.091260 metrics={'f1_val': 0.9831483278933479, 'auprc': 0.9981091805940321, 'loss_val': 0.059474305707407416, 'psi': 0.9891326689736215}-{'f1_val': 0.9607409897453603, 'auprc': 0.9978222264043022, 'loss_val': 0.10668957306242634, 'psi': 0.975573484408937}
[S4] START round=45 head_norm_before_train=1.996854 cos_to_last_merge=0.9999 (last merge round=42)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9434648037064729, 'auprc': 0.9302202490511252, 'loss_val': 0.31655635042161784, 'psi': 0.9381669818443338}-{'f1_val': 0.9436923666296458, 'auprc': 0.9296762892824547, 'loss_val': 0.3127890308409465, 'psi': 0.9380859356907694}
[S5] START round=45 head_norm_before_train=1.461648 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.8813461549580037, 'auprc': 0.9794140305139359, 'loss_val': 0.21327308944789503, 'psi': 0.9205733051803766}-{'f1_val': 0.995895166894551, 'auprc': 0.9914761144775616, 'loss_val': 0.06885208357738837, 'psi': 0.9941275459277552}
[S6] START round=45 head_norm_before_train=1.411506 cos_to_last_merge=0.9997 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6118351552740676, 'auprc': 0.8075412794758801, 'loss_val': 0.8133301460207943, 'psi': 0.6901176049547926}-{'f1_val': 0.8262391981882403, 'auprc': 0.966160008807563, 'loss_val': 0.33094021899765924, 'psi': 0.8822075224359693}
[S7] START round=45 head_norm_before_train=1.511804 cos_to_last_merge=0.9993 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5708834922583137, 'auprc': 0.9064077007369352, 'loss_val': 0.606931873634309, 'psi': 0.7050931756497623}-{'f1_val': 0.6175301799905439, 'auprc': 0.8264197252805742, 'loss_val': 0.5389114083348133, 'psi': 0.701085998106556}
[S8] START round=45 head_norm_before_train=1.433686 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9687549788145413, 'auprc': 0.9984637323794783, 'loss_val': 0.10795799374776262, 'psi': 0.9806384802405161}-{'f1_val': 0.9928938724649488, 'auprc': 0.9967880206247526, 'loss_val': 0.06540141042988665, 'psi': 0.9944515317288702}
[S9] START round=45 head_norm_before_train=1.453691 cos_to_last_merge=0.9846 (last merge round=37)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9924468337755783, 'loss_val': 0.029459676360240276, 'psi': 0.995240481017517}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981273190375463, 'loss_val': 0.03181543122051655, 'psi': 0.9972472347033534}
[S10] START round=45 head_norm_before_train=1.724906 cos_to_last_merge=0.9999 (last merge round=43)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9933158186388694, 'auprc': 0.9927089024498752, 'loss_val': 0.04315680859558828, 'psi': 0.9930730521632718}-{'f1_val': 0.994614115641838, 'auprc': 0.9967502423567655, 'loss_val': 0.04328195505049948, 'psi': 0.9954685663278089}
[S11] START round=45 head_norm_before_train=2.001299 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=45 local utility u=0.000357 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987456412377904, 'loss_val': 0.033028220878476934, 'psi': 0.9970212756387279}-{'f1_val': 0.9965268648289654, 'auprc': 0.9989396662153527, 'loss_val': 0.03825604359961423, 'psi': 0.9974919853835202}
[S13] START round=45 head_norm_before_train=1.717460 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=45 local utility u=0.301164 metrics={'f1_val': 0.6379775714147704, 'auprc': 0.7331172173874989, 'loss_val': 0.8444243460433913, 'psi': 0.6760334298038617}-{'f1_val': 0.6060760336737847, 'auprc': 0.6806277387727206, 'loss_val': 1.0978747643522826, 'psi': 0.635896715713359}
[S14] START round=45 head_norm_before_train=1.457440 cos_to_last_merge=0.9791 (last merge round=36)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9966631218177879, 'loss_val': 0.044660574087691356, 'psi': 0.9969512201649947}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984725094636268, 'loss_val': 0.04504925056813083, 'psi': 0.9975743038357165}
[S15] START round=45 head_norm_before_train=1.407084 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8103006780911928, 'auprc': 0.9898176761661536, 'loss_val': 0.30681923150963974, 'psi': 0.8821074773211771}-{'f1_val': 0.9956708864033912, 'auprc': 0.9924111982664887, 'loss_val': 0.07327194957278725, 'psi': 0.9943670111486302}
[S16] START round=45 head_norm_before_train=1.453349 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.086368 metrics={'f1_val': 0.9906221848405484, 'auprc': 0.9919974912104224, 'loss_val': 0.066295881867531, 'psi': 0.9911723073884979}-{'f1_val': 0.9748677445370533, 'auprc': 0.9872491172836739, 'loss_val': 0.1302606203527553, 'psi': 0.9798202936357016}
[S17] START round=45 head_norm_before_train=1.867964 cos_to_last_merge=0.8118 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=45 local utility u=0.077057 metrics={'f1_val': 0.6147612430136157, 'auprc': 0.8507926819381488, 'loss_val': 1.0905788728562584, 'psi': 0.709173818583429}-{'f1_val': 0.5956788325758522, 'auprc': 0.8109440033998189, 'loss_val': 1.0106516783681856, 'psi': 0.6817849009054389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:44911
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.004 → S13@127.0.0.1:44913
[S4] ⇄ pheromone p=0.017 → S11@127.0.0.1:44912
[S13] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.6118 head_norm=1.439195
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.601918e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.5974 head_norm=1.431962 delta_norm=0.086019
[S6] aggregate: ROLLBACK (f1_val pre=0.612 post=0.597 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.259 → S8@127.0.0.1:44909
[S14] ⇄ pheromone p=0.014 → S16@127.0.0.1:44916
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=45 metric=0.5709 head_norm=1.552581
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.384238e-02
[S7] stored merged vector for next round verification (round=45)
[S7] DEBUG after merge:  round=45 metric=0.5707 head_norm=1.535019 delta_norm=0.063842
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.204 → S3@127.0.0.1:44903
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=0.9998
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S13] ⇄ pheromone p=0.219 → S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44908
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9985
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.126 → S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44905
[S16] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S16
[S5] cosine check vs S16: cos=0.9861
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.022 → S6@127.0.0.1:44907
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.8813 head_norm=1.518170
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.269369e-01
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.8813 head_norm=1.489588 delta_norm=0.126937
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.037 → S15@127.0.0.1:44915
[S2] ⇄ pheromone p=0.072 → S15@127.0.0.1:44915
[S9] ⇄ pheromone p=0.004 → S8@127.0.0.1:44909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.208 → S2@127.0.0.1:44902
[S16] ⇄ pheromone p=0.098 → S5@127.0.0.1:44905
[S2] START round=46 head_norm_before_train=1.440778 cos_to_last_merge=0.9964 (last merge round=43)
[S2] round=46 local utility u=0.054963 metrics={'f1_val': 0.7184658114297595, 'auprc': 0.74944997791824, 'loss_val': 0.605040082659868, 'psi': 0.7308594780251516}-{'f1_val': 0.6946912573462587, 'auprc': 0.7634175477281191, 'loss_val': 0.6142215153879375, 'psi': 0.7221817734990028}
[S3] START round=46 head_norm_before_train=1.553842 cos_to_last_merge=0.9992 (last merge round=43)
[S3] round=46 local utility u=0.055621 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984341063971527, 'loss_val': 0.034535663661094236, 'psi': 0.9977954611539134}-{'f1_val': 0.9831483278933479, 'auprc': 0.9981091805940321, 'loss_val': 0.059474305707407416, 'psi': 0.9891326689736215}
[S4] START round=46 head_norm_before_train=2.007626 cos_to_last_merge=0.9998 (last merge round=42)
[S4] round=46 local utility u=0.072881 metrics={'f1_val': 0.9491095097921997, 'auprc': 0.9621535467967481, 'loss_val': 0.3004616880437198, 'psi': 0.954327124594019}-{'f1_val': 0.9434648037064729, 'auprc': 0.9302202490511252, 'loss_val': 0.31655635042161784, 'psi': 0.9381669818443338}
[S5] START round=46 head_norm_before_train=1.489588 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.434522 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9920063567305669, 'loss_val': 0.06930089026702246, 'psi': 0.9943396428289574}-{'f1_val': 0.8813461549580037, 'auprc': 0.9794140305139359, 'loss_val': 0.21327308944789503, 'psi': 0.9205733051803766}
[S6] START round=46 head_norm_before_train=1.431962 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.745618 metrics={'f1_val': 0.7559713636745763, 'auprc': 0.9303648647371934, 'loss_val': 0.5553815922370838, 'psi': 0.8257287640996231}-{'f1_val': 0.6118351552740676, 'auprc': 0.8075412794758801, 'loss_val': 0.8133301460207943, 'psi': 0.6901176049547926}
[S7] START round=46 head_norm_before_train=1.535019 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5432903892487336, 'auprc': 0.7996644117622399, 'loss_val': 0.7993363885950505, 'psi': 0.6458399982541361}-{'f1_val': 0.5708834922583137, 'auprc': 0.9064077007369352, 'loss_val': 0.606931873634309, 'psi': 0.7050931756497623}
[S8] START round=46 head_norm_before_train=1.460515 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=46 local utility u=0.092034 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9982273483245825, 'loss_val': 0.061517339149486726, 'psi': 0.9943775200275389}-{'f1_val': 0.9687549788145413, 'auprc': 0.9984637323794783, 'loss_val': 0.10795799374776262, 'psi': 0.9806384802405161}
[S9] START round=46 head_norm_before_train=1.472564 cos_to_last_merge=0.9828 (last merge round=37)
[S9] round=46 local utility u=0.000595 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.992999259171165, 'loss_val': 0.028424117473187006, 'psi': 0.9953112549238203}-{'f1_val': 0.9971029125121428, 'auprc': 0.9924468337755783, 'loss_val': 0.029459676360240276, 'psi': 0.995240481017517}
[S10] START round=46 head_norm_before_train=1.742476 cos_to_last_merge=0.9997 (last merge round=43)
[S10] round=46 local utility u=0.009093 metrics={'f1_val': 0.9944129591200672, 'auprc': 0.9952997542397382, 'loss_val': 0.039326919617954065, 'psi': 0.9947676771679356}-{'f1_val': 0.9933158186388694, 'auprc': 0.9927089024498752, 'loss_val': 0.04315680859558828, 'psi': 0.9930730521632718}
[S11] START round=46 head_norm_before_train=2.013518 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=46 local utility u=0.004081 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9990678952018376, 'loss_val': 0.028312113514015476, 'psi': 0.9973981751631085}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987456412377904, 'loss_val': 0.033028220878476934, 'psi': 0.9970212756387279}
[S13] START round=46 head_norm_before_train=1.723180 cos_to_last_merge=0.9999 (last merge round=43)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6285675908605205, 'auprc': 0.6984724062457489, 'loss_val': 0.8598440669066265, 'psi': 0.6565295170146119}-{'f1_val': 0.6379775714147704, 'auprc': 0.7331172173874989, 'loss_val': 0.8444243460433913, 'psi': 0.6760334298038617}
[S14] START round=46 head_norm_before_train=1.474824 cos_to_last_merge=0.9773 (last merge round=36)
[S14] round=46 local utility u=0.001184 metrics={'f1_val': 0.9969452255660185, 'auprc': 0.9967905905006496, 'loss_val': 0.04148594895609471, 'psi': 0.9968833715398709}-{'f1_val': 0.9971432857297993, 'auprc': 0.9966631218177879, 'loss_val': 0.044660574087691356, 'psi': 0.9969512201649947}
[S15] START round=46 head_norm_before_train=1.437860 cos_to_last_merge=0.9998 (last merge round=44)
[S15] round=46 local utility u=0.648449 metrics={'f1_val': 0.9875147946674712, 'auprc': 0.9906549307962567, 'loss_val': 0.07571718444264582, 'psi': 0.9887708491189854}-{'f1_val': 0.8103006780911928, 'auprc': 0.9898176761661536, 'loss_val': 0.30681923150963974, 'psi': 0.8821074773211771}
[S16] START round=46 head_norm_before_train=1.471438 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8570727733831512, 'auprc': 0.9850799748183541, 'loss_val': 0.6390462394479369, 'psi': 0.9082756539572324}-{'f1_val': 0.9906221848405484, 'auprc': 0.9919974912104224, 'loss_val': 0.066295881867531, 'psi': 0.9911723073884979}
[S17] START round=46 head_norm_before_train=1.874319 cos_to_last_merge=0.8115 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6025586737836719, 'auprc': 0.8936662566414553, 'loss_val': 1.1795903451444263, 'psi': 0.7190017069267853}-{'f1_val': 0.6147612430136157, 'auprc': 0.8507926819381488, 'loss_val': 1.0905788728562584, 'psi': 0.709173818583429}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:44913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.5433 head_norm=1.574653
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.188492e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.5435 head_norm=1.563058 delta_norm=0.061885
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9994
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9865
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9995
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:44907
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.9491 head_norm=2.013954
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.664110e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.9491 head_norm=2.013560 delta_norm=0.026641
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=46 metric=0.9944 head_norm=1.758708
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.057106e-02
[S10] stored merged vector for next round verification (round=46)
[S10] DEBUG after merge:  round=46 metric=0.9944 head_norm=1.740766 delta_norm=0.030571
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.9194
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1790) from S8
[S6] cosine check vs S8: cos=0.9865
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9194
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S9
[S8] cosine check vs S9: cos=0.9909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] cosine check vs S14: cos=0.9991
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9918 head_norm=1.486015
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.656312e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9918 head_norm=1.471066 delta_norm=0.036563
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.7185 head_norm=1.474277
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.955581e-01
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.7181 head_norm=1.441833 delta_norm=0.295558
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.9986
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9419
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.8571 head_norm=1.489190
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.135351e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.8571 head_norm=1.489861 delta_norm=0.031354
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9875 head_norm=1.469347
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.696858e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9858 head_norm=1.437640 delta_norm=0.096969
[S15] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.441833 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7044447347762196, 'auprc': 0.7591315510121723, 'loss_val': 0.6197904616142, 'psi': 0.7263194612706008}-{'f1_val': 0.7184658114297595, 'auprc': 0.74944997791824, 'loss_val': 0.605040082659868, 'psi': 0.7308594780251516}
[S3] START round=47 head_norm_before_train=1.585123 cos_to_last_merge=0.9983 (last merge round=43)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.99792846785364, 'loss_val': 0.12720906682256602, 'psi': 0.9757925378047221}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984341063971527, 'loss_val': 0.034535663661094236, 'psi': 0.9977954611539134}
[S4] START round=47 head_norm_before_train=2.013560 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9401034132724763, 'auprc': 0.9269528876186266, 'loss_val': 0.3289712708893544, 'psi': 0.9348432030109364}-{'f1_val': 0.9491095097921997, 'auprc': 0.9621535467967481, 'loss_val': 0.3004616880437198, 'psi': 0.954327124594019}
[S5] START round=47 head_norm_before_train=1.534254 cos_to_last_merge=0.9991 (last merge round=45)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9899260154094957, 'auprc': 0.9899068461320618, 'loss_val': 0.07729711495073537, 'psi': 0.989918347698522}-{'f1_val': 0.995895166894551, 'auprc': 0.9920063567305669, 'loss_val': 0.06930089026702246, 'psi': 0.9943396428289574}
[S6] START round=47 head_norm_before_train=1.452314 cos_to_last_merge=0.9998 (last merge round=45)
[S6] round=47 local utility u=0.855355 metrics={'f1_val': 0.9507936802095348, 'auprc': 0.9798122993659212, 'loss_val': 0.16194834319192347, 'psi': 0.9624011278720894}-{'f1_val': 0.7559713636745763, 'auprc': 0.9303648647371934, 'loss_val': 0.5553815922370838, 'psi': 0.8257287640996231}
[S7] START round=47 head_norm_before_train=1.563058 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.011416 metrics={'f1_val': 0.5391264929293862, 'auprc': 0.819266762958651, 'loss_val': 0.8103270683118626, 'psi': 0.6511826009410921}-{'f1_val': 0.5432903892487336, 'auprc': 0.7996644117622399, 'loss_val': 0.7993363885950505, 'psi': 0.6458399982541361}
[S8] START round=47 head_norm_before_train=1.471066 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9971893664123738, 'loss_val': 0.05883607449943182, 'psi': 0.9939623272626553}-{'f1_val': 0.9918109678295097, 'auprc': 0.9982273483245825, 'loss_val': 0.061517339149486726, 'psi': 0.9943775200275389}
[S9] START round=47 head_norm_before_train=1.491612 cos_to_last_merge=0.9812 (last merge round=37)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9984085696529674, 'loss_val': 0.031304933870160076, 'psi': 0.9959774213788772}-{'f1_val': 0.9968525854255906, 'auprc': 0.992999259171165, 'loss_val': 0.028424117473187006, 'psi': 0.9953112549238203}
[S10] START round=47 head_norm_before_train=1.740766 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9941506890043368, 'auprc': 0.994601636830361, 'loss_val': 0.04144060662662328, 'psi': 0.9943310681347464}-{'f1_val': 0.9944129591200672, 'auprc': 0.9952997542397382, 'loss_val': 0.039326919617954065, 'psi': 0.9947676771679356}
[S11] START round=47 head_norm_before_train=2.026083 cos_to_last_merge=0.9998 (last merge round=44)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986360833089667, 'loss_val': 0.10782271503955106, 'psi': 0.9972398840938079}-{'f1_val': 0.9962850284706224, 'auprc': 0.9990678952018376, 'loss_val': 0.028312113514015476, 'psi': 0.9973981751631085}
[S13] START round=47 head_norm_before_train=1.730410 cos_to_last_merge=0.9999 (last merge round=43)
[S13] round=47 local utility u=0.003751 metrics={'f1_val': 0.6544089942897766, 'auprc': 0.6963716308505797, 'loss_val': 1.001088728315819, 'psi': 0.6711940489140978}-{'f1_val': 0.6285675908605205, 'auprc': 0.6984724062457489, 'loss_val': 0.8598440669066265, 'psi': 0.6565295170146119}
[S14] START round=47 head_norm_before_train=1.491192 cos_to_last_merge=0.9756 (last merge round=36)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9967110921147512, 'loss_val': 0.03923260775881419, 'psi': 0.9966051155548593}-{'f1_val': 0.9969452255660185, 'auprc': 0.9967905905006496, 'loss_val': 0.04148594895609471, 'psi': 0.9968833715398709}
[S15] START round=47 head_norm_before_train=1.437640 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7708412048440179, 'auprc': 0.9773851636702162, 'loss_val': 0.37697653610884563, 'psi': 0.8534587883744973}-{'f1_val': 0.9875147946674712, 'auprc': 0.9906549307962567, 'loss_val': 0.07571718444264582, 'psi': 0.9887708491189854}
[S16] START round=47 head_norm_before_train=1.489861 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.256736 metrics={'f1_val': 0.8995363294611176, 'auprc': 0.990072053272475, 'loss_val': 0.39533154496000433, 'psi': 0.9357506189856606}-{'f1_val': 0.8570727733831512, 'auprc': 0.9850799748183541, 'loss_val': 0.6390462394479369, 'psi': 0.9082756539572324}
[S17] START round=47 head_norm_before_train=1.880782 cos_to_last_merge=0.8114 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6006041077677076, 'auprc': 0.8701808724346586, 'loss_val': 1.2036278222516434, 'psi': 0.708434813634488}-{'f1_val': 0.6025586737836719, 'auprc': 0.8936662566414553, 'loss_val': 1.1795903451444263, 'psi': 0.7190017069267853}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.962)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.9508 head_norm=1.471991
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.291055e-01
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.9498 head_norm=1.473374 delta_norm=0.129106
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9996
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.6544 head_norm=1.736649
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.143542e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.6406 head_norm=1.747431 delta_norm=0.031435
[S13] aggregate: ROLLBACK (f1_val pre=0.654 post=0.641 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9963 head_norm=2.035109
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.077152e-02
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9963 head_norm=2.024149 delta_norm=0.040772
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9967
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.5391 head_norm=1.594183
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.660304e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.5391 head_norm=1.588651 delta_norm=0.056603
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=47 metric=0.9610 head_norm=1.612238
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.527772e-02
[S3] stored merged vector for next round verification (round=47)
[S3] DEBUG after merge:  round=47 metric=0.9610 head_norm=1.601907 delta_norm=0.065278
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9885
[S2] START round=48 head_norm_before_train=1.472917 cos_to_last_merge=0.9993 (last merge round=46)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6829589341427674, 'auprc': 0.7509740006085138, 'loss_val': 0.7062596840222758, 'psi': 0.710164960729066}-{'f1_val': 0.7044447347762196, 'auprc': 0.7591315510121723, 'loss_val': 0.6197904616142, 'psi': 0.7263194612706008}
[S3] START round=48 head_norm_before_train=1.601907 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=48 local utility u=0.114106 metrics={'f1_val': 0.9860988847288437, 'auprc': 0.9984206827862347, 'loss_val': 0.050855371374811414, 'psi': 0.9910276039518}-{'f1_val': 0.9610352511054436, 'auprc': 0.99792846785364, 'loss_val': 0.12720906682256602, 'psi': 0.9757925378047221}
[S4] START round=48 head_norm_before_train=2.015752 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.012969 metrics={'f1_val': 0.9415579555042544, 'auprc': 0.9310081542176754, 'loss_val': 0.3239258354683044, 'psi': 0.9373380349896228}-{'f1_val': 0.9401034132724763, 'auprc': 0.9269528876186266, 'loss_val': 0.3289712708893544, 'psi': 0.9348432030109364}
[S5] START round=48 head_norm_before_train=1.564375 cos_to_last_merge=0.9977 (last merge round=45)
[S5] round=48 local utility u=0.045848 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9983529227975899, 'loss_val': 0.049385352618683216, 'psi': 0.9971414562971701}-{'f1_val': 0.9899260154094957, 'auprc': 0.9899068461320618, 'loss_val': 0.07729711495073537, 'psi': 0.989918347698522}
[S6] START round=48 head_norm_before_train=1.473374 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.778777342261534, 'auprc': 0.9428762453043863, 'loss_val': 0.5634702257651089, 'psi': 0.8444169034786748}-{'f1_val': 0.9507936802095348, 'auprc': 0.9798122993659212, 'loss_val': 0.16194834319192347, 'psi': 0.9624011278720894}
[S7] START round=48 head_norm_before_train=1.588651 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.937306 metrics={'f1_val': 0.7121196203104513, 'auprc': 0.969241447243112, 'loss_val': 0.4235987927866644, 'psi': 0.8149683510835156}-{'f1_val': 0.5391264929293862, 'auprc': 0.819266762958651, 'loss_val': 0.8103270683118626, 'psi': 0.6511826009410921}
[S8] START round=48 head_norm_before_train=1.493594 cos_to_last_merge=0.9999 (last merge round=46)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9683198107991999, 'auprc': 0.9983491174168045, 'loss_val': 0.09760672414876144, 'psi': 0.9803315334462418}-{'f1_val': 0.9918109678295097, 'auprc': 0.9971893664123738, 'loss_val': 0.05883607449943182, 'psi': 0.9939623272626553}
[S9] START round=48 head_norm_before_train=1.507895 cos_to_last_merge=0.9799 (last merge round=37)
[S9] round=48 local utility u=0.005934 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9955784573568665, 'loss_val': 0.025921728236382297, 'psi': 0.9963429341981009}-{'f1_val': 0.994356655862817, 'auprc': 0.9984085696529674, 'loss_val': 0.031304933870160076, 'psi': 0.9959774213788772}
[S10] START round=48 head_norm_before_train=1.756066 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=48 local utility u=0.004216 metrics={'f1_val': 0.9937365524730105, 'auprc': 0.9974442299157391, 'loss_val': 0.03905169272868649, 'psi': 0.9952196234501021}-{'f1_val': 0.9941506890043368, 'auprc': 0.994601636830361, 'loss_val': 0.04144060662662328, 'psi': 0.9943310681347464}
[S11] START round=48 head_norm_before_train=2.024149 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.038533 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987670369069019, 'loss_val': 0.02852575371752038, 'psi': 0.9970298339063726}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986360833089667, 'loss_val': 0.10782271503955106, 'psi': 0.9972398840938079}
[S13] START round=48 head_norm_before_train=1.747431 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163772500491951, 'auprc': 0.6946717304863407, 'loss_val': 0.9612292341861248, 'psi': 0.6476950422240533}-{'f1_val': 0.6544089942897766, 'auprc': 0.6963716308505797, 'loss_val': 1.001088728315819, 'psi': 0.6711940489140978}
[S14] START round=48 head_norm_before_train=1.507192 cos_to_last_merge=0.9741 (last merge round=36)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.996124188334813, 'auprc': 0.9956353255405473, 'loss_val': 0.037735840075780604, 'psi': 0.9959286432171068}-{'f1_val': 0.9965344645149313, 'auprc': 0.9967110921147512, 'loss_val': 0.03923260775881419, 'psi': 0.9966051155548593}
[S15] START round=48 head_norm_before_train=1.467639 cos_to_last_merge=0.9998 (last merge round=46)
[S15] round=48 local utility u=0.817399 metrics={'f1_val': 0.9845184090749389, 'auprc': 0.9928488663234588, 'loss_val': 0.07063190176246337, 'psi': 0.9878505919743469}-{'f1_val': 0.7708412048440179, 'auprc': 0.9773851636702162, 'loss_val': 0.37697653610884563, 'psi': 0.8534587883744973}
[S16] START round=48 head_norm_before_train=1.505575 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.428766 metrics={'f1_val': 0.9881231075180459, 'auprc': 0.9927012436229268, 'loss_val': 0.07720869300156537, 'psi': 0.9899543619599982}-{'f1_val': 0.8995363294611176, 'auprc': 0.990072053272475, 'loss_val': 0.39533154496000433, 'psi': 0.9357506189856606}
[S17] START round=48 head_norm_before_train=1.885551 cos_to_last_merge=0.8115 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=48 local utility u=0.621971 metrics={'f1_val': 0.7121373713858427, 'auprc': 0.8672250759759237, 'loss_val': 0.6200172531365958, 'psi': 0.774172453221875}-{'f1_val': 0.6006041077677076, 'auprc': 0.8701808724346586, 'loss_val': 1.2036278222516434, 'psi': 0.708434813634488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S7] not sending this round → trigger blocked (psi=0.815)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:44913
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S4] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9998
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=48 metric=0.9937 head_norm=1.771238
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.412014e-02
[S10] stored merged vector for next round verification (round=48)
[S10] DEBUG after merge:  round=48 metric=0.9937 head_norm=1.753697 delta_norm=0.034120
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=48 metric=0.9959 head_norm=2.033787
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.964462e-02
[S11] stored merged vector for next round verification (round=48)
[S11] DEBUG after merge:  round=48 metric=0.9959 head_norm=2.026084 delta_norm=0.019645
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9410
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S15
[S2] cosine check vs S15: cos=0.9787
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.9991
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.9963 head_norm=1.598978
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.434778e-01
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.9963 head_norm=1.546337 delta_norm=0.143478
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=48 metric=0.6164 head_norm=1.754699
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.976516e-02
[S13] stored merged vector for next round verification (round=48)
[S13] DEBUG after merge:  round=48 metric=0.6145 head_norm=1.762877 delta_norm=0.019765
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.990)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.6830 head_norm=1.507234
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.549616e-01
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.6871 head_norm=1.492575 delta_norm=0.154962
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9873
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9845 head_norm=1.493932
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.705101e-01
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9806 head_norm=1.523517 delta_norm=0.270510
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9683 head_norm=1.513422
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.208438e-01
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9683 head_norm=1.513086 delta_norm=0.120844
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=48 metric=0.9416 head_norm=2.018544
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.964462e-02
[S4] stored merged vector for next round verification (round=48)
[S4] DEBUG after merge:  round=48 metric=0.9416 head_norm=2.026084 delta_norm=0.019645
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.492575 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.037696 metrics={'f1_val': 0.6940625700485997, 'auprc': 0.7513572284184254, 'loss_val': 0.6986388358892661, 'psi': 0.7169804333965301}-{'f1_val': 0.6829589341427674, 'auprc': 0.7509740006085138, 'loss_val': 0.7062596840222758, 'psi': 0.710164960729066}
[S3] START round=49 head_norm_before_train=1.629115 cos_to_last_merge=0.9999 (last merge round=47)
[S3] round=49 local utility u=0.027895 metrics={'f1_val': 0.9929404216039119, 'auprc': 0.9980712021642895, 'loss_val': 0.03506696633239624, 'psi': 0.994992733828063}-{'f1_val': 0.9860988847288437, 'auprc': 0.9984206827862347, 'loss_val': 0.050855371374811414, 'psi': 0.9910276039518}
[S4] START round=49 head_norm_before_train=2.026084 cos_to_last_merge=1.0000 (last merge round=48)
[S4] round=49 local utility u=0.000955 metrics={'f1_val': 0.9417134184729203, 'auprc': 0.9314637051954593, 'loss_val': 0.3243147815528461, 'psi': 0.937613533161936}-{'f1_val': 0.9415579555042544, 'auprc': 0.9310081542176754, 'loss_val': 0.3239258354683044, 'psi': 0.9373380349896228}
[S5] START round=49 head_norm_before_train=1.546337 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9553693044203071, 'auprc': 0.9904835602014166, 'loss_val': 0.13322015388076386, 'psi': 0.9694150067327509}-{'f1_val': 0.9963338119635569, 'auprc': 0.9983529227975899, 'loss_val': 0.049385352618683216, 'psi': 0.9971414562971701}
[S6] START round=49 head_norm_before_train=1.496772 cos_to_last_merge=0.9999 (last merge round=47)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5980386333840492, 'auprc': 0.8772071280718506, 'loss_val': 0.9476855068176607, 'psi': 0.7097060312591699}-{'f1_val': 0.778777342261534, 'auprc': 0.9428762453043863, 'loss_val': 0.5634702257651089, 'psi': 0.8444169034786748}
[S7] START round=49 head_norm_before_train=1.632369 cos_to_last_merge=0.9995 (last merge round=47)
[S7] round=49 local utility u=0.006052 metrics={'f1_val': 0.7201003017980845, 'auprc': 0.980987348643287, 'loss_val': 0.4946171919659398, 'psi': 0.8244551205361654}-{'f1_val': 0.7121196203104513, 'auprc': 0.969241447243112, 'loss_val': 0.4235987927866644, 'psi': 0.8149683510835156}
[S8] START round=49 head_norm_before_train=1.513086 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.081305 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9944455002575485, 'loss_val': 0.05988337677506146, 'psi': 0.9924298297484603}-{'f1_val': 0.9683198107991999, 'auprc': 0.9983491174168045, 'loss_val': 0.09760672414876144, 'psi': 0.9803315334462418}
[S9] START round=49 head_norm_before_train=1.522374 cos_to_last_merge=0.9785 (last merge round=37)
[S9] round=49 local utility u=0.000825 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995311896918102, 'loss_val': 0.024974245597201704, 'psi': 0.9963865062745265}-{'f1_val': 0.9968525854255906, 'auprc': 0.9955784573568665, 'loss_val': 0.025921728236382297, 'psi': 0.9963429341981009}
[S10] START round=49 head_norm_before_train=1.753697 cos_to_last_merge=1.0000 (last merge round=48)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9939558319194128, 'auprc': 0.9970197229322135, 'loss_val': 0.039655586271756554, 'psi': 0.9951813883245332}-{'f1_val': 0.9937365524730105, 'auprc': 0.9974442299157391, 'loss_val': 0.03905169272868649, 'psi': 0.9952196234501021}
[S11] START round=49 head_norm_before_train=2.026084 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=49 local utility u=0.002373 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9988369848170942, 'loss_val': 0.026468762266708013, 'psi': 0.9973058110092111}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987670369069019, 'loss_val': 0.02852575371752038, 'psi': 0.9970298339063726}
[S13] START round=49 head_norm_before_train=1.762877 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=49 local utility u=0.186705 metrics={'f1_val': 0.6728703227371627, 'auprc': 0.7394491782313065, 'loss_val': 1.0611106673136765, 'psi': 0.6995018649348202}-{'f1_val': 0.6163772500491951, 'auprc': 0.6946717304863407, 'loss_val': 0.9612292341861248, 'psi': 0.6476950422240533}
[S14] START round=49 head_norm_before_train=1.521882 cos_to_last_merge=0.9727 (last merge round=36)
[S14] round=49 local utility u=0.004720 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.997690293736027, 'loss_val': 0.0357803872906407, 'psi': 0.9968826705584807}-{'f1_val': 0.996124188334813, 'auprc': 0.9956353255405473, 'loss_val': 0.037735840075780604, 'psi': 0.9959286432171068}
[S15] START round=49 head_norm_before_train=1.523517 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9020450466734219, 'auprc': 0.9909018824605001, 'loss_val': 0.1632401871317879, 'psi': 0.9375877809882531}-{'f1_val': 0.9845184090749389, 'auprc': 0.9928488663234588, 'loss_val': 0.07063190176246337, 'psi': 0.9878505919743469}
[S16] START round=49 head_norm_before_train=1.520935 cos_to_last_merge=0.9999 (last merge round=46)
[S16] round=49 local utility u=0.017424 metrics={'f1_val': 0.9903111310479196, 'auprc': 0.9939362866953704, 'loss_val': 0.0591936028330249, 'psi': 0.9917611933068999}-{'f1_val': 0.9881231075180459, 'auprc': 0.9927012436229268, 'loss_val': 0.07720869300156537, 'psi': 0.9899543619599982}
[S17] START round=49 head_norm_before_train=1.892451 cos_to_last_merge=0.8112 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6052919985405565, 'auprc': 0.9403297505032482, 'loss_val': 1.230673310039933, 'psi': 0.7393070993256332}-{'f1_val': 0.7121373713858427, 'auprc': 0.8672250759759237, 'loss_val': 0.6200172531365958, 'psi': 0.774172453221875}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:44903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[S7] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.9977
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1794) from S14
[S16] cosine check vs S14: cos=0.9988
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=1.0000
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9417 head_norm=2.028604
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.497882e-03
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9417 head_norm=2.031866 delta_norm=0.009498
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9963 head_norm=2.035167
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.497880e-03
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9963 head_norm=2.031866 delta_norm=0.009498
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44908
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.7201 head_norm=1.666169
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.371021e-02
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.7154 head_norm=1.646871 delta_norm=0.053710
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9870
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9936
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9992
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S9
[S8] cosine check vs S9: cos=0.9959
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9911 head_norm=1.528854
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.933784e-02
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9911 head_norm=1.530798 delta_norm=0.069338
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=49 metric=0.9903 head_norm=1.535430
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.709919e-02
[S16] stored merged vector for next round verification (round=49)
[S16] DEBUG after merge:  round=49 metric=0.9903 head_norm=1.535087 delta_norm=0.037099
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9554 head_norm=1.573682
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.985990e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9549 head_norm=1.552074 delta_norm=0.089860
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.9616
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9020 head_norm=1.544598
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.129933e-01
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9038 head_norm=1.520415 delta_norm=0.212993
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=49 metric=0.9929 head_norm=1.655476
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.698057e-02
[S3] stored merged vector for next round verification (round=49)
[S3] DEBUG after merge:  round=49 metric=0.9925 head_norm=1.659853 delta_norm=0.056981
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=1.525869 cos_to_last_merge=0.9994 (last merge round=48)
[S2] round=50 local utility u=0.064963 metrics={'f1_val': 0.7173508613261619, 'auprc': 0.7423460360069998, 'loss_val': 0.6814085350812237, 'psi': 0.7273489311984971}-{'f1_val': 0.6940625700485997, 'auprc': 0.7513572284184254, 'loss_val': 0.6986388358892661, 'psi': 0.7169804333965301}
[S3] START round=50 head_norm_before_train=1.659853 cos_to_last_merge=1.0000 (last merge round=49)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9968664805923855, 'loss_val': 0.13649638619235202, 'psi': 0.9750891766583296}-{'f1_val': 0.9929404216039119, 'auprc': 0.9980712021642895, 'loss_val': 0.03506696633239624, 'psi': 0.994992733828063}
[S4] START round=50 head_norm_before_train=2.031866 cos_to_last_merge=1.0000 (last merge round=49)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9397560339983878, 'auprc': 0.9248865063133624, 'loss_val': 0.3306784037430402, 'psi': 0.9338082229243776}-{'f1_val': 0.9417134184729203, 'auprc': 0.9314637051954593, 'loss_val': 0.3243147815528461, 'psi': 0.937613533161936}
[S5] START round=50 head_norm_before_train=1.552074 cos_to_last_merge=1.0000 (last merge round=49)
[S5] round=50 local utility u=0.162400 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9942437611157681, 'loss_val': 0.06285662071062903, 'psi': 0.9952346045830378}-{'f1_val': 0.9553693044203071, 'auprc': 0.9904835602014166, 'loss_val': 0.13322015388076386, 'psi': 0.9694150067327509}
[S6] START round=50 head_norm_before_train=1.514723 cos_to_last_merge=0.9996 (last merge round=47)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8716369908824986, 'auprc': 0.9662161722712319, 'loss_val': 0.2931715077576917, 'psi': 0.9094686634379919}-{'f1_val': 0.5980386333840492, 'auprc': 0.8772071280718506, 'loss_val': 0.9476855068176607, 'psi': 0.7097060312591699}
[S7] START round=50 head_norm_before_train=1.646871 cos_to_last_merge=1.0000 (last merge round=49)
[S7] round=50 local utility u=0.025085 metrics={'f1_val': 0.7362138949948178, 'auprc': 0.9821098631275178, 'loss_val': 0.5444962466138794, 'psi': 0.8345722822478978}-{'f1_val': 0.7201003017980845, 'auprc': 0.980987348643287, 'loss_val': 0.4946171919659398, 'psi': 0.8244551205361654}
[S8] START round=50 head_norm_before_train=1.530798 cos_to_last_merge=1.0000 (last merge round=49)
[S8] round=50 local utility u=0.006804 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9963377926373997, 'loss_val': 0.05624102320795622, 'psi': 0.9936156034939693}-{'f1_val': 0.9910860494090681, 'auprc': 0.9944455002575485, 'loss_val': 0.05988337677506146, 'psi': 0.9924298297484603}
[S9] START round=50 head_norm_before_train=1.535873 cos_to_last_merge=0.9773 (last merge round=37)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9867497125176926, 'auprc': 0.9976128647182245, 'loss_val': 0.057858166625644046, 'psi': 0.9910949733979053}-{'f1_val': 0.9971029125121428, 'auprc': 0.995311896918102, 'loss_val': 0.024974245597201704, 'psi': 0.9963865062745265}
[S10] START round=50 head_norm_before_train=1.768041 cos_to_last_merge=1.0000 (last merge round=48)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9935173467861318, 'auprc': 0.9974622081388815, 'loss_val': 0.04053832994885892, 'psi': 0.9950952913272317}-{'f1_val': 0.9939558319194128, 'auprc': 0.9970197229322135, 'loss_val': 0.039655586271756554, 'psi': 0.9951813883245332}
[S11] START round=50 head_norm_before_train=2.031866 cos_to_last_merge=1.0000 (last merge round=49)
[S11] round=50 local utility u=0.001374 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9994909000743256, 'loss_val': 0.025682152889383462, 'psi': 0.9975673771121037}-{'f1_val': 0.9962850284706224, 'auprc': 0.9988369848170942, 'loss_val': 0.026468762266708013, 'psi': 0.9973058110092111}
[S13] START round=50 head_norm_before_train=1.771695 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=50 local utility u=0.258106 metrics={'f1_val': 0.694927454922414, 'auprc': 0.7543676602410594, 'loss_val': 0.7219977299561352, 'psi': 0.7187035370498722}-{'f1_val': 0.6728703227371627, 'auprc': 0.7394491782313065, 'loss_val': 1.0611106673136765, 'psi': 0.6995018649348202}
[S14] START round=50 head_norm_before_train=1.535641 cos_to_last_merge=0.9715 (last merge round=36)
[S14] round=50 local utility u=0.001868 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9983424009654793, 'loss_val': 0.03386891531805405, 'psi': 0.9971303087810981}-{'f1_val': 0.9963442551067831, 'auprc': 0.997690293736027, 'loss_val': 0.0357803872906407, 'psi': 0.9968826705584807}
[S15] START round=50 head_norm_before_train=1.520415 cos_to_last_merge=1.0000 (last merge round=49)
[S15] round=50 local utility u=0.123823 metrics={'f1_val': 0.9343197658592421, 'auprc': 0.991482147932869, 'loss_val': 0.110984065792069, 'psi': 0.9571847186886928}-{'f1_val': 0.9020450466734219, 'auprc': 0.9909018824605001, 'loss_val': 0.1632401871317879, 'psi': 0.9375877809882531}
[S16] START round=50 head_norm_before_train=1.535087 cos_to_last_merge=1.0000 (last merge round=49)
[S16] round=50 local utility u=0.000999 metrics={'f1_val': 0.9903111310479196, 'auprc': 0.9940437271669813, 'loss_val': 0.05751777261214253, 'psi': 0.9918041694955443}-{'f1_val': 0.9903111310479196, 'auprc': 0.9939362866953704, 'loss_val': 0.0591936028330249, 'psi': 0.9917611933068999}
[S17] START round=50 head_norm_before_train=1.900327 cos_to_last_merge=0.8109 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=50 local utility u=0.294353 metrics={'f1_val': 0.6439874558607448, 'auprc': 0.950899469822472, 'loss_val': 0.9058492501933856, 'psi': 0.7667522614454356}-{'f1_val': 0.6052919985405565, 'auprc': 0.9403297505032482, 'loss_val': 1.230673310039933, 'psi': 0.7393070993256332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S14] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → trigger blocked (psi=0.719)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S11] ⇄ pheromone p=0.007 → S4@127.0.0.1:44904
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=50 metric=0.9935 head_norm=1.782117
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.029150e-02
[S10] stored merged vector for next round verification (round=50)
[S10] DEBUG after merge:  round=50 metric=0.9935 head_norm=1.776883 delta_norm=0.010291
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.003 → S13@127.0.0.1:44913
[S4] ⇄ pheromone p=0.013 → S11@127.0.0.1:44912
[S13] ⇄ pheromone p=0.154 → S10@127.0.0.1:44911
[S2] not sending this round → trigger blocked (psi=0.727)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] ⇄ pheromone p=0.006 → S16@127.0.0.1:44916
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9795
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=50 metric=0.8716 head_norm=1.527113
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.274730e-01
[S6] stored merged vector for next round verification (round=50)
[S6] DEBUG after merge:  round=50 metric=0.8706 head_norm=1.522657 delta_norm=0.127473
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.434 → S8@127.0.0.1:44909
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.002 → S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=50 metric=0.9918 head_norm=1.547501
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.557892e-01
[S8] stored merged vector for next round verification (round=50)
[S8] DEBUG after merge:  round=50 metric=0.9922 head_norm=1.529427 delta_norm=0.155789
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.029 → S6@127.0.0.1:44907
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.9995
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=50 metric=0.7362 head_norm=1.681715
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.085804e-02
[S7] stored merged vector for next round verification (round=50)
[S7] DEBUG after merge:  round=50 metric=0.7327 head_norm=1.667872 delta_norm=0.050858
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.194 → S3@127.0.0.1:44903
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9338
[S16] not sending this round → trigger blocked (psi=0.992)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S15
[S2] cosine check vs S15: cos=0.9880
[S5] ⇄ pheromone p=0.086 → S15@127.0.0.1:44915
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=50 metric=0.9606 head_norm=1.678449
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.578118e-02
[S3] stored merged vector for next round verification (round=50)
[S3] DEBUG after merge:  round=50 metric=0.9606 head_norm=1.679885 delta_norm=0.025781
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.065 → S17@127.0.0.1:44917
[S16] ⇄ pheromone p=0.116 → S5@127.0.0.1:44905
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=50 metric=0.7174 head_norm=1.561235
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.206090e-01
[S2] stored merged vector for next round verification (round=50)
[S2] DEBUG after merge:  round=50 metric=0.7159 head_norm=1.547874 delta_norm=0.120609
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.047 → S15@127.0.0.1:44915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=50 metric=0.9343 head_norm=1.543848
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.848761e-01
[S15] stored merged vector for next round verification (round=50)
[S15] DEBUG after merge:  round=50 metric=0.9312 head_norm=1.536839 delta_norm=0.284876
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.251 → S5@127.0.0.1:44905
[S2] START round=51 head_norm_before_train=1.547874 cos_to_last_merge=1.0000 (last merge round=50)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7114428748181544, 'auprc': 0.735771834340426, 'loss_val': 0.7135228269093616, 'psi': 0.7211744586270631}-{'f1_val': 0.7173508613261619, 'auprc': 0.7423460360069998, 'loss_val': 0.6814085350812237, 'psi': 0.7273489311984971}
[S3] START round=51 head_norm_before_train=1.679885 cos_to_last_merge=1.0000 (last merge round=50)
[S3] round=51 local utility u=0.167000 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9991501930957347, 'loss_val': 0.027842813789903914, 'psi': 0.997852223858258}-{'f1_val': 0.9605709740356257, 'auprc': 0.9968664805923855, 'loss_val': 0.13649638619235202, 'psi': 0.9750891766583296}
[S4] START round=51 head_norm_before_train=2.037124 cos_to_last_merge=1.0000 (last merge round=49)
[S4] round=51 local utility u=0.012923 metrics={'f1_val': 0.9411048754385261, 'auprc': 0.9286782219398628, 'loss_val': 0.32430144948618644, 'psi': 0.9361342140390607}-{'f1_val': 0.9397560339983878, 'auprc': 0.9248865063133624, 'loss_val': 0.3306784037430402, 'psi': 0.9338082229243776}
[S5] START round=51 head_norm_before_train=1.581958 cos_to_last_merge=0.9996 (last merge round=49)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9718685638560884, 'auprc': 0.9904714932539018, 'loss_val': 0.09437250501212237, 'psi': 0.9793097356152138}-{'f1_val': 0.995895166894551, 'auprc': 0.9942437611157681, 'loss_val': 0.06285662071062903, 'psi': 0.9952346045830378}
[S6] START round=51 head_norm_before_train=1.522657 cos_to_last_merge=1.0000 (last merge round=50)
[S6] round=51 local utility u=0.391314 metrics={'f1_val': 0.9704488060355958, 'auprc': 0.9824478053649142, 'loss_val': 0.15210997548504462, 'psi': 0.9752484057673232}-{'f1_val': 0.8716369908824986, 'auprc': 0.9662161722712319, 'loss_val': 0.2931715077576917, 'psi': 0.9094686634379919}
[S7] START round=51 head_norm_before_train=1.667872 cos_to_last_merge=1.0000 (last merge round=50)
[S7] round=51 local utility u=0.327052 metrics={'f1_val': 0.8198383060571595, 'auprc': 0.9881097678677844, 'loss_val': 0.41013923515144907, 'psi': 0.8871468907814094}-{'f1_val': 0.7362138949948178, 'auprc': 0.9821098631275178, 'loss_val': 0.5444962466138794, 'psi': 0.8345722822478978}
[S8] START round=51 head_norm_before_train=1.529427 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9770490004777783, 'auprc': 0.9985904313539957, 'loss_val': 0.07529342777237508, 'psi': 0.9856655728282653}-{'f1_val': 0.9918008107316822, 'auprc': 0.9963377926373997, 'loss_val': 0.05624102320795622, 'psi': 0.9936156034939693}
[S9] START round=51 head_norm_before_train=1.546490 cos_to_last_merge=0.9762 (last merge round=37)
[S9] round=51 local utility u=0.039692 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993260118650449, 'loss_val': 0.0250734061670447, 'psi': 0.995319542219037}-{'f1_val': 0.9867497125176926, 'auprc': 0.9976128647182245, 'loss_val': 0.057858166625644046, 'psi': 0.9910949733979053}
[S10] START round=51 head_norm_before_train=1.776883 cos_to_last_merge=1.0000 (last merge round=50)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.9975033664426629, 'loss_val': 0.04012443420026621, 'psi': 0.994980275323088}-{'f1_val': 0.9935173467861318, 'auprc': 0.9974622081388815, 'loss_val': 0.04053832994885892, 'psi': 0.9950952913272317}
[S11] START round=51 head_norm_before_train=2.039619 cos_to_last_merge=1.0000 (last merge round=49)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.997900323759581, 'loss_val': 0.02537723995015791, 'psi': 0.9969311465862059}-{'f1_val': 0.9962850284706224, 'auprc': 0.9994909000743256, 'loss_val': 0.025682152889383462, 'psi': 0.9975673771121037}
[S13] START round=51 head_norm_before_train=1.780492 cos_to_last_merge=0.9999 (last merge round=48)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6907385500745218, 'auprc': 0.6797572022145835, 'loss_val': 1.1548846061674822, 'psi': 0.6863460109305465}-{'f1_val': 0.694927454922414, 'auprc': 0.7543676602410594, 'loss_val': 0.7219977299561352, 'psi': 0.7187035370498722}
[S14] START round=51 head_norm_before_train=1.548472 cos_to_last_merge=0.9703 (last merge round=36)
[S14] round=51 local utility u=0.001545 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9983738327524663, 'loss_val': 0.03233093768178711, 'psi': 0.9972886670467624}-{'f1_val': 0.9963222473248441, 'auprc': 0.9983424009654793, 'loss_val': 0.03386891531805405, 'psi': 0.9971303087810981}
[S15] START round=51 head_norm_before_train=1.536839 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=51 local utility u=0.067603 metrics={'f1_val': 0.9539202245383702, 'auprc': 0.9928277972620905, 'loss_val': 0.0974182875345013, 'psi': 0.9694832536278584}-{'f1_val': 0.9343197658592421, 'auprc': 0.991482147932869, 'loss_val': 0.110984065792069, 'psi': 0.9571847186886928}
[S16] START round=51 head_norm_before_train=1.549113 cos_to_last_merge=1.0000 (last merge round=49)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8699649378015983, 'auprc': 0.9789628948844541, 'loss_val': 0.5800849956537816, 'psi': 0.9135641206347407}-{'f1_val': 0.9903111310479196, 'auprc': 0.9940437271669813, 'loss_val': 0.05751777261214253, 'psi': 0.9918041694955443}
[S17] START round=51 head_norm_before_train=1.909999 cos_to_last_merge=0.8102 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6248502441706557, 'auprc': 0.9663034249091493, 'loss_val': 1.1867270801226195, 'psi': 0.7614315164660532}-{'f1_val': 0.6439874558607448, 'auprc': 0.950899469822472, 'loss_val': 0.9058492501933856, 'psi': 0.7667522614454356}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S7] not sending this round → trigger blocked (psi=0.887)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.975)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S14
[S16] cosine check vs S14: cos=0.9992
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9998
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:44917
[S15] not sending this round → trigger blocked (psi=0.969)
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.6415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S9
[S8] cosine check vs S9: cos=0.9873
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=51 metric=0.9770 head_norm=1.546766
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.235174e-01
[S8] stored merged vector for next round verification (round=51)
[S8] DEBUG after merge:  round=51 metric=0.9774 head_norm=1.544878 delta_norm=0.123517
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=51 metric=0.8700 head_norm=1.561253
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.129470e-02
[S16] stored merged vector for next round verification (round=51)
[S16] DEBUG after merge:  round=51 metric=0.8706 head_norm=1.560297 delta_norm=0.031295
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=52 head_norm_before_train=1.574246 cos_to_last_merge=0.9997 (last merge round=50)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.7136989853442244, 'auprc': 0.7360067031123292, 'loss_val': 0.7280682686535832, 'psi': 0.7226220724514663}-{'f1_val': 0.7114428748181544, 'auprc': 0.735771834340426, 'loss_val': 0.7135228269093616, 'psi': 0.7211744586270631}
[S3] START round=52 head_norm_before_train=1.698519 cos_to_last_merge=1.0000 (last merge round=50)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9708194976176138, 'auprc': 0.9984509316920415, 'loss_val': 0.07333919200464985, 'psi': 0.9818720712473848}-{'f1_val': 0.9969869110332736, 'auprc': 0.9991501930957347, 'loss_val': 0.027842813789903914, 'psi': 0.997852223858258}
[S4] START round=52 head_norm_before_train=2.036582 cos_to_last_merge=0.9999 (last merge round=49)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9398696067525033, 'auprc': 0.9211468660932137, 'loss_val': 0.3283265310207924, 'psi': 0.9323805104887875}-{'f1_val': 0.9411048754385261, 'auprc': 0.9286782219398628, 'loss_val': 0.32430144948618644, 'psi': 0.9361342140390607}
[S5] START round=52 head_norm_before_train=1.622226 cos_to_last_merge=0.9981 (last merge round=49)
[S5] round=52 local utility u=0.100735 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9916468734613441, 'loss_val': 0.0427974248104266, 'psi': 0.9944167405107938}-{'f1_val': 0.9718685638560884, 'auprc': 0.9904714932539018, 'loss_val': 0.09437250501212237, 'psi': 0.9793097356152138}
[S6] START round=52 head_norm_before_train=1.537741 cos_to_last_merge=0.9999 (last merge round=50)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6024465800388541, 'auprc': 0.8116537968109165, 'loss_val': 0.9240672076874863, 'psi': 0.6861294667476792}-{'f1_val': 0.9704488060355958, 'auprc': 0.9824478053649142, 'loss_val': 0.15210997548504462, 'psi': 0.9752484057673232}
[S7] START round=52 head_norm_before_train=1.699204 cos_to_last_merge=0.9998 (last merge round=50)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5536018370332166, 'auprc': 0.8671339892998635, 'loss_val': 0.8872005312008315, 'psi': 0.6790146979398755}-{'f1_val': 0.8198383060571595, 'auprc': 0.9881097678677844, 'loss_val': 0.41013923515144907, 'psi': 0.8871468907814094}
[S8] START round=52 head_norm_before_train=1.544878 cos_to_last_merge=1.0000 (last merge round=51)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.978762396331915, 'auprc': 0.9924942828908867, 'loss_val': 0.07589919604694521, 'psi': 0.9842551509555036}-{'f1_val': 0.9770490004777783, 'auprc': 0.9985904313539957, 'loss_val': 0.07529342777237508, 'psi': 0.9856655728282653}
[S9] START round=52 head_norm_before_train=1.552844 cos_to_last_merge=0.9753 (last merge round=37)
[S9] round=52 local utility u=0.004040 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9952745651325358, 'loss_val': 0.0239975961508395, 'psi': 0.9962213773083686}-{'f1_val': 0.9966924912647621, 'auprc': 0.993260118650449, 'loss_val': 0.0250734061670447, 'psi': 0.995319542219037}
[S10] START round=52 head_norm_before_train=1.790937 cos_to_last_merge=1.0000 (last merge round=50)
[S10] round=52 local utility u=0.000468 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.9974895220157842, 'loss_val': 0.0391472210240441, 'psi': 0.9949747375523365}-{'f1_val': 0.9932982145767046, 'auprc': 0.9975033664426629, 'loss_val': 0.04012443420026621, 'psi': 0.994980275323088}
[S11] START round=52 head_norm_before_train=2.048097 cos_to_last_merge=0.9999 (last merge round=49)
[S11] round=52 local utility u=0.001630 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9986021245641127, 'loss_val': 0.024222567619037527, 'psi': 0.9972118669080186}-{'f1_val': 0.9962850284706224, 'auprc': 0.997900323759581, 'loss_val': 0.02537723995015791, 'psi': 0.9969311465862059}
[S13] START round=52 head_norm_before_train=1.787416 cos_to_last_merge=0.9999 (last merge round=48)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.622353533370323, 'auprc': 0.6818823881861538, 'loss_val': 0.9845849826307488, 'psi': 0.6461650752966552}-{'f1_val': 0.6907385500745218, 'auprc': 0.6797572022145835, 'loss_val': 1.1548846061674822, 'psi': 0.6863460109305465}
[S14] START round=52 head_norm_before_train=1.559969 cos_to_last_merge=0.9692 (last merge round=36)
[S14] round=52 local utility u=0.001911 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984417019404206, 'loss_val': 0.031173834793026434, 'psi': 0.9975619808264341}-{'f1_val': 0.9965652232429598, 'auprc': 0.9983738327524663, 'loss_val': 0.03233093768178711, 'psi': 0.9972886670467624}
[S15] START round=52 head_norm_before_train=1.559526 cos_to_last_merge=0.9998 (last merge round=50)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.7898290373358035, 'auprc': 0.9915290803196355, 'loss_val': 0.3354992123189601, 'psi': 0.8705090545293362}-{'f1_val': 0.9539202245383702, 'auprc': 0.9928277972620905, 'loss_val': 0.0974182875345013, 'psi': 0.9694832536278584}
[S16] START round=52 head_norm_before_train=1.560297 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=52 local utility u=0.648220 metrics={'f1_val': 0.9907785346576063, 'auprc': 0.9934709436425452, 'loss_val': 0.05205036758451417, 'psi': 0.9918554982515819}-{'f1_val': 0.8699649378015983, 'auprc': 0.9789628948844541, 'loss_val': 0.5800849956537816, 'psi': 0.9135641206347407}
[S17] START round=52 head_norm_before_train=1.922326 cos_to_last_merge=0.8095 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6232330928153296, 'auprc': 0.9664295795526652, 'loss_val': 1.23050508774173, 'psi': 0.7605116875102638}-{'f1_val': 0.6248502441706557, 'auprc': 0.9663034249091493, 'loss_val': 1.1867270801226195, 'psi': 0.7614315164660532}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=52 metric=0.6232 head_norm=1.931551
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.756280e-01
[S17] stored merged vector for next round verification (round=52)
[S17] DEBUG after merge:  round=52 metric=0.6215 head_norm=1.645093 delta_norm=0.775628
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9997
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1793) from S14
[S16] cosine check vs S14: cos=0.9996
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=52 metric=0.9963 head_norm=2.057970
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.605305e-02
[S11] stored merged vector for next round verification (round=52)
[S11] DEBUG after merge:  round=52 metric=0.9963 head_norm=2.047138 delta_norm=0.026053
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9815
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9884
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S9
[S8] cosine check vs S9: cos=0.9961
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=52 metric=0.9908 head_norm=1.572556
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.100901e-02
[S16] stored merged vector for next round verification (round=52)
[S16] DEBUG after merge:  round=52 metric=0.9908 head_norm=1.571115 delta_norm=0.021009
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=52 metric=0.9963 head_norm=1.659345
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.305390e-01
[S5] stored merged vector for next round verification (round=52)
[S5] DEBUG after merge:  round=52 metric=0.9963 head_norm=1.611254 delta_norm=0.130539
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=52 metric=0.9788 head_norm=1.560144
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.895599e-02
[S8] stored merged vector for next round verification (round=52)
[S8] DEBUG after merge:  round=52 metric=0.9788 head_norm=1.560085 delta_norm=0.068956
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=52 metric=0.7898 head_norm=1.584019
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.602192e-01
[S15] stored merged vector for next round verification (round=52)
[S15] DEBUG after merge:  round=52 metric=0.7827 head_norm=1.614187 delta_norm=0.160219
[S15] aggregate: ROLLBACK (f1_val pre=0.790 post=0.783 tol_abs=0.005 tol_rel=0.0)
[S2] START round=53 head_norm_before_train=1.597658 cos_to_last_merge=0.9991 (last merge round=50)
[S2] round=53 local utility u=0.006466 metrics={'f1_val': 0.714101519792331, 'auprc': 0.7418814231899374, 'loss_val': 0.7351748283665023, 'psi': 0.7252134811513736}-{'f1_val': 0.7136989853442244, 'auprc': 0.7360067031123292, 'loss_val': 0.7280682686535832, 'psi': 0.7226220724514663}
[S3] START round=53 head_norm_before_train=1.717419 cos_to_last_merge=0.9998 (last merge round=50)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9975016631178979, 'loss_val': 0.10268426918952367, 'psi': 0.9756457164868314}-{'f1_val': 0.9708194976176138, 'auprc': 0.9984509316920415, 'loss_val': 0.07333919200464985, 'psi': 0.9818720712473848}
[S4] START round=53 head_norm_before_train=2.040647 cos_to_last_merge=0.9998 (last merge round=49)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9386650577091245, 'auprc': 0.9189004478842754, 'loss_val': 0.33148069858911194, 'psi': 0.9307592137791848}-{'f1_val': 0.9398696067525033, 'auprc': 0.9211468660932137, 'loss_val': 0.3283265310207924, 'psi': 0.9323805104887875}
[S5] START round=53 head_norm_before_train=1.611254 cos_to_last_merge=1.0000 (last merge round=52)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.991943847146964, 'loss_val': 0.051625350421498906, 'psi': 0.9943146389955162}-{'f1_val': 0.9962633185437604, 'auprc': 0.9916468734613441, 'loss_val': 0.0427974248104266, 'psi': 0.9944167405107938}
[S6] START round=53 head_norm_before_train=1.555221 cos_to_last_merge=0.9996 (last merge round=50)
[S6] round=53 local utility u=0.933580 metrics={'f1_val': 0.8005385686763404, 'auprc': 0.909205883763238, 'loss_val': 0.5381147337431212, 'psi': 0.8440054947110994}-{'f1_val': 0.6024465800388541, 'auprc': 0.8116537968109165, 'loss_val': 0.9240672076874863, 'psi': 0.6861294667476792}
[S7] START round=53 head_norm_before_train=1.728633 cos_to_last_merge=0.9993 (last merge round=50)
[S7] round=53 local utility u=0.943310 metrics={'f1_val': 0.7756900106859552, 'auprc': 0.965517755230388, 'loss_val': 0.6282611770523002, 'psi': 0.8516211085037283}-{'f1_val': 0.5536018370332166, 'auprc': 0.8671339892998635, 'loss_val': 0.8872005312008315, 'psi': 0.6790146979398755}
[S8] START round=53 head_norm_before_train=1.560085 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=53 local utility u=0.063977 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9968836390074185, 'loss_val': 0.05249065441579556, 'psi': 0.9951485973560754}-{'f1_val': 0.978762396331915, 'auprc': 0.9924942828908867, 'loss_val': 0.07589919604694521, 'psi': 0.9842551509555036}
[S9] START round=53 head_norm_before_train=1.563071 cos_to_last_merge=0.9743 (last merge round=37)
[S9] round=53 local utility u=0.000282 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9984000417985816, 'loss_val': 0.025327243777119188, 'psi': 0.9967232835163328}-{'f1_val': 0.9968525854255906, 'auprc': 0.9952745651325358, 'loss_val': 0.0239975961508395, 'psi': 0.9962213773083686}
[S10] START round=53 head_norm_before_train=1.804624 cos_to_last_merge=0.9999 (last merge round=50)
[S10] round=53 local utility u=0.003839 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9952743948706326, 'loss_val': 0.034037230366967965, 'psi': 0.9950099737207782}-{'f1_val': 0.9932982145767046, 'auprc': 0.9974895220157842, 'loss_val': 0.0391472210240441, 'psi': 0.9949747375523365}
[S11] START round=53 head_norm_before_train=2.047138 cos_to_last_merge=1.0000 (last merge round=52)
[S11] round=53 local utility u=0.000287 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9986914898540467, 'loss_val': 0.023917182100958813, 'psi': 0.9972476130239921}-{'f1_val': 0.9962850284706224, 'auprc': 0.9986021245641127, 'loss_val': 0.024222567619037527, 'psi': 0.9972118669080186}
[S13] START round=53 head_norm_before_train=1.792376 cos_to_last_merge=0.9998 (last merge round=48)
[S13] round=53 local utility u=0.294305 metrics={'f1_val': 0.6970308033025516, 'auprc': 0.7140817900497431, 'loss_val': 0.9406374522662099, 'psi': 0.7038511980014281}-{'f1_val': 0.622353533370323, 'auprc': 0.6818823881861538, 'loss_val': 0.9845849826307488, 'psi': 0.6461650752966552}
[S14] START round=53 head_norm_before_train=1.569953 cos_to_last_merge=0.9682 (last merge round=36)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.997675009539347, 'loss_val': 0.03343417736325331, 'psi': 0.9973559752536183}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984417019404206, 'loss_val': 0.031173834793026434, 'psi': 0.9975619808264341}
[S15] START round=53 head_norm_before_train=1.614187 cos_to_last_merge=1.0000 (last merge round=52)
[S15] round=53 local utility u=0.353096 metrics={'f1_val': 0.884107852778927, 'auprc': 0.9920504919099655, 'loss_val': 0.19654420936264355, 'psi': 0.9272849084313424}-{'f1_val': 0.7898290373358035, 'auprc': 0.9915290803196355, 'loss_val': 0.3354992123189601, 'psi': 0.8705090545293362}
[S16] START round=53 head_norm_before_train=1.571115 cos_to_last_merge=1.0000 (last merge round=52)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.987121589717086, 'auprc': 0.9783573815140493, 'loss_val': 0.08246143823506276, 'psi': 0.9836159064358714}-{'f1_val': 0.9907785346576063, 'auprc': 0.9934709436425452, 'loss_val': 0.05205036758451417, 'psi': 0.9918554982515819}
[S17] START round=53 head_norm_before_train=1.645093 cos_to_last_merge=1.0000 (last merge round=52)
[S17] round=53 local utility u=0.130891 metrics={'f1_val': 0.6353310551191214, 'auprc': 0.89565761166709, 'loss_val': 0.8289941847939444, 'psi': 0.7394616777383087}-{'f1_val': 0.6232330928153296, 'auprc': 0.9664295795526652, 'loss_val': 1.23050508774173, 'psi': 0.7605116875102638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=53 metric=0.9387 head_norm=2.046208
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.317156e-02
[S4] stored merged vector for next round verification (round=53)
[S4] DEBUG after merge:  round=53 metric=0.9387 head_norm=2.051829 delta_norm=0.033172
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9995
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.9881
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.9986
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=53 metric=0.6970 head_norm=1.795171
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.769132e-02
[S13] stored merged vector for next round verification (round=53)
[S13] DEBUG after merge:  round=53 metric=0.6888 head_norm=1.802976 delta_norm=0.027691
[S13] aggregate: ROLLBACK (f1_val pre=0.697 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=53 metric=0.9948 head_norm=1.817738
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.116011e-02
[S10] stored merged vector for next round verification (round=53)
[S10] DEBUG after merge:  round=53 metric=0.9948 head_norm=1.806221 delta_norm=0.031160
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.9405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9908
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S9
[S8] cosine check vs S9: cos=0.9985
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=53 metric=0.9611 head_norm=1.735390
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.727575e-02
[S3] stored merged vector for next round verification (round=53)
[S3] DEBUG after merge:  round=53 metric=0.9611 head_norm=1.747355 delta_norm=0.047276
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=53 metric=0.9959 head_norm=1.631920
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.110170e-01
[S5] stored merged vector for next round verification (round=53)
[S5] DEBUG after merge:  round=53 metric=0.9959 head_norm=1.631183 delta_norm=0.111017
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=53 metric=0.8841 head_norm=1.637987
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.812001e-01
[S15] stored merged vector for next round verification (round=53)
[S15] DEBUG after merge:  round=53 metric=0.8841 head_norm=1.604466 delta_norm=0.281200
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:44907
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9881
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=53 metric=0.9940 head_norm=1.576391
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.366855e-02
[S8] stored merged vector for next round verification (round=53)
[S8] DEBUG after merge:  round=53 metric=0.9940 head_norm=1.569771 delta_norm=0.043669
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.619805 cos_to_last_merge=0.9983 (last merge round=50)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.70846909893635, 'auprc': 0.7397425303014176, 'loss_val': 0.7628967925536065, 'psi': 0.720978471482377}-{'f1_val': 0.714101519792331, 'auprc': 0.7418814231899374, 'loss_val': 0.7351748283665023, 'psi': 0.7252134811513736}
[S3] START round=54 head_norm_before_train=1.747355 cos_to_last_merge=1.0000 (last merge round=53)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9936221100282296, 'loss_val': 0.14022842084314918, 'psi': 0.9740938952509641}-{'f1_val': 0.9610750853994537, 'auprc': 0.9975016631178979, 'loss_val': 0.10268426918952367, 'psi': 0.9756457164868314}
[S4] START round=54 head_norm_before_train=2.051829 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=54 local utility u=0.064471 metrics={'f1_val': 0.945536078770137, 'auprc': 0.9428806650018345, 'loss_val': 0.3157056922720303, 'psi': 0.944473913262816}-{'f1_val': 0.9386650577091245, 'auprc': 0.9189004478842754, 'loss_val': 0.33148069858911194, 'psi': 0.9307592137791848}
[S5] START round=54 head_norm_before_train=1.631183 cos_to_last_merge=1.0000 (last merge round=53)
[S5] round=54 local utility u=0.015649 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9983896651278023, 'loss_val': 0.042297047053866776, 'psi': 0.997156153229255}-{'f1_val': 0.995895166894551, 'auprc': 0.991943847146964, 'loss_val': 0.051625350421498906, 'psi': 0.9943146389955162}
[S6] START round=54 head_norm_before_train=1.569919 cos_to_last_merge=0.9992 (last merge round=50)
[S6] round=54 local utility u=0.750325 metrics={'f1_val': 0.9619865713020992, 'auprc': 0.9693130141797545, 'loss_val': 0.18647502469622293, 'psi': 0.9649171484531613}-{'f1_val': 0.8005385686763404, 'auprc': 0.909205883763238, 'loss_val': 0.5381147337431212, 'psi': 0.8440054947110994}
[S7] START round=54 head_norm_before_train=1.760509 cos_to_last_merge=0.9985 (last merge round=50)
[S7] round=54 local utility u=0.419528 metrics={'f1_val': 0.8839329114942189, 'auprc': 0.9450052067074811, 'loss_val': 0.3771240767486011, 'psi': 0.9083618295795237}-{'f1_val': 0.7756900106859552, 'auprc': 0.965517755230388, 'loss_val': 0.6282611770523002, 'psi': 0.8516211085037283}
[S8] START round=54 head_norm_before_train=1.569771 cos_to_last_merge=1.0000 (last merge round=53)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9984851272672106, 'loss_val': 0.051156374606873424, 'psi': 0.9944806316045901}-{'f1_val': 0.9939919029218467, 'auprc': 0.9968836390074185, 'loss_val': 0.05249065441579556, 'psi': 0.9951485973560754}
[S9] START round=54 head_norm_before_train=1.574983 cos_to_last_merge=0.9733 (last merge round=37)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9932784496493796, 'loss_val': 0.023809464298388993, 'psi': 0.9953268746186091}-{'f1_val': 0.9956054446615002, 'auprc': 0.9984000417985816, 'loss_val': 0.025327243777119188, 'psi': 0.9967232835163328}
[S10] START round=54 head_norm_before_train=1.806221 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9950288014007544, 'auprc': 0.9940031644111834, 'loss_val': 0.03262662813283489, 'psi': 0.9946185466049261}-{'f1_val': 0.9948336929542084, 'auprc': 0.9952743948706326, 'loss_val': 0.034037230366967965, 'psi': 0.9950099737207782}
[S11] START round=54 head_norm_before_train=2.055201 cos_to_last_merge=1.0000 (last merge round=52)
[S11] round=54 local utility u=0.000464 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9989524046370564, 'loss_val': 0.02377266346222422, 'psi': 0.9973519789371961}-{'f1_val': 0.9962850284706224, 'auprc': 0.9986914898540467, 'loss_val': 0.023917182100958813, 'psi': 0.9972476130239921}
[S13] START round=54 head_norm_before_train=1.802976 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.6078501737951629, 'auprc': 0.6359841713631712, 'loss_val': 1.3138742257440719, 'psi': 0.6191037728223663}-{'f1_val': 0.6970308033025516, 'auprc': 0.7140817900497431, 'loss_val': 0.9406374522662099, 'psi': 0.7038511980014281}
[S14] START round=54 head_norm_before_train=1.580004 cos_to_last_merge=0.9672 (last merge round=36)
[S14] round=54 local utility u=0.002629 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.998461393113542, 'loss_val': 0.0295291632938281, 'psi': 0.9975698572956826}-{'f1_val': 0.9971432857297993, 'auprc': 0.997675009539347, 'loss_val': 0.03343417736325331, 'psi': 0.9973559752536183}
[S15] START round=54 head_norm_before_train=1.604466 cos_to_last_merge=1.0000 (last merge round=53)
[S15] round=54 local utility u=0.004666 metrics={'f1_val': 0.8847199310971391, 'auprc': 0.9921011747269209, 'loss_val': 0.19103604578265462, 'psi': 0.9276724285490519}-{'f1_val': 0.884107852778927, 'auprc': 0.9920504919099655, 'loss_val': 0.19654420936264355, 'psi': 0.9272849084313424}
[S16] START round=54 head_norm_before_train=1.583134 cos_to_last_merge=1.0000 (last merge round=52)
[S16] round=54 local utility u=0.049276 metrics={'f1_val': 0.9907694580662847, 'auprc': 0.9932727591730665, 'loss_val': 0.0505434856844893, 'psi': 0.9917707785089973}-{'f1_val': 0.987121589717086, 'auprc': 0.9783573815140493, 'loss_val': 0.08246143823506276, 'psi': 0.9836159064358714}
[S17] START round=54 head_norm_before_train=1.661885 cos_to_last_merge=0.9999 (last merge round=52)
[S17] round=54 local utility u=0.012276 metrics={'f1_val': 0.6570731450792096, 'auprc': 0.8501257528525549, 'loss_val': 0.7982986452537078, 'psi': 0.7342941881885476}-{'f1_val': 0.6353310551191214, 'auprc': 0.89565761166709, 'loss_val': 0.8289941847939444, 'psi': 0.7394616777383087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S7] not sending this round → trigger blocked (psi=0.908)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] cosine check vs S4: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9914
[S16] RECEIVED delta(kind=head bytes=1792) from S14
[S16] cosine check vs S14: cos=0.9996
[S5] sending update (kind=head size=1803 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=54 metric=0.9455 head_norm=2.054790
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.614336e-02
[S4] stored merged vector for next round verification (round=54)
[S4] DEBUG after merge:  round=54 metric=0.9451 head_norm=2.054932 delta_norm=0.016143
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=54 metric=0.9620 head_norm=1.582520
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.276183e-01
[S6] stored merged vector for next round verification (round=54)
[S6] DEBUG after merge:  round=54 metric=0.9624 head_norm=1.574295 delta_norm=0.127618
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.928)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9720
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.9872
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=54 metric=0.9918 head_norm=1.586297
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.041230e-01
[S8] stored merged vector for next round verification (round=54)
[S8] DEBUG after merge:  round=54 metric=0.9918 head_norm=1.580985 delta_norm=0.104123
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=54 metric=0.8847 head_norm=1.628976
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.941380e-01
[S15] stored merged vector for next round verification (round=54)
[S15] DEBUG after merge:  round=54 metric=0.8841 head_norm=1.627548 delta_norm=0.194138
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=54 metric=0.9963 head_norm=1.649133
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.324809e-01
[S5] stored merged vector for next round verification (round=54)
[S5] DEBUG after merge:  round=54 metric=0.9963 head_norm=1.616982 delta_norm=0.132481
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=54 metric=0.9908 head_norm=1.595218
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.176196e-02
[S16] stored merged vector for next round verification (round=54)
[S16] DEBUG after merge:  round=54 metric=0.9908 head_norm=1.592372 delta_norm=0.021762
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=1.640236 cos_to_last_merge=0.9974 (last merge round=50)
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.710509354497322, 'auprc': 0.7345641689078574, 'loss_val': 0.7967332575174656, 'psi': 0.720131280261536}-{'f1_val': 0.70846909893635, 'auprc': 0.7397425303014176, 'loss_val': 0.7628967925536065, 'psi': 0.720978471482377}
[S3] START round=55 head_norm_before_train=1.763928 cos_to_last_merge=1.0000 (last merge round=53)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9514949041427468, 'auprc': 0.9943742548733514, 'loss_val': 0.11331893684083634, 'psi': 0.9686466444349886}-{'f1_val': 0.9610750853994537, 'auprc': 0.9936221100282296, 'loss_val': 0.14022842084314918, 'psi': 0.9740938952509641}
[S4] START round=55 head_norm_before_train=2.054932 cos_to_last_merge=1.0000 (last merge round=54)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9420204114117151, 'auprc': 0.9254640913537777, 'loss_val': 0.3263167048376135, 'psi': 0.9353978833885401}-{'f1_val': 0.945536078770137, 'auprc': 0.9428806650018345, 'loss_val': 0.3157056922720303, 'psi': 0.944473913262816}
[S5] START round=55 head_norm_before_train=1.616982 cos_to_last_merge=1.0000 (last merge round=54)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9921366816108353, 'loss_val': 0.053606131731603966, 'psi': 0.9943917727810647}-{'f1_val': 0.9963338119635569, 'auprc': 0.9983896651278023, 'loss_val': 0.042297047053866776, 'psi': 0.997156153229255}
[S6] START round=55 head_norm_before_train=1.574295 cos_to_last_merge=1.0000 (last merge round=54)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7782845636532048, 'auprc': 0.9385296829745761, 'loss_val': 0.5633794755820507, 'psi': 0.8423826113817532}-{'f1_val': 0.9619865713020992, 'auprc': 0.9693130141797545, 'loss_val': 0.18647502469622293, 'psi': 0.9649171484531613}
[S7] START round=55 head_norm_before_train=1.801143 cos_to_last_merge=0.9971 (last merge round=50)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.8764498707944135, 'auprc': 0.9614209922405008, 'loss_val': 0.4030662286546447, 'psi': 0.9104383193728485}-{'f1_val': 0.8839329114942189, 'auprc': 0.9450052067074811, 'loss_val': 0.3771240767486011, 'psi': 0.9083618295795237}
[S8] START round=55 head_norm_before_train=1.580985 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9683198107991999, 'auprc': 0.9975512560080897, 'loss_val': 0.09855211081832543, 'psi': 0.9800123888827559}-{'f1_val': 0.9918109678295097, 'auprc': 0.9984851272672106, 'loss_val': 0.051156374606873424, 'psi': 0.9944806316045901}
[S9] START round=55 head_norm_before_train=1.587107 cos_to_last_merge=0.9723 (last merge round=37)
[S9] round=55 local utility u=0.002106 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9942527851622245, 'loss_val': 0.022520453530959342, 'psi': 0.9957166088237471}-{'f1_val': 0.9966924912647621, 'auprc': 0.9932784496493796, 'loss_val': 0.023809464298388993, 'psi': 0.9953268746186091}
[S10] START round=55 head_norm_before_train=1.819068 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929495733044881, 'loss_val': 0.03489134274559493, 'psi': 0.99429253273342}-{'f1_val': 0.9950288014007544, 'auprc': 0.9940031644111834, 'loss_val': 0.03262662813283489, 'psi': 0.9946185466049261}
[S11] START round=55 head_norm_before_train=2.064731 cos_to_last_merge=0.9999 (last merge round=52)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.99872383188148, 'loss_val': 0.04204427895790388, 'psi': 0.9972749835228132}-{'f1_val': 0.9962850284706224, 'auprc': 0.9989524046370564, 'loss_val': 0.02377266346222422, 'psi': 0.9973519789371961}
[S13] START round=55 head_norm_before_train=1.806038 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=55 local utility u=0.415946 metrics={'f1_val': 0.6261167787628967, 'auprc': 0.7414338896611903, 'loss_val': 0.9079302577145004, 'psi': 0.6722436231222142}-{'f1_val': 0.6078501737951629, 'auprc': 0.6359841713631712, 'loss_val': 1.3138742257440719, 'psi': 0.6191037728223663}
[S14] START round=55 head_norm_before_train=1.589818 cos_to_last_merge=0.9663 (last merge round=36)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9989422807774158, 'loss_val': 0.029503652920150635, 'psi': 0.997397211174357}-{'f1_val': 0.9969755000837764, 'auprc': 0.998461393113542, 'loss_val': 0.0295291632938281, 'psi': 0.9975698572956826}
[S15] START round=55 head_norm_before_train=1.627548 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.7775834742522253, 'auprc': 0.991166424374228, 'loss_val': 0.3511652568992754, 'psi': 0.8630166543010264}-{'f1_val': 0.8847199310971391, 'auprc': 0.9921011747269209, 'loss_val': 0.19103604578265462, 'psi': 0.9276724285490519}
[S16] START round=55 head_norm_before_train=1.592372 cos_to_last_merge=1.0000 (last merge round=54)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9449314388185662, 'auprc': 0.9892511911837587, 'loss_val': 0.15960725081644742, 'psi': 0.9626593397646432}-{'f1_val': 0.9907694580662847, 'auprc': 0.9932727591730665, 'loss_val': 0.0505434856844893, 'psi': 0.9917707785089973}
[S17] START round=55 head_norm_before_train=1.688205 cos_to_last_merge=0.9996 (last merge round=52)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6199326631377633, 'auprc': 0.9090345655582037, 'loss_val': 1.1047768005096827, 'psi': 0.7355734241059395}-{'f1_val': 0.6570731450792096, 'auprc': 0.8501257528525549, 'loss_val': 0.7982986452537078, 'psi': 0.7342941881885476}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:44911
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.278 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.003 → S16@127.0.0.1:44916
[S6] ⇄ pheromone p=0.414 → S8@127.0.0.1:44909
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1807 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=55 metric=0.9963 head_norm=2.074172
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.849772e-02
[S11] stored merged vector for next round verification (round=55)
[S11] DEBUG after merge:  round=55 metric=0.9963 head_norm=2.064307 delta_norm=0.028498
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S4] ⇄ pheromone p=0.016 → S11@127.0.0.1:44912
[S10] RECEIVED delta(kind=head bytes=1807) from S13
[S10] cosine check vs S13: cos=0.9999
[S13] ⇄ pheromone p=0.171 → S10@127.0.0.1:44911
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S9
[S8] cosine check vs S9: cos=0.9880
[S3] ⇄ pheromone p=0.035 → S7@127.0.0.1:44908
[S5] ⇄ pheromone p=0.041 → S15@127.0.0.1:44915
[S2] ⇄ pheromone p=0.016 → S15@127.0.0.1:44915
[S15] ⇄ pheromone p=0.134 → S5@127.0.0.1:44905
[S16] ⇄ pheromone p=0.112 → S5@127.0.0.1:44905
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=55 metric=0.9683 head_norm=1.597735
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.237878e-01
[S8] stored merged vector for next round verification (round=55)
[S8] DEBUG after merge:  round=55 metric=0.9693 head_norm=1.592961 delta_norm=0.123788
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.018 → S6@127.0.0.1:44907
[S9] ⇄ pheromone p=0.005 → S8@127.0.0.1:44909
[S2] START round=56 head_norm_before_train=1.658120 cos_to_last_merge=0.9966 (last merge round=50)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.6422397730096634, 'auprc': 0.7328073760804803, 'loss_val': 1.060638203439673, 'psi': 0.6784668142379902}-{'f1_val': 0.710509354497322, 'auprc': 0.7345641689078574, 'loss_val': 0.7967332575174656, 'psi': 0.720131280261536}
[S3] START round=56 head_norm_before_train=1.780022 cos_to_last_merge=0.9999 (last merge round=53)
[S3] round=56 local utility u=0.185082 metrics={'f1_val': 0.996729136408276, 'auprc': 0.9990226958682291, 'loss_val': 0.02850590732422658, 'psi': 0.9976465601922572}-{'f1_val': 0.9514949041427468, 'auprc': 0.9943742548733514, 'loss_val': 0.11331893684083634, 'psi': 0.9686466444349886}
[S4] START round=56 head_norm_before_train=2.054926 cos_to_last_merge=1.0000 (last merge round=54)
[S4] round=56 local utility u=0.052990 metrics={'f1_val': 0.9475406266819097, 'auprc': 0.9452860992571572, 'loss_val': 0.3129247804111699, 'psi': 0.9466388157120087}-{'f1_val': 0.9420204114117151, 'auprc': 0.9254640913537777, 'loss_val': 0.3263167048376135, 'psi': 0.9353978833885401}
[S5] START round=56 head_norm_before_train=1.634153 cos_to_last_merge=0.9999 (last merge round=54)
[S5] round=56 local utility u=0.002828 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9919490915203006, 'loss_val': 0.04738780313084566, 'psi': 0.9943167367448509}-{'f1_val': 0.995895166894551, 'auprc': 0.9921366816108353, 'loss_val': 0.053606131731603966, 'psi': 0.9943917727810647}
[S6] START round=56 head_norm_before_train=1.583003 cos_to_last_merge=1.0000 (last merge round=54)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.6188817944627723, 'auprc': 0.7734852730823056, 'loss_val': 0.909216447055838, 'psi': 0.6807231859105856}-{'f1_val': 0.7782845636532048, 'auprc': 0.9385296829745761, 'loss_val': 0.5633794755820507, 'psi': 0.8423826113817532}
[S7] START round=56 head_norm_before_train=1.828278 cos_to_last_merge=0.9961 (last merge round=50)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.8640918230489497, 'auprc': 0.976758254202819, 'loss_val': 0.4411656648710522, 'psi': 0.9091583955104975}-{'f1_val': 0.8764498707944135, 'auprc': 0.9614209922405008, 'loss_val': 0.4030662286546447, 'psi': 0.9104383193728485}
[S8] START round=56 head_norm_before_train=1.592961 cos_to_last_merge=1.0000 (last merge round=55)
[S8] round=56 local utility u=0.070177 metrics={'f1_val': 0.9853629043478473, 'auprc': 0.9982148060036469, 'loss_val': 0.06244792116529966, 'psi': 0.9905036650101672}-{'f1_val': 0.9683198107991999, 'auprc': 0.9975512560080897, 'loss_val': 0.09855211081832543, 'psi': 0.9800123888827559}
[S9] START round=56 head_norm_before_train=1.597791 cos_to_last_merge=0.9712 (last merge round=37)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993241872118609, 'loss_val': 0.023140350620231898, 'psi': 0.9953122436063009}-{'f1_val': 0.9966924912647621, 'auprc': 0.9942527851622245, 'loss_val': 0.022520453530959342, 'psi': 0.9957166088237471}
[S10] START round=56 head_norm_before_train=1.830752 cos_to_last_merge=0.9999 (last merge round=53)
[S10] round=56 local utility u=0.003851 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9945907625321594, 'loss_val': 0.03196486724303563, 'psi': 0.9949342862410364}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929495733044881, 'loss_val': 0.03489134274559493, 'psi': 0.99429253273342}
[S11] START round=56 head_norm_before_train=2.064307 cos_to_last_merge=1.0000 (last merge round=55)
[S11] round=56 local utility u=0.002742 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9987240746700736, 'loss_val': 0.03801278542069748, 'psi': 0.9974201828650878}-{'f1_val': 0.9963090846170353, 'auprc': 0.99872383188148, 'loss_val': 0.04204427895790388, 'psi': 0.9972749835228132}
[S13] START round=56 head_norm_before_train=1.809349 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.5837332871883393, 'auprc': 0.6440886731529768, 'loss_val': 1.4354159411875076, 'psi': 0.6078754415741943}-{'f1_val': 0.6261167787628967, 'auprc': 0.7414338896611903, 'loss_val': 0.9079302577145004, 'psi': 0.6722436231222142}
[S14] START round=56 head_norm_before_train=1.600562 cos_to_last_merge=0.9653 (last merge round=36)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9971660554268293, 'auprc': 0.9968049920942206, 'loss_val': 0.03001510347229551, 'psi': 0.9970216300937859}-{'f1_val': 0.9963671647723179, 'auprc': 0.9989422807774158, 'loss_val': 0.029503652920150635, 'psi': 0.997397211174357}
[S15] START round=56 head_norm_before_train=1.648397 cos_to_last_merge=0.9999 (last merge round=54)
[S15] round=56 local utility u=0.219020 metrics={'f1_val': 0.8318469151229039, 'auprc': 0.9892680490936782, 'loss_val': 0.2330104051638307, 'psi': 0.8948153687112136}-{'f1_val': 0.7775834742522253, 'auprc': 0.991166424374228, 'loss_val': 0.3511652568992754, 'psi': 0.8630166543010264}
[S16] START round=56 head_norm_before_train=1.603776 cos_to_last_merge=1.0000 (last merge round=54)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8673926306460686, 'auprc': 0.9816757898260151, 'loss_val': 0.6268067599487886, 'psi': 0.9131058943180472}-{'f1_val': 0.9449314388185662, 'auprc': 0.9892511911837587, 'loss_val': 0.15960725081644742, 'psi': 0.9626593397646432}
[S17] START round=56 head_norm_before_train=1.720302 cos_to_last_merge=0.9987 (last merge round=52)
[S17] round=56 local utility u=0.023580 metrics={'f1_val': 0.6218066748192392, 'auprc': 0.9364623323331822, 'loss_val': 1.151144126157905, 'psi': 0.7476689378248165}-{'f1_val': 0.6199326631377633, 'auprc': 0.9090345655582037, 'loss_val': 1.1047768005096827, 'psi': 0.7355734241059395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=56 metric=0.9952 head_norm=1.841773
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.347192e-02
[S10] stored merged vector for next round verification (round=56)
[S10] DEBUG after merge:  round=56 metric=0.9952 head_norm=1.825482 delta_norm=0.023472
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44905
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=56 metric=0.9966 head_norm=2.073068
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.255959e-02
[S11] stored merged vector for next round verification (round=56)
[S11] DEBUG after merge:  round=56 metric=0.9966 head_norm=2.064850 delta_norm=0.022560
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=56 metric=0.9475 head_norm=2.056845
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.255959e-02
[S4] stored merged vector for next round verification (round=56)
[S4] DEBUG after merge:  round=56 metric=0.9475 head_norm=2.064850 delta_norm=0.022560
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9832
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9976
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] cosine check vs S15: cos=0.9832
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=56 metric=0.9959 head_norm=1.651649
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.522040e-01
[S5] stored merged vector for next round verification (round=56)
[S5] DEBUG after merge:  round=56 metric=0.9959 head_norm=1.652387 delta_norm=0.152204
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44908
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=56 metric=0.8318 head_norm=1.667079
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.522040e-01
[S15] stored merged vector for next round verification (round=56)
[S15] DEBUG after merge:  round=56 metric=0.8318 head_norm=1.652387 delta_norm=0.152204
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9970
[S2] START round=57 head_norm_before_train=1.674316 cos_to_last_merge=0.9958 (last merge round=50)
[S2] round=57 local utility u=0.361946 metrics={'f1_val': 0.698529358233262, 'auprc': 0.7594475949709387, 'loss_val': 0.7544034231675013, 'psi': 0.7228966529283327}-{'f1_val': 0.6422397730096634, 'auprc': 0.7328073760804803, 'loss_val': 1.060638203439673, 'psi': 0.6784668142379902}
[S3] START round=57 head_norm_before_train=1.792574 cos_to_last_merge=0.9998 (last merge round=53)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9620012470396173, 'auprc': 0.9985769299790186, 'loss_val': 0.0916875318874199, 'psi': 0.9766315202153778}-{'f1_val': 0.996729136408276, 'auprc': 0.9990226958682291, 'loss_val': 0.02850590732422658, 'psi': 0.9976465601922572}
[S4] START round=57 head_norm_before_train=2.064850 cos_to_last_merge=1.0000 (last merge round=56)
[S4] round=57 local utility u=0.021901 metrics={'f1_val': 0.9526137386115918, 'auprc': 0.9510668886430209, 'loss_val': 0.31690402970590403, 'psi': 0.9519949986241635}-{'f1_val': 0.9475406266819097, 'auprc': 0.9452860992571572, 'loss_val': 0.3129247804111699, 'psi': 0.9466388157120087}
[S5] START round=57 head_norm_before_train=1.652387 cos_to_last_merge=1.0000 (last merge round=56)
[S5] round=57 local utility u=0.009554 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936690915880745, 'loss_val': 0.03828032980736696, 'psi': 0.9954888177223045}-{'f1_val': 0.995895166894551, 'auprc': 0.9919490915203006, 'loss_val': 0.04738780313084566, 'psi': 0.9943167367448509}
[S6] START round=57 head_norm_before_train=1.595650 cos_to_last_merge=0.9998 (last merge round=54)
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.8344515218987084, 'auprc': 0.9481016558618387, 'loss_val': 0.3652373113475724, 'psi': 0.8799115754839606}-{'f1_val': 0.6188817944627723, 'auprc': 0.7734852730823056, 'loss_val': 0.909216447055838, 'psi': 0.6807231859105856}
[S7] START round=57 head_norm_before_train=1.848670 cos_to_last_merge=0.9952 (last merge round=50)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.8460081745995064, 'auprc': 0.980361668293924, 'loss_val': 0.5342880092797209, 'psi': 0.8997495720772735}-{'f1_val': 0.8640918230489497, 'auprc': 0.976758254202819, 'loss_val': 0.4411656648710522, 'psi': 0.9091583955104975}
[S8] START round=57 head_norm_before_train=1.608321 cos_to_last_merge=0.9999 (last merge round=55)
[S8] round=57 local utility u=0.022847 metrics={'f1_val': 0.992482829258541, 'auprc': 0.9966573339937319, 'loss_val': 0.05480061549511849, 'psi': 0.9941526311526174}-{'f1_val': 0.9853629043478473, 'auprc': 0.9982148060036469, 'loss_val': 0.06244792116529966, 'psi': 0.9905036650101672}
[S9] START round=57 head_norm_before_train=1.604835 cos_to_last_merge=0.9706 (last merge round=37)
[S9] round=57 local utility u=0.001334 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9934435659690573, 'loss_val': 0.022038902108167942, 'psi': 0.9954889776429772}-{'f1_val': 0.9966924912647621, 'auprc': 0.993241872118609, 'loss_val': 0.023140350620231898, 'psi': 0.9953122436063009}
[S10] START round=57 head_norm_before_train=1.825482 cos_to_last_merge=1.0000 (last merge round=56)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9948774586571439, 'loss_val': 0.032961143486189816, 'psi': 0.9948001489944811}-{'f1_val': 0.9951633020469546, 'auprc': 0.9945907625321594, 'loss_val': 0.03196486724303563, 'psi': 0.9949342862410364}
[S11] START round=57 head_norm_before_train=2.064850 cos_to_last_merge=1.0000 (last merge round=56)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986526787925023, 'loss_val': 0.10550931682875057, 'psi': 0.9972465222872221}-{'f1_val': 0.9965509216617638, 'auprc': 0.9987240746700736, 'loss_val': 0.03801278542069748, 'psi': 0.9974201828650878}
[S13] START round=57 head_norm_before_train=1.814526 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=57 local utility u=0.660728 metrics={'f1_val': 0.6977893645400319, 'auprc': 0.6834693374418106, 'loss_val': 0.9164390532363434, 'psi': 0.6920613537007434}-{'f1_val': 0.5837332871883393, 'auprc': 0.6440886731529768, 'loss_val': 1.4354159411875076, 'psi': 0.6078754415741943}
[S14] START round=57 head_norm_before_train=1.608633 cos_to_last_merge=0.9644 (last merge round=36)
[S14] round=57 local utility u=0.002280 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9986634586412979, 'loss_val': 0.028561685171767954, 'psi': 0.997518102448738}-{'f1_val': 0.9971660554268293, 'auprc': 0.9968049920942206, 'loss_val': 0.03001510347229551, 'psi': 0.9970216300937859}
[S15] START round=57 head_norm_before_train=1.652387 cos_to_last_merge=1.0000 (last merge round=56)
[S15] round=57 local utility u=0.538770 metrics={'f1_val': 0.9819396337138754, 'auprc': 0.9918747438363151, 'loss_val': 0.06384711442973506, 'psi': 0.9859136777628512}-{'f1_val': 0.8318469151229039, 'auprc': 0.9892680490936782, 'loss_val': 0.2330104051638307, 'psi': 0.8948153687112136}
[S16] START round=57 head_norm_before_train=1.615315 cos_to_last_merge=0.9999 (last merge round=54)
[S16] round=57 local utility u=0.664668 metrics={'f1_val': 0.9910186731286967, 'auprc': 0.9870083070589085, 'loss_val': 0.05522519674802881, 'psi': 0.9894145267007814}-{'f1_val': 0.8673926306460686, 'auprc': 0.9816757898260151, 'loss_val': 0.6268067599487886, 'psi': 0.9131058943180472}
[S17] START round=57 head_norm_before_train=1.745311 cos_to_last_merge=0.9980 (last merge round=52)
[S17] round=57 local utility u=0.051859 metrics={'f1_val': 0.6322668681456362, 'auprc': 0.9434998732063902, 'loss_val': 1.1312992297399007, 'psi': 0.7567600701699377}-{'f1_val': 0.6218066748192392, 'auprc': 0.9364623323331822, 'loss_val': 1.151144126157905, 'psi': 0.7476689378248165}
[S17] not sending this round → trigger blocked (psi=0.757)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:44911
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S4] not sending this round → trigger blocked (psi=0.952)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=57 metric=0.8460 head_norm=1.873036
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.033859e-02
[S7] stored merged vector for next round verification (round=57)
[S7] DEBUG after merge:  round=57 metric=0.8471 head_norm=1.831019 delta_norm=0.090339
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S5] not sending this round → trigger blocked (psi=0.995)
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9995
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9973
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.986)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=57 metric=0.8345 head_norm=1.605821
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.035668e-02
[S6] stored merged vector for next round verification (round=57)
[S6] DEBUG after merge:  round=57 metric=0.8348 head_norm=1.605937 delta_norm=0.060357
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=57 metric=0.6978 head_norm=1.817767
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.390710e-02
[S13] stored merged vector for next round verification (round=57)
[S13] DEBUG after merge:  round=57 metric=0.6880 head_norm=1.829653 delta_norm=0.023907
[S13] aggregate: ROLLBACK (f1_val pre=0.698 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.9304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S16
[S5] cosine check vs S16: cos=0.9812
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9957
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=57 metric=0.9819 head_norm=1.671092
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.136544e-01
[S15] stored merged vector for next round verification (round=57)
[S15] DEBUG after merge:  round=57 metric=0.9798 head_norm=1.651266 delta_norm=0.313654
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=57 metric=0.9910 head_norm=1.625829
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.655185e-02
[S16] stored merged vector for next round verification (round=57)
[S16] DEBUG after merge:  round=57 metric=0.9910 head_norm=1.620321 delta_norm=0.026552
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=57 metric=0.9967 head_norm=1.670236
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.611811e-01
[S5] stored merged vector for next round verification (round=57)
[S5] DEBUG after merge:  round=57 metric=0.9967 head_norm=1.640282 delta_norm=0.161181
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=57 metric=0.9925 head_norm=1.623137
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.382502e-02
[S8] stored merged vector for next round verification (round=57)
[S8] DEBUG after merge:  round=57 metric=0.9925 head_norm=1.613955 delta_norm=0.023825
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=58 head_norm_before_train=1.690434 cos_to_last_merge=0.9949 (last merge round=50)
[S2] round=58 local utility u=0.081652 metrics={'f1_val': 0.7053734826889451, 'auprc': 0.7791338953108916, 'loss_val': 0.6912238986040629, 'psi': 0.7348776477377237}-{'f1_val': 0.698529358233262, 'auprc': 0.7594475949709387, 'loss_val': 0.7544034231675013, 'psi': 0.7228966529283327}
[S3] START round=58 head_norm_before_train=1.804712 cos_to_last_merge=0.9997 (last merge round=53)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9984079106300126, 'loss_val': 0.1355677705772807, 'psi': 0.9758314558688643}-{'f1_val': 0.9620012470396173, 'auprc': 0.9985769299790186, 'loss_val': 0.0916875318874199, 'psi': 0.9766315202153778}
[S4] START round=58 head_norm_before_train=2.065509 cos_to_last_merge=1.0000 (last merge round=56)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9442352863913562, 'auprc': 0.9346341761761133, 'loss_val': 0.33479154858508253, 'psi': 0.940394842305259}-{'f1_val': 0.9526137386115918, 'auprc': 0.9510668886430209, 'loss_val': 0.31690402970590403, 'psi': 0.9519949986241635}
[S5] START round=58 head_norm_before_train=1.640282 cos_to_last_merge=1.0000 (last merge round=57)
[S5] round=58 local utility u=0.001022 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9977513343459455, 'loss_val': 0.04627458704380189, 'psi': 0.9969008209165122}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936690915880745, 'loss_val': 0.03828032980736696, 'psi': 0.9954888177223045}
[S6] START round=58 head_norm_before_train=1.605937 cos_to_last_merge=1.0000 (last merge round=57)
[S6] round=58 local utility u=0.349858 metrics={'f1_val': 0.9368914353757788, 'auprc': 0.9540593842766415, 'loss_val': 0.2980333297558308, 'psi': 0.9437586149361239}-{'f1_val': 0.8344515218987084, 'auprc': 0.9481016558618387, 'loss_val': 0.3652373113475724, 'psi': 0.8799115754839606}
[S7] START round=58 head_norm_before_train=1.831019 cos_to_last_merge=1.0000 (last merge round=57)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6749621565393075, 'auprc': 0.9623698974508355, 'loss_val': 0.9784115944069403, 'psi': 0.7899252529039187}-{'f1_val': 0.8460081745995064, 'auprc': 0.980361668293924, 'loss_val': 0.5342880092797209, 'psi': 0.8997495720772735}
[S8] START round=58 head_norm_before_train=1.613955 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9988816205896556, 'loss_val': 0.04946033740888352, 'psi': 0.9935542724986446}-{'f1_val': 0.992482829258541, 'auprc': 0.9966573339937319, 'loss_val': 0.05480061549511849, 'psi': 0.9941526311526174}
[S9] START round=58 head_norm_before_train=1.614403 cos_to_last_merge=0.9698 (last merge round=37)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9901606111321243, 'auprc': 0.998836046742497, 'loss_val': 0.038409689241093725, 'psi': 0.9936307853762734}-{'f1_val': 0.9968525854255906, 'auprc': 0.9934435659690573, 'loss_val': 0.022038902108167942, 'psi': 0.9954889776429772}
[S10] START round=58 head_norm_before_train=1.836508 cos_to_last_merge=1.0000 (last merge round=56)
[S10] round=58 local utility u=0.000686 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9954219396630835, 'loss_val': 0.03241581317335989, 'psi': 0.9949372452503362}-{'f1_val': 0.9947486092193725, 'auprc': 0.9948774586571439, 'loss_val': 0.032961143486189816, 'psi': 0.9948001489944811}
[S11] START round=58 head_norm_before_train=2.074497 cos_to_last_merge=1.0000 (last merge round=56)
[S11] round=58 local utility u=0.039762 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.998900569079622, 'loss_val': 0.024103863502626843, 'psi': 0.9970832467754606}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986526787925023, 'loss_val': 0.10550931682875057, 'psi': 0.9972465222872221}
[S13] START round=58 head_norm_before_train=1.829653 cos_to_last_merge=1.0000 (last merge round=57)
[S13] round=58 local utility u=0.274888 metrics={'f1_val': 0.7513407156524403, 'auprc': 0.7083697335171997, 'loss_val': 0.762671458540845, 'psi': 0.734152322798344}-{'f1_val': 0.6977893645400319, 'auprc': 0.6834693374418106, 'loss_val': 0.9164390532363434, 'psi': 0.6920613537007434}
[S14] START round=58 head_norm_before_train=1.615232 cos_to_last_merge=0.9638 (last merge round=36)
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9982759725172772, 'loss_val': 0.02822546146455537, 'psi': 0.9971037374018172}-{'f1_val': 0.996754531653698, 'auprc': 0.9986634586412979, 'loss_val': 0.028561685171767954, 'psi': 0.997518102448738}
[S15] START round=58 head_norm_before_train=1.651266 cos_to_last_merge=1.0000 (last merge round=57)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9121376580915836, 'auprc': 0.9892113554533453, 'loss_val': 0.1367423242135359, 'psi': 0.9429671370362882}-{'f1_val': 0.9819396337138754, 'auprc': 0.9918747438363151, 'loss_val': 0.06384711442973506, 'psi': 0.9859136777628512}
[S16] START round=58 head_norm_before_train=1.620321 cos_to_last_merge=1.0000 (last merge round=57)
[S16] round=58 local utility u=0.012243 metrics={'f1_val': 0.9920862459500474, 'auprc': 0.9910497699403287, 'loss_val': 0.049268087830032725, 'psi': 0.9916716555461599}-{'f1_val': 0.9910186731286967, 'auprc': 0.9870083070589085, 'loss_val': 0.05522519674802881, 'psi': 0.9894145267007814}
[S17] START round=58 head_norm_before_train=1.767684 cos_to_last_merge=0.9972 (last merge round=52)
[S17] round=58 local utility u=0.282883 metrics={'f1_val': 0.6857079065350027, 'auprc': 0.9171845544184334, 'loss_val': 0.8072332947970973, 'psi': 0.778298565688375}-{'f1_val': 0.6322668681456362, 'auprc': 0.9434998732063902, 'loss_val': 1.1312992297399007, 'psi': 0.7567600701699377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.944)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → trigger blocked (psi=0.735)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9999
[S16] not sending this round → trigger blocked (psi=0.992)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=58 metric=0.9946 head_norm=1.847587
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.607180e-02
[S10] stored merged vector for next round verification (round=58)
[S10] DEBUG after merge:  round=58 metric=0.9946 head_norm=1.832552 delta_norm=0.026072
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9639
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=58 metric=0.9121 head_norm=1.669983
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.233253e-01
[S15] stored merged vector for next round verification (round=58)
[S15] DEBUG after merge:  round=58 metric=0.9127 head_norm=1.646466 delta_norm=0.223325
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.704809 cos_to_last_merge=0.9941 (last merge round=50)
[S2] round=59 local utility u=0.033004 metrics={'f1_val': 0.7175335608326026, 'auprc': 0.7721600253833527, 'loss_val': 0.677255625298692, 'psi': 0.7393841466529025}-{'f1_val': 0.7053734826889451, 'auprc': 0.7791338953108916, 'loss_val': 0.6912238986040629, 'psi': 0.7348776477377237}
[S3] START round=59 head_norm_before_train=1.817746 cos_to_last_merge=0.9996 (last merge round=53)
[S3] round=59 local utility u=0.017020 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9990392890100483, 'loss_val': 0.10342273869114758, 'psi': 0.9760840072208787}-{'f1_val': 0.9607804860280988, 'auprc': 0.9984079106300126, 'loss_val': 0.1355677705772807, 'psi': 0.9758314558688643}
[S4] START round=59 head_norm_before_train=2.064836 cos_to_last_merge=1.0000 (last merge round=56)
[S4] round=59 local utility u=0.079976 metrics={'f1_val': 0.9535083393778007, 'auprc': 0.9614443200878522, 'loss_val': 0.310908042213185, 'psi': 0.9566827316618213}-{'f1_val': 0.9442352863913562, 'auprc': 0.9346341761761133, 'loss_val': 0.33479154858508253, 'psi': 0.940394842305259}
[S5] START round=59 head_norm_before_train=1.653060 cos_to_last_merge=0.9999 (last merge round=57)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.991228114809825, 'loss_val': 0.04774709669797249, 'psi': 0.9940283460606606}-{'f1_val': 0.9963338119635569, 'auprc': 0.9977513343459455, 'loss_val': 0.04627458704380189, 'psi': 0.9969008209165122}
[S6] START round=59 head_norm_before_train=1.619833 cos_to_last_merge=0.9999 (last merge round=57)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6945599015308483, 'auprc': 0.8930376068570302, 'loss_val': 0.748603022324198, 'psi': 0.7739509836613211}-{'f1_val': 0.9368914353757788, 'auprc': 0.9540593842766415, 'loss_val': 0.2980333297558308, 'psi': 0.9437586149361239}
[S7] START round=59 head_norm_before_train=1.852958 cos_to_last_merge=0.9999 (last merge round=57)
[S7] round=59 local utility u=0.336136 metrics={'f1_val': 0.742482234103939, 'auprc': 0.9821173292401628, 'loss_val': 0.7705032202543093, 'psi': 0.8383362721584285}-{'f1_val': 0.6749621565393075, 'auprc': 0.9623698974508355, 'loss_val': 0.9784115944069403, 'psi': 0.7899252529039187}
[S8] START round=59 head_norm_before_train=1.626556 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9836013959184189, 'auprc': 0.9985784383438746, 'loss_val': 0.05977950995050388, 'psi': 0.9895922128886012}-{'f1_val': 0.9900027071046373, 'auprc': 0.9988816205896556, 'loss_val': 0.04946033740888352, 'psi': 0.9935542724986446}
[S9] START round=59 head_norm_before_train=1.623912 cos_to_last_merge=0.9688 (last merge round=37)
[S9] round=59 local utility u=0.021263 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9933663930600481, 'loss_val': 0.021128003910765844, 'psi': 0.9956083047313049}-{'f1_val': 0.9901606111321243, 'auprc': 0.998836046742497, 'loss_val': 0.038409689241093725, 'psi': 0.9936307853762734}
[S10] START round=59 head_norm_before_train=1.832552 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9939558319194128, 'auprc': 0.9968228131127779, 'loss_val': 0.033643466614888165, 'psi': 0.9951026243967589}-{'f1_val': 0.994614115641838, 'auprc': 0.9954219396630835, 'loss_val': 0.03241581317335989, 'psi': 0.9949372452503362}
[S11] START round=59 head_norm_before_train=2.085008 cos_to_last_merge=0.9999 (last merge round=56)
[S11] round=59 local utility u=0.000756 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9989057836691144, 'loss_val': 0.022607788421439387, 'psi': 0.9970853326112575}-{'f1_val': 0.9958716985726862, 'auprc': 0.998900569079622, 'loss_val': 0.024103863502626843, 'psi': 0.9970832467754606}
[S13] START round=59 head_norm_before_train=1.834124 cos_to_last_merge=1.0000 (last merge round=57)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.5797295740948086, 'auprc': 0.6545828326115732, 'loss_val': 1.517416138397402, 'psi': 0.6096708775015145}-{'f1_val': 0.7513407156524403, 'auprc': 0.7083697335171997, 'loss_val': 0.762671458540845, 'psi': 0.734152322798344}
[S14] START round=59 head_norm_before_train=1.622668 cos_to_last_merge=0.9631 (last merge round=36)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9963260683907673, 'auprc': 0.9979824560463615, 'loss_val': 0.03007151083806724, 'psi': 0.996988623453005}-{'f1_val': 0.9963222473248441, 'auprc': 0.9982759725172772, 'loss_val': 0.02822546146455537, 'psi': 0.9971037374018172}
[S15] START round=59 head_norm_before_train=1.646466 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=59 local utility u=0.301101 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9909079109445759, 'loss_val': 0.044798401243581636, 'psi': 0.9941626108871149}-{'f1_val': 0.9121376580915836, 'auprc': 0.9892113554533453, 'loss_val': 0.1367423242135359, 'psi': 0.9429671370362882}
[S16] START round=59 head_norm_before_train=1.629950 cos_to_last_merge=1.0000 (last merge round=57)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9918666712997605, 'auprc': 0.9907560523960925, 'loss_val': 0.047324263381847025, 'psi': 0.9914224237382933}-{'f1_val': 0.9920862459500474, 'auprc': 0.9910497699403287, 'loss_val': 0.049268087830032725, 'psi': 0.9916716555461599}
[S17] START round=59 head_norm_before_train=1.789941 cos_to_last_merge=0.9962 (last merge round=52)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6284005774450327, 'auprc': 0.8687587262446317, 'loss_val': 1.1572898613743867, 'psi': 0.7245438369648722}-{'f1_val': 0.6857079065350027, 'auprc': 0.9171845544184334, 'loss_val': 0.8072332947970973, 'psi': 0.778298565688375}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.725 u=0.0000 p_local=0.0836 f1=0.628 auprc=0.869 bytes=46792
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:44912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0011 f1=0.994 auprc=0.997 bytes=46806
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=59 metric=0.5797 head_norm=1.841145
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.081682e-02
[S13] stored merged vector for next round verification (round=59)
[S13] DEBUG after merge:  round=59 metric=0.5791 head_norm=1.844251 delta_norm=0.020817
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=60 psi=0.610 u=0.0000 p_local=0.1987 f1=0.580 auprc=0.655 bytes=44981
[S6] r=60 psi=0.774 u=0.0000 p_local=0.3534 f1=0.695 auprc=0.893 bytes=44902
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0014 f1=0.996 auprc=0.998 bytes=50333
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9998
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=59 metric=0.9535 head_norm=2.060528
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.334875e-02
[S4] stored merged vector for next round verification (round=59)
[S4] DEBUG after merge:  round=59 metric=0.9535 head_norm=2.072672 delta_norm=0.023349
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=60 psi=0.957 u=0.0800 p_local=0.0307 f1=0.954 auprc=0.961 bytes=46722
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] cosine check vs S2: cos=0.9496
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9905
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S9
[S8] cosine check vs S9: cos=0.9951
[S2] r=60 psi=0.739 u=0.0330 p_local=0.0727 f1=0.718 auprc=0.772 bytes=41396
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=59 metric=0.9959 head_norm=2.092948
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.779985e-02
[S11] stored merged vector for next round verification (round=59)
[S11] DEBUG after merge:  round=59 metric=0.9959 head_norm=2.076615 delta_norm=0.027800
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=60 psi=0.997 u=0.0008 p_local=0.0078 f1=0.996 auprc=0.999 bytes=46774
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9972
[S7] r=60 psi=0.838 u=0.3361 p_local=0.1812 f1=0.742 auprc=0.982 bytes=35983
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:44908
[S3] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S3
[S7] cosine check vs S3: cos=0.9972
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=59 metric=0.9963 head_norm=1.663981
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.697405e-01
[S15] stored merged vector for next round verification (round=59)
[S15] DEBUG after merge:  round=59 metric=0.9963 head_norm=1.669603 delta_norm=0.269741
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] r=60 psi=0.994 u=0.3011 p_local=0.2063 f1=0.996 auprc=0.991 bytes=50434
[S16] r=60 psi=0.991 u=0.0000 p_local=0.1331 f1=0.992 auprc=0.991 bytes=48546
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=59 metric=0.9608 head_norm=1.830414
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.424714e-02
[S3] stored merged vector for next round verification (round=59)
[S3] DEBUG after merge:  round=59 metric=0.9608 head_norm=1.854658 delta_norm=0.074247
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] r=60 psi=0.976 u=0.0170 p_local=0.0367 f1=0.961 auprc=0.999 bytes=45019
[S9] r=60 psi=0.996 u=0.0213 p_local=0.0064 f1=0.997 auprc=0.993 bytes=57479
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=59 metric=0.9959 head_norm=1.672287
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.148513e-01
[S5] stored merged vector for next round verification (round=59)
[S5] DEBUG after merge:  round=59 metric=0.9959 head_norm=1.664181 delta_norm=0.114851
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] r=60 psi=0.994 u=0.0000 p_local=0.0185 f1=0.996 auprc=0.991 bytes=46804
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=59 metric=0.9836 head_norm=1.638973
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.066583e-02
[S8] stored merged vector for next round verification (round=59)
[S8] DEBUG after merge:  round=59 metric=0.9840 head_norm=1.633908 delta_norm=0.080666
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] r=60 psi=0.990 u=0.0000 p_local=0.0174 f1=0.984 auprc=0.999 bytes=44892
[S2] START round=60 head_norm_before_train=1.718089 cos_to_last_merge=0.9934 (last merge round=50)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.707322887753136, 'auprc': 0.7771621598976823, 'loss_val': 0.6963125868233773, 'psi': 0.7352585966109546}-{'f1_val': 0.7175335608326026, 'auprc': 0.7721600253833527, 'loss_val': 0.677255625298692, 'psi': 0.7393841466529025}
[S3] START round=60 head_norm_before_train=1.854658 cos_to_last_merge=1.0000 (last merge round=59)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.997870080667999, 'loss_val': 0.15288393973992864, 'psi': 0.9703047761981937}-{'f1_val': 0.9607804860280988, 'auprc': 0.9990392890100483, 'loss_val': 0.10342273869114758, 'psi': 0.9760840072208787}
[S4] START round=60 head_norm_before_train=2.072672 cos_to_last_merge=1.0000 (last merge round=59)
[S4] round=60 local utility u=0.015225 metrics={'f1_val': 0.9563402774836001, 'auprc': 0.9656633618229727, 'loss_val': 0.3101068004333627, 'psi': 0.9600695112193491}-{'f1_val': 0.9535083393778007, 'auprc': 0.9614443200878522, 'loss_val': 0.310908042213185, 'psi': 0.9566827316618213}
[S5] START round=60 head_norm_before_train=1.664181 cos_to_last_merge=1.0000 (last merge round=59)
[S5] round=60 local utility u=0.006570 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9917736505790549, 'loss_val': 0.03845300415621502, 'psi': 0.9944674513578782}-{'f1_val': 0.995895166894551, 'auprc': 0.991228114809825, 'loss_val': 0.04774709669797249, 'psi': 0.9940283460606606}
[S6] START round=60 head_norm_before_train=1.637396 cos_to_last_merge=0.9998 (last merge round=57)
[S6] round=60 local utility u=0.389696 metrics={'f1_val': 0.7820235494098984, 'auprc': 0.9203176866249411, 'loss_val': 0.5758335620628654, 'psi': 0.8373412042959154}-{'f1_val': 0.6945599015308483, 'auprc': 0.8930376068570302, 'loss_val': 0.748603022324198, 'psi': 0.7739509836613211}
[S7] START round=60 head_norm_before_train=1.881522 cos_to_last_merge=0.9997 (last merge round=57)
[S7] round=60 local utility u=0.544558 metrics={'f1_val': 0.873327175248947, 'auprc': 0.9754036596315153, 'loss_val': 0.4463156740050342, 'psi': 0.9141577690019742}-{'f1_val': 0.742482234103939, 'auprc': 0.9821173292401628, 'loss_val': 0.7705032202543093, 'psi': 0.8383362721584285}
[S8] START round=60 head_norm_before_train=1.633908 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=60 local utility u=0.033424 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9987933398810044, 'loss_val': 0.04495512944521176, 'psi': 0.9948161056254331}-{'f1_val': 0.9836013959184189, 'auprc': 0.9985784383438746, 'loss_val': 0.05977950995050388, 'psi': 0.9895922128886012}
[S9] START round=60 head_norm_before_train=1.632818 cos_to_last_merge=0.9679 (last merge round=37)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9939275890322437, 'loss_val': 0.02142219586646481, 'psi': 0.9955673427012324}-{'f1_val': 0.9971029125121428, 'auprc': 0.9933663930600481, 'loss_val': 0.021128003910765844, 'psi': 0.9956083047313049}
[S10] START round=60 head_norm_before_train=1.843258 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9957883803429871, 'loss_val': 0.03535698412307768, 'psi': 0.9945064563553945}-{'f1_val': 0.9939558319194128, 'auprc': 0.9968228131127779, 'loss_val': 0.033643466614888165, 'psi': 0.9951026243967589}
[S11] START round=60 head_norm_before_train=2.076615 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=60 local utility u=0.000870 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9987361650342986, 'loss_val': 0.022839878793162283, 'psi': 0.997265483096093}-{'f1_val': 0.9958716985726862, 'auprc': 0.9989057836691144, 'loss_val': 0.022607788421439387, 'psi': 0.9970853326112575}
[S13] START round=60 head_norm_before_train=1.844251 cos_to_last_merge=1.0000 (last merge round=59)
[S13] round=60 local utility u=0.706171 metrics={'f1_val': 0.7241043970442314, 'auprc': 0.6843794318020839, 'loss_val': 1.060713727524252, 'psi': 0.7082144109473724}-{'f1_val': 0.5797295740948086, 'auprc': 0.6545828326115732, 'loss_val': 1.517416138397402, 'psi': 0.6096708775015145}
[S14] START round=60 head_norm_before_train=1.628955 cos_to_last_merge=0.9624 (last merge round=36)
[S14] round=60 local utility u=0.002764 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9983801004622266, 'loss_val': 0.028195619829260932, 'psi': 0.997393560995144}-{'f1_val': 0.9963260683907673, 'auprc': 0.9979824560463615, 'loss_val': 0.03007151083806724, 'psi': 0.996988623453005}
[S15] START round=60 head_norm_before_train=1.669603 cos_to_last_merge=1.0000 (last merge round=59)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.850252732711992, 'auprc': 0.9923658985555408, 'loss_val': 0.25246173910502484, 'psi': 0.9070979990494115}-{'f1_val': 0.9963324108488076, 'auprc': 0.9909079109445759, 'loss_val': 0.044798401243581636, 'psi': 0.9941626108871149}
[S16] START round=60 head_norm_before_train=1.639322 cos_to_last_merge=1.0000 (last merge round=57)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9392276230932524, 'auprc': 0.9868050489697516, 'loss_val': 0.28458288397702064, 'psi': 0.958258593443852}-{'f1_val': 0.9918666712997605, 'auprc': 0.9907560523960925, 'loss_val': 0.047324263381847025, 'psi': 0.9914224237382933}
[S17] START round=60 head_norm_before_train=1.811371 cos_to_last_merge=0.9952 (last merge round=52)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6112313661500695, 'auprc': 0.8808554021235517, 'loss_val': 1.3361864303934317, 'psi': 0.7190809805394625}-{'f1_val': 0.6284005774450327, 'auprc': 0.8687587262446317, 'loss_val': 1.1572898613743867, 'psi': 0.7245438369648722}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[S7] not sending this round → trigger blocked (psi=0.914)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=60 metric=0.8733 head_norm=1.901125
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.468153e-02
[S7] stored merged vector for next round verification (round=60)
[S7] DEBUG after merge:  round=60 metric=0.8750 head_norm=1.864182 delta_norm=0.084682
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.254 → S3@127.0.0.1:44903
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1807) from S13
[S10] cosine check vs S13: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9948
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=0.9995
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] ⇄ pheromone p=0.002 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.300 → S10@127.0.0.1:44911
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=60 metric=0.9563 head_norm=2.071612
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.230170e-02
[S4] stored merged vector for next round verification (round=60)
[S4] DEBUG after merge:  round=60 metric=0.9563 head_norm=2.078434 delta_norm=0.012302
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.028 → S11@127.0.0.1:44912
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S6] ⇄ pheromone p=0.361 → S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=60 metric=0.9963 head_norm=2.085305
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.230170e-02
[S11] stored merged vector for next round verification (round=60)
[S11] DEBUG after merge:  round=60 metric=0.9963 head_norm=2.078434 delta_norm=0.012302
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.006 → S4@127.0.0.1:44904
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9735
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=0.9948
[S5] ⇄ pheromone p=0.016 → S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.005 → S8@127.0.0.1:44909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=60 metric=0.8503 head_norm=1.687109
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.941164e-01
[S15] stored merged vector for next round verification (round=60)
[S15] DEBUG after merge:  round=60 metric=0.8503 head_norm=1.674033 delta_norm=0.194116
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.165 → S5@127.0.0.1:44905
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=60 metric=0.9392 head_norm=1.649310
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.756434e-02
[S16] stored merged vector for next round verification (round=60)
[S16] DEBUG after merge:  round=60 metric=0.9392 head_norm=1.642156 delta_norm=0.027564
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.106 → S5@127.0.0.1:44905
[S2] ⇄ pheromone p=0.058 → S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=60 metric=0.9922 head_norm=1.646518
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.415525e-02
[S8] stored merged vector for next round verification (round=60)
[S8] DEBUG after merge:  round=60 metric=0.9922 head_norm=1.648699 delta_norm=0.084155
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.021 → S6@127.0.0.1:44907
[S3] ⇄ pheromone p=0.029 → S7@127.0.0.1:44908
[S2] START round=61 head_norm_before_train=1.730240 cos_to_last_merge=0.9926 (last merge round=50)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.6946376203323965, 'auprc': 0.757303786426591, 'loss_val': 0.81796291091751, 'psi': 0.7197040867700744}-{'f1_val': 0.707322887753136, 'auprc': 0.7771621598976823, 'loss_val': 0.6963125868233773, 'psi': 0.7352585966109546}
[S3] START round=61 head_norm_before_train=1.866377 cos_to_last_merge=1.0000 (last merge round=59)
[S3] round=61 local utility u=0.039634 metrics={'f1_val': 0.9600177036600042, 'auprc': 0.9984858241910479, 'loss_val': 0.1240024892701598, 'psi': 0.9754049518724217}-{'f1_val': 0.9519279065516568, 'auprc': 0.997870080667999, 'loss_val': 0.15288393973992864, 'psi': 0.9703047761981937}
[S4] START round=61 head_norm_before_train=2.078434 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9538526284947303, 'auprc': 0.9583243134192858, 'loss_val': 0.3162944803356404, 'psi': 0.9556413024645525}-{'f1_val': 0.9563402774836001, 'auprc': 0.9656633618229727, 'loss_val': 0.3101068004333627, 'psi': 0.9600695112193491}
[S5] START round=61 head_norm_before_train=1.683389 cos_to_last_merge=0.9999 (last merge round=59)
[S5] round=61 local utility u=0.010420 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9977070041107665, 'loss_val': 0.03583535399720327, 'psi': 0.9968830888224407}-{'f1_val': 0.9962633185437604, 'auprc': 0.9917736505790549, 'loss_val': 0.03845300415621502, 'psi': 0.9944674513578782}
[S6] START round=61 head_norm_before_train=1.655161 cos_to_last_merge=0.9996 (last merge round=57)
[S6] round=61 local utility u=0.559240 metrics={'f1_val': 0.9174309465519219, 'auprc': 0.9357808192984283, 'loss_val': 0.31618808595878306, 'psi': 0.9247708956505245}-{'f1_val': 0.7820235494098984, 'auprc': 0.9203176866249411, 'loss_val': 0.5758335620628654, 'psi': 0.8373412042959154}
[S7] START round=61 head_norm_before_train=1.864182 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=61 local utility u=0.100246 metrics={'f1_val': 0.8899065556343162, 'auprc': 0.9743492856734887, 'loss_val': 0.34213738700012863, 'psi': 0.9236836476499851}-{'f1_val': 0.873327175248947, 'auprc': 0.9754036596315153, 'loss_val': 0.4463156740050342, 'psi': 0.9141577690019742}
[S8] START round=61 head_norm_before_train=1.648699 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=61 local utility u=0.006792 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9991840742995841, 'loss_val': 0.041307894322365694, 'psi': 0.9958488319885316}-{'f1_val': 0.9921646161217188, 'auprc': 0.9987933398810044, 'loss_val': 0.04495512944521176, 'psi': 0.9948161056254331}
[S9] START round=61 head_norm_before_train=1.640097 cos_to_last_merge=0.9674 (last merge round=37)
[S9] round=61 local utility u=0.002406 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953923031666783, 'loss_val': 0.02100423869959773, 'psi': 0.9961532283550062}-{'f1_val': 0.9966605118138915, 'auprc': 0.9939275890322437, 'loss_val': 0.02142219586646481, 'psi': 0.9955673427012324}
[S10] START round=61 head_norm_before_train=1.854094 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=61 local utility u=0.003093 metrics={'f1_val': 0.993871046050545, 'auprc': 0.997026883828737, 'loss_val': 0.03420107519276296, 'psi': 0.9951333811618218}-{'f1_val': 0.9936518403636662, 'auprc': 0.9957883803429871, 'loss_val': 0.03535698412307768, 'psi': 0.9945064563553945}
[S11] START round=61 head_norm_before_train=2.078434 cos_to_last_merge=1.0000 (last merge round=60)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987396815563557, 'loss_val': 0.026655344678548604, 'psi': 0.997018891766154}-{'f1_val': 0.9962850284706224, 'auprc': 0.9987361650342986, 'loss_val': 0.022839878793162283, 'psi': 0.997265483096093}
[S13] START round=61 head_norm_before_train=1.849796 cos_to_last_merge=1.0000 (last merge round=59)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6531254337582497, 'auprc': 0.6905333800714534, 'loss_val': 0.8223806571693856, 'psi': 0.6680886122835312}-{'f1_val': 0.7241043970442314, 'auprc': 0.6843794318020839, 'loss_val': 1.060713727524252, 'psi': 0.7082144109473724}
[S14] START round=61 head_norm_before_train=1.635435 cos_to_last_merge=0.9617 (last merge round=36)
[S14] round=61 local utility u=0.000636 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9985604835409913, 'loss_val': 0.026441682150038687, 'psi': 0.9973633273621725}-{'f1_val': 0.9967358680170888, 'auprc': 0.9983801004622266, 'loss_val': 0.028195619829260932, 'psi': 0.997393560995144}
[S15] START round=61 head_norm_before_train=1.674033 cos_to_last_merge=1.0000 (last merge round=60)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7603835465678186, 'auprc': 0.9890691329713284, 'loss_val': 0.4520466646075815, 'psi': 0.8518577811292225}-{'f1_val': 0.850252732711992, 'auprc': 0.9923658985555408, 'loss_val': 0.25246173910502484, 'psi': 0.9070979990494115}
[S16] START round=61 head_norm_before_train=1.642156 cos_to_last_merge=1.0000 (last merge round=60)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8671577337008722, 'auprc': 0.983817352859792, 'loss_val': 0.6715860968434959, 'psi': 0.9138215813644401}-{'f1_val': 0.9392276230932524, 'auprc': 0.9868050489697516, 'loss_val': 0.28458288397702064, 'psi': 0.958258593443852}
[S17] START round=61 head_norm_before_train=1.824666 cos_to_last_merge=0.9948 (last merge round=52)
[S17] round=61 local utility u=0.170264 metrics={'f1_val': 0.6386811972998538, 'auprc': 0.8433837822962567, 'loss_val': 1.0479427153910361, 'psi': 0.720562231298415}-{'f1_val': 0.6112313661500695, 'auprc': 0.8808554021235517, 'loss_val': 1.3361864303934317, 'psi': 0.7190809805394625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:44913
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[S6] not sending this round → trigger blocked (psi=0.925)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=61 metric=0.9174 head_norm=1.671482
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.236867e-02
[S6] stored merged vector for next round verification (round=61)
[S6] DEBUG after merge:  round=61 metric=0.8950 head_norm=1.656474 delta_norm=0.092369
[S6] aggregate: ROLLBACK (f1_val pre=0.917 post=0.895 tol_abs=0.005 tol_rel=0.0)
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.997)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=0.9998
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=61 metric=0.9939 head_norm=1.864160
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.624132e-02
[S10] stored merged vector for next round verification (round=61)
[S10] DEBUG after merge:  round=61 metric=0.9939 head_norm=1.856921 delta_norm=0.016241
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:44908
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S9
[S8] cosine check vs S9: cos=0.9941
[S8] not sending this round → trigger blocked (psi=0.996)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=61 metric=0.9600 head_norm=1.876361
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.434955e-02
[S3] stored merged vector for next round verification (round=61)
[S3] DEBUG after merge:  round=61 metric=0.9606 head_norm=1.876276 delta_norm=0.014350
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=61 metric=0.9936 head_norm=1.661842
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.992837e-02
[S8] stored merged vector for next round verification (round=61)
[S8] DEBUG after merge:  round=61 metric=0.9936 head_norm=1.652763 delta_norm=0.089928
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.743761 cos_to_last_merge=0.9918 (last merge round=50)
[S2] round=62 local utility u=0.159693 metrics={'f1_val': 0.7191996094813893, 'auprc': 0.7760049620642702, 'loss_val': 0.7020524819431386, 'psi': 0.7419217505145417}-{'f1_val': 0.6946376203323965, 'auprc': 0.757303786426591, 'loss_val': 0.81796291091751, 'psi': 0.7197040867700744}
[S3] START round=62 head_norm_before_train=1.876276 cos_to_last_merge=1.0000 (last merge round=61)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.8803277326228914, 'auprc': 0.9870665376847505, 'loss_val': 0.21993988143718643, 'psi': 0.9230232546476351}-{'f1_val': 0.9600177036600042, 'auprc': 0.9984858241910479, 'loss_val': 0.1240024892701598, 'psi': 0.9754049518724217}
[S4] START round=62 head_norm_before_train=2.077443 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=62 local utility u=0.011481 metrics={'f1_val': 0.9540046000197038, 'auprc': 0.9630682534849528, 'loss_val': 0.3084754332734137, 'psi': 0.9576300614058033}-{'f1_val': 0.9538526284947303, 'auprc': 0.9583243134192858, 'loss_val': 0.3162944803356404, 'psi': 0.9556413024645525}
[S5] START round=62 head_norm_before_train=1.699673 cos_to_last_merge=0.9996 (last merge round=59)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9929047987836678, 'loss_val': 0.03593461661589725, 'psi': 0.9946990196501977}-{'f1_val': 0.9963338119635569, 'auprc': 0.9977070041107665, 'loss_val': 0.03583535399720327, 'psi': 0.9968830888224407}
[S6] START round=62 head_norm_before_train=1.656474 cos_to_last_merge=1.0000 (last merge round=61)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6389836932947689, 'auprc': 0.7850555531542068, 'loss_val': 0.81305088230093, 'psi': 0.6974124372385442}-{'f1_val': 0.9174309465519219, 'auprc': 0.9357808192984283, 'loss_val': 0.31618808595878306, 'psi': 0.9247708956505245}
[S7] START round=62 head_norm_before_train=1.876301 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.5871595685277707, 'auprc': 0.9407779885492367, 'loss_val': 1.086825520376342, 'psi': 0.7286069365363572}-{'f1_val': 0.8899065556343162, 'auprc': 0.9743492856734887, 'loss_val': 0.34213738700012863, 'psi': 0.9236836476499851}
[S8] START round=62 head_norm_before_train=1.652763 cos_to_last_merge=1.0000 (last merge round=61)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.8403637440968627, 'auprc': 0.9987094059584606, 'loss_val': 0.288595644504848, 'psi': 0.9037020088415018}-{'f1_val': 0.9936253371144965, 'auprc': 0.9991840742995841, 'loss_val': 0.041307894322365694, 'psi': 0.9958488319885316}
[S9] START round=62 head_norm_before_train=1.648547 cos_to_last_merge=0.9669 (last merge round=37)
[S9] round=62 local utility u=0.004864 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987073463763085, 'loss_val': 0.02122121553850132, 'psi': 0.9974792456388583}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953923031666783, 'loss_val': 0.02100423869959773, 'psi': 0.9961532283550062}
[S10] START round=62 head_norm_before_train=1.856921 cos_to_last_merge=1.0000 (last merge round=61)
[S10] round=62 local utility u=0.000500 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9970008404550301, 'loss_val': 0.03312199249728562, 'psi': 0.995122963812339}-{'f1_val': 0.993871046050545, 'auprc': 0.997026883828737, 'loss_val': 0.03420107519276296, 'psi': 0.9951333811618218}
[S11] START round=62 head_norm_before_train=2.086224 cos_to_last_merge=1.0000 (last merge round=60)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986386847086864, 'loss_val': 0.047129406317095994, 'psi': 0.9973860268805329}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987396815563557, 'loss_val': 0.026655344678548604, 'psi': 0.997018891766154}
[S13] START round=62 head_norm_before_train=1.853987 cos_to_last_merge=0.9999 (last merge round=59)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.6933486525816669, 'auprc': 0.6945186811667688, 'loss_val': 1.1161574172945232, 'psi': 0.6938166640157077}-{'f1_val': 0.6531254337582497, 'auprc': 0.6905333800714534, 'loss_val': 0.8223806571693856, 'psi': 0.6680886122835312}
[S14] START round=62 head_norm_before_train=1.641660 cos_to_last_merge=0.9610 (last merge round=36)
[S14] round=62 local utility u=0.001265 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985522440938468, 'loss_val': 0.026349365409108923, 'psi': 0.9976061976878046}-{'f1_val': 0.9965652232429598, 'auprc': 0.9985604835409913, 'loss_val': 0.026441682150038687, 'psi': 0.9973633273621725}
[S15] START round=62 head_norm_before_train=1.689403 cos_to_last_merge=1.0000 (last merge round=60)
[S15] round=62 local utility u=0.866794 metrics={'f1_val': 0.9816684651301415, 'auprc': 0.994562854538815, 'loss_val': 0.06264893184525994, 'psi': 0.9868262208936109}-{'f1_val': 0.7603835465678186, 'auprc': 0.9890691329713284, 'loss_val': 0.4520466646075815, 'psi': 0.8518577811292225}
[S16] START round=62 head_norm_before_train=1.652517 cos_to_last_merge=1.0000 (last merge round=60)
[S16] round=62 local utility u=0.283498 metrics={'f1_val': 0.9127369623106505, 'auprc': 0.9895331950833162, 'loss_val': 0.3952125879912903, 'psi': 0.9434554554197168}-{'f1_val': 0.8671577337008722, 'auprc': 0.983817352859792, 'loss_val': 0.6715860968434959, 'psi': 0.9138215813644401}
[S17] START round=62 head_norm_before_train=1.837202 cos_to_last_merge=0.9943 (last merge round=52)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.6231019120990001, 'auprc': 0.8567463371820662, 'loss_val': 1.242095950810831, 'psi': 0.7165596821322265}-{'f1_val': 0.6386811972998538, 'auprc': 0.8433837822962567, 'loss_val': 1.0479427153910361, 'psi': 0.720562231298415}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=62 metric=0.6933 head_norm=1.857219
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.913510e-02
[S13] stored merged vector for next round verification (round=62)
[S13] DEBUG after merge:  round=62 metric=0.6890 head_norm=1.860594 delta_norm=0.019135
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=62 metric=0.5872 head_norm=1.884628
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.818999e-02
[S7] stored merged vector for next round verification (round=62)
[S7] DEBUG after merge:  round=62 metric=0.5872 head_norm=1.880411 delta_norm=0.018190
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9999
[S9] not sending this round → trigger blocked (psi=0.997)
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.9622
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[S14] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:44905
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S16
[S5] cosine check vs S16: cos=0.9795
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=0.9622
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=62 metric=0.7192 head_norm=1.757091
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.392372e-01
[S2] stored merged vector for next round verification (round=62)
[S2] DEBUG after merge:  round=62 metric=0.7189 head_norm=1.714481 delta_norm=0.239237
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=62 metric=0.9127 head_norm=1.661326
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.155488e-02
[S16] stored merged vector for next round verification (round=62)
[S16] DEBUG after merge:  round=62 metric=0.9136 head_norm=1.655249 delta_norm=0.021555
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=62 metric=0.9817 head_norm=1.704696
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.392372e-01
[S15] stored merged vector for next round verification (round=62)
[S15] DEBUG after merge:  round=62 metric=0.9776 head_norm=1.714481 delta_norm=0.239237
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=62 metric=0.9959 head_norm=1.718778
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.735422e-01
[S5] stored merged vector for next round verification (round=62)
[S5] DEBUG after merge:  round=62 metric=0.9959 head_norm=1.681364 delta_norm=0.173542
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=1.714481 cos_to_last_merge=1.0000 (last merge round=62)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.7045323621452815, 'auprc': 0.7630090361659305, 'loss_val': 0.7148192000944806, 'psi': 0.7279230317535411}-{'f1_val': 0.7191996094813893, 'auprc': 0.7760049620642702, 'loss_val': 0.7020524819431386, 'psi': 0.7419217505145417}
[S3] START round=63 head_norm_before_train=1.887553 cos_to_last_merge=1.0000 (last merge round=61)
[S3] round=63 local utility u=0.291052 metrics={'f1_val': 0.9603561684511364, 'auprc': 0.9989654649598981, 'loss_val': 0.15370241127127734, 'psi': 0.9757998870546412}-{'f1_val': 0.8803277326228914, 'auprc': 0.9870665376847505, 'loss_val': 0.21993988143718643, 'psi': 0.9230232546476351}
[S4] START round=63 head_norm_before_train=2.077006 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9396710259170152, 'auprc': 0.9245316649247045, 'loss_val': 0.3349724258453506, 'psi': 0.933615281520091}-{'f1_val': 0.9540046000197038, 'auprc': 0.9630682534849528, 'loss_val': 0.3084754332734137, 'psi': 0.9576300614058033}
[S5] START round=63 head_norm_before_train=1.681364 cos_to_last_merge=1.0000 (last merge round=62)
[S5] round=63 local utility u=0.004131 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9964737804065351, 'loss_val': 0.038379041000155135, 'psi': 0.9961266122993446}-{'f1_val': 0.995895166894551, 'auprc': 0.9929047987836678, 'loss_val': 0.03593461661589725, 'psi': 0.9946990196501977}
[S6] START round=63 head_norm_before_train=1.671761 cos_to_last_merge=0.9999 (last merge round=61)
[S6] round=63 local utility u=1.000000 metrics={'f1_val': 0.8315773121384659, 'auprc': 0.944596329171504, 'loss_val': 0.4356737314336455, 'psi': 0.8767849189516812}-{'f1_val': 0.6389836932947689, 'auprc': 0.7850555531542068, 'loss_val': 0.81305088230093, 'psi': 0.6974124372385442}
[S7] START round=63 head_norm_before_train=1.880411 cos_to_last_merge=1.0000 (last merge round=62)
[S7] round=63 local utility u=0.911773 metrics={'f1_val': 0.7895976098883004, 'auprc': 0.9889819347913167, 'loss_val': 0.6225198793214256, 'psi': 0.869351339849507}-{'f1_val': 0.5871595685277707, 'auprc': 0.9407779885492367, 'loss_val': 1.086825520376342, 'psi': 0.7286069365363572}
[S8] START round=63 head_norm_before_train=1.666444 cos_to_last_merge=1.0000 (last merge round=61)
[S8] round=63 local utility u=0.542920 metrics={'f1_val': 0.983027569283401, 'auprc': 0.9990082719172371, 'loss_val': 0.05963585681383955, 'psi': 0.9894198503369355}-{'f1_val': 0.8403637440968627, 'auprc': 0.9987094059584606, 'loss_val': 0.288595644504848, 'psi': 0.9037020088415018}
[S9] START round=63 head_norm_before_train=1.650523 cos_to_last_merge=0.9653 (last merge round=37)
[S9] round=63 local utility u=0.000010 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987141104086175, 'loss_val': 0.021221546370648728, 'psi': 0.9974819512517819}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987073463763085, 'loss_val': 0.02122121553850132, 'psi': 0.9974792456388583}
[S10] START round=63 head_norm_before_train=1.866193 cos_to_last_merge=1.0000 (last merge round=61)
[S10] round=63 local utility u=0.001440 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9970417219489401, 'loss_val': 0.03167973250509575, 'psi': 0.9952708840777443}-{'f1_val': 0.993871046050545, 'auprc': 0.9970008404550301, 'loss_val': 0.03312199249728562, 'psi': 0.995122963812339}
[S11] START round=63 head_norm_before_train=2.094866 cos_to_last_merge=1.0000 (last merge round=60)
[S11] round=63 local utility u=0.004012 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986359555551226, 'loss_val': 0.03909727798659318, 'psi': 0.9973849352191074}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986386847086864, 'loss_val': 0.047129406317095994, 'psi': 0.9973860268805329}
[S13] START round=63 head_norm_before_train=1.860594 cos_to_last_merge=1.0000 (last merge round=62)
[S13] round=63 local utility u=0.209359 metrics={'f1_val': 0.7141232461417018, 'auprc': 0.7444268103120482, 'loss_val': 0.9718109212586916, 'psi': 0.7262446718098403}-{'f1_val': 0.6933486525816669, 'auprc': 0.6945186811667688, 'loss_val': 1.1161574172945232, 'psi': 0.6938166640157077}
[S14] START round=63 head_norm_before_train=1.649430 cos_to_last_merge=0.9603 (last merge round=36)
[S14] round=63 local utility u=0.000504 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985464163549391, 'loss_val': 0.025323101921651152, 'psi': 0.9976038665922415}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985522440938468, 'loss_val': 0.026349365409108923, 'psi': 0.9976061976878046}
[S15] START round=63 head_norm_before_train=1.714481 cos_to_last_merge=1.0000 (last merge round=62)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.8310895649338736, 'auprc': 0.9906303171547716, 'loss_val': 0.30818094632626514, 'psi': 0.8949058658222329}-{'f1_val': 0.9816684651301415, 'auprc': 0.994562854538815, 'loss_val': 0.06264893184525994, 'psi': 0.9868262208936109}
[S16] START round=63 head_norm_before_train=1.655249 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=63 local utility u=0.168435 metrics={'f1_val': 0.9434053338135866, 'auprc': 0.9918791373747659, 'loss_val': 0.24938997229632556, 'psi': 0.9627948552380583}-{'f1_val': 0.9127369623106505, 'auprc': 0.9895331950833162, 'loss_val': 0.3952125879912903, 'psi': 0.9434554554197168}
[S17] START round=63 head_norm_before_train=1.847241 cos_to_last_merge=0.9941 (last merge round=52)
[S17] round=63 local utility u=0.097022 metrics={'f1_val': 0.6324235125050642, 'auprc': 0.8622545324858458, 'loss_val': 1.1205057847343007, 'psi': 0.7243559204973768}-{'f1_val': 0.6231019120990001, 'auprc': 0.8567463371820662, 'loss_val': 1.242095950810831, 'psi': 0.7165596821322265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44915
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1806) from S10
[S13] cosine check vs S10: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9977
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1808) from S7
[S3] cosine check vs S7: cos=0.9999
[S16] not sending this round → trigger blocked (psi=0.963)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44908
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=63 metric=0.7141 head_norm=1.863475
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.129615e-02
[S13] stored merged vector for next round verification (round=63)
[S13] DEBUG after merge:  round=63 metric=0.7145 head_norm=1.869681 delta_norm=0.011296
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=63 metric=0.9941 head_norm=1.875935
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.129616e-02
[S10] stored merged vector for next round verification (round=63)
[S10] DEBUG after merge:  round=63 metric=0.9941 head_norm=1.869681 delta_norm=0.011296
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:44907
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=0.9448
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9977
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9998
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=63 metric=0.9966 head_norm=2.104133
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.224129e-02
[S11] stored merged vector for next round verification (round=63)
[S11] DEBUG after merge:  round=63 metric=0.9966 head_norm=2.090495 delta_norm=0.022241
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9830 head_norm=1.678080
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.779095e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9820 head_norm=1.681947 delta_norm=0.057791
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=63 metric=0.8311 head_norm=1.729468
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.857079e-01
[S15] stored merged vector for next round verification (round=63)
[S15] DEBUG after merge:  round=63 metric=0.8311 head_norm=1.694761 delta_norm=0.285708
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=63 metric=0.9604 head_norm=1.898965
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.337889e-02
[S3] stored merged vector for next round verification (round=63)
[S3] DEBUG after merge:  round=63 metric=0.9604 head_norm=1.894761 delta_norm=0.013379
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.725643 cos_to_last_merge=1.0000 (last merge round=62)
[S2] round=64 local utility u=0.019246 metrics={'f1_val': 0.7203055574714299, 'auprc': 0.7473492224708712, 'loss_val': 0.7239878077990949, 'psi': 0.7311230234712064}-{'f1_val': 0.7045323621452815, 'auprc': 0.7630090361659305, 'loss_val': 0.7148192000944806, 'psi': 0.7279230317535411}
[S3] START round=64 head_norm_before_train=1.894761 cos_to_last_merge=1.0000 (last merge round=63)
[S3] round=64 local utility u=0.078110 metrics={'f1_val': 0.9730927139137879, 'auprc': 0.9992394654386769, 'loss_val': 0.07472468120580363, 'psi': 0.9835514145237436}-{'f1_val': 0.9603561684511364, 'auprc': 0.9989654649598981, 'loss_val': 0.15370241127127734, 'psi': 0.9757998870546412}
[S4] START round=64 head_norm_before_train=2.076142 cos_to_last_merge=0.9999 (last merge round=60)
[S4] round=64 local utility u=0.011598 metrics={'f1_val': 0.9402386096257961, 'auprc': 0.9300618238936753, 'loss_val': 0.3317718396498045, 'psi': 0.9361678953329478}-{'f1_val': 0.9396710259170152, 'auprc': 0.9245316649247045, 'loss_val': 0.3349724258453506, 'psi': 0.933615281520091}
[S5] START round=64 head_norm_before_train=1.707814 cos_to_last_merge=0.9998 (last merge round=62)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9928187193378246, 'loss_val': 0.037391239898670194, 'psi': 0.9949277749132639}-{'f1_val': 0.995895166894551, 'auprc': 0.9964737804065351, 'loss_val': 0.038379041000155135, 'psi': 0.9961266122993446}
[S6] START round=64 head_norm_before_train=1.687784 cos_to_last_merge=0.9997 (last merge round=61)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6175376710100889, 'auprc': 0.8719793520510113, 'loss_val': 0.9013900450406631, 'psi': 0.719314343426458}-{'f1_val': 0.8315773121384659, 'auprc': 0.944596329171504, 'loss_val': 0.4356737314336455, 'psi': 0.8767849189516812}
[S7] START round=64 head_norm_before_train=1.890643 cos_to_last_merge=1.0000 (last merge round=62)
[S7] round=64 local utility u=0.809643 metrics={'f1_val': 0.9786769050378334, 'auprc': 0.9849047869871201, 'loss_val': 0.12547795259635122, 'psi': 0.9811680578175481}-{'f1_val': 0.7895976098883004, 'auprc': 0.9889819347913167, 'loss_val': 0.6225198793214256, 'psi': 0.869351339849507}
[S8] START round=64 head_norm_before_train=1.681947 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.012757 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9990903338478685, 'loss_val': 0.05262820986114086, 'psi': 0.9912787574484897}-{'f1_val': 0.983027569283401, 'auprc': 0.9990082719172371, 'loss_val': 0.05963585681383955, 'psi': 0.9894198503369355}
[S9] START round=64 head_norm_before_train=1.657021 cos_to_last_merge=0.9644 (last merge round=37)
[S9] round=64 local utility u=0.000194 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986502103314832, 'loss_val': 0.02064178583449768, 'psi': 0.9974563912209281}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987141104086175, 'loss_val': 0.021221546370648728, 'psi': 0.9974819512517819}
[S10] START round=64 head_norm_before_train=1.869681 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=64 local utility u=0.000066 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9969843041168371, 'loss_val': 0.03137543597034814, 'psi': 0.9952479169449031}-{'f1_val': 0.9940903254969471, 'auprc': 0.9970417219489401, 'loss_val': 0.03167973250509575, 'psi': 0.9952708840777443}
[S11] START round=64 head_norm_before_train=2.090495 cos_to_last_merge=1.0000 (last merge round=63)
[S11] round=64 local utility u=0.002152 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986107195825467, 'loss_val': 0.03471724555028659, 'psi': 0.997374840830077}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986359555551226, 'loss_val': 0.03909727798659318, 'psi': 0.9973849352191074}
[S13] START round=64 head_norm_before_train=1.869681 cos_to_last_merge=1.0000 (last merge round=63)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6249477919760641, 'auprc': 0.690248904493932, 'loss_val': 1.035266758832013, 'psi': 0.6510682369832113}-{'f1_val': 0.7141232461417018, 'auprc': 0.7444268103120482, 'loss_val': 0.9718109212586916, 'psi': 0.7262446718098403}
[S14] START round=64 head_norm_before_train=1.657542 cos_to_last_merge=0.9595 (last merge round=36)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.998861356732502, 'loss_val': 0.024926759274381476, 'psi': 0.9973378910879072}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985464163549391, 'loss_val': 0.025323101921651152, 'psi': 0.9976038665922415}
[S15] START round=64 head_norm_before_train=1.694761 cos_to_last_merge=1.0000 (last merge round=63)
[S15] round=64 local utility u=0.633460 metrics={'f1_val': 0.9954184702899038, 'auprc': 0.9939720704647339, 'loss_val': 0.037260031313814286, 'psi': 0.9948399103598359}-{'f1_val': 0.8310895649338736, 'auprc': 0.9906303171547716, 'loss_val': 0.30818094632626514, 'psi': 0.8949058658222329}
[S16] START round=64 head_norm_before_train=1.664806 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=64 local utility u=0.041714 metrics={'f1_val': 0.9450685542835229, 'auprc': 0.9917195737834343, 'loss_val': 0.17546306150040472, 'psi': 0.9637289620834875}-{'f1_val': 0.9434053338135866, 'auprc': 0.9918791373747659, 'loss_val': 0.24938997229632556, 'psi': 0.9627948552380583}
[S17] START round=64 head_norm_before_train=1.860283 cos_to_last_merge=0.9936 (last merge round=52)
[S17] round=64 local utility u=0.024192 metrics={'f1_val': 0.6356115915390532, 'auprc': 0.8798095820841872, 'loss_val': 1.1439163186736534, 'psi': 0.7332907877571069}-{'f1_val': 0.6324235125050642, 'auprc': 0.8622545324858458, 'loss_val': 1.1205057847343007, 'psi': 0.7243559204973768}
[S17] not sending this round → trigger blocked (psi=0.733)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.981)
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=64 metric=0.9787 head_norm=1.908405
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.893708e-02
[S7] stored merged vector for next round verification (round=64)
[S7] DEBUG after merge:  round=64 metric=0.9789 head_norm=1.903597 delta_norm=0.018937
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=64 metric=0.6175 head_norm=1.702960
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.542477e-02
[S6] stored merged vector for next round verification (round=64)
[S6] DEBUG after merge:  round=64 metric=0.6164 head_norm=1.689299 delta_norm=0.065425
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9998
[S9] not sending this round → trigger blocked (psi=0.997)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=64 metric=0.9402 head_norm=2.081044
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.678645e-02
[S4] stored merged vector for next round verification (round=64)
[S4] DEBUG after merge:  round=64 metric=0.9402 head_norm=2.092448 delta_norm=0.026786
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.984)
[S8] not sending this round → trigger blocked (psi=0.991)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] cosine check vs S2: cos=0.9858
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=0.9858
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=64 metric=0.9954 head_norm=1.708308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.461635e-01
[S15] stored merged vector for next round verification (round=64)
[S15] DEBUG after merge:  round=64 metric=0.9954 head_norm=1.717108 delta_norm=0.146163
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=1.738198 cos_to_last_merge=0.9999 (last merge round=62)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7198649484442197, 'auprc': 0.7419595807838922, 'loss_val': 0.7452555607443616, 'psi': 0.7287028013800887}-{'f1_val': 0.7203055574714299, 'auprc': 0.7473492224708712, 'loss_val': 0.7239878077990949, 'psi': 0.7311230234712064}
[S3] START round=65 head_norm_before_train=1.905783 cos_to_last_merge=1.0000 (last merge round=63)
[S3] round=65 local utility u=0.090797 metrics={'f1_val': 0.9964618438119996, 'auprc': 0.9988713667610473, 'loss_val': 0.03224026569288076, 'psi': 0.9974256529916188}-{'f1_val': 0.9730927139137879, 'auprc': 0.9992394654386769, 'loss_val': 0.07472468120580363, 'psi': 0.9835514145237436}
[S4] START round=65 head_norm_before_train=2.092448 cos_to_last_merge=1.0000 (last merge round=64)
[S4] round=65 local utility u=0.017085 metrics={'f1_val': 0.9418947868179367, 'auprc': 0.9372833287377728, 'loss_val': 0.32920419387313343, 'psi': 0.9400502035858711}-{'f1_val': 0.9402386096257961, 'auprc': 0.9300618238936753, 'loss_val': 0.3317718396498045, 'psi': 0.9361678953329478}
[S5] START round=65 head_norm_before_train=1.728481 cos_to_last_merge=0.9994 (last merge round=62)
[S5] round=65 local utility u=0.007013 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9966711896517481, 'loss_val': 0.032290538179803416, 'psi': 0.9962055759974298}-{'f1_val': 0.9963338119635569, 'auprc': 0.9928187193378246, 'loss_val': 0.037391239898670194, 'psi': 0.9949277749132639}
[S6] START round=65 head_norm_before_train=1.689299 cos_to_last_merge=1.0000 (last merge round=64)
[S6] round=65 local utility u=0.643124 metrics={'f1_val': 0.751977452205555, 'auprc': 0.9361459553709977, 'loss_val': 0.6142807981596714, 'psi': 0.8256448534717321}-{'f1_val': 0.6175376710100889, 'auprc': 0.8719793520510113, 'loss_val': 0.9013900450406631, 'psi': 0.719314343426458}
[S7] START round=65 head_norm_before_train=1.903597 cos_to_last_merge=1.0000 (last merge round=64)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.8344408871276406, 'auprc': 0.9705128377361627, 'loss_val': 0.7021882427780889, 'psi': 0.8888696673710494}-{'f1_val': 0.9786769050378334, 'auprc': 0.9849047869871201, 'loss_val': 0.12547795259635122, 'psi': 0.9811680578175481}
[S8] START round=65 head_norm_before_train=1.692564 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.030598 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.999247850573701, 'loss_val': 0.037230946932739574, 'psi': 0.9958743424981784}-{'f1_val': 0.9860710398489039, 'auprc': 0.9990903338478685, 'loss_val': 0.05262820986114086, 'psi': 0.9912787574484897}
[S9] START round=65 head_norm_before_train=1.664078 cos_to_last_merge=0.9633 (last merge round=37)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9938353889620102, 'loss_val': 0.0527218848092034, 'psi': 0.9903513602609654}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986502103314832, 'loss_val': 0.02064178583449768, 'psi': 0.9974563912209281}
[S10] START round=65 head_norm_before_train=1.879405 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=65 local utility u=0.002272 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9968572311134603, 'loss_val': 0.030400621375019386, 'psi': 0.9955920579770077}-{'f1_val': 0.9940903254969471, 'auprc': 0.9969843041168371, 'loss_val': 0.03137543597034814, 'psi': 0.9952479169449031}
[S11] START round=65 head_norm_before_train=2.098360 cos_to_last_merge=1.0000 (last merge round=63)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998603592240151, 'loss_val': 0.03531700475865509, 'psi': 0.9973719898931188}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986107195825467, 'loss_val': 0.03471724555028659, 'psi': 0.997374840830077}
[S13] START round=65 head_norm_before_train=1.877564 cos_to_last_merge=1.0000 (last merge round=63)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6670445133310738, 'auprc': 0.6537989837580281, 'loss_val': 1.2939308362779574, 'psi': 0.6617463015018555}-{'f1_val': 0.6249477919760641, 'auprc': 0.690248904493932, 'loss_val': 1.035266758832013, 'psi': 0.6510682369832113}
[S14] START round=65 head_norm_before_train=1.665164 cos_to_last_merge=0.9588 (last merge round=36)
[S14] round=65 local utility u=0.000984 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9986387692624958, 'loss_val': 0.0249087359129408, 'psi': 0.9975106071886074}-{'f1_val': 0.9963222473248441, 'auprc': 0.998861356732502, 'loss_val': 0.024926759274381476, 'psi': 0.9973378910879072}
[S15] START round=65 head_norm_before_train=1.717108 cos_to_last_merge=1.0000 (last merge round=64)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.845501197784992, 'auprc': 0.9896806630730259, 'loss_val': 0.30466874284495254, 'psi': 0.9031729839002055}-{'f1_val': 0.9954184702899038, 'auprc': 0.9939720704647339, 'loss_val': 0.037260031313814286, 'psi': 0.9948399103598359}
[S16] START round=65 head_norm_before_train=1.674617 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8506040518404645, 'auprc': 0.9763026358219928, 'loss_val': 0.862390446209098, 'psi': 0.9008834854330758}-{'f1_val': 0.9450685542835229, 'auprc': 0.9917195737834343, 'loss_val': 0.17546306150040472, 'psi': 0.9637289620834875}
[S17] START round=65 head_norm_before_train=1.874970 cos_to_last_merge=0.9929 (last merge round=52)
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6224041733107815, 'auprc': 0.9197870840005898, 'loss_val': 1.3761537458373603, 'psi': 0.7413573375867049}-{'f1_val': 0.6356115915390532, 'auprc': 0.8798095820841872, 'loss_val': 1.1439163186736534, 'psi': 0.7332907877571069}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.940)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=65 metric=0.9968 head_norm=1.672127
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.987068e-02
[S14] stored merged vector for next round verification (round=65)
[S14] DEBUG after merge:  round=65 metric=0.9968 head_norm=1.673255 delta_norm=0.019871
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.015 → S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=65 metric=0.9966 head_norm=2.105136
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.427989e-02
[S11] stored merged vector for next round verification (round=65)
[S11] DEBUG after merge:  round=65 metric=0.9966 head_norm=2.092984 delta_norm=0.024280
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.003 → S4@127.0.0.1:44904
[S7] ⇄ pheromone p=0.338 → S3@127.0.0.1:44903
[S13] ⇄ pheromone p=0.125 → S10@127.0.0.1:44911
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9999
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:44908
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9676
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] cosine check vs S3: cos=0.9999
[S5] ⇄ pheromone p=0.008 → S15@127.0.0.1:44915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.421 → S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:44907
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=65 metric=0.9936 head_norm=1.704457
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.319706e-02
[S8] stored merged vector for next round verification (round=65)
[S8] DEBUG after merge:  round=65 metric=0.9936 head_norm=1.704697 delta_norm=0.013197
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.085 → S6@127.0.0.1:44907
[S16] ⇄ pheromone p=0.092 → S14@127.0.0.1:44914
[S3] ⇄ pheromone p=0.081 → S7@127.0.0.1:44908
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=65 metric=0.7199 head_norm=1.752084
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.514001e-01
[S2] stored merged vector for next round verification (round=65)
[S2] DEBUG after merge:  round=65 metric=0.7196 head_norm=1.723698 delta_norm=0.151400
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.038 → S15@127.0.0.1:44915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=65 metric=0.8455 head_norm=1.730069
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.220334e-01
[S15] stored merged vector for next round verification (round=65)
[S15] DEBUG after merge:  round=65 metric=0.8462 head_norm=1.726879 delta_norm=0.222033
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.244 → S2@127.0.0.1:44902
[S2] START round=66 head_norm_before_train=1.723698 cos_to_last_merge=1.0000 (last merge round=65)
[S2] round=66 local utility u=0.007528 metrics={'f1_val': 0.7200036721600143, 'auprc': 0.7420688937276203, 'loss_val': 0.7313591311514862, 'psi': 0.7288297607870566}-{'f1_val': 0.7198649484442197, 'auprc': 0.7419595807838922, 'loss_val': 0.7452555607443616, 'psi': 0.7287028013800887}
[S3] START round=66 head_norm_before_train=1.917389 cos_to_last_merge=1.0000 (last merge round=63)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.958793171903411, 'auprc': 0.9927031781096012, 'loss_val': 0.15037478319961772, 'psi': 0.9723571743858871}-{'f1_val': 0.9964618438119996, 'auprc': 0.9988713667610473, 'loss_val': 0.03224026569288076, 'psi': 0.9974256529916188}
[S4] START round=66 head_norm_before_train=2.101695 cos_to_last_merge=1.0000 (last merge round=64)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9386590927654859, 'auprc': 0.9218337816214399, 'loss_val': 0.3432559708085144, 'psi': 0.9319289683078675}-{'f1_val': 0.9418947868179367, 'auprc': 0.9372833287377728, 'loss_val': 0.32920419387313343, 'psi': 0.9400502035858711}
[S5] START round=66 head_norm_before_train=1.752051 cos_to_last_merge=0.9988 (last merge round=62)
[S5] round=66 local utility u=0.003203 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9973787489234982, 'loss_val': 0.03063951301689265, 'psi': 0.9967517867475333}-{'f1_val': 0.995895166894551, 'auprc': 0.9966711896517481, 'loss_val': 0.032290538179803416, 'psi': 0.9962055759974298}
[S6] START round=66 head_norm_before_train=1.705038 cos_to_last_merge=1.0000 (last merge round=64)
[S6] round=66 local utility u=0.237854 metrics={'f1_val': 0.8000139050186267, 'auprc': 0.9495135465063416, 'loss_val': 0.46689372487046565, 'psi': 0.8598137616137127}-{'f1_val': 0.751977452205555, 'auprc': 0.9361459553709977, 'loss_val': 0.6142807981596714, 'psi': 0.8256448534717321}
[S7] START round=66 head_norm_before_train=1.910071 cos_to_last_merge=0.9999 (last merge round=64)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.5376869735730585, 'auprc': 0.8112099343542964, 'loss_val': 1.487498520276597, 'psi': 0.6470961578855536}-{'f1_val': 0.8344408871276406, 'auprc': 0.9705128377361627, 'loss_val': 0.7021882427780889, 'psi': 0.8888696673710494}
[S8] START round=66 head_norm_before_train=1.704697 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9992171126588761, 'loss_val': 0.03768090315723331, 'psi': 0.9952042266579422}-{'f1_val': 0.9936253371144965, 'auprc': 0.999247850573701, 'loss_val': 0.037230946932739574, 'psi': 0.9958743424981784}
[S9] START round=66 head_norm_before_train=1.672417 cos_to_last_merge=0.9626 (last merge round=37)
[S9] round=66 local utility u=0.042843 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9933033653668181, 'loss_val': 0.019884553681073565, 'psi': 0.9955830936540129}-{'f1_val': 0.9880286744602689, 'auprc': 0.9938353889620102, 'loss_val': 0.0527218848092034, 'psi': 0.9903513602609654}
[S10] START round=66 head_norm_before_train=1.887285 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=66 local utility u=0.000325 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9970019008449753, 'loss_val': 0.030185391786587322, 'psi': 0.9956499258696137}-{'f1_val': 0.9947486092193725, 'auprc': 0.9968572311134603, 'loss_val': 0.030400621375019386, 'psi': 0.9955920579770077}
[S11] START round=66 head_norm_before_train=2.092984 cos_to_last_merge=1.0000 (last merge round=65)
[S11] round=66 local utility u=0.000395 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987179854317063, 'loss_val': 0.030795810321104764, 'psi': 0.9970102133162942}-{'f1_val': 0.9965509216617638, 'auprc': 0.998603592240151, 'loss_val': 0.03531700475865509, 'psi': 0.9973719898931188}
[S13] START round=66 head_norm_before_train=1.886029 cos_to_last_merge=0.9999 (last merge round=63)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6517545293450043, 'auprc': 0.648968586041603, 'loss_val': 1.2606247330899258, 'psi': 0.6506401520236438}-{'f1_val': 0.6670445133310738, 'auprc': 0.6537989837580281, 'loss_val': 1.2939308362779574, 'psi': 0.6617463015018555}
[S14] START round=66 head_norm_before_train=1.673255 cos_to_last_merge=1.0000 (last merge round=65)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9983646322898383, 'loss_val': 0.026246421804099744, 'psi': 0.9973853674153319}-{'f1_val': 0.9967584991393483, 'auprc': 0.9986387692624958, 'loss_val': 0.0249087359129408, 'psi': 0.9975106071886074}
[S15] START round=66 head_norm_before_train=1.726879 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.8347105807184508, 'auprc': 0.9896100260710281, 'loss_val': 0.32015539736533194, 'psi': 0.8966703588594818}-{'f1_val': 0.845501197784992, 'auprc': 0.9896806630730259, 'loss_val': 0.30466874284495254, 'psi': 0.9031729839002055}
[S16] START round=66 head_norm_before_train=1.683630 cos_to_last_merge=0.9999 (last merge round=62)
[S16] round=66 local utility u=0.610883 metrics={'f1_val': 0.9432063995775326, 'auprc': 0.9884614008004065, 'loss_val': 0.23271432791865632, 'psi': 0.9613084000666821}-{'f1_val': 0.8506040518404645, 'auprc': 0.9763026358219928, 'loss_val': 0.862390446209098, 'psi': 0.9008834854330758}
[S17] START round=66 head_norm_before_train=1.888919 cos_to_last_merge=0.9922 (last merge round=52)
[S17] round=66 local utility u=1.000000 metrics={'f1_val': 0.8959224857368764, 'auprc': 0.9192044939167959, 'loss_val': 0.42363300857999864, 'psi': 0.9052352890088442}-{'f1_val': 0.6224041733107815, 'auprc': 0.9197870840005898, 'loss_val': 1.3761537458373603, 'psi': 0.7413573375867049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.860)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[S10] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=66 metric=0.5377 head_norm=1.923394
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.228873e-02
[S7] stored merged vector for next round verification (round=66)
[S7] DEBUG after merge:  round=66 metric=0.5377 head_norm=1.920265 delta_norm=0.022289
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=66 metric=0.6518 head_norm=1.893133
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.693336e-02
[S13] stored merged vector for next round verification (round=66)
[S13] DEBUG after merge:  round=66 metric=0.6463 head_norm=1.890136 delta_norm=0.016933
[S13] aggregate: ROLLBACK (f1_val pre=0.652 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=66 metric=0.8000 head_norm=1.719412
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.134263e-02
[S6] stored merged vector for next round verification (round=66)
[S6] DEBUG after merge:  round=66 metric=0.8020 head_norm=1.711818 delta_norm=0.021343
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9999
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.9913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44914
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=66 metric=0.8347 head_norm=1.738927
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.120290e-02
[S15] stored merged vector for next round verification (round=66)
[S15] DEBUG after merge:  round=66 metric=0.8347 head_norm=1.738271 delta_norm=0.011203
[S15] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.9998
[S2] START round=67 head_norm_before_train=1.738276 cos_to_last_merge=1.0000 (last merge round=65)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7209163673454184, 'auprc': 0.741008565527104, 'loss_val': 0.7402986684200669, 'psi': 0.7289532466180927}-{'f1_val': 0.7200036721600143, 'auprc': 0.7420688937276203, 'loss_val': 0.7313591311514862, 'psi': 0.7288297607870566}
[S3] START round=67 head_norm_before_train=1.926942 cos_to_last_merge=0.9999 (last merge round=63)
[S3] round=67 local utility u=0.049328 metrics={'f1_val': 0.9626698102576245, 'auprc': 0.9980670456346782, 'loss_val': 0.09106956040141335, 'psi': 0.976828704408446}-{'f1_val': 0.958793171903411, 'auprc': 0.9927031781096012, 'loss_val': 0.15037478319961772, 'psi': 0.9723571743858871}
[S4] START round=67 head_norm_before_train=2.107438 cos_to_last_merge=0.9999 (last merge round=64)
[S4] round=67 local utility u=0.034634 metrics={'f1_val': 0.9411188029928037, 'auprc': 0.935530570805418, 'loss_val': 0.3298368139343705, 'psi': 0.9388835101178494}-{'f1_val': 0.9386590927654859, 'auprc': 0.9218337816214399, 'loss_val': 0.3432559708085144, 'psi': 0.9319289683078675}
[S5] START round=67 head_norm_before_train=1.766916 cos_to_last_merge=0.9982 (last merge round=62)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9928586597714428, 'loss_val': 0.0312113069813637, 'psi': 0.9946805640453077}-{'f1_val': 0.9963338119635569, 'auprc': 0.9973787489234982, 'loss_val': 0.03063951301689265, 'psi': 0.9967517867475333}
[S6] START round=67 head_norm_before_train=1.711818 cos_to_last_merge=1.0000 (last merge round=66)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.6546432740940911, 'auprc': 0.934374371648943, 'loss_val': 0.7424291148338311, 'psi': 0.7665357131160319}-{'f1_val': 0.8000139050186267, 'auprc': 0.9495135465063416, 'loss_val': 0.46689372487046565, 'psi': 0.8598137616137127}
[S7] START round=67 head_norm_before_train=1.920265 cos_to_last_merge=1.0000 (last merge round=66)
[S7] round=67 local utility u=0.803005 metrics={'f1_val': 0.6647183128277161, 'auprc': 0.9529200909037869, 'loss_val': 1.0688077214636889, 'psi': 0.7799990240581445}-{'f1_val': 0.5376869735730585, 'auprc': 0.8112099343542964, 'loss_val': 1.487498520276597, 'psi': 0.6470961578855536}
[S8] START round=67 head_norm_before_train=1.715089 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9989292987924396, 'loss_val': 0.04456218951292723, 'psi': 0.9935733437797583}-{'f1_val': 0.9925289693239863, 'auprc': 0.9992171126588761, 'loss_val': 0.03768090315723331, 'psi': 0.9952042266579422}
[S9] START round=67 head_norm_before_train=1.679044 cos_to_last_merge=0.9617 (last merge round=37)
[S9] round=67 local utility u=0.004561 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9985041487590766, 'loss_val': 0.022208217603684265, 'psi': 0.9972477709039631}-{'f1_val': 0.9971029125121428, 'auprc': 0.9933033653668181, 'loss_val': 0.019884553681073565, 'psi': 0.9955830936540129}
[S10] START round=67 head_norm_before_train=1.895741 cos_to_last_merge=0.9999 (last merge round=63)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9973001758110661, 'loss_val': 0.03044674399566351, 'psi': 0.9953742656225947}-{'f1_val': 0.9947486092193725, 'auprc': 0.9970019008449753, 'loss_val': 0.030185391786587322, 'psi': 0.9956499258696137}
[S11] START round=67 head_norm_before_train=2.100310 cos_to_last_merge=1.0000 (last merge round=65)
[S11] round=67 local utility u=0.002527 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987451303290235, 'loss_val': 0.025822273360628558, 'psi': 0.9970210712752211}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987179854317063, 'loss_val': 0.030795810321104764, 'psi': 0.9970102133162942}
[S13] START round=67 head_norm_before_train=1.890136 cos_to_last_merge=1.0000 (last merge round=66)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6236759421621727, 'auprc': 0.6459327246207492, 'loss_val': 1.2769157829178408, 'psi': 0.6325786551456033}-{'f1_val': 0.6517545293450043, 'auprc': 0.648968586041603, 'loss_val': 1.2606247330899258, 'psi': 0.6506401520236438}
[S14] START round=67 head_norm_before_train=1.680845 cos_to_last_merge=1.0000 (last merge round=65)
[S14] round=67 local utility u=0.002109 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9991196820965803, 'loss_val': 0.024430548775614937, 'psi': 0.9977010492882934}-{'f1_val': 0.9967325241656609, 'auprc': 0.9983646322898383, 'loss_val': 0.026246421804099744, 'psi': 0.9973853674153319}
[S15] START round=67 head_norm_before_train=1.738271 cos_to_last_merge=1.0000 (last merge round=66)
[S15] round=67 local utility u=0.634797 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9935226003328976, 'loss_val': 0.03203005486947428, 'psi': 0.9952084866424435}-{'f1_val': 0.8347105807184508, 'auprc': 0.9896100260710281, 'loss_val': 0.32015539736533194, 'psi': 0.8966703588594818}
[S16] START round=67 head_norm_before_train=1.690450 cos_to_last_merge=0.9999 (last merge round=62)
[S16] round=67 local utility u=0.232499 metrics={'f1_val': 0.9902838957366469, 'auprc': 0.9880076220925846, 'loss_val': 0.04881924364909766, 'psi': 0.9893733862790219}-{'f1_val': 0.9432063995775326, 'auprc': 0.9884614008004065, 'loss_val': 0.23271432791865632, 'psi': 0.9613084000666821}
[S17] START round=67 head_norm_before_train=1.899382 cos_to_last_merge=0.9917 (last merge round=52)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6418469938430984, 'auprc': 0.9095512095659679, 'loss_val': 1.1663815294847724, 'psi': 0.7489286801322462}-{'f1_val': 0.8959224857368764, 'auprc': 0.9192044939167959, 'loss_val': 0.42363300857999864, 'psi': 0.9052352890088442}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1796) from S14
[S16] cosine check vs S14: cos=0.9997
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44914
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=67 metric=0.9959 head_norm=2.108302
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.118787e-02
[S11] stored merged vector for next round verification (round=67)
[S11] DEBUG after merge:  round=67 metric=0.9959 head_norm=2.104733 delta_norm=0.021188
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=67 metric=0.9411 head_norm=2.101372
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.976409e-02
[S4] stored merged vector for next round verification (round=67)
[S4] DEBUG after merge:  round=67 metric=0.9411 head_norm=2.102744 delta_norm=0.019764
[S4] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=67 metric=0.9968 head_norm=1.686264
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.768710e-02
[S14] stored merged vector for next round verification (round=67)
[S14] DEBUG after merge:  round=67 metric=0.9968 head_norm=1.688265 delta_norm=0.017687
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9998
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=67 metric=0.9903 head_norm=1.696765
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.076943e-02
[S16] stored merged vector for next round verification (round=67)
[S16] DEBUG after merge:  round=67 metric=0.9903 head_norm=1.691395 delta_norm=0.020769
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=67 metric=0.6647 head_norm=1.935107
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.022348e-02
[S7] stored merged vector for next round verification (round=67)
[S7] DEBUG after merge:  round=67 metric=0.6648 head_norm=1.935789 delta_norm=0.020223
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=67 metric=0.9627 head_norm=1.936681
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.022348e-02
[S3] stored merged vector for next round verification (round=67)
[S3] DEBUG after merge:  round=67 metric=0.9627 head_norm=1.935789 delta_norm=0.020223
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S15
[S2] cosine check vs S15: cos=0.9908
[S2] START round=68 head_norm_before_train=1.753920 cos_to_last_merge=0.9998 (last merge round=65)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7200685642883686, 'auprc': 0.7444135971578509, 'loss_val': 0.7543025343539415, 'psi': 0.7298065774361615}-{'f1_val': 0.7209163673454184, 'auprc': 0.741008565527104, 'loss_val': 0.7402986684200669, 'psi': 0.7289532466180927}
[S3] START round=68 head_norm_before_train=1.935789 cos_to_last_merge=1.0000 (last merge round=67)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.8184376610678157, 'auprc': 0.9469348864539886, 'loss_val': 0.3731543793091442, 'psi': 0.8698365512222849}-{'f1_val': 0.9626698102576245, 'auprc': 0.9980670456346782, 'loss_val': 0.09106956040141335, 'psi': 0.976828704408446}
[S4] START round=68 head_norm_before_train=2.102744 cos_to_last_merge=1.0000 (last merge round=67)
[S4] round=68 local utility u=0.004593 metrics={'f1_val': 0.9416714848188797, 'auprc': 0.9376147794329549, 'loss_val': 0.3302201223312059, 'psi': 0.9400488026645097}-{'f1_val': 0.9411188029928037, 'auprc': 0.935530570805418, 'loss_val': 0.3298368139343705, 'psi': 0.9388835101178494}
[S5] START round=68 head_norm_before_train=1.786757 cos_to_last_merge=0.9976 (last merge round=62)
[S5] round=68 local utility u=0.003767 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9942859125409735, 'loss_val': 0.027958737044629138, 'psi': 0.99525146515312}-{'f1_val': 0.995895166894551, 'auprc': 0.9928586597714428, 'loss_val': 0.0312113069813637, 'psi': 0.9946805640453077}
[S6] START round=68 head_norm_before_train=1.730423 cos_to_last_merge=0.9999 (last merge round=66)
[S6] round=68 local utility u=1.000000 metrics={'f1_val': 0.9331485332944381, 'auprc': 0.9585518104106889, 'loss_val': 0.23917660111062725, 'psi': 0.9433098441409384}-{'f1_val': 0.6546432740940911, 'auprc': 0.934374371648943, 'loss_val': 0.7424291148338311, 'psi': 0.7665357131160319}
[S7] START round=68 head_norm_before_train=1.935789 cos_to_last_merge=1.0000 (last merge round=67)
[S7] round=68 local utility u=0.800011 metrics={'f1_val': 0.8506323655460314, 'auprc': 0.9744217033290266, 'loss_val': 0.6487742575408285, 'psi': 0.9001481006592293}-{'f1_val': 0.6647183128277161, 'auprc': 0.9529200909037869, 'loss_val': 1.0688077214636889, 'psi': 0.7799990240581445}
[S8] START round=68 head_norm_before_train=1.724413 cos_to_last_merge=0.9999 (last merge round=65)
[S8] round=68 local utility u=0.014402 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9988364350983969, 'loss_val': 0.03634649730477119, 'psi': 0.9956228908807332}-{'f1_val': 0.9900027071046373, 'auprc': 0.9989292987924396, 'loss_val': 0.04456218951292723, 'psi': 0.9935733437797583}
[S9] START round=68 head_norm_before_train=1.687080 cos_to_last_merge=0.9610 (last merge round=37)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9929478157723275, 'loss_val': 0.021185567740968525, 'psi': 0.9950252377092635}-{'f1_val': 0.9964101856672208, 'auprc': 0.9985041487590766, 'loss_val': 0.022208217603684265, 'psi': 0.9972477709039631}
[S10] START round=68 head_norm_before_train=1.904471 cos_to_last_merge=0.9999 (last merge round=63)
[S10] round=68 local utility u=0.001832 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9969178953469156, 'loss_val': 0.029584758672499125, 'psi': 0.9956163236703897}-{'f1_val': 0.9940903254969471, 'auprc': 0.9973001758110661, 'loss_val': 0.03044674399566351, 'psi': 0.9953742656225947}
[S11] START round=68 head_norm_before_train=2.104733 cos_to_last_merge=1.0000 (last merge round=67)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987115269907845, 'loss_val': 0.03690782400307567, 'psi': 0.997270061566535}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987451303290235, 'loss_val': 0.025822273360628558, 'psi': 0.9970210712752211}
[S13] START round=68 head_norm_before_train=1.895050 cos_to_last_merge=1.0000 (last merge round=66)
[S13] round=68 local utility u=0.159169 metrics={'f1_val': 0.6411840314168599, 'auprc': 0.6632949367596446, 'loss_val': 1.1157122700766133, 'psi': 0.6500283935539737}-{'f1_val': 0.6236759421621727, 'auprc': 0.6459327246207492, 'loss_val': 1.2769157829178408, 'psi': 0.6325786551456033}
[S14] START round=68 head_norm_before_train=1.688265 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9857887487075297, 'auprc': 0.9963828994517911, 'loss_val': 0.04494858998884245, 'psi': 0.9900264090052343}-{'f1_val': 0.9967552940827689, 'auprc': 0.9991196820965803, 'loss_val': 0.024430548775614937, 'psi': 0.9977010492882934}
[S15] START round=68 head_norm_before_train=1.748904 cos_to_last_merge=1.0000 (last merge round=66)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.8340696437058013, 'auprc': 0.990731320937776, 'loss_val': 0.26523832711064005, 'psi': 0.8967343145985912}-{'f1_val': 0.9963324108488076, 'auprc': 0.9935226003328976, 'loss_val': 0.03203005486947428, 'psi': 0.9952084866424435}
[S16] START round=68 head_norm_before_train=1.691395 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=68 local utility u=0.002017 metrics={'f1_val': 0.9908701923064713, 'auprc': 0.9877636184702832, 'loss_val': 0.047570020753437615, 'psi': 0.989627562771996}-{'f1_val': 0.9902838957366469, 'auprc': 0.9880076220925846, 'loss_val': 0.04881924364909766, 'psi': 0.9893733862790219}
[S17] START round=68 head_norm_before_train=1.907441 cos_to_last_merge=0.9914 (last merge round=52)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.6278560435628675, 'auprc': 0.9293126608519626, 'loss_val': 1.3457726306649653, 'psi': 0.7484386904785055}-{'f1_val': 0.6418469938430984, 'auprc': 0.9095512095659679, 'loss_val': 1.1663815294847724, 'psi': 0.7489286801322462}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S11
[S3]  timeout peer S17
[S8]  timeout peer S14
[S2]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S9
[S9]  timeout peer S8
[S9]  timeout peer S10
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:44913
[S4] not sending this round → trigger blocked (psi=0.940)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=68 metric=0.9858 head_norm=1.693787
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.271869e-02
[S14] stored merged vector for next round verification (round=68)
[S14] DEBUG after merge:  round=68 metric=0.9858 head_norm=1.695229 delta_norm=0.012719
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9995
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9998
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=68 metric=0.9947 head_norm=1.913108
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.034064e-02
[S10] stored merged vector for next round verification (round=68)
[S10] DEBUG after merge:  round=68 metric=0.9947 head_norm=1.905783 delta_norm=0.020341
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=68 metric=0.7201 head_norm=1.769680
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.252041e-01
[S2] stored merged vector for next round verification (round=68)
[S2] DEBUG after merge:  round=68 metric=0.7199 head_norm=1.754862 delta_norm=0.125204
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=68 metric=0.6412 head_norm=1.898647
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.034066e-02
[S13] stored merged vector for next round verification (round=68)
[S13] DEBUG after merge:  round=68 metric=0.6395 head_norm=1.905783 delta_norm=0.020341
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44915
[S7] not sending this round → trigger blocked (psi=0.900)
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] cosine check vs S5: cos=0.9906
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=68 metric=0.8341 head_norm=1.759765
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.245455e-01
[S15] stored merged vector for next round verification (round=68)
[S15] DEBUG after merge:  round=68 metric=0.8333 head_norm=1.779446 delta_norm=0.124546
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → trigger blocked (psi=0.990)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9995
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=68 metric=0.9935 head_norm=1.733427
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.812340e-02
[S8] stored merged vector for next round verification (round=68)
[S8] DEBUG after merge:  round=68 metric=0.9935 head_norm=1.739721 delta_norm=0.028123
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=1.754862 cos_to_last_merge=1.0000 (last merge round=68)
[S2] round=69 local utility u=0.000689 metrics={'f1_val': 0.7158090276530653, 'auprc': 0.7431103898111734, 'loss_val': 0.7234582077356619, 'psi': 0.7267295725163085}-{'f1_val': 0.7200685642883686, 'auprc': 0.7444135971578509, 'loss_val': 0.7543025343539415, 'psi': 0.7298065774361615}
[S3] START round=69 head_norm_before_train=1.943710 cos_to_last_merge=1.0000 (last merge round=67)
[S3] round=69 local utility u=0.636140 metrics={'f1_val': 0.9615525804599885, 'auprc': 0.9981791480746612, 'loss_val': 0.1132975021343319, 'psi': 0.9762032075058575}-{'f1_val': 0.8184376610678157, 'auprc': 0.9469348864539886, 'loss_val': 0.3731543793091442, 'psi': 0.8698365512222849}
[S4] START round=69 head_norm_before_train=2.104874 cos_to_last_merge=1.0000 (last merge round=67)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9406589584960042, 'auprc': 0.934347404407639, 'loss_val': 0.33123979801830683, 'psi': 0.9381343368606581}-{'f1_val': 0.9416714848188797, 'auprc': 0.9376147794329549, 'loss_val': 0.3302201223312059, 'psi': 0.9400488026645097}
[S5] START round=69 head_norm_before_train=1.807515 cos_to_last_merge=0.9970 (last merge round=62)
[S5] round=69 local utility u=0.006947 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9975576544595778, 'loss_val': 0.026088605520957292, 'psi': 0.9967810529100873}-{'f1_val': 0.995895166894551, 'auprc': 0.9942859125409735, 'loss_val': 0.027958737044629138, 'psi': 0.99525146515312}
[S6] START round=69 head_norm_before_train=1.746446 cos_to_last_merge=0.9998 (last merge round=66)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.6365993484210832, 'auprc': 0.9135152647764574, 'loss_val': 0.6982602086906735, 'psi': 0.7473657149632329}-{'f1_val': 0.9331485332944381, 'auprc': 0.9585518104106889, 'loss_val': 0.23917660111062725, 'psi': 0.9433098441409384}
[S7] START round=69 head_norm_before_train=1.952902 cos_to_last_merge=1.0000 (last merge round=67)
[S7] round=69 local utility u=0.157296 metrics={'f1_val': 0.8721182343119256, 'auprc': 0.9773238303941698, 'loss_val': 0.4718039708546082, 'psi': 0.9142004727448232}-{'f1_val': 0.8506323655460314, 'auprc': 0.9744217033290266, 'loss_val': 0.6487742575408285, 'psi': 0.9001481006592293}
[S8] START round=69 head_norm_before_train=1.739721 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9801154112716133, 'auprc': 0.9989092215547393, 'loss_val': 0.05791953591982056, 'psi': 0.9876329353848636}-{'f1_val': 0.9934805280689575, 'auprc': 0.9988364350983969, 'loss_val': 0.03634649730477119, 'psi': 0.9956228908807332}
[S9] START round=69 head_norm_before_train=1.694533 cos_to_last_merge=0.9605 (last merge round=37)
[S9] round=69 local utility u=0.000702 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9931222568728872, 'loss_val': 0.02030408230700793, 'psi': 0.9950950141494874}-{'f1_val': 0.9964101856672208, 'auprc': 0.9929478157723275, 'loss_val': 0.021185567740968525, 'psi': 0.9950252377092635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=69 head_norm_before_train=1.905783 cos_to_last_merge=1.0000 (last merge round=68)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9970171433321768, 'loss_val': 0.0301390137800206, 'psi': 0.995261052631039}-{'f1_val': 0.9947486092193725, 'auprc': 0.9969178953469156, 'loss_val': 0.029584758672499125, 'psi': 0.9956163236703897}
[S11] START round=69 head_norm_before_train=2.112374 cos_to_last_merge=1.0000 (last merge round=67)
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986422258828231, 'loss_val': 0.045027311610487314, 'psi': 0.9973874433501876}-{'f1_val': 0.9963090846170353, 'auprc': 0.9987115269907845, 'loss_val': 0.03690782400307567, 'psi': 0.997270061566535}
[S13] START round=69 head_norm_before_train=1.905783 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=69 local utility u=0.067130 metrics={'f1_val': 0.6932442368756317, 'auprc': 0.6547614521169822, 'loss_val': 1.2682124606715466, 'psi': 0.677851122972172}-{'f1_val': 0.6411840314168599, 'auprc': 0.6632949367596446, 'loss_val': 1.1157122700766133, 'psi': 0.6500283935539737}
[S14] START round=69 head_norm_before_train=1.695229 cos_to_last_merge=1.0000 (last merge round=68)
[S14] round=69 local utility u=0.046596 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9989868241192728, 'loss_val': 0.024042880077453584, 'psi': 0.997515408356668}-{'f1_val': 0.9857887487075297, 'auprc': 0.9963828994517911, 'loss_val': 0.04494858998884245, 'psi': 0.9900264090052343}
[S15] START round=69 head_norm_before_train=1.779446 cos_to_last_merge=1.0000 (last merge round=68)
[S15] round=69 local utility u=0.602072 metrics={'f1_val': 0.9949510241219324, 'auprc': 0.9940702648354256, 'loss_val': 0.03639943275145752, 'psi': 0.9945987204073297}-{'f1_val': 0.8340696437058013, 'auprc': 0.990731320937776, 'loss_val': 0.26523832711064005, 'psi': 0.8967343145985912}
[S16] START round=69 head_norm_before_train=1.698542 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=69 local utility u=0.001222 metrics={'f1_val': 0.9906977550130678, 'auprc': 0.9884728412719291, 'loss_val': 0.046219159588361744, 'psi': 0.9898077895166124}-{'f1_val': 0.9908701923064713, 'auprc': 0.9877636184702832, 'loss_val': 0.047570020753437615, 'psi': 0.989627562771996}
[S17] START round=69 head_norm_before_train=1.916216 cos_to_last_merge=0.9910 (last merge round=52)
[S17] round=69 local utility u=0.991970 metrics={'f1_val': 0.8354308143457245, 'auprc': 0.9208154848666067, 'loss_val': 0.5817887934626715, 'psi': 0.8695846825540774}-{'f1_val': 0.6278560435628675, 'auprc': 0.9293126608519626, 'loss_val': 1.3457726306649653, 'psi': 0.7484386904785055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.678)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] cosine check vs S14: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.9900
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=1.0000
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=69 metric=0.9965 head_norm=1.701366
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.670199e-03
[S14] stored merged vector for next round verification (round=69)
[S14] DEBUG after merge:  round=69 metric=0.9965 head_norm=1.703603 delta_norm=0.005670
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=69 metric=0.9907 head_norm=1.705855
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.670189e-03
[S16] stored merged vector for next round verification (round=69)
[S16] DEBUG after merge:  round=69 metric=0.9907 head_norm=1.703603 delta_norm=0.005670
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1800) from S15
[S2] cosine check vs S15: cos=0.9900
[S5] not sending this round → trigger blocked (psi=0.997)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=69 metric=0.9616 head_norm=1.953589
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.319662e-02
[S3] stored merged vector for next round verification (round=69)
[S3] DEBUG after merge:  round=69 metric=0.9619 head_norm=1.963439 delta_norm=0.023197
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=69 metric=0.9950 head_norm=1.790661
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.260556e-01
[S15] stored merged vector for next round verification (round=69)
[S15] DEBUG after merge:  round=69 metric=0.9950 head_norm=1.775932 delta_norm=0.126056
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=69 metric=0.6366 head_norm=1.758534
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.586894e-02
[S6] stored merged vector for next round verification (round=69)
[S6] DEBUG after merge:  round=69 metric=0.6436 head_norm=1.745657 delta_norm=0.035869
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=1.770080 cos_to_last_merge=1.0000 (last merge round=68)
[S2] round=70 local utility u=0.006086 metrics={'f1_val': 0.7194854256098404, 'auprc': 0.7446743612377769, 'loss_val': 0.7380374870098747, 'psi': 0.7295609998610151}-{'f1_val': 0.7158090276530653, 'auprc': 0.7431103898111734, 'loss_val': 0.7234582077356619, 'psi': 0.7267295725163085}
[S3] START round=70 head_norm_before_train=1.963439 cos_to_last_merge=1.0000 (last merge round=69)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.7761662092259243, 'auprc': 0.9632080997030747, 'loss_val': 0.45998692983651995, 'psi': 0.8509829654167844}-{'f1_val': 0.9615525804599885, 'auprc': 0.9981791480746612, 'loss_val': 0.1132975021343319, 'psi': 0.9762032075058575}
[S4] START round=70 head_norm_before_train=2.110937 cos_to_last_merge=1.0000 (last merge round=67)
[S4] round=70 local utility u=0.002623 metrics={'f1_val': 0.9410169912298928, 'auprc': 0.9357341236211857, 'loss_val': 0.33230303313954435, 'psi': 0.9389038441864099}-{'f1_val': 0.9406589584960042, 'auprc': 0.934347404407639, 'loss_val': 0.33123979801830683, 'psi': 0.9381343368606581}
[S5] START round=70 head_norm_before_train=1.822952 cos_to_last_merge=0.9962 (last merge round=62)
[S5] round=70 local utility u=0.001887 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9987336793844699, 'loss_val': 0.026265804743316003, 'psi': 0.997293758931922}-{'f1_val': 0.9962633185437604, 'auprc': 0.9975576544595778, 'loss_val': 0.026088605520957292, 'psi': 0.9967810529100873}
[S6] START round=70 head_norm_before_train=1.745657 cos_to_last_merge=1.0000 (last merge round=69)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6071326304437654, 'auprc': 0.904608134660087, 'loss_val': 0.796489638655072, 'psi': 0.726122832130294}-{'f1_val': 0.6365993484210832, 'auprc': 0.9135152647764574, 'loss_val': 0.6982602086906735, 'psi': 0.7473657149632329}
[S7] START round=70 head_norm_before_train=1.973512 cos_to_last_merge=0.9998 (last merge round=67)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.8574721851219489, 'auprc': 0.962786900467002, 'loss_val': 0.6065526589817493, 'psi': 0.8995980712599702}-{'f1_val': 0.8721182343119256, 'auprc': 0.9773238303941698, 'loss_val': 0.4718039708546082, 'psi': 0.9142004727448232}
[S8] START round=70 head_norm_before_train=1.748945 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=70 local utility u=0.048203 metrics={'f1_val': 0.9923077140383828, 'auprc': 0.9992173794045791, 'loss_val': 0.03559149728591702, 'psi': 0.9950715801848613}-{'f1_val': 0.9801154112716133, 'auprc': 0.9989092215547393, 'loss_val': 0.05791953591982056, 'psi': 0.9876329353848636}
[S9] START round=70 head_norm_before_train=1.699820 cos_to_last_merge=0.9603 (last merge round=37)
[S9] round=70 local utility u=0.005121 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9956424252642351, 'loss_val': 0.02027791895489681, 'psi': 0.9963685213610484}-{'f1_val': 0.9964101856672208, 'auprc': 0.9931222568728872, 'loss_val': 0.02030408230700793, 'psi': 0.9950950141494874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=70 head_norm_before_train=1.912680 cos_to_last_merge=1.0000 (last merge round=68)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9966749977761402, 'loss_val': 0.03080921998213232, 'psi': 0.994992626740783}-{'f1_val': 0.9940903254969471, 'auprc': 0.9970171433321768, 'loss_val': 0.0301390137800206, 'psi': 0.995261052631039}
[S11] START round=70 head_norm_before_train=2.120660 cos_to_last_merge=1.0000 (last merge round=67)
[S11] round=70 local utility u=0.003326 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985441716456152, 'loss_val': 0.038081832723934755, 'psi': 0.9973482216553045}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986422258828231, 'loss_val': 0.045027311610487314, 'psi': 0.9973874433501876}
[S13] START round=70 head_norm_before_train=1.910209 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=70 local utility u=0.224344 metrics={'f1_val': 0.6938384760417353, 'auprc': 0.7159415738432867, 'loss_val': 1.006629936734903, 'psi': 0.7026797151623558}-{'f1_val': 0.6932442368756317, 'auprc': 0.6547614521169822, 'loss_val': 1.2682124606715466, 'psi': 0.677851122972172}
[S14] START round=70 head_norm_before_train=1.703603 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.9987026588224835, 'loss_val': 0.02403650073795622, 'psi': 0.9974035821707736}-{'f1_val': 0.9965344645149313, 'auprc': 0.9989868241192728, 'loss_val': 0.024042880077453584, 'psi': 0.997515408356668}
[S15] START round=70 head_norm_before_train=1.775932 cos_to_last_merge=1.0000 (last merge round=69)
[S15] round=70 local utility u=0.008301 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9933046778827518, 'loss_val': 0.028273560594269897, 'psi': 0.995369872185613}-{'f1_val': 0.9949510241219324, 'auprc': 0.9940702648354256, 'loss_val': 0.03639943275145752, 'psi': 0.9945987204073297}
[S16] START round=70 head_norm_before_train=1.703603 cos_to_last_merge=1.0000 (last merge round=69)
[S16] round=70 local utility u=0.004473 metrics={'f1_val': 0.991356625350989, 'auprc': 0.9898179719012251, 'loss_val': 0.04526195688824526, 'psi': 0.9907411639710835}-{'f1_val': 0.9906977550130678, 'auprc': 0.9884728412719291, 'loss_val': 0.046219159588361744, 'psi': 0.9898077895166124}
[S17] START round=70 head_norm_before_train=1.923432 cos_to_last_merge=0.9907 (last merge round=52)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.6465215749514308, 'auprc': 0.9519974521241698, 'loss_val': 1.2365372184599461, 'psi': 0.7687119258205264}-{'f1_val': 0.8354308143457245, 'auprc': 0.9208154848666067, 'loss_val': 0.5817887934626715, 'psi': 0.8695846825540774}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=70 metric=0.8575 head_norm=1.992857
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.548112e-02
[S7] stored merged vector for next round verification (round=70)
[S7] DEBUG after merge:  round=70 metric=0.8575 head_norm=1.973002 delta_norm=0.035481
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.320 → S3@127.0.0.1:44903
[S2] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.995)
[S14] ⇄ pheromone p=0.008 → S16@127.0.0.1:44916
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.285 → S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:44907
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.9970
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=70 metric=0.9966 head_norm=2.127542
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.130732e-02
[S11] stored merged vector for next round verification (round=70)
[S11] DEBUG after merge:  round=70 metric=0.9966 head_norm=2.122354 delta_norm=0.021307
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=70 metric=0.9410 head_norm=2.117368
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.130732e-02
[S4] stored merged vector for next round verification (round=70)
[S4] DEBUG after merge:  round=70 metric=0.9410 head_norm=2.122354 delta_norm=0.021307
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.010 → S11@127.0.0.1:44912
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=70 metric=0.7195 head_norm=1.785681
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.324997e-01
[S2] stored merged vector for next round verification (round=70)
[S2] DEBUG after merge:  round=70 metric=0.7193 head_norm=1.783257 delta_norm=0.132500
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.015 → S15@127.0.0.1:44915
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S3] ⇄ pheromone p=0.133 → S7@127.0.0.1:44908
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=70 metric=0.9967 head_norm=1.786294
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.941637e-02
[S15] stored merged vector for next round verification (round=70)
[S15] DEBUG after merge:  round=70 metric=0.9967 head_norm=1.784638 delta_norm=0.069416
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.243 → S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.105 → S14@127.0.0.1:44914
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9837
[S8] ⇄ pheromone p=0.039 → S6@127.0.0.1:44907
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=1.0000
[S13] ⇄ pheromone p=0.117 → S10@127.0.0.1:44911
[S5] ⇄ pheromone p=0.005 → S15@127.0.0.1:44915
[S2] START round=71 head_norm_before_train=1.783257 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7177497797068466, 'auprc': 0.7320932736520657, 'loss_val': 0.7298204847204451, 'psi': 0.7234871772849343}-{'f1_val': 0.7194854256098404, 'auprc': 0.7446743612377769, 'loss_val': 0.7380374870098747, 'psi': 0.7295609998610151}
[S3] START round=71 head_norm_before_train=1.972994 cos_to_last_merge=1.0000 (last merge round=69)
[S3] round=71 local utility u=0.890001 metrics={'f1_val': 0.9875146090387057, 'auprc': 0.9983302572836392, 'loss_val': 0.05344209353824357, 'psi': 0.9918408683366791}-{'f1_val': 0.7761662092259243, 'auprc': 0.9632080997030747, 'loss_val': 0.45998692983651995, 'psi': 0.8509829654167844}
[S4] START round=71 head_norm_before_train=2.122354 cos_to_last_merge=1.0000 (last merge round=70)
[S4] round=71 local utility u=0.016648 metrics={'f1_val': 0.9428051779414363, 'auprc': 0.941816840349914, 'loss_val': 0.3279851055751444, 'psi': 0.9424098429048273}-{'f1_val': 0.9410169912298928, 'auprc': 0.9357341236211857, 'loss_val': 0.33230303313954435, 'psi': 0.9389038441864099}
[S5] START round=71 head_norm_before_train=1.830620 cos_to_last_merge=0.9959 (last merge round=62)
[S5] round=71 local utility u=0.002262 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9992350601983928, 'loss_val': 0.02545584882554154, 'psi': 0.9977152051664318}-{'f1_val': 0.9963338119635569, 'auprc': 0.9987336793844699, 'loss_val': 0.026265804743316003, 'psi': 0.997293758931922}
[S6] START round=71 head_norm_before_train=1.756077 cos_to_last_merge=1.0000 (last merge round=69)
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.9577914268934261, 'auprc': 0.9606174186721621, 'loss_val': 0.16139518810739525, 'psi': 0.9589218236049205}-{'f1_val': 0.6071326304437654, 'auprc': 0.904608134660087, 'loss_val': 0.796489638655072, 'psi': 0.726122832130294}
[S7] START round=71 head_norm_before_train=1.973002 cos_to_last_merge=1.0000 (last merge round=70)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.8487913704033851, 'auprc': 0.9568195778502484, 'loss_val': 0.6703131947727949, 'psi': 0.8920026533821304}-{'f1_val': 0.8574721851219489, 'auprc': 0.962786900467002, 'loss_val': 0.6065526589817493, 'psi': 0.8995980712599702}
[S8] START round=71 head_norm_before_train=1.758911 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=71 local utility u=0.002816 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9992545103078946, 'loss_val': 0.03358701675493712, 'psi': 0.9954381276021271}-{'f1_val': 0.9923077140383828, 'auprc': 0.9992173794045791, 'loss_val': 0.03559149728591702, 'psi': 0.9950715801848613}
[S9] START round=71 head_norm_before_train=1.705086 cos_to_last_merge=0.9596 (last merge round=37)
[S9] round=71 local utility u=0.002801 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9974922642753925, 'loss_val': 0.020224531548640092, 'psi': 0.9971084569655113}-{'f1_val': 0.9968525854255906, 'auprc': 0.9956424252642351, 'loss_val': 0.02027791895489681, 'psi': 0.9963685213610484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=71 head_norm_before_train=1.920030 cos_to_last_merge=1.0000 (last merge round=68)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9965678825951785, 'loss_val': 0.031055687412345337, 'psi': 0.9949497806683983}-{'f1_val': 0.993871046050545, 'auprc': 0.9966749977761402, 'loss_val': 0.03080921998213232, 'psi': 0.994992626740783}
[S11] START round=71 head_norm_before_train=2.122354 cos_to_last_merge=1.0000 (last merge round=70)
[S11] round=71 local utility u=0.003554 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9985993055460692, 'loss_val': 0.027064429613026263, 'psi': 0.9969627413620394}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985441716456152, 'loss_val': 0.038081832723934755, 'psi': 0.9973482216553045}
[S13] START round=71 head_norm_before_train=1.914440 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.6045905460333171, 'auprc': 0.6218306447777374, 'loss_val': 1.4618282855675566, 'psi': 0.6114865855310851}-{'f1_val': 0.6938384760417353, 'auprc': 0.7159415738432867, 'loss_val': 1.006629936734903, 'psi': 0.7026797151623558}
[S14] START round=71 head_norm_before_train=1.710584 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9974526156058158, 'loss_val': 0.02450580450985636, 'psi': 0.9970225670525796}-{'f1_val': 0.9965375310696338, 'auprc': 0.9987026588224835, 'loss_val': 0.02403650073795622, 'psi': 0.9974035821707736}
[S15] START round=71 head_norm_before_train=1.784638 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9905784916364955, 'loss_val': 0.5186126755444948, 'psi': 0.8166909499160478}-{'f1_val': 0.9967466683875206, 'auprc': 0.9933046778827518, 'loss_val': 0.028273560594269897, 'psi': 0.995369872185613}
[S16] START round=71 head_norm_before_train=1.711594 cos_to_last_merge=1.0000 (last merge round=69)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9905507917321777, 'auprc': 0.9910823183576801, 'loss_val': 0.049507437161701626, 'psi': 0.9907634023823786}-{'f1_val': 0.991356625350989, 'auprc': 0.9898179719012251, 'loss_val': 0.04526195688824526, 'psi': 0.9907411639710835}
[S17] START round=71 head_norm_before_train=1.933233 cos_to_last_merge=0.9902 (last merge round=52)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.6347376904835527, 'auprc': 0.985794740822208, 'loss_val': 1.2697029382488658, 'psi': 0.7751605106190148}-{'f1_val': 0.6465215749514308, 'auprc': 0.9519974521241698, 'loss_val': 1.2365372184599461, 'psi': 0.7687119258205264}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44904
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=71 metric=0.9939 head_norm=1.928008
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.271178e-02
[S10] stored merged vector for next round verification (round=71)
[S10] DEBUG after merge:  round=71 metric=0.9939 head_norm=1.921194 delta_norm=0.012712
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44908
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=1.0000
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=71 metric=0.9428 head_norm=2.128426
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.227148e-03
[S4] stored merged vector for next round verification (round=71)
[S4] DEBUG after merge:  round=71 metric=0.9428 head_norm=2.128926 delta_norm=0.005227
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=71 metric=0.9578 head_norm=1.767751
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.572689e-02
[S6] stored merged vector for next round verification (round=71)
[S6] DEBUG after merge:  round=71 metric=0.9574 head_norm=1.763267 delta_norm=0.015727
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=71 metric=0.9959 head_norm=2.129438
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.227141e-03
[S11] stored merged vector for next round verification (round=71)
[S11] DEBUG after merge:  round=71 metric=0.9959 head_norm=2.128926 delta_norm=0.005227
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9832
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=71 metric=0.9929 head_norm=1.767536
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.637899e-02
[S8] stored merged vector for next round verification (round=71)
[S8] DEBUG after merge:  round=71 metric=0.9929 head_norm=1.767568 delta_norm=0.016379
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=71 metric=0.7008 head_norm=1.794452
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.669839e-01
[S15] stored merged vector for next round verification (round=71)
[S15] DEBUG after merge:  round=71 metric=0.7008 head_norm=1.806594 delta_norm=0.166984
[S15] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=1.796864 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.6744564737701496, 'auprc': 0.7366068913957241, 'loss_val': 0.9067556185349679, 'psi': 0.6993166408203795}-{'f1_val': 0.7177497797068466, 'auprc': 0.7320932736520657, 'loss_val': 0.7298204847204451, 'psi': 0.7234871772849343}
[S3] START round=72 head_norm_before_train=1.980335 cos_to_last_merge=1.0000 (last merge round=69)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9850784427815105, 'auprc': 0.9984237235185521, 'loss_val': 0.05628943564875669, 'psi': 0.9904165550763272}-{'f1_val': 0.9875146090387057, 'auprc': 0.9983302572836392, 'loss_val': 0.05344209353824357, 'psi': 0.9918408683366791}
[S4] START round=72 head_norm_before_train=2.128926 cos_to_last_merge=1.0000 (last merge round=71)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9383191415442791, 'auprc': 0.9279666169604478, 'loss_val': 0.34732670421237033, 'psi': 0.9341781317107466}-{'f1_val': 0.9428051779414363, 'auprc': 0.941816840349914, 'loss_val': 0.3279851055751444, 'psi': 0.9424098429048273}
[S5] START round=72 head_norm_before_train=1.837248 cos_to_last_merge=0.9956 (last merge round=62)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9980161960612249, 'loss_val': 0.025252055287141306, 'psi': 0.9969644695507461}-{'f1_val': 0.9967019684784577, 'auprc': 0.9992350601983928, 'loss_val': 0.02545584882554154, 'psi': 0.9977152051664318}
[S6] START round=72 head_norm_before_train=1.763267 cos_to_last_merge=1.0000 (last merge round=71)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.7951511685597235, 'auprc': 0.9082415267627384, 'loss_val': 0.5376336640769087, 'psi': 0.8403873118409295}-{'f1_val': 0.9577914268934261, 'auprc': 0.9606174186721621, 'loss_val': 0.16139518810739525, 'psi': 0.9589218236049205}
[S7] START round=72 head_norm_before_train=1.999840 cos_to_last_merge=0.9999 (last merge round=70)
[S7] round=72 local utility u=0.525999 metrics={'f1_val': 0.9391727787013198, 'auprc': 0.9723770042679385, 'loss_val': 0.20727630207335068, 'psi': 0.9524544689279673}-{'f1_val': 0.8487913704033851, 'auprc': 0.9568195778502484, 'loss_val': 0.6703131947727949, 'psi': 0.8920026533821304}
[S8] START round=72 head_norm_before_train=1.767568 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9989835117934017, 'loss_val': 0.036792991437869994, 'psi': 0.9946738911563701}-{'f1_val': 0.9928938724649488, 'auprc': 0.9992545103078946, 'loss_val': 0.03358701675493712, 'psi': 0.9954381276021271}
[S9] START round=72 head_norm_before_train=1.710504 cos_to_last_merge=0.9587 (last merge round=37)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9987774535875966, 'loss_val': 0.020840601719967065, 'psi': 0.9971084547265676}-{'f1_val': 0.9968525854255906, 'auprc': 0.9974922642753925, 'loss_val': 0.020224531548640092, 'psi': 0.9971084569655113}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=1.921194 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=72 local utility u=0.001421 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9968549905874398, 'loss_val': 0.030390650744204266, 'psi': 0.9951961915331442}-{'f1_val': 0.993871046050545, 'auprc': 0.9965678825951785, 'loss_val': 0.031055687412345337, 'psi': 0.9949497806683983}
[S11] START round=72 head_norm_before_train=2.128926 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=72 local utility u=0.000601 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9986219203065891, 'loss_val': 0.025930988759973277, 'psi': 0.9969717872662474}-{'f1_val': 0.9958716985726862, 'auprc': 0.9985993055460692, 'loss_val': 0.027064429613026263, 'psi': 0.9969627413620394}
[S13] START round=72 head_norm_before_train=1.918552 cos_to_last_merge=0.9999 (last merge round=68)
[S13] round=72 local utility u=0.306265 metrics={'f1_val': 0.6518085940679054, 'auprc': 0.6891246389083721, 'loss_val': 1.3344893930394814, 'psi': 0.666735012004092}-{'f1_val': 0.6045905460333171, 'auprc': 0.6218306447777374, 'loss_val': 1.4618282855675566, 'psi': 0.6114865855310851}
[S14] START round=72 head_norm_before_train=1.715370 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=72 local utility u=0.000791 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9979166278477232, 'loss_val': 0.023292795526348317, 'psi': 0.9971057850848652}-{'f1_val': 0.9967358680170888, 'auprc': 0.9974526156058158, 'loss_val': 0.02450580450985636, 'psi': 0.9970225670525796}
[S15] START round=72 head_norm_before_train=1.806594 cos_to_last_merge=1.0000 (last merge round=71)
[S15] round=72 local utility u=0.491371 metrics={'f1_val': 0.8291825818956415, 'auprc': 0.992763839454137, 'loss_val': 0.312927014700405, 'psi': 0.8946150849190397}-{'f1_val': 0.7007659221024161, 'auprc': 0.9905784916364955, 'loss_val': 0.5186126755444948, 'psi': 0.8166909499160478}
[S16] START round=72 head_norm_before_train=1.719816 cos_to_last_merge=1.0000 (last merge round=69)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9434069848702502, 'auprc': 0.9850943556210359, 'loss_val': 0.2396255590414829, 'psi': 0.9600819331705644}-{'f1_val': 0.9905507917321777, 'auprc': 0.9910823183576801, 'loss_val': 0.049507437161701626, 'psi': 0.9907634023823786}
[S17] START round=72 head_norm_before_train=1.943058 cos_to_last_merge=0.9897 (last merge round=52)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6307992074711973, 'auprc': 0.8718956506231185, 'loss_val': 1.315632350376063, 'psi': 0.7272377847319658}-{'f1_val': 0.6347376904835527, 'auprc': 0.985794740822208, 'loss_val': 1.2697029382488658, 'psi': 0.7751605106190148}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=72 metric=0.7952 head_norm=1.772653
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.283565e-02
[S6] stored merged vector for next round verification (round=72)
[S6] DEBUG after merge:  round=72 metric=0.7923 head_norm=1.770050 delta_norm=0.012836
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=0.9999
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=72 metric=0.9941 head_norm=1.928191
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.519730e-02
[S10] stored merged vector for next round verification (round=72)
[S10] DEBUG after merge:  round=72 metric=0.9941 head_norm=1.926103 delta_norm=0.015197
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=72 metric=0.6518 head_norm=1.924132
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.519731e-02
[S13] stored merged vector for next round verification (round=72)
[S13] DEBUG after merge:  round=72 metric=0.6509 head_norm=1.926103 delta_norm=0.015197
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1797) from S15
[S2] cosine check vs S15: cos=0.9979
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.9997
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=72 metric=0.9392 head_norm=2.018692
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.153041e-02
[S7] stored merged vector for next round verification (round=72)
[S7] DEBUG after merge:  round=72 metric=0.9321 head_norm=1.999357 delta_norm=0.031530
[S7] aggregate: ROLLBACK (f1_val pre=0.939 post=0.932 tol_abs=0.005 tol_rel=0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=72 metric=0.9851 head_norm=1.985884
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.085589e-02
[S3] stored merged vector for next round verification (round=72)
[S3] DEBUG after merge:  round=72 metric=0.9851 head_norm=2.002118 delta_norm=0.030856
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=1.806936 cos_to_last_merge=0.9999 (last merge round=70)
[S2] round=73 local utility u=0.212150 metrics={'f1_val': 0.7182595029461349, 'auprc': 0.7355606914869242, 'loss_val': 0.7421359231313608, 'psi': 0.7251799783624506}-{'f1_val': 0.6744564737701496, 'auprc': 0.7366068913957241, 'loss_val': 0.9067556185349679, 'psi': 0.6993166408203795}
[S3] START round=73 head_norm_before_train=2.002118 cos_to_last_merge=1.0000 (last merge round=72)
[S3] round=73 local utility u=0.040672 metrics={'f1_val': 0.9929481249417512, 'auprc': 0.9986345995656868, 'loss_val': 0.022796154609734193, 'psi': 0.9952227147913255}-{'f1_val': 0.9850784427815105, 'auprc': 0.9984237235185521, 'loss_val': 0.05628943564875669, 'psi': 0.9904165550763272}
[S4] START round=73 head_norm_before_train=2.132532 cos_to_last_merge=1.0000 (last merge round=71)
[S4] round=73 local utility u=0.028927 metrics={'f1_val': 0.9407241549789456, 'auprc': 0.9382919489265559, 'loss_val': 0.33487833228546016, 'psi': 0.9397512725579897}-{'f1_val': 0.9383191415442791, 'auprc': 0.9279666169604478, 'loss_val': 0.34732670421237033, 'psi': 0.9341781317107466}
[S5] START round=73 head_norm_before_train=1.845032 cos_to_last_merge=0.9951 (last merge round=62)
[S5] round=73 local utility u=0.003351 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9993388877678907, 'loss_val': 0.025149924143755612, 'psi': 0.9977567361942309}-{'f1_val': 0.9962633185437604, 'auprc': 0.9980161960612249, 'loss_val': 0.025252055287141306, 'psi': 0.9969644695507461}
[S6] START round=73 head_norm_before_train=1.770050 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6563221648277004, 'auprc': 0.8833982816984212, 'loss_val': 0.8668598583511241, 'psi': 0.7471526115759888}-{'f1_val': 0.7951511685597235, 'auprc': 0.9082415267627384, 'loss_val': 0.5376336640769087, 'psi': 0.8403873118409295}
[S7] START round=73 head_norm_before_train=1.999357 cos_to_last_merge=1.0000 (last merge round=72)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6224906425534676, 'auprc': 0.931464089529988, 'loss_val': 1.3223965216652926, 'psi': 0.7460800213440758}-{'f1_val': 0.9391727787013198, 'auprc': 0.9723770042679385, 'loss_val': 0.20727630207335068, 'psi': 0.9524544689279673}
[S8] START round=73 head_norm_before_train=1.776193 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9843044951922839, 'auprc': 0.9986609303826665, 'loss_val': 0.05162846034376636, 'psi': 0.990047069268437}-{'f1_val': 0.9918008107316822, 'auprc': 0.9989835117934017, 'loss_val': 0.036792991437869994, 'psi': 0.9946738911563701}
[S9] START round=73 head_norm_before_train=1.717298 cos_to_last_merge=0.9581 (last merge round=37)
[S9] round=73 local utility u=0.002333 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987447000083847, 'loss_val': 0.020064129483685834, 'psi': 0.9974941870916887}-{'f1_val': 0.9959957888192151, 'auprc': 0.9987774535875966, 'loss_val': 0.020840601719967065, 'psi': 0.9971084547265676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=73 head_norm_before_train=1.926103 cos_to_last_merge=1.0000 (last merge round=72)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9968965550406772, 'loss_val': 0.030816973782995666, 'psi': 0.9950812496465978}-{'f1_val': 0.9940903254969471, 'auprc': 0.9968549905874398, 'loss_val': 0.030390650744204266, 'psi': 0.9951961915331442}
[S11] START round=73 head_norm_before_train=2.136659 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9985618305064214, 'loss_val': 0.026690190229848792, 'psi': 0.9969477513461803}-{'f1_val': 0.9958716985726862, 'auprc': 0.9986219203065891, 'loss_val': 0.025930988759973277, 'psi': 0.9969717872662474}
[S13] START round=73 head_norm_before_train=1.926103 cos_to_last_merge=1.0000 (last merge round=72)
[S13] round=73 local utility u=0.075864 metrics={'f1_val': 0.6381800719836123, 'auprc': 0.6804541193546514, 'loss_val': 1.0749795694291848, 'psi': 0.6550896909320278}-{'f1_val': 0.6518085940679054, 'auprc': 0.6891246389083721, 'loss_val': 1.3344893930394814, 'psi': 0.666735012004092}
[S14] START round=73 head_norm_before_train=1.720457 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9954357786394643, 'loss_val': 0.0246030636410144, 'psi': 0.9962289534819522}-{'f1_val': 0.9965652232429598, 'auprc': 0.9979166278477232, 'loss_val': 0.023292795526348317, 'psi': 0.9971057850848652}
[S15] START round=73 head_norm_before_train=1.816545 cos_to_last_merge=1.0000 (last merge round=71)
[S15] round=73 local utility u=0.649052 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9964308146468728, 'loss_val': 0.02872205990636655, 'psi': 0.9963717723680336}-{'f1_val': 0.8291825818956415, 'auprc': 0.992763839454137, 'loss_val': 0.312927014700405, 'psi': 0.8946150849190397}
[S16] START round=73 head_norm_before_train=1.727656 cos_to_last_merge=1.0000 (last merge round=69)
[S16] round=73 local utility u=0.242169 metrics={'f1_val': 0.9907493397545588, 'auprc': 0.9889786009263551, 'loss_val': 0.05099437363241602, 'psi': 0.9900410442232773}-{'f1_val': 0.9434069848702502, 'auprc': 0.9850943556210359, 'loss_val': 0.2396255590414829, 'psi': 0.9600819331705644}
[S17] START round=73 head_norm_before_train=1.952656 cos_to_last_merge=0.9893 (last merge round=52)
[S17] round=73 local utility u=0.511412 metrics={'f1_val': 0.7518911267670265, 'auprc': 0.781169807446526, 'loss_val': 0.7471814938794051, 'psi': 0.7636025990388263}-{'f1_val': 0.6307992074711973, 'auprc': 0.8718956506231185, 'loss_val': 1.315632350376063, 'psi': 0.7272377847319658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44914
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.655)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.996)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=0.9976
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=73 metric=0.9407 head_norm=2.134402
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.509782e-02
[S4] stored merged vector for next round verification (round=73)
[S4] DEBUG after merge:  round=73 metric=0.9407 head_norm=2.135477 delta_norm=0.015098
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=73 metric=0.9907 head_norm=1.735185
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.513997e-02
[S16] stored merged vector for next round verification (round=73)
[S16] DEBUG after merge:  round=73 metric=0.9907 head_norm=1.727770 delta_norm=0.015140
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=73 metric=0.7183 head_norm=1.819311
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.435647e-02
[S2] stored merged vector for next round verification (round=73)
[S2] DEBUG after merge:  round=73 metric=0.7183 head_norm=1.816789 delta_norm=0.064356
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=73 metric=0.9963 head_norm=1.827542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.389258e-02
[S15] stored merged vector for next round verification (round=73)
[S15] DEBUG after merge:  round=73 metric=0.9963 head_norm=1.822311 delta_norm=0.063893
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=1.0000
[S2] START round=74 head_norm_before_train=1.816789 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=74 local utility u=0.023341 metrics={'f1_val': 0.7182877404894223, 'auprc': 0.7469358756506865, 'loss_val': 0.7297489321777507, 'psi': 0.729746994553928}-{'f1_val': 0.7182595029461349, 'auprc': 0.7355606914869242, 'loss_val': 0.7421359231313608, 'psi': 0.7251799783624506}
[S3] START round=74 head_norm_before_train=2.009307 cos_to_last_merge=1.0000 (last merge round=72)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9587989981397127, 'auprc': 0.9940856573863514, 'loss_val': 0.14464405141275002, 'psi': 0.9729136618383682}-{'f1_val': 0.9929481249417512, 'auprc': 0.9986345995656868, 'loss_val': 0.022796154609734193, 'psi': 0.9952227147913255}
[S4] START round=74 head_norm_before_train=2.135477 cos_to_last_merge=1.0000 (last merge round=73)
[S4] round=74 local utility u=0.005570 metrics={'f1_val': 0.9411563768265152, 'auprc': 0.940565831439822, 'loss_val': 0.33315383406733384, 'psi': 0.9409201586718379}-{'f1_val': 0.9407241549789456, 'auprc': 0.9382919489265559, 'loss_val': 0.33487833228546016, 'psi': 0.9397512725579897}
[S5] START round=74 head_norm_before_train=1.848147 cos_to_last_merge=0.9945 (last merge round=62)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9986224992989474, 'loss_val': 0.02514539141137919, 'psi': 0.9974701808066535}-{'f1_val': 0.9967019684784577, 'auprc': 0.9993388877678907, 'loss_val': 0.025149924143755612, 'psi': 0.9977567361942309}
[S6] START round=74 head_norm_before_train=1.776616 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=74 local utility u=0.204354 metrics={'f1_val': 0.714885355358196, 'auprc': 0.8676500072773267, 'loss_val': 0.7622860570345609, 'psi': 0.7759912161258482}-{'f1_val': 0.6563221648277004, 'auprc': 0.8833982816984212, 'loss_val': 0.8668598583511241, 'psi': 0.7471526115759888}
[S7] START round=74 head_norm_before_train=2.005314 cos_to_last_merge=1.0000 (last merge round=72)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5258694936415899, 'auprc': 0.7947823708440117, 'loss_val': 1.6616515639860767, 'psi': 0.6334346445225586}-{'f1_val': 0.6224906425534676, 'auprc': 0.931464089529988, 'loss_val': 1.3223965216652926, 'psi': 0.7460800213440758}
[S8] START round=74 head_norm_before_train=1.783171 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=74 local utility u=0.026794 metrics={'f1_val': 0.9920958619566724, 'auprc': 0.9989281374917346, 'loss_val': 0.04559116158273463, 'psi': 0.9948287721706973}-{'f1_val': 0.9843044951922839, 'auprc': 0.9986609303826665, 'loss_val': 0.05162846034376636, 'psi': 0.990047069268437}
[S9] START round=74 head_norm_before_train=1.721550 cos_to_last_merge=0.9573 (last merge round=37)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.998766734816404, 'loss_val': 0.019846494608923057, 'psi': 0.9971041672180907}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987447000083847, 'loss_val': 0.020064129483685834, 'psi': 0.9974941870916887}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=1.932795 cos_to_last_merge=1.0000 (last merge round=72)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.99406584719663, 'auprc': 0.9964493385264763, 'loss_val': 0.032292579817881854, 'psi': 0.9950192437285685}-{'f1_val': 0.993871046050545, 'auprc': 0.9968965550406772, 'loss_val': 0.030816973782995666, 'psi': 0.9950812496465978}
[S11] START round=74 head_norm_before_train=2.144447 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.995391754225302, 'auprc': 0.998406373320583, 'loss_val': 0.027632076558681724, 'psi': 0.9965976018634144}-{'f1_val': 0.9958716985726862, 'auprc': 0.9985618305064214, 'loss_val': 0.026690190229848792, 'psi': 0.9969477513461803}
[S13] START round=74 head_norm_before_train=1.930559 cos_to_last_merge=1.0000 (last merge round=72)
[S13] round=74 local utility u=0.279754 metrics={'f1_val': 0.702063098446119, 'auprc': 0.7277219188867898, 'loss_val': 1.040572876546171, 'psi': 0.7123266266223873}-{'f1_val': 0.6381800719836123, 'auprc': 0.6804541193546514, 'loss_val': 1.0749795694291848, 'psi': 0.6550896909320278}
[S14] START round=74 head_norm_before_train=1.724716 cos_to_last_merge=0.9999 (last merge round=69)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9960293290281307, 'loss_val': 0.024700880813217977, 'psi': 0.9962182846753221}-{'f1_val': 0.9967577367102773, 'auprc': 0.9954357786394643, 'loss_val': 0.0246030636410144, 'psi': 0.9962289534819522}
[S15] START round=74 head_norm_before_train=1.822311 cos_to_last_merge=1.0000 (last merge round=73)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9165043867769429, 'auprc': 0.9929693304354019, 'loss_val': 0.14783275826353615, 'psi': 0.9470903642403266}-{'f1_val': 0.9963324108488076, 'auprc': 0.9964308146468728, 'loss_val': 0.02872205990636655, 'psi': 0.9963717723680336}
[S16] START round=74 head_norm_before_train=1.727770 cos_to_last_merge=1.0000 (last merge round=73)
[S16] round=74 local utility u=0.008385 metrics={'f1_val': 0.990769919705693, 'auprc': 0.993067305035555, 'loss_val': 0.0466137706510941, 'psi': 0.9916888738376377}-{'f1_val': 0.9907493397545588, 'auprc': 0.9889786009263551, 'loss_val': 0.05099437363241602, 'psi': 0.9900410442232773}
[S17] START round=74 head_norm_before_train=1.957270 cos_to_last_merge=0.9892 (last merge round=52)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.6499363580497893, 'auprc': 0.8527913596188174, 'loss_val': 1.137918131583112, 'psi': 0.7310783586774006}-{'f1_val': 0.7518911267670265, 'auprc': 0.781169807446526, 'loss_val': 0.7471814938794051, 'psi': 0.7636025990388263}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.941)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S16] not sending this round → trigger blocked (psi=0.992)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.730)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:44907
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=74 metric=0.9954 head_norm=2.151633
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.164770e-02
[S11] stored merged vector for next round verification (round=74)
[S11] DEBUG after merge:  round=74 metric=0.9954 head_norm=2.142925 delta_norm=0.021648
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=74 metric=0.5259 head_norm=2.007458
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.951758e-03
[S7] stored merged vector for next round verification (round=74)
[S7] DEBUG after merge:  round=74 metric=0.5259 head_norm=2.008363 delta_norm=0.008952
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=74 metric=0.9963 head_norm=1.728490
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.685137e-02
[S14] stored merged vector for next round verification (round=74)
[S14] DEBUG after merge:  round=74 metric=0.9963 head_norm=1.731759 delta_norm=0.016851
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=74 metric=0.9165 head_norm=1.832565
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.237554e-01
[S15] stored merged vector for next round verification (round=74)
[S15] DEBUG after merge:  round=74 metric=0.9165 head_norm=1.836207 delta_norm=0.123755
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=74 metric=0.9921 head_norm=1.789270
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.215136e-02
[S8] stored merged vector for next round verification (round=74)
[S8] DEBUG after merge:  round=74 metric=0.9925 head_norm=1.785730 delta_norm=0.012151
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S2] START round=75 head_norm_before_train=1.832046 cos_to_last_merge=0.9999 (last merge round=73)
[S2] round=75 local utility u=0.020056 metrics={'f1_val': 0.7190004183994595, 'auprc': 0.7538922940445336, 'loss_val': 0.7147819441952101, 'psi': 0.7329571686574892}-{'f1_val': 0.7182877404894223, 'auprc': 0.7469358756506865, 'loss_val': 0.7297489321777507, 'psi': 0.729746994553928}
[S3] START round=75 head_norm_before_train=2.015642 cos_to_last_merge=1.0000 (last merge round=72)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.8765988395138677, 'auprc': 0.9878488127345291, 'loss_val': 0.2788497170256682, 'psi': 0.9210988288021323}-{'f1_val': 0.9587989981397127, 'auprc': 0.9940856573863514, 'loss_val': 0.14464405141275002, 'psi': 0.9729136618383682}
[S4] START round=75 head_norm_before_train=2.137407 cos_to_last_merge=1.0000 (last merge round=73)
[S4] round=75 local utility u=0.019161 metrics={'f1_val': 0.9433637262249612, 'auprc': 0.9470660944571138, 'loss_val': 0.3275770207372041, 'psi': 0.9448446735178222}-{'f1_val': 0.9411563768265152, 'auprc': 0.940565831439822, 'loss_val': 0.33315383406733384, 'psi': 0.9409201586718379}
[S5] START round=75 head_norm_before_train=1.855223 cos_to_last_merge=0.9939 (last merge round=62)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9959857674030241, 'loss_val': 0.024955053198294896, 'psi': 0.9959314070979403}-{'f1_val': 0.9967019684784577, 'auprc': 0.9986224992989474, 'loss_val': 0.02514539141137919, 'psi': 0.9974701808066535}
[S6] START round=75 head_norm_before_train=1.782266 cos_to_last_merge=0.9999 (last merge round=72)
[S6] round=75 local utility u=0.732754 metrics={'f1_val': 0.8403671547996912, 'auprc': 0.952602606933812, 'loss_val': 0.30452702598935993, 'psi': 0.8852613356533394}-{'f1_val': 0.714885355358196, 'auprc': 0.8676500072773267, 'loss_val': 0.7622860570345609, 'psi': 0.7759912161258482}
[S7] START round=75 head_norm_before_train=2.008363 cos_to_last_merge=1.0000 (last merge round=74)
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.8629738220792775, 'auprc': 0.9874248217050507, 'loss_val': 0.5092880562463695, 'psi': 0.9127542219295868}-{'f1_val': 0.5258694936415899, 'auprc': 0.7947823708440117, 'loss_val': 1.6616515639860767, 'psi': 0.6334346445225586}
[S8] START round=75 head_norm_before_train=1.785730 cos_to_last_merge=1.0000 (last merge round=74)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9694179143771103, 'auprc': 0.9989383967383642, 'loss_val': 0.08290321728127861, 'psi': 0.9812261073216119}-{'f1_val': 0.9920958619566724, 'auprc': 0.9989281374917346, 'loss_val': 0.04559116158273463, 'psi': 0.9948287721706973}
[S9] START round=75 head_norm_before_train=1.728315 cos_to_last_merge=0.9568 (last merge round=37)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956383235348094, 'loss_val': 0.019419243076013826, 'psi': 0.9962516365022587}-{'f1_val': 0.9959957888192151, 'auprc': 0.998766734816404, 'loss_val': 0.019846494608923057, 'psi': 0.9971041672180907}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=1.940172 cos_to_last_merge=1.0000 (last merge round=72)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9961652266656167, 'loss_val': 0.0324367921685129, 'psi': 0.9946571948844464}-{'f1_val': 0.99406584719663, 'auprc': 0.9964493385264763, 'loss_val': 0.032292579817881854, 'psi': 0.9950192437285685}
[S11] START round=75 head_norm_before_train=2.142925 cos_to_last_merge=1.0000 (last merge round=74)
[S11] round=75 local utility u=0.003060 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9984708380737224, 'loss_val': 0.02458608303905825, 'psi': 0.9969113543731007}-{'f1_val': 0.995391754225302, 'auprc': 0.998406373320583, 'loss_val': 0.027632076558681724, 'psi': 0.9965976018634144}
[S13] START round=75 head_norm_before_train=1.936470 cos_to_last_merge=0.9999 (last merge round=72)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6109890293964423, 'auprc': 0.6169780774783613, 'loss_val': 1.3991703538147098, 'psi': 0.6133846486292098}-{'f1_val': 0.702063098446119, 'auprc': 0.7277219188867898, 'loss_val': 1.040572876546171, 'psi': 0.7123266266223873}
[S14] START round=75 head_norm_before_train=1.731759 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=75 local utility u=0.005500 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9987876186833782, 'loss_val': 0.021979666348071997, 'psi': 0.9973220579948637}-{'f1_val': 0.9963442551067831, 'auprc': 0.9960293290281307, 'loss_val': 0.024700880813217977, 'psi': 0.9962182846753221}
[S15] START round=75 head_norm_before_train=1.836207 cos_to_last_merge=1.0000 (last merge round=74)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.8826223645753429, 'auprc': 0.9923575680266007, 'loss_val': 0.23455844471819448, 'psi': 0.9265164459558459}-{'f1_val': 0.9165043867769429, 'auprc': 0.9929693304354019, 'loss_val': 0.14783275826353615, 'psi': 0.9470903642403266}
[S16] START round=75 head_norm_before_train=1.734661 cos_to_last_merge=1.0000 (last merge round=73)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.8713370806517888, 'auprc': 0.9769067774908557, 'loss_val': 0.6406303651052954, 'psi': 0.9135649593874156}-{'f1_val': 0.990769919705693, 'auprc': 0.993067305035555, 'loss_val': 0.0466137706510941, 'psi': 0.9916888738376377}
[S17] START round=75 head_norm_before_train=1.966845 cos_to_last_merge=0.9887 (last merge round=52)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.624274335232945, 'auprc': 0.9584984831130623, 'loss_val': 1.4260532869501565, 'psi': 0.7579639943849918}-{'f1_val': 0.6499363580497893, 'auprc': 0.8527913596188174, 'loss_val': 1.137918131583112, 'psi': 0.7310783586774006}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S6] not sending this round → trigger blocked (psi=0.885)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=75 metric=0.8404 head_norm=1.793659
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.629455e-02
[S6] stored merged vector for next round verification (round=75)
[S6] DEBUG after merge:  round=75 metric=0.8402 head_norm=1.791391 delta_norm=0.016295
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.355 → S8@127.0.0.1:44909
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.124 → S10@127.0.0.1:44911
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.9970
[S11] RECEIVED delta(kind=head bytes=1792) from S4
[S11] cosine check vs S4: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9999
[S7] ⇄ pheromone p=0.359 → S3@127.0.0.1:44903
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=75 metric=0.9434 head_norm=2.141723
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.658428e-02
[S4] stored merged vector for next round verification (round=75)
[S4] DEBUG after merge:  round=75 metric=0.9430 head_norm=2.145748 delta_norm=0.016584
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.013 → S11@127.0.0.1:44912
[S14] ⇄ pheromone p=0.004 → S16@127.0.0.1:44916
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=75 metric=0.9959 head_norm=2.149894
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.658427e-02
[S11] stored merged vector for next round verification (round=75)
[S11] DEBUG after merge:  round=75 metric=0.9959 head_norm=2.145748 delta_norm=0.016584
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S2] ⇄ pheromone p=0.040 → S15@127.0.0.1:44915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.017 → S6@127.0.0.1:44907
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=75 metric=0.8766 head_norm=2.022622
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.177708e-02
[S3] stored merged vector for next round verification (round=75)
[S3] DEBUG after merge:  round=75 metric=0.8783 head_norm=2.018296 delta_norm=0.011777
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.122 → S7@127.0.0.1:44908
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=75 metric=0.8826 head_norm=1.847170
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.173759e-02
[S15] stored merged vector for next round verification (round=75)
[S15] DEBUG after merge:  round=75 metric=0.8820 head_norm=1.846277 delta_norm=0.071738
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.213 → S2@127.0.0.1:44902
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=75 metric=0.9937 head_norm=1.947863
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.435346e-02
[S10] stored merged vector for next round verification (round=75)
[S10] DEBUG after merge:  round=75 metric=0.9937 head_norm=1.942122 delta_norm=0.014353
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:44913
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=75 metric=0.8713 head_norm=1.741035
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.332571e-03
[S16] stored merged vector for next round verification (round=75)
[S16] DEBUG after merge:  round=75 metric=0.8713 head_norm=1.738967 delta_norm=0.007333
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.067 → S14@127.0.0.1:44914
[S5] ⇄ pheromone p=0.002 → S15@127.0.0.1:44915
[S2] START round=76 head_norm_before_train=1.848171 cos_to_last_merge=0.9998 (last merge round=73)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.6372611567694131, 'auprc': 0.7572103481212892, 'loss_val': 1.0775806362134215, 'psi': 0.6852408333101636}-{'f1_val': 0.7190004183994595, 'auprc': 0.7538922940445336, 'loss_val': 0.7147819441952101, 'psi': 0.7329571686574892}
[S3] START round=76 head_norm_before_train=2.018296 cos_to_last_merge=1.0000 (last merge round=75)
[S3] round=76 local utility u=0.341320 metrics={'f1_val': 0.954794358540025, 'auprc': 0.9982793501871366, 'loss_val': 0.09667387941934108, 'psi': 0.9721883551988697}-{'f1_val': 0.8765988395138677, 'auprc': 0.9878488127345291, 'loss_val': 0.2788497170256682, 'psi': 0.9210988288021323}
[S4] START round=76 head_norm_before_train=2.145748 cos_to_last_merge=1.0000 (last merge round=75)
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.941769212855995, 'auprc': 0.9395819194738384, 'loss_val': 0.33309733077901116, 'psi': 0.9408942955031323}-{'f1_val': 0.9433637262249612, 'auprc': 0.9470660944571138, 'loss_val': 0.3275770207372041, 'psi': 0.9448446735178222}
[S5] START round=76 head_norm_before_train=1.870838 cos_to_last_merge=0.9933 (last merge round=62)
[S5] round=76 local utility u=0.001907 metrics={'f1_val': 0.995895166894551, 'auprc': 0.99712044140571, 'loss_val': 0.024545465157309414, 'psi': 0.9963852766990146}-{'f1_val': 0.995895166894551, 'auprc': 0.9959857674030241, 'loss_val': 0.024955053198294896, 'psi': 0.9959314070979403}
[S6] START round=76 head_norm_before_train=1.791391 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7457291489546308, 'auprc': 0.9443983495266615, 'loss_val': 0.6262716689154936, 'psi': 0.8251968291834431}-{'f1_val': 0.8403671547996912, 'auprc': 0.952602606933812, 'loss_val': 0.30452702598935993, 'psi': 0.8852613356533394}
[S7] START round=76 head_norm_before_train=2.014029 cos_to_last_merge=1.0000 (last merge round=74)
[S7] round=76 local utility u=0.119295 metrics={'f1_val': 0.8858513423224411, 'auprc': 0.9805757252656129, 'loss_val': 0.3874151837164054, 'psi': 0.9237410954997098}-{'f1_val': 0.8629738220792775, 'auprc': 0.9874248217050507, 'loss_val': 0.5092880562463695, 'psi': 0.9127542219295868}
[S8] START round=76 head_norm_before_train=1.790144 cos_to_last_merge=1.0000 (last merge round=74)
[S8] round=76 local utility u=0.094319 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9988900059057735, 'loss_val': 0.03411405173732115, 'psi': 0.9952061814212017}-{'f1_val': 0.9694179143771103, 'auprc': 0.9989383967383642, 'loss_val': 0.08290321728127861, 'psi': 0.9812261073216119}
[S9] START round=76 head_norm_before_train=1.735361 cos_to_last_merge=0.9565 (last merge round=37)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9956393615651784, 'loss_val': 0.019420887640452435, 'psi': 0.9961018560264039}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956383235348094, 'loss_val': 0.019419243076013826, 'psi': 0.9962516365022587}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.942122 cos_to_last_merge=1.0000 (last merge round=75)
[S10] round=76 local utility u=0.003830 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995337729123672, 'loss_val': 0.028875086199443567, 'psi': 0.9949842571810923}-{'f1_val': 0.9936518403636662, 'auprc': 0.9961652266656167, 'loss_val': 0.0324367921685129, 'psi': 0.9946571948844464}
[S11] START round=76 head_norm_before_train=2.145748 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9249518668113828, 'auprc': 0.9508001497136837, 'loss_val': 0.41461930046547946, 'psi': 0.935291179972303}-{'f1_val': 0.9958716985726862, 'auprc': 0.9984708380737224, 'loss_val': 0.02458608303905825, 'psi': 0.9969113543731007}
[S13] START round=76 head_norm_before_train=1.944067 cos_to_last_merge=0.9999 (last merge round=72)
[S13] round=76 local utility u=0.739013 metrics={'f1_val': 0.7267792607205542, 'auprc': 0.7418924817748975, 'loss_val': 0.9906298449621249, 'psi': 0.7328245491422916}-{'f1_val': 0.6109890293964423, 'auprc': 0.6169780774783613, 'loss_val': 1.3991703538147098, 'psi': 0.6133846486292098}
[S14] START round=76 head_norm_before_train=1.736927 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=76 local utility u=0.001429 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9988346576476924, 'loss_val': 0.02172358070001587, 'psi': 0.9975870395087383}-{'f1_val': 0.996345017535854, 'auprc': 0.9987876186833782, 'loss_val': 0.021979666348071997, 'psi': 0.9973220579948637}
[S15] START round=76 head_norm_before_train=1.846277 cos_to_last_merge=1.0000 (last merge round=75)
[S15] round=76 local utility u=0.449603 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9954923243528334, 'loss_val': 0.027016759106491216, 'psi': 0.9959963762504179}-{'f1_val': 0.8826223645753429, 'auprc': 0.9923575680266007, 'loss_val': 0.23455844471819448, 'psi': 0.9265164459558459}
[S16] START round=76 head_norm_before_train=1.738967 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=76 local utility u=0.683449 metrics={'f1_val': 0.9913599595172675, 'auprc': 0.9933679940849628, 'loss_val': 0.04325259636995374, 'psi': 0.9921631733443457}-{'f1_val': 0.8713370806517888, 'auprc': 0.9769067774908557, 'loss_val': 0.6406303651052954, 'psi': 0.9135649593874156}
[S17] START round=76 head_norm_before_train=1.975837 cos_to_last_merge=0.9882 (last merge round=52)
[S17] round=76 local utility u=0.965312 metrics={'f1_val': 0.7990307752254866, 'auprc': 0.9801652090113621, 'loss_val': 0.6089678383533319, 'psi': 0.8714845487398368}-{'f1_val': 0.624274335232945, 'auprc': 0.9584984831130623, 'loss_val': 1.4260532869501565, 'psi': 0.7579639943849918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.924)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:44908
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=76 metric=0.7268 head_norm=1.948541
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.502355e-02
[S13] stored merged vector for next round verification (round=76)
[S13] DEBUG after merge:  round=76 metric=0.7264 head_norm=1.948914 delta_norm=0.015024
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=76 metric=0.9947 head_norm=1.949404
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.502355e-02
[S10] stored merged vector for next round verification (round=76)
[S10] DEBUG after merge:  round=76 metric=0.9947 head_norm=1.948914 delta_norm=0.015024
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S3
[S7] cosine check vs S3: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9936
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9990
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=76 metric=0.9963 head_norm=1.857318
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.069577e-01
[S15] stored merged vector for next round verification (round=76)
[S15] DEBUG after merge:  round=76 metric=0.9963 head_norm=1.867190 delta_norm=0.106958
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=1.861452 cos_to_last_merge=0.9996 (last merge round=73)
[S2] round=77 local utility u=0.437879 metrics={'f1_val': 0.711170326425746, 'auprc': 0.7768322388740624, 'loss_val': 0.704142616640373, 'psi': 0.7374350914050725}-{'f1_val': 0.6372611567694131, 'auprc': 0.7572103481212892, 'loss_val': 1.0775806362134215, 'psi': 0.6852408333101636}
[S3] START round=77 head_norm_before_train=2.026434 cos_to_last_merge=1.0000 (last merge round=75)
[S3] round=77 local utility u=0.000501 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9982286416787316, 'loss_val': 0.13119872555272602, 'psi': 0.9757360505187088}-{'f1_val': 0.954794358540025, 'auprc': 0.9982793501871366, 'loss_val': 0.09667387941934108, 'psi': 0.9721883551988697}
[S4] START round=77 head_norm_before_train=2.145702 cos_to_last_merge=1.0000 (last merge round=75)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.942566187488117, 'auprc': 0.927454413156768, 'loss_val': 0.32801569949264164, 'psi': 0.9365214777555774}-{'f1_val': 0.941769212855995, 'auprc': 0.9395819194738384, 'loss_val': 0.33309733077901116, 'psi': 0.9408942955031323}
[S5] START round=77 head_norm_before_train=1.883096 cos_to_last_merge=0.9929 (last merge round=62)
[S5] round=77 local utility u=0.004449 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9980771195457067, 'loss_val': 0.02335772719248966, 'psi': 0.9972520289053572}-{'f1_val': 0.995895166894551, 'auprc': 0.99712044140571, 'loss_val': 0.024545465157309414, 'psi': 0.9963852766990146}
[S6] START round=77 head_norm_before_train=1.804997 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=77 local utility u=0.040376 metrics={'f1_val': 0.7449664707493252, 'auprc': 0.9532938744123539, 'loss_val': 0.5676292637163988, 'psi': 0.8282974322145367}-{'f1_val': 0.7457291489546308, 'auprc': 0.9443983495266615, 'loss_val': 0.6262716689154936, 'psi': 0.8251968291834431}
[S7] START round=77 head_norm_before_train=2.025508 cos_to_last_merge=1.0000 (last merge round=74)
[S7] round=77 local utility u=0.328050 metrics={'f1_val': 0.9526642900827234, 'auprc': 0.9890614260978916, 'loss_val': 0.15764994012305455, 'psi': 0.9672231444887907}-{'f1_val': 0.8858513423224411, 'auprc': 0.9805757252656129, 'loss_val': 0.3874151837164054, 'psi': 0.9237410954997098}
[S8] START round=77 head_norm_before_train=1.794487 cos_to_last_merge=1.0000 (last merge round=74)
[S8] round=77 local utility u=0.004677 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9994264607528256, 'loss_val': 0.03162042286786507, 'psi': 0.9959457865698282}-{'f1_val': 0.992750298431487, 'auprc': 0.9988900059057735, 'loss_val': 0.03411405173732115, 'psi': 0.9952061814212017}
[S9] START round=77 head_norm_before_train=1.740145 cos_to_last_merge=0.9559 (last merge round=37)
[S9] round=77 local utility u=0.004651 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9987787538143523, 'loss_val': 0.019537351857995655, 'psi': 0.9973576129260735}-{'f1_val': 0.9964101856672208, 'auprc': 0.9956393615651784, 'loss_val': 0.019420887640452435, 'psi': 0.9961018560264039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=77 head_norm_before_train=1.948914 cos_to_last_merge=1.0000 (last merge round=76)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9964550725096628, 'loss_val': 0.02958747692286843, 'psi': 0.9950362243020334}-{'f1_val': 0.9947486092193725, 'auprc': 0.995337729123672, 'loss_val': 0.028875086199443567, 'psi': 0.9949842571810923}
[S11] START round=77 head_norm_before_train=2.149731 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.820702776040984, 'auprc': 0.9984884999227406, 'loss_val': 0.19747405415339642, 'psi': 0.8918170655936866}-{'f1_val': 0.9249518668113828, 'auprc': 0.9508001497136837, 'loss_val': 0.41461930046547946, 'psi': 0.935291179972303}
[S13] START round=77 head_norm_before_train=1.948914 cos_to_last_merge=1.0000 (last merge round=76)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6165243596794523, 'auprc': 0.6762190456618, 'loss_val': 1.3545861499664276, 'psi': 0.6404022340723914}-{'f1_val': 0.7267792607205542, 'auprc': 0.7418924817748975, 'loss_val': 0.9906298449621249, 'psi': 0.7328245491422916}
[S14] START round=77 head_norm_before_train=1.740689 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9985491093615767, 'loss_val': 0.021982599400227523, 'psi': 0.9974723627368495}-{'f1_val': 0.9967552940827689, 'auprc': 0.9988346576476924, 'loss_val': 0.02172358070001587, 'psi': 0.9975870395087383}
[S15] START round=77 head_norm_before_train=1.867190 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.8736121225869968, 'auprc': 0.9929900609433182, 'loss_val': 0.27797340715211855, 'psi': 0.9213632979295254}-{'f1_val': 0.9963324108488076, 'auprc': 0.9954923243528334, 'loss_val': 0.027016759106491216, 'psi': 0.9959963762504179}
[S16] START round=77 head_norm_before_train=1.745562 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9904450250543615, 'auprc': 0.9885451370412044, 'loss_val': 0.04588454504217229, 'psi': 0.9896850698490987}-{'f1_val': 0.9913599595172675, 'auprc': 0.9933679940849628, 'loss_val': 0.04325259636995374, 'psi': 0.9921631733443457}
[S17] START round=77 head_norm_before_train=1.982963 cos_to_last_merge=0.9879 (last merge round=52)
[S17] round=77 local utility u=0.014194 metrics={'f1_val': 0.804570412935216, 'auprc': 0.9861024024955324, 'loss_val': 0.6316297584559669, 'psi': 0.8771832087593425}-{'f1_val': 0.7990307752254866, 'auprc': 0.9801652090113621, 'loss_val': 0.6089678383533319, 'psi': 0.8714845487398368}
[S17] not sending this round → trigger blocked (psi=0.877)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S7] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=77 metric=0.9968 head_norm=1.746025
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.158831e-03
[S14] stored merged vector for next round verification (round=77)
[S14] DEBUG after merge:  round=77 metric=0.9968 head_norm=1.745779 delta_norm=0.007159
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → trigger blocked (psi=0.976)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.9947
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9998
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=77 metric=0.7450 head_norm=1.820009
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.254449e-02
[S6] stored merged vector for next round verification (round=77)
[S6] DEBUG after merge:  round=77 metric=0.7466 head_norm=1.807153 delta_norm=0.022544
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=77 metric=0.7112 head_norm=1.873133
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.782443e-02
[S2] stored merged vector for next round verification (round=77)
[S2] DEBUG after merge:  round=77 metric=0.7107 head_norm=1.864629 delta_norm=0.047824
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=77 metric=0.9527 head_norm=2.041567
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.855109e-02
[S7] stored merged vector for next round verification (round=77)
[S7] DEBUG after merge:  round=77 metric=0.9527 head_norm=2.033930 delta_norm=0.018551
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → trigger blocked (psi=0.997)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=77 metric=0.9607 head_norm=2.034898
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.921440e-02
[S3] stored merged vector for next round verification (round=77)
[S3] DEBUG after merge:  round=77 metric=0.9607 head_norm=2.038145 delta_norm=0.019214
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=77 metric=0.9936 head_norm=1.800701
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.135484e-02
[S8] stored merged vector for next round verification (round=77)
[S8] DEBUG after merge:  round=77 metric=0.9936 head_norm=1.810255 delta_norm=0.021355
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=77 metric=0.8736 head_norm=1.878272
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.650416e-02
[S15] stored merged vector for next round verification (round=77)
[S15] DEBUG after merge:  round=77 metric=0.8736 head_norm=1.873220 delta_norm=0.096504
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=1.864629 cos_to_last_merge=1.0000 (last merge round=77)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7195321632651932, 'auprc': 0.7380491585138558, 'loss_val': 0.7548402063970009, 'psi': 0.7269389613646582}-{'f1_val': 0.711170326425746, 'auprc': 0.7768322388740624, 'loss_val': 0.704142616640373, 'psi': 0.7374350914050725}
[S3] START round=78 head_norm_before_train=2.038145 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9567020940454974, 'auprc': 0.9909961486993919, 'loss_val': 0.14089218674927112, 'psi': 0.9704197159070551}-{'f1_val': 0.9607409897453603, 'auprc': 0.9982286416787316, 'loss_val': 0.13119872555272602, 'psi': 0.9757360505187088}
[S4] START round=78 head_norm_before_train=2.147363 cos_to_last_merge=0.9999 (last merge round=75)
[S4] round=78 local utility u=0.003961 metrics={'f1_val': 0.9416363578233872, 'auprc': 0.931784048250972, 'loss_val': 0.32750456815870244, 'psi': 0.9376954339944211}-{'f1_val': 0.942566187488117, 'auprc': 0.927454413156768, 'loss_val': 0.32801569949264164, 'psi': 0.9365214777555774}
[S5] START round=78 head_norm_before_train=1.890512 cos_to_last_merge=0.9924 (last merge round=62)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9853482148826104, 'auprc': 0.9923123966840341, 'loss_val': 0.05001209923869501, 'psi': 0.9881338876031799}-{'f1_val': 0.9967019684784577, 'auprc': 0.9980771195457067, 'loss_val': 0.02335772719248966, 'psi': 0.9972520289053572}
[S6] START round=78 head_norm_before_train=1.807153 cos_to_last_merge=1.0000 (last merge round=77)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.7163626042819425, 'auprc': 0.958067265592478, 'loss_val': 0.5605047275678213, 'psi': 0.8130444688061568}-{'f1_val': 0.7449664707493252, 'auprc': 0.9532938744123539, 'loss_val': 0.5676292637163988, 'psi': 0.8282974322145367}
[S7] START round=78 head_norm_before_train=2.033930 cos_to_last_merge=1.0000 (last merge round=77)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.825823171174929, 'auprc': 0.9582757469442407, 'loss_val': 0.8988720336616381, 'psi': 0.8788042014826536}-{'f1_val': 0.9526642900827234, 'auprc': 0.9890614260978916, 'loss_val': 0.15764994012305455, 'psi': 0.9672231444887907}
[S8] START round=78 head_norm_before_train=1.810255 cos_to_last_merge=1.0000 (last merge round=77)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9992464440471986, 'loss_val': 0.031938644513187425, 'psi': 0.9952159592132712}-{'f1_val': 0.9936253371144965, 'auprc': 0.9994264607528256, 'loss_val': 0.03162042286786507, 'psi': 0.9959457865698282}
[S9] START round=78 head_norm_before_train=1.743465 cos_to_last_merge=0.9557 (last merge round=37)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9931096570334577, 'loss_val': 0.020103620182225362, 'psi': 0.9949939196809496}-{'f1_val': 0.9964101856672208, 'auprc': 0.9987787538143523, 'loss_val': 0.019537351857995655, 'psi': 0.9973576129260735}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=1.954861 cos_to_last_merge=1.0000 (last merge round=76)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9944809565731662, 'loss_val': 0.030822962921038366, 'psi': 0.9943634964195887}-{'f1_val': 0.9940903254969471, 'auprc': 0.9964550725096628, 'loss_val': 0.02958747692286843, 'psi': 0.9950362243020334}
[S11] START round=78 head_norm_before_train=2.153394 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=78 local utility u=0.612492 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9981426779619947, 'loss_val': 0.022466628502855506, 'psi': 0.9967800903284096}-{'f1_val': 0.820702776040984, 'auprc': 0.9984884999227406, 'loss_val': 0.19747405415339642, 'psi': 0.8918170655936866}
[S13] START round=78 head_norm_before_train=1.952819 cos_to_last_merge=1.0000 (last merge round=76)
[S13] round=78 local utility u=0.678974 metrics={'f1_val': 0.734289718929182, 'auprc': 0.7491690095042696, 'loss_val': 0.9220792841045475, 'psi': 0.740241435159217}-{'f1_val': 0.6165243596794523, 'auprc': 0.6762190456618, 'loss_val': 1.3545861499664276, 'psi': 0.6404022340723914}
[S14] START round=78 head_norm_before_train=1.745779 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9963265049430008, 'loss_val': 0.022473530708711702, 'psi': 0.9963371550412702}-{'f1_val': 0.996754531653698, 'auprc': 0.9985491093615767, 'loss_val': 0.021982599400227523, 'psi': 0.9974723627368495}
[S15] START round=78 head_norm_before_train=1.873220 cos_to_last_merge=1.0000 (last merge round=77)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7748560717717212, 'auprc': 0.9924492234832267, 'loss_val': 0.4724897252839177, 'psi': 0.8618933324563234}-{'f1_val': 0.8736121225869968, 'auprc': 0.9929900609433182, 'loss_val': 0.27797340715211855, 'psi': 0.9213632979295254}
[S16] START round=78 head_norm_before_train=1.752692 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9022767240418885, 'auprc': 0.9874564266189244, 'loss_val': 0.446611072436681, 'psi': 0.9363486050727029}-{'f1_val': 0.9904450250543615, 'auprc': 0.9885451370412044, 'loss_val': 0.04588454504217229, 'psi': 0.9896850698490987}
[S17] START round=78 head_norm_before_train=1.991595 cos_to_last_merge=0.9875 (last merge round=52)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6410247979609764, 'auprc': 0.9857445009623833, 'loss_val': 1.328959202893502, 'psi': 0.7789126791615392}-{'f1_val': 0.804570412935216, 'auprc': 0.9861024024955324, 'loss_val': 0.6316297584559669, 'psi': 0.8771832087593425}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=1.0000
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=78 metric=0.9416 head_norm=2.153059
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.421766e-02
[S4] stored merged vector for next round verification (round=78)
[S4] DEBUG after merge:  round=78 metric=0.9419 head_norm=2.154528 delta_norm=0.024218
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=78 metric=0.9959 head_norm=2.156269
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.421766e-02
[S11] stored merged vector for next round verification (round=78)
[S11] DEBUG after merge:  round=78 metric=0.9959 head_norm=2.154528 delta_norm=0.024218
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=1.876289 cos_to_last_merge=1.0000 (last merge round=77)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.701384337614418, 'auprc': 0.73760890589418, 'loss_val': 0.7987838806967941, 'psi': 0.7158741649263228}-{'f1_val': 0.7195321632651932, 'auprc': 0.7380491585138558, 'loss_val': 0.7548402063970009, 'psi': 0.7269389613646582}
[S3] START round=79 head_norm_before_train=2.046350 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=79 local utility u=0.011900 metrics={'f1_val': 0.9569535538876125, 'auprc': 0.993464053374467, 'loss_val': 0.1260046462769025, 'psi': 0.9715577536823543}-{'f1_val': 0.9567020940454974, 'auprc': 0.9909961486993919, 'loss_val': 0.14089218674927112, 'psi': 0.9704197159070551}
[S4] START round=79 head_norm_before_train=2.154528 cos_to_last_merge=1.0000 (last merge round=78)
[S4] round=79 local utility u=0.005614 metrics={'f1_val': 0.9401094864848731, 'auprc': 0.9397026894050664, 'loss_val': 0.33087064094237517, 'psi': 0.9399467676529504}-{'f1_val': 0.9416363578233872, 'auprc': 0.931784048250972, 'loss_val': 0.32750456815870244, 'psi': 0.9376954339944211}
[S5] START round=79 head_norm_before_train=1.892354 cos_to_last_merge=0.9919 (last merge round=62)
[S5] round=79 local utility u=0.055242 metrics={'f1_val': 0.995895166894551, 'auprc': 0.999175781045732, 'loss_val': 0.023400648142960417, 'psi': 0.9972074125550234}-{'f1_val': 0.9853482148826104, 'auprc': 0.9923123966840341, 'loss_val': 0.05001209923869501, 'psi': 0.9881338876031799}
[S6] START round=79 head_norm_before_train=1.820355 cos_to_last_merge=1.0000 (last merge round=77)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.6075011773925898, 'auprc': 0.9391137137918868, 'loss_val': 1.0430354785601894, 'psi': 0.7401461919523087}-{'f1_val': 0.7163626042819425, 'auprc': 0.958067265592478, 'loss_val': 0.5605047275678213, 'psi': 0.8130444688061568}
[S7] START round=79 head_norm_before_train=2.053904 cos_to_last_merge=1.0000 (last merge round=77)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.8264233566198105, 'auprc': 0.9529033839532691, 'loss_val': 0.9621642522232032, 'psi': 0.877015367553194}-{'f1_val': 0.825823171174929, 'auprc': 0.9582757469442407, 'loss_val': 0.8988720336616381, 'psi': 0.8788042014826536}
[S8] START round=79 head_norm_before_train=1.816214 cos_to_last_merge=1.0000 (last merge round=77)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9990963648501205, 'loss_val': 0.03925816843028203, 'psi': 0.9936401702028306}-{'f1_val': 0.9925289693239863, 'auprc': 0.9992464440471986, 'loss_val': 0.031938644513187425, 'psi': 0.9952159592132712}
[S9] START round=79 head_norm_before_train=1.749605 cos_to_last_merge=0.9554 (last merge round=37)
[S9] round=79 local utility u=0.000044 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.99310980355307, 'loss_val': 0.020015294936775608, 'psi': 0.9949939782887945}-{'f1_val': 0.9962500947792776, 'auprc': 0.9931096570334577, 'loss_val': 0.020103620182225362, 'psi': 0.9949939196809496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=80 psi=0.995 u=0.0000 p_local=0.0016 f1=0.996 auprc=0.993 bytes=75440
[S10] START round=79 head_norm_before_train=1.961599 cos_to_last_merge=1.0000 (last merge round=76)
[S10] round=79 local utility u=0.004113 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9969312928795587, 'loss_val': 0.02877815068221443, 'psi': 0.9952267124499917}-{'f1_val': 0.9942851896505369, 'auprc': 0.9944809565731662, 'loss_val': 0.030822962921038366, 'psi': 0.9943634964195887}
[S11] START round=79 head_norm_before_train=2.154528 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=79 local utility u=0.001878 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9980360549692371, 'loss_val': 0.020871294038517924, 'psi': 0.9969854390700683}-{'f1_val': 0.9958716985726862, 'auprc': 0.9981426779619947, 'loss_val': 0.022466628502855506, 'psi': 0.9967800903284096}
[S13] START round=79 head_norm_before_train=1.957397 cos_to_last_merge=1.0000 (last merge round=76)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6282105602962987, 'auprc': 0.670603551994966, 'loss_val': 1.4019975244027991, 'psi': 0.6451677569757657}-{'f1_val': 0.734289718929182, 'auprc': 0.7491690095042696, 'loss_val': 0.9220792841045475, 'psi': 0.740241435159217}
[S14] START round=79 head_norm_before_train=1.752171 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=79 local utility u=0.000502 metrics={'f1_val': 0.9967480671851483, 'auprc': 0.9977629421223542, 'loss_val': 0.02820079259950922, 'psi': 0.9971540171600306}-{'f1_val': 0.9963442551067831, 'auprc': 0.9963265049430008, 'loss_val': 0.022473530708711702, 'psi': 0.9963371550412702}
[S15] START round=79 head_norm_before_train=1.883965 cos_to_last_merge=1.0000 (last merge round=77)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.7360627009264747, 'auprc': 0.9920423829772677, 'loss_val': 0.5403192152774537, 'psi': 0.8384545737467919}-{'f1_val': 0.7748560717717212, 'auprc': 0.9924492234832267, 'loss_val': 0.4724897252839177, 'psi': 0.8618933324563234}
[S16] START round=79 head_norm_before_train=1.759727 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.868883666539455, 'auprc': 0.9827755645346483, 'loss_val': 0.7267734321536805, 'psi': 0.9144404257375324}-{'f1_val': 0.9022767240418885, 'auprc': 0.9874564266189244, 'loss_val': 0.446611072436681, 'psi': 0.9363486050727029}
[S17] START round=79 head_norm_before_train=2.000799 cos_to_last_merge=0.9871 (last merge round=52)
[S17] round=79 local utility u=1.000000 metrics={'f1_val': 0.9067780300038313, 'auprc': 0.9883148566531986, 'loss_val': 0.4229186245458948, 'psi': 0.9393927606635781}-{'f1_val': 0.6410247979609764, 'auprc': 0.9857445009623833, 'loss_val': 1.328959202893502, 'psi': 0.7789126791615392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=80 psi=0.939 u=1.0000 p_local=0.3621 f1=0.907 auprc=0.988 bytes=59366
[S3]  timeout peer S2
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.940)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:44908
[S4] r=80 psi=0.940 u=0.0056 p_local=0.0071 f1=0.940 auprc=0.940 bytes=62893
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.914 u=0.0000 p_local=0.0974 f1=0.869 auprc=0.983 bytes=61112
[S2] r=80 psi=0.716 u=0.0000 p_local=0.0723 f1=0.701 auprc=0.738 bytes=55800
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] r=80 psi=0.877 u=0.0000 p_local=0.2012 f1=0.826 auprc=0.953 bytes=48597
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S6] r=80 psi=0.740 u=0.0000 p_local=0.1504 f1=0.608 auprc=0.939 bytes=57486
[S11] r=80 psi=0.997 u=0.0019 p_local=0.0990 f1=0.996 auprc=0.998 bytes=62941
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1792) from S14
[S16] cosine check vs S14: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=79 metric=0.9941 head_norm=1.968750
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.150758e-02
[S10] stored merged vector for next round verification (round=79)
[S10] DEBUG after merge:  round=79 metric=0.9941 head_norm=1.963048 delta_norm=0.011508
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=80 psi=0.995 u=0.0041 p_local=0.0014 f1=0.994 auprc=0.997 bytes=59424
[S14] r=80 psi=0.997 u=0.0005 p_local=0.0018 f1=0.997 auprc=0.998 bytes=64698
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9998
[S3] r=80 psi=0.972 u=0.0119 p_local=0.0873 f1=0.957 auprc=0.993 bytes=61222
[S8] r=80 psi=0.994 u=0.0000 p_local=0.0174 f1=0.990 auprc=0.999 bytes=59267
[S15] r=80 psi=0.838 u=0.0000 p_local=0.1333 f1=0.736 auprc=0.992 bytes=61240
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9930
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=79 metric=0.6282 head_norm=1.961395
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.164707e-02
[S13] stored merged vector for next round verification (round=79)
[S13] DEBUG after merge:  round=79 metric=0.6266 head_norm=1.965041 delta_norm=0.011647
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=80 psi=0.645 u=0.0000 p_local=0.2352 f1=0.628 auprc=0.671 bytes=59394
[S5] r=80 psi=0.997 u=0.0552 p_local=0.0127 f1=0.996 auprc=0.999 bytes=64787
[S2] START round=80 head_norm_before_train=1.887967 cos_to_last_merge=0.9999 (last merge round=77)
[S2] round=80 local utility u=0.072335 metrics={'f1_val': 0.7210564024063902, 'auprc': 0.7418779536081184, 'loss_val': 0.7849524882146957, 'psi': 0.7293850228870815}-{'f1_val': 0.701384337614418, 'auprc': 0.73760890589418, 'loss_val': 0.7987838806967941, 'psi': 0.7158741649263228}
[S3] START round=80 head_norm_before_train=2.054735 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=80 local utility u=0.065997 metrics={'f1_val': 0.9710375863641826, 'auprc': 0.9962442622628003, 'loss_val': 0.08685480150298933, 'psi': 0.9811202567236297}-{'f1_val': 0.9569535538876125, 'auprc': 0.993464053374467, 'loss_val': 0.1260046462769025, 'psi': 0.9715577536823543}
[S4] START round=80 head_norm_before_train=2.156616 cos_to_last_merge=1.0000 (last merge round=78)
[S4] round=80 local utility u=0.023728 metrics={'f1_val': 0.9430097189141861, 'auprc': 0.9475273500300142, 'loss_val': 0.32428932985622344, 'psi': 0.9448167713605173}-{'f1_val': 0.9401094864848731, 'auprc': 0.9397026894050664, 'loss_val': 0.33087064094237517, 'psi': 0.9399467676529504}
[S5] START round=80 head_norm_before_train=1.900584 cos_to_last_merge=0.9915 (last merge round=62)
[S5] round=80 local utility u=0.001742 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9994527332671452, 'loss_val': 0.022955708183548362, 'psi': 0.9975390844331142}-{'f1_val': 0.995895166894551, 'auprc': 0.999175781045732, 'loss_val': 0.023400648142960417, 'psi': 0.9972074125550234}
[S6] START round=80 head_norm_before_train=1.828305 cos_to_last_merge=0.9998 (last merge round=77)
[S6] round=80 local utility u=1.000000 metrics={'f1_val': 0.8878022095490594, 'auprc': 0.9647206237121706, 'loss_val': 0.2731437124039779, 'psi': 0.9185695752143039}-{'f1_val': 0.6075011773925898, 'auprc': 0.9391137137918868, 'loss_val': 1.0430354785601894, 'psi': 0.7401461919523087}
[S7] START round=80 head_norm_before_train=2.077889 cos_to_last_merge=0.9999 (last merge round=77)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.8261059006494138, 'auprc': 0.9459389646050769, 'loss_val': 0.9478020958795963, 'psi': 0.8740391262316791}-{'f1_val': 0.8264233566198105, 'auprc': 0.9529033839532691, 'loss_val': 0.9621642522232032, 'psi': 0.877015367553194}
[S8] START round=80 head_norm_before_train=1.822711 cos_to_last_merge=1.0000 (last merge round=77)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9846567949518252, 'auprc': 0.9988252890960175, 'loss_val': 0.04842686619624594, 'psi': 0.9903241926095021}-{'f1_val': 0.9900027071046373, 'auprc': 0.9990963648501205, 'loss_val': 0.03925816843028203, 'psi': 0.9936401702028306}
[S9] START round=80 head_norm_before_train=1.755893 cos_to_last_merge=0.9549 (last merge round=37)
[S9] round=80 local utility u=0.004688 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9956424946789268, 'loss_val': 0.01919864018294962, 'psi': 0.9961031092719033}-{'f1_val': 0.9962500947792776, 'auprc': 0.99310980355307, 'loss_val': 0.020015294936775608, 'psi': 0.9949939782887945}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=80 head_norm_before_train=1.963048 cos_to_last_merge=1.0000 (last merge round=79)
[S10] round=80 local utility u=0.001931 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9967992587391077, 'loss_val': 0.028469488527681566, 'psi': 0.9955688690272666}-{'f1_val': 0.9940903254969471, 'auprc': 0.9969312928795587, 'loss_val': 0.02877815068221443, 'psi': 0.9952267124499917}
[S11] START round=80 head_norm_before_train=2.158303 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9977843182779262, 'loss_val': 0.020558793834213177, 'psi': 0.996884744393544}-{'f1_val': 0.9962850284706224, 'auprc': 0.9980360549692371, 'loss_val': 0.020871294038517924, 'psi': 0.9969854390700683}
[S13] START round=80 head_norm_before_train=1.965041 cos_to_last_merge=1.0000 (last merge round=79)
[S13] round=80 local utility u=0.012705 metrics={'f1_val': 0.6271105534200049, 'auprc': 0.6752373450542236, 'loss_val': 1.3838888496926733, 'psi': 0.6463612700736924}-{'f1_val': 0.6282105602962987, 'auprc': 0.670603551994966, 'loss_val': 1.4019975244027991, 'psi': 0.6451677569757657}
[S14] START round=80 head_norm_before_train=1.756216 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=80 local utility u=0.005350 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9989310766257415, 'loss_val': 0.023376888589973867, 'psi': 0.9978584020881762}-{'f1_val': 0.9967480671851483, 'auprc': 0.9977629421223542, 'loss_val': 0.02820079259950922, 'psi': 0.9971540171600306}
[S15] START round=80 head_norm_before_train=1.894349 cos_to_last_merge=0.9999 (last merge round=77)
[S15] round=80 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9960220313988354, 'loss_val': 0.0249060656157174, 'psi': 0.9962082590688187}-{'f1_val': 0.7360627009264747, 'auprc': 0.9920423829772677, 'loss_val': 0.5403192152774537, 'psi': 0.8384545737467919}
[S16] START round=80 head_norm_before_train=1.766543 cos_to_last_merge=0.9999 (last merge round=75)
[S16] round=80 local utility u=0.726450 metrics={'f1_val': 0.9920144870514954, 'auprc': 0.9924058060871025, 'loss_val': 0.04154951953952067, 'psi': 0.9921710146657383}-{'f1_val': 0.868883666539455, 'auprc': 0.9827755645346483, 'loss_val': 0.7267734321536805, 'psi': 0.9144404257375324}
[S17] START round=80 head_norm_before_train=2.009916 cos_to_last_merge=0.9866 (last merge round=52)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.9006617565340883, 'auprc': 0.9810466493234664, 'loss_val': 0.4616477125376866, 'psi': 0.9328157136498396}-{'f1_val': 0.9067780300038313, 'auprc': 0.9883148566531986, 'loss_val': 0.4229186245458948, 'psi': 0.9393927606635781}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.981)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:44911
[S14] ⇄ pheromone p=0.003 → S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[S3] ⇄ pheromone p=0.083 → S7@127.0.0.1:44908
[S11] ⇄ pheromone p=0.079 → S4@127.0.0.1:44904
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=80 metric=0.8261 head_norm=2.097219
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.561707e-02
[S7] stored merged vector for next round verification (round=80)
[S7] DEBUG after merge:  round=80 metric=0.8266 head_norm=2.075780 delta_norm=0.035617
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.161 → S3@127.0.0.1:44903
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9996
[S13] ⇄ pheromone p=0.191 → S10@127.0.0.1:44911
[S6] ⇄ pheromone p=0.320 → S8@127.0.0.1:44909
[S4] ⇄ pheromone p=0.010 → S11@127.0.0.1:44912
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S15
[S2] cosine check vs S15: cos=0.9991
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=80 metric=0.9847 head_norm=1.827914
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.593938e-02
[S8] stored merged vector for next round verification (round=80)
[S8] DEBUG after merge:  round=80 metric=0.9847 head_norm=1.830122 delta_norm=0.025939
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.014 → S6@127.0.0.1:44907
[S5] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=80 metric=0.9947 head_norm=1.970335
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.784926e-03
[S10] stored merged vector for next round verification (round=80)
[S10] DEBUG after merge:  round=80 metric=0.9947 head_norm=1.969833 delta_norm=0.004785
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] ⇄ pheromone p=0.011 → S15@127.0.0.1:44915
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=80 metric=0.9920 head_norm=1.771248
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.522317e-02
[S16] stored merged vector for next round verification (round=80)
[S16] DEBUG after merge:  round=80 metric=0.9920 head_norm=1.763683 delta_norm=0.015223
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.223 → S14@127.0.0.1:44914
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=80 metric=0.9963 head_norm=1.903630
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.280148e-02
[S15] stored merged vector for next round verification (round=80)
[S15] DEBUG after merge:  round=80 metric=0.9963 head_norm=1.898443 delta_norm=0.042801
[S15] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.307 → S2@127.0.0.1:44902
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=80 metric=0.7211 head_norm=1.899399
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.088026e-02
[S2] stored merged vector for next round verification (round=80)
[S2] DEBUG after merge:  round=80 metric=0.7209 head_norm=1.901077 delta_norm=0.040880
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.072 → S15@127.0.0.1:44915
[S2] START round=81 head_norm_before_train=1.901077 cos_to_last_merge=1.0000 (last merge round=80)
[S2] round=81 local utility u=0.031697 metrics={'f1_val': 0.7170613771723706, 'auprc': 0.7534974829042916, 'loss_val': 0.7324464500004586, 'psi': 0.7316358194651391}-{'f1_val': 0.7210564024063902, 'auprc': 0.7418779536081184, 'loss_val': 0.7849524882146957, 'psi': 0.7293850228870815}
[S3] START round=81 head_norm_before_train=2.060479 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9923110549367611, 'loss_val': 0.16263724992763035, 'psi': 0.9735218744544061}-{'f1_val': 0.9710375863641826, 'auprc': 0.9962442622628003, 'loss_val': 0.08685480150298933, 'psi': 0.9811202567236297}
[S4] START round=81 head_norm_before_train=2.157105 cos_to_last_merge=0.9999 (last merge round=78)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9422906755382937, 'auprc': 0.9483691497207465, 'loss_val': 0.3267283224789047, 'psi': 0.9447220652112749}-{'f1_val': 0.9430097189141861, 'auprc': 0.9475273500300142, 'loss_val': 0.32428932985622344, 'psi': 0.9448167713605173}
[S5] START round=81 head_norm_before_train=1.906996 cos_to_last_merge=0.9910 (last merge round=62)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9966029359827371, 'loss_val': 0.02414200796530983, 'psi': 0.9961782745298254}-{'f1_val': 0.9962633185437604, 'auprc': 0.9994527332671452, 'loss_val': 0.022955708183548362, 'psi': 0.9975390844331142}
[S6] START round=81 head_norm_before_train=1.832694 cos_to_last_merge=0.9997 (last merge round=77)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.7509955171874929, 'auprc': 0.9608753154913232, 'loss_val': 0.5846454306045551, 'psi': 0.834947436509025}-{'f1_val': 0.8878022095490594, 'auprc': 0.9647206237121706, 'loss_val': 0.2731437124039779, 'psi': 0.9185695752143039}
[S7] START round=81 head_norm_before_train=2.075780 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=81 local utility u=0.410171 metrics={'f1_val': 0.8828819256569678, 'auprc': 0.9571423247931725, 'loss_val': 0.5017271515000236, 'psi': 0.9125860853114497}-{'f1_val': 0.8261059006494138, 'auprc': 0.9459389646050769, 'loss_val': 0.9478020958795963, 'psi': 0.8740391262316791}
[S8] START round=81 head_norm_before_train=1.830122 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=81 local utility u=0.033533 metrics={'f1_val': 0.9932431880504957, 'auprc': 0.9992149749978385, 'loss_val': 0.0340478023705472, 'psi': 0.9956319028294328}-{'f1_val': 0.9846567949518252, 'auprc': 0.9988252890960175, 'loss_val': 0.04842686619624594, 'psi': 0.9903241926095021}
[S9] START round=81 head_norm_before_train=1.761476 cos_to_last_merge=0.9542 (last merge round=37)
[S9] round=81 local utility u=0.001715 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9987782484370135, 'loss_val': 0.020348293240419802, 'psi': 0.9968745661717056}-{'f1_val': 0.9964101856672208, 'auprc': 0.9956424946789268, 'loss_val': 0.01919864018294962, 'psi': 0.9961031092719033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=81 head_norm_before_train=1.969833 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9963615442481185, 'loss_val': 0.029111823423399064, 'psi': 0.9948672453295744}-{'f1_val': 0.9947486092193725, 'auprc': 0.9967992587391077, 'loss_val': 0.028469488527681566, 'psi': 0.9955688690272666}
[S11] START round=81 head_norm_before_train=2.163323 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=81 local utility u=0.001867 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9987085186123787, 'loss_val': 0.019717405106475582, 'psi': 0.9972665079262681}-{'f1_val': 0.9962850284706224, 'auprc': 0.9977843182779262, 'loss_val': 0.020558793834213177, 'psi': 0.996884744393544}
[S13] START round=81 head_norm_before_train=1.969342 cos_to_last_merge=1.0000 (last merge round=79)
[S13] round=81 local utility u=0.785159 metrics={'f1_val': 0.7360524067885924, 'auprc': 0.7766783305173595, 'loss_val': 0.7715458297595456, 'psi': 0.7523027762800992}-{'f1_val': 0.6271105534200049, 'auprc': 0.6752373450542236, 'loss_val': 1.3838888496926733, 'psi': 0.6463612700736924}
[S14] START round=81 head_norm_before_train=1.759851 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.998469128461733, 'loss_val': 0.02316331530756443, 'psi': 0.9976736228225728}-{'f1_val': 0.9971432857297993, 'auprc': 0.9989310766257415, 'loss_val': 0.023376888589973867, 'psi': 0.9978584020881762}
[S15] START round=81 head_norm_before_train=1.898443 cos_to_last_merge=1.0000 (last merge round=80)
[S15] round=81 local utility u=0.000333 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9961463429739719, 'loss_val': 0.024612771602624067, 'psi': 0.9962579836988733}-{'f1_val': 0.9963324108488076, 'auprc': 0.9960220313988354, 'loss_val': 0.0249060656157174, 'psi': 0.9962082590688187}
[S16] START round=81 head_norm_before_train=1.763683 cos_to_last_merge=1.0000 (last merge round=80)
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9917175676316579, 'auprc': 0.984766480626425, 'loss_val': 0.05117159945116614, 'psi': 0.9889371328295647}-{'f1_val': 0.9920144870514954, 'auprc': 0.9924058060871025, 'loss_val': 0.04154951953952067, 'psi': 0.9921710146657383}
[S17] START round=81 head_norm_before_train=2.018168 cos_to_last_merge=0.9862 (last merge round=52)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.7447517337265144, 'auprc': 0.960645276388914, 'loss_val': 0.9912078373468733, 'psi': 0.8311091507914742}-{'f1_val': 0.9006617565340883, 'auprc': 0.9810466493234664, 'loss_val': 0.4616477125376866, 'psi': 0.9328157136498396}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.732)
[S13] not sending this round → trigger blocked (psi=0.752)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=81 metric=0.9971 head_norm=1.764277
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.573881e-02
[S14] stored merged vector for next round verification (round=81)
[S14] DEBUG after merge:  round=81 metric=0.9971 head_norm=1.767696 delta_norm=0.015739
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9997
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=81 metric=0.9963 head_norm=2.167201
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.898248e-02
[S11] stored merged vector for next round verification (round=81)
[S11] DEBUG after merge:  round=81 metric=0.9963 head_norm=2.162076 delta_norm=0.018982
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=0.9999
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=1.912861 cos_to_last_merge=1.0000 (last merge round=80)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.6993567587150401, 'auprc': 0.7663731418391762, 'loss_val': 0.7692296249723856, 'psi': 0.7261633119646945}-{'f1_val': 0.7170613771723706, 'auprc': 0.7534974829042916, 'loss_val': 0.7324464500004586, 'psi': 0.7316358194651391}
[S3] START round=82 head_norm_before_train=2.064265 cos_to_last_merge=0.9999 (last merge round=77)
[S3] round=82 local utility u=0.180300 metrics={'f1_val': 0.9944581232376073, 'auprc': 0.9983257668885962, 'loss_val': 0.02085568309692986, 'psi': 0.9960051806980028}-{'f1_val': 0.960995754132836, 'auprc': 0.9923110549367611, 'loss_val': 0.16263724992763035, 'psi': 0.9735218744544061}
[S4] START round=82 head_norm_before_train=2.161116 cos_to_last_merge=0.9998 (last merge round=78)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9387489678854698, 'auprc': 0.9460437774489213, 'loss_val': 0.3460024890633727, 'psi': 0.9416668917108504}-{'f1_val': 0.9422906755382937, 'auprc': 0.9483691497207465, 'loss_val': 0.3267283224789047, 'psi': 0.9447220652112749}
[S5] START round=82 head_norm_before_train=1.915781 cos_to_last_merge=0.9905 (last merge round=62)
[S5] round=82 local utility u=0.005492 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9988251469947605, 'loss_val': 0.022457306045810886, 'psi': 0.9973303459760383}-{'f1_val': 0.995895166894551, 'auprc': 0.9966029359827371, 'loss_val': 0.02414200796530983, 'psi': 0.9961782745298254}
[S6] START round=82 head_norm_before_train=1.837349 cos_to_last_merge=0.9997 (last merge round=77)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.6461482256627088, 'auprc': 0.8948986468845986, 'loss_val': 0.8096303037707324, 'psi': 0.7456483941514648}-{'f1_val': 0.7509955171874929, 'auprc': 0.9608753154913232, 'loss_val': 0.5846454306045551, 'psi': 0.834947436509025}
[S7] START round=82 head_norm_before_train=2.086851 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.8562609887779604, 'auprc': 0.9753294489598292, 'loss_val': 0.6682250177384064, 'psi': 0.9038883728507079}-{'f1_val': 0.8828819256569678, 'auprc': 0.9571423247931725, 'loss_val': 0.5017271515000236, 'psi': 0.9125860853114497}
[S8] START round=82 head_norm_before_train=1.834076 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.8129421312131124, 'auprc': 0.9988325508025485, 'loss_val': 0.4115461719028601, 'psi': 0.8872982990488869}-{'f1_val': 0.9932431880504957, 'auprc': 0.9992149749978385, 'loss_val': 0.0340478023705472, 'psi': 0.9956319028294328}
[S9] START round=82 head_norm_before_train=1.767080 cos_to_last_merge=0.9539 (last merge round=37)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9956337177945711, 'loss_val': 0.019036451416385564, 'psi': 0.9963650383731828}-{'f1_val': 0.9956054446615002, 'auprc': 0.9987782484370135, 'loss_val': 0.020348293240419802, 'psi': 0.9968745661717056}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=1.977154 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9955579583097979, 'loss_val': 0.02956892002838924, 'psi': 0.9947942971142413}-{'f1_val': 0.993871046050545, 'auprc': 0.9963615442481185, 'loss_val': 0.029111823423399064, 'psi': 0.9948672453295744}
[S11] START round=82 head_norm_before_train=2.162076 cos_to_last_merge=1.0000 (last merge round=81)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9985680062525928, 'loss_val': 0.02000520236993202, 'psi': 0.9972103029823537}-{'f1_val': 0.996305167468861, 'auprc': 0.9987085186123787, 'loss_val': 0.019717405106475582, 'psi': 0.9972665079262681}
[S13] START round=82 head_norm_before_train=1.975328 cos_to_last_merge=1.0000 (last merge round=79)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.599224049432162, 'auprc': 0.6474090377981102, 'loss_val': 1.5426816332257578, 'psi': 0.6184980447785413}-{'f1_val': 0.7360524067885924, 'auprc': 0.7766783305173595, 'loss_val': 0.7715458297595456, 'psi': 0.7523027762800992}
[S14] START round=82 head_norm_before_train=1.767696 cos_to_last_merge=1.0000 (last merge round=81)
[S14] round=82 local utility u=0.000407 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9987503303083901, 'loss_val': 0.02072918331424703, 'psi': 0.9975396466227526}-{'f1_val': 0.9971432857297993, 'auprc': 0.998469128461733, 'loss_val': 0.02316331530756443, 'psi': 0.9976736228225728}
[S15] START round=82 head_norm_before_train=1.907797 cos_to_last_merge=1.0000 (last merge round=80)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.8805428119338987, 'auprc': 0.9931848076748272, 'loss_val': 0.2850568659133609, 'psi': 0.9255996102302702}-{'f1_val': 0.9963324108488076, 'auprc': 0.9961463429739719, 'loss_val': 0.024612771602624067, 'psi': 0.9962579836988733}
[S16] START round=82 head_norm_before_train=1.768917 cos_to_last_merge=1.0000 (last merge round=80)
[S16] round=82 local utility u=0.015765 metrics={'f1_val': 0.9924534357373314, 'auprc': 0.9903585871341456, 'loss_val': 0.0408328034490949, 'psi': 0.991615496296057}-{'f1_val': 0.9917175676316579, 'auprc': 0.984766480626425, 'loss_val': 0.05117159945116614, 'psi': 0.9889371328295647}
[S17] START round=82 head_norm_before_train=2.028523 cos_to_last_merge=0.9857 (last merge round=52)
[S17] round=82 local utility u=0.195514 metrics={'f1_val': 0.8011881890581274, 'auprc': 0.9250785824557625, 'loss_val': 0.8320975433604123, 'psi': 0.8507443464171814}-{'f1_val': 0.7447517337265144, 'auprc': 0.960645276388914, 'loss_val': 0.9912078373468733, 'psi': 0.8311091507914742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=82 metric=0.6461 head_norm=1.842808
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.710528e-02
[S6] stored merged vector for next round verification (round=82)
[S6] DEBUG after merge:  round=82 metric=0.6509 head_norm=1.838368 delta_norm=0.017105
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=82 metric=0.9387 head_norm=2.158881
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.006166e-02
[S4] stored merged vector for next round verification (round=82)
[S4] DEBUG after merge:  round=82 metric=0.9387 head_norm=2.162836 delta_norm=0.030062
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] cosine check vs S3: cos=0.9995
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=82 metric=0.9967 head_norm=1.773508
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.570815e-03
[S14] stored merged vector for next round verification (round=82)
[S14] DEBUG after merge:  round=82 metric=0.9967 head_norm=1.773849 delta_norm=0.007571
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=82 metric=0.9945 head_norm=2.069623
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.873423e-02
[S3] stored merged vector for next round verification (round=82)
[S3] DEBUG after merge:  round=82 metric=0.9945 head_norm=2.078056 delta_norm=0.028734
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=82 metric=0.9925 head_norm=1.774223
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.570812e-03
[S16] stored merged vector for next round verification (round=82)
[S16] DEBUG after merge:  round=82 metric=0.9925 head_norm=1.773849 delta_norm=0.007571
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9942
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=82 metric=0.8563 head_norm=2.103985
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.677877e-02
[S7] stored merged vector for next round verification (round=82)
[S7] DEBUG after merge:  round=82 metric=0.8565 head_norm=2.086550 delta_norm=0.036779
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=82 metric=0.8805 head_norm=1.917110
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.034347e-01
[S15] stored merged vector for next round verification (round=82)
[S15] DEBUG after merge:  round=82 metric=0.8805 head_norm=1.916744 delta_norm=0.103435
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=1.923830 cos_to_last_merge=0.9999 (last merge round=80)
[S2] round=83 local utility u=0.093070 metrics={'f1_val': 0.7149123349320363, 'auprc': 0.7796740886452147, 'loss_val': 0.716326766028812, 'psi': 0.7408170364173077}-{'f1_val': 0.6993567587150401, 'auprc': 0.7663731418391762, 'loss_val': 0.7692296249723856, 'psi': 0.7261633119646945}
[S3] START round=83 head_norm_before_train=2.078056 cos_to_last_merge=1.0000 (last merge round=82)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9946658673106226, 'loss_val': 0.15100073279428364, 'psi': 0.9744637994039507}-{'f1_val': 0.9944581232376073, 'auprc': 0.9983257668885962, 'loss_val': 0.02085568309692986, 'psi': 0.9960051806980028}
[S4] START round=83 head_norm_before_train=2.162836 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=83 local utility u=0.055467 metrics={'f1_val': 0.9456619165345558, 'auprc': 0.9633056283849954, 'loss_val': 0.32833242777411115, 'psi': 0.9527194012747316}-{'f1_val': 0.9387489678854698, 'auprc': 0.9460437774489213, 'loss_val': 0.3460024890633727, 'psi': 0.9416668917108504}
[S5] START round=83 head_norm_before_train=1.921953 cos_to_last_merge=0.9899 (last merge round=62)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.7158060605638769, 'auprc': 0.9899442809337371, 'loss_val': 0.4431228606529951, 'psi': 0.825461348711821}-{'f1_val': 0.9963338119635569, 'auprc': 0.9988251469947605, 'loss_val': 0.022457306045810886, 'psi': 0.9973303459760383}
[S6] START round=83 head_norm_before_train=1.838368 cos_to_last_merge=1.0000 (last merge round=82)
[S6] round=83 local utility u=0.541666 metrics={'f1_val': 0.7739617216200533, 'auprc': 0.904954883629432, 'loss_val': 0.5233476288021387, 'psi': 0.8263589864238048}-{'f1_val': 0.6461482256627088, 'auprc': 0.8948986468845986, 'loss_val': 0.8096303037707324, 'psi': 0.7456483941514648}
[S7] START round=83 head_norm_before_train=2.086550 cos_to_last_merge=1.0000 (last merge round=82)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.7689163544622206, 'auprc': 0.9816198118361497, 'loss_val': 0.9610018335386975, 'psi': 0.8539977374117922}-{'f1_val': 0.8562609887779604, 'auprc': 0.9753294489598292, 'loss_val': 0.6682250177384064, 'psi': 0.9038883728507079}
[S8] START round=83 head_norm_before_train=1.839221 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=83 local utility u=0.628555 metrics={'f1_val': 0.9683597781172911, 'auprc': 0.9981777468704607, 'loss_val': 0.08497695015845508, 'psi': 0.9802869656185589}-{'f1_val': 0.8129421312131124, 'auprc': 0.9988325508025485, 'loss_val': 0.4115461719028601, 'psi': 0.8872982990488869}
[S9] START round=83 head_norm_before_train=1.771374 cos_to_last_merge=0.9533 (last merge round=37)
[S9] round=83 local utility u=0.003122 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9987632172463594, 'loss_val': 0.01952598571834262, 'psi': 0.9973513982988763}-{'f1_val': 0.9968525854255906, 'auprc': 0.9956337177945711, 'loss_val': 0.019036451416385564, 'psi': 0.9963650383731828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=83 head_norm_before_train=1.984343 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9959144145382166, 'loss_val': 0.02933514265266798, 'psi': 0.9946883934456137}-{'f1_val': 0.9942851896505369, 'auprc': 0.9955579583097979, 'loss_val': 0.02956892002838924, 'psi': 0.9947942971142413}
[S11] START round=83 head_norm_before_train=2.167567 cos_to_last_merge=1.0000 (last merge round=81)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9983469299788026, 'loss_val': 0.020091162866502137, 'psi': 0.9971097890738945}-{'f1_val': 0.996305167468861, 'auprc': 0.9985680062525928, 'loss_val': 0.02000520236993202, 'psi': 0.9972103029823537}
[S13] START round=83 head_norm_before_train=1.980062 cos_to_last_merge=1.0000 (last merge round=79)
[S13] round=83 local utility u=0.510037 metrics={'f1_val': 0.6666746842567159, 'auprc': 0.7588809475140001, 'loss_val': 1.2617276139640805, 'psi': 0.7035571895596295}-{'f1_val': 0.599224049432162, 'auprc': 0.6474090377981102, 'loss_val': 1.5426816332257578, 'psi': 0.6184980447785413}
[S14] START round=83 head_norm_before_train=1.773849 cos_to_last_merge=1.0000 (last merge round=82)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9991468739850868, 'loss_val': 0.02045558047137051, 'psi': 0.9974657601155472}-{'f1_val': 0.9967325241656609, 'auprc': 0.9987503303083901, 'loss_val': 0.02072918331424703, 'psi': 0.9975396466227526}
[S15] START round=83 head_norm_before_train=1.916744 cos_to_last_merge=1.0000 (last merge round=82)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.7708440959263942, 'auprc': 0.9904219218429736, 'loss_val': 0.46767822326950076, 'psi': 0.858675226293026}-{'f1_val': 0.8805428119338987, 'auprc': 0.9931848076748272, 'loss_val': 0.2850568659133609, 'psi': 0.9255996102302702}
[S16] START round=83 head_norm_before_train=1.773849 cos_to_last_merge=1.0000 (last merge round=82)
[S16] round=83 local utility u=0.003371 metrics={'f1_val': 0.9927032863016021, 'auprc': 0.9915576872012211, 'loss_val': 0.039187395119551854, 'psi': 0.9922450466614496}-{'f1_val': 0.9924534357373314, 'auprc': 0.9903585871341456, 'loss_val': 0.0408328034490949, 'psi': 0.991615496296057}
[S17] START round=83 head_norm_before_train=2.038227 cos_to_last_merge=0.9851 (last merge round=52)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.7003079367731249, 'auprc': 0.9400684525171966, 'loss_val': 1.1744905168223472, 'psi': 0.7962121430707536}-{'f1_val': 0.8011881890581274, 'auprc': 0.9250785824557625, 'loss_val': 0.8320975433604123, 'psi': 0.8507443464171814}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.9949
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9999
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=83 metric=0.7708 head_norm=1.926128
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.797090e-02
[S15] stored merged vector for next round verification (round=83)
[S15] DEBUG after merge:  round=83 metric=0.7708 head_norm=1.927661 delta_norm=0.097971
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=83 metric=0.7740 head_norm=1.845838
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.243358e-02
[S6] stored merged vector for next round verification (round=83)
[S6] DEBUG after merge:  round=83 metric=0.7746 head_norm=1.845388 delta_norm=0.012434
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=83 metric=0.9684 head_norm=1.845022
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.243356e-02
[S8] stored merged vector for next round verification (round=83)
[S8] DEBUG after merge:  round=83 metric=0.9700 head_norm=1.845388 delta_norm=0.012434
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=1.934161 cos_to_last_merge=0.9998 (last merge round=80)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7197874011542124, 'auprc': 0.7528934681643522, 'loss_val': 0.7827403163506788, 'psi': 0.7330298279582683}-{'f1_val': 0.7149123349320363, 'auprc': 0.7796740886452147, 'loss_val': 0.716326766028812, 'psi': 0.7408170364173077}
[S3] START round=84 head_norm_before_train=2.084596 cos_to_last_merge=1.0000 (last merge round=82)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9943206806686112, 'loss_val': 0.15144792382960443, 'psi': 0.9743257247471462}-{'f1_val': 0.960995754132836, 'auprc': 0.9946658673106226, 'loss_val': 0.15100073279428364, 'psi': 0.9744637994039507}
[S4] START round=84 head_norm_before_train=2.160582 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9412115891905563, 'auprc': 0.9484488369749066, 'loss_val': 0.33070574186508184, 'psi': 0.9441064883042964}-{'f1_val': 0.9456619165345558, 'auprc': 0.9633056283849954, 'loss_val': 0.32833242777411115, 'psi': 0.9527194012747316}
[S5] START round=84 head_norm_before_train=1.926587 cos_to_last_merge=0.9894 (last merge round=62)
[S5] round=84 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936238205955905, 'loss_val': 0.02314811252636735, 'psi': 0.9954707093253108}-{'f1_val': 0.7158060605638769, 'auprc': 0.9899442809337371, 'loss_val': 0.4431228606529951, 'psi': 0.825461348711821}
[S6] START round=84 head_norm_before_train=1.845388 cos_to_last_merge=1.0000 (last merge round=83)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.7016178530209357, 'auprc': 0.9185761459624251, 'loss_val': 0.7836123720520316, 'psi': 0.7884011701975315}-{'f1_val': 0.7739617216200533, 'auprc': 0.904954883629432, 'loss_val': 0.5233476288021387, 'psi': 0.8263589864238048}
[S7] START round=84 head_norm_before_train=2.104746 cos_to_last_merge=1.0000 (last merge round=82)
[S7] round=84 local utility u=0.440983 metrics={'f1_val': 0.8649433032803564, 'auprc': 0.9742467942926184, 'loss_val': 0.6330794405846284, 'psi': 0.9086646996852612}-{'f1_val': 0.7689163544622206, 'auprc': 0.9816198118361497, 'loss_val': 0.9610018335386975, 'psi': 0.8539977374117922}
[S8] START round=84 head_norm_before_train=1.845388 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=84 local utility u=0.022508 metrics={'f1_val': 0.9730946342280502, 'auprc': 0.9990414768407886, 'loss_val': 0.07096145486006174, 'psi': 0.9834733712731456}-{'f1_val': 0.9683597781172911, 'auprc': 0.9981777468704607, 'loss_val': 0.08497695015845508, 'psi': 0.9802869656185589}
[S9] START round=84 head_norm_before_train=1.774373 cos_to_last_merge=0.9531 (last merge round=37)
[S9] round=84 local utility u=0.000020 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.998754210033618, 'loss_val': 0.0194583623075598, 'psi': 0.9973477954137797}-{'f1_val': 0.9964101856672208, 'auprc': 0.9987632172463594, 'loss_val': 0.01952598571834262, 'psi': 0.9973513982988763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=84 head_norm_before_train=1.990941 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=84 local utility u=0.001726 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9965742764386948, 'loss_val': 0.02917769343792627, 'psi': 0.9950839058736461}-{'f1_val': 0.993871046050545, 'auprc': 0.9959144145382166, 'loss_val': 0.02933514265266798, 'psi': 0.9946883934456137}
[S11] START round=84 head_norm_before_train=2.171008 cos_to_last_merge=1.0000 (last merge round=81)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987557598258927, 'loss_val': 0.020638542418112468, 'psi': 0.9970253230739688}-{'f1_val': 0.9962850284706224, 'auprc': 0.9983469299788026, 'loss_val': 0.020091162866502137, 'psi': 0.9971097890738945}
[S13] START round=84 head_norm_before_train=1.984090 cos_to_last_merge=0.9999 (last merge round=79)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6256551615207073, 'auprc': 0.653455139997086, 'loss_val': 1.2948932303813137, 'psi': 0.6367751529112589}-{'f1_val': 0.6666746842567159, 'auprc': 0.7588809475140001, 'loss_val': 1.2617276139640805, 'psi': 0.7035571895596295}
[S14] START round=84 head_norm_before_train=1.777274 cos_to_last_merge=1.0000 (last merge round=82)
[S14] round=84 local utility u=0.000687 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9990538174548558, 'loss_val': 0.02114783092858475, 'psi': 0.9976630477921956}-{'f1_val': 0.996345017535854, 'auprc': 0.9991468739850868, 'loss_val': 0.02045558047137051, 'psi': 0.9974657601155472}
[S15] START round=84 head_norm_before_train=1.927661 cos_to_last_merge=1.0000 (last merge round=83)
[S15] round=84 local utility u=0.086607 metrics={'f1_val': 0.7959496854027679, 'auprc': 0.9921815747795278, 'loss_val': 0.4503775396191111, 'psi': 0.8744424411534719}-{'f1_val': 0.7708440959263942, 'auprc': 0.9904219218429736, 'loss_val': 0.46767822326950076, 'psi': 0.858675226293026}
[S16] START round=84 head_norm_before_train=1.780219 cos_to_last_merge=1.0000 (last merge round=82)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9916380718119093, 'auprc': 0.9825883921812948, 'loss_val': 0.04479717638621552, 'psi': 0.9880181999596636}-{'f1_val': 0.9927032863016021, 'auprc': 0.9915576872012211, 'loss_val': 0.039187395119551854, 'psi': 0.9922450466614496}
[S17] START round=84 head_norm_before_train=2.045208 cos_to_last_merge=0.9848 (last merge round=52)
[S17] round=84 local utility u=0.167018 metrics={'f1_val': 0.7411789804218254, 'auprc': 0.9306598464623548, 'loss_val': 1.0574550262250997, 'psi': 0.8169713268380372}-{'f1_val': 0.7003079367731249, 'auprc': 0.9400684525171966, 'loss_val': 1.1744905168223472, 'psi': 0.7962121430707536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:44913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:44903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=84 metric=0.9959 head_norm=2.175282
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.407371e-02
[S11] stored merged vector for next round verification (round=84)
[S11] DEBUG after merge:  round=84 metric=0.9959 head_norm=2.167811 delta_norm=0.024074
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=84 metric=0.9941 head_norm=1.995810
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.767612e-02
[S10] stored merged vector for next round verification (round=84)
[S10] DEBUG after merge:  round=84 metric=0.9941 head_norm=1.989880 delta_norm=0.017676
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=84 metric=0.9967 head_norm=1.780030
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.578048e-03
[S14] stored merged vector for next round verification (round=84)
[S14] DEBUG after merge:  round=84 metric=0.9967 head_norm=1.780112 delta_norm=0.006578
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1797) from S15
[S2] cosine check vs S15: cos=0.9986
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9938
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=84 metric=0.7959 head_norm=1.937170
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.077422e-01
[S15] stored merged vector for next round verification (round=84)
[S15] DEBUG after merge:  round=84 metric=0.7951 head_norm=1.931593 delta_norm=0.107742
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:44907
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=84 metric=0.6257 head_norm=1.987056
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.785991e-02
[S13] stored merged vector for next round verification (round=84)
[S13] DEBUG after merge:  round=84 metric=0.6244 head_norm=1.991358 delta_norm=0.017860
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=1.0000
[S2] START round=85 head_norm_before_train=1.943518 cos_to_last_merge=0.9997 (last merge round=80)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7206996160839734, 'auprc': 0.7519092225293206, 'loss_val': 0.7967661553837003, 'psi': 0.7331834586621122}-{'f1_val': 0.7197874011542124, 'auprc': 0.7528934681643522, 'loss_val': 0.7827403163506788, 'psi': 0.7330298279582683}
[S3] START round=85 head_norm_before_train=2.091554 cos_to_last_merge=1.0000 (last merge round=82)
[S3] round=85 local utility u=0.173969 metrics={'f1_val': 0.9954643553242586, 'auprc': 0.9987358286700166, 'loss_val': 0.023566945734047537, 'psi': 0.9967729446625617}-{'f1_val': 0.960995754132836, 'auprc': 0.9943206806686112, 'loss_val': 0.15144792382960443, 'psi': 0.9743257247471462}
[S4] START round=85 head_norm_before_train=2.160372 cos_to_last_merge=0.9999 (last merge round=82)
[S4] round=85 local utility u=0.001834 metrics={'f1_val': 0.9403374238583864, 'auprc': 0.9493395854025155, 'loss_val': 0.32446434890922926, 'psi': 0.943938288476038}-{'f1_val': 0.9412115891905563, 'auprc': 0.9484488369749066, 'loss_val': 0.33070574186508184, 'psi': 0.9441064883042964}
[S5] START round=85 head_norm_before_train=1.932017 cos_to_last_merge=0.9888 (last merge round=62)
[S5] round=85 local utility u=0.006083 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9975570727895489, 'loss_val': 0.02278103952407828, 'psi': 0.9970440102028941}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936238205955905, 'loss_val': 0.02314811252636735, 'psi': 0.9954707093253108}
[S6] START round=85 head_norm_before_train=1.852014 cos_to_last_merge=1.0000 (last merge round=83)
[S6] round=85 local utility u=0.783096 metrics={'f1_val': 0.8612622714540902, 'auprc': 0.9617167965961702, 'loss_val': 0.3047081354225607, 'psi': 0.9014440815109221}-{'f1_val': 0.7016178530209357, 'auprc': 0.9185761459624251, 'loss_val': 0.7836123720520316, 'psi': 0.7884011701975315}
[S7] START round=85 head_norm_before_train=2.125623 cos_to_last_merge=0.9999 (last merge round=82)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.846562646869637, 'auprc': 0.9493899447885742, 'loss_val': 0.8092497896328622, 'psi': 0.8876935660372118}-{'f1_val': 0.8649433032803564, 'auprc': 0.9742467942926184, 'loss_val': 0.6330794405846284, 'psi': 0.9086646996852612}
[S8] START round=85 head_norm_before_train=1.849662 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.8521845027719455, 'auprc': 0.997414941632425, 'loss_val': 0.2884060260750151, 'psi': 0.9102766783161373}-{'f1_val': 0.9730946342280502, 'auprc': 0.9990414768407886, 'loss_val': 0.07096145486006174, 'psi': 0.9834733712731456}
[S9] START round=85 head_norm_before_train=1.777674 cos_to_last_merge=0.9523 (last merge round=37)
[S9] round=85 local utility u=0.000144 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983686391524045, 'loss_val': 0.019515605058291724, 'psi': 0.9973437627492967}-{'f1_val': 0.9964101856672208, 'auprc': 0.998754210033618, 'loss_val': 0.0194583623075598, 'psi': 0.9973477954137797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=85 head_norm_before_train=1.989880 cos_to_last_merge=1.0000 (last merge round=84)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9969959829837062, 'loss_val': 0.029578675271206348, 'psi': 0.9951210208238095}-{'f1_val': 0.9940903254969471, 'auprc': 0.9965742764386948, 'loss_val': 0.02917769343792627, 'psi': 0.9950839058736461}
[S11] START round=85 head_norm_before_train=2.167811 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9988297798324566, 'loss_val': 0.02109702774082083, 'psi': 0.9970549310765944}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987557598258927, 'loss_val': 0.020638542418112468, 'psi': 0.9970253230739688}
[S13] START round=85 head_norm_before_train=1.991358 cos_to_last_merge=1.0000 (last merge round=84)
[S13] round=85 local utility u=0.615094 metrics={'f1_val': 0.7211269523199951, 'auprc': 0.7971204470879198, 'loss_val': 1.068531792738507, 'psi': 0.751524350227165}-{'f1_val': 0.6256551615207073, 'auprc': 0.653455139997086, 'loss_val': 1.2948932303813137, 'psi': 0.6367751529112589}
[S14] START round=85 head_norm_before_train=1.780112 cos_to_last_merge=1.0000 (last merge round=84)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9984137432212868, 'loss_val': 0.021377391995465508, 'psi': 0.9974050117879113}-{'f1_val': 0.9967358680170888, 'auprc': 0.9990538174548558, 'loss_val': 0.02114783092858475, 'psi': 0.9976630477921956}
[S15] START round=85 head_norm_before_train=1.931593 cos_to_last_merge=1.0000 (last merge round=84)
[S15] round=85 local utility u=0.309152 metrics={'f1_val': 0.8732226390876374, 'auprc': 0.9930409357733988, 'loss_val': 0.2982889110448726, 'psi': 0.921149957761942}-{'f1_val': 0.7959496854027679, 'auprc': 0.9921815747795278, 'loss_val': 0.4503775396191111, 'psi': 0.8744424411534719}
[S16] START round=85 head_norm_before_train=1.785741 cos_to_last_merge=1.0000 (last merge round=82)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9551798479624896, 'auprc': 0.9748295973471665, 'loss_val': 0.11940474611696793, 'psi': 0.9630397477163604}-{'f1_val': 0.9916380718119093, 'auprc': 0.9825883921812948, 'loss_val': 0.04479717638621552, 'psi': 0.9880181999596636}
[S17] START round=85 head_norm_before_train=2.050621 cos_to_last_merge=0.9846 (last merge round=52)
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6572872537086285, 'auprc': 0.9750611058717793, 'loss_val': 1.3331361501549932, 'psi': 0.7843967945738888}-{'f1_val': 0.7411789804218254, 'auprc': 0.9306598464623548, 'loss_val': 1.0574550262250997, 'psi': 0.8169713268380372}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44908
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] ⇄ pheromone p=0.026 → S4@127.0.0.1:44904
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:44913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=85 metric=0.7207 head_norm=1.953821
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.675886e-02
[S2] stored merged vector for next round verification (round=85)
[S2] DEBUG after merge:  round=85 metric=0.7207 head_norm=1.944685 delta_norm=0.056759
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.038 → S15@127.0.0.1:44915
[S7] ⇄ pheromone p=0.157 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.001 → S16@127.0.0.1:44916
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9997
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=1.0000
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=85 metric=0.9955 head_norm=2.097015
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.575735e-02
[S3] stored merged vector for next round verification (round=85)
[S3] DEBUG after merge:  round=85 metric=0.9955 head_norm=2.111211 delta_norm=0.025757
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.080 → S7@127.0.0.1:44908
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] ⇄ pheromone p=0.315 → S10@127.0.0.1:44911
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=85 metric=0.8613 head_norm=1.856024
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.309884e-02
[S6] stored merged vector for next round verification (round=85)
[S6] DEBUG after merge:  round=85 metric=0.8618 head_norm=1.852800 delta_norm=0.013099
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.331 → S8@127.0.0.1:44909
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9966
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=85 metric=0.8522 head_norm=1.853980
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.287507e-02
[S8] stored merged vector for next round verification (round=85)
[S8] DEBUG after merge:  round=85 metric=0.8517 head_norm=1.854958 delta_norm=0.012875
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.091 → S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9983
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=85 metric=0.8732 head_norm=1.940413
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.727077e-02
[S15] stored merged vector for next round verification (round=85)
[S15] DEBUG after merge:  round=85 metric=0.8736 head_norm=1.940071 delta_norm=0.057271
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.176 → S2@127.0.0.1:44902
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=85 metric=0.9552 head_norm=1.789962
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.950671e-03
[S16] stored merged vector for next round verification (round=85)
[S16] DEBUG after merge:  round=85 metric=0.9547 head_norm=1.784975 delta_norm=0.009951
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.075 → S14@127.0.0.1:44914
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9997
[S4] ⇄ pheromone p=0.011 → S11@127.0.0.1:44912
[S5] ⇄ pheromone p=0.165 → S15@127.0.0.1:44915
[S2] START round=86 head_norm_before_train=1.944685 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7049155733040633, 'auprc': 0.7673261264494331, 'loss_val': 0.7495048556580703, 'psi': 0.7298797945622112}-{'f1_val': 0.7206996160839734, 'auprc': 0.7519092225293206, 'loss_val': 0.7967661553837003, 'psi': 0.7331834586621122}
[S3] START round=86 head_norm_before_train=2.111211 cos_to_last_merge=1.0000 (last merge round=85)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.9490318067349277, 'auprc': 0.9844606330370027, 'loss_val': 0.18958128909540223, 'psi': 0.9632033372557578}-{'f1_val': 0.9954643553242586, 'auprc': 0.9987358286700166, 'loss_val': 0.023566945734047537, 'psi': 0.9967729446625617}
[S4] START round=86 head_norm_before_train=2.164654 cos_to_last_merge=0.9998 (last merge round=82)
[S4] round=86 local utility u=0.009895 metrics={'f1_val': 0.9407285906513994, 'auprc': 0.9551173243967982, 'loss_val': 0.32435479325597294, 'psi': 0.946484084149559}-{'f1_val': 0.9403374238583864, 'auprc': 0.9493395854025155, 'loss_val': 0.32446434890922926, 'psi': 0.943938288476038}
[S5] START round=86 head_norm_before_train=1.941418 cos_to_last_merge=0.9884 (last merge round=62)
[S5] round=86 local utility u=0.003045 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9995028746958745, 'loss_val': 0.022528069627105178, 'psi': 0.9978223309654244}-{'f1_val': 0.9967019684784577, 'auprc': 0.9975570727895489, 'loss_val': 0.02278103952407828, 'psi': 0.9970440102028941}
[S6] START round=86 head_norm_before_train=1.852800 cos_to_last_merge=1.0000 (last merge round=85)
[S6] round=86 local utility u=0.023322 metrics={'f1_val': 0.8667768064355248, 'auprc': 0.9643282035918628, 'loss_val': 0.29898617799660554, 'psi': 0.90579736529806}-{'f1_val': 0.8612622714540902, 'auprc': 0.9617167965961702, 'loss_val': 0.3047081354225607, 'psi': 0.9014440815109221}
[S7] START round=86 head_norm_before_train=2.140762 cos_to_last_merge=0.9998 (last merge round=82)
[S7] round=86 local utility u=0.045319 metrics={'f1_val': 0.8451923480135376, 'auprc': 0.9749537458102349, 'loss_val': 0.7870805399853545, 'psi': 0.8970969071322166}-{'f1_val': 0.846562646869637, 'auprc': 0.9493899447885742, 'loss_val': 0.8092497896328622, 'psi': 0.8876935660372118}
[S8] START round=86 head_norm_before_train=1.854958 cos_to_last_merge=1.0000 (last merge round=85)
[S8] round=86 local utility u=0.548540 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9991877176298698, 'loss_val': 0.034402482746193355, 'psi': 0.9947616677496538}-{'f1_val': 0.8521845027719455, 'auprc': 0.997414941632425, 'loss_val': 0.2884060260750151, 'psi': 0.9102766783161373}
[S9] START round=86 head_norm_before_train=1.782879 cos_to_last_merge=0.9520 (last merge round=37)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9987464740852039, 'loss_val': 0.01986575426346303, 'psi': 0.9972486465016481}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983686391524045, 'loss_val': 0.019515605058291724, 'psi': 0.9973437627492967}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=1.995702 cos_to_last_merge=1.0000 (last merge round=84)
[S10] round=86 local utility u=0.000469 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9974981796580124, 'loss_val': 0.030146493903295747, 'psi': 0.9953218994935319}-{'f1_val': 0.993871046050545, 'auprc': 0.9969959829837062, 'loss_val': 0.029578675271206348, 'psi': 0.9951210208238095}
[S11] START round=86 head_norm_before_train=2.173531 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=86 local utility u=0.000247 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9988215105381639, 'loss_val': 0.020578865016076125, 'psi': 0.9970516233588773}-{'f1_val': 0.9958716985726862, 'auprc': 0.9988297798324566, 'loss_val': 0.02109702774082083, 'psi': 0.9970549310765944}
[S13] START round=86 head_norm_before_train=1.995947 cos_to_last_merge=1.0000 (last merge round=84)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.7001684955290757, 'auprc': 0.6990254059760572, 'loss_val': 1.3236560822033665, 'psi': 0.6997112597078683}-{'f1_val': 0.7211269523199951, 'auprc': 0.7971204470879198, 'loss_val': 1.068531792738507, 'psi': 0.751524350227165}
[S14] START round=86 head_norm_before_train=1.780823 cos_to_last_merge=1.0000 (last merge round=84)
[S14] round=86 local utility u=0.000431 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9992034239034369, 'loss_val': 0.021696525756545675, 'psi': 0.9976020482703336}-{'f1_val': 0.9967325241656609, 'auprc': 0.9984137432212868, 'loss_val': 0.021377391995465508, 'psi': 0.9974050117879113}
[S15] START round=86 head_norm_before_train=1.940071 cos_to_last_merge=1.0000 (last merge round=85)
[S15] round=86 local utility u=0.478297 metrics={'f1_val': 0.9892122379451619, 'auprc': 0.9926681373656552, 'loss_val': 0.0365142167436011, 'psi': 0.9905945977133592}-{'f1_val': 0.8732226390876374, 'auprc': 0.9930409357733988, 'loss_val': 0.2982889110448726, 'psi': 0.921149957761942}
[S16] START round=86 head_norm_before_train=1.784975 cos_to_last_merge=1.0000 (last merge round=85)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.940045446513658, 'auprc': 0.9806823768826562, 'loss_val': 0.32215321454321055, 'psi': 0.9563002186612573}-{'f1_val': 0.9551798479624896, 'auprc': 0.9748295973471665, 'loss_val': 0.11940474611696793, 'psi': 0.9630397477163604}
[S17] START round=86 head_norm_before_train=2.057892 cos_to_last_merge=0.9842 (last merge round=52)
[S17] round=86 local utility u=0.411293 metrics={'f1_val': 0.7290951902810683, 'auprc': 0.9834841109690385, 'loss_val': 0.966666892135306, 'psi': 0.8308507585562563}-{'f1_val': 0.6572872537086285, 'auprc': 0.9750611058717793, 'loss_val': 1.3331361501549932, 'psi': 0.7843967945738888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=86 metric=0.7049 head_norm=1.954146
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.381837e-02
[S2] stored merged vector for next round verification (round=86)
[S2] DEBUG after merge:  round=86 metric=0.7040 head_norm=1.945487 delta_norm=0.083818
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=1.0000
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=86 metric=0.9407 head_norm=2.172131
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.033714e-02
[S4] stored merged vector for next round verification (round=86)
[S4] DEBUG after merge:  round=86 metric=0.9407 head_norm=2.175899 delta_norm=0.030337
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=86 metric=0.8452 head_norm=2.158311
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.456396e-02
[S7] stored merged vector for next round verification (round=86)
[S7] DEBUG after merge:  round=86 metric=0.8452 head_norm=2.127417 delta_norm=0.044564
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=86 metric=0.9939 head_norm=2.001964
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.524756e-03
[S10] stored merged vector for next round verification (round=86)
[S10] DEBUG after merge:  round=86 metric=0.9939 head_norm=1.998947 delta_norm=0.006525
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9994
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=86 metric=0.9959 head_norm=2.180083
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.913520e-02
[S11] stored merged vector for next round verification (round=86)
[S11] DEBUG after merge:  round=86 metric=0.9959 head_norm=2.174047 delta_norm=0.029135
[S11] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9994
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=86 metric=0.9892 head_norm=1.948928
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.360670e-02
[S15] stored merged vector for next round verification (round=86)
[S15] DEBUG after merge:  round=86 metric=0.9888 head_norm=1.947315 delta_norm=0.033607
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=86 metric=0.9918 head_norm=1.858384
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.646575e-03
[S8] stored merged vector for next round verification (round=86)
[S8] DEBUG after merge:  round=86 metric=0.9918 head_norm=1.858514 delta_norm=0.009647
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=86 metric=0.9967 head_norm=1.946280
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.360670e-02
[S5] stored merged vector for next round verification (round=86)
[S5] DEBUG after merge:  round=86 metric=0.9967 head_norm=1.947315 delta_norm=0.033607
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=1.945487 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=87 local utility u=0.047632 metrics={'f1_val': 0.7059786672103672, 'auprc': 0.7834578581117976, 'loss_val': 0.7090155701275193, 'psi': 0.7369703435709394}-{'f1_val': 0.7049155733040633, 'auprc': 0.7673261264494331, 'loss_val': 0.7495048556580703, 'psi': 0.7298797945622112}
[S3] START round=87 head_norm_before_train=2.112169 cos_to_last_merge=1.0000 (last merge round=85)
[S3] round=87 local utility u=0.051261 metrics={'f1_val': 0.9517671366151279, 'auprc': 0.9963710187511383, 'loss_val': 0.13920307815073266, 'psi': 0.9696086894695322}-{'f1_val': 0.9490318067349277, 'auprc': 0.9844606330370027, 'loss_val': 0.18958128909540223, 'psi': 0.9632033372557578}
[S4] START round=87 head_norm_before_train=2.175899 cos_to_last_merge=1.0000 (last merge round=86)
[S4] round=87 local utility u=0.002431 metrics={'f1_val': 0.9419447474670248, 'auprc': 0.9566568465977848, 'loss_val': 0.33140775941911227, 'psi': 0.9478295871193289}-{'f1_val': 0.9407285906513994, 'auprc': 0.9551173243967982, 'loss_val': 0.32435479325597294, 'psi': 0.946484084149559}
[S5] START round=87 head_norm_before_train=1.947315 cos_to_last_merge=1.0000 (last merge round=86)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.992950183312981, 'loss_val': 0.023644113546180907, 'psi': 0.994717173461923}-{'f1_val': 0.9967019684784577, 'auprc': 0.9995028746958745, 'loss_val': 0.022528069627105178, 'psi': 0.9978223309654244}
[S6] START round=87 head_norm_before_train=1.858693 cos_to_last_merge=0.9999 (last merge round=85)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.7657287470896023, 'auprc': 0.9546289168552444, 'loss_val': 0.49549884459396304, 'psi': 0.8412888149958591}-{'f1_val': 0.8667768064355248, 'auprc': 0.9643282035918628, 'loss_val': 0.29898617799660554, 'psi': 0.90579736529806}
[S7] START round=87 head_norm_before_train=2.127417 cos_to_last_merge=1.0000 (last merge round=86)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.839602801178913, 'auprc': 0.9815145881912348, 'loss_val': 0.7906003084958655, 'psi': 0.8963675159838417}-{'f1_val': 0.8451923480135376, 'auprc': 0.9749537458102349, 'loss_val': 0.7870805399853545, 'psi': 0.8970969071322166}
[S8] START round=87 head_norm_before_train=1.858514 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9915794263117453, 'auprc': 0.9993753437810923, 'loss_val': 0.033726557503887165, 'psi': 0.9946977932994842}-{'f1_val': 0.9918109678295097, 'auprc': 0.9991877176298698, 'loss_val': 0.034402482746193355, 'psi': 0.9947616677496538}
[S9] START round=87 head_norm_before_train=1.788451 cos_to_last_merge=0.9514 (last merge round=37)
[S9] round=87 local utility u=0.001012 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983686510810676, 'loss_val': 0.019170931241981607, 'psi': 0.9973437675207619}-{'f1_val': 0.9962500947792776, 'auprc': 0.9987464740852039, 'loss_val': 0.01986575426346303, 'psi': 0.9972486465016481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=87 head_norm_before_train=1.998947 cos_to_last_merge=1.0000 (last merge round=86)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9970437378877757, 'loss_val': 0.030087269261762722, 'psi': 0.9951401227854373}-{'f1_val': 0.993871046050545, 'auprc': 0.9974981796580124, 'loss_val': 0.030146493903295747, 'psi': 0.9953218994935319}
[S11] START round=87 head_norm_before_train=2.174047 cos_to_last_merge=1.0000 (last merge round=86)
[S11] round=87 local utility u=0.000116 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987952208951998, 'loss_val': 0.020267807073538757, 'psi': 0.9970411075016916}-{'f1_val': 0.9958716985726862, 'auprc': 0.9988215105381639, 'loss_val': 0.020578865016076125, 'psi': 0.9970516233588773}
[S13] START round=87 head_norm_before_train=2.000325 cos_to_last_merge=1.0000 (last merge round=84)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.616894787276844, 'auprc': 0.6777134944834969, 'loss_val': 1.3719602697486237, 'psi': 0.6412222701595052}-{'f1_val': 0.7001684955290757, 'auprc': 0.6990254059760572, 'loss_val': 1.3236560822033665, 'psi': 0.6997112597078683}
[S14] START round=87 head_norm_before_train=1.780458 cos_to_last_merge=1.0000 (last merge round=84)
[S14] round=87 local utility u=0.000063 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9992107992660941, 'loss_val': 0.021593357514757862, 'psi': 0.9976049984153965}-{'f1_val': 0.9965344645149313, 'auprc': 0.9992034239034369, 'loss_val': 0.021696525756545675, 'psi': 0.9976020482703336}
[S15] START round=87 head_norm_before_train=1.947315 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=87 local utility u=0.025187 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9929474351948101, 'loss_val': 0.02969842168964357, 'psi': 0.9949784205872085}-{'f1_val': 0.9892122379451619, 'auprc': 0.9926681373656552, 'loss_val': 0.0365142167436011, 'psi': 0.9905945977133592}
[S16] START round=87 head_norm_before_train=1.789367 cos_to_last_merge=1.0000 (last merge round=85)
[S16] round=87 local utility u=0.285642 metrics={'f1_val': 0.9907097550876947, 'auprc': 0.9793009434068323, 'loss_val': 0.05071172458425062, 'psi': 0.9861462304153497}-{'f1_val': 0.940045446513658, 'auprc': 0.9806823768826562, 'loss_val': 0.32215321454321055, 'psi': 0.9563002186612573}
[S17] START round=87 head_norm_before_train=2.065719 cos_to_last_merge=0.9838 (last merge round=52)
[S17] round=87 local utility u=0.369466 metrics={'f1_val': 0.8116667607954353, 'auprc': 0.9775548981007681, 'loss_val': 0.7053774623109265, 'psi': 0.8780220157175684}-{'f1_val': 0.7290951902810683, 'auprc': 0.9834841109690385, 'loss_val': 0.966666892135306, 'psi': 0.8308507585562563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=87 metric=0.6169 head_norm=2.004137
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.887136e-03
[S13] stored merged vector for next round verification (round=87)
[S13] DEBUG after merge:  round=87 metric=0.6161 head_norm=2.003031 delta_norm=0.008887
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1796) from S14
[S16] cosine check vs S14: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.9960
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=87 metric=0.9959 head_norm=2.181014
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.947091e-03
[S11] stored merged vector for next round verification (round=87)
[S11] DEBUG after merge:  round=87 metric=0.9959 head_norm=2.181676 delta_norm=0.008947
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=87 metric=0.9965 head_norm=1.782245
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.509159e-02
[S14] stored merged vector for next round verification (round=87)
[S14] DEBUG after merge:  round=87 metric=0.9965 head_norm=1.787928 delta_norm=0.015092
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=87 metric=0.9907 head_norm=1.793719
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.411818e-02
[S16] stored merged vector for next round verification (round=87)
[S16] DEBUG after merge:  round=87 metric=0.9907 head_norm=1.787489 delta_norm=0.014118
[S16] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=87 metric=0.9419 head_norm=2.182375
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.947089e-03
[S4] stored merged vector for next round verification (round=87)
[S4] DEBUG after merge:  round=87 metric=0.9419 head_norm=2.181676 delta_norm=0.008947
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=1.0000
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=87 metric=0.7657 head_norm=1.862284
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.142615e-02
[S6] stored merged vector for next round verification (round=87)
[S6] DEBUG after merge:  round=87 metric=0.7660 head_norm=1.860300 delta_norm=0.011426
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=87 metric=0.9963 head_norm=1.956732
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.781824e-02
[S15] stored merged vector for next round verification (round=87)
[S15] DEBUG after merge:  round=87 metric=0.9963 head_norm=1.954593 delta_norm=0.087818
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=87 metric=0.9518 head_norm=2.115707
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.401992e-02
[S3] stored merged vector for next round verification (round=87)
[S3] DEBUG after merge:  round=87 metric=0.9531 head_norm=2.136844 delta_norm=0.034020
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=87 metric=0.9959 head_norm=1.955787
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.087906e-03
[S5] stored merged vector for next round verification (round=87)
[S5] DEBUG after merge:  round=87 metric=0.9959 head_norm=1.956246 delta_norm=0.007088
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=1.956397 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7022039079231234, 'auprc': 0.7624021029609906, 'loss_val': 0.7808728804283531, 'psi': 0.7262831859382703}-{'f1_val': 0.7059786672103672, 'auprc': 0.7834578581117976, 'loss_val': 0.7090155701275193, 'psi': 0.7369703435709394}
[S3] START round=88 head_norm_before_train=2.136844 cos_to_last_merge=1.0000 (last merge round=87)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9362145040199708, 'auprc': 0.9761229090792006, 'loss_val': 0.22405661930813786, 'psi': 0.9521778660436627}-{'f1_val': 0.9517671366151279, 'auprc': 0.9963710187511383, 'loss_val': 0.13920307815073266, 'psi': 0.9696086894695322}
[S4] START round=88 head_norm_before_train=2.181676 cos_to_last_merge=1.0000 (last merge round=87)
[S4] round=88 local utility u=0.044896 metrics={'f1_val': 0.9501175484788074, 'auprc': 0.9671090967228695, 'loss_val': 0.32200942221100676, 'psi': 0.9569141677764322}-{'f1_val': 0.9419447474670248, 'auprc': 0.9566568465977848, 'loss_val': 0.33140775941911227, 'psi': 0.9478295871193289}
[S5] START round=88 head_norm_before_train=1.956246 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=88 local utility u=0.012936 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9991241742237156, 'loss_val': 0.02113441275096334, 'psi': 0.9976708507765608}-{'f1_val': 0.995895166894551, 'auprc': 0.992950183312981, 'loss_val': 0.023644113546180907, 'psi': 0.994717173461923}
[S6] START round=88 head_norm_before_train=1.860300 cos_to_last_merge=1.0000 (last merge round=87)
[S6] round=88 local utility u=0.165397 metrics={'f1_val': 0.8104823592856306, 'auprc': 0.9279520186988206, 'loss_val': 0.3531963665641505, 'psi': 0.8574702230509066}-{'f1_val': 0.7657287470896023, 'auprc': 0.9546289168552444, 'loss_val': 0.49549884459396304, 'psi': 0.8412888149958591}
[S7] START round=88 head_norm_before_train=2.144801 cos_to_last_merge=1.0000 (last merge round=86)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.8257939268829073, 'auprc': 0.9582249861091972, 'loss_val': 1.0785289880025106, 'psi': 0.8787663505734233}-{'f1_val': 0.839602801178913, 'auprc': 0.9815145881912348, 'loss_val': 0.7906003084958655, 'psi': 0.8963675159838417}
[S8] START round=88 head_norm_before_train=1.862363 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9920222688347867, 'auprc': 0.9931517738001828, 'loss_val': 0.03866969276833625, 'psi': 0.9924740708209452}-{'f1_val': 0.9915794263117453, 'auprc': 0.9993753437810923, 'loss_val': 0.033726557503887165, 'psi': 0.9946977932994842}
[S9] START round=88 head_norm_before_train=1.792606 cos_to_last_merge=0.9509 (last merge round=37)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956280467410747, 'loss_val': 0.019338155847354467, 'psi': 0.9962475257847647}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983686510810676, 'loss_val': 0.019170931241981607, 'psi': 0.9973437675207619}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.005416 cos_to_last_merge=1.0000 (last merge round=86)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9969990796762447, 'loss_val': 0.03026728186696647, 'psi': 0.9951222595008249}-{'f1_val': 0.993871046050545, 'auprc': 0.9970437378877757, 'loss_val': 0.030087269261762722, 'psi': 0.9951401227854373}
[S11] START round=88 head_norm_before_train=2.181676 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=88 local utility u=0.000122 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987803249579765, 'loss_val': 0.019978365172408342, 'psi': 0.9970351491268024}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987952208951998, 'loss_val': 0.020267807073538757, 'psi': 0.9970411075016916}
[S13] START round=88 head_norm_before_train=2.003031 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=88 local utility u=0.205644 metrics={'f1_val': 0.6551424431537981, 'auprc': 0.6878003547202647, 'loss_val': 1.220417788733143, 'psi': 0.6682056077803847}-{'f1_val': 0.616894787276844, 'auprc': 0.6777134944834969, 'loss_val': 1.3719602697486237, 'psi': 0.6412222701595052}
[S14] START round=88 head_norm_before_train=1.787928 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=88 local utility u=0.000949 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9985382341473681, 'loss_val': 0.02133074420630686, 'psi': 0.9977012650968268}-{'f1_val': 0.9965344645149313, 'auprc': 0.9992107992660941, 'loss_val': 0.021593357514757862, 'psi': 0.9976049984153965}
[S15] START round=88 head_norm_before_train=1.954593 cos_to_last_merge=1.0000 (last merge round=87)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.8156625122508814, 'auprc': 0.9923215714029031, 'loss_val': 0.38465008403035456, 'psi': 0.8863261359116901}-{'f1_val': 0.9963324108488076, 'auprc': 0.9929474351948101, 'loss_val': 0.02969842168964357, 'psi': 0.9949784205872085}
[S16] START round=88 head_norm_before_train=1.787489 cos_to_last_merge=1.0000 (last merge round=87)
[S16] round=88 local utility u=0.018320 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9832981909044031, 'loss_val': 0.038909213252612436, 'psi': 0.9890297837064848}-{'f1_val': 0.9907097550876947, 'auprc': 0.9793009434068323, 'loss_val': 0.05071172458425062, 'psi': 0.9861462304153497}
[S17] START round=88 head_norm_before_train=2.073524 cos_to_last_merge=0.9833 (last merge round=52)
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.8055370356580941, 'auprc': 0.9547569586873645, 'loss_val': 0.8644078335294703, 'psi': 0.8652250048698022}-{'f1_val': 0.8116667607954353, 'auprc': 0.9775548981007681, 'loss_val': 0.7053774623109265, 'psi': 0.8780220157175684}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44904
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=88 metric=0.8258 head_norm=2.156191
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.909954e-02
[S7] stored merged vector for next round verification (round=88)
[S7] DEBUG after merge:  round=88 metric=0.8258 head_norm=2.135847 delta_norm=0.029100
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=88 metric=0.9971 head_norm=1.791945
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.003501e-03
[S14] stored merged vector for next round verification (round=88)
[S14] DEBUG after merge:  round=88 metric=0.9971 head_norm=1.791721 delta_norm=0.005004
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=88 metric=0.9929 head_norm=1.791510
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.003508e-03
[S16] stored merged vector for next round verification (round=88)
[S16] DEBUG after merge:  round=88 metric=0.9929 head_norm=1.791721 delta_norm=0.005004
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=88 metric=0.9501 head_norm=2.187298
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.349206e-03
[S4] stored merged vector for next round verification (round=88)
[S4] DEBUG after merge:  round=88 metric=0.9497 head_norm=2.187963 delta_norm=0.006349
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=88 metric=0.9959 head_norm=2.188646
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.349204e-03
[S11] stored merged vector for next round verification (round=88)
[S11] DEBUG after merge:  round=88 metric=0.9959 head_norm=2.187963 delta_norm=0.006349
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=88 metric=0.9920 head_norm=1.866485
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.413661e-02
[S8] stored merged vector for next round verification (round=88)
[S8] DEBUG after merge:  round=88 metric=0.9920 head_norm=1.865793 delta_norm=0.014137
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9987
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] START round=89 head_norm_before_train=1.966153 cos_to_last_merge=0.9999 (last merge round=86)
[S2] round=89 local utility u=0.131552 metrics={'f1_val': 0.7170351614337275, 'auprc': 0.7937339892366544, 'loss_val': 0.700752920958825, 'psi': 0.7477146925548983}-{'f1_val': 0.7022039079231234, 'auprc': 0.7624021029609906, 'loss_val': 0.7808728804283531, 'psi': 0.7262831859382703}
[S3] START round=89 head_norm_before_train=2.142951 cos_to_last_merge=1.0000 (last merge round=87)
[S3] round=89 local utility u=0.014396 metrics={'f1_val': 0.921506457545612, 'auprc': 0.9959493295068471, 'loss_val': 0.1664953288987696, 'psi': 0.9512836063301061}-{'f1_val': 0.9362145040199708, 'auprc': 0.9761229090792006, 'loss_val': 0.22405661930813786, 'psi': 0.9521778660436627}
[S4] START round=89 head_norm_before_train=2.187963 cos_to_last_merge=1.0000 (last merge round=88)
[S4] round=89 local utility u=0.010565 metrics={'f1_val': 0.9536476116638557, 'auprc': 0.9666482946007903, 'loss_val': 0.32067754795289943, 'psi': 0.9588478848386296}-{'f1_val': 0.9501175484788074, 'auprc': 0.9671090967228695, 'loss_val': 0.32200942221100676, 'psi': 0.9569141677764322}
[S5] START round=89 head_norm_before_train=1.961727 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=89 local utility u=0.000640 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994594926682489, 'loss_val': 0.0208608111422092, 'psi': 0.9978049781543741}-{'f1_val': 0.9967019684784577, 'auprc': 0.9991241742237156, 'loss_val': 0.02113441275096334, 'psi': 0.9976708507765608}
[S6] START round=89 head_norm_before_train=1.865207 cos_to_last_merge=1.0000 (last merge round=87)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.618799668981261, 'auprc': 0.8704141722613801, 'loss_val': 0.7711607686069234, 'psi': 0.7194454702933086}-{'f1_val': 0.8104823592856306, 'auprc': 0.9279520186988206, 'loss_val': 0.3531963665641505, 'psi': 0.8574702230509066}
[S7] START round=89 head_norm_before_train=2.135847 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=89 local utility u=0.198258 metrics={'f1_val': 0.8445149471043838, 'auprc': 0.9684747363757609, 'loss_val': 0.8250890639120522, 'psi': 0.8940988628129346}-{'f1_val': 0.8257939268829073, 'auprc': 0.9582249861091972, 'loss_val': 1.0785289880025106, 'psi': 0.8787663505734233}
[S8] START round=89 head_norm_before_train=1.865793 cos_to_last_merge=1.0000 (last merge round=88)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9787345111746355, 'auprc': 0.9989707511861019, 'loss_val': 0.056110670303696805, 'psi': 0.9868290071792221}-{'f1_val': 0.9920222688347867, 'auprc': 0.9931517738001828, 'loss_val': 0.03866969276833625, 'psi': 0.9924740708209452}
[S9] START round=89 head_norm_before_train=1.798857 cos_to_last_merge=0.9505 (last merge round=37)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9930530735793841, 'loss_val': 0.019466086233851966, 'psi': 0.9949712862993202}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956280467410747, 'loss_val': 0.019338155847354467, 'psi': 0.9962475257847647}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.011943 cos_to_last_merge=1.0000 (last merge round=86)
[S10] round=89 local utility u=0.000146 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9969948525171547, 'loss_val': 0.02996185654279767, 'psi': 0.9951205686371889}-{'f1_val': 0.993871046050545, 'auprc': 0.9969990796762447, 'loss_val': 0.03026728186696647, 'psi': 0.9951222595008249}
[S11] START round=89 head_norm_before_train=2.187963 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987579612602989, 'loss_val': 0.02127075490044702, 'psi': 0.9970262036477313}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987803249579765, 'loss_val': 0.019978365172408342, 'psi': 0.9970351491268024}
[S13] START round=89 head_norm_before_train=2.008944 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=89 local utility u=0.015241 metrics={'f1_val': 0.6890437091287187, 'auprc': 0.6871502069830544, 'loss_val': 1.3913923627708327, 'psi': 0.688286308270453}-{'f1_val': 0.6551424431537981, 'auprc': 0.6878003547202647, 'loss_val': 1.220417788733143, 'psi': 0.6682056077803847}
[S14] START round=89 head_norm_before_train=1.791721 cos_to_last_merge=1.0000 (last merge round=88)
[S14] round=89 local utility u=0.001544 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988067743633051, 'loss_val': 0.02050584516476246, 'psi': 0.997954466734071}-{'f1_val': 0.9971432857297993, 'auprc': 0.9985382341473681, 'loss_val': 0.02133074420630686, 'psi': 0.9977012650968268}
[S15] START round=89 head_norm_before_train=1.963829 cos_to_last_merge=1.0000 (last merge round=87)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.7452695044987688, 'auprc': 0.9901507220537029, 'loss_val': 0.5587226740895767, 'psi': 0.8432219915207425}-{'f1_val': 0.8156625122508814, 'auprc': 0.9923215714029031, 'loss_val': 0.38465008403035456, 'psi': 0.8863261359116901}
[S16] START round=89 head_norm_before_train=1.791721 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9920499320823678, 'auprc': 0.9835664229487594, 'loss_val': 0.0378508112387752, 'psi': 0.9886565284289245}-{'f1_val': 0.9928508455745393, 'auprc': 0.9832981909044031, 'loss_val': 0.038909213252612436, 'psi': 0.9890297837064848}
[S17] START round=89 head_norm_before_train=2.081142 cos_to_last_merge=0.9829 (last merge round=52)
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.8031735441436345, 'auprc': 0.9513554379225861, 'loss_val': 0.8986592793535535, 'psi': 0.8624463016552152}-{'f1_val': 0.8055370356580941, 'auprc': 0.9547569586873645, 'loss_val': 0.8644078335294703, 'psi': 0.8652250048698022}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:44908
[S4] not sending this round → trigger blocked (psi=0.959)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S13] not sending this round → trigger blocked (psi=0.688)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] cosine check vs S3: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.9987
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=89 metric=0.9215 head_norm=2.148095
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.026044e-03
[S3] stored merged vector for next round verification (round=89)
[S3] DEBUG after merge:  round=89 metric=0.9212 head_norm=2.148730 delta_norm=0.006026
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=89 metric=0.8445 head_norm=2.149381
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.026038e-03
[S7] stored merged vector for next round verification (round=89)
[S7] DEBUG after merge:  round=89 metric=0.8447 head_norm=2.148730 delta_norm=0.006026
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=89 metric=0.9939 head_norm=2.016103
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.219034e-03
[S10] stored merged vector for next round verification (round=89)
[S10] DEBUG after merge:  round=89 metric=0.9939 head_norm=2.012506 delta_norm=0.009219
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=89 metric=0.7453 head_norm=1.972651
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.183496e-02
[S15] stored merged vector for next round verification (round=89)
[S15] DEBUG after merge:  round=89 metric=0.7442 head_norm=1.969080 delta_norm=0.011835
[S15] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9985
[S2] START round=90 head_norm_before_train=1.974510 cos_to_last_merge=0.9999 (last merge round=86)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7193904757854679, 'auprc': 0.7797105552160439, 'loss_val': 0.7218197460490356, 'psi': 0.7435185075576983}-{'f1_val': 0.7170351614337275, 'auprc': 0.7937339892366544, 'loss_val': 0.700752920958825, 'psi': 0.7477146925548983}
[S3] START round=90 head_norm_before_train=2.148730 cos_to_last_merge=1.0000 (last merge round=89)
[S3] round=90 local utility u=0.030393 metrics={'f1_val': 0.9469672713604277, 'auprc': 0.9778564642616849, 'loss_val': 0.20419603920667578, 'psi': 0.9593229485209306}-{'f1_val': 0.921506457545612, 'auprc': 0.9959493295068471, 'loss_val': 0.1664953288987696, 'psi': 0.9512836063301061}
[S4] START round=90 head_norm_before_train=2.197621 cos_to_last_merge=1.0000 (last merge round=88)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9515989322614081, 'auprc': 0.9606347978659562, 'loss_val': 0.32906020031686767, 'psi': 0.9552132785032273}-{'f1_val': 0.9536476116638557, 'auprc': 0.9666482946007903, 'loss_val': 0.32067754795289943, 'psi': 0.9588478848386296}
[S5] START round=90 head_norm_before_train=1.966734 cos_to_last_merge=0.9999 (last merge round=87)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9987573675399525, 'loss_val': 0.020831218466485835, 'psi': 0.997303234194115}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994594926682489, 'loss_val': 0.0208608111422092, 'psi': 0.9978049781543741}
[S6] START round=90 head_norm_before_train=1.870983 cos_to_last_merge=0.9999 (last merge round=87)
[S6] round=90 local utility u=0.564266 metrics={'f1_val': 0.7470523067132483, 'auprc': 0.9336566127427574, 'loss_val': 0.6018714056424087, 'psi': 0.821694029125052}-{'f1_val': 0.618799668981261, 'auprc': 0.8704141722613801, 'loss_val': 0.7711607686069234, 'psi': 0.7194454702933086}
[S7] START round=90 head_norm_before_train=2.148730 cos_to_last_merge=1.0000 (last merge round=89)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.8298384823327976, 'auprc': 0.9693522927994757, 'loss_val': 0.9886131498410338, 'psi': 0.8856440065194688}-{'f1_val': 0.8445149471043838, 'auprc': 0.9684747363757609, 'loss_val': 0.8250890639120522, 'psi': 0.8940988628129346}
[S8] START round=90 head_norm_before_train=1.871224 cos_to_last_merge=1.0000 (last merge round=88)
[S8] round=90 local utility u=0.059168 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9992900304127226, 'loss_val': 0.028949917795221762, 'psi': 0.9959785552094413}-{'f1_val': 0.9787345111746355, 'auprc': 0.9989707511861019, 'loss_val': 0.056110670303696805, 'psi': 0.9868290071792221}
[S9] START round=90 head_norm_before_train=1.804237 cos_to_last_merge=0.9499 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=90 local utility u=0.001911 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9932129293880687, 'loss_val': 0.018585397300594542, 'psi': 0.9952814788435623}-{'f1_val': 0.9962500947792776, 'auprc': 0.9930530735793841, 'loss_val': 0.019466086233851966, 'psi': 0.9949712862993202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=90 head_norm_before_train=2.012506 cos_to_last_merge=1.0000 (last merge round=89)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.996469651075381, 'loss_val': 0.03033881350782392, 'psi': 0.9949104880604793}-{'f1_val': 0.993871046050545, 'auprc': 0.9969948525171547, 'loss_val': 0.02996185654279767, 'psi': 0.9951205686371889}
[S11] START round=90 head_norm_before_train=2.193063 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.998556253560589, 'loss_val': 0.04817758213802773, 'psi': 0.9972079521944568}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987579612602989, 'loss_val': 0.02127075490044702, 'psi': 0.9970262036477313}
[S13] START round=90 head_norm_before_train=2.015698 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.585082766338128, 'auprc': 0.6441550142587454, 'loss_val': 1.6504481700393203, 'psi': 0.6087116655063749}-{'f1_val': 0.6890437091287187, 'auprc': 0.6871502069830544, 'loss_val': 1.3913923627708327, 'psi': 0.688286308270453}
[S14] START round=90 head_norm_before_train=1.793789 cos_to_last_merge=1.0000 (last merge round=88)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9773152623547885, 'auprc': 0.9966970286085812, 'loss_val': 0.043756615126665385, 'psi': 0.9850679688563057}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988067743633051, 'loss_val': 0.02050584516476246, 'psi': 0.997954466734071}
[S15] START round=90 head_norm_before_train=1.969080 cos_to_last_merge=1.0000 (last merge round=89)
[S15] round=90 local utility u=0.193266 metrics={'f1_val': 0.7925022763346865, 'auprc': 0.990564751756487, 'loss_val': 0.456829735140751, 'psi': 0.8717272665034066}-{'f1_val': 0.7452695044987688, 'auprc': 0.9901507220537029, 'loss_val': 0.5587226740895767, 'psi': 0.8432219915207425}
[S16] START round=90 head_norm_before_train=1.797051 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9925183290253178, 'auprc': 0.9827167672982536, 'loss_val': 0.03941499004482565, 'psi': 0.9885977043344921}-{'f1_val': 0.9920499320823678, 'auprc': 0.9835664229487594, 'loss_val': 0.0378508112387752, 'psi': 0.9886565284289245}
[S17] START round=90 head_norm_before_train=2.085402 cos_to_last_merge=0.9828 (last merge round=52)
[S17] round=90 local utility u=0.135936 metrics={'f1_val': 0.8300840828576744, 'auprc': 0.9514089972559843, 'loss_val': 0.7884110684014626, 'psi': 0.8786140486169984}-{'f1_val': 0.8031735441436345, 'auprc': 0.9513554379225861, 'loss_val': 0.8986592793535535, 'psi': 0.8624463016552152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:44908
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:44913
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S4] ⇄ pheromone p=0.012 → S11@127.0.0.1:44912
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=90 metric=0.5851 head_norm=2.021345
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.393017e-02
[S13] stored merged vector for next round verification (round=90)
[S13] DEBUG after merge:  round=90 metric=0.5844 head_norm=2.018678 delta_norm=0.013930
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.132 → S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] ⇄ pheromone p=0.038 → S15@127.0.0.1:44915
[S11] ⇄ pheromone p=0.009 → S4@127.0.0.1:44904
[S16] ⇄ pheromone p=0.056 → S14@127.0.0.1:44914
[S7] ⇄ pheromone p=0.087 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.001 → S16@127.0.0.1:44916
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9999
[S3] ⇄ pheromone p=0.040 → S7@127.0.0.1:44908
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9983
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=90 metric=0.7925 head_norm=1.977361
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.530874e-02
[S15] stored merged vector for next round verification (round=90)
[S15] DEBUG after merge:  round=90 metric=0.7925 head_norm=1.971279 delta_norm=0.055309
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.138 → S5@127.0.0.1:44905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=90 metric=0.9963 head_norm=1.975487
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.793227e-02
[S5] stored merged vector for next round verification (round=90)
[S5] DEBUG after merge:  round=90 metric=0.9963 head_norm=1.975575 delta_norm=0.057932
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.056 → S15@127.0.0.1:44915
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=90 metric=0.7471 head_norm=1.877462
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.097406e-02
[S6] stored merged vector for next round verification (round=90)
[S6] DEBUG after merge:  round=90 metric=0.7485 head_norm=1.876725 delta_norm=0.010974
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.244 → S8@127.0.0.1:44909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=90 metric=0.9938 head_norm=1.876052
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.097405e-02
[S8] stored merged vector for next round verification (round=90)
[S8] DEBUG after merge:  round=90 metric=0.9938 head_norm=1.876725 delta_norm=0.010974
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.087 → S6@127.0.0.1:44907
[S2] START round=91 head_norm_before_train=1.981731 cos_to_last_merge=0.9998 (last merge round=86)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.7036885213622741, 'auprc': 0.7642646635040358, 'loss_val': 0.7548967821434832, 'psi': 0.7279189782189788}-{'f1_val': 0.7193904757854679, 'auprc': 0.7797105552160439, 'loss_val': 0.7218197460490356, 'psi': 0.7435185075576983}
[S3] START round=91 head_norm_before_train=2.154010 cos_to_last_merge=1.0000 (last merge round=89)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.717168094181153, 'auprc': 0.9151574199663962, 'loss_val': 0.6407013992504669, 'psi': 0.7963638244952503}-{'f1_val': 0.9469672713604277, 'auprc': 0.9778564642616849, 'loss_val': 0.20419603920667578, 'psi': 0.9593229485209306}
[S4] START round=91 head_norm_before_train=2.202477 cos_to_last_merge=1.0000 (last merge round=88)
[S4] round=91 local utility u=0.041007 metrics={'f1_val': 0.9554880724759278, 'auprc': 0.9754718479519362, 'loss_val': 0.3148916520136852, 'psi': 0.9634815826663312}-{'f1_val': 0.9515989322614081, 'auprc': 0.9606347978659562, 'loss_val': 0.32906020031686767, 'psi': 0.9552132785032273}
[S5] START round=91 head_norm_before_train=1.975575 cos_to_last_merge=1.0000 (last merge round=90)
[S5] round=91 local utility u=0.003160 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9999088146912349, 'loss_val': 0.020175176439892483, 'psi': 0.9979847069635686}-{'f1_val': 0.9963338119635569, 'auprc': 0.9987573675399525, 'loss_val': 0.020831218466485835, 'psi': 0.997303234194115}
[S6] START round=91 head_norm_before_train=1.876725 cos_to_last_merge=1.0000 (last merge round=90)
[S6] round=91 local utility u=0.040535 metrics={'f1_val': 0.76259347467562, 'auprc': 0.9005794033431433, 'loss_val': 0.5148168699989567, 'psi': 0.8177878461426293}-{'f1_val': 0.7470523067132483, 'auprc': 0.9336566127427574, 'loss_val': 0.6018714056424087, 'psi': 0.821694029125052}
[S7] START round=91 head_norm_before_train=2.163482 cos_to_last_merge=1.0000 (last merge round=89)
[S7] round=91 local utility u=0.049018 metrics={'f1_val': 0.8347731685429063, 'auprc': 0.9807618492228807, 'loss_val': 0.9544145785513231, 'psi': 0.893168640814896}-{'f1_val': 0.8298384823327976, 'auprc': 0.9693522927994757, 'loss_val': 0.9886131498410338, 'psi': 0.8856440065194688}
[S8] START round=91 head_norm_before_train=1.876725 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9991185894139477, 'loss_val': 0.03892424314997298, 'psi': 0.9930019303251283}-{'f1_val': 0.9937709050739206, 'auprc': 0.9992900304127226, 'loss_val': 0.028949917795221762, 'psi': 0.9959785552094413}
[S9] START round=91 head_norm_before_train=1.809663 cos_to_last_merge=0.9494 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=91 local utility u=0.007692 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.9988093755594766, 'loss_val': 0.01846745086073808, 'psi': 0.9973677617154348}-{'f1_val': 0.9966605118138915, 'auprc': 0.9932129293880687, 'loss_val': 0.018585397300594542, 'psi': 0.9952814788435623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=91 head_norm_before_train=2.017708 cos_to_last_merge=1.0000 (last merge round=89)
[S10] round=91 local utility u=0.001937 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9967729630392334, 'loss_val': 0.02868995160627235, 'psi': 0.9951633805138616}-{'f1_val': 0.993871046050545, 'auprc': 0.996469651075381, 'loss_val': 0.03033881350782392, 'psi': 0.9949104880604793}
[S11] START round=91 head_norm_before_train=2.197462 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=91 local utility u=0.013258 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9988078585234947, 'loss_val': 0.01979165575767179, 'psi': 0.9970461625530096}-{'f1_val': 0.9963090846170353, 'auprc': 0.998556253560589, 'loss_val': 0.04817758213802773, 'psi': 0.9972079521944568}
[S13] START round=91 head_norm_before_train=2.018678 cos_to_last_merge=1.0000 (last merge round=90)
[S13] round=91 local utility u=0.693614 metrics={'f1_val': 0.6762182586604193, 'auprc': 0.7004991170076736, 'loss_val': 0.9790646481259391, 'psi': 0.685930601999321}-{'f1_val': 0.585082766338128, 'auprc': 0.6441550142587454, 'loss_val': 1.6504481700393203, 'psi': 0.6087116655063749}
[S14] START round=91 head_norm_before_train=1.797535 cos_to_last_merge=1.0000 (last merge round=88)
[S14] round=91 local utility u=0.074511 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9992164758512277, 'loss_val': 0.01906631442300588, 'psi': 0.9977530549119529}-{'f1_val': 0.9773152623547885, 'auprc': 0.9966970286085812, 'loss_val': 0.043756615126665385, 'psi': 0.9850679688563057}
[S15] START round=91 head_norm_before_train=1.971279 cos_to_last_merge=1.0000 (last merge round=90)
[S15] round=91 local utility u=0.841147 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9979233931052789, 'loss_val': 0.021819368010728035, 'psi': 0.9971915344159649}-{'f1_val': 0.7925022763346865, 'auprc': 0.990564751756487, 'loss_val': 0.456829735140751, 'psi': 0.8717272665034066}
[S16] START round=91 head_norm_before_train=1.803180 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=91 local utility u=0.000221 metrics={'f1_val': 0.9925183290253178, 'auprc': 0.9827846636878015, 'loss_val': 0.0391766173661861, 'psi': 0.9886248628903113}-{'f1_val': 0.9925183290253178, 'auprc': 0.9827167672982536, 'loss_val': 0.03941499004482565, 'psi': 0.9885977043344921}
[S17] START round=91 head_norm_before_train=2.090458 cos_to_last_merge=0.9825 (last merge round=52)
[S17] round=91 local utility u=0.250225 metrics={'f1_val': 0.8772545505315517, 'auprc': 0.9480420651182981, 'loss_val': 0.5608826489973071, 'psi': 0.9055695563662503}-{'f1_val': 0.8300840828576744, 'auprc': 0.9514089972559843, 'loss_val': 0.7884110684014626, 'psi': 0.8786140486169984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=91 metric=0.8348 head_norm=2.175795
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.080998e-02
[S7] stored merged vector for next round verification (round=91)
[S7] DEBUG after merge:  round=91 metric=0.8348 head_norm=2.164830 delta_norm=0.020810
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=91 metric=0.6762 head_norm=2.023693
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.946473e-03
[S13] stored merged vector for next round verification (round=91)
[S13] DEBUG after merge:  round=91 metric=0.6757 head_norm=2.022877 delta_norm=0.008946
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=91 metric=0.9941 head_norm=2.022101
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.946460e-03
[S10] stored merged vector for next round verification (round=91)
[S10] DEBUG after merge:  round=91 metric=0.9941 head_norm=2.022877 delta_norm=0.008946
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=91 metric=0.9968 head_norm=1.802047
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.012406e-02
[S14] stored merged vector for next round verification (round=91)
[S14] DEBUG after merge:  round=91 metric=0.9968 head_norm=1.805544 delta_norm=0.010124
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=91 metric=0.9925 head_norm=1.809091
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.012407e-02
[S16] stored merged vector for next round verification (round=91)
[S16] DEBUG after merge:  round=91 metric=0.9925 head_norm=1.805544 delta_norm=0.010124
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=1.0000
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=91 metric=0.9889 head_norm=1.882018
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.821366e-03
[S8] stored merged vector for next round verification (round=91)
[S8] DEBUG after merge:  round=91 metric=0.9889 head_norm=1.883511 delta_norm=0.004821
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:44912
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=91 metric=0.9967 head_norm=1.978371
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.438529e-03
[S15] stored merged vector for next round verification (round=91)
[S15] DEBUG after merge:  round=91 metric=0.9967 head_norm=1.981211 delta_norm=0.008439
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=91 metric=0.9967 head_norm=1.984082
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.438536e-03
[S5] stored merged vector for next round verification (round=91)
[S5] DEBUG after merge:  round=91 metric=0.9967 head_norm=1.981211 delta_norm=0.008439
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=91 metric=0.9555 head_norm=2.202713
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.761568e-02
[S4] stored merged vector for next round verification (round=91)
[S4] DEBUG after merge:  round=91 metric=0.9555 head_norm=2.202867 delta_norm=0.017616
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=1.989025 cos_to_last_merge=0.9997 (last merge round=86)
[S2] round=92 local utility u=0.052059 metrics={'f1_val': 0.7198265158956192, 'auprc': 0.7643093617845109, 'loss_val': 0.7477417375971492, 'psi': 0.7376196542511759}-{'f1_val': 0.7036885213622741, 'auprc': 0.7642646635040358, 'loss_val': 0.7548967821434832, 'psi': 0.7279189782189788}
[S3] START round=92 head_norm_before_train=2.158936 cos_to_last_merge=1.0000 (last merge round=89)
[S3] round=92 local utility u=1.000000 metrics={'f1_val': 0.987211160579404, 'auprc': 0.9986714755915141, 'loss_val': 0.04089245913086108, 'psi': 0.9917952865842481}-{'f1_val': 0.717168094181153, 'auprc': 0.9151574199663962, 'loss_val': 0.6407013992504669, 'psi': 0.7963638244952503}
[S4] START round=92 head_norm_before_train=2.202867 cos_to_last_merge=1.0000 (last merge round=91)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9512468312098686, 'auprc': 0.9621341183609139, 'loss_val': 0.32937367051212624, 'psi': 0.9556017460702867}-{'f1_val': 0.9554880724759278, 'auprc': 0.9754718479519362, 'loss_val': 0.3148916520136852, 'psi': 0.9634815826663312}
[S5] START round=92 head_norm_before_train=1.981211 cos_to_last_merge=1.0000 (last merge round=91)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9993225011980394, 'loss_val': 0.02114724268972933, 'psi': 0.9977501815662904}-{'f1_val': 0.9967019684784577, 'auprc': 0.9999088146912349, 'loss_val': 0.020175176439892483, 'psi': 0.9979847069635686}
[S6] START round=92 head_norm_before_train=1.885015 cos_to_last_merge=1.0000 (last merge round=90)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.6014901808200857, 'auprc': 0.8766231991587292, 'loss_val': 0.9601923385224868, 'psi': 0.7115433881555431}-{'f1_val': 0.76259347467562, 'auprc': 0.9005794033431433, 'loss_val': 0.5148168699989567, 'psi': 0.8177878461426293}
[S7] START round=92 head_norm_before_train=2.164830 cos_to_last_merge=1.0000 (last merge round=91)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.810641351711639, 'auprc': 0.9854056235168249, 'loss_val': 0.9573440131846523, 'psi': 0.8805470604337133}-{'f1_val': 0.8347731685429063, 'auprc': 0.9807618492228807, 'loss_val': 0.9544145785513231, 'psi': 0.893168640814896}
[S8] START round=92 head_norm_before_train=1.883511 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.7786178388133185, 'auprc': 0.9986707650075355, 'loss_val': 0.5769944931576096, 'psi': 0.8666390092910052}-{'f1_val': 0.9889241575992487, 'auprc': 0.9991185894139477, 'loss_val': 0.03892424314997298, 'psi': 0.9930019303251283}
[S9] START round=92 head_norm_before_train=1.813524 cos_to_last_merge=0.9493 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.996095059822684, 'loss_val': 0.0201404307691457, 'psi': 0.9961880807966401}-{'f1_val': 0.9964066858194072, 'auprc': 0.9988093755594766, 'loss_val': 0.01846745086073808, 'psi': 0.9973677617154348}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.022877 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9966026880578998, 'loss_val': 0.028409306577027223, 'psi': 0.9950952705213282}-{'f1_val': 0.9940903254969471, 'auprc': 0.9967729630392334, 'loss_val': 0.02868995160627235, 'psi': 0.9951633805138616}
[S11] START round=92 head_norm_before_train=2.203162 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986282398511472, 'loss_val': 0.0280061529346761, 'psi': 0.9972367467106801}-{'f1_val': 0.9958716985726862, 'auprc': 0.9988078585234947, 'loss_val': 0.01979165575767179, 'psi': 0.9970461625530096}
[S13] START round=92 head_norm_before_train=2.022877 cos_to_last_merge=1.0000 (last merge round=91)
[S13] round=92 local utility u=0.059132 metrics={'f1_val': 0.7184345891861875, 'auprc': 0.7099808446166459, 'loss_val': 1.1425446438599078, 'psi': 0.7150530913583709}-{'f1_val': 0.6762182586604193, 'auprc': 0.7004991170076736, 'loss_val': 0.9790646481259391, 'psi': 0.685930601999321}
[S14] START round=92 head_norm_before_train=1.805544 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963174016016366, 'auprc': 0.9961289643003165, 'loss_val': 0.022100775063879412, 'psi': 0.9962420266811086}-{'f1_val': 0.9967774409524363, 'auprc': 0.9992164758512277, 'loss_val': 0.01906631442300588, 'psi': 0.9977530549119529}
[S15] START round=92 head_norm_before_train=1.981211 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.9632069704725376, 'loss_val': 0.6929565219601772, 'psi': 0.805743665769691}-{'f1_val': 0.9967036286230888, 'auprc': 0.9979233931052789, 'loss_val': 0.021819368010728035, 'psi': 0.9971915344159649}
[S16] START round=92 head_norm_before_train=1.805544 cos_to_last_merge=1.0000 (last merge round=91)
[S16] round=92 local utility u=0.005385 metrics={'f1_val': 0.9926643754518716, 'auprc': 0.9857559012768338, 'loss_val': 0.038196948989124874, 'psi': 0.9899009857818565}-{'f1_val': 0.9925183290253178, 'auprc': 0.9827846636878015, 'loss_val': 0.0391766173661861, 'psi': 0.9886248628903113}
[S17] START round=92 head_norm_before_train=2.095725 cos_to_last_merge=0.9823 (last merge round=52)
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.7382297176833421, 'auprc': 0.9878557367835179, 'loss_val': 1.1149830261790084, 'psi': 0.8380801253234125}-{'f1_val': 0.8772545505315517, 'auprc': 0.9480420651182981, 'loss_val': 0.5608826489973071, 'psi': 0.9055695563662503}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44908
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=92 metric=0.9963 head_norm=2.208929
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.003421e-02
[S11] stored merged vector for next round verification (round=92)
[S11] DEBUG after merge:  round=92 metric=0.9963 head_norm=2.205732 delta_norm=0.020034
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S3
[S7] cosine check vs S3: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] cosine check vs S2: cos=0.9963
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=1.0000
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=92 metric=0.9872 head_norm=2.165418
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.052704e-02
[S3] stored merged vector for next round verification (round=92)
[S3] DEBUG after merge:  round=92 metric=0.9872 head_norm=2.170516 delta_norm=0.020527
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=92 metric=0.9963 head_norm=1.809433
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.354674e-03
[S14] stored merged vector for next round verification (round=92)
[S14] DEBUG after merge:  round=92 metric=0.9963 head_norm=1.809718 delta_norm=0.003355
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=92 metric=0.7008 head_norm=1.987327
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.634462e-02
[S15] stored merged vector for next round verification (round=92)
[S15] DEBUG after merge:  round=92 metric=0.7008 head_norm=1.990410 delta_norm=0.086345
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=1.997225 cos_to_last_merge=0.9996 (last merge round=86)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7198932144323456, 'auprc': 0.7628956489465486, 'loss_val': 0.7847631642779961, 'psi': 0.7370941882380269}-{'f1_val': 0.7198265158956192, 'auprc': 0.7643093617845109, 'loss_val': 0.7477417375971492, 'psi': 0.7376196542511759}
[S3] START round=93 head_norm_before_train=2.170516 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9931740269681327, 'loss_val': 0.2192092840325777, 'psi': 0.9582071359578869}-{'f1_val': 0.987211160579404, 'auprc': 0.9986714755915141, 'loss_val': 0.04089245913086108, 'psi': 0.9917952865842481}
[S4] START round=93 head_norm_before_train=2.205015 cos_to_last_merge=1.0000 (last merge round=91)
[S4] round=93 local utility u=0.016953 metrics={'f1_val': 0.9519760312978482, 'auprc': 0.9696743810311199, 'loss_val': 0.32246388345710547, 'psi': 0.9590553711911569}-{'f1_val': 0.9512468312098686, 'auprc': 0.9621341183609139, 'loss_val': 0.32937367051212624, 'psi': 0.9556017460702867}
[S5] START round=93 head_norm_before_train=1.988465 cos_to_last_merge=1.0000 (last merge round=91)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9558075835455611, 'auprc': 0.9920635047125239, 'loss_val': 0.08580085479171937, 'psi': 0.9703099520123462}-{'f1_val': 0.9967019684784577, 'auprc': 0.9993225011980394, 'loss_val': 0.02114724268972933, 'psi': 0.9977501815662904}
[S6] START round=93 head_norm_before_train=1.895034 cos_to_last_merge=0.9999 (last merge round=90)
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.842331170631035, 'auprc': 0.9567434923377166, 'loss_val': 0.41984469119108336, 'psi': 0.8880960993137076}-{'f1_val': 0.6014901808200857, 'auprc': 0.8766231991587292, 'loss_val': 0.9601923385224868, 'psi': 0.7115433881555431}
[S7] START round=93 head_norm_before_train=2.178357 cos_to_last_merge=1.0000 (last merge round=91)
[S7] round=93 local utility u=0.022458 metrics={'f1_val': 0.8273445684372107, 'auprc': 0.9825271544752887, 'loss_val': 1.0040119464880417, 'psi': 0.8894176028524419}-{'f1_val': 0.810641351711639, 'auprc': 0.9854056235168249, 'loss_val': 0.9573440131846523, 'psi': 0.8805470604337133}
[S8] START round=93 head_norm_before_train=1.886825 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=93 local utility u=0.920760 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9992467224744831, 'loss_val': 0.02944637814925102, 'psi': 0.9960938307429013}-{'f1_val': 0.7786178388133185, 'auprc': 0.9986707650075355, 'loss_val': 0.5769944931576096, 'psi': 0.8666390092910052}
[S9] START round=93 head_norm_before_train=1.817902 cos_to_last_merge=0.9493 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=93 local utility u=0.006050 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988221666023569, 'loss_val': 0.018684175522029473, 'psi': 0.9975251737292776}-{'f1_val': 0.9962500947792776, 'auprc': 0.996095059822684, 'loss_val': 0.0201404307691457, 'psi': 0.9961880807966401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=93 head_norm_before_train=2.027183 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9962292194431817, 'loss_val': 0.028875162368488718, 'psi': 0.9948143154075997}-{'f1_val': 0.9940903254969471, 'auprc': 0.9966026880578998, 'loss_val': 0.028409306577027223, 'psi': 0.9950952705213282}
[S11] START round=93 head_norm_before_train=2.205732 cos_to_last_merge=1.0000 (last merge round=92)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984494657514409, 'loss_val': 0.08850597578603032, 'psi': 0.9973103392976347}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986282398511472, 'loss_val': 0.0280061529346761, 'psi': 0.9972367467106801}
[S13] START round=93 head_norm_before_train=2.027406 cos_to_last_merge=1.0000 (last merge round=91)
[S13] round=93 local utility u=0.095436 metrics={'f1_val': 0.7202934923850617, 'auprc': 0.7408262407714843, 'loss_val': 1.055361714090469, 'psi': 0.7285065917396307}-{'f1_val': 0.7184345891861875, 'auprc': 0.7099808446166459, 'loss_val': 1.1425446438599078, 'psi': 0.7150530913583709}
[S14] START round=93 head_norm_before_train=1.809718 cos_to_last_merge=1.0000 (last merge round=92)
[S14] round=93 local utility u=0.003658 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9964193882321005, 'loss_val': 0.02076023162583911, 'psi': 0.9968685659511567}-{'f1_val': 0.9963174016016366, 'auprc': 0.9961289643003165, 'loss_val': 0.022100775063879412, 'psi': 0.9962420266811086}
[S15] START round=93 head_norm_before_train=1.990410 cos_to_last_merge=1.0000 (last merge round=92)
[S15] round=93 local utility u=1.000000 metrics={'f1_val': 0.9691524007464095, 'auprc': 0.9927798534105219, 'loss_val': 0.05976392823954481, 'psi': 0.9786033818120545}-{'f1_val': 0.7007681293011265, 'auprc': 0.9632069704725376, 'loss_val': 0.6929565219601772, 'psi': 0.805743665769691}
[S16] START round=93 head_norm_before_train=1.810009 cos_to_last_merge=1.0000 (last merge round=91)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.99226984525309, 'auprc': 0.9859406573076186, 'loss_val': 0.03713669057441573, 'psi': 0.9897381700749015}-{'f1_val': 0.9926643754518716, 'auprc': 0.9857559012768338, 'loss_val': 0.038196948989124874, 'psi': 0.9899009857818565}
[S17] START round=93 head_norm_before_train=2.100403 cos_to_last_merge=0.9820 (last merge round=52)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.7044271051341453, 'auprc': 0.9942107462663806, 'loss_val': 1.0798818797851324, 'psi': 0.8203405615870394}-{'f1_val': 0.7382297176833421, 'auprc': 0.9878557367835179, 'loss_val': 1.1149830261790084, 'psi': 0.8380801253234125}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44911
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:44907
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=93 metric=0.9939 head_norm=2.032409
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.593955e-03
[S10] stored merged vector for next round verification (round=93)
[S10] DEBUG after merge:  round=93 metric=0.9939 head_norm=2.029901 delta_norm=0.005594
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=1.0000
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=93 metric=0.8273 head_norm=2.196128
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.593552e-02
[S7] stored merged vector for next round verification (round=93)
[S7] DEBUG after merge:  round=93 metric=0.8276 head_norm=2.180673 delta_norm=0.025936
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9988
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:44916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=93 metric=0.9940 head_norm=1.891020
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.627821e-02
[S8] stored merged vector for next round verification (round=93)
[S8] DEBUG after merge:  round=93 metric=0.9940 head_norm=1.897080 delta_norm=0.016278
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1789 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=93 metric=0.9558 head_norm=1.991360
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.899532e-02
[S5] stored merged vector for next round verification (round=93)
[S5] DEBUG after merge:  round=93 metric=0.9558 head_norm=1.993056 delta_norm=0.048995
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1789) from S14
[S16] cosine check vs S14: cos=1.0000
[S2] START round=94 head_norm_before_train=2.004354 cos_to_last_merge=0.9995 (last merge round=86)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7185204675097956, 'auprc': 0.7414062373626695, 'loss_val': 0.812306668280385, 'psi': 0.7276747754509452}-{'f1_val': 0.7198932144323456, 'auprc': 0.7628956489465486, 'loss_val': 0.7847631642779961, 'psi': 0.7370941882380269}
[S3] START round=94 head_norm_before_train=2.176496 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=94 local utility u=0.291798 metrics={'f1_val': 0.996718896605481, 'auprc': 0.9985835754248498, 'loss_val': 0.022780657483861037, 'psi': 0.9974647681332285}-{'f1_val': 0.9348958752843897, 'auprc': 0.9931740269681327, 'loss_val': 0.2192092840325777, 'psi': 0.9582071359578869}
[S4] START round=94 head_norm_before_train=2.207803 cos_to_last_merge=1.0000 (last merge round=91)
[S4] round=94 local utility u=0.002017 metrics={'f1_val': 0.9543988945507553, 'auprc': 0.9663983920617955, 'loss_val': 0.3231390987267307, 'psi': 0.9591986935551714}-{'f1_val': 0.9519760312978482, 'auprc': 0.9696743810311199, 'loss_val': 0.32246388345710547, 'psi': 0.9590553711911569}
[S5] START round=94 head_norm_before_train=1.993056 cos_to_last_merge=1.0000 (last merge round=93)
[S5] round=94 local utility u=0.164485 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9986928492366007, 'loss_val': 0.02429057833425286, 'psi': 0.9977188748612789}-{'f1_val': 0.9558075835455611, 'auprc': 0.9920635047125239, 'loss_val': 0.08580085479171937, 'psi': 0.9703099520123462}
[S6] START round=94 head_norm_before_train=1.903260 cos_to_last_merge=0.9999 (last merge round=90)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.8223364072633563, 'auprc': 0.9515829010342397, 'loss_val': 0.38104798831362185, 'psi': 0.8740350047717096}-{'f1_val': 0.842331170631035, 'auprc': 0.9567434923377166, 'loss_val': 0.41984469119108336, 'psi': 0.8880960993137076}
[S7] START round=94 head_norm_before_train=2.180673 cos_to_last_merge=1.0000 (last merge round=93)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.7539455553745792, 'auprc': 0.9602057225359782, 'loss_val': 1.3420222463796634, 'psi': 0.8364496222391389}-{'f1_val': 0.8273445684372107, 'auprc': 0.9825271544752887, 'loss_val': 1.0040119464880417, 'psi': 0.8894176028524419}
[S8] START round=94 head_norm_before_train=1.897080 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=94 local utility u=0.000813 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9994455629433162, 'loss_val': 0.02841615694087291, 'psi': 0.9961733669304346}-{'f1_val': 0.9939919029218467, 'auprc': 0.9992467224744831, 'loss_val': 0.02944637814925102, 'psi': 0.9960938307429013}
[S9] START round=94 head_norm_before_train=1.821271 cos_to_last_merge=0.9490 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9930646508179075, 'loss_val': 0.01868984333193556, 'psi': 0.9953374115825173}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988221666023569, 'loss_val': 0.018684175522029473, 'psi': 0.9975251737292776}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.029901 cos_to_last_merge=1.0000 (last merge round=93)
[S10] round=94 local utility u=0.001328 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9965081260910617, 'loss_val': 0.029540341204877665, 'psi': 0.9951743642267468}-{'f1_val': 0.993871046050545, 'auprc': 0.9962292194431817, 'loss_val': 0.028875162368488718, 'psi': 0.9948143154075997}
[S11] START round=94 head_norm_before_train=2.209249 cos_to_last_merge=1.0000 (last merge round=92)
[S11] round=94 local utility u=0.032898 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9985811460202985, 'loss_val': 0.021654680184199887, 'psi': 0.9972179091783406}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984494657514409, 'loss_val': 0.08850597578603032, 'psi': 0.9973103392976347}
[S13] START round=94 head_norm_before_train=2.031558 cos_to_last_merge=1.0000 (last merge round=91)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6903803604589183, 'auprc': 0.7090625100088361, 'loss_val': 1.2540835064594766, 'psi': 0.6978532202788854}-{'f1_val': 0.7202934923850617, 'auprc': 0.7408262407714843, 'loss_val': 1.055361714090469, 'psi': 0.7285065917396307}
[S14] START round=94 head_norm_before_train=1.813559 cos_to_last_merge=1.0000 (last merge round=92)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9959243557296398, 'loss_val': 0.02067815157001136, 'psi': 0.9966705529501725}-{'f1_val': 0.9971680177638609, 'auprc': 0.9964193882321005, 'loss_val': 0.02076023162583911, 'psi': 0.9968685659511567}
[S15] START round=94 head_norm_before_train=1.995955 cos_to_last_merge=1.0000 (last merge round=92)
[S15] round=94 local utility u=0.102703 metrics={'f1_val': 0.9958045813547682, 'auprc': 0.9955726204304634, 'loss_val': 0.02264903044527439, 'psi': 0.9957117969850462}-{'f1_val': 0.9691524007464095, 'auprc': 0.9927798534105219, 'loss_val': 0.05976392823954481, 'psi': 0.9786033818120545}
[S16] START round=94 head_norm_before_train=1.815451 cos_to_last_merge=1.0000 (last merge round=91)
[S16] round=94 local utility u=0.002115 metrics={'f1_val': 0.9927032863016021, 'auprc': 0.9864173804552174, 'loss_val': 0.03693749352805184, 'psi': 0.9901889239630481}-{'f1_val': 0.99226984525309, 'auprc': 0.9859406573076186, 'loss_val': 0.03713669057441573, 'psi': 0.9897381700749015}
[S17] START round=94 head_norm_before_train=2.102813 cos_to_last_merge=0.9820 (last merge round=52)
[S17] round=94 local utility u=0.854698 metrics={'f1_val': 0.9073446917232728, 'auprc': 0.9624889265608255, 'loss_val': 0.49282520086702214, 'psi': 0.9294023856582939}-{'f1_val': 0.7044271051341453, 'auprc': 0.9942107462663806, 'loss_val': 1.0798818797851324, 'psi': 0.8203405615870394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44914
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=94 metric=0.8223 head_norm=1.913913
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.130415e-02
[S6] stored merged vector for next round verification (round=94)
[S6] DEBUG after merge:  round=94 metric=0.8242 head_norm=1.902381 delta_norm=0.021304
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1798) from S3
[S7] cosine check vs S3: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=94 metric=0.9967 head_norm=2.180878
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.692887e-02
[S3] stored merged vector for next round verification (round=94)
[S3] DEBUG after merge:  round=94 metric=0.9967 head_norm=2.188451 delta_norm=0.016929
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=94 metric=0.9927 head_norm=1.821510
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.189969e-03
[S16] stored merged vector for next round verification (round=94)
[S16] DEBUG after merge:  round=94 metric=0.9927 head_norm=1.817525 delta_norm=0.007190
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=94 metric=0.9943 head_norm=2.035497
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.862715e-03
[S10] stored merged vector for next round verification (round=94)
[S10] DEBUG after merge:  round=94 metric=0.9943 head_norm=2.033517 delta_norm=0.006863
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=1.0000
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44904
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9997
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=94 metric=0.7539 head_norm=2.199761
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.689727e-02
[S7] stored merged vector for next round verification (round=94)
[S7] DEBUG after merge:  round=94 metric=0.7539 head_norm=2.190275 delta_norm=0.016897
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=94 metric=0.9963 head_norm=2.214554
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.344508e-02
[S11] stored merged vector for next round verification (round=94)
[S11] DEBUG after merge:  round=94 metric=0.9959 head_norm=2.211627 delta_norm=0.013445
[S11] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=94 metric=0.9958 head_norm=2.001670
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.632592e-02
[S15] stored merged vector for next round verification (round=94)
[S15] DEBUG after merge:  round=94 metric=0.9958 head_norm=1.999914 delta_norm=0.026326
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=94 metric=0.9971 head_norm=1.998504
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.632594e-02
[S5] stored merged vector for next round verification (round=94)
[S5] DEBUG after merge:  round=94 metric=0.9971 head_norm=1.999914 delta_norm=0.026326
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=95 head_norm_before_train=2.010326 cos_to_last_merge=0.9994 (last merge round=86)
[S2] round=95 local utility u=0.026445 metrics={'f1_val': 0.7191626731310402, 'auprc': 0.7589285601063017, 'loss_val': 0.8158364930061678, 'psi': 0.7350690279211448}-{'f1_val': 0.7185204675097956, 'auprc': 0.7414062373626695, 'loss_val': 0.812306668280385, 'psi': 0.7276747754509452}
[S3] START round=95 head_norm_before_train=2.188451 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.8891119604772648, 'auprc': 0.9948864825551915, 'loss_val': 0.23208488396495316, 'psi': 0.9314217693084355}-{'f1_val': 0.996718896605481, 'auprc': 0.9985835754248498, 'loss_val': 0.022780657483861037, 'psi': 0.9974647681332285}
[S4] START round=95 head_norm_before_train=2.209760 cos_to_last_merge=0.9999 (last merge round=91)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9432746646664266, 'auprc': 0.9566730079685364, 'loss_val': 0.3286473499952427, 'psi': 0.9486340019872705}-{'f1_val': 0.9543988945507553, 'auprc': 0.9663983920617955, 'loss_val': 0.3231390987267307, 'psi': 0.9591986935551714}
[S5] START round=95 head_norm_before_train=1.999914 cos_to_last_merge=1.0000 (last merge round=94)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.8770572664502787, 'auprc': 0.9919375577467433, 'loss_val': 0.24651220328871906, 'psi': 0.9230093829688646}-{'f1_val': 0.9970695586110643, 'auprc': 0.9986928492366007, 'loss_val': 0.02429057833425286, 'psi': 0.9977188748612789}
[S6] START round=95 head_norm_before_train=1.902381 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.5966393215502305, 'auprc': 0.8377468177313766, 'loss_val': 0.9958131128056957, 'psi': 0.693082320022689}-{'f1_val': 0.8223364072633563, 'auprc': 0.9515829010342397, 'loss_val': 0.38104798831362185, 'psi': 0.8740350047717096}
[S7] START round=95 head_norm_before_train=2.190275 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6562545038948231, 'auprc': 0.9525573098476172, 'loss_val': 1.6259154000352716, 'psi': 0.7747756262759408}-{'f1_val': 0.7539455553745792, 'auprc': 0.9602057225359782, 'loss_val': 1.3420222463796634, 'psi': 0.8364496222391389}
[S8] START round=95 head_norm_before_train=1.900857 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9693121163741527, 'auprc': 0.9988955874374517, 'loss_val': 0.08681902778738987, 'psi': 0.9811455047994723}-{'f1_val': 0.9939919029218467, 'auprc': 0.9994455629433162, 'loss_val': 0.02841615694087291, 'psi': 0.9961733669304346}
[S9] START round=95 head_norm_before_train=1.825765 cos_to_last_merge=0.9484 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=95 local utility u=0.000373 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9934228155633195, 'loss_val': 0.01901796330959236, 'psi': 0.9954806774806821}-{'f1_val': 0.9968525854255906, 'auprc': 0.9930646508179075, 'loss_val': 0.01868984333193556, 'psi': 0.9953374115825173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=95 head_norm_before_train=2.033517 cos_to_last_merge=1.0000 (last merge round=94)
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9962356552433443, 'loss_val': 0.029640559389197758, 'psi': 0.9948168897276647}-{'f1_val': 0.9942851896505369, 'auprc': 0.9965081260910617, 'loss_val': 0.029540341204877665, 'psi': 0.9951743642267468}
[S11] START round=95 head_norm_before_train=2.211627 cos_to_last_merge=1.0000 (last merge round=94)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9987175090187952, 'loss_val': 0.020730946854682207, 'psi': 0.9970100227511298}-{'f1_val': 0.9963090846170353, 'auprc': 0.9985811460202985, 'loss_val': 0.021654680184199887, 'psi': 0.9972179091783406}
[S13] START round=95 head_norm_before_train=2.034544 cos_to_last_merge=1.0000 (last merge round=91)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6429893940907554, 'auprc': 0.6717758778131123, 'loss_val': 1.354542903540331, 'psi': 0.6545039875796982}-{'f1_val': 0.6903803604589183, 'auprc': 0.7090625100088361, 'loss_val': 1.2540835064594766, 'psi': 0.6978532202788854}
[S14] START round=95 head_norm_before_train=1.815989 cos_to_last_merge=1.0000 (last merge round=92)
[S14] round=95 local utility u=0.006815 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991756431840021, 'loss_val': 0.018259106949158745, 'psi': 0.9981168538342977}-{'f1_val': 0.9971680177638609, 'auprc': 0.9959243557296398, 'loss_val': 0.02067815157001136, 'psi': 0.9966705529501725}
[S15] START round=95 head_norm_before_train=1.999914 cos_to_last_merge=1.0000 (last merge round=94)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.8076780311479153, 'auprc': 0.9906639014781295, 'loss_val': 0.4400867531985676, 'psi': 0.880872379280001}-{'f1_val': 0.9958045813547682, 'auprc': 0.9955726204304634, 'loss_val': 0.02264903044527439, 'psi': 0.9957117969850462}
[S16] START round=95 head_norm_before_train=1.817525 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=95 local utility u=0.004223 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.989148345603617, 'loss_val': 0.037568828361075515, 'psi': 0.9913698455861704}-{'f1_val': 0.9927032863016021, 'auprc': 0.9864173804552174, 'loss_val': 0.03693749352805184, 'psi': 0.9901889239630481}
[S17] START round=95 head_norm_before_train=2.107954 cos_to_last_merge=0.9817 (last merge round=52)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8950771799307914, 'auprc': 0.9309084675917073, 'loss_val': 0.5305561278186827, 'psi': 0.9094096949951578}-{'f1_val': 0.9073446917232728, 'auprc': 0.9624889265608255, 'loss_val': 0.49282520086702214, 'psi': 0.9294023856582939}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=95 metric=0.6430 head_norm=2.039887
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.282425e-02
[S13] stored merged vector for next round verification (round=95)
[S13] DEBUG after merge:  round=95 metric=0.6402 head_norm=2.037653 delta_norm=0.012824
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.118 → S10@127.0.0.1:44911
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=95 metric=0.9433 head_norm=2.212250
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.693732e-02
[S4] stored merged vector for next round verification (round=95)
[S4] DEBUG after merge:  round=95 metric=0.9433 head_norm=2.213338 delta_norm=0.016937
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.010 → S11@127.0.0.1:44912
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=95 metric=0.5966 head_norm=1.912855
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.239996e-02
[S6] stored merged vector for next round verification (round=95)
[S6] DEBUG after merge:  round=95 metric=0.5966 head_norm=1.906825 delta_norm=0.012400
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.211 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.035 → S3@127.0.0.1:44903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] ⇄ pheromone p=0.009 → S4@127.0.0.1:44904
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:44913
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.9980
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=1.0000
[S2] ⇄ pheromone p=0.023 → S15@127.0.0.1:44915
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=95 metric=0.9929 head_norm=1.822009
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.683994e-03
[S16] stored merged vector for next round verification (round=95)
[S16] DEBUG after merge:  round=95 metric=0.9929 head_norm=1.820584 delta_norm=0.008684
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.020 → S14@127.0.0.1:44914
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=95 metric=0.9974 head_norm=1.819198
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.761113e-03
[S14] stored merged vector for next round verification (round=95)
[S14] DEBUG after merge:  round=95 metric=0.9974 head_norm=1.820457 delta_norm=0.008761
[S14] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.008 → S16@127.0.0.1:44916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=95 metric=0.8077 head_norm=2.005311
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.388516e-02
[S15] stored merged vector for next round verification (round=95)
[S15] DEBUG after merge:  round=95 metric=0.8077 head_norm=2.009875 delta_norm=0.063885
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.259 → S5@127.0.0.1:44905
[S8] ⇄ pheromone p=0.146 → S6@127.0.0.1:44907
[S3] ⇄ pheromone p=0.162 → S7@127.0.0.1:44908
[S5] ⇄ pheromone p=0.045 → S15@127.0.0.1:44915
[S2] START round=96 head_norm_before_train=2.016454 cos_to_last_merge=0.9993 (last merge round=86)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7192092056660044, 'auprc': 0.7394572125640461, 'loss_val': 0.8290780967730685, 'psi': 0.727308408425221}-{'f1_val': 0.7191626731310402, 'auprc': 0.7589285601063017, 'loss_val': 0.8158364930061678, 'psi': 0.7350690279211448}
[S3] START round=96 head_norm_before_train=2.190405 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=96 local utility u=0.273382 metrics={'f1_val': 0.9580199396050227, 'auprc': 0.998041418575861, 'loss_val': 0.1082327380897353, 'psi': 0.9740285311933581}-{'f1_val': 0.8891119604772648, 'auprc': 0.9948864825551915, 'loss_val': 0.23208488396495316, 'psi': 0.9314217693084355}
[S4] START round=96 head_norm_before_train=2.213338 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9430817671290076, 'auprc': 0.9534285094517282, 'loss_val': 0.324785088797944, 'psi': 0.9472204640580959}-{'f1_val': 0.9432746646664266, 'auprc': 0.9566730079685364, 'loss_val': 0.3286473499952427, 'psi': 0.9486340019872705}
[S5] START round=96 head_norm_before_train=2.004584 cos_to_last_merge=1.0000 (last merge round=94)
[S5] round=96 local utility u=0.483644 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.999758231879108, 'loss_val': 0.02055484670432798, 'psi': 0.9979244738387179}-{'f1_val': 0.8770572664502787, 'auprc': 0.9919375577467433, 'loss_val': 0.24651220328871906, 'psi': 0.9230093829688646}
[S6] START round=96 head_norm_before_train=1.906825 cos_to_last_merge=1.0000 (last merge round=95)
[S6] round=96 local utility u=0.658960 metrics={'f1_val': 0.7373952000379996, 'auprc': 0.9076255785040827, 'loss_val': 0.7320646865906058, 'psi': 0.8054873514244328}-{'f1_val': 0.5966393215502305, 'auprc': 0.8377468177313766, 'loss_val': 0.9958131128056957, 'psi': 0.693082320022689}
[S7] START round=96 head_norm_before_train=2.206493 cos_to_last_merge=0.9999 (last merge round=94)
[S7] round=96 local utility u=0.280905 metrics={'f1_val': 0.7332265769936593, 'auprc': 0.9325423393618029, 'loss_val': 1.4658931486703333, 'psi': 0.8129528819409167}-{'f1_val': 0.6562545038948231, 'auprc': 0.9525573098476172, 'loss_val': 1.6259154000352716, 'psi': 0.7747756262759408}
[S8] START round=96 head_norm_before_train=1.904406 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=96 local utility u=0.097948 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9991783884056907, 'loss_val': 0.03107223935033255, 'psi': 0.9951887369566681}-{'f1_val': 0.9693121163741527, 'auprc': 0.9988955874374517, 'loss_val': 0.08681902778738987, 'psi': 0.9811455047994723}
[S9] START round=96 head_norm_before_train=1.831540 cos_to_last_merge=0.9480 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=96 local utility u=0.000666 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9930272744329849, 'loss_val': 0.01800126602986871, 'psi': 0.9954726572804796}-{'f1_val': 0.9968525854255906, 'auprc': 0.9934228155633195, 'loss_val': 0.01901796330959236, 'psi': 0.9954806774806821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=96 head_norm_before_train=2.039279 cos_to_last_merge=1.0000 (last merge round=94)
[S10] round=96 local utility u=0.001609 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9965696389681257, 'loss_val': 0.028740194936318287, 'psi': 0.9950820508854186}-{'f1_val': 0.993871046050545, 'auprc': 0.9962356552433443, 'loss_val': 0.029640559389197758, 'psi': 0.9948168897276647}
[S11] START round=96 head_norm_before_train=2.217486 cos_to_last_merge=1.0000 (last merge round=94)
[S11] round=96 local utility u=0.000133 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.998601472918544, 'loss_val': 0.020116358590373425, 'psi': 0.9969636083110294}-{'f1_val': 0.9958716985726862, 'auprc': 0.9987175090187952, 'loss_val': 0.020730946854682207, 'psi': 0.9970100227511298}
[S13] START round=96 head_norm_before_train=2.037653 cos_to_last_merge=1.0000 (last merge round=95)
[S13] round=96 local utility u=0.403826 metrics={'f1_val': 0.6829055948060944, 'auprc': 0.7384912287460108, 'loss_val': 0.986533167750376, 'psi': 0.705139848382061}-{'f1_val': 0.6429893940907554, 'auprc': 0.6717758778131123, 'loss_val': 1.354542903540331, 'psi': 0.6545039875796982}
[S14] START round=96 head_norm_before_train=1.820457 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9988498480172433, 'loss_val': 0.018556788234686317, 'psi': 0.997738824478133}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991756431840021, 'loss_val': 0.018259106949158745, 'psi': 0.9981168538342977}
[S15] START round=96 head_norm_before_train=2.009875 cos_to_last_merge=1.0000 (last merge round=95)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.9622114715596103, 'loss_val': 0.688191466007652, 'psi': 0.8054354368850181}-{'f1_val': 0.8076780311479153, 'auprc': 0.9906639014781295, 'loss_val': 0.4400867531985676, 'psi': 0.880872379280001}
[S16] START round=96 head_norm_before_train=1.820584 cos_to_last_merge=1.0000 (last merge round=95)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9886108490902568, 'loss_val': 0.03798293811770241, 'psi': 0.9911548469808262}-{'f1_val': 0.9928508455745393, 'auprc': 0.989148345603617, 'loss_val': 0.037568828361075515, 'psi': 0.9913698455861704}
[S17] START round=96 head_norm_before_train=2.111446 cos_to_last_merge=0.9816 (last merge round=52)
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.6732258375822946, 'auprc': 0.9434509141034952, 'loss_val': 1.2309968377946285, 'psi': 0.7813158681907748}-{'f1_val': 0.8950771799307914, 'auprc': 0.9309084675917073, 'loss_val': 0.5305561278186827, 'psi': 0.9094096949951578}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:44908
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1795) from S3
[S7] cosine check vs S3: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1791) from S6
[S8] cosine check vs S6: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=1.0000
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=96 metric=0.9580 head_norm=2.195277
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.291763e-02
[S3] stored merged vector for next round verification (round=96)
[S3] DEBUG after merge:  round=96 metric=0.9580 head_norm=2.207021 delta_norm=0.022918
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=96 metric=0.7332 head_norm=2.218939
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.291763e-02
[S7] stored merged vector for next round verification (round=96)
[S7] DEBUG after merge:  round=96 metric=0.7336 head_norm=2.207021 delta_norm=0.022918
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:44911
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9994
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=96 metric=0.9925 head_norm=1.908642
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.411766e-02
[S8] stored merged vector for next round verification (round=96)
[S8] DEBUG after merge:  round=96 metric=0.9925 head_norm=1.912632 delta_norm=0.014118
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=1.0000
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=96 metric=0.9941 head_norm=2.045128
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.053150e-03
[S10] stored merged vector for next round verification (round=96)
[S10] DEBUG after merge:  round=96 metric=0.9941 head_norm=2.043951 delta_norm=0.009053
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.022391 cos_to_last_merge=0.9992 (last merge round=86)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7192092056660044, 'auprc': 0.7396834696252064, 'loss_val': 0.8337085891671105, 'psi': 0.7273989112496853}-{'f1_val': 0.7192092056660044, 'auprc': 0.7394572125640461, 'loss_val': 0.8290780967730685, 'psi': 0.727308408425221}
[S3] START round=97 head_norm_before_train=2.207021 cos_to_last_merge=1.0000 (last merge round=96)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9557758766266133, 'auprc': 0.9737074036564634, 'loss_val': 0.20695222555108453, 'psi': 0.9629484874385534}-{'f1_val': 0.9580199396050227, 'auprc': 0.998041418575861, 'loss_val': 0.1082327380897353, 'psi': 0.9740285311933581}
[S4] START round=97 head_norm_before_train=2.217222 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9425791115126206, 'auprc': 0.9509924612278868, 'loss_val': 0.3329751233627666, 'psi': 0.9459444513987272}-{'f1_val': 0.9430817671290076, 'auprc': 0.9534285094517282, 'loss_val': 0.324785088797944, 'psi': 0.9472204640580959}
[S5] START round=97 head_norm_before_train=2.010659 cos_to_last_merge=1.0000 (last merge round=94)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9755485631042097, 'auprc': 0.9928305174854943, 'loss_val': 0.05416796277669362, 'psi': 0.9824613448567237}-{'f1_val': 0.9967019684784577, 'auprc': 0.999758231879108, 'loss_val': 0.02055484670432798, 'psi': 0.9979244738387179}
[S6] START round=97 head_norm_before_train=1.916717 cos_to_last_merge=1.0000 (last merge round=95)
[S6] round=97 local utility u=0.457138 metrics={'f1_val': 0.8306509283637398, 'auprc': 0.9421764036025764, 'loss_val': 0.4809757260514825, 'psi': 0.8752611184592745}-{'f1_val': 0.7373952000379996, 'auprc': 0.9076255785040827, 'loss_val': 0.7320646865906058, 'psi': 0.8054873514244328}
[S7] START round=97 head_norm_before_train=2.207021 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=97 local utility u=0.204456 metrics={'f1_val': 0.765083986537983, 'auprc': 0.9499544843396792, 'loss_val': 1.3003627386986891, 'psi': 0.8390321856586616}-{'f1_val': 0.7332265769936593, 'auprc': 0.9325423393618029, 'loss_val': 1.4658931486703333, 'psi': 0.8129528819409167}
[S8] START round=97 head_norm_before_train=1.912632 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=97 local utility u=0.000875 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9992245310169726, 'loss_val': 0.02945969540195627, 'psi': 0.9952071940011809}-{'f1_val': 0.9925289693239863, 'auprc': 0.9991783884056907, 'loss_val': 0.03107223935033255, 'psi': 0.9951887369566681}
[S9] START round=97 head_norm_before_train=1.835936 cos_to_last_merge=0.9471 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=97 local utility u=0.005922 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996915338441962, 'loss_val': 0.017822135102942054, 'psi': 0.9970278828840705}-{'f1_val': 0.9971029125121428, 'auprc': 0.9930272744329849, 'loss_val': 0.01800126602986871, 'psi': 0.9954726572804796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=97 head_norm_before_train=2.043951 cos_to_last_merge=1.0000 (last merge round=96)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.996370975504799, 'loss_val': 0.029139987489190392, 'psi': 0.9948710178322466}-{'f1_val': 0.9940903254969471, 'auprc': 0.9965696389681257, 'loss_val': 0.028740194936318287, 'psi': 0.9950820508854186}
[S11] START round=97 head_norm_before_train=2.223433 cos_to_last_merge=1.0000 (last merge round=94)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985939103750567, 'loss_val': 0.032521670271769595, 'psi': 0.9973681171470811}-{'f1_val': 0.9958716985726862, 'auprc': 0.998601472918544, 'loss_val': 0.020116358590373425, 'psi': 0.9969636083110294}
[S13] START round=97 head_norm_before_train=2.042813 cos_to_last_merge=1.0000 (last merge round=95)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.5619289557590395, 'auprc': 0.6397184197279951, 'loss_val': 1.8282232921820578, 'psi': 0.5930447413466218}-{'f1_val': 0.6829055948060944, 'auprc': 0.7384912287460108, 'loss_val': 0.986533167750376, 'psi': 0.705139848382061}
[S14] START round=97 head_norm_before_train=1.823150 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9980812906619033, 'loss_val': 0.023694992960513674, 'psi': 0.9975184877026408}-{'f1_val': 0.9969981421187261, 'auprc': 0.9988498480172433, 'loss_val': 0.018556788234686317, 'psi': 0.997738824478133}
[S15] START round=97 head_norm_before_train=2.014856 cos_to_last_merge=1.0000 (last merge round=95)
[S15] round=97 local utility u=0.500328 metrics={'f1_val': 0.8212230462406218, 'auprc': 0.9678236607421775, 'loss_val': 0.4262016688619567, 'psi': 0.8798632920412441}-{'f1_val': 0.7009180804352899, 'auprc': 0.9622114715596103, 'loss_val': 0.688191466007652, 'psi': 0.8054354368850181}
[S16] START round=97 head_norm_before_train=1.825195 cos_to_last_merge=1.0000 (last merge round=95)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9886322257582252, 'loss_val': 0.03812768573722858, 'psi': 0.9911633976480136}-{'f1_val': 0.9928508455745393, 'auprc': 0.9886108490902568, 'loss_val': 0.03798293811770241, 'psi': 0.9911548469808262}
[S17] START round=97 head_norm_before_train=2.115814 cos_to_last_merge=0.9814 (last merge round=52)
[S17] round=97 local utility u=0.601513 metrics={'f1_val': 0.7916293106482313, 'auprc': 0.9518519699489392, 'loss_val': 0.7635949668717023, 'psi': 0.8557183743685144}-{'f1_val': 0.6732258375822946, 'auprc': 0.9434509141034952, 'loss_val': 1.2309968377946285, 'psi': 0.7813158681907748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.839)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.875)
[S8] not sending this round → trigger blocked (psi=0.995)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=97 metric=0.9426 head_norm=2.222620
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.354368e-02
[S4] stored merged vector for next round verification (round=97)
[S4] DEBUG after merge:  round=97 metric=0.9426 head_norm=2.222985 delta_norm=0.013544
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=97 metric=0.8307 head_norm=1.924281
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.752308e-02
[S6] stored merged vector for next round verification (round=97)
[S6] DEBUG after merge:  round=97 metric=0.8303 head_norm=1.916397 delta_norm=0.017523
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=97 metric=0.5619 head_norm=2.047843
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.085203e-02
[S13] stored merged vector for next round verification (round=97)
[S13] DEBUG after merge:  round=97 metric=0.5619 head_norm=2.046458 delta_norm=0.010852
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9993
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=97 metric=0.8212 head_norm=2.020085
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.622719e-02
[S15] stored merged vector for next round verification (round=97)
[S15] DEBUG after merge:  round=97 metric=0.8212 head_norm=2.015052 delta_norm=0.036227
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=97 metric=0.9755 head_norm=2.016616
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.774347e-02
[S5] stored merged vector for next round verification (round=97)
[S5] DEBUG after merge:  round=97 metric=0.9760 head_norm=2.017998 delta_norm=0.037743
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.028513 cos_to_last_merge=0.9991 (last merge round=86)
[S2] round=98 local utility u=0.021580 metrics={'f1_val': 0.7191626731310402, 'auprc': 0.7530512992372, 'loss_val': 0.830372669736082, 'psi': 0.7327181235735042}-{'f1_val': 0.7192092056660044, 'auprc': 0.7396834696252064, 'loss_val': 0.8337085891671105, 'psi': 0.7273989112496853}
[S3] START round=98 head_norm_before_train=2.212801 cos_to_last_merge=1.0000 (last merge round=96)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9512059985307558, 'auprc': 0.9719259357911092, 'loss_val': 0.21906007333994032, 'psi': 0.9594939734348972}-{'f1_val': 0.9557758766266133, 'auprc': 0.9737074036564634, 'loss_val': 0.20695222555108453, 'psi': 0.9629484874385534}
[S4] START round=98 head_norm_before_train=2.222985 cos_to_last_merge=1.0000 (last merge round=97)
[S4] round=98 local utility u=0.012160 metrics={'f1_val': 0.9429158707391196, 'auprc': 0.9566063823021111, 'loss_val': 0.3275175069924165, 'psi': 0.9483920753643162}-{'f1_val': 0.9425791115126206, 'auprc': 0.9509924612278868, 'loss_val': 0.3329751233627666, 'psi': 0.9459444513987272}
[S5] START round=98 head_norm_before_train=2.017998 cos_to_last_merge=1.0000 (last merge round=97)
[S5] round=98 local utility u=0.080929 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9937862530386439, 'loss_val': 0.022097835456382053, 'psi': 0.9955356823025321}-{'f1_val': 0.9755485631042097, 'auprc': 0.9928305174854943, 'loss_val': 0.05416796277669362, 'psi': 0.9824613448567237}
[S6] START round=98 head_norm_before_train=1.916397 cos_to_last_merge=1.0000 (last merge round=97)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.8138426556622453, 'auprc': 0.9434013757062584, 'loss_val': 0.5956667119123965, 'psi': 0.8656661436798505}-{'f1_val': 0.8306509283637398, 'auprc': 0.9421764036025764, 'loss_val': 0.4809757260514825, 'psi': 0.8752611184592745}
[S7] START round=98 head_norm_before_train=2.218482 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=98 local utility u=0.358817 metrics={'f1_val': 0.8332655338686032, 'auprc': 0.9580074901835974, 'loss_val': 1.0159760673188145, 'psi': 0.883162316394601}-{'f1_val': 0.765083986537983, 'auprc': 0.9499544843396792, 'loss_val': 1.3003627386986891, 'psi': 0.8390321856586616}
[S8] START round=98 head_norm_before_train=1.913808 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=98 local utility u=0.004372 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9994545776045567, 'loss_val': 0.027984592071473087, 'psi': 0.9959570333105205}-{'f1_val': 0.9925289693239863, 'auprc': 0.9992245310169726, 'loss_val': 0.02945969540195627, 'psi': 0.9952071940011809}
[S9] START round=98 head_norm_before_train=1.837741 cos_to_last_merge=0.9471 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=98 local utility u=0.002825 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987756768938929, 'loss_val': 0.01775327624476232, 'psi': 0.9977720182648429}-{'f1_val': 0.9971029125121428, 'auprc': 0.996915338441962, 'loss_val': 0.017822135102942054, 'psi': 0.9970278828840705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=98 head_norm_before_train=2.049807 cos_to_last_merge=1.0000 (last merge round=96)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9964532183123567, 'loss_val': 0.02960147840233369, 'psi': 0.9949039149552696}-{'f1_val': 0.993871046050545, 'auprc': 0.996370975504799, 'loss_val': 0.029139987489190392, 'psi': 0.9948710178322466}
[S11] START round=98 head_norm_before_train=2.229050 cos_to_last_merge=1.0000 (last merge round=94)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9984898464195648, 'loss_val': 0.10626950051494852, 'psi': 0.9971813893380471}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985939103750567, 'loss_val': 0.032521670271769595, 'psi': 0.9973681171470811}
[S13] START round=98 head_norm_before_train=2.046458 cos_to_last_merge=1.0000 (last merge round=97)
[S13] round=98 local utility u=0.917660 metrics={'f1_val': 0.6589616022906273, 'auprc': 0.8658495002015886, 'loss_val': 1.2534928201669078, 'psi': 0.7417167614550118}-{'f1_val': 0.5619289557590395, 'auprc': 0.6397184197279951, 'loss_val': 1.8282232921820578, 'psi': 0.5930447413466218}
[S14] START round=98 head_norm_before_train=1.824230 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=98 local utility u=0.002291 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9983380621995852, 'loss_val': 0.020031082827833644, 'psi': 0.9976360355381506}-{'f1_val': 0.9971432857297993, 'auprc': 0.9980812906619033, 'loss_val': 0.023694992960513674, 'psi': 0.9975184877026408}
[S15] START round=98 head_norm_before_train=2.015052 cos_to_last_merge=1.0000 (last merge round=97)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.7743110359663359, 'auprc': 0.9640947144362411, 'loss_val': 0.5569214162644875, 'psi': 0.850224507354298}-{'f1_val': 0.8212230462406218, 'auprc': 0.9678236607421775, 'loss_val': 0.4262016688619567, 'psi': 0.8798632920412441}
[S16] START round=98 head_norm_before_train=1.830792 cos_to_last_merge=1.0000 (last merge round=95)
[S16] round=98 local utility u=0.000082 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9887223899827696, 'loss_val': 0.03823328982939871, 'psi': 0.9911994633378314}-{'f1_val': 0.9928508455745393, 'auprc': 0.9886322257582252, 'loss_val': 0.03812768573722858, 'psi': 0.9911633976480136}
[S17] START round=98 head_norm_before_train=2.121104 cos_to_last_merge=0.9811 (last merge round=52)
[S17] round=98 local utility u=0.463196 metrics={'f1_val': 0.9044329667313363, 'auprc': 0.9501117929077089, 'loss_val': 0.5088034332739751, 'psi': 0.9227044972018854}-{'f1_val': 0.7916293106482313, 'auprc': 0.9518519699489392, 'loss_val': 0.7635949668717023, 'psi': 0.8557183743685144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:44903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:44911
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:44907
[S7] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1805) from S7
[S3] cosine check vs S7: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=98 metric=0.9972 head_norm=1.826169
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.245861e-02
[S14] stored merged vector for next round verification (round=98)
[S14] DEBUG after merge:  round=98 metric=0.9972 head_norm=1.831460 delta_norm=0.012459
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=98 metric=0.9929 head_norm=1.836821
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.245860e-02
[S16] stored merged vector for next round verification (round=98)
[S16] DEBUG after merge:  round=98 metric=0.9929 head_norm=1.831460 delta_norm=0.012459
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=1.0000
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] cosine check vs S2: cos=0.9984
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=98 metric=0.7743 head_norm=2.020660
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.812235e-02
[S15] stored merged vector for next round verification (round=98)
[S15] DEBUG after merge:  round=98 metric=0.7743 head_norm=2.023198 delta_norm=0.028122
[S15] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=2.032969 cos_to_last_merge=0.9990 (last merge round=86)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.699966960133253, 'auprc': 0.7422958548018238, 'loss_val': 0.830686261751165, 'psi': 0.7168985180006813}-{'f1_val': 0.7191626731310402, 'auprc': 0.7530512992372, 'loss_val': 0.830372669736082, 'psi': 0.7327181235735042}
[S3] START round=99 head_norm_before_train=2.216807 cos_to_last_merge=1.0000 (last merge round=96)
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.9161370552304773, 'auprc': 0.9980380837775162, 'loss_val': 0.152214123820449, 'psi': 0.9488974666492929}-{'f1_val': 0.9512059985307558, 'auprc': 0.9719259357911092, 'loss_val': 0.21906007333994032, 'psi': 0.9594939734348972}
[S4] START round=99 head_norm_before_train=2.221724 cos_to_last_merge=1.0000 (last merge round=97)
[S4] round=99 local utility u=0.014887 metrics={'f1_val': 0.9447652407630529, 'auprc': 0.9593125271399778, 'loss_val': 0.31695849202181847, 'psi': 0.9505841553138228}-{'f1_val': 0.9429158707391196, 'auprc': 0.9566063823021111, 'loss_val': 0.3275175069924165, 'psi': 0.9483920753643162}
[S5] START round=99 head_norm_before_train=2.020974 cos_to_last_merge=1.0000 (last merge round=97)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9917192228001654, 'loss_val': 0.02105647086984627, 'psi': 0.9944879762982002}-{'f1_val': 0.9967019684784577, 'auprc': 0.9937862530386439, 'loss_val': 0.022097835456382053, 'psi': 0.9955356823025321}
[S6] START round=99 head_norm_before_train=1.922846 cos_to_last_merge=1.0000 (last merge round=97)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.610566160823856, 'auprc': 0.7915208274557662, 'loss_val': 1.134155127127764, 'psi': 0.6829480274766201}-{'f1_val': 0.8138426556622453, 'auprc': 0.9434013757062584, 'loss_val': 0.5956667119123965, 'psi': 0.8656661436798505}
[S7] START round=99 head_norm_before_train=2.230849 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=99 local utility u=0.034402 metrics={'f1_val': 0.8368939714215042, 'auprc': 0.9584922100258819, 'loss_val': 0.9703973333587488, 'psi': 0.8855332668632553}-{'f1_val': 0.8332655338686032, 'auprc': 0.9580074901835974, 'loss_val': 1.0159760673188145, 'psi': 0.883162316394601}
[S8] START round=99 head_norm_before_train=1.917102 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=99 local utility u=0.000228 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.999447821038918, 'loss_val': 0.028382348539478172, 'psi': 0.9960416714599196}-{'f1_val': 0.9936253371144965, 'auprc': 0.9994545776045567, 'loss_val': 0.027984592071473087, 'psi': 0.9959570333105205}
[S9] START round=99 head_norm_before_train=1.842543 cos_to_last_merge=0.9470 (last merge round=37)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9987587531544688, 'loss_val': 0.03891190316170262, 'psi': 0.9930851179786593}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987756768938929, 'loss_val': 0.01775327624476232, 'psi': 0.9977720182648429}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.993 u=0.0000 p_local=0.0020 f1=0.989 auprc=0.999 bytes=97014
[S10] START round=99 head_norm_before_train=2.053297 cos_to_last_merge=1.0000 (last merge round=96)
[S10] round=99 local utility u=0.000663 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9968539661976933, 'loss_val': 0.02947677933400374, 'psi': 0.9950642141094043}-{'f1_val': 0.993871046050545, 'auprc': 0.9964532183123567, 'loss_val': 0.02960147840233369, 'psi': 0.9949039149552696}
[S11] START round=99 head_norm_before_train=2.232688 cos_to_last_merge=0.9999 (last merge round=94)
[S11] round=99 local utility u=0.044017 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9988667587852365, 'loss_val': 0.018193216658905213, 'psi': 0.997214824472712}-{'f1_val': 0.9963090846170353, 'auprc': 0.9984898464195648, 'loss_val': 0.10626950051494852, 'psi': 0.9971813893380471}
[S13] START round=99 head_norm_before_train=2.048871 cos_to_last_merge=1.0000 (last merge round=97)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6149709272238828, 'auprc': 0.6813174291260847, 'loss_val': 1.438789196383816, 'psi': 0.6415095279847636}-{'f1_val': 0.6589616022906273, 'auprc': 0.8658495002015886, 'loss_val': 1.2534928201669078, 'psi': 0.7417167614550118}
[S14] START round=99 head_norm_before_train=1.831460 cos_to_last_merge=1.0000 (last merge round=98)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9969478118293155, 'auprc': 0.9986341028958367, 'loss_val': 0.020810974710646732, 'psi': 0.997622328255924}-{'f1_val': 0.9971680177638609, 'auprc': 0.9983380621995852, 'loss_val': 0.020031082827833644, 'psi': 0.9976360355381506}
[S15] START round=99 head_norm_before_train=2.023198 cos_to_last_merge=1.0000 (last merge round=98)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.7513841573760731, 'auprc': 0.990279494417484, 'loss_val': 0.5163150111321565, 'psi': 0.8469422921926375}-{'f1_val': 0.7743110359663359, 'auprc': 0.9640947144362411, 'loss_val': 0.5569214162644875, 'psi': 0.850224507354298}
[S16] START round=99 head_norm_before_train=1.831460 cos_to_last_merge=1.0000 (last merge round=98)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9924156602567238, 'auprc': 0.9887057059665972, 'loss_val': 0.03828654304514329, 'psi': 0.9909316785406732}-{'f1_val': 0.9928508455745393, 'auprc': 0.9887223899827696, 'loss_val': 0.03823328982939871, 'psi': 0.9911994633378314}
[S17] START round=99 head_norm_before_train=2.127926 cos_to_last_merge=0.9807 (last merge round=52)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.7053381876076246, 'auprc': 0.9574128003189939, 'loss_val': 1.0046882921308908, 'psi': 0.8061680326921723}-{'f1_val': 0.9044329667313363, 'auprc': 0.9501117929077089, 'loss_val': 0.5088034332739751, 'psi': 0.9227044972018854}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.806 u=0.0000 p_local=0.2350 f1=0.705 auprc=0.957 bytes=75544
[S5]  timeout peer S16
[S8]  timeout peer S9
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:44913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:44907
[S2] r=100 psi=0.717 u=0.0000 p_local=0.0130 f1=0.700 auprc=0.742 bytes=68396
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] r=100 psi=0.642 u=0.0000 p_local=0.2367 f1=0.615 auprc=0.681 bytes=75578
[S16] r=100 psi=0.991 u=0.0000 p_local=0.0083 f1=0.992 auprc=0.989 bytes=79080
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0037 f1=0.997 auprc=0.999 bytes=80865
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=99 metric=0.9161 head_norm=2.217443
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.241821e-02
[S3] stored merged vector for next round verification (round=99)
[S3] DEBUG after merge:  round=99 metric=0.9161 head_norm=2.224122 delta_norm=0.012418
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] r=100 psi=0.949 u=0.0000 p_local=0.0944 f1=0.916 auprc=0.998 bytes=75611
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=99 metric=0.6106 head_norm=1.931306
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.835139e-02
[S6] stored merged vector for next round verification (round=99)
[S6] DEBUG after merge:  round=99 metric=0.6106 head_norm=1.924129 delta_norm=0.018351
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] r=100 psi=0.683 u=0.0000 p_local=0.2126 f1=0.611 auprc=0.792 bytes=73644
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9998
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=99 metric=0.9939 head_norm=2.055518
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.723810e-03
[S10] stored merged vector for next round verification (round=99)
[S10] DEBUG after merge:  round=99 metric=0.9939 head_norm=2.052174 delta_norm=0.009724
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=100 psi=0.995 u=0.0007 p_local=0.0005 f1=0.994 auprc=0.997 bytes=72028
[S5] r=100 psi=0.994 u=0.0000 p_local=0.0809 f1=0.996 auprc=0.992 bytes=82771
[S4] r=100 psi=0.951 u=0.0149 p_local=0.0089 f1=0.945 auprc=0.959 bytes=82656
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9998
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=99 metric=0.9961 head_norm=2.233777
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.995318e-02
[S11] stored merged vector for next round verification (round=99)
[S11] DEBUG after merge:  round=99 metric=0.9961 head_norm=2.228819 delta_norm=0.019953
[S11] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] r=100 psi=0.997 u=0.0440 p_local=0.0126 f1=0.996 auprc=0.999 bytes=77316
[S7] r=100 psi=0.886 u=0.0344 p_local=0.1337 f1=0.837 auprc=0.958 bytes=64817
[S15] r=100 psi=0.847 u=0.0000 p_local=0.1700 f1=0.751 auprc=0.990 bytes=79240
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=1.0000
[S8] r=100 psi=0.996 u=0.0002 p_local=0.0709 f1=0.994 auprc=0.999 bytes=77225
[runner] rounds complete.
[runner] all agents stopped.
