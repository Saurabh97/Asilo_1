[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:57003
[S3] → join 127.0.0.1:57002
[S4] → join 127.0.0.1:57002
[S5] → join 127.0.0.1:57002
[S6] → join 127.0.0.1:57002
[S7] → join 127.0.0.1:57002
[S8] → join 127.0.0.1:57002
[S9] → join 127.0.0.1:57002
[S10] → join 127.0.0.1:57002
[S11] → join 127.0.0.1:57002
[S13] → join 127.0.0.1:57002
[S14] → join 127.0.0.1:57002
[S15] → join 127.0.0.1:57002
[S16] → join 127.0.0.1:57002
[S17] → join 127.0.0.1:57002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.109197 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.177641 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.122342 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.163960 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.183850 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.150946 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.186439 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.185677 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.162028 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.165165 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.155095 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.185801 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.188609 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.228890 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.167480 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S10
[S5] + discovered S3
[S4] + discovered S13
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S16
[S5] + discovered S4
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S7
[S5] + discovered S2
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S13
[S6] + discovered S2
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S7
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S15
[S7] + discovered S2
[S7] + discovered S5
[S6] + discovered S14
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S10
[S7] + discovered S3
[S6] + discovered S16
[S6] + discovered S15
[S7] + discovered S6
[S7] + discovered S4
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S17
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S11
[S8] + discovered S2
[S7] + discovered S8
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S10
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S10
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S3
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S17
[S10] + discovered S2
[S9] + discovered S16
[S10] + discovered S6
[S10] + discovered S7
[S9] + discovered S13
[S10] + discovered S8
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S10
[S10] + discovered S11
[S11] + discovered S2
[S11] + discovered S5
[S10] + discovered S15
[S10] + discovered S14
[S11] + discovered S9
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S16
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S8
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S14] + discovered S8
[S14] + discovered S10
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S9
[S15] + discovered S11
[S15] + discovered S6
[S14] + discovered S16
[S15] + discovered S13
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S9
[S16] + discovered S8
[S16] + discovered S4
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S2
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S16
[S17] + discovered S2
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:57010
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:57002
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S2] START round=1 head_norm_before_train=1.112686 (no previous merge yet)
[S2] round=1 local utility u=0.469441 metrics={'f1_val': 0.16699194925591607, 'auprc': 0.633933017487741, 'loss_val': 1.3239534015451389, 'psi': 0.353768376548646}-{'f1_val': 0.10477605118829982, 'auprc': 0.45865537479845614, 'loss_val': 1.3637068475452228, 'psi': 0.24632778063236238}
[S3] START round=1 head_norm_before_train=1.191723 (no previous merge yet)
[S3] round=1 local utility u=0.039144 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9837070501963525, 'loss_val': 1.2651220527337015, 'psi': 0.4773868594470052}-{'f1_val': 0.13984006561410703, 'auprc': 0.9813956845251794, 'loss_val': 1.336475501217572, 'psi': 0.47646231317853605}
[S4] START round=1 head_norm_before_train=1.122322 (no previous merge yet)
[S4] round=1 local utility u=0.306542 metrics={'f1_val': 0.08833063209076175, 'auprc': 0.7502638417286511, 'loss_val': 1.3387569732897036, 'psi': 0.3531039159459175}-{'f1_val': 0.08833063209076175, 'auprc': 0.5585322309892904, 'loss_val': 1.376645349159655, 'psi': 0.2764112716501732}
[S5] START round=1 head_norm_before_train=1.172221 (no previous merge yet)
[S5] round=1 local utility u=0.134852 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7152240095972281, 'loss_val': 1.2682362316385658, 'psi': 0.3714467466960341}-{'f1_val': 0.16815196998123827, 'auprc': 0.5951217589841937, 'loss_val': 1.332973836878053, 'psi': 0.33893988558242044}
[S6] START round=1 head_norm_before_train=1.187491 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.3758530925227313, 'auprc': 0.820430310598071, 'loss_val': 1.341330406192174, 'psi': 0.5536839797528672}-{'f1_val': 0.08954368264159597, 'auprc': 0.4301705838023234, 'loss_val': 1.3735216785926876, 'psi': 0.22579444310588695}
[S7] START round=1 head_norm_before_train=1.161624 (no previous merge yet)
[S7] round=1 local utility u=0.038630 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.779017450749955, 'loss_val': 1.2832871832717805, 'psi': 0.396841073937437}-{'f1_val': 0.14205682272909165, 'auprc': 0.7694231477984333, 'loss_val': 1.3317646569334245, 'psi': 0.39300335275682835}
[S8] START round=1 head_norm_before_train=1.183501 (no previous merge yet)
[S8] round=1 local utility u=0.851982 metrics={'f1_val': 0.2519528548429736, 'auprc': 0.6350212848554979, 'loss_val': 1.3275925657141427, 'psi': 0.4051802268479834}-{'f1_val': 0.09188539123039689, 'auprc': 0.3962841426059073, 'loss_val': 1.3549405537201373, 'psi': 0.21364489178060106}
[S9] START round=1 head_norm_before_train=1.203286 (no previous merge yet)
[S9] round=1 local utility u=0.130323 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9993315647634504, 'loss_val': 1.2218534332268147, 'psi': 0.4845714001893778}-{'f1_val': 0.141397957139996, 'auprc': 0.9436128418237073, 'loss_val': 1.3153428394731144, 'psi': 0.46228391101348054}
[S10] START round=1 head_norm_before_train=1.158920 (no previous merge yet)
[S10] round=1 local utility u=1.000000 metrics={'f1_val': 0.3839069043157074, 'auprc': 0.7683667612207541, 'loss_val': 1.3459416772353667, 'psi': 0.5376908470777261}-{'f1_val': 0.10265544041450778, 'auprc': 0.6032222238558969, 'loss_val': 1.38434980868204, 'psi': 0.3028821537910634}
[S11] START round=1 head_norm_before_train=1.167696 (no previous merge yet)
[S11] round=1 local utility u=0.189501 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.694099195726827, 'loss_val': 1.3318776606887768, 'psi': 0.3618878883145972}-{'f1_val': 0.14041368337311058, 'auprc': 0.5775422980884621, 'loss_val': 1.3612089644799275, 'psi': 0.3152651292592512}
[S13] START round=1 head_norm_before_train=1.161202 (no previous merge yet)
[S13] round=1 local utility u=0.021431 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5442932451193523, 'loss_val': 1.3082164678080996, 'psi': 0.3019487555939728}-{'f1_val': 0.1403857625770531, 'auprc': 0.5395351796201459, 'loss_val': 1.3368039806747183, 'psi': 0.3000455293942902}
[S14] START round=1 head_norm_before_train=1.185394 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7670763763755839, 'loss_val': 1.3373106433563682, 'psi': 0.3910452622798558}-{'f1_val': 0.2777529996701662, 'auprc': 0.7084498686604441, 'loss_val': 1.3613729315116863, 'psi': 0.45003174726627737}
[S15] START round=1 head_norm_before_train=1.193734 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.3911987850752338, 'auprc': 0.7118490453150759, 'loss_val': 1.3165719530641293, 'psi': 0.5194588891711707}-{'f1_val': 0.103651869669801, 'auprc': 0.628606352357159, 'loss_val': 1.3467448292149584, 'psi': 0.3136336627447442}
[S16] START round=1 head_norm_before_train=1.235782 (no previous merge yet)
[S16] round=1 local utility u=0.261745 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8075827050522524, 'loss_val': 1.3143213224283739, 'psi': 0.4074155521404229}-{'f1_val': 0.14063745019920318, 'auprc': 0.6461992020232878, 'loss_val': 1.353659935967464, 'psi': 0.3428621509288371}
[S17] START round=1 head_norm_before_train=1.177756 (no previous merge yet)
[S17] round=1 local utility u=0.168401 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7642782650146637, 'loss_val': 1.3232773329696756, 'psi': 0.3902806839962961}-{'f1_val': 0.14097706879361915, 'auprc': 0.6602842943871244, 'loss_val': 1.3482666319505099, 'psi': 0.34869995903102124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:57005
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S15] → sending delta(kind=head bytes=1783) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:57014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:57012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S2] → sending delta(kind=head bytes=1785) to S17@127.0.0.1:57017
[S10] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1783 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1785 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S7
[S5] cosine check vs S7: cos=-0.0319
[S5] DROPPED delta from S7 (cos=-0.0319 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1789) from S11
[S6] cosine check vs S11: cos=-0.0427
[S6] DROPPED delta from S11 (cos=-0.0427 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S10
[S8] cosine check vs S10: cos=-0.0587
[S8] DROPPED delta from S10 (cos=-0.0587 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S3
[S17] cosine check vs S3: cos=0.1217
[S11] RECEIVED delta(kind=head bytes=1795) from S9
[S11] cosine check vs S9: cos=-0.0127
[S11] DROPPED delta from S9 (cos=-0.0127 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S4
[S5] cosine check vs S4: cos=-0.0800
[S5] DROPPED delta from S4 (cos=-0.0800 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] cosine check vs S5: cos=0.1656
[S14] RECEIVED delta(kind=head bytes=1789) from S16
[S14] cosine check vs S16: cos=-0.0491
[S14] DROPPED delta from S16 (cos=-0.0491 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1783) from S15
[S7] cosine check vs S15: cos=-0.0270
[S7] DROPPED delta from S15 (cos=-0.0270 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S13
[S15] cosine check vs S13: cos=0.0822
[S16] RECEIVED delta(kind=head bytes=1787) from S6
[S16] cosine check vs S6: cos=-0.0330
[S16] DROPPED delta from S6 (cos=-0.0330 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1785) from S2
[S17] cosine check vs S2: cos=0.0874
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0425
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:57007
[S17] sending update (kind=head size=1787 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1787) from S17
[S6] cosine check vs S17: cos=-0.0162
[S6] DROPPED delta from S17 (cos=-0.0162 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.3912 head_norm=1.207798
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.074110e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.876709 delta_norm=0.807411
[S15] aggregate: ROLLBACK (f1_val pre=0.391 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.194177
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.140785e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.725598 delta_norm=0.614079
[S17] aggregate: ACCEPT kept=['S3', 'S5', 'S2', 'S8'] (k=4/4) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.127564 (no previous merge yet)
[S2] round=2 local utility u=0.130026 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7548531695833377, 'loss_val': 1.2753728646696756, 'psi': 0.3870075478664751}-{'f1_val': 0.16699194925591607, 'auprc': 0.633933017487741, 'loss_val': 1.3239534015451389, 'psi': 0.353768376548646}
[S3] START round=2 head_norm_before_train=1.233292 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7023924270564013, 'loss_val': 1.202215323735818, 'psi': 0.3648610101910247}-{'f1_val': 0.13984006561410703, 'auprc': 0.9837070501963525, 'loss_val': 1.2651220527337015, 'psi': 0.4773868594470052}
[S4] START round=2 head_norm_before_train=1.135952 (no previous merge yet)
[S4] round=2 local utility u=0.920535 metrics={'f1_val': 0.3771032148900169, 'auprc': 0.7712557269918828, 'loss_val': 1.2932978840105018, 'psi': 0.5347642197307634}-{'f1_val': 0.08833063209076175, 'auprc': 0.7502638417286511, 'loss_val': 1.3387569732897036, 'psi': 0.3531039159459175}
[S5] START round=2 head_norm_before_train=1.210056 (no previous merge yet)
[S5] round=2 local utility u=0.075656 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.735845134214385, 'loss_val': 1.178786979231783, 'psi': 0.37969519654289685}-{'f1_val': 0.14226190476190476, 'auprc': 0.7152240095972281, 'loss_val': 1.2682362316385658, 'psi': 0.3714467466960341}
[S6] START round=2 head_norm_before_train=1.200215 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8207288673784708, 'loss_val': 1.3010823806634748, 'psi': 0.41314731618215755}-{'f1_val': 0.3758530925227313, 'auprc': 0.820430310598071, 'loss_val': 1.341330406192174, 'psi': 0.5536839797528672}
[S7] START round=2 head_norm_before_train=1.185642 (no previous merge yet)
[S7] round=2 local utility u=0.029182 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7880249658528607, 'loss_val': 1.2519454785085693, 'psi': 0.4004440799785993}-{'f1_val': 0.14205682272909165, 'auprc': 0.779017450749955, 'loss_val': 1.2832871832717805, 'psi': 0.396841073937437}
[S8] START round=2 head_norm_before_train=1.190082 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.15262481796417554, 'auprc': 0.6731955160098531, 'loss_val': 1.2968568654858954, 'psi': 0.36085309718244657}-{'f1_val': 0.2519528548429736, 'auprc': 0.6350212848554979, 'loss_val': 1.3275925657141427, 'psi': 0.4051802268479834}
[S9] START round=2 head_norm_before_train=1.246713 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6182666063261781, 'loss_val': 1.15180040374558, 'psi': 0.33214541681446885}-{'f1_val': 0.141397957139996, 'auprc': 0.9993315647634504, 'loss_val': 1.2218534332268147, 'psi': 0.4845714001893778}
[S10] START round=2 head_norm_before_train=1.168510 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7742893892023877, 'loss_val': 1.2980557073294188, 'psi': 0.39288873820598946}-{'f1_val': 0.3839069043157074, 'auprc': 0.7683667612207541, 'loss_val': 1.3459416772353667, 'psi': 0.5376908470777261}
[S11] START round=2 head_norm_before_train=1.180748 (no previous merge yet)
[S11] round=2 local utility u=0.159866 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.789766454621844, 'loss_val': 1.2991477873371828, 'psi': 0.400154791872604}-{'f1_val': 0.14041368337311058, 'auprc': 0.694099195726827, 'loss_val': 1.3318776606887768, 'psi': 0.3618878883145972}
[S13] START round=2 head_norm_before_train=1.175706 (no previous merge yet)
[S13] round=2 local utility u=0.049088 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5657499676349304, 'loss_val': 1.2744097670780992, 'psi': 0.310531444600204}-{'f1_val': 0.1403857625770531, 'auprc': 0.5442932451193523, 'loss_val': 1.3082164678080996, 'psi': 0.3019487555939728}
[S14] START round=2 head_norm_before_train=1.196728 (no previous merge yet)
[S14] round=2 local utility u=0.084439 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8144798276145946, 'loss_val': 1.3106438892033776, 'psi': 0.4100066427754601}-{'f1_val': 0.14035785288270378, 'auprc': 0.7670763763755839, 'loss_val': 1.3373106433563682, 'psi': 0.3910452622798558}
[S15] START round=2 head_norm_before_train=0.876709 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7726501003219665, 'loss_val': 1.3177834699688868, 'psi': 0.39290023094572163}-{'f1_val': 0.3911987850752338, 'auprc': 0.7118490453150759, 'loss_val': 1.3165719530641293, 'psi': 0.5194588891711707}
[S16] START round=2 head_norm_before_train=1.253467 (no previous merge yet)
[S16] round=2 local utility u=0.019516 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8080385749935484, 'loss_val': 1.2766569581744631, 'psi': 0.4075979001169413}-{'f1_val': 0.14063745019920318, 'auprc': 0.8075827050522524, 'loss_val': 1.3143213224283739, 'psi': 0.4074155521404229}
[S17] START round=2 head_norm_before_train=0.725598 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.049666 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.796472282330979, 'loss_val': 1.3205269426620976, 'psi': 0.40315829092282224}-{'f1_val': 0.14094896331738438, 'auprc': 0.7642782650146637, 'loss_val': 1.3232773329696756, 'psi': 0.3902806839962961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:57012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S7] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:57002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S4] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1784 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1791) from S13
[S11] cosine check vs S13: cos=0.0865
[S17] RECEIVED delta(kind=head bytes=1788) from S4
[S17] cosine check vs S4: cos=-0.0165
[S17] DROPPED delta from S4 (cos=-0.0165 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1784) from S7
[S2] cosine check vs S7: cos=-0.0598
[S2] DROPPED delta from S7 (cos=-0.0598 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=0.0777
[S3] RECEIVED delta(kind=head bytes=1798) from S14
[S3] cosine check vs S14: cos=-0.0254
[S3] DROPPED delta from S14 (cos=-0.0254 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S5
[S6] cosine check vs S5: cos=0.0250
[S6] RECEIVED delta(kind=head bytes=1786) from S16
[S6] cosine check vs S16: cos=-0.0378
[S6] DROPPED delta from S16 (cos=-0.0378 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S2
[S5] cosine check vs S2: cos=-0.0465
[S5] DROPPED delta from S2 (cos=-0.0465 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S17
[S2] cosine check vs S17: cos=0.2365
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.223571
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.698751e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.4015 head_norm=0.891894 delta_norm=0.869875
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.151313
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.165908e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.732398 delta_norm=0.616591
[S2] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.203132
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.117372e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.885248 delta_norm=0.811737
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.732398 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7057739387505382, 'loss_val': 1.2557759295831712, 'psi': 0.36737585553335533}-{'f1_val': 0.1417771333885667, 'auprc': 0.7548531695833377, 'loss_val': 1.2753728646696756, 'psi': 0.3870075478664751}
[S3] START round=3 head_norm_before_train=1.280911 (no previous merge yet)
[S3] round=3 local utility u=0.244958 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8141737844748623, 'loss_val': 1.0476429985688698, 'psi': 0.40957355315840915}-{'f1_val': 0.13984006561410703, 'auprc': 0.7023924270564013, 'loss_val': 1.202215323735818, 'psi': 0.3648610101910247}
[S4] START round=3 head_norm_before_train=1.161705 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7772740276328525, 'loss_val': 1.22409456714174, 'psi': 0.3950455883902515}-{'f1_val': 0.3771032148900169, 'auprc': 0.7712557269918828, 'loss_val': 1.2932978840105018, 'psi': 0.5347642197307634}
[S5] START round=3 head_norm_before_train=1.267750 (no previous merge yet)
[S5] round=3 local utility u=0.955414 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7742279999454256, 'loss_val': 1.0372438302043636, 'psi': 0.560462014556822}-{'f1_val': 0.14226190476190476, 'auprc': 0.735845134214385, 'loss_val': 1.178786979231783, 'psi': 0.37969519654289685}
[S6] START round=3 head_norm_before_train=0.891894 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8017230406770942, 'loss_val': 1.2934177950838939, 'psi': 0.4055449855016069}-{'f1_val': 0.14142628205128205, 'auprc': 0.8207288673784708, 'loss_val': 1.3010823806634748, 'psi': 0.41314731618215755}
[S7] START round=3 head_norm_before_train=1.217574 (no previous merge yet)
[S7] round=3 local utility u=0.045379 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950916683842889, 'loss_val': 1.182387778329826, 'psi': 0.4032707609911706}-{'f1_val': 0.14205682272909165, 'auprc': 0.7880249658528607, 'loss_val': 1.2519454785085693, 'psi': 0.4004440799785993}
[S8] START round=3 head_norm_before_train=1.206049 (no previous merge yet)
[S8] round=3 local utility u=0.105084 metrics={'f1_val': 0.171153786732126, 'auprc': 0.6921176748471136, 'loss_val': 1.254628208923269, 'psi': 0.37953934197812106}-{'f1_val': 0.15262481796417554, 'auprc': 0.6731955160098531, 'loss_val': 1.2968568654858954, 'psi': 0.36085309718244657}
[S9] START round=3 head_norm_before_train=1.304423 (no previous merge yet)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.41689328151122174, 'auprc': 0.9917903166979553, 'loss_val': 0.8927882710661658, 'psi': 0.6468520955859152}-{'f1_val': 0.141397957139996, 'auprc': 0.6182666063261781, 'loss_val': 1.15180040374558, 'psi': 0.33214541681446885}
[S10] START round=3 head_norm_before_train=1.186891 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6977969705153226, 'loss_val': 1.2381516623353905, 'psi': 0.3622917707311634}-{'f1_val': 0.13862163754172394, 'auprc': 0.7742893892023877, 'loss_val': 1.2980557073294188, 'psi': 0.39288873820598946}
[S11] START round=3 head_norm_before_train=0.885248 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7917647509805944, 'loss_val': 1.306679702734872, 'psi': 0.4009541104161041}-{'f1_val': 0.14041368337311058, 'auprc': 0.789766454621844, 'loss_val': 1.2991477873371828, 'psi': 0.400154791872604}
[S13] START round=3 head_norm_before_train=1.199015 (no previous merge yet)
[S13] round=3 local utility u=0.029065 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5711332426819641, 'loss_val': 1.232430420512688, 'psi': 0.3126847546190175}-{'f1_val': 0.1403857625770531, 'auprc': 0.5657499676349304, 'loss_val': 1.2744097670780992, 'psi': 0.310531444600204}
[S14] START round=3 head_norm_before_train=1.217609 (no previous merge yet)
[S14] round=3 local utility u=0.128579 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8899338549166147, 'loss_val': 1.279847793147897, 'psi': 0.44018825369626813}-{'f1_val': 0.14035785288270378, 'auprc': 0.8144798276145946, 'loss_val': 1.3106438892033776, 'psi': 0.4100066427754601}
[S15] START round=3 head_norm_before_train=0.894731 cos_to_last_merge=0.9965 (last merge round=1)
[S15] round=3 local utility u=0.025459 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7790935142234785, 'loss_val': 1.2861957539429412, 'psi': 0.3954775965063264}-{'f1_val': 0.13973365136155833, 'auprc': 0.7726501003219665, 'loss_val': 1.3177834699688868, 'psi': 0.39290023094572163}
[S16] START round=3 head_norm_before_train=1.275304 (no previous merge yet)
[S16] round=3 local utility u=0.053609 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.828551714233304, 'loss_val': 1.230978856779391, 'psi': 0.41580315581284355}-{'f1_val': 0.14063745019920318, 'auprc': 0.8080385749935484, 'loss_val': 1.2766569581744631, 'psi': 0.4075979001169413}
[S17] START round=3 head_norm_before_train=0.752225 cos_to_last_merge=0.9960 (last merge round=1)
[S17] round=3 local utility u=0.140505 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8780126908979938, 'loss_val': 1.2841386848095566, 'psi': 0.4357744543496282}-{'f1_val': 0.14094896331738438, 'auprc': 0.796472282330979, 'loss_val': 1.3205269426620976, 'psi': 0.40315829092282224}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:57003
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:57007
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=-0.0563
[S6] DROPPED delta from S16 (cos=-0.0563 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] cosine check vs S14: cos=0.0022
[S3] RECEIVED delta(kind=head bytes=1790) from S8
[S3] cosine check vs S8: cos=0.0025
[S15] RECEIVED delta(kind=head bytes=1793) from S3
[S15] cosine check vs S3: cos=0.0190
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.1113
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=-0.0050
[S15] DROPPED delta from S7 (cos=-0.0050 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=0.6833
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.0260
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=-0.1203
[S10] DROPPED delta from S15 (cos=-0.1203 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=0.2325
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.917150
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.720812e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1436 head_norm=0.773678 delta_norm=0.772081
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.921531
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.757340e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.790233 delta_norm=0.475734
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4169 head_norm=1.343437
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.258333e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4169 head_norm=0.950234 delta_norm=0.925833
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.320717
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.559012e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.819829 delta_norm=0.755901
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1712 head_norm=1.233678
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.500302e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.805199 delta_norm=0.650030
[S8] aggregate: ROLLBACK (f1_val pre=0.171 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=0.764091 cos_to_last_merge=0.9957 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6114473153426998, 'loss_val': 1.201083165911177, 'psi': 0.32964520617022}-{'f1_val': 0.1417771333885667, 'auprc': 0.7057739387505382, 'loss_val': 1.2557759295831712, 'psi': 0.36737585553335533}
[S3] START round=4 head_norm_before_train=0.819829 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.876821 metrics={'f1_val': 0.4224727193828194, 'auprc': 0.796339512802612, 'loss_val': 0.936294232128185, 'psi': 0.5720194367507364}-{'f1_val': 0.13984006561410703, 'auprc': 0.8141737844748623, 'loss_val': 1.0476429985688698, 'psi': 0.40957355315840915}
[S4] START round=4 head_norm_before_train=1.200008 (no previous merge yet)
[S4] round=4 local utility u=0.051678 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7807023722229596, 'loss_val': 1.1310230394880278, 'psi': 0.3964169262262943}-{'f1_val': 0.14022662889518414, 'auprc': 0.7772740276328525, 'loss_val': 1.22409456714174, 'psi': 0.3950455883902515}
[S5] START round=4 head_norm_before_train=1.309733 (no previous merge yet)
[S5] round=4 local utility u=0.395410 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.9808788959459533, 'loss_val': 0.8641927213214523, 'psi': 0.642903984505655}-{'f1_val': 0.41795135763108626, 'auprc': 0.7742279999454256, 'loss_val': 1.0372438302043636, 'psi': 0.560462014556822}
[S6] START round=4 head_norm_before_train=0.773678 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6405012270151902, 'loss_val': 1.2889713690115019, 'psi': 0.3410562600368453}-{'f1_val': 0.14142628205128205, 'auprc': 0.8017230406770942, 'loss_val': 1.2934177950838939, 'psi': 0.4055449855016069}
[S7] START round=4 head_norm_before_train=1.248898 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.7138712770128022, 'auprc': 0.7949683264811012, 'loss_val': 0.9974836981005172, 'psi': 0.7463100968001217}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950916683842889, 'loss_val': 1.182387778329826, 'psi': 0.4032707609911706}
[S8] START round=4 head_norm_before_train=0.805199 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.17402448448405214, 'auprc': 0.6143235480044713, 'loss_val': 1.2721200525259027, 'psi': 0.35014410989221983}-{'f1_val': 0.171153786732126, 'auprc': 0.6921176748471136, 'loss_val': 1.254628208923269, 'psi': 0.37953934197812106}
[S9] START round=4 head_norm_before_train=0.950234 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.4164908106574855, 'auprc': 0.8189131362851437, 'loss_val': 0.8355022718666911, 'psi': 0.5774597409085488}-{'f1_val': 0.41689328151122174, 'auprc': 0.9917903166979553, 'loss_val': 0.8927882710661658, 'psi': 0.6468520955859152}
[S10] START round=4 head_norm_before_train=1.212888 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6128930087015931, 'loss_val': 1.1808509408641212, 'psi': 0.32833018600567165}-{'f1_val': 0.13862163754172394, 'auprc': 0.6977969705153226, 'loss_val': 1.2381516623353905, 'psi': 0.3622917707311634}
[S11] START round=4 head_norm_before_train=0.911672 cos_to_last_merge=0.9973 (last merge round=2)
[S11] round=4 local utility u=0.033542 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8025795484010735, 'loss_val': 1.2720401127622614, 'psi': 0.40528002938429575}-{'f1_val': 0.14041368337311058, 'auprc': 0.7917647509805944, 'loss_val': 1.306679702734872, 'psi': 0.4009541104161041}
[S13] START round=4 head_norm_before_train=1.227792 (no previous merge yet)
[S13] round=4 local utility u=0.028220 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5706615182292218, 'loss_val': 1.174575456214801, 'psi': 0.3124960648379206}-{'f1_val': 0.1403857625770531, 'auprc': 0.5711332426819641, 'loss_val': 1.232430420512688, 'psi': 0.3126847546190175}
[S14] START round=4 head_norm_before_train=1.244271 (no previous merge yet)
[S14] round=4 local utility u=0.042742 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9067546839080469, 'loss_val': 1.2448257928343338, 'psi': 0.44691658529284106}-{'f1_val': 0.14035785288270378, 'auprc': 0.8899338549166147, 'loss_val': 1.279847793147897, 'psi': 0.44018825369626813}
[S15] START round=4 head_norm_before_train=0.790233 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.014267 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7902135904579597, 'loss_val': 1.2910215333242063, 'psi': 0.3999256270001189}-{'f1_val': 0.13973365136155833, 'auprc': 0.7790935142234785, 'loss_val': 1.2861957539429412, 'psi': 0.3954775965063264}
[S16] START round=4 head_norm_before_train=1.304501 (no previous merge yet)
[S16] round=4 local utility u=0.022976 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8295331738748556, 'loss_val': 1.1879712231608202, 'psi': 0.4161957396694642}-{'f1_val': 0.14063745019920318, 'auprc': 0.828551714233304, 'loss_val': 1.230978856779391, 'psi': 0.41580315581284355}
[S17] START round=4 head_norm_before_train=0.787279 cos_to_last_merge=0.9859 (last merge round=1)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8189320082355849, 'loss_val': 1.2361483346418376, 'psi': 0.4121421812846646}-{'f1_val': 0.14094896331738438, 'auprc': 0.8780126908979938, 'loss_val': 1.2841386848095566, 'psi': 0.4357744543496282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:57011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:57008
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=0.7814
[S7] RECEIVED delta(kind=head bytes=1794) from S11
[S7] cosine check vs S11: cos=-0.0341
[S7] DROPPED delta from S11 (cos=-0.0341 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S3
[S15] cosine check vs S3: cos=0.3632
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0710
[S6] DROPPED delta from S16 (cos=-0.0710 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] cosine check vs S15: cos=-0.0757
[S10] DROPPED delta from S15 (cos=-0.0757 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=0.7878
[S15] RECEIVED delta(kind=head bytes=1793) from S7
[S15] cosine check vs S7: cos=-0.0249
[S15] DROPPED delta from S7 (cos=-0.0249 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S4
[S2] cosine check vs S4: cos=-0.0160
[S2] DROPPED delta from S4 (cos=-0.0160 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.6473
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.4165 head_norm=1.009020
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.223262e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.4166 head_norm=1.077507 delta_norm=0.522326
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.793472
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.087610e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.977198 delta_norm=0.408761
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.810476
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.221069e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.762203 delta_norm=0.222107
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.798034 cos_to_last_merge=0.9863 (last merge round=2)
[S2] round=5 local utility u=0.043584 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6197388787472464, 'loss_val': 1.138789518593694, 'psi': 0.3329618315320386}-{'f1_val': 0.1417771333885667, 'auprc': 0.6114473153426998, 'loss_val': 1.201083165911177, 'psi': 0.32964520617022}
[S3] START round=5 head_norm_before_train=0.887419 cos_to_last_merge=0.9919 (last merge round=3)
[S3] round=5 local utility u=0.132434 metrics={'f1_val': 0.4059122689826149, 'auprc': 0.8741136368091271, 'loss_val': 0.8053850066324199, 'psi': 0.5931928161132198}-{'f1_val': 0.4224727193828194, 'auprc': 0.796339512802612, 'loss_val': 0.936294232128185, 'psi': 0.5720194367507364}
[S4] START round=5 head_norm_before_train=1.243114 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.6325534021657291, 'auprc': 0.7843534545369053, 'loss_val': 0.9956644522018563, 'psi': 0.6932734231141996}-{'f1_val': 0.14022662889518414, 'auprc': 0.7807023722229596, 'loss_val': 1.1310230394880278, 'psi': 0.3964169262262943}
[S5] START round=5 head_norm_before_train=1.359988 (no previous merge yet)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.4181537288170242, 'auprc': 0.9328808067724162, 'loss_val': 0.7991515494901386, 'psi': 0.6240445599991811}-{'f1_val': 0.4175873768787894, 'auprc': 0.9808788959459533, 'loss_val': 0.8641927213214523, 'psi': 0.642903984505655}
[S6] START round=5 head_norm_before_train=0.977198 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6119529318868898, 'loss_val': 1.2710575106327153, 'psi': 0.3296369419855252}-{'f1_val': 0.14142628205128205, 'auprc': 0.6405012270151902, 'loss_val': 1.2889713690115019, 'psi': 0.3410562600368453}
[S7] START round=5 head_norm_before_train=1.298595 (no previous merge yet)
[S7] round=5 local utility u=0.070916 metrics={'f1_val': 0.6961006369111069, 'auprc': 0.7943990273987573, 'loss_val': 0.747320297260136, 'psi': 0.7354199931061671}-{'f1_val': 0.7138712770128022, 'auprc': 0.7949683264811012, 'loss_val': 0.9974836981005172, 'psi': 0.7463100968001217}
[S8] START round=5 head_norm_before_train=0.831647 cos_to_last_merge=0.9973 (last merge round=3)
[S8] round=5 local utility u=0.427773 metrics={'f1_val': 0.3025458042537752, 'auprc': 0.6159813590199225, 'loss_val': 1.1926763625008256, 'psi': 0.4279200261602341}-{'f1_val': 0.17402448448405214, 'auprc': 0.6143235480044713, 'loss_val': 1.2721200525259027, 'psi': 0.35014410989221983}
[S9] START round=5 head_norm_before_train=1.077507 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.386707 metrics={'f1_val': 0.43884980350236025, 'auprc': 0.9990714957220054, 'loss_val': 0.7367182678667367, 'psi': 0.6629384803902183}-{'f1_val': 0.4164908106574855, 'auprc': 0.8189131362851437, 'loss_val': 0.8355022718666911, 'psi': 0.5774597409085488}
[S10] START round=5 head_norm_before_train=1.234450 (no previous merge yet)
[S10] round=5 local utility u=0.041579 metrics={'f1_val': 0.13927796409548235, 'auprc': 0.6097080799999605, 'loss_val': 1.092076380841304, 'psi': 0.3274500104572736}-{'f1_val': 0.13862163754172394, 'auprc': 0.6128930087015931, 'loss_val': 1.1808509408641212, 'psi': 0.32833018600567165}
[S11] START round=5 head_norm_before_train=0.946008 cos_to_last_merge=0.9903 (last merge round=2)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7813224322196256, 'loss_val': 1.2362752446217637, 'psi': 0.3967771829117166}-{'f1_val': 0.14041368337311058, 'auprc': 0.8025795484010735, 'loss_val': 1.2720401127622614, 'psi': 0.40528002938429575}
[S13] START round=5 head_norm_before_train=1.256075 (no previous merge yet)
[S13] round=5 local utility u=0.825164 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.5399969079278198, 'loss_val': 1.0864065454753904, 'psi': 0.46564549149990286}-{'f1_val': 0.1403857625770531, 'auprc': 0.5706615182292218, 'loss_val': 1.174575456214801, 'psi': 0.3124960648379206}
[S14] START round=5 head_norm_before_train=1.270593 (no previous merge yet)
[S14] round=5 local utility u=0.005861 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8891599951852409, 'loss_val': 1.1803189687829827, 'psi': 0.4398787098037186}-{'f1_val': 0.14035785288270378, 'auprc': 0.9067546839080469, 'loss_val': 1.2448257928343338, 'psi': 0.44691658529284106}
[S15] START round=5 head_norm_before_train=0.762203 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.023519 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7981683661570246, 'loss_val': 1.267848004153587, 'psi': 0.40310753727974485}-{'f1_val': 0.13973365136155833, 'auprc': 0.7902135904579597, 'loss_val': 1.2910215333242063, 'psi': 0.3999256270001189}
[S16] START round=5 head_norm_before_train=1.335295 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7722416425202611, 'loss_val': 1.1178046165429425, 'psi': 0.39327912712762636}-{'f1_val': 0.14063745019920318, 'auprc': 0.8295331738748556, 'loss_val': 1.1879712231608202, 'psi': 0.4161957396694642}
[S17] START round=5 head_norm_before_train=0.822737 cos_to_last_merge=0.9737 (last merge round=1)
[S17] round=5 local utility u=0.002550 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7932566043720303, 'loss_val': 1.1540223402589802, 'psi': 0.40187201973924275}-{'f1_val': 0.14094896331738438, 'auprc': 0.8189320082355849, 'loss_val': 1.2361483346418376, 'psi': 0.4121421812846646}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] cosine check vs S3: cos=0.4799
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=-0.0170
[S2] DROPPED delta from S4 (cos=-0.0170 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1788) from S2
[S10] cosine check vs S2: cos=-0.0164
[S10] DROPPED delta from S2 (cos=-0.0164 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S13
[S15] cosine check vs S13: cos=0.8211
[S15] RECEIVED delta(kind=head bytes=1793) from S7
[S15] cosine check vs S7: cos=-0.0354
[S15] DROPPED delta from S7 (cos=-0.0354 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=-0.0613
[S10] DROPPED delta from S15 (cos=-0.0613 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.0766
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.9532
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.2643
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.3608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1789 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1789) from S17
[S8] cosine check vs S17: cos=0.5966
[S11] ⇄ pheromone p=0.365 → S7@127.0.0.1:57008
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.989492
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.353169e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=1.134644 delta_norm=0.235317
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.410 → S8@127.0.0.1:57009
[S5] ⇄ pheromone p=0.532 → S9@127.0.0.1:57010
[S2] ⇄ pheromone p=0.388 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.361 → S6@127.0.0.1:57007
[S10] ⇄ pheromone p=0.418 → S7@127.0.0.1:57008
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.4059 head_norm=0.976213
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.917447e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4024 head_norm=0.735737 delta_norm=0.491745
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.529 → S15@127.0.0.1:57015
[S9] ⇄ pheromone p=0.544 → S3@127.0.0.1:57003
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.782328
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.489193e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.786103 delta_norm=0.148919
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.420 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=0.508 → S15@127.0.0.1:57015
[S4] ⇄ pheromone p=0.655 → S2@127.0.0.1:57002
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.6961 head_norm=1.364293
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.919109e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.6832 head_norm=0.962854 delta_norm=0.891911
[S7] aggregate: ROLLBACK (f1_val pre=0.696 post=0.683 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.514 → S15@127.0.0.1:57015
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.3025 head_norm=0.868716
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.872328e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1917 head_norm=0.770283 delta_norm=0.387233
[S8] aggregate: ROLLBACK (f1_val pre=0.303 post=0.192 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.496 → S3@127.0.0.1:57003
[S16] ⇄ pheromone p=0.362 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=0.365 → S8@127.0.0.1:57009
[S2] START round=6 head_norm_before_train=0.823228 cos_to_last_merge=0.9780 (last merge round=2)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.41592297122298333, 'auprc': 0.7755567563117278, 'loss_val': 1.0687660556711553, 'psi': 0.5597764852584811}-{'f1_val': 0.1417771333885667, 'auprc': 0.6197388787472464, 'loss_val': 1.138789518593694, 'psi': 0.3329618315320386}
[S3] START round=6 head_norm_before_train=0.735737 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.216316 metrics={'f1_val': 0.45338637895390227, 'auprc': 0.9087443773588579, 'loss_val': 0.7614901814720321, 'psi': 0.6355295783158845}-{'f1_val': 0.4059122689826149, 'auprc': 0.8741136368091271, 'loss_val': 0.8053850066324199, 'psi': 0.5931928161132198}
[S4] START round=6 head_norm_before_train=1.284351 (no previous merge yet)
[S4] round=6 local utility u=0.028617 metrics={'f1_val': 0.6699016947201182, 'auprc': 0.6611178754064675, 'loss_val': 0.7928125844929025, 'psi': 0.6663881669946579}-{'f1_val': 0.6325534021657291, 'auprc': 0.7843534545369053, 'loss_val': 0.9956644522018563, 'psi': 0.6932734231141996}
[S5] START round=6 head_norm_before_train=1.405378 (no previous merge yet)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.41774624146170947, 'auprc': 0.8651775602176426, 'loss_val': 0.7057811492957262, 'psi': 0.5967187689640827}-{'f1_val': 0.4181537288170242, 'auprc': 0.9328808067724162, 'loss_val': 0.7991515494901386, 'psi': 0.6240445599991811}
[S6] START round=6 head_norm_before_train=1.134644 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.015957 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6125348479762984, 'loss_val': 1.240888979266318, 'psi': 0.3298697084212886}-{'f1_val': 0.14142628205128205, 'auprc': 0.6119529318868898, 'loss_val': 1.2710575106327153, 'psi': 0.3296369419855252}
[S7] START round=6 head_norm_before_train=0.962854 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.6385657413348137, 'auprc': 0.7892032586481588, 'loss_val': 0.7414937889984293, 'psi': 0.6988207482601517}-{'f1_val': 0.6961006369111069, 'auprc': 0.7943990273987573, 'loss_val': 0.747320297260136, 'psi': 0.7354199931061671}
[S8] START round=6 head_norm_before_train=0.770283 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.287266 metrics={'f1_val': 0.416084496488008, 'auprc': 0.5730205864707231, 'loss_val': 1.1704951842341422, 'psi': 0.478858932481094}-{'f1_val': 0.3025458042537752, 'auprc': 0.6159813590199225, 'loss_val': 1.1926763625008256, 'psi': 0.4279200261602341}
[S9] START round=6 head_norm_before_train=1.135737 cos_to_last_merge=0.9892 (last merge round=4)
[S9] round=6 local utility u=0.052521 metrics={'f1_val': 0.46572227826217794, 'auprc': 0.9457244368570399, 'loss_val': 0.6328699682958709, 'psi': 0.6577231417001228}-{'f1_val': 0.43884980350236025, 'auprc': 0.9990714957220054, 'loss_val': 0.7367182678667367, 'psi': 0.6629384803902183}
[S10] START round=6 head_norm_before_train=1.258527 (no previous merge yet)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.4366756612062889, 'auprc': 0.6645056422872063, 'loss_val': 0.958893652174687, 'psi': 0.5278076536386558}-{'f1_val': 0.13927796409548235, 'auprc': 0.6097080799999605, 'loss_val': 1.092076380841304, 'psi': 0.3274500104572736}
[S11] START round=6 head_norm_before_train=0.984588 cos_to_last_merge=0.9810 (last merge round=2)
[S11] round=6 local utility u=0.039958 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.78786885577325, 'loss_val': 1.1759985169216225, 'psi': 0.3993957523331664}-{'f1_val': 0.14041368337311058, 'auprc': 0.7813224322196256, 'loss_val': 1.2362752446217637, 'psi': 0.3967771829117166}
[S13] START round=6 head_norm_before_train=1.284311 (no previous merge yet)
[S13] round=6 local utility u=0.032937 metrics={'f1_val': 0.4163167573796875, 'auprc': 0.5270402387341226, 'loss_val': 0.9830963821633405, 'psi': 0.46060614992146154}-{'f1_val': 0.41607788054795825, 'auprc': 0.5399969079278198, 'loss_val': 1.0864065454753904, 'psi': 0.46564549149990286}
[S14] START round=6 head_norm_before_train=1.306326 (no previous merge yet)
[S14] round=6 local utility u=0.122629 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9337803389916446, 'loss_val': 1.068921812445902, 'psi': 0.4577268473262801}-{'f1_val': 0.14035785288270378, 'auprc': 0.8891599951852409, 'loss_val': 1.1803189687829827, 'psi': 0.4398787098037186}
[S15] START round=6 head_norm_before_train=0.786103 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.026661 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8000620491831056, 'loss_val': 1.2202073225237475, 'psi': 0.40386501049017726}-{'f1_val': 0.13973365136155833, 'auprc': 0.7981683661570246, 'loss_val': 1.267848004153587, 'psi': 0.40310753727974485}
[S16] START round=6 head_norm_before_train=1.359398 (no previous merge yet)
[S16] round=6 local utility u=0.623729 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.5961671247350804, 'loss_val': 1.0028280076765117, 'psi': 0.4889198999036221}-{'f1_val': 0.14063745019920318, 'auprc': 0.7722416425202611, 'loss_val': 1.1178046165429425, 'psi': 0.39327912712762636}
[S17] START round=6 head_norm_before_train=0.855513 cos_to_last_merge=0.9619 (last merge round=1)
[S17] round=6 local utility u=0.799146 metrics={'f1_val': 0.3821322811805789, 'auprc': 0.7978567001316736, 'loss_val': 1.0166307751655446, 'psi': 0.5484220487610169}-{'f1_val': 0.14094896331738438, 'auprc': 0.7932566043720303, 'loss_val': 1.1540223402589802, 'psi': 0.40187201973924275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:57015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:57011
[S2] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.8103
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0774
[S7] DROPPED delta from S11 (cos=-0.0774 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S3
[S15] cosine check vs S3: cos=0.4802
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.5888
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=-0.0173
[S2] DROPPED delta from S4 (cos=-0.0173 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.6615
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.0163
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=-0.0526
[S6] DROPPED delta from S16 (cos=-0.0526 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=-0.0554
[S10] DROPPED delta from S15 (cos=-0.0554 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=0.9806
[S10] RECEIVED delta(kind=head bytes=1792) from S2
[S10] cosine check vs S2: cos=-0.0145
[S10] DROPPED delta from S2 (cos=-0.0145 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=0.5644
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S17] → sending delta(kind=head bytes=1784) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1784 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1784) from S17
[S8] cosine check vs S17: cos=0.8500
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.6386 head_norm=1.037081
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.910359e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.6426 head_norm=1.059816 delta_norm=0.491036
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.4534 head_norm=0.835653
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.197965e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.4378 head_norm=0.764592 delta_norm=0.319797
[S3] aggregate: ROLLBACK (f1_val pre=0.453 post=0.438 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.809309
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.440171e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.786198 delta_norm=0.144017
[S15] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=1.148121
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.585438e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.242604 delta_norm=0.158544
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4161 head_norm=0.798883
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.682105e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.6568 head_norm=0.670310 delta_norm=0.368211
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.847952 cos_to_last_merge=0.9693 (last merge round=2)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.41663915620715675, 'auprc': 0.7413043192116904, 'loss_val': 0.9951113067133222, 'psi': 0.5465052214089702}-{'f1_val': 0.41592297122298333, 'auprc': 0.7755567563117278, 'loss_val': 1.0687660556711553, 'psi': 0.5597764852584811}
[S3] START round=7 head_norm_before_train=0.764592 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.923161 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9981113142024667, 'loss_val': 0.6619272868478732, 'psi': 0.8191422551992587}-{'f1_val': 0.45338637895390227, 'auprc': 0.9087443773588579, 'loss_val': 0.7614901814720321, 'psi': 0.6355295783158845}
[S4] START round=7 head_norm_before_train=1.333435 (no previous merge yet)
[S4] round=7 local utility u=0.096310 metrics={'f1_val': 0.6672373062873005, 'auprc': 0.6604091997284474, 'loss_val': 0.5820797710393345, 'psi': 0.6645060636637592}-{'f1_val': 0.6699016947201182, 'auprc': 0.6611178754064675, 'loss_val': 0.7928125844929025, 'psi': 0.6663881669946579}
[S5] START round=7 head_norm_before_train=1.446891 (no previous merge yet)
[S5] round=7 local utility u=0.381407 metrics={'f1_val': 0.5189180827335076, 'auprc': 0.8895633639857631, 'loss_val': 0.6231563771189002, 'psi': 0.6671761952344097}-{'f1_val': 0.41774624146170947, 'auprc': 0.8651775602176426, 'loss_val': 0.7057811492957262, 'psi': 0.5967187689640827}
[S6] START round=7 head_norm_before_train=1.242604 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.197324 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7201417311445877, 'loss_val': 1.1690615109116553, 'psi': 0.3729124616886043}-{'f1_val': 0.14142628205128205, 'auprc': 0.6125348479762984, 'loss_val': 1.240888979266318, 'psi': 0.3298697084212886}
[S7] START round=7 head_norm_before_train=1.059816 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.5682645569146736, 'auprc': 0.7823142436337657, 'loss_val': 0.846819586676867, 'psi': 0.6538844316023105}-{'f1_val': 0.6385657413348137, 'auprc': 0.7892032586481588, 'loss_val': 0.7414937889984293, 'psi': 0.6988207482601517}
[S8] START round=7 head_norm_before_train=0.670310 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.101652 metrics={'f1_val': 0.41593493692345573, 'auprc': 0.6275463626852443, 'loss_val': 1.1298720711969958, 'psi': 0.5005795072281711}-{'f1_val': 0.416084496488008, 'auprc': 0.5730205864707231, 'loss_val': 1.1704951842341422, 'psi': 0.478858932481094}
[S9] START round=7 head_norm_before_train=1.211916 cos_to_last_merge=0.9676 (last merge round=4)
[S9] round=7 local utility u=0.899134 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9992788937955884, 'loss_val': 0.4082309015088484, 'psi': 0.8204415059822465}-{'f1_val': 0.46572227826217794, 'auprc': 0.9457244368570399, 'loss_val': 0.6328699682958709, 'psi': 0.6577231417001228}
[S10] START round=7 head_norm_before_train=1.285735 (no previous merge yet)
[S10] round=7 local utility u=0.519024 metrics={'f1_val': 0.5192800318742508, 'auprc': 0.7921020355209227, 'loss_val': 0.7992610762512288, 'psi': 0.6284088333329196}-{'f1_val': 0.4366756612062889, 'auprc': 0.6645056422872063, 'loss_val': 0.958893652174687, 'psi': 0.5278076536386558}
[S11] START round=7 head_norm_before_train=1.026342 cos_to_last_merge=0.9708 (last merge round=2)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.9043184784225516, 'loss_val': 1.0428428802797443, 'psi': 0.6153698256073477}-{'f1_val': 0.14041368337311058, 'auprc': 0.78786885577325, 'loss_val': 1.1759985169216225, 'psi': 0.3993957523331664}
[S13] START round=7 head_norm_before_train=1.326556 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.4846125428617214, 'loss_val': 0.9363093655305521, 'psi': 0.4434473369041656}-{'f1_val': 0.4163167573796875, 'auprc': 0.5270402387341226, 'loss_val': 0.9830963821633405, 'psi': 0.46060614992146154}
[S14] START round=7 head_norm_before_train=1.349155 (no previous merge yet)
[S14] round=7 local utility u=0.959445 metrics={'f1_val': 0.4021952394277585, 'auprc': 0.9923612852832417, 'loss_val': 0.8967982091539313, 'psi': 0.6382616577699518}-{'f1_val': 0.14035785288270378, 'auprc': 0.9337803389916446, 'loss_val': 1.068921812445902, 'psi': 0.4577268473262801}
[S15] START round=7 head_norm_before_train=0.786198 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.854937 metrics={'f1_val': 0.4156068426860873, 'auprc': 0.7860644128269272, 'loss_val': 1.123579568360364, 'psi': 0.5637898707424233}-{'f1_val': 0.13973365136155833, 'auprc': 0.8000620491831056, 'loss_val': 1.2202073225237475, 'psi': 0.40386501049017726}
[S16] START round=7 head_norm_before_train=1.389133 (no previous merge yet)
[S16] round=7 local utility u=0.269205 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.7375121269024725, 'loss_val': 0.8868721694283624, 'psi': 0.5452998796301624}-{'f1_val': 0.41742175001598325, 'auprc': 0.5961671247350804, 'loss_val': 1.0028280076765117, 'psi': 0.4889198999036221}
[S17] START round=7 head_norm_before_train=0.902087 cos_to_last_merge=0.9458 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=7 local utility u=0.132827 metrics={'f1_val': 0.37428978988044925, 'auprc': 0.8768945557577469, 'loss_val': 0.9410358044302867, 'psi': 0.5753316962313684}-{'f1_val': 0.3821322811805789, 'auprc': 0.7978567001316736, 'loss_val': 1.0166307751655446, 'psi': 0.5484220487610169}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S17] → sending delta(kind=head bytes=1782) to S8@127.0.0.1:57009
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.5844
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.7143
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.7884
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.4005
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0434
[S6] DROPPED delta from S16 (cos=-0.0434 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=0.9875
[S7] RECEIVED delta(kind=head bytes=1793) from S11
[S7] cosine check vs S11: cos=-0.0785
[S7] DROPPED delta from S11 (cos=-0.0785 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.8865
[S2] RECEIVED delta(kind=head bytes=1791) from S4
[S2] cosine check vs S4: cos=-0.0157
[S2] DROPPED delta from S4 (cos=-0.0157 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.4477
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=-0.0551
[S10] DROPPED delta from S15 (cos=-0.0551 < 0.0)
[S17] sending update (kind=head size=1782 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1782) from S17
[S8] cosine check vs S17: cos=0.8032
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.5683 head_norm=1.119089
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.065512e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.6061 head_norm=1.184936 delta_norm=0.306551
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.6998 head_norm=0.865642
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.593095e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.6998 head_norm=0.802050 delta_norm=0.259310
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=1.256793
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.252943e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=1.321414 delta_norm=0.125294
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.4159 head_norm=0.703109
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.291540e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.4159 head_norm=0.707072 delta_norm=0.229154
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4156 head_norm=0.814153
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.419241e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4162 head_norm=0.714698 delta_norm=0.441924
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=1.287894
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.596874e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7012 head_norm=1.309954 delta_norm=0.459687
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.889018 cos_to_last_merge=0.9556 (last merge round=2)
[S2] round=8 local utility u=0.824749 metrics={'f1_val': 0.6934090712136571, 'auprc': 0.6977869061767588, 'loss_val': 0.8756806229170964, 'psi': 0.6951602051988978}-{'f1_val': 0.41663915620715675, 'auprc': 0.7413043192116904, 'loss_val': 0.9951113067133222, 'psi': 0.5465052214089702}
[S3] START round=8 head_norm_before_train=0.802050 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.043782 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9966685019799499, 'loss_val': 0.5715391755865088, 'psi': 0.818715582948131}-{'f1_val': 0.69982954919712, 'auprc': 0.9981113142024667, 'loss_val': 0.6619272868478732, 'psi': 0.8191422551992587}
[S4] START round=8 head_norm_before_train=1.392906 (no previous merge yet)
[S4] round=8 local utility u=0.016242 metrics={'f1_val': 0.6594227727441188, 'auprc': 0.6539435189144327, 'loss_val': 0.4833114328763054, 'psi': 0.6572310712122443}-{'f1_val': 0.6672373062873005, 'auprc': 0.6604091997284474, 'loss_val': 0.5820797710393345, 'psi': 0.6645060636637592}
[S5] START round=8 head_norm_before_train=1.481862 (no previous merge yet)
[S5] round=8 local utility u=0.638177 metrics={'f1_val': 0.6837058136293879, 'auprc': 0.9507206069579779, 'loss_val': 0.5190009101532265, 'psi': 0.7905117309608238}-{'f1_val': 0.5189180827335076, 'auprc': 0.8895633639857631, 'loss_val': 0.6231563771189002, 'psi': 0.6671761952344097}
[S6] START round=8 head_norm_before_train=1.321414 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.877232 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.7205165885484941, 'loss_val': 1.067090717950728, 'psi': 0.5381993231527047}-{'f1_val': 0.14142628205128205, 'auprc': 0.7201417311445877, 'loss_val': 1.1690615109116553, 'psi': 0.3729124616886043}
[S7] START round=8 head_norm_before_train=1.184936 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.447135 metrics={'f1_val': 0.6465228426217364, 'auprc': 0.8546417988740933, 'loss_val': 0.6390815156831577, 'psi': 0.7297704251226792}-{'f1_val': 0.5682645569146736, 'auprc': 0.7823142436337657, 'loss_val': 0.846819586676867, 'psi': 0.6538844316023105}
[S8] START round=8 head_norm_before_train=0.707072 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.040041 metrics={'f1_val': 0.41593493692345573, 'auprc': 0.635981380547943, 'loss_val': 1.0750955211131592, 'psi': 0.5039535143732505}-{'f1_val': 0.41593493692345573, 'auprc': 0.6275463626852443, 'loss_val': 1.1298720711969958, 'psi': 0.5005795072281711}
[S9] START round=8 head_norm_before_train=1.309954 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.026230 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982814211685085, 'loss_val': 0.3527793892268352, 'psi': 0.8200425169314145}-{'f1_val': 0.7012165807733519, 'auprc': 0.9992788937955884, 'loss_val': 0.4082309015088484, 'psi': 0.8204415059822465}
[S10] START round=8 head_norm_before_train=1.320505 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.4212609361383215, 'auprc': 0.8308884345420195, 'loss_val': 0.7049499759043122, 'psi': 0.5851119354998007}-{'f1_val': 0.5192800318742508, 'auprc': 0.7921020355209227, 'loss_val': 0.7992610762512288, 'psi': 0.6284088333329196}
[S11] START round=8 head_norm_before_train=1.062995 cos_to_last_merge=0.9608 (last merge round=2)
[S11] round=8 local utility u=0.188992 metrics={'f1_val': 0.4150663577634667, 'auprc': 0.9769718972861883, 'loss_val': 0.8367923240858804, 'psi': 0.6398285735725553}-{'f1_val': 0.42273739039721175, 'auprc': 0.9043184784225516, 'loss_val': 1.0428428802797443, 'psi': 0.6153698256073477}
[S13] START round=8 head_norm_before_train=1.367244 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.4294880456058212, 'loss_val': 0.883698175684064, 'psi': 0.42139753800180557}-{'f1_val': 0.4160038662657951, 'auprc': 0.4846125428617214, 'loss_val': 0.9363093655305521, 'psi': 0.4434473369041656}
[S14] START round=8 head_norm_before_train=1.394324 (no previous merge yet)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.700856843639516, 'auprc': 0.9921338687000745, 'loss_val': 0.6457473704242659, 'psi': 0.8173676536637393}-{'f1_val': 0.4021952394277585, 'auprc': 0.9923612852832417, 'loss_val': 0.8967982091539313, 'psi': 0.6382616577699518}
[S15] START round=8 head_norm_before_train=0.714698 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.048745 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7989277141445058, 'loss_val': 1.0704450774141023, 'psi': 0.5695116891265597}-{'f1_val': 0.4156068426860873, 'auprc': 0.7860644128269272, 'loss_val': 1.123579568360364, 'psi': 0.5637898707424233}
[S16] START round=8 head_norm_before_train=1.420063 (no previous merge yet)
[S16] round=8 local utility u=0.066687 metrics={'f1_val': 0.43156532213956855, 'auprc': 0.7463609940624055, 'loss_val': 0.8664866465612417, 'psi': 0.5574835909087033}-{'f1_val': 0.4171583814486223, 'auprc': 0.7375121269024725, 'loss_val': 0.8868721694283624, 'psi': 0.5452998796301624}
[S17] START round=8 head_norm_before_train=0.957860 cos_to_last_merge=0.9271 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3528326351486136, 'auprc': 0.8008945412002899, 'loss_val': 0.8876202655353532, 'psi': 0.5320573975692842}-{'f1_val': 0.37428978988044925, 'auprc': 0.8768945557577469, 'loss_val': 0.9410358044302867, 'psi': 0.5753316962313684}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=0.7903
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.1043
[S15] DROPPED delta from S7 (cos=-0.1043 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.5999
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.7573
[S7] RECEIVED delta(kind=head bytes=1788) from S11
[S7] cosine check vs S11: cos=-0.0684
[S7] DROPPED delta from S11 (cos=-0.0684 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:57011
[S15] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:57011
[S10] RECEIVED delta(kind=head bytes=1791) from S15
[S10] cosine check vs S15: cos=-0.0593
[S10] DROPPED delta from S15 (cos=-0.0593 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.5298
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0151
[S2] DROPPED delta from S4 (cos=-0.0151 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0358
[S6] DROPPED delta from S16 (cos=-0.0358 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1787) from S2
[S10] cosine check vs S2: cos=-0.0058
[S10] DROPPED delta from S2 (cos=-0.0058 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9260
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=0.9908
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7001 head_norm=0.907526
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.634227e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7001 head_norm=0.850168 delta_norm=0.263423
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=1.382855
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.883055e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.9761 head_norm=1.427030 delta_norm=0.288305
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4167 head_norm=1.334580
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.106050e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4169 head_norm=1.388829 delta_norm=0.110605
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4166 head_norm=0.746125
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.784254e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4166 head_norm=0.782708 delta_norm=0.278425
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.4159 head_norm=0.741148
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.346906e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.4159 head_norm=0.937715 delta_norm=0.534691
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.933110 cos_to_last_merge=0.9405 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=9 local utility u=0.005260 metrics={'f1_val': 0.6563544044353611, 'auprc': 0.7758338403867024, 'loss_val': 0.8769733949107751, 'psi': 0.7041461788158976}-{'f1_val': 0.6934090712136571, 'auprc': 0.6977869061767588, 'loss_val': 0.8756806229170964, 'psi': 0.6951602051988978}
[S3] START round=9 head_norm_before_train=0.850168 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.049917 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9962998884548431, 'loss_val': 0.47465553051481413, 'psi': 0.818973677623117}-{'f1_val': 0.7000803035935849, 'auprc': 0.9966685019799499, 'loss_val': 0.5715391755865088, 'psi': 0.818715582948131}
[S4] START round=9 head_norm_before_train=1.455898 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6523891585166761, 'auprc': 0.6497535289639162, 'loss_val': 0.4557653385576732, 'psi': 0.6513349066955721}-{'f1_val': 0.6594227727441188, 'auprc': 0.6539435189144327, 'loss_val': 0.4833114328763054, 'psi': 0.6572310712122443}
[S5] START round=9 head_norm_before_train=1.525380 (no previous merge yet)
[S5] round=9 local utility u=0.147903 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9769941878128074, 'loss_val': 0.40319117465071175, 'psi': 0.811138781127914}-{'f1_val': 0.6837058136293879, 'auprc': 0.9507206069579779, 'loss_val': 0.5190009101532265, 'psi': 0.7905117309608238}
[S6] START round=9 head_norm_before_train=1.388829 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.720734 metrics={'f1_val': 0.6054901572164753, 'auprc': 0.7773989365124689, 'loss_val': 0.9292840057580614, 'psi': 0.6742536689348727}-{'f1_val': 0.4166544795555117, 'auprc': 0.7205165885484941, 'loss_val': 1.067090717950728, 'psi': 0.5381993231527047}
[S7] START round=9 head_norm_before_train=1.232223 cos_to_last_merge=0.9937 (last merge round=7)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6142974006125582, 'auprc': 0.6631926766710896, 'loss_val': 0.6770719315567486, 'psi': 0.6338555110359707}-{'f1_val': 0.6465228426217364, 'auprc': 0.8546417988740933, 'loss_val': 0.6390815156831577, 'psi': 0.7297704251226792}
[S8] START round=9 head_norm_before_train=0.937715 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.7138828428684335, 'auprc': 0.7735834091542608, 'loss_val': 1.0160059983558711, 'psi': 0.7377630693827645}-{'f1_val': 0.41593493692345573, 'auprc': 0.635981380547943, 'loss_val': 1.0750955211131592, 'psi': 0.5039535143732505}
[S9] START round=9 head_norm_before_train=1.427030 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.674669 metrics={'f1_val': 0.9350481027582153, 'auprc': 0.9899140590000105, 'loss_val': 0.38132765910217264, 'psi': 0.9569944852549334}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982814211685085, 'loss_val': 0.3527793892268352, 'psi': 0.8200425169314145}
[S10] START round=9 head_norm_before_train=1.361894 (no previous merge yet)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6959424417629968, 'auprc': 0.9640050110270684, 'loss_val': 0.5913117548484831, 'psi': 0.8031674694686255}-{'f1_val': 0.4212609361383215, 'auprc': 0.8308884345420195, 'loss_val': 0.7049499759043122, 'psi': 0.5851119354998007}
[S11] START round=9 head_norm_before_train=1.111795 cos_to_last_merge=0.9474 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=9 local utility u=0.111263 metrics={'f1_val': 0.40499072134281344, 'auprc': 0.9990290942735647, 'loss_val': 0.6199833847356844, 'psi': 0.642606070515114}-{'f1_val': 0.4150663577634667, 'auprc': 0.9769718972861883, 'loss_val': 0.8367923240858804, 'psi': 0.6398285735725553}
[S13] START round=9 head_norm_before_train=1.397440 (no previous merge yet)
[S13] round=9 local utility u=0.011672 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.42216134087806734, 'loss_val': 0.8371947412736979, 'psi': 0.41834889754264526}-{'f1_val': 0.4160038662657951, 'auprc': 0.4294880456058212, 'loss_val': 0.883698175684064, 'psi': 0.42139753800180557}
[S14] START round=9 head_norm_before_train=1.449501 (no previous merge yet)
[S14] round=9 local utility u=0.079367 metrics={'f1_val': 0.6972356188612059, 'auprc': 0.9943669580347848, 'loss_val': 0.47198496507131793, 'psi': 0.8160881545306374}-{'f1_val': 0.700856843639516, 'auprc': 0.9921338687000745, 'loss_val': 0.6457473704242659, 'psi': 0.8173676536637393}
[S15] START round=9 head_norm_before_train=0.782708 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.4121070335711168, 'auprc': 0.714160119210331, 'loss_val': 1.0161063390142024, 'psi': 0.5329282678268025}-{'f1_val': 0.416567672447929, 'auprc': 0.7989277141445058, 'loss_val': 1.0704450774141023, 'psi': 0.5695116891265597}
[S16] START round=9 head_norm_before_train=1.455527 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3897969239415995, 'auprc': 0.7613622004968467, 'loss_val': 0.8294588284962192, 'psi': 0.5384230345636984}-{'f1_val': 0.43156532213956855, 'auprc': 0.7463609940624055, 'loss_val': 0.8664866465612417, 'psi': 0.5574835909087033}
[S17] START round=9 head_norm_before_train=1.014686 cos_to_last_merge=0.9083 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.7723574905743994, 'loss_val': 0.8888528868563413, 'psi': 0.5205826099765755}-{'f1_val': 0.3528326351486136, 'auprc': 0.8008945412002899, 'loss_val': 0.8876202655353532, 'psi': 0.5320573975692842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] → sending delta(kind=head bytes=1810) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1810 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0704
[S7] DROPPED delta from S11 (cos=-0.0704 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9234
[S3] RECEIVED delta(kind=head bytes=1789) from S8
[S3] cosine check vs S8: cos=0.3269
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] cosine check vs S14: cos=0.9918
[S3] RECEIVED delta(kind=head bytes=1810) from S9
[S3] cosine check vs S9: cos=0.7961
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9632
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=0.8960
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=0.2270
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=0.9228
[S10] RECEIVED delta(kind=head bytes=1792) from S2
[S10] cosine check vs S2: cos=-0.0050
[S10] DROPPED delta from S2 (cos=-0.0050 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7139 head_norm=0.962282
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.178261e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.4956 head_norm=1.161991 delta_norm=0.317826
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.496 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7008 head_norm=0.945967
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.926725e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7008 head_norm=0.893766 delta_norm=0.292673
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6055 head_norm=1.405875
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.051228e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.5944 head_norm=1.452155 delta_norm=0.105123
[S6] aggregate: ROLLBACK (f1_val pre=0.605 post=0.594 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4121 head_norm=0.812349
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.272020e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4092 head_norm=0.763110 delta_norm=0.327202
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9350 head_norm=1.498743
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.114604e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.9809 head_norm=1.521183 delta_norm=0.211460
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6143 head_norm=1.280947
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.702584e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6192 head_norm=1.315668 delta_norm=0.270258
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.983584 cos_to_last_merge=0.9238 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6014321899896263, 'auprc': 0.7434239163034452, 'loss_val': 0.7873724941678095, 'psi': 0.6582288805151539}-{'f1_val': 0.6563544044353611, 'auprc': 0.7758338403867024, 'loss_val': 0.8769733949107751, 'psi': 0.7041461788158976}
[S3] START round=10 head_norm_before_train=0.893766 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.013262 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9945470469667845, 'loss_val': 0.4428726084003325, 'psi': 0.8182725410278936}-{'f1_val': 0.7007562037352997, 'auprc': 0.9962998884548431, 'loss_val': 0.47465553051481413, 'psi': 0.818973677623117}
[S4] START round=10 head_norm_before_train=1.513741 (no previous merge yet)
[S4] round=10 local utility u=0.043879 metrics={'f1_val': 0.6624947867266203, 'auprc': 0.6544275330529185, 'loss_val': 0.4426621686567506, 'psi': 0.6592678852571396}-{'f1_val': 0.6523891585166761, 'auprc': 0.6497535289639162, 'loss_val': 0.4557653385576732, 'psi': 0.6513349066955721}
[S5] START round=10 head_norm_before_train=1.572005 (no previous merge yet)
[S5] round=10 local utility u=0.065501 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.989681160353073, 'loss_val': 0.3119762233033566, 'psi': 0.8163862576771559}-{'f1_val': 0.7005685100046517, 'auprc': 0.9769941878128074, 'loss_val': 0.40319117465071175, 'psi': 0.811138781127914}
[S6] START round=10 head_norm_before_train=1.452155 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5722318804215356, 'auprc': 0.7770396158146545, 'loss_val': 0.784731852463555, 'psi': 0.6541549745787831}-{'f1_val': 0.6054901572164753, 'auprc': 0.7773989365124689, 'loss_val': 0.9292840057580614, 'psi': 0.6742536689348727}
[S7] START round=10 head_norm_before_train=1.315668 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.421789 metrics={'f1_val': 0.6560589245878008, 'auprc': 0.8311327204776131, 'loss_val': 0.5878836658658443, 'psi': 0.7260884429437258}-{'f1_val': 0.6142974006125582, 'auprc': 0.6631926766710896, 'loss_val': 0.6770719315567486, 'psi': 0.6338555110359707}
[S8] START round=10 head_norm_before_train=1.161991 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.6659926600435677, 'auprc': 0.7754018010615378, 'loss_val': 0.8860787482450242, 'psi': 0.7097563164507558}-{'f1_val': 0.7138828428684335, 'auprc': 0.7735834091542608, 'loss_val': 1.0160059983558711, 'psi': 0.7377630693827645}
[S9] START round=10 head_norm_before_train=1.521183 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.258237 metrics={'f1_val': 0.9887656335000179, 'auprc': 0.9983929226982189, 'loss_val': 0.21259524591471402, 'psi': 0.9926165491792982}-{'f1_val': 0.9350481027582153, 'auprc': 0.9899140590000105, 'loss_val': 0.38132765910217264, 'psi': 0.9569944852549334}
[S10] START round=10 head_norm_before_train=1.402576 (no previous merge yet)
[S10] round=10 local utility u=0.065789 metrics={'f1_val': 0.6949162696861166, 'auprc': 0.9707331437264899, 'loss_val': 0.47376171855894955, 'psi': 0.8052430193022659}-{'f1_val': 0.6959424417629968, 'auprc': 0.9640050110270684, 'loss_val': 0.5913117548484831, 'psi': 0.8031674694686255}
[S11] START round=10 head_norm_before_train=1.168993 cos_to_last_merge=0.9327 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=10 local utility u=1.000000 metrics={'f1_val': 0.9548242913355803, 'auprc': 0.9969598519683891, 'loss_val': 0.42624071909820266, 'psi': 0.9716785155887039}-{'f1_val': 0.40499072134281344, 'auprc': 0.9990290942735647, 'loss_val': 0.6199833847356844, 'psi': 0.642606070515114}
[S13] START round=10 head_norm_before_train=1.421246 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.37279059364601685, 'auprc': 0.43163233464681117, 'loss_val': 0.8482169471672237, 'psi': 0.3963272900463346}-{'f1_val': 0.41580726865236384, 'auprc': 0.42216134087806734, 'loss_val': 0.8371947412736979, 'psi': 0.41834889754264526}
[S14] START round=10 head_norm_before_train=1.504369 (no previous merge yet)
[S14] round=10 local utility u=0.064524 metrics={'f1_val': 0.7020620161542324, 'auprc': 0.9944266924188199, 'loss_val': 0.37207552028935575, 'psi': 0.8190078866600674}-{'f1_val': 0.6972356188612059, 'auprc': 0.9943669580347848, 'loss_val': 0.47198496507131793, 'psi': 0.8160881545306374}
[S15] START round=10 head_norm_before_train=0.763110 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.181454 metrics={'f1_val': 0.4143035365589065, 'auprc': 0.7996469886814904, 'loss_val': 0.9228372472203354, 'psi': 0.5684409174079401}-{'f1_val': 0.4121070335711168, 'auprc': 0.714160119210331, 'loss_val': 1.0161063390142024, 'psi': 0.5329282678268025}
[S16] START round=10 head_norm_before_train=1.488748 (no previous merge yet)
[S16] round=10 local utility u=0.103966 metrics={'f1_val': 0.4371667087316593, 'auprc': 0.742417971248949, 'loss_val': 0.8489130514518461, 'psi': 0.5592672137385752}-{'f1_val': 0.3897969239415995, 'auprc': 0.7613622004968467, 'loss_val': 0.8294588284962192, 'psi': 0.5384230345636984}
[S17] START round=10 head_norm_before_train=1.066177 cos_to_last_merge=0.8913 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.349756242568371, 'auprc': 0.7859268000800559, 'loss_val': 0.9256887290539635, 'psi': 0.524224465573045}-{'f1_val': 0.35273268957802617, 'auprc': 0.7723574905743994, 'loss_val': 0.8888528868563413, 'psi': 0.5205826099765755}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.8193
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.9688
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=-0.0513
[S10] DROPPED delta from S15 (cos=-0.0513 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S11
[S7] cosine check vs S11: cos=-0.0471
[S7] DROPPED delta from S11 (cos=-0.0471 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=-0.0833
[S15] DROPPED delta from S7 (cos=-0.0833 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.9929
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9774
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=-0.0134
[S2] DROPPED delta from S4 (cos=-0.0134 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=-0.0273
[S6] DROPPED delta from S16 (cos=-0.0273 < 0.0)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S3
[S15] cosine check vs S3: cos=0.7087
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.5722 head_norm=1.477523
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.844218e-02
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.5690 head_norm=1.514161 delta_norm=0.098442
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.383 → S8@127.0.0.1:57009
[S8] ⇄ pheromone p=0.362 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=0.316 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=0.171 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.332 → S9@127.0.0.1:57010
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6561 head_norm=1.353025
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.799913e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6644 head_norm=1.386401 delta_norm=0.179991
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.310 → S15@127.0.0.1:57015
[S10] ⇄ pheromone p=0.445 → S7@127.0.0.1:57008
[S4] ⇄ pheromone p=0.238 → S2@127.0.0.1:57002
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9888 head_norm=1.593945
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.708835e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9899 head_norm=1.595123 delta_norm=0.170884
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.437 → S3@127.0.0.1:57003
[S11] ⇄ pheromone p=0.467 → S7@127.0.0.1:57008
[S14] ⇄ pheromone p=0.380 → S6@127.0.0.1:57007
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4143 head_norm=0.802590
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.504560e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4167 head_norm=0.825457 delta_norm=0.350456
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.270 → S10@127.0.0.1:57011
[S16] ⇄ pheromone p=0.226 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=0.199 → S8@127.0.0.1:57009
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7008 head_norm=0.981961
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.848273e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7008 head_norm=1.231827 delta_norm=0.484827
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.302 → S15@127.0.0.1:57015
[S2] START round=11 head_norm_before_train=1.034313 cos_to_last_merge=0.9071 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=11 local utility u=0.350971 metrics={'f1_val': 0.7138254046542402, 'auprc': 0.7764299297547728, 'loss_val': 0.8588078557925599, 'psi': 0.7388672146944533}-{'f1_val': 0.6014321899896263, 'auprc': 0.7434239163034452, 'loss_val': 0.7873724941678095, 'psi': 0.6582288805151539}
[S3] START round=11 head_norm_before_train=1.231827 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.039896 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9936504375988763, 'loss_val': 0.36039157875931316, 'psi': 0.8179138972807303}-{'f1_val': 0.7007562037352997, 'auprc': 0.9945470469667845, 'loss_val': 0.4428726084003325, 'psi': 0.8182725410278936}
[S4] START round=11 head_norm_before_train=1.560940 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6666302490766056, 'auprc': 0.6603417036052706, 'loss_val': 0.5201480187485501, 'psi': 0.6641148308880716}-{'f1_val': 0.6624947867266203, 'auprc': 0.6544275330529185, 'loss_val': 0.4426621686567506, 'psi': 0.6592678852571396}
[S5] START round=11 head_norm_before_train=1.614490 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9660770005282536, 'loss_val': 0.33504791297541847, 'psi': 0.806795835808906}-{'f1_val': 0.7008563225598777, 'auprc': 0.989681160353073, 'loss_val': 0.3119762233033566, 'psi': 0.8163862576771559}
[S6] START round=11 head_norm_before_train=1.514161 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.217524 metrics={'f1_val': 0.6198572330627532, 'auprc': 0.7899411959608147, 'loss_val': 0.6741399975760418, 'psi': 0.6878908182219778}-{'f1_val': 0.5722318804215356, 'auprc': 0.7770396158146545, 'loss_val': 0.784731852463555, 'psi': 0.6541549745787831}
[S7] START round=11 head_norm_before_train=1.386401 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6585526127224031, 'auprc': 0.8241632211034067, 'loss_val': 0.6064547192761748, 'psi': 0.7247968560748045}-{'f1_val': 0.6560589245878008, 'auprc': 0.8311327204776131, 'loss_val': 0.5878836658658443, 'psi': 0.7260884429437258}
[S8] START round=11 head_norm_before_train=1.184117 cos_to_last_merge=0.9965 (last merge round=9)
[S8] round=11 local utility u=0.232973 metrics={'f1_val': 0.6998398556343262, 'auprc': 0.7922451653758165, 'loss_val': 0.6737451000836315, 'psi': 0.7368019795309223}-{'f1_val': 0.6659926600435677, 'auprc': 0.7754018010615378, 'loss_val': 0.8860787482450242, 'psi': 0.7097563164507558}
[S9] START round=11 head_norm_before_train=1.595123 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.023590 metrics={'f1_val': 0.9904995882076159, 'auprc': 0.9955977880978127, 'loss_val': 0.1674340343819293, 'psi': 0.9925388681636946}-{'f1_val': 0.9887656335000179, 'auprc': 0.9983929226982189, 'loss_val': 0.21259524591471402, 'psi': 0.9926165491792982}
[S10] START round=11 head_norm_before_train=1.441642 (no previous merge yet)
[S10] round=11 local utility u=0.084256 metrics={'f1_val': 0.6947218654620722, 'auprc': 0.9965547776696272, 'loss_val': 0.3815490795042962, 'psi': 0.8154550303450941}-{'f1_val': 0.6949162696861166, 'auprc': 0.9707331437264899, 'loss_val': 0.47376171855894955, 'psi': 0.8052430193022659}
[S11] START round=11 head_norm_before_train=1.226055 cos_to_last_merge=0.9170 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=11 local utility u=0.087592 metrics={'f1_val': 0.9609199081980986, 'auprc': 0.9986005775290567, 'loss_val': 0.2925523841534175, 'psi': 0.9759921759304818}-{'f1_val': 0.9548242913355803, 'auprc': 0.9969598519683891, 'loss_val': 0.42624071909820266, 'psi': 0.9716785155887039}
[S13] START round=11 head_norm_before_train=1.444902 (no previous merge yet)
[S13] round=11 local utility u=0.048870 metrics={'f1_val': 0.37670682930382554, 'auprc': 0.4602843151611488, 'loss_val': 0.8599310222870914, 'psi': 0.41013782364675483}-{'f1_val': 0.37279059364601685, 'auprc': 0.43163233464681117, 'loss_val': 0.8482169471672237, 'psi': 0.3963272900463346}
[S14] START round=11 head_norm_before_train=1.556174 (no previous merge yet)
[S14] round=11 local utility u=0.672987 metrics={'f1_val': 0.9268843372356967, 'auprc': 0.9943384869389891, 'loss_val': 0.37477090283831743, 'psi': 0.9538659971170136}-{'f1_val': 0.7020620161542324, 'auprc': 0.9944266924188199, 'loss_val': 0.37207552028935575, 'psi': 0.8190078866600674}
[S15] START round=11 head_norm_before_train=0.825457 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.012645 metrics={'f1_val': 0.3843923301979377, 'auprc': 0.8530384891812169, 'loss_val': 0.8782541376469858, 'psi': 0.5718507937912495}-{'f1_val': 0.4143035365589065, 'auprc': 0.7996469886814904, 'loss_val': 0.9228372472203354, 'psi': 0.5684409174079401}
[S16] START round=11 head_norm_before_train=1.518596 (no previous merge yet)
[S16] round=11 local utility u=0.391344 metrics={'f1_val': 0.5430218588643979, 'auprc': 0.7623876247067094, 'loss_val': 0.7612649207981282, 'psi': 0.6307681652013225}-{'f1_val': 0.4371667087316593, 'auprc': 0.742417971248949, 'loss_val': 0.8489130514518461, 'psi': 0.5592672137385752}
[S17] START round=11 head_norm_before_train=1.106436 cos_to_last_merge=0.8775 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.33602614116418905, 'auprc': 0.8276090941389106, 'loss_val': 1.0219445293987641, 'psi': 0.5326593223540776}-{'f1_val': 0.349756242568371, 'auprc': 0.7859268000800559, 'loss_val': 0.9256887290539635, 'psi': 0.524224465573045}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0253
[S6] DROPPED delta from S16 (cos=-0.0253 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=-0.0299
[S10] DROPPED delta from S15 (cos=-0.0299 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] cosine check vs S14: cos=0.9943
[S10] RECEIVED delta(kind=head bytes=1791) from S2
[S10] cosine check vs S2: cos=-0.0126
[S10] DROPPED delta from S2 (cos=-0.0126 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.2861
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] cosine check vs S3: cos=0.8631
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.1831
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9511
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0342
[S7] DROPPED delta from S11 (cos=-0.0342 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9823
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.9435
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.6586 head_norm=1.422622
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.391883e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6566 head_norm=1.444005 delta_norm=0.139188
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6199 head_norm=1.543500
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.873995e-02
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6199 head_norm=1.570130 delta_norm=0.088740
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.6998 head_norm=1.214329
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.700992e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7139 head_norm=1.362182 delta_norm=0.270099
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.3844 head_norm=0.860650
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.127477e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.3844 head_norm=0.873440 delta_norm=0.312748
[S15] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7008 head_norm=1.304567
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.514094e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7008 head_norm=1.137347 delta_norm=0.351409
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.086746 cos_to_last_merge=0.8913 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.891
[S2] round=12 local utility u=0.101079 metrics={'f1_val': 0.6996621359687365, 'auprc': 0.7760891234250429, 'loss_val': 0.570647530364545, 'psi': 0.7302329309512591}-{'f1_val': 0.7138254046542402, 'auprc': 0.7764299297547728, 'loss_val': 0.8588078557925599, 'psi': 0.7388672146944533}
[S3] START round=12 head_norm_before_train=1.137347 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9945659601531418, 'loss_val': 0.36726374503930553, 'psi': 0.8182349598604576}-{'f1_val': 0.7007562037352997, 'auprc': 0.9936504375988763, 'loss_val': 0.36039157875931316, 'psi': 0.8179138972807303}
[S4] START round=12 head_norm_before_train=1.595737 (no previous merge yet)
[S4] round=12 local utility u=0.006855 metrics={'f1_val': 0.6656064458521083, 'auprc': 0.6585022874845963, 'loss_val': 0.49477661840842185, 'psi': 0.6627647825051035}-{'f1_val': 0.6666302490766056, 'auprc': 0.6603417036052706, 'loss_val': 0.5201480187485501, 'psi': 0.6641148308880716}
[S5] START round=12 head_norm_before_train=1.649067 (no previous merge yet)
[S5] round=12 local utility u=0.092314 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9911561391386499, 'loss_val': 0.22566203073751784, 'psi': 0.8168279120589284}-{'f1_val': 0.7006083926626743, 'auprc': 0.9660770005282536, 'loss_val': 0.33504791297541847, 'psi': 0.806795835808906}
[S6] START round=12 head_norm_before_train=1.570130 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.572078 metrics={'f1_val': 0.7050425801915412, 'auprc': 0.9375879302825246, 'loss_val': 0.48403564012024497, 'psi': 0.7980607202279346}-{'f1_val': 0.6198572330627532, 'auprc': 0.7899411959608147, 'loss_val': 0.6741399975760418, 'psi': 0.6878908182219778}
[S7] START round=12 head_norm_before_train=1.444005 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.451164 metrics={'f1_val': 0.6993935466334926, 'auprc': 0.9807726801901522, 'loss_val': 0.4190009645261471, 'psi': 0.8119452000561564}-{'f1_val': 0.6585526127224031, 'auprc': 0.8241632211034067, 'loss_val': 0.6064547192761748, 'psi': 0.7247968560748045}
[S8] START round=12 head_norm_before_train=1.362182 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.005014 metrics={'f1_val': 0.7137948385190309, 'auprc': 0.7761616470167825, 'loss_val': 0.6991966454533604, 'psi': 0.7387415619181316}-{'f1_val': 0.6998398556343262, 'auprc': 0.7922451653758165, 'loss_val': 0.6737451000836315, 'psi': 0.7368019795309223}
[S9] START round=12 head_norm_before_train=1.665659 cos_to_last_merge=0.9976 (last merge round=10)
[S9] round=12 local utility u=0.022307 metrics={'f1_val': 0.990921566249656, 'auprc': 0.9944002930380407, 'loss_val': 0.1217604145196124, 'psi': 0.9923130569650099}-{'f1_val': 0.9904995882076159, 'auprc': 0.9955977880978127, 'loss_val': 0.1674340343819293, 'psi': 0.9925388681636946}
[S10] START round=12 head_norm_before_train=1.478240 (no previous merge yet)
[S10] round=12 local utility u=0.033527 metrics={'f1_val': 0.6940029135253628, 'auprc': 0.9977725657969365, 'loss_val': 0.31383508813164973, 'psi': 0.8155107744339923}-{'f1_val': 0.6947218654620722, 'auprc': 0.9965547776696272, 'loss_val': 0.3815490795042962, 'psi': 0.8154550303450941}
[S11] START round=12 head_norm_before_train=1.284573 cos_to_last_merge=0.9013 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=12 local utility u=0.064205 metrics={'f1_val': 0.9695008113124483, 'auprc': 0.9984556254550908, 'loss_val': 0.21519225081851667, 'psi': 0.9810827369695052}-{'f1_val': 0.9609199081980986, 'auprc': 0.9986005775290567, 'loss_val': 0.2925523841534175, 'psi': 0.9759921759304818}
[S13] START round=12 head_norm_before_train=1.466386 (no previous merge yet)
[S13] round=12 local utility u=0.633976 metrics={'f1_val': 0.5453200499735291, 'auprc': 0.526701305437978, 'loss_val': 0.8029097911325714, 'psi': 0.5378725521593086}-{'f1_val': 0.37670682930382554, 'auprc': 0.4602843151611488, 'loss_val': 0.8599310222870914, 'psi': 0.41013782364675483}
[S14] START round=12 head_norm_before_train=1.601241 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.6203210244220432, 'auprc': 0.9214550527448159, 'loss_val': 0.44060714877794616, 'psi': 0.7407746357511522}-{'f1_val': 0.9268843372356967, 'auprc': 0.9943384869389891, 'loss_val': 0.37477090283831743, 'psi': 0.9538659971170136}
[S15] START round=12 head_norm_before_train=0.873440 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.703108 metrics={'f1_val': 0.7012381165512998, 'auprc': 0.6752778567614076, 'loss_val': 0.8398303903311959, 'psi': 0.6908540126353429}-{'f1_val': 0.3843923301979377, 'auprc': 0.8530384891812169, 'loss_val': 0.8782541376469858, 'psi': 0.5718507937912495}
[S16] START round=12 head_norm_before_train=1.545781 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.41041293621796815, 'auprc': 0.7523055946368665, 'loss_val': 0.7604482815005587, 'psi': 0.5471699995855275}-{'f1_val': 0.5430218588643979, 'auprc': 0.7623876247067094, 'loss_val': 0.7612649207981282, 'psi': 0.6307681652013225}
[S17] START round=12 head_norm_before_train=1.132148 cos_to_last_merge=0.8682 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3361819307548658, 'auprc': 0.8257286240590296, 'loss_val': 1.026369618229168, 'psi': 0.5320006080765314}-{'f1_val': 0.33602614116418905, 'auprc': 0.8276090941389106, 'loss_val': 1.0219445293987641, 'psi': 0.5326593223540776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=-0.0110
[S2] DROPPED delta from S4 (cos=-0.0110 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9798
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.0440
[S15] DROPPED delta from S7 (cos=-0.0440 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.9056
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9752
[S7] RECEIVED delta(kind=head bytes=1792) from S11
[S7] cosine check vs S11: cos=-0.0262
[S7] DROPPED delta from S11 (cos=-0.0262 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9892
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.3307
[S10] RECEIVED delta(kind=head bytes=1789) from S2
[S10] cosine check vs S2: cos=-0.0153
[S10] DROPPED delta from S2 (cos=-0.0153 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.5662
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=-0.0253
[S10] DROPPED delta from S15 (cos=-0.0253 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7138 head_norm=1.386153
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.842358e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7138 head_norm=1.485792 delta_norm=0.184236
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6994 head_norm=1.469506
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.116103e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.7236 head_norm=1.486533 delta_norm=0.111610
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7007 head_norm=1.208977
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.617168e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=1.135516 delta_norm=0.261717
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7012 head_norm=0.913375
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.119444e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6914 head_norm=1.068162 delta_norm=0.611944
[S15] aggregate: ROLLBACK (f1_val pre=0.701 post=0.691 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9909 head_norm=1.723999
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.907890e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9905 head_norm=1.690734 delta_norm=0.190789
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.141374 cos_to_last_merge=0.8765 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=13 local utility u=0.004644 metrics={'f1_val': 0.6989693590414899, 'auprc': 0.7467039558001063, 'loss_val': 0.46904669963258194, 'psi': 0.7180631977449365}-{'f1_val': 0.6996621359687365, 'auprc': 0.7760891234250429, 'loss_val': 0.570647530364545, 'psi': 0.7302329309512591}
[S3] START round=13 head_norm_before_train=1.135516 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.001910 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.99357269672768, 'loss_val': 0.3604635833326418, 'psi': 0.8178376544902728}-{'f1_val': 0.7006809596653347, 'auprc': 0.9945659601531418, 'loss_val': 0.36726374503930553, 'psi': 0.8182349598604576}
[S4] START round=13 head_norm_before_train=1.617631 (no previous merge yet)
[S4] round=13 local utility u=0.001513 metrics={'f1_val': 0.6651551568228993, 'auprc': 0.6588689797277302, 'loss_val': 0.490143002813482, 'psi': 0.6626406859848316}-{'f1_val': 0.6656064458521083, 'auprc': 0.6585022874845963, 'loss_val': 0.49477661840842185, 'psi': 0.6627647825051035}
[S5] START round=13 head_norm_before_train=1.678628 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.4177062138068043, 'auprc': 0.7818376233680107, 'loss_val': 1.1598087307869365, 'psi': 0.5633587776312869}-{'f1_val': 0.7006090940057808, 'auprc': 0.9911561391386499, 'loss_val': 0.22566203073751784, 'psi': 0.8168279120589284}
[S6] START round=13 head_norm_before_train=1.600507 cos_to_last_merge=0.9993 (last merge round=11)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.7097914796873478, 'auprc': 0.8009000620969735, 'loss_val': 0.48432664084121974, 'psi': 0.7462349126511981}-{'f1_val': 0.7050425801915412, 'auprc': 0.9375879302825246, 'loss_val': 0.48403564012024497, 'psi': 0.7980607202279346}
[S7] START round=13 head_norm_before_train=1.486533 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6515050204833764, 'auprc': 0.8144264605243863, 'loss_val': 0.6036833430124168, 'psi': 0.7166735964997804}-{'f1_val': 0.6993935466334926, 'auprc': 0.9807726801901522, 'loss_val': 0.4190009645261471, 'psi': 0.8119452000561564}
[S8] START round=13 head_norm_before_train=1.485792 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.369527 metrics={'f1_val': 0.6996688376413861, 'auprc': 0.9887017221704282, 'loss_val': 0.5130064068947408, 'psi': 0.815281991453003}-{'f1_val': 0.7137948385190309, 'auprc': 0.7761616470167825, 'loss_val': 0.6991966454533604, 'psi': 0.7387415619181316}
[S9] START round=13 head_norm_before_train=1.690734 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7428683875354274, 'auprc': 0.8994213850586994, 'loss_val': 0.5494582296014361, 'psi': 0.8054895865447362}-{'f1_val': 0.990921566249656, 'auprc': 0.9944002930380407, 'loss_val': 0.1217604145196124, 'psi': 0.9923130569650099}
[S10] START round=13 head_norm_before_train=1.511630 (no previous merge yet)
[S10] round=13 local utility u=0.191794 metrics={'f1_val': 0.7520372452715062, 'auprc': 0.9968445545110297, 'loss_val': 0.27566920571068987, 'psi': 0.8499601689673155}-{'f1_val': 0.6940029135253628, 'auprc': 0.9977725657969365, 'loss_val': 0.31383508813164973, 'psi': 0.8155107744339923}
[S11] START round=13 head_norm_before_train=1.340547 cos_to_last_merge=0.8886 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=13 local utility u=0.118611 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9984382568728921, 'loss_val': 0.141350250164634, 'psi': 0.9974189775228208}-{'f1_val': 0.9695008113124483, 'auprc': 0.9984556254550908, 'loss_val': 0.21519225081851667, 'psi': 0.9810827369695052}
[S13] START round=13 head_norm_before_train=1.482106 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3825495411801444, 'auprc': 0.49833335828664466, 'loss_val': 0.8208422416309195, 'psi': 0.42886306802274454}-{'f1_val': 0.5453200499735291, 'auprc': 0.526701305437978, 'loss_val': 0.8029097911325714, 'psi': 0.5378725521593086}
[S14] START round=13 head_norm_before_train=1.643339 (no previous merge yet)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.9982560961963116, 'auprc': 0.9956381763241624, 'loss_val': 0.31825384545696117, 'psi': 0.9972089282474519}-{'f1_val': 0.6203210244220432, 'auprc': 0.9214550527448159, 'loss_val': 0.44060714877794616, 'psi': 0.7407746357511522}
[S15] START round=13 head_norm_before_train=1.068162 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.007150 metrics={'f1_val': 0.6913870112198439, 'auprc': 0.6751155064574025, 'loss_val': 0.7659366793497574, 'psi': 0.6848784093148674}-{'f1_val': 0.7012381165512998, 'auprc': 0.6752778567614076, 'loss_val': 0.8398303903311959, 'psi': 0.6908540126353429}
[S16] START round=13 head_norm_before_train=1.576897 (no previous merge yet)
[S16] round=13 local utility u=0.487809 metrics={'f1_val': 0.5540307736404247, 'auprc': 0.7772377719763564, 'loss_val': 0.7213330569798068, 'psi': 0.6433135729747974}-{'f1_val': 0.41041293621796815, 'auprc': 0.7523055946368665, 'loss_val': 0.7604482815005587, 'psi': 0.5471699995855275}
[S17] START round=13 head_norm_before_train=1.151144 cos_to_last_merge=0.8623 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=13 local utility u=0.029843 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.786346846672052, 'loss_val': 0.9469528487568236, 'psi': 0.5260894197755134}-{'f1_val': 0.3361819307548658, 'auprc': 0.8257286240590296, 'loss_val': 1.026369618229168, 'psi': 0.5320006080765314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:57009
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0293
[S6] DROPPED delta from S16 (cos=-0.0293 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0209
[S7] DROPPED delta from S11 (cos=-0.0209 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.9926
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=-0.0466
[S10] DROPPED delta from S15 (cos=-0.0466 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] cosine check vs S2: cos=-0.0155
[S10] DROPPED delta from S2 (cos=-0.0155 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.4379
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] cosine check vs S14: cos=0.9914
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.3097
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=-0.0105
[S2] DROPPED delta from S4 (cos=-0.0105 < 0.0)
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.0013
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7098 head_norm=1.631572
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.112301e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7078 head_norm=1.653277 delta_norm=0.111230
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6515 head_norm=1.508270
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.447829e-02
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6606 head_norm=1.522758 delta_norm=0.094478
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.6997 head_norm=1.506142
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.530156e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.6991 head_norm=0.954218 delta_norm=0.953016
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6914 head_norm=1.102097
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.793785e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.5099 head_norm=0.934514 delta_norm=0.679379
[S15] aggregate: ROLLBACK (f1_val pre=0.691 post=0.510 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7007 head_norm=1.206286
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.301672e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7007 head_norm=1.152672 delta_norm=0.730167
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.199161 cos_to_last_merge=0.8616 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=14 local utility u=0.010469 metrics={'f1_val': 0.6990693315920973, 'auprc': 0.7307878745176865, 'loss_val': 0.4009596616004405, 'psi': 0.7117567487623329}-{'f1_val': 0.6989693590414899, 'auprc': 0.7467039558001063, 'loss_val': 0.46904669963258194, 'psi': 0.7180631977449365}
[S3] START round=14 head_norm_before_train=1.152672 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9978669302510472, 'loss_val': 0.43350350383173447, 'psi': 0.8195553478996198}-{'f1_val': 0.7006809596653347, 'auprc': 0.99357269672768, 'loss_val': 0.3604635833326418, 'psi': 0.8178376544902728}
[S4] START round=14 head_norm_before_train=1.637702 (no previous merge yet)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.941027931775504, 'auprc': 0.9446000254751936, 'loss_val': 0.5040994485638994, 'psi': 0.9424567692553798}-{'f1_val': 0.6651551568228993, 'auprc': 0.6588689797277302, 'loss_val': 0.490143002813482, 'psi': 0.6626406859848316}
[S5] START round=14 head_norm_before_train=1.696534 (no previous merge yet)
[S5] round=14 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9878429911940423, 'loss_val': 0.2540068661214016, 'psi': 0.8155026528810854}-{'f1_val': 0.4177062138068043, 'auprc': 0.7818376233680107, 'loss_val': 1.1598087307869365, 'psi': 0.5633587776312869}
[S6] START round=14 head_norm_before_train=1.653277 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.026025 metrics={'f1_val': 0.7071444740178959, 'auprc': 0.8094284649576245, 'loss_val': 0.4419797374692838, 'psi': 0.7480580703937874}-{'f1_val': 0.7097914796873478, 'auprc': 0.8009000620969735, 'loss_val': 0.48432664084121974, 'psi': 0.7462349126511981}
[S7] START round=14 head_norm_before_train=1.522758 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.075295 metrics={'f1_val': 0.6656818061693552, 'auprc': 0.814343876994393, 'loss_val': 0.5379055655872401, 'psi': 0.7251466344993704}-{'f1_val': 0.6515050204833764, 'auprc': 0.8144264605243863, 'loss_val': 0.6036833430124168, 'psi': 0.7166735964997804}
[S8] START round=14 head_norm_before_train=0.954218 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7138828428684335, 'auprc': 0.7915496865735148, 'loss_val': 0.6514748054724172, 'psi': 0.744949580350466}-{'f1_val': 0.6996688376413861, 'auprc': 0.9887017221704282, 'loss_val': 0.5130064068947408, 'psi': 0.815281991453003}
[S9] START round=14 head_norm_before_train=1.736639 cos_to_last_merge=0.9993 (last merge round=12)
[S9] round=14 local utility u=1.000000 metrics={'f1_val': 0.9955623821232735, 'auprc': 0.9972532651949056, 'loss_val': 0.10251064367054383, 'psi': 0.9962387353519263}-{'f1_val': 0.7428683875354274, 'auprc': 0.8994213850586994, 'loss_val': 0.5494582296014361, 'psi': 0.8054895865447362}
[S10] START round=14 head_norm_before_train=1.542906 (no previous merge yet)
[S10] round=14 local utility u=0.333999 metrics={'f1_val': 0.8595918974586226, 'auprc': 0.9943980059875915, 'loss_val': 0.24565953069042556, 'psi': 0.9135143408702102}-{'f1_val': 0.7520372452715062, 'auprc': 0.9968445545110297, 'loss_val': 0.27566920571068987, 'psi': 0.8499601689673155}
[S11] START round=14 head_norm_before_train=1.390847 cos_to_last_merge=0.8785 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.982714243440718, 'auprc': 0.9983890960106511, 'loss_val': 0.1353175267742633, 'psi': 0.9889841844686913}-{'f1_val': 0.9967394579561065, 'auprc': 0.9984382568728921, 'loss_val': 0.141350250164634, 'psi': 0.9974189775228208}
[S13] START round=14 head_norm_before_train=1.495683 (no previous merge yet)
[S13] round=14 local utility u=0.589925 metrics={'f1_val': 0.5481243288570026, 'auprc': 0.5528494889994572, 'loss_val': 0.7979900590107536, 'psi': 0.5500143929139845}-{'f1_val': 0.3825495411801444, 'auprc': 0.49833335828664466, 'loss_val': 0.8208422416309195, 'psi': 0.42886306802274454}
[S14] START round=14 head_norm_before_train=1.682073 (no previous merge yet)
[S14] round=14 local utility u=0.011416 metrics={'f1_val': 0.9983295269340572, 'auprc': 0.9956380440181627, 'loss_val': 0.29586144276842047, 'psi': 0.9972529337676994}-{'f1_val': 0.9982560961963116, 'auprc': 0.9956381763241624, 'loss_val': 0.31825384545696117, 'psi': 0.9972089282474519}
[S15] START round=14 head_norm_before_train=0.934514 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.433493 metrics={'f1_val': 0.6817414411055954, 'auprc': 0.9696244408617443, 'loss_val': 0.7246032524568585, 'psi': 0.7968946410080551}-{'f1_val': 0.6913870112198439, 'auprc': 0.6751155064574025, 'loss_val': 0.7659366793497574, 'psi': 0.6848784093148674}
[S16] START round=14 head_norm_before_train=1.607909 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.47514781367568987, 'auprc': 0.7887487365105914, 'loss_val': 0.6346112040911117, 'psi': 0.6005881828096504}-{'f1_val': 0.5540307736404247, 'auprc': 0.7772377719763564, 'loss_val': 0.7213330569798068, 'psi': 0.6433135729747974}
[S17] START round=14 head_norm_before_train=1.170076 cos_to_last_merge=0.8572 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3549091461212698, 'auprc': 0.7164804738403213, 'loss_val': 0.8762112048534497, 'psi': 0.4995376772088904}-{'f1_val': 0.3525844685111543, 'auprc': 0.786346846672052, 'loss_val': 0.9469528487568236, 'psi': 0.5260894197755134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:57014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:57012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S6
[S14] cosine check vs S6: cos=0.9956
[S5] RECEIVED delta(kind=head bytes=1806) from S9
[S5] cosine check vs S9: cos=0.9850
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=-0.0078
[S4] DROPPED delta from S2 (cos=-0.0078 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S10
[S2] cosine check vs S10: cos=-0.0141
[S2] DROPPED delta from S10 (cos=-0.0141 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S7
[S11] cosine check vs S7: cos=-0.0197
[S11] DROPPED delta from S7 (cos=-0.0197 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=-0.0300
[S7] DROPPED delta from S15 (cos=-0.0300 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.705095
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.544070e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.733147 delta_norm=0.154407
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9983 head_norm=1.718288
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.245180e-02
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9979 head_norm=1.696099 delta_norm=0.082452
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.247697 cos_to_last_merge=0.8473 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.847
[S2] round=15 local utility u=0.027307 metrics={'f1_val': 0.6992367802816669, 'auprc': 0.7372298305710936, 'loss_val': 0.36667642091363534, 'psi': 0.7144340003974377}-{'f1_val': 0.6990693315920973, 'auprc': 0.7307878745176865, 'loss_val': 0.4009596616004405, 'psi': 0.7117567487623329}
[S3] START round=15 head_norm_before_train=1.206864 cos_to_last_merge=0.9904 (last merge round=13)
[S3] round=15 local utility u=0.047959 metrics={'f1_val': 0.6998453448223826, 'auprc': 0.9980461364332185, 'loss_val': 0.3331090208297045, 'psi': 0.819125661466717}-{'f1_val': 0.7006809596653347, 'auprc': 0.9978669302510472, 'loss_val': 0.43350350383173447, 'psi': 0.8195553478996198}
[S4] START round=15 head_norm_before_train=1.658463 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6054640185053799, 'auprc': 0.9481581387401489, 'loss_val': 0.520711600493281, 'psi': 0.7425416665992874}-{'f1_val': 0.941027931775504, 'auprc': 0.9446000254751936, 'loss_val': 0.5040994485638994, 'psi': 0.9424567692553798}
[S5] START round=15 head_norm_before_train=1.733147 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.037363 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9925551823648036, 'loss_val': 0.19342163168547338, 'psi': 0.8173880307089145}-{'f1_val': 0.7006090940057808, 'auprc': 0.9878429911940423, 'loss_val': 0.2540068661214016, 'psi': 0.8155026528810854}
[S6] START round=15 head_norm_before_train=1.677673 cos_to_last_merge=0.9997 (last merge round=13)
[S6] round=15 local utility u=0.383968 metrics={'f1_val': 0.7424921855749197, 'auprc': 0.9629757510952095, 'loss_val': 0.34677235523718486, 'psi': 0.8306856117830357}-{'f1_val': 0.7071444740178959, 'auprc': 0.8094284649576245, 'loss_val': 0.4419797374692838, 'psi': 0.7480580703937874}
[S7] START round=15 head_norm_before_train=1.558293 cos_to_last_merge=0.9985 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6310932034405672, 'auprc': 0.7994927728547365, 'loss_val': 0.5934604760896752, 'psi': 0.6984530312062349}-{'f1_val': 0.6656818061693552, 'auprc': 0.814343876994393, 'loss_val': 0.5379055655872401, 'psi': 0.7251466344993704}
[S8] START round=15 head_norm_before_train=0.987402 cos_to_last_merge=0.9981 (last merge round=13)
[S8] round=15 local utility u=0.302993 metrics={'f1_val': 0.6985545807199035, 'auprc': 0.9736435960683161, 'loss_val': 0.49980163574167685, 'psi': 0.8085901868592685}-{'f1_val': 0.7138828428684335, 'auprc': 0.7915496865735148, 'loss_val': 0.6514748054724172, 'psi': 0.744949580350466}
[S9] START round=15 head_norm_before_train=1.774241 cos_to_last_merge=0.9980 (last merge round=12)
[S9] round=15 local utility u=0.022598 metrics={'f1_val': 0.9966192614804416, 'auprc': 0.9966770977159157, 'loss_val': 0.061926880727486415, 'psi': 0.9966423959746311}-{'f1_val': 0.9955623821232735, 'auprc': 0.9972532651949056, 'loss_val': 0.10251064367054383, 'psi': 0.9962387353519263}
[S10] START round=15 head_norm_before_train=1.573394 (no previous merge yet)
[S10] round=15 local utility u=0.421980 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9924585927997328, 'loss_val': 0.20699861448736692, 'psi': 0.9938503558616815}-{'f1_val': 0.8595918974586226, 'auprc': 0.9943980059875915, 'loss_val': 0.24565953069042556, 'psi': 0.9135143408702102}
[S11] START round=15 head_norm_before_train=1.433149 cos_to_last_merge=0.8703 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=15 local utility u=0.060744 metrics={'f1_val': 0.996760249814205, 'auprc': 0.9983741120440766, 'loss_val': 0.09806083009571955, 'psi': 0.9974057947061536}-{'f1_val': 0.982714243440718, 'auprc': 0.9983890960106511, 'loss_val': 0.1353175267742633, 'psi': 0.9889841844686913}
[S13] START round=15 head_norm_before_train=1.509737 (no previous merge yet)
[S13] round=15 local utility u=0.040621 metrics={'f1_val': 0.5729177368931637, 'auprc': 0.5244982302308643, 'loss_val': 0.7804549507130253, 'psi': 0.553549934228244}-{'f1_val': 0.5481243288570026, 'auprc': 0.5528494889994572, 'loss_val': 0.7979900590107536, 'psi': 0.5500143929139845}
[S14] START round=15 head_norm_before_train=1.696099 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.030157 metrics={'f1_val': 0.9968419739193168, 'auprc': 0.997066143335017, 'loss_val': 0.23090576779916883, 'psi': 0.9969316416855969}-{'f1_val': 0.9983295269340572, 'auprc': 0.9956380440181627, 'loss_val': 0.29586144276842047, 'psi': 0.9972529337676994}
[S15] START round=15 head_norm_before_train=0.971557 cos_to_last_merge=0.9963 (last merge round=13)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6961030591884136, 'auprc': 0.6842732044100571, 'loss_val': 0.6446838143706591, 'psi': 0.6913711172770711}-{'f1_val': 0.6817414411055954, 'auprc': 0.9696244408617443, 'loss_val': 0.7246032524568585, 'psi': 0.7968946410080551}
[S16] START round=15 head_norm_before_train=1.640325 (no previous merge yet)
[S16] round=15 local utility u=0.944934 metrics={'f1_val': 0.7781992115834007, 'auprc': 0.8231214305489061, 'loss_val': 0.6661702937029254, 'psi': 0.7961680991696027}-{'f1_val': 0.47514781367568987, 'auprc': 0.7887487365105914, 'loss_val': 0.6346112040911117, 'psi': 0.6005881828096504}
[S17] START round=15 head_norm_before_train=1.186386 cos_to_last_merge=0.8528 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.853
[S17] round=15 local utility u=0.513051 metrics={'f1_val': 0.41386505413803254, 'auprc': 0.8720696601683102, 'loss_val': 0.6706127980904838, 'psi': 0.5971468965501436}-{'f1_val': 0.3549091461212698, 'auprc': 0.7164804738403213, 'loss_val': 0.8762112048534497, 'psi': 0.4995376772088904}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:57004
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:57014
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.5019
[S14] RECEIVED delta(kind=head bytes=1799) from S6
[S14] cosine check vs S6: cos=0.9970
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=-0.0038
[S4] DROPPED delta from S2 (cos=-0.0038 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] cosine check vs S10: cos=-0.0128
[S2] DROPPED delta from S10 (cos=-0.0128 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.7375
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9939
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9968 head_norm=1.729871
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.766862e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9386 head_norm=1.714409 delta_norm=0.067669
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.939 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.232 → S7@127.0.0.1:57008
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.738936
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.052588e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.774436 delta_norm=0.105259
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.160 → S11@127.0.0.1:57012
[S8] ⇄ pheromone p=0.246 → S6@127.0.0.1:57007
[S3] ⇄ pheromone p=0.112 → S9@127.0.0.1:57010
[S10] ⇄ pheromone p=0.319 → S2@127.0.0.1:57002
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7425 head_norm=1.701501
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.861694e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7080 head_norm=1.275562 delta_norm=0.586169
[S6] aggregate: ROLLBACK (f1_val pre=0.742 post=0.708 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.283 → S14@127.0.0.1:57014
[S2] ⇄ pheromone p=0.150 → S4@127.0.0.1:57004
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9966 head_norm=1.815353
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.061517e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9967 head_norm=1.346837 delta_norm=0.806152
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.312 → S5@127.0.0.1:57005
[S2] START round=16 head_norm_before_train=1.290923 cos_to_last_merge=0.8336 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6992441147247028, 'auprc': 0.6615909790530357, 'loss_val': 0.3465696675956997, 'psi': 0.6841828604560359}-{'f1_val': 0.6992367802816669, 'auprc': 0.7372298305710936, 'loss_val': 0.36667642091363534, 'psi': 0.7144340003974377}
[S3] START round=16 head_norm_before_train=1.277575 cos_to_last_merge=0.9696 (last merge round=13)
[S3] round=16 local utility u=0.002682 metrics={'f1_val': 0.6888950397188552, 'auprc': 0.9978026368062209, 'loss_val': 0.2613122997079385, 'psi': 0.8124580785538016}-{'f1_val': 0.6998453448223826, 'auprc': 0.9980461364332185, 'loss_val': 0.3331090208297045, 'psi': 0.819125661466717}
[S4] START round=16 head_norm_before_train=1.679227 (no previous merge yet)
[S4] round=16 local utility u=0.028127 metrics={'f1_val': 0.6135578984720569, 'auprc': 0.947686597486458, 'loss_val': 0.5116067987069366, 'psi': 0.7472093780778173}-{'f1_val': 0.6054640185053799, 'auprc': 0.9481581387401489, 'loss_val': 0.520711600493281, 'psi': 0.7425416665992874}
[S5] START round=16 head_norm_before_train=1.774436 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.41786857439360237, 'auprc': 0.8010306763565446, 'loss_val': 1.231955658815014, 'psi': 0.5711334151787792}-{'f1_val': 0.7006099296049884, 'auprc': 0.9925551823648036, 'loss_val': 0.19342163168547338, 'psi': 0.8173880307089145}
[S6] START round=16 head_norm_before_train=1.275562 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7170053413270459, 'auprc': 0.9617125851901033, 'loss_val': 0.3994787885358212, 'psi': 0.8148882388722688}-{'f1_val': 0.7424921855749197, 'auprc': 0.9629757510952095, 'loss_val': 0.34677235523718486, 'psi': 0.8306856117830357}
[S7] START round=16 head_norm_before_train=1.593303 cos_to_last_merge=0.9951 (last merge round=13)
[S7] round=16 local utility u=0.053462 metrics={'f1_val': 0.6414633174907216, 'auprc': 0.8030227953978979, 'loss_val': 0.5593479785892849, 'psi': 0.7060871086535921}-{'f1_val': 0.6310932034405672, 'auprc': 0.7994927728547365, 'loss_val': 0.5934604760896752, 'psi': 0.6984530312062349}
[S8] START round=16 head_norm_before_train=1.022839 cos_to_last_merge=0.9934 (last merge round=13)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7135790152243451, 'auprc': 0.7934476357718298, 'loss_val': 0.5025098304575949, 'psi': 0.745526463443339}-{'f1_val': 0.6985545807199035, 'auprc': 0.9736435960683161, 'loss_val': 0.49980163574167685, 'psi': 0.8085901868592685}
[S9] START round=16 head_norm_before_train=1.346837 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9962204214526479, 'auprc': 0.9957342531059156, 'loss_val': 0.13781361139921433, 'psi': 0.9960259541139549}-{'f1_val': 0.9966192614804416, 'auprc': 0.9966770977159157, 'loss_val': 0.061926880727486415, 'psi': 0.9966423959746311}
[S10] START round=16 head_norm_before_train=1.601783 (no previous merge yet)
[S10] round=16 local utility u=0.033815 metrics={'f1_val': 0.9947128492202709, 'auprc': 0.9959577356613335, 'loss_val': 0.149473634623533, 'psi': 0.995210803796696}-{'f1_val': 0.9947781979029806, 'auprc': 0.9924585927997328, 'loss_val': 0.20699861448736692, 'psi': 0.9938503558616815}
[S11] START round=16 head_norm_before_train=1.461484 cos_to_last_merge=0.8649 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.865
[S11] round=16 local utility u=0.000281 metrics={'f1_val': 0.996760249814205, 'auprc': 0.998394424361496, 'loss_val': 0.09755935368263688, 'psi': 0.9974139196331213}-{'f1_val': 0.996760249814205, 'auprc': 0.9983741120440766, 'loss_val': 0.09806083009571955, 'psi': 0.9974057947061536}
[S13] START round=16 head_norm_before_train=1.524841 (no previous merge yet)
[S13] round=16 local utility u=0.047275 metrics={'f1_val': 0.5665855211799992, 'auprc': 0.5717090151193028, 'loss_val': 0.7895440457177361, 'psi': 0.5686349187557207}-{'f1_val': 0.5729177368931637, 'auprc': 0.5244982302308643, 'loss_val': 0.7804549507130253, 'psi': 0.553549934228244}
[S14] START round=16 head_norm_before_train=1.714409 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9393409815090674, 'auprc': 0.9970641469069595, 'loss_val': 0.19328313531551072, 'psi': 0.9624302476682243}-{'f1_val': 0.9968419739193168, 'auprc': 0.997066143335017, 'loss_val': 0.23090576779916883, 'psi': 0.9969316416855969}
[S15] START round=16 head_norm_before_train=1.016282 cos_to_last_merge=0.9870 (last merge round=13)
[S15] round=16 local utility u=0.212489 metrics={'f1_val': 0.6942613519750788, 'auprc': 0.7954423389923712, 'loss_val': 0.5421627638749534, 'psi': 0.7347337467819957}-{'f1_val': 0.6961030591884136, 'auprc': 0.6842732044100571, 'loss_val': 0.6446838143706591, 'psi': 0.6913711172770711}
[S16] START round=16 head_norm_before_train=1.672798 (no previous merge yet)
[S16] round=16 local utility u=0.629747 metrics={'f1_val': 0.9000453798809228, 'auprc': 0.9150950734839958, 'loss_val': 0.4136732872744342, 'psi': 0.9060652573221519}-{'f1_val': 0.7781992115834007, 'auprc': 0.8231214305489061, 'loss_val': 0.6661702937029254, 'psi': 0.7961680991696027}
[S17] START round=16 head_norm_before_train=1.202498 cos_to_last_merge=0.8479 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3918549867158302, 'auprc': 0.8142251597408359, 'loss_val': 0.6350785290456231, 'psi': 0.5608030559258325}-{'f1_val': 0.41386505413803254, 'auprc': 0.8720696601683102, 'loss_val': 0.6706127980904838, 'psi': 0.5971468965501436}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:57012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S10
[S2] cosine check vs S10: cos=-0.0121
[S2] DROPPED delta from S10 (cos=-0.0121 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0011
[S2] DROPPED delta from S4 (cos=-0.0011 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.8032
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0302
[S7] DROPPED delta from S11 (cos=-0.0302 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S7
[S11] cosine check vs S7: cos=-0.0302
[S11] DROPPED delta from S7 (cos=-0.0302 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=-0.0542
[S7] DROPPED delta from S15 (cos=-0.0542 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9962 head_norm=1.409285
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.319218e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9962 head_norm=1.303039 delta_norm=0.431922
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.330084 cos_to_last_merge=0.8222 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=17 local utility u=0.000083 metrics={'f1_val': 0.6990663757070921, 'auprc': 0.6601523080442988, 'loss_val': 0.3410209331953107, 'psi': 0.6835007486419747}-{'f1_val': 0.6992441147247028, 'auprc': 0.6615909790530357, 'loss_val': 0.3465696675956997, 'psi': 0.6841828604560359}
[S3] START round=17 head_norm_before_train=1.335235 cos_to_last_merge=0.9535 (last merge round=13)
[S3] round=17 local utility u=0.650716 metrics={'f1_val': 0.895036004263102, 'auprc': 0.9981654418134969, 'loss_val': 0.19781544096997555, 'psi': 0.93628777928326}-{'f1_val': 0.6888950397188552, 'auprc': 0.9978026368062209, 'loss_val': 0.2613122997079385, 'psi': 0.8124580785538016}
[S4] START round=17 head_norm_before_train=1.699979 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6107372752085617, 'auprc': 0.9415586034681189, 'loss_val': 0.5130389214236896, 'psi': 0.7430658065123845}-{'f1_val': 0.6135578984720569, 'auprc': 0.947686597486458, 'loss_val': 0.5116067987069366, 'psi': 0.7472093780778173}
[S5] START round=17 head_norm_before_train=1.780689 cos_to_last_merge=0.9999 (last merge round=15)
[S5] round=17 local utility u=1.000000 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9925793012380983, 'loss_val': 0.20780699752363327, 'psi': 0.8173976782582324}-{'f1_val': 0.41786857439360237, 'auprc': 0.8010306763565446, 'loss_val': 1.231955658815014, 'psi': 0.5711334151787792}
[S6] START round=17 head_norm_before_train=1.301586 cos_to_last_merge=0.9995 (last merge round=15)
[S6] round=17 local utility u=0.144129 metrics={'f1_val': 0.7399407473613322, 'auprc': 0.9823228231668634, 'loss_val': 0.31066413426293804, 'psi': 0.8368935776835447}-{'f1_val': 0.7170053413270459, 'auprc': 0.9617125851901033, 'loss_val': 0.3994787885358212, 'psi': 0.8148882388722688}
[S7] START round=17 head_norm_before_train=1.618101 cos_to_last_merge=0.9918 (last merge round=13)
[S7] round=17 local utility u=0.446489 metrics={'f1_val': 0.6946081685867236, 'auprc': 0.9091891373973167, 'loss_val': 0.30373855550452616, 'psi': 0.7804405561109609}-{'f1_val': 0.6414633174907216, 'auprc': 0.8030227953978979, 'loss_val': 0.5593479785892849, 'psi': 0.7060871086535921}
[S8] START round=17 head_norm_before_train=1.057716 cos_to_last_merge=0.9873 (last merge round=13)
[S8] round=17 local utility u=0.238430 metrics={'f1_val': 0.6964509232852777, 'auprc': 0.9555166651834702, 'loss_val': 0.4090883042956378, 'psi': 0.8000772200445547}-{'f1_val': 0.7135790152243451, 'auprc': 0.7934476357718298, 'loss_val': 0.5025098304575949, 'psi': 0.745526463443339}
[S9] START round=17 head_norm_before_train=1.303039 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937194305527954, 'auprc': 0.9977811874716547, 'loss_val': 0.15900451147247838, 'psi': 0.9953441333203391}-{'f1_val': 0.9962204214526479, 'auprc': 0.9957342531059156, 'loss_val': 0.13781361139921433, 'psi': 0.9960259541139549}
[S10] START round=17 head_norm_before_train=1.624676 (no previous merge yet)
[S10] round=17 local utility u=0.002104 metrics={'f1_val': 0.993705525296829, 'auprc': 0.9971112401442257, 'loss_val': 0.1426817778532135, 'psi': 0.9950678112357876}-{'f1_val': 0.9947128492202709, 'auprc': 0.9959577356613335, 'loss_val': 0.149473634623533, 'psi': 0.995210803796696}
[S11] START round=17 head_norm_before_train=1.484324 cos_to_last_merge=0.8610 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.861
[S11] round=17 local utility u=0.008865 metrics={'f1_val': 0.996760249814205, 'auprc': 0.9983540584017532, 'loss_val': 0.07970780145089394, 'psi': 0.9973977732492243}-{'f1_val': 0.996760249814205, 'auprc': 0.998394424361496, 'loss_val': 0.09755935368263688, 'psi': 0.9974139196331213}
[S13] START round=17 head_norm_before_train=1.541213 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5664655409419133, 'auprc': 0.5606423735914354, 'loss_val': 0.8025415692920881, 'psi': 0.5641362740017222}-{'f1_val': 0.5665855211799992, 'auprc': 0.5717090151193028, 'loss_val': 0.7895440457177361, 'psi': 0.5686349187557207}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.743705 cos_to_last_merge=0.9998 (last merge round=15)
[S14] round=17 local utility u=0.048615 metrics={'f1_val': 0.9490030592307697, 'auprc': 0.995719663400832, 'loss_val': 0.1499924380262976, 'psi': 0.9676897008987946}-{'f1_val': 0.9393409815090674, 'auprc': 0.9970641469069595, 'loss_val': 0.19328313531551072, 'psi': 0.9624302476682243}
[S15] START round=17 head_norm_before_train=1.063189 cos_to_last_merge=0.9760 (last merge round=13)
[S15] round=17 local utility u=0.540668 metrics={'f1_val': 0.7725998061197821, 'auprc': 0.9530383738506956, 'loss_val': 0.40364604568038426, 'psi': 0.8447752332121474}-{'f1_val': 0.6942613519750788, 'auprc': 0.7954423389923712, 'loss_val': 0.5421627638749534, 'psi': 0.7347337467819957}
[S16] START round=17 head_norm_before_train=1.707611 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8502856095416051, 'auprc': 0.9677070658833549, 'loss_val': 0.5343607089750624, 'psi': 0.897254192078305}-{'f1_val': 0.9000453798809228, 'auprc': 0.9150950734839958, 'loss_val': 0.4136732872744342, 'psi': 0.9060652573221519}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=1.217970 cos_to_last_merge=0.8439 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=17 local utility u=0.060105 metrics={'f1_val': 0.39152290852343885, 'auprc': 0.852790399160358, 'loss_val': 0.6285722789276544, 'psi': 0.5760299047782065}-{'f1_val': 0.3918549867158302, 'auprc': 0.8142251597408359, 'loss_val': 0.6350785290456231, 'psi': 0.5608030559258325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0339
[S7] DROPPED delta from S11 (cos=-0.0339 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.9588
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.7833
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:57014
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:57012
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S3
[S9] cosine check vs S3: cos=0.9242
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.8809
[S2] RECEIVED delta(kind=head bytes=1801) from S10
[S2] cosine check vs S10: cos=-0.0123
[S2] DROPPED delta from S10 (cos=-0.0123 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=-0.0123
[S10] DROPPED delta from S2 (cos=-0.0123 < 0.0)
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9937 head_norm=1.384810
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.738802e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9941 head_norm=1.370927 delta_norm=0.173880
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1805) from S6
[S14] cosine check vs S6: cos=0.9588
[S11] RECEIVED delta(kind=head bytes=1799) from S7
[S11] cosine check vs S7: cos=-0.0339
[S11] DROPPED delta from S7 (cos=-0.0339 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=-0.0616
[S7] DROPPED delta from S15 (cos=-0.0616 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.7399 head_norm=1.332563
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.036117e-02
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.8221 head_norm=1.332010 delta_norm=0.060361
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.365685 cos_to_last_merge=0.8136 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6970084696692797, 'auprc': 0.6594222529250964, 'loss_val': 0.3423997248189358, 'psi': 0.6819739829716063}-{'f1_val': 0.6990663757070921, 'auprc': 0.6601523080442988, 'loss_val': 0.3410209331953107, 'psi': 0.6835007486419747}
[S3] START round=18 head_norm_before_train=1.376457 cos_to_last_merge=0.9436 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=18 local utility u=0.289131 metrics={'f1_val': 0.9833701494118764, 'auprc': 0.9979108290011038, 'loss_val': 0.14879447160093606, 'psi': 0.9891864212475674}-{'f1_val': 0.895036004263102, 'auprc': 0.9981654418134969, 'loss_val': 0.19781544096997555, 'psi': 0.93628777928326}
[S4] START round=18 head_norm_before_train=1.720451 (no previous merge yet)
[S4] round=18 local utility u=0.000906 metrics={'f1_val': 0.6133933778121144, 'auprc': 0.9436339915592182, 'loss_val': 0.5333905713936317, 'psi': 0.745489623310956}-{'f1_val': 0.6107372752085617, 'auprc': 0.9415586034681189, 'loss_val': 0.5130389214236896, 'psi': 0.7430658065123845}
[S5] START round=18 head_norm_before_train=1.785495 cos_to_last_merge=0.9999 (last merge round=15)
[S5] round=18 local utility u=0.028357 metrics={'f1_val': 0.7018934771609526, 'auprc': 0.995448503597187, 'loss_val': 0.16740281563052622, 'psi': 0.8193154877354464}-{'f1_val': 0.7006099296049884, 'auprc': 0.9925793012380983, 'loss_val': 0.20780699752363327, 'psi': 0.8173976782582324}
[S6] START round=18 head_norm_before_train=1.332010 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6383808263311865, 'auprc': 0.7870315990652846, 'loss_val': 0.5507484794853813, 'psi': 0.6978411354248257}-{'f1_val': 0.7399407473613322, 'auprc': 0.9823228231668634, 'loss_val': 0.31066413426293804, 'psi': 0.8368935776835447}
[S7] START round=18 head_norm_before_train=1.637623 cos_to_last_merge=0.9891 (last merge round=13)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6708774765483821, 'auprc': 0.8258156257644808, 'loss_val': 0.47325678288069695, 'psi': 0.7328527362348216}-{'f1_val': 0.6946081685867236, 'auprc': 0.9091891373973167, 'loss_val': 0.30373855550452616, 'psi': 0.7804405561109609}
[S8] START round=18 head_norm_before_train=1.089318 cos_to_last_merge=0.9812 (last merge round=13)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7137948385190309, 'auprc': 0.7912909565746162, 'loss_val': 0.554752998439632, 'psi': 0.744793285741265}-{'f1_val': 0.6964509232852777, 'auprc': 0.9555166651834702, 'loss_val': 0.4090883042956378, 'psi': 0.8000772200445547}
[S9] START round=18 head_norm_before_train=1.370927 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.041055 metrics={'f1_val': 0.9958348043894436, 'auprc': 0.9987967104164097, 'loss_val': 0.09263293879405475, 'psi': 0.9970195668002301}-{'f1_val': 0.9937194305527954, 'auprc': 0.9977811874716547, 'loss_val': 0.15900451147247838, 'psi': 0.9953441333203391}
[S10] START round=18 head_norm_before_train=1.650259 (no previous merge yet)
[S10] round=18 local utility u=0.016858 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9936696257509552, 'loss_val': 0.10254533509471425, 'psi': 0.9940816893274349}-{'f1_val': 0.993705525296829, 'auprc': 0.9971112401442257, 'loss_val': 0.1426817778532135, 'psi': 0.9950678112357876}
[S11] START round=18 head_norm_before_train=1.508631 cos_to_last_merge=0.8574 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.857
[S11] round=18 local utility u=0.001696 metrics={'f1_val': 0.9970232068186706, 'auprc': 0.9979685731784698, 'loss_val': 0.07673695149497661, 'psi': 0.9974013533625903}-{'f1_val': 0.996760249814205, 'auprc': 0.9983540584017532, 'loss_val': 0.07970780145089394, 'psi': 0.9973977732492243}
[S13] START round=18 head_norm_before_train=1.557610 (no previous merge yet)
[S13] round=18 local utility u=0.113677 metrics={'f1_val': 0.6001838381309271, 'auprc': 0.5482482997586605, 'loss_val': 0.7403143563665758, 'psi': 0.5794096227820205}-{'f1_val': 0.5664655409419133, 'auprc': 0.5606423735914354, 'loss_val': 0.8025415692920881, 'psi': 0.5641362740017222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=18 head_norm_before_train=1.770732 cos_to_last_merge=0.9994 (last merge round=15)
[S14] round=18 local utility u=0.151951 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997066604059649, 'loss_val': 0.1420195238265561, 'psi': 0.9974173124537717}-{'f1_val': 0.9490030592307697, 'auprc': 0.995719663400832, 'loss_val': 0.1499924380262976, 'psi': 0.9676897008987946}
[S15] START round=18 head_norm_before_train=1.108869 cos_to_last_merge=0.9654 (last merge round=13)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6958501881734165, 'auprc': 0.8081780003439472, 'loss_val': 0.4394764687504843, 'psi': 0.7407813130416288}-{'f1_val': 0.7725998061197821, 'auprc': 0.9530383738506956, 'loss_val': 0.40364604568038426, 'psi': 0.8447752332121474}
[S16] START round=18 head_norm_before_train=1.740795 (no previous merge yet)
[S16] round=18 local utility u=0.215283 metrics={'f1_val': 0.8828751592425331, 'auprc': 0.9920688059101941, 'loss_val': 0.37241782364870657, 'psi': 0.9265526179095975}-{'f1_val': 0.8502856095416051, 'auprc': 0.9677070658833549, 'loss_val': 0.5343607089750624, 'psi': 0.897254192078305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=18 head_norm_before_train=1.235947 cos_to_last_merge=0.8404 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=18 local utility u=0.197641 metrics={'f1_val': 0.4194326140885719, 'auprc': 0.9066842346526697, 'loss_val': 0.5624306356988346, 'psi': 0.614333262314211}-{'f1_val': 0.39152290852343885, 'auprc': 0.852790399160358, 'loss_val': 0.6285722789276544, 'psi': 0.5760299047782065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.9591
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=-0.0013
[S2] DROPPED delta from S4 (cos=-0.0013 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.8617
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] cosine check vs S11: cos=-0.0378
[S7] DROPPED delta from S11 (cos=-0.0378 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9977 head_norm=1.796657
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.237257e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9981 head_norm=1.548241 delta_norm=0.323726
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S10
[S2] cosine check vs S10: cos=-0.0130
[S2] DROPPED delta from S10 (cos=-0.0130 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.8617
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.8614
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9958 head_norm=1.465320
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.177872e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9958 head_norm=1.428129 delta_norm=0.117787
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6384 head_norm=1.356105
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.136685e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6411 head_norm=1.560484 delta_norm=0.313668
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.396312 cos_to_last_merge=0.8080 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.808
[S2] round=19 local utility u=0.133695 metrics={'f1_val': 0.6989718590037731, 'auprc': 0.7520927819901875, 'loss_val': 0.364802521731065, 'psi': 0.7202202281983389}-{'f1_val': 0.6970084696692797, 'auprc': 0.6594222529250964, 'loss_val': 0.3423997248189358, 'psi': 0.6819739829716063}
[S3] START round=19 head_norm_before_train=1.414553 cos_to_last_merge=0.9359 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9162732654424374, 'auprc': 0.99667120686894, 'loss_val': 0.23846449455399774, 'psi': 0.9484324420130383}-{'f1_val': 0.9833701494118764, 'auprc': 0.9979108290011038, 'loss_val': 0.14879447160093606, 'psi': 0.9891864212475674}
[S4] START round=19 head_norm_before_train=1.739318 (no previous merge yet)
[S4] round=19 local utility u=0.008643 metrics={'f1_val': 0.6149226775620403, 'auprc': 0.9457244955784645, 'loss_val': 0.5315519103874399, 'psi': 0.7472434047686101}-{'f1_val': 0.6133933778121144, 'auprc': 0.9436339915592182, 'loss_val': 0.5333905713936317, 'psi': 0.745489623310956}
[S5] START round=19 head_norm_before_train=1.794650 cos_to_last_merge=0.9997 (last merge round=15)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.4238146036614746, 'auprc': 0.8529238854273637, 'loss_val': 0.8733017805710036, 'psi': 0.5954583163678302}-{'f1_val': 0.7018934771609526, 'auprc': 0.995448503597187, 'loss_val': 0.16740281563052622, 'psi': 0.8193154877354464}
[S6] START round=19 head_norm_before_train=1.560484 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9584378331896193, 'auprc': 0.9732425129868651, 'loss_val': 0.25225690878003976, 'psi': 0.9643597051085177}-{'f1_val': 0.6383808263311865, 'auprc': 0.7870315990652846, 'loss_val': 0.5507484794853813, 'psi': 0.6978411354248257}
[S7] START round=19 head_norm_before_train=1.655772 cos_to_last_merge=0.9864 (last merge round=13)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6314428955354363, 'auprc': 0.8047898102472408, 'loss_val': 0.5582888453672746, 'psi': 0.7007816614201581}-{'f1_val': 0.6708774765483821, 'auprc': 0.8258156257644808, 'loss_val': 0.47325678288069695, 'psi': 0.7328527362348216}
[S8] START round=19 head_norm_before_train=1.121833 cos_to_last_merge=0.9745 (last merge round=13)
[S8] round=19 local utility u=0.345567 metrics={'f1_val': 0.6990817592441152, 'auprc': 0.9753538312956647, 'loss_val': 0.3275301317540455, 'psi': 0.8095905880647349}-{'f1_val': 0.7137948385190309, 'auprc': 0.7912909565746162, 'loss_val': 0.554752998439632, 'psi': 0.744793285741265}
[S9] START round=19 head_norm_before_train=1.428129 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.010364 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9988483831243478, 'loss_val': 0.0779043340956493, 'psi': 0.9976247336963673}-{'f1_val': 0.9958348043894436, 'auprc': 0.9987967104164097, 'loss_val': 0.09263293879405475, 'psi': 0.9970195668002301}
[S10] START round=19 head_norm_before_train=1.676768 (no previous merge yet)
[S10] round=19 local utility u=0.009476 metrics={'f1_val': 0.9940718139004033, 'auprc': 0.9952818781756927, 'loss_val': 0.08672250417768629, 'psi': 0.9945558396105191}-{'f1_val': 0.9943563983784213, 'auprc': 0.9936696257509552, 'loss_val': 0.10254533509471425, 'psi': 0.9940816893274349}
[S11] START round=19 head_norm_before_train=1.535225 cos_to_last_merge=0.8538 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=19 local utility u=0.005063 metrics={'f1_val': 0.9970232068186706, 'auprc': 0.9965415109535691, 'loss_val': 0.06232965216661277, 'psi': 0.99683052847263}-{'f1_val': 0.9970232068186706, 'auprc': 0.9979685731784698, 'loss_val': 0.07673695149497661, 'psi': 0.9974013533625903}
[S13] START round=19 head_norm_before_train=1.580448 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5655829133272743, 'auprc': 0.6577009262727253, 'loss_val': 0.9035415233468529, 'psi': 0.6024301185054547}-{'f1_val': 0.6001838381309271, 'auprc': 0.5482482997586605, 'loss_val': 0.7403143563665758, 'psi': 0.5794096227820205}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.602 u=0.0000 p_local=0.1162 f1=0.566 auprc=0.658 bytes=23357
[S14] START round=19 head_norm_before_train=1.548241 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.015562 metrics={'f1_val': 0.9978207838439215, 'auprc': 0.997011695749704, 'loss_val': 0.11174831106814347, 'psi': 0.9974971486062345}-{'f1_val': 0.9976511180498535, 'auprc': 0.997066604059649, 'loss_val': 0.1420195238265561, 'psi': 0.9974173124537717}
[S15] START round=19 head_norm_before_train=1.153721 cos_to_last_merge=0.9563 (last merge round=13)
[S15] round=19 local utility u=0.094698 metrics={'f1_val': 0.6981771491407601, 'auprc': 0.8488258452943682, 'loss_val': 0.385986637028915, 'psi': 0.7584366276022034}-{'f1_val': 0.6958501881734165, 'auprc': 0.8081780003439472, 'loss_val': 0.4394764687504843, 'psi': 0.7407813130416288}
[S16] START round=19 head_norm_before_train=1.773767 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8403948002040529, 'auprc': 0.9908344630975523, 'loss_val': 0.6790891920351755, 'psi': 0.9005706653614527}-{'f1_val': 0.8828751592425331, 'auprc': 0.9920688059101941, 'loss_val': 0.37241782364870657, 'psi': 0.9265526179095975}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.901 u=0.0000 p_local=0.2454 f1=0.840 auprc=0.991 bytes=23371
[S17] START round=19 head_norm_before_train=1.254762 cos_to_last_merge=0.8377 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.4182905903989086, 'auprc': 0.8419012651868955, 'loss_val': 0.5529797221528481, 'psi': 0.5877348603141034}-{'f1_val': 0.4194326140885719, 'auprc': 0.9066842346526697, 'loss_val': 0.5624306356988346, 'psi': 0.614333262314211}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.588 u=0.0000 p_local=0.1096 f1=0.418 auprc=0.842 bytes=17914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.4238 head_norm=1.803560
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.600624e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.4249 head_norm=1.577447 delta_norm=0.460062
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.595 u=0.0000 p_local=0.2495 f1=0.424 auprc=0.853 bytes=23412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] cosine check vs S11: cos=-0.0402
[S7] DROPPED delta from S11 (cos=-0.0402 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0014
[S2] DROPPED delta from S4 (cos=-0.0014 < 0.0)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] r=20 psi=0.997 u=0.0051 p_local=0.0820 f1=0.997 auprc=0.997 bytes=28725
[S14] r=20 psi=0.997 u=0.0156 p_local=0.1629 f1=0.998 auprc=0.997 bytes=28799
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] r=20 psi=0.747 u=0.0086 p_local=0.1026 f1=0.615 auprc=0.946 bytes=25159
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9717
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=-0.0137
[S10] DROPPED delta from S2 (cos=-0.0137 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S10
[S2] cosine check vs S10: cos=-0.0137
[S2] DROPPED delta from S10 (cos=-0.0137 < 0.0)
[S9] r=20 psi=0.998 u=0.0104 p_local=0.1365 f1=0.997 auprc=0.999 bytes=25241
[S10] r=20 psi=0.995 u=0.0095 p_local=0.1388 f1=0.994 auprc=0.995 bytes=26961
[S2] r=20 psi=0.720 u=0.1337 p_local=0.0883 f1=0.699 auprc=0.752 bytes=23295
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:57014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S3] r=20 psi=0.948 u=0.0000 p_local=0.1757 f1=0.916 auprc=0.997 bytes=26960
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S6
[S14] cosine check vs S6: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.7948
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.0773
[S7] DROPPED delta from S15 (cos=-0.0773 < 0.0)
[S8] r=20 psi=0.810 u=0.3456 p_local=0.2004 f1=0.699 auprc=0.975 bytes=23361
[S7] r=20 psi=0.701 u=0.0000 p_local=0.1281 f1=0.631 auprc=0.805 bytes=19754
[S15] r=20 psi=0.758 u=0.0947 p_local=0.2048 f1=0.698 auprc=0.849 bytes=26937
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.9584 head_norm=1.577581
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.389394e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.9590 head_norm=1.422314 delta_norm=0.238939
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.964 u=1.0000 p_local=0.3344 f1=0.958 auprc=0.973 bytes=19777
[S2] START round=20 head_norm_before_train=1.423916 cos_to_last_merge=0.8032 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=20 local utility u=0.024960 metrics={'f1_val': 0.7102285348752935, 'auprc': 0.7887297520547493, 'loss_val': 0.4923338122540332, 'psi': 0.7416290217470758}-{'f1_val': 0.6989718590037731, 'auprc': 0.7520927819901875, 'loss_val': 0.364802521731065, 'psi': 0.7202202281983389}
[S3] START round=20 head_norm_before_train=1.453582 cos_to_last_merge=0.9286 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=20 local utility u=0.309288 metrics={'f1_val': 0.9952582588558114, 'auprc': 0.9957073015391703, 'loss_val': 0.09090696237952746, 'psi': 0.995437875929155}-{'f1_val': 0.9162732654424374, 'auprc': 0.99667120686894, 'loss_val': 0.23846449455399774, 'psi': 0.9484324420130383}
[S4] START round=20 head_norm_before_train=1.748798 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.6124563983095568, 'auprc': 0.9268674760092118, 'loss_val': 0.49449565844810084, 'psi': 0.7382208293894188}-{'f1_val': 0.6149226775620403, 'auprc': 0.9457244955784645, 'loss_val': 0.5315519103874399, 'psi': 0.7472434047686101}
[S5] START round=20 head_norm_before_train=1.577447 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8548751017702906, 'loss_val': 0.36332025834022563, 'psi': 0.7623154971115846}-{'f1_val': 0.4238146036614746, 'auprc': 0.8529238854273637, 'loss_val': 0.8733017805710036, 'psi': 0.5954583163678302}
[S6] START round=20 head_norm_before_train=1.422314 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.9275269028431177, 'auprc': 0.9678651671898617, 'loss_val': 0.31379049017749877, 'psi': 0.9436622085818154}-{'f1_val': 0.9584378331896193, 'auprc': 0.9732425129868651, 'loss_val': 0.25225690878003976, 'psi': 0.9643597051085177}
[S7] START round=20 head_norm_before_train=1.670632 cos_to_last_merge=0.9841 (last merge round=13)
[S7] round=20 local utility u=0.317784 metrics={'f1_val': 0.6855833805809399, 'auprc': 0.8510944419995539, 'loss_val': 0.38647682880308637, 'psi': 0.7517878051483855}-{'f1_val': 0.6314428955354363, 'auprc': 0.8047898102472408, 'loss_val': 0.5582888453672746, 'psi': 0.7007816614201581}
[S8] START round=20 head_norm_before_train=1.150347 cos_to_last_merge=0.9691 (last merge round=13)
[S8] round=20 local utility u=0.021660 metrics={'f1_val': 0.6996032956902092, 'auprc': 0.9836830251241698, 'loss_val': 0.31232601675078453, 'psi': 0.8132351874637935}-{'f1_val': 0.6990817592441152, 'auprc': 0.9753538312956647, 'loss_val': 0.3275301317540455, 'psi': 0.8095905880647349}
[S9] START round=20 head_norm_before_train=1.501245 cos_to_last_merge=0.9985 (last merge round=18)
[S9] round=20 local utility u=0.004462 metrics={'f1_val': 0.996808967411047, 'auprc': 0.996835682157898, 'loss_val': 0.06294245589883336, 'psi': 0.9968196533097874}-{'f1_val': 0.996808967411047, 'auprc': 0.9988483831243478, 'loss_val': 0.0779043340956493, 'psi': 0.9976247336963673}
[S10] START round=20 head_norm_before_train=1.702321 (no previous merge yet)
[S10] round=20 local utility u=0.004204 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9930581575000286, 'loss_val': 0.07581142751380841, 'psi': 0.9940831532255288}-{'f1_val': 0.9940718139004033, 'auprc': 0.9952818781756927, 'loss_val': 0.08672250417768629, 'psi': 0.9945558396105191}
[S11] START round=20 head_norm_before_train=1.563015 cos_to_last_merge=0.8499 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=20 local utility u=0.007658 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9982824307246014, 'loss_val': 0.04817503423559973, 'psi': 0.9971208274399479}-{'f1_val': 0.9970232068186706, 'auprc': 0.9965415109535691, 'loss_val': 0.06232965216661277, 'psi': 0.99683052847263}
[S13] START round=20 head_norm_before_train=1.597443 (no previous merge yet)
[S13] round=20 local utility u=0.218719 metrics={'f1_val': 0.6023397586168607, 'auprc': 0.6746135767110294, 'loss_val': 0.7373830485403537, 'psi': 0.6312492858545282}-{'f1_val': 0.5655829133272743, 'auprc': 0.6577009262727253, 'loss_val': 0.9035415233468529, 'psi': 0.6024301185054547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=20 head_norm_before_train=1.578323 cos_to_last_merge=0.9997 (last merge round=18)
[S14] round=20 local utility u=0.012773 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9969775356807469, 'loss_val': 0.0850852575088398, 'psi': 0.9973819887329385}-{'f1_val': 0.9978207838439215, 'auprc': 0.997011695749704, 'loss_val': 0.11174831106814347, 'psi': 0.9974971486062345}
[S15] START round=20 head_norm_before_train=1.196864 cos_to_last_merge=0.9490 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=20 local utility u=0.344260 metrics={'f1_val': 0.7498238975458502, 'auprc': 0.9557047970797861, 'loss_val': 0.3279841747265549, 'psi': 0.8321762573594245}-{'f1_val': 0.6981771491407601, 'auprc': 0.8488258452943682, 'loss_val': 0.385986637028915, 'psi': 0.7584366276022034}
[S16] START round=20 head_norm_before_train=1.801375 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8215321523281294, 'auprc': 0.9440541437166355, 'loss_val': 0.5281049196008606, 'psi': 0.8705409488835318}-{'f1_val': 0.8403948002040529, 'auprc': 0.9908344630975523, 'loss_val': 0.6790891920351755, 'psi': 0.9005706653614527}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.277445 cos_to_last_merge=0.8347 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.401586463840211, 'auprc': 0.8210546715204602, 'loss_val': 0.6564855460368042, 'psi': 0.5693737469123107}-{'f1_val': 0.4182905903989086, 'auprc': 0.8419012651868955, 'loss_val': 0.5529797221528481, 'psi': 0.5877348603141034}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] → sending delta(kind=head bytes=1809) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S5] sending update (kind=head size=1809 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:57005
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] ⇄ pheromone p=0.082 → S2@127.0.0.1:57002
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=0.9905
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=-0.0414
[S7] DROPPED delta from S11 (cos=-0.0414 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1809) from S5
[S9] cosine check vs S5: cos=0.9717
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7006 head_norm=1.586549
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.897247e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7006 head_norm=1.532789 delta_norm=0.189725
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.400 → S9@127.0.0.1:57010
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] ⇄ pheromone p=0.067 → S7@127.0.0.1:57008
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9977 head_norm=1.613036
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.029149e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9977 head_norm=1.594898 delta_norm=0.040291
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.133 → S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:57012
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S10
[S2] cosine check vs S10: cos=-0.0146
[S2] DROPPED delta from S10 (cos=-0.0146 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=-0.0146
[S10] DROPPED delta from S2 (cos=-0.0146 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.8228
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9923
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.8593
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S7
[S11] cosine check vs S7: cos=-0.0414
[S11] DROPPED delta from S7 (cos=-0.0414 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9968 head_norm=1.558644
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.697860e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9968 head_norm=1.478812 delta_norm=0.169786
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.110 → S5@127.0.0.1:57005
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] ⇄ pheromone p=0.202 → S9@127.0.0.1:57010
[S8] ⇄ pheromone p=0.165 → S6@127.0.0.1:57007
[S2] ⇄ pheromone p=0.076 → S10@127.0.0.1:57011
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.0818
[S7] DROPPED delta from S15 (cos=-0.0818 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9275 head_norm=1.439318
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.204716e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9206 head_norm=1.375898 delta_norm=0.120472
[S6] aggregate: ROLLBACK (f1_val pre=0.928 post=0.921 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.267 → S8@127.0.0.1:57009
[S10] ⇄ pheromone p=0.112 → S15@127.0.0.1:57015
[S15] ⇄ pheromone p=0.233 → S7@127.0.0.1:57008
[S7] ⇄ pheromone p=0.166 → S10@127.0.0.1:57011
[S2] START round=21 head_norm_before_train=1.448814 cos_to_last_merge=0.7993 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6996780437696617, 'auprc': 0.7574712090697157, 'loss_val': 0.39395243206253666, 'psi': 0.7227953098896833}-{'f1_val': 0.7102285348752935, 'auprc': 0.7887297520547493, 'loss_val': 0.4923338122540332, 'psi': 0.7416290217470758}
[S3] START round=21 head_norm_before_train=1.491872 cos_to_last_merge=0.9218 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=21 local utility u=0.007792 metrics={'f1_val': 0.9940335392918865, 'auprc': 0.9975703381200886, 'loss_val': 0.07356437640474764, 'psi': 0.9954482588231672}-{'f1_val': 0.9952582588558114, 'auprc': 0.9957073015391703, 'loss_val': 0.09090696237952746, 'psi': 0.995437875929155}
[S4] START round=21 head_norm_before_train=1.757944 (no previous merge yet)
[S4] round=21 local utility u=0.107698 metrics={'f1_val': 0.6555516157565794, 'auprc': 0.9077341850017137, 'loss_val': 0.4802702043721045, 'psi': 0.7564246434546331}-{'f1_val': 0.6124563983095568, 'auprc': 0.9268674760092118, 'loss_val': 0.49449565844810084, 'psi': 0.7382208293894188}
[S5] START round=21 head_norm_before_train=1.532789 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6454281955502855, 'auprc': 0.853913487734449, 'loss_val': 0.45186340018821564, 'psi': 0.7288223124239509}-{'f1_val': 0.7006090940057808, 'auprc': 0.8548751017702906, 'loss_val': 0.36332025834022563, 'psi': 0.7623154971115846}
[S6] START round=21 head_norm_before_train=1.375898 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.572367812656729, 'auprc': 0.7833421018197573, 'loss_val': 0.626890111867156, 'psi': 0.6567575283219402}-{'f1_val': 0.9275269028431177, 'auprc': 0.9678651671898617, 'loss_val': 0.31379049017749877, 'psi': 0.9436622085818154}
[S7] START round=21 head_norm_before_train=1.684922 cos_to_last_merge=0.9823 (last merge round=13)
[S7] round=21 local utility u=0.051716 metrics={'f1_val': 0.6896374916629162, 'auprc': 0.8596142308199946, 'loss_val': 0.33292848020551563, 'psi': 0.7576281873257475}-{'f1_val': 0.6855833805809399, 'auprc': 0.8510944419995539, 'loss_val': 0.38647682880308637, 'psi': 0.7517878051483855}
[S8] START round=21 head_norm_before_train=1.178560 cos_to_last_merge=0.9637 (last merge round=13)
[S8] round=21 local utility u=0.046610 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9845742257840611, 'loss_val': 0.30668207643214235, 'psi': 0.8220819838729261}-{'f1_val': 0.6996032956902092, 'auprc': 0.9836830251241698, 'loss_val': 0.31232601675078453, 'psi': 0.8132351874637935}
[S9] START round=21 head_norm_before_train=1.478812 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9449187746423322, 'auprc': 0.9939389185305454, 'loss_val': 0.16572036532469314, 'psi': 0.9645268321976175}-{'f1_val': 0.996808967411047, 'auprc': 0.996835682157898, 'loss_val': 0.06294245589883336, 'psi': 0.9968196533097874}
[S10] START round=21 head_norm_before_train=1.729693 (no previous merge yet)
[S10] round=21 local utility u=0.009266 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952861042054397, 'loss_val': 0.06649213532456437, 'psi': 0.9952271450938007}-{'f1_val': 0.9947664837091956, 'auprc': 0.9930581575000286, 'loss_val': 0.07581142751380841, 'psi': 0.9940831532255288}
[S11] START round=21 head_norm_before_train=1.591801 cos_to_last_merge=0.8463 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=21 local utility u=0.000906 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9983746209383713, 'loss_val': 0.04664006489180544, 'psi': 0.997157703525456}-{'f1_val': 0.9963464252501789, 'auprc': 0.9982824307246014, 'loss_val': 0.04817503423559973, 'psi': 0.9971208274399479}
[S13] START round=21 head_norm_before_train=1.609404 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5990569573708195, 'auprc': 0.6804798411293056, 'loss_val': 0.7811047415760303, 'psi': 0.6316261108742139}-{'f1_val': 0.6023397586168607, 'auprc': 0.6746135767110294, 'loss_val': 0.7373830485403537, 'psi': 0.6312492858545282}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.594898 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.001820 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9970674594793596, 'loss_val': 0.07568224501244242, 'psi': 0.9968146668019615}-{'f1_val': 0.9976516241010662, 'auprc': 0.9969775356807469, 'loss_val': 0.0850852575088398, 'psi': 0.9973819887329385}
[S15] START round=21 head_norm_before_train=1.233594 cos_to_last_merge=0.9430 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=21 local utility u=0.859895 metrics={'f1_val': 0.9930081355535765, 'auprc': 0.9893799150203407, 'loss_val': 0.1683256046259905, 'psi': 0.9915568473402822}-{'f1_val': 0.7498238975458502, 'auprc': 0.9557047970797861, 'loss_val': 0.3279841747265549, 'psi': 0.8321762573594245}
[S16] START round=21 head_norm_before_train=1.827899 (no previous merge yet)
[S16] round=21 local utility u=0.270401 metrics={'f1_val': 0.8764878317242397, 'auprc': 0.9956673556681273, 'loss_val': 0.471876669175774, 'psi': 0.9241596413017947}-{'f1_val': 0.8215321523281294, 'auprc': 0.9440541437166355, 'loss_val': 0.5281049196008606, 'psi': 0.8705409488835318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=21 head_norm_before_train=1.304341 cos_to_last_merge=0.8318 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=21 local utility u=0.707036 metrics={'f1_val': 0.6416689516689517, 'auprc': 0.8195167708102431, 'loss_val': 0.6782945227579323, 'psi': 0.7128080793254683}-{'f1_val': 0.401586463840211, 'auprc': 0.8210546715204602, 'loss_val': 0.6564855460368042, 'psi': 0.5693737469123107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6454 head_norm=1.555501
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.026084e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6482 head_norm=1.553689 delta_norm=0.102608
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0427
[S7] DROPPED delta from S11 (cos=-0.0427 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.0000
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] cosine check vs S14: cos=0.9795
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1804) from S10
[S15] cosine check vs S10: cos=-0.0361
[S15] DROPPED delta from S10 (cos=-0.0361 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.8590
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.8905
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9449 head_norm=1.531539
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.064575e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9244 head_norm=1.475804 delta_norm=0.406458
[S9] aggregate: ROLLBACK (f1_val pre=0.945 post=0.924 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.6997 head_norm=1.469512
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.147177e+00
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.5006 head_norm=1.147196 delta_norm=1.147177
[S2] aggregate: ROLLBACK (f1_val pre=0.700 post=0.501 tol_abs=0.005 tol_rel=0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9572
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9952 head_norm=1.755283
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.542541e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9952 head_norm=1.707841 delta_norm=0.254254
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=-0.0852
[S7] DROPPED delta from S15 (cos=-0.0852 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.5724 head_norm=1.394632
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.704830e-02
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.5678 head_norm=1.365702 delta_norm=0.067048
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.147196 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6758005535537157, 'auprc': 0.7731286162445143, 'loss_val': 0.6937255663374353, 'psi': 0.7147317786300351}-{'f1_val': 0.6996780437696617, 'auprc': 0.7574712090697157, 'loss_val': 0.39395243206253666, 'psi': 0.7227953098896833}
[S3] START round=22 head_norm_before_train=1.529967 cos_to_last_merge=0.9153 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=22 local utility u=0.018393 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9973741835091303, 'loss_val': 0.056207354855853806, 'psi': 0.9973714919987045}-{'f1_val': 0.9940335392918865, 'auprc': 0.9975703381200886, 'loss_val': 0.07356437640474764, 'psi': 0.9954482588231672}
[S4] START round=22 head_norm_before_train=1.762011 (no previous merge yet)
[S4] round=22 local utility u=0.904836 metrics={'f1_val': 0.9481972577150077, 'auprc': 0.882374332617036, 'loss_val': 0.35039293690854806, 'psi': 0.9218680876758191}-{'f1_val': 0.6555516157565794, 'auprc': 0.9077341850017137, 'loss_val': 0.4802702043721045, 'psi': 0.7564246434546331}
[S5] START round=22 head_norm_before_train=1.553689 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.136816 metrics={'f1_val': 0.6662308615387272, 'auprc': 0.8738986228556622, 'loss_val': 0.36300373963724664, 'psi': 0.7492979660655013}-{'f1_val': 0.6454281955502855, 'auprc': 0.853913487734449, 'loss_val': 0.45186340018821564, 'psi': 0.7288223124239509}
[S6] START round=22 head_norm_before_train=1.365702 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.8342838713216527, 'auprc': 0.9687254542084462, 'loss_val': 0.24543104107802863, 'psi': 0.8880605044763701}-{'f1_val': 0.572367812656729, 'auprc': 0.7833421018197573, 'loss_val': 0.626890111867156, 'psi': 0.6567575283219402}
[S7] START round=22 head_norm_before_train=1.697561 cos_to_last_merge=0.9807 (last merge round=13)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6677133399818382, 'auprc': 0.8106700673478638, 'loss_val': 0.5046430920285052, 'psi': 0.7248960309282485}-{'f1_val': 0.6896374916629162, 'auprc': 0.8596142308199946, 'loss_val': 0.33292848020551563, 'psi': 0.7576281873257475}
[S8] START round=22 head_norm_before_train=1.203376 cos_to_last_merge=0.9588 (last merge round=13)
[S8] round=22 local utility u=0.056702 metrics={'f1_val': 0.7173119888678735, 'auprc': 0.9970760857969443, 'loss_val': 0.2521317393252609, 'psi': 0.8292176276395018}-{'f1_val': 0.7137538225988359, 'auprc': 0.9845742257840611, 'loss_val': 0.30668207643214235, 'psi': 0.8220819838729261}
[S9] START round=22 head_norm_before_train=1.475804 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.192398 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9957138820223899, 'loss_val': 0.09758976761222928, 'psi': 0.9963709332555841}-{'f1_val': 0.9449187746423322, 'auprc': 0.9939389185305454, 'loss_val': 0.16572036532469314, 'psi': 0.9645268321976175}
[S10] START round=22 head_norm_before_train=1.707841 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943768461798683, 'loss_val': 0.07004776134888485, 'psi': 0.9948634418835722}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952861042054397, 'loss_val': 0.06649213532456437, 'psi': 0.9952271450938007}
[S11] START round=22 head_norm_before_train=1.618003 cos_to_last_merge=0.8432 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=22 local utility u=0.002111 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9974751881918142, 'loss_val': 0.039595682019622436, 'psi': 0.9967854550897934}-{'f1_val': 0.9963464252501789, 'auprc': 0.9983746209383713, 'loss_val': 0.04664006489180544, 'psi': 0.997157703525456}
[S13] START round=22 head_norm_before_train=1.621844 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5948013207699289, 'auprc': 0.682813349185593, 'loss_val': 0.8267393569606043, 'psi': 0.6300061321361945}-{'f1_val': 0.5990569573708195, 'auprc': 0.6804798411293056, 'loss_val': 0.7811047415760303, 'psi': 0.6316261108742139}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.630132 cos_to_last_merge=0.9997 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9934807235898097, 'auprc': 0.9987638100533256, 'loss_val': 0.0653508088847232, 'psi': 0.995593958175216}-{'f1_val': 0.9966461383503629, 'auprc': 0.9970674594793596, 'loss_val': 0.07568224501244242, 'psi': 0.9968146668019615}
[S15] START round=22 head_norm_before_train=1.269385 cos_to_last_merge=0.9374 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7001020050859328, 'auprc': 0.8111930779179397, 'loss_val': 0.401496426706371, 'psi': 0.7445384342187356}-{'f1_val': 0.9930081355535765, 'auprc': 0.9893799150203407, 'loss_val': 0.1683256046259905, 'psi': 0.9915568473402822}
[S16] START round=22 head_norm_before_train=1.847056 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8713025961918437, 'auprc': 0.9980030192177676, 'loss_val': 0.5179286736516214, 'psi': 0.9219827654022132}-{'f1_val': 0.8764878317242397, 'auprc': 0.9956673556681273, 'loss_val': 0.471876669175774, 'psi': 0.9241596413017947}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.330952 cos_to_last_merge=0.8291 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=22 local utility u=0.007717 metrics={'f1_val': 0.6500760546279759, 'auprc': 0.820891907558637, 'loss_val': 0.7174292881907832, 'psi': 0.7184023958002403}-{'f1_val': 0.6416689516689517, 'auprc': 0.8195167708102431, 'loss_val': 0.6782945227579323, 'psi': 0.7128080793254683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:57005
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.7487
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9327
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0449
[S7] DROPPED delta from S11 (cos=-0.0449 < 0.0)
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:57016
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9053
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.9514
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.9327
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6758 head_norm=1.172855
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.891616e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.5787 head_norm=1.376915 delta_norm=0.589162
[S2] aggregate: ROLLBACK (f1_val pre=0.676 post=0.579 tol_abs=0.005 tol_rel=0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=-0.0246
[S16] DROPPED delta from S6 (cos=-0.0246 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9968 head_norm=1.531447
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.662058e-02
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9968 head_norm=1.508184 delta_norm=0.056621
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8343 head_norm=1.381567
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.937008e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.9036 head_norm=1.273646 delta_norm=0.293701
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.376915 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.131673 metrics={'f1_val': 0.7187630218893657, 'auprc': 0.789486626277351, 'loss_val': 0.7372293085737842, 'psi': 0.7470524636445598}-{'f1_val': 0.6758005535537157, 'auprc': 0.7731286162445143, 'loss_val': 0.6937255663374353, 'psi': 0.7147317786300351}
[S3] START round=23 head_norm_before_train=1.565857 cos_to_last_merge=0.9089 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.972865017655, 'auprc': 0.9976111516625833, 'loss_val': 0.07570818392165383, 'psi': 0.9827634712580333}-{'f1_val': 0.9973696976584205, 'auprc': 0.9973741835091303, 'loss_val': 0.056207354855853806, 'psi': 0.9973714919987045}
[S4] START round=23 head_norm_before_train=1.763640 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9308119676046795, 'auprc': 0.8883360800139526, 'loss_val': 0.4625824509433703, 'psi': 0.9138216125683887}-{'f1_val': 0.9481972577150077, 'auprc': 0.882374332617036, 'loss_val': 0.35039293690854806, 'psi': 0.9218680876758191}
[S5] START round=23 head_norm_before_train=1.583099 cos_to_last_merge=0.9997 (last merge round=21)
[S5] round=23 local utility u=0.352918 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9897354680663235, 'loss_val': 0.2119798324020317, 'psi': 0.816362861700228}-{'f1_val': 0.6662308615387272, 'auprc': 0.8738986228556622, 'loss_val': 0.36300373963724664, 'psi': 0.7492979660655013}
[S6] START round=23 head_norm_before_train=1.273646 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6124308323235985, 'auprc': 0.7790055033974562, 'loss_val': 0.5820750687210811, 'psi': 0.6790607007531416}-{'f1_val': 0.8342838713216527, 'auprc': 0.9687254542084462, 'loss_val': 0.24543104107802863, 'psi': 0.8880605044763701}
[S7] START round=23 head_norm_before_train=1.708973 cos_to_last_merge=0.9787 (last merge round=13)
[S7] round=23 local utility u=0.455839 metrics={'f1_val': 0.7064122087607063, 'auprc': 0.9665919178765545, 'loss_val': 0.29292297564121905, 'psi': 0.8104840924070456}-{'f1_val': 0.6677133399818382, 'auprc': 0.8106700673478638, 'loss_val': 0.5046430920285052, 'psi': 0.7248960309282485}
[S8] START round=23 head_norm_before_train=1.228065 cos_to_last_merge=0.9544 (last merge round=13)
[S8] round=23 local utility u=0.761451 metrics={'f1_val': 0.9736522414012571, 'auprc': 0.9871465065719096, 'loss_val': 0.23748239753276892, 'psi': 0.979049947469518}-{'f1_val': 0.7173119888678735, 'auprc': 0.9970760857969443, 'loss_val': 0.2521317393252609, 'psi': 0.8292176276395018}
[S9] START round=23 head_norm_before_train=1.508184 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.003581 metrics={'f1_val': 0.9930610557399971, 'auprc': 0.9988129155759187, 'loss_val': 0.07723696663903351, 'psi': 0.9953617996743658}-{'f1_val': 0.996808967411047, 'auprc': 0.9957138820223899, 'loss_val': 0.09758976761222928, 'psi': 0.9963709332555841}
[S10] START round=23 head_norm_before_train=1.733299 cos_to_last_merge=0.9998 (last merge round=21)
[S10] round=23 local utility u=0.005640 metrics={'f1_val': 0.994243089309356, 'auprc': 0.9968095567084065, 'loss_val': 0.060397877222532564, 'psi': 0.9952696762689763}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943768461798683, 'loss_val': 0.07004776134888485, 'psi': 0.9948634418835722}
[S11] START round=23 head_norm_before_train=1.644002 cos_to_last_merge=0.8408 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=23 local utility u=0.000146 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9978888646985072, 'loss_val': 0.040669704758920726, 'psi': 0.9969634010295103}-{'f1_val': 0.9963256330217796, 'auprc': 0.9974751881918142, 'loss_val': 0.039595682019622436, 'psi': 0.9967854550897934}
[S13] START round=23 head_norm_before_train=1.634378 (no previous merge yet)
[S13] round=23 local utility u=0.040098 metrics={'f1_val': 0.6034006877630337, 'auprc': 0.678470080410321, 'loss_val': 0.7851092075148238, 'psi': 0.6334284448219486}-{'f1_val': 0.5948013207699289, 'auprc': 0.682813349185593, 'loss_val': 0.8267393569606043, 'psi': 0.6300061321361945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.669470 cos_to_last_merge=0.9986 (last merge round=20)
[S14] round=23 local utility u=0.023712 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990499210116498, 'loss_val': 0.04380708587627283, 'psi': 0.9982106392345721}-{'f1_val': 0.9934807235898097, 'auprc': 0.9987638100533256, 'loss_val': 0.0653508088847232, 'psi': 0.995593958175216}
[S15] START round=23 head_norm_before_train=1.301952 cos_to_last_merge=0.9326 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9869387033638674, 'auprc': 0.997323425600497, 'loss_val': 0.14402497999181726, 'psi': 0.9910925922585192}-{'f1_val': 0.7001020050859328, 'auprc': 0.8111930779179397, 'loss_val': 0.401496426706371, 'psi': 0.7445384342187356}
[S16] START round=23 head_norm_before_train=1.865362 (no previous merge yet)
[S16] round=23 local utility u=0.591308 metrics={'f1_val': 0.9924138266823379, 'auprc': 0.9949234651281148, 'loss_val': 0.05274064158337532, 'psi': 0.9934176820606486}-{'f1_val': 0.8713025961918437, 'auprc': 0.9980030192177676, 'loss_val': 0.5179286736516214, 'psi': 0.9219827654022132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=23 head_norm_before_train=1.362932 cos_to_last_merge=0.8264 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6534754597886044, 'auprc': 0.8217034432760315, 'loss_val': 0.7621051141828696, 'psi': 0.7207666531835752}-{'f1_val': 0.6500760546279759, 'auprc': 0.820891907558637, 'loss_val': 0.7174292881907832, 'psi': 0.7184023958002403}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:57007
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:57005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9438
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=0.8988
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=-0.0470
[S7] DROPPED delta from S11 (cos=-0.0470 < 0.0)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7008 head_norm=1.625099
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.031839e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7008 head_norm=1.549586 delta_norm=0.303184
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[S15] RECEIVED delta(kind=head bytes=1799) from S10
[S15] cosine check vs S10: cos=-0.0594
[S15] DROPPED delta from S10 (cos=-0.0594 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9883
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9706
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:57008
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9833
[S15] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S15
[S7] cosine check vs S15: cos=-0.0907
[S7] DROPPED delta from S15 (cos=-0.0907 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9931 head_norm=1.571101
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.691708e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9931 head_norm=1.575500 delta_norm=0.269171
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:57011
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9942 head_norm=1.764439
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.607858e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9943 head_norm=1.735213 delta_norm=0.160786
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.6124 head_norm=1.289403
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.240811e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.6043 head_norm=1.337981 delta_norm=0.124081
[S6] aggregate: ROLLBACK (f1_val pre=0.612 post=0.604 tol_abs=0.005 tol_rel=0.0)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] cosine check vs S2: cos=-0.0368
[S10] DROPPED delta from S2 (cos=-0.0368 < 0.0)
[S2] START round=24 head_norm_before_train=1.396394 cos_to_last_merge=0.9976 (last merge round=22)
[S2] round=24 local utility u=0.029450 metrics={'f1_val': 0.6989781258636941, 'auprc': 0.7867401014589172, 'loss_val': 0.5513793997185792, 'psi': 0.7340829161017833}-{'f1_val': 0.7187630218893657, 'auprc': 0.789486626277351, 'loss_val': 0.7372293085737842, 'psi': 0.7470524636445598}
[S3] START round=24 head_norm_before_train=1.595700 cos_to_last_merge=0.9034 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9764207308162671, 'auprc': 0.9974572419828237, 'loss_val': 0.1088980221597732, 'psi': 0.9848353352828897}-{'f1_val': 0.972865017655, 'auprc': 0.9976111516625833, 'loss_val': 0.07570818392165383, 'psi': 0.9827634712580333}
[S4] START round=24 head_norm_before_train=1.766467 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.6106247009700243, 'auprc': 0.9124446599060847, 'loss_val': 0.5066681502393117, 'psi': 0.7313526845444485}-{'f1_val': 0.9308119676046795, 'auprc': 0.8883360800139526, 'loss_val': 0.4625824509433703, 'psi': 0.9138216125683887}
[S5] START round=24 head_norm_before_train=1.549586 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.9773009991926498, 'loss_val': 0.2746119267140004, 'psi': 0.8114409601092651}-{'f1_val': 0.700781124122831, 'auprc': 0.9897354680663235, 'loss_val': 0.2119798324020317, 'psi': 0.816362861700228}
[S6] START round=24 head_norm_before_train=1.337981 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9581329696332914, 'auprc': 0.9728448019047633, 'loss_val': 0.2710178144134981, 'psi': 0.9640177025418801}-{'f1_val': 0.6124308323235985, 'auprc': 0.7790055033974562, 'loss_val': 0.5820750687210811, 'psi': 0.6790607007531416}
[S7] START round=24 head_norm_before_train=1.720577 cos_to_last_merge=0.9771 (last merge round=13)
[S7] round=24 local utility u=0.055472 metrics={'f1_val': 0.6991389908653732, 'auprc': 0.9908804545851301, 'loss_val': 0.21120599306727025, 'psi': 0.8158355763532761}-{'f1_val': 0.7064122087607063, 'auprc': 0.9665919178765545, 'loss_val': 0.29292297564121905, 'psi': 0.8104840924070456}
[S8] START round=24 head_norm_before_train=1.254932 cos_to_last_merge=0.9507 (last merge round=13)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7756024851004379, 'loss_val': 0.6258242676346648, 'psi': 0.7386512228244438}-{'f1_val': 0.9736522414012571, 'auprc': 0.9871465065719096, 'loss_val': 0.23748239753276892, 'psi': 0.979049947469518}
[S9] START round=24 head_norm_before_train=1.575500 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.026665 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9982378133862596, 'loss_val': 0.04466901498416499, 'psi': 0.997380505801132}-{'f1_val': 0.9930610557399971, 'auprc': 0.9988129155759187, 'loss_val': 0.07723696663903351, 'psi': 0.9953617996743658}
[S10] START round=24 head_norm_before_train=1.735213 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.003003 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964977518548571, 'loss_val': 0.05993656691302508, 'psi': 0.9957929730801811}-{'f1_val': 0.994243089309356, 'auprc': 0.9968095567084065, 'loss_val': 0.060397877222532564, 'psi': 0.9952696762689763}
[S11] START round=24 head_norm_before_train=1.667507 cos_to_last_merge=0.8389 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=24 local utility u=0.002618 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9974621543583747, 'loss_val': 0.03402869347163792, 'psi': 0.9967802415564176}-{'f1_val': 0.9963464252501789, 'auprc': 0.9978888646985072, 'loss_val': 0.040669704758920726, 'psi': 0.9969634010295103}
[S13] START round=24 head_norm_before_train=1.647509 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5811577549081285, 'auprc': 0.6903421251065156, 'loss_val': 0.894824906176221, 'psi': 0.6248315029874834}-{'f1_val': 0.6034006877630337, 'auprc': 0.678470080410321, 'loss_val': 0.7851092075148238, 'psi': 0.6334284448219486}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.707702 cos_to_last_merge=0.9969 (last merge round=20)
[S14] round=24 local utility u=0.003795 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.999045324117906, 'loss_val': 0.03621930223454853, 'psi': 0.998210435336736}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990499210116498, 'loss_val': 0.04380708587627283, 'psi': 0.9982106392345721}
[S15] START round=24 head_norm_before_train=1.330643 cos_to_last_merge=0.9287 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6954878901568633, 'auprc': 0.8035456701038567, 'loss_val': 0.4455336675987213, 'psi': 0.7387110021356607}-{'f1_val': 0.9869387033638674, 'auprc': 0.997323425600497, 'loss_val': 0.14402497999181726, 'psi': 0.9910925922585192}
[S16] START round=24 head_norm_before_train=1.882705 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9154152889411425, 'auprc': 0.9919337728098299, 'loss_val': 0.3545326952407902, 'psi': 0.9460226824886174}-{'f1_val': 0.9924138266823379, 'auprc': 0.9949234651281148, 'loss_val': 0.05274064158337532, 'psi': 0.9934176820606486}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.398358 cos_to_last_merge=0.8236 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6407004359636674, 'auprc': 0.8200229062356015, 'loss_val': 0.9387503666998275, 'psi': 0.7124294240724411}-{'f1_val': 0.6534754597886044, 'auprc': 0.8217034432760315, 'loss_val': 0.7621051141828696, 'psi': 0.7207666531835752}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7009 head_norm=1.587995
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.365616e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7009 head_norm=1.573656 delta_norm=0.136562
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] cosine check vs S14: cos=0.9320
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=-0.0491
[S7] DROPPED delta from S11 (cos=-0.0491 < 0.0)
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:57016
[S15] RECEIVED delta(kind=head bytes=1797) from S10
[S15] cosine check vs S10: cos=-0.0742
[S15] DROPPED delta from S10 (cos=-0.0742 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9943
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=-0.0385
[S10] DROPPED delta from S2 (cos=-0.0385 < 0.0)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9935
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=-0.0162
[S16] DROPPED delta from S6 (cos=-0.0162 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.9581 head_norm=1.359735
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.424311e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.9584 head_norm=1.525164 delta_norm=0.342431
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9953 head_norm=1.766205
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.012185e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9953 head_norm=1.746078 delta_norm=0.101219
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.434610 cos_to_last_merge=0.9893 (last merge round=22)
[S2] round=25 local utility u=0.052143 metrics={'f1_val': 0.7050999235660292, 'auprc': 0.7876539328174287, 'loss_val': 0.4865657899518836, 'psi': 0.7381215272665891}-{'f1_val': 0.6989781258636941, 'auprc': 0.7867401014589172, 'loss_val': 0.5513793997185792, 'psi': 0.7340829161017833}
[S3] START round=25 head_norm_before_train=1.621686 cos_to_last_merge=0.8986 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9475182570117231, 'auprc': 0.9977010423827101, 'loss_val': 0.15191737118289866, 'psi': 0.9675913711601178}-{'f1_val': 0.9764207308162671, 'auprc': 0.9974572419828237, 'loss_val': 0.1088980221597732, 'psi': 0.9848353352828897}
[S4] START round=25 head_norm_before_train=1.775904 (no previous merge yet)
[S4] round=25 local utility u=1.000000 metrics={'f1_val': 0.9361604035828262, 'auprc': 0.9491014264148014, 'loss_val': 0.281710542031823, 'psi': 0.9413368127156163}-{'f1_val': 0.6106247009700243, 'auprc': 0.9124446599060847, 'loss_val': 0.5066681502393117, 'psi': 0.7313526845444485}
[S5] START round=25 head_norm_before_train=1.573656 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6869548359668776, 'auprc': 0.8578015301088966, 'loss_val': 0.39862988881439004, 'psi': 0.7552935136236851}-{'f1_val': 0.7008676007203419, 'auprc': 0.9773009991926498, 'loss_val': 0.2746119267140004, 'psi': 0.8114409601092651}
[S6] START round=25 head_norm_before_train=1.525164 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.4623696234216277, 'auprc': 0.7657313041981134, 'loss_val': 0.8921229443851514, 'psi': 0.5837142957322219}-{'f1_val': 0.9581329696332914, 'auprc': 0.9728448019047633, 'loss_val': 0.2710178144134981, 'psi': 0.9640177025418801}
[S7] START round=25 head_norm_before_train=1.731643 cos_to_last_merge=0.9754 (last merge round=13)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6865585628143404, 'auprc': 0.8533376724960494, 'loss_val': 0.3441218257327497, 'psi': 0.753270206687024}-{'f1_val': 0.6991389908653732, 'auprc': 0.9908804545851301, 'loss_val': 0.21120599306727025, 'psi': 0.8158355763532761}
[S8] START round=25 head_norm_before_train=1.279349 cos_to_last_merge=0.9471 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=25 local utility u=1.000000 metrics={'f1_val': 0.9937568072064122, 'auprc': 0.994692495295977, 'loss_val': 0.2076855056762456, 'psi': 0.9941310824422381}-{'f1_val': 0.7140170479737811, 'auprc': 0.7756024851004379, 'loss_val': 0.6258242676346648, 'psi': 0.7386512228244438}
[S9] START round=25 head_norm_before_train=1.634395 cos_to_last_merge=0.9993 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9901193303318852, 'auprc': 0.9959748399745312, 'loss_val': 0.05358000548307042, 'psi': 0.9924615341889436}-{'f1_val': 0.996808967411047, 'auprc': 0.9982378133862596, 'loss_val': 0.04466901498416499, 'psi': 0.997380505801132}
[S10] START round=25 head_norm_before_train=1.746078 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9939921299130324, 'loss_val': 0.05854806212928615, 'psi': 0.9947907243034512}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964977518548571, 'loss_val': 0.05993656691302508, 'psi': 0.9957929730801811}
[S11] START round=25 head_norm_before_train=1.687553 cos_to_last_merge=0.8373 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=25 local utility u=0.001664 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9979730770348227, 'loss_val': 0.03235856171364145, 'psi': 0.9969970859640365}-{'f1_val': 0.9963256330217796, 'auprc': 0.9974621543583747, 'loss_val': 0.03402869347163792, 'psi': 0.9967802415564176}
[S13] START round=25 head_norm_before_train=1.657457 (no previous merge yet)
[S13] round=25 local utility u=0.108563 metrics={'f1_val': 0.60541422988644, 'auprc': 0.6817818119891524, 'loss_val': 0.797557391570726, 'psi': 0.6359612627275251}-{'f1_val': 0.5811577549081285, 'auprc': 0.6903421251065156, 'loss_val': 0.894824906176221, 'psi': 0.6248315029874834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=25 head_norm_before_train=1.742954 cos_to_last_merge=0.9952 (last merge round=20)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9963353604820302, 'auprc': 0.9986749129422863, 'loss_val': 0.04171427295408508, 'psi': 0.9972711814661326}-{'f1_val': 0.9976538428159559, 'auprc': 0.999045324117906, 'loss_val': 0.03621930223454853, 'psi': 0.998210435336736}
[S15] START round=25 head_norm_before_train=1.351799 cos_to_last_merge=0.9258 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=25 local utility u=0.749863 metrics={'f1_val': 0.8185193322066295, 'auprc': 0.9899859523409532, 'loss_val': 0.24331801247301427, 'psi': 0.8871059802603589}-{'f1_val': 0.6954878901568633, 'auprc': 0.8035456701038567, 'loss_val': 0.4455336675987213, 'psi': 0.7387110021356607}
[S16] START round=25 head_norm_before_train=1.898008 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9043191464257173, 'auprc': 0.9936333857883503, 'loss_val': 0.3975647983291161, 'psi': 0.9400448421707704}-{'f1_val': 0.9154152889411425, 'auprc': 0.9919337728098299, 'loss_val': 0.3545326952407902, 'psi': 0.9460226824886174}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.424986 cos_to_last_merge=0.8210 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=25 local utility u=0.134787 metrics={'f1_val': 0.6649879909259788, 'auprc': 0.8179490924610562, 'loss_val': 0.8086793133149479, 'psi': 0.7261724315400098}-{'f1_val': 0.6407004359636674, 'auprc': 0.8200229062356015, 'loss_val': 0.9387503666998275, 'psi': 0.7124294240724411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:57002
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.6870 head_norm=1.607854
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.927205e-02
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.6904 head_norm=1.619240 delta_norm=0.079272
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.190 → S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:57011
[S4] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S14] ⇄ pheromone p=0.047 → S6@127.0.0.1:57007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] cosine check vs S4: cos=0.8851
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0500
[S7] DROPPED delta from S11 (cos=-0.0500 < 0.0)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] ⇄ pheromone p=0.023 → S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.328 → S2@127.0.0.1:57002
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] cosine check vs S2: cos=-0.0379
[S10] DROPPED delta from S2 (cos=-0.0379 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.8557
[S9] ⇄ pheromone p=0.060 → S3@127.0.0.1:57003
[S3] ⇄ pheromone p=0.069 → S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.7051 head_norm=1.487598
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.197323e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.6992 head_norm=1.592071 delta_norm=0.419732
[S2] aggregate: ROLLBACK (f1_val pre=0.705 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.057 → S4@127.0.0.1:57004
[S8] ⇄ pheromone p=0.361 → S6@127.0.0.1:57007
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=-0.0947
[S7] DROPPED delta from S15 (cos=-0.0947 < 0.0)
[S10] ⇄ pheromone p=0.039 → S15@127.0.0.1:57015
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.4624 head_norm=1.545340
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.001175e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.4587 head_norm=1.368132 delta_norm=0.400118
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.350 → S16@127.0.0.1:57016
[S7] ⇄ pheromone p=0.126 → S10@127.0.0.1:57011
[S15] ⇄ pheromone p=0.425 → S7@127.0.0.1:57008
[S2] START round=26 head_norm_before_train=1.592071 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.712255324577989, 'auprc': 0.7895923192444554, 'loss_val': 0.6017426150562907, 'psi': 0.7431901224445756}-{'f1_val': 0.7050999235660292, 'auprc': 0.7876539328174287, 'loss_val': 0.4865657899518836, 'psi': 0.7381215272665891}
[S3] START round=26 head_norm_before_train=1.644828 cos_to_last_merge=0.8944 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=26 local utility u=0.158235 metrics={'f1_val': 0.9835800728454073, 'auprc': 0.9976759741256577, 'loss_val': 0.051742212034969905, 'psi': 0.9892184333575075}-{'f1_val': 0.9475182570117231, 'auprc': 0.9977010423827101, 'loss_val': 0.15191737118289866, 'psi': 0.9675913711601178}
[S4] START round=26 head_norm_before_train=1.791307 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9308163536819283, 'auprc': 0.9551144109087808, 'loss_val': 0.3438647889391524, 'psi': 0.9405355765726693}-{'f1_val': 0.9361604035828262, 'auprc': 0.9491014264148014, 'loss_val': 0.281710542031823, 'psi': 0.9413368127156163}
[S5] START round=26 head_norm_before_train=1.619240 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.43728552446051266, 'auprc': 0.8535747392404697, 'loss_val': 0.8143755733708645, 'psi': 0.6038012103724955}-{'f1_val': 0.6869548359668776, 'auprc': 0.8578015301088966, 'loss_val': 0.39862988881439004, 'psi': 0.7552935136236851}
[S6] START round=26 head_norm_before_train=1.368132 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9550448606141448, 'auprc': 0.9884973633656207, 'loss_val': 0.2509773903399086, 'psi': 0.9684258617147352}-{'f1_val': 0.4623696234216277, 'auprc': 0.7657313041981134, 'loss_val': 0.8921229443851514, 'psi': 0.5837142957322219}
[S7] START round=26 head_norm_before_train=1.740211 cos_to_last_merge=0.9743 (last merge round=13)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5068319833398249, 'auprc': 0.7706931520187599, 'loss_val': 1.1534909875704302, 'psi': 0.6123764508113989}-{'f1_val': 0.6865585628143404, 'auprc': 0.8533376724960494, 'loss_val': 0.3441218257327497, 'psi': 0.753270206687024}
[S8] START round=26 head_norm_before_train=1.294482 cos_to_last_merge=0.9443 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.993036649104297, 'auprc': 0.988185700257189, 'loss_val': 0.19919090286914978, 'psi': 0.9910962695654537}-{'f1_val': 0.9937568072064122, 'auprc': 0.994692495295977, 'loss_val': 0.2076855056762456, 'psi': 0.9941310824422381}
[S9] START round=26 head_norm_before_train=1.674608 cos_to_last_merge=0.9982 (last merge round=23)
[S9] round=26 local utility u=0.029003 metrics={'f1_val': 0.9955623821232735, 'auprc': 0.998968685497711, 'loss_val': 0.037213423340386416, 'psi': 0.9969249034730485}-{'f1_val': 0.9901193303318852, 'auprc': 0.9959748399745312, 'loss_val': 0.05358000548307042, 'psi': 0.9924615341889436}
[S10] START round=26 head_norm_before_train=1.772836 cos_to_last_merge=0.9998 (last merge round=24)
[S10] round=26 local utility u=0.003038 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9938543929210252, 'loss_val': 0.052058901181588395, 'psi': 0.9947356295066483}-{'f1_val': 0.9953231205637304, 'auprc': 0.9939921299130324, 'loss_val': 0.05854806212928615, 'psi': 0.9947907243034512}
[S11] START round=26 head_norm_before_train=1.703287 cos_to_last_merge=0.8361 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=26 local utility u=0.001078 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9982804816823376, 'loss_val': 0.031124005506783688, 'psi': 0.9971200478230424}-{'f1_val': 0.9963464252501789, 'auprc': 0.9979730770348227, 'loss_val': 0.03235856171364145, 'psi': 0.9969970859640365}
[S13] START round=26 head_norm_before_train=1.667949 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6048275903944015, 'auprc': 0.6829489193165379, 'loss_val': 0.8052893705124771, 'psi': 0.636076121963256}-{'f1_val': 0.60541422988644, 'auprc': 0.6817818119891524, 'loss_val': 0.797557391570726, 'psi': 0.6359612627275251}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.768553 cos_to_last_merge=0.9938 (last merge round=20)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9913779822898086, 'auprc': 0.996980545651734, 'loss_val': 0.04730570794887142, 'psi': 0.9936190076345788}-{'f1_val': 0.9963353604820302, 'auprc': 0.9986749129422863, 'loss_val': 0.04171427295408508, 'psi': 0.9972711814661326}
[S15] START round=26 head_norm_before_train=1.366724 cos_to_last_merge=0.9237 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=26 local utility u=0.602167 metrics={'f1_val': 0.9931337207729614, 'auprc': 0.9954703055254955, 'loss_val': 0.10312299506895438, 'psi': 0.994068354673975}-{'f1_val': 0.8185193322066295, 'auprc': 0.9899859523409532, 'loss_val': 0.24331801247301427, 'psi': 0.8871059802603589}
[S16] START round=26 head_norm_before_train=1.910251 (no previous merge yet)
[S16] round=26 local utility u=0.439282 metrics={'f1_val': 0.9922647283307827, 'auprc': 0.9941564338563242, 'loss_val': 0.04824277867572205, 'psi': 0.9930214105409993}-{'f1_val': 0.9043191464257173, 'auprc': 0.9936333857883503, 'loss_val': 0.3975647983291161, 'psi': 0.9400448421707704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=26 head_norm_before_train=1.450230 cos_to_last_merge=0.8186 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6502852989290836, 'auprc': 0.8268771222474693, 'loss_val': 0.957841158924807, 'psi': 0.7209220282564379}-{'f1_val': 0.6649879909259788, 'auprc': 0.8179490924610562, 'loss_val': 0.8086793133149479, 'psi': 0.7261724315400098}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] cosine check vs S11: cos=-0.0508
[S7] DROPPED delta from S11 (cos=-0.0508 < 0.0)
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.8392
[S5] RECEIVED delta(kind=head bytes=1806) from S9
[S5] cosine check vs S9: cos=0.9970
[S2] RECEIVED delta(kind=head bytes=1796) from S10
[S2] cosine check vs S10: cos=-0.0373
[S2] DROPPED delta from S10 (cos=-0.0373 < 0.0)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9536
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9956 head_norm=1.707839
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.789750e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9947 head_norm=1.618760 delta_norm=0.478975
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9930 head_norm=1.312008
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.081009e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9927 head_norm=1.331368 delta_norm=0.208101
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.627857 cos_to_last_merge=0.9972 (last merge round=25)
[S2] round=27 local utility u=0.015633 metrics={'f1_val': 0.7114095694804412, 'auprc': 0.7882544495142704, 'loss_val': 0.5613880390870187, 'psi': 0.7421475214939729}-{'f1_val': 0.712255324577989, 'auprc': 0.7895923192444554, 'loss_val': 0.6017426150562907, 'psi': 0.7431901224445756}
[S3] START round=27 head_norm_before_train=1.668199 cos_to_last_merge=0.8905 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=27 local utility u=0.022336 metrics={'f1_val': 0.9908505570179138, 'auprc': 0.9980505308770738, 'loss_val': 0.051816850872282036, 'psi': 0.9937305465615778}-{'f1_val': 0.9835800728454073, 'auprc': 0.9976759741256577, 'loss_val': 0.051742212034969905, 'psi': 0.9892184333575075}
[S4] START round=27 head_norm_before_train=1.811289 (no previous merge yet)
[S4] round=27 local utility u=0.002624 metrics={'f1_val': 0.9326567508896051, 'auprc': 0.9501113843933217, 'loss_val': 0.33464933395607727, 'psi': 0.9396386042910917}-{'f1_val': 0.9308163536819283, 'auprc': 0.9551144109087808, 'loss_val': 0.3438647889391524, 'psi': 0.9405355765726693}
[S5] START round=27 head_norm_before_train=1.644138 cos_to_last_merge=0.9998 (last merge round=25)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9185726698147817, 'loss_val': 0.3491293973603497, 'psi': 0.7878980746441504}-{'f1_val': 0.43728552446051266, 'auprc': 0.8535747392404697, 'loss_val': 0.8143755733708645, 'psi': 0.6038012103724955}
[S6] START round=27 head_norm_before_train=1.382146 cos_to_last_merge=0.9999 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8188595871747217, 'auprc': 0.9254216563134589, 'loss_val': 0.3620924545974195, 'psi': 0.8614844148302165}-{'f1_val': 0.9550448606141448, 'auprc': 0.9884973633656207, 'loss_val': 0.2509773903399086, 'psi': 0.9684258617147352}
[S7] START round=27 head_norm_before_train=1.747801 cos_to_last_merge=0.9733 (last merge round=13)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6995699134765261, 'auprc': 0.9110631263825226, 'loss_val': 0.2964122085559866, 'psi': 0.7841671986389247}-{'f1_val': 0.5068319833398249, 'auprc': 0.7706931520187599, 'loss_val': 1.1534909875704302, 'psi': 0.6123764508113989}
[S8] START round=27 head_norm_before_train=1.331368 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.002654 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9888392513530749, 'loss_val': 0.20075601010624528, 'psi': 0.9918489699096167}-{'f1_val': 0.993036649104297, 'auprc': 0.988185700257189, 'loss_val': 0.19919090286914978, 'psi': 0.9910962695654537}
[S9] START round=27 head_norm_before_train=1.618760 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9963712438762351, 'loss_val': 0.05967529805879126, 'psi': 0.9963684381421003}-{'f1_val': 0.9955623821232735, 'auprc': 0.998968685497711, 'loss_val': 0.037213423340386416, 'psi': 0.9969249034730485}
[S10] START round=27 head_norm_before_train=1.798833 cos_to_last_merge=0.9992 (last merge round=24)
[S10] round=27 local utility u=0.005695 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958731516526157, 'loss_val': 0.04672514143372924, 'psi': 0.9955431329992845}-{'f1_val': 0.9953231205637304, 'auprc': 0.9938543929210252, 'loss_val': 0.052058901181588395, 'psi': 0.9947356295066483}
[S11] START round=27 head_norm_before_train=1.717542 cos_to_last_merge=0.8350 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9977602430773338, 'loss_val': 0.03247151271222394, 'psi': 0.9970570552272655}-{'f1_val': 0.9963464252501789, 'auprc': 0.9982804816823376, 'loss_val': 0.031124005506783688, 'psi': 0.9971200478230424}
[S13] START round=27 head_norm_before_train=1.677229 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5771769403469629, 'auprc': 0.6922115658695001, 'loss_val': 0.9311015814552096, 'psi': 0.6231907905559777}-{'f1_val': 0.6048275903944015, 'auprc': 0.6829489193165379, 'loss_val': 0.8052893705124771, 'psi': 0.636076121963256}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.789171 cos_to_last_merge=0.9926 (last merge round=20)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.936576389098582, 'auprc': 0.9986712559646443, 'loss_val': 0.08907197378596722, 'psi': 0.9614143358450069}-{'f1_val': 0.9913779822898086, 'auprc': 0.996980545651734, 'loss_val': 0.04730570794887142, 'psi': 0.9936190076345788}
[S15] START round=27 head_norm_before_train=1.381764 cos_to_last_merge=0.9217 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9413247673412872, 'auprc': 0.9938136846467697, 'loss_val': 0.13157043291284695, 'psi': 0.9623203342634803}-{'f1_val': 0.9931337207729614, 'auprc': 0.9954703055254955, 'loss_val': 0.10312299506895438, 'psi': 0.994068354673975}
[S16] START round=27 head_norm_before_train=1.924919 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.884663358447161, 'auprc': 0.9941180290439695, 'loss_val': 0.4752534199633916, 'psi': 0.9284452266858845}-{'f1_val': 0.9922647283307827, 'auprc': 0.9941564338563242, 'loss_val': 0.04824277867572205, 'psi': 0.9930214105409993}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.474590 cos_to_last_merge=0.8163 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=27 local utility u=0.162550 metrics={'f1_val': 0.6852925060953694, 'auprc': 0.8333442739062238, 'loss_val': 0.8621854129341147, 'psi': 0.7445132132197112}-{'f1_val': 0.6502852989290836, 'auprc': 0.8268771222474693, 'loss_val': 0.957841158924807, 'psi': 0.7209220282564379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:57007
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.9373
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9755
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7008 head_norm=1.661147
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.073870e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7008 head_norm=1.683169 delta_norm=0.070739
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.9504
[S2] RECEIVED delta(kind=head bytes=1799) from S10
[S2] cosine check vs S10: cos=-0.0391
[S2] DROPPED delta from S10 (cos=-0.0391 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.9373
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] cosine check vs S8: cos=0.9870
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9964 head_norm=1.659053
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.369226e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9964 head_norm=1.636882 delta_norm=0.063692
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=-0.0965
[S15] DROPPED delta from S7 (cos=-0.0965 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7114 head_norm=1.671877
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.200153e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6424 head_norm=1.724501 delta_norm=0.320015
[S2] aggregate: ROLLBACK (f1_val pre=0.711 post=0.642 tol_abs=0.005 tol_rel=0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.8189 head_norm=1.397029
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.132062e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.8181 head_norm=1.369867 delta_norm=0.113206
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.724501 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6370659679938242, 'auprc': 0.7901845656001388, 'loss_val': 0.7150304821522769, 'psi': 0.69831340703635}-{'f1_val': 0.7114095694804412, 'auprc': 0.7882544495142704, 'loss_val': 0.5613880390870187, 'psi': 0.7421475214939729}
[S3] START round=28 head_norm_before_train=1.688423 cos_to_last_merge=0.8873 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9590079954520911, 'auprc': 0.9984096055444222, 'loss_val': 0.1384587241828736, 'psi': 0.9747686394890236}-{'f1_val': 0.9908505570179138, 'auprc': 0.9980505308770738, 'loss_val': 0.051816850872282036, 'psi': 0.9937305465615778}
[S4] START round=28 head_norm_before_train=1.832335 (no previous merge yet)
[S4] round=28 local utility u=0.116854 metrics={'f1_val': 0.942868668136098, 'auprc': 0.9816614911965839, 'loss_val': 0.25686230084996253, 'psi': 0.9583857973602923}-{'f1_val': 0.9326567508896051, 'auprc': 0.9501113843933217, 'loss_val': 0.33464933395607727, 'psi': 0.9396386042910917}
[S5] START round=28 head_norm_before_train=1.683169 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.43728526697303427, 'auprc': 0.8532615520850193, 'loss_val': 0.8621042973957407, 'psi': 0.6036757810178284}-{'f1_val': 0.7007816778637295, 'auprc': 0.9185726698147817, 'loss_val': 0.3491293973603497, 'psi': 0.7878980746441504}
[S6] START round=28 head_norm_before_train=1.369867 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.475068 metrics={'f1_val': 0.943828924369472, 'auprc': 0.9691666268844832, 'loss_val': 0.29300655055419894, 'psi': 0.9539640053754765}-{'f1_val': 0.8188595871747217, 'auprc': 0.9254216563134589, 'loss_val': 0.3620924545974195, 'psi': 0.8614844148302165}
[S7] START round=28 head_norm_before_train=1.753621 cos_to_last_merge=0.9725 (last merge round=13)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6798830818482869, 'auprc': 0.8355747336948528, 'loss_val': 0.397208408090336, 'psi': 0.7421597425869133}-{'f1_val': 0.6995699134765261, 'auprc': 0.9110631263825226, 'loss_val': 0.2964122085559866, 'psi': 0.7841671986389247}
[S8] START round=28 head_norm_before_train=1.351670 cos_to_last_merge=0.9998 (last merge round=26)
[S8] round=28 local utility u=0.003997 metrics={'f1_val': 0.9928968500159877, 'auprc': 0.9879673268637293, 'loss_val': 0.1843950457543846, 'psi': 0.9909250407550845}-{'f1_val': 0.9938554489473111, 'auprc': 0.9888392513530749, 'loss_val': 0.20075601010624528, 'psi': 0.9918489699096167}
[S9] START round=28 head_norm_before_train=1.636882 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9894764731487903, 'auprc': 0.9911611302523458, 'loss_val': 0.0909284410507778, 'psi': 0.9901503359902124}-{'f1_val': 0.9963665676526772, 'auprc': 0.9963712438762351, 'loss_val': 0.05967529805879126, 'psi': 0.9963684381421003}
[S10] START round=28 head_norm_before_train=1.823677 cos_to_last_merge=0.9983 (last merge round=24)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937463773365546, 'loss_val': 0.04349474108195169, 'psi': 0.9946112543462466}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958731516526157, 'loss_val': 0.04672514143372924, 'psi': 0.9955431329992845}
[S11] START round=28 head_norm_before_train=1.729288 cos_to_last_merge=0.8338 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=28 local utility u=0.001082 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9978253060550801, 'loss_val': 0.029052257982499403, 'psi': 0.9969379775721394}-{'f1_val': 0.9965882633272201, 'auprc': 0.9977602430773338, 'loss_val': 0.03247151271222394, 'psi': 0.9970570552272655}
[S13] START round=28 head_norm_before_train=1.683135 (no previous merge yet)
[S13] round=28 local utility u=0.102901 metrics={'f1_val': 0.6004917675742707, 'auprc': 0.6879277467720433, 'loss_val': 0.8523372116215772, 'psi': 0.6354661592533797}-{'f1_val': 0.5771769403469629, 'auprc': 0.6922115658695001, 'loss_val': 0.9311015814552096, 'psi': 0.6231907905559777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=28 head_norm_before_train=1.806648 cos_to_last_merge=0.9915 (last merge round=20)
[S14] round=28 local utility u=0.193782 metrics={'f1_val': 0.9930611278268856, 'auprc': 0.9990517393694311, 'loss_val': 0.04155762955047215, 'psi': 0.9954573724439039}-{'f1_val': 0.936576389098582, 'auprc': 0.9986712559646443, 'loss_val': 0.08907197378596722, 'psi': 0.9614143358450069}
[S15] START round=28 head_norm_before_train=1.400867 cos_to_last_merge=0.9193 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7000400194091229, 'auprc': 0.8583383172452688, 'loss_val': 0.42761373726299284, 'psi': 0.7633593385435813}-{'f1_val': 0.9413247673412872, 'auprc': 0.9938136846467697, 'loss_val': 0.13157043291284695, 'psi': 0.9623203342634803}
[S16] START round=28 head_norm_before_train=1.939716 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8486935921846757, 'auprc': 0.9868780451262931, 'loss_val': 0.8030546237174563, 'psi': 0.9039673733613226}-{'f1_val': 0.884663358447161, 'auprc': 0.9941180290439695, 'loss_val': 0.4752534199633916, 'psi': 0.9284452266858845}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.498662 cos_to_last_merge=0.8142 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.669037266727905, 'auprc': 0.8312220770920161, 'loss_val': 0.9731628469613777, 'psi': 0.7339111908735494}-{'f1_val': 0.6852925060953694, 'auprc': 0.8333442739062238, 'loss_val': 0.8621854129341147, 'psi': 0.7445132132197112}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1805) from S14
[S6] cosine check vs S14: cos=0.8831
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9749
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] cosine check vs S11: cos=-0.0524
[S7] DROPPED delta from S11 (cos=-0.0524 < 0.0)
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9429 head_norm=1.850688
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.254923e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9437 head_norm=1.733253 delta_norm=0.325492
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9951
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.6371 head_norm=1.753278
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.076364e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.6534 head_norm=1.790643 delta_norm=0.207636
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9951
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9929 head_norm=1.372881
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.871696e-02
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9902 head_norm=1.377842 delta_norm=0.068717
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.9438 head_norm=1.386197
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.909590e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9402 head_norm=1.448457 delta_norm=0.190959
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.790643 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.294055 metrics={'f1_val': 0.7038273624434825, 'auprc': 0.7857866387091699, 'loss_val': 0.5142959452191841, 'psi': 0.7366110729497575}-{'f1_val': 0.6370659679938242, 'auprc': 0.7901845656001388, 'loss_val': 0.7150304821522769, 'psi': 0.69831340703635}
[S3] START round=29 head_norm_before_train=1.708736 cos_to_last_merge=0.8840 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=29 local utility u=0.131033 metrics={'f1_val': 0.9881754231472347, 'auprc': 0.9981018996434716, 'loss_val': 0.050473859567476076, 'psi': 0.9921460137457294}-{'f1_val': 0.9590079954520911, 'auprc': 0.9984096055444222, 'loss_val': 0.1384587241828736, 'psi': 0.9747686394890236}
[S4] START round=29 head_norm_before_train=1.733253 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9322251992845552, 'auprc': 0.9703586223137461, 'loss_val': 0.2992800442581427, 'psi': 0.9474785684962316}-{'f1_val': 0.942868668136098, 'auprc': 0.9816614911965839, 'loss_val': 0.25686230084996253, 'psi': 0.9583857973602923}
[S5] START round=29 head_norm_before_train=1.701515 cos_to_last_merge=0.9999 (last merge round=27)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9858281124739341, 'loss_val': 0.37809180923663177, 'psi': 0.8148002517078113}-{'f1_val': 0.43728526697303427, 'auprc': 0.8532615520850193, 'loss_val': 0.8621042973957407, 'psi': 0.6036757810178284}
[S6] START round=29 head_norm_before_train=1.448457 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8217170523633242, 'auprc': 0.8335261015217552, 'loss_val': 0.40418928888960887, 'psi': 0.8264406720266966}-{'f1_val': 0.943828924369472, 'auprc': 0.9691666268844832, 'loss_val': 0.29300655055419894, 'psi': 0.9539640053754765}
[S7] START round=29 head_norm_before_train=1.762669 cos_to_last_merge=0.9716 (last merge round=13)
[S7] round=29 local utility u=0.004308 metrics={'f1_val': 0.6784706388399666, 'auprc': 0.8345461806898676, 'loss_val': 0.37703224130156865, 'psi': 0.740900855579927}-{'f1_val': 0.6798830818482869, 'auprc': 0.8355747336948528, 'loss_val': 0.397208408090336, 'psi': 0.7421597425869133}
[S8] START round=29 head_norm_before_train=1.377842 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.012940 metrics={'f1_val': 0.9936107548088262, 'auprc': 0.9878868290992063, 'loss_val': 0.1625563841685095, 'psi': 0.9913211845249783}-{'f1_val': 0.9928968500159877, 'auprc': 0.9879673268637293, 'loss_val': 0.1843950457543846, 'psi': 0.9909250407550845}
[S9] START round=29 head_norm_before_train=1.681414 cos_to_last_merge=0.9993 (last merge round=27)
[S9] round=29 local utility u=0.053105 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9962088326867934, 'loss_val': 0.04385588827542434, 'psi': 0.9965689135213456}-{'f1_val': 0.9894764731487903, 'auprc': 0.9911611302523458, 'loss_val': 0.0909284410507778, 'psi': 0.9901503359902124}
[S10] START round=29 head_norm_before_train=1.847404 cos_to_last_merge=0.9972 (last merge round=24)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9927001928544741, 'loss_val': 0.04135924509834889, 'psi': 0.9942739494800279}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937463773365546, 'loss_val': 0.04349474108195169, 'psi': 0.9946112543462466}
[S11] START round=29 head_norm_before_train=1.742698 cos_to_last_merge=0.8327 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9656676153890105, 'auprc': 0.9968883014652399, 'loss_val': 0.07644983556080714, 'psi': 0.9781558898195022}-{'f1_val': 0.9963464252501789, 'auprc': 0.9978253060550801, 'loss_val': 0.029052257982499403, 'psi': 0.9969379775721394}
[S13] START round=29 head_norm_before_train=1.688471 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5750536592232609, 'auprc': 0.6899360109272934, 'loss_val': 0.992173285925176, 'psi': 0.621006599904874}-{'f1_val': 0.6004917675742707, 'auprc': 0.6879277467720433, 'loss_val': 0.8523372116215772, 'psi': 0.6354661592533797}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.821172 cos_to_last_merge=0.9904 (last merge round=20)
[S14] round=29 local utility u=0.023582 metrics={'f1_val': 0.9984758593419994, 'auprc': 0.9990530661225723, 'loss_val': 0.026886919310175436, 'psi': 0.9987067420542286}-{'f1_val': 0.9930611278268856, 'auprc': 0.9990517393694311, 'loss_val': 0.04155762955047215, 'psi': 0.9954573724439039}
[S15] START round=29 head_norm_before_train=1.419511 cos_to_last_merge=0.9171 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=29 local utility u=0.321497 metrics={'f1_val': 0.7649481396904845, 'auprc': 0.9236753876890119, 'loss_val': 0.3700804875353356, 'psi': 0.8284390388898955}-{'f1_val': 0.7000400194091229, 'auprc': 0.8583383172452688, 'loss_val': 0.42761373726299284, 'psi': 0.7633593385435813}
[S16] START round=29 head_norm_before_train=1.954955 (no previous merge yet)
[S16] round=29 local utility u=0.599992 metrics={'f1_val': 0.9404875431536882, 'auprc': 0.9980680887316232, 'loss_val': 0.18740420342797973, 'psi': 0.9635197613848623}-{'f1_val': 0.8486935921846757, 'auprc': 0.9868780451262931, 'loss_val': 0.8030546237174563, 'psi': 0.9039673733613226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=29 head_norm_before_train=1.520182 cos_to_last_merge=0.8124 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6547643941716887, 'auprc': 0.8281386680017953, 'loss_val': 1.075141265502017, 'psi': 0.7241141037037313}-{'f1_val': 0.669037266727905, 'auprc': 0.8312220770920161, 'loss_val': 0.9731628469613777, 'psi': 0.7339111908735494}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:57005
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9717
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] cosine check vs S14: cos=0.9350
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9717
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.9424
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9836
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=0.9996
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.0981
[S15] DROPPED delta from S7 (cos=-0.0981 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9968 head_norm=1.722959
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.766153e-02
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9968 head_norm=1.687010 delta_norm=0.077662
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8217 head_norm=1.469285
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.088399e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8217 head_norm=1.511222 delta_norm=0.108840
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.809829 cos_to_last_merge=0.9990 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6812143447374144, 'auprc': 0.7438514703486999, 'loss_val': 0.5242224610996968, 'psi': 0.7062691949819286}-{'f1_val': 0.7038273624434825, 'auprc': 0.7857866387091699, 'loss_val': 0.5142959452191841, 'psi': 0.7366110729497575}
[S3] START round=30 head_norm_before_train=1.727278 cos_to_last_merge=0.8811 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.881
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9234008616971144, 'auprc': 0.9477066268898755, 'loss_val': 0.22152702629405271, 'psi': 0.9331231677742189}-{'f1_val': 0.9881754231472347, 'auprc': 0.9981018996434716, 'loss_val': 0.050473859567476076, 'psi': 0.9921460137457294}
[S4] START round=30 head_norm_before_train=1.749969 cos_to_last_merge=0.9999 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9293439936032105, 'auprc': 0.9434066072808224, 'loss_val': 0.26542145231187575, 'psi': 0.9349690390742553}-{'f1_val': 0.9322251992845552, 'auprc': 0.9703586223137461, 'loss_val': 0.2992800442581427, 'psi': 0.9474785684962316}
[S5] START round=30 head_norm_before_train=1.717355 cos_to_last_merge=0.9998 (last merge round=27)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9981104614907828, 'loss_val': 0.09623895092667123, 'psi': 0.9970897450095766}-{'f1_val': 0.7007816778637295, 'auprc': 0.9858281124739341, 'loss_val': 0.37809180923663177, 'psi': 0.8148002517078113}
[S6] START round=30 head_norm_before_train=1.511222 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.46269512146280467, 'auprc': 0.7782152659345544, 'loss_val': 0.9799481093764925, 'psi': 0.5889031792515045}-{'f1_val': 0.8217170523633242, 'auprc': 0.8335261015217552, 'loss_val': 0.40418928888960887, 'psi': 0.8264406720266966}
[S7] START round=30 head_norm_before_train=1.774344 cos_to_last_merge=0.9701 (last merge round=13)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5634864254858175, 'auprc': 0.7662415492767186, 'loss_val': 1.0733016475673292, 'psi': 0.644588475002178}-{'f1_val': 0.6784706388399666, 'auprc': 0.8345461806898676, 'loss_val': 0.37703224130156865, 'psi': 0.740900855579927}
[S8] START round=30 head_norm_before_train=1.396491 cos_to_last_merge=0.9999 (last merge round=28)
[S8] round=30 local utility u=0.007072 metrics={'f1_val': 0.9932513355536252, 'auprc': 0.987626310398303, 'loss_val': 0.14547379060922203, 'psi': 0.9910013254914963}-{'f1_val': 0.9936107548088262, 'auprc': 0.9878868290992063, 'loss_val': 0.1625563841685095, 'psi': 0.9913211845249783}
[S9] START round=30 head_norm_before_train=1.687010 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9960601757629016, 'loss_val': 0.04471592257191774, 'psi': 0.9965094507517889}-{'f1_val': 0.996808967411047, 'auprc': 0.9962088326867934, 'loss_val': 0.04385588827542434, 'psi': 0.9965689135213456}
[S10] START round=30 head_norm_before_train=1.869336 cos_to_last_merge=0.9962 (last merge round=24)
[S10] round=30 local utility u=0.002337 metrics={'f1_val': 0.993924439075923, 'auprc': 0.9970427082820505, 'loss_val': 0.0413212387328841, 'psi': 0.995171746758374}-{'f1_val': 0.9953231205637304, 'auprc': 0.9927001928544741, 'loss_val': 0.04135924509834889, 'psi': 0.9942739494800279}
[S11] START round=30 head_norm_before_train=1.756334 cos_to_last_merge=0.8315 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=30 local utility u=0.117502 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9975685848091629, 'loss_val': 0.02743503994235846, 'psi': 0.996822813736733}-{'f1_val': 0.9656676153890105, 'auprc': 0.9968883014652399, 'loss_val': 0.07644983556080714, 'psi': 0.9781558898195022}
[S13] START round=30 head_norm_before_train=1.697384 (no previous merge yet)
[S13] round=30 local utility u=0.161863 metrics={'f1_val': 0.6035844293630157, 'auprc': 0.6845827574740202, 'loss_val': 0.8235720767517961, 'psi': 0.6359837606074175}-{'f1_val': 0.5750536592232609, 'auprc': 0.6899360109272934, 'loss_val': 0.992173285925176, 'psi': 0.621006599904874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=30 head_norm_before_train=1.838500 cos_to_last_merge=0.9894 (last merge round=20)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.997284015000207, 'auprc': 0.9986145489859012, 'loss_val': 0.025125128887304272, 'psi': 0.9978162285944847}-{'f1_val': 0.9984758593419994, 'auprc': 0.9990530661225723, 'loss_val': 0.026886919310175436, 'psi': 0.9987067420542286}
[S15] START round=30 head_norm_before_train=1.437303 cos_to_last_merge=0.9149 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=30 local utility u=0.814372 metrics={'f1_val': 0.9584874716008919, 'auprc': 0.9904534109367019, 'loss_val': 0.10290751840067207, 'psi': 0.9712738473352158}-{'f1_val': 0.7649481396904845, 'auprc': 0.9236753876890119, 'loss_val': 0.3700804875353356, 'psi': 0.8284390388898955}
[S16] START round=30 head_norm_before_train=1.969732 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8513231347877503, 'auprc': 0.9951077540744706, 'loss_val': 0.7712991204944362, 'psi': 0.9088369825024385}-{'f1_val': 0.9404875431536882, 'auprc': 0.9980680887316232, 'loss_val': 0.18740420342797973, 'psi': 0.9635197613848623}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.543208 cos_to_last_merge=0.8107 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=30 local utility u=0.064497 metrics={'f1_val': 0.6464003896548584, 'auprc': 0.8444752178679272, 'loss_val': 0.9449730538125087, 'psi': 0.7256303209400858}-{'f1_val': 0.6547643941716887, 'auprc': 0.8281386680017953, 'loss_val': 1.075141265502017, 'psi': 0.7241141037037313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9293 head_norm=1.768309
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.661776e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9297 head_norm=1.788814 delta_norm=0.036618
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.123 → S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] ⇄ pheromone p=0.044 → S6@127.0.0.1:57007
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9702
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0548
[S7] DROPPED delta from S11 (cos=-0.0548 < 0.0)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.9964 head_norm=1.722940
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.053726e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.9964 head_norm=1.710666 delta_norm=0.205373
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.525 → S9@127.0.0.1:57010
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] ⇄ pheromone p=0.031 → S7@127.0.0.1:57008
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9674
[S2] RECEIVED delta(kind=head bytes=1800) from S10
[S2] cosine check vs S10: cos=-0.0385
[S2] DROPPED delta from S10 (cos=-0.0385 < 0.0)
[S2] ⇄ pheromone p=0.067 → S10@127.0.0.1:57011
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9968 head_norm=1.723562
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.103568e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9968 head_norm=1.710364 delta_norm=0.210357
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.031 → S5@127.0.0.1:57005
[S3] ⇄ pheromone p=0.059 → S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] ⇄ pheromone p=0.014 → S2@127.0.0.1:57002
[S8] ⇄ pheromone p=0.123 → S6@127.0.0.1:57007
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.4627 head_norm=1.530248
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.963834e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.4627 head_norm=1.461789 delta_norm=0.196383
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.257 → S8@127.0.0.1:57009
[S7] ⇄ pheromone p=0.144 → S15@127.0.0.1:57015
[S2] START round=31 head_norm_before_train=1.832594 cos_to_last_merge=0.9961 (last merge round=28)
[S2] round=31 local utility u=0.171010 metrics={'f1_val': 0.7079409396795266, 'auprc': 0.789766095700451, 'loss_val': 0.48030589763416787, 'psi': 0.7406710020878964}-{'f1_val': 0.6812143447374144, 'auprc': 0.7438514703486999, 'loss_val': 0.5242224610996968, 'psi': 0.7062691949819286}
[S3] START round=31 head_norm_before_train=1.743501 cos_to_last_merge=0.8790 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.879
[S3] round=31 local utility u=0.347249 metrics={'f1_val': 0.9849270262241732, 'auprc': 0.9986239291643966, 'loss_val': 0.04893770529379901, 'psi': 0.9904057874002625}-{'f1_val': 0.9234008616971144, 'auprc': 0.9477066268898755, 'loss_val': 0.22152702629405271, 'psi': 0.9331231677742189}
[S4] START round=31 head_norm_before_train=1.788814 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.106355 metrics={'f1_val': 0.9398691700419061, 'auprc': 0.9686976216506193, 'loss_val': 0.1917354065040162, 'psi': 0.9514005506853913}-{'f1_val': 0.9293439936032105, 'auprc': 0.9434066072808224, 'loss_val': 0.26542145231187575, 'psi': 0.9349690390742553}
[S5] START round=31 head_norm_before_train=1.710666 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7981264653746339, 'auprc': 0.9839873272130328, 'loss_val': 0.21659020280655228, 'psi': 0.8724708101099935}-{'f1_val': 0.9964092673554392, 'auprc': 0.9981104614907828, 'loss_val': 0.09623895092667123, 'psi': 0.9970897450095766}
[S6] START round=31 head_norm_before_train=1.461789 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9398159445051995, 'auprc': 0.9751507236681681, 'loss_val': 0.23882579058886177, 'psi': 0.953949856170387}-{'f1_val': 0.46269512146280467, 'auprc': 0.7782152659345544, 'loss_val': 0.9799481093764925, 'psi': 0.5889031792515045}
[S7] START round=31 head_norm_before_train=1.782278 cos_to_last_merge=0.9690 (last merge round=13)
[S7] round=31 local utility u=0.339568 metrics={'f1_val': 0.6200554038025771, 'auprc': 0.7861574089770349, 'loss_val': 0.7933274816178832, 'psi': 0.6864962058723603}-{'f1_val': 0.5634864254858175, 'auprc': 0.7662415492767186, 'loss_val': 1.0733016475673292, 'psi': 0.644588475002178}
[S8] START round=31 head_norm_before_train=1.417437 cos_to_last_merge=0.9994 (last merge round=28)
[S8] round=31 local utility u=0.005265 metrics={'f1_val': 0.9932441256377541, 'auprc': 0.9864481223530617, 'loss_val': 0.13136555371151754, 'psi': 0.9905257243238772}-{'f1_val': 0.9932513355536252, 'auprc': 0.987626310398303, 'loss_val': 0.14547379060922203, 'psi': 0.9910013254914963}
[S9] START round=31 head_norm_before_train=1.710364 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.009169 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9983732945422921, 'loss_val': 0.033316723443906404, 'psi': 0.997434698263545}-{'f1_val': 0.996808967411047, 'auprc': 0.9960601757629016, 'loss_val': 0.04471592257191774, 'psi': 0.9965094507517889}
[S10] START round=31 head_norm_before_train=1.888876 cos_to_last_merge=0.9953 (last merge round=24)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9926776894077446, 'loss_val': 0.03870485398974027, 'psi': 0.9937660747341126}-{'f1_val': 0.993924439075923, 'auprc': 0.9970427082820505, 'loss_val': 0.0413212387328841, 'psi': 0.995171746758374}
[S11] START round=31 head_norm_before_train=1.769687 cos_to_last_merge=0.8305 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=31 local utility u=0.000269 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9977413389548953, 'loss_val': 0.027539241787008922, 'psi': 0.9969043907320655}-{'f1_val': 0.9963256330217796, 'auprc': 0.9975685848091629, 'loss_val': 0.02743503994235846, 'psi': 0.996822813736733}
[S13] START round=31 head_norm_before_train=1.703931 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6006702310102822, 'auprc': 0.6880071914385443, 'loss_val': 0.8655833800171918, 'psi': 0.635605015181587}-{'f1_val': 0.6035844293630157, 'auprc': 0.6845827574740202, 'loss_val': 0.8235720767517961, 'psi': 0.6359837606074175}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.855305 cos_to_last_merge=0.9885 (last merge round=20)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9835705277886515, 'auprc': 0.9971773838924959, 'loss_val': 0.06402541060279013, 'psi': 0.9890132702301893}-{'f1_val': 0.997284015000207, 'auprc': 0.9986145489859012, 'loss_val': 0.025125128887304272, 'psi': 0.9978162285944847}
[S15] START round=31 head_norm_before_train=1.452491 cos_to_last_merge=0.9130 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7762555737440635, 'auprc': 0.9231931140393059, 'loss_val': 0.33527774672028, 'psi': 0.8350305898621605}-{'f1_val': 0.9584874716008919, 'auprc': 0.9904534109367019, 'loss_val': 0.10290751840067207, 'psi': 0.9712738473352158}
[S16] START round=31 head_norm_before_train=1.982071 (no previous merge yet)
[S16] round=31 local utility u=0.792841 metrics={'f1_val': 0.993243426087512, 'auprc': 0.9948817750039373, 'loss_val': 0.03646050152231557, 'psi': 0.9938987656540822}-{'f1_val': 0.8513231347877503, 'auprc': 0.9951077540744706, 'loss_val': 0.7712991204944362, 'psi': 0.9088369825024385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=31 head_norm_before_train=1.562115 cos_to_last_merge=0.8089 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=31 local utility u=0.718910 metrics={'f1_val': 0.725624586635159, 'auprc': 0.9821691524185657, 'loss_val': 0.3955798747905673, 'psi': 0.8282424129485217}-{'f1_val': 0.6464003896548584, 'auprc': 0.8444752178679272, 'loss_val': 0.9449730538125087, 'psi': 0.7256303209400858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S8]  timeout peer S17
[S6]  timeout peer S16
[S15]  timeout peer S3
[S15]  timeout peer S13
[S3]  timeout peer S8
[S7]  timeout peer S10
[S10]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:57004
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9968
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=-0.0554
[S7] DROPPED delta from S11 (cos=-0.0554 < 0.0)
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.9968
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9895
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.8966
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9895
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.0994
[S15] DROPPED delta from S7 (cos=-0.0994 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.7079 head_norm=1.854756
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.719538e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.7089 head_norm=1.827249 delta_norm=0.077195
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9968 head_norm=1.745354
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.975097e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9968 head_norm=1.702245 delta_norm=0.397510
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9398 head_norm=1.473258
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.066491e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9376 head_norm=1.453742 delta_norm=0.106649
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.827249 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6242922311539956, 'auprc': 0.7193687112335565, 'loss_val': 0.6655566453973171, 'psi': 0.66232282318582}-{'f1_val': 0.7079409396795266, 'auprc': 0.789766095700451, 'loss_val': 0.48030589763416787, 'psi': 0.7406710020878964}
[S3] START round=32 head_norm_before_train=1.750727 cos_to_last_merge=0.8774 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.877
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9579570255998775, 'auprc': 0.9985878899270723, 'loss_val': 0.09407884004629737, 'psi': 0.9742093713307554}-{'f1_val': 0.9849270262241732, 'auprc': 0.9986239291643966, 'loss_val': 0.04893770529379901, 'psi': 0.9904057874002625}
[S4] START round=32 head_norm_before_train=1.802630 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9458488698362144, 'auprc': 0.9679573333963891, 'loss_val': 0.2681805627079418, 'psi': 0.9546922552602843}-{'f1_val': 0.9398691700419061, 'auprc': 0.9686976216506193, 'loss_val': 0.1917354065040162, 'psi': 0.9514005506853913}
[S5] START round=32 head_norm_before_train=1.714488 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6723496680446956, 'auprc': 0.9431143498355308, 'loss_val': 0.35655501325329075, 'psi': 0.7806555407610297}-{'f1_val': 0.7981264653746339, 'auprc': 0.9839873272130328, 'loss_val': 0.21659020280655228, 'psi': 0.8724708101099935}
[S6] START round=32 head_norm_before_train=1.453742 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7640298115209778, 'auprc': 0.8146237177729097, 'loss_val': 0.40893370529705947, 'psi': 0.7842673740217505}-{'f1_val': 0.9398159445051995, 'auprc': 0.9751507236681681, 'loss_val': 0.23882579058886177, 'psi': 0.953949856170387}
[S7] START round=32 head_norm_before_train=1.789801 cos_to_last_merge=0.9682 (last merge round=13)
[S7] round=32 local utility u=0.325222 metrics={'f1_val': 0.6594135233201359, 'auprc': 0.8131324236419248, 'loss_val': 0.45995635689320574, 'psi': 0.7209010834488515}-{'f1_val': 0.6200554038025771, 'auprc': 0.7861574089770349, 'loss_val': 0.7933274816178832, 'psi': 0.6864962058723603}
[S8] START round=32 head_norm_before_train=1.441871 cos_to_last_merge=0.9985 (last merge round=28)
[S8] round=32 local utility u=0.004009 metrics={'f1_val': 0.992147567760106, 'auprc': 0.9858477978704034, 'loss_val': 0.11496790368471953, 'psi': 0.9896276598042251}-{'f1_val': 0.9932441256377541, 'auprc': 0.9864481223530617, 'loss_val': 0.13136555371151754, 'psi': 0.9905257243238772}
[S9] START round=32 head_norm_before_train=1.702245 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9926423765407113, 'auprc': 0.9974319833306141, 'loss_val': 0.06012691713959096, 'psi': 0.9945582192566724}-{'f1_val': 0.996808967411047, 'auprc': 0.9983732945422921, 'loss_val': 0.033316723443906404, 'psi': 0.997434698263545}
[S10] START round=32 head_norm_before_train=1.905897 cos_to_last_merge=0.9946 (last merge round=24)
[S10] round=32 local utility u=0.005199 metrics={'f1_val': 0.9941434254657042, 'auprc': 0.9966580500335368, 'loss_val': 0.038158994405096534, 'psi': 0.9951492752928373}-{'f1_val': 0.9944916649516913, 'auprc': 0.9926776894077446, 'loss_val': 0.03870485398974027, 'psi': 0.9937660747341126}
[S11] START round=32 head_norm_before_train=1.776695 cos_to_last_merge=0.8286 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9965727087371187, 'loss_val': 0.026409149661693113, 'psi': 0.9964369386449549}-{'f1_val': 0.9963464252501789, 'auprc': 0.9977413389548953, 'loss_val': 0.027539241787008922, 'psi': 0.9969043907320655}
[S13] START round=32 head_norm_before_train=1.712345 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5608588746872493, 'auprc': 0.684667210778453, 'loss_val': 1.176383884213928, 'psi': 0.6103822091237308}-{'f1_val': 0.6006702310102822, 'auprc': 0.6880071914385443, 'loss_val': 0.8655833800171918, 'psi': 0.635605015181587}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.868007 cos_to_last_merge=0.9878 (last merge round=20)
[S14] round=32 local utility u=0.046271 metrics={'f1_val': 0.9937957971593424, 'auprc': 0.9979369581335592, 'loss_val': 0.03511429028167901, 'psi': 0.9954522615490291}-{'f1_val': 0.9835705277886515, 'auprc': 0.9971773838924959, 'loss_val': 0.06402541060279013, 'psi': 0.9890132702301893}
[S15] START round=32 head_norm_before_train=1.462721 cos_to_last_merge=0.9116 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=32 local utility u=0.810486 metrics={'f1_val': 0.9773166901998679, 'auprc': 0.9876913731375891, 'loss_val': 0.11416726460106742, 'psi': 0.9814665633749564}-{'f1_val': 0.7762555737440635, 'auprc': 0.9231931140393059, 'loss_val': 0.33527774672028, 'psi': 0.8350305898621605}
[S16] START round=32 head_norm_before_train=1.993945 (no previous merge yet)
[S16] round=32 local utility u=0.000203 metrics={'f1_val': 0.993243426087512, 'auprc': 0.99471336980022, 'loss_val': 0.03554920382319841, 'psi': 0.9938314035725953}-{'f1_val': 0.993243426087512, 'auprc': 0.9948817750039373, 'loss_val': 0.03646050152231557, 'psi': 0.9938987656540822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=32 head_norm_before_train=1.576917 cos_to_last_merge=0.8075 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6817638557117827, 'auprc': 0.8562691381760383, 'loss_val': 0.7935460470359175, 'psi': 0.7515659686974849}-{'f1_val': 0.725624586635159, 'auprc': 0.9821691524185657, 'loss_val': 0.3955798747905673, 'psi': 0.8282424129485217}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:57007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.6723 head_norm=1.729251
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.176187e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.6723 head_norm=1.737185 delta_norm=0.021762
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9458 head_norm=1.816281
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.743352e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9459 head_norm=1.833985 delta_norm=0.077434
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S14
[S6] cosine check vs S14: cos=0.8821
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.1003
[S7] DROPPED delta from S15 (cos=-0.1003 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S10
[S2] cosine check vs S10: cos=-0.0396
[S2] DROPPED delta from S10 (cos=-0.0396 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] cosine check vs S8: cos=0.9959
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9921 head_norm=1.469320
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.150476e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9929 head_norm=1.466785 delta_norm=0.115048
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] cosine check vs S7: cos=-0.1003
[S15] DROPPED delta from S7 (cos=-0.1003 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7640 head_norm=1.468350
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.980321e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8096 head_norm=1.526665 delta_norm=0.198032
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.845238 cos_to_last_merge=0.9997 (last merge round=31)
[S2] round=33 local utility u=0.409637 metrics={'f1_val': 0.7175707804649335, 'auprc': 0.7710534825371433, 'loss_val': 0.5610082856052353, 'psi': 0.7389638612938174}-{'f1_val': 0.6242922311539956, 'auprc': 0.7193687112335565, 'loss_val': 0.6655566453973171, 'psi': 0.66232282318582}
[S3] START round=33 head_norm_before_train=1.762096 cos_to_last_merge=0.8756 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.876
[S3] round=33 local utility u=0.110026 metrics={'f1_val': 0.9885867478933518, 'auprc': 0.9978122230451056, 'loss_val': 0.055478031262349625, 'psi': 0.9922769379540533}-{'f1_val': 0.9579570255998775, 'auprc': 0.9985878899270723, 'loss_val': 0.09407884004629737, 'psi': 0.9742093713307554}
[S4] START round=33 head_norm_before_train=1.833985 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9413445690188469, 'auprc': 0.9642776743018486, 'loss_val': 0.2526680920325032, 'psi': 0.9505178111320476}-{'f1_val': 0.9458488698362144, 'auprc': 0.9679573333963891, 'loss_val': 0.2681805627079418, 'psi': 0.9546922552602843}
[S5] START round=33 head_norm_before_train=1.737185 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9783115214561502, 'auprc': 0.9966733398867583, 'loss_val': 0.1486980795138073, 'psi': 0.9856562488283934}-{'f1_val': 0.6723496680446956, 'auprc': 0.9431143498355308, 'loss_val': 0.35655501325329075, 'psi': 0.7806555407610297}
[S6] START round=33 head_norm_before_train=1.526665 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.761403 metrics={'f1_val': 0.9171535211575648, 'auprc': 0.9677373353843051, 'loss_val': 0.26421033931631044, 'psi': 0.9373870468482608}-{'f1_val': 0.7640298115209778, 'auprc': 0.8146237177729097, 'loss_val': 0.40893370529705947, 'psi': 0.7842673740217505}
[S7] START round=33 head_norm_before_train=1.798563 cos_to_last_merge=0.9670 (last merge round=13)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6546050431921785, 'auprc': 0.808225199794907, 'loss_val': 0.5168643238338534, 'psi': 0.71605310583327}-{'f1_val': 0.6594135233201359, 'auprc': 0.8131324236419248, 'loss_val': 0.45995635689320574, 'psi': 0.7209010834488515}
[S8] START round=33 head_norm_before_train=1.466785 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.002153 metrics={'f1_val': 0.9932441256377541, 'auprc': 0.9856202525049028, 'loss_val': 0.11655774179553176, 'psi': 0.9901945763846136}-{'f1_val': 0.992147567760106, 'auprc': 0.9858477978704034, 'loss_val': 0.11496790368471953, 'psi': 0.9896276598042251}
[S9] START round=33 head_norm_before_train=1.735527 cos_to_last_merge=0.9996 (last merge round=31)
[S9] round=33 local utility u=0.021034 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9972476974701963, 'loss_val': 0.04250623028960657, 'psi': 0.9969844594347067}-{'f1_val': 0.9926423765407113, 'auprc': 0.9974319833306141, 'loss_val': 0.06012691713959096, 'psi': 0.9945582192566724}
[S10] START round=33 head_norm_before_train=1.921433 cos_to_last_merge=0.9937 (last merge round=24)
[S10] round=33 local utility u=0.000877 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9934215424914812, 'loss_val': 0.03377300729440893, 'psi': 0.9945624893348306}-{'f1_val': 0.9941434254657042, 'auprc': 0.9966580500335368, 'loss_val': 0.038158994405096534, 'psi': 0.9951492752928373}
[S11] START round=33 head_norm_before_train=1.785131 cos_to_last_merge=0.8268 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=33 local utility u=0.002209 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9980482219632658, 'loss_val': 0.02629201992954868, 'psi': 0.9970146685983741}-{'f1_val': 0.9963464252501789, 'auprc': 0.9965727087371187, 'loss_val': 0.026409149661693113, 'psi': 0.9964369386449549}
[S13] START round=33 head_norm_before_train=1.718920 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5438669529116328, 'auprc': 0.7040475130486578, 'loss_val': 1.1507849206014056, 'psi': 0.6079391769664427}-{'f1_val': 0.5608588746872493, 'auprc': 0.684667210778453, 'loss_val': 1.176383884213928, 'psi': 0.6103822091237308}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.879286 cos_to_last_merge=0.9870 (last merge round=20)
[S14] round=33 local utility u=0.015309 metrics={'f1_val': 0.9973392248361934, 'auprc': 0.9986064318122139, 'loss_val': 0.02776523943416127, 'psi': 0.9978461076266016}-{'f1_val': 0.9937957971593424, 'auprc': 0.9979369581335592, 'loss_val': 0.03511429028167901, 'psi': 0.9954522615490291}
[S15] START round=33 head_norm_before_train=1.474165 cos_to_last_merge=0.9101 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=33 local utility u=0.053905 metrics={'f1_val': 0.9850115022287539, 'auprc': 0.9950532411523145, 'loss_val': 0.07461154411582639, 'psi': 0.9890281977981781}-{'f1_val': 0.9773166901998679, 'auprc': 0.9876913731375891, 'loss_val': 0.11416726460106742, 'psi': 0.9814665633749564}
[S16] START round=33 head_norm_before_train=2.006027 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9729280961895429, 'auprc': 0.9956481602688414, 'loss_val': 0.08600604619268078, 'psi': 0.9820161218212624}-{'f1_val': 0.993243426087512, 'auprc': 0.99471336980022, 'loss_val': 0.03554920382319841, 'psi': 0.9938314035725953}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.587525 cos_to_last_merge=0.8063 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6636587765897737, 'auprc': 0.8479524054146139, 'loss_val': 0.9948514315823134, 'psi': 0.7373762281197098}-{'f1_val': 0.6817638557117827, 'auprc': 0.8562691381760383, 'loss_val': 0.7935460470359175, 'psi': 0.7515659686974849}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:57005
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S11
[S7] cosine check vs S11: cos=-0.0586
[S7] DROPPED delta from S11 (cos=-0.0586 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=0.9341
[S2] RECEIVED delta(kind=head bytes=1795) from S10
[S2] cosine check vs S10: cos=-0.0404
[S2] DROPPED delta from S10 (cos=-0.0404 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9790
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=-0.1014
[S7] DROPPED delta from S15 (cos=-0.1014 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9895
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.9636
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9790
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9895
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.9989
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.9172 head_norm=1.542362
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.233952e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.9174 head_norm=1.586516 delta_norm=0.123395
[S6] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9968 head_norm=1.770507
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.348964e-02
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9968 head_norm=1.743684 delta_norm=0.053490
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.859541 cos_to_last_merge=0.9990 (last merge round=31)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7104343772608599, 'auprc': 0.7541259099306611, 'loss_val': 0.5659321004320598, 'psi': 0.7279109903287804}-{'f1_val': 0.7175707804649335, 'auprc': 0.7710534825371433, 'loss_val': 0.5610082856052353, 'psi': 0.7389638612938174}
[S3] START round=34 head_norm_before_train=1.774799 cos_to_last_merge=0.8738 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.874
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9612440485292413, 'auprc': 0.998039617380654, 'loss_val': 0.08786939487179714, 'psi': 0.9759622760698063}-{'f1_val': 0.9885867478933518, 'auprc': 0.9978122230451056, 'loss_val': 0.055478031262349625, 'psi': 0.9922769379540533}
[S4] START round=34 head_norm_before_train=1.846233 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9326443941055722, 'auprc': 0.9363674547635075, 'loss_val': 0.3435313364214491, 'psi': 0.9341336183687463}-{'f1_val': 0.9413445690188469, 'auprc': 0.9642776743018486, 'loss_val': 0.2526680920325032, 'psi': 0.9505178111320476}
[S5] START round=34 head_norm_before_train=1.757915 cos_to_last_merge=0.9999 (last merge round=32)
[S5] round=34 local utility u=0.012612 metrics={'f1_val': 0.9764346949100254, 'auprc': 0.9971837413772742, 'loss_val': 0.11374385859163698, 'psi': 0.9847343134969249}-{'f1_val': 0.9783115214561502, 'auprc': 0.9966733398867583, 'loss_val': 0.1486980795138073, 'psi': 0.9856562488283934}
[S6] START round=34 head_norm_before_train=1.586516 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7597963602640403, 'auprc': 0.8828421754129193, 'loss_val': 0.4740888781490737, 'psi': 0.8090146863235919}-{'f1_val': 0.9171535211575648, 'auprc': 0.9677373353843051, 'loss_val': 0.26421033931631044, 'psi': 0.9373870468482608}
[S7] START round=34 head_norm_before_train=1.807922 cos_to_last_merge=0.9658 (last merge round=13)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6188780885674028, 'auprc': 0.8012063925112838, 'loss_val': 0.6188753380083906, 'psi': 0.6918094101449552}-{'f1_val': 0.6546050431921785, 'auprc': 0.808225199794907, 'loss_val': 0.5168643238338534, 'psi': 0.71605310583327}
[S8] START round=34 head_norm_before_train=1.493146 cos_to_last_merge=0.9998 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.9844401475552275, 'loss_val': 0.12788620654671645, 'psi': 0.9892928360351471}-{'f1_val': 0.9932441256377541, 'auprc': 0.9856202525049028, 'loss_val': 0.11655774179553176, 'psi': 0.9901945763846136}
[S9] START round=34 head_norm_before_train=1.743684 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9901193303318852, 'auprc': 0.9975611585851478, 'loss_val': 0.05296039181297331, 'psi': 0.9930960616331902}-{'f1_val': 0.996808967411047, 'auprc': 0.9972476974701963, 'loss_val': 0.04250623028960657, 'psi': 0.9969844594347067}
[S10] START round=34 head_norm_before_train=1.932772 cos_to_last_merge=0.9930 (last merge round=24)
[S10] round=34 local utility u=0.004433 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9965560479838502, 'loss_val': 0.03289342541426006, 'psi': 0.9956745163079981}-{'f1_val': 0.9953231205637304, 'auprc': 0.9934215424914812, 'loss_val': 0.03377300729440893, 'psi': 0.9945624893348306}
[S11] START round=34 head_norm_before_train=1.796434 cos_to_last_merge=0.8255 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.996445216967593, 'loss_val': 0.026149316429321137, 'psi': 0.996373466600105}-{'f1_val': 0.9963256330217796, 'auprc': 0.9980482219632658, 'loss_val': 0.02629201992954868, 'psi': 0.9970146685983741}
[S13] START round=34 head_norm_before_train=1.722488 (no previous merge yet)
[S13] round=34 local utility u=0.291744 metrics={'f1_val': 0.6043588454230759, 'auprc': 0.671169757216311, 'loss_val': 0.8316147022180327, 'psi': 0.6310832101403699}-{'f1_val': 0.5438669529116328, 'auprc': 0.7040475130486578, 'loss_val': 1.1507849206014056, 'psi': 0.6079391769664427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=34 head_norm_before_train=1.891204 cos_to_last_merge=0.9865 (last merge round=20)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9967503466647865, 'auprc': 0.9986017914169555, 'loss_val': 0.029348947700701854, 'psi': 0.997490924565654}-{'f1_val': 0.9973392248361934, 'auprc': 0.9986064318122139, 'loss_val': 0.02776523943416127, 'psi': 0.9978461076266016}
[S15] START round=34 head_norm_before_train=1.487083 cos_to_last_merge=0.9086 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8876201943936552, 'auprc': 0.9914704336787159, 'loss_val': 0.20815722605761308, 'psi': 0.9291602901076794}-{'f1_val': 0.9850115022287539, 'auprc': 0.9950532411523145, 'loss_val': 0.07461154411582639, 'psi': 0.9890281977981781}
[S16] START round=34 head_norm_before_train=2.017192 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9264571429788319, 'auprc': 0.9934020025869199, 'loss_val': 0.3643756747316836, 'psi': 0.9532350868220671}-{'f1_val': 0.9729280961895429, 'auprc': 0.9956481602688414, 'loss_val': 0.08600604619268078, 'psi': 0.9820161218212624}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.597648 cos_to_last_merge=0.8052 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6575314719652109, 'auprc': 0.7870251828392596, 'loss_val': 1.2404024561056906, 'psi': 0.7093289563148304}-{'f1_val': 0.6636587765897737, 'auprc': 0.8479524054146139, 'loss_val': 0.9948514315823134, 'psi': 0.7373762281197098}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9925 head_norm=1.514089
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.184016e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9903 head_norm=1.523697 delta_norm=0.118402
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9326 head_norm=1.851020
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.746597e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9326 head_norm=1.854678 delta_norm=0.047466
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9776
[S2] RECEIVED delta(kind=head bytes=1796) from S10
[S2] cosine check vs S10: cos=-0.0410
[S2] DROPPED delta from S10 (cos=-0.0410 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9764 head_norm=1.778245
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.887659e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9864 head_norm=1.764311 delta_norm=0.188766
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9901 head_norm=1.778448
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.881861e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9901 head_norm=1.768362 delta_norm=0.188186
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.873824 cos_to_last_merge=0.9982 (last merge round=31)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7138161328187379, 'auprc': 0.7431983381999852, 'loss_val': 0.5963704165110534, 'psi': 0.7255690149712368}-{'f1_val': 0.7104343772608599, 'auprc': 0.7541259099306611, 'loss_val': 0.5659321004320598, 'psi': 0.7279109903287804}
[S3] START round=35 head_norm_before_train=1.789352 cos_to_last_merge=0.8719 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.872
[S3] round=35 local utility u=0.052844 metrics={'f1_val': 0.9780438072062936, 'auprc': 0.9980090171788498, 'loss_val': 0.08288778996571858, 'psi': 0.986029891195316}-{'f1_val': 0.9612440485292413, 'auprc': 0.998039617380654, 'loss_val': 0.08786939487179714, 'psi': 0.9759622760698063}
[S4] START round=35 head_norm_before_train=1.854678 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9321829010626103, 'auprc': 0.927774866690524, 'loss_val': 0.3197357755073415, 'psi': 0.9304196873137758}-{'f1_val': 0.9326443941055722, 'auprc': 0.9363674547635075, 'loss_val': 0.3435313364214491, 'psi': 0.9341336183687463}
[S5] START round=35 head_norm_before_train=1.764311 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6735788725438482, 'auprc': 0.8687625915332897, 'loss_val': 0.4898531091888209, 'psi': 0.7516523601396248}-{'f1_val': 0.9764346949100254, 'auprc': 0.9971837413772742, 'loss_val': 0.11374385859163698, 'psi': 0.9847343134969249}
[S6] START round=35 head_norm_before_train=1.603146 cos_to_last_merge=0.9998 (last merge round=33)
[S6] round=35 local utility u=0.376909 metrics={'f1_val': 0.8239411441499356, 'auprc': 0.965615707108929, 'loss_val': 0.35345944514783467, 'psi': 0.8806109693335329}-{'f1_val': 0.7597963602640403, 'auprc': 0.8828421754129193, 'loss_val': 0.4740888781490737, 'psi': 0.8090146863235919}
[S7] START round=35 head_norm_before_train=1.816675 cos_to_last_merge=0.9644 (last merge round=13)
[S7] round=35 local utility u=0.354723 metrics={'f1_val': 0.6789398149565843, 'auprc': 0.8387696163362783, 'loss_val': 0.38248991993735054, 'psi': 0.742871735508462}-{'f1_val': 0.6188780885674028, 'auprc': 0.8012063925112838, 'loss_val': 0.6188753380083906, 'psi': 0.6918094101449552}
[S8] START round=35 head_norm_before_train=1.523697 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9869511425758863, 'auprc': 0.9861398355500228, 'loss_val': 0.1251530162042017, 'psi': 0.9866266197655409}-{'f1_val': 0.9925279616884268, 'auprc': 0.9844401475552275, 'loss_val': 0.12788620654671645, 'psi': 0.9892928360351471}
[S9] START round=35 head_norm_before_train=1.768362 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9888378245618925, 'auprc': 0.9968022172865042, 'loss_val': 0.052124126193168564, 'psi': 0.9920235816517372}-{'f1_val': 0.9901193303318852, 'auprc': 0.9975611585851478, 'loss_val': 0.05296039181297331, 'psi': 0.9930960616331902}
[S10] START round=35 head_norm_before_train=1.945731 cos_to_last_merge=0.9922 (last merge round=24)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9926803799725984, 'loss_val': 0.03192900392703924, 'psi': 0.9942660243272776}-{'f1_val': 0.9950868285240967, 'auprc': 0.9965560479838502, 'loss_val': 0.03289342541426006, 'psi': 0.9956745163079981}
[S11] START round=35 head_norm_before_train=1.805156 cos_to_last_merge=0.8240 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.824
[S11] round=35 local utility u=0.000534 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9964636854505733, 'loss_val': 0.02513703920540327, 'psi': 0.996380853993297}-{'f1_val': 0.9963256330217796, 'auprc': 0.996445216967593, 'loss_val': 0.026149316429321137, 'psi': 0.996373466600105}
[S13] START round=35 head_norm_before_train=1.728733 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5451029368532805, 'auprc': 0.6951323592241136, 'loss_val': 1.086716084547248, 'psi': 0.6051147058016138}-{'f1_val': 0.6043588454230759, 'auprc': 0.671169757216311, 'loss_val': 0.8316147022180327, 'psi': 0.6310832101403699}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.902447 cos_to_last_merge=0.9860 (last merge round=20)
[S14] round=35 local utility u=0.003072 metrics={'f1_val': 0.9969167109240578, 'auprc': 0.9987945917749957, 'loss_val': 0.02478236176478188, 'psi': 0.9976678632644329}-{'f1_val': 0.9967503466647865, 'auprc': 0.9986017914169555, 'loss_val': 0.029348947700701854, 'psi': 0.997490924565654}
[S15] START round=35 head_norm_before_train=1.501319 cos_to_last_merge=0.9067 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8370323843262967, 'auprc': 0.9690209368069556, 'loss_val': 0.28076111624217187, 'psi': 0.8898278053185602}-{'f1_val': 0.8876201943936552, 'auprc': 0.9914704336787159, 'loss_val': 0.20815722605761308, 'psi': 0.9291602901076794}
[S16] START round=35 head_norm_before_train=2.023818 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8847730731382654, 'auprc': 0.9880704544728879, 'loss_val': 0.5610433426915782, 'psi': 0.9260920256721143}-{'f1_val': 0.9264571429788319, 'auprc': 0.9934020025869199, 'loss_val': 0.3643756747316836, 'psi': 0.9532350868220671}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.607744 cos_to_last_merge=0.8040 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=35 local utility u=0.004372 metrics={'f1_val': 0.6377598726227843, 'auprc': 0.8241176460848648, 'loss_val': 1.224307001147074, 'psi': 0.7123029820076165}-{'f1_val': 0.6575314719652109, 'auprc': 0.7870251828392596, 'loss_val': 1.2404024561056906, 'psi': 0.7093289563148304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] ⇄ pheromone p=0.041 → S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:57009
[S10] ⇄ pheromone p=0.006 → S2@127.0.0.1:57002
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] ⇄ pheromone p=0.302 → S9@127.0.0.1:57010
[S15] ⇄ pheromone p=0.222 → S7@127.0.0.1:57008
[S4] ⇄ pheromone p=0.049 → S2@127.0.0.1:57002
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=0.9566
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.9266
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=-0.0628
[S7] DROPPED delta from S11 (cos=-0.0628 < 0.0)
[S3] ⇄ pheromone p=0.072 → S9@127.0.0.1:57010
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.022 → S6@127.0.0.1:57007
[S11] ⇄ pheromone p=0.011 → S7@127.0.0.1:57008
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] cosine check vs S6: cos=0.9873
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1039
[S15] DROPPED delta from S7 (cos=-0.1039 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.9888 head_norm=1.798417
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.448783e-01
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.9897 head_norm=1.766883 delta_norm=0.344878
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.014 → S5@127.0.0.1:57005
[S2] ⇄ pheromone p=0.088 → S4@127.0.0.1:57004
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8239 head_norm=1.618222
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.979332e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8242 head_norm=1.746193 delta_norm=0.297933
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.339 → S8@127.0.0.1:57009
[S7] ⇄ pheromone p=0.179 → S15@127.0.0.1:57015
[S2] START round=36 head_norm_before_train=1.886363 cos_to_last_merge=0.9974 (last merge round=31)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.631559436265904, 'auprc': 0.7313416722645387, 'loss_val': 0.7641389087922849, 'psi': 0.6714723306653578}-{'f1_val': 0.7138161328187379, 'auprc': 0.7431983381999852, 'loss_val': 0.5963704165110534, 'psi': 0.7255690149712368}
[S3] START round=36 head_norm_before_train=1.802035 cos_to_last_merge=0.8703 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.870
[S3] round=36 local utility u=0.081780 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9975899517802991, 'loss_val': 0.03266779202998116, 'psi': 0.9973220628015625}-{'f1_val': 0.9780438072062936, 'auprc': 0.9980090171788498, 'loss_val': 0.08288778996571858, 'psi': 0.986029891195316}
[S4] START round=36 head_norm_before_train=1.860198 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9334571128582904, 'auprc': 0.9270001599993302, 'loss_val': 0.33230847266686275, 'psi': 0.9308743317147062}-{'f1_val': 0.9321829010626103, 'auprc': 0.927774866690524, 'loss_val': 0.3197357755073415, 'psi': 0.9304196873137758}
[S5] START round=36 head_norm_before_train=1.785561 cos_to_last_merge=0.9999 (last merge round=34)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976110951777398, 'loss_val': 0.0848007622442144, 'psi': 0.9970656191581706}-{'f1_val': 0.6735788725438482, 'auprc': 0.8687625915332897, 'loss_val': 0.4898531091888209, 'psi': 0.7516523601396248}
[S6] START round=36 head_norm_before_train=1.746193 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6493115509807177, 'auprc': 0.8054415939990143, 'loss_val': 0.5316524280870575, 'psi': 0.7117635681880363}-{'f1_val': 0.8239411441499356, 'auprc': 0.965615707108929, 'loss_val': 0.35345944514783467, 'psi': 0.8806109693335329}
[S7] START round=36 head_norm_before_train=1.831954 cos_to_last_merge=0.9624 (last merge round=13)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.977895139995133, 'auprc': 0.985254938953557, 'loss_val': 0.15221200414129374, 'psi': 0.9808390595785026}-{'f1_val': 0.6789398149565843, 'auprc': 0.8387696163362783, 'loss_val': 0.38248991993735054, 'psi': 0.742871735508462}
[S8] START round=36 head_norm_before_train=1.541434 cos_to_last_merge=0.9999 (last merge round=34)
[S8] round=36 local utility u=0.027412 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9848651541941263, 'loss_val': 0.1045274313788404, 'psi': 0.9899190576216176}-{'f1_val': 0.9869511425758863, 'auprc': 0.9861398355500228, 'loss_val': 0.1251530162042017, 'psi': 0.9866266197655409}
[S9] START round=36 head_norm_before_train=1.766883 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.023073 metrics={'f1_val': 0.996808967411047, 'auprc': 0.994361406334362, 'loss_val': 0.04648303381817934, 'psi': 0.995829942980373}-{'f1_val': 0.9888378245618925, 'auprc': 0.9968022172865042, 'loss_val': 0.052124126193168564, 'psi': 0.9920235816517372}
[S10] START round=36 head_norm_before_train=1.959996 cos_to_last_merge=0.9915 (last merge round=24)
[S10] round=36 local utility u=0.005811 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996122473759258, 'loss_val': 0.03063372866910248, 'psi': 0.9956428618419414}-{'f1_val': 0.9953231205637304, 'auprc': 0.9926803799725984, 'loss_val': 0.03192900392703924, 'psi': 0.9942660243272776}
[S11] START round=36 head_norm_before_train=1.814915 cos_to_last_merge=0.8231 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.823
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.996502663925108, 'loss_val': 0.02574055961512591, 'psi': 0.9963964453831109}-{'f1_val': 0.9963256330217796, 'auprc': 0.9964636854505733, 'loss_val': 0.02513703920540327, 'psi': 0.996380853993297}
[S13] START round=36 head_norm_before_train=1.734403 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5509533007068385, 'auprc': 0.6476507314432375, 'loss_val': 1.0854358785012013, 'psi': 0.5896322730013981}-{'f1_val': 0.5451029368532805, 'auprc': 0.6951323592241136, 'loss_val': 1.086716084547248, 'psi': 0.6051147058016138}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.912398 cos_to_last_merge=0.9855 (last merge round=20)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.999034381586497, 'loss_val': 0.031715926643653754, 'psi': 0.9967060998752456}-{'f1_val': 0.9969167109240578, 'auprc': 0.9987945917749957, 'loss_val': 0.02478236176478188, 'psi': 0.9976678632644329}
[S15] START round=36 head_norm_before_train=1.516199 cos_to_last_merge=0.9048 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7555311947318595, 'auprc': 0.9177343779403944, 'loss_val': 0.40378558351499994, 'psi': 0.8204124680152735}-{'f1_val': 0.8370323843262967, 'auprc': 0.9690209368069556, 'loss_val': 0.28076111624217187, 'psi': 0.8898278053185602}
[S16] START round=36 head_norm_before_train=2.030669 (no previous merge yet)
[S16] round=36 local utility u=0.226782 metrics={'f1_val': 0.9275000467041475, 'auprc': 0.9885852304920996, 'loss_val': 0.3653848721614559, 'psi': 0.9519341202193283}-{'f1_val': 0.8847730731382654, 'auprc': 0.9880704544728879, 'loss_val': 0.5610433426915782, 'psi': 0.9260920256721143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=36 head_norm_before_train=1.616404 cos_to_last_merge=0.8036 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=36 local utility u=0.939402 metrics={'f1_val': 0.7413021348815352, 'auprc': 0.9736328745251757, 'loss_val': 0.4153020504958863, 'psi': 0.8342344307389914}-{'f1_val': 0.6377598726227843, 'auprc': 0.8241176460848648, 'loss_val': 1.224307001147074, 'psi': 0.7123029820076165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:57002
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:57005
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.9781
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9486
[S2] RECEIVED delta(kind=head bytes=1795) from S10
[S2] cosine check vs S10: cos=-0.0423
[S2] DROPPED delta from S10 (cos=-0.0423 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.9833
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9933 head_norm=1.563390
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.376141e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9933 head_norm=1.585080 delta_norm=0.137614
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=-0.1045
[S15] DROPPED delta from S7 (cos=-0.1045 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9833
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.6493 head_norm=1.762370
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.841694e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.6495 head_norm=1.641437 delta_norm=0.284169
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9968 head_norm=1.794434
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.727120e-02
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9968 head_norm=1.783983 delta_norm=0.027271
[S9] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.897258 cos_to_last_merge=0.9967 (last merge round=31)
[S2] round=37 local utility u=0.258888 metrics={'f1_val': 0.7023354605763354, 'auprc': 0.731278297373555, 'loss_val': 0.6708293264783597, 'psi': 0.7139125952952232}-{'f1_val': 0.631559436265904, 'auprc': 0.7313416722645387, 'loss_val': 0.7641389087922849, 'psi': 0.6714723306653578}
[S3] START round=37 head_norm_before_train=1.813044 cos_to_last_merge=0.8689 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.869
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9292698899342323, 'auprc': 0.9906331730697129, 'loss_val': 0.1972016466693412, 'psi': 0.9538152031884245}-{'f1_val': 0.9971434701490716, 'auprc': 0.9975899517802991, 'loss_val': 0.03266779202998116, 'psi': 0.9973220628015625}
[S4] START round=37 head_norm_before_train=1.865603 cos_to_last_merge=0.9997 (last merge round=34)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9319346312067845, 'auprc': 0.9260116406664001, 'loss_val': 0.3454648444945267, 'psi': 0.9295654349906307}-{'f1_val': 0.9334571128582904, 'auprc': 0.9270001599993302, 'loss_val': 0.33230847266686275, 'psi': 0.9308743317147062}
[S5] START round=37 head_norm_before_train=1.803001 cos_to_last_merge=0.9995 (last merge round=34)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9409326267372449, 'auprc': 0.9939854993266224, 'loss_val': 0.11780999826192105, 'psi': 0.9621537757729959}-{'f1_val': 0.9967019684784577, 'auprc': 0.9976110951777398, 'loss_val': 0.0848007622442144, 'psi': 0.9970656191581706}
[S6] START round=37 head_norm_before_train=1.641437 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.599679 metrics={'f1_val': 0.816356104699203, 'auprc': 0.8227784097050425, 'loss_val': 0.3865729180701527, 'psi': 0.8189250267015388}-{'f1_val': 0.6493115509807177, 'auprc': 0.8054415939990143, 'loss_val': 0.5316524280870575, 'psi': 0.7117635681880363}
[S7] START round=37 head_norm_before_train=1.841485 cos_to_last_merge=0.9613 (last merge round=13)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.553807355423331, 'auprc': 0.7910118631364452, 'loss_val': 0.9096616544521051, 'psi': 0.6486891585085768}-{'f1_val': 0.977895139995133, 'auprc': 0.985254938953557, 'loss_val': 0.15221200414129374, 'psi': 0.9808390595785026}
[S8] START round=37 head_norm_before_train=1.585080 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9922921445692389, 'auprc': 0.9846783914565166, 'loss_val': 0.10756866550734957, 'psi': 0.9892466433241499}-{'f1_val': 0.9932883265732785, 'auprc': 0.9848651541941263, 'loss_val': 0.1045274313788404, 'psi': 0.9899190576216176}
[S9] START round=37 head_norm_before_train=1.783983 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.003378 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.99751274098022, 'loss_val': 0.04172725102838881, 'psi': 0.9963450622172538}-{'f1_val': 0.996808967411047, 'auprc': 0.994361406334362, 'loss_val': 0.04648303381817934, 'psi': 0.995829942980373}
[S10] START round=37 head_norm_before_train=1.974567 cos_to_last_merge=0.9908 (last merge round=24)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9938956113011587, 'loss_val': 0.030200322658612062, 'psi': 0.9947521168587017}-{'f1_val': 0.9953231205637304, 'auprc': 0.996122473759258, 'loss_val': 0.03063372866910248, 'psi': 0.9956428618419414}
[S11] START round=37 head_norm_before_train=1.822393 cos_to_last_merge=0.8221 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.822
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9949019236335007, 'auprc': 0.9965328522828796, 'loss_val': 0.03598260230743278, 'psi': 0.9955542950932523}-{'f1_val': 0.9963256330217796, 'auprc': 0.996502663925108, 'loss_val': 0.02574055961512591, 'psi': 0.9963964453831109}
[S13] START round=37 head_norm_before_train=1.741776 (no previous merge yet)
[S13] round=37 local utility u=0.518907 metrics={'f1_val': 0.653851252740514, 'auprc': 0.7423767237532702, 'loss_val': 0.949188125251089, 'psi': 0.6892614411456165}-{'f1_val': 0.5509533007068385, 'auprc': 0.6476507314432375, 'loss_val': 1.0854358785012013, 'psi': 0.5896322730013981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=37 head_norm_before_train=1.919474 cos_to_last_merge=0.9854 (last merge round=20)
[S14] round=37 local utility u=0.000404 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.9989980986139763, 'loss_val': 0.030799830803856478, 'psi': 0.9966915866862373}-{'f1_val': 0.9951539120677446, 'auprc': 0.999034381586497, 'loss_val': 0.031715926643653754, 'psi': 0.9967060998752456}
[S15] START round=37 head_norm_before_train=1.532795 cos_to_last_merge=0.9028 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9911136017931337, 'loss_val': 0.04652162765314687, 'psi': 0.9939109183268885}-{'f1_val': 0.7555311947318595, 'auprc': 0.9177343779403944, 'loss_val': 0.40378558351499994, 'psi': 0.8204124680152735}
[S16] START round=37 head_norm_before_train=2.039131 (no previous merge yet)
[S16] round=37 local utility u=0.017576 metrics={'f1_val': 0.9308319279432073, 'auprc': 0.9879587222701989, 'loss_val': 0.34834500233790294, 'psi': 0.953682645674004}-{'f1_val': 0.9275000467041475, 'auprc': 0.9885852304920996, 'loss_val': 0.3653848721614559, 'psi': 0.9519341202193283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=37 head_norm_before_train=1.625358 cos_to_last_merge=0.8033 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.7142748935805612, 'auprc': 0.8945466614345826, 'loss_val': 0.7652439625443737, 'psi': 0.7863836007221697}-{'f1_val': 0.7413021348815352, 'auprc': 0.9736328745251757, 'loss_val': 0.4153020504958863, 'psi': 0.8342344307389914}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.9409 head_norm=1.822214
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.727722e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.9563 head_norm=1.800105 delta_norm=0.172772
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=-0.1051
[S7] DROPPED delta from S15 (cos=-0.1051 < 0.0)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9964
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9968
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9952
[S2] START round=38 head_norm_before_train=1.908972 cos_to_last_merge=0.9959 (last merge round=31)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6254542588921242, 'auprc': 0.7270124757967574, 'loss_val': 1.013858384788742, 'psi': 0.6660775456539776}-{'f1_val': 0.7023354605763354, 'auprc': 0.731278297373555, 'loss_val': 0.6708293264783597, 'psi': 0.7139125952952232}
[S3] START round=38 head_norm_before_train=1.823630 cos_to_last_merge=0.8677 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.868
[S3] round=38 local utility u=0.297157 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9971111522479251, 'loss_val': 0.02956324428952553, 'psi': 0.997130542988613}-{'f1_val': 0.9292698899342323, 'auprc': 0.9906331730697129, 'loss_val': 0.1972016466693412, 'psi': 0.9538152031884245}
[S4] START round=38 head_norm_before_train=1.877278 cos_to_last_merge=0.9995 (last merge round=34)
[S4] round=38 local utility u=0.019197 metrics={'f1_val': 0.9330340505924173, 'auprc': 0.93731945760863, 'loss_val': 0.3475901853902557, 'psi': 0.9347482133989025}-{'f1_val': 0.9319346312067845, 'auprc': 0.9260116406664001, 'loss_val': 0.3454648444945267, 'psi': 0.9295654349906307}
[S5] START round=38 head_norm_before_train=1.800105 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.187777 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.997893398120135, 'loss_val': 0.08859525790923964, 'psi': 0.9971785403351285}-{'f1_val': 0.9409326267372449, 'auprc': 0.9939854993266224, 'loss_val': 0.11780999826192105, 'psi': 0.9621537757729959}
[S6] START round=38 head_norm_before_train=1.652713 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.768568558305384, 'auprc': 0.8964213999503404, 'loss_val': 0.5110460657454743, 'psi': 0.8197096949633665}-{'f1_val': 0.816356104699203, 'auprc': 0.8227784097050425, 'loss_val': 0.3865729180701527, 'psi': 0.8189250267015388}
[S7] START round=38 head_norm_before_train=1.844487 cos_to_last_merge=0.9606 (last merge round=13)
[S7] round=38 local utility u=0.369851 metrics={'f1_val': 0.6215087230619079, 'auprc': 0.7959218472119541, 'loss_val': 0.5908972217355077, 'psi': 0.6912739727219264}-{'f1_val': 0.553807355423331, 'auprc': 0.7910118631364452, 'loss_val': 0.9096616544521051, 'psi': 0.6486891585085768}
[S8] START round=38 head_norm_before_train=1.608416 cos_to_last_merge=0.9998 (last merge round=36)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9862409241768243, 'auprc': 0.986126282888715, 'loss_val': 0.09553765141175462, 'psi': 0.9861950676615805}-{'f1_val': 0.9922921445692389, 'auprc': 0.9846783914565166, 'loss_val': 0.10756866550734957, 'psi': 0.9892466433241499}
[S9] START round=38 head_norm_before_train=1.818560 cos_to_last_merge=0.9996 (last merge round=36)
[S9] round=38 local utility u=0.003904 metrics={'f1_val': 0.996808967411047, 'auprc': 0.995351241787352, 'loss_val': 0.034889011834397646, 'psi': 0.9962258771615691}-{'f1_val': 0.9955666097086097, 'auprc': 0.99751274098022, 'loss_val': 0.04172725102838881, 'psi': 0.9963450622172538}
[S10] START round=38 head_norm_before_train=1.984369 cos_to_last_merge=0.9899 (last merge round=24)
[S10] round=38 local utility u=0.000773 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9941624826078848, 'loss_val': 0.029455846366007604, 'psi': 0.9948588653813921}-{'f1_val': 0.9953231205637304, 'auprc': 0.9938956113011587, 'loss_val': 0.030200322658612062, 'psi': 0.9947521168587017}
[S11] START round=38 head_norm_before_train=1.829768 cos_to_last_merge=0.8212 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.821
[S11] round=38 local utility u=0.010411 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.996488708773369, 'loss_val': 0.02369525664839258, 'psi': 0.9964033386594551}-{'f1_val': 0.9949019236335007, 'auprc': 0.9965328522828796, 'loss_val': 0.03598260230743278, 'psi': 0.9955542950932523}
[S13] START round=38 head_norm_before_train=1.746554 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6305434872281758, 'auprc': 0.6935882775256814, 'loss_val': 0.9503529892423852, 'psi': 0.655761403347178}-{'f1_val': 0.653851252740514, 'auprc': 0.7423767237532702, 'loss_val': 0.949188125251089, 'psi': 0.6892614411456165}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.927779 cos_to_last_merge=0.9850 (last merge round=20)
[S14] round=38 local utility u=0.013758 metrics={'f1_val': 0.9981489983820784, 'auprc': 0.998847231521109, 'loss_val': 0.020802459007235204, 'psi': 0.9984282916376905}-{'f1_val': 0.9951539120677446, 'auprc': 0.9989980986139763, 'loss_val': 0.030799830803856478, 'psi': 0.9966915866862373}
[S15] START round=38 head_norm_before_train=1.549269 cos_to_last_merge=0.9008 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.901
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8321599038100892, 'auprc': 0.9872529351717579, 'loss_val': 0.27497221368498986, 'psi': 0.8941971163547566}-{'f1_val': 0.9957757960160583, 'auprc': 0.9911136017931337, 'loss_val': 0.04652162765314687, 'psi': 0.9939109183268885}
[S16] START round=38 head_norm_before_train=2.042920 (no previous merge yet)
[S16] round=38 local utility u=0.118341 metrics={'f1_val': 0.9427370860469355, 'auprc': 0.9874477776053834, 'loss_val': 0.18156167947562937, 'psi': 0.9606213626703146}-{'f1_val': 0.9308319279432073, 'auprc': 0.9879587222701989, 'loss_val': 0.34834500233790294, 'psi': 0.953682645674004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=38 head_norm_before_train=1.637235 cos_to_last_merge=0.8026 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=38 local utility u=0.131085 metrics={'f1_val': 0.726999246362545, 'auprc': 0.9308413948142819, 'loss_val': 0.6883037120686721, 'psi': 0.8085361057432396}-{'f1_val': 0.7142748935805612, 'auprc': 0.8945466614345826, 'loss_val': 0.7652439625443737, 'psi': 0.7863836007221697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9862 head_norm=1.628877
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.906582e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9870 head_norm=1.638419 delta_norm=0.089066
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:57005
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.9709
[S2] RECEIVED delta(kind=head bytes=1800) from S10
[S2] cosine check vs S10: cos=-0.0434
[S2] DROPPED delta from S10 (cos=-0.0434 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=0.9959
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9963
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9330 head_norm=1.890774
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.995290e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9329 head_norm=1.898212 delta_norm=0.079953
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=-0.1046
[S15] DROPPED delta from S7 (cos=-0.1046 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9963
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.6255 head_norm=1.920594
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.706592e-02
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.6271 head_norm=1.903752 delta_norm=0.087066
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9968 head_norm=1.851639
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.660867e-02
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9968 head_norm=1.826489 delta_norm=0.086609
[S9] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9967 head_norm=1.819826
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.318631e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9967 head_norm=1.825527 delta_norm=0.083186
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.903752 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6076654880592804, 'auprc': 0.7033893181282806, 'loss_val': 0.9637563521148536, 'psi': 0.6459550200868804}-{'f1_val': 0.6254542588921242, 'auprc': 0.7270124757967574, 'loss_val': 1.013858384788742, 'psi': 0.6660775456539776}
[S3] START round=39 head_norm_before_train=1.835531 cos_to_last_merge=0.8662 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9738849896671469, 'auprc': 0.9928963651044156, 'loss_val': 0.09437313372696218, 'psi': 0.9814895398420543}-{'f1_val': 0.9971434701490716, 'auprc': 0.9971111522479251, 'loss_val': 0.02956324428952553, 'psi': 0.997130542988613}
[S4] START round=39 head_norm_before_train=1.898212 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.034656 metrics={'f1_val': 0.9336750920865594, 'auprc': 0.9500173630945405, 'loss_val': 0.32021886389019694, 'psi': 0.9402120004897518}-{'f1_val': 0.9330340505924173, 'auprc': 0.93731945760863, 'loss_val': 0.3475901853902557, 'psi': 0.9347482133989025}
[S5] START round=39 head_norm_before_train=1.825527 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.009233 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998122562773574, 'loss_val': 0.07081582500460815, 'psi': 0.9972702061965042}-{'f1_val': 0.9967019684784577, 'auprc': 0.997893398120135, 'loss_val': 0.08859525790923964, 'psi': 0.9971785403351285}
[S6] START round=39 head_norm_before_train=1.662679 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=39 local utility u=0.663144 metrics={'f1_val': 0.9085457902383088, 'auprc': 0.964521287465912, 'loss_val': 0.22892078089401374, 'psi': 0.93093598912935}-{'f1_val': 0.768568558305384, 'auprc': 0.8964213999503404, 'loss_val': 0.5110460657454743, 'psi': 0.8197096949633665}
[S7] START round=39 head_norm_before_train=1.849848 cos_to_last_merge=0.9604 (last merge round=13)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6187341187449364, 'auprc': 0.7939252179070363, 'loss_val': 0.6724371433989692, 'psi': 0.6888105584097763}-{'f1_val': 0.6215087230619079, 'auprc': 0.7959218472119541, 'loss_val': 0.5908972217355077, 'psi': 0.6912739727219264}
[S8] START round=39 head_norm_before_train=1.638419 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.018761 metrics={'f1_val': 0.9930438858289332, 'auprc': 0.9847719682510347, 'loss_val': 0.09477010094620791, 'psi': 0.9897351187977738}-{'f1_val': 0.9862409241768243, 'auprc': 0.986126282888715, 'loss_val': 0.09553765141175462, 'psi': 0.9861950676615805}
[S9] START round=39 head_norm_before_train=1.826489 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9974263859968822, 'loss_val': 0.038585843091825896, 'psi': 0.9963105202239186}-{'f1_val': 0.996808967411047, 'auprc': 0.995351241787352, 'loss_val': 0.034889011834397646, 'psi': 0.9962258771615691}
[S10] START round=39 head_norm_before_train=1.996111 cos_to_last_merge=0.9891 (last merge round=24)
[S10] round=39 local utility u=0.003389 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961456578950384, 'loss_val': 0.028628348265541847, 'psi': 0.9956521354962535}-{'f1_val': 0.9953231205637304, 'auprc': 0.9941624826078848, 'loss_val': 0.029455846366007604, 'psi': 0.9948588653813921}
[S11] START round=39 head_norm_before_train=1.836975 cos_to_last_merge=0.8207 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.821
[S11] round=39 local utility u=0.000484 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9964803600185587, 'loss_val': 0.022701709264295704, 'psi': 0.9963999991575309}-{'f1_val': 0.9963464252501789, 'auprc': 0.996488708773369, 'loss_val': 0.02369525664839258, 'psi': 0.9964033386594551}
[S13] START round=39 head_norm_before_train=1.752678 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5927868009906972, 'auprc': 0.6643670161723948, 'loss_val': 1.0421920408965295, 'psi': 0.6214188870633763}-{'f1_val': 0.6305434872281758, 'auprc': 0.6935882775256814, 'loss_val': 0.9503529892423852, 'psi': 0.655761403347178}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.621 u=0.0000 p_local=0.0948 f1=0.593 auprc=0.664 bytes=35969
[S14] START round=39 head_norm_before_train=1.937164 cos_to_last_merge=0.9844 (last merge round=20)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9947363892425176, 'auprc': 0.996979321393092, 'loss_val': 0.029253563696566332, 'psi': 0.9956335621027474}-{'f1_val': 0.9981489983820784, 'auprc': 0.998847231521109, 'loss_val': 0.020802459007235204, 'psi': 0.9984282916376905}
[S15] START round=39 head_norm_before_train=1.564292 cos_to_last_merge=0.8988 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=39 local utility u=0.625707 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9966764332314938, 'loss_val': 0.03858631319255758, 'psi': 0.9966423645066298}-{'f1_val': 0.8321599038100892, 'auprc': 0.9872529351717579, 'loss_val': 0.27497221368498986, 'psi': 0.8941971163547566}
[S16] START round=39 head_norm_before_train=2.048614 (no previous merge yet)
[S16] round=39 local utility u=0.226630 metrics={'f1_val': 0.9919546630569573, 'auprc': 0.9927990645172158, 'loss_val': 0.03966127681397659, 'psi': 0.9922924236410607}-{'f1_val': 0.9427370860469355, 'auprc': 0.9874477776053834, 'loss_val': 0.18156167947562937, 'psi': 0.9606213626703146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=40 psi=0.992 u=0.2266 p_local=0.1412 f1=0.992 auprc=0.993 bytes=41366
[S17] START round=39 head_norm_before_train=1.652649 cos_to_last_merge=0.8017 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6582873904686677, 'auprc': 0.8340448695283753, 'loss_val': 1.1149018173627256, 'psi': 0.7285903820925508}-{'f1_val': 0.726999246362545, 'auprc': 0.9308413948142819, 'loss_val': 0.6883037120686721, 'psi': 0.8085361057432396}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.729 u=0.0000 p_local=0.1506 f1=0.658 auprc=0.834 bytes=34090
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.996 u=0.0005 p_local=0.0061 f1=0.996 auprc=0.996 bytes=53915
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] r=40 psi=0.996 u=0.0000 p_local=0.0112 f1=0.995 auprc=0.997 bytes=48602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] r=40 psi=0.981 u=0.0000 p_local=0.0856 f1=0.974 auprc=0.993 bytes=46768
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9969
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1046
[S7] DROPPED delta from S15 (cos=-0.1046 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9999
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] r=40 psi=0.940 u=0.0347 p_local=0.0301 f1=0.934 auprc=0.950 bytes=39546
[S5] r=40 psi=0.997 u=0.0092 p_local=0.2580 f1=0.997 auprc=0.998 bytes=43230
[S15] r=40 psi=0.997 u=0.6257 p_local=0.3440 f1=0.997 auprc=0.997 bytes=46737
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9978
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=39 metric=0.6077 head_norm=1.915977
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.596418e-02
[S2] stored merged vector for next round verification (round=39)
[S2] DEBUG after merge:  round=39 metric=0.6077 head_norm=1.913385 delta_norm=0.015964
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=40 psi=0.646 u=0.0000 p_local=0.0694 f1=0.608 auprc=0.703 bytes=39480
[S7] r=40 psi=0.689 u=0.0000 p_local=0.2350 f1=0.619 auprc=0.794 bytes=39556
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] cosine check vs S10: cos=-0.0448
[S2] DROPPED delta from S10 (cos=-0.0448 < 0.0)
[S6] r=40 psi=0.931 u=0.6631 p_local=0.3483 f1=0.909 auprc=0.965 bytes=35981
[S10] r=40 psi=0.996 u=0.0034 p_local=0.0038 f1=0.995 auprc=0.996 bytes=50333
[S8] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=0.9978
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9930 head_norm=1.655032
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.629889e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9930 head_norm=1.664865 delta_norm=0.056299
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.990 u=0.0188 p_local=0.0235 f1=0.993 auprc=0.985 bytes=48583
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9956 head_norm=1.853116
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.333602e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9956 head_norm=1.853675 delta_norm=0.073336
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0089 f1=0.996 auprc=0.997 bytes=45049
[S2] START round=40 head_norm_before_train=1.913385 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=40 local utility u=0.281622 metrics={'f1_val': 0.6645915885062804, 'auprc': 0.7190437334218509, 'loss_val': 0.7890312788880551, 'psi': 0.6863724464725086}-{'f1_val': 0.6076654880592804, 'auprc': 0.7033893181282806, 'loss_val': 0.9637563521148536, 'psi': 0.6459550200868804}
[S3] START round=40 head_norm_before_train=1.846390 cos_to_last_merge=0.8647 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.865
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9325563934937244, 'auprc': 0.9988211138350488, 'loss_val': 0.2008412514734529, 'psi': 0.9590622816302542}-{'f1_val': 0.9738849896671469, 'auprc': 0.9928963651044156, 'loss_val': 0.09437313372696218, 'psi': 0.9814895398420543}
[S4] START round=40 head_norm_before_train=1.910922 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=40 local utility u=0.009772 metrics={'f1_val': 0.9332330120410628, 'auprc': 0.9540132500388524, 'loss_val': 0.3100091318942335, 'psi': 0.9415451072401786}-{'f1_val': 0.9336750920865594, 'auprc': 0.9500173630945405, 'loss_val': 0.32021886389019694, 'psi': 0.9402120004897518}
[S5] START round=40 head_norm_before_train=1.857134 cos_to_last_merge=0.9997 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9853605818682973, 'auprc': 0.9916929975883804, 'loss_val': 0.08256436492016614, 'psi': 0.9878935481563306}-{'f1_val': 0.9967019684784577, 'auprc': 0.998122562773574, 'loss_val': 0.07081582500460815, 'psi': 0.9972702061965042}
[S6] START round=40 head_norm_before_train=1.676533 cos_to_last_merge=0.9995 (last merge round=36)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.616403450207843, 'auprc': 0.794897088845983, 'loss_val': 0.682172709695536, 'psi': 0.687800905663099}-{'f1_val': 0.9085457902383088, 'auprc': 0.964521287465912, 'loss_val': 0.22892078089401374, 'psi': 0.93093598912935}
[S7] START round=40 head_norm_before_train=1.857313 cos_to_last_merge=0.9596 (last merge round=13)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5814498754396885, 'auprc': 0.791722205591738, 'loss_val': 0.7429793176466811, 'psi': 0.6655588075005083}-{'f1_val': 0.6187341187449364, 'auprc': 0.7939252179070363, 'loss_val': 0.6724371433989692, 'psi': 0.6888105584097763}
[S8] START round=40 head_norm_before_train=1.664865 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9901607173486547, 'auprc': 0.9859187904478681, 'loss_val': 0.08423205125784802, 'psi': 0.98846394658834}-{'f1_val': 0.9930438858289332, 'auprc': 0.9847719682510347, 'loss_val': 0.09477010094620791, 'psi': 0.9897351187977738}
[S9] START round=40 head_norm_before_train=1.853675 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.996398546385143, 'auprc': 0.9928822188160451, 'loss_val': 0.03140705945175725, 'psi': 0.9949920153575039}-{'f1_val': 0.9955666097086097, 'auprc': 0.9974263859968822, 'loss_val': 0.038585843091825896, 'psi': 0.9963105202239186}
[S10] START round=40 head_norm_before_train=2.008372 cos_to_last_merge=0.9883 (last merge round=24)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9941950312532156, 'loss_val': 0.02852377075786157, 'psi': 0.9948718848395244}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961456578950384, 'loss_val': 0.028628348265541847, 'psi': 0.9956521354962535}
[S11] START round=40 head_norm_before_train=1.846452 cos_to_last_merge=0.8205 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9912448951871418, 'auprc': 0.9964324503440876, 'loss_val': 0.041284633656436934, 'psi': 0.9933199172499201}-{'f1_val': 0.9963464252501789, 'auprc': 0.9964803600185587, 'loss_val': 0.022701709264295704, 'psi': 0.9963999991575309}
[S13] START round=40 head_norm_before_train=1.757920 (no previous merge yet)
[S13] round=40 local utility u=0.431142 metrics={'f1_val': 0.7045357973300698, 'auprc': 0.6754139652769713, 'loss_val': 0.8835429278955917, 'psi': 0.6928870645088303}-{'f1_val': 0.5927868009906972, 'auprc': 0.6643670161723948, 'loss_val': 1.0421920408965295, 'psi': 0.6214188870633763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=40 head_norm_before_train=1.947773 cos_to_last_merge=0.9838 (last merge round=20)
[S14] round=40 local utility u=0.001463 metrics={'f1_val': 0.9947139726721735, 'auprc': 0.9984547251492254, 'loss_val': 0.030620107481777816, 'psi': 0.9962102736629943}-{'f1_val': 0.9947363892425176, 'auprc': 0.996979321393092, 'loss_val': 0.029253563696566332, 'psi': 0.9956335621027474}
[S15] START round=40 head_norm_before_train=1.577725 cos_to_last_merge=0.8970 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.897
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9048562955855518, 'loss_val': 0.5020307895056462, 'psi': 0.7824927045359948}-{'f1_val': 0.9966196520233872, 'auprc': 0.9966764332314938, 'loss_val': 0.03858631319255758, 'psi': 0.9966423645066298}
[S16] START round=40 head_norm_before_train=2.056427 (no previous merge yet)
[S16] round=40 local utility u=0.002442 metrics={'f1_val': 0.9919546630569573, 'auprc': 0.9943720443292786, 'loss_val': 0.03949534423222947, 'psi': 0.9929216155658859}-{'f1_val': 0.9919546630569573, 'auprc': 0.9927990645172158, 'loss_val': 0.03966127681397659, 'psi': 0.9922924236410607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=40 head_norm_before_train=1.665926 cos_to_last_merge=0.8007 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.639487314090722, 'auprc': 0.8110833910321826, 'loss_val': 1.3188017310887783, 'psi': 0.7081257448673063}-{'f1_val': 0.6582873904686677, 'auprc': 0.8340448695283753, 'loss_val': 1.1149018173627256, 'psi': 0.7285903820925508}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S14]  timeout peer S6
[S11]  timeout peer S7
[S15] ⇄ pheromone p=0.275 → S7@127.0.0.1:57008
[S10] ⇄ pheromone p=0.003 → S2@127.0.0.1:57002
[S8] ⇄ pheromone p=0.019 → S6@127.0.0.1:57007
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.206 → S9@127.0.0.1:57010
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S3] ⇄ pheromone p=0.068 → S9@127.0.0.1:57010
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9998
[S4] ⇄ pheromone p=0.026 → S2@127.0.0.1:57002
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9998
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.6164 head_norm=1.691882
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.184122e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.6172 head_norm=1.672415 delta_norm=0.061841
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.279 → S14@127.0.0.1:57014
[S7] ⇄ pheromone p=0.188 → S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.6646 head_norm=1.925719
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.972414e-02
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.6651 head_norm=1.923704 delta_norm=0.019724
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.112 → S4@127.0.0.1:57004
[S9] ⇄ pheromone p=0.007 → S5@127.0.0.1:57005
[S2] START round=41 head_norm_before_train=1.923704 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.5781984887343647, 'auprc': 0.6813566819733881, 'loss_val': 1.157666720771556, 'psi': 0.619461766029974}-{'f1_val': 0.6645915885062804, 'auprc': 0.7190437334218509, 'loss_val': 0.7890312788880551, 'psi': 0.6863724464725086}
[S3] START round=41 head_norm_before_train=1.855937 cos_to_last_merge=0.8633 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=41 local utility u=0.183719 metrics={'f1_val': 0.9825537580086922, 'auprc': 0.9893818173126132, 'loss_val': 0.10506938948728113, 'psi': 0.9852849817302607}-{'f1_val': 0.9325563934937244, 'auprc': 0.9988211138350488, 'loss_val': 0.2008412514734529, 'psi': 0.9590622816302542}
[S4] START round=41 head_norm_before_train=1.921888 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9323409127598256, 'auprc': 0.9547917065630855, 'loss_val': 0.33474255627550786, 'psi': 0.9413212302811296}-{'f1_val': 0.9332330120410628, 'auprc': 0.9540132500388524, 'loss_val': 0.3100091318942335, 'psi': 0.9415451072401786}
[S5] START round=41 head_norm_before_train=1.890678 cos_to_last_merge=0.9989 (last merge round=38)
[S5] round=41 local utility u=0.056907 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9982138098962903, 'loss_val': 0.05373013640064835, 'psi': 0.9970435150847723}-{'f1_val': 0.9853605818682973, 'auprc': 0.9916929975883804, 'loss_val': 0.08256436492016614, 'psi': 0.9878935481563306}
[S6] START round=41 head_norm_before_train=1.672415 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.9591456082718253, 'auprc': 0.9759469854129688, 'loss_val': 0.1709032176801324, 'psi': 0.9658661591282827}-{'f1_val': 0.616403450207843, 'auprc': 0.794897088845983, 'loss_val': 0.682172709695536, 'psi': 0.687800905663099}
[S7] START round=41 head_norm_before_train=1.863642 cos_to_last_merge=0.9589 (last merge round=13)
[S7] round=41 local utility u=0.653202 metrics={'f1_val': 0.6839617350610783, 'auprc': 0.8780213822641874, 'loss_val': 0.31054423269968007, 'psi': 0.761585593942322}-{'f1_val': 0.5814498754396885, 'auprc': 0.791722205591738, 'loss_val': 0.7429793176466811, 'psi': 0.6655588075005083}
[S8] START round=41 head_norm_before_train=1.684826 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=41 local utility u=0.011785 metrics={'f1_val': 0.992147567760106, 'auprc': 0.9857390765675517, 'loss_val': 0.07204374947787555, 'psi': 0.9895841712830843}-{'f1_val': 0.9901607173486547, 'auprc': 0.9859187904478681, 'loss_val': 0.08423205125784802, 'psi': 0.98846394658834}
[S9] START round=41 head_norm_before_train=1.882270 cos_to_last_merge=0.9998 (last merge round=39)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9938968689134425, 'auprc': 0.9960557151147702, 'loss_val': 0.045832195578121855, 'psi': 0.9947604073939736}-{'f1_val': 0.996398546385143, 'auprc': 0.9928822188160451, 'loss_val': 0.03140705945175725, 'psi': 0.9949920153575039}
[S10] START round=41 head_norm_before_train=2.020587 cos_to_last_merge=0.9877 (last merge round=24)
[S10] round=41 local utility u=0.000042 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9941094291535595, 'loss_val': 0.02818306273131222, 'psi': 0.994837643999662}-{'f1_val': 0.9953231205637304, 'auprc': 0.9941950312532156, 'loss_val': 0.02852377075786157, 'psi': 0.9948718848395244}
[S11] START round=41 head_norm_before_train=1.857487 cos_to_last_merge=0.8202 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=41 local utility u=0.026874 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981037823542499, 'loss_val': 0.023034396272857745, 'psi': 0.9970368927547677}-{'f1_val': 0.9912448951871418, 'auprc': 0.9964324503440876, 'loss_val': 0.041284633656436934, 'psi': 0.9933199172499201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=41 head_norm_before_train=1.762506 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6188263864011063, 'auprc': 0.671172869745438, 'loss_val': 0.9673647509183835, 'psi': 0.639764979738839}-{'f1_val': 0.7045357973300698, 'auprc': 0.6754139652769713, 'loss_val': 0.8835429278955917, 'psi': 0.6928870645088303}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.957118 cos_to_last_merge=0.9831 (last merge round=20)
[S14] round=41 local utility u=0.011991 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9986490249529213, 'loss_val': 0.022341512410077733, 'psi': 0.9977999453235147}-{'f1_val': 0.9947139726721735, 'auprc': 0.9984547251492254, 'loss_val': 0.030620107481777816, 'psi': 0.9962102736629943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=41 head_norm_before_train=1.589519 cos_to_last_merge=0.8955 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=41 local utility u=0.341735 metrics={'f1_val': 0.7748796503419625, 'auprc': 0.9467031512049564, 'loss_val': 0.3878772245144706, 'psi': 0.8436090506871601}-{'f1_val': 0.7009169771696235, 'auprc': 0.9048562955855518, 'loss_val': 0.5020307895056462, 'psi': 0.7824927045359948}
[S16] START round=41 head_norm_before_train=2.065080 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8923239550771086, 'auprc': 0.9880013815215687, 'loss_val': 0.5278599106901326, 'psi': 0.9305949256548927}-{'f1_val': 0.9919546630569573, 'auprc': 0.9943720443292786, 'loss_val': 0.03949534423222947, 'psi': 0.9929216155658859}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.671042 cos_to_last_merge=0.8000 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.8606321681200175, 'auprc': 0.8539209355491467, 'loss_val': 0.6890562589126953, 'psi': 0.8579476750916691}-{'f1_val': 0.639487314090722, 'auprc': 0.8110833910321826, 'loss_val': 1.3188017310887783, 'psi': 0.7081257448673063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9323 head_norm=1.929361
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.268477e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9323 head_norm=1.927408 delta_norm=0.022685
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:57014
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9993
[S2] RECEIVED delta(kind=head bytes=1798) from S10
[S2] cosine check vs S10: cos=-0.0457
[S2] DROPPED delta from S10 (cos=-0.0457 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.9623
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S6
[S14] cosine check vs S6: cos=0.9473
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.1058
[S15] DROPPED delta from S7 (cos=-0.1058 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9939 head_norm=1.904913
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.596058e-01
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9937 head_norm=1.865900 delta_norm=0.259606
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=-0.1058
[S7] DROPPED delta from S15 (cos=-0.1058 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9848
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.9591 head_norm=1.685261
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.401254e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.9591 head_norm=1.696069 delta_norm=0.034013
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.935049 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=42 local utility u=0.233062 metrics={'f1_val': 0.619944012840712, 'auprc': 0.7163957426607503, 'loss_val': 1.0471327746656747, 'psi': 0.6585247047687273}-{'f1_val': 0.5781984887343647, 'auprc': 0.6813566819733881, 'loss_val': 1.157666720771556, 'psi': 0.619461766029974}
[S3] START round=42 head_norm_before_train=1.862595 cos_to_last_merge=0.8623 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.862
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9742443089474866, 'auprc': 0.9982002618432, 'loss_val': 0.09669285576386935, 'psi': 0.983826690105772}-{'f1_val': 0.9825537580086922, 'auprc': 0.9893818173126132, 'loss_val': 0.10506938948728113, 'psi': 0.9852849817302607}
[S4] START round=42 head_norm_before_train=1.927408 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.016394 metrics={'f1_val': 0.9334821568364224, 'auprc': 0.9651237842934282, 'loss_val': 0.33979769655012493, 'psi': 0.9461388078192248}-{'f1_val': 0.9323409127598256, 'auprc': 0.9547917065630855, 'loss_val': 0.33474255627550786, 'psi': 0.9413212302811296}
[S5] START round=42 head_norm_before_train=1.910598 cos_to_last_merge=0.9982 (last merge round=38)
[S5] round=42 local utility u=0.006144 metrics={'f1_val': 0.9967759625455614, 'auprc': 0.9992583893519015, 'loss_val': 0.047652694704386364, 'psi': 0.9977689332680975}-{'f1_val': 0.9962633185437604, 'auprc': 0.9982138098962903, 'loss_val': 0.05373013640064835, 'psi': 0.9970435150847723}
[S6] START round=42 head_norm_before_train=1.696069 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.46253247750936954, 'auprc': 0.7595466670113185, 'loss_val': 1.1485011887432537, 'psi': 0.5813381533101492}-{'f1_val': 0.9591456082718253, 'auprc': 0.9759469854129688, 'loss_val': 0.1709032176801324, 'psi': 0.9658661591282827}
[S7] START round=42 head_norm_before_train=1.875545 cos_to_last_merge=0.9575 (last merge round=13)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6934050536335159, 'auprc': 0.8654285067712375, 'loss_val': 0.33463080206432605, 'psi': 0.7622144348886045}-{'f1_val': 0.6839617350610783, 'auprc': 0.8780213822641874, 'loss_val': 0.31054423269968007, 'psi': 0.761585593942322}
[S8] START round=42 head_norm_before_train=1.707487 cos_to_last_merge=0.9994 (last merge round=39)
[S8] round=42 local utility u=0.001915 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9869461652055279, 'loss_val': 0.06789286678040395, 'psi': 0.9896727576519886}-{'f1_val': 0.992147567760106, 'auprc': 0.9857390765675517, 'loss_val': 0.07204374947787555, 'psi': 0.9895841712830843}
[S9] START round=42 head_norm_before_train=1.865900 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.008568 metrics={'f1_val': 0.996808967411047, 'auprc': 0.993915863856492, 'loss_val': 0.03974959889921243, 'psi': 0.995651725989225}-{'f1_val': 0.9938968689134425, 'auprc': 0.9960557151147702, 'loss_val': 0.045832195578121855, 'psi': 0.9947604073939736}
[S10] START round=42 head_norm_before_train=2.031469 cos_to_last_merge=0.9870 (last merge round=24)
[S10] round=42 local utility u=0.003267 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.99608746547343, 'loss_val': 0.02758309126019749, 'psi': 0.9956288585276102}-{'f1_val': 0.9953231205637304, 'auprc': 0.9941094291535595, 'loss_val': 0.02818306273131222, 'psi': 0.994837643999662}
[S11] START round=42 head_norm_before_train=1.867875 cos_to_last_merge=0.8200 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=42 local utility u=0.001360 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981396006180319, 'loss_val': 0.021871928642235677, 'psi': 0.997196322630941}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981037823542499, 'loss_val': 0.023034396272857745, 'psi': 0.9970368927547677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=42 head_norm_before_train=1.768557 (no previous merge yet)
[S13] round=42 local utility u=0.196239 metrics={'f1_val': 0.6377605087192726, 'auprc': 0.7508620479374232, 'loss_val': 0.9275588327267451, 'psi': 0.6830011244065328}-{'f1_val': 0.6188263864011063, 'auprc': 0.671172869745438, 'loss_val': 0.9673647509183835, 'psi': 0.639764979738839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.968097 cos_to_last_merge=0.9825 (last merge round=20)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9345413413885264, 'auprc': 0.9969254711515657, 'loss_val': 0.11107510792814193, 'psi': 0.9594949932937421}-{'f1_val': 0.9972338922372435, 'auprc': 0.9986490249529213, 'loss_val': 0.022341512410077733, 'psi': 0.9977999453235147}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9345 head_norm=1.978866
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.316131e-01
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9343 head_norm=1.807773 delta_norm=0.331613
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=42 head_norm_before_train=1.601475 cos_to_last_merge=0.8941 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=42 local utility u=0.454711 metrics={'f1_val': 0.8800581496740351, 'auprc': 0.992766681798574, 'loss_val': 0.24771743129620424, 'psi': 0.9251415625238506}-{'f1_val': 0.7748796503419625, 'auprc': 0.9467031512049564, 'loss_val': 0.3878772245144706, 'psi': 0.8436090506871601}
[S16] START round=42 head_norm_before_train=2.070637 (no previous merge yet)
[S16] round=42 local utility u=0.279933 metrics={'f1_val': 0.9400227566195202, 'auprc': 0.9913331964957953, 'loss_val': 0.264181744098079, 'psi': 0.9605469325700302}-{'f1_val': 0.8923239550771086, 'auprc': 0.9880013815215687, 'loss_val': 0.5278599106901326, 'psi': 0.9305949256548927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=42 head_norm_before_train=1.671892 cos_to_last_merge=0.7995 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6796798774742185, 'auprc': 0.8323699654342982, 'loss_val': 1.164375672701266, 'psi': 0.7407559126582504}-{'f1_val': 0.8606321681200175, 'auprc': 0.8539209355491467, 'loss_val': 0.6890562589126953, 'psi': 0.8579476750916691}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S4] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:57005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9993
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9844
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=-0.1057
[S7] DROPPED delta from S15 (cos=-0.1057 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S10
[S2] cosine check vs S10: cos=-0.0462
[S2] DROPPED delta from S10 (cos=-0.0462 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9999
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.9844
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.4625 head_norm=1.706810
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.344143e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.4625 head_norm=1.717783 delta_norm=0.033441
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.6199 head_norm=1.942556
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.683777e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.6202 head_norm=1.937936 delta_norm=0.016838
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.9968 head_norm=1.887861
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.634122e-01
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.9968 head_norm=1.898594 delta_norm=0.163412
[S9] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.937936 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.169317 metrics={'f1_val': 0.6484803485460781, 'auprc': 0.7118051094276561, 'loss_val': 0.8659446723488667, 'psi': 0.6738102528987092}-{'f1_val': 0.619944012840712, 'auprc': 0.7163957426607503, 'loss_val': 1.0471327746656747, 'psi': 0.6585247047687273}
[S3] START round=43 head_norm_before_train=1.870427 cos_to_last_merge=0.8612 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.861
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.947860483828888, 'auprc': 0.9903058570727703, 'loss_val': 0.1596580544017712, 'psi': 0.9648386331264409}-{'f1_val': 0.9742443089474866, 'auprc': 0.9982002618432, 'loss_val': 0.09669285576386935, 'psi': 0.983826690105772}
[S4] START round=43 head_norm_before_train=1.933452 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.021241 metrics={'f1_val': 0.9362018361798177, 'auprc': 0.9686865173558793, 'loss_val': 0.3243229280768202, 'psi': 0.9491957086502423}-{'f1_val': 0.9334821568364224, 'auprc': 0.9651237842934282, 'loss_val': 0.33979769655012493, 'psi': 0.9461388078192248}
[S5] START round=43 head_norm_before_train=1.935932 cos_to_last_merge=0.9972 (last merge round=38)
[S5] round=43 local utility u=0.003816 metrics={'f1_val': 0.9967759625455614, 'auprc': 0.9994935384743904, 'loss_val': 0.04072596209949077, 'psi': 0.997862992917093}-{'f1_val': 0.9967759625455614, 'auprc': 0.9992583893519015, 'loss_val': 0.047652694704386364, 'psi': 0.9977689332680975}
[S6] START round=43 head_norm_before_train=1.717783 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8065514635299351, 'auprc': 0.9435430019944464, 'loss_val': 0.44075234221131016, 'psi': 0.8613480789157396}-{'f1_val': 0.46253247750936954, 'auprc': 0.7595466670113185, 'loss_val': 1.1485011887432537, 'psi': 0.5813381533101492}
[S7] START round=43 head_norm_before_train=1.887679 cos_to_last_merge=0.9563 (last merge round=13)
[S7] round=43 local utility u=0.986728 metrics={'f1_val': 0.9398813687027545, 'auprc': 0.9885198136871252, 'loss_val': 0.20930708501042686, 'psi': 0.9593367466965028}-{'f1_val': 0.6934050536335159, 'auprc': 0.8654285067712375, 'loss_val': 0.33463080206432605, 'psi': 0.7622144348886045}
[S8] START round=43 head_norm_before_train=1.729334 cos_to_last_merge=0.9987 (last merge round=39)
[S8] round=43 local utility u=0.008156 metrics={'f1_val': 0.9917925202525073, 'auprc': 0.9897501307546597, 'loss_val': 0.06180574877616231, 'psi': 0.9909755644533682}-{'f1_val': 0.991490485949629, 'auprc': 0.9869461652055279, 'loss_val': 0.06789286678040395, 'psi': 0.9896727576519886}
[S9] START round=43 head_norm_before_train=1.898594 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.008919 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9972961749007754, 'loss_val': 0.02939785507955454, 'psi': 0.9967384105519164}-{'f1_val': 0.996808967411047, 'auprc': 0.993915863856492, 'loss_val': 0.03974959889921243, 'psi': 0.995651725989225}
[S10] START round=43 head_norm_before_train=2.038750 cos_to_last_merge=0.9863 (last merge round=24)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959906632477509, 'loss_val': 0.02739386792681416, 'psi': 0.9955901376373386}-{'f1_val': 0.9953231205637304, 'auprc': 0.99608746547343, 'loss_val': 0.02758309126019749, 'psi': 0.9956288585276102}
[S11] START round=43 head_norm_before_train=1.872376 cos_to_last_merge=0.8192 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.819
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998025144886024, 'loss_val': 0.021878789631174497, 'psi': 0.9971505403381378}-{'f1_val': 0.996567470639547, 'auprc': 0.9981396006180319, 'loss_val': 0.021871928642235677, 'psi': 0.997196322630941}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.773937 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6103703897037057, 'auprc': 0.6346023949664563, 'loss_val': 1.071192782880328, 'psi': 0.620063191808806}-{'f1_val': 0.6377605087192726, 'auprc': 0.7508620479374232, 'loss_val': 0.9275588327267451, 'psi': 0.6830011244065328}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.807773 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.233495 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9984521238378687, 'loss_val': 0.027843380571122636, 'psi': 0.9980234993531912}-{'f1_val': 0.9345413413885264, 'auprc': 0.9969254711515657, 'loss_val': 0.11107510792814193, 'psi': 0.9594949932937421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=43 head_norm_before_train=1.612549 cos_to_last_merge=0.8928 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=43 local utility u=0.458134 metrics={'f1_val': 0.9961900430063055, 'auprc': 0.9950394340467432, 'loss_val': 0.035059198317291373, 'psi': 0.9957297994224806}-{'f1_val': 0.8800581496740351, 'auprc': 0.992766681798574, 'loss_val': 0.24771743129620424, 'psi': 0.9251415625238506}
[S16] START round=43 head_norm_before_train=2.077023 (no previous merge yet)
[S16] round=43 local utility u=0.276336 metrics={'f1_val': 0.9923930148400706, 'auprc': 0.9937735597703328, 'loss_val': 0.03305207184038443, 'psi': 0.9929452328121755}-{'f1_val': 0.9400227566195202, 'auprc': 0.9913331964957953, 'loss_val': 0.264181744098079, 'psi': 0.9605469325700302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.674350 cos_to_last_merge=0.7992 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=43 local utility u=0.917992 metrics={'f1_val': 0.8682188891295192, 'auprc': 0.8768948538722529, 'loss_val': 0.593201188742828, 'psi': 0.8716892750266126}-{'f1_val': 0.6796798774742185, 'auprc': 0.8323699654342982, 'loss_val': 1.164375672701266, 'psi': 0.7407559126582504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:57014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9994
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1052
[S7] DROPPED delta from S15 (cos=-0.1052 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9952
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9999
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9362 head_norm=1.938875
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.863099e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9362 head_norm=1.940627 delta_norm=0.018631
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.1052
[S15] DROPPED delta from S7 (cos=-0.1052 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9952
[S14] RECEIVED delta(kind=head bytes=1799) from S6
[S14] cosine check vs S6: cos=0.9802
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.6485 head_norm=1.943621
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.436876e-02
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.6472 head_norm=1.941196 delta_norm=0.014369
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.8066 head_norm=1.724430
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.184253e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.8066 head_norm=1.736704 delta_norm=0.031843
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.9968 head_norm=1.960704
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.402985e-01
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.9968 head_norm=1.924985 delta_norm=0.140299
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=43 metric=0.9964 head_norm=1.914164
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.733315e-02
[S9] stored merged vector for next round verification (round=43)
[S9] DEBUG after merge:  round=43 metric=0.9964 head_norm=1.935127 delta_norm=0.097333
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.941196 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.057389 metrics={'f1_val': 0.6612932662796709, 'auprc': 0.7155381229062092, 'loss_val': 0.8392422504221838, 'psi': 0.6829912089302862}-{'f1_val': 0.6484803485460781, 'auprc': 0.7118051094276561, 'loss_val': 0.8659446723488667, 'psi': 0.6738102528987092}
[S3] START round=44 head_norm_before_train=1.879236 cos_to_last_merge=0.8600 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.860
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9475765426638431, 'auprc': 0.9918132017964157, 'loss_val': 0.17461736428835092, 'psi': 0.9652712063168722}-{'f1_val': 0.947860483828888, 'auprc': 0.9903058570727703, 'loss_val': 0.1596580544017712, 'psi': 0.9648386331264409}
[S4] START round=44 head_norm_before_train=1.940627 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9287431337503774, 'auprc': 0.9213568318489698, 'loss_val': 0.3405101631474574, 'psi': 0.9257886129898144}-{'f1_val': 0.9362018361798177, 'auprc': 0.9686865173558793, 'loss_val': 0.3243229280768202, 'psi': 0.9491957086502423}
[S5] START round=44 head_norm_before_train=1.924985 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9927170737460023, 'loss_val': 0.06820975544432224, 'psi': 0.9947109590372333}-{'f1_val': 0.9967759625455614, 'auprc': 0.9994935384743904, 'loss_val': 0.04072596209949077, 'psi': 0.997862992917093}
[S6] START round=44 head_norm_before_train=1.736704 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.647887 metrics={'f1_val': 0.9611404180168063, 'auprc': 0.9763920407728737, 'loss_val': 0.1710597185997269, 'psi': 0.9672410671192333}-{'f1_val': 0.8065514635299351, 'auprc': 0.9435430019944464, 'loss_val': 0.44075234221131016, 'psi': 0.8613480789157396}
[S7] START round=44 head_norm_before_train=1.896747 cos_to_last_merge=0.9554 (last merge round=13)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.8291223577699107, 'auprc': 0.9740359896707876, 'loss_val': 0.2665857728096547, 'psi': 0.8870878105302615}-{'f1_val': 0.9398813687027545, 'auprc': 0.9885198136871252, 'loss_val': 0.20930708501042686, 'psi': 0.9593367466965028}
[S8] START round=44 head_norm_before_train=1.749471 cos_to_last_merge=0.9979 (last merge round=39)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.992392260479464, 'auprc': 0.985888193420611, 'loss_val': 0.05627161545892794, 'psi': 0.9897906336559228}-{'f1_val': 0.9917925202525073, 'auprc': 0.9897501307546597, 'loss_val': 0.06180574877616231, 'psi': 0.9909755644533682}
[S9] START round=44 head_norm_before_train=1.935127 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9973334552371168, 'loss_val': 0.03401220065218001, 'psi': 0.9952536575580895}-{'f1_val': 0.9963665676526772, 'auprc': 0.9972961749007754, 'loss_val': 0.02939785507955454, 'psi': 0.9967384105519164}
[S10] START round=44 head_norm_before_train=2.047832 cos_to_last_merge=0.9856 (last merge round=24)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955091011466972, 'loss_val': 0.0272259544599762, 'psi': 0.995397512796917}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959906632477509, 'loss_val': 0.02739386792681416, 'psi': 0.9955901376373386}
[S11] START round=44 head_norm_before_train=1.878180 cos_to_last_merge=0.8186 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.819
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.998246048670752, 'loss_val': 0.023524289621688118, 'psi': 0.9970937992813685}-{'f1_val': 0.996567470639547, 'auprc': 0.998025144886024, 'loss_val': 0.021878789631174497, 'psi': 0.9971505403381378}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.779554 (no previous merge yet)
[S13] round=44 local utility u=0.179698 metrics={'f1_val': 0.6329806111550133, 'auprc': 0.6689397722290741, 'loss_val': 0.9504707955018892, 'psi': 0.6473642755846376}-{'f1_val': 0.6103703897037057, 'auprc': 0.6346023949664563, 'loss_val': 1.071192782880328, 'psi': 0.620063191808806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=44 head_norm_before_train=1.816135 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9969800358199304, 'loss_val': 0.029318119145935656, 'psi': 0.9971323496703183}-{'f1_val': 0.9977377496967396, 'auprc': 0.9984521238378687, 'loss_val': 0.027843380571122636, 'psi': 0.9980234993531912}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9972 head_norm=1.825843
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.858044e-01
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9972 head_norm=1.766113 delta_norm=0.185804
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=44 head_norm_before_train=1.623716 cos_to_last_merge=0.8913 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9548659902819004, 'auprc': 0.9913960996951496, 'loss_val': 0.0813430167840799, 'psi': 0.9694780340472002}-{'f1_val': 0.9961900430063055, 'auprc': 0.9950394340467432, 'loss_val': 0.035059198317291373, 'psi': 0.9957297994224806}
[S16] START round=44 head_norm_before_train=2.082748 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9923964772584256, 'auprc': 0.992143163311212, 'loss_val': 0.03187602816740566, 'psi': 0.9922951516795402}-{'f1_val': 0.9923930148400706, 'auprc': 0.9937735597703328, 'loss_val': 0.03305207184038443, 'psi': 0.9929452328121755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.681046 cos_to_last_merge=0.7987 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6793072442134706, 'auprc': 0.8858109851212972, 'loss_val': 0.9490123791026348, 'psi': 0.7619087405766012}-{'f1_val': 0.8682188891295192, 'auprc': 0.8768948538722529, 'loss_val': 0.593201188742828, 'psi': 0.8716892750266126}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=44 metric=0.9287 head_norm=1.941243
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.787456e-03
[S4] stored merged vector for next round verification (round=44)
[S4] DEBUG after merge:  round=44 metric=0.9287 head_norm=1.942412 delta_norm=0.008787
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:57014
[S6] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1807) from S6
[S14] cosine check vs S6: cos=0.9935
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.947469 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6636030318815066, 'auprc': 0.7109753910692924, 'loss_val': 0.8472473548944525, 'psi': 0.682551975556621}-{'f1_val': 0.6612932662796709, 'auprc': 0.7155381229062092, 'loss_val': 0.8392422504221838, 'psi': 0.6829912089302862}
[S3] START round=45 head_norm_before_train=1.889674 cos_to_last_merge=0.8587 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8195175801696197, 'auprc': 0.9328721932082645, 'loss_val': 0.40909269995283376, 'psi': 0.8648594253850777}-{'f1_val': 0.9475765426638431, 'auprc': 0.9918132017964157, 'loss_val': 0.17461736428835092, 'psi': 0.9652712063168722}
[S4] START round=45 head_norm_before_train=1.942412 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9288715188325277, 'auprc': 0.9176122625728624, 'loss_val': 0.35532290552554135, 'psi': 0.9243678163286616}-{'f1_val': 0.9287431337503774, 'auprc': 0.9213568318489698, 'loss_val': 0.3405101631474574, 'psi': 0.9257886129898144}
[S5] START round=45 head_norm_before_train=1.943280 cos_to_last_merge=0.9999 (last merge round=43)
[S5] round=45 local utility u=0.022667 metrics={'f1_val': 0.9964083724129549, 'auprc': 0.9987498135630853, 'loss_val': 0.043183524419098875, 'psi': 0.9973449488730071}-{'f1_val': 0.9960402158980539, 'auprc': 0.9927170737460023, 'loss_val': 0.06820975544432224, 'psi': 0.9947109590372333}
[S6] START round=45 head_norm_before_train=1.742883 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8250788830898357, 'auprc': 0.964484996701364, 'loss_val': 0.4138745358291548, 'psi': 0.880841328534447}-{'f1_val': 0.9611404180168063, 'auprc': 0.9763920407728737, 'loss_val': 0.1710597185997269, 'psi': 0.9672410671192333}
[S7] START round=45 head_norm_before_train=1.905894 cos_to_last_merge=0.9544 (last merge round=13)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6493494125565253, 'auprc': 0.8160630366957007, 'loss_val': 0.4626743315686658, 'psi': 0.7160348622121955}-{'f1_val': 0.8291223577699107, 'auprc': 0.9740359896707876, 'loss_val': 0.2665857728096547, 'psi': 0.8870878105302615}
[S8] START round=45 head_norm_before_train=1.769048 cos_to_last_merge=0.9973 (last merge round=39)
[S8] round=45 local utility u=0.005069 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9884432660131935, 'loss_val': 0.053799278623035095, 'psi': 0.9908126626929559}-{'f1_val': 0.992392260479464, 'auprc': 0.985888193420611, 'loss_val': 0.05627161545892794, 'psi': 0.9897906336559228}
[S9] START round=45 head_norm_before_train=1.949669 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=45 local utility u=0.009034 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9954345031980384, 'loss_val': 0.025243196144670334, 'psi': 0.9959937418708216}-{'f1_val': 0.9938671257720713, 'auprc': 0.9973334552371168, 'loss_val': 0.03401220065218001, 'psi': 0.9952536575580895}
[S10] START round=45 head_norm_before_train=2.057679 cos_to_last_merge=0.9849 (last merge round=24)
[S10] round=45 local utility u=0.000212 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955757477429479, 'loss_val': 0.027001130122514046, 'psi': 0.9954241714354173}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955091011466972, 'loss_val': 0.0272259544599762, 'psi': 0.995397512796917}
[S11] START round=45 head_norm_before_train=1.886495 cos_to_last_merge=0.8182 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=45 local utility u=0.000476 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981764611658955, 'loss_val': 0.0223628526026847, 'psi': 0.997065964279426}-{'f1_val': 0.9963256330217796, 'auprc': 0.998246048670752, 'loss_val': 0.023524289621688118, 'psi': 0.9970937992813685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=45 head_norm_before_train=1.780792 (no previous merge yet)
[S13] round=45 local utility u=0.228945 metrics={'f1_val': 0.6614185553200003, 'auprc': 0.756021513200362, 'loss_val': 0.9244536804036569, 'psi': 0.6992597384721451}-{'f1_val': 0.6329806111550133, 'auprc': 0.6689397722290741, 'loss_val': 0.9504707955018892, 'psi': 0.6473642755846376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=45 head_norm_before_train=1.766113 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.004032 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9979800679077202, 'loss_val': 0.029238500666401414, 'psi': 0.9980307919046203}-{'f1_val': 0.9972338922372435, 'auprc': 0.9969800358199304, 'loss_val': 0.029318119145935656, 'psi': 0.9971323496703183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9981 head_norm=1.780564
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.053891e-01
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9981 head_norm=1.758669 delta_norm=0.105389
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=45 head_norm_before_train=1.635176 cos_to_last_merge=0.8899 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8869281656002779, 'auprc': 0.984428940783335, 'loss_val': 0.254606052547582, 'psi': 0.9259284756735008}-{'f1_val': 0.9548659902819004, 'auprc': 0.9913960996951496, 'loss_val': 0.0813430167840799, 'psi': 0.9694780340472002}
[S16] START round=45 head_norm_before_train=2.088442 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8590106592711183, 'auprc': 0.9801653439691658, 'loss_val': 0.8270993487558792, 'psi': 0.9074725331503373}-{'f1_val': 0.9923964772584256, 'auprc': 0.992143163311212, 'loss_val': 0.03187602816740566, 'psi': 0.9922951516795402}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.690458 cos_to_last_merge=0.7981 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=45 local utility u=0.538927 metrics={'f1_val': 0.7618357244600631, 'auprc': 0.9392200539092801, 'loss_val': 0.5265573731845445, 'psi': 0.8327894562397499}-{'f1_val': 0.6793072442134706, 'auprc': 0.8858109851212972, 'loss_val': 0.9490123791026348, 'psi': 0.7619087405766012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] ⇄ pheromone p=0.037 → S9@127.0.0.1:57010
[S15] ⇄ pheromone p=0.223 → S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:57005
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=45 metric=0.9289 head_norm=1.941325
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.261888e-02
[S4] stored merged vector for next round verification (round=45)
[S4] DEBUG after merge:  round=45 metric=0.9289 head_norm=1.944359 delta_norm=0.012619
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.013 → S2@127.0.0.1:57002
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9997
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9991
[S8] ⇄ pheromone p=0.009 → S6@127.0.0.1:57007
[S5] ⇄ pheromone p=0.078 → S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S7] ⇄ pheromone p=0.241 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.091 → S4@127.0.0.1:57004
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.8251 head_norm=1.746586
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.216092e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.8251 head_norm=1.765863 delta_norm=0.042161
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.405 → S14@127.0.0.1:57014
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S10
[S2] cosine check vs S10: cos=-0.0478
[S2] DROPPED delta from S10 (cos=-0.0478 < 0.0)
[S10] ⇄ pheromone p=0.001 → S2@127.0.0.1:57002
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=0.9997
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9964 head_norm=1.963873
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.510636e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9964 head_norm=1.960636 delta_norm=0.025106
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.006 → S5@127.0.0.1:57005
[S2] START round=46 head_norm_before_train=1.954823 cos_to_last_merge=0.9999 (last merge round=43)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6426084281147055, 'auprc': 0.7035343129547074, 'loss_val': 0.9590155045060439, 'psi': 0.6669787820507063}-{'f1_val': 0.6636030318815066, 'auprc': 0.7109753910692924, 'loss_val': 0.8472473548944525, 'psi': 0.682551975556621}
[S3] START round=46 head_norm_before_train=1.899573 cos_to_last_merge=0.8574 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.857
[S3] round=46 local utility u=0.776518 metrics={'f1_val': 0.9840442720458686, 'auprc': 0.9991970908650987, 'loss_val': 0.042191036326114796, 'psi': 0.9901053995735607}-{'f1_val': 0.8195175801696197, 'auprc': 0.9328721932082645, 'loss_val': 0.40909269995283376, 'psi': 0.8648594253850777}
[S4] START round=46 head_norm_before_train=1.944359 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=46 local utility u=0.072715 metrics={'f1_val': 0.934653952791346, 'auprc': 0.9513780376106147, 'loss_val': 0.3458845661316131, 'psi': 0.9413435867190534}-{'f1_val': 0.9288715188325277, 'auprc': 0.9176122625728624, 'loss_val': 0.35532290552554135, 'psi': 0.9243678163286616}
[S5] START round=46 head_norm_before_train=1.957715 cos_to_last_merge=0.9998 (last merge round=43)
[S5] round=46 local utility u=0.002412 metrics={'f1_val': 0.9967759625455614, 'auprc': 0.9992982570552893, 'loss_val': 0.04221102151146457, 'psi': 0.9977848803494526}-{'f1_val': 0.9964083724129549, 'auprc': 0.9987498135630853, 'loss_val': 0.043183524419098875, 'psi': 0.9973449488730071}
[S6] START round=46 head_norm_before_train=1.765863 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.423470 metrics={'f1_val': 0.9255002965675412, 'auprc': 0.9763016819821212, 'loss_val': 0.20491217380344715, 'psi': 0.9458208507333732}-{'f1_val': 0.8250788830898357, 'auprc': 0.964484996701364, 'loss_val': 0.4138745358291548, 'psi': 0.880841328534447}
[S7] START round=46 head_norm_before_train=1.916951 cos_to_last_merge=0.9532 (last merge round=13)
[S7] round=46 local utility u=0.298532 metrics={'f1_val': 0.6864719369241635, 'auprc': 0.9059043035143658, 'loss_val': 0.3578696699382967, 'psi': 0.7742448835602445}-{'f1_val': 0.6493494125565253, 'auprc': 0.8160630366957007, 'loss_val': 0.4626743315686658, 'psi': 0.7160348622121955}
[S8] START round=46 head_norm_before_train=1.785927 cos_to_last_merge=0.9969 (last merge round=39)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9883631334862164, 'auprc': 0.99831416520209, 'loss_val': 0.059289444555782535, 'psi': 0.9923435461725658}-{'f1_val': 0.992392260479464, 'auprc': 0.9884432660131935, 'loss_val': 0.053799278623035095, 'psi': 0.9908126626929559}
[S9] START round=46 head_norm_before_train=1.960636 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.002395 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9980616590704371, 'loss_val': 0.025999810406919156, 'psi': 0.9968111641457131}-{'f1_val': 0.9963665676526772, 'auprc': 0.9954345031980384, 'loss_val': 0.025243196144670334, 'psi': 0.9959937418708216}
[S10] START round=46 head_norm_before_train=2.067682 cos_to_last_merge=0.9843 (last merge round=24)
[S10] round=46 local utility u=0.000347 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.995742820383247, 'loss_val': 0.026809116664912674, 'psi': 0.9954910004915369}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955757477429479, 'loss_val': 0.027001130122514046, 'psi': 0.9954241714354173}
[S11] START round=46 head_norm_before_train=1.895193 cos_to_last_merge=0.8179 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=46 local utility u=0.000449 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.998236133824719, 'loss_val': 0.02164451803492058, 'psi': 0.9970898333429554}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981764611658955, 'loss_val': 0.0223628526026847, 'psi': 0.997065964279426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=46 head_norm_before_train=1.781094 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6493218606186925, 'auprc': 0.7549439298475079, 'loss_val': 0.8945191386603446, 'psi': 0.6915706883102186}-{'f1_val': 0.6614185553200003, 'auprc': 0.756021513200362, 'loss_val': 0.9244536804036569, 'psi': 0.6992597384721451}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.758669 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9990403163384695, 'loss_val': 0.03056972685988197, 'psi': 0.9982084322249614}-{'f1_val': 0.9980646079025537, 'auprc': 0.9979800679077202, 'loss_val': 0.029238500666401414, 'psi': 0.9980307919046203}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.646919 cos_to_last_merge=0.8884 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8828813757392855, 'auprc': 0.9824491057254854, 'loss_val': 0.26099206639053774, 'psi': 0.9227084677337654}-{'f1_val': 0.8869281656002779, 'auprc': 0.984428940783335, 'loss_val': 0.254606052547582, 'psi': 0.9259284756735008}
[S16] START round=46 head_norm_before_train=2.094806 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8565771587557756, 'auprc': 0.9904531641507472, 'loss_val': 0.8726512375854701, 'psi': 0.9101275609137642}-{'f1_val': 0.8590106592711183, 'auprc': 0.9801653439691658, 'loss_val': 0.8270993487558792, 'psi': 0.9074725331503373}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.704401 cos_to_last_merge=0.7973 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7064990783447969, 'auprc': 0.896256371918909, 'loss_val': 0.788067669398938, 'psi': 0.7824019957744417}-{'f1_val': 0.7618357244600631, 'auprc': 0.9392200539092801, 'loss_val': 0.5265573731845445, 'psi': 0.8327894562397499}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:57014
[S10] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1794) from S10
[S2] cosine check vs S10: cos=-0.0481
[S2] DROPPED delta from S10 (cos=-0.0481 < 0.0)
[S7] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1808) from S7
[S15] cosine check vs S7: cos=-0.1047
[S15] DROPPED delta from S7 (cos=-0.1047 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S6
[S14] cosine check vs S6: cos=0.9969
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.6426 head_norm=1.963680
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.994465e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.6426 head_norm=1.954718 delta_norm=0.019945
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=0.9998
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.9968 head_norm=1.973955
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.460726e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.9968 head_norm=1.972003 delta_norm=0.024607
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.954718 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6315854364291791, 'auprc': 0.6842551502068601, 'loss_val': 0.9984510964096793, 'psi': 0.6526533219402515}-{'f1_val': 0.6426084281147055, 'auprc': 0.7035343129547074, 'loss_val': 0.9590155045060439, 'psi': 0.6669787820507063}
[S3] START round=47 head_norm_before_train=1.909949 cos_to_last_merge=0.8562 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.856
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8563468520983337, 'auprc': 0.9200321428074698, 'loss_val': 0.3936280600991113, 'psi': 0.8818209683819881}-{'f1_val': 0.9840442720458686, 'auprc': 0.9991970908650987, 'loss_val': 0.042191036326114796, 'psi': 0.9901053995735607}
[S4] START round=47 head_norm_before_train=1.945920 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=47 local utility u=0.004416 metrics={'f1_val': 0.9339542268150406, 'auprc': 0.951626946786889, 'loss_val': 0.33360056597023413, 'psi': 0.94102331480378}-{'f1_val': 0.934653952791346, 'auprc': 0.9513780376106147, 'loss_val': 0.3458845661316131, 'psi': 0.9413435867190534}
[S5] START round=47 head_norm_before_train=1.972003 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9931392479226226, 'loss_val': 0.056818317705276476, 'psi': 0.9950136902953053}-{'f1_val': 0.9967759625455614, 'auprc': 0.9992982570552893, 'loss_val': 0.04221102151146457, 'psi': 0.9977848803494526}
[S6] START round=47 head_norm_before_train=1.772053 cos_to_last_merge=0.9999 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7576025859893482, 'auprc': 0.7677880978234831, 'loss_val': 0.6491102384545103, 'psi': 0.7616767907230022}-{'f1_val': 0.9255002965675412, 'auprc': 0.9763016819821212, 'loss_val': 0.20491217380344715, 'psi': 0.9458208507333732}
[S7] START round=47 head_norm_before_train=1.925687 cos_to_last_merge=0.9522 (last merge round=13)
[S7] round=47 local utility u=0.277888 metrics={'f1_val': 0.7818165808809261, 'auprc': 0.9202396967047223, 'loss_val': 0.4171673217199708, 'psi': 0.8371858272104445}-{'f1_val': 0.6864719369241635, 'auprc': 0.9059043035143658, 'loss_val': 0.3578696699382967, 'psi': 0.7742448835602445}
[S8] START round=47 head_norm_before_train=1.802617 cos_to_last_merge=0.9963 (last merge round=39)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9854281434280745, 'loss_val': 0.051189739137777884, 'psi': 0.9899235818879517}-{'f1_val': 0.9883631334862164, 'auprc': 0.99831416520209, 'loss_val': 0.059289444555782535, 'psi': 0.9923435461725658}
[S9] START round=47 head_norm_before_train=1.976872 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=47 local utility u=0.000660 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9961150370710681, 'loss_val': 0.023828474154525204, 'psi': 0.9965313952750554}-{'f1_val': 0.9959775008625639, 'auprc': 0.9980616590704371, 'loss_val': 0.025999810406919156, 'psi': 0.9968111641457131}
[S10] START round=47 head_norm_before_train=2.077551 cos_to_last_merge=0.9838 (last merge round=24)
[S10] round=47 local utility u=0.000651 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960620452794515, 'loss_val': 0.026465082698272864, 'psi': 0.9956186904500188}-{'f1_val': 0.9953231205637304, 'auprc': 0.995742820383247, 'loss_val': 0.026809116664912674, 'psi': 0.9954910004915369}
[S11] START round=47 head_norm_before_train=1.904807 cos_to_last_merge=0.8177 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9980981931431417, 'loss_val': 0.022200030474067472, 'psi': 0.9970471324073641}-{'f1_val': 0.9963256330217796, 'auprc': 0.998236133824719, 'loss_val': 0.02164451803492058, 'psi': 0.9970898333429554}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.784219 (no previous merge yet)
[S13] round=47 local utility u=0.046714 metrics={'f1_val': 0.6682154384749447, 'auprc': 0.7581175394874636, 'loss_val': 0.9239739285202322, 'psi': 0.7041762788799523}-{'f1_val': 0.6493218606186925, 'auprc': 0.7549439298475079, 'loss_val': 0.8945191386603446, 'psi': 0.6915706883102186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=47 head_norm_before_train=1.779647 cos_to_last_merge=0.9999 (last merge round=45)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9933038488375803, 'auprc': 0.9986689991495363, 'loss_val': 0.03966694893422086, 'psi': 0.9954499089623627}-{'f1_val': 0.9976538428159559, 'auprc': 0.9990403163384695, 'loss_val': 0.03056972685988197, 'psi': 0.9982084322249614}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9933 head_norm=1.803230
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.841101e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9933 head_norm=1.785989 delta_norm=0.078411
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=47 head_norm_before_train=1.658385 cos_to_last_merge=0.8871 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=47 local utility u=0.395759 metrics={'f1_val': 0.976748239195646, 'auprc': 0.9911205032050382, 'loss_val': 0.05869028805466325, 'psi': 0.9824971447994029}-{'f1_val': 0.8828813757392855, 'auprc': 0.9824491057254854, 'loss_val': 0.26099206639053774, 'psi': 0.9227084677337654}
[S16] START round=47 head_norm_before_train=2.102197 (no previous merge yet)
[S16] round=47 local utility u=0.563271 metrics={'f1_val': 0.9402504147924878, 'auprc': 0.9960177626612452, 'loss_val': 0.26484209250077984, 'psi': 0.9625573539399908}-{'f1_val': 0.8565771587557756, 'auprc': 0.9904531641507472, 'loss_val': 0.8726512375854701, 'psi': 0.9101275609137642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=47 head_norm_before_train=1.718883 cos_to_last_merge=0.7963 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6748695749012992, 'auprc': 0.8653747064261869, 'loss_val': 1.1130654486103586, 'psi': 0.7510716275112542}-{'f1_val': 0.7064990783447969, 'auprc': 0.896256371918909, 'loss_val': 0.788067669398938, 'psi': 0.7824019957744417}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:57002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S10
[S2] cosine check vs S10: cos=-0.0488
[S2] DROPPED delta from S10 (cos=-0.0488 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=-0.1045
[S7] DROPPED delta from S15 (cos=-0.1045 < 0.0)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=-0.1045
[S15] DROPPED delta from S7 (cos=-0.1045 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.6316 head_norm=1.964476
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.731833e-02
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.6316 head_norm=1.956573 delta_norm=0.017318
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.9968 head_norm=1.990929
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.795877e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.9968 head_norm=1.982263 delta_norm=0.027959
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.956573 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6256256204423583, 'auprc': 0.6721838453374048, 'loss_val': 1.0316138906512637, 'psi': 0.6442489104003769}-{'f1_val': 0.6315854364291791, 'auprc': 0.6842551502068601, 'loss_val': 0.9984510964096793, 'psi': 0.6526533219402515}
[S3] START round=48 head_norm_before_train=1.918474 cos_to_last_merge=0.8551 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=48 local utility u=0.717428 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9968101227605297, 'loss_val': 0.03405908228503609, 'psi': 0.9970274670486294}-{'f1_val': 0.8563468520983337, 'auprc': 0.9200321428074698, 'loss_val': 0.3936280600991113, 'psi': 0.8818209683819881}
[S4] START round=48 head_norm_before_train=1.948792 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=48 local utility u=0.089535 metrics={'f1_val': 0.9528695905081429, 'auprc': 0.9595854553160177, 'loss_val': 0.2918985263438062, 'psi': 0.9555559364312928}-{'f1_val': 0.9339542268150406, 'auprc': 0.951626946786889, 'loss_val': 0.33360056597023413, 'psi': 0.94102331480378}
[S5] START round=48 head_norm_before_train=1.992359 cos_to_last_merge=0.9999 (last merge round=46)
[S5] round=48 local utility u=0.011710 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9952604368186723, 'loss_val': 0.039761648389036626, 'psi': 0.9958621658537251}-{'f1_val': 0.9962633185437604, 'auprc': 0.9931392479226226, 'loss_val': 0.056818317705276476, 'psi': 0.9950136902953053}
[S6] START round=48 head_norm_before_train=1.779859 cos_to_last_merge=0.9996 (last merge round=45)
[S6] round=48 local utility u=0.984161 metrics={'f1_val': 0.9242403659123202, 'auprc': 0.9632561285430614, 'loss_val': 0.2670187290919213, 'psi': 0.9398466709646167}-{'f1_val': 0.7576025859893482, 'auprc': 0.7677880978234831, 'loss_val': 0.6491102384545103, 'psi': 0.7616767907230022}
[S7] START round=48 head_norm_before_train=1.933633 cos_to_last_merge=0.9512 (last merge round=13)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5866818596791626, 'auprc': 0.8200247414819253, 'loss_val': 0.6630830008906037, 'psi': 0.6800190124002676}-{'f1_val': 0.7818165808809261, 'auprc': 0.9202396967047223, 'loss_val': 0.4171673217199708, 'psi': 0.8371858272104445}
[S8] START round=48 head_norm_before_train=1.817246 cos_to_last_merge=0.9957 (last merge round=39)
[S8] round=48 local utility u=0.001531 metrics={'f1_val': 0.9931069890632681, 'auprc': 0.9854769920945499, 'loss_val': 0.04939376173457354, 'psi': 0.9900549902757808}-{'f1_val': 0.9929205408612032, 'auprc': 0.9854281434280745, 'loss_val': 0.051189739137777884, 'psi': 0.9899235818879517}
[S9] START round=48 head_norm_before_train=1.982263 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9954101903245987, 'loss_val': 0.023715657333259366, 'psi': 0.9962494565764677}-{'f1_val': 0.996808967411047, 'auprc': 0.9961150370710681, 'loss_val': 0.023828474154525204, 'psi': 0.9965313952750554}
[S10] START round=48 head_norm_before_train=2.087302 cos_to_last_merge=0.9833 (last merge round=24)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959625263498224, 'loss_val': 0.026462291917531928, 'psi': 0.9955788828781671}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960620452794515, 'loss_val': 0.026465082698272864, 'psi': 0.9956186904500188}
[S11] START round=48 head_norm_before_train=1.910860 cos_to_last_merge=0.8168 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.817
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9944212132243192, 'auprc': 0.9964910981426096, 'loss_val': 0.031395387174167594, 'psi': 0.9952491671916353}-{'f1_val': 0.9963464252501789, 'auprc': 0.9980981931431417, 'loss_val': 0.022200030474067472, 'psi': 0.9970471324073641}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.784822 (no previous merge yet)
[S13] round=48 local utility u=0.207693 metrics={'f1_val': 0.7311478611605031, 'auprc': 0.7511406271673651, 'loss_val': 0.8652523639757285, 'psi': 0.739144967563248}-{'f1_val': 0.6682154384749447, 'auprc': 0.7581175394874636, 'loss_val': 0.9239739285202322, 'psi': 0.7041762788799523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=48 head_norm_before_train=1.785989 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9332482679592213, 'auprc': 0.9986637319576854, 'loss_val': 0.11853874713582616, 'psi': 0.959414453558607}-{'f1_val': 0.9933038488375803, 'auprc': 0.9986689991495363, 'loss_val': 0.03966694893422086, 'psi': 0.9954499089623627}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.667090 cos_to_last_merge=0.8860 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.886
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9629051288085377, 'auprc': 0.9966652890383029, 'loss_val': 0.07746317353643735, 'psi': 0.9764091929004438}-{'f1_val': 0.976748239195646, 'auprc': 0.9911205032050382, 'loss_val': 0.05869028805466325, 'psi': 0.9824971447994029}
[S16] START round=48 head_norm_before_train=2.109944 (no previous merge yet)
[S16] round=48 local utility u=0.267220 metrics={'f1_val': 0.9923664209103679, 'auprc': 0.9948383632314346, 'loss_val': 0.03956090061446726, 'psi': 0.9933551978387944}-{'f1_val': 0.9402504147924878, 'auprc': 0.9960177626612452, 'loss_val': 0.26484209250077984, 'psi': 0.9625573539399908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=48 head_norm_before_train=1.730319 cos_to_last_merge=0.7955 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=48 local utility u=0.920065 metrics={'f1_val': 0.8258039138727319, 'auprc': 0.9671675337569116, 'loss_val': 0.48392004577015574, 'psi': 0.8823493618264038}-{'f1_val': 0.6748695749012992, 'auprc': 0.8653747064261869, 'loss_val': 1.1130654486103586, 'psi': 0.7510716275112542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:57010
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:57014
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1790 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9978
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=0.9996
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.9963 head_norm=2.017521
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.597797e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.9963 head_norm=2.003946 delta_norm=0.035978
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S6
[S14] cosine check vs S6: cos=0.9981
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.6256 head_norm=1.965469
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.668522e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.6256 head_norm=1.958781 delta_norm=0.016685
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=48 metric=0.9968 head_norm=1.997831
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.908930e-02
[S9] stored merged vector for next round verification (round=48)
[S9] DEBUG after merge:  round=48 metric=0.9968 head_norm=2.007489 delta_norm=0.029089
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.9242 head_norm=1.790017
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.312352e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.9313 head_norm=1.808887 delta_norm=0.063124
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.958781 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.053493 metrics={'f1_val': 0.6356381635463112, 'auprc': 0.6744401361422943, 'loss_val': 0.9914719023937748, 'psi': 0.6511589525847044}-{'f1_val': 0.6256256204423583, 'auprc': 0.6721838453374048, 'loss_val': 1.0316138906512637, 'psi': 0.6442489104003769}
[S3] START round=49 head_norm_before_train=1.922786 cos_to_last_merge=0.8547 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9608899096938723, 'auprc': 0.9932246157762503, 'loss_val': 0.13833596763829664, 'psi': 0.9738237921268235}-{'f1_val': 0.9971723632406959, 'auprc': 0.9968101227605297, 'loss_val': 0.03405908228503609, 'psi': 0.9970274670486294}
[S4] START round=49 head_norm_before_train=1.952212 cos_to_last_merge=0.9999 (last merge round=45)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9347477699915108, 'auprc': 0.9506355996382712, 'loss_val': 0.32279394493415536, 'psi': 0.941102901850215}-{'f1_val': 0.9528695905081429, 'auprc': 0.9595854553160177, 'loss_val': 0.2918985263438062, 'psi': 0.9555559364312928}
[S5] START round=49 head_norm_before_train=2.003946 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.010110 metrics={'f1_val': 0.9964083724129549, 'auprc': 0.9993410801195162, 'loss_val': 0.03265315716916136, 'psi': 0.9975814554955794}-{'f1_val': 0.9962633185437604, 'auprc': 0.9952604368186723, 'loss_val': 0.039761648389036626, 'psi': 0.9958621658537251}
[S6] START round=49 head_norm_before_train=1.808887 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6702227009583857, 'auprc': 0.7860495212963257, 'loss_val': 0.7457372122622101, 'psi': 0.7165534290935617}-{'f1_val': 0.9242403659123202, 'auprc': 0.9632561285430614, 'loss_val': 0.2670187290919213, 'psi': 0.9398466709646167}
[S7] START round=49 head_norm_before_train=1.941388 cos_to_last_merge=0.9502 (last merge round=13)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.9491943560738206, 'auprc': 0.9886215317374263, 'loss_val': 0.13836161607536415, 'psi': 0.964965226339263}-{'f1_val': 0.5866818596791626, 'auprc': 0.8200247414819253, 'loss_val': 0.6630830008906037, 'psi': 0.6800190124002676}
[S8] START round=49 head_norm_before_train=1.829740 cos_to_last_merge=0.9952 (last merge round=39)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9819183889919959, 'auprc': 0.9988053321214874, 'loss_val': 0.07562351292358346, 'psi': 0.9886731662437924}-{'f1_val': 0.9931069890632681, 'auprc': 0.9854769920945499, 'loss_val': 0.04939376173457354, 'psi': 0.9900549902757808}
[S9] START round=49 head_norm_before_train=2.007489 cos_to_last_merge=1.0000 (last merge round=48)
[S9] round=49 local utility u=0.003421 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.998313343594603, 'loss_val': 0.02310185131706985, 'psi': 0.9971625429414626}-{'f1_val': 0.996808967411047, 'auprc': 0.9954101903245987, 'loss_val': 0.023715657333259366, 'psi': 0.9962494565764677}
[S10] START round=49 head_norm_before_train=2.096822 cos_to_last_merge=0.9827 (last merge round=24)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.994322696008851, 'loss_val': 0.026481136095340016, 'psi': 0.9949229507417786}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959625263498224, 'loss_val': 0.026462291917531928, 'psi': 0.9955788828781671}
[S11] START round=49 head_norm_before_train=1.915958 cos_to_last_merge=0.8162 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.816
[S11] round=49 local utility u=0.012990 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981758890503719, 'loss_val': 0.021897041959628667, 'psi': 0.9970657354332165}-{'f1_val': 0.9944212132243192, 'auprc': 0.9964910981426096, 'loss_val': 0.031395387174167594, 'psi': 0.9952491671916353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=49 head_norm_before_train=1.788035 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.633704371904052, 'auprc': 0.6993009183146104, 'loss_val': 0.9695306110305346, 'psi': 0.6599429904682754}-{'f1_val': 0.7311478611605031, 'auprc': 0.7511406271673651, 'loss_val': 0.8652523639757285, 'psi': 0.739144967563248}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.806866 cos_to_last_merge=0.9999 (last merge round=47)
[S14] round=49 local utility u=0.229325 metrics={'f1_val': 0.9951961613162258, 'auprc': 0.9988856038359608, 'loss_val': 0.032242534647520735, 'psi': 0.9966719383241198}-{'f1_val': 0.9332482679592213, 'auprc': 0.9986637319576854, 'loss_val': 0.11853874713582616, 'psi': 0.959414453558607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9952 head_norm=1.829148
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.585445e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9952 head_norm=1.808490 delta_norm=0.065854
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=49 head_norm_before_train=1.674382 cos_to_last_merge=0.8850 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=49 local utility u=0.123833 metrics={'f1_val': 0.9960957151763188, 'auprc': 0.9974360292931497, 'loss_val': 0.031252907264683036, 'psi': 0.9966318408230511}-{'f1_val': 0.9629051288085377, 'auprc': 0.9966652890383029, 'loss_val': 0.07746317353643735, 'psi': 0.9764091929004438}
[S16] START round=49 head_norm_before_train=2.112828 (no previous merge yet)
[S16] round=49 local utility u=0.000309 metrics={'f1_val': 0.9928076081826916, 'auprc': 0.9917151877058873, 'loss_val': 0.03222126103626533, 'psi': 0.9923706399919698}-{'f1_val': 0.9923664209103679, 'auprc': 0.9948383632314346, 'loss_val': 0.03956090061446726, 'psi': 0.9933551978387944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=49 head_norm_before_train=1.739300 cos_to_last_merge=0.7947 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=49 local utility u=0.086729 metrics={'f1_val': 0.8452532170702635, 'auprc': 0.9737634176635791, 'loss_val': 0.4469458070031311, 'psi': 0.8966572973075897}-{'f1_val': 0.8258039138727319, 'auprc': 0.9671675337569116, 'loss_val': 0.48392004577015574, 'psi': 0.8823493618264038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S3]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:57005
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=-0.1044
[S7] DROPPED delta from S15 (cos=-0.1044 < 0.0)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S9
[S5] cosine check vs S9: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=-0.1044
[S15] DROPPED delta from S7 (cos=-0.1044 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.9964 head_norm=2.021973
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.378154e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.9964 head_norm=2.026031 delta_norm=0.013782
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.9998
[S2] START round=50 head_norm_before_train=1.969181 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=50 local utility u=0.030709 metrics={'f1_val': 0.6417933962064306, 'auprc': 0.6844256663054656, 'loss_val': 0.996941153682396, 'psi': 0.6588463042460446}-{'f1_val': 0.6356381635463112, 'auprc': 0.6744401361422943, 'loss_val': 0.9914719023937748, 'psi': 0.6511589525847044}
[S3] START round=50 head_norm_before_train=1.926384 cos_to_last_merge=0.8545 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=50 local utility u=0.175576 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9991802684162854, 'loss_val': 0.022571934870451286, 'psi': 0.997958189455957}-{'f1_val': 0.9608899096938723, 'auprc': 0.9932246157762503, 'loss_val': 0.13833596763829664, 'psi': 0.9738237921268235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=50 head_norm_before_train=1.955463 cos_to_last_merge=0.9999 (last merge round=45)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9299518139307816, 'auprc': 0.9028815303600378, 'loss_val': 0.37502505737477365, 'psi': 0.9191237005024842}-{'f1_val': 0.9347477699915108, 'auprc': 0.9506355996382712, 'loss_val': 0.32279394493415536, 'psi': 0.941102901850215}
[S5] START round=50 head_norm_before_train=2.030173 cos_to_last_merge=0.9999 (last merge round=48)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9956256620489609, 'loss_val': 0.031251089804011235, 'psi': 0.9960082559458405}-{'f1_val': 0.9964083724129549, 'auprc': 0.9993410801195162, 'loss_val': 0.03265315716916136, 'psi': 0.9975814554955794}
[S6] START round=50 head_norm_before_train=1.821236 cos_to_last_merge=0.9999 (last merge round=48)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8464317911076082, 'auprc': 0.9596600389795925, 'loss_val': 0.24219396579810837, 'psi': 0.891723090256402}-{'f1_val': 0.6702227009583857, 'auprc': 0.7860495212963257, 'loss_val': 0.7457372122622101, 'psi': 0.7165534290935617}
[S7] START round=50 head_norm_before_train=1.948164 cos_to_last_merge=0.9496 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.6369991112611392, 'auprc': 0.8058053852718066, 'loss_val': 0.5230651635036668, 'psi': 0.7045216208654062}-{'f1_val': 0.9491943560738206, 'auprc': 0.9886215317374263, 'loss_val': 0.13836161607536415, 'psi': 0.964965226339263}
[S8] START round=50 head_norm_before_train=1.844411 cos_to_last_merge=0.9945 (last merge round=39)
[S8] round=50 local utility u=0.033247 metrics={'f1_val': 0.9924011572900254, 'auprc': 0.9900977798245728, 'loss_val': 0.04590271895564489, 'psi': 0.9914798063038444}-{'f1_val': 0.9819183889919959, 'auprc': 0.9988053321214874, 'loss_val': 0.07562351292358346, 'psi': 0.9886731662437924}
[S9] START round=50 head_norm_before_train=2.026031 cos_to_last_merge=1.0000 (last merge round=49)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.992223179014058, 'auprc': 0.9976011498036357, 'loss_val': 0.031070716736450628, 'psi': 0.994374367329889}-{'f1_val': 0.9963953425060355, 'auprc': 0.998313343594603, 'loss_val': 0.02310185131706985, 'psi': 0.9971625429414626}
[S10] START round=50 head_norm_before_train=2.101821 cos_to_last_merge=0.9820 (last merge round=24)
[S10] round=50 local utility u=0.002338 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.995789718896642, 'loss_val': 0.026205701230830585, 'psi': 0.9955097598968949}-{'f1_val': 0.9953231205637304, 'auprc': 0.994322696008851, 'loss_val': 0.026481136095340016, 'psi': 0.9949229507417786}
[S11] START round=50 head_norm_before_train=1.922375 cos_to_last_merge=0.8160 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.816
[S11] round=50 local utility u=0.000213 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983138674904691, 'loss_val': 0.021884044489215746, 'psi': 0.9971209268092553}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981758890503719, 'loss_val': 0.021897041959628667, 'psi': 0.9970657354332165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=50 head_norm_before_train=1.794944 (no previous merge yet)
[S13] round=50 local utility u=0.226791 metrics={'f1_val': 0.6868785982904649, 'auprc': 0.7470791064304911, 'loss_val': 0.9783285484350296, 'psi': 0.7109588015464754}-{'f1_val': 0.633704371904052, 'auprc': 0.6993009183146104, 'loss_val': 0.9695306110305346, 'psi': 0.6599429904682754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=50 head_norm_before_train=1.808490 cos_to_last_merge=1.0000 (last merge round=49)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9388383321172811, 'auprc': 0.9986202953941954, 'loss_val': 0.08969789801859542, 'psi': 0.9627511174280468}-{'f1_val': 0.9951961613162258, 'auprc': 0.9988856038359608, 'loss_val': 0.032242534647520735, 'psi': 0.9966719383241198}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.681563 cos_to_last_merge=0.8842 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9949359732491352, 'loss_val': 0.2259947609130102, 'psi': 0.9388459353007778}-{'f1_val': 0.9960957151763188, 'auprc': 0.9974360292931497, 'loss_val': 0.031252907264683036, 'psi': 0.9966318408230511}
[S16] START round=50 head_norm_before_train=2.115620 (no previous merge yet)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9928076081826916, 'auprc': 0.9909696409081848, 'loss_val': 0.03200307419089476, 'psi': 0.9920724212728889}-{'f1_val': 0.9928076081826916, 'auprc': 0.9917151877058873, 'loss_val': 0.03222126103626533, 'psi': 0.9923706399919698}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.750685 cos_to_last_merge=0.7938 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6711374837930272, 'auprc': 0.8335544994789404, 'loss_val': 1.1483528374986445, 'psi': 0.7361042900673925}-{'f1_val': 0.8452532170702635, 'auprc': 0.9737634176635791, 'loss_val': 0.4469458070031311, 'psi': 0.8966572973075897}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:57014
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:57004
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] ⇄ pheromone p=0.134 → S7@127.0.0.1:57008
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=50 metric=0.9963 head_norm=2.052523
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.759711e-02
[S5] stored merged vector for next round verification (round=50)
[S5] DEBUG after merge:  round=50 metric=0.9963 head_norm=2.037118 delta_norm=0.027597
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.029 → S9@127.0.0.1:57010
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=50 metric=0.9300 head_norm=1.964784
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.922521e-02
[S4] stored merged vector for next round verification (round=50)
[S4] DEBUG after merge:  round=50 metric=0.9300 head_norm=1.966890 delta_norm=0.019225
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.022 → S2@127.0.0.1:57002
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9984
[S2] RECEIVED delta(kind=head bytes=1795) from S10
[S2] cosine check vs S10: cos=-0.0496
[S2] DROPPED delta from S10 (cos=-0.0496 < 0.0)
[S8] ⇄ pheromone p=0.010 → S6@127.0.0.1:57007
[S2] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.001 → S2@127.0.0.1:57002
[S14] RECEIVED delta(kind=head bytes=1798) from S6
[S14] cosine check vs S6: cos=0.9985
[S4] RECEIVED delta(kind=head bytes=1791) from S2
[S4] cosine check vs S2: cos=0.9999
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.292 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.045 → S4@127.0.0.1:57004
[S9] ⇄ pheromone p=0.003 → S3@127.0.0.1:57003
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=50 metric=0.8464 head_norm=1.836851
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.330431e-02
[S6] stored merged vector for next round verification (round=50)
[S6] DEBUG after merge:  round=50 metric=0.8532 head_norm=1.846053 delta_norm=0.053304
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.493 → S14@127.0.0.1:57014
[S2] START round=51 head_norm_before_train=1.979411 cos_to_last_merge=0.9998 (last merge round=48)
[S2] round=51 local utility u=0.119743 metrics={'f1_val': 0.656568864849997, 'auprc': 0.7013288506443713, 'loss_val': 0.8968170272607842, 'psi': 0.6744728591677467}-{'f1_val': 0.6417933962064306, 'auprc': 0.6844256663054656, 'loss_val': 0.996941153682396, 'psi': 0.6588463042460446}
[S3] START round=51 head_norm_before_train=1.934189 cos_to_last_merge=0.8539 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9119443918353545, 'auprc': 0.9854542494327982, 'loss_val': 0.21260330552180756, 'psi': 0.941348334874332}-{'f1_val': 0.9971434701490716, 'auprc': 0.9991802684162854, 'loss_val': 0.022571934870451286, 'psi': 0.997958189455957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.966890 cos_to_last_merge=1.0000 (last merge round=50)
[S4] round=51 local utility u=0.030745 metrics={'f1_val': 0.9305760881843391, 'auprc': 0.9198719552452319, 'loss_val': 0.3682526868356387, 'psi': 0.9262944350086962}-{'f1_val': 0.9299518139307816, 'auprc': 0.9028815303600378, 'loss_val': 0.37502505737477365, 'psi': 0.9191237005024842}
[S5] START round=51 head_norm_before_train=2.037118 cos_to_last_merge=1.0000 (last merge round=50)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.993180220389067, 'loss_val': 0.03146595572052668, 'psi': 0.9948091882923573}-{'f1_val': 0.9962633185437604, 'auprc': 0.9956256620489609, 'loss_val': 0.031251089804011235, 'psi': 0.9960082559458405}
[S6] START round=51 head_norm_before_train=1.846053 cos_to_last_merge=1.0000 (last merge round=50)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7626259472936874, 'auprc': 0.7957711523591264, 'loss_val': 0.6372265066225152, 'psi': 0.775884029319863}-{'f1_val': 0.8464317911076082, 'auprc': 0.9596600389795925, 'loss_val': 0.24219396579810837, 'psi': 0.891723090256402}
[S7] START round=51 head_norm_before_train=1.949685 cos_to_last_merge=0.9494 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6207444857992188, 'auprc': 0.8382005337778544, 'loss_val': 0.612567125021985, 'psi': 0.7077269049906731}-{'f1_val': 0.6369991112611392, 'auprc': 0.8058053852718066, 'loss_val': 0.5230651635036668, 'psi': 0.7045216208654062}
[S8] START round=51 head_norm_before_train=1.856740 cos_to_last_merge=0.9939 (last merge round=39)
[S8] round=51 local utility u=0.004802 metrics={'f1_val': 0.9915983655414597, 'auprc': 0.9942933427559891, 'loss_val': 0.04406894798287045, 'psi': 0.9926763564272715}-{'f1_val': 0.9924011572900254, 'auprc': 0.9900977798245728, 'loss_val': 0.04590271895564489, 'psi': 0.9914798063038444}
[S9] START round=51 head_norm_before_train=2.039127 cos_to_last_merge=1.0000 (last merge round=49)
[S9] round=51 local utility u=0.016042 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9982121894914907, 'loss_val': 0.02334562023482898, 'psi': 0.9968713763141346}-{'f1_val': 0.992223179014058, 'auprc': 0.9976011498036357, 'loss_val': 0.031070716736450628, 'psi': 0.994374367329889}
[S10] START round=51 head_norm_before_train=2.106959 cos_to_last_merge=0.9814 (last merge round=24)
[S10] round=51 local utility u=0.000347 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959555194043233, 'loss_val': 0.026009342885291446, 'psi': 0.9955760800999676}-{'f1_val': 0.9953231205637304, 'auprc': 0.995789718896642, 'loss_val': 0.026205701230830585, 'psi': 0.9955097598968949}
[S11] START round=51 head_norm_before_train=1.927160 cos_to_last_merge=0.8156 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.816
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951424611079533, 'auprc': 0.9977401447676605, 'loss_val': 0.03044501380255435, 'psi': 0.9961815345718361}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983138674904691, 'loss_val': 0.021884044489215746, 'psi': 0.9971209268092553}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.800907 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6745618055521567, 'auprc': 0.7330875605929975, 'loss_val': 0.9370010948587235, 'psi': 0.697972107568493}-{'f1_val': 0.6868785982904649, 'auprc': 0.7470791064304911, 'loss_val': 0.9783285484350296, 'psi': 0.7109588015464754}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.828932 cos_to_last_merge=0.9999 (last merge round=49)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9311871311677031, 'auprc': 0.998624845774395, 'loss_val': 0.14217154024968548, 'psi': 0.95816221701038}-{'f1_val': 0.9388383321172811, 'auprc': 0.9986202953941954, 'loss_val': 0.08969789801859542, 'psi': 0.9627511174280468}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=51 metric=0.9312 head_norm=1.847100
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.790370e-02
[S14] stored merged vector for next round verification (round=51)
[S14] DEBUG after merge:  round=51 metric=0.9312 head_norm=1.841072 delta_norm=0.057904
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=51 head_norm_before_train=1.688544 cos_to_last_merge=0.8836 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9127071794085208, 'loss_val': 0.5408392687415623, 'psi': 0.7856330580651825}-{'f1_val': 0.9014525766685394, 'auprc': 0.9949359732491352, 'loss_val': 0.2259947609130102, 'psi': 0.9388459353007778}
[S16] START round=51 head_norm_before_train=2.120987 (no previous merge yet)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.9466846484827747, 'auprc': 0.9868484551048972, 'loss_val': 0.1321124004988918, 'psi': 0.9627501711316236}-{'f1_val': 0.9928076081826916, 'auprc': 0.9909696409081848, 'loss_val': 0.03200307419089476, 'psi': 0.9920724212728889}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.761677 cos_to_last_merge=0.7929 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6619180464177659, 'auprc': 0.8286614949415865, 'loss_val': 1.2527887945221379, 'psi': 0.7286154258272941}-{'f1_val': 0.6711374837930272, 'auprc': 0.8335544994789404, 'loss_val': 1.1483528374986445, 'psi': 0.7361042900673925}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[S8] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] cosine check vs S8: cos=0.9993
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9997
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=51 metric=0.9306 head_norm=1.977234
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.888472e-02
[S4] stored merged vector for next round verification (round=51)
[S4] DEBUG after merge:  round=51 metric=0.9306 head_norm=1.978232 delta_norm=0.018885
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.9500
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=51 metric=0.7626 head_norm=1.857601
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.483453e-02
[S6] stored merged vector for next round verification (round=51)
[S6] DEBUG after merge:  round=51 metric=0.7652 head_norm=1.861794 delta_norm=0.034835
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=51 metric=0.6566 head_norm=1.991071
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.709679e-02
[S2] stored merged vector for next round verification (round=51)
[S2] DEBUG after merge:  round=51 metric=0.6566 head_norm=1.983980 delta_norm=0.027097
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=52 head_norm_before_train=1.983980 cos_to_last_merge=1.0000 (last merge round=51)
[S2] round=52 local utility u=0.124028 metrics={'f1_val': 0.6790155552951735, 'auprc': 0.7088466960421825, 'loss_val': 0.8059955179284287, 'psi': 0.6909480115939771}-{'f1_val': 0.656568864849997, 'auprc': 0.7013288506443713, 'loss_val': 0.8968170272607842, 'psi': 0.6744728591677467}
[S3] START round=52 head_norm_before_train=1.940051 cos_to_last_merge=0.8534 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8869874088141523, 'auprc': 0.9971758216499049, 'loss_val': 0.19999555452626058, 'psi': 0.9310627739484533}-{'f1_val': 0.9119443918353545, 'auprc': 0.9854542494327982, 'loss_val': 0.21260330552180756, 'psi': 0.941348334874332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=52 metric=0.8870 head_norm=1.948263
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.208856e-01
[S3] stored merged vector for next round verification (round=52)
[S3] DEBUG after merge:  round=52 metric=0.9200 head_norm=1.974946 delta_norm=0.320886
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=52 head_norm_before_train=1.978232 cos_to_last_merge=1.0000 (last merge round=51)
[S4] round=52 local utility u=0.040231 metrics={'f1_val': 0.934051813435788, 'auprc': 0.9350078151172674, 'loss_val': 0.35405344372601544, 'psi': 0.9344342141083798}-{'f1_val': 0.9305760881843391, 'auprc': 0.9198719552452319, 'loss_val': 0.3682526868356387, 'psi': 0.9262944350086962}
[S5] START round=52 head_norm_before_train=2.054969 cos_to_last_merge=0.9999 (last merge round=50)
[S5] round=52 local utility u=0.002419 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.993222233716341, 'loss_val': 0.02896237985378822, 'psi': 0.9950468846127926}-{'f1_val': 0.995895166894551, 'auprc': 0.993180220389067, 'loss_val': 0.03146595572052668, 'psi': 0.9948091882923573}
[S6] START round=52 head_norm_before_train=1.861794 cos_to_last_merge=1.0000 (last merge round=51)
[S6] round=52 local utility u=0.088903 metrics={'f1_val': 0.7761448943840802, 'auprc': 0.8106127931058618, 'loss_val': 0.5850598757159302, 'psi': 0.7899320538727927}-{'f1_val': 0.7626259472936874, 'auprc': 0.7957711523591264, 'loss_val': 0.6372265066225152, 'psi': 0.775884029319863}
[S7] START round=52 head_norm_before_train=1.955098 cos_to_last_merge=0.9489 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6056456653669152, 'auprc': 0.8116040065534109, 'loss_val': 0.707950907530953, 'psi': 0.6880290018415135}-{'f1_val': 0.6207444857992188, 'auprc': 0.8382005337778544, 'loss_val': 0.612567125021985, 'psi': 0.7077269049906731}
[S8] START round=52 head_norm_before_train=1.866628 cos_to_last_merge=0.9935 (last merge round=39)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9862233172697478, 'auprc': 0.9988735148804978, 'loss_val': 0.05340947295485365, 'psi': 0.9912833963140477}-{'f1_val': 0.9915983655414597, 'auprc': 0.9942933427559891, 'loss_val': 0.04406894798287045, 'psi': 0.9926763564272715}
[S9] START round=52 head_norm_before_train=2.052080 cos_to_last_merge=0.9999 (last merge round=49)
[S9] round=52 local utility u=0.003093 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.998684906936229, 'loss_val': 0.02091194328323624, 'psi': 0.9972939033660979}-{'f1_val': 0.9959775008625639, 'auprc': 0.9982121894914907, 'loss_val': 0.02334562023482898, 'psi': 0.9968713763141346}
[S10] START round=52 head_norm_before_train=2.113770 cos_to_last_merge=0.9808 (last merge round=24)
[S10] round=52 local utility u=0.000032 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959391869820258, 'loss_val': 0.025896807148602104, 'psi': 0.9955695471310485}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959555194043233, 'loss_val': 0.026009342885291446, 'psi': 0.9955760800999676}
[S11] START round=52 head_norm_before_train=1.930390 cos_to_last_merge=0.8146 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.815
[S11] round=52 local utility u=0.008711 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9981278634434733, 'loss_val': 0.021410289119951516, 'psi': 0.9970590005274966}-{'f1_val': 0.9951424611079533, 'auprc': 0.9977401447676605, 'loss_val': 0.03044501380255435, 'psi': 0.9961815345718361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=52 head_norm_before_train=1.807939 (no previous merge yet)
[S13] round=52 local utility u=0.535898 metrics={'f1_val': 0.7639061707363932, 'auprc': 0.7992725547773409, 'loss_val': 0.5998256828685633, 'psi': 0.7780527243527724}-{'f1_val': 0.6745618055521567, 'auprc': 0.7330875605929975, 'loss_val': 0.9370010948587235, 'psi': 0.697972107568493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=52 head_norm_before_train=1.841072 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=52 local utility u=0.254359 metrics={'f1_val': 0.9970772460152744, 'auprc': 0.9988196478046099, 'loss_val': 0.029379572848926783, 'psi': 0.9977742067310086}-{'f1_val': 0.9311871311677031, 'auprc': 0.998624845774395, 'loss_val': 0.14217154024968548, 'psi': 0.95816221701038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=52 head_norm_before_train=1.695524 cos_to_last_merge=0.8829 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=52 local utility u=1.000000 metrics={'f1_val': 0.960310332729644, 'auprc': 0.9974074168595125, 'loss_val': 0.08951280088316017, 'psi': 0.9751491663815914}-{'f1_val': 0.7009169771696235, 'auprc': 0.9127071794085208, 'loss_val': 0.5408392687415623, 'psi': 0.7856330580651825}
[S16] START round=52 head_norm_before_train=2.127282 (no previous merge yet)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9090130557153842, 'auprc': 0.9820169586519968, 'loss_val': 0.43632855845339935, 'psi': 0.9382146168900292}-{'f1_val': 0.9466846484827747, 'auprc': 0.9868484551048972, 'loss_val': 0.1321124004988918, 'psi': 0.9627501711316236}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.769578 cos_to_last_merge=0.7923 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=52 local utility u=1.000000 metrics={'f1_val': 0.88025006052772, 'auprc': 0.9720776078416231, 'loss_val': 0.3619884436942772, 'psi': 0.9169810794532813}-{'f1_val': 0.6619180464177659, 'auprc': 0.8286614949415865, 'loss_val': 1.2527887945221379, 'psi': 0.7286154258272941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:57014
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:57004
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=-0.1040
[S7] DROPPED delta from S15 (cos=-0.1040 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.9999
[S9] sending update (kind=head size=1794 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=52 metric=0.9341 head_norm=1.984641
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.969662e-02
[S4] stored merged vector for next round verification (round=52)
[S4] DEBUG after merge:  round=52 metric=0.9341 head_norm=1.987761 delta_norm=0.019697
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.9876
[S14] RECEIVED delta(kind=head bytes=1795) from S6
[S14] cosine check vs S6: cos=0.9982
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=52 metric=0.9964 head_norm=2.063385
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.064459e-02
[S9] stored merged vector for next round verification (round=52)
[S9] DEBUG after merge:  round=52 metric=0.9964 head_norm=2.065957 delta_norm=0.030645
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=52 metric=0.6790 head_norm=1.994427
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.421745e-02
[S2] stored merged vector for next round verification (round=52)
[S2] DEBUG after merge:  round=52 metric=0.6788 head_norm=1.989489 delta_norm=0.014217
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.989489 cos_to_last_merge=1.0000 (last merge round=52)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.6439084237899515, 'auprc': 0.712869542743991, 'loss_val': 1.0005191331358705, 'psi': 0.6714928713715673}-{'f1_val': 0.6790155552951735, 'auprc': 0.7088466960421825, 'loss_val': 0.8059955179284287, 'psi': 0.6909480115939771}
[S3] START round=53 head_norm_before_train=1.974946 cos_to_last_merge=1.0000 (last merge round=52)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.8768433631434035, 'auprc': 0.9971040462809875, 'loss_val': 0.19099745089159892, 'psi': 0.924947636398437}-{'f1_val': 0.8869874088141523, 'auprc': 0.9971758216499049, 'loss_val': 0.19999555452626058, 'psi': 0.9310627739484533}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=53 metric=0.8768 head_norm=1.983454
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.652043e-01
[S3] stored merged vector for next round verification (round=53)
[S3] DEBUG after merge:  round=53 metric=0.8931 head_norm=2.017060 delta_norm=0.165204
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=53 head_norm_before_train=1.987761 cos_to_last_merge=1.0000 (last merge round=52)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9313060453931015, 'auprc': 0.9215558618746035, 'loss_val': 0.38249356069164153, 'psi': 0.9274059719857022}-{'f1_val': 0.934051813435788, 'auprc': 0.9350078151172674, 'loss_val': 0.35405344372601544, 'psi': 0.9344342141083798}
[S5] START round=53 head_norm_before_train=2.068980 cos_to_last_merge=0.9998 (last merge round=50)
[S5] round=53 local utility u=0.003891 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9954778110307567, 'loss_val': 0.027947936393033238, 'psi': 0.9959491155385589}-{'f1_val': 0.9962633185437604, 'auprc': 0.993222233716341, 'loss_val': 0.02896237985378822, 'psi': 0.9950468846127926}
[S6] START round=53 head_norm_before_train=1.869773 cos_to_last_merge=1.0000 (last merge round=51)
[S6] round=53 local utility u=0.608336 metrics={'f1_val': 0.8403046181355466, 'auprc': 0.9752555719643261, 'loss_val': 0.24727465777562432, 'psi': 0.8942849996670583}-{'f1_val': 0.7761448943840802, 'auprc': 0.8106127931058618, 'loss_val': 0.5850598757159302, 'psi': 0.7899320538727927}
[S7] START round=53 head_norm_before_train=1.968105 cos_to_last_merge=0.9478 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=53 local utility u=1.000000 metrics={'f1_val': 0.8419025529173199, 'auprc': 0.9828423430919493, 'loss_val': 0.3541067376616388, 'psi': 0.8982784689871717}-{'f1_val': 0.6056456653669152, 'auprc': 0.8116040065534109, 'loss_val': 0.707950907530953, 'psi': 0.6880290018415135}
[S8] START round=53 head_norm_before_train=1.876672 cos_to_last_merge=0.9930 (last merge round=39)
[S8] round=53 local utility u=0.011463 metrics={'f1_val': 0.9932295911756457, 'auprc': 0.9890595244837188, 'loss_val': 0.04307931081561183, 'psi': 0.9915615644988749}-{'f1_val': 0.9862233172697478, 'auprc': 0.9988735148804978, 'loss_val': 0.05340947295485365, 'psi': 0.9912833963140477}
[S9] START round=53 head_norm_before_train=2.065957 cos_to_last_merge=1.0000 (last merge round=52)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9951223056421215, 'auprc': 0.9986846372936429, 'loss_val': 0.021091717355935968, 'psi': 0.9965472383027301}-{'f1_val': 0.9963665676526772, 'auprc': 0.998684906936229, 'loss_val': 0.02091194328323624, 'psi': 0.9972939033660979}
[S10] START round=53 head_norm_before_train=2.117538 cos_to_last_merge=0.9800 (last merge round=24)
[S10] round=53 local utility u=0.000067 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959387490159926, 'loss_val': 0.025762106867110238, 'psi': 0.9955693719446352}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959391869820258, 'loss_val': 0.025896807148602104, 'psi': 0.9955695471310485}
[S11] START round=53 head_norm_before_train=1.936433 cos_to_last_merge=0.8142 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=53 local utility u=0.000042 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.998098604213461, 'loss_val': 0.02123784599082509, 'psi': 0.9970472968354918}-{'f1_val': 0.9963464252501789, 'auprc': 0.9981278634434733, 'loss_val': 0.021410289119951516, 'psi': 0.9970590005274966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=53 head_norm_before_train=1.814282 (no previous merge yet)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6114652797610508, 'auprc': 0.6903484680611893, 'loss_val': 1.1222508703526777, 'psi': 0.6430185550811063}-{'f1_val': 0.7639061707363932, 'auprc': 0.7992725547773409, 'loss_val': 0.5998256828685633, 'psi': 0.7780527243527724}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.857020 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=53 local utility u=0.001367 metrics={'f1_val': 0.9970772460152744, 'auprc': 0.99883194282116, 'loss_val': 0.02668215682207015, 'psi': 0.9977791247376286}-{'f1_val': 0.9970772460152744, 'auprc': 0.9988196478046099, 'loss_val': 0.029379572848926783, 'psi': 0.9977742067310086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=53 metric=0.9971 head_norm=1.877275
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.263607e-02
[S14] stored merged vector for next round verification (round=53)
[S14] DEBUG after merge:  round=53 metric=0.9971 head_norm=1.872481 delta_norm=0.062636
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=53 head_norm_before_train=1.702135 cos_to_last_merge=0.8822 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.8819144872666406, 'auprc': 0.9660131495636584, 'loss_val': 0.27741008552176016, 'psi': 0.9155539521854477}-{'f1_val': 0.960310332729644, 'auprc': 0.9974074168595125, 'loss_val': 0.08951280088316017, 'psi': 0.9751491663815914}
[S16] START round=53 head_norm_before_train=2.129807 (no previous merge yet)
[S16] round=53 local utility u=0.435123 metrics={'f1_val': 0.9904419867078762, 'auprc': 0.9862981345740083, 'loss_val': 0.06749893997440932, 'psi': 0.9887844458543291}-{'f1_val': 0.9090130557153842, 'auprc': 0.9820169586519968, 'loss_val': 0.43632855845339935, 'psi': 0.9382146168900292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=53 head_norm_before_train=1.778740 cos_to_last_merge=0.7918 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.670798597830556, 'auprc': 0.8763179424596474, 'loss_val': 1.1033113430872135, 'psi': 0.7530063356821926}-{'f1_val': 0.88025006052772, 'auprc': 0.9720776078416231, 'loss_val': 0.3619884436942772, 'psi': 0.9169810794532813}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:57014
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=53 metric=0.9313 head_norm=1.994414
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.672225e-03
[S4] stored merged vector for next round verification (round=53)
[S4] DEBUG after merge:  round=53 metric=0.9313 head_norm=1.994397 delta_norm=0.009672
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9997
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.9993
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S6
[S14] cosine check vs S6: cos=0.9995
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.1041
[S15] DROPPED delta from S7 (cos=-0.1041 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=53 metric=0.9951 head_norm=2.078216
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.521728e-02
[S9] stored merged vector for next round verification (round=53)
[S9] DEBUG after merge:  round=53 metric=0.9951 head_norm=2.084373 delta_norm=0.025217
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=53 metric=0.8403 head_norm=1.876846
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.421800e-02
[S6] stored merged vector for next round verification (round=53)
[S6] DEBUG after merge:  round=53 metric=0.8406 head_norm=1.880433 delta_norm=0.034218
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.999560 cos_to_last_merge=1.0000 (last merge round=52)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.6392647215479519, 'auprc': 0.7123762333158717, 'loss_val': 1.0525647968074325, 'psi': 0.6685093262551198}-{'f1_val': 0.6439084237899515, 'auprc': 0.712869542743991, 'loss_val': 1.0005191331358705, 'psi': 0.6714928713715673}
[S3] START round=54 head_norm_before_train=2.017060 cos_to_last_merge=1.0000 (last merge round=53)
[S3] round=54 local utility u=0.376021 metrics={'f1_val': 0.9805778274355272, 'auprc': 0.9982636094830116, 'loss_val': 0.06484174813211968, 'psi': 0.987652140254521}-{'f1_val': 0.8768433631434035, 'auprc': 0.9971040462809875, 'loss_val': 0.19099745089159892, 'psi': 0.924947636398437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=54 head_norm_before_train=1.994397 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=54 local utility u=0.005941 metrics={'f1_val': 0.9311859133699424, 'auprc': 0.9283015153397326, 'loss_val': 0.390128227191046, 'psi': 0.9300321541578584}-{'f1_val': 0.9313060453931015, 'auprc': 0.9215558618746035, 'loss_val': 0.38249356069164153, 'psi': 0.9274059719857022}
[S5] START round=54 head_norm_before_train=2.090817 cos_to_last_merge=0.9996 (last merge round=50)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9950865150135154, 'loss_val': 0.026866787601398566, 'psi': 0.9957925971316623}-{'f1_val': 0.9962633185437604, 'auprc': 0.9954778110307567, 'loss_val': 0.027947936393033238, 'psi': 0.9959491155385589}
[S6] START round=54 head_norm_before_train=1.880433 cos_to_last_merge=1.0000 (last merge round=53)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.8221489466296664, 'auprc': 0.9482406716472717, 'loss_val': 0.45029008915910496, 'psi': 0.8725856366367085}-{'f1_val': 0.8403046181355466, 'auprc': 0.9752555719643261, 'loss_val': 0.24727465777562432, 'psi': 0.8942849996670583}
[S7] START round=54 head_norm_before_train=1.979876 cos_to_last_merge=0.9466 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6805736044749331, 'auprc': 0.9297996874532395, 'loss_val': 0.5777646345677705, 'psi': 0.7802640376662556}-{'f1_val': 0.8419025529173199, 'auprc': 0.9828423430919493, 'loss_val': 0.3541067376616388, 'psi': 0.8982784689871717}
[S8] START round=54 head_norm_before_train=1.884636 cos_to_last_merge=0.9927 (last merge round=39)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9928780528403698, 'auprc': 0.9895606142103105, 'loss_val': 0.04257570850685304, 'psi': 0.991551077388346}-{'f1_val': 0.9932295911756457, 'auprc': 0.9890595244837188, 'loss_val': 0.04307931081561183, 'psi': 0.9915615644988749}
[S9] START round=54 head_norm_before_train=2.084373 cos_to_last_merge=1.0000 (last merge round=53)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9986884021112288, 'loss_val': 0.024373976369227644, 'psi': 0.9957956363077343}-{'f1_val': 0.9951223056421215, 'auprc': 0.9986846372936429, 'loss_val': 0.021091717355935968, 'psi': 0.9965472383027301}
[S10] START round=54 head_norm_before_train=2.122249 cos_to_last_merge=0.9793 (last merge round=24)
[S10] round=54 local utility u=0.000112 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959708273434676, 'loss_val': 0.025635198474045363, 'psi': 0.9955822032756252}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959387490159926, 'loss_val': 0.025762106867110238, 'psi': 0.9955693719446352}
[S11] START round=54 head_norm_before_train=1.944400 cos_to_last_merge=0.8141 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=54 local utility u=0.000715 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9981875221838152, 'loss_val': 0.02007514135250723, 'psi': 0.9970828640236336}-{'f1_val': 0.9963464252501789, 'auprc': 0.998098604213461, 'loss_val': 0.02123784599082509, 'psi': 0.9970472968354918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=54 head_norm_before_train=1.818770 (no previous merge yet)
[S13] round=54 local utility u=0.223854 metrics={'f1_val': 0.6681221611992071, 'auprc': 0.7040345393544616, 'loss_val': 1.0555425738629378, 'psi': 0.6824871124613089}-{'f1_val': 0.6114652797610508, 'auprc': 0.6903484680611893, 'loss_val': 1.1222508703526777, 'psi': 0.6430185550811063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=54 head_norm_before_train=1.872481 cos_to_last_merge=1.0000 (last merge round=53)
[S14] round=54 local utility u=0.001437 metrics={'f1_val': 0.9972768303733199, 'auprc': 0.9988926127177531, 'loss_val': 0.02518849550129459, 'psi': 0.9979231433110931}-{'f1_val': 0.9970772460152744, 'auprc': 0.99883194282116, 'loss_val': 0.02668215682207015, 'psi': 0.9977791247376286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=54 metric=0.9973 head_norm=1.892679
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.843445e-02
[S14] stored merged vector for next round verification (round=54)
[S14] DEBUG after merge:  round=54 metric=0.9973 head_norm=1.884387 delta_norm=0.038434
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=54 head_norm_before_train=1.709334 cos_to_last_merge=0.8814 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=54 local utility u=0.431888 metrics={'f1_val': 0.9744511580754754, 'auprc': 0.9947794304777453, 'loss_val': 0.05515372752672872, 'psi': 0.9825824670363834}-{'f1_val': 0.8819144872666406, 'auprc': 0.9660131495636584, 'loss_val': 0.27741008552176016, 'psi': 0.9155539521854477}
[S16] START round=54 head_norm_before_train=2.133109 (no previous merge yet)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.9443451049068162, 'auprc': 0.9878512969374541, 'loss_val': 0.16314351056339238, 'psi': 0.9617475817190714}-{'f1_val': 0.9904419867078762, 'auprc': 0.9862981345740083, 'loss_val': 0.06749893997440932, 'psi': 0.9887844458543291}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=1.785940 cos_to_last_merge=0.7914 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=54 local utility u=0.260201 metrics={'f1_val': 0.6975720162400739, 'auprc': 0.9140402122614799, 'loss_val': 0.8567169519136365, 'psi': 0.7841592946486363}-{'f1_val': 0.670798597830556, 'auprc': 0.8763179424596474, 'loss_val': 1.1033113430872135, 'psi': 0.7530063356821926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=-0.1046
[S7] DROPPED delta from S15 (cos=-0.1046 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S4
[S2] cosine check vs S4: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=54 metric=0.6393 head_norm=2.012232
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.538848e-02
[S2] stored merged vector for next round verification (round=54)
[S2] DEBUG after merge:  round=54 metric=0.6393 head_norm=2.006267 delta_norm=0.015388
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=2.006267 cos_to_last_merge=1.0000 (last merge round=54)
[S2] round=55 local utility u=0.066936 metrics={'f1_val': 0.6557066019170057, 'auprc': 0.706509225665364, 'loss_val': 0.9997433905946094, 'psi': 0.676027651416349}-{'f1_val': 0.6392647215479519, 'auprc': 0.7123762333158717, 'loss_val': 1.0525647968074325, 'psi': 0.6685093262551198}
[S3] START round=55 head_norm_before_train=2.026362 cos_to_last_merge=1.0000 (last merge round=53)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9986255553939457, 'loss_val': 0.09941450070632767, 'psi': 0.9763733353305868}-{'f1_val': 0.9805778274355272, 'auprc': 0.9982636094830116, 'loss_val': 0.06484174813211968, 'psi': 0.987652140254521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=2.000402 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=55 local utility u=0.046348 metrics={'f1_val': 0.9347335327516704, 'auprc': 0.9397193085713773, 'loss_val': 0.352971338792337, 'psi': 0.9367278430795531}-{'f1_val': 0.9311859133699424, 'auprc': 0.9283015153397326, 'loss_val': 0.390128227191046, 'psi': 0.9300321541578584}
[S5] START round=55 head_norm_before_train=2.114114 cos_to_last_merge=0.9993 (last merge round=50)
[S5] round=55 local utility u=0.001244 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9957440102059253, 'loss_val': 0.026350296820593113, 'psi': 0.9960555952086263}-{'f1_val': 0.9962633185437604, 'auprc': 0.9950865150135154, 'loss_val': 0.026866787601398566, 'psi': 0.9957925971316623}
[S6] START round=55 head_norm_before_train=1.889024 cos_to_last_merge=1.0000 (last merge round=53)
[S6] round=55 local utility u=0.045746 metrics={'f1_val': 0.8228121655505504, 'auprc': 0.9547495817354834, 'loss_val': 0.382304208304785, 'psi': 0.8755871320245235}-{'f1_val': 0.8221489466296664, 'auprc': 0.9482406716472717, 'loss_val': 0.45029008915910496, 'psi': 0.8725856366367085}
[S7] START round=55 head_norm_before_train=1.991794 cos_to_last_merge=0.9453 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=55 local utility u=0.970157 metrics={'f1_val': 0.9249014231602187, 'auprc': 0.9840952969299004, 'loss_val': 0.2663040794108187, 'psi': 0.9485789726680914}-{'f1_val': 0.6805736044749331, 'auprc': 0.9297996874532395, 'loss_val': 0.5777646345677705, 'psi': 0.7802640376662556}
[S8] START round=55 head_norm_before_train=1.891241 cos_to_last_merge=0.9924 (last merge round=39)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.8434050209788995, 'auprc': 0.9963055550529417, 'loss_val': 0.27956399785408675, 'psi': 0.9045652346085163}-{'f1_val': 0.9928780528403698, 'auprc': 0.9895606142103105, 'loss_val': 0.04257570850685304, 'psi': 0.991551077388346}
[S9] START round=55 head_norm_before_train=2.096556 cos_to_last_merge=1.0000 (last merge round=53)
[S9] round=55 local utility u=0.009663 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9986842599451786, 'loss_val': 0.020032764926708233, 'psi': 0.9972936445696777}-{'f1_val': 0.9938671257720713, 'auprc': 0.9986884021112288, 'loss_val': 0.024373976369227644, 'psi': 0.9957956363077343}
[S10] START round=55 head_norm_before_train=2.125862 cos_to_last_merge=0.9785 (last merge round=24)
[S10] round=55 local utility u=0.000064 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959803425817995, 'loss_val': 0.025535591704737418, 'psi': 0.995586009370958}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959708273434676, 'loss_val': 0.025635198474045363, 'psi': 0.9955822032756252}
[S11] START round=55 head_norm_before_train=1.953308 cos_to_last_merge=0.8139 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=55 local utility u=0.000264 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9981935391832334, 'loss_val': 0.019565805156767143, 'psi': 0.9970852708234008}-{'f1_val': 0.9963464252501789, 'auprc': 0.9981875221838152, 'loss_val': 0.02007514135250723, 'psi': 0.9970828640236336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=55 head_norm_before_train=1.822031 (no previous merge yet)
[S13] round=55 local utility u=0.277344 metrics={'f1_val': 0.7037009595521564, 'auprc': 0.753078811578202, 'loss_val': 0.8614599007703138, 'psi': 0.7234521003625747}-{'f1_val': 0.6681221611992071, 'auprc': 0.7040345393544616, 'loss_val': 1.0555425738629378, 'psi': 0.6824871124613089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=55 head_norm_before_train=1.884387 cos_to_last_merge=1.0000 (last merge round=54)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9373249141271134, 'auprc': 0.9986608626005818, 'loss_val': 0.0983098318473843, 'psi': 0.9618592935165008}-{'f1_val': 0.9972768303733199, 'auprc': 0.9988926127177531, 'loss_val': 0.02518849550129459, 'psi': 0.9979231433110931}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.716697 cos_to_last_merge=0.8806 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9103747277239199, 'auprc': 0.9914223037805785, 'loss_val': 0.15764118565932592, 'psi': 0.9427937581465834}-{'f1_val': 0.9744511580754754, 'auprc': 0.9947794304777453, 'loss_val': 0.05515372752672872, 'psi': 0.9825824670363834}
[S16] START round=55 head_norm_before_train=2.137723 (no previous merge yet)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.8576006732025823, 'auprc': 0.8901995822964582, 'loss_val': 0.8776709814879056, 'psi': 0.8706402368401327}-{'f1_val': 0.9443451049068162, 'auprc': 0.9878512969374541, 'loss_val': 0.16314351056339238, 'psi': 0.9617475817190714}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.792315 cos_to_last_merge=0.7910 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=55 local utility u=1.000000 metrics={'f1_val': 0.9226367103626454, 'auprc': 0.9767790490665538, 'loss_val': 0.2696927744920629, 'psi': 0.9442936458442088}-{'f1_val': 0.6975720162400739, 'auprc': 0.9140402122614799, 'loss_val': 0.8567169519136365, 'psi': 0.7841592946486363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.215 → S7@127.0.0.1:57008
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:57004
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:57014
[S8] ⇄ pheromone p=0.005 → S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9995
[S10]  timeout peer S2
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S5] ⇄ pheromone p=0.010 → S9@127.0.0.1:57010
[S4] ⇄ pheromone p=0.024 → S2@127.0.0.1:57002
[S14] RECEIVED delta(kind=head bytes=1804) from S6
[S14] cosine check vs S6: cos=0.9994
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=-0.1041
[S15] DROPPED delta from S7 (cos=-0.1041 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=0.9956
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=0.9999
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=55 metric=0.9964 head_norm=2.107584
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.326812e-02
[S9] stored merged vector for next round verification (round=55)
[S9] DEBUG after merge:  round=55 metric=0.9964 head_norm=2.115355 delta_norm=0.033268
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.004 → S3@127.0.0.1:57003
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=55 metric=0.6557 head_norm=2.017588
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.706347e-02
[S2] stored merged vector for next round verification (round=55)
[S2] DEBUG after merge:  round=55 metric=0.6557 head_norm=2.011121 delta_norm=0.017063
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.051 → S4@127.0.0.1:57004
[S6] ⇄ pheromone p=0.258 → S14@127.0.0.1:57014
[S7] ⇄ pheromone p=0.418 → S15@127.0.0.1:57015
[S2] START round=56 head_norm_before_train=2.011121 cos_to_last_merge=1.0000 (last merge round=55)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.646484408378488, 'auprc': 0.703906444729532, 'loss_val': 1.0252543777057823, 'psi': 0.6694532229189056}-{'f1_val': 0.6557066019170057, 'auprc': 0.706509225665364, 'loss_val': 0.9997433905946094, 'psi': 0.676027651416349}
[S3] START round=56 head_norm_before_train=2.035334 cos_to_last_merge=1.0000 (last merge round=53)
[S3] round=56 local utility u=0.109562 metrics={'f1_val': 0.9910229793672763, 'auprc': 0.9964861960656605, 'loss_val': 0.05077830199910295, 'psi': 0.9932082660466299}-{'f1_val': 0.9615385219550141, 'auprc': 0.9986255553939457, 'loss_val': 0.09941450070632767, 'psi': 0.9763733353305868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=56 metric=0.9910 head_norm=2.042673
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.050069e-01
[S3] stored merged vector for next round verification (round=56)
[S3] DEBUG after merge:  round=56 metric=0.9910 head_norm=2.072724 delta_norm=0.105007
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=56 head_norm_before_train=2.004778 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=56 local utility u=0.023817 metrics={'f1_val': 0.938971658283496, 'auprc': 0.9469871280515327, 'loss_val': 0.35257045786612834, 'psi': 0.9421778461907107}-{'f1_val': 0.9347335327516704, 'auprc': 0.9397193085713773, 'loss_val': 0.352971338792337, 'psi': 0.9367278430795531}
[S5] START round=56 head_norm_before_train=2.123620 cos_to_last_merge=0.9990 (last merge round=50)
[S5] round=56 local utility u=0.005728 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9992374164125626, 'loss_val': 0.025373561439842724, 'psi': 0.9974529576912812}-{'f1_val': 0.9962633185437604, 'auprc': 0.9957440102059253, 'loss_val': 0.026350296820593113, 'psi': 0.9960555952086263}
[S6] START round=56 head_norm_before_train=1.900463 cos_to_last_merge=0.9998 (last merge round=53)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.787077405649448, 'auprc': 0.9509127644397651, 'loss_val': 0.5511599313760605, 'psi': 0.8526115491655748}-{'f1_val': 0.8228121655505504, 'auprc': 0.9547495817354834, 'loss_val': 0.382304208304785, 'psi': 0.8755871320245235}
[S7] START round=56 head_norm_before_train=2.001782 cos_to_last_merge=0.9444 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.5871879968076539, 'auprc': 0.826542809668752, 'loss_val': 0.9450842567892133, 'psi': 0.6829299219520932}-{'f1_val': 0.9249014231602187, 'auprc': 0.9840952969299004, 'loss_val': 0.2663040794108187, 'psi': 0.9485789726680914}
[S8] START round=56 head_norm_before_train=1.897119 cos_to_last_merge=0.9921 (last merge round=39)
[S8] round=56 local utility u=0.557184 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9886801755828333, 'loss_val': 0.042821946858915674, 'psi': 0.9915653619069338}-{'f1_val': 0.8434050209788995, 'auprc': 0.9963055550529417, 'loss_val': 0.27956399785408675, 'psi': 0.9045652346085163}
[S9] START round=56 head_norm_before_train=2.115355 cos_to_last_merge=1.0000 (last merge round=55)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9934792190535642, 'auprc': 0.9986879188637323, 'loss_val': 0.025629498105539553, 'psi': 0.9955626989776314}-{'f1_val': 0.9963665676526772, 'auprc': 0.9986842599451786, 'loss_val': 0.020032764926708233, 'psi': 0.9972936445696777}
[S10] START round=56 head_norm_before_train=2.129630 cos_to_last_merge=0.9778 (last merge round=24)
[S10] round=56 local utility u=0.000193 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960540861283604, 'loss_val': 0.025370780373805562, 'psi': 0.9956155067895824}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959803425817995, 'loss_val': 0.025535591704737418, 'psi': 0.995586009370958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=56 head_norm_before_train=1.962451 cos_to_last_merge=0.8139 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=56 local utility u=0.000087 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9981927100186675, 'loss_val': 0.01938842922126036, 'psi': 0.9970849391575745}-{'f1_val': 0.9963464252501789, 'auprc': 0.9981935391832334, 'loss_val': 0.019565805156767143, 'psi': 0.9970852708234008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=56 head_norm_before_train=1.827419 (no previous merge yet)
[S13] round=56 local utility u=0.192840 metrics={'f1_val': 0.7407105171331373, 'auprc': 0.7824675757778099, 'loss_val': 0.7860027692397935, 'psi': 0.7574133405910064}-{'f1_val': 0.7037009595521564, 'auprc': 0.753078811578202, 'loss_val': 0.8614599007703138, 'psi': 0.7234521003625747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=56 head_norm_before_train=1.901118 cos_to_last_merge=1.0000 (last merge round=54)
[S14] round=56 local utility u=0.191309 metrics={'f1_val': 0.9905732070661395, 'auprc': 0.9985168263642458, 'loss_val': 0.03474889096376636, 'psi': 0.9937506547853819}-{'f1_val': 0.9373249141271134, 'auprc': 0.9986608626005818, 'loss_val': 0.0983098318473843, 'psi': 0.9618592935165008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=56 metric=0.9906 head_norm=1.915222
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.124391e-02
[S14] stored merged vector for next round verification (round=56)
[S14] DEBUG after merge:  round=56 metric=0.9910 head_norm=1.907411 delta_norm=0.041244
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] START round=56 head_norm_before_train=1.723235 cos_to_last_merge=0.8796 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9003683915509155, 'auprc': 0.9902807242489398, 'loss_val': 0.24712270755183235, 'psi': 0.9363333246301252}-{'f1_val': 0.9103747277239199, 'auprc': 0.9914223037805785, 'loss_val': 0.15764118565932592, 'psi': 0.9427937581465834}
[S16] START round=56 head_norm_before_train=2.142393 (no previous merge yet)
[S16] round=56 local utility u=0.963440 metrics={'f1_val': 0.9929834221798002, 'auprc': 0.9843362835232539, 'loss_val': 0.045498163764374225, 'psi': 0.9895245667171816}-{'f1_val': 0.8576006732025823, 'auprc': 0.8901995822964582, 'loss_val': 0.8776709814879056, 'psi': 0.8706402368401327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=56 head_norm_before_train=1.797103 cos_to_last_merge=0.7905 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6748463105681544, 'auprc': 0.822031566499168, 'loss_val': 1.3713667403523389, 'psi': 0.7337204129405598}-{'f1_val': 0.9226367103626454, 'auprc': 0.9767790490665538, 'loss_val': 0.2696927744920629, 'psi': 0.9442936458442088}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=56 metric=0.9390 head_norm=2.006603
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.219563e-02
[S4] stored merged vector for next round verification (round=56)
[S4] DEBUG after merge:  round=56 metric=0.9386 head_norm=2.011981 delta_norm=0.022196
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=56 metric=0.9935 head_norm=2.125822
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.297018e-02
[S9] stored merged vector for next round verification (round=56)
[S9] DEBUG after merge:  round=56 metric=0.9935 head_norm=2.129014 delta_norm=0.022970
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=56 metric=0.6465 head_norm=2.021508
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.001439e-02
[S2] stored merged vector for next round verification (round=56)
[S2] DEBUG after merge:  round=56 metric=0.6467 head_norm=2.013970 delta_norm=0.020014
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=2.013970 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=57 local utility u=0.160324 metrics={'f1_val': 0.6749883639786097, 'auprc': 0.7015657715459088, 'loss_val': 0.8686077021180265, 'psi': 0.6856193270055293}-{'f1_val': 0.646484408378488, 'auprc': 0.703906444729532, 'loss_val': 1.0252543777057823, 'psi': 0.6694532229189056}
[S3] START round=57 head_norm_before_train=2.072724 cos_to_last_merge=1.0000 (last merge round=56)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9320897180981486, 'auprc': 0.9716972820915767, 'loss_val': 0.21193520138980024, 'psi': 0.9479327436955198}-{'f1_val': 0.9910229793672763, 'auprc': 0.9964861960656605, 'loss_val': 0.05077830199910295, 'psi': 0.9932082660466299}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=2.011981 cos_to_last_merge=1.0000 (last merge round=56)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9348181384942478, 'auprc': 0.938473147014206, 'loss_val': 0.3552126627348463, 'psi': 0.9362801419022311}-{'f1_val': 0.938971658283496, 'auprc': 0.9469871280515327, 'loss_val': 0.35257045786612834, 'psi': 0.9421778461907107}
[S5] START round=57 head_norm_before_train=2.132448 cos_to_last_merge=0.9989 (last merge round=50)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9938531402797486, 'loss_val': 0.02779860237054556, 'psi': 0.9952992472381557}-{'f1_val': 0.9962633185437604, 'auprc': 0.9992374164125626, 'loss_val': 0.025373561439842724, 'psi': 0.9974529576912812}
[S6] START round=57 head_norm_before_train=1.914409 cos_to_last_merge=0.9996 (last merge round=53)
[S6] round=57 local utility u=0.195702 metrics={'f1_val': 0.8224835570512546, 'auprc': 0.9561346834994555, 'loss_val': 0.3878595717681508, 'psi': 0.8759440076305349}-{'f1_val': 0.787077405649448, 'auprc': 0.9509127644397651, 'loss_val': 0.5511599313760605, 'psi': 0.8526115491655748}
[S7] START round=57 head_norm_before_train=2.014678 cos_to_last_merge=0.9431 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5835484209036593, 'auprc': 0.6740399179766374, 'loss_val': 1.0805589536653555, 'psi': 0.6197450197328506}-{'f1_val': 0.5871879968076539, 'auprc': 0.826542809668752, 'loss_val': 0.9450842567892133, 'psi': 0.6829299219520932}
[S8] START round=57 head_norm_before_train=1.902569 cos_to_last_merge=0.9919 (last merge round=39)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.8970735640821835, 'loss_val': 0.5808371364520517, 'psi': 0.7870817191921751}-{'f1_val': 0.9934888194563342, 'auprc': 0.9886801755828333, 'loss_val': 0.042821946858915674, 'psi': 0.9915653619069338}
[S9] START round=57 head_norm_before_train=2.129014 cos_to_last_merge=1.0000 (last merge round=56)
[S9] round=57 local utility u=0.009398 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9983766576882636, 'loss_val': 0.020890195952594868, 'psi': 0.9969371635928437}-{'f1_val': 0.9934792190535642, 'auprc': 0.9986879188637323, 'loss_val': 0.025629498105539553, 'psi': 0.9955626989776314}
[S10] START round=57 head_norm_before_train=2.135460 cos_to_last_merge=0.9771 (last merge round=24)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960069512645289, 'loss_val': 0.02533800633768089, 'psi': 0.9955966528440497}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960540861283604, 'loss_val': 0.025370780373805562, 'psi': 0.9956155067895824}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=1.971376 cos_to_last_merge=0.8138 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9570469121012507, 'auprc': 0.9979156770506792, 'loss_val': 0.11349447675257594, 'psi': 0.9733944180810221}-{'f1_val': 0.9963464252501789, 'auprc': 0.9981927100186675, 'loss_val': 0.01938842922126036, 'psi': 0.9970849391575745}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.835053 (no previous merge yet)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.7361303455343122, 'auprc': 0.7162553336674395, 'loss_val': 0.9921862413892752, 'psi': 0.7281803407875631}-{'f1_val': 0.7407105171331373, 'auprc': 0.7824675757778099, 'loss_val': 0.7860027692397935, 'psi': 0.7574133405910064}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.907411 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=57 local utility u=0.016178 metrics={'f1_val': 0.9947785013638276, 'auprc': 0.9989301034072811, 'loss_val': 0.02886456829245273, 'psi': 0.996439142181209}-{'f1_val': 0.9905732070661395, 'auprc': 0.9985168263642458, 'loss_val': 0.03474889096376636, 'psi': 0.9937506547853819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=57 head_norm_before_train=1.730988 cos_to_last_merge=0.8786 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.879
[S15] round=57 local utility u=0.074035 metrics={'f1_val': 0.911071863853971, 'auprc': 0.9862239591749875, 'loss_val': 0.15110367346329034, 'psi': 0.9411327019823776}-{'f1_val': 0.9003683915509155, 'auprc': 0.9902807242489398, 'loss_val': 0.24712270755183235, 'psi': 0.9363333246301252}
[S16] START round=57 head_norm_before_train=2.144454 (no previous merge yet)
[S16] round=57 local utility u=0.013741 metrics={'f1_val': 0.9928316640166417, 'auprc': 0.9885916012251597, 'loss_val': 0.02987079813580436, 'psi': 0.9911356389000489}-{'f1_val': 0.9929834221798002, 'auprc': 0.9843362835232539, 'loss_val': 0.045498163764374225, 'psi': 0.9895245667171816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=57 head_norm_before_train=1.801218 cos_to_last_merge=0.7899 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=57 local utility u=0.793088 metrics={'f1_val': 0.8002772912172689, 'auprc': 0.9210469008511943, 'loss_val': 0.8348233845830785, 'psi': 0.8485851350708391}-{'f1_val': 0.6748463105681544, 'auprc': 0.822031566499168, 'loss_val': 1.3713667403523389, 'psi': 0.7337204129405598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=-0.1041
[S7] DROPPED delta from S15 (cos=-0.1041 < 0.0)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.9980
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9985
[S2] START round=58 head_norm_before_train=2.025495 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.609144454035602, 'auprc': 0.7000003250336716, 'loss_val': 1.2895909615987005, 'psi': 0.6454868024348298}-{'f1_val': 0.6749883639786097, 'auprc': 0.7015657715459088, 'loss_val': 0.8686077021180265, 'psi': 0.6856193270055293}
[S3] START round=58 head_norm_before_train=2.077147 cos_to_last_merge=1.0000 (last merge round=56)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.8915054185487116, 'auprc': 0.9961107837855963, 'loss_val': 0.19049467951285215, 'psi': 0.9333475646434655}-{'f1_val': 0.9320897180981486, 'auprc': 0.9716972820915767, 'loss_val': 0.21193520138980024, 'psi': 0.9479327436955198}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=58 metric=0.8915 head_norm=2.083459
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.368233e-02
[S3] stored merged vector for next round verification (round=58)
[S3] DEBUG after merge:  round=58 metric=0.9020 head_norm=2.108448 delta_norm=0.073682
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=58 head_norm_before_train=2.014767 cos_to_last_merge=1.0000 (last merge round=56)
[S4] round=58 local utility u=0.019038 metrics={'f1_val': 0.9350724374051889, 'auprc': 0.9494501054062757, 'loss_val': 0.3515926624403793, 'psi': 0.9408235046056237}-{'f1_val': 0.9348181384942478, 'auprc': 0.938473147014206, 'loss_val': 0.3552126627348463, 'psi': 0.9362801419022311}
[S5] START round=58 head_norm_before_train=2.138325 cos_to_last_merge=0.9986 (last merge round=50)
[S5] round=58 local utility u=0.001387 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9960233160718941, 'loss_val': 0.03153537923184317, 'psi': 0.9961673175550139}-{'f1_val': 0.9962633185437604, 'auprc': 0.9938531402797486, 'loss_val': 0.02779860237054556, 'psi': 0.9952992472381557}
[S6] START round=58 head_norm_before_train=1.931052 cos_to_last_merge=0.9993 (last merge round=53)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.701096435473999, 'auprc': 0.8002469022645728, 'loss_val': 0.7465684997515791, 'psi': 0.7407566221902286}-{'f1_val': 0.8224835570512546, 'auprc': 0.9561346834994555, 'loss_val': 0.3878595717681508, 'psi': 0.8759440076305349}
[S7] START round=58 head_norm_before_train=2.027769 cos_to_last_merge=0.9419 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=58 local utility u=0.823395 metrics={'f1_val': 0.6735331093206525, 'auprc': 0.9239818192893513, 'loss_val': 0.7235030985715203, 'psi': 0.773712593308132}-{'f1_val': 0.5835484209036593, 'auprc': 0.6740399179766374, 'loss_val': 1.0805589536653555, 'psi': 0.6197450197328506}
[S8] START round=58 head_norm_before_train=1.908245 cos_to_last_merge=0.9916 (last merge round=39)
[S8] round=58 local utility u=0.662166 metrics={'f1_val': 0.8384512409658251, 'auprc': 0.9964054673338472, 'loss_val': 0.302685896967188, 'psi': 0.901632931513034}-{'f1_val': 0.7137538225988359, 'auprc': 0.8970735640821835, 'loss_val': 0.5808371364520517, 'psi': 0.7870817191921751}
[S9] START round=58 head_norm_before_train=2.135688 cos_to_last_merge=1.0000 (last merge round=56)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9953001390815561, 'loss_val': 0.020100414446656053, 'psi': 0.9961355503914797}-{'f1_val': 0.9959775008625639, 'auprc': 0.9983766576882636, 'loss_val': 0.020890195952594868, 'psi': 0.9969371635928437}
[S10] START round=58 head_norm_before_train=2.142523 cos_to_last_merge=0.9766 (last merge round=24)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959717931821301, 'loss_val': 0.025339628345740318, 'psi': 0.9955825896110903}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960069512645289, 'loss_val': 0.02533800633768089, 'psi': 0.9955966528440497}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=1.975664 cos_to_last_merge=0.8132 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.813
[S11] round=58 local utility u=0.164505 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982574930441395, 'loss_val': 0.02118133724828816, 'psi': 0.9970983770307236}-{'f1_val': 0.9570469121012507, 'auprc': 0.9979156770506792, 'loss_val': 0.11349447675257594, 'psi': 0.9733944180810221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=58 head_norm_before_train=1.839844 (no previous merge yet)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6539781875144186, 'auprc': 0.6952959741386969, 'loss_val': 1.0403715922368753, 'psi': 0.67050530216413}-{'f1_val': 0.7361303455343122, 'auprc': 0.7162553336674395, 'loss_val': 0.9921862413892752, 'psi': 0.7281803407875631}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.923989 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=58 local utility u=0.010706 metrics={'f1_val': 0.9972768303733199, 'auprc': 0.9985354733254591, 'loss_val': 0.021258227356123007, 'psi': 0.9977802875541756}-{'f1_val': 0.9947785013638276, 'auprc': 0.9989301034072811, 'loss_val': 0.02886456829245273, 'psi': 0.996439142181209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=58 head_norm_before_train=1.740024 cos_to_last_merge=0.8776 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=58 local utility u=0.099722 metrics={'f1_val': 0.9381682184392213, 'auprc': 0.9856769416567891, 'loss_val': 0.11259750562361907, 'psi': 0.9571717077262485}-{'f1_val': 0.911071863853971, 'auprc': 0.9862239591749875, 'loss_val': 0.15110367346329034, 'psi': 0.9411327019823776}
[S16] START round=58 head_norm_before_train=2.149534 (no previous merge yet)
[S16] round=58 local utility u=0.004740 metrics={'f1_val': 0.99317075897421, 'auprc': 0.9914104521815539, 'loss_val': 0.030881539330557834, 'psi': 0.9924666362571476}-{'f1_val': 0.9928316640166417, 'auprc': 0.9885916012251597, 'loss_val': 0.02987079813580436, 'psi': 0.9911356389000489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=58 head_norm_before_train=1.805857 cos_to_last_merge=0.7895 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=58 local utility u=0.316635 metrics={'f1_val': 0.8321269695436122, 'auprc': 0.9639972405344606, 'loss_val': 0.5215021215620573, 'psi': 0.8848750779399515}-{'f1_val': 0.8002772912172689, 'auprc': 0.9210469008511943, 'loss_val': 0.8348233845830785, 'psi': 0.8485851350708391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=58 metric=0.8385 head_norm=1.912841
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.428112e-02
[S8] stored merged vector for next round verification (round=58)
[S8] DEBUG after merge:  round=58 metric=0.8392 head_norm=1.921201 delta_norm=0.054281
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1793) from S15
[S7] cosine check vs S15: cos=-0.1043
[S7] DROPPED delta from S15 (cos=-0.1043 < 0.0)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=58 metric=0.9351 head_norm=2.020435
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.367296e-02
[S4] stored merged vector for next round verification (round=58)
[S4] DEBUG after merge:  round=58 metric=0.9351 head_norm=2.022921 delta_norm=0.013673
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=-0.1043
[S15] DROPPED delta from S7 (cos=-0.1043 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=58 metric=0.6091 head_norm=2.036591
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.961610e-02
[S2] stored merged vector for next round verification (round=58)
[S2] DEBUG after merge:  round=58 metric=0.6091 head_norm=2.028434 delta_norm=0.019616
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=58 metric=0.9967 head_norm=2.146131
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.665518e-02
[S9] stored merged vector for next round verification (round=58)
[S9] DEBUG after merge:  round=58 metric=0.9967 head_norm=2.145999 delta_norm=0.026655
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=2.028434 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=59 local utility u=0.233762 metrics={'f1_val': 0.6456876525756141, 'auprc': 0.7038847938281174, 'loss_val': 1.0529787279626255, 'psi': 0.6689665090766155}-{'f1_val': 0.609144454035602, 'auprc': 0.7000003250336716, 'loss_val': 1.2895909615987005, 'psi': 0.6454868024348298}
[S3] START round=59 head_norm_before_train=2.108448 cos_to_last_merge=1.0000 (last merge round=58)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.877011652072488, 'auprc': 0.9275239404260198, 'loss_val': 0.4320332714434721, 'psi': 0.8972165674139008}-{'f1_val': 0.8915054185487116, 'auprc': 0.9961107837855963, 'loss_val': 0.19049467951285215, 'psi': 0.9333475646434655}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.897 u=0.0000 p_local=0.0631 f1=0.877 auprc=0.928 bytes=57554
[S4] START round=59 head_norm_before_train=2.022921 cos_to_last_merge=1.0000 (last merge round=58)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9321253750626783, 'auprc': 0.9300230777356562, 'loss_val': 0.355074997336616, 'psi': 0.9312844561318694}-{'f1_val': 0.9350724374051889, 'auprc': 0.9494501054062757, 'loss_val': 0.3515926624403793, 'psi': 0.9408235046056237}
[S5] START round=59 head_norm_before_train=2.146199 cos_to_last_merge=0.9983 (last merge round=50)
[S5] round=59 local utility u=0.007392 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9992411709259121, 'loss_val': 0.028609919270103958, 'psi': 0.9976750110821893}-{'f1_val': 0.9962633185437604, 'auprc': 0.9960233160718941, 'loss_val': 0.03153537923184317, 'psi': 0.9961673175550139}
[S6] START round=59 head_norm_before_train=1.942599 cos_to_last_merge=0.9989 (last merge round=53)
[S6] round=59 local utility u=0.878141 metrics={'f1_val': 0.8350095492213951, 'auprc': 0.9522147431452541, 'loss_val': 0.2496691877231811, 'psi': 0.8818916267909387}-{'f1_val': 0.701096435473999, 'auprc': 0.8002469022645728, 'loss_val': 0.7465684997515791, 'psi': 0.7407566221902286}
[S7] START round=59 head_norm_before_train=2.036926 cos_to_last_merge=0.9410 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=59 local utility u=0.023850 metrics={'f1_val': 0.7045023390117986, 'auprc': 0.8951434938915495, 'loss_val': 0.775103347899321, 'psi': 0.780758800963699}-{'f1_val': 0.6735331093206525, 'auprc': 0.9239818192893513, 'loss_val': 0.7235030985715203, 'psi': 0.773712593308132}
[S8] START round=59 head_norm_before_train=1.921201 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=59 local utility u=0.571218 metrics={'f1_val': 0.9862409241768243, 'auprc': 0.9984823500099853, 'loss_val': 0.053218610788185766, 'psi': 0.9911374945100887}-{'f1_val': 0.8384512409658251, 'auprc': 0.9964054673338472, 'loss_val': 0.302685896967188, 'psi': 0.901632931513034}
[S9] START round=59 head_norm_before_train=2.145999 cos_to_last_merge=1.0000 (last merge round=58)
[S9] round=59 local utility u=0.006224 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9988165542071512, 'loss_val': 0.018901446239251874, 'psi': 0.9976120021294888}-{'f1_val': 0.9966924912647621, 'auprc': 0.9953001390815561, 'loss_val': 0.020100414446656053, 'psi': 0.9961355503914797}
[S10] START round=59 head_norm_before_train=2.149977 cos_to_last_merge=0.9762 (last merge round=24)
[S10] round=59 local utility u=0.000683 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963643389255843, 'loss_val': 0.025152114439965425, 'psi': 0.9957396079084719}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959717931821301, 'loss_val': 0.025339628345740318, 'psi': 0.9955825896110903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=60 psi=0.996 u=0.0007 p_local=0.0003 f1=0.995 auprc=0.996 bytes=73701
[S11] START round=59 head_norm_before_train=1.975130 cos_to_last_merge=0.8125 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.812
[S11] round=59 local utility u=0.000293 metrics={'f1_val': 0.9963464252501789, 'auprc': 0.9980010996642767, 'loss_val': 0.01995171204865971, 'psi': 0.9970082950158181}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982574930441395, 'loss_val': 0.02118133724828816, 'psi': 0.9970983770307236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=60 psi=0.997 u=0.0003 p_local=0.0273 f1=0.996 auprc=0.998 bytes=77289
[S13] START round=59 head_norm_before_train=1.833069 (no previous merge yet)
[S13] round=59 local utility u=0.185135 metrics={'f1_val': 0.6533220155214121, 'auprc': 0.7546203275942194, 'loss_val': 0.8441377055495944, 'psi': 0.693841340350535}-{'f1_val': 0.6539781875144186, 'auprc': 0.6952959741386969, 'loss_val': 1.0403715922368753, 'psi': 0.67050530216413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=60 psi=0.694 u=0.1851 p_local=0.1334 f1=0.653 auprc=0.755 bytes=57582
[S14] START round=59 head_norm_before_train=1.937786 cos_to_last_merge=0.9999 (last merge round=56)
[S14] round=59 local utility u=0.002165 metrics={'f1_val': 0.9979151217722836, 'auprc': 0.998406627745035, 'loss_val': 0.020371556034772784, 'psi': 0.9981117241613842}-{'f1_val': 0.9972768303733199, 'auprc': 0.9985354733254591, 'loss_val': 0.021258227356123007, 'psi': 0.9977802875541756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] r=60 psi=0.998 u=0.0022 p_local=0.0411 f1=0.998 auprc=0.998 bytes=70229
[S15] START round=59 head_norm_before_train=1.748201 cos_to_last_merge=0.8768 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.877
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.8442819188807328, 'auprc': 0.9242755761678962, 'loss_val': 0.3323361385232408, 'psi': 0.8762793817955981}-{'f1_val': 0.9381682184392213, 'auprc': 0.9856769416567891, 'loss_val': 0.11259750562361907, 'psi': 0.9571717077262485}
[S16] START round=59 head_norm_before_train=2.155882 (no previous merge yet)
[S16] round=59 local utility u=0.000830 metrics={'f1_val': 0.9925332791609631, 'auprc': 0.9935201079472851, 'loss_val': 0.03172562671693243, 'psi': 0.9929280106754919}-{'f1_val': 0.99317075897421, 'auprc': 0.9914104521815539, 'loss_val': 0.030881539330557834, 'psi': 0.9924666362571476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=60 psi=0.993 u=0.0008 p_local=0.1409 f1=0.993 auprc=0.994 bytes=61163
[S17] START round=59 head_norm_before_train=1.812905 cos_to_last_merge=0.7892 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6961859616535617, 'auprc': 0.9241457536580087, 'loss_val': 0.8973965380839404, 'psi': 0.7873698784553405}-{'f1_val': 0.8321269695436122, 'auprc': 0.9639972405344606, 'loss_val': 0.5215021215620573, 'psi': 0.8848750779399515}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.787 u=0.0000 p_local=0.3260 f1=0.696 auprc=0.924 bytes=52091
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=60 psi=0.991 u=0.5712 p_local=0.2793 f1=0.986 auprc=0.998 bytes=68392
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[S4] r=60 psi=0.931 u=0.0000 p_local=0.0154 f1=0.932 auprc=0.930 bytes=61132
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S15] r=60 psi=0.876 u=0.0000 p_local=0.1136 f1=0.844 auprc=0.924 bytes=62926
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:57009
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9998
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] r=60 psi=0.998 u=0.0074 p_local=0.0066 f1=0.997 auprc=0.999 bytes=66567
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1043
[S15] DROPPED delta from S7 (cos=-0.1043 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] cosine check vs S6: cos=0.9990
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=0.9991
[S7] r=60 psi=0.781 u=0.0239 p_local=0.3076 f1=0.705 auprc=0.895 bytes=55780
[S6] r=60 psi=0.882 u=0.8781 p_local=0.3063 f1=0.835 auprc=0.952 bytes=55793
[S2] r=60 psi=0.669 u=0.2338 p_local=0.0880 f1=0.646 auprc=0.704 bytes=59251
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=59 metric=0.9968 head_norm=2.157084
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.889655e-02
[S9] stored merged vector for next round verification (round=59)
[S9] DEBUG after merge:  round=59 metric=0.9968 head_norm=2.155801 delta_norm=0.018897
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=60 psi=0.998 u=0.0062 p_local=0.0043 f1=0.997 auprc=0.999 bytes=64797
[S2] START round=60 head_norm_before_train=2.037431 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.6449905959170964, 'auprc': 0.7008429253357176, 'loss_val': 1.0850313990642346, 'psi': 0.6673315276845448}-{'f1_val': 0.6456876525756141, 'auprc': 0.7038847938281174, 'loss_val': 1.0529787279626255, 'psi': 0.6689665090766155}
[S3] START round=60 head_norm_before_train=2.114850 cos_to_last_merge=1.0000 (last merge round=58)
[S3] round=60 local utility u=0.303233 metrics={'f1_val': 0.8970763655470417, 'auprc': 0.9956694867703133, 'loss_val': 0.15039252572262804, 'psi': 0.9365136140363504}-{'f1_val': 0.877011652072488, 'auprc': 0.9275239404260198, 'loss_val': 0.4320332714434721, 'psi': 0.8972165674139008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=60 metric=0.8971 head_norm=2.120565
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.008996e-02
[S3] stored merged vector for next round verification (round=60)
[S3] DEBUG after merge:  round=60 metric=0.9073 head_norm=2.138316 delta_norm=0.050090
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=60 head_norm_before_train=2.025628 cos_to_last_merge=1.0000 (last merge round=58)
[S4] round=60 local utility u=0.050132 metrics={'f1_val': 0.9384416223229395, 'auprc': 0.949302879844671, 'loss_val': 0.3505473010725284, 'psi': 0.9427861253316321}-{'f1_val': 0.9321253750626783, 'auprc': 0.9300230777356562, 'loss_val': 0.355074997336616, 'psi': 0.9312844561318694}
[S5] START round=60 head_norm_before_train=2.154684 cos_to_last_merge=0.9981 (last merge round=50)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9922508777088022, 'loss_val': 0.030118399672760043, 'psi': 0.9944374512202514}-{'f1_val': 0.9966309045197074, 'auprc': 0.9992411709259121, 'loss_val': 0.028609919270103958, 'psi': 0.9976750110821893}
[S6] START round=60 head_norm_before_train=1.954474 cos_to_last_merge=0.9985 (last merge round=53)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.807741178588557, 'auprc': 0.9318327526421181, 'loss_val': 0.5368214356411389, 'psi': 0.8573778082099814}-{'f1_val': 0.8350095492213951, 'auprc': 0.9522147431452541, 'loss_val': 0.2496691877231811, 'psi': 0.8818916267909387}
[S7] START round=60 head_norm_before_train=2.049474 cos_to_last_merge=0.9396 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=60 local utility u=0.002984 metrics={'f1_val': 0.7445124965543487, 'auprc': 0.850824702766805, 'loss_val': 0.876239686071752, 'psi': 0.7870373790393312}-{'f1_val': 0.7045023390117986, 'auprc': 0.8951434938915495, 'loss_val': 0.775103347899321, 'psi': 0.780758800963699}
[S8] START round=60 head_norm_before_train=1.925897 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9840761134032961, 'loss_val': 0.4064075500096925, 'psi': 0.8218300288517113}-{'f1_val': 0.9862409241768243, 'auprc': 0.9984823500099853, 'loss_val': 0.053218610788185766, 'psi': 0.9911374945100887}
[S9] START round=60 head_norm_before_train=2.155801 cos_to_last_merge=1.0000 (last merge round=59)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9987937416653256, 'loss_val': 0.018904760865776967, 'psi': 0.9972651656456617}-{'f1_val': 0.996808967411047, 'auprc': 0.9988165542071512, 'loss_val': 0.018901446239251874, 'psi': 0.9976120021294888}
[S10] START round=60 head_norm_before_train=2.152772 cos_to_last_merge=0.9754 (last merge round=24)
[S10] round=60 local utility u=0.000542 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966551228067995, 'loss_val': 0.024939555162617994, 'psi': 0.9958559214609579}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963643389255843, 'loss_val': 0.025152114439965425, 'psi': 0.9957396079084719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=60 head_norm_before_train=1.974074 cos_to_last_merge=0.8117 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.812
[S11] round=60 local utility u=0.000263 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9977629664587842, 'loss_val': 0.02016214947272394, 'psi': 0.9970581445798457}-{'f1_val': 0.9963464252501789, 'auprc': 0.9980010996642767, 'loss_val': 0.01995171204865971, 'psi': 0.9970082950158181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=60 head_norm_before_train=1.827614 (no previous merge yet)
[S13] round=60 local utility u=0.155124 metrics={'f1_val': 0.7330152955250626, 'auprc': 0.7365297702545759, 'loss_val': 0.9577786996240147, 'psi': 0.7344210854168679}-{'f1_val': 0.6533220155214121, 'auprc': 0.7546203275942194, 'loss_val': 0.8441377055495944, 'psi': 0.693841340350535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=60 head_norm_before_train=1.949885 cos_to_last_merge=0.9998 (last merge round=56)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.945552388187782, 'auprc': 0.9986602046628874, 'loss_val': 0.06514101504579817, 'psi': 0.9667955147778242}-{'f1_val': 0.9979151217722836, 'auprc': 0.998406627745035, 'loss_val': 0.020371556034772784, 'psi': 0.9981117241613842}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.755500 cos_to_last_merge=0.8761 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=60 local utility u=0.188323 metrics={'f1_val': 0.8744240477830469, 'auprc': 0.9764035871372863, 'loss_val': 0.2929270299125076, 'psi': 0.9152158635247427}-{'f1_val': 0.8442819188807328, 'auprc': 0.9242755761678962, 'loss_val': 0.3323361385232408, 'psi': 0.8762793817955981}
[S16] START round=60 head_norm_before_train=2.162664 (no previous merge yet)
[S16] round=60 local utility u=0.005200 metrics={'f1_val': 0.9928260904633331, 'auprc': 0.9965987543166114, 'loss_val': 0.03231806611576663, 'psi': 0.9943351560046445}-{'f1_val': 0.9925332791609631, 'auprc': 0.9935201079472851, 'loss_val': 0.03172562671693243, 'psi': 0.9929280106754919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=60 head_norm_before_train=1.819765 cos_to_last_merge=0.7889 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=60 local utility u=0.705041 metrics={'f1_val': 0.8368400260287036, 'auprc': 0.9671265093439072, 'loss_val': 0.460182180870122, 'psi': 0.888954619354785}-{'f1_val': 0.6961859616535617, 'auprc': 0.9241457536580087, 'loss_val': 0.8973965380839404, 'psi': 0.7873698784553405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=60 metric=0.7137 head_norm=1.929812
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.692387e-02
[S8] stored merged vector for next round verification (round=60)
[S8] DEBUG after merge:  round=60 metric=0.7137 head_norm=1.941615 delta_norm=0.046924
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.005 → S9@127.0.0.1:57010
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=-0.1041
[S7] DROPPED delta from S15 (cos=-0.1041 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9999
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] ⇄ pheromone p=0.129 → S7@127.0.0.1:57008
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1041
[S15] DROPPED delta from S7 (cos=-0.1041 < 0.0)
[S9] ⇄ pheromone p=0.003 → S3@127.0.0.1:57003
[S6] ⇄ pheromone p=0.245 → S8@127.0.0.1:57009
[S7] ⇄ pheromone p=0.247 → S15@127.0.0.1:57015
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=60 metric=0.9384 head_norm=2.027835
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.313096e-02
[S4] stored merged vector for next round verification (round=60)
[S4] DEBUG after merge:  round=60 metric=0.9384 head_norm=2.032596 delta_norm=0.013131
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.022 → S2@127.0.0.1:57002
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=60 metric=0.6450 head_norm=2.045390
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.859086e-02
[S2] stored merged vector for next round verification (round=60)
[S2] DEBUG after merge:  round=60 metric=0.6450 head_norm=2.036546 delta_norm=0.018591
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.070 → S4@127.0.0.1:57004
[S2] START round=61 head_norm_before_train=2.036546 cos_to_last_merge=1.0000 (last merge round=60)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.6371255439633607, 'auprc': 0.7035857250083218, 'loss_val': 1.1428925817371098, 'psi': 0.6637096163813452}-{'f1_val': 0.6449905959170964, 'auprc': 0.7008429253357176, 'loss_val': 1.0850313990642346, 'psi': 0.6673315276845448}
[S3] START round=61 head_norm_before_train=2.138316 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.8398687827917972, 'auprc': 0.9665423650902536, 'loss_val': 0.3008252885371925, 'psi': 0.8905382157111799}-{'f1_val': 0.8970763655470417, 'auprc': 0.9956694867703133, 'loss_val': 0.15039252572262804, 'psi': 0.9365136140363504}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=2.032596 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=61 local utility u=0.041077 metrics={'f1_val': 0.9408336402870715, 'auprc': 0.9702291337124778, 'loss_val': 0.3455245324870841, 'psi': 0.952591837657234}-{'f1_val': 0.9384416223229395, 'auprc': 0.949302879844671, 'loss_val': 0.3505473010725284, 'psi': 0.9427861253316321}
[S5] START round=61 head_norm_before_train=2.156415 cos_to_last_merge=0.9982 (last merge round=50)
[S5] round=61 local utility u=0.014272 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9988426857242138, 'loss_val': 0.028395659039406673, 'psi': 0.9977788094563241}-{'f1_val': 0.995895166894551, 'auprc': 0.9922508777088022, 'loss_val': 0.030118399672760043, 'psi': 0.9944374512202514}
[S6] START round=61 head_norm_before_train=1.964639 cos_to_last_merge=0.9980 (last merge round=53)
[S6] round=61 local utility u=0.061144 metrics={'f1_val': 0.8218284641789404, 'auprc': 0.9376435528603262, 'loss_val': 0.5164892798089441, 'psi': 0.8681544996514947}-{'f1_val': 0.807741178588557, 'auprc': 0.9318327526421181, 'loss_val': 0.5368214356411389, 'psi': 0.8573778082099814}
[S7] START round=61 head_norm_before_train=2.060233 cos_to_last_merge=0.9384 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=61 local utility u=0.493515 metrics={'f1_val': 0.8548219826451837, 'auprc': 0.8906541761848623, 'loss_val': 0.6705546027895283, 'psi': 0.8691548600610551}-{'f1_val': 0.7445124965543487, 'auprc': 0.850824702766805, 'loss_val': 0.876239686071752, 'psi': 0.7870373790393312}
[S8] START round=61 head_norm_before_train=1.941615 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=61 local utility u=0.955877 metrics={'f1_val': 0.9712371904909858, 'auprc': 0.9988038248699078, 'loss_val': 0.08426423764201002, 'psi': 0.9822638442425546}-{'f1_val': 0.713665972483988, 'auprc': 0.9840761134032961, 'loss_val': 0.4064075500096925, 'psi': 0.8218300288517113}
[S9] START round=61 head_norm_before_train=2.167463 cos_to_last_merge=1.0000 (last merge round=59)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9968538309283959, 'loss_val': 0.019528641076845894, 'psi': 0.9967378394596932}-{'f1_val': 0.9962461149658858, 'auprc': 0.9987937416653256, 'loss_val': 0.018904760865776967, 'psi': 0.9972651656456617}
[S10] START round=61 head_norm_before_train=2.157919 cos_to_last_merge=0.9748 (last merge round=24)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966224852899406, 'loss_val': 0.025064556657379937, 'psi': 0.9958428664542145}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966551228067995, 'loss_val': 0.024939555162617994, 'psi': 0.9958559214609579}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.974884 cos_to_last_merge=0.8108 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.811
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9972340790110141, 'loss_val': 0.02260644416915355, 'psi': 0.9966767320857222}-{'f1_val': 0.9965882633272201, 'auprc': 0.9977629664587842, 'loss_val': 0.02016214947272394, 'psi': 0.9970581445798457}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.825659 (no previous merge yet)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6418547683465543, 'auprc': 0.7035832365267212, 'loss_val': 0.9496741540000262, 'psi': 0.6665461556186211}-{'f1_val': 0.7330152955250626, 'auprc': 0.7365297702545759, 'loss_val': 0.9577786996240147, 'psi': 0.7344210854168679}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.960991 cos_to_last_merge=0.9996 (last merge round=56)
[S14] round=61 local utility u=0.181642 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.999035803391902, 'loss_val': 0.01906821172724653, 'psi': 0.9985541278330838}-{'f1_val': 0.945552388187782, 'auprc': 0.9986602046628874, 'loss_val': 0.06514101504579817, 'psi': 0.9667955147778242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=61 head_norm_before_train=1.762466 cos_to_last_merge=0.8754 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.8744091213379718, 'auprc': 0.9750353094504874, 'loss_val': 0.29297065392231636, 'psi': 0.914659596582978}-{'f1_val': 0.8744240477830469, 'auprc': 0.9764035871372863, 'loss_val': 0.2929270299125076, 'psi': 0.9152158635247427}
[S16] START round=61 head_norm_before_train=2.169246 (no previous merge yet)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9435566886676745, 'auprc': 0.9902359242898633, 'loss_val': 0.2523487149234757, 'psi': 0.96222838291655}-{'f1_val': 0.9928260904633331, 'auprc': 0.9965987543166114, 'loss_val': 0.03231806611576663, 'psi': 0.9943351560046445}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.827150 cos_to_last_merge=0.7886 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.7958944605051002, 'auprc': 0.9203182709121995, 'loss_val': 0.8349365331899222, 'psi': 0.8456639846679399}-{'f1_val': 0.8368400260287036, 'auprc': 0.9671265093439072, 'loss_val': 0.460182180870122, 'psi': 0.888954619354785}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7]  timeout peer S11
[S6]  timeout peer S14
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9992
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.1038
[S15] DROPPED delta from S7 (cos=-0.1038 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9992
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=61 metric=0.8218 head_norm=1.977177
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.344415e-02
[S6] stored merged vector for next round verification (round=61)
[S6] DEBUG after merge:  round=61 metric=0.8225 head_norm=1.960814 delta_norm=0.043444
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=61 metric=0.9967 head_norm=2.174031
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.257177e-02
[S9] stored merged vector for next round verification (round=61)
[S9] DEBUG after merge:  round=61 metric=0.9967 head_norm=2.167956 delta_norm=0.022572
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=61 metric=0.6371 head_norm=2.044266
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.114899e-02
[S2] stored merged vector for next round verification (round=61)
[S2] DEBUG after merge:  round=61 metric=0.6371 head_norm=2.039912 delta_norm=0.011149
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=2.039912 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.6284894291973242, 'auprc': 0.7078846146345832, 'loss_val': 1.1824807847540455, 'psi': 0.6602475033722278}-{'f1_val': 0.6371255439633607, 'auprc': 0.7035857250083218, 'loss_val': 1.1428925817371098, 'psi': 0.6637096163813452}
[S3] START round=62 head_norm_before_train=2.143209 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=62 local utility u=0.210055 metrics={'f1_val': 0.9210993271565766, 'auprc': 0.9736448587446089, 'loss_val': 0.38940567351357536, 'psi': 0.9421175397917895}-{'f1_val': 0.8398687827917972, 'auprc': 0.9665423650902536, 'loss_val': 0.3008252885371925, 'psi': 0.8905382157111799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=62 head_norm_before_train=2.035609 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9438338054419283, 'auprc': 0.9440336812988426, 'loss_val': 0.3457909242779065, 'psi': 0.9439137557846939}-{'f1_val': 0.9408336402870715, 'auprc': 0.9702291337124778, 'loss_val': 0.3455245324870841, 'psi': 0.952591837657234}
[S5] START round=62 head_norm_before_train=2.162098 cos_to_last_merge=0.9981 (last merge round=50)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9929726233894531, 'loss_val': 0.028786845156040693, 'psi': 0.9947261494925118}-{'f1_val': 0.9970695586110643, 'auprc': 0.9988426857242138, 'loss_val': 0.028395659039406673, 'psi': 0.9977788094563241}
[S6] START round=62 head_norm_before_train=1.960814 cos_to_last_merge=1.0000 (last merge round=61)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.5875646938212964, 'auprc': 0.7277556775829509, 'loss_val': 1.1200918715643597, 'psi': 0.6436410873259581}-{'f1_val': 0.8218284641789404, 'auprc': 0.9376435528603262, 'loss_val': 0.5164892798089441, 'psi': 0.8681544996514947}
[S7] START round=62 head_norm_before_train=2.073383 cos_to_last_merge=0.9371 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=62 local utility u=0.400345 metrics={'f1_val': 0.8912295197760183, 'auprc': 0.9595592021664049, 'loss_val': 0.2950239164647372, 'psi': 0.918561392732173}-{'f1_val': 0.8548219826451837, 'auprc': 0.8906541761848623, 'loss_val': 0.6705546027895283, 'psi': 0.8691548600610551}
[S8] START round=62 head_norm_before_train=1.945285 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=62 local utility u=0.066967 metrics={'f1_val': 0.9876477851362023, 'auprc': 0.9986601751819784, 'loss_val': 0.04836319698276795, 'psi': 0.9920527411545128}-{'f1_val': 0.9712371904909858, 'auprc': 0.9988038248699078, 'loss_val': 0.08426423764201002, 'psi': 0.9822638442425546}
[S9] START round=62 head_norm_before_train=2.167956 cos_to_last_merge=1.0000 (last merge round=61)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9892304409695105, 'auprc': 0.9960158948604, 'loss_val': 0.04151199422596139, 'psi': 0.9919446225258663}-{'f1_val': 0.9966605118138915, 'auprc': 0.9968538309283959, 'loss_val': 0.019528641076845894, 'psi': 0.9967378394596932}
[S10] START round=62 head_norm_before_train=2.164231 cos_to_last_merge=0.9743 (last merge round=24)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960258461888907, 'loss_val': 0.025174501373507387, 'psi': 0.9956042108137945}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966224852899406, 'loss_val': 0.025064556657379937, 'psi': 0.9958428664542145}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.979483 cos_to_last_merge=0.8103 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.810
[S11] round=62 local utility u=0.001353 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9969463818616903, 'loss_val': 0.021521251611678987, 'psi': 0.9968099483646157}-{'f1_val': 0.996305167468861, 'auprc': 0.9972340790110141, 'loss_val': 0.02260644416915355, 'psi': 0.9966767320857222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=62 head_norm_before_train=1.829636 (no previous merge yet)
[S13] round=62 local utility u=0.127532 metrics={'f1_val': 0.6235421293777244, 'auprc': 0.817067056333429, 'loss_val': 0.925186552480801, 'psi': 0.7009521001600063}-{'f1_val': 0.6418547683465543, 'auprc': 0.7035832365267212, 'loss_val': 0.9496741540000262, 'psi': 0.6665461556186211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=62 head_norm_before_train=1.974266 cos_to_last_merge=0.9994 (last merge round=56)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9989023428457479, 'loss_val': 0.020369636244460525, 'psi': 0.9978114958367148}-{'f1_val': 0.9982330107938716, 'auprc': 0.999035803391902, 'loss_val': 0.01906821172724653, 'psi': 0.9985541278330838}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.769436 cos_to_last_merge=0.8746 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=62 local utility u=0.423836 metrics={'f1_val': 0.968945413244821, 'auprc': 0.9972085786368257, 'loss_val': 0.07903564849224799, 'psi': 0.9802506794016228}-{'f1_val': 0.8744091213379718, 'auprc': 0.9750353094504874, 'loss_val': 0.29297065392231636, 'psi': 0.914659596582978}
[S16] START round=62 head_norm_before_train=2.175469 (no previous merge yet)
[S16] round=62 local utility u=0.256479 metrics={'f1_val': 0.9927830655905525, 'auprc': 0.9910592269616942, 'loss_val': 0.03721813993060236, 'psi': 0.9920935301390092}-{'f1_val': 0.9435566886676745, 'auprc': 0.9902359242898633, 'loss_val': 0.2523487149234757, 'psi': 0.96222838291655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=62 head_norm_before_train=1.833006 cos_to_last_merge=0.7874 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.5357660366669336, 'auprc': 0.870341770130231, 'loss_val': 1.3618302131510973, 'psi': 0.6695963300522525}-{'f1_val': 0.7958944605051002, 'auprc': 0.9203182709121995, 'loss_val': 0.8349365331899222, 'psi': 0.8456639846679399}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1038
[S15] DROPPED delta from S7 (cos=-0.1038 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=-0.1038
[S7] DROPPED delta from S15 (cos=-0.1038 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9996
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=62 metric=0.9876 head_norm=1.950339
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.320057e-02
[S8] stored merged vector for next round verification (round=62)
[S8] DEBUG after merge:  round=62 metric=0.9873 head_norm=1.963328 delta_norm=0.043201
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=2.048413 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=63 local utility u=0.073549 metrics={'f1_val': 0.642632779321109, 'auprc': 0.7078143653297828, 'loss_val': 1.120031686336194, 'psi': 0.6687054137245785}-{'f1_val': 0.6284894291973242, 'auprc': 0.7078846146345832, 'loss_val': 1.1824807847540455, 'psi': 0.6602475033722278}
[S3] START round=63 head_norm_before_train=2.149559 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=63 local utility u=0.164672 metrics={'f1_val': 0.9424797028935653, 'auprc': 0.98152587354398, 'loss_val': 0.21198755469968097, 'psi': 0.9580981711537313}-{'f1_val': 0.9210993271565766, 'auprc': 0.9736448587446089, 'loss_val': 0.38940567351357536, 'psi': 0.9421175397917895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=63 head_norm_before_train=2.042258 cos_to_last_merge=0.9999 (last merge round=60)
[S4] round=63 local utility u=0.018404 metrics={'f1_val': 0.9404708730114288, 'auprc': 0.9625702885693002, 'loss_val': 0.3444144228373425, 'psi': 0.9493106392345774}-{'f1_val': 0.9438338054419283, 'auprc': 0.9440336812988426, 'loss_val': 0.3457909242779065, 'psi': 0.9439137557846939}
[S5] START round=63 head_norm_before_train=2.168626 cos_to_last_merge=0.9979 (last merge round=50)
[S5] round=63 local utility u=0.006135 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9948343004470706, 'loss_val': 0.024310743883212176, 'psi': 0.9956917113050844}-{'f1_val': 0.995895166894551, 'auprc': 0.9929726233894531, 'loss_val': 0.028786845156040693, 'psi': 0.9947261494925118}
[S6] START round=63 head_norm_before_train=1.971543 cos_to_last_merge=1.0000 (last merge round=61)
[S6] round=63 local utility u=1.000000 metrics={'f1_val': 0.8228551398768905, 'auprc': 0.9491279310887418, 'loss_val': 0.3663043066681321, 'psi': 0.8733642563616311}-{'f1_val': 0.5875646938212964, 'auprc': 0.7277556775829509, 'loss_val': 1.1200918715643597, 'psi': 0.6436410873259581}
[S7] START round=63 head_norm_before_train=2.084369 cos_to_last_merge=0.9360 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.8777778151337208, 'auprc': 0.9490440528352301, 'loss_val': 0.314045557665279, 'psi': 0.9062843102143244}-{'f1_val': 0.8912295197760183, 'auprc': 0.9595592021664049, 'loss_val': 0.2950239164647372, 'psi': 0.918561392732173}
[S8] START round=63 head_norm_before_train=1.963328 cos_to_last_merge=1.0000 (last merge round=62)
[S8] round=63 local utility u=0.010496 metrics={'f1_val': 0.9904055349873329, 'auprc': 0.9986249238109877, 'loss_val': 0.04381135612996824, 'psi': 0.9936932905167948}-{'f1_val': 0.9876477851362023, 'auprc': 0.9986601751819784, 'loss_val': 0.04836319698276795, 'psi': 0.9920527411545128}
[S9] START round=63 head_norm_before_train=2.170341 cos_to_last_merge=1.0000 (last merge round=61)
[S9] round=63 local utility u=0.033770 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964536151377064, 'loss_val': 0.01986580294356301, 'psi': 0.9965777531434175}-{'f1_val': 0.9892304409695105, 'auprc': 0.9960158948604, 'loss_val': 0.04151199422596139, 'psi': 0.9919446225258663}
[S10] START round=63 head_norm_before_train=2.171142 cos_to_last_merge=0.9739 (last merge round=24)
[S10] round=63 local utility u=0.001044 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966328826492935, 'loss_val': 0.02490774470529271, 'psi': 0.9958470253979557}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960258461888907, 'loss_val': 0.025174501373507387, 'psi': 0.9956042108137945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=63 head_norm_before_train=1.985388 cos_to_last_merge=0.8101 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.810
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9948083856753628, 'loss_val': 0.021988729705835888, 'psi': 0.9959547498900847}-{'f1_val': 0.9967189926998994, 'auprc': 0.9969463818616903, 'loss_val': 0.021521251611678987, 'psi': 0.9968099483646157}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.834910 (no previous merge yet)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.6261070711897609, 'auprc': 0.6985721354218434, 'loss_val': 1.0504153473160123, 'psi': 0.6550930968825939}-{'f1_val': 0.6235421293777244, 'auprc': 0.817067056333429, 'loss_val': 0.925186552480801, 'psi': 0.7009521001600063}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=1.984162 cos_to_last_merge=0.9993 (last merge round=56)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9849992492985962, 'auprc': 0.9985429043136977, 'loss_val': 0.03728014193784109, 'psi': 0.9904167113046368}-{'f1_val': 0.9970842644973595, 'auprc': 0.9989023428457479, 'loss_val': 0.020369636244460525, 'psi': 0.9978114958367148}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.776282 cos_to_last_merge=0.8739 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=63 local utility u=0.108067 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966018924448594, 'loss_val': 0.027888155327638976, 'psi': 0.9966887580104561}-{'f1_val': 0.968945413244821, 'auprc': 0.9972085786368257, 'loss_val': 0.07903564849224799, 'psi': 0.9802506794016228}
[S16] START round=63 head_norm_before_train=2.177916 (no previous merge yet)
[S16] round=63 local utility u=0.008312 metrics={'f1_val': 0.9928316640166417, 'auprc': 0.9944067165201872, 'loss_val': 0.03092776327185791, 'psi': 0.9934616850180599}-{'f1_val': 0.9927830655905525, 'auprc': 0.9910592269616942, 'loss_val': 0.03721813993060236, 'psi': 0.9920935301390092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=63 head_norm_before_train=1.840093 cos_to_last_merge=0.7864 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=63 local utility u=0.739511 metrics={'f1_val': 0.685563491623497, 'auprc': 0.9232161950805331, 'loss_val': 0.9402168550206289, 'psi': 0.7806245730063115}-{'f1_val': 0.5357660366669336, 'auprc': 0.870341770130231, 'loss_val': 1.3618302131510973, 'psi': 0.6695963300522525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:57004
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1037
[S7] DROPPED delta from S15 (cos=-0.1037 < 0.0)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9904 head_norm=1.969946
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.476409e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9904 head_norm=1.975092 delta_norm=0.014764
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=63 metric=0.8229 head_norm=1.980335
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.557259e-02
[S6] stored merged vector for next round verification (round=63)
[S6] DEBUG after merge:  round=63 metric=0.8232 head_norm=1.970047 delta_norm=0.025573
[S6] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.9994
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=0.9998
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=63 metric=0.6426 head_norm=2.058952
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.966631e-02
[S2] stored merged vector for next round verification (round=63)
[S2] DEBUG after merge:  round=63 metric=0.6426 head_norm=2.052516 delta_norm=0.019666
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=63 metric=0.9967 head_norm=2.176543
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.257154e-02
[S9] stored merged vector for next round verification (round=63)
[S9] DEBUG after merge:  round=63 metric=0.9967 head_norm=2.175660 delta_norm=0.022572
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=2.052516 cos_to_last_merge=1.0000 (last merge round=63)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6406705399230973, 'auprc': 0.7086187679949527, 'loss_val': 1.1262032726429572, 'psi': 0.6678498311518395}-{'f1_val': 0.642632779321109, 'auprc': 0.7078143653297828, 'loss_val': 1.120031686336194, 'psi': 0.6687054137245785}
[S3] START round=64 head_norm_before_train=2.154372 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=64 local utility u=0.077771 metrics={'f1_val': 0.9557859106584583, 'auprc': 0.9874451159953955, 'loss_val': 0.15404098977807695, 'psi': 0.9684495927932332}-{'f1_val': 0.9424797028935653, 'auprc': 0.98152587354398, 'loss_val': 0.21198755469968097, 'psi': 0.9580981711537313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=64 metric=0.9558 head_norm=2.160872
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.031129e-02
[S3] stored merged vector for next round verification (round=64)
[S3] DEBUG after merge:  round=64 metric=0.9558 head_norm=2.168347 delta_norm=0.040311
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=64 head_norm_before_train=2.046250 cos_to_last_merge=0.9999 (last merge round=60)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9343162823134595, 'auprc': 0.8740290928016851, 'loss_val': 0.3487504399956235, 'psi': 0.9102014065087498}-{'f1_val': 0.9404708730114288, 'auprc': 0.9625702885693002, 'loss_val': 0.3444144228373425, 'psi': 0.9493106392345774}
[S5] START round=64 head_norm_before_train=2.175012 cos_to_last_merge=0.9978 (last merge round=50)
[S5] round=64 local utility u=0.000092 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938117364748136, 'loss_val': 0.023691508540018082, 'psi': 0.995545875677}-{'f1_val': 0.9962633185437604, 'auprc': 0.9948343004470706, 'loss_val': 0.024310743883212176, 'psi': 0.9956917113050844}
[S6] START round=64 head_norm_before_train=1.970047 cos_to_last_merge=1.0000 (last merge round=63)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.78735675300247, 'auprc': 0.7943815166778734, 'loss_val': 0.6370433627348662, 'psi': 0.7901666584726313}-{'f1_val': 0.8228551398768905, 'auprc': 0.9491279310887418, 'loss_val': 0.3663043066681321, 'psi': 0.8733642563616311}
[S7] START round=64 head_norm_before_train=2.091355 cos_to_last_merge=0.9353 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.8666360772147514, 'auprc': 0.9609239252707944, 'loss_val': 0.3153473394376825, 'psi': 0.9043512164371685}-{'f1_val': 0.8777778151337208, 'auprc': 0.9490440528352301, 'loss_val': 0.314045557665279, 'psi': 0.9062843102143244}
[S8] START round=64 head_norm_before_train=1.975092 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.004517 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9982341830887834, 'loss_val': 0.0422919511594907, 'psi': 0.9944056023418228}-{'f1_val': 0.9904055349873329, 'auprc': 0.9986249238109877, 'loss_val': 0.04381135612996824, 'psi': 0.9936932905167948}
[S9] START round=64 head_norm_before_train=2.175660 cos_to_last_merge=1.0000 (last merge round=63)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.997771694877204, 'loss_val': 0.019867457303871534, 'psi': 0.9966047089693928}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964536151377064, 'loss_val': 0.01986580294356301, 'psi': 0.9965777531434175}
[S10] START round=64 head_norm_before_train=2.174853 cos_to_last_merge=0.9731 (last merge round=24)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9965589196052281, 'loss_val': 0.024805111921577545, 'psi': 0.9958174401803295}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966328826492935, 'loss_val': 0.02490774470529271, 'psi': 0.9958470253979557}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.989647 cos_to_last_merge=0.8100 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.810
[S11] round=64 local utility u=0.003676 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9966651639928011, 'loss_val': 0.021658691625281504, 'psi': 0.9968425634438972}-{'f1_val': 0.9967189926998994, 'auprc': 0.9948083856753628, 'loss_val': 0.021988729705835888, 'psi': 0.9959547498900847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=64 head_norm_before_train=1.839949 (no previous merge yet)
[S13] round=64 local utility u=0.723146 metrics={'f1_val': 0.7745712077612081, 'auprc': 0.793224720596206, 'loss_val': 0.7788653954132964, 'psi': 0.7820326128952073}-{'f1_val': 0.6261070711897609, 'auprc': 0.6985721354218434, 'loss_val': 1.0504153473160123, 'psi': 0.6550930968825939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=64 head_norm_before_train=1.995867 cos_to_last_merge=0.9991 (last merge round=56)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9321797047917162, 'auprc': 0.9985796235619746, 'loss_val': 0.15227610295365476, 'psi': 0.9587396722998196}-{'f1_val': 0.9849992492985962, 'auprc': 0.9985429043136977, 'loss_val': 0.03728014193784109, 'psi': 0.9904167113046368}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=1.783288 cos_to_last_merge=0.8732 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9010457098677005, 'auprc': 0.9926331574183507, 'loss_val': 0.21523533312974077, 'psi': 0.9376806888879605}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966018924448594, 'loss_val': 0.027888155327638976, 'psi': 0.9966887580104561}
[S16] START round=64 head_norm_before_train=2.181383 (no previous merge yet)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9933864712455891, 'auprc': 0.9922524511206953, 'loss_val': 0.03237870795319263, 'psi': 0.9929328631956316}-{'f1_val': 0.9928316640166417, 'auprc': 0.9944067165201872, 'loss_val': 0.03092776327185791, 'psi': 0.9934616850180599}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.847293 cos_to_last_merge=0.7862 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=64 local utility u=0.795865 metrics={'f1_val': 0.8430866273382004, 'auprc': 0.9751817516930708, 'loss_val': 0.44952218944576944, 'psi': 0.8959246770801486}-{'f1_val': 0.685563491623497, 'auprc': 0.9232161950805331, 'loss_val': 0.9402168550206289, 'psi': 0.7806245730063115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=64 metric=0.9343 head_norm=2.051238
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.170257e-02
[S4] stored merged vector for next round verification (round=64)
[S4] DEBUG after merge:  round=64 metric=0.9344 head_norm=2.054984 delta_norm=0.021703
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9999
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=64 metric=0.9958 head_norm=2.185013
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.854316e-02
[S9] stored merged vector for next round verification (round=64)
[S9] DEBUG after merge:  round=64 metric=0.9958 head_norm=2.182695 delta_norm=0.018543
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=2.064281 cos_to_last_merge=1.0000 (last merge round=63)
[S2] round=65 local utility u=0.036373 metrics={'f1_val': 0.6472493286885224, 'auprc': 0.7080094153190544, 'loss_val': 1.0911025979596354, 'psi': 0.6715533633407351}-{'f1_val': 0.6406705399230973, 'auprc': 0.7086187679949527, 'loss_val': 1.1262032726429572, 'psi': 0.6678498311518395}
[S3] START round=65 head_norm_before_train=2.168347 cos_to_last_merge=1.0000 (last merge round=64)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.7882701386288479, 'auprc': 0.9879720688653896, 'loss_val': 0.37280402291734216, 'psi': 0.8681509107234646}-{'f1_val': 0.9557859106584583, 'auprc': 0.9874451159953955, 'loss_val': 0.15404098977807695, 'psi': 0.9684495927932332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=2.054984 cos_to_last_merge=1.0000 (last merge round=64)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9325534171953719, 'auprc': 0.8661264303383608, 'loss_val': 0.3576543098780163, 'psi': 0.9059826224525674}-{'f1_val': 0.9343162823134595, 'auprc': 0.8740290928016851, 'loss_val': 0.3487504399956235, 'psi': 0.9102014065087498}
[S5] START round=65 head_norm_before_train=2.180532 cos_to_last_merge=0.9977 (last merge round=50)
[S5] round=65 local utility u=0.000411 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935524270695025, 'loss_val': 0.02209168918788758, 'psi': 0.9954421519148756}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938117364748136, 'loss_val': 0.023691508540018082, 'psi': 0.995545875677}
[S6] START round=65 head_norm_before_train=1.980956 cos_to_last_merge=1.0000 (last merge round=63)
[S6] round=65 local utility u=0.200396 metrics={'f1_val': 0.7841111897258619, 'auprc': 0.9288370882024086, 'loss_val': 0.6201448943873633, 'psi': 0.8420015491164806}-{'f1_val': 0.78735675300247, 'auprc': 0.7943815166778734, 'loss_val': 0.6370433627348662, 'psi': 0.7901666584726313}
[S7] START round=65 head_norm_before_train=2.100227 cos_to_last_merge=0.9344 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.8801247672566224, 'auprc': 0.9417427554618774, 'loss_val': 0.34898773408836953, 'psi': 0.9047719625387244}-{'f1_val': 0.8666360772147514, 'auprc': 0.9609239252707944, 'loss_val': 0.3153473394376825, 'psi': 0.9043512164371685}
[S8] START round=65 head_norm_before_train=1.981940 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9883392048726948, 'loss_val': 0.037649254567827285, 'psi': 0.9914201771268063}-{'f1_val': 0.9918532151771823, 'auprc': 0.9982341830887834, 'loss_val': 0.0422919511594907, 'psi': 0.9944056023418228}
[S9] START round=65 head_norm_before_train=2.182695 cos_to_last_merge=1.0000 (last merge round=64)
[S9] round=65 local utility u=0.002602 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9977002420771166, 'loss_val': 0.019452203260813893, 'psi': 0.9970764039191815}-{'f1_val': 0.9958267183641853, 'auprc': 0.997771694877204, 'loss_val': 0.019867457303871534, 'psi': 0.9966047089693928}
[S10] START round=65 head_norm_before_train=2.178967 cos_to_last_merge=0.9724 (last merge round=24)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964597612865309, 'loss_val': 0.02490979354175633, 'psi': 0.9957777768528506}-{'f1_val': 0.9953231205637304, 'auprc': 0.9965589196052281, 'loss_val': 0.024805111921577545, 'psi': 0.9958174401803295}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=1.995298 cos_to_last_merge=0.8099 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.810
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9972248519961573, 'loss_val': 0.022353036184514383, 'psi': 0.9966730412797795}-{'f1_val': 0.996960829744628, 'auprc': 0.9966651639928011, 'loss_val': 0.021658691625281504, 'psi': 0.9968425634438972}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.843935 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6544360589569602, 'auprc': 0.6875178860365972, 'loss_val': 1.0903168042596045, 'psi': 0.667668789788815}-{'f1_val': 0.7745712077612081, 'auprc': 0.793224720596206, 'loss_val': 0.7788653954132964, 'psi': 0.7820326128952073}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.005105 cos_to_last_merge=0.9990 (last merge round=56)
[S14] round=65 local utility u=0.044856 metrics={'f1_val': 0.9390599114177984, 'auprc': 0.998573921242792, 'loss_val': 0.10382904924889189, 'psi': 0.9628655153477959}-{'f1_val': 0.9321797047917162, 'auprc': 0.9985796235619746, 'loss_val': 0.15227610295365476, 'psi': 0.9587396722998196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=65 head_norm_before_train=1.791023 cos_to_last_merge=0.8725 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=65 local utility u=0.369549 metrics={'f1_val': 0.9922145762885469, 'auprc': 0.9967724986889128, 'loss_val': 0.03556843785537324, 'psi': 0.9940377452486933}-{'f1_val': 0.9010457098677005, 'auprc': 0.9926331574183507, 'loss_val': 0.21523533312974077, 'psi': 0.9376806888879605}
[S16] START round=65 head_norm_before_train=2.186302 (no previous merge yet)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9307971656214481, 'auprc': 0.9878154057912862, 'loss_val': 0.1503990518974958, 'psi': 0.9536044616893834}-{'f1_val': 0.9933864712455891, 'auprc': 0.9922524511206953, 'loss_val': 0.03237870795319263, 'psi': 0.9929328631956316}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.854807 cos_to_last_merge=0.7859 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.8050009145627639, 'auprc': 0.986106019281325, 'loss_val': 0.46125158295803054, 'psi': 0.8774429564501883}-{'f1_val': 0.8430866273382004, 'auprc': 0.9751817516930708, 'loss_val': 0.44952218944576944, 'psi': 0.8959246770801486}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:57003
[S7] ⇄ pheromone p=0.162 → S15@127.0.0.1:57015
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] ⇄ pheromone p=0.013 → S2@127.0.0.1:57002
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] ⇄ pheromone p=0.160 → S6@127.0.0.1:57007
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=-0.1036
[S7] DROPPED delta from S15 (cos=-0.1036 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=65 metric=0.7841 head_norm=1.992637
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.101837e-02
[S6] stored merged vector for next round verification (round=65)
[S6] DEBUG after merge:  round=65 metric=0.7844 head_norm=1.987265 delta_norm=0.011018
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.253 → S8@127.0.0.1:57009
[S5] ⇄ pheromone p=0.004 → S9@127.0.0.1:57010
[S15] ⇄ pheromone p=0.173 → S7@127.0.0.1:57008
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] cosine check vs S9: cos=0.9996
[S2] ⇄ pheromone p=0.040 → S4@127.0.0.1:57004
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=65 metric=0.9967 head_norm=2.192495
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.303198e-02
[S9] stored merged vector for next round verification (round=65)
[S9] DEBUG after merge:  round=65 metric=0.9967 head_norm=2.190099 delta_norm=0.013032
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.006 → S3@127.0.0.1:57003
[S2] START round=66 head_norm_before_train=2.075485 cos_to_last_merge=0.9999 (last merge round=63)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.6486931946928012, 'auprc': 0.7069371429156712, 'loss_val': 1.104095958201479, 'psi': 0.6719907739819492}-{'f1_val': 0.6472493286885224, 'auprc': 0.7080094153190544, 'loss_val': 1.0911025979596354, 'psi': 0.6715533633407351}
[S3] START round=66 head_norm_before_train=2.175231 cos_to_last_merge=1.0000 (last merge round=64)
[S3] round=66 local utility u=0.659544 metrics={'f1_val': 0.9610378149963086, 'auprc': 0.9945808877539182, 'loss_val': 0.11014821461956245, 'psi': 0.9744550440993525}-{'f1_val': 0.7882701386288479, 'auprc': 0.9879720688653896, 'loss_val': 0.37280402291734216, 'psi': 0.8681509107234646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=66 metric=0.9610 head_norm=2.182917
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.378861e-02
[S3] stored merged vector for next round verification (round=66)
[S3] DEBUG after merge:  round=66 metric=0.9610 head_norm=2.187450 delta_norm=0.033789
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] START round=66 head_norm_before_train=2.060895 cos_to_last_merge=1.0000 (last merge round=64)
[S4] round=66 local utility u=0.101862 metrics={'f1_val': 0.9336362055273468, 'auprc': 0.9308746828958265, 'loss_val': 0.35467191332677384, 'psi': 0.9325315964747387}-{'f1_val': 0.9325534171953719, 'auprc': 0.8661264303383608, 'loss_val': 0.3576543098780163, 'psi': 0.9059826224525674}
[S5] START round=66 head_norm_before_train=2.187777 cos_to_last_merge=0.9975 (last merge round=50)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933636671745134, 'loss_val': 0.021445633286192565, 'psi': 0.9951457540479394}-{'f1_val': 0.9967019684784577, 'auprc': 0.9935524270695025, 'loss_val': 0.02209168918788758, 'psi': 0.9954421519148756}
[S6] START round=66 head_norm_before_train=1.987265 cos_to_last_merge=1.0000 (last merge round=65)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6166776032647012, 'auprc': 0.8851352369222326, 'loss_val': 1.0339052502330097, 'psi': 0.7240606567277137}-{'f1_val': 0.7841111897258619, 'auprc': 0.9288370882024086, 'loss_val': 0.6201448943873633, 'psi': 0.8420015491164806}
[S7] START round=66 head_norm_before_train=2.113435 cos_to_last_merge=0.9331 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.5990972743490333, 'auprc': 0.7795757913377821, 'loss_val': 1.2247211488923158, 'psi': 0.6712886811445328}-{'f1_val': 0.8801247672566224, 'auprc': 0.9417427554618774, 'loss_val': 0.34898773408836953, 'psi': 0.9047719625387244}
[S8] START round=66 head_norm_before_train=1.988803 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.7721643616240959, 'auprc': 0.9851785778811701, 'loss_val': 0.2134097766713769, 'psi': 0.8573700481269255}-{'f1_val': 0.9934741586295472, 'auprc': 0.9883392048726948, 'loss_val': 0.037649254567827285, 'psi': 0.9914201771268063}
[S9] START round=66 head_norm_before_train=2.190099 cos_to_last_merge=1.0000 (last merge round=65)
[S9] round=66 local utility u=0.000440 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9977395814927763, 'loss_val': 0.01868966856537598, 'psi': 0.9970921396854454}-{'f1_val': 0.9966605118138915, 'auprc': 0.9977002420771166, 'loss_val': 0.019452203260813893, 'psi': 0.9970764039191815}
[S10] START round=66 head_norm_before_train=2.184542 cos_to_last_merge=0.9719 (last merge round=24)
[S10] round=66 local utility u=0.000056 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964999189870424, 'loss_val': 0.024917428736420503, 'psi': 0.9957938399330551}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964597612865309, 'loss_val': 0.02490979354175633, 'psi': 0.9957777768528506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=66 head_norm_before_train=2.000621 cos_to_last_merge=0.8094 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.809
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997180847537654, 'loss_val': 0.023797636470884828, 'psi': 0.9966554394963782}-{'f1_val': 0.996305167468861, 'auprc': 0.9972248519961573, 'loss_val': 0.022353036184514383, 'psi': 0.9966730412797795}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.846764 (no previous merge yet)
[S13] round=66 local utility u=0.350972 metrics={'f1_val': 0.7413931716554911, 'auprc': 0.7089039360508935, 'loss_val': 0.9742745339241081, 'psi': 0.7283974774136521}-{'f1_val': 0.6544360589569602, 'auprc': 0.6875178860365972, 'loss_val': 1.0903168042596045, 'psi': 0.667668789788815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=66 head_norm_before_train=2.013484 cos_to_last_merge=0.9988 (last merge round=56)
[S14] round=66 local utility u=0.218003 metrics={'f1_val': 0.9976724637413676, 'auprc': 0.9983638899092266, 'loss_val': 0.01886872696708807, 'psi': 0.9979490342085112}-{'f1_val': 0.9390599114177984, 'auprc': 0.998573921242792, 'loss_val': 0.10382904924889189, 'psi': 0.9628655153477959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=66 head_norm_before_train=1.798892 cos_to_last_merge=0.8717 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9010457098677005, 'auprc': 0.9952078214145643, 'loss_val': 0.2370140602511425, 'psi': 0.938710554486446}-{'f1_val': 0.9922145762885469, 'auprc': 0.9967724986889128, 'loss_val': 0.03556843785537324, 'psi': 0.9940377452486933}
[S16] START round=66 head_norm_before_train=2.191604 (no previous merge yet)
[S16] round=66 local utility u=0.253756 metrics={'f1_val': 0.993542671993396, 'auprc': 0.9920285033453826, 'loss_val': 0.03199866132586366, 'psi': 0.9929370045341906}-{'f1_val': 0.9307971656214481, 'auprc': 0.9878154057912862, 'loss_val': 0.1503990518974958, 'psi': 0.9536044616893834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=66 head_norm_before_train=1.863026 cos_to_last_merge=0.7856 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.7670324527645461, 'auprc': 0.9686424622502383, 'loss_val': 0.5928352678463028, 'psi': 0.8476764565588231}-{'f1_val': 0.8050009145627639, 'auprc': 0.986106019281325, 'loss_val': 0.46125158295803054, 'psi': 0.8774429564501883}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=66 metric=0.7722 head_norm=1.996635
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.209373e-02
[S8] stored merged vector for next round verification (round=66)
[S8] DEBUG after merge:  round=66 metric=0.7722 head_norm=1.994600 delta_norm=0.012094
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:57005
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=66 metric=0.9336 head_norm=2.070338
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.838929e-02
[S4] stored merged vector for next round verification (round=66)
[S4] DEBUG after merge:  round=66 metric=0.9336 head_norm=2.072832 delta_norm=0.018389
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=66 metric=0.6487 head_norm=2.084210
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.379311e-02
[S2] stored merged vector for next round verification (round=66)
[S2] DEBUG after merge:  round=66 metric=0.6487 head_norm=2.077149 delta_norm=0.023793
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=67 head_norm_before_train=2.077149 cos_to_last_merge=1.0000 (last merge round=66)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.6469086422808092, 'auprc': 0.7054821486457427, 'loss_val': 1.1107780836014456, 'psi': 0.6703380448267826}-{'f1_val': 0.6486931946928012, 'auprc': 0.7069371429156712, 'loss_val': 1.104095958201479, 'psi': 0.6719907739819492}
[S3] START round=67 head_norm_before_train=2.187450 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9381025229130238, 'auprc': 0.9800447810626816, 'loss_val': 0.2364723621592306, 'psi': 0.9548794261728869}-{'f1_val': 0.9610378149963086, 'auprc': 0.9945808877539182, 'loss_val': 0.11014821461956245, 'psi': 0.9744550440993525}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.072832 cos_to_last_merge=1.0000 (last merge round=66)
[S4] round=67 local utility u=0.019027 metrics={'f1_val': 0.9328291853759357, 'auprc': 0.9403680238751511, 'loss_val': 0.34025618923292594, 'psi': 0.9358447207756219}-{'f1_val': 0.9336362055273468, 'auprc': 0.9308746828958265, 'loss_val': 0.35467191332677384, 'psi': 0.9325315964747387}
[S5] START round=67 head_norm_before_train=2.198701 cos_to_last_merge=0.9973 (last merge round=50)
[S5] round=67 local utility u=0.009881 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9989023858632458, 'loss_val': 0.020509379010195887, 'psi': 0.9975821354323728}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933636671745134, 'loss_val': 0.021445633286192565, 'psi': 0.9951457540479394}
[S6] START round=67 head_norm_before_train=1.997857 cos_to_last_merge=1.0000 (last merge round=65)
[S6] round=67 local utility u=1.000000 metrics={'f1_val': 0.8849479802621386, 'auprc': 0.9390167453656603, 'loss_val': 0.27195231116816215, 'psi': 0.9065754863035472}-{'f1_val': 0.6166776032647012, 'auprc': 0.8851352369222326, 'loss_val': 1.0339052502330097, 'psi': 0.7240606567277137}
[S7] START round=67 head_norm_before_train=2.128590 cos_to_last_merge=0.9316 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=67 local utility u=1.000000 metrics={'f1_val': 0.9075864936202153, 'auprc': 0.9309554232268555, 'loss_val': 0.36962603431171265, 'psi': 0.9169340654628715}-{'f1_val': 0.5990972743490333, 'auprc': 0.7795757913377821, 'loss_val': 1.2247211488923158, 'psi': 0.6712886811445328}
[S8] START round=67 head_norm_before_train=1.994600 cos_to_last_merge=1.0000 (last merge round=66)
[S8] round=67 local utility u=0.764027 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9983027916494969, 'loss_val': 0.04068488670022143, 'psi': 0.9942154082295761}-{'f1_val': 0.7721643616240959, 'auprc': 0.9851785778811701, 'loss_val': 0.2134097766713769, 'psi': 0.8573700481269255}
[S9] START round=67 head_norm_before_train=2.198926 cos_to_last_merge=1.0000 (last merge round=65)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9977804645896886, 'loss_val': 0.02273366698649129, 'psi': 0.9954324612991182}-{'f1_val': 0.9966605118138915, 'auprc': 0.9977395814927763, 'loss_val': 0.01868966856537598, 'psi': 0.9970921396854454}
[S10] START round=67 head_norm_before_train=2.190871 cos_to_last_merge=0.9715 (last merge round=24)
[S10] round=67 local utility u=0.000001 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964865127984289, 'loss_val': 0.0248744099517511, 'psi': 0.9957884774576098}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964999189870424, 'loss_val': 0.024917428736420503, 'psi': 0.9957938399330551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=67 head_norm_before_train=2.004638 cos_to_last_merge=0.8087 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.809
[S11] round=67 local utility u=0.000268 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9973147715198865, 'loss_val': 0.023662606264910745, 'psi': 0.9967090090892712}-{'f1_val': 0.996305167468861, 'auprc': 0.997180847537654, 'loss_val': 0.023797636470884828, 'psi': 0.9966554394963782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=67 head_norm_before_train=1.850770 (no previous merge yet)
[S13] round=67 local utility u=0.050625 metrics={'f1_val': 0.6790183075724143, 'auprc': 0.7899120169159415, 'loss_val': 0.7417987071219817, 'psi': 0.7233757913098252}-{'f1_val': 0.7413931716554911, 'auprc': 0.7089039360508935, 'loss_val': 0.9742745339241081, 'psi': 0.7283974774136521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=67 head_norm_before_train=2.019580 cos_to_last_merge=0.9986 (last merge round=56)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.939329557587909, 'auprc': 0.9985846823883293, 'loss_val': 0.09678473207090618, 'psi': 0.9630316075080771}-{'f1_val': 0.9976724637413676, 'auprc': 0.9983638899092266, 'loss_val': 0.01886872696708807, 'psi': 0.9979490342085112}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.805930 cos_to_last_merge=0.8709 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=67 local utility u=0.166620 metrics={'f1_val': 0.9342321065629388, 'auprc': 0.9962583992293065, 'loss_val': 0.10604418050287906, 'psi': 0.9590426236294858}-{'f1_val': 0.9010457098677005, 'auprc': 0.9952078214145643, 'loss_val': 0.2370140602511425, 'psi': 0.938710554486446}
[S16] START round=67 head_norm_before_train=2.195810 (no previous merge yet)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.8311719132718922, 'auprc': 0.8156971448714383, 'loss_val': 1.396949833000984, 'psi': 0.8249820059117107}-{'f1_val': 0.993542671993396, 'auprc': 0.9920285033453826, 'loss_val': 0.03199866132586366, 'psi': 0.9929370045341906}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=1.868393 cos_to_last_merge=0.7852 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=67 local utility u=0.715200 metrics={'f1_val': 0.9252041481347586, 'auprc': 0.9874293385148349, 'loss_val': 0.16782511297097508, 'psi': 0.9500942242867891}-{'f1_val': 0.7670324527645461, 'auprc': 0.9686424622502383, 'loss_val': 0.5928352678463028, 'psi': 0.8476764565588231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=67 metric=0.9967 head_norm=2.207772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.408467e-02
[S5] stored merged vector for next round verification (round=67)
[S5] DEBUG after merge:  round=67 metric=0.9967 head_norm=2.203309 delta_norm=0.014085
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=-0.1032
[S7] DROPPED delta from S15 (cos=-0.1032 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=-0.1032
[S15] DROPPED delta from S7 (cos=-0.1032 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=67 metric=0.9915 head_norm=2.000024
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.344202e-02
[S8] stored merged vector for next round verification (round=67)
[S8] DEBUG after merge:  round=67 metric=0.9915 head_norm=2.003127 delta_norm=0.013442
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=67 metric=0.8849 head_norm=2.006314
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.344200e-02
[S6] stored merged vector for next round verification (round=67)
[S6] DEBUG after merge:  round=67 metric=0.8849 head_norm=2.003127 delta_norm=0.013442
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=67 metric=0.6469 head_norm=2.085179
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.013771e-02
[S2] stored merged vector for next round verification (round=67)
[S2] DEBUG after merge:  round=67 metric=0.6472 head_norm=2.082366 delta_norm=0.010138
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=2.082366 cos_to_last_merge=1.0000 (last merge round=67)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.6399661364704559, 'auprc': 0.6972418784722125, 'loss_val': 1.172569682467528, 'psi': 0.6628764332711585}-{'f1_val': 0.6469086422808092, 'auprc': 0.7054821486457427, 'loss_val': 1.1107780836014456, 'psi': 0.6703380448267826}
[S3] START round=68 head_norm_before_train=2.194104 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=68 local utility u=0.252181 metrics={'f1_val': 0.9823166983241666, 'auprc': 0.9985647084895967, 'loss_val': 0.05295569112878046, 'psi': 0.9888159023903387}-{'f1_val': 0.9381025229130238, 'auprc': 0.9800447810626816, 'loss_val': 0.2364723621592306, 'psi': 0.9548794261728869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=68 head_norm_before_train=2.079599 cos_to_last_merge=1.0000 (last merge round=66)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9336362055273468, 'auprc': 0.9376271126661242, 'loss_val': 0.3502737695443783, 'psi': 0.9352325683828577}-{'f1_val': 0.9328291853759357, 'auprc': 0.9403680238751511, 'loss_val': 0.34025618923292594, 'psi': 0.9358447207756219}
[S5] START round=68 head_norm_before_train=2.203309 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933952947898776, 'loss_val': 0.021558223225748664, 'psi': 0.9951584050940852}-{'f1_val': 0.9967019684784577, 'auprc': 0.9989023858632458, 'loss_val': 0.020509379010195887, 'psi': 0.9975821354323728}
[S6] START round=68 head_norm_before_train=2.003127 cos_to_last_merge=1.0000 (last merge round=67)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6949900380407901, 'auprc': 0.800676479079924, 'loss_val': 0.7456921019839684, 'psi': 0.7372646144564436}-{'f1_val': 0.8849479802621386, 'auprc': 0.9390167453656603, 'loss_val': 0.27195231116816215, 'psi': 0.9065754863035472}
[S7] START round=68 head_norm_before_train=2.140484 cos_to_last_merge=0.9303 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.8630677571922587, 'auprc': 0.9290487715435434, 'loss_val': 0.39692336918088333, 'psi': 0.8894601629327725}-{'f1_val': 0.9075864936202153, 'auprc': 0.9309554232268555, 'loss_val': 0.36962603431171265, 'psi': 0.9169340654628715}
[S8] START round=68 head_norm_before_train=2.003127 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9915983655414597, 'auprc': 0.9962031047754778, 'loss_val': 0.03805738479008899, 'psi': 0.993440261235067}-{'f1_val': 0.991490485949629, 'auprc': 0.9983027916494969, 'loss_val': 0.04068488670022143, 'psi': 0.9942154082295761}
[S9] START round=68 head_norm_before_train=2.206958 cos_to_last_merge=1.0000 (last merge round=65)
[S9] round=68 local utility u=0.007083 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958483218123202, 'loss_val': 0.019531519692469527, 'psi': 0.9963356358132629}-{'f1_val': 0.9938671257720713, 'auprc': 0.9977804645896886, 'loss_val': 0.02273366698649129, 'psi': 0.9954324612991182}
[S10] START round=68 head_norm_before_train=2.197556 cos_to_last_merge=0.9712 (last merge round=24)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964316614257078, 'loss_val': 0.02488703585063952, 'psi': 0.9957665369085213}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964865127984289, 'loss_val': 0.0248744099517511, 'psi': 0.9957884774576098}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.010113 cos_to_last_merge=0.8083 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9973082890194495, 'loss_val': 0.023972711532003317, 'psi': 0.9964584183289282}-{'f1_val': 0.996305167468861, 'auprc': 0.9973147715198865, 'loss_val': 0.023662606264910745, 'psi': 0.9967090090892712}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.855643 (no previous merge yet)
[S13] round=68 local utility u=0.142178 metrics={'f1_val': 0.7440218303663331, 'auprc': 0.8080552722215365, 'loss_val': 0.9018945285109881, 'psi': 0.7696352071084145}-{'f1_val': 0.6790183075724143, 'auprc': 0.7899120169159415, 'loss_val': 0.7417987071219817, 'psi': 0.7233757913098252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=68 head_norm_before_train=2.025521 cos_to_last_merge=0.9983 (last merge round=56)
[S14] round=68 local utility u=0.040734 metrics={'f1_val': 0.9477434560685771, 'auprc': 0.9985764056119156, 'loss_val': 0.06577576809665713, 'psi': 0.9680766358859125}-{'f1_val': 0.939329557587909, 'auprc': 0.9985846823883293, 'loss_val': 0.09678473207090618, 'psi': 0.9630316075080771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=68 head_norm_before_train=1.813234 cos_to_last_merge=0.8702 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.8172538134396149, 'auprc': 0.9902339805832909, 'loss_val': 0.34165950456077687, 'psi': 0.8864458802970854}-{'f1_val': 0.9342321065629388, 'auprc': 0.9962583992293065, 'loss_val': 0.10604418050287906, 'psi': 0.9590426236294858}
[S16] START round=68 head_norm_before_train=2.196508 (no previous merge yet)
[S16] round=68 local utility u=1.000000 metrics={'f1_val': 0.9929546614636195, 'auprc': 0.9915028625094219, 'loss_val': 0.03266484220191896, 'psi': 0.9923739418819405}-{'f1_val': 0.8311719132718922, 'auprc': 0.8156971448714383, 'loss_val': 1.396949833000984, 'psi': 0.8249820059117107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=68 head_norm_before_train=1.873127 cos_to_last_merge=0.7847 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.8054821132733349, 'auprc': 0.9589917535394239, 'loss_val': 0.6953344263781671, 'psi': 0.8668859693797705}-{'f1_val': 0.9252041481347586, 'auprc': 0.9874293385148349, 'loss_val': 0.16782511297097508, 'psi': 0.9500942242867891}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:57005
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9999
[S2] START round=69 head_norm_before_train=2.090751 cos_to_last_merge=1.0000 (last merge round=67)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.6363469716144905, 'auprc': 0.6889588172814368, 'loss_val': 1.1651544310582367, 'psi': 0.657391709881269}-{'f1_val': 0.6399661364704559, 'auprc': 0.6972418784722125, 'loss_val': 1.172569682467528, 'psi': 0.6628764332711585}
[S3] START round=69 head_norm_before_train=2.201020 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9940485589680389, 'loss_val': 0.15033943632274754, 'psi': 0.974288577927907}-{'f1_val': 0.9823166983241666, 'auprc': 0.9985647084895967, 'loss_val': 0.05295569112878046, 'psi': 0.9888159023903387}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=2.084305 cos_to_last_merge=1.0000 (last merge round=66)
[S4] round=69 local utility u=0.008067 metrics={'f1_val': 0.9361479724482027, 'auprc': 0.9403371567725407, 'loss_val': 0.35734054853119146, 'psi': 0.9378236461779379}-{'f1_val': 0.9336362055273468, 'auprc': 0.9376271126661242, 'loss_val': 0.3502737695443783, 'psi': 0.9352325683828577}
[S5] START round=69 head_norm_before_train=2.212739 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=69 local utility u=0.000540 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936699898908672, 'loss_val': 0.021302997842640416, 'psi': 0.995268283134481}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933952947898776, 'loss_val': 0.021558223225748664, 'psi': 0.9951584050940852}
[S6] START round=69 head_norm_before_train=2.012714 cos_to_last_merge=1.0000 (last merge round=67)
[S6] round=69 local utility u=0.778383 metrics={'f1_val': 0.8378729430749347, 'auprc': 0.9349444098808313, 'loss_val': 0.4490282308542239, 'psi': 0.8767015297972933}-{'f1_val': 0.6949900380407901, 'auprc': 0.800676479079924, 'loss_val': 0.7456921019839684, 'psi': 0.7372646144564436}
[S7] START round=69 head_norm_before_train=2.152676 cos_to_last_merge=0.9291 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.7930182055856067, 'auprc': 0.8810104362432412, 'loss_val': 0.7525399620158765, 'psi': 0.8282150978486604}-{'f1_val': 0.8630677571922587, 'auprc': 0.9290487715435434, 'loss_val': 0.39692336918088333, 'psi': 0.8894601629327725}
[S8] START round=69 head_norm_before_train=2.007325 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9876783222372405, 'loss_val': 0.03595701398543488, 'psi': 0.9911558240726246}-{'f1_val': 0.9915983655414597, 'auprc': 0.9962031047754778, 'loss_val': 0.03805738479008899, 'psi': 0.993440261235067}
[S9] START round=69 head_norm_before_train=2.215955 cos_to_last_merge=1.0000 (last merge round=65)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9985483040960192, 'loss_val': 0.029793671827540044, 'psi': 0.9936405323759838}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958483218123202, 'loss_val': 0.019531519692469527, 'psi': 0.9963356358132629}
[S10] START round=69 head_norm_before_train=2.204394 cos_to_last_merge=0.9709 (last merge round=24)
[S10] round=69 local utility u=0.001759 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975662065048749, 'loss_val': 0.02477226451193455, 'psi': 0.9962203549401882}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964316614257078, 'loss_val': 0.02488703585063952, 'psi': 0.9957665369085213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=69 head_norm_before_train=2.016826 cos_to_last_merge=0.8083 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=69 local utility u=0.003414 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975057978346986, 'loss_val': 0.021667531487548155, 'psi': 0.9969305218420332}-{'f1_val': 0.9958918378685807, 'auprc': 0.9973082890194495, 'loss_val': 0.023972711532003317, 'psi': 0.9964584183289282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=69 head_norm_before_train=1.860831 (no previous merge yet)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6625381486191769, 'auprc': 0.7943731074610227, 'loss_val': 0.9520115355111205, 'psi': 0.7152721321559152}-{'f1_val': 0.7440218303663331, 'auprc': 0.8080552722215365, 'loss_val': 0.9018945285109881, 'psi': 0.7696352071084145}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.024015 cos_to_last_merge=0.9980 (last merge round=56)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9309444101570085, 'auprc': 0.9985461129714851, 'loss_val': 0.16610056494156303, 'psi': 0.9579850912827991}-{'f1_val': 0.9477434560685771, 'auprc': 0.9985764056119156, 'loss_val': 0.06577576809665713, 'psi': 0.9680766358859125}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.819765 cos_to_last_merge=0.8696 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=69 local utility u=0.499170 metrics={'f1_val': 0.9389127526908692, 'auprc': 0.9961034044253552, 'loss_val': 0.09088057381003409, 'psi': 0.9617890133846636}-{'f1_val': 0.8172538134396149, 'auprc': 0.9902339805832909, 'loss_val': 0.34165950456077687, 'psi': 0.8864458802970854}
[S16] START round=69 head_norm_before_train=2.197908 (no previous merge yet)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9929682834285696, 'auprc': 0.9911709059251084, 'loss_val': 0.03367216212574779, 'psi': 0.992249332427185}-{'f1_val': 0.9929546614636195, 'auprc': 0.9915028625094219, 'loss_val': 0.03266484220191896, 'psi': 0.9923739418819405}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.875959 cos_to_last_merge=0.7844 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7022893573548461, 'auprc': 0.9075861676448447, 'loss_val': 1.1115462542922951, 'psi': 0.7844080814708456}-{'f1_val': 0.8054821132733349, 'auprc': 0.9589917535394239, 'loss_val': 0.6953344263781671, 'psi': 0.8668859693797705}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=69 metric=0.9963 head_norm=2.218562
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.760615e-02
[S5] stored merged vector for next round verification (round=69)
[S5] DEBUG after merge:  round=69 metric=0.9963 head_norm=2.217189 delta_norm=0.017606
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=-0.1036
[S7] DROPPED delta from S15 (cos=-0.1036 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=0.9998
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=69 metric=0.6363 head_norm=2.100394
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.946341e-02
[S2] stored merged vector for next round verification (round=69)
[S2] DEBUG after merge:  round=69 metric=0.6363 head_norm=2.095143 delta_norm=0.019463
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=2.095143 cos_to_last_merge=1.0000 (last merge round=69)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.631730644369127, 'auprc': 0.683511770170177, 'loss_val': 1.2302429123793455, 'psi': 0.652443094689547}-{'f1_val': 0.6363469716144905, 'auprc': 0.6889588172814368, 'loss_val': 1.1651544310582367, 'psi': 0.657391709881269}
[S3] START round=70 head_norm_before_train=2.207313 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9336240132787992, 'auprc': 0.9934629556180316, 'loss_val': 0.2191385372418804, 'psi': 0.9575595902144921}-{'f1_val': 0.9611152572344858, 'auprc': 0.9940485589680389, 'loss_val': 0.15033943632274754, 'psi': 0.974288577927907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.090060 cos_to_last_merge=0.9999 (last merge round=66)
[S4] round=70 local utility u=0.034594 metrics={'f1_val': 0.9437082521359105, 'auprc': 0.9473132708597114, 'loss_val': 0.354442421067552, 'psi': 0.9451502596254309}-{'f1_val': 0.9361479724482027, 'auprc': 0.9403371567725407, 'loss_val': 0.35734054853119146, 'psi': 0.9378236461779379}
[S5] START round=70 head_norm_before_train=2.217189 cos_to_last_merge=1.0000 (last merge round=69)
[S5] round=70 local utility u=0.002916 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9960701411846753, 'loss_val': 0.022671167258991803, 'psi': 0.9962283436520042}-{'f1_val': 0.9963338119635569, 'auprc': 0.9936699898908672, 'loss_val': 0.021302997842640416, 'psi': 0.995268283134481}
[S6] START round=70 head_norm_before_train=2.022554 cos_to_last_merge=0.9999 (last merge round=67)
[S6] round=70 local utility u=0.008058 metrics={'f1_val': 0.8406693131333884, 'auprc': 0.9361622038884057, 'loss_val': 0.45334447454767074, 'psi': 0.8788664694353954}-{'f1_val': 0.8378729430749347, 'auprc': 0.9349444098808313, 'loss_val': 0.4490282308542239, 'psi': 0.8767015297972933}
[S7] START round=70 head_norm_before_train=2.163946 cos_to_last_merge=0.9279 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=70 local utility u=0.471863 metrics={'f1_val': 0.8771574122276253, 'auprc': 0.9237067832704553, 'loss_val': 0.44173820174060896, 'psi': 0.8957771606447573}-{'f1_val': 0.7930182055856067, 'auprc': 0.8810104362432412, 'loss_val': 0.7525399620158765, 'psi': 0.8282150978486604}
[S8] START round=70 head_norm_before_train=2.011527 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=70 local utility u=0.009639 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9984418128333948, 'loss_val': 0.040962848979730626, 'psi': 0.9946604579362098}-{'f1_val': 0.9934741586295472, 'auprc': 0.9876783222372405, 'loss_val': 0.03595701398543488, 'psi': 0.9911558240726246}
[S9] START round=70 head_norm_before_train=2.222512 cos_to_last_merge=0.9999 (last merge round=65)
[S9] round=70 local utility u=0.019741 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955722806953238, 'loss_val': 0.019134392711376187, 'psi': 0.9962252193664644}-{'f1_val': 0.9903686845626269, 'auprc': 0.9985483040960192, 'loss_val': 0.029793671827540044, 'psi': 0.9936405323759838}
[S10] START round=70 head_norm_before_train=2.206292 cos_to_last_merge=0.9701 (last merge round=24)
[S10] round=70 local utility u=0.000110 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976138685435809, 'loss_val': 0.024695184216258163, 'psi': 0.9962394197556705}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975662065048749, 'loss_val': 0.02477226451193455, 'psi': 0.9962203549401882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=70 head_norm_before_train=2.021126 cos_to_last_merge=0.8084 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9970737079450369, 'loss_val': 0.02303999713713229, 'psi': 0.9966125836593314}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975057978346986, 'loss_val': 0.021667531487548155, 'psi': 0.9969305218420332}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.866116 (no previous merge yet)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6432477299358599, 'auprc': 0.7049839541684856, 'loss_val': 1.1090813944426283, 'psi': 0.6679422196289102}-{'f1_val': 0.6625381486191769, 'auprc': 0.7943731074610227, 'loss_val': 0.9520115355111205, 'psi': 0.7152721321559152}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.029649 cos_to_last_merge=0.9978 (last merge round=56)
[S14] round=70 local utility u=0.274556 metrics={'f1_val': 0.9974950262084489, 'auprc': 0.9989413110970637, 'loss_val': 0.01747790687959643, 'psi': 0.9980735401638948}-{'f1_val': 0.9309444101570085, 'auprc': 0.9985461129714851, 'loss_val': 0.16610056494156303, 'psi': 0.9579850912827991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=70 head_norm_before_train=1.824884 cos_to_last_merge=0.8691 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.8907557619992148, 'auprc': 0.9760471932603842, 'loss_val': 0.2138433815920786, 'psi': 0.9248723345036826}-{'f1_val': 0.9389127526908692, 'auprc': 0.9961034044253552, 'loss_val': 0.09088057381003409, 'psi': 0.9617890133846636}
[S16] START round=70 head_norm_before_train=2.201508 (no previous merge yet)
[S16] round=70 local utility u=0.004738 metrics={'f1_val': 0.9916086187935218, 'auprc': 0.998074494037423, 'loss_val': 0.03674897545080355, 'psi': 0.9941949688910823}-{'f1_val': 0.9929682834285696, 'auprc': 0.9911709059251084, 'loss_val': 0.03367216212574779, 'psi': 0.992249332427185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=70 head_norm_before_train=1.878623 cos_to_last_merge=0.7842 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=70 local utility u=1.000000 metrics={'f1_val': 0.8872517296513044, 'auprc': 0.9751998711020786, 'loss_val': 0.3561029141254149, 'psi': 0.9224309862316141}-{'f1_val': 0.7022893573548461, 'auprc': 0.9075861676448447, 'loss_val': 1.1115462542922951, 'psi': 0.7844080814708456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] ⇄ pheromone p=0.154 → S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.1036
[S15] DROPPED delta from S7 (cos=-0.1036 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9999
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=70 metric=0.9921 head_norm=2.015680
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.546034e-02
[S8] stored merged vector for next round verification (round=70)
[S8] DEBUG after merge:  round=70 metric=0.9921 head_norm=2.020808 delta_norm=0.015460
[S8] aggregate: ACCEPT kept=['S6', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.133 → S6@127.0.0.1:57007
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=70 metric=0.8407 head_norm=2.029539
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.783346e-02
[S6] stored merged vector for next round verification (round=70)
[S6] DEBUG after merge:  round=70 metric=0.8407 head_norm=2.022543 delta_norm=0.017833
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.312 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.023 → S2@127.0.0.1:57002
[S7] ⇄ pheromone p=0.250 → S15@127.0.0.1:57015
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=70 metric=0.6317 head_norm=2.104794
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.652008e-02
[S2] stored merged vector for next round verification (round=70)
[S2] DEBUG after merge:  round=70 metric=0.6317 head_norm=2.100239 delta_norm=0.016520
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.013 → S4@127.0.0.1:57004
[S9] ⇄ pheromone p=0.007 → S5@127.0.0.1:57005
[S2] START round=71 head_norm_before_train=2.100239 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.6207354425425519, 'auprc': 0.6871270068365742, 'loss_val': 1.2793582022307914, 'psi': 0.6472920682601608}-{'f1_val': 0.631730644369127, 'auprc': 0.683511770170177, 'loss_val': 1.2302429123793455, 'psi': 0.652443094689547}
[S3] START round=71 head_norm_before_train=2.210952 cos_to_last_merge=0.9999 (last merge round=66)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8875358986081194, 'auprc': 0.9813755859255707, 'loss_val': 0.4202630936247216, 'psi': 0.9250717735351}-{'f1_val': 0.9336240132787992, 'auprc': 0.9934629556180316, 'loss_val': 0.2191385372418804, 'psi': 0.9575595902144921}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.095805 cos_to_last_merge=0.9999 (last merge round=66)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9360395519408893, 'auprc': 0.9525767957452516, 'loss_val': 0.3541377842740897, 'psi': 0.9426544494626342}-{'f1_val': 0.9437082521359105, 'auprc': 0.9473132708597114, 'loss_val': 0.354442421067552, 'psi': 0.9451502596254309}
[S5] START round=71 head_norm_before_train=2.220341 cos_to_last_merge=1.0000 (last merge round=69)
[S5] round=71 local utility u=0.003485 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.997909155920197, 'loss_val': 0.023427255073737868, 'psi': 0.9971848434551533}-{'f1_val': 0.9963338119635569, 'auprc': 0.9960701411846753, 'loss_val': 0.022671167258991803, 'psi': 0.9962283436520042}
[S6] START round=71 head_norm_before_train=2.022543 cos_to_last_merge=1.0000 (last merge round=70)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.5052845705899974, 'auprc': 0.7692550952277316, 'loss_val': 1.17035057031464, 'psi': 0.6108727804450911}-{'f1_val': 0.8406693131333884, 'auprc': 0.9361622038884057, 'loss_val': 0.45334447454767074, 'psi': 0.8788664694353954}
[S7] START round=71 head_norm_before_train=2.175760 cos_to_last_merge=0.9267 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.7887101892688397, 'auprc': 0.8573742706998436, 'loss_val': 0.9073806262236048, 'psi': 0.8161758218412414}-{'f1_val': 0.8771574122276253, 'auprc': 0.9237067832704553, 'loss_val': 0.44173820174060896, 'psi': 0.8957771606447573}
[S8] START round=71 head_norm_before_train=2.020808 cos_to_last_merge=1.0000 (last merge round=70)
[S8] round=71 local utility u=0.000470 metrics={'f1_val': 0.9924339064187924, 'auprc': 0.9971373488229602, 'loss_val': 0.03787632155480894, 'psi': 0.9943152833804596}-{'f1_val': 0.9921395546714198, 'auprc': 0.9984418128333948, 'loss_val': 0.040962848979730626, 'psi': 0.9946604579362098}
[S9] START round=71 head_norm_before_train=2.228141 cos_to_last_merge=0.9999 (last merge round=65)
[S9] round=71 local utility u=0.001680 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9978534202228871, 'loss_val': 0.018520737640464933, 'psi': 0.9967278686066932}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955722806953238, 'loss_val': 0.019134392711376187, 'psi': 0.9962252193664644}
[S10] START round=71 head_norm_before_train=2.210412 cos_to_last_merge=0.9695 (last merge round=24)
[S10] round=71 local utility u=0.000104 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976515775662891, 'loss_val': 0.024600557039189588, 'psi': 0.9962545033647539}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976138685435809, 'loss_val': 0.024695184216258163, 'psi': 0.9962394197556705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=71 head_norm_before_train=2.026286 cos_to_last_merge=0.8084 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=71 local utility u=0.003204 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980703207253232, 'loss_val': 0.021072320793263887, 'psi': 0.997156330998283}-{'f1_val': 0.996305167468861, 'auprc': 0.9970737079450369, 'loss_val': 0.02303999713713229, 'psi': 0.9966125836593314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=71 head_norm_before_train=1.871246 (no previous merge yet)
[S13] round=71 local utility u=0.533444 metrics={'f1_val': 0.7048448922860304, 'auprc': 0.8424732672594716, 'loss_val': 0.8242439113792492, 'psi': 0.7598962422754069}-{'f1_val': 0.6432477299358599, 'auprc': 0.7049839541684856, 'loss_val': 1.1090813944426283, 'psi': 0.6679422196289102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=71 head_norm_before_train=2.039674 cos_to_last_merge=0.9976 (last merge round=56)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9987507843299961, 'loss_val': 0.018753953233902058, 'psi': 0.9977508724304142}-{'f1_val': 0.9974950262084489, 'auprc': 0.9989413110970637, 'loss_val': 0.01747790687959643, 'psi': 0.9980735401638948}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.830254 cos_to_last_merge=0.8686 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.8314423151581838, 'auprc': 0.9303210016567987, 'loss_val': 0.36814998517898817, 'psi': 0.8709937897576296}-{'f1_val': 0.8907557619992148, 'auprc': 0.9760471932603842, 'loss_val': 0.2138433815920786, 'psi': 0.9248723345036826}
[S16] START round=71 head_norm_before_train=2.206380 (no previous merge yet)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9466657123059808, 'auprc': 0.9967887382196202, 'loss_val': 0.15172959357696938, 'psi': 0.9667149226714365}-{'f1_val': 0.9916086187935218, 'auprc': 0.998074494037423, 'loss_val': 0.03674897545080355, 'psi': 0.9941949688910823}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.881946 cos_to_last_merge=0.7840 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.7780464461712042, 'auprc': 0.9712081941052754, 'loss_val': 0.5910202717984905, 'psi': 0.8553111453448327}-{'f1_val': 0.8872517296513044, 'auprc': 0.9751998711020786, 'loss_val': 0.3561029141254149, 'psi': 0.9224309862316141}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S3
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:57005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] cosine check vs S8: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9998
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=71 metric=0.9967 head_norm=2.229384
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.746102e-02
[S5] stored merged vector for next round verification (round=71)
[S5] DEBUG after merge:  round=71 metric=0.9967 head_norm=2.228694 delta_norm=0.017461
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=0.9999
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=71 metric=0.9960 head_norm=2.233631
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.039153e-02
[S9] stored merged vector for next round verification (round=71)
[S9] DEBUG after merge:  round=71 metric=0.9960 head_norm=2.231415 delta_norm=0.020392
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=2.108637 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=72 local utility u=0.028846 metrics={'f1_val': 0.6251142335865292, 'auprc': 0.700164938114711, 'loss_val': 1.287052619794201, 'psi': 0.6551345153978019}-{'f1_val': 0.6207354425425519, 'auprc': 0.6871270068365742, 'loss_val': 1.2793582022307914, 'psi': 0.6472920682601608}
[S3] START round=72 head_norm_before_train=2.211661 cos_to_last_merge=0.9999 (last merge round=66)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.8576230324757439, 'auprc': 0.9861439096639717, 'loss_val': 0.29865247418837, 'psi': 0.9090313833510351}-{'f1_val': 0.8875358986081194, 'auprc': 0.9813755859255707, 'loss_val': 0.4202630936247216, 'psi': 0.9250717735351}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.102251 cos_to_last_merge=0.9998 (last merge round=66)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9347417613447447, 'auprc': 0.9470285561856728, 'loss_val': 0.34699217081507694, 'psi': 0.939656479281116}-{'f1_val': 0.9360395519408893, 'auprc': 0.9525767957452516, 'loss_val': 0.3541377842740897, 'psi': 0.9426544494626342}
[S5] START round=72 head_norm_before_train=2.228694 cos_to_last_merge=1.0000 (last merge round=71)
[S5] round=72 local utility u=0.001442 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9981790915823661, 'loss_val': 0.02135252501592769, 'psi': 0.9972928177200211}-{'f1_val': 0.9967019684784577, 'auprc': 0.997909155920197, 'loss_val': 0.023427255073737868, 'psi': 0.9971848434551533}
[S6] START round=72 head_norm_before_train=2.029258 cos_to_last_merge=1.0000 (last merge round=70)
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.8438278349427067, 'auprc': 0.9544011321701296, 'loss_val': 0.3363196188061695, 'psi': 0.8880571538336759}-{'f1_val': 0.5052845705899974, 'auprc': 0.7692550952277316, 'loss_val': 1.17035057031464, 'psi': 0.6108727804450911}
[S7] START round=72 head_norm_before_train=2.184039 cos_to_last_merge=0.9258 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=72 local utility u=0.630369 metrics={'f1_val': 0.8615769308862099, 'auprc': 0.9525150560391854, 'loss_val': 0.36926554749983537, 'psi': 0.8979521809474}-{'f1_val': 0.7887101892688397, 'auprc': 0.8573742706998436, 'loss_val': 0.9073806262236048, 'psi': 0.8161758218412414}
[S8] START round=72 head_norm_before_train=2.028023 cos_to_last_merge=1.0000 (last merge round=70)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.991884704200146, 'auprc': 0.9976918297101565, 'loss_val': 0.037786252841341086, 'psi': 0.9942075544041502}-{'f1_val': 0.9924339064187924, 'auprc': 0.9971373488229602, 'loss_val': 0.03787632155480894, 'psi': 0.9943152833804596}
[S9] START round=72 head_norm_before_train=2.231415 cos_to_last_merge=1.0000 (last merge round=71)
[S9] round=72 local utility u=0.001674 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9965236350715128, 'loss_val': 0.017935762639195607, 'psi': 0.9968712015358908}-{'f1_val': 0.9959775008625639, 'auprc': 0.9978534202228871, 'loss_val': 0.018520737640464933, 'psi': 0.9967278686066932}
[S10] START round=72 head_norm_before_train=2.215769 cos_to_last_merge=0.9691 (last merge round=24)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975906955945706, 'loss_val': 0.024562821940813998, 'psi': 0.9962301505760665}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976515775662891, 'loss_val': 0.024600557039189588, 'psi': 0.9962545033647539}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.031151 cos_to_last_merge=0.8084 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981170215113183, 'loss_val': 0.02181727929684527, 'psi': 0.9970299090858439}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980703207253232, 'loss_val': 0.021072320793263887, 'psi': 0.997156330998283}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.873660 (no previous merge yet)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6108851962318926, 'auprc': 0.6848666424038454, 'loss_val': 1.2331892630462993, 'psi': 0.6404777747006738}-{'f1_val': 0.7048448922860304, 'auprc': 0.8424732672594716, 'loss_val': 0.8242439113792492, 'psi': 0.7598962422754069}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.051143 cos_to_last_merge=0.9974 (last merge round=56)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9884254885374911, 'auprc': 0.9984602227423814, 'loss_val': 0.03426580707735981, 'psi': 0.9924393822194473}-{'f1_val': 0.9970842644973595, 'auprc': 0.9987507843299961, 'loss_val': 0.018753953233902058, 'psi': 0.9977508724304142}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=1.835589 cos_to_last_merge=0.8681 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=72 local utility u=0.394622 metrics={'f1_val': 0.9039007497843756, 'auprc': 0.9912879193936296, 'loss_val': 0.19655713123134302, 'psi': 0.9388556176280772}-{'f1_val': 0.8314423151581838, 'auprc': 0.9303210016567987, 'loss_val': 0.36814998517898817, 'psi': 0.8709937897576296}
[S16] START round=72 head_norm_before_train=2.208814 (no previous merge yet)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9328895795764356, 'auprc': 0.9967380865994684, 'loss_val': 0.41801051845704956, 'psi': 0.9584289823856488}-{'f1_val': 0.9466657123059808, 'auprc': 0.9967887382196202, 'loss_val': 0.15172959357696938, 'psi': 0.9667149226714365}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.886742 cos_to_last_merge=0.7836 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6486498674672794, 'auprc': 0.9026961118530081, 'loss_val': 1.1223989044590634, 'psi': 0.7502683652215709}-{'f1_val': 0.7780464461712042, 'auprc': 0.9712081941052754, 'loss_val': 0.5910202717984905, 'psi': 0.8553111453448327}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=1.0000
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=-0.1036
[S7] DROPPED delta from S15 (cos=-0.1036 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1036
[S15] DROPPED delta from S7 (cos=-0.1036 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=72 metric=0.8438 head_norm=2.033505
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.053124e-02
[S6] stored merged vector for next round verification (round=72)
[S6] DEBUG after merge:  round=72 metric=0.8438 head_norm=2.030739 delta_norm=0.010531
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=72 metric=0.9971 head_norm=2.239133
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.505352e-03
[S9] stored merged vector for next round verification (round=72)
[S9] DEBUG after merge:  round=72 metric=0.9971 head_norm=2.239119 delta_norm=0.006505
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=72 metric=0.9967 head_norm=2.239125
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.911085e-03
[S5] stored merged vector for next round verification (round=72)
[S5] DEBUG after merge:  round=72 metric=0.9967 head_norm=2.237723 delta_norm=0.009911
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9998
[S2] START round=73 head_norm_before_train=2.117345 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=73 local utility u=0.351872 metrics={'f1_val': 0.683107587455441, 'auprc': 0.7042896094231316, 'loss_val': 0.9436423422117454, 'psi': 0.6915803962425172}-{'f1_val': 0.6251142335865292, 'auprc': 0.700164938114711, 'loss_val': 1.287052619794201, 'psi': 0.6551345153978019}
[S3] START round=73 head_norm_before_train=2.212224 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.8179788521879849, 'auprc': 0.9969314428603648, 'loss_val': 0.25936952246655187, 'psi': 0.8895598884569369}-{'f1_val': 0.8576230324757439, 'auprc': 0.9861439096639717, 'loss_val': 0.29865247418837, 'psi': 0.9090313833510351}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=2.106787 cos_to_last_merge=0.9998 (last merge round=66)
[S4] round=73 local utility u=0.023951 metrics={'f1_val': 0.9379906070079184, 'auprc': 0.9552898503234879, 'loss_val': 0.34336636079432814, 'psi': 0.9449103043341462}-{'f1_val': 0.9347417613447447, 'auprc': 0.9470285561856728, 'loss_val': 0.34699217081507694, 'psi': 0.939656479281116}
[S5] START round=73 head_norm_before_train=2.237723 cos_to_last_merge=1.0000 (last merge round=72)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9950344191634983, 'loss_val': 0.021528261617027495, 'psi': 0.996034948752474}-{'f1_val': 0.9967019684784577, 'auprc': 0.9981790915823661, 'loss_val': 0.02135252501592769, 'psi': 0.9972928177200211}
[S6] START round=73 head_norm_before_train=2.030739 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.7847679455958476, 'auprc': 0.9383962878361478, 'loss_val': 0.47494266410178015, 'psi': 0.8462192824919677}-{'f1_val': 0.8438278349427067, 'auprc': 0.9544011321701296, 'loss_val': 0.3363196188061695, 'psi': 0.8880571538336759}
[S7] START round=73 head_norm_before_train=2.194829 cos_to_last_merge=0.9247 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=73 local utility u=0.393248 metrics={'f1_val': 0.9447944027626463, 'auprc': 0.976502347187483, 'loss_val': 0.15403706039188314, 'psi': 0.957477580532581}-{'f1_val': 0.8615769308862099, 'auprc': 0.9525150560391854, 'loss_val': 0.36926554749983537, 'psi': 0.8979521809474}
[S8] START round=73 head_norm_before_train=2.036555 cos_to_last_merge=1.0000 (last merge round=70)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.99304356686603, 'auprc': 0.9899791762634264, 'loss_val': 0.034908731427303843, 'psi': 0.9918178106249885}-{'f1_val': 0.991884704200146, 'auprc': 0.9976918297101565, 'loss_val': 0.037786252841341086, 'psi': 0.9942075544041502}
[S9] START round=73 head_norm_before_train=2.239119 cos_to_last_merge=1.0000 (last merge round=72)
[S9] round=73 local utility u=0.001565 metrics={'f1_val': 0.9968062435266511, 'auprc': 0.997850086221596, 'loss_val': 0.01700521093896946, 'psi': 0.9972237806046291}-{'f1_val': 0.9971029125121428, 'auprc': 0.9965236350715128, 'loss_val': 0.017935762639195607, 'psi': 0.9968712015358908}
[S10] START round=73 head_norm_before_train=2.217013 cos_to_last_merge=0.9682 (last merge round=24)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973353382490608, 'loss_val': 0.02470996762545598, 'psi': 0.9961280076378625}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975906955945706, 'loss_val': 0.024562821940813998, 'psi': 0.9962301505760665}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.032041 cos_to_last_merge=0.8076 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980657249999918, 'loss_val': 0.022068386771117054, 'psi': 0.9970093904813133}-{'f1_val': 0.996305167468861, 'auprc': 0.9981170215113183, 'loss_val': 0.02181727929684527, 'psi': 0.9970299090858439}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.877792 (no previous merge yet)
[S13] round=73 local utility u=0.633172 metrics={'f1_val': 0.7080226909711574, 'auprc': 0.8316520787181136, 'loss_val': 0.990027325608824, 'psi': 0.7574744460699399}-{'f1_val': 0.6108851962318926, 'auprc': 0.6848666424038454, 'loss_val': 1.2331892630462993, 'psi': 0.6404777747006738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=73 head_norm_before_train=2.060753 cos_to_last_merge=0.9972 (last merge round=56)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.930904957202394, 'auprc': 0.9985457612974658, 'loss_val': 0.17109083032901548, 'psi': 0.9579612788404227}-{'f1_val': 0.9884254885374911, 'auprc': 0.9984602227423814, 'loss_val': 0.03426580707735981, 'psi': 0.9924393822194473}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.841167 cos_to_last_merge=0.8676 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=73 local utility u=0.302489 metrics={'f1_val': 0.9793361051698166, 'auprc': 0.9915339690163931, 'loss_val': 0.04493015801972443, 'psi': 0.9842152507084473}-{'f1_val': 0.9039007497843756, 'auprc': 0.9912879193936296, 'loss_val': 0.19655713123134302, 'psi': 0.9388556176280772}
[S16] START round=73 head_norm_before_train=2.212720 (no previous merge yet)
[S16] round=73 local utility u=0.345882 metrics={'f1_val': 0.9896278687974605, 'auprc': 0.9922236174441182, 'loss_val': 0.05313223341599889, 'psi': 0.9906661682561235}-{'f1_val': 0.9328895795764356, 'auprc': 0.9967380865994684, 'loss_val': 0.41801051845704956, 'psi': 0.9584289823856488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=73 head_norm_before_train=1.893918 cos_to_last_merge=0.7830 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=73 local utility u=1.000000 metrics={'f1_val': 0.8465751963515746, 'auprc': 0.9732760943810411, 'loss_val': 0.40149178722642037, 'psi': 0.8972555555633612}-{'f1_val': 0.6486498674672794, 'auprc': 0.9026961118530081, 'loss_val': 1.1223989044590634, 'psi': 0.7502683652215709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=73 metric=0.9930 head_norm=2.044210
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.474461e-02
[S8] stored merged vector for next round verification (round=73)
[S8] DEBUG after merge:  round=73 metric=0.9930 head_norm=2.038811 delta_norm=0.014745
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[S9] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S9
[S5] cosine check vs S9: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=-0.1036
[S15] DROPPED delta from S7 (cos=-0.1036 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=-0.1036
[S7] DROPPED delta from S15 (cos=-0.1036 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=73 metric=0.9380 head_norm=2.113027
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.981879e-02
[S4] stored merged vector for next round verification (round=73)
[S4] DEBUG after merge:  round=73 metric=0.9380 head_norm=2.115094 delta_norm=0.019819
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=73 metric=0.6831 head_norm=2.124692
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.402415e-02
[S2] stored merged vector for next round verification (round=73)
[S2] DEBUG after merge:  round=73 metric=0.6829 head_norm=2.118731 delta_norm=0.024024
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=74 head_norm_before_train=2.118731 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.6792934781475276, 'auprc': 0.7051021860966626, 'loss_val': 0.9486801883598083, 'psi': 0.6896169613271816}-{'f1_val': 0.683107587455441, 'auprc': 0.7042896094231316, 'loss_val': 0.9436423422117454, 'psi': 0.6915803962425172}
[S3] START round=74 head_norm_before_train=2.216724 cos_to_last_merge=0.9999 (last merge round=66)
[S3] round=74 local utility u=0.500346 metrics={'f1_val': 0.9588994304722167, 'auprc': 0.9967098361038493, 'loss_val': 0.1035354594433381, 'psi': 0.9740235927248697}-{'f1_val': 0.8179788521879849, 'auprc': 0.9969314428603648, 'loss_val': 0.25936952246655187, 'psi': 0.8895598884569369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=74 head_norm_before_train=2.115094 cos_to_last_merge=1.0000 (last merge round=73)
[S4] round=74 local utility u=0.011144 metrics={'f1_val': 0.9386517977283724, 'auprc': 0.9614377171594678, 'loss_val': 0.34348977085163623, 'psi': 0.9477661655008106}-{'f1_val': 0.9379906070079184, 'auprc': 0.9552898503234879, 'loss_val': 0.34336636079432814, 'psi': 0.9449103043341462}
[S5] START round=74 head_norm_before_train=2.246794 cos_to_last_merge=1.0000 (last merge round=72)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9947093591179711, 'loss_val': 0.02094985495752451, 'psi': 0.9959049247342631}-{'f1_val': 0.9967019684784577, 'auprc': 0.9950344191634983, 'loss_val': 0.021528261617027495, 'psi': 0.996034948752474}
[S6] START round=74 head_norm_before_train=2.036152 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.645280598173249, 'auprc': 0.9506779105408162, 'loss_val': 0.5087978195322458, 'psi': 0.767439523120276}-{'f1_val': 0.7847679455958476, 'auprc': 0.9383962878361478, 'loss_val': 0.47494266410178015, 'psi': 0.8462192824919677}
[S7] START round=74 head_norm_before_train=2.202003 cos_to_last_merge=0.9240 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5448451406562871, 'auprc': 0.568044041968045, 'loss_val': 1.920762386630717, 'psi': 0.5541247011809902}-{'f1_val': 0.9447944027626463, 'auprc': 0.976502347187483, 'loss_val': 0.15403706039188314, 'psi': 0.957477580532581}
[S8] START round=74 head_norm_before_train=2.038811 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=74 local utility u=0.001277 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9880649775700258, 'loss_val': 0.033687116775923384, 'psi': 0.9917595731992328}-{'f1_val': 0.99304356686603, 'auprc': 0.9899791762634264, 'loss_val': 0.034908731427303843, 'psi': 0.9918178106249885}
[S9] START round=74 head_norm_before_train=2.244097 cos_to_last_merge=1.0000 (last merge round=72)
[S9] round=74 local utility u=0.000762 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978371943193225, 'loss_val': 0.017223099192866735, 'psi': 0.9973966252350147}-{'f1_val': 0.9968062435266511, 'auprc': 0.997850086221596, 'loss_val': 0.01700521093896946, 'psi': 0.9972237806046291}
[S10] START round=74 head_norm_before_train=2.220813 cos_to_last_merge=0.9676 (last merge round=24)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972239320087989, 'loss_val': 0.024756449689068857, 'psi': 0.9960834451417577}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973353382490608, 'loss_val': 0.02470996762545598, 'psi': 0.9961280076378625}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.032703 cos_to_last_merge=0.8071 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9509888295289037, 'auprc': 0.9981115148587459, 'loss_val': 0.1872754643639621, 'psi': 0.9698379036608407}-{'f1_val': 0.996305167468861, 'auprc': 0.9980657249999918, 'loss_val': 0.022068386771117054, 'psi': 0.9970093904813133}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.881427 (no previous merge yet)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6279254715822011, 'auprc': 0.77688257649446, 'loss_val': 1.0953147423030298, 'psi': 0.6875083135471047}-{'f1_val': 0.7080226909711574, 'auprc': 0.8316520787181136, 'loss_val': 0.990027325608824, 'psi': 0.7574744460699399}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.068496 cos_to_last_merge=0.9970 (last merge round=56)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9304212825333331, 'auprc': 0.9985114397494357, 'loss_val': 0.17965764943209997, 'psi': 0.9576573454197741}-{'f1_val': 0.930904957202394, 'auprc': 0.9985457612974658, 'loss_val': 0.17109083032901548, 'psi': 0.9579612788404227}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.847564 cos_to_last_merge=0.8669 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9677186252446102, 'auprc': 0.9970316280543285, 'loss_val': 0.07476866779789391, 'psi': 0.9794438263684975}-{'f1_val': 0.9793361051698166, 'auprc': 0.9915339690163931, 'loss_val': 0.04493015801972443, 'psi': 0.9842152507084473}
[S16] START round=74 head_norm_before_train=2.214501 (no previous merge yet)
[S16] round=74 local utility u=0.014462 metrics={'f1_val': 0.9924726039977416, 'auprc': 0.9901111429900349, 'loss_val': 0.034938939897536374, 'psi': 0.991528019594659}-{'f1_val': 0.9896278687974605, 'auprc': 0.9922236174441182, 'loss_val': 0.05313223341599889, 'psi': 0.9906661682561235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=74 head_norm_before_train=1.900032 cos_to_last_merge=0.7824 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=74 local utility u=0.061387 metrics={'f1_val': 0.8574893099876575, 'auprc': 0.9731759640007688, 'loss_val': 0.34390289403369617, 'psi': 0.903763971592902}-{'f1_val': 0.8465751963515746, 'auprc': 0.9732760943810411, 'loss_val': 0.40149178722642037, 'psi': 0.8972555555633612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=74 metric=0.9967 head_norm=2.251091
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.117568e-02
[S5] stored merged vector for next round verification (round=74)
[S5] DEBUG after merge:  round=74 metric=0.9967 head_norm=2.247569 delta_norm=0.011176
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=74 metric=0.9387 head_norm=2.122961
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.595324e-02
[S4] stored merged vector for next round verification (round=74)
[S4] DEBUG after merge:  round=74 metric=0.9387 head_norm=2.123767 delta_norm=0.015953
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=74 metric=0.6793 head_norm=2.123971
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.127636e-02
[S2] stored merged vector for next round verification (round=74)
[S2] DEBUG after merge:  round=74 metric=0.6790 head_norm=2.123436 delta_norm=0.011276
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=2.123436 cos_to_last_merge=1.0000 (last merge round=74)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.6670882521023435, 'auprc': 0.702437859826319, 'loss_val': 0.9723706213507904, 'psi': 0.6812280951919337}-{'f1_val': 0.6792934781475276, 'auprc': 0.7051021860966626, 'loss_val': 0.9486801883598083, 'psi': 0.6896169613271816}
[S3] START round=75 head_norm_before_train=2.222850 cos_to_last_merge=0.9999 (last merge round=66)
[S3] round=75 local utility u=0.102666 metrics={'f1_val': 0.982377675479922, 'auprc': 0.9986626963361467, 'loss_val': 0.04493148637286062, 'psi': 0.9888916838224119}-{'f1_val': 0.9588994304722167, 'auprc': 0.9967098361038493, 'loss_val': 0.1035354594433381, 'psi': 0.9740235927248697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=75 head_norm_before_train=2.123767 cos_to_last_merge=1.0000 (last merge round=74)
[S4] round=75 local utility u=0.020254 metrics={'f1_val': 0.9402875589313713, 'auprc': 0.9671967013486751, 'loss_val': 0.3300734073531101, 'psi': 0.9510512158982928}-{'f1_val': 0.9386517977283724, 'auprc': 0.9614377171594678, 'loss_val': 0.34348977085163623, 'psi': 0.9477661655008106}
[S5] START round=75 head_norm_before_train=2.247569 cos_to_last_merge=1.0000 (last merge round=74)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936065969425243, 'loss_val': 0.020690381290710737, 'psi': 0.9952429259551439}-{'f1_val': 0.9967019684784577, 'auprc': 0.9947093591179711, 'loss_val': 0.02094985495752451, 'psi': 0.9959049247342631}
[S6] START round=75 head_norm_before_train=2.041659 cos_to_last_merge=0.9999 (last merge round=72)
[S6] round=75 local utility u=0.409897 metrics={'f1_val': 0.799858580587905, 'auprc': 0.929524610567326, 'loss_val': 0.5530109495692029, 'psi': 0.8517249925796735}-{'f1_val': 0.645280598173249, 'auprc': 0.9506779105408162, 'loss_val': 0.5087978195322458, 'psi': 0.767439523120276}
[S7] START round=75 head_norm_before_train=2.206362 cos_to_last_merge=0.9236 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.8677736626419511, 'auprc': 0.8831113273848534, 'loss_val': 0.6748281874129443, 'psi': 0.8739087285391121}-{'f1_val': 0.5448451406562871, 'auprc': 0.568044041968045, 'loss_val': 1.920762386630717, 'psi': 0.5541247011809902}
[S8] START round=75 head_norm_before_train=2.042902 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9899712503563753, 'auprc': 0.9983516317090516, 'loss_val': 0.03990329994016107, 'psi': 0.9933234028974458}-{'f1_val': 0.9942226369520374, 'auprc': 0.9880649775700258, 'loss_val': 0.033687116775923384, 'psi': 0.9917595731992328}
[S9] START round=75 head_norm_before_train=2.248201 cos_to_last_merge=1.0000 (last merge round=72)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9978428141627664, 'loss_val': 0.01822092011876689, 'psi': 0.9967236261826449}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978371943193225, 'loss_val': 0.017223099192866735, 'psi': 0.9973966252350147}
[S10] START round=75 head_norm_before_train=2.225920 cos_to_last_merge=0.9672 (last merge round=24)
[S10] round=75 local utility u=0.000470 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9974819976344601, 'loss_val': 0.02459016241375602, 'psi': 0.9961866713920222}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972239320087989, 'loss_val': 0.024756449689068857, 'psi': 0.9960834451417577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=75 head_norm_before_train=2.033976 cos_to_last_merge=0.8068 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=75 local utility u=0.218374 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979274178205801, 'loss_val': 0.021872848523642317, 'psi': 0.9969540676095486}-{'f1_val': 0.9509888295289037, 'auprc': 0.9981115148587459, 'loss_val': 0.1872754643639621, 'psi': 0.9698379036608407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=75 head_norm_before_train=1.884061 (no previous merge yet)
[S13] round=75 local utility u=0.164367 metrics={'f1_val': 0.6802389238353045, 'auprc': 0.7943044159800237, 'loss_val': 1.1327269471826913, 'psi': 0.7258651206931922}-{'f1_val': 0.6279254715822011, 'auprc': 0.77688257649446, 'loss_val': 1.0953147423030298, 'psi': 0.6875083135471047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=75 head_norm_before_train=2.074502 cos_to_last_merge=0.9968 (last merge round=56)
[S14] round=75 local utility u=0.275774 metrics={'f1_val': 0.9960073863923677, 'auprc': 0.9983964038060961, 'loss_val': 0.021280831570465338, 'psi': 0.9969629933578591}-{'f1_val': 0.9304212825333331, 'auprc': 0.9985114397494357, 'loss_val': 0.17965764943209997, 'psi': 0.9576573454197741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=75 head_norm_before_train=1.854093 cos_to_last_merge=0.8663 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=75 local utility u=0.064719 metrics={'f1_val': 0.9848579245915554, 'auprc': 0.9969400259729471, 'loss_val': 0.04789124939694674, 'psi': 0.9896907651441121}-{'f1_val': 0.9677186252446102, 'auprc': 0.9970316280543285, 'loss_val': 0.07476866779789391, 'psi': 0.9794438263684975}
[S16] START round=75 head_norm_before_train=2.217241 (no previous merge yet)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9923228178929865, 'auprc': 0.987560546806276, 'loss_val': 0.03346544683825444, 'psi': 0.9904179094583023}-{'f1_val': 0.9924726039977416, 'auprc': 0.9901111429900349, 'loss_val': 0.034938939897536374, 'psi': 0.991528019594659}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.906740 cos_to_last_merge=0.7815 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.6927054354620796, 'auprc': 0.9122524243105559, 'loss_val': 0.9497231471114027, 'psi': 0.7805242310014702}-{'f1_val': 0.8574893099876575, 'auprc': 0.9731759640007688, 'loss_val': 0.34390289403369617, 'psi': 0.903763971592902}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2]  timeout peer S10
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S9] ⇄ pheromone p=0.003 → S5@127.0.0.1:57005
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] ⇄ pheromone p=0.044 → S6@127.0.0.1:57007
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=75 metric=0.9963 head_norm=2.254105
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.020919e-02
[S5] stored merged vector for next round verification (round=75)
[S5] DEBUG after merge:  round=75 metric=0.9963 head_norm=2.251132 delta_norm=0.010209
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.001 → S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=-0.1031
[S7] DROPPED delta from S15 (cos=-0.1031 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=-0.1031
[S15] DROPPED delta from S7 (cos=-0.1031 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9998
[S7] ⇄ pheromone p=0.397 → S15@127.0.0.1:57015
[S15] ⇄ pheromone p=0.142 → S7@127.0.0.1:57008
[S4] ⇄ pheromone p=0.016 → S2@127.0.0.1:57002
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=75 metric=0.6671 head_norm=2.131925
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.841435e-03
[S2] stored merged vector for next round verification (round=75)
[S2] DEBUG after merge:  round=75 metric=0.6671 head_norm=2.129244 delta_norm=0.008841
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.052 → S4@127.0.0.1:57004
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=75 metric=0.7999 head_norm=2.048677
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.783433e-02
[S6] stored merged vector for next round verification (round=75)
[S6] DEBUG after merge:  round=75 metric=0.8002 head_norm=2.045714 delta_norm=0.017834
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.286 → S8@127.0.0.1:57009
[S2] START round=76 head_norm_before_train=2.129244 cos_to_last_merge=1.0000 (last merge round=75)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.668961219831059, 'auprc': 0.7045692709343256, 'loss_val': 1.022553271607235, 'psi': 0.6832044402723657}-{'f1_val': 0.6670882521023435, 'auprc': 0.702437859826319, 'loss_val': 0.9723706213507904, 'psi': 0.6812280951919337}
[S3] START round=76 head_norm_before_train=2.229109 cos_to_last_merge=0.9999 (last merge round=66)
[S3] round=76 local utility u=0.024856 metrics={'f1_val': 0.9890449807649145, 'auprc': 0.9987718862733663, 'loss_val': 0.03555135287978508, 'psi': 0.9929357429682952}-{'f1_val': 0.982377675479922, 'auprc': 0.9986626963361467, 'loss_val': 0.04493148637286062, 'psi': 0.9888916838224119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=76 head_norm_before_train=2.126597 cos_to_last_merge=1.0000 (last merge round=74)
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9393084851920401, 'auprc': 0.9406391812254591, 'loss_val': 0.3233118630182314, 'psi': 0.9398407636054077}-{'f1_val': 0.9402875589313713, 'auprc': 0.9671967013486751, 'loss_val': 0.3300734073531101, 'psi': 0.9510512158982928}
[S5] START round=76 head_norm_before_train=2.251132 cos_to_last_merge=1.0000 (last merge round=75)
[S5] round=76 local utility u=0.005254 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9959978412642686, 'loss_val': 0.01956578923606162, 'psi': 0.996420317592782}-{'f1_val': 0.9963338119635569, 'auprc': 0.9936065969425243, 'loss_val': 0.020690381290710737, 'psi': 0.9952429259551439}
[S6] START round=76 head_norm_before_train=2.045714 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=76 local utility u=0.193856 metrics={'f1_val': 0.8389235800615674, 'auprc': 0.9345448924488133, 'loss_val': 0.41474974806092485, 'psi': 0.8771721050164658}-{'f1_val': 0.799858580587905, 'auprc': 0.929524610567326, 'loss_val': 0.5530109495692029, 'psi': 0.8517249925796735}
[S7] START round=76 head_norm_before_train=2.206847 cos_to_last_merge=0.9235 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=76 local utility u=0.625328 metrics={'f1_val': 0.9524545412509567, 'auprc': 0.9708293962530707, 'loss_val': 0.19541084577403361, 'psi': 0.9598044832518022}-{'f1_val': 0.8677736626419511, 'auprc': 0.8831113273848534, 'loss_val': 0.6748281874129443, 'psi': 0.8739087285391121}
[S8] START round=76 head_norm_before_train=2.046257 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9831874160636723, 'auprc': 0.998968641153155, 'loss_val': 0.05597168406077851, 'psi': 0.9894999060994654}-{'f1_val': 0.9899712503563753, 'auprc': 0.9983516317090516, 'loss_val': 0.03990329994016107, 'psi': 0.9933234028974458}
[S9] START round=76 head_norm_before_train=2.255307 cos_to_last_merge=1.0000 (last merge round=72)
[S9] round=76 local utility u=0.004517 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979822549373479, 'loss_val': 0.016358277760849055, 'psi': 0.9974546494822248}-{'f1_val': 0.9959775008625639, 'auprc': 0.9978428141627664, 'loss_val': 0.01822092011876689, 'psi': 0.9967236261826449}
[S10] START round=76 head_norm_before_train=2.231786 cos_to_last_merge=0.9669 (last merge round=24)
[S10] round=76 local utility u=0.000124 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975682505928396, 'loss_val': 0.02460052245828021, 'psi': 0.996221172575374}-{'f1_val': 0.9953231205637304, 'auprc': 0.9974819976344601, 'loss_val': 0.02459016241375602, 'psi': 0.9961866713920222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=76 head_norm_before_train=2.036500 cos_to_last_merge=0.8066 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=76 local utility u=0.000851 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981421110925308, 'loss_val': 0.0209368220097713, 'psi': 0.9970522242500801}-{'f1_val': 0.996305167468861, 'auprc': 0.9979274178205801, 'loss_val': 0.021872848523642317, 'psi': 0.9969540676095486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=76 head_norm_before_train=1.885759 (no previous merge yet)
[S13] round=76 local utility u=0.362479 metrics={'f1_val': 0.7448825436653916, 'auprc': 0.8216801670899033, 'loss_val': 0.8777576535312807, 'psi': 0.7756015930351963}-{'f1_val': 0.6802389238353045, 'auprc': 0.7943044159800237, 'loss_val': 1.1327269471826913, 'psi': 0.7258651206931922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=76 head_norm_before_train=2.079232 cos_to_last_merge=0.9965 (last merge round=56)
[S14] round=76 local utility u=0.009850 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9988918595248818, 'loss_val': 0.016420063614452175, 'psi': 0.9984965502862757}-{'f1_val': 0.9960073863923677, 'auprc': 0.9983964038060961, 'loss_val': 0.021280831570465338, 'psi': 0.9969629933578591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=76 head_norm_before_train=1.860318 cos_to_last_merge=0.8656 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9463669364016326, 'auprc': 0.9940610615238077, 'loss_val': 0.08842115830750999, 'psi': 0.9654445864505026}-{'f1_val': 0.9848579245915554, 'auprc': 0.9969400259729471, 'loss_val': 0.04789124939694674, 'psi': 0.9896907651441121}
[S16] START round=76 head_norm_before_train=2.221787 (no previous merge yet)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9919329198697596, 'auprc': 0.9867701453494921, 'loss_val': 0.03864630502160337, 'psi': 0.9898678100616527}-{'f1_val': 0.9923228178929865, 'auprc': 0.987560546806276, 'loss_val': 0.03346544683825444, 'psi': 0.9904179094583023}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=1.913588 cos_to_last_merge=0.7810 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6609743557739773, 'auprc': 0.8816226994109235, 'loss_val': 1.1448605298901502, 'psi': 0.7492336932287558}-{'f1_val': 0.6927054354620796, 'auprc': 0.9122524243105559, 'loss_val': 0.9497231471114027, 'psi': 0.7805242310014702}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:57005
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=76 metric=0.9832 head_norm=2.049941
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.091115e-02
[S8] stored merged vector for next round verification (round=76)
[S8] DEBUG after merge:  round=76 metric=0.9832 head_norm=2.049202 delta_norm=0.020911
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=-0.1031
[S15] DROPPED delta from S7 (cos=-0.1031 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=1.0000
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=76 metric=0.9971 head_norm=2.263025
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.110238e-02
[S9] stored merged vector for next round verification (round=76)
[S9] DEBUG after merge:  round=76 metric=0.9971 head_norm=2.260837 delta_norm=0.011102
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=76 metric=0.9967 head_norm=2.258702
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.110239e-02
[S5] stored merged vector for next round verification (round=76)
[S5] DEBUG after merge:  round=76 metric=0.9967 head_norm=2.260837 delta_norm=0.011102
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=2.136917 cos_to_last_merge=1.0000 (last merge round=75)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.6509737203751768, 'auprc': 0.6994518117230328, 'loss_val': 1.1099156610728522, 'psi': 0.6703649569143192}-{'f1_val': 0.668961219831059, 'auprc': 0.7045692709343256, 'loss_val': 1.022553271607235, 'psi': 0.6832044402723657}
[S3] START round=77 head_norm_before_train=2.235207 cos_to_last_merge=0.9998 (last merge round=66)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.8364951464572534, 'auprc': 0.9894342614306854, 'loss_val': 0.35756475583596, 'psi': 0.8976707924466263}-{'f1_val': 0.9890449807649145, 'auprc': 0.9987718862733663, 'loss_val': 0.03555135287978508, 'psi': 0.9929357429682952}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.129048 cos_to_last_merge=1.0000 (last merge round=74)
[S4] round=77 local utility u=0.013746 metrics={'f1_val': 0.9394509641987034, 'auprc': 0.9529110143680025, 'loss_val': 0.3334897793536226, 'psi': 0.9448349842664231}-{'f1_val': 0.9393084851920401, 'auprc': 0.9406391812254591, 'loss_val': 0.3233118630182314, 'psi': 0.9398407636054077}
[S5] START round=77 head_norm_before_train=2.260837 cos_to_last_merge=1.0000 (last merge round=76)
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9944812278166022, 'loss_val': 0.019721776277241143, 'psi': 0.9955927783047749}-{'f1_val': 0.9967019684784577, 'auprc': 0.9959978412642686, 'loss_val': 0.01956578923606162, 'psi': 0.996420317592782}
[S6] START round=77 head_norm_before_train=2.059265 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.4628898436011062, 'auprc': 0.7337907660147297, 'loss_val': 1.604054261501579, 'psi': 0.5712502125665555}-{'f1_val': 0.8389235800615674, 'auprc': 0.9345448924488133, 'loss_val': 0.41474974806092485, 'psi': 0.8771721050164658}
[S7] START round=77 head_norm_before_train=2.209162 cos_to_last_merge=0.9232 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.8679640648576137, 'auprc': 0.8865770912369058, 'loss_val': 0.5938670684995213, 'psi': 0.8754092754093306}-{'f1_val': 0.9524545412509567, 'auprc': 0.9708293962530707, 'loss_val': 0.19541084577403361, 'psi': 0.9598044832518022}
[S8] START round=77 head_norm_before_train=2.049202 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=77 local utility u=0.013724 metrics={'f1_val': 0.9865096559284341, 'auprc': 0.998959761339718, 'loss_val': 0.04843086883702955, 'psi': 0.9914896980929476}-{'f1_val': 0.9831874160636723, 'auprc': 0.998968641153155, 'loss_val': 0.05597168406077851, 'psi': 0.9894999060994654}
[S9] START round=77 head_norm_before_train=2.260837 cos_to_last_merge=1.0000 (last merge round=76)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978842351902758, 'loss_val': 0.016666418261842997, 'psi': 0.997415441583396}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979822549373479, 'loss_val': 0.016358277760849055, 'psi': 0.9974546494822248}
[S10] START round=77 head_norm_before_train=2.238064 cos_to_last_merge=0.9667 (last merge round=24)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9974306748266017, 'loss_val': 0.02472161602114158, 'psi': 0.9961661422688789}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975682505928396, 'loss_val': 0.02460052245828021, 'psi': 0.996221172575374}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=2.037306 cos_to_last_merge=0.8060 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.806
[S11] round=77 local utility u=0.000814 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982388780582521, 'loss_val': 0.021051099599298587, 'psi': 0.9972360336070291}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981421110925308, 'loss_val': 0.0209368220097713, 'psi': 0.9970522242500801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=77 head_norm_before_train=1.887281 (no previous merge yet)
[S13] round=77 local utility u=0.075361 metrics={'f1_val': 0.7465645163758281, 'auprc': 0.8427732822647374, 'loss_val': 0.8004077373419486, 'psi': 0.7850480227313918}-{'f1_val': 0.7448825436653916, 'auprc': 0.8216801670899033, 'loss_val': 0.8777576535312807, 'psi': 0.7756015930351963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=77 head_norm_before_train=2.084956 cos_to_last_merge=0.9963 (last merge round=56)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9789050063361895, 'auprc': 0.9989508790352468, 'loss_val': 0.04225081421941098, 'psi': 0.9869233554158124}-{'f1_val': 0.9982330107938716, 'auprc': 0.9988918595248818, 'loss_val': 0.016420063614452175, 'psi': 0.9984965502862757}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.866052 cos_to_last_merge=0.8651 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=77 local utility u=0.082903 metrics={'f1_val': 0.9719996259760015, 'auprc': 0.9912427513505855, 'loss_val': 0.06795705239961111, 'psi': 0.9796968761258351}-{'f1_val': 0.9463669364016326, 'auprc': 0.9940610615238077, 'loss_val': 0.08842115830750999, 'psi': 0.9654445864505026}
[S16] START round=77 head_norm_before_train=2.223802 (no previous merge yet)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9718381342077949, 'auprc': 0.9861427377905833, 'loss_val': 0.08992684761918453, 'psi': 0.9775599756409101}-{'f1_val': 0.9919329198697596, 'auprc': 0.9867701453494921, 'loss_val': 0.03864630502160337, 'psi': 0.9898678100616527}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.918346 cos_to_last_merge=0.7804 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=77 local utility u=0.622022 metrics={'f1_val': 0.7744043456266876, 'auprc': 0.9412830654996016, 'loss_val': 0.7603773365159767, 'psi': 0.8411558335758532}-{'f1_val': 0.6609743557739773, 'auprc': 0.8816226994109235, 'loss_val': 1.1448605298901502, 'psi': 0.7492336932287558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=-0.1033
[S7] DROPPED delta from S15 (cos=-0.1033 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=77 metric=0.9865 head_norm=2.052356
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.188396e-02
[S8] stored merged vector for next round verification (round=77)
[S8] DEBUG after merge:  round=77 metric=0.9865 head_norm=2.055779 delta_norm=0.011884
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=2.144362 cos_to_last_merge=1.0000 (last merge round=75)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6490904913931203, 'auprc': 0.7009040379755749, 'loss_val': 1.1282349001553322, 'psi': 0.6698159100261021}-{'f1_val': 0.6509737203751768, 'auprc': 0.6994518117230328, 'loss_val': 1.1099156610728522, 'psi': 0.6703649569143192}
[S3] START round=78 head_norm_before_train=2.239139 cos_to_last_merge=0.9998 (last merge round=66)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.7976757424050347, 'auprc': 0.9783999900563625, 'loss_val': 0.35010937319632196, 'psi': 0.8699654414655658}-{'f1_val': 0.8364951464572534, 'auprc': 0.9894342614306854, 'loss_val': 0.35756475583596, 'psi': 0.8976707924466263}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.134593 cos_to_last_merge=0.9999 (last merge round=74)
[S4] round=78 local utility u=0.033196 metrics={'f1_val': 0.9439386373975501, 'auprc': 0.9692722393627874, 'loss_val': 0.34310704236111356, 'psi': 0.9540720781836449}-{'f1_val': 0.9394509641987034, 'auprc': 0.9529110143680025, 'loss_val': 0.3334897793536226, 'psi': 0.9448349842664231}
[S5] START round=78 head_norm_before_train=2.268736 cos_to_last_merge=1.0000 (last merge round=76)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9938540795139279, 'loss_val': 0.020526886331160843, 'psi': 0.9953419189837052}-{'f1_val': 0.9963338119635569, 'auprc': 0.9944812278166022, 'loss_val': 0.019721776277241143, 'psi': 0.9955927783047749}
[S6] START round=78 head_norm_before_train=2.070865 cos_to_last_merge=0.9999 (last merge round=75)
[S6] round=78 local utility u=0.630804 metrics={'f1_val': 0.6068971410841889, 'auprc': 0.7013576886268307, 'loss_val': 1.1091914111574095, 'psi': 0.6446813601012455}-{'f1_val': 0.4628898436011062, 'auprc': 0.7337907660147297, 'loss_val': 1.604054261501579, 'psi': 0.5712502125665555}
[S7] START round=78 head_norm_before_train=2.218093 cos_to_last_merge=0.9224 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.6890065649375607, 'auprc': 0.8056848948336927, 'loss_val': 1.2088242163267362, 'psi': 0.7356778968960135}-{'f1_val': 0.8679640648576137, 'auprc': 0.8865770912369058, 'loss_val': 0.5938670684995213, 'psi': 0.8754092754093306}
[S8] START round=78 head_norm_before_train=2.055779 cos_to_last_merge=1.0000 (last merge round=77)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.815465491735912, 'auprc': 0.985795471488281, 'loss_val': 0.17458257088422524, 'psi': 0.8835974836368596}-{'f1_val': 0.9865096559284341, 'auprc': 0.998959761339718, 'loss_val': 0.04843086883702955, 'psi': 0.9914896980929476}
[S9] START round=78 head_norm_before_train=2.266782 cos_to_last_merge=1.0000 (last merge round=76)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9978294691767728, 'loss_val': 0.016655974533306212, 'psi': 0.9971259948503559}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978842351902758, 'loss_val': 0.016666418261842997, 'psi': 0.997415441583396}
[S10] START round=78 head_norm_before_train=2.244447 cos_to_last_merge=0.9665 (last merge round=24)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973601110164241, 'loss_val': 0.024760940927046598, 'psi': 0.9961379167448079}-{'f1_val': 0.9953231205637304, 'auprc': 0.9974306748266017, 'loss_val': 0.02472161602114158, 'psi': 0.9961661422688789}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.039313 cos_to_last_merge=0.8053 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.805
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981121684923306, 'loss_val': 0.021186115466101413, 'psi': 0.9971853497806604}-{'f1_val': 0.996567470639547, 'auprc': 0.9982388780582521, 'loss_val': 0.021051099599298587, 'psi': 0.9972360336070291}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.889026 (no previous merge yet)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.7235472236653234, 'auprc': 0.8779711101318444, 'loss_val': 0.8503555994738272, 'psi': 0.7853167782519318}-{'f1_val': 0.7465645163758281, 'auprc': 0.8427732822647374, 'loss_val': 0.8004077373419486, 'psi': 0.7850480227313918}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.089043 cos_to_last_merge=0.9961 (last merge round=56)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9383228953476371, 'auprc': 0.9984875975940644, 'loss_val': 0.10787614947209044, 'psi': 0.962388776246208}-{'f1_val': 0.9789050063361895, 'auprc': 0.9989508790352468, 'loss_val': 0.04225081421941098, 'psi': 0.9869233554158124}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.871796 cos_to_last_merge=0.8646 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.8999726341641318, 'auprc': 0.9737232122424789, 'loss_val': 0.26192496650893804, 'psi': 0.9294728653954707}-{'f1_val': 0.9719996259760015, 'auprc': 0.9912427513505855, 'loss_val': 0.06795705239961111, 'psi': 0.9796968761258351}
[S16] START round=78 head_norm_before_train=2.227271 (no previous merge yet)
[S16] round=78 local utility u=0.051483 metrics={'f1_val': 0.9845020574228892, 'auprc': 0.9854503276469291, 'loss_val': 0.06086771354244942, 'psi': 0.984881365512505}-{'f1_val': 0.9718381342077949, 'auprc': 0.9861427377905833, 'loss_val': 0.08992684761918453, 'psi': 0.9775599756409101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=78 head_norm_before_train=1.924875 cos_to_last_merge=0.7799 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=78 local utility u=0.380922 metrics={'f1_val': 0.8438166666394662, 'auprc': 0.9672399349029323, 'loss_val': 0.49287691496553193, 'psi': 0.8931859739448527}-{'f1_val': 0.7744043456266876, 'auprc': 0.9412830654996016, 'loss_val': 0.7603773365159767, 'psi': 0.8411558335758532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=78 metric=0.6491 head_norm=2.151677
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.985294e-02
[S2] stored merged vector for next round verification (round=78)
[S2] DEBUG after merge:  round=78 metric=0.6487 head_norm=2.143060 delta_norm=0.019853
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=78 metric=0.6069 head_norm=2.077964
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.334606e-02
[S6] stored merged vector for next round verification (round=78)
[S6] DEBUG after merge:  round=78 metric=0.6054 head_norm=2.065068 delta_norm=0.023346
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=2.143060 cos_to_last_merge=1.0000 (last merge round=78)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.6471965808319509, 'auprc': 0.6942597607805082, 'loss_val': 1.150236565357875, 'psi': 0.6660218528113738}-{'f1_val': 0.6490904913931203, 'auprc': 0.7009040379755749, 'loss_val': 1.1282349001553322, 'psi': 0.6698159100261021}
[S3] START round=79 head_norm_before_train=2.238852 cos_to_last_merge=0.9998 (last merge round=66)
[S3] round=79 local utility u=0.743585 metrics={'f1_val': 0.9837849824105639, 'auprc': 0.9973742923612094, 'loss_val': 0.036518363828097054, 'psi': 0.989220706390822}-{'f1_val': 0.7976757424050347, 'auprc': 0.9783999900563625, 'loss_val': 0.35010937319632196, 'psi': 0.8699654414655658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=80 psi=0.989 u=0.7436 p_local=0.2081 f1=0.984 auprc=0.997 bytes=75501
[S4] START round=79 head_norm_before_train=2.143155 cos_to_last_merge=0.9999 (last merge round=74)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9383055588976401, 'auprc': 0.9333022618574311, 'loss_val': 0.3465365239724837, 'psi': 0.9363042400815564}-{'f1_val': 0.9439386373975501, 'auprc': 0.9692722393627874, 'loss_val': 0.34310704236111356, 'psi': 0.9540720781836449}
[S5] START round=79 head_norm_before_train=2.265384 cos_to_last_merge=1.0000 (last merge round=76)
[S5] round=79 local utility u=0.008062 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9981603655913502, 'loss_val': 0.01953017321588557, 'psi': 0.9972853273236146}-{'f1_val': 0.9963338119635569, 'auprc': 0.9938540795139279, 'loss_val': 0.020526886331160843, 'psi': 0.9953419189837052}
[S6] START round=79 head_norm_before_train=2.065068 cos_to_last_merge=1.0000 (last merge round=78)
[S6] round=79 local utility u=1.000000 metrics={'f1_val': 0.8093561690827276, 'auprc': 0.9227811451438075, 'loss_val': 0.38255831243146476, 'psi': 0.8547261595071596}-{'f1_val': 0.6068971410841889, 'auprc': 0.7013576886268307, 'loss_val': 1.1091914111574095, 'psi': 0.6446813601012455}
[S7] START round=79 head_norm_before_train=2.224940 cos_to_last_merge=0.9218 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=79 local utility u=0.265921 metrics={'f1_val': 0.7799160045154339, 'auprc': 0.7977853920043416, 'loss_val': 1.198739823615514, 'psi': 0.7870637595109969}-{'f1_val': 0.6890065649375607, 'auprc': 0.8056848948336927, 'loss_val': 1.2088242163267362, 'psi': 0.7356778968960135}
[S8] START round=79 head_norm_before_train=2.058834 cos_to_last_merge=1.0000 (last merge round=77)
[S8] round=79 local utility u=0.615329 metrics={'f1_val': 0.9915320055837552, 'auprc': 0.9988867402492793, 'loss_val': 0.03959830909565838, 'psi': 0.9944738994499648}-{'f1_val': 0.815465491735912, 'auprc': 0.985795471488281, 'loss_val': 0.17458257088422524, 'psi': 0.8835974836368596}
[S9] START round=79 head_norm_before_train=2.271971 cos_to_last_merge=1.0000 (last merge round=76)
[S9] round=79 local utility u=0.001286 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9978160885354994, 'loss_val': 0.01652931155283047, 'psi': 0.9973692833358199}-{'f1_val': 0.9966570119660778, 'auprc': 0.9978294691767728, 'loss_val': 0.016655974533306212, 'psi': 0.9971259948503559}
[S10] START round=79 head_norm_before_train=2.250779 cos_to_last_merge=0.9663 (last merge round=24)
[S10] round=79 local utility u=0.000380 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975789857202539, 'loss_val': 0.024657877435139298, 'psi': 0.9962254666263397}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973601110164241, 'loss_val': 0.024760940927046598, 'psi': 0.9961379167448079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=80 psi=0.996 u=0.0004 p_local=0.0002 f1=0.995 auprc=0.998 bytes=91695
[S11] START round=79 head_norm_before_train=2.044257 cos_to_last_merge=0.8051 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.805
[S11] round=79 local utility u=0.000289 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979321883851219, 'loss_val': 0.020068789534729525, 'psi': 0.997113357737777}-{'f1_val': 0.996567470639547, 'auprc': 0.9981121684923306, 'loss_val': 0.021186115466101413, 'psi': 0.9971853497806604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=80 psi=0.997 u=0.0003 p_local=0.0187 f1=0.997 auprc=0.998 bytes=95289
[S13] START round=79 head_norm_before_train=1.891703 (no previous merge yet)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6071824619322614, 'auprc': 0.6996503265377088, 'loss_val': 1.221672423452766, 'psi': 0.6441696077744403}-{'f1_val': 0.7235472236653234, 'auprc': 0.8779711101318444, 'loss_val': 0.8503555994738272, 'psi': 0.7853167782519318}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.644 u=0.0000 p_local=0.1260 f1=0.607 auprc=0.700 bytes=77370
[S14] START round=79 head_norm_before_train=2.095559 cos_to_last_merge=0.9960 (last merge round=56)
[S14] round=79 local utility u=0.184439 metrics={'f1_val': 0.9878149492781684, 'auprc': 0.9983663288236284, 'loss_val': 0.03558622089212047, 'psi': 0.9920355010963524}-{'f1_val': 0.9383228953476371, 'auprc': 0.9984875975940644, 'loss_val': 0.10787614947209044, 'psi': 0.962388776246208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=80 psi=0.992 u=0.1844 p_local=0.0725 f1=0.988 auprc=0.998 bytes=84637
[S15] START round=79 head_norm_before_train=1.877206 cos_to_last_merge=0.8642 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8313864786058465, 'loss_val': 0.7035331637336624, 'psi': 0.7530154690230145}-{'f1_val': 0.8999726341641318, 'auprc': 0.9737232122424789, 'loss_val': 0.26192496650893804, 'psi': 0.9294728653954707}
[S16] START round=79 head_norm_before_train=2.228949 (no previous merge yet)
[S16] round=79 local utility u=0.043595 metrics={'f1_val': 0.9932488004394694, 'auprc': 0.9872629059101894, 'loss_val': 0.031595303610840154, 'psi': 0.9908544426277575}-{'f1_val': 0.9845020574228892, 'auprc': 0.9854503276469291, 'loss_val': 0.06086771354244942, 'psi': 0.984881365512505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=80 psi=0.991 u=0.0436 p_local=0.0590 f1=0.993 auprc=0.987 bytes=79143
[S17] START round=79 head_norm_before_train=1.932036 cos_to_last_merge=0.7795 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=79 local utility u=0.036539 metrics={'f1_val': 0.8471458530066349, 'auprc': 0.9716449984686566, 'loss_val': 0.45298852381814897, 'psi': 0.8969455111914435}-{'f1_val': 0.8438166666394662, 'auprc': 0.9672399349029323, 'loss_val': 0.49287691496553193, 'psi': 0.8931859739448527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=80 psi=0.897 u=0.0365 p_local=0.2566 f1=0.847 auprc=0.972 bytes=70092
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=79 metric=0.6472 head_norm=2.149974
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.448348e-02
[S2] stored merged vector for next round verification (round=79)
[S2] DEBUG after merge:  round=79 metric=0.6472 head_norm=2.146518 delta_norm=0.014483
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=80 psi=0.666 u=0.0000 p_local=0.0214 f1=0.647 auprc=0.694 bytes=66444
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] r=80 psi=0.753 u=0.0000 p_local=0.0690 f1=0.701 auprc=0.831 bytes=80932
[S4] r=80 psi=0.936 u=0.0000 p_local=0.0138 f1=0.938 auprc=0.933 bytes=82729
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.1049
[S15] DROPPED delta from S7 (cos=-0.1049 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9999
[S7] r=80 psi=0.787 u=0.2659 p_local=0.2797 f1=0.780 auprc=0.798 bytes=73782
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=79 metric=0.9915 head_norm=2.061658
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.509535e-02
[S8] stored merged vector for next round verification (round=79)
[S8] DEBUG after merge:  round=79 metric=0.9912 head_norm=2.068099 delta_norm=0.015095
[S8] aggregate: ACCEPT kept=['S6', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] r=80 psi=0.994 u=0.6153 p_local=0.1427 f1=0.992 auprc=0.999 bytes=86395
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=79 metric=0.9967 head_norm=2.269257
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.888487e-02
[S5] stored merged vector for next round verification (round=79)
[S5] DEBUG after merge:  round=79 metric=0.9967 head_norm=2.273656 delta_norm=0.018885
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=80 psi=0.997 u=0.0081 p_local=0.0027 f1=0.997 auprc=0.998 bytes=86319
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=79 metric=0.8094 head_norm=2.071316
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.188707e-02
[S6] stored merged vector for next round verification (round=79)
[S6] DEBUG after merge:  round=79 metric=0.8099 head_norm=2.066459 delta_norm=0.011887
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] r=80 psi=0.855 u=1.0000 p_local=0.4381 f1=0.809 auprc=0.923 bytes=75599
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=79 metric=0.9971 head_norm=2.278204
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.888486e-02
[S9] stored merged vector for next round verification (round=79)
[S9] DEBUG after merge:  round=79 metric=0.9971 head_norm=2.273656 delta_norm=0.018885
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=80 psi=0.997 u=0.0013 p_local=0.0019 f1=0.997 auprc=0.998 bytes=84540
[S2] START round=80 head_norm_before_train=2.146518 cos_to_last_merge=1.0000 (last merge round=79)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.6400966812775934, 'auprc': 0.6929170927726479, 'loss_val': 1.241804067608797, 'psi': 0.6612248458756151}-{'f1_val': 0.6471965808319509, 'auprc': 0.6942597607805082, 'loss_val': 1.150236565357875, 'psi': 0.6660218528113738}
[S3] START round=80 head_norm_before_train=2.241718 cos_to_last_merge=0.9998 (last merge round=66)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8563836750016504, 'auprc': 0.9067823781500823, 'loss_val': 0.6200228073374728, 'psi': 0.8765431562610231}-{'f1_val': 0.9837849824105639, 'auprc': 0.9973742923612094, 'loss_val': 0.036518363828097054, 'psi': 0.989220706390822}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=2.151382 cos_to_last_merge=0.9999 (last merge round=74)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9349736198772237, 'auprc': 0.892548152725043, 'loss_val': 0.3344110919059651, 'psi': 0.9180034330163513}-{'f1_val': 0.9383055588976401, 'auprc': 0.9333022618574311, 'loss_val': 0.3465365239724837, 'psi': 0.9363042400815564}
[S5] START round=80 head_norm_before_train=2.273656 cos_to_last_merge=1.0000 (last merge round=79)
[S5] round=80 local utility u=0.002259 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9994782178721592, 'loss_val': 0.02117036345290314, 'psi': 0.9980330223155023}-{'f1_val': 0.9967019684784577, 'auprc': 0.9981603655913502, 'loss_val': 0.01953017321588557, 'psi': 0.9972853273236146}
[S6] START round=80 head_norm_before_train=2.066459 cos_to_last_merge=1.0000 (last merge round=79)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6045191225507465, 'auprc': 0.7267446328627319, 'loss_val': 1.091676236062846, 'psi': 0.6534093266755406}-{'f1_val': 0.8093561690827276, 'auprc': 0.9227811451438075, 'loss_val': 0.38255831243146476, 'psi': 0.8547261595071596}
[S7] START round=80 head_norm_before_train=2.233749 cos_to_last_merge=0.9210 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=80 local utility u=0.262791 metrics={'f1_val': 0.8265971129278342, 'auprc': 0.8221722730132331, 'loss_val': 1.0264045051022617, 'psi': 0.8248271769619937}-{'f1_val': 0.7799160045154339, 'auprc': 0.7977853920043416, 'loss_val': 1.198739823615514, 'psi': 0.7870637595109969}
[S8] START round=80 head_norm_before_train=2.068099 cos_to_last_merge=1.0000 (last merge round=79)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9663296973212137, 'auprc': 0.9987004126701066, 'loss_val': 0.10777631086649733, 'psi': 0.9792779834607708}-{'f1_val': 0.9915320055837552, 'auprc': 0.9988867402492793, 'loss_val': 0.03959830909565838, 'psi': 0.9944738994499648}
[S9] START round=80 head_norm_before_train=2.273656 cos_to_last_merge=1.0000 (last merge round=79)
[S9] round=80 local utility u=0.000061 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9978936167720444, 'loss_val': 0.016639767557601444, 'psi': 0.9974002946304379}-{'f1_val': 0.9970714132027002, 'auprc': 0.9978160885354994, 'loss_val': 0.01652931155283047, 'psi': 0.9973692833358199}
[S10] START round=80 head_norm_before_train=2.256942 cos_to_last_merge=0.9661 (last merge round=24)
[S10] round=80 local utility u=0.000049 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976063014292542, 'loss_val': 0.024641764509442908, 'psi': 0.9962363929099398}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975789857202539, 'loss_val': 0.024657877435139298, 'psi': 0.9962254666263397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=80 head_norm_before_train=2.050499 cos_to_last_merge=0.8052 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.805
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976444222687979, 'loss_val': 0.021762762725374717, 'psi': 0.9968408693888358}-{'f1_val': 0.996567470639547, 'auprc': 0.9979321883851219, 'loss_val': 0.020068789534729525, 'psi': 0.997113357737777}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.894213 (no previous merge yet)
[S13] round=80 local utility u=0.562377 metrics={'f1_val': 0.7438171448332027, 'auprc': 0.76814208227452, 'loss_val': 1.1222012223057025, 'psi': 0.7535471198097297}-{'f1_val': 0.6071824619322614, 'auprc': 0.6996503265377088, 'loss_val': 1.221672423452766, 'psi': 0.6441696077744403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=80 head_norm_before_train=2.102234 cos_to_last_merge=0.9957 (last merge round=56)
[S14] round=80 local utility u=0.040409 metrics={'f1_val': 0.9980837124267063, 'auprc': 0.99838743193869, 'loss_val': 0.016444420112673937, 'psi': 0.9982052002314998}-{'f1_val': 0.9878149492781684, 'auprc': 0.9983663288236284, 'loss_val': 0.03558622089212047, 'psi': 0.9920355010963524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=80 head_norm_before_train=1.882611 cos_to_last_merge=0.8636 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=80 local utility u=0.895318 metrics={'f1_val': 0.8774152092916521, 'auprc': 0.9544909863605124, 'loss_val': 0.3420926009316367, 'psi': 0.9082455201191962}-{'f1_val': 0.7007681293011265, 'auprc': 0.8313864786058465, 'loss_val': 0.7035331637336624, 'psi': 0.7530154690230145}
[S16] START round=80 head_norm_before_train=2.232487 (no previous merge yet)
[S16] round=80 local utility u=0.001628 metrics={'f1_val': 0.9929802681927752, 'auprc': 0.9893847310282851, 'loss_val': 0.03309331965565285, 'psi': 0.9915420533269792}-{'f1_val': 0.9932488004394694, 'auprc': 0.9872629059101894, 'loss_val': 0.031595303610840154, 'psi': 0.9908544426277575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=80 head_norm_before_train=1.938731 cos_to_last_merge=0.7789 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.8160546082304734, 'auprc': 0.9716325454978704, 'loss_val': 0.5555276743452342, 'psi': 0.8782857831374322}-{'f1_val': 0.8471458530066349, 'auprc': 0.9716449984686566, 'loss_val': 0.45298852381814897, 'psi': 0.8969455111914435}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:57005
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] ⇄ pheromone p=0.017 → S4@127.0.0.1:57004
[S5] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.114 → S6@127.0.0.1:57007
[S6] ⇄ pheromone p=0.350 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.011 → S2@127.0.0.1:57002
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=-0.1049
[S15] DROPPED delta from S7 (cos=-0.1049 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.1049
[S7] DROPPED delta from S15 (cos=-0.1049 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=1.0000
[S7] ⇄ pheromone p=0.276 → S15@127.0.0.1:57015
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=80 metric=0.9971 head_norm=2.274733
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.120251e-03
[S5] stored merged vector for next round verification (round=80)
[S5] DEBUG after merge:  round=80 metric=0.9967 head_norm=2.278076 delta_norm=0.008120
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.003 → S9@127.0.0.1:57010
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=80 metric=0.9971 head_norm=2.281444
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.120268e-03
[S9] stored merged vector for next round verification (round=80)
[S9] DEBUG after merge:  round=80 metric=0.9971 head_norm=2.278076 delta_norm=0.008120
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.002 → S5@127.0.0.1:57005
[S15] ⇄ pheromone p=0.234 → S7@127.0.0.1:57008
[S2] START round=81 head_norm_before_train=2.153487 cos_to_last_merge=1.0000 (last merge round=79)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.5985350649341236, 'auprc': 0.6792453336530612, 'loss_val': 1.4506883305527327, 'psi': 0.6308191724216986}-{'f1_val': 0.6400966812775934, 'auprc': 0.6929170927726479, 'loss_val': 1.241804067608797, 'psi': 0.6612248458756151}
[S3] START round=81 head_norm_before_train=2.240096 cos_to_last_merge=0.9997 (last merge round=66)
[S3] round=81 local utility u=0.732432 metrics={'f1_val': 0.9661466813566378, 'auprc': 0.9971738348520005, 'loss_val': 0.08491066323567546, 'psi': 0.9785575427547828}-{'f1_val': 0.8563836750016504, 'auprc': 0.9067823781500823, 'loss_val': 0.6200228073374728, 'psi': 0.8765431562610231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=81 head_norm_before_train=2.156345 cos_to_last_merge=0.9998 (last merge round=74)
[S4] round=81 local utility u=0.014189 metrics={'f1_val': 0.933647667133729, 'auprc': 0.9022160164817982, 'loss_val': 0.3270803717919005, 'psi': 0.9210750068729567}-{'f1_val': 0.9349736198772237, 'auprc': 0.892548152725043, 'loss_val': 0.3344110919059651, 'psi': 0.9180034330163513}
[S5] START round=81 head_norm_before_train=2.278076 cos_to_last_merge=1.0000 (last merge round=80)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9961435426119857, 'loss_val': 0.0196047318343488, 'psi': 0.9964785981318689}-{'f1_val': 0.9970695586110643, 'auprc': 0.9994782178721592, 'loss_val': 0.02117036345290314, 'psi': 0.9980330223155023}
[S6] START round=81 head_norm_before_train=2.071170 cos_to_last_merge=1.0000 (last merge round=79)
[S6] round=81 local utility u=0.549881 metrics={'f1_val': 0.6662633843758563, 'auprc': 0.8912935526812713, 'loss_val': 0.8560263736579687, 'psi': 0.7562754516980223}-{'f1_val': 0.6045191225507465, 'auprc': 0.7267446328627319, 'loss_val': 1.091676236062846, 'psi': 0.6534093266755406}
[S7] START round=81 head_norm_before_train=2.244875 cos_to_last_merge=0.9199 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=81 local utility u=0.307559 metrics={'f1_val': 0.8257258051701973, 'auprc': 0.8902547591950677, 'loss_val': 0.61030695606737, 'psi': 0.8515373867801455}-{'f1_val': 0.8265971129278342, 'auprc': 0.8221722730132331, 'loss_val': 1.0264045051022617, 'psi': 0.8248271769619937}
[S8] START round=81 head_norm_before_train=2.073114 cos_to_last_merge=1.0000 (last merge round=79)
[S8] round=81 local utility u=0.110160 metrics={'f1_val': 0.9918947343964528, 'auprc': 0.9968421509180205, 'loss_val': 0.035272393247176896, 'psi': 0.9938737010050799}-{'f1_val': 0.9663296973212137, 'auprc': 0.9987004126701066, 'loss_val': 0.10777631086649733, 'psi': 0.9792779834607708}
[S9] START round=81 head_norm_before_train=2.278076 cos_to_last_merge=1.0000 (last merge round=80)
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998665352302776, 'loss_val': 0.01717325137129633, 'psi': 0.9974624480094453}-{'f1_val': 0.9970714132027002, 'auprc': 0.9978936167720444, 'loss_val': 0.016639767557601444, 'psi': 0.9974002946304379}
[S10] START round=81 head_norm_before_train=2.261688 cos_to_last_merge=0.9658 (last merge round=24)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970783670523997, 'loss_val': 0.024809628237235672, 'psi': 0.9960252191591981}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976063014292542, 'loss_val': 0.024641764509442908, 'psi': 0.9962363929099398}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.057648 cos_to_last_merge=0.8054 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.805
[S11] round=81 local utility u=0.001970 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979084640860338, 'loss_val': 0.02006688057445247, 'psi': 0.9970915883425673}-{'f1_val': 0.996305167468861, 'auprc': 0.9976444222687979, 'loss_val': 0.021762762725374717, 'psi': 0.9968408693888358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=81 head_norm_before_train=1.896389 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.656155056319669, 'auprc': 0.8437037468784656, 'loss_val': 0.8668801971160336, 'psi': 0.7311745325431876}-{'f1_val': 0.7438171448332027, 'auprc': 0.76814208227452, 'loss_val': 1.1222012223057025, 'psi': 0.7535471198097297}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.108456 cos_to_last_merge=0.9953 (last merge round=56)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986607939064269, 'loss_val': 0.014938698628120367, 'psi': 0.9980809174348686}-{'f1_val': 0.9980837124267063, 'auprc': 0.99838743193869, 'loss_val': 0.016444420112673937, 'psi': 0.9982052002314998}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.887206 cos_to_last_merge=0.8632 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=81 local utility u=0.290644 metrics={'f1_val': 0.9194592242685704, 'auprc': 0.9969774774726269, 'loss_val': 0.14052904331121416, 'psi': 0.9504665255501931}-{'f1_val': 0.8774152092916521, 'auprc': 0.9544909863605124, 'loss_val': 0.3420926009316367, 'psi': 0.9082455201191962}
[S16] START round=81 head_norm_before_train=2.237930 (no previous merge yet)
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9914948834904139, 'auprc': 0.9883836193473376, 'loss_val': 0.044729572416756035, 'psi': 0.9902503778331835}-{'f1_val': 0.9929802681927752, 'auprc': 0.9893847310282851, 'loss_val': 0.03309331965565285, 'psi': 0.9915420533269792}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.944185 cos_to_last_merge=0.7783 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=81 local utility u=0.181555 metrics={'f1_val': 0.8479094661342338, 'auprc': 0.9767754350555157, 'loss_val': 0.3989749616454443, 'psi': 0.8994558537027466}-{'f1_val': 0.8160546082304734, 'auprc': 0.9716325454978704, 'loss_val': 0.5555276743452342, 'psi': 0.8782857831374322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=-0.1049
[S7] DROPPED delta from S15 (cos=-0.1049 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=-0.1049
[S15] DROPPED delta from S7 (cos=-0.1049 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S4
[S2] cosine check vs S4: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=81 metric=0.9919 head_norm=2.078401
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.651268e-03
[S8] stored merged vector for next round verification (round=81)
[S8] DEBUG after merge:  round=81 metric=0.9919 head_norm=2.076763 delta_norm=0.008651
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=81 metric=0.6663 head_norm=2.075159
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.651261e-03
[S6] stored merged vector for next round verification (round=81)
[S6] DEBUG after merge:  round=81 metric=0.6660 head_norm=2.076763 delta_norm=0.008651
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=2.160526 cos_to_last_merge=1.0000 (last merge round=79)
[S2] round=82 local utility u=0.294425 metrics={'f1_val': 0.6454525004917313, 'auprc': 0.7003339971066569, 'loss_val': 1.2066087648445227, 'psi': 0.6674050991377015}-{'f1_val': 0.5985350649341236, 'auprc': 0.6792453336530612, 'loss_val': 1.4506883305527327, 'psi': 0.6308191724216986}
[S3] START round=82 head_norm_before_train=2.239996 cos_to_last_merge=0.9997 (last merge round=66)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9186074638963181, 'auprc': 0.9843786021139485, 'loss_val': 0.24169654655023254, 'psi': 0.9449159191833703}-{'f1_val': 0.9661466813566378, 'auprc': 0.9971738348520005, 'loss_val': 0.08491066323567546, 'psi': 0.9785575427547828}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.161052 cos_to_last_merge=0.9997 (last merge round=74)
[S4] round=82 local utility u=0.031734 metrics={'f1_val': 0.9340142964122029, 'auprc': 0.9248319437502116, 'loss_val': 0.33365922441690904, 'psi': 0.9303413553474064}-{'f1_val': 0.933647667133729, 'auprc': 0.9022160164817982, 'loss_val': 0.3270803717919005, 'psi': 0.9210750068729567}
[S5] START round=82 head_norm_before_train=2.278452 cos_to_last_merge=1.0000 (last merge round=80)
[S5] round=82 local utility u=0.005616 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9994422305553483, 'loss_val': 0.020473522797751418, 'psi': 0.9980186273887779}-{'f1_val': 0.9967019684784577, 'auprc': 0.9961435426119857, 'loss_val': 0.0196047318343488, 'psi': 0.9964785981318689}
[S6] START round=82 head_norm_before_train=2.076763 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.9837181283561469, 'auprc': 0.9554499967156129, 'loss_val': 0.13047550522751408, 'psi': 0.9724108756999333}-{'f1_val': 0.6662633843758563, 'auprc': 0.8912935526812713, 'loss_val': 0.8560263736579687, 'psi': 0.7562754516980223}
[S7] START round=82 head_norm_before_train=2.256302 cos_to_last_merge=0.9190 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.7785969992234281, 'auprc': 0.7988066523262238, 'loss_val': 1.1414726586135457, 'psi': 0.7866808604645463}-{'f1_val': 0.8257258051701973, 'auprc': 0.8902547591950677, 'loss_val': 0.61030695606737, 'psi': 0.8515373867801455}
[S8] START round=82 head_norm_before_train=2.076763 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9937604981237848, 'auprc': 0.9887980661852517, 'loss_val': 0.033403569388302905, 'psi': 0.9917755253483715}-{'f1_val': 0.9918947343964528, 'auprc': 0.9968421509180205, 'loss_val': 0.035272393247176896, 'psi': 0.9938737010050799}
[S9] START round=82 head_norm_before_train=2.285714 cos_to_last_merge=1.0000 (last merge round=80)
[S9] round=82 local utility u=0.001551 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9986916109412213, 'loss_val': 0.016616267257538116, 'psi': 0.9977194922981086}-{'f1_val': 0.9966605118138915, 'auprc': 0.998665352302776, 'loss_val': 0.01717325137129633, 'psi': 0.9974624480094453}
[S10] START round=82 head_norm_before_train=2.262368 cos_to_last_merge=0.9649 (last merge round=24)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9964370881897591, 'loss_val': 0.024845309281130563, 'psi': 0.9957687076141418}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970783670523997, 'loss_val': 0.024809628237235672, 'psi': 0.9960252191591981}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.060812 cos_to_last_merge=0.8048 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.805
[S11] round=82 local utility u=0.000129 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998019673000502, 'loss_val': 0.020265213126690794, 'psi': 0.997148351583929}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979084640860338, 'loss_val': 0.02006688057445247, 'psi': 0.9970915883425673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=82 head_norm_before_train=1.897134 (no previous merge yet)
[S13] round=82 local utility u=0.445337 metrics={'f1_val': 0.7707192689859402, 'auprc': 0.8790201055954745, 'loss_val': 0.7695398762297547, 'psi': 0.8140396036297539}-{'f1_val': 0.656155056319669, 'auprc': 0.8437037468784656, 'loss_val': 0.8668801971160336, 'psi': 0.7311745325431876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=82 head_norm_before_train=2.114245 cos_to_last_merge=0.9951 (last merge round=56)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9990233714231992, 'loss_val': 0.01591194208597715, 'psi': 0.9978338199120795}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986607939064269, 'loss_val': 0.014938698628120367, 'psi': 0.9980809174348686}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=1.891605 cos_to_last_merge=0.8627 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=82 local utility u=0.163467 metrics={'f1_val': 0.9637969078627, 'auprc': 0.9937268318916086, 'loss_val': 0.06986900034279155, 'psi': 0.9757688774742634}-{'f1_val': 0.9194592242685704, 'auprc': 0.9969774774726269, 'loss_val': 0.14052904331121416, 'psi': 0.9504665255501931}
[S16] START round=82 head_norm_before_train=2.241686 (no previous merge yet)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.8669325375769921, 'auprc': 0.9825048552965651, 'loss_val': 0.9195436106117412, 'psi': 0.9131614646648213}-{'f1_val': 0.9914948834904139, 'auprc': 0.9883836193473376, 'loss_val': 0.044729572416756035, 'psi': 0.9902503778331835}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.949039 cos_to_last_merge=0.7778 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.8020633394522971, 'auprc': 0.9708014041323703, 'loss_val': 0.6120200728165759, 'psi': 0.8695585653243264}-{'f1_val': 0.8479094661342338, 'auprc': 0.9767754350555157, 'loss_val': 0.3989749616454443, 'psi': 0.8994558537027466}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:57005
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=-0.1048
[S7] DROPPED delta from S15 (cos=-0.1048 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=1.0000
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=82 metric=0.6455 head_norm=2.166296
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.277905e-02
[S2] stored merged vector for next round verification (round=82)
[S2] DEBUG after merge:  round=82 metric=0.6460 head_norm=2.164043 delta_norm=0.022779
[S2] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=82 metric=0.9340 head_norm=2.163031
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.368113e-02
[S4] stored merged vector for next round verification (round=82)
[S4] DEBUG after merge:  round=82 metric=0.9340 head_norm=2.164535 delta_norm=0.023681
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=82 metric=0.9971 head_norm=2.292202
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.232700e-02
[S9] stored merged vector for next round verification (round=82)
[S9] DEBUG after merge:  round=82 metric=0.9971 head_norm=2.286029 delta_norm=0.012327
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=82 metric=0.9971 head_norm=2.279906
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.232701e-02
[S5] stored merged vector for next round verification (round=82)
[S5] DEBUG after merge:  round=82 metric=0.9971 head_norm=2.286029 delta_norm=0.012327
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=2.164043 cos_to_last_merge=1.0000 (last merge round=82)
[S2] round=83 local utility u=0.263970 metrics={'f1_val': 0.6919381969533476, 'auprc': 0.7011298556353605, 'loss_val': 0.9599710582483771, 'psi': 0.6956148604261527}-{'f1_val': 0.6454525004917313, 'auprc': 0.7003339971066569, 'loss_val': 1.2066087648445227, 'psi': 0.6674050991377015}
[S3] START round=83 head_norm_before_train=2.243840 cos_to_last_merge=0.9997 (last merge round=66)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.7948102388932413, 'auprc': 0.9846564909675518, 'loss_val': 0.35052786005680286, 'psi': 0.8707487397229655}-{'f1_val': 0.9186074638963181, 'auprc': 0.9843786021139485, 'loss_val': 0.24169654655023254, 'psi': 0.9449159191833703}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.164535 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=83 local utility u=0.045566 metrics={'f1_val': 0.9382171878565153, 'auprc': 0.9487846494239643, 'loss_val': 0.3396033826298836, 'psi': 0.9424441724834949}-{'f1_val': 0.9340142964122029, 'auprc': 0.9248319437502116, 'loss_val': 0.33365922441690904, 'psi': 0.9303413553474064}
[S5] START round=83 head_norm_before_train=2.286029 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935332491847322, 'loss_val': 0.02032130532646992, 'psi': 0.9954344807609674}-{'f1_val': 0.9970695586110643, 'auprc': 0.9994422305553483, 'loss_val': 0.020473522797751418, 'psi': 0.9980186273887779}
[S6] START round=83 head_norm_before_train=2.083276 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7162480474664465, 'auprc': 0.9300565661820002, 'loss_val': 0.7359685733941693, 'psi': 0.801771454952668}-{'f1_val': 0.9837181283561469, 'auprc': 0.9554499967156129, 'loss_val': 0.13047550522751408, 'psi': 0.9724108756999333}
[S7] START round=83 head_norm_before_train=2.267346 cos_to_last_merge=0.9180 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.918
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6388806598343666, 'auprc': 0.7847611824636799, 'loss_val': 1.47404656791134, 'psi': 0.6972328688860919}-{'f1_val': 0.7785969992234281, 'auprc': 0.7988066523262238, 'loss_val': 1.1414726586135457, 'psi': 0.7866808604645463}
[S8] START round=83 head_norm_before_train=2.082055 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=83 local utility u=0.007309 metrics={'f1_val': 0.9921294610699772, 'auprc': 0.997265242403819, 'loss_val': 0.03440168891107221, 'psi': 0.994183773603514}-{'f1_val': 0.9937604981237848, 'auprc': 0.9887980661852517, 'loss_val': 0.033403569388302905, 'psi': 0.9917755253483715}
[S9] START round=83 head_norm_before_train=2.286029 cos_to_last_merge=1.0000 (last merge round=82)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9985069485002758, 'loss_val': 0.0165448826782984, 'psi': 0.9976456273217305}-{'f1_val': 0.9970714132027002, 'auprc': 0.9986916109412213, 'loss_val': 0.016616267257538116, 'psi': 0.9977194922981086}
[S10] START round=83 head_norm_before_train=2.265522 cos_to_last_merge=0.9644 (last merge round=24)
[S10] round=83 local utility u=0.001555 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997395427851011, 'loss_val': 0.02460966554359527, 'psi': 0.9961520434786426}-{'f1_val': 0.9953231205637304, 'auprc': 0.9964370881897591, 'loss_val': 0.024845309281130563, 'psi': 0.9957687076141418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=83 head_norm_before_train=2.064695 cos_to_last_merge=0.8044 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9980497925462251, 'loss_val': 0.020223247182680155, 'psi': 0.9970152968315578}-{'f1_val': 0.996567470639547, 'auprc': 0.998019673000502, 'loss_val': 0.020265213126690794, 'psi': 0.997148351583929}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.898670 (no previous merge yet)
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.711274169051559, 'auprc': 0.7436497525746428, 'loss_val': 1.1428066946626254, 'psi': 0.7242244024607926}-{'f1_val': 0.7707192689859402, 'auprc': 0.8790201055954745, 'loss_val': 0.7695398762297547, 'psi': 0.8140396036297539}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.119576 cos_to_last_merge=0.9949 (last merge round=56)
[S14] round=83 local utility u=0.004729 metrics={'f1_val': 0.9984758593419994, 'auprc': 0.9986759687870473, 'loss_val': 0.014022505448943514, 'psi': 0.9985559031200186}-{'f1_val': 0.9970407855713329, 'auprc': 0.9990233714231992, 'loss_val': 0.01591194208597715, 'psi': 0.9978338199120795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=83 head_norm_before_train=1.895919 cos_to_last_merge=0.8621 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.862
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9430627174327605, 'auprc': 0.9970853680270131, 'loss_val': 0.10364098850349904, 'psi': 0.9646717776704615}-{'f1_val': 0.9637969078627, 'auprc': 0.9937268318916086, 'loss_val': 0.06986900034279155, 'psi': 0.9757688774742634}
[S16] START round=83 head_norm_before_train=2.246041 (no previous merge yet)
[S16] round=83 local utility u=0.822078 metrics={'f1_val': 0.991445538154399, 'auprc': 0.9903456792356028, 'loss_val': 0.04598718519794518, 'psi': 0.9910055945868805}-{'f1_val': 0.8669325375769921, 'auprc': 0.9825048552965651, 'loss_val': 0.9195436106117412, 'psi': 0.9131614646648213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=83 head_norm_before_train=1.955189 cos_to_last_merge=0.7772 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=83 local utility u=0.091353 metrics={'f1_val': 0.8159090135129032, 'auprc': 0.977292496923184, 'loss_val': 0.531862278596349, 'psi': 0.8804624068770155}-{'f1_val': 0.8020633394522971, 'auprc': 0.9708014041323703, 'loss_val': 0.6120200728165759, 'psi': 0.8695585653243264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=83 metric=0.9921 head_norm=2.088010
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.151827e-03
[S8] stored merged vector for next round verification (round=83)
[S8] DEBUG after merge:  round=83 metric=0.9921 head_norm=2.085632 delta_norm=0.007152
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=83 metric=0.9382 head_norm=2.166725
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.666983e-03
[S4] stored merged vector for next round verification (round=83)
[S4] DEBUG after merge:  round=83 metric=0.9382 head_norm=2.168269 delta_norm=0.007667
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=83 metric=0.6919 head_norm=2.169838
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.666990e-03
[S2] stored merged vector for next round verification (round=83)
[S2] DEBUG after merge:  round=83 metric=0.6919 head_norm=2.168269 delta_norm=0.007667
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=2.168269 cos_to_last_merge=1.0000 (last merge round=83)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.6600119840954664, 'auprc': 0.7018801739890281, 'loss_val': 1.0745374786230093, 'psi': 0.6767592600528911}-{'f1_val': 0.6919381969533476, 'auprc': 0.7011298556353605, 'loss_val': 0.9599710582483771, 'psi': 0.6956148604261527}
[S3] START round=84 head_norm_before_train=2.249148 cos_to_last_merge=0.9996 (last merge round=66)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7938647703520683, 'auprc': 0.9881150250556759, 'loss_val': 0.3771514737785876, 'psi': 0.8715648722335113}-{'f1_val': 0.7948102388932413, 'auprc': 0.9846564909675518, 'loss_val': 0.35052786005680286, 'psi': 0.8707487397229655}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.168269 cos_to_last_merge=1.0000 (last merge round=83)
[S4] round=84 local utility u=0.018033 metrics={'f1_val': 0.938594972984857, 'auprc': 0.9513626943217774, 'loss_val': 0.3135390176536752, 'psi': 0.9437020615196252}-{'f1_val': 0.9382171878565153, 'auprc': 0.9487846494239643, 'loss_val': 0.3396033826298836, 'psi': 0.9424441724834949}
[S5] START round=84 head_norm_before_train=2.287953 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=84 local utility u=0.000347 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936275925939059, 'loss_val': 0.019910826622378246, 'psi': 0.9954722181246369}-{'f1_val': 0.9967019684784577, 'auprc': 0.9935332491847322, 'loss_val': 0.02032130532646992, 'psi': 0.9954344807609674}
[S6] START round=84 head_norm_before_train=2.090334 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.5979304829267533, 'auprc': 0.781884149830915, 'loss_val': 1.1478874093656326, 'psi': 0.6715119496884181}-{'f1_val': 0.7162480474664465, 'auprc': 0.9300565661820002, 'loss_val': 0.7359685733941693, 'psi': 0.801771454952668}
[S7] START round=84 head_norm_before_train=2.281956 cos_to_last_merge=0.9167 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=84 local utility u=1.000000 metrics={'f1_val': 0.8845728128437814, 'auprc': 0.8915992999113449, 'loss_val': 0.622354892248765, 'psi': 0.8873834076708067}-{'f1_val': 0.6388806598343666, 'auprc': 0.7847611824636799, 'loss_val': 1.47404656791134, 'psi': 0.6972328688860919}
[S8] START round=84 head_norm_before_train=2.085632 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9900864781784007, 'auprc': 0.998827049525445, 'loss_val': 0.03840048478540135, 'psi': 0.9935827067172184}-{'f1_val': 0.9921294610699772, 'auprc': 0.997265242403819, 'loss_val': 0.03440168891107221, 'psi': 0.994183773603514}
[S9] START round=84 head_norm_before_train=2.291773 cos_to_last_merge=1.0000 (last merge round=82)
[S9] round=84 local utility u=0.001367 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9983304071450163, 'loss_val': 0.015936024305715932, 'psi': 0.9978404533120531}-{'f1_val': 0.9970714132027002, 'auprc': 0.9985069485002758, 'loss_val': 0.0165448826782984, 'psi': 0.9976456273217305}
[S10] START round=84 head_norm_before_train=2.269923 cos_to_last_merge=0.9641 (last merge round=24)
[S10] round=84 local utility u=0.000372 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975882861379877, 'loss_val': 0.024444357881075476, 'psi': 0.9962291867934332}-{'f1_val': 0.9953231205637304, 'auprc': 0.997395427851011, 'loss_val': 0.02460966554359527, 'psi': 0.9961520434786426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=84 head_norm_before_train=2.067862 cos_to_last_merge=0.8043 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9980657245434659, 'loss_val': 0.020479674279878707, 'psi': 0.9970216696304541}-{'f1_val': 0.9963256330217796, 'auprc': 0.9980497925462251, 'loss_val': 0.020223247182680155, 'psi': 0.9970152968315578}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.903208 (no previous merge yet)
[S13] round=84 local utility u=0.432086 metrics={'f1_val': 0.7440950055924338, 'auprc': 0.8581421598008474, 'loss_val': 0.8190367310201686, 'psi': 0.7897138672757993}-{'f1_val': 0.711274169051559, 'auprc': 0.7436497525746428, 'loss_val': 1.1428066946626254, 'psi': 0.7242244024607926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=84 head_norm_before_train=2.125716 cos_to_last_merge=0.9946 (last merge round=56)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9879022937815074, 'auprc': 0.9986060988259877, 'loss_val': 0.03699131354254395, 'psi': 0.9921838157992995}-{'f1_val': 0.9984758593419994, 'auprc': 0.9986759687870473, 'loss_val': 0.014022505448943514, 'psi': 0.9985559031200186}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=1.900966 cos_to_last_merge=0.8616 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.862
[S15] round=84 local utility u=0.183290 metrics={'f1_val': 0.9930516478793865, 'auprc': 0.9960271997665572, 'loss_val': 0.03382017626406761, 'psi': 0.9942418686342547}-{'f1_val': 0.9430627174327605, 'auprc': 0.9970853680270131, 'loss_val': 0.10364098850349904, 'psi': 0.9646717776704615}
[S16] START round=84 head_norm_before_train=2.251606 (no previous merge yet)
[S16] round=84 local utility u=0.013995 metrics={'f1_val': 0.9932438841188189, 'auprc': 0.990817467232274, 'loss_val': 0.03020201016712962, 'psi': 0.9922733173642009}-{'f1_val': 0.991445538154399, 'auprc': 0.9903456792356028, 'loss_val': 0.04598718519794518, 'psi': 0.9910055945868805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=84 head_norm_before_train=1.961451 cos_to_last_merge=0.7766 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=84 local utility u=0.328582 metrics={'f1_val': 0.8690995022624699, 'auprc': 0.9942943559283173, 'loss_val': 0.24484714521441725, 'psi': 0.9191774437288088}-{'f1_val': 0.8159090135129032, 'auprc': 0.977292496923184, 'loss_val': 0.531862278596349, 'psi': 0.8804624068770155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=84 metric=0.5979 head_norm=2.096857
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.292671e-02
[S6] stored merged vector for next round verification (round=84)
[S6] DEBUG after merge:  round=84 metric=0.5979 head_norm=2.092398 delta_norm=0.012927
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1790) from S15
[S7] cosine check vs S15: cos=-0.1049
[S7] DROPPED delta from S15 (cos=-0.1049 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=-0.1049
[S15] DROPPED delta from S7 (cos=-0.1049 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=84 metric=0.9967 head_norm=2.298949
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.289035e-02
[S5] stored merged vector for next round verification (round=84)
[S5] DEBUG after merge:  round=84 metric=0.9967 head_norm=2.299241 delta_norm=0.012890
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=84 metric=0.9975 head_norm=2.299605
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.289035e-02
[S9] stored merged vector for next round verification (round=84)
[S9] DEBUG after merge:  round=84 metric=0.9975 head_norm=2.299241 delta_norm=0.012890
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=2.176283 cos_to_last_merge=1.0000 (last merge round=83)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.6221818258237086, 'auprc': 0.6965506861741216, 'loss_val': 1.4826143601992083, 'psi': 0.6519293699638737}-{'f1_val': 0.6600119840954664, 'auprc': 0.7018801739890281, 'loss_val': 1.0745374786230093, 'psi': 0.6767592600528911}
[S3] START round=85 head_norm_before_train=2.255843 cos_to_last_merge=0.9995 (last merge round=66)
[S3] round=85 local utility u=0.666885 metrics={'f1_val': 0.9644707792607211, 'auprc': 0.9951997371065996, 'loss_val': 0.08827146409116368, 'psi': 0.9767623623990724}-{'f1_val': 0.7938647703520683, 'auprc': 0.9881150250556759, 'loss_val': 0.3771514737785876, 'psi': 0.8715648722335113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=85 head_norm_before_train=2.171899 cos_to_last_merge=1.0000 (last merge round=83)
[S4] round=85 local utility u=0.012349 metrics={'f1_val': 0.9397106723259043, 'auprc': 0.9534865756546196, 'loss_val': 0.3019064939115204, 'psi': 0.9452210336573904}-{'f1_val': 0.938594972984857, 'auprc': 0.9513626943217774, 'loss_val': 0.3135390176536752, 'psi': 0.9437020615196252}
[S5] START round=85 head_norm_before_train=2.299241 cos_to_last_merge=1.0000 (last merge round=84)
[S5] round=85 local utility u=0.004372 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9963387631663442, 'loss_val': 0.019300526232750376, 'psi': 0.9965566863536123}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936275925939059, 'loss_val': 0.019910826622378246, 'psi': 0.9954722181246369}
[S6] START round=85 head_norm_before_train=2.092398 cos_to_last_merge=1.0000 (last merge round=84)
[S6] round=85 local utility u=1.000000 metrics={'f1_val': 0.9187452036744337, 'auprc': 0.9458383522961111, 'loss_val': 0.2345471912432652, 'psi': 0.9295824631231047}-{'f1_val': 0.5979304829267533, 'auprc': 0.781884149830915, 'loss_val': 1.1478874093656326, 'psi': 0.6715119496884181}
[S7] START round=85 head_norm_before_train=2.293307 cos_to_last_merge=0.9157 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.8498215041696757, 'auprc': 0.8429846932681437, 'loss_val': 0.9549979959535018, 'psi': 0.8470867798090629}-{'f1_val': 0.8845728128437814, 'auprc': 0.8915992999113449, 'loss_val': 0.622354892248765, 'psi': 0.8873834076708067}
[S8] START round=85 head_norm_before_train=2.086571 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9854657544381686, 'auprc': 0.9988178324080622, 'loss_val': 0.04878317097333625, 'psi': 0.9908065856261261}-{'f1_val': 0.9900864781784007, 'auprc': 0.998827049525445, 'loss_val': 0.03840048478540135, 'psi': 0.9935827067172184}
[S9] START round=85 head_norm_before_train=2.299241 cos_to_last_merge=1.0000 (last merge round=84)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985754987705873, 'loss_val': 0.017348093292302903, 'psi': 0.9976919470155206}-{'f1_val': 0.9975138174234109, 'auprc': 0.9983304071450163, 'loss_val': 0.015936024305715932, 'psi': 0.9978404533120531}
[S10] START round=85 head_norm_before_train=2.275020 cos_to_last_merge=0.9638 (last merge round=24)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973704854535965, 'loss_val': 0.024625220333038284, 'psi': 0.9961420665196767}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975882861379877, 'loss_val': 0.024444357881075476, 'psi': 0.9962291867934332}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.072078 cos_to_last_merge=0.8044 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981363537943746, 'loss_val': 0.021129449754220143, 'psi': 0.9970499213308176}-{'f1_val': 0.9963256330217796, 'auprc': 0.9980657245434659, 'loss_val': 0.020479674279878707, 'psi': 0.9970216696304541}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.913002 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6806656775367533, 'auprc': 0.7036579172326272, 'loss_val': 1.168316281173981, 'psi': 0.6898625734151029}-{'f1_val': 0.7440950055924338, 'auprc': 0.8581421598008474, 'loss_val': 0.8190367310201686, 'psi': 0.7897138672757993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.132370 cos_to_last_merge=0.9944 (last merge round=56)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9345026700949841, 'auprc': 0.9985852121908361, 'loss_val': 0.15051937718503863, 'psi': 0.960135686933325}-{'f1_val': 0.9879022937815074, 'auprc': 0.9986060988259877, 'loss_val': 0.03699131354254395, 'psi': 0.9921838157992995}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.906075 cos_to_last_merge=0.8612 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=85 local utility u=0.009839 metrics={'f1_val': 0.9963796601002626, 'auprc': 0.9935170101475477, 'loss_val': 0.026580326285828307, 'psi': 0.9952346001191766}-{'f1_val': 0.9930516478793865, 'auprc': 0.9960271997665572, 'loss_val': 0.03382017626406761, 'psi': 0.9942418686342547}
[S16] START round=85 head_norm_before_train=2.257631 (no previous merge yet)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.7734696204637658, 'auprc': 0.9848215550914947, 'loss_val': 0.9140888342572959, 'psi': 0.8580103943148574}-{'f1_val': 0.9932438841188189, 'auprc': 0.990817467232274, 'loss_val': 0.03020201016712962, 'psi': 0.9922733173642009}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.967827 cos_to_last_merge=0.7760 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8170620767167344, 'auprc': 0.9790690105014439, 'loss_val': 0.5245677608387156, 'psi': 0.8818648502306181}-{'f1_val': 0.8690995022624699, 'auprc': 0.9942943559283173, 'loss_val': 0.24484714521441725, 'psi': 0.9191774437288088}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.001 → S5@127.0.0.1:57005
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.047 → S6@127.0.0.1:57007
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=85 metric=0.6222 head_norm=2.184567
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.132682e-02
[S2] stored merged vector for next round verification (round=85)
[S2] DEBUG after merge:  round=85 metric=0.6220 head_norm=2.178213 delta_norm=0.011327
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.070 → S4@127.0.0.1:57004
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] ⇄ pheromone p=0.276 → S15@127.0.0.1:57015
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.1051
[S7] DROPPED delta from S15 (cos=-0.1051 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=1.0000
[S6] ⇄ pheromone p=0.462 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.019 → S2@127.0.0.1:57002
[S15] ⇄ pheromone p=0.149 → S7@127.0.0.1:57008
[S5] ⇄ pheromone p=0.002 → S9@127.0.0.1:57010
[S2] START round=86 head_norm_before_train=2.178213 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=86 local utility u=0.175760 metrics={'f1_val': 0.639702766028704, 'auprc': 0.7022858071861413, 'loss_val': 1.2534259426276173, 'psi': 0.664735982491679}-{'f1_val': 0.6221818258237086, 'auprc': 0.6965506861741216, 'loss_val': 1.4826143601992083, 'psi': 0.6519293699638737}
[S3] START round=86 head_norm_before_train=2.262696 cos_to_last_merge=0.9995 (last merge round=66)
[S3] round=86 local utility u=0.024529 metrics={'f1_val': 0.9696920379866845, 'auprc': 0.9961350301988446, 'loss_val': 0.0733477847469536, 'psi': 0.9802692348715486}-{'f1_val': 0.9644707792607211, 'auprc': 0.9951997371065996, 'loss_val': 0.08827146409116368, 'psi': 0.9767623623990724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=86 head_norm_before_train=2.175954 cos_to_last_merge=1.0000 (last merge round=83)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9345671353487324, 'auprc': 0.962073598502013, 'loss_val': 0.30066529210582044, 'psi': 0.9455697206100446}-{'f1_val': 0.9397106723259043, 'auprc': 0.9534865756546196, 'loss_val': 0.3019064939115204, 'psi': 0.9452210336573904}
[S5] START round=86 head_norm_before_train=2.307033 cos_to_last_merge=1.0000 (last merge round=84)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935791309700525, 'loss_val': 0.02005546095762132, 'psi': 0.9954528334750956}-{'f1_val': 0.9967019684784577, 'auprc': 0.9963387631663442, 'loss_val': 0.019300526232750376, 'psi': 0.9965566863536123}
[S6] START round=86 head_norm_before_train=2.097262 cos_to_last_merge=1.0000 (last merge round=84)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7849037380165349, 'auprc': 0.9269877592482672, 'loss_val': 0.5935021810372181, 'psi': 0.8417373465092278}-{'f1_val': 0.9187452036744337, 'auprc': 0.9458383522961111, 'loss_val': 0.2345471912432652, 'psi': 0.9295824631231047}
[S7] START round=86 head_norm_before_train=2.300440 cos_to_last_merge=0.9152 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=86 local utility u=0.171147 metrics={'f1_val': 0.8324961160642887, 'auprc': 0.8899715162151309, 'loss_val': 0.6497130835088436, 'psi': 0.8554862761246256}-{'f1_val': 0.8498215041696757, 'auprc': 0.8429846932681437, 'loss_val': 0.9549979959535018, 'psi': 0.8470867798090629}
[S8] START round=86 head_norm_before_train=2.090497 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=86 local utility u=0.006053 metrics={'f1_val': 0.9872374812345726, 'auprc': 0.9988073728980439, 'loss_val': 0.04727634050521315, 'psi': 0.9918654378999611}-{'f1_val': 0.9854657544381686, 'auprc': 0.9988178324080622, 'loss_val': 0.04878317097333625, 'psi': 0.9908065856261261}
[S9] START round=86 head_norm_before_train=2.305043 cos_to_last_merge=1.0000 (last merge round=84)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9978772194695341, 'loss_val': 0.01624549463395538, 'psi': 0.9971623603109387}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985754987705873, 'loss_val': 0.017348093292302903, 'psi': 0.9976919470155206}
[S10] START round=86 head_norm_before_train=2.275540 cos_to_last_merge=0.9629 (last merge round=24)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969342361194087, 'loss_val': 0.024702784735571588, 'psi': 0.9959675667860017}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973704854535965, 'loss_val': 0.024625220333038284, 'psi': 0.9961420665196767}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.074926 cos_to_last_merge=0.8039 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982004576862094, 'loss_val': 0.021756007714780257, 'psi': 0.9970755628875515}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981363537943746, 'loss_val': 0.021129449754220143, 'psi': 0.9970499213308176}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.925174 (no previous merge yet)
[S13] round=86 local utility u=0.018853 metrics={'f1_val': 0.6518249114686231, 'auprc': 0.7984036032103518, 'loss_val': 1.2418022543845175, 'psi': 0.7104563881653145}-{'f1_val': 0.6806656775367533, 'auprc': 0.7036579172326272, 'loss_val': 1.168316281173981, 'psi': 0.6898625734151029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=86 head_norm_before_train=2.140382 cos_to_last_merge=0.9942 (last merge round=56)
[S14] round=86 local utility u=0.008769 metrics={'f1_val': 0.9345279451171427, 'auprc': 0.998463862774408, 'loss_val': 0.13276832180041762, 'psi': 0.9601023121800488}-{'f1_val': 0.9345026700949841, 'auprc': 0.9985852121908361, 'loss_val': 0.15051937718503863, 'psi': 0.960135686933325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=86 head_norm_before_train=1.911198 cos_to_last_merge=0.8608 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9940755226229099, 'loss_val': 0.2532007811701757, 'psi': 0.9385017550502877}-{'f1_val': 0.9963796601002626, 'auprc': 0.9935170101475477, 'loss_val': 0.026580326285828307, 'psi': 0.9952346001191766}
[S16] START round=86 head_norm_before_train=2.262169 (no previous merge yet)
[S16] round=86 local utility u=1.000000 metrics={'f1_val': 0.9934227665498173, 'auprc': 0.9859432491679341, 'loss_val': 0.031430139851641115, 'psi': 0.990430959597064}-{'f1_val': 0.7734696204637658, 'auprc': 0.9848215550914947, 'loss_val': 0.9140888342572959, 'psi': 0.8580103943148574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=86 head_norm_before_train=1.973071 cos_to_last_merge=0.7757 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.7796103877845222, 'auprc': 0.9735895919485062, 'loss_val': 0.6438993537273452, 'psi': 0.8572020694501158}-{'f1_val': 0.8170620767167344, 'auprc': 0.9790690105014439, 'loss_val': 0.5245677608387156, 'psi': 0.8818648502306181}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:57004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=86 metric=0.9967 head_norm=2.306665
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.690833e-03
[S9] stored merged vector for next round verification (round=86)
[S9] DEBUG after merge:  round=86 metric=0.9967 head_norm=2.306837 delta_norm=0.007691
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1052
[S15] DROPPED delta from S7 (cos=-0.1052 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=86 metric=0.9872 head_norm=2.096773
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.180408e-02
[S8] stored merged vector for next round verification (round=86)
[S8] DEBUG after merge:  round=86 metric=0.9872 head_norm=2.096984 delta_norm=0.011804
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=86 metric=0.6397 head_norm=2.184960
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.025392e-02
[S2] stored merged vector for next round verification (round=86)
[S2] DEBUG after merge:  round=86 metric=0.6397 head_norm=2.180438 delta_norm=0.010254
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.180438 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=87 local utility u=0.002903 metrics={'f1_val': 0.6415828029303816, 'auprc': 0.7032134784170399, 'loss_val': 1.2616828036886623, 'psi': 0.6662350731250449}-{'f1_val': 0.639702766028704, 'auprc': 0.7022858071861413, 'loss_val': 1.2534259426276173, 'psi': 0.664735982491679}
[S3] START round=87 head_norm_before_train=2.269165 cos_to_last_merge=0.9994 (last merge round=66)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9574798955446475, 'auprc': 0.9916975528157004, 'loss_val': 0.13776395670272773, 'psi': 0.9711669584530687}-{'f1_val': 0.9696920379866845, 'auprc': 0.9961350301988446, 'loss_val': 0.0733477847469536, 'psi': 0.9802692348715486}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.177928 cos_to_last_merge=1.0000 (last merge round=83)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9338638568732366, 'auprc': 0.9499133243913247, 'loss_val': 0.31283778000468127, 'psi': 0.9402836438804718}-{'f1_val': 0.9345671353487324, 'auprc': 0.962073598502013, 'loss_val': 0.30066529210582044, 'psi': 0.9455697206100446}
[S5] START round=87 head_norm_before_train=2.304690 cos_to_last_merge=1.0000 (last merge round=84)
[S5] round=87 local utility u=0.000412 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936807471233082, 'loss_val': 0.0195355781590394, 'psi': 0.9954934799363979}-{'f1_val': 0.9967019684784577, 'auprc': 0.9935791309700525, 'loss_val': 0.02005546095762132, 'psi': 0.9954528334750956}
[S6] START round=87 head_norm_before_train=2.103282 cos_to_last_merge=1.0000 (last merge round=84)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.5978836679865506, 'auprc': 0.7833113383289251, 'loss_val': 1.136982300741464, 'psi': 0.6720547361235004}-{'f1_val': 0.7849037380165349, 'auprc': 0.9269877592482672, 'loss_val': 0.5935021810372181, 'psi': 0.8417373465092278}
[S7] START round=87 head_norm_before_train=2.310594 cos_to_last_merge=0.9143 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=87 local utility u=0.033486 metrics={'f1_val': 0.8385882716329798, 'auprc': 0.8973767130197519, 'loss_val': 0.6415089164840482, 'psi': 0.8621036481876886}-{'f1_val': 0.8324961160642887, 'auprc': 0.8899715162151309, 'loss_val': 0.6497130835088436, 'psi': 0.8554862761246256}
[S8] START round=87 head_norm_before_train=2.096984 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=87 local utility u=0.009418 metrics={'f1_val': 0.9892527482403732, 'auprc': 0.9983307502068893, 'loss_val': 0.03910125744814978, 'psi': 0.9928839490269797}-{'f1_val': 0.9872374812345726, 'auprc': 0.9988073728980439, 'loss_val': 0.04727634050521315, 'psi': 0.9918654378999611}
[S9] START round=87 head_norm_before_train=2.306837 cos_to_last_merge=1.0000 (last merge round=86)
[S9] round=87 local utility u=0.001251 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997857378486254, 'loss_val': 0.016185753390149576, 'psi': 0.9974046989017873}-{'f1_val': 0.9966857875385419, 'auprc': 0.9978772194695341, 'loss_val': 0.01624549463395538, 'psi': 0.9971623603109387}
[S10] START round=87 head_norm_before_train=2.278582 cos_to_last_merge=0.9624 (last merge round=24)
[S10] round=87 local utility u=0.000970 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975537080316071, 'loss_val': 0.024621405330540642, 'psi': 0.996215355550881}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969342361194087, 'loss_val': 0.024702784735571588, 'psi': 0.9959675667860017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=87 head_norm_before_train=2.077835 cos_to_last_merge=0.8033 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=87 local utility u=0.000174 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982206684204783, 'loss_val': 0.021469357622848552, 'psi': 0.9970836471812591}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982004576862094, 'loss_val': 0.021756007714780257, 'psi': 0.9970755628875515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=87 head_norm_before_train=1.935912 (no previous merge yet)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6358953544101706, 'auprc': 0.6857454819421787, 'loss_val': 1.1245118347688194, 'psi': 0.6558354054229738}-{'f1_val': 0.6518249114686231, 'auprc': 0.7984036032103518, 'loss_val': 1.2418022543845175, 'psi': 0.7104563881653145}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.149437 cos_to_last_merge=0.9940 (last merge round=56)
[S14] round=87 local utility u=0.010390 metrics={'f1_val': 0.9357901928569444, 'auprc': 0.9985399035607082, 'loss_val': 0.11979028526104654, 'psi': 0.9608900771384499}-{'f1_val': 0.9345279451171427, 'auprc': 0.998463862774408, 'loss_val': 0.13276832180041762, 'psi': 0.9601023121800488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=87 head_norm_before_train=1.915836 cos_to_last_merge=0.8604 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9138178882622218, 'loss_val': 0.6394058386869418, 'psi': 0.7859867085663383}-{'f1_val': 0.9014525766685394, 'auprc': 0.9940755226229099, 'loss_val': 0.2532007811701757, 'psi': 0.9385017550502877}
[S16] START round=87 head_norm_before_train=2.265661 (no previous merge yet)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.8741282318836157, 'auprc': 0.9661024530974683, 'loss_val': 0.7877447168999877, 'psi': 0.9109179203691566}-{'f1_val': 0.9934227665498173, 'auprc': 0.9859432491679341, 'loss_val': 0.031430139851641115, 'psi': 0.990430959597064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=1.978322 cos_to_last_merge=0.7755 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=87 local utility u=0.454629 metrics={'f1_val': 0.8616701519195531, 'auprc': 0.988605096397009, 'loss_val': 0.2720467142316546, 'psi': 0.9124441297105355}-{'f1_val': 0.7796103877845222, 'auprc': 0.9735895919485062, 'loss_val': 0.6438993537273452, 'psi': 0.8572020694501158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:57005
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=87 metric=0.5979 head_norm=2.107300
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.865495e-02
[S6] stored merged vector for next round verification (round=87)
[S6] DEBUG after merge:  round=87 metric=0.5979 head_norm=2.101960 delta_norm=0.018655
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=87 metric=0.9339 head_norm=2.180304
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.321065e-02
[S4] stored merged vector for next round verification (round=87)
[S4] DEBUG after merge:  round=87 metric=0.9339 head_norm=2.182594 delta_norm=0.013211
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=-0.1050
[S15] DROPPED delta from S7 (cos=-0.1050 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=1.0000
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=1.0000
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=87 metric=0.9967 head_norm=2.307038
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.758330e-02
[S5] stored merged vector for next round verification (round=87)
[S5] DEBUG after merge:  round=87 metric=0.9967 head_norm=2.308015 delta_norm=0.017583
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=87 metric=0.9971 head_norm=2.309125
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.758330e-02
[S9] stored merged vector for next round verification (round=87)
[S9] DEBUG after merge:  round=87 metric=0.9971 head_norm=2.308015 delta_norm=0.017583
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.188032 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.6340411410463614, 'auprc': 0.7007237030511979, 'loss_val': 1.314088717194282, 'psi': 0.660714165848296}-{'f1_val': 0.6415828029303816, 'auprc': 0.7032134784170399, 'loss_val': 1.2616828036886623, 'psi': 0.6662350731250449}
[S3] START round=88 head_norm_before_train=2.275305 cos_to_last_merge=0.9993 (last merge round=66)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.715298526744014, 'auprc': 0.9802224359544018, 'loss_val': 0.5452995177353402, 'psi': 0.8212680904281691}-{'f1_val': 0.9574798955446475, 'auprc': 0.9916975528157004, 'loss_val': 0.13776395670272773, 'psi': 0.9711669584530687}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.182594 cos_to_last_merge=1.0000 (last merge round=87)
[S4] round=88 local utility u=0.051325 metrics={'f1_val': 0.9397639600776355, 'auprc': 0.9682391621377411, 'loss_val': 0.3005650151292627, 'psi': 0.9511540409016778}-{'f1_val': 0.9338638568732366, 'auprc': 0.9499133243913247, 'loss_val': 0.31283778000468127, 'psi': 0.9402836438804718}
[S5] START round=88 head_norm_before_train=2.308015 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=88 local utility u=0.005350 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9990409545015594, 'loss_val': 0.024917068677431944, 'psi': 0.9976375628876983}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936807471233082, 'loss_val': 0.0195355781590394, 'psi': 0.9954934799363979}
[S6] START round=88 head_norm_before_train=2.101960 cos_to_last_merge=1.0000 (last merge round=87)
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.8232062165356077, 'auprc': 0.9401691902161424, 'loss_val': 0.340291896487884, 'psi': 0.8699914060078215}-{'f1_val': 0.5978836679865506, 'auprc': 0.7833113383289251, 'loss_val': 1.136982300741464, 'psi': 0.6720547361235004}
[S7] START round=88 head_norm_before_train=2.320204 cos_to_last_merge=0.9134 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.6885799627338266, 'auprc': 0.7823648270265628, 'loss_val': 1.3941930207744744, 'psi': 0.726093908450921}-{'f1_val': 0.8385882716329798, 'auprc': 0.8973767130197519, 'loss_val': 0.6415089164840482, 'psi': 0.8621036481876886}
[S8] START round=88 head_norm_before_train=2.100484 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=88 local utility u=0.001881 metrics={'f1_val': 0.9945089764462749, 'auprc': 0.9877838202045485, 'loss_val': 0.03523485182683533, 'psi': 0.9918189139495843}-{'f1_val': 0.9892527482403732, 'auprc': 0.9983307502068893, 'loss_val': 0.03910125744814978, 'psi': 0.9928839490269797}
[S9] START round=88 head_norm_before_train=2.308015 cos_to_last_merge=1.0000 (last merge round=87)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981749348652684, 'loss_val': 0.017106576187406086, 'psi': 0.9972662810344423}-{'f1_val': 0.9971029125121428, 'auprc': 0.997857378486254, 'loss_val': 0.016185753390149576, 'psi': 0.9974046989017873}
[S10] START round=88 head_norm_before_train=2.282981 cos_to_last_merge=0.9621 (last merge round=24)
[S10] round=88 local utility u=0.000069 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997596569887047, 'loss_val': 0.024611101002380745, 'psi': 0.996232500293057}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975537080316071, 'loss_val': 0.024621405330540642, 'psi': 0.996215355550881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=88 head_norm_before_train=2.083051 cos_to_last_merge=0.8032 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=88 local utility u=0.001588 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998220305320058, 'loss_val': 0.019743251044729848, 'psi': 0.9972286045117514}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982206684204783, 'loss_val': 0.021469357622848552, 'psi': 0.9970836471812591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=88 head_norm_before_train=1.942301 (no previous merge yet)
[S13] round=88 local utility u=0.629889 metrics={'f1_val': 0.7482742142025793, 'auprc': 0.7917278423635983, 'loss_val': 0.8569539094396884, 'psi': 0.7656556654669869}-{'f1_val': 0.6358953544101706, 'auprc': 0.6857454819421787, 'loss_val': 1.1245118347688194, 'psi': 0.6558354054229738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=88 head_norm_before_train=2.153738 cos_to_last_merge=0.9937 (last merge round=56)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9309449162082212, 'auprc': 0.9988118178455438, 'loss_val': 0.1994396120767583, 'psi': 0.9580916768631502}-{'f1_val': 0.9357901928569444, 'auprc': 0.9985399035607082, 'loss_val': 0.11979028526104654, 'psi': 0.9608900771384499}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=1.920112 cos_to_last_merge=0.8599 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=88 local utility u=0.916154 metrics={'f1_val': 0.8912848601701502, 'auprc': 0.9969663397162312, 'loss_val': 0.19965622683208578, 'psi': 0.9335574519885825}-{'f1_val': 0.7007659221024161, 'auprc': 0.9138178882622218, 'loss_val': 0.6394058386869418, 'psi': 0.7859867085663383}
[S16] START round=88 head_norm_before_train=2.268492 (no previous merge yet)
[S16] round=88 local utility u=0.418029 metrics={'f1_val': 0.9375093558212279, 'auprc': 0.9888218834262323, 'loss_val': 0.40013267763685817, 'psi': 0.9580343668632296}-{'f1_val': 0.8741282318836157, 'auprc': 0.9661024530974683, 'loss_val': 0.7877447168999877, 'psi': 0.9109179203691566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=88 head_norm_before_train=1.984152 cos_to_last_merge=0.7752 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.8447415234241181, 'auprc': 0.9722917264434155, 'loss_val': 0.5048977148523185, 'psi': 0.8957616046318371}-{'f1_val': 0.8616701519195531, 'auprc': 0.988605096397009, 'loss_val': 0.2720467142316546, 'psi': 0.9124441297105355}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S15
[S7] cosine check vs S15: cos=-0.1049
[S7] DROPPED delta from S15 (cos=-0.1049 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=88 metric=0.9398 head_norm=2.183955
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.707080e-03
[S4] stored merged vector for next round verification (round=88)
[S4] DEBUG after merge:  round=88 metric=0.9398 head_norm=2.185973 delta_norm=0.009707
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=88 metric=0.8232 head_norm=2.105160
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.511315e-03
[S6] stored merged vector for next round verification (round=88)
[S6] DEBUG after merge:  round=88 metric=0.8232 head_norm=2.103303 delta_norm=0.009511
[S6] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=88 metric=0.9945 head_norm=2.102503
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.112633e-02
[S8] stored merged vector for next round verification (round=88)
[S8] DEBUG after merge:  round=88 metric=0.9945 head_norm=2.103803 delta_norm=0.011126
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=2.193472 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.6206257684041371, 'auprc': 0.700172315390269, 'loss_val': 1.386816375632309, 'psi': 0.6524443871985899}-{'f1_val': 0.6340411410463614, 'auprc': 0.7007237030511979, 'loss_val': 1.314088717194282, 'psi': 0.660714165848296}
[S3] START round=89 head_norm_before_train=2.280385 cos_to_last_merge=0.9992 (last merge round=66)
[S3] round=89 local utility u=0.534591 metrics={'f1_val': 0.8550947170939127, 'auprc': 0.9788027069402652, 'loss_val': 0.31063592919007693, 'psi': 0.9045779130324537}-{'f1_val': 0.715298526744014, 'auprc': 0.9802224359544018, 'loss_val': 0.5452995177353402, 'psi': 0.8212680904281691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=89 head_norm_before_train=2.185973 cos_to_last_merge=1.0000 (last merge round=88)
[S4] round=89 local utility u=0.005464 metrics={'f1_val': 0.9400373462283629, 'auprc': 0.9699501408188967, 'loss_val': 0.29640934868975444, 'psi': 0.9520024640645764}-{'f1_val': 0.9397639600776355, 'auprc': 0.9682391621377411, 'loss_val': 0.3005650151292627, 'psi': 0.9511540409016778}
[S5] START round=89 head_norm_before_train=2.311799 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9913423993161133, 'loss_val': 0.026639022247114726, 'psi': 0.9943372469045795}-{'f1_val': 0.9967019684784577, 'auprc': 0.9990409545015594, 'loss_val': 0.024917068677431944, 'psi': 0.9976375628876983}
[S6] START round=89 head_norm_before_train=2.103303 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=89 local utility u=0.292642 metrics={'f1_val': 0.9194203486643032, 'auprc': 0.9184630571582778, 'loss_val': 0.26717454217088377, 'psi': 0.919037432061893}-{'f1_val': 0.8232062165356077, 'auprc': 0.9401691902161424, 'loss_val': 0.340291896487884, 'psi': 0.8699914060078215}
[S7] START round=89 head_norm_before_train=2.330699 cos_to_last_merge=0.9126 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=89 local utility u=0.782946 metrics={'f1_val': 0.8540525979246087, 'auprc': 0.8377424939706348, 'loss_val': 0.9872701555363287, 'psi': 0.8475285563430192}-{'f1_val': 0.6885799627338266, 'auprc': 0.7823648270265628, 'loss_val': 1.3941930207744744, 'psi': 0.726093908450921}
[S8] START round=89 head_norm_before_train=2.103803 cos_to_last_merge=1.0000 (last merge round=88)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9885575747013454, 'loss_val': 0.035776006871301745, 'psi': 0.9907067626833901}-{'f1_val': 0.9945089764462749, 'auprc': 0.9877838202045485, 'loss_val': 0.03523485182683533, 'psi': 0.9918189139495843}
[S9] START round=89 head_norm_before_train=2.312424 cos_to_last_merge=1.0000 (last merge round=87)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9978614809206022, 'loss_val': 0.018646708957554114, 'psi': 0.9963910851213778}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981749348652684, 'loss_val': 0.017106576187406086, 'psi': 0.9972662810344423}
[S10] START round=89 head_norm_before_train=2.287008 cos_to_last_merge=0.9617 (last merge round=24)
[S10] round=89 local utility u=0.000040 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976095427481484, 'loss_val': 0.024569124300006195, 'psi': 0.9962376894374976}-{'f1_val': 0.9953231205637304, 'auprc': 0.997596569887047, 'loss_val': 0.024611101002380745, 'psi': 0.996232500293057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=89 head_norm_before_train=2.085971 cos_to_last_merge=0.8033 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=89 local utility u=0.000495 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985111917294226, 'loss_val': 0.019625485492990636, 'psi': 0.9973449590754973}-{'f1_val': 0.996567470639547, 'auprc': 0.998220305320058, 'loss_val': 0.019743251044729848, 'psi': 0.9972286045117514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=89 head_norm_before_train=1.945973 (no previous merge yet)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6747668209728812, 'auprc': 0.8246616068299024, 'loss_val': 1.213677214647464, 'psi': 0.7347247353156897}-{'f1_val': 0.7482742142025793, 'auprc': 0.7917278423635983, 'loss_val': 0.8569539094396884, 'psi': 0.7656556654669869}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.158726 cos_to_last_merge=0.9934 (last merge round=56)
[S14] round=89 local utility u=0.290082 metrics={'f1_val': 0.9972617020302783, 'auprc': 0.9986707875342293, 'loss_val': 0.016752355360878775, 'psi': 0.9978253362318587}-{'f1_val': 0.9309449162082212, 'auprc': 0.9988118178455438, 'loss_val': 0.1994396120767583, 'psi': 0.9580916768631502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=89 head_norm_before_train=1.924100 cos_to_last_merge=0.8595 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=89 local utility u=0.127336 metrics={'f1_val': 0.9244501406222085, 'auprc': 0.995929226631347, 'loss_val': 0.14086390398910845, 'psi': 0.953041775025864}-{'f1_val': 0.8912848601701502, 'auprc': 0.9969663397162312, 'loss_val': 0.19965622683208578, 'psi': 0.9335574519885825}
[S16] START round=89 head_norm_before_train=2.272807 (no previous merge yet)
[S16] round=89 local utility u=0.066881 metrics={'f1_val': 0.9446080549160609, 'auprc': 0.9928171115053519, 'loss_val': 0.32094891837528927, 'psi': 0.9638916775517773}-{'f1_val': 0.9375093558212279, 'auprc': 0.9888218834262323, 'loss_val': 0.40013267763685817, 'psi': 0.9580343668632296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=89 head_norm_before_train=1.988818 cos_to_last_merge=0.7745 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.8310416734531294, 'auprc': 0.9622289105183628, 'loss_val': 0.5950570902836474, 'psi': 0.8835165682792228}-{'f1_val': 0.8447415234241181, 'auprc': 0.9722917264434155, 'loss_val': 0.5048977148523185, 'psi': 0.8957616046318371}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=89 metric=0.6206 head_norm=2.197774
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.468614e-02
[S2] stored merged vector for next round verification (round=89)
[S2] DEBUG after merge:  round=89 metric=0.6206 head_norm=2.190826 delta_norm=0.014686
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=89 metric=0.9954 head_norm=2.317785
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.018600e-02
[S9] stored merged vector for next round verification (round=89)
[S9] DEBUG after merge:  round=89 metric=0.9954 head_norm=2.314772 delta_norm=0.010186
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1048
[S15] DROPPED delta from S7 (cos=-0.1048 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.1048
[S7] DROPPED delta from S15 (cos=-0.1048 < 0.0)
[S2] START round=90 head_norm_before_train=2.190826 cos_to_last_merge=1.0000 (last merge round=89)
[S2] round=90 local utility u=0.441536 metrics={'f1_val': 0.6848845558406134, 'auprc': 0.7036503597179329, 'loss_val': 0.8997322165653056, 'psi': 0.6923908773915411}-{'f1_val': 0.6206257684041371, 'auprc': 0.700172315390269, 'loss_val': 1.386816375632309, 'psi': 0.6524443871985899}
[S3] START round=90 head_norm_before_train=2.285638 cos_to_last_merge=0.9992 (last merge round=66)
[S3] round=90 local utility u=0.359833 metrics={'f1_val': 0.9540082368966836, 'auprc': 0.9784711735706964, 'loss_val': 0.18345635071424068, 'psi': 0.9637934115662886}-{'f1_val': 0.8550947170939127, 'auprc': 0.9788027069402652, 'loss_val': 0.31063592919007693, 'psi': 0.9045779130324537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=90 head_norm_before_train=2.191420 cos_to_last_merge=1.0000 (last merge round=88)
[S4] round=90 local utility u=0.000277 metrics={'f1_val': 0.9396641521947791, 'auprc': 0.9710180479260218, 'loss_val': 0.29681898272844304, 'psi': 0.9522057104872761}-{'f1_val': 0.9400373462283629, 'auprc': 0.9699501408188967, 'loss_val': 0.29640934868975444, 'psi': 0.9520024640645764}
[S5] START round=90 head_norm_before_train=2.320985 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=90 local utility u=0.008385 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9937384296337308, 'loss_val': 0.019266687000255644, 'psi': 0.995516552940567}-{'f1_val': 0.9963338119635569, 'auprc': 0.9913423993161133, 'loss_val': 0.026639022247114726, 'psi': 0.9943372469045795}
[S6] START round=90 head_norm_before_train=2.109851 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7695724399006453, 'auprc': 0.9387098978436358, 'loss_val': 0.582600432953805, 'psi': 0.8372274230778415}-{'f1_val': 0.9194203486643032, 'auprc': 0.9184630571582778, 'loss_val': 0.26717454217088377, 'psi': 0.919037432061893}
[S7] START round=90 head_norm_before_train=2.342016 cos_to_last_merge=0.9118 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.7443333767214637, 'auprc': 0.8001079824173967, 'loss_val': 1.2695795751444587, 'psi': 0.7666432189998369}-{'f1_val': 0.8540525979246087, 'auprc': 0.8377424939706348, 'loss_val': 0.9872701555363287, 'psi': 0.8475285563430192}
[S8] START round=90 head_norm_before_train=2.107039 cos_to_last_merge=1.0000 (last merge round=88)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.984653652437015, 'auprc': 0.9984238121880362, 'loss_val': 0.053840565520414156, 'psi': 0.9901617163374234}-{'f1_val': 0.9921395546714198, 'auprc': 0.9885575747013454, 'loss_val': 0.035776006871301745, 'psi': 0.9907067626833901}
[S9] START round=90 head_norm_before_train=2.314772 cos_to_last_merge=1.0000 (last merge round=89)
[S9] round=90 local utility u=0.005060 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984447131406394, 'loss_val': 0.017774333861713974, 'psi': 0.9973741923445907}-{'f1_val': 0.9954108212552283, 'auprc': 0.9978614809206022, 'loss_val': 0.018646708957554114, 'psi': 0.9963910851213778}
[S10] START round=90 head_norm_before_train=2.288158 cos_to_last_merge=0.9609 (last merge round=24)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971612138392072, 'loss_val': 0.024620334707647316, 'psi': 0.996058357873921}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976095427481484, 'loss_val': 0.024569124300006195, 'psi': 0.9962376894374976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.090562 cos_to_last_merge=0.8035 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983059204415272, 'loss_val': 0.021289984467174318, 'psi': 0.9971177479896787}-{'f1_val': 0.996567470639547, 'auprc': 0.9985111917294226, 'loss_val': 0.019625485492990636, 'psi': 0.9973449590754973}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.949141 (no previous merge yet)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6081592600767354, 'auprc': 0.6921933124277488, 'loss_val': 1.3541500347072377, 'psi': 0.6417728810171408}-{'f1_val': 0.6747668209728812, 'auprc': 0.8246616068299024, 'loss_val': 1.213677214647464, 'psi': 0.7347247353156897}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.164287 cos_to_last_merge=0.9932 (last merge round=56)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9968732947155414, 'auprc': 0.998513294130261, 'loss_val': 0.017726628280475904, 'psi': 0.9975292944814292}-{'f1_val': 0.9972617020302783, 'auprc': 0.9986707875342293, 'loss_val': 0.016752355360878775, 'psi': 0.9978253362318587}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=1.928353 cos_to_last_merge=0.8591 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.859
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.8874871615698331, 'auprc': 0.955389814657423, 'loss_val': 0.19027041529923333, 'psi': 0.914648222804869}-{'f1_val': 0.9244501406222085, 'auprc': 0.995929226631347, 'loss_val': 0.14086390398910845, 'psi': 0.953041775025864}
[S16] START round=90 head_norm_before_train=2.277917 (no previous merge yet)
[S16] round=90 local utility u=0.210894 metrics={'f1_val': 0.9782539328016373, 'auprc': 0.9853789602001687, 'loss_val': 0.07872126686474487, 'psi': 0.9811039437610498}-{'f1_val': 0.9446080549160609, 'auprc': 0.9928171115053519, 'loss_val': 0.32094891837528927, 'psi': 0.9638916775517773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=90 head_norm_before_train=1.995365 cos_to_last_merge=0.7741 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.7821718591396439, 'auprc': 0.9372857770310377, 'loss_val': 0.9181028532488258, 'psi': 0.8442174262962014}-{'f1_val': 0.8310416734531294, 'auprc': 0.9622289105183628, 'loss_val': 0.5950570902836474, 'psi': 0.8835165682792228}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:57005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.326 → S8@127.0.0.1:57009
[S9] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=90 metric=0.9847 head_norm=2.111184
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.329924e-03
[S8] stored merged vector for next round verification (round=90)
[S8] DEBUG after merge:  round=90 metric=0.9843 head_norm=2.110501 delta_norm=0.008330
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.017 → S6@127.0.0.1:57007
[S7] ⇄ pheromone p=0.233 → S15@127.0.0.1:57015
[S15] ⇄ pheromone p=0.186 → S7@127.0.0.1:57008
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1792) from S9
[S5] cosine check vs S9: cos=0.9999
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=90 metric=0.9967 head_norm=2.320115
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.355898e-02
[S9] stored merged vector for next round verification (round=90)
[S9] DEBUG after merge:  round=90 metric=0.9967 head_norm=2.322326 delta_norm=0.013559
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.001 → S5@127.0.0.1:57005
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=90 metric=0.6849 head_norm=2.194762
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.428162e-03
[S2] stored merged vector for next round verification (round=90)
[S2] DEBUG after merge:  round=90 metric=0.6851 head_norm=2.194546 delta_norm=0.009428
[S2] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.126 → S4@127.0.0.1:57004
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=90 metric=0.9967 head_norm=2.324614
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.355898e-02
[S5] stored merged vector for next round verification (round=90)
[S5] DEBUG after merge:  round=90 metric=0.9967 head_norm=2.322326 delta_norm=0.013559
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.003 → S9@127.0.0.1:57010
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=90 metric=0.9397 head_norm=2.197329
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.146416e-02
[S4] stored merged vector for next round verification (round=90)
[S4] DEBUG after merge:  round=90 metric=0.9397 head_norm=2.196016 delta_norm=0.011464
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.014 → S2@127.0.0.1:57002
[S2] START round=91 head_norm_before_train=2.194546 cos_to_last_merge=1.0000 (last merge round=90)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.6446018446625887, 'auprc': 0.7042795899094785, 'loss_val': 1.1943545619563805, 'psi': 0.6684729427613446}-{'f1_val': 0.6848845558406134, 'auprc': 0.7036503597179329, 'loss_val': 0.8997322165653056, 'psi': 0.6923908773915411}
[S3] START round=91 head_norm_before_train=2.290945 cos_to_last_merge=0.9991 (last merge round=66)
[S3] round=91 local utility u=0.102960 metrics={'f1_val': 0.9626304814654795, 'auprc': 0.9980970190837943, 'loss_val': 0.08814808196262944, 'psi': 0.9768170965128053}-{'f1_val': 0.9540082368966836, 'auprc': 0.9784711735706964, 'loss_val': 0.18345635071424068, 'psi': 0.9637934115662886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=91 head_norm_before_train=2.196016 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=91 local utility u=0.021980 metrics={'f1_val': 0.9511425930233941, 'auprc': 0.9637100486263701, 'loss_val': 0.299805932146559, 'psi': 0.9561695752645845}-{'f1_val': 0.9396641521947791, 'auprc': 0.9710180479260218, 'loss_val': 0.29681898272844304, 'psi': 0.9522057104872761}
[S5] START round=91 head_norm_before_train=2.322326 cos_to_last_merge=1.0000 (last merge round=90)
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9921522840287181, 'loss_val': 0.01918355310255865, 'psi': 0.9948820946985619}-{'f1_val': 0.9967019684784577, 'auprc': 0.9937384296337308, 'loss_val': 0.019266687000255644, 'psi': 0.995516552940567}
[S6] START round=91 head_norm_before_train=2.115356 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.7264541427426808, 'auprc': 0.9391873389355052, 'loss_val': 0.6659569917827365, 'psi': 0.8115474212198106}-{'f1_val': 0.7695724399006453, 'auprc': 0.9387098978436358, 'loss_val': 0.582600432953805, 'psi': 0.8372274230778415}
[S7] START round=91 head_norm_before_train=2.354556 cos_to_last_merge=0.9108 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=91 local utility u=0.217178 metrics={'f1_val': 0.8022877650678242, 'auprc': 0.8053061258169881, 'loss_val': 1.198543802682953, 'psi': 0.8034951093674898}-{'f1_val': 0.7443333767214637, 'auprc': 0.8001079824173967, 'loss_val': 1.2695795751444587, 'psi': 0.7666432189998369}
[S8] START round=91 head_norm_before_train=2.110501 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=91 local utility u=0.019696 metrics={'f1_val': 0.9939497221170495, 'auprc': 0.9873382424590325, 'loss_val': 0.03696803246057915, 'psi': 0.9913051302538427}-{'f1_val': 0.984653652437015, 'auprc': 0.9984238121880362, 'loss_val': 0.053840565520414156, 'psi': 0.9901617163374234}
[S9] START round=91 head_norm_before_train=2.322326 cos_to_last_merge=1.0000 (last merge round=90)
[S9] round=91 local utility u=0.000576 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998533189302731, 'loss_val': 0.016887814653871857, 'psi': 0.9974095828094273}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984447131406394, 'loss_val': 0.017774333861713974, 'psi': 0.9973741923445907}
[S10] START round=91 head_norm_before_train=2.291597 cos_to_last_merge=0.9604 (last merge round=24)
[S10] round=91 local utility u=0.000097 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997226692569643, 'loss_val': 0.024623764409936664, 'psi': 0.9960845493660955}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971612138392072, 'loss_val': 0.024620334707647316, 'psi': 0.996058357873921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=91 head_norm_before_train=2.091789 cos_to_last_merge=0.8027 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=91 local utility u=0.001343 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998169050313268, 'loss_val': 0.01964411643493521, 'psi': 0.9972081025090354}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983059204415272, 'loss_val': 0.021289984467174318, 'psi': 0.9971177479896787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=91 head_norm_before_train=1.953457 (no previous merge yet)
[S13] round=91 local utility u=0.731199 metrics={'f1_val': 0.763030504431313, 'auprc': 0.7474254767152848, 'loss_val': 0.9866760956096143, 'psi': 0.7567884933449017}-{'f1_val': 0.6081592600767354, 'auprc': 0.6921933124277488, 'loss_val': 1.3541500347072377, 'psi': 0.6417728810171408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=91 head_norm_before_train=2.167704 cos_to_last_merge=0.9931 (last merge round=56)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9858850017402643, 'auprc': 0.9986850168815957, 'loss_val': 0.03303318053549012, 'psi': 0.9910050077967969}-{'f1_val': 0.9968732947155414, 'auprc': 0.998513294130261, 'loss_val': 0.017726628280475904, 'psi': 0.9975292944814292}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=1.932991 cos_to_last_merge=0.8586 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.859
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.7965416887172919, 'auprc': 0.9985674921700941, 'loss_val': 0.5523829794460645, 'psi': 0.8773520100984128}-{'f1_val': 0.8874871615698331, 'auprc': 0.955389814657423, 'loss_val': 0.19027041529923333, 'psi': 0.914648222804869}
[S16] START round=91 head_norm_before_train=2.281600 (no previous merge yet)
[S16] round=91 local utility u=0.064142 metrics={'f1_val': 0.9912944110087499, 'auprc': 0.9881738205352747, 'loss_val': 0.03706513574523023, 'psi': 0.9900461748193599}-{'f1_val': 0.9782539328016373, 'auprc': 0.9853789602001687, 'loss_val': 0.07872126686474487, 'psi': 0.9811039437610498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=91 head_norm_before_train=2.001700 cos_to_last_merge=0.7738 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=91 local utility u=0.282216 metrics={'f1_val': 0.8171932404814555, 'auprc': 0.9665822496889248, 'loss_val': 0.6516882655736522, 'psi': 0.8769488441644432}-{'f1_val': 0.7821718591396439, 'auprc': 0.9372857770310377, 'loss_val': 0.9181028532488258, 'psi': 0.8442174262962014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=-0.1046
[S15] DROPPED delta from S7 (cos=-0.1046 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9999
[S2] START round=92 head_norm_before_train=2.199816 cos_to_last_merge=1.0000 (last merge round=90)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6259305007536895, 'auprc': 0.7030469909135153, 'loss_val': 1.3478484904390604, 'psi': 0.6567770968176199}-{'f1_val': 0.6446018446625887, 'auprc': 0.7042795899094785, 'loss_val': 1.1943545619563805, 'psi': 0.6684729427613446}
[S3] START round=92 head_norm_before_train=2.296497 cos_to_last_merge=0.9991 (last merge round=66)
[S3] round=92 local utility u=0.033501 metrics={'f1_val': 0.9720790666047404, 'auprc': 0.996358921178768, 'loss_val': 0.0726239145949567, 'psi': 0.9817910084343515}-{'f1_val': 0.9626304814654795, 'auprc': 0.9980970190837943, 'loss_val': 0.08814808196262944, 'psi': 0.9768170965128053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=92 head_norm_before_train=2.201952 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9334099393950779, 'auprc': 0.9365677161529598, 'loss_val': 0.33026260018394793, 'psi': 0.9346730500982307}-{'f1_val': 0.9511425930233941, 'auprc': 0.9637100486263701, 'loss_val': 0.299805932146559, 'psi': 0.9561695752645845}
[S5] START round=92 head_norm_before_train=2.321517 cos_to_last_merge=1.0000 (last merge round=90)
[S5] round=92 local utility u=0.002423 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938843745559875, 'loss_val': 0.01953285631063506, 'psi': 0.9955749309094697}-{'f1_val': 0.9967019684784577, 'auprc': 0.9921522840287181, 'loss_val': 0.01918355310255865, 'psi': 0.9948820946985619}
[S6] START round=92 head_norm_before_train=2.122837 cos_to_last_merge=0.9999 (last merge round=88)
[S6] round=92 local utility u=1.000000 metrics={'f1_val': 0.9831474443865788, 'auprc': 0.9499386847746552, 'loss_val': 0.09691820760371013, 'psi': 0.9698639405418094}-{'f1_val': 0.7264541427426808, 'auprc': 0.9391873389355052, 'loss_val': 0.6659569917827365, 'psi': 0.8115474212198106}
[S7] START round=92 head_norm_before_train=2.364759 cos_to_last_merge=0.9099 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.6737083311417161, 'auprc': 0.7774380212293884, 'loss_val': 1.5179189860426927, 'psi': 0.7152002071767851}-{'f1_val': 0.8022877650678242, 'auprc': 0.8053061258169881, 'loss_val': 1.198543802682953, 'psi': 0.8034951093674898}
[S8] START round=92 head_norm_before_train=2.114003 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9860639574098615, 'auprc': 0.9978208736977363, 'loss_val': 0.047725824101588966, 'psi': 0.9907667239250115}-{'f1_val': 0.9939497221170495, 'auprc': 0.9873382424590325, 'loss_val': 0.03696803246057915, 'psi': 0.9913051302538427}
[S9] START round=92 head_norm_before_train=2.329350 cos_to_last_merge=1.0000 (last merge round=90)
[S9] round=92 local utility u=0.000820 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9978901795231734, 'loss_val': 0.015784662866171275, 'psi': 0.9973989197308895}-{'f1_val': 0.9966605118138915, 'auprc': 0.998533189302731, 'loss_val': 0.016887814653871857, 'psi': 0.9974095828094273}
[S10] START round=92 head_norm_before_train=2.296250 cos_to_last_merge=0.9602 (last merge round=24)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970384071882852, 'loss_val': 0.024702232885322254, 'psi': 0.9960092352135523}-{'f1_val': 0.9953231205637304, 'auprc': 0.997226692569643, 'loss_val': 0.024623764409936664, 'psi': 0.9960845493660955}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.094118 cos_to_last_merge=0.8023 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982810665070353, 'loss_val': 0.021310458045050714, 'psi': 0.9971078064158818}-{'f1_val': 0.996567470639547, 'auprc': 0.998169050313268, 'loss_val': 0.01964411643493521, 'psi': 0.9972081025090354}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.959848 (no previous merge yet)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.739276024365531, 'auprc': 0.8031809590364652, 'loss_val': 1.0595094320838516, 'psi': 0.7648379982339046}-{'f1_val': 0.763030504431313, 'auprc': 0.7474254767152848, 'loss_val': 0.9866760956096143, 'psi': 0.7567884933449017}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.170282 cos_to_last_merge=0.9930 (last merge round=56)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9304675771953448, 'auprc': 0.9982327900107949, 'loss_val': 0.23382198381138578, 'psi': 0.9575736623215247}-{'f1_val': 0.9858850017402643, 'auprc': 0.9986850168815957, 'loss_val': 0.03303318053549012, 'psi': 0.9910050077967969}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=1.936669 cos_to_last_merge=0.8583 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=92 local utility u=0.331315 metrics={'f1_val': 0.8956995503009619, 'auprc': 0.9456659382131215, 'loss_val': 0.32599507004088035, 'psi': 0.9156861054658257}-{'f1_val': 0.7965416887172919, 'auprc': 0.9985674921700941, 'loss_val': 0.5523829794460645, 'psi': 0.8773520100984128}
[S16] START round=92 head_norm_before_train=2.286490 (no previous merge yet)
[S16] round=92 local utility u=0.007196 metrics={'f1_val': 0.9918272861818264, 'auprc': 0.9916720692035976, 'loss_val': 0.03636493933837677, 'psi': 0.9917651993905349}-{'f1_val': 0.9912944110087499, 'auprc': 0.9881738205352747, 'loss_val': 0.03706513574523023, 'psi': 0.9900461748193599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=92 head_norm_before_train=2.006859 cos_to_last_merge=0.7736 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=92 local utility u=0.388858 metrics={'f1_val': 0.8796702542556775, 'auprc': 0.9907382590724763, 'loss_val': 0.3213028770649776, 'psi': 0.9240974561823969}-{'f1_val': 0.8171932404814555, 'auprc': 0.9665822496889248, 'loss_val': 0.6516882655736522, 'psi': 0.8769488441644432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=92 metric=0.6259 head_norm=2.205614
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.389454e-03
[S2] stored merged vector for next round verification (round=92)
[S2] DEBUG after merge:  round=92 metric=0.6259 head_norm=2.203772 delta_norm=0.007389
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=-0.1044
[S7] DROPPED delta from S15 (cos=-0.1044 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=92 metric=0.9967 head_norm=2.324091
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.676024e-02
[S5] stored merged vector for next round verification (round=92)
[S5] DEBUG after merge:  round=92 metric=0.9967 head_norm=2.327335 delta_norm=0.016760
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=92 metric=0.9831 head_norm=2.132166
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.826153e-02
[S6] stored merged vector for next round verification (round=92)
[S6] DEBUG after merge:  round=92 metric=0.9831 head_norm=2.123025 delta_norm=0.018262
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=92 metric=0.9971 head_norm=2.332049
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.790083e-02
[S9] stored merged vector for next round verification (round=92)
[S9] DEBUG after merge:  round=92 metric=0.9971 head_norm=2.328004 delta_norm=0.017901
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=2.203772 cos_to_last_merge=1.0000 (last merge round=92)
[S2] round=93 local utility u=0.461864 metrics={'f1_val': 0.7043784811766491, 'auprc': 0.7052164083730332, 'loss_val': 0.9013159667146262, 'psi': 0.7047136520552028}-{'f1_val': 0.6259305007536895, 'auprc': 0.7030469909135153, 'loss_val': 1.3478484904390604, 'psi': 0.6567770968176199}
[S3] START round=93 head_norm_before_train=2.301219 cos_to_last_merge=0.9990 (last merge round=66)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9375953397126773, 'auprc': 0.9923386321911839, 'loss_val': 0.2977492276924841, 'psi': 0.9594926567040799}-{'f1_val': 0.9720790666047404, 'auprc': 0.996358921178768, 'loss_val': 0.0726239145949567, 'psi': 0.9817910084343515}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=2.204561 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9312456270051815, 'auprc': 0.8868067294863067, 'loss_val': 0.3379854012614442, 'psi': 0.9134700679976315}-{'f1_val': 0.9334099393950779, 'auprc': 0.9365677161529598, 'loss_val': 0.33026260018394793, 'psi': 0.9346730500982307}
[S5] START round=93 head_norm_before_train=2.327335 cos_to_last_merge=1.0000 (last merge round=92)
[S5] round=93 local utility u=0.000700 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940778017766259, 'loss_val': 0.01871409876169957, 'psi': 0.995652301797725}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938843745559875, 'loss_val': 0.01953285631063506, 'psi': 0.9955749309094697}
[S6] START round=93 head_norm_before_train=2.123025 cos_to_last_merge=1.0000 (last merge round=92)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.8260995419920609, 'auprc': 0.9426678434625341, 'loss_val': 0.41877929896090677, 'psi': 0.8727268625802502}-{'f1_val': 0.9831474443865788, 'auprc': 0.9499386847746552, 'loss_val': 0.09691820760371013, 'psi': 0.9698639405418094}
[S7] START round=93 head_norm_before_train=2.378014 cos_to_last_merge=0.9088 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=93 local utility u=0.827801 metrics={'f1_val': 0.8035868678104026, 'auprc': 0.8641463203911239, 'loss_val': 0.9017126899042917, 'psi': 0.8278106488426911}-{'f1_val': 0.6737083311417161, 'auprc': 0.7774380212293884, 'loss_val': 1.5179189860426927, 'psi': 0.7152002071767851}
[S8] START round=93 head_norm_before_train=2.119029 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9892527482403732, 'auprc': 0.9880220681031173, 'loss_val': 0.03869396703706596, 'psi': 0.9887604761854709}-{'f1_val': 0.9860639574098615, 'auprc': 0.9978208736977363, 'loss_val': 0.047725824101588966, 'psi': 0.9907667239250115}
[S9] START round=93 head_norm_before_train=2.328004 cos_to_last_merge=1.0000 (last merge round=92)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984585331801149, 'loss_val': 0.01643869262604722, 'psi': 0.9973797203603808}-{'f1_val': 0.9970714132027002, 'auprc': 0.9978901795231734, 'loss_val': 0.015784662866171275, 'psi': 0.9973989197308895}
[S10] START round=93 head_norm_before_train=2.299517 cos_to_last_merge=0.9597 (last merge round=24)
[S10] round=93 local utility u=0.000170 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971412734671126, 'loss_val': 0.024670989302355652, 'psi': 0.9960503817250832}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970384071882852, 'loss_val': 0.024702232885322254, 'psi': 0.9960092352135523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=93 head_norm_before_train=2.094416 cos_to_last_merge=0.8021 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983399427051394, 'loss_val': 0.021550143934698687, 'psi': 0.9971313568951234}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982810665070353, 'loss_val': 0.021310458045050714, 'psi': 0.9971078064158818}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.966879 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6236815878449757, 'auprc': 0.688403060971225, 'loss_val': 1.2843758327660657, 'psi': 0.6495701770954754}-{'f1_val': 0.739276024365531, 'auprc': 0.8031809590364652, 'loss_val': 1.0595094320838516, 'psi': 0.7648379982339046}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.174553 cos_to_last_merge=0.9929 (last merge round=56)
[S14] round=93 local utility u=0.037957 metrics={'f1_val': 0.9322361483869444, 'auprc': 0.9985843651664514, 'loss_val': 0.16957450418363618, 'psi': 0.9587754350987472}-{'f1_val': 0.9304675771953448, 'auprc': 0.9982327900107949, 'loss_val': 0.23382198381138578, 'psi': 0.9575736623215247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=93 head_norm_before_train=1.940688 cos_to_last_merge=0.8579 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=93 local utility u=0.034971 metrics={'f1_val': 0.8986592146511982, 'auprc': 0.9517416200948945, 'loss_val': 0.29203886327247025, 'psi': 0.9198921768286767}-{'f1_val': 0.8956995503009619, 'auprc': 0.9456659382131215, 'loss_val': 0.32599507004088035, 'psi': 0.9156861054658257}
[S16] START round=93 head_norm_before_train=2.288776 (no previous merge yet)
[S16] round=93 local utility u=0.002193 metrics={'f1_val': 0.9918272861818264, 'auprc': 0.993945520033343, 'loss_val': 0.038800212904612545, 'psi': 0.992674579722433}-{'f1_val': 0.9918272861818264, 'auprc': 0.9916720692035976, 'loss_val': 0.03636493933837677, 'psi': 0.9917651993905349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=93 head_norm_before_train=2.013389 cos_to_last_merge=0.7731 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=93 local utility u=0.091162 metrics={'f1_val': 0.9096877735639431, 'auprc': 0.9906301156025323, 'loss_val': 0.3187602239315977, 'psi': 0.9420647103793788}-{'f1_val': 0.8796702542556775, 'auprc': 0.9907382590724763, 'loss_val': 0.3213028770649776, 'psi': 0.9240974561823969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=93 metric=0.9893 head_norm=2.124951
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.758987e-02
[S8] stored merged vector for next round verification (round=93)
[S8] DEBUG after merge:  round=93 metric=0.9893 head_norm=2.128489 delta_norm=0.017590
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=-0.1040
[S7] DROPPED delta from S15 (cos=-0.1040 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=-0.1040
[S15] DROPPED delta from S7 (cos=-0.1040 < 0.0)
[S2] START round=94 head_norm_before_train=2.209730 cos_to_last_merge=1.0000 (last merge round=92)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.670792306041978, 'auprc': 0.7005371107687, 'loss_val': 1.0642886895755714, 'psi': 0.6826902279326668}-{'f1_val': 0.7043784811766491, 'auprc': 0.7052164083730332, 'loss_val': 0.9013159667146262, 'psi': 0.7047136520552028}
[S3] START round=94 head_norm_before_train=2.303266 cos_to_last_merge=0.9989 (last merge round=66)
[S3] round=94 local utility u=0.209336 metrics={'f1_val': 0.9744699354161345, 'auprc': 0.9982677951271504, 'loss_val': 0.11811131524218574, 'psi': 0.9839890793005408}-{'f1_val': 0.9375953397126773, 'auprc': 0.9923386321911839, 'loss_val': 0.2977492276924841, 'psi': 0.9594926567040799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=94 head_norm_before_train=2.206876 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=94 local utility u=0.068587 metrics={'f1_val': 0.9324046568173345, 'auprc': 0.9284862969008107, 'loss_val': 0.3328042867305798, 'psi': 0.930837312850725}-{'f1_val': 0.9312456270051815, 'auprc': 0.8868067294863067, 'loss_val': 0.3379854012614442, 'psi': 0.9134700679976315}
[S5] START round=94 head_norm_before_train=2.331273 cos_to_last_merge=1.0000 (last merge round=92)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938401895702064, 'loss_val': 0.027162998221343174, 'psi': 0.9955572569151572}-{'f1_val': 0.9967019684784577, 'auprc': 0.9940778017766259, 'loss_val': 0.01871409876169957, 'psi': 0.995652301797725}
[S6] START round=94 head_norm_before_train=2.130195 cos_to_last_merge=1.0000 (last merge round=92)
[S6] round=94 local utility u=0.037112 metrics={'f1_val': 0.8364742784756484, 'auprc': 0.9421326964275996, 'loss_val': 0.40519790910180653, 'psi': 0.8787376456564289}-{'f1_val': 0.8260995419920609, 'auprc': 0.9426678434625341, 'loss_val': 0.41877929896090677, 'psi': 0.8727268625802502}
[S7] START round=94 head_norm_before_train=2.389622 cos_to_last_merge=0.9079 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.908
[S7] round=94 local utility u=0.096038 metrics={'f1_val': 0.8241396358151416, 'auprc': 0.8722085796952382, 'loss_val': 0.8571399223376637, 'psi': 0.8433672133671803}-{'f1_val': 0.8035868678104026, 'auprc': 0.8641463203911239, 'loss_val': 0.9017126899042917, 'psi': 0.8278106488426911}
[S8] START round=94 head_norm_before_train=2.128489 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9428596636318713, 'auprc': 0.988646034820618, 'loss_val': 0.14584009396483705, 'psi': 0.96117421210737}-{'f1_val': 0.9892527482403732, 'auprc': 0.9880220681031173, 'loss_val': 0.03869396703706596, 'psi': 0.9887604761854709}
[S9] START round=94 head_norm_before_train=2.333480 cos_to_last_merge=1.0000 (last merge round=92)
[S9] round=94 local utility u=0.000129 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986743902978831, 'loss_val': 0.01682769248075033, 'psi': 0.9974660632074881}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984585331801149, 'loss_val': 0.01643869262604722, 'psi': 0.9973797203603808}
[S10] START round=94 head_norm_before_train=2.301233 cos_to_last_merge=0.9589 (last merge round=24)
[S10] round=94 local utility u=0.000175 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972375332816208, 'loss_val': 0.024609309237616197, 'psi': 0.9960888856508865}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971412734671126, 'loss_val': 0.024670989302355652, 'psi': 0.9960503817250832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=94 head_norm_before_train=2.096603 cos_to_last_merge=0.8021 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9790354626703238, 'auprc': 0.9984517162789651, 'loss_val': 0.05385245639467414, 'psi': 0.9868019641137804}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983399427051394, 'loss_val': 0.021550143934698687, 'psi': 0.9971313568951234}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.972811 (no previous merge yet)
[S13] round=94 local utility u=0.680187 metrics={'f1_val': 0.7662255788918563, 'auprc': 0.7629509120427911, 'loss_val': 1.0029089218667648, 'psi': 0.7649157121522302}-{'f1_val': 0.6236815878449757, 'auprc': 0.688403060971225, 'loss_val': 1.2843758327660657, 'psi': 0.6495701770954754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=94 head_norm_before_train=2.179111 cos_to_last_merge=0.9927 (last merge round=56)
[S14] round=94 local utility u=0.265889 metrics={'f1_val': 0.9956133093410242, 'auprc': 0.9988962122986572, 'loss_val': 0.018994167945830483, 'psi': 0.9969264705240773}-{'f1_val': 0.9322361483869444, 'auprc': 0.9985843651664514, 'loss_val': 0.16957450418363618, 'psi': 0.9587754350987472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=94 head_norm_before_train=1.945140 cos_to_last_merge=0.8575 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=94 local utility u=0.202250 metrics={'f1_val': 0.9249280802294206, 'auprc': 0.9772987234193224, 'loss_val': 0.12182366863964762, 'psi': 0.9458763375053814}-{'f1_val': 0.8986592146511982, 'auprc': 0.9517416200948945, 'loss_val': 0.29203886327247025, 'psi': 0.9198921768286767}
[S16] START round=94 head_norm_before_train=2.292203 (no previous merge yet)
[S16] round=94 local utility u=0.003479 metrics={'f1_val': 0.9922647925825068, 'auprc': 0.9958378419523657, 'loss_val': 0.04014386412843232, 'psi': 0.9936940123304503}-{'f1_val': 0.9918272861818264, 'auprc': 0.993945520033343, 'loss_val': 0.038800212904612545, 'psi': 0.992674579722433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=94 head_norm_before_train=2.020510 cos_to_last_merge=0.7722 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7815235197232024, 'auprc': 0.9609627994678958, 'loss_val': 0.870985338281324, 'psi': 0.8532992316210798}-{'f1_val': 0.9096877735639431, 'auprc': 0.9906301156025323, 'loss_val': 0.3187602239315977, 'psi': 0.9420647103793788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:57005
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=-0.1038
[S15] DROPPED delta from S7 (cos=-0.1038 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1038
[S7] DROPPED delta from S15 (cos=-0.1038 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=94 metric=0.9967 head_norm=2.340688
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.992324e-03
[S9] stored merged vector for next round verification (round=94)
[S9] DEBUG after merge:  round=94 metric=0.9967 head_norm=2.335964 delta_norm=0.009992
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=94 metric=0.9324 head_norm=2.208713
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.218223e-02
[S4] stored merged vector for next round verification (round=94)
[S4] DEBUG after merge:  round=94 metric=0.9324 head_norm=2.209188 delta_norm=0.012182
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=95 head_norm_before_train=2.215985 cos_to_last_merge=1.0000 (last merge round=92)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.6606366453231647, 'auprc': 0.6981379858895026, 'loss_val': 1.1807519386168903, 'psi': 0.6756371815496998}-{'f1_val': 0.670792306041978, 'auprc': 0.7005371107687, 'loss_val': 1.0642886895755714, 'psi': 0.6826902279326668}
[S3] START round=95 head_norm_before_train=2.303627 cos_to_last_merge=0.9988 (last merge round=66)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.9421910733974316, 'auprc': 0.988939681874295, 'loss_val': 0.16614772847617476, 'psi': 0.9608905167881769}-{'f1_val': 0.9744699354161345, 'auprc': 0.9982677951271504, 'loss_val': 0.11811131524218574, 'psi': 0.9839890793005408}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=2.209188 cos_to_last_merge=1.0000 (last merge round=94)
[S4] round=95 local utility u=0.004480 metrics={'f1_val': 0.9315016002895244, 'auprc': 0.9360504834640031, 'loss_val': 0.34111811293126093, 'psi': 0.9333211535593159}-{'f1_val': 0.9324046568173345, 'auprc': 0.9284862969008107, 'loss_val': 0.3328042867305798, 'psi': 0.930837312850725}
[S5] START round=95 head_norm_before_train=2.335963 cos_to_last_merge=1.0000 (last merge round=92)
[S5] round=95 local utility u=0.003484 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9937911170304663, 'loss_val': 0.02004730009202817, 'psi': 0.9955376278992611}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938401895702064, 'loss_val': 0.027162998221343174, 'psi': 0.9955572569151572}
[S6] START round=95 head_norm_before_train=2.137365 cos_to_last_merge=0.9999 (last merge round=92)
[S6] round=95 local utility u=0.070339 metrics={'f1_val': 0.839320388920372, 'auprc': 0.9450524034787686, 'loss_val': 0.2903555413595434, 'psi': 0.8816131947437307}-{'f1_val': 0.8364742784756484, 'auprc': 0.9421326964275996, 'loss_val': 0.40519790910180653, 'psi': 0.8787376456564289}
[S7] START round=95 head_norm_before_train=2.400696 cos_to_last_merge=0.9070 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.8154869061010652, 'auprc': 0.8775238251500166, 'loss_val': 0.8346446502686569, 'psi': 0.8403016737206458}-{'f1_val': 0.8241396358151416, 'auprc': 0.8722085796952382, 'loss_val': 0.8571399223376637, 'psi': 0.8433672133671803}
[S8] START round=95 head_norm_before_train=2.133109 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=95 local utility u=0.181102 metrics={'f1_val': 0.9868821161158586, 'auprc': 0.9888488547962496, 'loss_val': 0.048379278332681554, 'psi': 0.987668811588015}-{'f1_val': 0.9428596636318713, 'auprc': 0.988646034820618, 'loss_val': 0.14584009396483705, 'psi': 0.96117421210737}
[S9] START round=95 head_norm_before_train=2.335964 cos_to_last_merge=1.0000 (last merge round=94)
[S9] round=95 local utility u=0.002030 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9989558393672924, 'loss_val': 0.016077092798976712, 'psi': 0.997825183668537}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986743902978831, 'loss_val': 0.01682769248075033, 'psi': 0.9974660632074881}
[S10] START round=95 head_norm_before_train=2.304941 cos_to_last_merge=0.9586 (last merge round=24)
[S10] round=95 local utility u=0.000056 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972704640588507, 'loss_val': 0.024595448321054196, 'psi': 0.9961020579617785}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972375332816208, 'loss_val': 0.024609309237616197, 'psi': 0.9960888856508865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=95 head_norm_before_train=2.097354 cos_to_last_merge=0.8022 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=95 local utility u=0.068603 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9984699067068221, 'loss_val': 0.02044301605546666, 'psi': 0.9971833424957965}-{'f1_val': 0.9790354626703238, 'auprc': 0.9984517162789651, 'loss_val': 0.05385245639467414, 'psi': 0.9868019641137804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=95 head_norm_before_train=1.976555 (no previous merge yet)
[S13] round=95 local utility u=0.317803 metrics={'f1_val': 0.7834890106196651, 'auprc': 0.8328182057707257, 'loss_val': 0.6804853268114595, 'psi': 0.8032206886800894}-{'f1_val': 0.7662255788918563, 'auprc': 0.7629509120427911, 'loss_val': 1.0029089218667648, 'psi': 0.7649157121522302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=95 head_norm_before_train=2.184029 cos_to_last_merge=0.9926 (last merge round=56)
[S14] round=95 local utility u=0.005996 metrics={'f1_val': 0.9974486688495627, 'auprc': 0.9987556624205385, 'loss_val': 0.01759195543430007, 'psi': 0.997971466277953}-{'f1_val': 0.9956133093410242, 'auprc': 0.9988962122986572, 'loss_val': 0.018994167945830483, 'psi': 0.9969264705240773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=95 head_norm_before_train=1.949978 cos_to_last_merge=0.8570 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.857
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9150404358197134, 'auprc': 0.9963020736868466, 'loss_val': 0.14658902243787994, 'psi': 0.9475450909665667}-{'f1_val': 0.9249280802294206, 'auprc': 0.9772987234193224, 'loss_val': 0.12182366863964762, 'psi': 0.9458763375053814}
[S16] START round=95 head_norm_before_train=2.296758 (no previous merge yet)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9916086187935218, 'auprc': 0.9973553941781443, 'loss_val': 0.0421871771966648, 'psi': 0.9939073289473708}-{'f1_val': 0.9922647925825068, 'auprc': 0.9958378419523657, 'loss_val': 0.04014386412843232, 'psi': 0.9936940123304503}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.026682 cos_to_last_merge=0.7716 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=95 local utility u=0.353789 metrics={'f1_val': 0.8459294125104846, 'auprc': 0.9677247202990834, 'loss_val': 0.5701287690325162, 'psi': 0.8946475356259241}-{'f1_val': 0.7815235197232024, 'auprc': 0.9609627994678958, 'loss_val': 0.870985338281324, 'psi': 0.8532992316210798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:57009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:57005
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] ⇄ pheromone p=0.132 → S7@127.0.0.1:57008
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] ⇄ pheromone p=0.215 → S15@127.0.0.1:57015
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=95 metric=0.6606 head_norm=2.223141
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.993787e-02
[S2] stored merged vector for next round verification (round=95)
[S2] DEBUG after merge:  round=95 metric=0.6605 head_norm=2.215849 delta_norm=0.019938
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.100 → S4@127.0.0.1:57004
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S6
[S8] cosine check vs S6: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=1.0000
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9998
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=95 metric=0.8393 head_norm=2.147842
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.935845e-02
[S6] stored merged vector for next round verification (round=95)
[S6] DEBUG after merge:  round=95 metric=0.8390 head_norm=2.142286 delta_norm=0.019358
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.229 → S8@127.0.0.1:57009
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=95 metric=0.9971 head_norm=2.342785
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.275373e-02
[S9] stored merged vector for next round verification (round=95)
[S9] DEBUG after merge:  round=95 metric=0.9971 head_norm=2.341949 delta_norm=0.012754
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.001 → S5@127.0.0.1:57005
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=95 metric=0.9869 head_norm=2.136892
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.632979e-02
[S8] stored merged vector for next round verification (round=95)
[S8] DEBUG after merge:  round=95 metric=0.9869 head_norm=2.139683 delta_norm=0.016330
[S8] aggregate: ACCEPT kept=['S6', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.043 → S6@127.0.0.1:57007
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=95 metric=0.9967 head_norm=2.341183
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.352000e-02
[S5] stored merged vector for next round verification (round=95)
[S5] DEBUG after merge:  round=95 metric=0.9967 head_norm=2.341419 delta_norm=0.013520
[S5] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.002 → S9@127.0.0.1:57010
[S4] ⇄ pheromone p=0.018 → S2@127.0.0.1:57002
[S2] START round=96 head_norm_before_train=2.215849 cos_to_last_merge=1.0000 (last merge round=95)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.6276248915061696, 'auprc': 0.7021204490820178, 'loss_val': 1.3860988880967877, 'psi': 0.6574231145365088}-{'f1_val': 0.6606366453231647, 'auprc': 0.6981379858895026, 'loss_val': 1.1807519386168903, 'psi': 0.6756371815496998}
[S3] START round=96 head_norm_before_train=2.306823 cos_to_last_merge=0.9987 (last merge round=66)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.941394748221934, 'auprc': 0.988262778452397, 'loss_val': 0.17634101625010234, 'psi': 0.9601419603141192}-{'f1_val': 0.9421910733974316, 'auprc': 0.988939681874295, 'loss_val': 0.16614772847617476, 'psi': 0.9608905167881769}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.214684 cos_to_last_merge=1.0000 (last merge round=94)
[S4] round=96 local utility u=0.029319 metrics={'f1_val': 0.9343958877796177, 'auprc': 0.9474463939997964, 'loss_val': 0.334033366942407, 'psi': 0.9396160902676891}-{'f1_val': 0.9315016002895244, 'auprc': 0.9360504834640031, 'loss_val': 0.34111811293126093, 'psi': 0.9333211535593159}
[S5] START round=96 head_norm_before_train=2.341419 cos_to_last_merge=1.0000 (last merge round=95)
[S5] round=96 local utility u=0.000699 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939588881106323, 'loss_val': 0.01915207732642593, 'psi': 0.9956047363313275}-{'f1_val': 0.9967019684784577, 'auprc': 0.9937911170304663, 'loss_val': 0.02004730009202817, 'psi': 0.9955376278992611}
[S6] START round=96 head_norm_before_train=2.142286 cos_to_last_merge=1.0000 (last merge round=95)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.754758739060631, 'auprc': 0.8290899470301913, 'loss_val': 0.6812286158124854, 'psi': 0.7844912222484551}-{'f1_val': 0.839320388920372, 'auprc': 0.9450524034787686, 'loss_val': 0.2903555413595434, 'psi': 0.8816131947437307}
[S7] START round=96 head_norm_before_train=2.410766 cos_to_last_merge=0.9062 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.7786105123806362, 'auprc': 0.8144734405269084, 'loss_val': 1.2468350878939303, 'psi': 0.792955683639145}-{'f1_val': 0.8154869061010652, 'auprc': 0.8775238251500166, 'loss_val': 0.8346446502686569, 'psi': 0.8403016737206458}
[S8] START round=96 head_norm_before_train=2.139683 cos_to_last_merge=1.0000 (last merge round=95)
[S8] round=96 local utility u=0.023862 metrics={'f1_val': 0.99304356686603, 'auprc': 0.9887156537505375, 'loss_val': 0.037223913861153105, 'psi': 0.991312401619833}-{'f1_val': 0.9868821161158586, 'auprc': 0.9888488547962496, 'loss_val': 0.048379278332681554, 'psi': 0.987668811588015}
[S9] START round=96 head_norm_before_train=2.341949 cos_to_last_merge=1.0000 (last merge round=95)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986096335970829, 'loss_val': 0.017292809331455286, 'psi': 0.997440160527168}-{'f1_val': 0.9970714132027002, 'auprc': 0.9989558393672924, 'loss_val': 0.016077092798976712, 'psi': 0.997825183668537}
[S10] START round=96 head_norm_before_train=2.305713 cos_to_last_merge=0.9577 (last merge round=24)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972285230039426, 'loss_val': 0.024704693020470608, 'psi': 0.9960852815398152}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972704640588507, 'loss_val': 0.024595448321054196, 'psi': 0.9961020579617785}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.101051 cos_to_last_merge=0.8024 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983931449362635, 'loss_val': 0.020927181215180654, 'psi': 0.9971526377875732}-{'f1_val': 0.9963256330217796, 'auprc': 0.9984699067068221, 'loss_val': 0.02044301605546666, 'psi': 0.9971833424957965}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.976835 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.7346293829565903, 'auprc': 0.7203967888309661, 'loss_val': 1.0975716732706637, 'psi': 0.7289363453063407}-{'f1_val': 0.7834890106196651, 'auprc': 0.8328182057707257, 'loss_val': 0.6804853268114595, 'psi': 0.8032206886800894}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.190619 cos_to_last_merge=0.9924 (last merge round=56)
[S14] round=96 local utility u=0.000748 metrics={'f1_val': 0.9976694466594485, 'auprc': 0.9988555369607379, 'loss_val': 0.017721224159281103, 'psi': 0.9981438827799642}-{'f1_val': 0.9974486688495627, 'auprc': 0.9987556624205385, 'loss_val': 0.01759195543430007, 'psi': 0.997971466277953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=96 head_norm_before_train=1.955053 cos_to_last_merge=0.8565 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.857
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.8316763215067641, 'auprc': 0.9975185042506184, 'loss_val': 0.41595725552840024, 'psi': 0.8980131946043058}-{'f1_val': 0.9150404358197134, 'auprc': 0.9963020736868466, 'loss_val': 0.14658902243787994, 'psi': 0.9475450909665667}
[S16] START round=96 head_norm_before_train=2.301843 (no previous merge yet)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9834127743131381, 'auprc': 0.9832072371161601, 'loss_val': 0.09904710111074998, 'psi': 0.9833305594343469}-{'f1_val': 0.9916086187935218, 'auprc': 0.9973553941781443, 'loss_val': 0.0421871771966648, 'psi': 0.9939073289473708}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.030370 cos_to_last_merge=0.7710 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.8225258632792682, 'auprc': 0.940383631866332, 'loss_val': 0.6257965618453538, 'psi': 0.8696689707140938}-{'f1_val': 0.8459294125104846, 'auprc': 0.9677247202990834, 'loss_val': 0.5701287690325162, 'psi': 0.8946475356259241}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=96 metric=0.6276 head_norm=2.223836
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.078450e-02
[S2] stored merged vector for next round verification (round=96)
[S2] DEBUG after merge:  round=96 metric=0.6276 head_norm=2.219238 delta_norm=0.010785
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] cosine check vs S5: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=1.0000
[S2] START round=97 head_norm_before_train=2.219238 cos_to_last_merge=1.0000 (last merge round=96)
[S2] round=97 local utility u=0.245253 metrics={'f1_val': 0.6671803738984726, 'auprc': 0.6974185305642638, 'loss_val': 1.1188203769997387, 'psi': 0.6792756365647892}-{'f1_val': 0.6276248915061696, 'auprc': 0.7021204490820178, 'loss_val': 1.3860988880967877, 'psi': 0.6574231145365088}
[S3] START round=97 head_norm_before_train=2.311386 cos_to_last_merge=0.9986 (last merge round=66)
[S3] round=97 local utility u=0.054424 metrics={'f1_val': 0.9521425531068083, 'auprc': 0.9904579918665267, 'loss_val': 0.13856554012108277, 'psi': 0.9674687286106957}-{'f1_val': 0.941394748221934, 'auprc': 0.988262778452397, 'loss_val': 0.17634101625010234, 'psi': 0.9601419603141192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=97 head_norm_before_train=2.217846 cos_to_last_merge=1.0000 (last merge round=94)
[S4] round=97 local utility u=0.020706 metrics={'f1_val': 0.937414079883967, 'auprc': 0.9550628068075584, 'loss_val': 0.33357974244205146, 'psi': 0.9444735706534035}-{'f1_val': 0.9343958877796177, 'auprc': 0.9474463939997964, 'loss_val': 0.334033366942407, 'psi': 0.9396160902676891}
[S5] START round=97 head_norm_before_train=2.345645 cos_to_last_merge=1.0000 (last merge round=95)
[S5] round=97 local utility u=0.002536 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9957061341636427, 'loss_val': 0.019320848325622506, 'psi': 0.9963036347525317}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939588881106323, 'loss_val': 0.01915207732642593, 'psi': 0.9956047363313275}
[S6] START round=97 head_norm_before_train=2.151562 cos_to_last_merge=1.0000 (last merge round=95)
[S6] round=97 local utility u=0.147242 metrics={'f1_val': 0.7587755794439749, 'auprc': 0.9181098238284287, 'loss_val': 0.6779058347435343, 'psi': 0.8225092771977565}-{'f1_val': 0.754758739060631, 'auprc': 0.8290899470301913, 'loss_val': 0.6812286158124854, 'psi': 0.7844912222484551}
[S7] START round=97 head_norm_before_train=2.419409 cos_to_last_merge=0.9055 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=97 local utility u=0.566930 metrics={'f1_val': 0.8292394950934988, 'auprc': 0.9070313774182316, 'loss_val': 0.6944225136520463, 'psi': 0.860356248023392}-{'f1_val': 0.7786105123806362, 'auprc': 0.8144734405269084, 'loss_val': 1.2468350878939303, 'psi': 0.792955683639145}
[S8] START round=97 head_norm_before_train=2.140848 cos_to_last_merge=1.0000 (last merge round=95)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9939497221170495, 'auprc': 0.9880091508747418, 'loss_val': 0.04125700802630922, 'psi': 0.9915734936201264}-{'f1_val': 0.99304356686603, 'auprc': 0.9887156537505375, 'loss_val': 0.037223913861153105, 'psi': 0.991312401619833}
[S9] START round=97 head_norm_before_train=2.346277 cos_to_last_merge=1.0000 (last merge round=95)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985783999266823, 'loss_val': 0.017587717666929025, 'psi': 0.9974276670590078}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986096335970829, 'loss_val': 0.017292809331455286, 'psi': 0.997440160527168}
[S10] START round=97 head_norm_before_train=2.308467 cos_to_last_merge=0.9571 (last merge round=24)
[S10] round=97 local utility u=0.000084 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972644230978371, 'loss_val': 0.024644967284237398, 'psi': 0.9960996415773731}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972285230039426, 'loss_val': 0.024704693020470608, 'psi': 0.9960852815398152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=97 head_norm_before_train=2.103162 cos_to_last_merge=0.8025 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=97 local utility u=0.001561 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998507028293247, 'loss_val': 0.019597022179882677, 'psi': 0.997343293701027}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983931449362635, 'loss_val': 0.020927181215180654, 'psi': 0.9971526377875732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=97 head_norm_before_train=1.978101 (no previous merge yet)
[S13] round=97 local utility u=0.056736 metrics={'f1_val': 0.731653750239318, 'auprc': 0.7879110799944085, 'loss_val': 1.1687881501179818, 'psi': 0.7541566821413541}-{'f1_val': 0.7346293829565903, 'auprc': 0.7203967888309661, 'loss_val': 1.0975716732706637, 'psi': 0.7289363453063407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=97 head_norm_before_train=2.194398 cos_to_last_merge=0.9920 (last merge round=56)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9312051384796475, 'auprc': 0.998353092720012, 'loss_val': 0.18102404147013695, 'psi': 0.9580643201757933}-{'f1_val': 0.9976694466594485, 'auprc': 0.9988555369607379, 'loss_val': 0.017721224159281103, 'psi': 0.9981438827799642}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=1.960264 cos_to_last_merge=0.8561 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.856
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.7953435409928551, 'auprc': 0.929479627315217, 'loss_val': 0.5116954156438478, 'psi': 0.8489979755217999}-{'f1_val': 0.8316763215067641, 'auprc': 0.9975185042506184, 'loss_val': 0.41595725552840024, 'psi': 0.8980131946043058}
[S16] START round=97 head_norm_before_train=2.305512 (no previous merge yet)
[S16] round=97 local utility u=0.010470 metrics={'f1_val': 0.9825537859423075, 'auprc': 0.9825404797971615, 'loss_val': 0.07095319555011394, 'psi': 0.9825484634842491}-{'f1_val': 0.9834127743131381, 'auprc': 0.9832072371161601, 'loss_val': 0.09904710111074998, 'psi': 0.9833305594343469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=97 head_norm_before_train=2.034197 cos_to_last_merge=0.7706 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=97 local utility u=0.094412 metrics={'f1_val': 0.8332502961043836, 'auprc': 0.9494231587335613, 'loss_val': 0.5284387011679637, 'psi': 0.8797194411560547}-{'f1_val': 0.8225258632792682, 'auprc': 0.940383631866332, 'loss_val': 0.6257965618453538, 'psi': 0.8696689707140938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=97 metric=0.9967 head_norm=2.351954
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.021859e-03
[S9] stored merged vector for next round verification (round=97)
[S9] DEBUG after merge:  round=97 metric=0.9967 head_norm=2.348788 delta_norm=0.008022
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=-0.1033
[S15] DROPPED delta from S7 (cos=-0.1033 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=97 metric=0.9374 head_norm=2.220845
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.625916e-02
[S4] stored merged vector for next round verification (round=97)
[S4] DEBUG after merge:  round=97 metric=0.9374 head_norm=2.223717 delta_norm=0.016259
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=97 metric=0.6672 head_norm=2.226705
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.423031e-02
[S2] stored merged vector for next round verification (round=97)
[S2] DEBUG after merge:  round=97 metric=0.6672 head_norm=2.222979 delta_norm=0.014230
[S2] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=97 metric=0.7588 head_norm=2.161096
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.782110e-02
[S6] stored merged vector for next round verification (round=97)
[S6] DEBUG after merge:  round=97 metric=0.7618 head_norm=2.150923 delta_norm=0.017821
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.222979 cos_to_last_merge=1.0000 (last merge round=97)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.6615256646741519, 'auprc': 0.6862536745190899, 'loss_val': 1.180451815575619, 'psi': 0.6714168686121271}-{'f1_val': 0.6671803738984726, 'auprc': 0.6974185305642638, 'loss_val': 1.1188203769997387, 'psi': 0.6792756365647892}
[S3] START round=98 head_norm_before_train=2.316078 cos_to_last_merge=0.9985 (last merge round=66)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9415026905099723, 'auprc': 0.9834706418938863, 'loss_val': 0.22130646028629528, 'psi': 0.9582898710635379}-{'f1_val': 0.9521425531068083, 'auprc': 0.9904579918665267, 'loss_val': 0.13856554012108277, 'psi': 0.9674687286106957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.223717 cos_to_last_merge=1.0000 (last merge round=97)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9410542419615919, 'auprc': 0.9490350891136128, 'loss_val': 0.33904266775153996, 'psi': 0.9442465808224003}-{'f1_val': 0.937414079883967, 'auprc': 0.9550628068075584, 'loss_val': 0.33357974244205146, 'psi': 0.9444735706534035}
[S5] START round=98 head_norm_before_train=2.342235 cos_to_last_merge=0.9999 (last merge round=95)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9951071315297692, 'loss_val': 0.019233360669834408, 'psi': 0.9960640336989823}-{'f1_val': 0.9967019684784577, 'auprc': 0.9957061341636427, 'loss_val': 0.019320848325622506, 'psi': 0.9963036347525317}
[S6] START round=98 head_norm_before_train=2.150923 cos_to_last_merge=1.0000 (last merge round=97)
[S6] round=98 local utility u=0.353907 metrics={'f1_val': 0.8281957744310661, 'auprc': 0.9282698902504608, 'loss_val': 0.4170927330508482, 'psi': 0.868225420758824}-{'f1_val': 0.7587755794439749, 'auprc': 0.9181098238284287, 'loss_val': 0.6779058347435343, 'psi': 0.8225092771977565}
[S7] START round=98 head_norm_before_train=2.427148 cos_to_last_merge=0.9049 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6489019369205961, 'auprc': 0.7506464217789863, 'loss_val': 1.7556056625332606, 'psi': 0.6895997308639522}-{'f1_val': 0.8292394950934988, 'auprc': 0.9070313774182316, 'loss_val': 0.6944225136520463, 'psi': 0.860356248023392}
[S8] START round=98 head_norm_before_train=2.144683 cos_to_last_merge=1.0000 (last merge round=95)
[S8] round=98 local utility u=0.012754 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9987187840297058, 'loss_val': 0.03701755729835427, 'psi': 0.9947712464147342}-{'f1_val': 0.9939497221170495, 'auprc': 0.9880091508747418, 'loss_val': 0.04125700802630922, 'psi': 0.9915734936201264}
[S9] START round=98 head_norm_before_train=2.348788 cos_to_last_merge=1.0000 (last merge round=97)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.994988868793922, 'auprc': 0.9980443714431385, 'loss_val': 0.020053427542180802, 'psi': 0.9962110698536086}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985783999266823, 'loss_val': 0.017587717666929025, 'psi': 0.9974276670590078}
[S10] START round=98 head_norm_before_train=2.312962 cos_to_last_merge=0.9569 (last merge round=24)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972283623319171, 'loss_val': 0.024676078161394183, 'psi': 0.9960852172710051}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972644230978371, 'loss_val': 0.024644967284237398, 'psi': 0.9960996415773731}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.103508 cos_to_last_merge=0.8019 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=98 local utility u=0.000040 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985272218905143, 'loss_val': 0.019578097930032116, 'psi': 0.997351371139934}-{'f1_val': 0.996567470639547, 'auprc': 0.998507028293247, 'loss_val': 0.019597022179882677, 'psi': 0.997343293701027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=98 head_norm_before_train=1.983102 (no previous merge yet)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.5916042624559584, 'auprc': 0.6475366611716249, 'loss_val': 1.46103127256094, 'psi': 0.613977221942225}-{'f1_val': 0.731653750239318, 'auprc': 0.7879110799944085, 'loss_val': 1.1687881501179818, 'psi': 0.7541566821413541}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.198667 cos_to_last_merge=0.9917 (last merge round=56)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9304272073308006, 'auprc': 0.998850160024405, 'loss_val': 0.23606010558366264, 'psi': 0.9577963884082423}-{'f1_val': 0.9312051384796475, 'auprc': 0.998353092720012, 'loss_val': 0.18102404147013695, 'psi': 0.9580643201757933}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=1.965236 cos_to_last_merge=0.8556 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.856
[S15] round=98 local utility u=0.362682 metrics={'f1_val': 0.887086491447675, 'auprc': 0.9381717485957375, 'loss_val': 0.3628650591215044, 'psi': 0.9075205943069}-{'f1_val': 0.7953435409928551, 'auprc': 0.929479627315217, 'loss_val': 0.5116954156438478, 'psi': 0.8489979755217999}
[S16] START round=98 head_norm_before_train=2.305988 (no previous merge yet)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.858260495655857, 'auprc': 0.9673503586018513, 'loss_val': 1.1880833605237444, 'psi': 0.9018964408342547}-{'f1_val': 0.9825537859423075, 'auprc': 0.9825404797971615, 'loss_val': 0.07095319555011394, 'psi': 0.9825484634842491}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.039551 cos_to_last_merge=0.7702 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=98 local utility u=0.156797 metrics={'f1_val': 0.8581249855565163, 'auprc': 0.9711921710766558, 'loss_val': 0.429400692942859, 'psi': 0.9033518597645721}-{'f1_val': 0.8332502961043836, 'auprc': 0.9494231587335613, 'loss_val': 0.5284387011679637, 'psi': 0.8797194411560547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=98 metric=0.9950 head_norm=2.351561
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.749378e-02
[S9] stored merged vector for next round verification (round=98)
[S9] DEBUG after merge:  round=98 metric=0.9950 head_norm=2.346837 delta_norm=0.017494
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1034
[S7] DROPPED delta from S15 (cos=-0.1034 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9999
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=98 metric=0.9921 head_norm=2.150931
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.512174e-02
[S8] stored merged vector for next round verification (round=98)
[S8] DEBUG after merge:  round=98 metric=0.9921 head_norm=2.155674 delta_norm=0.015122
[S8] aggregate: ACCEPT kept=['S6', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=98 metric=0.8282 head_norm=2.159953
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.390253e-02
[S6] stored merged vector for next round verification (round=98)
[S6] DEBUG after merge:  round=98 metric=0.8282 head_norm=2.155402 delta_norm=0.013903
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=2.227573 cos_to_last_merge=1.0000 (last merge round=97)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.6198071600159262, 'auprc': 0.6915094191629111, 'loss_val': 1.4366755731189675, 'psi': 0.6484880636747201}-{'f1_val': 0.6615256646741519, 'auprc': 0.6862536745190899, 'loss_val': 1.180451815575619, 'psi': 0.6714168686121271}
[S3] START round=99 head_norm_before_train=2.318171 cos_to_last_merge=0.9984 (last merge round=66)
[S3] round=99 local utility u=0.112012 metrics={'f1_val': 0.9583285637767921, 'auprc': 0.995876013106276, 'loss_val': 0.1354538140142616, 'psi': 0.9733475435085857}-{'f1_val': 0.9415026905099723, 'auprc': 0.9834706418938863, 'loss_val': 0.22130646028629528, 'psi': 0.9582898710635379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=100 psi=0.973 u=0.1120 p_local=0.0803 f1=0.958 auprc=0.996 bytes=93454
[S4] START round=99 head_norm_before_train=2.223809 cos_to_last_merge=1.0000 (last merge round=97)
[S4] round=99 local utility u=0.011661 metrics={'f1_val': 0.9430419306994684, 'auprc': 0.9508148430952658, 'loss_val': 0.33298634561736806, 'psi': 0.9461510956577874}-{'f1_val': 0.9410542419615919, 'auprc': 0.9490350891136128, 'loss_val': 0.33904266775153996, 'psi': 0.9442465808224003}
[S5] START round=99 head_norm_before_train=2.342333 cos_to_last_merge=0.9998 (last merge round=95)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940038396251033, 'loss_val': 0.019368952862100167, 'psi': 0.9956227169371159}-{'f1_val': 0.9967019684784577, 'auprc': 0.9951071315297692, 'loss_val': 0.019233360669834408, 'psi': 0.9960640336989823}
[S6] START round=99 head_norm_before_train=2.155402 cos_to_last_merge=1.0000 (last merge round=98)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.7652764552006716, 'auprc': 0.9131731061295973, 'loss_val': 0.6630625597340241, 'psi': 0.8244351155722418}-{'f1_val': 0.8281957744310661, 'auprc': 0.9282698902504608, 'loss_val': 0.4170927330508482, 'psi': 0.868225420758824}
[S7] START round=99 head_norm_before_train=2.434764 cos_to_last_merge=0.9043 (last merge round=13)
[S7] ⚠️ Model drifted since last merge! cos=0.904
[S7] round=99 local utility u=0.150117 metrics={'f1_val': 0.6579108229331989, 'auprc': 0.7859400134312141, 'loss_val': 1.615306725580797, 'psi': 0.709122499132405}-{'f1_val': 0.6489019369205961, 'auprc': 0.7506464217789863, 'loss_val': 1.7556056625332606, 'psi': 0.6895997308639522}
[S8] START round=99 head_norm_before_train=2.155674 cos_to_last_merge=1.0000 (last merge round=98)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9937751589505717, 'auprc': 0.9886993274582274, 'loss_val': 0.030803132322025417, 'psi': 0.9917448263536339}-{'f1_val': 0.9921395546714198, 'auprc': 0.9987187840297058, 'loss_val': 0.03701755729835427, 'psi': 0.9947712464147342}
[S9] START round=99 head_norm_before_train=2.346837 cos_to_last_merge=1.0000 (last merge round=98)
[S9] round=99 local utility u=0.007085 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986473993115343, 'loss_val': 0.017722728125390375, 'psi': 0.9974552668129486}-{'f1_val': 0.994988868793922, 'auprc': 0.9980443714431385, 'loss_val': 0.020053427542180802, 'psi': 0.9962110698536086}
[S10] START round=99 head_norm_before_train=2.318358 cos_to_last_merge=0.9569 (last merge round=24)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971308887876007, 'loss_val': 0.024750469621003544, 'psi': 0.9960462278532785}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972283623319171, 'loss_val': 0.024676078161394183, 'psi': 0.9960852172710051}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.997 bytes=111461
[S11] START round=99 head_norm_before_train=2.104857 cos_to_last_merge=0.8013 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.801
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9920075461789907, 'auprc': 0.998573050285176, 'loss_val': 0.029005541583420856, 'psi': 0.9946337478214649}-{'f1_val': 0.996567470639547, 'auprc': 0.9985272218905143, 'loss_val': 0.019578097930032116, 'psi': 0.997351371139934}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.995 u=0.0000 p_local=0.0061 f1=0.992 auprc=0.999 bytes=111481
[S13] START round=99 head_norm_before_train=1.986396 (no previous merge yet)
[S13] round=99 local utility u=0.858895 metrics={'f1_val': 0.742830606964601, 'auprc': 0.8202673504660418, 'loss_val': 1.1687913599836535, 'psi': 0.7738053043651774}-{'f1_val': 0.5916042624559584, 'auprc': 0.6475366611716249, 'loss_val': 1.46103127256094, 'psi': 0.613977221942225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=100 psi=0.774 u=0.8589 p_local=0.2933 f1=0.743 auprc=0.820 bytes=95359
[S14] START round=99 head_norm_before_train=2.202211 cos_to_last_merge=0.9917 (last merge round=56)
[S14] round=99 local utility u=0.307259 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9979696515065476, 'loss_val': 0.018581381965595115, 'psi': 0.9974123319454189}-{'f1_val': 0.9304272073308006, 'auprc': 0.998850160024405, 'loss_val': 0.23606010558366264, 'psi': 0.9577963884082423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=100 psi=0.997 u=0.3073 p_local=0.0889 f1=0.997 auprc=0.998 bytes=102631
[S15] START round=99 head_norm_before_train=1.969842 cos_to_last_merge=0.8552 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.855
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.8742631641407321, 'auprc': 0.9261227750230081, 'loss_val': 0.3840889017193349, 'psi': 0.8950070084936426}-{'f1_val': 0.887086491447675, 'auprc': 0.9381717485957375, 'loss_val': 0.3628650591215044, 'psi': 0.9075205943069}
[S16] START round=99 head_norm_before_train=2.310020 (no previous merge yet)
[S16] round=99 local utility u=0.953265 metrics={'f1_val': 0.9825450605400435, 'auprc': 0.9860864519505803, 'loss_val': 0.08346991153218569, 'psi': 0.9839616171042582}-{'f1_val': 0.858260495655857, 'auprc': 0.9673503586018513, 'loss_val': 1.1880833605237444, 'psi': 0.9018964408342547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=100 psi=0.984 u=0.9533 p_local=0.2255 f1=0.983 auprc=0.986 bytes=102525
[S17] START round=99 head_norm_before_train=2.046154 cos_to_last_merge=0.7696 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8532431683396186, 'auprc': 0.9750937072084966, 'loss_val': 0.5482497081554178, 'psi': 0.9019833838871698}-{'f1_val': 0.8581249855565163, 'auprc': 0.9711921710766558, 'loss_val': 0.429400692942859, 'psi': 0.9033518597645721}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.902 u=0.0000 p_local=0.1094 f1=0.853 auprc=0.975 bytes=88111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] r=100 psi=0.996 u=0.0000 p_local=0.0012 f1=0.997 auprc=0.994 bytes=107865
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] r=100 psi=0.992 u=0.0000 p_local=0.0223 f1=0.994 auprc=0.989 bytes=102600
[S2] r=100 psi=0.648 u=0.0000 p_local=0.0725 f1=0.620 auprc=0.692 bytes=79037
[S6] r=100 psi=0.824 u=0.0000 p_local=0.1694 f1=0.765 auprc=0.913 bytes=93594
[S15] r=100 psi=0.895 u=0.0000 p_local=0.1120 f1=0.874 auprc=0.926 bytes=100700
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=-0.1037
[S15] DROPPED delta from S7 (cos=-0.1037 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.9999
[S4] r=100 psi=0.946 u=0.0117 p_local=0.0154 f1=0.943 auprc=0.951 bytes=107910
[S9] r=100 psi=0.997 u=0.0071 p_local=0.0018 f1=0.997 auprc=0.999 bytes=102492
[S7] r=100 psi=0.709 u=0.1501 p_local=0.1909 f1=0.658 auprc=0.786 bytes=93567
[runner] rounds complete.
[runner] all agents stopped.
