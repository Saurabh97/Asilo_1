[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38503
[S3] → join 127.0.0.1:38502
[S4] → join 127.0.0.1:38502
[S5] → join 127.0.0.1:38502
[S6] → join 127.0.0.1:38502
[S7] → join 127.0.0.1:38502
[S8] → join 127.0.0.1:38502
[S9] → join 127.0.0.1:38502
[S10] → join 127.0.0.1:38502
[S11] → join 127.0.0.1:38502
[S13] → join 127.0.0.1:38502
[S14] → join 127.0.0.1:38502
[S15] → join 127.0.0.1:38502
[S16] → join 127.0.0.1:38502
[S17] → join 127.0.0.1:38502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.208206 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.177052 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.167097 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.157647 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.199474 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.196703 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.196428 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.140501 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.111376 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.136464 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.217651 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.186584 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.183522 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.129320 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.175019 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S16
[S4] + discovered S2
[S4] + discovered S3
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S16
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S15
[S5] + discovered S2
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S8
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S7
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S9
[S6] + discovered S17
[S7] + discovered S2
[S6] + discovered S9
[S7] + discovered S6
[S6] + discovered S10
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S11
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S11
[S8] + discovered S6
[S8] + discovered S4
[S8] + discovered S5
[S7] + discovered S17
[S7] + discovered S8
[S8] + discovered S3
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S14
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S9
[S9] + discovered S4
[S9] + discovered S5
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S11
[S9] + discovered S8
[S9] + discovered S3
[S8] + discovered S10
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S13
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S4
[S9] + discovered S10
[S10] + discovered S2
[S9] + discovered S14
[S10] + discovered S7
[S9] + discovered S13
[S10] + discovered S3
[S9] + discovered S17
[S10] + discovered S8
[S9] + discovered S15
[S10] + discovered S5
[S9] + discovered S16
[S9] + discovered S11
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S8
[S10] + discovered S11
[S11] + discovered S3
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S2
[S11] + discovered S6
[S10] + discovered S15
[S11] + discovered S5
[S11] + discovered S9
[S13] + discovered S4
[S13] + discovered S10
[S13] + discovered S9
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S7
[S11] + discovered S16
[S13] + discovered S5
[S14] + discovered S7
[S14] + discovered S6
[S14] + discovered S5
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S8
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S9
[S15] + discovered S5
[S15] + discovered S13
[S14] + discovered S16
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S7
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S9
[S14] + discovered S15
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S3
[S14] + discovered S17
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S5
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S7
[S17] + discovered S11
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S5
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:38508
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:38516
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:38513
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:38511
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] START round=1 head_norm_before_train=1.212503 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6539906501753459, 'loss_val': 1.330244575952938, 'psi': 0.3466625401032784}-{'f1_val': 0.31774524587417274, 'auprc': 0.6328210395191474, 'loss_val': 1.3730639048009505, 'psi': 0.4437755633321626}
[S3] START round=1 head_norm_before_train=1.186227 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7431748620611459, 'loss_val': 1.2639849714277613, 'psi': 0.3811739841929226}-{'f1_val': 0.1713504912135049, 'auprc': 0.8192273672912218, 'loss_val': 1.335231270054088, 'psi': 0.4305012416445917}
[S4] START round=1 head_norm_before_train=1.163302 (no previous merge yet)
[S4] round=1 local utility u=0.090719 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7702964650314255, 'loss_val': 1.3229062879046705, 'psi': 0.3922545633496807}-{'f1_val': 0.14022662889518414, 'auprc': 0.7212731359198818, 'loss_val': 1.3572748692525058, 'psi': 0.37264523170506325}
[S5] START round=1 head_norm_before_train=1.165486 (no previous merge yet)
[S5] round=1 local utility u=0.122777 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7716862452390446, 'loss_val': 1.2759116612230799, 'psi': 0.3940316409527607}-{'f1_val': 0.14226190476190476, 'auprc': 0.7080968222813514, 'loss_val': 1.3306964779365427, 'psi': 0.36859587176968345}
[S6] START round=1 head_norm_before_train=1.206786 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8530888522426667, 'loss_val': 1.3081337525866155, 'psi': 0.4260913101278359}-{'f1_val': 0.14142628205128205, 'auprc': 0.8900547187150473, 'loss_val': 1.3310286119326442, 'psi': 0.44087765671678814}
[S7] START round=1 head_norm_before_train=1.208243 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7831571618323153, 'loss_val': 1.2819515573740234, 'psi': 0.3984969583703811}-{'f1_val': 0.14205682272909165, 'auprc': 0.8038428873507126, 'loss_val': 1.3282104567039423, 'psi': 0.40677124857774005}
[S8] START round=1 head_norm_before_train=1.190313 (no previous merge yet)
[S8] round=1 local utility u=0.118408 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7102400497477103, 'loss_val': 1.3442794030470748, 'psi': 0.36806960933485844}-{'f1_val': 0.13995598239295717, 'auprc': 0.6422484543369074, 'loss_val': 1.377121438123016, 'psi': 0.3408729711705373}
[S9] START round=1 head_norm_before_train=1.148423 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9117843455461162, 'loss_val': 1.2281210348818048, 'psi': 0.4495525125024441}-{'f1_val': 0.141397957139996, 'auprc': 0.9725327502618031, 'loss_val': 1.3135337153074835, 'psi': 0.47385187438871884}
[S10] START round=1 head_norm_before_train=1.119262 (no previous merge yet)
[S10] round=1 local utility u=0.272102 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6049197828487819, 'loss_val': 1.3148375841600508, 'psi': 0.3251408956645471}-{'f1_val': 0.13862163754172394, 'auprc': 0.4328578347042585, 'loss_val': 1.3428551027866977, 'psi': 0.2563161164067378}
[S11] START round=1 head_norm_before_train=1.141345 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8792058452374714, 'loss_val': 1.3094605480951569, 'psi': 0.4359305481188549}-{'f1_val': 0.14041368337311058, 'auprc': 0.9889666865879265, 'loss_val': 1.3420360344332687, 'psi': 0.47983488465903695}
[S13] START round=1 head_norm_before_train=1.222073 (no previous merge yet)
[S13] round=1 local utility u=0.553922 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.620182973633945, 'loss_val': 1.3326278979940904, 'psi': 0.3323046469998099}-{'f1_val': 0.1403857625770531, 'auprc': 0.26306181568590664, 'loss_val': 1.3691086197569533, 'psi': 0.18945618382059454}
[S14] START round=1 head_norm_before_train=1.189004 (no previous merge yet)
[S14] round=1 local utility u=0.129068 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.48126030860348906, 'loss_val': 1.357032704875495, 'psi': 0.2767188351710179}-{'f1_val': 0.1035101204201896, 'auprc': 0.47733906816236205, 'loss_val': 1.3823185796329909, 'psi': 0.25304169951705857}
[S15] START round=1 head_norm_before_train=1.190279 (no previous merge yet)
[S15] round=1 local utility u=0.014003 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7829127790378699, 'loss_val': 1.3291296819262484, 'psi': 0.397005302432083}-{'f1_val': 0.13973365136155833, 'auprc': 0.7831014568536081, 'loss_val': 1.3577018693563068, 'psi': 0.3970807735583783}
[S16] START round=1 head_norm_before_train=1.131634 (no previous merge yet)
[S16] round=1 local utility u=0.399782 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6904460400274306, 'loss_val': 1.3271234223004422, 'psi': 0.3605608861304942}-{'f1_val': 0.14063745019920318, 'auprc': 0.4316219722742354, 'loss_val': 1.3502161537168906, 'psi': 0.2570312590292161}
[S17] START round=1 head_norm_before_train=1.183144 (no previous merge yet)
[S17] round=1 local utility u=0.039154 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7536001347470916, 'loss_val': 1.3307295407338922, 'psi': 0.3860094318892673}-{'f1_val': 0.14094896331738438, 'auprc': 0.7365384497449887, 'loss_val': 1.357852835155396, 'psi': 0.37918475788842615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1781 reason=None
[S8] → sending delta(kind=head bytes=1781) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:38502
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38516
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S17@127.0.0.1:38517
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38509
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:38507
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1781 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=-0.0373
[S16] DROPPED delta from S13 (cos=-0.0373 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S10
[S2] cosine check vs S10: cos=-0.0141
[S2] DROPPED delta from S10 (cos=-0.0141 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S5
[S7] cosine check vs S5: cos=-0.1254
[S7] DROPPED delta from S5 (cos=-0.1254 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S14
[S6] cosine check vs S14: cos=-0.0164
[S6] DROPPED delta from S14 (cos=-0.0164 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1781) from S8
[S14] cosine check vs S8: cos=0.0041
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.0847
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.0091
[S17] RECEIVED delta(kind=head bytes=1785) from S16
[S17] cosine check vs S16: cos=-0.0722
[S17] DROPPED delta from S16 (cos=-0.0722 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:38505
[S17] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S17
[S5] cosine check vs S17: cos=0.0873
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.197551
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.100448e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.884142 delta_norm=0.810045
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.201249
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.455082e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1471 head_norm=0.848996 delta_norm=0.845508
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.195139
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.450164e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.852722 delta_norm=0.845016
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.143460
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.835474e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.852977 delta_norm=0.783547
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.228828 (no previous merge yet)
[S2] round=2 local utility u=0.138484 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7295110395526424, 'loss_val': 1.2798367654300231, 'psi': 0.376870695854197}-{'f1_val': 0.1417771333885667, 'auprc': 0.6539906501753459, 'loss_val': 1.330244575952938, 'psi': 0.3466625401032784}
[S3] START round=2 head_norm_before_train=1.222773 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6142050153273886, 'loss_val': 1.1748514432618955, 'psi': 0.32958604549941967}-{'f1_val': 0.13984006561410703, 'auprc': 0.7431748620611459, 'loss_val': 1.2639849714277613, 'psi': 0.3811739841929226}
[S4] START round=2 head_norm_before_train=1.172830 (no previous merge yet)
[S4] round=2 local utility u=0.035944 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7807644635272424, 'loss_val': 1.282423239678486, 'psi': 0.39644176274800746}-{'f1_val': 0.14022662889518414, 'auprc': 0.7702964650314255, 'loss_val': 1.3229062879046705, 'psi': 0.3922545633496807}
[S5] START round=2 head_norm_before_train=0.884142 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7450846030484805, 'loss_val': 1.2390621673015998, 'psi': 0.38339098407653505}-{'f1_val': 0.14226190476190476, 'auprc': 0.7716862452390446, 'loss_val': 1.2759116612230799, 'psi': 0.3940316409527607}
[S6] START round=2 head_norm_before_train=1.222006 (no previous merge yet)
[S6] round=2 local utility u=0.013764 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8539890735222477, 'loss_val': 1.2833068576268594, 'psi': 0.4264513986396683}-{'f1_val': 0.14142628205128205, 'auprc': 0.8530888522426667, 'loss_val': 1.3081337525866155, 'psi': 0.4260913101278359}
[S7] START round=2 head_norm_before_train=1.241201 (no previous merge yet)
[S7] round=2 local utility u=0.031483 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7915545751193641, 'loss_val': 1.2441769142090306, 'psi': 0.4018559236852007}-{'f1_val': 0.14205682272909165, 'auprc': 0.7831571618323153, 'loss_val': 1.2819515573740234, 'psi': 0.3984969583703811}
[S8] START round=2 head_norm_before_train=0.852722 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6821799696621741, 'loss_val': 1.3302757158142846, 'psi': 0.356845577300644}-{'f1_val': 0.13995598239295717, 'auprc': 0.7102400497477103, 'loss_val': 1.3442794030470748, 'psi': 0.36806960933485844}
[S9] START round=2 head_norm_before_train=1.188674 (no previous merge yet)
[S9] round=2 local utility u=0.022153 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8841212684499884, 'loss_val': 1.100825649815074, 'psi': 0.438487281663993}-{'f1_val': 0.141397957139996, 'auprc': 0.9117843455461162, 'loss_val': 1.2281210348818048, 'psi': 0.4495525125024441}
[S10] START round=2 head_norm_before_train=1.134109 (no previous merge yet)
[S10] round=2 local utility u=0.112793 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6685852989545044, 'loss_val': 1.280247175635876, 'psi': 0.3506071021068361}-{'f1_val': 0.13862163754172394, 'auprc': 0.6049197828487819, 'loss_val': 1.3148375841600508, 'psi': 0.3251408956645471}
[S11] START round=2 head_norm_before_train=1.156790 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7867522174015453, 'loss_val': 1.2726586064249963, 'psi': 0.3989490969844845}-{'f1_val': 0.14041368337311058, 'auprc': 0.8792058452374714, 'loss_val': 1.3094605480951569, 'psi': 0.4359305481188549}
[S13] START round=2 head_norm_before_train=1.234162 (no previous merge yet)
[S13] round=2 local utility u=0.126484 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6928344337440988, 'loss_val': 1.2976138222282236, 'psi': 0.36136523104387136}-{'f1_val': 0.1403857625770531, 'auprc': 0.620182973633945, 'loss_val': 1.3326278979940904, 'psi': 0.3323046469998099}
[S14] START round=2 head_norm_before_train=0.848996 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.419804890555875, 'loss_val': 1.3478340341314343, 'psi': 0.25213666795197226}-{'f1_val': 0.14035785288270378, 'auprc': 0.48126030860348906, 'loss_val': 1.357032704875495, 'psi': 0.2767188351710179}
[S15] START round=2 head_norm_before_train=1.205827 (no previous merge yet)
[S15] round=2 local utility u=0.015813 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7827876396837942, 'loss_val': 1.2971273512373354, 'psi': 0.3969552466904527}-{'f1_val': 0.13973365136155833, 'auprc': 0.7829127790378699, 'loss_val': 1.3291296819262484, 'psi': 0.397005302432083}
[S16] START round=2 head_norm_before_train=0.852977 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.235761 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.846807446965262, 'loss_val': 1.3246852317583087, 'psi': 0.42310544890562674}-{'f1_val': 0.14063745019920318, 'auprc': 0.6904460400274306, 'loss_val': 1.3271234223004422, 'psi': 0.3605608861304942}
[S17] START round=2 head_norm_before_train=1.200679 (no previous merge yet)
[S17] round=2 local utility u=0.089797 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8007072858275535, 'loss_val': 1.2924579813419246, 'psi': 0.40485229232145203}-{'f1_val': 0.14094896331738438, 'auprc': 0.7536001347470916, 'loss_val': 1.3307295407338922, 'psi': 0.3860094318892673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:38515
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:38502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:38502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:38517
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:38517
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:38504
[S4] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S6
[S16] cosine check vs S6: cos=0.0429
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=-0.0836
[S17] DROPPED delta from S2 (cos=-0.0836 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0439
[S8] DROPPED delta from S7 (cos=-0.0439 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S16
[S9] cosine check vs S16: cos=-0.0557
[S9] DROPPED delta from S16 (cos=-0.0557 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S15
[S2] cosine check vs S15: cos=0.0143
[S2] RECEIVED delta(kind=head bytes=1796) from S9
[S2] cosine check vs S9: cos=-0.1120
[S2] DROPPED delta from S9 (cos=-0.1120 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] cosine check vs S10: cos=0.0401
[S17] RECEIVED delta(kind=head bytes=1790) from S4
[S17] cosine check vs S4: cos=-0.0351
[S17] DROPPED delta from S4 (cos=-0.0351 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S13
[S15] cosine check vs S13: cos=0.1420
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38511
[S17] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0563
[S10] DROPPED delta from S17 (cos=-0.0563 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.231063
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.125190e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.937426 delta_norm=0.812519
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=0.869795
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.438887e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.774490 delta_norm=0.743889
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.251915
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.716030e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.884144 delta_norm=0.871603
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.193676
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.146074e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.2328 head_norm=0.847978 delta_norm=0.814607
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.884144 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.072351 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7727037632730401, 'loss_val': 1.2647138218863383, 'psi': 0.3941477853423561}-{'f1_val': 0.1417771333885667, 'auprc': 0.7295110395526424, 'loss_val': 1.2798367654300231, 'psi': 0.376870695854197}
[S3] START round=3 head_norm_before_train=1.269942 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.795685256090685, 'loss_val': 1.0062860569661853, 'psi': 0.5560520879427462}-{'f1_val': 0.13984006561410703, 'auprc': 0.6142050153273886, 'loss_val': 1.1748514432618955, 'psi': 0.32958604549941967}
[S4] START round=3 head_norm_before_train=0.847978 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.511850 metrics={'f1_val': 0.31025661659920684, 'auprc': 0.7795050017046988, 'loss_val': 1.2751250979444886, 'psi': 0.4979559706414037}-{'f1_val': 0.14022662889518414, 'auprc': 0.7807644635272424, 'loss_val': 1.282423239678486, 'psi': 0.39644176274800746}
[S5] START round=3 head_norm_before_train=0.932268 cos_to_last_merge=0.9931 (last merge round=1)
[S5] round=3 local utility u=0.100929 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7777898189180231, 'loss_val': 1.1353190492682594, 'psi': 0.39647307042435215}-{'f1_val': 0.14226190476190476, 'auprc': 0.7450846030484805, 'loss_val': 1.2390621673015998, 'psi': 0.38339098407653505}
[S6] START round=3 head_norm_before_train=1.244936 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8443024381571317, 'loss_val': 1.2549774174399193, 'psi': 0.4225767444936219}-{'f1_val': 0.14142628205128205, 'auprc': 0.8539890735222477, 'loss_val': 1.2833068576268594, 'psi': 0.4264513986396683}
[S7] START round=3 head_norm_before_train=1.278643 (no previous merge yet)
[S7] round=3 local utility u=0.030740 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947446179953539, 'loss_val': 1.1922662155036898, 'psi': 0.40313194083559656}-{'f1_val': 0.14205682272909165, 'auprc': 0.7915545751193641, 'loss_val': 1.2441769142090306, 'psi': 0.4018559236852007}
[S8] START round=3 head_norm_before_train=0.874328 cos_to_last_merge=0.9971 (last merge round=1)
[S8] round=3 local utility u=0.017057 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.682256361037562, 'loss_val': 1.2963907849029108, 'psi': 0.35687613385079914}-{'f1_val': 0.13995598239295717, 'auprc': 0.6821799696621741, 'loss_val': 1.3302757158142846, 'psi': 0.356845577300644}
[S9] START round=3 head_norm_before_train=1.243314 (no previous merge yet)
[S9] round=3 local utility u=0.925968 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.8631259656175916, 'loss_val': 0.8381613988421951, 'psi': 0.5953148666890412}-{'f1_val': 0.141397957139996, 'auprc': 0.8841212684499884, 'loss_val': 1.100825649815074, 'psi': 0.438487281663993}
[S10] START round=3 head_norm_before_train=1.157774 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6359086316902336, 'loss_val': 1.248675889606227, 'psi': 0.3375364352011278}-{'f1_val': 0.13862163754172394, 'auprc': 0.6685852989545044, 'loss_val': 1.280247175635876, 'psi': 0.3506071021068361}
[S11] START round=3 head_norm_before_train=1.181961 (no previous merge yet)
[S11] round=3 local utility u=0.018000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7839135069536332, 'loss_val': 1.228141722311297, 'psi': 0.3978136128053196}-{'f1_val': 0.14041368337311058, 'auprc': 0.7867522174015453, 'loss_val': 1.2726586064249963, 'psi': 0.3989490969844845}
[S13] START round=3 head_norm_before_train=1.249957 (no previous merge yet)
[S13] round=3 local utility u=0.043258 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7109944059883274, 'loss_val': 1.2655772534727476, 'psi': 0.36862921994156284}-{'f1_val': 0.1403857625770531, 'auprc': 0.6928344337440988, 'loss_val': 1.2976138222282236, 'psi': 0.36136523104387136}
[S14] START round=3 head_norm_before_train=0.870390 cos_to_last_merge=0.9973 (last merge round=1)
[S14] round=3 local utility u=0.020326 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.42547107276804375, 'loss_val': 1.3241804594042124, 'psi': 0.2544031408368398}-{'f1_val': 0.14035785288270378, 'auprc': 0.419804890555875, 'loss_val': 1.3478340341314343, 'psi': 0.25213666795197226}
[S15] START round=3 head_norm_before_train=0.937426 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.6150471415097505, 'loss_val': 1.3067038515246745, 'psi': 0.3298590474208352}-{'f1_val': 0.13973365136155833, 'auprc': 0.7827876396837942, 'loss_val': 1.2971273512373354, 'psi': 0.3969552466904527}
[S16] START round=3 head_norm_before_train=0.774490 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.136408 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9358111646784573, 'loss_val': 1.3188799659128632, 'psi': 0.45870693599090484}-{'f1_val': 0.14063745019920318, 'auprc': 0.846807446965262, 'loss_val': 1.3246852317583087, 'psi': 0.42310544890562674}
[S17] START round=3 head_norm_before_train=1.228864 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7302221657105248, 'loss_val': 1.2288557777428977, 'psi': 0.37665824427464056}-{'f1_val': 0.14094896331738438, 'auprc': 0.8007072858275535, 'loss_val': 1.2924579813419246, 'psi': 0.40485229232145203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.0128
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=-0.0844
[S5] DROPPED delta from S3 (cos=-0.0844 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] cosine check vs S14: cos=-0.0926
[S5] DROPPED delta from S14 (cos=-0.0926 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S2
[S5] cosine check vs S2: cos=-0.0309
[S5] DROPPED delta from S2 (cos=-0.0309 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0357
[S11] DROPPED delta from S4 (cos=-0.0357 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.0471
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.0520
[S16] DROPPED delta from S5 (cos=-0.0520 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1785) from S16
[S6] cosine check vs S16: cos=0.8096
[S7] RECEIVED delta(kind=head bytes=1793) from S8
[S7] cosine check vs S8: cos=-0.0266
[S7] DROPPED delta from S8 (cos=-0.0266 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=-0.0200
[S9] DROPPED delta from S13 (cos=-0.0200 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1807) from S9
[S14] cosine check vs S9: cos=-0.0382
[S14] DROPPED delta from S9 (cos=-0.0382 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.274531
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.928810e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.985474 delta_norm=0.392881
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4168 head_norm=1.325246
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.759691e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4168 head_norm=0.918046 delta_norm=0.875969
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.900272
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.906728e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.800186 delta_norm=0.790673
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.911577 cos_to_last_merge=0.9969 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.612557234020946, 'loss_val': 1.2107933441869305, 'psi': 0.3300891736415184}-{'f1_val': 0.1417771333885667, 'auprc': 0.7727037632730401, 'loss_val': 1.2647138218863383, 'psi': 0.3941477853423561}
[S3] START round=4 head_norm_before_train=1.321195 (no previous merge yet)
[S3] round=4 local utility u=0.495743 metrics={'f1_val': 0.45747987562169706, 'auprc': 0.9151705281126797, 'loss_val': 0.7403558524767653, 'psi': 0.6405561366180902}-{'f1_val': 0.39629664251078706, 'auprc': 0.795685256090685, 'loss_val': 1.0062860569661853, 'psi': 0.5560520879427462}
[S4] START round=4 head_norm_before_train=0.873052 cos_to_last_merge=0.9970 (last merge round=2)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.29370224073889134, 'auprc': 0.7807540146491596, 'loss_val': 1.1945694038322416, 'psi': 0.48852295030299864}-{'f1_val': 0.31025661659920684, 'auprc': 0.7795050017046988, 'loss_val': 1.2751250979444886, 'psi': 0.4979559706414037}
[S5] START round=4 head_norm_before_train=0.976045 cos_to_last_merge=0.9814 (last merge round=1)
[S5] round=4 local utility u=0.906941 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7778210832841856, 'loss_val': 0.9749375886556844, 'psi': 0.561826316333345}-{'f1_val': 0.14226190476190476, 'auprc': 0.7777898189180231, 'loss_val': 1.1353190492682594, 'psi': 0.39647307042435215}
[S6] START round=4 head_norm_before_train=0.985474 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8243968762060222, 'loss_val': 1.2416123832288268, 'psi': 0.4146145197131781}-{'f1_val': 0.14142628205128205, 'auprc': 0.8443024381571317, 'loss_val': 1.2549774174399193, 'psi': 0.4225767444936219}
[S7] START round=4 head_norm_before_train=1.311653 (no previous merge yet)
[S7] round=4 local utility u=0.450936 metrics={'f1_val': 0.27614940282375655, 'auprc': 0.7952364081768745, 'loss_val': 1.0964252812236472, 'psi': 0.48378420496500374}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947446179953539, 'loss_val': 1.1922662155036898, 'psi': 0.40313194083559656}
[S8] START round=4 head_norm_before_train=0.906037 cos_to_last_merge=0.9889 (last merge round=1)
[S8] round=4 local utility u=0.096530 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7336342361006867, 'loss_val': 1.2574634274112229, 'psi': 0.377427283876049}-{'f1_val': 0.13995598239295717, 'auprc': 0.682256361037562, 'loss_val': 1.2963907849029108, 'psi': 0.35687613385079914}
[S9] START round=4 head_norm_before_train=0.918046 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.198373 metrics={'f1_val': 0.3849766125349165, 'auprc': 0.9995753128032516, 'loss_val': 0.6599776517381427, 'psi': 0.6308160926422506}-{'f1_val': 0.41677413407000763, 'auprc': 0.8631259656175916, 'loss_val': 0.8381613988421951, 'psi': 0.5953148666890412}
[S10] START round=4 head_norm_before_train=1.181469 (no previous merge yet)
[S10] round=4 local utility u=0.004772 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6283704300698989, 'loss_val': 1.2165162923728616, 'psi': 0.3345211545529939}-{'f1_val': 0.13862163754172394, 'auprc': 0.6359086316902336, 'loss_val': 1.248675889606227, 'psi': 0.3375364352011278}
[S11] START round=4 head_norm_before_train=1.209951 (no previous merge yet)
[S11] round=4 local utility u=0.024256 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7776596866806087, 'loss_val': 1.1608690678965627, 'psi': 0.39531208469610984}-{'f1_val': 0.14041368337311058, 'auprc': 0.7839135069536332, 'loss_val': 1.228141722311297, 'psi': 0.3978136128053196}
[S13] START round=4 head_norm_before_train=1.273402 (no previous merge yet)
[S13] round=4 local utility u=0.020689 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7172569043608678, 'loss_val': 1.2429864781865854, 'psi': 0.37113421929057894}-{'f1_val': 0.1403857625770531, 'auprc': 0.7109944059883274, 'loss_val': 1.2655772534727476, 'psi': 0.36862921994156284}
[S14] START round=4 head_norm_before_train=0.800186 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.3051820597829778, 'loss_val': 1.3298562615399137, 'psi': 0.20628753564281338}-{'f1_val': 0.14035785288270378, 'auprc': 0.42547107276804375, 'loss_val': 1.3241804594042124, 'psi': 0.2544031408368398}
[S15] START round=4 head_norm_before_train=0.965936 cos_to_last_merge=0.9974 (last merge round=2)
[S15] round=4 local utility u=0.013649 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.6103776435962933, 'loss_val': 1.2653969266220937, 'psi': 0.32799124825545234}-{'f1_val': 0.13973365136155833, 'auprc': 0.6150471415097505, 'loss_val': 1.3067038515246745, 'psi': 0.3298590474208352}
[S16] START round=4 head_norm_before_train=0.791580 cos_to_last_merge=0.9960 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8385342219795897, 'loss_val': 1.2826697855640137, 'psi': 0.4197961589113578}-{'f1_val': 0.14063745019920318, 'auprc': 0.9358111646784573, 'loss_val': 1.3188799659128632, 'psi': 0.45870693599090484}
[S17] START round=4 head_norm_before_train=1.264755 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5834603627722935, 'loss_val': 1.1135195796537856, 'psi': 0.31795352309934805}-{'f1_val': 0.14094896331738438, 'auprc': 0.7302221657105248, 'loss_val': 1.2288557777428977, 'psi': 0.37665824427464056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38508
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.0172
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] cosine check vs S13: cos=-0.0164
[S9] DROPPED delta from S13 (cos=-0.0164 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0469
[S16] DROPPED delta from S5 (cos=-0.0469 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] cosine check vs S10: cos=-0.0339
[S5] DROPPED delta from S10 (cos=-0.0339 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.6391
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=-0.0125
[S7] DROPPED delta from S8 (cos=-0.0125 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=-0.0763
[S5] DROPPED delta from S3 (cos=-0.0763 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.8019
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=-0.0045
[S5] DROPPED delta from S15 (cos=-0.0045 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.821712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.502281e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.756793 delta_norm=0.350228
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.3850 head_norm=1.022021
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.898942e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.3825 head_norm=1.024054 delta_norm=0.489894
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.947248 cos_to_last_merge=0.9885 (last merge round=2)
[S2] round=5 local utility u=0.154722 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6986725227167042, 'loss_val': 1.1596955504543847, 'psi': 0.36453528911982175}-{'f1_val': 0.1417771333885667, 'auprc': 0.612557234020946, 'loss_val': 1.2107933441869305, 'psi': 0.3300891736415184}
[S3] START round=5 head_norm_before_train=1.392655 (no previous merge yet)
[S3] round=5 local utility u=0.632994 metrics={'f1_val': 0.5999954167856054, 'auprc': 0.9959757096776616, 'loss_val': 0.5718771859994893, 'psi': 0.758387533942428}-{'f1_val': 0.45747987562169706, 'auprc': 0.9151705281126797, 'loss_val': 0.7403558524767653, 'psi': 0.6405561366180902}
[S4] START round=5 head_norm_before_train=0.909940 cos_to_last_merge=0.9886 (last merge round=2)
[S4] round=5 local utility u=0.345108 metrics={'f1_val': 0.39419658960485326, 'auprc': 0.7626276405931685, 'loss_val': 1.0529397985744806, 'psi': 0.5415690100001793}-{'f1_val': 0.29370224073889134, 'auprc': 0.7807540146491596, 'loss_val': 1.1945694038322416, 'psi': 0.48852295030299864}
[S5] START round=5 head_norm_before_train=1.026271 cos_to_last_merge=0.9673 (last merge round=1)
[S5] round=5 local utility u=0.081620 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7775176032664897, 'loss_val': 0.8139353249251902, 'psi': 0.56201968996596}-{'f1_val': 0.41782980503278466, 'auprc': 0.7778210832841856, 'loss_val': 0.9749375886556844, 'psi': 0.561826316333345}
[S6] START round=5 head_norm_before_train=1.021511 cos_to_last_merge=0.9982 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8129973951467009, 'loss_val': 1.2119141039536245, 'psi': 0.4100547272894496}-{'f1_val': 0.14142628205128205, 'auprc': 0.8243968762060222, 'loss_val': 1.2416123832288268, 'psi': 0.4146145197131781}
[S7] START round=5 head_norm_before_train=1.344157 (no previous merge yet)
[S7] round=5 local utility u=1.000000 metrics={'f1_val': 0.7152497116142261, 'auprc': 0.7950319912026522, 'loss_val': 0.8429827429017144, 'psi': 0.7471626234495965}-{'f1_val': 0.27614940282375655, 'auprc': 0.7952364081768745, 'loss_val': 1.0964252812236472, 'psi': 0.48378420496500374}
[S8] START round=5 head_norm_before_train=0.939584 cos_to_last_merge=0.9788 (last merge round=1)
[S8] round=5 local utility u=0.077985 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7655440812846553, 'loss_val': 1.1972223506215487, 'psi': 0.39019122194963646}-{'f1_val': 0.13995598239295717, 'auprc': 0.7336342361006867, 'loss_val': 1.2574634274112229, 'psi': 0.377427283876049}
[S9] START round=5 head_norm_before_train=1.024054 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.353513 metrics={'f1_val': 0.4985717747810061, 'auprc': 0.9791615750507218, 'loss_val': 0.5732816462975476, 'psi': 0.6908076948888924}-{'f1_val': 0.3849766125349165, 'auprc': 0.9995753128032516, 'loss_val': 0.6599776517381427, 'psi': 0.6308160926422506}
[S10] START round=5 head_norm_before_train=1.202698 (no previous merge yet)
[S10] round=5 local utility u=0.230998 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7684588586013684, 'loss_val': 1.1747847770704412, 'psi': 0.39055652596558177}-{'f1_val': 0.13862163754172394, 'auprc': 0.6283704300698989, 'loss_val': 1.2165162923728616, 'psi': 0.3345211545529939}
[S11] START round=5 head_norm_before_train=1.238079 (no previous merge yet)
[S11] round=5 local utility u=0.085695 metrics={'f1_val': 0.1550606545357595, 'auprc': 0.7671179930375452, 'loss_val': 1.0457352385509386, 'psi': 0.3998835899364738}-{'f1_val': 0.14041368337311058, 'auprc': 0.7776596866806087, 'loss_val': 1.1608690678965627, 'psi': 0.39531208469610984}
[S13] START round=5 head_norm_before_train=1.289051 (no previous merge yet)
[S13] round=5 local utility u=0.198636 metrics={'f1_val': 0.19786332640438045, 'auprc': 0.725149542887217, 'loss_val': 1.2142584310144962, 'psi': 0.4087778129975151}-{'f1_val': 0.1403857625770531, 'auprc': 0.7172569043608678, 'loss_val': 1.2429864781865854, 'psi': 0.37113421929057894}
[S14] START round=5 head_norm_before_train=0.756793 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.370532 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5484284387974676, 'loss_val': 1.3185317181819847, 'psi': 0.3035860872486093}-{'f1_val': 0.14035785288270378, 'auprc': 0.3051820597829778, 'loss_val': 1.3298562615399137, 'psi': 0.20628753564281338}
[S15] START round=5 head_norm_before_train=1.001742 cos_to_last_merge=0.9907 (last merge round=2)
[S15] round=5 local utility u=0.101032 metrics={'f1_val': 0.14467997530356042, 'auprc': 0.6534162532296344, 'loss_val': 1.2221261547062443, 'psi': 0.34817448647398996}-{'f1_val': 0.13973365136155833, 'auprc': 0.6103776435962933, 'loss_val': 1.2653969266220937, 'psi': 0.32799124825545234}
[S16] START round=5 head_norm_before_train=0.813973 cos_to_last_merge=0.9848 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6497318291923468, 'loss_val': 1.2194663972562105, 'psi': 0.34427520179646065}-{'f1_val': 0.14063745019920318, 'auprc': 0.8385342219795897, 'loss_val': 1.2826697855640137, 'psi': 0.4197961589113578}
[S17] START round=5 head_norm_before_train=1.305879 (no previous merge yet)
[S17] round=5 local utility u=1.000000 metrics={'f1_val': 0.39178269178899605, 'auprc': 0.7354921045021255, 'loss_val': 0.966214389330485, 'psi': 0.5292664568742478}-{'f1_val': 0.14094896331738438, 'auprc': 0.5834603627722935, 'loss_val': 1.1135195796537856, 'psi': 0.31795352309934805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.3525
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] cosine check vs S14: cos=-0.0606
[S5] DROPPED delta from S14 (cos=-0.0606 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S13
[S9] cosine check vs S13: cos=-0.0132
[S9] DROPPED delta from S13 (cos=-0.0132 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.0019
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.0057
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=-0.0412
[S11] DROPPED delta from S4 (cos=-0.0412 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0411
[S16] DROPPED delta from S5 (cos=-0.0411 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=-0.0692
[S5] DROPPED delta from S3 (cos=-0.0692 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.0202
[S5] DROPPED delta from S2 (cos=-0.0202 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] cosine check vs S10: cos=-0.0226
[S5] DROPPED delta from S10 (cos=-0.0226 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1789) from S7
[S14] cosine check vs S7: cos=0.8566
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.8701
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.0442
[S6] ⇄ pheromone p=0.329 → S4@127.0.0.1:38504
[S11] ⇄ pheromone p=0.351 → S9@127.0.0.1:38510
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.4986 head_norm=1.114754
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.618053e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.4376 head_norm=0.930059 delta_norm=0.461805
[S9] aggregate: ROLLBACK (f1_val pre=0.499 post=0.438 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.551 → S14@127.0.0.1:38514
[S13] ⇄ pheromone p=0.435 → S9@127.0.0.1:38510
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.7152 head_norm=1.387843
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.479034e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.7152 head_norm=0.852448 delta_norm=0.847903
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.607 → S14@127.0.0.1:38514
[S2] ⇄ pheromone p=0.382 → S5@127.0.0.1:38505
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.774057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.155073e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.811557 delta_norm=0.215507
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.415 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.408 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=0.662 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.473 → S11@127.0.0.1:38512
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4184 head_norm=1.078819
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.469062e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4177 head_norm=0.748344 delta_norm=0.746906
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.512 → S16@127.0.0.1:38516
[S15] ⇄ pheromone p=0.353 → S5@127.0.0.1:38505
[S8] ⇄ pheromone p=0.371 → S7@127.0.0.1:38508
[S16] ⇄ pheromone p=0.402 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.540 → S9@127.0.0.1:38510
[S2] START round=6 head_norm_before_train=0.971815 cos_to_last_merge=0.9820 (last merge round=2)
[S2] round=6 local utility u=0.954150 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.773458636851053, 'loss_val': 1.1191128864511481, 'psi': 0.5587856353748238}-{'f1_val': 0.1417771333885667, 'auprc': 0.6986725227167042, 'loss_val': 1.1596955504543847, 'psi': 0.36453528911982175}
[S3] START round=6 head_norm_before_train=1.475515 (no previous merge yet)
[S3] round=6 local utility u=0.090552 metrics={'f1_val': 0.6149207533859766, 'auprc': 0.9981850876805186, 'loss_val': 0.4869538077946788, 'psi': 0.7682264871037934}-{'f1_val': 0.5999954167856054, 'auprc': 0.9959757096776616, 'loss_val': 0.5718771859994893, 'psi': 0.758387533942428}
[S4] START round=6 head_norm_before_train=0.958470 cos_to_last_merge=0.9758 (last merge round=2)
[S4] round=6 local utility u=0.021529 metrics={'f1_val': 0.3723084766795537, 'auprc': 0.7631967409270322, 'loss_val': 0.8802605730487558, 'psi': 0.5286637823785452}-{'f1_val': 0.39419658960485326, 'auprc': 0.7626276405931685, 'loss_val': 1.0529397985744806, 'psi': 0.5415690100001793}
[S5] START round=6 head_norm_before_train=0.748344 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.42848433223874804, 'auprc': 0.6782747609090051, 'loss_val': 0.7815264946038729, 'psi': 0.5284005037068509}-{'f1_val': 0.4183544144322735, 'auprc': 0.7775176032664897, 'loss_val': 0.8139353249251902, 'psi': 0.56201968996596}
[S6] START round=6 head_norm_before_train=1.054241 cos_to_last_merge=0.9940 (last merge round=3)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.16995246464827413, 'auprc': 0.7065214041114479, 'loss_val': 1.0971397226695774, 'psi': 0.38458004043354366}-{'f1_val': 0.14142628205128205, 'auprc': 0.8129973951467009, 'loss_val': 1.2119141039536245, 'psi': 0.4100547272894496}
[S7] START round=6 head_norm_before_train=0.852448 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.041236 metrics={'f1_val': 0.7143650336037626, 'auprc': 0.7923573825177704, 'loss_val': 0.7471790296167361, 'psi': 0.7455619731693657}-{'f1_val': 0.7152497116142261, 'auprc': 0.7950319912026522, 'loss_val': 0.8429827429017144, 'psi': 0.7471626234495965}
[S8] START round=6 head_norm_before_train=0.982399 cos_to_last_merge=0.9670 (last merge round=1)
[S8] round=6 local utility u=0.486848 metrics={'f1_val': 0.2870308707982616, 'auprc': 0.7696576274383565, 'loss_val': 1.1183161950076324, 'psi': 0.4800815734542996}-{'f1_val': 0.13995598239295717, 'auprc': 0.7655440812846553, 'loss_val': 1.1972223506215487, 'psi': 0.39019122194963646}
[S9] START round=6 head_norm_before_train=0.930059 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.685735 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9973135157754727, 'loss_val': 0.4721361905896933, 'psi': 0.8196553547742003}-{'f1_val': 0.4985717747810061, 'auprc': 0.9791615750507218, 'loss_val': 0.5732816462975476, 'psi': 0.6908076948888924}
[S10] START round=6 head_norm_before_train=1.223527 (no previous merge yet)
[S10] round=6 local utility u=0.082909 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7956503544486984, 'loss_val': 1.0905410038247654, 'psi': 0.4014331243045137}-{'f1_val': 0.13862163754172394, 'auprc': 0.7684588586013684, 'loss_val': 1.1747847770704412, 'psi': 0.39055652596558177}
[S11] START round=6 head_norm_before_train=1.275453 (no previous merge yet)
[S11] round=6 local utility u=0.914163 metrics={'f1_val': 0.39638486531124173, 'auprc': 0.8330596583340822, 'loss_val': 0.8631797333071715, 'psi': 0.571054782520378}-{'f1_val': 0.1550606545357595, 'auprc': 0.7671179930375452, 'loss_val': 1.0457352385509386, 'psi': 0.3998835899364738}
[S13] START round=6 head_norm_before_train=1.299422 (no previous merge yet)
[S13] round=6 local utility u=0.648117 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.7028513445284428, 'loss_val': 1.1592365587973603, 'psi': 0.5306691361771847}-{'f1_val': 0.19786332640438045, 'auprc': 0.725149542887217, 'loss_val': 1.2142584310144962, 'psi': 0.4087778129975151}
[S14] START round=6 head_norm_before_train=0.811557 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5351666744308079, 'loss_val': 1.2955887472958412, 'psi': 0.29828138150194544}-{'f1_val': 0.14035785288270378, 'auprc': 0.5484284387974676, 'loss_val': 1.3185317181819847, 'psi': 0.3035860872486093}
[S15] START round=6 head_norm_before_train=1.035338 cos_to_last_merge=0.9833 (last merge round=2)
[S15] round=6 local utility u=0.303782 metrics={'f1_val': 0.16754904570814477, 'auprc': 0.7817948603504337, 'loss_val': 1.1369123827909764, 'psi': 0.41324737156506036}-{'f1_val': 0.14467997530356042, 'auprc': 0.6534162532296344, 'loss_val': 1.2221261547062443, 'psi': 0.34817448647398996}
[S16] START round=6 head_norm_before_train=0.850585 cos_to_last_merge=0.9667 (last merge round=2)
[S16] round=6 local utility u=0.204143 metrics={'f1_val': 0.19384571256672334, 'auprc': 0.6477746770726556, 'loss_val': 1.1245585639053781, 'psi': 0.3754172983690962}-{'f1_val': 0.14063745019920318, 'auprc': 0.6497318291923468, 'loss_val': 1.2194663972562105, 'psi': 0.34427520179646065}
[S17] START round=6 head_norm_before_train=1.348607 (no previous merge yet)
[S17] round=6 local utility u=0.046728 metrics={'f1_val': 0.3560806711807735, 'auprc': 0.822540723975598, 'loss_val': 0.9196922631805821, 'psi': 0.5426646922987033}-{'f1_val': 0.39178269178899605, 'auprc': 0.7354921045021255, 'loss_val': 0.966214389330485, 'psi': 0.5292664568742478}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=-0.0296
[S5] DROPPED delta from S3 (cos=-0.0296 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.8441
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.2976
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.6358
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.5493
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.4976
[S6] RECEIVED delta(kind=head bytes=1789) from S16
[S6] cosine check vs S16: cos=0.8357
[S14] RECEIVED delta(kind=head bytes=1791) from S7
[S14] cosine check vs S7: cos=0.7286
[S9] RECEIVED delta(kind=head bytes=1792) from S13
[S9] cosine check vs S13: cos=0.0042
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] cosine check vs S10: cos=-0.0556
[S5] DROPPED delta from S10 (cos=-0.0556 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=-0.0403
[S11] DROPPED delta from S4 (cos=-0.0403 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1808 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1808) from S17
[S9] cosine check vs S17: cos=0.3652
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4285 head_norm=0.822713
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.079438e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.4316 head_norm=0.752502 delta_norm=0.407944
[S5] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1700 head_norm=1.086903
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.986989e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.945602 delta_norm=0.298699
[S6] aggregate: ROLLBACK (f1_val pre=0.170 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.829602
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.227257e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.738069 delta_norm=0.222726
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.7144 head_norm=0.940365
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.665317e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4473 head_norm=0.862808 delta_norm=0.466532
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.447 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7012 head_norm=1.022013
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.827775e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7013 head_norm=0.836310 delta_norm=0.382777
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.989447 cos_to_last_merge=0.9767 (last merge round=2)
[S2] round=7 local utility u=0.058165 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.775473051750859, 'loss_val': 1.0126371317863057, 'psi': 0.5599724037534111}-{'f1_val': 0.4156703010573377, 'auprc': 0.773458636851053, 'loss_val': 1.1191128864511481, 'psi': 0.5587856353748238}
[S3] START round=7 head_norm_before_train=1.548226 (no previous merge yet)
[S3] round=7 local utility u=0.110479 metrics={'f1_val': 0.6405398626486463, 'auprc': 0.9940906165458278, 'loss_val': 0.40742759388241945, 'psi': 0.7819601642075189}-{'f1_val': 0.6149207533859766, 'auprc': 0.9981850876805186, 'loss_val': 0.4869538077946788, 'psi': 0.7682264871037934}
[S4] START round=7 head_norm_before_train=1.011676 cos_to_last_merge=0.9609 (last merge round=2)
[S4] round=7 local utility u=0.103762 metrics={'f1_val': 0.3761083714134083, 'auprc': 0.7952049592616673, 'loss_val': 0.791560639806276, 'psi': 0.5437470065527119}-{'f1_val': 0.3723084766795537, 'auprc': 0.7631967409270322, 'loss_val': 0.8802605730487558, 'psi': 0.5286637823785452}
[S5] START round=7 head_norm_before_train=0.752502 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.081844 metrics={'f1_val': 0.41730510810538973, 'auprc': 0.7907157917146732, 'loss_val': 0.8880859011831987, 'psi': 0.5666693815491031}-{'f1_val': 0.42848433223874804, 'auprc': 0.6782747609090051, 'loss_val': 0.7815264946038729, 'psi': 0.5284005037068509}
[S6] START round=7 head_norm_before_train=0.945602 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.757824 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.6775803775621607, 'loss_val': 0.9700519753759752, 'psi': 0.5205420126899492}-{'f1_val': 0.16995246464827413, 'auprc': 0.7065214041114479, 'loss_val': 1.0971397226695774, 'psi': 0.38458004043354366}
[S7] START round=7 head_norm_before_train=0.862808 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.6788826558477299, 'auprc': 0.7921283204811298, 'loss_val': 0.7842064376312228, 'psi': 0.7241809217010898}-{'f1_val': 0.7143650336037626, 'auprc': 0.7923573825177704, 'loss_val': 0.7471790296167361, 'psi': 0.7455619731693657}
[S8] START round=7 head_norm_before_train=1.019751 cos_to_last_merge=0.9570 (last merge round=1)
[S8] round=7 local utility u=0.907758 metrics={'f1_val': 0.6416534282711521, 'auprc': 0.6427638140224405, 'loss_val': 1.0498536197531252, 'psi': 0.6420975825716675}-{'f1_val': 0.2870308707982616, 'auprc': 0.7696576274383565, 'loss_val': 1.1183161950076324, 'psi': 0.4800815734542996}
[S9] START round=7 head_norm_before_train=0.836310 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.034752 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982191776179504, 'loss_val': 0.4053499054357808, 'psi': 0.8200176195111913}-{'f1_val': 0.7012165807733519, 'auprc': 0.9973135157754727, 'loss_val': 0.4721361905896933, 'psi': 0.8196553547742003}
[S10] START round=7 head_norm_before_train=1.254779 (no previous merge yet)
[S10] round=7 local utility u=0.858320 metrics={'f1_val': 0.39557274556168875, 'auprc': 0.8124818025189433, 'loss_val': 0.9661012178946095, 'psi': 0.5623363683445906}-{'f1_val': 0.13862163754172394, 'auprc': 0.7956503544486984, 'loss_val': 1.0905410038247654, 'psi': 0.4014331243045137}
[S11] START round=7 head_norm_before_train=1.312396 (no previous merge yet)
[S11] round=7 local utility u=0.327900 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9985656946240068, 'loss_val': 0.7251412501302291, 'psi': 0.6393815295310659}-{'f1_val': 0.39638486531124173, 'auprc': 0.8330596583340822, 'loss_val': 0.8631797333071715, 'psi': 0.571054782520378}
[S13] START round=7 head_norm_before_train=1.315090 (no previous merge yet)
[S13] round=7 local utility u=0.112131 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.7371424703935042, 'loss_val': 1.0413889010016497, 'psi': 0.5447396541079409}-{'f1_val': 0.4158809972763461, 'auprc': 0.7028513445284428, 'loss_val': 1.1592365587973603, 'psi': 0.5306691361771847}
[S14] START round=7 head_norm_before_train=0.738069 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.063964 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5696898971517815, 'loss_val': 1.2712303694396645, 'psi': 0.3120906705903349}-{'f1_val': 0.14035785288270378, 'auprc': 0.5351666744308079, 'loss_val': 1.2955887472958412, 'psi': 0.29828138150194544}
[S15] START round=7 head_norm_before_train=1.065657 cos_to_last_merge=0.9762 (last merge round=2)
[S15] round=7 local utility u=1.000000 metrics={'f1_val': 0.7151545815837624, 'auprc': 0.8001266413465338, 'loss_val': 1.0076947713115136, 'psi': 0.749143405488871}-{'f1_val': 0.16754904570814477, 'auprc': 0.7817948603504337, 'loss_val': 1.1369123827909764, 'psi': 0.41324737156506036}
[S16] START round=7 head_norm_before_train=0.886233 cos_to_last_merge=0.9477 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=7 local utility u=0.563750 metrics={'f1_val': 0.41715376224746203, 'auprc': 0.534156024161758, 'loss_val': 0.9960512544055636, 'psi': 0.46395466701318044}-{'f1_val': 0.19384571256672334, 'auprc': 0.6477746770726556, 'loss_val': 1.1245585639053781, 'psi': 0.3754172983690962}
[S17] START round=7 head_norm_before_train=1.390673 (no previous merge yet)
[S17] round=7 local utility u=0.020920 metrics={'f1_val': 0.3536510154013902, 'auprc': 0.8173332930546787, 'loss_val': 0.8476529817464997, 'psi': 0.5391239264627057}-{'f1_val': 0.3560806711807735, 'auprc': 0.822540723975598, 'loss_val': 0.9196922631805821, 'psi': 0.5426646922987033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=-0.0583
[S5] DROPPED delta from S10 (cos=-0.0583 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=-0.0123
[S5] DROPPED delta from S3 (cos=-0.0123 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.8282
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=-0.0204
[S5] DROPPED delta from S14 (cos=-0.0204 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.5747
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.6141
[S4] RECEIVED delta(kind=head bytes=1787) from S6
[S4] cosine check vs S6: cos=0.1571
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.8105
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0375
[S11] DROPPED delta from S4 (cos=-0.0375 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0258
[S16] DROPPED delta from S5 (cos=-0.0258 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=0.9241
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.4743
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.2446
[S9] RECEIVED delta(kind=head bytes=1807) from S11
[S9] cosine check vs S11: cos=0.7672
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.6789 head_norm=0.948709
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.976303e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.7141 head_norm=0.957307 delta_norm=0.297630
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4158 head_norm=0.976618
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.869866e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4150 head_norm=0.932539 delta_norm=0.186987
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=0.938138
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.679185e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7012 head_norm=0.843839 delta_norm=0.267918
[S9] aggregate: ACCEPT kept=['S17', 'S13', 'S11'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3761 head_norm=1.065526
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.637492e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.3764 head_norm=0.777175 delta_norm=0.663749
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.758418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.992216e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.753838 delta_norm=0.399222
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4173 head_norm=0.807704
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.558312e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4173 head_norm=0.822534 delta_norm=0.255831
[S5] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.021598 cos_to_last_merge=0.9673 (last merge round=2)
[S2] round=8 local utility u=0.047765 metrics={'f1_val': 0.41723085085657674, 'auprc': 0.7754171398762789, 'loss_val': 0.9224919275811312, 'psi': 0.5605053664644576}-{'f1_val': 0.41630530508844577, 'auprc': 0.775473051750859, 'loss_val': 1.0126371317863057, 'psi': 0.5599724037534111}
[S3] START round=8 head_norm_before_train=1.615383 (no previous merge yet)
[S3] round=8 local utility u=0.260724 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984847111375579, 'loss_val': 0.26000781179005067, 'psi': 0.819802460254224}-{'f1_val': 0.6405398626486463, 'auprc': 0.9940906165458278, 'loss_val': 0.40742759388241945, 'psi': 0.7819601642075189}
[S4] START round=8 head_norm_before_train=0.777175 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.37259438781737575, 'auprc': 0.7907722058785135, 'loss_val': 0.8037184564255335, 'psi': 0.5398655150418309}-{'f1_val': 0.3761083714134083, 'auprc': 0.7952049592616673, 'loss_val': 0.791560639806276, 'psi': 0.5437470065527119}
[S5] START round=8 head_norm_before_train=0.822534 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.42089154377795024, 'auprc': 0.691998529916578, 'loss_val': 0.7631358610186907, 'psi': 0.5293343382334014}-{'f1_val': 0.41730510810538973, 'auprc': 0.7907157917146732, 'loss_val': 0.8880859011831987, 'psi': 0.5666693815491031}
[S6] START round=8 head_norm_before_train=0.932539 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.252572 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.795691474653678, 'loss_val': 0.8264773793167153, 'psi': 0.5685100125859917}-{'f1_val': 0.41584976944180807, 'auprc': 0.6775803775621607, 'loss_val': 0.9700519753759752, 'psi': 0.5205420126899492}
[S7] START round=8 head_norm_before_train=0.957307 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.019728 metrics={'f1_val': 0.6638521790334988, 'auprc': 0.822024345111156, 'loss_val': 0.7442557100154071, 'psi': 0.7271210454645617}-{'f1_val': 0.6788826558477299, 'auprc': 0.7921283204811298, 'loss_val': 0.7842064376312228, 'psi': 0.7241809217010898}
[S8] START round=8 head_norm_before_train=1.053562 cos_to_last_merge=0.9479 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.6253598857351438, 'auprc': 0.6341617386178326, 'loss_val': 0.9500813470460814, 'psi': 0.6288806268882193}-{'f1_val': 0.6416534282711521, 'auprc': 0.6427638140224405, 'loss_val': 1.0498536197531252, 'psi': 0.6420975825716675}
[S9] START round=8 head_norm_before_train=0.843839 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.030500 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982209568415553, 'loss_val': 0.3443549316574175, 'psi': 0.8200183312006333}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982191776179504, 'loss_val': 0.4053499054357808, 'psi': 0.8200176195111913}
[S10] START round=8 head_norm_before_train=1.293028 (no previous merge yet)
[S10] round=8 local utility u=0.138399 metrics={'f1_val': 0.4092456771854998, 'auprc': 0.8247683977404837, 'loss_val': 0.8082003230972207, 'psi': 0.5754547654074934}-{'f1_val': 0.39557274556168875, 'auprc': 0.8124818025189433, 'loss_val': 0.9661012178946095, 'psi': 0.5623363683445906}
[S11] START round=8 head_norm_before_train=1.353649 (no previous merge yet)
[S11] round=8 local utility u=0.047840 metrics={'f1_val': 0.4005844218082196, 'auprc': 0.9986181025782748, 'loss_val': 0.6335716497983909, 'psi': 0.6397978941162417}-{'f1_val': 0.39992541946910537, 'auprc': 0.9985656946240068, 'loss_val': 0.7251412501302291, 'psi': 0.6393815295310659}
[S13] START round=8 head_norm_before_train=1.344750 (no previous merge yet)
[S13] round=8 local utility u=0.292977 metrics={'f1_val': 0.4813582833450869, 'auprc': 0.7590986088378795, 'loss_val': 0.9106271196761728, 'psi': 0.592454413542204}-{'f1_val': 0.4164711099175653, 'auprc': 0.7371424703935042, 'loss_val': 1.0413889010016497, 'psi': 0.5447396541079409}
[S14] START round=8 head_norm_before_train=0.753838 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.307191 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7621719265869423, 'loss_val': 1.2342937680023298, 'psi': 0.3890834823643992}-{'f1_val': 0.14035785288270378, 'auprc': 0.5696898971517815, 'loss_val': 1.2712303694396645, 'psi': 0.3120906705903349}
[S15] START round=8 head_norm_before_train=1.093062 cos_to_last_merge=0.9688 (last merge round=2)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6425436815108178, 'auprc': 0.7998749142817863, 'loss_val': 0.7813080824412931, 'psi': 0.7054761746192051}-{'f1_val': 0.7151545815837624, 'auprc': 0.8001266413465338, 'loss_val': 1.0076947713115136, 'psi': 0.749143405488871}
[S16] START round=8 head_norm_before_train=0.924880 cos_to_last_merge=0.9273 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=8 local utility u=0.212657 metrics={'f1_val': 0.4166929047986758, 'auprc': 0.6441266452477221, 'loss_val': 0.8978833775899095, 'psi': 0.5076664009782943}-{'f1_val': 0.41715376224746203, 'auprc': 0.534156024161758, 'loss_val': 0.9960512544055636, 'psi': 0.46395466701318044}
[S17] START round=8 head_norm_before_train=1.436198 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35369453961003255, 'auprc': 0.7972781615741715, 'loss_val': 0.8545323951665355, 'psi': 0.5311279883956881}-{'f1_val': 0.3536510154013902, 'auprc': 0.8173332930546787, 'loss_val': 0.8476529817464997, 'psi': 0.5391239264627057}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.2422
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.8564
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.7349
[S5] RECEIVED delta(kind=head bytes=1805) from S3
[S5] cosine check vs S3: cos=-0.0023
[S5] DROPPED delta from S3 (cos=-0.0023 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.0512
[S5] DROPPED delta from S10 (cos=-0.0512 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] cosine check vs S14: cos=0.1020
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9583
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.7155
[S9] RECEIVED delta(kind=head bytes=1804) from S13
[S9] cosine check vs S13: cos=0.3772
[S9] RECEIVED delta(kind=head bytes=1805) from S11
[S9] cosine check vs S11: cos=0.7082
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3726 head_norm=0.831637
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.353394e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3720 head_norm=0.841277 delta_norm=0.335339
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4171 head_norm=0.974052
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.405336e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.962464 delta_norm=0.140534
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4209 head_norm=0.885400
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.403785e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4175 head_norm=0.697890 delta_norm=0.340379
[S5] aggregate: ACCEPT kept=['S14', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=0.770715
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.608311e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.688687 delta_norm=0.260831
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=0.942027
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.270401e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7165 head_norm=0.903860 delta_norm=0.327040
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.061934 cos_to_last_merge=0.9559 (last merge round=2)
[S2] round=9 local utility u=0.780015 metrics={'f1_val': 0.7056367859937515, 'auprc': 0.6806832218707553, 'loss_val': 0.8086951087653141, 'psi': 0.695655360344553}-{'f1_val': 0.41723085085657674, 'auprc': 0.7754171398762789, 'loss_val': 0.9224919275811312, 'psi': 0.5605053664644576}
[S3] START round=9 head_norm_before_train=1.675750 (no previous merge yet)
[S3] round=9 local utility u=0.036009 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986078632935331, 'loss_val': 0.18790884297609747, 'psi': 0.8198067468175366}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984847111375579, 'loss_val': 0.26000781179005067, 'psi': 0.819802460254224}
[S4] START round=9 head_norm_before_train=0.841277 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.37244492947626406, 'auprc': 0.7671618312343913, 'loss_val': 0.7977505552869864, 'psi': 0.530331690179515}-{'f1_val': 0.37259438781737575, 'auprc': 0.7907722058785135, 'loss_val': 0.8037184564255335, 'psi': 0.5398655150418309}
[S5] START round=9 head_norm_before_train=0.697890 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.882461 metrics={'f1_val': 0.6690822501772428, 'auprc': 0.7610320725818678, 'loss_val': 0.6944593400555259, 'psi': 0.7058621791390928}-{'f1_val': 0.42089154377795024, 'auprc': 0.691998529916578, 'loss_val': 0.7631358610186907, 'psi': 0.5293343382334014}
[S6] START round=9 head_norm_before_train=0.962464 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.061627 metrics={'f1_val': 0.4171352566691459, 'auprc': 0.7942111665490095, 'loss_val': 0.6992603889921762, 'psi': 0.5679656206210913}-{'f1_val': 0.41705570454086727, 'auprc': 0.795691474653678, 'loss_val': 0.8264773793167153, 'psi': 0.5685100125859917}
[S7] START round=9 head_norm_before_train=1.021899 cos_to_last_merge=0.9908 (last merge round=7)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.45492858014012494, 'auprc': 0.789141756084677, 'loss_val': 0.8379729571096486, 'psi': 0.5886138505179457}-{'f1_val': 0.6638521790334988, 'auprc': 0.822024345111156, 'loss_val': 0.7442557100154071, 'psi': 0.7271210454645617}
[S8] START round=9 head_norm_before_train=1.087568 cos_to_last_merge=0.9369 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=9 local utility u=0.565324 metrics={'f1_val': 0.7045308161287993, 'auprc': 0.7938224045165355, 'loss_val': 0.7734400718837903, 'psi': 0.7402474514838938}-{'f1_val': 0.6253598857351438, 'auprc': 0.6341617386178326, 'loss_val': 0.9500813470460814, 'psi': 0.6288806268882193}
[S9] START round=9 head_norm_before_train=0.903860 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.929608 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9993418440287591, 'loss_val': 0.261165920697116, 'psi': 0.9977330446998385}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982209568415553, 'loss_val': 0.3443549316574175, 'psi': 0.8200183312006333}
[S10] START round=9 head_norm_before_train=1.341353 (no previous merge yet)
[S10] round=9 local utility u=0.080375 metrics={'f1_val': 0.40434546161133167, 'auprc': 0.8505642656459382, 'loss_val': 0.6954358214530153, 'psi': 0.5828329832251743}-{'f1_val': 0.4092456771854998, 'auprc': 0.8247683977404837, 'loss_val': 0.8082003230972207, 'psi': 0.5754547654074934}
[S11] START round=9 head_norm_before_train=1.397876 (no previous merge yet)
[S11] round=9 local utility u=0.002376 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.999111836388267, 'loss_val': 0.6305437854940686, 'psi': 0.6400197566325614}-{'f1_val': 0.4005844218082196, 'auprc': 0.9986181025782748, 'loss_val': 0.6335716497983909, 'psi': 0.6397978941162417}
[S13] START round=9 head_norm_before_train=1.371612 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.37461567104652493, 'auprc': 0.7575719650792737, 'loss_val': 0.8225192964844394, 'psi': 0.5277981886596245}-{'f1_val': 0.4813582833450869, 'auprc': 0.7590986088378795, 'loss_val': 0.9106271196761728, 'psi': 0.592454413542204}
[S14] START round=9 head_norm_before_train=0.688687 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.057715 metrics={'f1_val': 0.1536118363794604, 'auprc': 0.7394071193740102, 'loss_val': 1.130092949586499, 'psi': 0.38792994957728033}-{'f1_val': 0.14035785288270378, 'auprc': 0.7621719265869423, 'loss_val': 1.2342937680023298, 'psi': 0.3890834823643992}
[S15] START round=9 head_norm_before_train=1.132218 cos_to_last_merge=0.9574 (last merge round=2)
[S15] round=9 local utility u=0.179312 metrics={'f1_val': 0.6843718578776058, 'auprc': 0.799418050029884, 'loss_val': 0.6722831625194138, 'psi': 0.7303903347385171}-{'f1_val': 0.6425436815108178, 'auprc': 0.7998749142817863, 'loss_val': 0.7813080824412931, 'psi': 0.7054761746192051}
[S16] START round=9 head_norm_before_train=0.971286 cos_to_last_merge=0.9063 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=9 local utility u=0.085470 metrics={'f1_val': 0.4271800950816408, 'auprc': 0.6523055130499805, 'loss_val': 0.814403053644252, 'psi': 0.5172302622689766}-{'f1_val': 0.4166929047986758, 'auprc': 0.6441266452477221, 'loss_val': 0.8978833775899095, 'psi': 0.5076664009782943}
[S17] START round=9 head_norm_before_train=1.474959 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3532160952819635, 'auprc': 0.7976141502455347, 'loss_val': 0.9023600570412093, 'psi': 0.530975317267392}-{'f1_val': 0.35369453961003255, 'auprc': 0.7972781615741715, 'loss_val': 0.8545323951665355, 'psi': 0.5311279883956881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38516
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=0.9124
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0331
[S16] DROPPED delta from S5 (cos=-0.0331 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=-0.0019
[S5] DROPPED delta from S3 (cos=-0.0019 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.7671
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.6736
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.7486
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.0197
[S5] DROPPED delta from S10 (cos=-0.0197 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=0.9714
[S7] RECEIVED delta(kind=head bytes=1793) from S8
[S7] cosine check vs S8: cos=0.8837
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.7521
[S5] RECEIVED delta(kind=head bytes=1792) from S14
[S5] cosine check vs S14: cos=0.4613
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4549 head_norm=1.088802
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.681219e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.5144 head_norm=1.076104 delta_norm=0.268122
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3724 head_norm=0.892332
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.061569e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3724 head_norm=0.927967 delta_norm=0.206157
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9967 head_norm=1.006182
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.753577e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.9967 head_norm=1.146383 delta_norm=0.475358
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4171 head_norm=1.005481
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.211559e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4169 head_norm=1.004093 delta_norm=0.121156
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.6691 head_norm=0.782131
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.935431e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7006 head_norm=0.742463 delta_norm=0.193543
[S5] aggregate: ACCEPT kept=['S15', 'S2', 'S14'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.1536 head_norm=0.713241
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.240744e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.1404 head_norm=0.809650 delta_norm=0.324074
[S14] aggregate: ROLLBACK (f1_val pre=0.154 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.104541 cos_to_last_merge=0.9431 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=10 local utility u=0.103473 metrics={'f1_val': 0.6776880047204208, 'auprc': 0.7773035520009188, 'loss_val': 0.7239169375388882, 'psi': 0.7175342236326201}-{'f1_val': 0.7056367859937515, 'auprc': 0.6806832218707553, 'loss_val': 0.8086951087653141, 'psi': 0.695655360344553}
[S3] START round=10 head_norm_before_train=1.722232 (no previous merge yet)
[S3] round=10 local utility u=0.901522 metrics={'f1_val': 0.9927752496305641, 'auprc': 0.998689917962732, 'loss_val': 0.13812732956733276, 'psi': 0.9951411169634312}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986078632935331, 'loss_val': 0.18790884297609747, 'psi': 0.8198067468175366}
[S4] START round=10 head_norm_before_train=0.927967 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.003920 metrics={'f1_val': 0.3725014115484226, 'auprc': 0.7639877504956863, 'loss_val': 0.780726296166972, 'psi': 0.5290959471273281}-{'f1_val': 0.37244492947626406, 'auprc': 0.7671618312343913, 'loss_val': 0.7977505552869864, 'psi': 0.530331690179515}
[S5] START round=10 head_norm_before_train=0.742463 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.283235 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8561035938509325, 'loss_val': 0.6021252599526725, 'psi': 0.7627829306465312}-{'f1_val': 0.6690822501772428, 'auprc': 0.7610320725818678, 'loss_val': 0.6944593400555259, 'psi': 0.7058621791390928}
[S6] START round=10 head_norm_before_train=1.004093 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.4158432846376109, 'auprc': 0.781474042836315, 'loss_val': 0.6734476904040965, 'psi': 0.5620955879170926}-{'f1_val': 0.4171352566691459, 'auprc': 0.7942111665490095, 'loss_val': 0.6992603889921762, 'psi': 0.5679656206210913}
[S7] START round=10 head_norm_before_train=1.076104 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.655120 metrics={'f1_val': 0.6330769838720496, 'auprc': 0.8152419404811908, 'loss_val': 0.6749242116438956, 'psi': 0.7059429665157061}-{'f1_val': 0.45492858014012494, 'auprc': 0.789141756084677, 'loss_val': 0.8379729571096486, 'psi': 0.5886138505179457}
[S8] START round=10 head_norm_before_train=1.128844 cos_to_last_merge=0.9222 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.922
[S8] round=10 local utility u=0.124822 metrics={'f1_val': 0.7139808238386206, 'auprc': 0.7931763091120676, 'loss_val': 0.5785578513776681, 'psi': 0.7456590179479994}-{'f1_val': 0.7045308161287993, 'auprc': 0.7938224045165355, 'loss_val': 0.7734400718837903, 'psi': 0.7402474514838938}
[S9] START round=10 head_norm_before_train=1.146383 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.053163 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987942406608308, 'loss_val': 0.15585054845480698, 'psi': 0.997779443771618}-{'f1_val': 0.9966605118138915, 'auprc': 0.9993418440287591, 'loss_val': 0.261165920697116, 'psi': 0.9977330446998385}
[S10] START round=10 head_norm_before_train=1.395815 (no previous merge yet)
[S10] round=10 local utility u=0.750916 metrics={'f1_val': 0.605783792329088, 'auprc': 0.8972456954362308, 'loss_val': 0.5422784658697288, 'psi': 0.7223685535719451}-{'f1_val': 0.40434546161133167, 'auprc': 0.8505642656459382, 'loss_val': 0.6954358214530153, 'psi': 0.5828329832251743}
[S11] START round=10 head_norm_before_train=1.438025 (no previous merge yet)
[S11] round=10 local utility u=0.997250 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9981884085368943, 'loss_val': 0.4408677568327007, 'psi': 0.820409747987123}-{'f1_val': 0.40062503679542427, 'auprc': 0.999111836388267, 'loss_val': 0.6305437854940686, 'psi': 0.6400197566325614}
[S13] START round=10 head_norm_before_train=1.398116 (no previous merge yet)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.7135150731518334, 'auprc': 0.7622971485403375, 'loss_val': 0.6847819949275865, 'psi': 0.733027903307235}-{'f1_val': 0.37461567104652493, 'auprc': 0.7575719650792737, 'loss_val': 0.8225192964844394, 'psi': 0.5277981886596245}
[S14] START round=10 head_norm_before_train=0.809650 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.6922370269115006, 'auprc': 0.9267527253830111, 'loss_val': 1.006310209872048, 'psi': 0.7860433063001048}-{'f1_val': 0.1536118363794604, 'auprc': 0.7394071193740102, 'loss_val': 1.130092949586499, 'psi': 0.38792994957728033}
[S15] START round=10 head_norm_before_train=1.173939 cos_to_last_merge=0.9447 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=10 local utility u=0.103027 metrics={'f1_val': 0.701588966402071, 'auprc': 0.7994177084655498, 'loss_val': 0.5695305259404094, 'psi': 0.7407204632274625}-{'f1_val': 0.6843718578776058, 'auprc': 0.799418050029884, 'loss_val': 0.6722831625194138, 'psi': 0.7303903347385171}
[S16] START round=10 head_norm_before_train=1.017236 cos_to_last_merge=0.8892 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.889
[S16] round=10 local utility u=0.103502 metrics={'f1_val': 0.4364669236207885, 'auprc': 0.6927074912309308, 'loss_val': 0.7843258543682126, 'psi': 0.5389631506648453}-{'f1_val': 0.4271800950816408, 'auprc': 0.6523055130499805, 'loss_val': 0.814403053644252, 'psi': 0.5172302622689766}
[S17] START round=10 head_norm_before_train=1.499641 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3520371884697376, 'auprc': 0.807121184396222, 'loss_val': 0.9337165913060207, 'psi': 0.5340707868403314}-{'f1_val': 0.3532160952819635, 'auprc': 0.7976141502455347, 'loss_val': 0.9023600570412093, 'psi': 0.530975317267392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38507
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0616
[S11] DROPPED delta from S4 (cos=-0.0616 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.2327
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=0.9394
[S7] RECEIVED delta(kind=head bytes=1790) from S8
[S7] cosine check vs S8: cos=0.9513
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=0.8938
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.2261
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] cosine check vs S14: cos=0.4873
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.0099
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.0263
[S16] DROPPED delta from S5 (cos=-0.0263 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.0194
[S5] DROPPED delta from S10 (cos=-0.0194 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] cosine check vs S2: cos=0.7329
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=0.9762
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.7417
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4158 head_norm=1.046939
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.152708e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4158 head_norm=1.047774 delta_norm=0.115271
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.228 → S4@127.0.0.1:38504
[S8] ⇄ pheromone p=0.370 → S7@127.0.0.1:38508
[S4] ⇄ pheromone p=0.168 → S11@127.0.0.1:38512
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6922 head_norm=0.837432
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.602559e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3966 head_norm=0.797978 delta_norm=0.260256
[S14] aggregate: ROLLBACK (f1_val pre=0.692 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.391 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.409 → S5@127.0.0.1:38505
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7006 head_norm=0.821885
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.123050e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7006 head_norm=0.743727 delta_norm=0.212305
[S5] aggregate: ACCEPT kept=['S14', 'S3', 'S2', 'S15'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.374 → S16@127.0.0.1:38516
[S13] ⇄ pheromone p=0.444 → S9@127.0.0.1:38510
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6331 head_norm=1.120584
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.818514e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6433 head_norm=1.136326 delta_norm=0.181851
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.336 → S14@127.0.0.1:38514
[S2] ⇄ pheromone p=0.361 → S5@127.0.0.1:38505
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9971 head_norm=1.236997
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.446724e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9971 head_norm=1.086849 delta_norm=0.344672
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.404 → S14@127.0.0.1:38514
[S3] ⇄ pheromone p=0.455 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.429 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.268 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.183 → S9@127.0.0.1:38510
[S15] ⇄ pheromone p=0.292 → S5@127.0.0.1:38505
[S2] START round=11 head_norm_before_train=1.154314 cos_to_last_merge=0.9278 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7000472919661002, 'auprc': 0.6641922257940258, 'loss_val': 0.610022408178028, 'psi': 0.6857052654972704}-{'f1_val': 0.6776880047204208, 'auprc': 0.7773035520009188, 'loss_val': 0.7239169375388882, 'psi': 0.7175342236326201}
[S3] START round=11 head_norm_before_train=1.761314 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.9737565819597069, 'auprc': 0.9984993701568123, 'loss_val': 0.1204542901482484, 'psi': 0.9836536972385491}-{'f1_val': 0.9927752496305641, 'auprc': 0.998689917962732, 'loss_val': 0.13812732956733276, 'psi': 0.9951411169634312}
[S4] START round=11 head_norm_before_train=0.978908 cos_to_last_merge=0.9937 (last merge round=9)
[S4] round=11 local utility u=0.026052 metrics={'f1_val': 0.37455608020486425, 'auprc': 0.7576131570015061, 'loss_val': 0.7218270741008005, 'psi': 0.527778910923521}-{'f1_val': 0.3725014115484226, 'auprc': 0.7639877504956863, 'loss_val': 0.780726296166972, 'psi': 0.5290959471273281}
[S5] START round=11 head_norm_before_train=0.743727 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7560860777318814, 'loss_val': 0.5793369530564066, 'psi': 0.722626790187568}-{'f1_val': 0.7005691551769304, 'auprc': 0.8561035938509325, 'loss_val': 0.6021252599526725, 'psi': 0.7627829306465312}
[S6] START round=11 head_norm_before_train=1.047774 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.6951507326076964, 'auprc': 0.965117947089891, 'loss_val': 0.512535157911508, 'psi': 0.8031376184005743}-{'f1_val': 0.4158432846376109, 'auprc': 0.781474042836315, 'loss_val': 0.6734476904040965, 'psi': 0.5620955879170926}
[S7] START round=11 head_norm_before_train=1.136326 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5506145559978106, 'auprc': 0.7833423031713975, 'loss_val': 0.8258339733520239, 'psi': 0.6437056548672454}-{'f1_val': 0.6330769838720496, 'auprc': 0.8152419404811908, 'loss_val': 0.6749242116438956, 'psi': 0.7059429665157061}
[S8] START round=11 head_norm_before_train=1.180214 cos_to_last_merge=0.9054 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.905
[S8] round=11 local utility u=0.112433 metrics={'f1_val': 0.7135030164876403, 'auprc': 0.8096998668544464, 'loss_val': 0.40039479579174797, 'psi': 0.7519817566343627}-{'f1_val': 0.7139808238386206, 'auprc': 0.7931763091120676, 'loss_val': 0.5785578513776681, 'psi': 0.7456590179479994}
[S9] START round=11 head_norm_before_train=1.086849 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.998204133085115, 'loss_val': 0.16740147434543795, 'psi': 0.9966449200309462}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987942406608308, 'loss_val': 0.15585054845480698, 'psi': 0.997779443771618}
[S10] START round=11 head_norm_before_train=1.449958 (no previous merge yet)
[S10] round=11 local utility u=0.189176 metrics={'f1_val': 0.6152025475161722, 'auprc': 0.9786464154760177, 'loss_val': 0.4646419186673977, 'psi': 0.7605800947001105}-{'f1_val': 0.605783792329088, 'auprc': 0.8972456954362308, 'loss_val': 0.5422784658697288, 'psi': 0.7223685535719451}
[S11] START round=11 head_norm_before_train=1.473294 (no previous merge yet)
[S11] round=11 local utility u=0.032991 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.998673401319102, 'loss_val': 0.37739508668511007, 'psi': 0.8207092585946048}-{'f1_val': 0.701890640953942, 'auprc': 0.9981884085368943, 'loss_val': 0.4408677568327007, 'psi': 0.820409747987123}
[S13] START round=11 head_norm_before_train=1.434361 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6168892448608001, 'auprc': 0.7258120263973308, 'loss_val': 0.7026891715158138, 'psi': 0.6604583574754124}-{'f1_val': 0.7135150731518334, 'auprc': 0.7622971485403375, 'loss_val': 0.6847819949275865, 'psi': 0.733027903307235}
[S14] START round=11 head_norm_before_train=0.797978 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.119838 metrics={'f1_val': 0.6810831851690151, 'auprc': 0.9906786729371893, 'loss_val': 0.8914896172036701, 'psi': 0.8049213802762848}-{'f1_val': 0.6922370269115006, 'auprc': 0.9267527253830111, 'loss_val': 1.006310209872048, 'psi': 0.7860433063001048}
[S15] START round=11 head_norm_before_train=1.216075 cos_to_last_merge=0.9309 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=11 local utility u=0.043488 metrics={'f1_val': 0.6995598666775965, 'auprc': 0.7994514966550712, 'loss_val': 0.4704822875463579, 'psi': 0.7395165186685864}-{'f1_val': 0.701588966402071, 'auprc': 0.7994177084655498, 'loss_val': 0.5695305259404094, 'psi': 0.7407204632274625}
[S16] START round=11 head_norm_before_train=1.061205 cos_to_last_merge=0.8710 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4017002078256367, 'auprc': 0.7391644357705959, 'loss_val': 0.7566985518152581, 'psi': 0.5366858990036204}-{'f1_val': 0.4364669236207885, 'auprc': 0.6927074912309308, 'loss_val': 0.7843258543682126, 'psi': 0.5389631506648453}
[S17] START round=11 head_norm_before_train=1.517432 (no previous merge yet)
[S17] round=11 local utility u=0.033635 metrics={'f1_val': 0.35357838737504155, 'auprc': 0.8187109125376559, 'loss_val': 0.9104626696430705, 'psi': 0.5396313974400873}-{'f1_val': 0.3520371884697376, 'auprc': 0.807121184396222, 'loss_val': 0.9337165913060207, 'psi': 0.5340707868403314}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:38512
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9748
[S5] RECEIVED delta(kind=head bytes=1794) from S14
[S5] cosine check vs S14: cos=0.5627
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] cosine check vs S6: cos=0.9230
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.0454
[S5] DROPPED delta from S10 (cos=-0.0454 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.7632
[S11] RECEIVED delta(kind=head bytes=1790) from S4
[S11] cosine check vs S4: cos=-0.0555
[S11] DROPPED delta from S4 (cos=-0.0555 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.8683
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.1444
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9956 head_norm=1.163769
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.495808e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9956 head_norm=1.046440 delta_norm=0.449581
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.5506 head_norm=1.169597
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.387854e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.5536 head_norm=1.194514 delta_norm=0.138785
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.3746 head_norm=1.038202
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.103323e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.3745 head_norm=1.043523 delta_norm=0.210332
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7003 head_norm=0.826148
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.545731e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7003 head_norm=0.809894 delta_norm=0.254573
[S5] aggregate: ACCEPT kept=['S14', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.205020 cos_to_last_merge=0.9132 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=12 local utility u=0.181157 metrics={'f1_val': 0.7009310269642833, 'auprc': 0.7490996436394937, 'loss_val': 0.507732077199226, 'psi': 0.7201984736343674}-{'f1_val': 0.7000472919661002, 'auprc': 0.6641922257940258, 'loss_val': 0.610022408178028, 'psi': 0.6857052654972704}
[S3] START round=12 head_norm_before_train=1.799276 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9753279793549594, 'loss_val': 0.25774333753726925, 'psi': 0.8105397675411846}-{'f1_val': 0.9737565819597069, 'auprc': 0.9984993701568123, 'loss_val': 0.1204542901482484, 'psi': 0.9836536972385491}
[S4] START round=12 head_norm_before_train=1.043523 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.298777 metrics={'f1_val': 0.3757327047560122, 'auprc': 0.941806362360116, 'loss_val': 0.6839120326849684, 'psi': 0.6021621677976537}-{'f1_val': 0.37455608020486425, 'auprc': 0.7576131570015061, 'loss_val': 0.7218270741008005, 'psi': 0.527778910923521}
[S5] START round=12 head_norm_before_train=0.809894 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.687143106390802, 'auprc': 0.7284149803013619, 'loss_val': 0.5858282808246185, 'psi': 0.703651855955026}-{'f1_val': 0.700320598491359, 'auprc': 0.7560860777318814, 'loss_val': 0.5793369530564066, 'psi': 0.722626790187568}
[S6] START round=12 head_norm_before_train=1.090182 cos_to_last_merge=0.9969 (last merge round=10)
[S6] round=12 local utility u=0.073111 metrics={'f1_val': 0.7077380463841179, 'auprc': 0.9661103375558566, 'loss_val': 0.44481444236136974, 'psi': 0.8110869628528133}-{'f1_val': 0.6951507326076964, 'auprc': 0.965117947089891, 'loss_val': 0.512535157911508, 'psi': 0.8031376184005743}
[S7] START round=12 head_norm_before_train=1.194514 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.209014 metrics={'f1_val': 0.5995147166653966, 'auprc': 0.7963997267213045, 'loss_val': 0.7403800578497725, 'psi': 0.6782687206877598}-{'f1_val': 0.5506145559978106, 'auprc': 0.7833423031713975, 'loss_val': 0.8258339733520239, 'psi': 0.6437056548672454}
[S8] START round=12 head_norm_before_train=1.234623 cos_to_last_merge=0.8875 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.888
[S8] round=12 local utility u=0.316801 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9927735110402381, 'loss_val': 0.31793366040833143, 'psi': 0.8254031714064514}-{'f1_val': 0.7135030164876403, 'auprc': 0.8096998668544464, 'loss_val': 0.40039479579174797, 'psi': 0.7519817566343627}
[S9] START round=12 head_norm_before_train=1.046440 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000763 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9951602427227646, 'loss_val': 0.16396569941232653, 'psi': 0.996149477535734}-{'f1_val': 0.9956054446615002, 'auprc': 0.998204133085115, 'loss_val': 0.16740147434543795, 'psi': 0.9966449200309462}
[S10] START round=12 head_norm_before_train=1.499042 (no previous merge yet)
[S10] round=12 local utility u=0.375381 metrics={'f1_val': 0.6996093488975941, 'auprc': 0.9933019267613514, 'loss_val': 0.2642872100949922, 'psi': 0.817086380043097}-{'f1_val': 0.6152025475161722, 'auprc': 0.9786464154760177, 'loss_val': 0.4646419186673977, 'psi': 0.7605800947001105}
[S11] START round=12 head_norm_before_train=1.512142 (no previous merge yet)
[S11] round=12 local utility u=0.046969 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997996030019525, 'loss_val': 0.27918683470953853, 'psi': 0.820214499759965}-{'f1_val': 0.7020664967782734, 'auprc': 0.998673401319102, 'loss_val': 0.37739508668511007, 'psi': 0.8207092585946048}
[S13] START round=12 head_norm_before_train=1.470665 (no previous merge yet)
[S13] round=12 local utility u=0.418103 metrics={'f1_val': 0.7121045034741973, 'auprc': 0.7424657752603387, 'loss_val': 0.48773590659285815, 'psi': 0.7242490121886539}-{'f1_val': 0.6168892448608001, 'auprc': 0.7258120263973308, 'loss_val': 0.7026891715158138, 'psi': 0.6604583574754124}
[S14] START round=12 head_norm_before_train=0.833163 cos_to_last_merge=0.9951 (last merge round=10)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.995347936660649, 'loss_val': 0.7626016011091492, 'psi': 0.6360953366930169}-{'f1_val': 0.6810831851690151, 'auprc': 0.9906786729371893, 'loss_val': 0.8914896172036701, 'psi': 0.8049213802762848}
[S15] START round=12 head_norm_before_train=1.260653 cos_to_last_merge=0.9167 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=12 local utility u=0.014374 metrics={'f1_val': 0.7009621312698922, 'auprc': 0.7995068744688398, 'loss_val': 0.4503148845089758, 'psi': 0.7403800285494713}-{'f1_val': 0.6995598666775965, 'auprc': 0.7994514966550712, 'loss_val': 0.4704822875463579, 'psi': 0.7395165186685864}
[S16] START round=12 head_norm_before_train=1.106586 cos_to_last_merge=0.8527 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.853
[S16] round=12 local utility u=0.130921 metrics={'f1_val': 0.43392263725770086, 'auprc': 0.7563762967302983, 'loss_val': 0.739826478428173, 'psi': 0.5629041010467399}-{'f1_val': 0.4017002078256367, 'auprc': 0.7391644357705959, 'loss_val': 0.7566985518152581, 'psi': 0.5366858990036204}
[S17] START round=12 head_norm_before_train=1.533834 (no previous merge yet)
[S17] round=12 local utility u=0.020525 metrics={'f1_val': 0.3570496175550628, 'auprc': 0.8191124948271042, 'loss_val': 0.891445547657126, 'psi': 0.5418747684638794}-{'f1_val': 0.35357838737504155, 'auprc': 0.8187109125376559, 'loss_val': 0.9104626696430705, 'psi': 0.5396313974400873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:38505
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.9836
[S5] RECEIVED delta(kind=head bytes=1806) from S2
[S5] cosine check vs S2: cos=0.5508
[S14] RECEIVED delta(kind=head bytes=1805) from S9
[S14] cosine check vs S9: cos=0.8146
[S11] RECEIVED delta(kind=head bytes=1791) from S4
[S11] cosine check vs S4: cos=-0.0506
[S11] DROPPED delta from S4 (cos=-0.0506 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.0327
[S5] DROPPED delta from S10 (cos=-0.0327 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.9657
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.8619
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.9586
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] cosine check vs S15: cos=0.8307
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.2735
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.4277
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.4527
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.6871 head_norm=0.879227
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.093773e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=0.935815 delta_norm=0.309377
[S5] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3966 head_norm=0.877919
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.234277e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3966 head_norm=0.825763 delta_norm=0.223428
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.3757 head_norm=1.089954
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.471315e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.3755 head_norm=1.102120 delta_norm=0.147131
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.5995 head_norm=1.227683
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.181526e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6050 head_norm=1.253626 delta_norm=0.118153
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9968 head_norm=1.122649
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.716037e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9968 head_norm=0.993657 delta_norm=0.271604
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7077 head_norm=1.133417
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.651388e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7077 head_norm=1.132788 delta_norm=0.165139
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.250444 cos_to_last_merge=0.9002 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=13 local utility u=0.102051 metrics={'f1_val': 0.700852847654986, 'auprc': 0.793627544699232, 'loss_val': 0.43674371034992415, 'psi': 0.7379627264726845}-{'f1_val': 0.7009310269642833, 'auprc': 0.7490996436394937, 'loss_val': 0.507732077199226, 'psi': 0.7201984736343674}
[S3] START round=13 head_norm_before_train=1.837159 (no previous merge yet)
[S3] round=13 local utility u=0.969558 metrics={'f1_val': 0.9852910375018197, 'auprc': 0.9986804075009313, 'loss_val': 0.09634516656167835, 'psi': 0.9906467855014643}-{'f1_val': 0.7006809596653347, 'auprc': 0.9753279793549594, 'loss_val': 0.25774333753726925, 'psi': 0.8105397675411846}
[S4] START round=13 head_norm_before_train=1.102120 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.40753277256407944, 'auprc': 0.8593178220857063, 'loss_val': 0.6377453755234109, 'psi': 0.5882467923727301}-{'f1_val': 0.3757327047560122, 'auprc': 0.941806362360116, 'loss_val': 0.6839120326849684, 'psi': 0.6021621677976537}
[S5] START round=13 head_norm_before_train=0.935815 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.460632 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9639279781065706, 'loss_val': 0.4501690155812068, 'psi': 0.8057635503374436}-{'f1_val': 0.687143106390802, 'auprc': 0.7284149803013619, 'loss_val': 0.5858282808246185, 'psi': 0.703651855955026}
[S6] START round=13 head_norm_before_train=1.132788 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.697756971841613, 'auprc': 0.9590903957620174, 'loss_val': 0.439685490858168, 'psi': 0.8022903414097747}-{'f1_val': 0.7077380463841179, 'auprc': 0.9661103375558566, 'loss_val': 0.44481444236136974, 'psi': 0.8110869628528133}
[S7] START round=13 head_norm_before_train=1.253626 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.673562 metrics={'f1_val': 0.6978298660659159, 'auprc': 0.9495887848845391, 'loss_val': 0.4427139947970897, 'psi': 0.7985334335933651}-{'f1_val': 0.5995147166653966, 'auprc': 0.7963997267213045, 'loss_val': 0.7403800578497725, 'psi': 0.6782687206877598}
[S8] START round=13 head_norm_before_train=1.289912 cos_to_last_merge=0.8704 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=13 local utility u=0.721148 metrics={'f1_val': 0.9410002161063126, 'auprc': 0.9963504237797292, 'loss_val': 0.2494315791165126, 'psi': 0.9631402991756792}-{'f1_val': 0.7138229449839267, 'auprc': 0.9927735110402381, 'loss_val': 0.31793366040833143, 'psi': 0.8254031714064514}
[S9] START round=13 head_norm_before_train=0.993657 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.001284 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9980731530643565, 'loss_val': 0.16791483809240867, 'psi': 0.9970925539525144}-{'f1_val': 0.996808967411047, 'auprc': 0.9951602427227646, 'loss_val': 0.16396569941232653, 'psi': 0.996149477535734}
[S10] START round=13 head_norm_before_train=1.542454 (no previous merge yet)
[S10] round=13 local utility u=0.026685 metrics={'f1_val': 0.7009272502454333, 'auprc': 0.9959485867232191, 'loss_val': 0.22676480221050554, 'psi': 0.8189357848365477}-{'f1_val': 0.6996093488975941, 'auprc': 0.9933019267613514, 'loss_val': 0.2642872100949922, 'psi': 0.817086380043097}
[S11] START round=13 head_norm_before_train=1.556064 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.65600568122135, 'auprc': 0.9984347980767855, 'loss_val': 0.3303878745540906, 'psi': 0.7929773279635242}-{'f1_val': 0.7016934795869249, 'auprc': 0.997996030019525, 'loss_val': 0.27918683470953853, 'psi': 0.820214499759965}
[S13] START round=13 head_norm_before_train=1.504233 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6893127212007621, 'auprc': 0.7404751781228631, 'loss_val': 0.5599505581997783, 'psi': 0.7097777039696025}-{'f1_val': 0.7121045034741973, 'auprc': 0.7424657752603387, 'loss_val': 0.48773590659285815, 'psi': 0.7242490121886539}
[S14] START round=13 head_norm_before_train=0.825763 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.3960490692696715, 'auprc': 0.9929633013973196, 'loss_val': 0.7632287649835294, 'psi': 0.6348147621207307}-{'f1_val': 0.39659360338126215, 'auprc': 0.995347936660649, 'loss_val': 0.7626016011091492, 'psi': 0.6360953366930169}
[S15] START round=13 head_norm_before_train=1.306896 cos_to_last_merge=0.9029 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=13 local utility u=0.137573 metrics={'f1_val': 0.7015486852681293, 'auprc': 0.8550256048910956, 'loss_val': 0.3452442707365488, 'psi': 0.7629394531173158}-{'f1_val': 0.7009621312698922, 'auprc': 0.7995068744688398, 'loss_val': 0.4503148845089758, 'psi': 0.7403800285494713}
[S16] START round=13 head_norm_before_train=1.155995 cos_to_last_merge=0.8361 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4137147228302004, 'auprc': 0.7526169305316305, 'loss_val': 0.7229226851310122, 'psi': 0.5492756059107724}-{'f1_val': 0.43392263725770086, 'auprc': 0.7563762967302983, 'loss_val': 0.739826478428173, 'psi': 0.5629041010467399}
[S17] START round=13 head_norm_before_train=1.550026 (no previous merge yet)
[S17] round=13 local utility u=0.070322 metrics={'f1_val': 0.3773447565395126, 'auprc': 0.8268945956795253, 'loss_val': 0.8959177836021165, 'psi': 0.5571646921955177}-{'f1_val': 0.3570496175550628, 'auprc': 0.8191124948271042, 'loss_val': 0.891445547657126, 'psi': 0.5418747684638794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38507
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:38513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S9] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0113
[S13] DROPPED delta from S10 (cos=-0.0113 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.9888
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.8500
[S6] RECEIVED delta(kind=head bytes=1805) from S9
[S6] cosine check vs S9: cos=-0.0756
[S6] DROPPED delta from S9 (cos=-0.0756 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=0.0538
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.5259
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9410 head_norm=1.333327
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.012851e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7010 head_norm=1.303100 delta_norm=0.101285
[S8] aggregate: ROLLBACK (f1_val pre=0.941 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.9853 head_norm=1.874182
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.039486e+00
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.9651 head_norm=1.087204 delta_norm=1.039486
[S3] aggregate: ROLLBACK (f1_val pre=0.985 post=0.965 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9964 head_norm=1.078848
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.768408e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9969 head_norm=1.159585 delta_norm=0.676841
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7003 head_norm=1.006244
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.631325e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7003 head_norm=1.134872 delta_norm=0.363133
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.300037 cos_to_last_merge=0.8876 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.6660374763697544, 'loss_val': 0.3850334798909943, 'psi': 0.6861678039691976}-{'f1_val': 0.700852847654986, 'auprc': 0.793627544699232, 'loss_val': 0.43674371034992415, 'psi': 0.7379627264726845}
[S3] START round=14 head_norm_before_train=1.087204 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.9803991070431209, 'auprc': 0.9986792503714348, 'loss_val': 0.17239275310070135, 'psi': 0.9877111643744465}-{'f1_val': 0.9852910375018197, 'auprc': 0.9986804075009313, 'loss_val': 0.09634516656167835, 'psi': 0.9906467855014643}
[S4] START round=14 head_norm_before_train=1.150937 cos_to_last_merge=0.9973 (last merge round=12)
[S4] round=14 local utility u=0.493136 metrics={'f1_val': 0.6617831716158162, 'auprc': 0.6600832747710798, 'loss_val': 0.5792721290569777, 'psi': 0.6611032128779217}-{'f1_val': 0.40753277256407944, 'auprc': 0.8593178220857063, 'loss_val': 0.6377453755234109, 'psi': 0.5882467923727301}
[S5] START round=14 head_norm_before_train=1.134872 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6942971329876401, 'auprc': 0.7841070302182691, 'loss_val': 0.4603865800927497, 'psi': 0.7302210918798917}-{'f1_val': 0.700320598491359, 'auprc': 0.9639279781065706, 'loss_val': 0.4501690155812068, 'psi': 0.8057635503374436}
[S6] START round=14 head_norm_before_train=1.168124 cos_to_last_merge=0.9988 (last merge round=12)
[S6] round=14 local utility u=0.048990 metrics={'f1_val': 0.7074444286310667, 'auprc': 0.9594888934769906, 'loss_val': 0.40102575753414105, 'psi': 0.8082622145694363}-{'f1_val': 0.697756971841613, 'auprc': 0.9590903957620174, 'loss_val': 0.439685490858168, 'psi': 0.8022903414097747}
[S7] START round=14 head_norm_before_train=1.280194 cos_to_last_merge=0.9985 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4087145175109961, 'auprc': 0.7574894294555343, 'loss_val': 1.0178703737337522, 'psi': 0.5482244822888114}-{'f1_val': 0.6978298660659159, 'auprc': 0.9495887848845391, 'loss_val': 0.4427139947970897, 'psi': 0.7985334335933651}
[S8] START round=14 head_norm_before_train=1.303100 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7031332160908192, 'auprc': 0.9918446383130394, 'loss_val': 0.2378047855566627, 'psi': 0.8186177849797074}-{'f1_val': 0.9410002161063126, 'auprc': 0.9963504237797292, 'loss_val': 0.2494315791165126, 'psi': 0.9631402991756792}
[S9] START round=14 head_norm_before_train=1.159585 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9955598144693145, 'loss_val': 0.21596778058962693, 'psi': 0.996309306234354}-{'f1_val': 0.9964388212112862, 'auprc': 0.9980731530643565, 'loss_val': 0.16791483809240867, 'psi': 0.9970925539525144}
[S10] START round=14 head_norm_before_train=1.573699 (no previous merge yet)
[S10] round=14 local utility u=0.775843 metrics={'f1_val': 0.957532816886097, 'auprc': 0.9971112791967865, 'loss_val': 0.2181995388122247, 'psi': 0.9733642018103728}-{'f1_val': 0.7009272502454333, 'auprc': 0.9959485867232191, 'loss_val': 0.22676480221050554, 'psi': 0.8189357848365477}
[S11] START round=14 head_norm_before_train=1.598220 (no previous merge yet)
[S11] round=14 local utility u=0.958508 metrics={'f1_val': 0.9547246252056056, 'auprc': 0.9980003145246039, 'loss_val': 0.2043828061186818, 'psi': 0.972034900933205}-{'f1_val': 0.65600568122135, 'auprc': 0.9984347980767855, 'loss_val': 0.3303878745540906, 'psi': 0.7929773279635242}
[S13] START round=14 head_norm_before_train=1.532439 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6342325226310296, 'auprc': 0.7432170735842685, 'loss_val': 0.5066003761968079, 'psi': 0.6778263430123251}-{'f1_val': 0.6893127212007621, 'auprc': 0.7404751781228631, 'loss_val': 0.5599505581997783, 'psi': 0.7097777039696025}
[S14] START round=14 head_norm_before_train=0.862181 cos_to_last_merge=0.9969 (last merge round=12)
[S14] round=14 local utility u=0.051851 metrics={'f1_val': 0.3960490692696715, 'auprc': 0.9950625220622045, 'loss_val': 0.6658245191615305, 'psi': 0.6356544503866847}-{'f1_val': 0.3960490692696715, 'auprc': 0.9929633013973196, 'loss_val': 0.7632287649835294, 'psi': 0.6348147621207307}
[S15] START round=14 head_norm_before_train=1.351692 cos_to_last_merge=0.8909 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7013105282640891, 'auprc': 0.8109064747099586, 'loss_val': 0.36379422470262857, 'psi': 0.745148906842437}-{'f1_val': 0.7015486852681293, 'auprc': 0.8550256048910956, 'loss_val': 0.3452442707365488, 'psi': 0.7629394531173158}
[S16] START round=14 head_norm_before_train=1.206590 cos_to_last_merge=0.8205 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=14 local utility u=0.304831 metrics={'f1_val': 0.48534372827954486, 'auprc': 0.7851706081575986, 'loss_val': 0.6406959503153186, 'psi': 0.6052744802307664}-{'f1_val': 0.4137147228302004, 'auprc': 0.7526169305316305, 'loss_val': 0.7229226851310122, 'psi': 0.5492756059107724}
[S17] START round=14 head_norm_before_train=1.562559 (no previous merge yet)
[S17] round=14 local utility u=0.486098 metrics={'f1_val': 0.5433551161107342, 'auprc': 0.8246495385402584, 'loss_val': 0.9130487603323019, 'psi': 0.6558728850825439}-{'f1_val': 0.3773447565395126, 'auprc': 0.8268945956795253, 'loss_val': 0.8959177836021165, 'psi': 0.5571646921955177}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38516
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38504
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=-0.0479
[S4] DROPPED delta from S11 (cos=-0.0479 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.9618
[S9] RECEIVED delta(kind=head bytes=1793) from S14
[S9] cosine check vs S14: cos=0.5556
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.0099
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S4
[S6] cosine check vs S4: cos=0.9647
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6943 head_norm=1.193093
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.612334e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.6411 head_norm=0.869800 delta_norm=0.861233
[S5] aggregate: ROLLBACK (f1_val pre=0.694 post=0.641 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9968 head_norm=1.229444
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.230297e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9971 head_norm=0.944289 delta_norm=0.523030
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7074 head_norm=1.201834
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.600785e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7074 head_norm=1.194771 delta_norm=0.160079
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4853 head_norm=1.254225
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.716431e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4771 head_norm=1.216257 delta_norm=0.171643
[S16] aggregate: ROLLBACK (f1_val pre=0.485 post=0.477 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.348310 cos_to_last_merge=0.8759 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.876
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6898458713204223, 'auprc': 0.6681809200741636, 'loss_val': 0.35622882551039226, 'psi': 0.6811798908219189}-{'f1_val': 0.6995880223688264, 'auprc': 0.6660374763697544, 'loss_val': 0.3850334798909943, 'psi': 0.6861678039691976}
[S3] START round=15 head_norm_before_train=1.178577 cos_to_last_merge=0.9959 (last merge round=13)
[S3] round=15 local utility u=0.089949 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9984728830286572, 'loss_val': 0.09617022274613153, 'psi': 0.9980580510384214}-{'f1_val': 0.9803991070431209, 'auprc': 0.9986792503714348, 'loss_val': 0.17239275310070135, 'psi': 0.9877111643744465}
[S4] START round=15 head_norm_before_train=1.209048 cos_to_last_merge=0.9904 (last merge round=12)
[S4] round=15 local utility u=0.176429 metrics={'f1_val': 0.6189063134260857, 'auprc': 0.8593452289230574, 'loss_val': 0.5669388231802651, 'psi': 0.7150818796248744}-{'f1_val': 0.6617831716158162, 'auprc': 0.6600832747710798, 'loss_val': 0.5792721290569777, 'psi': 0.6611032128779217}
[S5] START round=15 head_norm_before_train=0.869800 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.6755105653025362, 'auprc': 0.7726290530734078, 'loss_val': 0.5363316913290983, 'psi': 0.7143579604108848}-{'f1_val': 0.6942971329876401, 'auprc': 0.7841070302182691, 'loss_val': 0.4603865800927497, 'psi': 0.7302210918798917}
[S6] START round=15 head_norm_before_train=1.194771 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7065197602978587, 'auprc': 0.8666777795952254, 'loss_val': 0.41985301289440413, 'psi': 0.7705829680168054}-{'f1_val': 0.7074444286310667, 'auprc': 0.9594888934769906, 'loss_val': 0.40102575753414105, 'psi': 0.8082622145694363}
[S7] START round=15 head_norm_before_train=1.300573 cos_to_last_merge=0.9964 (last merge round=12)
[S7] round=15 local utility u=0.162418 metrics={'f1_val': 0.4449379675098013, 'auprc': 0.7767548791477261, 'loss_val': 0.9681712069790058, 'psi': 0.5776647321649713}-{'f1_val': 0.4087145175109961, 'auprc': 0.7574894294555343, 'loss_val': 1.0178703737337522, 'psi': 0.5482244822888114}
[S8] START round=15 head_norm_before_train=1.332619 cos_to_last_merge=0.9996 (last merge round=13)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7941350562394051, 'loss_val': 0.494317462611151, 'psi': 0.7460642512800306}-{'f1_val': 0.7031332160908192, 'auprc': 0.9918446383130394, 'loss_val': 0.2378047855566627, 'psi': 0.8186177849797074}
[S9] START round=15 head_norm_before_train=0.944289 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.026620 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947310937507171, 'loss_val': 0.15954206333444015, 'psi': 0.9959079322591442}-{'f1_val': 0.996808967411047, 'auprc': 0.9955598144693145, 'loss_val': 0.21596778058962693, 'psi': 0.996309306234354}
[S10] START round=15 head_norm_before_train=1.603177 (no previous merge yet)
[S10] round=15 local utility u=0.120188 metrics={'f1_val': 0.9960201290336115, 'auprc': 0.9968690706088046, 'loss_val': 0.20802114062944005, 'psi': 0.9963597056636887}-{'f1_val': 0.957532816886097, 'auprc': 0.9971112791967865, 'loss_val': 0.2181995388122247, 'psi': 0.9733642018103728}
[S11] START round=15 head_norm_before_train=1.629990 (no previous merge yet)
[S11] round=15 local utility u=0.026079 metrics={'f1_val': 0.9578276111022713, 'auprc': 0.9980773488086516, 'loss_val': 0.17107321046704124, 'psi': 0.9739275061848235}-{'f1_val': 0.9547246252056056, 'auprc': 0.9980003145246039, 'loss_val': 0.2043828061186818, 'psi': 0.972034900933205}
[S13] START round=15 head_norm_before_train=1.555064 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6333080685823499, 'auprc': 0.7080742129041018, 'loss_val': 0.5003802979637499, 'psi': 0.6632145263110507}-{'f1_val': 0.6342325226310296, 'auprc': 0.7432170735842685, 'loss_val': 0.5066003761968079, 'psi': 0.6778263430123251}
[S14] START round=15 head_norm_before_train=0.904960 cos_to_last_merge=0.9897 (last merge round=12)
[S14] round=15 local utility u=0.592742 metrics={'f1_val': 0.576830233324001, 'auprc': 0.9961751172753892, 'loss_val': 0.5683656495748656, 'psi': 0.7445681869045563}-{'f1_val': 0.3960490692696715, 'auprc': 0.9950625220622045, 'loss_val': 0.6658245191615305, 'psi': 0.6356544503866847}
[S15] START round=15 head_norm_before_train=1.392796 cos_to_last_merge=0.8801 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=15 local utility u=0.036522 metrics={'f1_val': 0.7009613975403449, 'auprc': 0.8293463861127471, 'loss_val': 0.3439759405576138, 'psi': 0.7523153929693058}-{'f1_val': 0.7013105282640891, 'auprc': 0.8109064747099586, 'loss_val': 0.36379422470262857, 'psi': 0.745148906842437}
[S16] START round=15 head_norm_before_train=1.216257 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.445431 metrics={'f1_val': 0.5763200424129666, 'auprc': 0.8712306745083774, 'loss_val': 0.5538718085521309, 'psi': 0.694284295251131}-{'f1_val': 0.48534372827954486, 'auprc': 0.7851706081575986, 'loss_val': 0.6406959503153186, 'psi': 0.6052744802307664}
[S17] START round=15 head_norm_before_train=1.573572 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3438455268422106, 'auprc': 0.8086827145377368, 'loss_val': 0.9978447999567612, 'psi': 0.5297804019204211}-{'f1_val': 0.5433551161107342, 'auprc': 0.8246495385402584, 'loss_val': 0.9130487603323019, 'psi': 0.6558728850825439}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:38513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S4
[S6] cosine check vs S4: cos=0.9839
[S13] RECEIVED delta(kind=head bytes=1804) from S9
[S13] cosine check vs S9: cos=0.2678
[S9] RECEIVED delta(kind=head bytes=1797) from S14
[S9] cosine check vs S14: cos=0.8404
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=-0.0512
[S4] DROPPED delta from S11 (cos=-0.0512 < 0.0)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.6641
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=0.9884
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7140 head_norm=1.356330
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.037029e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7140 head_norm=1.333971 delta_norm=0.103703
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6333 head_norm=1.574556
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.181225e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6296 head_norm=1.051541 delta_norm=0.818123
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.6755 head_norm=0.938440
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.738179e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.6447 head_norm=1.004975 delta_norm=0.473818
[S5] aggregate: ROLLBACK (f1_val pre=0.676 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.182 → S3@127.0.0.1:38503
[S7] ⇄ pheromone p=0.250 → S8@127.0.0.1:38509
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9967 head_norm=1.034843
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.830968e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9967 head_norm=0.950975 delta_norm=0.283097
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.138 → S13@127.0.0.1:38513
[S4] ⇄ pheromone p=0.202 → S6@127.0.0.1:38507
[S11] ⇄ pheromone p=0.307 → S4@127.0.0.1:38504
[S14] ⇄ pheromone p=0.265 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.239 → S5@127.0.0.1:38505
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7065 head_norm=1.225401
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.132668e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7065 head_norm=1.239417 delta_norm=0.113267
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.172 → S16@127.0.0.1:38516
[S2] START round=16 head_norm_before_train=1.393273 cos_to_last_merge=0.8652 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=16 local utility u=0.053911 metrics={'f1_val': 0.7010299569678582, 'auprc': 0.6641440902681738, 'loss_val': 0.3034013170283561, 'psi': 0.6862756102879843}-{'f1_val': 0.6898458713204223, 'auprc': 0.6681809200741636, 'loss_val': 0.35622882551039226, 'psi': 0.6811798908219189}
[S3] START round=16 head_norm_before_train=1.295285 cos_to_last_merge=0.9852 (last merge round=13)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9984993260007338, 'loss_val': 0.11436733321662605, 'psi': 0.9760208810635597}-{'f1_val': 0.9977814963782642, 'auprc': 0.9984728830286572, 'loss_val': 0.09617022274613153, 'psi': 0.9980580510384214}
[S4] START round=16 head_norm_before_train=1.263472 cos_to_last_merge=0.9830 (last merge round=12)
[S4] round=16 local utility u=1.000000 metrics={'f1_val': 0.9446885014312817, 'auprc': 0.8700236435130572, 'loss_val': 0.5095725712362318, 'psi': 0.914822558263992}-{'f1_val': 0.6189063134260857, 'auprc': 0.8593452289230574, 'loss_val': 0.5669388231802651, 'psi': 0.7150818796248744}
[S5] START round=16 head_norm_before_train=1.004975 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6075223689104021, 'auprc': 0.7320375026700301, 'loss_val': 0.6590828793249575, 'psi': 0.6573284224142533}-{'f1_val': 0.6755105653025362, 'auprc': 0.7726290530734078, 'loss_val': 0.5363316913290983, 'psi': 0.7143579604108848}
[S6] START round=16 head_norm_before_train=1.239417 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.911046 metrics={'f1_val': 0.9485944508255548, 'auprc': 0.9608467069687681, 'loss_val': 0.3327160944442968, 'psi': 0.9534953532828402}-{'f1_val': 0.7065197602978587, 'auprc': 0.8666777795952254, 'loss_val': 0.41985301289440413, 'psi': 0.7705829680168054}
[S7] START round=16 head_norm_before_train=1.319408 cos_to_last_merge=0.9942 (last merge round=12)
[S7] round=16 local utility u=1.000000 metrics={'f1_val': 0.6759293965316729, 'auprc': 0.8309114017874071, 'loss_val': 0.5060764450106846, 'psi': 0.7379221986339666}-{'f1_val': 0.4449379675098013, 'auprc': 0.7767548791477261, 'loss_val': 0.9681712069790058, 'psi': 0.5776647321649713}
[S8] START round=16 head_norm_before_train=1.333971 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=1.000000 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9978522715916429, 'loss_val': 0.19679503239378246, 'psi': 0.9960654014974918}-{'f1_val': 0.7140170479737811, 'auprc': 0.7941350562394051, 'loss_val': 0.494317462611151, 'psi': 0.7460642512800306}
[S9] START round=16 head_norm_before_train=0.950975 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.016721 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988480345199607, 'loss_val': 0.13442053432476075, 'psi': 0.9971516349942966}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947310937507171, 'loss_val': 0.15954206333444015, 'psi': 0.9959079322591442}
[S10] START round=16 head_norm_before_train=1.628825 (no previous merge yet)
[S10] round=16 local utility u=0.026424 metrics={'f1_val': 0.9961472922086307, 'auprc': 0.9978287840227402, 'loss_val': 0.15881567494663001, 'psi': 0.9968198889342745}-{'f1_val': 0.9960201290336115, 'auprc': 0.9968690706088046, 'loss_val': 0.20802114062944005, 'psi': 0.9963597056636887}
[S11] START round=16 head_norm_before_train=1.658954 (no previous merge yet)
[S11] round=16 local utility u=0.024121 metrics={'f1_val': 0.9601905572999714, 'auprc': 0.9979256776395972, 'loss_val': 0.1365533755107514, 'psi': 0.9752846054358217}-{'f1_val': 0.9578276111022713, 'auprc': 0.9980773488086516, 'loss_val': 0.17107321046704124, 'psi': 0.9739275061848235}
[S13] START round=16 head_norm_before_train=1.051541 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6410122867873698, 'auprc': 0.6255888496162828, 'loss_val': 0.6489996241716414, 'psi': 0.6348429119189349}-{'f1_val': 0.6333080685823499, 'auprc': 0.7080742129041018, 'loss_val': 0.5003802979637499, 'psi': 0.6632145263110507}
[S14] START round=16 head_norm_before_train=0.947678 cos_to_last_merge=0.9815 (last merge round=12)
[S14] round=16 local utility u=1.000000 metrics={'f1_val': 0.9290674236309099, 'auprc': 0.9984739863037653, 'loss_val': 0.4600287822150596, 'psi': 0.9568300487000521}-{'f1_val': 0.576830233324001, 'auprc': 0.9961751172753892, 'loss_val': 0.5683656495748656, 'psi': 0.7445681869045563}
[S15] START round=16 head_norm_before_train=1.431148 cos_to_last_merge=0.8710 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=16 local utility u=0.229442 metrics={'f1_val': 0.6997096135561656, 'auprc': 0.9624835658326645, 'loss_val': 0.27699372199630035, 'psi': 0.8048191944667651}-{'f1_val': 0.7009613975403449, 'auprc': 0.8293463861127471, 'loss_val': 0.3439759405576138, 'psi': 0.7523153929693058}
[S16] START round=16 head_norm_before_train=1.260272 cos_to_last_merge=0.9986 (last merge round=14)
[S16] round=16 local utility u=0.969169 metrics={'f1_val': 0.8615973049608023, 'auprc': 0.9238813020032772, 'loss_val': 0.4851489389103469, 'psi': 0.8865109037777923}-{'f1_val': 0.5763200424129666, 'auprc': 0.8712306745083774, 'loss_val': 0.5538718085521309, 'psi': 0.694284295251131}
[S17] START round=16 head_norm_before_train=1.589045 (no previous merge yet)
[S17] round=16 local utility u=0.231239 metrics={'f1_val': 0.39168138943993247, 'auprc': 0.820176335596228, 'loss_val': 0.8568630011323171, 'psi': 0.5630793679024507}-{'f1_val': 0.3438455268422106, 'auprc': 0.8086827145377368, 'loss_val': 0.9978447999567612, 'psi': 0.5297804019204211}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S15
[S9]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38508
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.9944
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=-0.0556
[S4] DROPPED delta from S11 (cos=-0.0556 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9405
[S9] RECEIVED delta(kind=head bytes=1801) from S14
[S9] cosine check vs S14: cos=0.9401
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=0.8912
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0556
[S11] DROPPED delta from S4 (cos=-0.0556 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.6558
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.9944
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6759 head_norm=1.337959
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.145593e-02
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6771 head_norm=1.344186 delta_norm=0.071456
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9949 head_norm=1.354159
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.145593e-02
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9946 head_norm=1.344186 delta_norm=0.071456
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8616 head_norm=1.304713
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.226074e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8561 head_norm=1.267156 delta_norm=0.222607
[S16] aggregate: ROLLBACK (f1_val pre=0.862 post=0.856 tol_abs=0.005 tol_rel=0.0)
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9960 head_norm=1.045013
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.780924e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9960 head_norm=1.000058 delta_norm=0.178092
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=2 need=5 — continuing
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.6075 head_norm=1.052956
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.009323e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.5809 head_norm=1.146707 delta_norm=0.300932
[S5] aggregate: ROLLBACK (f1_val pre=0.608 post=0.581 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.434124 cos_to_last_merge=0.8558 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.856
[S2] round=17 local utility u=0.006930 metrics={'f1_val': 0.7013912449526117, 'auprc': 0.6643565395233226, 'loss_val': 0.2923455743270654, 'psi': 0.6865773627808961}-{'f1_val': 0.7010299569678582, 'auprc': 0.6641440902681738, 'loss_val': 0.3034013170283561, 'psi': 0.6862756102879843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=17 head_norm_before_train=1.392026 cos_to_last_merge=0.9756 (last merge round=13)
[S3] round=17 local utility u=0.060523 metrics={'f1_val': 0.9742014211050578, 'auprc': 0.9986478994352131, 'loss_val': 0.07276402991825583, 'psi': 0.98398001243712}-{'f1_val': 0.9610352511054436, 'auprc': 0.9984993260007338, 'loss_val': 0.11436733321662605, 'psi': 0.9760208810635597}
[S4] START round=17 head_norm_before_train=1.313729 cos_to_last_merge=0.9758 (last merge round=12)
[S4] round=17 local utility u=0.107666 metrics={'f1_val': 0.9450496375513087, 'auprc': 0.9277381309809134, 'loss_val': 0.4695503214399308, 'psi': 0.9381250349231506}-{'f1_val': 0.9446885014312817, 'auprc': 0.8700236435130572, 'loss_val': 0.5095725712362318, 'psi': 0.914822558263992}
[S5] START round=17 head_norm_before_train=1.146707 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.213783 metrics={'f1_val': 0.6761741590776066, 'auprc': 0.6949243404743293, 'loss_val': 0.5320888565483277, 'psi': 0.6836742316362956}-{'f1_val': 0.6075223689104021, 'auprc': 0.7320375026700301, 'loss_val': 0.6590828793249575, 'psi': 0.6573284224142533}
[S6] START round=17 head_norm_before_train=1.268147 cos_to_last_merge=0.9994 (last merge round=15)
[S6] round=17 local utility u=0.063708 metrics={'f1_val': 0.9608137071836371, 'auprc': 0.9627731256500426, 'loss_val': 0.28439577702592556, 'psi': 0.9615974745701993}-{'f1_val': 0.9485944508255548, 'auprc': 0.9608467069687681, 'loss_val': 0.3327160944442968, 'psi': 0.9534953532828402}
[S7] START round=17 head_norm_before_train=1.344186 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.092369 metrics={'f1_val': 0.687554208673414, 'auprc': 0.8565108191336651, 'loss_val': 0.4678863226524535, 'psi': 0.7551368528575144}-{'f1_val': 0.6759293965316729, 'auprc': 0.8309114017874071, 'loss_val': 0.5060764450106846, 'psi': 0.7379221986339666}
[S8] START round=17 head_norm_before_train=1.344186 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9886510897744984, 'auprc': 0.9950680795368682, 'loss_val': 0.19653652593121335, 'psi': 0.9912178856794464}-{'f1_val': 0.9948741547680577, 'auprc': 0.9978522715916429, 'loss_val': 0.19679503239378246, 'psi': 0.9960654014974918}
[S9] START round=17 head_norm_before_train=1.000058 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.008311 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.998833629721571, 'loss_val': 0.11777795774951026, 'psi': 0.9971481900921725}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988480345199607, 'loss_val': 0.13442053432476075, 'psi': 0.9971516349942966}
[S10] START round=17 head_norm_before_train=1.651963 (no previous merge yet)
[S10] round=17 local utility u=0.024652 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9976194239125513, 'loss_val': 0.10723523276135843, 'psi': 0.9965712952992762}-{'f1_val': 0.9961472922086307, 'auprc': 0.9978287840227402, 'loss_val': 0.15881567494663001, 'psi': 0.9968198889342745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=17 head_norm_before_train=1.690760 (no previous merge yet)
[S11] round=17 local utility u=0.116214 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9978855015842731, 'loss_val': 0.12462690727777889, 'psi': 0.9973306984804859}-{'f1_val': 0.9601905572999714, 'auprc': 0.9979256776395972, 'loss_val': 0.1365533755107514, 'psi': 0.9752846054358217}
[S13] START round=17 head_norm_before_train=1.088371 cos_to_last_merge=0.9990 (last merge round=15)
[S13] round=17 local utility u=0.068833 metrics={'f1_val': 0.6282164294365203, 'auprc': 0.6800754645806393, 'loss_val': 0.5980179139176997, 'psi': 0.6489600434941679}-{'f1_val': 0.6410122867873698, 'auprc': 0.6255888496162828, 'loss_val': 0.6489996241716414, 'psi': 0.6348429119189349}
[S14] START round=17 head_norm_before_train=0.985705 cos_to_last_merge=0.9744 (last merge round=12)
[S14] round=17 local utility u=0.236170 metrics={'f1_val': 0.996314980197995, 'auprc': 0.9969045028416325, 'loss_val': 0.3864649398978929, 'psi': 0.9965507892554499}-{'f1_val': 0.9290674236309099, 'auprc': 0.9984739863037653, 'loss_val': 0.4600287822150596, 'psi': 0.9568300487000521}
[S15] START round=17 head_norm_before_train=1.465767 cos_to_last_merge=0.8639 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=17 local utility u=0.298461 metrics={'f1_val': 0.7705954376194346, 'auprc': 0.9899506481309707, 'loss_val': 0.18778875860762578, 'psi': 0.858337521824049}-{'f1_val': 0.6997096135561656, 'auprc': 0.9624835658326645, 'loss_val': 0.27699372199630035, 'psi': 0.8048191944667651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=17 head_norm_before_train=1.267156 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8273864998401632, 'auprc': 0.9951062906683162, 'loss_val': 0.641174922725724, 'psi': 0.8944744161714244}-{'f1_val': 0.8615973049608023, 'auprc': 0.9238813020032772, 'loss_val': 0.4851489389103469, 'psi': 0.8865109037777923}
[S17] START round=17 head_norm_before_train=1.605428 (no previous merge yet)
[S17] round=17 local utility u=0.017675 metrics={'f1_val': 0.39026191568901925, 'auprc': 0.8279073191037102, 'loss_val': 0.8361888303874392, 'psi': 0.5653200770548956}-{'f1_val': 0.39168138943993247, 'auprc': 0.820176335596228, 'loss_val': 0.8568630011323171, 'psi': 0.5630793679024507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:38512
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38504
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] cosine check vs S13: cos=0.6079
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.0124
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6282 head_norm=1.135274
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.659614e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6258 head_norm=0.986575 delta_norm=0.465961
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.9850
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0591
[S11] DROPPED delta from S4 (cos=-0.0591 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9450 head_norm=1.349929
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.175569e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9475 head_norm=1.318561 delta_norm=0.117557
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S5
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S4]  timeout peer S6
[S11]  timeout peer S4
[S7]  timeout peer S8
[S14]  timeout peer S7
[S14]  timeout peer S9
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S17
[S6]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38516
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9295
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6762 head_norm=1.190231
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.374107e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.6704 head_norm=0.948841 delta_norm=0.937411
[S5] aggregate: ROLLBACK (f1_val pre=0.676 post=0.670 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.9680
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9960 head_norm=1.088556
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.927480e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9964 head_norm=0.997046 delta_norm=0.492748
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.468903 cos_to_last_merge=0.8486 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=18 local utility u=0.001825 metrics={'f1_val': 0.7012105951167499, 'auprc': 0.6650505145722453, 'loss_val': 0.289694521442724, 'psi': 0.686746562898948}-{'f1_val': 0.7013912449526117, 'auprc': 0.6643565395233226, 'loss_val': 0.2923455743270654, 'psi': 0.6865773627808961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=18 head_norm_before_train=1.463362 cos_to_last_merge=0.9677 (last merge round=13)
[S3] round=18 local utility u=0.083922 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9984324890577665, 'loss_val': 0.04326756277865929, 'psi': 0.9977932048231302}-{'f1_val': 0.9742014211050578, 'auprc': 0.9986478994352131, 'loss_val': 0.07276402991825583, 'psi': 0.98398001243712}
[S4] START round=18 head_norm_before_train=1.318561 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.8238262365044327, 'auprc': 0.9494699351086155, 'loss_val': 0.4812797567466514, 'psi': 0.8740837159461058}-{'f1_val': 0.9450496375513087, 'auprc': 0.9277381309809134, 'loss_val': 0.4695503214399308, 'psi': 0.9381250349231506}
[S5] START round=18 head_norm_before_train=0.948841 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.301376 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8229249017819384, 'loss_val': 0.45821678197193455, 'psi': 0.7493623198075907}-{'f1_val': 0.6761741590776066, 'auprc': 0.6949243404743293, 'loss_val': 0.5320888565483277, 'psi': 0.6836742316362956}
[S6] START round=18 head_norm_before_train=1.297128 cos_to_last_merge=0.9979 (last merge round=15)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8341504740634837, 'auprc': 0.95784005628926, 'loss_val': 0.32162838615736133, 'psi': 0.8836263069537942}-{'f1_val': 0.9608137071836371, 'auprc': 0.9627731256500426, 'loss_val': 0.28439577702592556, 'psi': 0.9615974745701993}
[S7] START round=18 head_norm_before_train=1.363954 cos_to_last_merge=0.9997 (last merge round=16)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5842074292397825, 'auprc': 0.7939331946802837, 'loss_val': 0.6990535662869423, 'psi': 0.6680977354159829}-{'f1_val': 0.687554208673414, 'auprc': 0.8565108191336651, 'loss_val': 0.4678863226524535, 'psi': 0.7551368528575144}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.363865 cos_to_last_merge=0.9997 (last merge round=16)
[S8] round=18 local utility u=0.036111 metrics={'f1_val': 0.99360271531528, 'auprc': 0.9979729908678846, 'loss_val': 0.16273910380197112, 'psi': 0.9953508255363218}-{'f1_val': 0.9886510897744984, 'auprc': 0.9950680795368682, 'loss_val': 0.19653652593121335, 'psi': 0.9912178856794464}
[S9] START round=18 head_norm_before_train=0.997046 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9935824248516112, 'loss_val': 0.13017990304700575, 'psi': 0.9954484646995018}-{'f1_val': 0.9960245636725735, 'auprc': 0.998833629721571, 'loss_val': 0.11777795774951026, 'psi': 0.9971481900921725}
[S10] START round=18 head_norm_before_train=1.678269 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9958296213108069, 'auprc': 0.9959671225587956, 'loss_val': 0.11534272459304305, 'psi': 0.9958846218100024}-{'f1_val': 0.9958725428904263, 'auprc': 0.9976194239125513, 'loss_val': 0.10723523276135843, 'psi': 0.9965712952992762}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=18 head_norm_before_train=1.721677 (no previous merge yet)
[S11] round=18 local utility u=0.009452 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980103315132266, 'loss_val': 0.1036151457227485, 'psi': 0.9971323353134444}-{'f1_val': 0.996960829744628, 'auprc': 0.9978855015842731, 'loss_val': 0.12462690727777889, 'psi': 0.9973306984804859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=18 head_norm_before_train=0.986575 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.035475 metrics={'f1_val': 0.6497130488309019, 'auprc': 0.6743918144464766, 'loss_val': 0.638996838903728, 'psi': 0.6595845550771318}-{'f1_val': 0.6282164294365203, 'auprc': 0.6800754645806393, 'loss_val': 0.5980179139176997, 'psi': 0.6489600434941679}
[S14] START round=18 head_norm_before_train=1.023811 cos_to_last_merge=0.9678 (last merge round=12)
[S14] round=18 local utility u=0.035885 metrics={'f1_val': 0.9958991241222702, 'auprc': 0.9955629873311488, 'loss_val': 0.3081745644728758, 'psi': 0.9957646694058216}-{'f1_val': 0.996314980197995, 'auprc': 0.9969045028416325, 'loss_val': 0.3864649398978929, 'psi': 0.9965507892554499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9959 head_norm=1.065230
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.437583e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9946 head_norm=1.067318 delta_norm=0.143758
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] START round=18 head_norm_before_train=1.500403 cos_to_last_merge=0.8579 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7010233509369124, 'auprc': 0.7995750950277736, 'loss_val': 0.5337416951365763, 'psi': 0.7404440485732569}-{'f1_val': 0.7705954376194346, 'auprc': 0.9899506481309707, 'loss_val': 0.18778875860762578, 'psi': 0.858337521824049}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.304563 cos_to_last_merge=0.9990 (last merge round=16)
[S16] round=18 local utility u=0.128806 metrics={'f1_val': 0.8529812268380963, 'auprc': 0.9778865980947321, 'loss_val': 0.4854720196364793, 'psi': 0.9029433753407506}-{'f1_val': 0.8273864998401632, 'auprc': 0.9951062906683162, 'loss_val': 0.641174922725724, 'psi': 0.8944744161714244}
[S17] START round=18 head_norm_before_train=1.626876 (no previous merge yet)
[S17] round=18 local utility u=0.105166 metrics={'f1_val': 0.41016171622446873, 'auprc': 0.8313411008674613, 'loss_val': 0.7555579542993354, 'psi': 0.5786334700816658}-{'f1_val': 0.39026191568901925, 'auprc': 0.8279073191037102, 'loss_val': 0.8361888303874392, 'psi': 0.5653200770548956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38516
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.9875
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.9971
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.9677
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.4688
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.7492
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8530 head_norm=1.342195
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.141161e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8596 head_norm=1.111837 delta_norm=0.414116
[S16] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.024587
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.093041e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=1.196541 delta_norm=0.509304
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.497754 cos_to_last_merge=0.8431 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.843
[S2] round=19 local utility u=0.028003 metrics={'f1_val': 0.7013912449526117, 'auprc': 0.6820085254709451, 'loss_val': 0.2856455483577869, 'psi': 0.693638157159945}-{'f1_val': 0.7012105951167499, 'auprc': 0.6650505145722453, 'loss_val': 0.289694521442724, 'psi': 0.686746562898948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S2] r=20 psi=0.694 u=0.0280 p_local=0.0737 f1=0.701 auprc=0.682 bytes=25212
[S3] START round=19 head_norm_before_train=1.527227 cos_to_last_merge=0.9613 (last merge round=13)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9883763333587932, 'auprc': 0.9984813115588848, 'loss_val': 0.04286171114239259, 'psi': 0.9924183246388297}-{'f1_val': 0.9973670153333725, 'auprc': 0.9984324890577665, 'loss_val': 0.04326756277865929, 'psi': 0.9977932048231302}
[S4] START round=19 head_norm_before_train=1.352362 cos_to_last_merge=0.9997 (last merge round=17)
[S4] round=19 local utility u=0.394455 metrics={'f1_val': 0.9452517616335396, 'auprc': 0.9579355660897044, 'loss_val': 0.4463192591275358, 'psi': 0.9503252834160056}-{'f1_val': 0.8238262365044327, 'auprc': 0.9494699351086155, 'loss_val': 0.4812797567466514, 'psi': 0.8740837159461058}
[S5] START round=19 head_norm_before_train=1.196541 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.601667076981695, 'auprc': 0.7950969623397351, 'loss_val': 0.5882085912554018, 'psi': 0.679039031124911}-{'f1_val': 0.700320598491359, 'auprc': 0.8229249017819384, 'loss_val': 0.45821678197193455, 'psi': 0.7493623198075907}
[S6] START round=19 head_norm_before_train=1.320720 cos_to_last_merge=0.9959 (last merge round=15)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8308514118059948, 'auprc': 0.9589871791427726, 'loss_val': 0.3222756531303863, 'psi': 0.882105718740706}-{'f1_val': 0.8341504740634837, 'auprc': 0.95784005628926, 'loss_val': 0.32162838615736133, 'psi': 0.8836263069537942}
[S7] START round=19 head_norm_before_train=1.392791 cos_to_last_merge=0.9987 (last merge round=16)
[S7] round=19 local utility u=0.218953 metrics={'f1_val': 0.6281624524856932, 'auprc': 0.8053360204845079, 'loss_val': 0.559086690502879, 'psi': 0.6990318796852191}-{'f1_val': 0.5842074292397825, 'auprc': 0.7939331946802837, 'loss_val': 0.6990535662869423, 'psi': 0.6680977354159829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6282 head_norm=1.423932
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.286273e-02
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6310 head_norm=1.404374 delta_norm=0.072863
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.699 u=0.2190 p_local=0.2605 f1=0.628 auprc=0.805 bytes=23343
[S8] START round=19 head_norm_before_train=1.388370 cos_to_last_merge=0.9988 (last merge round=16)
[S8] round=19 local utility u=0.009851 metrics={'f1_val': 0.9936452145104662, 'auprc': 0.9977816646208031, 'loss_val': 0.14271859865667186, 'psi': 0.9952997945546009}-{'f1_val': 0.99360271531528, 'auprc': 0.9979729908678846, 'loss_val': 0.16273910380197112, 'psi': 0.9953508255363218}
[S9] START round=19 head_norm_before_train=1.076237 cos_to_last_merge=0.9966 (last merge round=17)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7665050579284156, 'auprc': 0.9825091200317755, 'loss_val': 0.24481299457547012, 'psi': 0.8529066827697596}-{'f1_val': 0.9966924912647621, 'auprc': 0.9935824248516112, 'loss_val': 0.13017990304700575, 'psi': 0.9954484646995018}
[S10] START round=19 head_norm_before_train=1.710347 (no previous merge yet)
[S10] round=19 local utility u=0.008114 metrics={'f1_val': 0.9954199190330099, 'auprc': 0.9958724515379193, 'loss_val': 0.09637245963210204, 'psi': 0.9956009320349737}-{'f1_val': 0.9958296213108069, 'auprc': 0.9959671225587956, 'loss_val': 0.11534272459304305, 'psi': 0.9958846218100024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=20 psi=0.996 u=0.0081 p_local=0.1466 f1=0.995 auprc=0.996 bytes=30549
[S11] START round=19 head_norm_before_train=1.756524 (no previous merge yet)
[S11] round=19 local utility u=0.013735 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981139279519631, 'loss_val': 0.07645595074759118, 'psi': 0.997173773888939}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980103315132266, 'loss_val': 0.1036151457227485, 'psi': 0.9971323353134444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=20 psi=0.997 u=0.0137 p_local=0.1473 f1=0.997 auprc=0.998 bytes=28812
[S13] START round=19 head_norm_before_train=1.034388 cos_to_last_merge=0.9969 (last merge round=17)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6258664803593994, 'auprc': 0.6803887775650359, 'loss_val': 0.6626281993519273, 'psi': 0.647675399241654}-{'f1_val': 0.6497130488309019, 'auprc': 0.6743918144464766, 'loss_val': 0.638996838903728, 'psi': 0.6595845550771318}
[S14] START round=19 head_norm_before_train=1.067318 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.037339 metrics={'f1_val': 0.9973194047261705, 'auprc': 0.9986549370539068, 'loss_val': 0.25129453589451917, 'psi': 0.9978536176572651}-{'f1_val': 0.9958991241222702, 'auprc': 0.9955629873311488, 'loss_val': 0.3081745644728758, 'psi': 0.9957646694058216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S14] r=20 psi=0.998 u=0.0373 p_local=0.2543 f1=0.997 auprc=0.999 bytes=25130
[S15] START round=19 head_norm_before_train=1.534559 cos_to_last_merge=0.8529 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.853
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.9955013899730634, 'auprc': 0.993625288494937, 'loss_val': 0.09648735357499336, 'psi': 0.9947509493818129}-{'f1_val': 0.7010233509369124, 'auprc': 0.7995750950277736, 'loss_val': 0.5337416951365763, 'psi': 0.7404440485732569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=20 psi=0.995 u=1.0000 p_local=0.3132 f1=0.996 auprc=0.994 bytes=26977
[S16] START round=19 head_norm_before_train=1.111837 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8444278078893104, 'auprc': 0.9930597445015181, 'loss_val': 0.559050962258452, 'psi': 0.9038805825341935}-{'f1_val': 0.8529812268380963, 'auprc': 0.9778865980947321, 'loss_val': 0.4854720196364793, 'psi': 0.9029433753407506}
[S17] START round=19 head_norm_before_train=1.655804 (no previous merge yet)
[S17] round=19 local utility u=0.559272 metrics={'f1_val': 0.6343156433577757, 'auprc': 0.8207126179976818, 'loss_val': 0.9500512326594781, 'psi': 0.7088744332137382}-{'f1_val': 0.41016171622446873, 'auprc': 0.8313411008674613, 'loss_val': 0.7555579542993354, 'psi': 0.5786334700816658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=20 psi=0.709 u=0.5593 p_local=0.2167 f1=0.634 auprc=0.821 bytes=23394
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7665 head_norm=1.153083
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.277115e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.7805 head_norm=1.087874 delta_norm=0.127711
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.853 u=0.0000 p_local=0.0592 f1=0.767 auprc=0.983 bytes=25203
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.8309 head_norm=1.346330
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.762986e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.8620 head_norm=1.332653 delta_norm=0.176299
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.882 u=0.0000 p_local=0.1718 f1=0.831 auprc=0.959 bytes=16161
[S16] r=20 psi=0.904 u=0.0000 p_local=0.2178 f1=0.844 auprc=0.993 bytes=23332
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] r=20 psi=0.648 u=0.0000 p_local=0.0917 f1=0.626 auprc=0.680 bytes=21563
[S5] r=20 psi=0.679 u=0.0000 p_local=0.1499 f1=0.602 auprc=0.795 bytes=17979
[S3] r=20 psi=0.992 u=0.0000 p_local=0.1404 f1=0.988 auprc=0.998 bytes=21610
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=-0.0577
[S11] DROPPED delta from S4 (cos=-0.0577 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9976
[S8] r=20 psi=0.995 u=0.0099 p_local=0.2146 f1=0.994 auprc=0.998 bytes=25125
[S4] r=20 psi=0.950 u=0.3945 p_local=0.2778 f1=0.945 auprc=0.958 bytes=25149
[S2] START round=20 head_norm_before_train=1.523682 cos_to_last_merge=0.8383 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.6661622379302508, 'loss_val': 0.28652326696827285, 'psi': 0.6874080391638129}-{'f1_val': 0.7013912449526117, 'auprc': 0.6820085254709451, 'loss_val': 0.2856455483577869, 'psi': 0.693638157159945}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.573824 cos_to_last_merge=0.9569 (last merge round=13)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9803648687939185, 'auprc': 0.9983581016276688, 'loss_val': 0.05496616268313442, 'psi': 0.9875621619274186}-{'f1_val': 0.9883763333587932, 'auprc': 0.9984813115588848, 'loss_val': 0.04286171114239259, 'psi': 0.9924183246388297}
[S4] START round=20 head_norm_before_train=1.388228 cos_to_last_merge=0.9987 (last merge round=17)
[S4] round=20 local utility u=0.050172 metrics={'f1_val': 0.9561736809834958, 'auprc': 0.9480334210818903, 'loss_val': 0.38179967697060374, 'psi': 0.9529175770228535}-{'f1_val': 0.9452517616335396, 'auprc': 0.9579355660897044, 'loss_val': 0.4463192591275358, 'psi': 0.9503252834160056}
[S5] START round=20 head_norm_before_train=1.255349 cos_to_last_merge=0.9951 (last merge round=18)
[S5] round=20 local utility u=0.164879 metrics={'f1_val': 0.6718588715840172, 'auprc': 0.714058897003147, 'loss_val': 0.436487023021907, 'psi': 0.6887388817516691}-{'f1_val': 0.601667076981695, 'auprc': 0.7950969623397351, 'loss_val': 0.5882085912554018, 'psi': 0.679039031124911}
[S6] START round=20 head_norm_before_train=1.332653 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.303063 metrics={'f1_val': 0.928159425971103, 'auprc': 0.961867554867941, 'loss_val': 0.3086380575646086, 'psi': 0.9416426775298381}-{'f1_val': 0.8308514118059948, 'auprc': 0.9589871791427726, 'loss_val': 0.3222756531303863, 'psi': 0.882105718740706}
[S7] START round=20 head_norm_before_train=1.404374 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5903551260558385, 'auprc': 0.7975282098133671, 'loss_val': 0.6529505068316812, 'psi': 0.67322435955885}-{'f1_val': 0.6281624524856932, 'auprc': 0.8053360204845079, 'loss_val': 0.559086690502879, 'psi': 0.6990318796852191}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5904 head_norm=1.435249
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.327327e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5919 head_norm=1.423225 delta_norm=0.063273
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] START round=20 head_norm_before_train=1.413932 cos_to_last_merge=0.9971 (last merge round=16)
[S8] round=20 local utility u=0.004037 metrics={'f1_val': 0.9936452145104662, 'auprc': 0.9946872770516773, 'loss_val': 0.12536127756935275, 'psi': 0.9940620395269506}-{'f1_val': 0.9936452145104662, 'auprc': 0.9977816646208031, 'loss_val': 0.14271859865667186, 'psi': 0.9952997945546009}
[S9] START round=20 head_norm_before_train=1.087874 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.779402 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9941050364781822, 'loss_val': 0.10192187132735349, 'psi': 0.9956575093501302}-{'f1_val': 0.7665050579284156, 'auprc': 0.9825091200317755, 'loss_val': 0.24481299457547012, 'psi': 0.8529066827697596}
[S10] START round=20 head_norm_before_train=1.743551 (no previous merge yet)
[S10] round=20 local utility u=0.007485 metrics={'f1_val': 0.9950533517510767, 'auprc': 0.9956127558465279, 'loss_val': 0.0784231787978215, 'psi': 0.9952771133892571}-{'f1_val': 0.9954199190330099, 'auprc': 0.9958724515379193, 'loss_val': 0.09637245963210204, 'psi': 0.9956009320349737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=20 head_norm_before_train=1.793075 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9953437213899076, 'auprc': 0.9981682174823512, 'loss_val': 0.06990286065940209, 'psi': 0.996473519826885}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981139279519631, 'loss_val': 0.07645595074759118, 'psi': 0.997173773888939}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=1.086441 cos_to_last_merge=0.9894 (last merge round=17)
[S13] round=20 local utility u=0.292162 metrics={'f1_val': 0.6960445025448189, 'auprc': 0.6729534936473701, 'loss_val': 0.47706570391648623, 'psi': 0.6868080989858394}-{'f1_val': 0.6258664803593994, 'auprc': 0.6803887775650359, 'loss_val': 0.6626281993519273, 'psi': 0.647675399241654}
[S14] START round=20 head_norm_before_train=1.117188 cos_to_last_merge=0.9987 (last merge round=18)
[S14] round=20 local utility u=0.023137 metrics={'f1_val': 0.996645795236444, 'auprc': 0.9953088400298367, 'loss_val': 0.19094087032587453, 'psi': 0.9961110131538011}-{'f1_val': 0.9973194047261705, 'auprc': 0.9986549370539068, 'loss_val': 0.25129453589451917, 'psi': 0.9978536176572651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] sending update (kind=head size=1787 to 1 peers)
[S15] START round=20 head_norm_before_train=1.562133 cos_to_last_merge=0.8486 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9367630757419951, 'auprc': 0.9955893861425762, 'loss_val': 0.11982739264531701, 'psi': 0.9602935999022276}-{'f1_val': 0.9955013899730634, 'auprc': 0.993625288494937, 'loss_val': 0.09648735357499336, 'psi': 0.9947509493818129}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.153970 cos_to_last_merge=0.9989 (last merge round=18)
[S16] round=20 local utility u=0.395181 metrics={'f1_val': 0.9386371199909054, 'auprc': 0.9749287417460386, 'loss_val': 0.2795522386752658, 'psi': 0.9531537686929586}-{'f1_val': 0.8444278078893104, 'auprc': 0.9930597445015181, 'loss_val': 0.559050962258452, 'psi': 0.9038805825341935}
[S17] START round=20 head_norm_before_train=1.685294 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6351558399925772, 'auprc': 0.8136344168751618, 'loss_val': 1.003484700964534, 'psi': 0.7065472707456111}-{'f1_val': 0.6343156433577757, 'auprc': 0.8207126179976818, 'loss_val': 0.9500512326594781, 'psi': 0.7088744332137382}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S3] ⇄ pheromone p=0.112 → S5@127.0.0.1:38505
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9980
[S9] RECEIVED delta(kind=head bytes=1795) from S13
[S9] cosine check vs S13: cos=0.9703
[S14] RECEIVED delta(kind=head bytes=1805) from S9
[S14] cosine check vs S9: cos=0.8504
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.9757
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.3782
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.9400
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] cosine check vs S4: cos=-0.0611
[S11] DROPPED delta from S4 (cos=-0.0611 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9967 head_norm=1.139302
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.388525e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.131025 delta_norm=0.138852
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.203 → S14@127.0.0.1:38514
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9386 head_norm=1.202363
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.025805e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9382 head_norm=1.044241 delta_norm=0.702581
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.253 → S6@127.0.0.1:38507
[S5] ⇄ pheromone p=0.153 → S16@127.0.0.1:38516
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9282 head_norm=1.357453
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.344934e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9425 head_norm=1.260631 delta_norm=0.234493
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.198 → S4@127.0.0.1:38504
[S13] ⇄ pheromone p=0.132 → S9@127.0.0.1:38510
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9562 head_norm=1.420922
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.563919e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9562 head_norm=1.380721 delta_norm=0.156392
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.232 → S11@127.0.0.1:38512
[S8] ⇄ pheromone p=0.173 → S7@127.0.0.1:38508
[S2] START round=21 head_norm_before_train=1.544849 cos_to_last_merge=0.8340 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=21 local utility u=0.210299 metrics={'f1_val': 0.7018134555683964, 'auprc': 0.8152617105465743, 'loss_val': 0.31467373122237136, 'psi': 0.7471927575596675}-{'f1_val': 0.7015719066528542, 'auprc': 0.6661622379302508, 'loss_val': 0.28652326696827285, 'psi': 0.6874080391638129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=21 head_norm_before_train=1.602587 cos_to_last_merge=0.9536 (last merge round=13)
[S3] round=21 local utility u=0.063487 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984367264406151, 'loss_val': 0.03025697470322605, 'psi': 0.9977965091712984}-{'f1_val': 0.9803648687939185, 'auprc': 0.9983581016276688, 'loss_val': 0.05496616268313442, 'psi': 0.9875621619274186}
[S4] START round=21 head_norm_before_train=1.380721 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.013870 metrics={'f1_val': 0.9523137548014001, 'auprc': 0.9631570859324997, 'loss_val': 0.3762720292484332, 'psi': 0.95665108725384}-{'f1_val': 0.9561736809834958, 'auprc': 0.9480334210818903, 'loss_val': 0.38179967697060374, 'psi': 0.9529175770228535}
[S5] START round=21 head_norm_before_train=1.312418 cos_to_last_merge=0.9868 (last merge round=18)
[S5] round=21 local utility u=0.389988 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8804071136577271, 'loss_val': 0.3263266350663396, 'psi': 0.7723552045579063}-{'f1_val': 0.6718588715840172, 'auprc': 0.714058897003147, 'loss_val': 0.436487023021907, 'psi': 0.6887388817516691}
[S6] START round=21 head_norm_before_train=1.260631 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6083696785433684, 'auprc': 0.7867244698286265, 'loss_val': 0.6269039970053475, 'psi': 0.6797115950574717}-{'f1_val': 0.928159425971103, 'auprc': 0.961867554867941, 'loss_val': 0.3086380575646086, 'psi': 0.9416426775298381}
[S7] START round=21 head_norm_before_train=1.423225 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.094097 metrics={'f1_val': 0.6111100107175756, 'auprc': 0.8019305184619342, 'loss_val': 0.6024929900445836, 'psi': 0.687438213815319}-{'f1_val': 0.5903551260558385, 'auprc': 0.7975282098133671, 'loss_val': 0.6529505068316812, 'psi': 0.67322435955885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6111 head_norm=1.447931
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.608188e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6102 head_norm=1.443582 delta_norm=0.056082
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] START round=21 head_norm_before_train=1.441404 cos_to_last_merge=0.9950 (last merge round=16)
[S8] round=21 local utility u=0.004274 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9896520373136595, 'loss_val': 0.10184308496269262, 'psi': 0.9920614027366035}-{'f1_val': 0.9936452145104662, 'auprc': 0.9946872770516773, 'loss_val': 0.12536127756935275, 'psi': 0.9940620395269506}
[S9] START round=21 head_norm_before_train=1.131025 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.008222 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962549794962265, 'loss_val': 0.09439042764180441, 'psi': 0.9967637393057763}-{'f1_val': 0.9966924912647621, 'auprc': 0.9941050364781822, 'loss_val': 0.10192187132735349, 'psi': 0.9956575093501302}
[S10] START round=21 head_norm_before_train=1.774237 (no previous merge yet)
[S10] round=21 local utility u=0.005467 metrics={'f1_val': 0.9950533517510767, 'auprc': 0.9955617967595172, 'loss_val': 0.06733544171607908, 'psi': 0.9952567297544528}-{'f1_val': 0.9950533517510767, 'auprc': 0.9956127558465279, 'loss_val': 0.0784231787978215, 'psi': 0.9952771133892571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=21 head_norm_before_train=1.824632 (no previous merge yet)
[S11] round=21 local utility u=0.008873 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979222988826092, 'loss_val': 0.05615907618005499, 'psi': 0.9968491245010292}-{'f1_val': 0.9953437213899076, 'auprc': 0.9981682174823512, 'loss_val': 0.06990286065940209, 'psi': 0.996473519826885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=21 head_norm_before_train=1.139731 cos_to_last_merge=0.9796 (last merge round=17)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6108194981610422, 'auprc': 0.6886505996412597, 'loss_val': 0.6856512333997813, 'psi': 0.6419519387531292}-{'f1_val': 0.6960445025448189, 'auprc': 0.6729534936473701, 'loss_val': 0.47706570391648623, 'psi': 0.6868080989858394}
[S14] START round=21 head_norm_before_train=1.173540 cos_to_last_merge=0.9949 (last merge round=18)
[S14] round=21 local utility u=0.033446 metrics={'f1_val': 0.9977391219798778, 'auprc': 0.9986372079395445, 'loss_val': 0.14059356455387934, 'psi': 0.9980983563637444}-{'f1_val': 0.996645795236444, 'auprc': 0.9953088400298367, 'loss_val': 0.19094087032587453, 'psi': 0.9961110131538011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.226689
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.326592e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.136101 delta_norm=0.332659
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] START round=21 head_norm_before_train=1.588673 cos_to_last_merge=0.8451 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7011578199677704, 'auprc': 0.8491709151223981, 'loss_val': 0.41740390092517266, 'psi': 0.7603630580296215}-{'f1_val': 0.9367630757419951, 'auprc': 0.9955893861425762, 'loss_val': 0.11982739264531701, 'psi': 0.9602935999022276}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.044241 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9399058882754845, 'auprc': 0.982398248784272, 'loss_val': 0.351908641640608, 'psi': 0.9569028324789994}-{'f1_val': 0.9386371199909054, 'auprc': 0.9749287417460386, 'loss_val': 0.2795522386752658, 'psi': 0.9531537686929586}
[S17] START round=21 head_norm_before_train=1.715897 (no previous merge yet)
[S17] round=21 local utility u=0.013250 metrics={'f1_val': 0.6419824517715137, 'auprc': 0.813417930368406, 'loss_val': 1.0172953075501612, 'psi': 0.7105566432102706}-{'f1_val': 0.6351558399925772, 'auprc': 0.8136344168751618, 'loss_val': 1.003484700964534, 'psi': 0.7065472707456111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:38512
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.9025
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.9384
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.8207
[S11] RECEIVED delta(kind=head bytes=1791) from S4
[S11] cosine check vs S4: cos=-0.0558
[S11] DROPPED delta from S4 (cos=-0.0558 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S8
[S7] cosine check vs S8: cos=0.9985
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.349158
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.540563e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7003 head_norm=1.449408 delta_norm=0.354056
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.563222 cos_to_last_merge=0.8310 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7014900204402302, 'auprc': 0.6681855480691693, 'loss_val': 0.3231836997801211, 'psi': 0.6881682314918058}-{'f1_val': 0.7018134555683964, 'auprc': 0.8152617105465743, 'loss_val': 0.31467373122237136, 'psi': 0.7471927575596675}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.622361 cos_to_last_merge=0.9513 (last merge round=13)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.91425522028513, 'auprc': 0.9570525420389515, 'loss_val': 0.228070523086595, 'psi': 0.9313741489866585}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984367264406151, 'loss_val': 0.03025697470322605, 'psi': 0.9977965091712984}
[S4] START round=22 head_norm_before_train=1.411719 cos_to_last_merge=0.9997 (last merge round=20)
[S4] round=22 local utility u=0.031843 metrics={'f1_val': 0.9545671148150406, 'auprc': 0.9643145119621233, 'loss_val': 0.32957880962330194, 'psi': 0.9584660736738737}-{'f1_val': 0.9523137548014001, 'auprc': 0.9631570859324997, 'loss_val': 0.3762720292484332, 'psi': 0.95665108725384}
[S5] START round=22 head_norm_before_train=1.449408 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.187349 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9958174747106597, 'loss_val': 0.2978639294400257, 'psi': 0.8185197803446121}-{'f1_val': 0.700320598491359, 'auprc': 0.8804071136577271, 'loss_val': 0.3263266350663396, 'psi': 0.7723552045579063}
[S6] START round=22 head_norm_before_train=1.285828 cos_to_last_merge=0.9995 (last merge round=20)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9369555805444538, 'auprc': 0.9621199913657984, 'loss_val': 0.302518383498611, 'psi': 0.9470213448729917}-{'f1_val': 0.6083696785433684, 'auprc': 0.7867244698286265, 'loss_val': 0.6269039970053475, 'psi': 0.6797115950574717}
[S7] START round=22 head_norm_before_train=1.443582 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5863216611556319, 'auprc': 0.7944143730718068, 'loss_val': 0.7158197744926906, 'psi': 0.6695587459221019}-{'f1_val': 0.6111100107175756, 'auprc': 0.8019305184619342, 'loss_val': 0.6024929900445836, 'psi': 0.687438213815319}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5863 head_norm=1.471787
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.213140e-02
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5865 head_norm=1.468577 delta_norm=0.052131
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] START round=22 head_norm_before_train=1.467214 cos_to_last_merge=0.9928 (last merge round=16)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9874583326574358, 'loss_val': 0.09788854801013508, 'psi': 0.9910633953880978}-{'f1_val': 0.9936676463518993, 'auprc': 0.9896520373136595, 'loss_val': 0.10184308496269262, 'psi': 0.9920614027366035}
[S9] START round=22 head_norm_before_train=1.190527 cos_to_last_merge=0.9984 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9981934262413455, 'loss_val': 0.07993020415380542, 'psi': 0.9928664220499898}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962549794962265, 'loss_val': 0.09439042764180441, 'psi': 0.9967637393057763}
[S10] START round=22 head_norm_before_train=1.804221 (no previous merge yet)
[S10] round=22 local utility u=0.002683 metrics={'f1_val': 0.9950533517510767, 'auprc': 0.9959746947458928, 'loss_val': 0.06320909166779606, 'psi': 0.9954218889490032}-{'f1_val': 0.9950533517510767, 'auprc': 0.9955617967595172, 'loss_val': 0.06733544171607908, 'psi': 0.9952567297544528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=22 head_norm_before_train=1.853817 (no previous merge yet)
[S11] round=22 local utility u=0.003936 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998189407590161, 'loss_val': 0.04908799244948398, 'psi': 0.99695596798405}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979222988826092, 'loss_val': 0.05615907618005499, 'psi': 0.9968491245010292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=22 head_norm_before_train=1.176885 cos_to_last_merge=0.9723 (last merge round=17)
[S13] round=22 local utility u=0.086603 metrics={'f1_val': 0.6276683611428475, 'auprc': 0.6906137560541317, 'loss_val': 0.6194269455462389, 'psi': 0.6528465191073611}-{'f1_val': 0.6108194981610422, 'auprc': 0.6886505996412597, 'loss_val': 0.6856512333997813, 'psi': 0.6419519387531292}
[S14] START round=22 head_norm_before_train=1.136101 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9968429160880343, 'auprc': 0.9987199561261929, 'loss_val': 0.16661747005365762, 'psi': 0.9975937321032977}-{'f1_val': 0.9977391219798778, 'auprc': 0.9986372079395445, 'loss_val': 0.14059356455387934, 'psi': 0.9980983563637444}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9968 head_norm=1.184100
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.218961e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9968 head_norm=1.166399 delta_norm=0.221896
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] START round=22 head_norm_before_train=1.614949 cos_to_last_merge=0.8416 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.842
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9969942172713024, 'loss_val': 0.057911120958448054, 'psi': 0.9965971334178055}-{'f1_val': 0.7011578199677704, 'auprc': 0.8491709151223981, 'loss_val': 0.41740390092517266, 'psi': 0.7603630580296215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=22 head_norm_before_train=1.094687 cos_to_last_merge=0.9974 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8344635783975138, 'auprc': 0.9957780891087709, 'loss_val': 0.7178281217244145, 'psi': 0.8989893826820167}-{'f1_val': 0.9399058882754845, 'auprc': 0.982398248784272, 'loss_val': 0.351908641640608, 'psi': 0.9569028324789994}
[S17] START round=22 head_norm_before_train=1.743132 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6423770112153094, 'auprc': 0.8120826267751362, 'loss_val': 1.0912432860363201, 'psi': 0.7102592574392401}-{'f1_val': 0.6419824517715137, 'auprc': 0.813417930368406, 'loss_val': 1.0172953075501612, 'psi': 0.7105566432102706}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:38504
[S6] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8345 head_norm=1.159656
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.189836e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8340 head_norm=1.186156 delta_norm=0.418984
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.9661
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.8862
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=0.9664
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=-0.0591
[S11] DROPPED delta from S4 (cos=-0.0591 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9546 head_norm=1.441254
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.896875e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9546 head_norm=1.364975 delta_norm=0.189688
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.577596 cos_to_last_merge=0.8289 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=23 local utility u=0.051773 metrics={'f1_val': 0.7086867419108435, 'auprc': 0.684987426636197, 'loss_val': 0.3132245443437463, 'psi': 0.6992070158009849}-{'f1_val': 0.7014900204402302, 'auprc': 0.6681855480691693, 'loss_val': 0.3231836997801211, 'psi': 0.6881682314918058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=23 head_norm_before_train=1.647243 cos_to_last_merge=0.9486 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=23 local utility u=0.411342 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9984960187317395, 'loss_val': 0.02857428020282575, 'psi': 0.9978373489603303}-{'f1_val': 0.91425522028513, 'auprc': 0.9570525420389515, 'loss_val': 0.228070523086595, 'psi': 0.9313741489866585}
[S4] START round=23 head_norm_before_train=1.364975 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.012847 metrics={'f1_val': 0.9562162615897745, 'auprc': 0.9662411235216934, 'loss_val': 0.31955923431454925, 'psi': 0.960226206362542}-{'f1_val': 0.9545671148150406, 'auprc': 0.9643145119621233, 'loss_val': 0.32957880962330194, 'psi': 0.9584660736738737}
[S5] START round=23 head_norm_before_train=1.470371 cos_to_last_merge=0.9997 (last merge round=21)
[S5] round=23 local utility u=0.006858 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9952279709046967, 'loss_val': 0.2823758586743764, 'psi': 0.8182835474566941}-{'f1_val': 0.7003213174339138, 'auprc': 0.9958174747106597, 'loss_val': 0.2978639294400257, 'psi': 0.8185197803446121}
[S6] START round=23 head_norm_before_train=1.311893 cos_to_last_merge=0.9982 (last merge round=20)
[S6] round=23 local utility u=0.157714 metrics={'f1_val': 0.9598519015149958, 'auprc': 0.9764807663360597, 'loss_val': 0.16755109053515702, 'psi': 0.9665034474434213}-{'f1_val': 0.9369555805444538, 'auprc': 0.9621199913657984, 'loss_val': 0.302518383498611, 'psi': 0.9470213448729917}
[S7] START round=23 head_norm_before_train=1.468577 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.207698 metrics={'f1_val': 0.6294299634942149, 'auprc': 0.8042972491293157, 'loss_val': 0.5887230293305508, 'psi': 0.6993768777482552}-{'f1_val': 0.5863216611556319, 'auprc': 0.7944143730718068, 'loss_val': 0.7158197744926906, 'psi': 0.6695587459221019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=23 head_norm_before_train=1.495617 cos_to_last_merge=0.9904 (last merge round=16)
[S8] round=23 local utility u=0.007786 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9878385624106036, 'loss_val': 0.07595612647054473, 'psi': 0.9904653173696556}-{'f1_val': 0.9934667705418724, 'auprc': 0.9874583326574358, 'loss_val': 0.09788854801013508, 'psi': 0.9910633953880978}
[S9] START round=23 head_norm_before_train=1.252971 cos_to_last_merge=0.9946 (last merge round=20)
[S9] round=23 local utility u=0.024893 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9936836924996887, 'loss_val': 0.059377473866657586, 'psi': 0.9953387755068015}-{'f1_val': 0.9893150859224193, 'auprc': 0.9981934262413455, 'loss_val': 0.07993020415380542, 'psi': 0.9928664220499898}
[S10] START round=23 head_norm_before_train=1.833177 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9950533517510767, 'auprc': 0.9955023462687942, 'loss_val': 0.0638462610328451, 'psi': 0.9952329495581637}-{'f1_val': 0.9950533517510767, 'auprc': 0.9959746947458928, 'loss_val': 0.06320909166779606, 'psi': 0.9954218889490032}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=1.879788 (no previous merge yet)
[S11] round=23 local utility u=0.002822 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978995694855399, 'loss_val': 0.04257508622597315, 'psi': 0.9968400327422016}-{'f1_val': 0.9961336749133093, 'auprc': 0.998189407590161, 'loss_val': 0.04908799244948398, 'psi': 0.99695596798405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=23 head_norm_before_train=1.211537 cos_to_last_merge=0.9653 (last merge round=17)
[S13] round=23 local utility u=0.213524 metrics={'f1_val': 0.6665939139386189, 'auprc': 0.7078992003308489, 'loss_val': 0.4777879492832406, 'psi': 0.6831160284955109}-{'f1_val': 0.6276683611428475, 'auprc': 0.6906137560541317, 'loss_val': 0.6194269455462389, 'psi': 0.6528465191073611}
[S14] START round=23 head_norm_before_train=1.166399 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.996645795236444, 'auprc': 0.9986953365053522, 'loss_val': 0.17351138492454832, 'psi': 0.9974656117440073}-{'f1_val': 0.9968429160880343, 'auprc': 0.9987199561261929, 'loss_val': 0.16661747005365762, 'psi': 0.9975937321032977}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.637719 cos_to_last_merge=0.8388 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.839
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7690484076024355, 'auprc': 0.9331211304518414, 'loss_val': 0.34254368763127535, 'psi': 0.8346774967421979}-{'f1_val': 0.9963324108488076, 'auprc': 0.9969942172713024, 'loss_val': 0.057911120958448054, 'psi': 0.9965971334178055}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.186156 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.278853 metrics={'f1_val': 0.8755049760077707, 'auprc': 0.9874591881347945, 'loss_val': 0.38141317964709665, 'psi': 0.9202866608585802}-{'f1_val': 0.8344635783975138, 'auprc': 0.9957780891087709, 'loss_val': 0.7178281217244145, 'psi': 0.8989893826820167}
[S17] START round=23 head_norm_before_train=1.768437 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.644457127508123, 'auprc': 0.8104801960024214, 'loss_val': 1.1321977834193753, 'psi': 0.7108663549058424}-{'f1_val': 0.6423770112153094, 'auprc': 0.8120826267751362, 'loss_val': 1.0912432860363201, 'psi': 0.7102592574392401}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8755 head_norm=1.233864
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.812817e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8819 head_norm=1.302624 delta_norm=0.381282
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9964 head_norm=1.300712
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.857844e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9964 head_norm=1.243109 delta_norm=0.185784
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.593542 cos_to_last_merge=0.8273 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=24 local utility u=0.032870 metrics={'f1_val': 0.7088431337954092, 'auprc': 0.7255847259078049, 'loss_val': 0.3702141159561581, 'psi': 0.7155397706403674}-{'f1_val': 0.7086867419108435, 'auprc': 0.684987426636197, 'loss_val': 0.3132245443437463, 'psi': 0.6992070158009849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=24 head_norm_before_train=1.670620 cos_to_last_merge=0.9464 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9342951680476788, 'auprc': 0.9964699125719287, 'loss_val': 0.15789803008794115, 'psi': 0.9591650658573787}-{'f1_val': 0.9973982357793907, 'auprc': 0.9984960187317395, 'loss_val': 0.02857428020282575, 'psi': 0.9978373489603303}
[S4] START round=24 head_norm_before_train=1.393548 cos_to_last_merge=0.9997 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9524384253353146, 'auprc': 0.9639963589052107, 'loss_val': 0.307024107777422, 'psi': 0.9570615987632731}-{'f1_val': 0.9562162615897745, 'auprc': 0.9662411235216934, 'loss_val': 0.31955923431454925, 'psi': 0.960226206362542}
[S5] START round=24 head_norm_before_train=1.488240 cos_to_last_merge=0.9990 (last merge round=21)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8996303953512567, 'loss_val': 0.32128185297454515, 'psi': 0.7800445172353181}-{'f1_val': 0.700320598491359, 'auprc': 0.9952279709046967, 'loss_val': 0.2823758586743764, 'psi': 0.8182835474566941}
[S6] START round=24 head_norm_before_train=1.333544 cos_to_last_merge=0.9966 (last merge round=20)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6044126592305505, 'auprc': 0.7554860652478076, 'loss_val': 0.6858800033057475, 'psi': 0.6648420216374533}-{'f1_val': 0.9598519015149958, 'auprc': 0.9764807663360597, 'loss_val': 0.16755109053515702, 'psi': 0.9665034474434213}
[S7] START round=24 head_norm_before_train=1.502804 cos_to_last_merge=0.9996 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6233704693525787, 'auprc': 0.8038685906859868, 'loss_val': 0.6145468828061275, 'psi': 0.6955697178859419}-{'f1_val': 0.6294299634942149, 'auprc': 0.8042972491293157, 'loss_val': 0.5887230293305508, 'psi': 0.6993768777482552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.525081 cos_to_last_merge=0.9878 (last merge round=16)
[S8] round=24 local utility u=0.001795 metrics={'f1_val': 0.9928067723240902, 'auprc': 0.985378575988136, 'loss_val': 0.06852815208830179, 'psi': 0.9898354937897086}-{'f1_val': 0.9922164873423569, 'auprc': 0.9878385624106036, 'loss_val': 0.07595612647054473, 'psi': 0.9904653173696556}
[S9] START round=24 head_norm_before_train=1.243109 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9938093263736841, 'loss_val': 0.07407707561767472, 'psi': 0.9953890290563996}-{'f1_val': 0.99644216417821, 'auprc': 0.9936836924996887, 'loss_val': 0.059377473866657586, 'psi': 0.9953387755068015}
[S10] START round=24 head_norm_before_train=1.857876 (no previous merge yet)
[S10] round=24 local utility u=0.001256 metrics={'f1_val': 0.9950533517510767, 'auprc': 0.9953078584985722, 'loss_val': 0.06075021872528734, 'psi': 0.9951551544500749}-{'f1_val': 0.9950533517510767, 'auprc': 0.9955023462687942, 'loss_val': 0.0638462610328451, 'psi': 0.9952329495581637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=24 head_norm_before_train=1.905232 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9954113368503568, 'auprc': 0.9982352325534491, 'loss_val': 0.04048476020047138, 'psi': 0.9965408951315937}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978995694855399, 'loss_val': 0.04257508622597315, 'psi': 0.9968400327422016}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.244638 cos_to_last_merge=0.9592 (last merge round=17)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6114669253009916, 'auprc': 0.7014052382477981, 'loss_val': 0.7196638419440108, 'psi': 0.6474422504797142}-{'f1_val': 0.6665939139386189, 'auprc': 0.7078992003308489, 'loss_val': 0.4777879492832406, 'psi': 0.6831160284955109}
[S14] START round=24 head_norm_before_train=1.213027 cos_to_last_merge=0.9988 (last merge round=22)
[S14] round=24 local utility u=0.022501 metrics={'f1_val': 0.9976223066820082, 'auprc': 0.9986388096774075, 'loss_val': 0.13419813442705755, 'psi': 0.9980289078801678}-{'f1_val': 0.996645795236444, 'auprc': 0.9986953365053522, 'loss_val': 0.17351138492454832, 'psi': 0.9974656117440073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=24 head_norm_before_train=1.656092 cos_to_last_merge=0.8367 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.837
[S15] round=24 local utility u=0.919806 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9968643269191964, 'loss_val': 0.0578655562616642, 'psi': 0.9965451772769631}-{'f1_val': 0.7690484076024355, 'auprc': 0.9331211304518414, 'loss_val': 0.34254368763127535, 'psi': 0.8346774967421979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=24 head_norm_before_train=1.302624 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.359127 metrics={'f1_val': 0.990660527160834, 'auprc': 0.9900573898770324, 'loss_val': 0.36188663908229424, 'psi': 0.9904192722473133}-{'f1_val': 0.8755049760077707, 'auprc': 0.9874591881347945, 'loss_val': 0.38141317964709665, 'psi': 0.9202866608585802}
[S17] START round=24 head_norm_before_train=1.790252 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6310254215623914, 'auprc': 0.7976451528490591, 'loss_val': 1.2781921373893335, 'psi': 0.6976733140770585}-{'f1_val': 0.644457127508123, 'auprc': 0.8104801960024214, 'loss_val': 1.1321977834193753, 'psi': 0.7108663549058424}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S2] START round=25 head_norm_before_train=1.610443 cos_to_last_merge=0.8257 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=25 local utility u=0.152568 metrics={'f1_val': 0.7088336616306576, 'auprc': 0.8065243928876744, 'loss_val': 0.30783943656363405, 'psi': 0.7479099541334644}-{'f1_val': 0.7088431337954092, 'auprc': 0.7255847259078049, 'loss_val': 0.3702141159561581, 'psi': 0.7155397706403674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=25 head_norm_before_train=1.693807 cos_to_last_merge=0.9445 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=25 local utility u=0.259551 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9988736246985029, 'loss_val': 0.024626508169474724, 'psi': 0.9979883913470357}-{'f1_val': 0.9342951680476788, 'auprc': 0.9964699125719287, 'loss_val': 0.15789803008794115, 'psi': 0.9591650658573787}
[S4] START round=25 head_norm_before_train=1.422167 cos_to_last_merge=0.9990 (last merge round=22)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9535548348252596, 'auprc': 0.9542052052750072, 'loss_val': 0.28825894393558227, 'psi': 0.9538149830051587}-{'f1_val': 0.9524384253353146, 'auprc': 0.9639963589052107, 'loss_val': 0.307024107777422, 'psi': 0.9570615987632731}
[S5] START round=25 head_norm_before_train=1.499137 cos_to_last_merge=0.9985 (last merge round=21)
[S5] round=25 local utility u=0.136164 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9846957641230796, 'loss_val': 0.30414924551871175, 'psi': 0.8140706647440472}-{'f1_val': 0.700320598491359, 'auprc': 0.8996303953512567, 'loss_val': 0.32128185297454515, 'psi': 0.7800445172353181}
[S6] START round=25 head_norm_before_train=1.351731 cos_to_last_merge=0.9951 (last merge round=20)
[S6] round=25 local utility u=0.753698 metrics={'f1_val': 0.8001308032941699, 'auprc': 0.798343781508295, 'loss_val': 0.481365245181936, 'psi': 0.7994159945798198}-{'f1_val': 0.6044126592305505, 'auprc': 0.7554860652478076, 'loss_val': 0.6858800033057475, 'psi': 0.6648420216374533}
[S7] START round=25 head_norm_before_train=1.528606 cos_to_last_merge=0.9988 (last merge round=22)
[S7] round=25 local utility u=0.288736 metrics={'f1_val': 0.6685347098379901, 'auprc': 0.8317395639606439, 'loss_val': 0.3916737937823545, 'psi': 0.7338166514870517}-{'f1_val': 0.6233704693525787, 'auprc': 0.8038685906859868, 'loss_val': 0.6145468828061275, 'psi': 0.6955697178859419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=25 head_norm_before_train=1.554938 cos_to_last_merge=0.9849 (last merge round=16)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9930910663870046, 'auprc': 0.9849264809045963, 'loss_val': 0.07448879394786506, 'psi': 0.9898252321940413}-{'f1_val': 0.9928067723240902, 'auprc': 0.985378575988136, 'loss_val': 0.06852815208830179, 'psi': 0.9898354937897086}
[S9] START round=25 head_norm_before_train=1.286087 cos_to_last_merge=0.9994 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9980923553811981, 'loss_val': 0.06829564104089862, 'psi': 0.9938393448246926}-{'f1_val': 0.99644216417821, 'auprc': 0.9938093263736841, 'loss_val': 0.07407707561767472, 'psi': 0.9953890290563996}
[S10] START round=25 head_norm_before_train=1.880038 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9951519619883572, 'loss_val': 0.063815053080479, 'psi': 0.9950053674028232}-{'f1_val': 0.9950533517510767, 'auprc': 0.9953078584985722, 'loss_val': 0.06075021872528734, 'psi': 0.9951551544500749}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=1.925921 (no previous merge yet)
[S11] round=25 local utility u=0.005919 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981779537258952, 'loss_val': 0.03528964774335067, 'psi': 0.9971993841985118}-{'f1_val': 0.9954113368503568, 'auprc': 0.9982352325534491, 'loss_val': 0.04048476020047138, 'psi': 0.9965408951315937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=25 head_norm_before_train=1.268522 cos_to_last_merge=0.9550 (last merge round=17)
[S13] round=25 local utility u=0.039667 metrics={'f1_val': 0.6187717163207824, 'auprc': 0.7030347372335273, 'loss_val': 0.6890468928945039, 'psi': 0.6524769246858804}-{'f1_val': 0.6114669253009916, 'auprc': 0.7014052382477981, 'loss_val': 0.7196638419440108, 'psi': 0.6474422504797142}
[S14] START round=25 head_norm_before_train=1.261111 cos_to_last_merge=0.9955 (last merge round=22)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9707130693448307, 'auprc': 0.9984514568767816, 'loss_val': 0.136320696468718, 'psi': 0.9818084243576111}-{'f1_val': 0.9976223066820082, 'auprc': 0.9986388096774075, 'loss_val': 0.13419813442705755, 'psi': 0.9980289078801678}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.674476 cos_to_last_merge=0.8347 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.835
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7729574682053657, 'auprc': 0.9442202461552515, 'loss_val': 0.35664570959045944, 'psi': 0.84146257938532}-{'f1_val': 0.9963324108488076, 'auprc': 0.9968643269191964, 'loss_val': 0.0578655562616642, 'psi': 0.9965451772769631}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.340396 cos_to_last_merge=0.9964 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8574548979786791, 'auprc': 0.9919955168446801, 'loss_val': 0.5886557016314587, 'psi': 0.9112711455250795}-{'f1_val': 0.990660527160834, 'auprc': 0.9900573898770324, 'loss_val': 0.36188663908229424, 'psi': 0.9904192722473133}
[S17] START round=25 head_norm_before_train=1.807260 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.48073250163566916, 'auprc': 0.7671018766599954, 'loss_val': 2.1421077343837536, 'psi': 0.5952802516453997}-{'f1_val': 0.6310254215623914, 'auprc': 0.7976451528490591, 'loss_val': 1.2781921373893335, 'psi': 0.6976733140770585}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] START round=26 head_norm_before_train=1.625930 cos_to_last_merge=0.8250 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.714552769188157, 'auprc': 0.7459031320763079, 'loss_val': 0.3351390450213841, 'psi': 0.7270929143434174}-{'f1_val': 0.7088336616306576, 'auprc': 0.8065243928876744, 'loss_val': 0.30783943656363405, 'psi': 0.7479099541334644}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.718327 cos_to_last_merge=0.9424 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9983968075104925, 'loss_val': 0.13992603697924294, 'psi': 0.9757013074255725}-{'f1_val': 0.9973982357793907, 'auprc': 0.9988736246985029, 'loss_val': 0.024626508169474724, 'psi': 0.9979883913470357}
[S4] START round=26 head_norm_before_train=1.454499 cos_to_last_merge=0.9978 (last merge round=22)
[S4] round=26 local utility u=0.002426 metrics={'f1_val': 0.9502067302110713, 'auprc': 0.9622824874051495, 'loss_val': 0.28755066312965977, 'psi': 0.9550370330887026}-{'f1_val': 0.9535548348252596, 'auprc': 0.9542052052750072, 'loss_val': 0.28825894393558227, 'psi': 0.9538149830051587}
[S5] START round=26 head_norm_before_train=1.511123 cos_to_last_merge=0.9979 (last merge round=21)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.5808755261069142, 'auprc': 0.8308097894059434, 'loss_val': 0.6087413756208967, 'psi': 0.680849231426526}-{'f1_val': 0.700320598491359, 'auprc': 0.9846957641230796, 'loss_val': 0.30414924551871175, 'psi': 0.8140706647440472}
[S6] START round=26 head_norm_before_train=1.368078 cos_to_last_merge=0.9938 (last merge round=20)
[S6] round=26 local utility u=0.761300 metrics={'f1_val': 0.9409221766353155, 'auprc': 0.960860383284382, 'loss_val': 0.29106322737833445, 'psi': 0.9488974592949421}-{'f1_val': 0.8001308032941699, 'auprc': 0.798343781508295, 'loss_val': 0.481365245181936, 'psi': 0.7994159945798198}
[S7] START round=26 head_norm_before_train=1.542638 cos_to_last_merge=0.9983 (last merge round=22)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6188842511097873, 'auprc': 0.8029529382595233, 'loss_val': 0.5998401736453637, 'psi': 0.6925117259696817}-{'f1_val': 0.6685347098379901, 'auprc': 0.8317395639606439, 'loss_val': 0.3916737937823545, 'psi': 0.7338166514870517}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.583063 cos_to_last_merge=0.9818 (last merge round=16)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9818761851478031, 'auprc': 0.9987737365614358, 'loss_val': 0.07886654420905337, 'psi': 0.9886352057132561}-{'f1_val': 0.9930910663870046, 'auprc': 0.9849264809045963, 'loss_val': 0.07448879394786506, 'psi': 0.9898252321940413}
[S9] START round=26 head_norm_before_train=1.326435 cos_to_last_merge=0.9980 (last merge round=23)
[S9] round=26 local utility u=0.018676 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.994209256871007, 'loss_val': 0.05342483089847114, 'psi': 0.9956991975072601}-{'f1_val': 0.9910040044536889, 'auprc': 0.9980923553811981, 'loss_val': 0.06829564104089862, 'psi': 0.9938393448246926}
[S10] START round=26 head_norm_before_train=1.901533 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.994324431516532, 'auprc': 0.994850962050855, 'loss_val': 0.07379454939936282, 'psi': 0.9945350437302612}-{'f1_val': 0.9949076376791339, 'auprc': 0.9951519619883572, 'loss_val': 0.063815053080479, 'psi': 0.9950053674028232}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=1.944587 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981751800040997, 'loss_val': 0.03296436915285538, 'psi': 0.9969502769496255}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981779537258952, 'loss_val': 0.03528964774335067, 'psi': 0.9971993841985118}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.290309 cos_to_last_merge=0.9510 (last merge round=17)
[S13] round=26 local utility u=0.073423 metrics={'f1_val': 0.6281419941499327, 'auprc': 0.705406065530032, 'loss_val': 0.6055358181792566, 'psi': 0.6590476227019724}-{'f1_val': 0.6187717163207824, 'auprc': 0.7030347372335273, 'loss_val': 0.6890468928945039, 'psi': 0.6524769246858804}
[S14] START round=26 head_norm_before_train=1.303291 cos_to_last_merge=0.9914 (last merge round=22)
[S14] round=26 local utility u=0.095389 metrics={'f1_val': 0.9963375338307721, 'auprc': 0.9955207224241277, 'loss_val': 0.09049649911250186, 'psi': 0.9960108092681144}-{'f1_val': 0.9707130693448307, 'auprc': 0.9984514568767816, 'loss_val': 0.136320696468718, 'psi': 0.9818084243576111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=26 head_norm_before_train=1.695886 cos_to_last_merge=0.8327 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=26 local utility u=0.265942 metrics={'f1_val': 0.8175841278051514, 'auprc': 0.9947396935024186, 'loss_val': 0.24408008790426572, 'psi': 0.8884463540840584}-{'f1_val': 0.7729574682053657, 'auprc': 0.9442202461552515, 'loss_val': 0.35664570959045944, 'psi': 0.84146257938532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=26 head_norm_before_train=1.393026 cos_to_last_merge=0.9864 (last merge round=23)
[S16] round=26 local utility u=0.435424 metrics={'f1_val': 0.9434196477041665, 'auprc': 0.9856891463352158, 'loss_val': 0.21467797652817833, 'psi': 0.9603274471565862}-{'f1_val': 0.8574548979786791, 'auprc': 0.9919955168446801, 'loss_val': 0.5886557016314587, 'psi': 0.9112711455250795}
[S17] START round=26 head_norm_before_train=1.827344 (no previous merge yet)
[S17] round=26 local utility u=0.701636 metrics={'f1_val': 0.5952568709435118, 'auprc': 0.7836693279971472, 'loss_val': 1.4756844038335977, 'psi': 0.670621853764966}-{'f1_val': 0.48073250163566916, 'auprc': 0.7671018766599954, 'loss_val': 2.1421077343837536, 'psi': 0.5952802516453997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] START round=27 head_norm_before_train=1.643065 cos_to_last_merge=0.8239 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=27 local utility u=0.001123 metrics={'f1_val': 0.709779773251187, 'auprc': 0.769864489090879, 'loss_val': 0.37613981205755287, 'psi': 0.7338136595870638}-{'f1_val': 0.714552769188157, 'auprc': 0.7459031320763079, 'loss_val': 0.3351390450213841, 'psi': 0.7270929143434174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=27 head_norm_before_train=1.740680 cos_to_last_merge=0.9404 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=27 local utility u=0.121906 metrics={'f1_val': 0.9881497152040528, 'auprc': 0.9980218259197116, 'loss_val': 0.06046061851861034, 'psi': 0.9920985594903163}-{'f1_val': 0.9605709740356257, 'auprc': 0.9983968075104925, 'loss_val': 0.13992603697924294, 'psi': 0.9757013074255725}
[S4] START round=27 head_norm_before_train=1.485376 cos_to_last_merge=0.9963 (last merge round=22)
[S4] round=27 local utility u=0.021643 metrics={'f1_val': 0.9568257471438275, 'auprc': 0.9583233368164203, 'loss_val': 0.27210227233134726, 'psi': 0.9574247830128646}-{'f1_val': 0.9502067302110713, 'auprc': 0.9622824874051495, 'loss_val': 0.28755066312965977, 'psi': 0.9550370330887026}
[S5] START round=27 head_norm_before_train=1.528839 cos_to_last_merge=0.9968 (last merge round=21)
[S5] round=27 local utility u=0.778805 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9944646308996701, 'loss_val': 0.25876573885895315, 'psi': 0.8179782114546834}-{'f1_val': 0.5808755261069142, 'auprc': 0.8308097894059434, 'loss_val': 0.6087413756208967, 'psi': 0.680849231426526}
[S6] START round=27 head_norm_before_train=1.388040 cos_to_last_merge=0.9924 (last merge round=20)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6423269484353242, 'auprc': 0.7901859839226825, 'loss_val': 0.6757286821960058, 'psi': 0.7014705626302675}-{'f1_val': 0.9409221766353155, 'auprc': 0.960860383284382, 'loss_val': 0.29106322737833445, 'psi': 0.9488974592949421}
[S7] START round=27 head_norm_before_train=1.555578 cos_to_last_merge=0.9978 (last merge round=22)
[S7] round=27 local utility u=0.449237 metrics={'f1_val': 0.6912170334783454, 'auprc': 0.8566166660199008, 'loss_val': 0.29635428869036734, 'psi': 0.7573768864949676}-{'f1_val': 0.6188842511097873, 'auprc': 0.8029529382595233, 'loss_val': 0.5998401736453637, 'psi': 0.6925117259696817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=27 head_norm_before_train=1.606829 cos_to_last_merge=0.9792 (last merge round=16)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.983361666508681, 'loss_val': 0.29084203239537754, 'psi': 0.8214915074778314}-{'f1_val': 0.9818761851478031, 'auprc': 0.9987737365614358, 'loss_val': 0.07886654420905337, 'psi': 0.9886352057132561}
[S9] START round=27 head_norm_before_train=1.362729 cos_to_last_merge=0.9962 (last merge round=23)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9966579738833182, 'loss_val': 0.04817022409627047, 'psi': 0.9952771830710174}-{'f1_val': 0.9966924912647621, 'auprc': 0.994209256871007, 'loss_val': 0.05342483089847114, 'psi': 0.9956991975072601}
[S10] START round=27 head_norm_before_train=1.921796 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.993203230108249, 'auprc': 0.9940297675884802, 'loss_val': 0.09440880533959219, 'psi': 0.9935338451003414}-{'f1_val': 0.994324431516532, 'auprc': 0.994850962050855, 'loss_val': 0.07379454939936282, 'psi': 0.9945350437302612}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=1.961196 (no previous merge yet)
[S11] round=27 local utility u=0.000589 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982383907482542, 'loss_val': 0.031976788049002926, 'psi': 0.9969755612472873}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981751800040997, 'loss_val': 0.03296436915285538, 'psi': 0.9969502769496255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=27 head_norm_before_train=1.308086 cos_to_last_merge=0.9470 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6204016261827734, 'auprc': 0.7002673229502528, 'loss_val': 0.6876290511746678, 'psi': 0.6523479048897651}-{'f1_val': 0.6281419941499327, 'auprc': 0.705406065530032, 'loss_val': 0.6055358181792566, 'psi': 0.6590476227019724}
[S14] START round=27 head_norm_before_train=1.341709 cos_to_last_merge=0.9873 (last merge round=22)
[S14] round=27 local utility u=0.013157 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9987354327272182, 'loss_val': 0.07672423525538263, 'psi': 0.9975865208729597}-{'f1_val': 0.9963375338307721, 'auprc': 0.9955207224241277, 'loss_val': 0.09049649911250186, 'psi': 0.9960108092681144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=27 head_norm_before_train=1.719162 cos_to_last_merge=0.8304 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=27 local utility u=0.359116 metrics={'f1_val': 0.9141959226979693, 'auprc': 0.9956508533784105, 'loss_val': 0.10825224937140987, 'psi': 0.9467778949701459}-{'f1_val': 0.8175841278051514, 'auprc': 0.9947396935024186, 'loss_val': 0.24408008790426572, 'psi': 0.8884463540840584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=27 head_norm_before_train=1.449954 cos_to_last_merge=0.9735 (last merge round=23)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8312163779533821, 'auprc': 0.8615665826494137, 'loss_val': 0.8532235593648868, 'psi': 0.8433564598317947}-{'f1_val': 0.9434196477041665, 'auprc': 0.9856891463352158, 'loss_val': 0.21467797652817833, 'psi': 0.9603274471565862}
[S17] START round=27 head_norm_before_train=1.844935 (no previous merge yet)
[S17] round=27 local utility u=0.330707 metrics={'f1_val': 0.6516281462540072, 'auprc': 0.8153125870647283, 'loss_val': 1.247426840744064, 'psi': 0.7171019225782956}-{'f1_val': 0.5952568709435118, 'auprc': 0.7836693279971472, 'loss_val': 1.4756844038335977, 'psi': 0.670621853764966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.660603 cos_to_last_merge=0.8225 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=28 local utility u=0.316188 metrics={'f1_val': 0.7860690626314291, 'auprc': 0.8296025267334373, 'loss_val': 0.38071458976998995, 'psi': 0.8034824482722323}-{'f1_val': 0.709779773251187, 'auprc': 0.769864489090879, 'loss_val': 0.37613981205755287, 'psi': 0.7338136595870638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=28 head_norm_before_train=1.757449 cos_to_last_merge=0.9388 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9601059790903541, 'auprc': 0.9981925929416465, 'loss_val': 0.14724711070493432, 'psi': 0.9753406246308711}-{'f1_val': 0.9881497152040528, 'auprc': 0.9980218259197116, 'loss_val': 0.06046061851861034, 'psi': 0.9920985594903163}
[S4] START round=28 head_norm_before_train=1.511379 cos_to_last_merge=0.9949 (last merge round=22)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9514445715362962, 'auprc': 0.9654033445111744, 'loss_val': 0.27191924927509964, 'psi': 0.9570280807262475}-{'f1_val': 0.9568257471438275, 'auprc': 0.9583233368164203, 'loss_val': 0.27210227233134726, 'psi': 0.9574247830128646}
[S5] START round=28 head_norm_before_train=1.548696 cos_to_last_merge=0.9956 (last merge round=21)
[S5] round=28 local utility u=0.019891 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9966546003558081, 'loss_val': 0.22704079331426313, 'psi': 0.8190029461451143}-{'f1_val': 0.700320598491359, 'auprc': 0.9944646308996701, 'loss_val': 0.25876573885895315, 'psi': 0.8179782114546834}
[S6] START round=28 head_norm_before_train=1.410703 cos_to_last_merge=0.9905 (last merge round=20)
[S6] round=28 local utility u=0.917555 metrics={'f1_val': 0.8227878566184685, 'auprc': 0.9599185409832659, 'loss_val': 0.4325823415820656, 'psi': 0.8776401303643875}-{'f1_val': 0.6423269484353242, 'auprc': 0.7901859839226825, 'loss_val': 0.6757286821960058, 'psi': 0.7014705626302675}
[S7] START round=28 head_norm_before_train=1.575619 cos_to_last_merge=0.9969 (last merge round=22)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6664659467008259, 'auprc': 0.8274633052336386, 'loss_val': 0.40280565562459847, 'psi': 0.7308648901139511}-{'f1_val': 0.6912170334783454, 'auprc': 0.8566166660199008, 'loss_val': 0.29635428869036734, 'psi': 0.7573768864949676}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.624866 cos_to_last_merge=0.9777 (last merge round=16)
[S8] round=28 local utility u=0.802820 metrics={'f1_val': 0.9471209173882351, 'auprc': 0.9987293122219237, 'loss_val': 0.1325626726271272, 'psi': 0.9677642753217105}-{'f1_val': 0.7135780681239317, 'auprc': 0.983361666508681, 'loss_val': 0.29084203239537754, 'psi': 0.8214915074778314}
[S9] START round=28 head_norm_before_train=1.397287 cos_to_last_merge=0.9945 (last merge round=23)
[S9] round=28 local utility u=0.010499 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9962951626842131, 'loss_val': 0.04105943680131569, 'psi': 0.9966296163290396}-{'f1_val': 0.994356655862817, 'auprc': 0.9966579738833182, 'loss_val': 0.04817022409627047, 'psi': 0.9952771830710174}
[S10] START round=28 head_norm_before_train=1.941140 (no previous merge yet)
[S10] round=28 local utility u=0.025351 metrics={'f1_val': 0.9948648506904307, 'auprc': 0.9950463872525919, 'loss_val': 0.056726944464562716, 'psi': 0.9949374653152951}-{'f1_val': 0.993203230108249, 'auprc': 0.9940297675884802, 'loss_val': 0.09440880533959219, 'psi': 0.9935338451003414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=28 head_norm_before_train=1.975535 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9923138665505316, 'auprc': 0.9983331458063087, 'loss_val': 0.03897795828086872, 'psi': 0.9947215782528425}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982383907482542, 'loss_val': 0.031976788049002926, 'psi': 0.9969755612472873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.328226 cos_to_last_merge=0.9434 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=28 local utility u=0.044770 metrics={'f1_val': 0.629369108507057, 'auprc': 0.6932392525354754, 'loss_val': 0.6308095250679036, 'psi': 0.6549171661184243}-{'f1_val': 0.6204016261827734, 'auprc': 0.7002673229502528, 'loss_val': 0.6876290511746678, 'psi': 0.6523479048897651}
[S14] START round=28 head_norm_before_train=1.375512 cos_to_last_merge=0.9837 (last merge round=22)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9969098321482058, 'loss_val': 0.06977305535558433, 'psi': 0.9964522371780846}-{'f1_val': 0.9968205796367875, 'auprc': 0.9987354327272182, 'loss_val': 0.07672423525538263, 'psi': 0.9975865208729597}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.743025 cos_to_last_merge=0.8278 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.828
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7603340362535815, 'auprc': 0.9774125402496631, 'loss_val': 0.38044570354197543, 'psi': 0.8471654378520141}-{'f1_val': 0.9141959226979693, 'auprc': 0.9956508533784105, 'loss_val': 0.10825224937140987, 'psi': 0.9467778949701459}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.500447 cos_to_last_merge=0.9622 (last merge round=23)
[S16] round=28 local utility u=0.980356 metrics={'f1_val': 0.9722999364849911, 'auprc': 0.992544321868674, 'loss_val': 0.13194684422885072, 'psi': 0.9803976906384643}-{'f1_val': 0.8312163779533821, 'auprc': 0.8615665826494137, 'loss_val': 0.8532235593648868, 'psi': 0.8433564598317947}
[S17] START round=28 head_norm_before_train=1.863088 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6554032749761238, 'auprc': 0.8207297741153844, 'loss_val': 1.2872339620159308, 'psi': 0.721533874631828}-{'f1_val': 0.6516281462540072, 'auprc': 0.8153125870647283, 'loss_val': 1.247426840744064, 'psi': 0.7171019225782956}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] START round=29 head_norm_before_train=1.677095 cos_to_last_merge=0.8211 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.8248348274330484, 'auprc': 0.7555140335498401, 'loss_val': 0.3988795113988048, 'psi': 0.7971065098797651}-{'f1_val': 0.7860690626314291, 'auprc': 0.8296025267334373, 'loss_val': 0.38071458976998995, 'psi': 0.8034824482722323}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.772159 cos_to_last_merge=0.9371 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=29 local utility u=0.055266 metrics={'f1_val': 0.9682029918726667, 'auprc': 0.9981028253352346, 'loss_val': 0.08502862228485276, 'psi': 0.9801629252576939}-{'f1_val': 0.9601059790903541, 'auprc': 0.9981925929416465, 'loss_val': 0.14724711070493432, 'psi': 0.9753406246308711}
[S4] START round=29 head_norm_before_train=1.528484 cos_to_last_merge=0.9938 (last merge round=22)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9525161294937544, 'auprc': 0.9593618945569152, 'loss_val': 0.2654934579864938, 'psi': 0.9552544355190187}-{'f1_val': 0.9514445715362962, 'auprc': 0.9654033445111744, 'loss_val': 0.27191924927509964, 'psi': 0.9570280807262475}
[S5] START round=29 head_norm_before_train=1.565405 cos_to_last_merge=0.9946 (last merge round=21)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.995166015268252, 'loss_val': 0.22250677583707434, 'psi': 0.8182587652021163}-{'f1_val': 0.7005685100046517, 'auprc': 0.9966546003558081, 'loss_val': 0.22704079331426313, 'psi': 0.8190029461451143}
[S6] START round=29 head_norm_before_train=1.431982 cos_to_last_merge=0.9890 (last merge round=20)
[S6] round=29 local utility u=0.542526 metrics={'f1_val': 0.9616921418945878, 'auprc': 0.9658073469357938, 'loss_val': 0.19862181606806298, 'psi': 0.9633382239110703}-{'f1_val': 0.8227878566184685, 'auprc': 0.9599185409832659, 'loss_val': 0.4325823415820656, 'psi': 0.8776401303643875}
[S7] START round=29 head_norm_before_train=1.590931 cos_to_last_merge=0.9960 (last merge round=22)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6202128947177947, 'auprc': 0.8012081725687173, 'loss_val': 0.6376677674587033, 'psi': 0.6926110058581638}-{'f1_val': 0.6664659467008259, 'auprc': 0.8274633052336386, 'loss_val': 0.40280565562459847, 'psi': 0.7308648901139511}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.637534 cos_to_last_merge=0.9765 (last merge round=16)
[S8] round=29 local utility u=0.176109 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9984858094386149, 'loss_val': 0.05018772008603664, 'psi': 0.99472421618086}-{'f1_val': 0.9471209173882351, 'auprc': 0.9987293122219237, 'loss_val': 0.1325626726271272, 'psi': 0.9677642753217105}
[S9] START round=29 head_norm_before_train=1.429199 cos_to_last_merge=0.9929 (last merge round=23)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9938169689408707, 'loss_val': 0.03759298129878369, 'psi': 0.9956383388317026}-{'f1_val': 0.9968525854255906, 'auprc': 0.9962951626842131, 'loss_val': 0.04105943680131569, 'psi': 0.9966296163290396}
[S10] START round=29 head_norm_before_train=1.958697 (no previous merge yet)
[S10] round=29 local utility u=0.005807 metrics={'f1_val': 0.9946314014883041, 'auprc': 0.9953060267269646, 'loss_val': 0.04449049380599842, 'psi': 0.9949012515837683}-{'f1_val': 0.9948648506904307, 'auprc': 0.9950463872525919, 'loss_val': 0.056726944464562716, 'psi': 0.9949374653152951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=29 head_norm_before_train=1.991256 (no previous merge yet)
[S11] round=29 local utility u=0.015644 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979836091131484, 'loss_val': 0.02955959002011467, 'psi': 0.996873648593245}-{'f1_val': 0.9923138665505316, 'auprc': 0.9983331458063087, 'loss_val': 0.03897795828086872, 'psi': 0.9947215782528425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=29 head_norm_before_train=1.343896 cos_to_last_merge=0.9412 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5950186878531645, 'auprc': 0.7067434489818567, 'loss_val': 0.8295300692181827, 'psi': 0.6397085923046414}-{'f1_val': 0.629369108507057, 'auprc': 0.6932392525354754, 'loss_val': 0.6308095250679036, 'psi': 0.6549171661184243}
[S14] START round=29 head_norm_before_train=1.403905 cos_to_last_merge=0.9808 (last merge round=22)
[S14] round=29 local utility u=0.005137 metrics={'f1_val': 0.9961481882456003, 'auprc': 0.9977571516574031, 'loss_val': 0.062047845603947986, 'psi': 0.9967917736103213}-{'f1_val': 0.9961471738646706, 'auprc': 0.9969098321482058, 'loss_val': 0.06977305535558433, 'psi': 0.9964522371780846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=29 head_norm_before_train=1.764412 cos_to_last_merge=0.8257 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.826
[S15] round=29 local utility u=0.912614 metrics={'f1_val': 0.9962625367239556, 'auprc': 0.9985495090707537, 'loss_val': 0.03420038162288707, 'psi': 0.9971773256626748}-{'f1_val': 0.7603340362535815, 'auprc': 0.9774125402496631, 'loss_val': 0.38044570354197543, 'psi': 0.8471654378520141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=29 head_norm_before_train=1.543720 cos_to_last_merge=0.9528 (last merge round=23)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8592856306265831, 'auprc': 0.9784853913864908, 'loss_val': 0.41913977545064024, 'psi': 0.9069655349305463}-{'f1_val': 0.9722999364849911, 'auprc': 0.992544321868674, 'loss_val': 0.13194684422885072, 'psi': 0.9803976906384643}
[S17] START round=29 head_norm_before_train=1.882118 (no previous merge yet)
[S17] round=29 local utility u=0.115586 metrics={'f1_val': 0.6758240429676474, 'auprc': 0.8270980930394325, 'loss_val': 1.1976915579857381, 'psi': 0.7363336629963615}-{'f1_val': 0.6554032749761238, 'auprc': 0.8207297741153844, 'loss_val': 1.2872339620159308, 'psi': 0.721533874631828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S5]  timeout peer S16
[S16]  timeout peer S6
[S9]  timeout peer S14
[S4]  timeout peer S11
[S13]  timeout peer S9
[S3]  timeout peer S5
[S8]  timeout peer S7
[S6]  timeout peer S4
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.697007 cos_to_last_merge=0.8192 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7284944860528498, 'auprc': 0.8637644346092657, 'loss_val': 0.40342991069611117, 'psi': 0.7826024654754162}-{'f1_val': 0.8248348274330484, 'auprc': 0.7555140335498401, 'loss_val': 0.3988795113988048, 'psi': 0.7971065098797651}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.784199 cos_to_last_merge=0.9356 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=30 local utility u=0.080280 metrics={'f1_val': 0.9870460153478404, 'auprc': 0.998853834841793, 'loss_val': 0.039780571458228865, 'psi': 0.9917691431454214}-{'f1_val': 0.9682029918726667, 'auprc': 0.9981028253352346, 'loss_val': 0.08502862228485276, 'psi': 0.9801629252576939}
[S3] not sending this round → trigger blocked (psi=0.992)
[S4] START round=30 head_norm_before_train=1.542713 cos_to_last_merge=0.9929 (last merge round=22)
[S4] round=30 local utility u=0.002606 metrics={'f1_val': 0.9542056164027174, 'auprc': 0.9559488606945915, 'loss_val': 0.26017891187687, 'psi': 0.954902914119467}-{'f1_val': 0.9525161294937544, 'auprc': 0.9593618945569152, 'loss_val': 0.2654934579864938, 'psi': 0.9552544355190187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=30 head_norm_before_train=1.574172 cos_to_last_merge=0.9939 (last merge round=21)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6832133154195291, 'auprc': 0.90816802738907, 'loss_val': 0.35289889280287734, 'psi': 0.7731952002073454}-{'f1_val': 0.700320598491359, 'auprc': 0.995166015268252, 'loss_val': 0.22250677583707434, 'psi': 0.8182587652021163}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.452188 cos_to_last_merge=0.9875 (last merge round=20)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7318368200341863, 'auprc': 0.9279728173017493, 'loss_val': 0.6428201337049319, 'psi': 0.8102912189412115}-{'f1_val': 0.9616921418945878, 'auprc': 0.9658073469357938, 'loss_val': 0.19862181606806298, 'psi': 0.9633382239110703}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.604725 cos_to_last_merge=0.9953 (last merge round=22)
[S7] round=30 local utility u=0.195765 metrics={'f1_val': 0.6473798464976604, 'auprc': 0.8114256949244849, 'loss_val': 0.43979189392497936, 'psi': 0.7129981858683903}-{'f1_val': 0.6202128947177947, 'auprc': 0.8012081725687173, 'loss_val': 0.6376677674587033, 'psi': 0.6926110058581638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] START round=30 head_norm_before_train=1.646013 cos_to_last_merge=0.9761 (last merge round=16)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9839402500608447, 'loss_val': 0.23594258448373753, 'psi': 0.8217229408986969}-{'f1_val': 0.9922164873423569, 'auprc': 0.9984858094386149, 'loss_val': 0.05018772008603664, 'psi': 0.99472421618086}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.457522 cos_to_last_merge=0.9912 (last merge round=23)
[S9] round=30 local utility u=0.005707 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9964325557585374, 'loss_val': 0.03402622842033298, 'psi': 0.9966845735587693}-{'f1_val': 0.9968525854255906, 'auprc': 0.9938169689408707, 'loss_val': 0.03759298129878369, 'psi': 0.9956383388317026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=30 head_norm_before_train=1.974454 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.995047236581652, 'auprc': 0.9930602069267772, 'loss_val': 0.043567802188174465, 'psi': 0.994252424719702}-{'f1_val': 0.9946314014883041, 'auprc': 0.9953060267269646, 'loss_val': 0.04449049380599842, 'psi': 0.9949012515837683}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=2.007036 (no previous merge yet)
[S11] round=30 local utility u=0.001453 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982797612989339, 'loss_val': 0.0276650733315139, 'psi': 0.9970043893660208}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979836091131484, 'loss_val': 0.02955959002011467, 'psi': 0.996873648593245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=30 head_norm_before_train=1.357425 cos_to_last_merge=0.9393 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=30 local utility u=0.263246 metrics={'f1_val': 0.6327860436963688, 'auprc': 0.7253124108780703, 'loss_val': 0.5853496031153651, 'psi': 0.6697965905690495}-{'f1_val': 0.5950186878531645, 'auprc': 0.7067434489818567, 'loss_val': 0.8295300692181827, 'psi': 0.6397085923046414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=30 head_norm_before_train=1.432276 cos_to_last_merge=0.9779 (last merge round=22)
[S14] round=30 local utility u=0.002992 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.996777491031433, 'loss_val': 0.05457525297942346, 'psi': 0.9965450097936771}-{'f1_val': 0.9961481882456003, 'auprc': 0.9977571516574031, 'loss_val': 0.062047845603947986, 'psi': 0.9967917736103213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.780882 cos_to_last_merge=0.8242 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8953050869680639, 'auprc': 0.9967056975179177, 'loss_val': 0.1384323174537763, 'psi': 0.9358653311880054}-{'f1_val': 0.9962625367239556, 'auprc': 0.9985495090707537, 'loss_val': 0.03420038162288707, 'psi': 0.9971773256626748}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.579479 cos_to_last_merge=0.9456 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=30 local utility u=0.590080 metrics={'f1_val': 0.9913390319889626, 'auprc': 0.9901672533745972, 'loss_val': 0.06634563805338164, 'psi': 0.9908703205432164}-{'f1_val': 0.8592856306265831, 'auprc': 0.9784853913864908, 'loss_val': 0.41913977545064024, 'psi': 0.9069655349305463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=30 head_norm_before_train=1.898327 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6362361451866795, 'auprc': 0.8142583105960155, 'loss_val': 1.4283022574131465, 'psi': 0.7074450113504138}-{'f1_val': 0.6758240429676474, 'auprc': 0.8270980930394325, 'loss_val': 1.1976915579857381, 'psi': 0.7363336629963615}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.717327 cos_to_last_merge=0.8171 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=31 local utility u=0.077796 metrics={'f1_val': 0.7576956024644159, 'auprc': 0.8691187941492966, 'loss_val': 0.4391073065000041, 'psi': 0.8022648791383682}-{'f1_val': 0.7284944860528498, 'auprc': 0.8637644346092657, 'loss_val': 0.40342991069611117, 'psi': 0.7826024654754162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=31 head_norm_before_train=1.794840 cos_to_last_merge=0.9348 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9484274677393304, 'auprc': 0.9970899609642104, 'loss_val': 0.1526245890463543, 'psi': 0.9678924650292824}-{'f1_val': 0.9870460153478404, 'auprc': 0.998853834841793, 'loss_val': 0.039780571458228865, 'psi': 0.9917691431454214}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.558178 cos_to_last_merge=0.9919 (last merge round=22)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9495113193166063, 'auprc': 0.9522304302612767, 'loss_val': 0.27600812683837095, 'psi': 0.9505989636944745}-{'f1_val': 0.9542056164027174, 'auprc': 0.9559488606945915, 'loss_val': 0.26017891187687, 'psi': 0.954902914119467}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.582638 cos_to_last_merge=0.9932 (last merge round=21)
[S5] round=31 local utility u=0.159787 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9656801537461654, 'loss_val': 0.3085039873988673, 'psi': 0.8064644205932816}-{'f1_val': 0.6832133154195291, 'auprc': 0.90816802738907, 'loss_val': 0.35289889280287734, 'psi': 0.7731952002073454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=31 head_norm_before_train=1.469651 cos_to_last_merge=0.9858 (last merge round=20)
[S6] round=31 local utility u=0.536243 metrics={'f1_val': 0.8375091324780243, 'auprc': 0.9503357712410863, 'loss_val': 0.2714569678231452, 'psi': 0.882639787983249}-{'f1_val': 0.7318368200341863, 'auprc': 0.9279728173017493, 'loss_val': 0.6428201337049319, 'psi': 0.8102912189412115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=31 head_norm_before_train=1.619592 cos_to_last_merge=0.9946 (last merge round=22)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.622456479340313, 'auprc': 0.8025114447890311, 'loss_val': 0.6328972140223245, 'psi': 0.6944784655198003}-{'f1_val': 0.6473798464976604, 'auprc': 0.8114256949244849, 'loss_val': 0.43979189392497936, 'psi': 0.7129981858683903}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.653805 cos_to_last_merge=0.9758 (last merge round=16)
[S8] round=31 local utility u=0.936080 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9987777302979671, 'loss_val': 0.056073542157487256, 'psi': 0.9924357481193247}-{'f1_val': 0.7135780681239317, 'auprc': 0.9839402500608447, 'loss_val': 0.23594258448373753, 'psi': 0.8217229408986969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=31 head_norm_before_train=1.484601 cos_to_last_merge=0.9895 (last merge round=23)
[S9] round=31 local utility u=0.000090 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9976510239276615, 'loss_val': 0.032360211609836674, 'psi': 0.9966578828625936}-{'f1_val': 0.9968525854255906, 'auprc': 0.9964325557585374, 'loss_val': 0.03402622842033298, 'psi': 0.9966845735587693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S9] sending update (kind=head size=1808 to 1 peers)
[S10] START round=31 head_norm_before_train=1.988704 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947821544713022, 'auprc': 0.992634034808459, 'loss_val': 0.06534831953685724, 'psi': 0.993922906606165}-{'f1_val': 0.995047236581652, 'auprc': 0.9930602069267772, 'loss_val': 0.043567802188174465, 'psi': 0.994252424719702}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=2.019324 (no previous merge yet)
[S11] round=31 local utility u=0.000315 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998190405037302, 'loss_val': 0.02664404936025733, 'psi': 0.9969563669629065}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982797612989339, 'loss_val': 0.0276650733315139, 'psi': 0.9970043893660208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=31 head_norm_before_train=1.371195 cos_to_last_merge=0.9368 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6100734051486637, 'auprc': 0.7151577350197806, 'loss_val': 0.7494814093932609, 'psi': 0.6521071370971104}-{'f1_val': 0.6327860436963688, 'auprc': 0.7253124108780703, 'loss_val': 0.5853496031153651, 'psi': 0.6697965905690495}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.458344 cos_to_last_merge=0.9752 (last merge round=22)
[S14] round=31 local utility u=0.008410 metrics={'f1_val': 0.9973060238921251, 'auprc': 0.9984733658737519, 'loss_val': 0.048339535788170365, 'psi': 0.9977729606847758}-{'f1_val': 0.9963900223018398, 'auprc': 0.996777491031433, 'loss_val': 0.05457525297942346, 'psi': 0.9965450097936771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=31 head_norm_before_train=1.796801 cos_to_last_merge=0.8228 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.823
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7546341061758914, 'auprc': 0.9221966454543118, 'loss_val': 0.4580964035273105, 'psi': 0.8216591218872595}-{'f1_val': 0.8953050869680639, 'auprc': 0.9967056975179177, 'loss_val': 0.1384323174537763, 'psi': 0.9358653311880054}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.608840 cos_to_last_merge=0.9402 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8498908627799231, 'auprc': 0.9731117494239832, 'loss_val': 0.7952236524563963, 'psi': 0.8991792174375471}-{'f1_val': 0.9913390319889626, 'auprc': 0.9901672533745972, 'loss_val': 0.06634563805338164, 'psi': 0.9908703205432164}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.908193 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6438800734514037, 'auprc': 0.7893193870971609, 'loss_val': 1.4675985562508258, 'psi': 0.7020557989097067}-{'f1_val': 0.6362361451866795, 'auprc': 0.8142583105960155, 'loss_val': 1.4283022574131465, 'psi': 0.7074450113504138}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.739224 cos_to_last_merge=0.8149 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=32 local utility u=0.169765 metrics={'f1_val': 0.8270827581545427, 'auprc': 0.8387670818947908, 'loss_val': 0.4248442915806119, 'psi': 0.8317564876506419}-{'f1_val': 0.7576956024644159, 'auprc': 0.8691187941492966, 'loss_val': 0.4391073065000041, 'psi': 0.8022648791383682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=32 head_norm_before_train=1.805381 cos_to_last_merge=0.9341 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=32 local utility u=0.214490 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.999022389569415, 'loss_val': 0.02343936131958305, 'psi': 0.9980652333997005}-{'f1_val': 0.9484274677393304, 'auprc': 0.9970899609642104, 'loss_val': 0.1526245890463543, 'psi': 0.9678924650292824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=32 head_norm_before_train=1.573201 cos_to_last_merge=0.9908 (last merge round=22)
[S4] round=32 local utility u=0.037195 metrics={'f1_val': 0.9502219509684926, 'auprc': 0.9731036866803553, 'loss_val': 0.2685011073239461, 'psi': 0.9593746452532377}-{'f1_val': 0.9495113193166063, 'auprc': 0.9522304302612767, 'loss_val': 0.27600812683837095, 'psi': 0.9505989636944745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=32 head_norm_before_train=1.590856 cos_to_last_merge=0.9925 (last merge round=21)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.586576442720731, 'auprc': 0.7859207562312186, 'loss_val': 0.6713289782049685, 'psi': 0.666314168124926}-{'f1_val': 0.700320598491359, 'auprc': 0.9656801537461654, 'loss_val': 0.3085039873988673, 'psi': 0.8064644205932816}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.483955 cos_to_last_merge=0.9838 (last merge round=20)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8233353709217175, 'auprc': 0.9609733358797833, 'loss_val': 0.3015305401295128, 'psi': 0.8783905569049438}-{'f1_val': 0.8375091324780243, 'auprc': 0.9503357712410863, 'loss_val': 0.2714569678231452, 'psi': 0.882639787983249}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.630429 cos_to_last_merge=0.9939 (last merge round=22)
[S7] round=32 local utility u=0.162472 metrics={'f1_val': 0.6425713564779691, 'auprc': 0.8103245491748946, 'loss_val': 0.4520824943105022, 'psi': 0.7096726335567394}-{'f1_val': 0.622456479340313, 'auprc': 0.8025114447890311, 'loss_val': 0.6328972140223245, 'psi': 0.6944784655198003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=32 head_norm_before_train=1.653724 cos_to_last_merge=0.9751 (last merge round=16)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.7351904344551029, 'auprc': 0.9849669880670368, 'loss_val': 0.18118853199602045, 'psi': 0.8351010558998765}-{'f1_val': 0.9882077600002297, 'auprc': 0.9987777302979671, 'loss_val': 0.056073542157487256, 'psi': 0.9924357481193247}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.507416 cos_to_last_merge=0.9881 (last merge round=23)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9954277079093184, 'loss_val': 0.030103900821299448, 'psi': 0.9960363816706533}-{'f1_val': 0.9959957888192151, 'auprc': 0.9976510239276615, 'loss_val': 0.032360211609836674, 'psi': 0.9966578828625936}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.999518 (no previous merge yet)
[S10] round=32 local utility u=0.000914 metrics={'f1_val': 0.9942999998531838, 'auprc': 0.9938262676808054, 'loss_val': 0.06420440374264337, 'psi': 0.9941105069842324}-{'f1_val': 0.9947821544713022, 'auprc': 0.992634034808459, 'loss_val': 0.06534831953685724, 'psi': 0.993922906606165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=32 head_norm_before_train=2.033173 (no previous merge yet)
[S11] round=32 local utility u=0.000328 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981171403847037, 'loss_val': 0.025768695562818134, 'psi': 0.996927061101867}-{'f1_val': 0.9961336749133093, 'auprc': 0.998190405037302, 'loss_val': 0.02664404936025733, 'psi': 0.9969563669629065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=32 head_norm_before_train=1.383472 cos_to_last_merge=0.9345 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=32 local utility u=0.076075 metrics={'f1_val': 0.6297609029482973, 'auprc': 0.6907226539368208, 'loss_val': 0.6421521528594771, 'psi': 0.6541456033437067}-{'f1_val': 0.6100734051486637, 'auprc': 0.7151577350197806, 'loss_val': 0.7494814093932609, 'psi': 0.6521071370971104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=32 head_norm_before_train=1.481402 cos_to_last_merge=0.9728 (last merge round=22)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.997043018986542, 'auprc': 0.9966738713178362, 'loss_val': 0.04545538280929453, 'psi': 0.9968953599190598}-{'f1_val': 0.9973060238921251, 'auprc': 0.9984733658737519, 'loss_val': 0.048339535788170365, 'psi': 0.9977729606847758}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.811841 cos_to_last_merge=0.8214 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.821
[S15] round=32 local utility u=0.989648 metrics={'f1_val': 0.9793294998056954, 'auprc': 0.9971315295316855, 'loss_val': 0.051777800185428394, 'psi': 0.9864503116960914}-{'f1_val': 0.7546341061758914, 'auprc': 0.9221966454543118, 'loss_val': 0.4580964035273105, 'psi': 0.8216591218872595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=32 head_norm_before_train=1.631751 cos_to_last_merge=0.9362 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8351268440024773, 'auprc': 0.9620730445246533, 'loss_val': 0.9559984634972836, 'psi': 0.8859053242113477}-{'f1_val': 0.8498908627799231, 'auprc': 0.9731117494239832, 'loss_val': 0.7952236524563963, 'psi': 0.8991792174375471}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.915230 (no previous merge yet)
[S17] round=32 local utility u=0.129202 metrics={'f1_val': 0.6554825821917153, 'auprc': 0.8188124650868285, 'loss_val': 1.3672890936295485, 'psi': 0.7208145353497606}-{'f1_val': 0.6438800734514037, 'auprc': 0.7893193870971609, 'loss_val': 1.4675985562508258, 'psi': 0.7020557989097067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=33 head_norm_before_train=1.756706 cos_to_last_merge=0.8132 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.813
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8270827581545427, 'auprc': 0.8027469627300817, 'loss_val': 0.4146604303402899, 'psi': 0.8173484399847584}-{'f1_val': 0.8270827581545427, 'auprc': 0.8387670818947908, 'loss_val': 0.4248442915806119, 'psi': 0.8317564876506419}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.820362 cos_to_last_merge=0.9330 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.968228981621029, 'auprc': 0.998501632283546, 'loss_val': 0.08544330814686428, 'psi': 0.9803380418860358}-{'f1_val': 0.9974271292865575, 'auprc': 0.999022389569415, 'loss_val': 0.02343936131958305, 'psi': 0.9980652333997005}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.585546 cos_to_last_merge=0.9897 (last merge round=22)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9458175127798095, 'auprc': 0.9399185892127517, 'loss_val': 0.28136227493270405, 'psi': 0.9434579433529864}-{'f1_val': 0.9502219509684926, 'auprc': 0.9731036866803553, 'loss_val': 0.2685011073239461, 'psi': 0.9593746452532377}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.599360 cos_to_last_merge=0.9914 (last merge round=21)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.5696940522593703, 'auprc': 0.6914933394066539, 'loss_val': 0.7563148276956555, 'psi': 0.6184137671182838}-{'f1_val': 0.586576442720731, 'auprc': 0.7859207562312186, 'loss_val': 0.6713289782049685, 'psi': 0.666314168124926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.497596 cos_to_last_merge=0.9821 (last merge round=20)
[S6] round=33 local utility u=0.432850 metrics={'f1_val': 0.94676189791536, 'auprc': 0.972135355383656, 'loss_val': 0.20987548665263167, 'psi': 0.9569112809026785}-{'f1_val': 0.8233353709217175, 'auprc': 0.9609733358797833, 'loss_val': 0.3015305401295128, 'psi': 0.8783905569049438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=33 head_norm_before_train=1.645707 cos_to_last_merge=0.9929 (last merge round=22)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6219308282424935, 'auprc': 0.8015016208142148, 'loss_val': 0.6844421730588248, 'psi': 0.693759145271182}-{'f1_val': 0.6425713564779691, 'auprc': 0.8103245491748946, 'loss_val': 0.4520824943105022, 'psi': 0.7096726335567394}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.653072 cos_to_last_merge=0.9750 (last merge round=16)
[S8] round=33 local utility u=0.844620 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9987819611688937, 'loss_val': 0.053644105598962204, 'psi': 0.9926522024349491}-{'f1_val': 0.7351904344551029, 'auprc': 0.9849669880670368, 'loss_val': 0.18118853199602045, 'psi': 0.8351010558998765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=33 head_norm_before_train=1.526537 cos_to_last_merge=0.9870 (last merge round=23)
[S9] round=33 local utility u=0.000861 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984119331167167, 'loss_val': 0.02967363237423564, 'psi': 0.9964640770806558}-{'f1_val': 0.99644216417821, 'auprc': 0.9954277079093184, 'loss_val': 0.030103900821299448, 'psi': 0.9960363816706533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=33 head_norm_before_train=2.010016 (no previous merge yet)
[S10] round=33 local utility u=0.014518 metrics={'f1_val': 0.995047236581652, 'auprc': 0.9946768861086592, 'loss_val': 0.04220320114027515, 'psi': 0.9948990963924549}-{'f1_val': 0.9942999998531838, 'auprc': 0.9938262676808054, 'loss_val': 0.06420440374264337, 'psi': 0.9941105069842324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=33 head_norm_before_train=2.046872 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9911198146213613, 'auprc': 0.9982848250304068, 'loss_val': 0.03713618990716303, 'psi': 0.9939858187849795}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981171403847037, 'loss_val': 0.025768695562818134, 'psi': 0.996927061101867}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.395236 cos_to_last_merge=0.9330 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6209937459858756, 'auprc': 0.7109303502213847, 'loss_val': 0.7276113716748125, 'psi': 0.6569683876800793}-{'f1_val': 0.6297609029482973, 'auprc': 0.6907226539368208, 'loss_val': 0.6421521528594771, 'psi': 0.6541456033437067}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.503318 cos_to_last_merge=0.9704 (last merge round=22)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9965448711663262, 'loss_val': 0.044419114074667705, 'psi': 0.9963200126366967}-{'f1_val': 0.997043018986542, 'auprc': 0.9966738713178362, 'loss_val': 0.04545538280929453, 'psi': 0.9968953599190598}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.827884 cos_to_last_merge=0.8199 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.820
[S15] round=33 local utility u=0.057573 metrics={'f1_val': 0.9951611201824148, 'auprc': 0.9979550199518428, 'loss_val': 0.03409229211071868, 'psi': 0.9962786800901859}-{'f1_val': 0.9793294998056954, 'auprc': 0.9971315295316855, 'loss_val': 0.051777800185428394, 'psi': 0.9864503116960914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=33 head_norm_before_train=1.652325 cos_to_last_merge=0.9326 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=33 local utility u=0.932734 metrics={'f1_val': 0.9846030465414101, 'auprc': 0.9918316576854538, 'loss_val': 0.07666412575289117, 'psi': 0.9874944909990275}-{'f1_val': 0.8351268440024773, 'auprc': 0.9620730445246533, 'loss_val': 0.9559984634972836, 'psi': 0.8859053242113477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=33 head_norm_before_train=1.920801 (no previous merge yet)
[S17] round=33 local utility u=0.001284 metrics={'f1_val': 0.6533440930935628, 'auprc': 0.8233776001035165, 'loss_val': 1.3655858179961455, 'psi': 0.7213574958975442}-{'f1_val': 0.6554825821917153, 'auprc': 0.8188124650868285, 'loss_val': 1.3672890936295485, 'psi': 0.7208145353497606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=34 head_norm_before_train=1.772936 cos_to_last_merge=0.8114 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7553746624373041, 'auprc': 0.864740352797946, 'loss_val': 0.4499443775221298, 'psi': 0.7991209385815609}-{'f1_val': 0.8270827581545427, 'auprc': 0.8027469627300817, 'loss_val': 0.4146604303402899, 'psi': 0.8173484399847584}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.834591 cos_to_last_merge=0.9321 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9980952562489747, 'loss_val': 0.164192579370698, 'psi': 0.9755644262390581}-{'f1_val': 0.968228981621029, 'auprc': 0.998501632283546, 'loss_val': 0.08544330814686428, 'psi': 0.9803380418860358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.597188 cos_to_last_merge=0.9887 (last merge round=22)
[S4] round=34 local utility u=0.044114 metrics={'f1_val': 0.9535550676230751, 'auprc': 0.9486666908388278, 'loss_val': 0.2658035256008543, 'psi': 0.9515997169093762}-{'f1_val': 0.9458175127798095, 'auprc': 0.9399185892127517, 'loss_val': 0.28136227493270405, 'psi': 0.9434579433529864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.608668 cos_to_last_merge=0.9902 (last merge round=21)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.44323111813592975, 'auprc': 0.773378108049448, 'loss_val': 0.9753276582064929, 'psi': 0.575289914101337}-{'f1_val': 0.5696940522593703, 'auprc': 0.6914933394066539, 'loss_val': 0.7563148276956555, 'psi': 0.6184137671182838}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.510591 cos_to_last_merge=0.9808 (last merge round=20)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7743990559836693, 'auprc': 0.9431824692567199, 'loss_val': 0.6252015025502144, 'psi': 0.8419124212928895}-{'f1_val': 0.94676189791536, 'auprc': 0.972135355383656, 'loss_val': 0.20987548665263167, 'psi': 0.9569112809026785}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.658004 cos_to_last_merge=0.9921 (last merge round=22)
[S7] round=34 local utility u=0.270933 metrics={'f1_val': 0.6611725096337085, 'auprc': 0.811470995690197, 'loss_val': 0.4079335708889502, 'psi': 0.721291904056304}-{'f1_val': 0.6219308282424935, 'auprc': 0.8015016208142148, 'loss_val': 0.6844421730588248, 'psi': 0.693759145271182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=34 head_norm_before_train=1.656673 cos_to_last_merge=0.9745 (last merge round=16)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9830187779457308, 'loss_val': 0.30652190292843806, 'psi': 0.8214598047375938}-{'f1_val': 0.9885656966123193, 'auprc': 0.9987819611688937, 'loss_val': 0.053644105598962204, 'psi': 0.9926522024349491}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.544650 cos_to_last_merge=0.9859 (last merge round=23)
[S9] round=34 local utility u=0.005470 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971022815969848, 'loss_val': 0.02642825163162444, 'psi': 0.9971026601460796}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984119331167167, 'loss_val': 0.02967363237423564, 'psi': 0.9964640770806558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=34 head_norm_before_train=2.021708 (no previous merge yet)
[S10] round=34 local utility u=0.001002 metrics={'f1_val': 0.9954625686799674, 'auprc': 0.994638056482485, 'loss_val': 0.04257445238902316, 'psi': 0.9951327638009744}-{'f1_val': 0.995047236581652, 'auprc': 0.9946768861086592, 'loss_val': 0.04220320114027515, 'psi': 0.9948990963924549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=34 head_norm_before_train=2.059317 (no previous merge yet)
[S11] round=34 local utility u=0.020734 metrics={'f1_val': 0.9959130523161147, 'auprc': 0.9983000103362609, 'loss_val': 0.024473483328217794, 'psi': 0.9968678355241732}-{'f1_val': 0.9911198146213613, 'auprc': 0.9982848250304068, 'loss_val': 0.03713618990716303, 'psi': 0.9939858187849795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=34 head_norm_before_train=1.404197 cos_to_last_merge=0.9319 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6174241355013959, 'auprc': 0.7124064580552515, 'loss_val': 0.7504061284360242, 'psi': 0.6554170645229381}-{'f1_val': 0.6209937459858756, 'auprc': 0.7109303502213847, 'loss_val': 0.7276113716748125, 'psi': 0.6569683876800793}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.523818 cos_to_last_merge=0.9683 (last merge round=22)
[S14] round=34 local utility u=0.007422 metrics={'f1_val': 0.9968957473452102, 'auprc': 0.9984616618593092, 'loss_val': 0.03967983495385848, 'psi': 0.9975221131508498}-{'f1_val': 0.9961701069502772, 'auprc': 0.9965448711663262, 'loss_val': 0.044419114074667705, 'psi': 0.9963200126366967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=34 head_norm_before_train=1.842891 cos_to_last_merge=0.8186 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8474452272622748, 'auprc': 0.9957105791095671, 'loss_val': 0.22899510712192023, 'psi': 0.9067513680011917}-{'f1_val': 0.9951611201824148, 'auprc': 0.9979550199518428, 'loss_val': 0.03409229211071868, 'psi': 0.9962786800901859}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.668799 cos_to_last_merge=0.9300 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8257609970631813, 'auprc': 0.9433377137870469, 'loss_val': 0.6847264201896947, 'psi': 0.8727916837527275}-{'f1_val': 0.9846030465414101, 'auprc': 0.9918316576854538, 'loss_val': 0.07666412575289117, 'psi': 0.9874944909990275}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.929019 (no previous merge yet)
[S17] round=34 local utility u=0.120642 metrics={'f1_val': 0.6760378225418335, 'auprc': 0.8261166656601636, 'loss_val': 1.2686822396506476, 'psi': 0.7360693597891657}-{'f1_val': 0.6533440930935628, 'auprc': 0.8233776001035165, 'loss_val': 1.3655858179961455, 'psi': 0.7213574958975442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=35 head_norm_before_train=1.787466 cos_to_last_merge=0.8097 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=35 local utility u=0.016151 metrics={'f1_val': 0.7594461123910237, 'auprc': 0.867522011389932, 'loss_val': 0.4504152448853572, 'psi': 0.802676471990587}-{'f1_val': 0.7553746624373041, 'auprc': 0.864740352797946, 'loss_val': 0.4499443775221298, 'psi': 0.7991209385815609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=35 head_norm_before_train=1.846128 cos_to_last_merge=0.9308 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9402755207895401, 'auprc': 0.9979232718654676, 'loss_val': 0.1166682941573729, 'psi': 0.9633346212199111}-{'f1_val': 0.9605438728991138, 'auprc': 0.9980952562489747, 'loss_val': 0.164192579370698, 'psi': 0.9755644262390581}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.611258 cos_to_last_merge=0.9877 (last merge round=22)
[S4] round=35 local utility u=0.001936 metrics={'f1_val': 0.9515090383162764, 'auprc': 0.9550611344898357, 'loss_val': 0.26883806657054543, 'psi': 0.9529298767857002}-{'f1_val': 0.9535550676230751, 'auprc': 0.9486666908388278, 'loss_val': 0.2658035256008543, 'psi': 0.9515997169093762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=35 head_norm_before_train=1.612229 cos_to_last_merge=0.9901 (last merge round=21)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9955984112065076, 'loss_val': 0.15626512607590679, 'psi': 0.8184321549429513}-{'f1_val': 0.44323111813592975, 'auprc': 0.773378108049448, 'loss_val': 0.9753276582064929, 'psi': 0.575289914101337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=35 head_norm_before_train=1.525647 cos_to_last_merge=0.9795 (last merge round=20)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7745255184226487, 'auprc': 0.933433905840007, 'loss_val': 0.6139029301454961, 'psi': 0.838088873389592}-{'f1_val': 0.7743990559836693, 'auprc': 0.9431824692567199, 'loss_val': 0.6252015025502144, 'psi': 0.8419124212928895}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.668641 cos_to_last_merge=0.9912 (last merge round=22)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5844646146093744, 'auprc': 0.7950699454127462, 'loss_val': 0.8251891424179078, 'psi': 0.6687067469307231}-{'f1_val': 0.6611725096337085, 'auprc': 0.811470995690197, 'loss_val': 0.4079335708889502, 'psi': 0.721291904056304}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.663551 cos_to_last_merge=0.9738 (last merge round=16)
[S8] round=35 local utility u=0.988198 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9982833446619033, 'loss_val': 0.04644305364955187, 'psi': 0.9946178820828283}-{'f1_val': 0.7137538225988359, 'auprc': 0.9830187779457308, 'loss_val': 0.30652190292843806, 'psi': 0.8214598047375938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=35 head_norm_before_train=1.561362 cos_to_last_merge=0.9849 (last merge round=23)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998403680556495, 'loss_val': 0.027276856733934957, 'psi': 0.9969738934089103}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971022815969848, 'loss_val': 0.02642825163162444, 'psi': 0.9971026601460796}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.028595 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.991570226559971, 'auprc': 0.9922844783944694, 'loss_val': 0.07457499735284416, 'psi': 0.9918559272937704}-{'f1_val': 0.9954625686799674, 'auprc': 0.994638056482485, 'loss_val': 0.04257445238902316, 'psi': 0.9951327638009744}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=2.068413 (no previous merge yet)
[S11] round=35 local utility u=0.000347 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981288193929281, 'loss_val': 0.024590024901842828, 'psi': 0.9969317327051568}-{'f1_val': 0.9959130523161147, 'auprc': 0.9983000103362609, 'loss_val': 0.024473483328217794, 'psi': 0.9968678355241732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.415380 cos_to_last_merge=0.9305 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.602809680143787, 'auprc': 0.7003806003027478, 'loss_val': 0.8393330306870734, 'psi': 0.6418380482073713}-{'f1_val': 0.6174241355013959, 'auprc': 0.7124064580552515, 'loss_val': 0.7504061284360242, 'psi': 0.6554170645229381}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.539461 cos_to_last_merge=0.9670 (last merge round=22)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965831726061278, 'auprc': 0.9966859475116832, 'loss_val': 0.04078802565111289, 'psi': 0.99662428256835}-{'f1_val': 0.9968957473452102, 'auprc': 0.9984616618593092, 'loss_val': 0.03967983495385848, 'psi': 0.9975221131508498}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.856547 cos_to_last_merge=0.8175 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.817
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7803256758841881, 'auprc': 0.9914446315191723, 'loss_val': 0.31942915792347587, 'psi': 0.8647732581381817}-{'f1_val': 0.8474452272622748, 'auprc': 0.9957105791095671, 'loss_val': 0.22899510712192023, 'psi': 0.9067513680011917}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.684022 cos_to_last_merge=0.9277 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=35 local utility u=0.893731 metrics={'f1_val': 0.9917627394470626, 'auprc': 0.9951110636049694, 'loss_val': 0.04859564170632395, 'psi': 0.9931020691102252}-{'f1_val': 0.8257609970631813, 'auprc': 0.9433377137870469, 'loss_val': 0.6847264201896947, 'psi': 0.8727916837527275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=35 head_norm_before_train=1.938350 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6574120268159803, 'auprc': 0.8348533711971989, 'loss_val': 1.3261135496952166, 'psi': 0.7283885645684678}-{'f1_val': 0.6760378225418335, 'auprc': 0.8261166656601636, 'loss_val': 1.2686822396506476, 'psi': 0.7360693597891657}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.801421 cos_to_last_merge=0.8083 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.808
[S2] round=36 local utility u=0.064195 metrics={'f1_val': 0.8307933718689708, 'auprc': 0.7522322475331948, 'loss_val': 0.40423898327483254, 'psi': 0.7993689221346605}-{'f1_val': 0.7594461123910237, 'auprc': 0.867522011389932, 'loss_val': 0.4504152448853572, 'psi': 0.802676471990587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=36 head_norm_before_train=1.859445 cos_to_last_merge=0.9298 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=36 local utility u=0.050891 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9990230004560616, 'loss_val': 0.14274429867346278, 'psi': 0.9762303508456909}-{'f1_val': 0.9402755207895401, 'auprc': 0.9979232718654676, 'loss_val': 0.1166682941573729, 'psi': 0.9633346212199111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=36 head_norm_before_train=1.622645 cos_to_last_merge=0.9869 (last merge round=22)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9412742411646187, 'auprc': 0.938951699065155, 'loss_val': 0.30241739676675894, 'psi': 0.9403452243248331}-{'f1_val': 0.9515090383162764, 'auprc': 0.9550611344898357, 'loss_val': 0.26883806657054543, 'psi': 0.9529298767857002}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.613339 cos_to_last_merge=0.9902 (last merge round=21)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.6636734247147617, 'auprc': 0.6629979877668478, 'loss_val': 0.5093071323533876, 'psi': 0.6634032499355961}-{'f1_val': 0.7003213174339138, 'auprc': 0.9955984112065076, 'loss_val': 0.15626512607590679, 'psi': 0.8184321549429513}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.540664 cos_to_last_merge=0.9782 (last merge round=20)
[S6] round=36 local utility u=0.981373 metrics={'f1_val': 0.9846365682864755, 'auprc': 0.992523747897935, 'loss_val': 0.0890923996500288, 'psi': 0.9877914401310592}-{'f1_val': 0.7745255184226487, 'auprc': 0.933433905840007, 'loss_val': 0.6139029301454961, 'psi': 0.838088873389592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=36 head_norm_before_train=1.679402 cos_to_last_merge=0.9903 (last merge round=22)
[S7] round=36 local utility u=0.077118 metrics={'f1_val': 0.5965505661318969, 'auprc': 0.7954321247994369, 'loss_val': 0.7445560293293041, 'psi': 0.6761031895989129}-{'f1_val': 0.5844646146093744, 'auprc': 0.7950699454127462, 'loss_val': 0.8251891424179078, 'psi': 0.6687067469307231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=36 head_norm_before_train=1.670756 cos_to_last_merge=0.9736 (last merge round=16)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.993285624290135, 'auprc': 0.9917039262490024, 'loss_val': 0.04583864192356066, 'psi': 0.992652945073682}-{'f1_val': 0.992174240363445, 'auprc': 0.9982833446619033, 'loss_val': 0.04644305364955187, 'psi': 0.9946178820828283}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.578439 cos_to_last_merge=0.9838 (last merge round=23)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9934882193570039, 'loss_val': 0.026245539091297447, 'psi': 0.9954107825016589}-{'f1_val': 0.9960207019771873, 'auprc': 0.998403680556495, 'loss_val': 0.027276856733934957, 'psi': 0.9969738934089103}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.036365 (no previous merge yet)
[S10] round=36 local utility u=0.025324 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9936792869264417, 'loss_val': 0.04813610722195083, 'psi': 0.994416297378057}-{'f1_val': 0.991570226559971, 'auprc': 0.9922844783944694, 'loss_val': 0.07457499735284416, 'psi': 0.9918559272937704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=36 head_norm_before_train=2.078960 (no previous merge yet)
[S11] round=36 local utility u=0.000507 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982147165606763, 'loss_val': 0.02383355828025362, 'psi': 0.9969660915722561}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981288193929281, 'loss_val': 0.024590024901842828, 'psi': 0.9969317327051568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=36 head_norm_before_train=1.428465 cos_to_last_merge=0.9289 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=36 local utility u=0.262874 metrics={'f1_val': 0.6297624056423976, 'auprc': 0.7468278243045924, 'loss_val': 0.6146423077579011, 'psi': 0.6765885731072755}-{'f1_val': 0.602809680143787, 'auprc': 0.7003806003027478, 'loss_val': 0.8393330306870734, 'psi': 0.6418380482073713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=36 head_norm_before_train=1.552238 cos_to_last_merge=0.9656 (last merge round=22)
[S14] round=36 local utility u=0.006318 metrics={'f1_val': 0.9970633655553506, 'auprc': 0.9985471021324456, 'loss_val': 0.036617365561123674, 'psi': 0.9976568601861886}-{'f1_val': 0.9965831726061278, 'auprc': 0.9966859475116832, 'loss_val': 0.04078802565111289, 'psi': 0.99662428256835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=36 head_norm_before_train=1.869766 cos_to_last_merge=0.8163 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.816
[S15] round=36 local utility u=0.806265 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972922705080585, 'loss_val': 0.022968009757560616, 'psi': 0.9969649092357358}-{'f1_val': 0.7803256758841881, 'auprc': 0.9914446315191723, 'loss_val': 0.31942915792347587, 'psi': 0.8647732581381817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=36 head_norm_before_train=1.696179 cos_to_last_merge=0.9258 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9511193261772501, 'auprc': 0.9939829955208808, 'loss_val': 0.14244757221103957, 'psi': 0.9682647939147024}-{'f1_val': 0.9917627394470626, 'auprc': 0.9951110636049694, 'loss_val': 0.04859564170632395, 'psi': 0.9931020691102252}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.946134 (no previous merge yet)
[S17] round=36 local utility u=0.138645 metrics={'f1_val': 0.6838089364049553, 'auprc': 0.8363986925178261, 'loss_val': 1.2118400410353802, 'psi': 0.7448448388501037}-{'f1_val': 0.6574120268159803, 'auprc': 0.8348533711971989, 'loss_val': 1.3261135496952166, 'psi': 0.7283885645684678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=37 head_norm_before_train=1.812731 cos_to_last_merge=0.8071 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7181600394257409, 'auprc': 0.8930704854359002, 'loss_val': 0.4856021679226796, 'psi': 0.7881242178298047}-{'f1_val': 0.8307933718689708, 'auprc': 0.7522322475331948, 'loss_val': 0.40423898327483254, 'psi': 0.7993689221346605}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.875013 cos_to_last_merge=0.9287 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=37 local utility u=0.170550 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9993762745195427, 'loss_val': 0.020881582306804623, 'psi': 0.9981894512754516}-{'f1_val': 0.9610352511054436, 'auprc': 0.9990230004560616, 'loss_val': 0.14274429867346278, 'psi': 0.9762303508456909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=37 head_norm_before_train=1.632672 cos_to_last_merge=0.9860 (last merge round=22)
[S4] round=37 local utility u=0.050734 metrics={'f1_val': 0.9415214126726058, 'auprc': 0.9671701950734501, 'loss_val': 0.2870887913982407, 'psi': 0.9517809256329435}-{'f1_val': 0.9412742411646187, 'auprc': 0.938951699065155, 'loss_val': 0.30241739676675894, 'psi': 0.9403452243248331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=37 head_norm_before_train=1.614317 cos_to_last_merge=0.9900 (last merge round=21)
[S5] round=37 local utility u=0.712867 metrics={'f1_val': 0.7154528749282973, 'auprc': 0.9581382601214565, 'loss_val': 0.27967041338906057, 'psi': 0.8125270290055611}-{'f1_val': 0.6636734247147617, 'auprc': 0.6629979877668478, 'loss_val': 0.5093071323533876, 'psi': 0.6634032499355961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=37 head_norm_before_train=1.554872 cos_to_last_merge=0.9770 (last merge round=20)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6147936207676439, 'auprc': 0.7806459023228248, 'loss_val': 0.9031105316060899, 'psi': 0.6811345333897163}-{'f1_val': 0.9846365682864755, 'auprc': 0.992523747897935, 'loss_val': 0.0890923996500288, 'psi': 0.9877914401310592}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.686796 cos_to_last_merge=0.9897 (last merge round=22)
[S7] round=37 local utility u=0.234054 metrics={'f1_val': 0.6437837573447944, 'auprc': 0.805391276900732, 'loss_val': 0.5897244104171894, 'psi': 0.7084267651671694}-{'f1_val': 0.5965505661318969, 'auprc': 0.7954321247994369, 'loss_val': 0.7445560293293041, 'psi': 0.6761031895989129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=37 head_norm_before_train=1.680955 cos_to_last_merge=0.9733 (last merge round=16)
[S8] round=37 local utility u=0.007517 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9982505451620199, 'loss_val': 0.04371797195497705, 'psi': 0.9945989877378393}-{'f1_val': 0.993285624290135, 'auprc': 0.9917039262490024, 'loss_val': 0.04583864192356066, 'psi': 0.992652945073682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=37 head_norm_before_train=1.593270 cos_to_last_merge=0.9829 (last merge round=23)
[S9] round=37 local utility u=0.003162 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9948680335870741, 'loss_val': 0.02502057355450882, 'psi': 0.996058764690184}-{'f1_val': 0.9966924912647621, 'auprc': 0.9934882193570039, 'loss_val': 0.026245539091297447, 'psi': 0.9954107825016589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=37 head_norm_before_train=2.045588 (no previous merge yet)
[S10] round=37 local utility u=0.001222 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9950088094722807, 'loss_val': 0.049681627047474405, 'psi': 0.9949481063963925}-{'f1_val': 0.9949076376791339, 'auprc': 0.9936792869264417, 'loss_val': 0.04813610722195083, 'psi': 0.994416297378057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=37 head_norm_before_train=2.090002 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9954312449678927, 'auprc': 0.9982765957370671, 'loss_val': 0.029943287366887752, 'psi': 0.9965693852755624}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982147165606763, 'loss_val': 0.02383355828025362, 'psi': 0.9969660915722561}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.440168 cos_to_last_merge=0.9271 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6281172471317041, 'auprc': 0.7318749017172671, 'loss_val': 0.666870944932263, 'psi': 0.6696203089659294}-{'f1_val': 0.6297624056423976, 'auprc': 0.7468278243045924, 'loss_val': 0.6146423077579011, 'psi': 0.6765885731072755}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.566121 cos_to_last_merge=0.9640 (last merge round=22)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9987744104660345, 'loss_val': 0.03610806090795886, 'psi': 0.9975899430119125}-{'f1_val': 0.9970633655553506, 'auprc': 0.9985471021324456, 'loss_val': 0.036617365561123674, 'psi': 0.9976568601861886}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.882994 cos_to_last_merge=0.8150 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7007449487928452, 'auprc': 0.824564672609067, 'loss_val': 0.7044483623922789, 'psi': 0.750272838319334}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972922705080585, 'loss_val': 0.022968009757560616, 'psi': 0.9969649092357358}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.706571 cos_to_last_merge=0.9243 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8844978730172428, 'auprc': 0.9870757250088611, 'loss_val': 0.576746744403819, 'psi': 0.9255290138138901}-{'f1_val': 0.9511193261772501, 'auprc': 0.9939829955208808, 'loss_val': 0.14244757221103957, 'psi': 0.9682647939147024}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.953141 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6552515572942302, 'auprc': 0.8271412033428003, 'loss_val': 1.3890142462297894, 'psi': 0.7240074157136582}-{'f1_val': 0.6838089364049553, 'auprc': 0.8363986925178261, 'loss_val': 1.2118400410353802, 'psi': 0.7448448388501037}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.821642 cos_to_last_merge=0.8061 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=38 local utility u=0.252787 metrics={'f1_val': 0.8253609927351723, 'auprc': 0.8355196478827487, 'loss_val': 0.45058225960165504, 'psi': 0.8294244547942028}-{'f1_val': 0.7181600394257409, 'auprc': 0.8930704854359002, 'loss_val': 0.4856021679226796, 'psi': 0.7881242178298047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=38 head_norm_before_train=1.889393 cos_to_last_merge=0.9277 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9991498171885063, 'loss_val': 0.14501516730074113, 'psi': 0.9763049781150748}-{'f1_val': 0.9973982357793907, 'auprc': 0.9993762745195427, 'loss_val': 0.020881582306804623, 'psi': 0.9981894512754516}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.647548 cos_to_last_merge=0.9848 (last merge round=22)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9413156515161096, 'auprc': 0.9633208515712959, 'loss_val': 0.30301624736720306, 'psi': 0.9501177315381841}-{'f1_val': 0.9415214126726058, 'auprc': 0.9671701950734501, 'loss_val': 0.2870887913982407, 'psi': 0.9517809256329435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.618662 cos_to_last_merge=0.9894 (last merge round=21)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6268201844925644, 'auprc': 0.6944282750488273, 'loss_val': 0.6048763113368933, 'psi': 0.6538634207150695}-{'f1_val': 0.7154528749282973, 'auprc': 0.9581382601214565, 'loss_val': 0.27967041338906057, 'psi': 0.8125270290055611}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.564048 cos_to_last_merge=0.9759 (last merge round=20)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6005693347391243, 'auprc': 0.7353985068514468, 'loss_val': 1.098218843915129, 'psi': 0.6545010035840533}-{'f1_val': 0.6147936207676439, 'auprc': 0.7806459023228248, 'loss_val': 0.9031105316060899, 'psi': 0.6811345333897163}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.690516 cos_to_last_merge=0.9891 (last merge round=22)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6223617732608835, 'auprc': 0.7998790044621779, 'loss_val': 0.5486162303461999, 'psi': 0.6933686657414012}-{'f1_val': 0.6437837573447944, 'auprc': 0.805391276900732, 'loss_val': 0.5897244104171894, 'psi': 0.7084267651671694}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.688228 cos_to_last_merge=0.9729 (last merge round=16)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.992032490903249, 'auprc': 0.9986507961748863, 'loss_val': 0.04425972870412339, 'psi': 0.9946798130119039}-{'f1_val': 0.9921646161217188, 'auprc': 0.9982505451620199, 'loss_val': 0.04371797195497705, 'psi': 0.9945989877378393}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.605283 cos_to_last_merge=0.9822 (last merge round=23)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.998379612021049, 'loss_val': 0.028834883289231634, 'psi': 0.9956977091440913}-{'f1_val': 0.9968525854255906, 'auprc': 0.9948680335870741, 'loss_val': 0.02502057355450882, 'psi': 0.996058764690184}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.056053 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9918580711568534, 'auprc': 0.9926337889186475, 'loss_val': 0.07101072753481413, 'psi': 0.9921683582615711}-{'f1_val': 0.9949076376791339, 'auprc': 0.9950088094722807, 'loss_val': 0.049681627047474405, 'psi': 0.9949481063963925}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.096587 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8678854756100668, 'auprc': 0.997667443990388, 'loss_val': 0.14080238427083547, 'psi': 0.9197982629621952}-{'f1_val': 0.9954312449678927, 'auprc': 0.9982765957370671, 'loss_val': 0.029943287366887752, 'psi': 0.9965693852755624}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.450863 cos_to_last_merge=0.9255 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6008793764250745, 'auprc': 0.7331434494939577, 'loss_val': 0.8544259191070912, 'psi': 0.6537850056526278}-{'f1_val': 0.6281172471317041, 'auprc': 0.7318749017172671, 'loss_val': 0.666870944932263, 'psi': 0.6696203089659294}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.576464 cos_to_last_merge=0.9630 (last merge round=22)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965803821790421, 'auprc': 0.9966771955889695, 'loss_val': 0.03643139200198991, 'psi': 0.9966191075430131}-{'f1_val': 0.9968002980424979, 'auprc': 0.9987744104660345, 'loss_val': 0.03610806090795886, 'psi': 0.9975899430119125}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.894790 cos_to_last_merge=0.8140 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=38 local utility u=0.803533 metrics={'f1_val': 0.8267266478855759, 'auprc': 0.9839837618597842, 'loss_val': 0.3315291598340804, 'psi': 0.8896294934752592}-{'f1_val': 0.7007449487928452, 'auprc': 0.824564672609067, 'loss_val': 0.7044483623922789, 'psi': 0.750272838319334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=38 head_norm_before_train=1.717096 cos_to_last_merge=0.9228 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=38 local utility u=0.248845 metrics={'f1_val': 0.9316360404779318, 'auprc': 0.9922986490729048, 'loss_val': 0.37755475040004327, 'psi': 0.955901083915921}-{'f1_val': 0.8844978730172428, 'auprc': 0.9870757250088611, 'loss_val': 0.576746744403819, 'psi': 0.9255290138138901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=38 head_norm_before_train=1.961012 (no previous merge yet)
[S17] round=38 local utility u=0.102180 metrics={'f1_val': 0.6770182543237943, 'auprc': 0.8275896752401377, 'loss_val': 1.3165991788409734, 'psi': 0.7372468226903317}-{'f1_val': 0.6552515572942302, 'auprc': 0.8271412033428003, 'loss_val': 1.3890142462297894, 'psi': 0.7240074157136582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=39 head_norm_before_train=1.831889 cos_to_last_merge=0.8050 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8217855735741912, 'auprc': 0.8394526126898549, 'loss_val': 0.4623065992384055, 'psi': 0.8288523892204567}-{'f1_val': 0.8253609927351723, 'auprc': 0.8355196478827487, 'loss_val': 0.45058225960165504, 'psi': 0.8294244547942028}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.829 u=0.0000 p_local=0.0670 f1=0.822 auprc=0.839 bytes=45029
[S3] START round=39 head_norm_before_train=1.897314 cos_to_last_merge=0.9268 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9198892612799651, 'auprc': 0.998127020161675, 'loss_val': 0.15252133923566558, 'psi': 0.951184364832649}-{'f1_val': 0.9610750853994537, 'auprc': 0.9991498171885063, 'loss_val': 0.14501516730074113, 'psi': 0.9763049781150748}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.951 u=0.0000 p_local=0.0475 f1=0.920 auprc=0.998 bytes=36009
[S4] START round=39 head_norm_before_train=1.659063 cos_to_last_merge=0.9835 (last merge round=22)
[S4] round=39 local utility u=0.026562 metrics={'f1_val': 0.9429457851696306, 'auprc': 0.9703673095669895, 'loss_val': 0.28081167856447853, 'psi': 0.9539143949285741}-{'f1_val': 0.9413156515161096, 'auprc': 0.9633208515712959, 'loss_val': 0.30301624736720306, 'psi': 0.9501177315381841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S4] r=40 psi=0.954 u=0.0266 p_local=0.0204 f1=0.943 auprc=0.970 bytes=46708
[S5] START round=39 head_norm_before_train=1.629237 cos_to_last_merge=0.9884 (last merge round=21)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.5652126026420607, 'auprc': 0.748912711304343, 'loss_val': 0.7794935984772522, 'psi': 0.6386926461069736}-{'f1_val': 0.6268201844925644, 'auprc': 0.6944282750488273, 'loss_val': 0.6048763113368933, 'psi': 0.6538634207150695}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.639 u=0.0000 p_local=0.1953 f1=0.565 auprc=0.749 bytes=35992
[S6] START round=39 head_norm_before_train=1.573126 cos_to_last_merge=0.9750 (last merge round=20)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.8451704637726418, 'auprc': 0.9586596368863682, 'loss_val': 0.31103670261111627, 'psi': 0.8905661330181325}-{'f1_val': 0.6005693347391243, 'auprc': 0.7353985068514468, 'loss_val': 1.098218843915129, 'psi': 0.6545010035840533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] r=40 psi=0.891 u=1.0000 p_local=0.3918 f1=0.845 auprc=0.959 bytes=35961
[S7] START round=39 head_norm_before_train=1.695461 cos_to_last_merge=0.9888 (last merge round=22)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6226011979794969, 'auprc': 0.8004758321525925, 'loss_val': 0.6407637018635413, 'psi': 0.6937510516487351}-{'f1_val': 0.6223617732608835, 'auprc': 0.7998790044621779, 'loss_val': 0.5486162303461999, 'psi': 0.6933686657414012}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.694 u=0.0000 p_local=0.0809 f1=0.623 auprc=0.800 bytes=39540
[S8] START round=39 head_norm_before_train=1.697207 cos_to_last_merge=0.9724 (last merge round=16)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9929276522285003, 'auprc': 0.9895216596280768, 'loss_val': 0.042605415473152976, 'psi': 0.9915652551883309}-{'f1_val': 0.992032490903249, 'auprc': 0.9986507961748863, 'loss_val': 0.04425972870412339, 'psi': 0.9946798130119039}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.992 u=0.0000 p_local=0.1777 f1=0.993 auprc=0.990 bytes=43108
[S9] START round=39 head_norm_before_train=1.616921 cos_to_last_merge=0.9815 (last merge round=23)
[S9] round=39 local utility u=0.003045 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9934722860449845, 'loss_val': 0.02471894506176079, 'psi': 0.9954044091768511}-{'f1_val': 0.993909773892786, 'auprc': 0.998379612021049, 'loss_val': 0.028834883289231634, 'psi': 0.9956977091440913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S9] r=40 psi=0.995 u=0.0030 p_local=0.0051 f1=0.997 auprc=0.993 bytes=45049
[S10] START round=39 head_norm_before_train=2.066983 (no previous merge yet)
[S10] round=39 local utility u=0.020012 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9933488988164407, 'loss_val': 0.05143021375783393, 'psi': 0.9942841421340566}-{'f1_val': 0.9918580711568534, 'auprc': 0.9926337889186475, 'loss_val': 0.07101072753481413, 'psi': 0.9921683582615711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S10] r=40 psi=0.994 u=0.0200 p_local=0.0099 f1=0.995 auprc=0.993 bytes=52118
[S11] START round=39 head_norm_before_train=2.103692 (no previous merge yet)
[S11] round=39 local utility u=0.442029 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998337312752626, 'loss_val': 0.028366282833334804, 'psi': 0.9970274099474976}-{'f1_val': 0.8678854756100668, 'auprc': 0.997667443990388, 'loss_val': 0.14080238427083547, 'psi': 0.9197982629621952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] r=40 psi=0.997 u=0.4420 p_local=0.0921 f1=0.996 auprc=0.998 bytes=52214
[S13] START round=39 head_norm_before_train=1.459534 cos_to_last_merge=0.9246 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=39 local utility u=0.012316 metrics={'f1_val': 0.6037475996945566, 'auprc': 0.7273533614918622, 'loss_val': 0.8296328877998308, 'psi': 0.6531899044134788}-{'f1_val': 0.6008793764250745, 'auprc': 0.7331434494939577, 'loss_val': 0.8544259191070912, 'psi': 0.6537850056526278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=40 psi=0.653 u=0.0123 p_local=0.0451 f1=0.604 auprc=0.727 bytes=39570
[S14] START round=39 head_norm_before_train=1.587409 cos_to_last_merge=0.9619 (last merge round=22)
[S14] round=39 local utility u=0.006944 metrics={'f1_val': 0.9974095353784286, 'auprc': 0.9984434875341301, 'loss_val': 0.03281646354093308, 'psi': 0.9978231162407092}-{'f1_val': 0.9965803821790421, 'auprc': 0.9966771955889695, 'loss_val': 0.03643139200198991, 'psi': 0.9966191075430131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=40 psi=0.998 u=0.0069 p_local=0.0075 f1=0.997 auprc=0.998 bytes=44941
[S15] START round=39 head_norm_before_train=1.905665 cos_to_last_merge=0.8131 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.813
[S15] round=39 local utility u=0.685627 metrics={'f1_val': 0.9968061796928895, 'auprc': 0.9979732499523023, 'loss_val': 0.022721458974098354, 'psi': 0.9972730077966547}-{'f1_val': 0.8267266478855759, 'auprc': 0.9839837618597842, 'loss_val': 0.3315291598340804, 'psi': 0.8896294934752592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S15] r=40 psi=0.997 u=0.6856 p_local=0.4348 f1=0.997 auprc=0.998 bytes=44956
[S16] START round=39 head_norm_before_train=1.728147 cos_to_last_merge=0.9212 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=39 local utility u=0.353832 metrics={'f1_val': 0.9915582458472608, 'auprc': 0.9977414460580797, 'loss_val': 0.04575312310406326, 'psi': 0.9940315259315884}-{'f1_val': 0.9316360404779318, 'auprc': 0.9922986490729048, 'loss_val': 0.37755475040004327, 'psi': 0.955901083915921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S16] r=40 psi=0.994 u=0.3538 p_local=0.2779 f1=0.992 auprc=0.998 bytes=41344
[S17] START round=39 head_norm_before_train=1.968086 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6679702443215694, 'auprc': 0.8246271704440351, 'loss_val': 1.4022544290811385, 'psi': 0.7306330147705556}-{'f1_val': 0.6770182543237943, 'auprc': 0.8275896752401377, 'loss_val': 1.3165991788409734, 'psi': 0.7372468226903317}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.731 u=0.0000 p_local=0.0612 f1=0.668 auprc=0.825 bytes=39594
[S2] START round=40 head_norm_before_train=1.839555 cos_to_last_merge=0.8045 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7203071440928712, 'auprc': 0.8624130162479305, 'loss_val': 0.514527808261655, 'psi': 0.777149492954895}-{'f1_val': 0.8217855735741912, 'auprc': 0.8394526126898549, 'loss_val': 0.4623065992384055, 'psi': 0.8288523892204567}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.907132 cos_to_last_merge=0.9254 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.7322750710176483, 'auprc': 0.949362645521942, 'loss_val': 0.554687942841138, 'psi': 0.8191101008193659}-{'f1_val': 0.9198892612799651, 'auprc': 0.998127020161675, 'loss_val': 0.15252133923566558, 'psi': 0.951184364832649}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.666619 cos_to_last_merge=0.9825 (last merge round=22)
[S4] round=40 local utility u=0.005684 metrics={'f1_val': 0.9464254895430304, 'auprc': 0.966569165906612, 'loss_val': 0.27892744028078165, 'psi': 0.954482960088463}-{'f1_val': 0.9429457851696306, 'auprc': 0.9703673095669895, 'loss_val': 0.28081167856447853, 'psi': 0.9539143949285741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=40 head_norm_before_train=1.635766 cos_to_last_merge=0.9882 (last merge round=21)
[S5] round=40 local utility u=0.481092 metrics={'f1_val': 0.6854839950205279, 'auprc': 0.7239821580329244, 'loss_val': 0.46414542450652335, 'psi': 0.7008832602254865}-{'f1_val': 0.5652126026420607, 'auprc': 0.748912711304343, 'loss_val': 0.7794935984772522, 'psi': 0.6386926461069736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=40 head_norm_before_train=1.581454 cos_to_last_merge=0.9743 (last merge round=20)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.5953170050105449, 'auprc': 0.7788509430994652, 'loss_val': 1.0399675726525948, 'psi': 0.668730580246113}-{'f1_val': 0.8451704637726418, 'auprc': 0.9586596368863682, 'loss_val': 0.31103670261111627, 'psi': 0.8905661330181325}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.703411 cos_to_last_merge=0.9881 (last merge round=22)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6184560820153917, 'auprc': 0.7997161123940126, 'loss_val': 0.6182272542287294, 'psi': 0.6909600941668401}-{'f1_val': 0.6226011979794969, 'auprc': 0.8004758321525925, 'loss_val': 0.6407637018635413, 'psi': 0.6937510516487351}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.710102 cos_to_last_merge=0.9717 (last merge round=16)
[S8] round=40 local utility u=0.000382 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9884456208265812, 'loss_val': 0.04085650532808245, 'psi': 0.9913592306460679}-{'f1_val': 0.9929276522285003, 'auprc': 0.9895216596280768, 'loss_val': 0.042605415473152976, 'psi': 0.9915652551883309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=40 head_norm_before_train=1.628442 cos_to_last_merge=0.9809 (last merge round=23)
[S9] round=40 local utility u=0.002914 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9982275455911961, 'loss_val': 0.02646075174865048, 'psi': 0.9966368535669872}-{'f1_val': 0.9966924912647621, 'auprc': 0.9934722860449845, 'loss_val': 0.02471894506176079, 'psi': 0.9954044091768511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=40 head_norm_before_train=2.074203 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9914432168572603, 'auprc': 0.9936194337998675, 'loss_val': 0.06723498951479001, 'psi': 0.9923137036343033}-{'f1_val': 0.9949076376791339, 'auprc': 0.9933488988164407, 'loss_val': 0.05143021375783393, 'psi': 0.9942841421340566}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.113075 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9947108083319763, 'auprc': 0.9984491242823033, 'loss_val': 0.024338990320807136, 'psi': 0.9962061347121072}-{'f1_val': 0.9961541414107454, 'auprc': 0.998337312752626, 'loss_val': 0.028366282833334804, 'psi': 0.9970274099474976}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.469139 cos_to_last_merge=0.9237 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=40 local utility u=0.093776 metrics={'f1_val': 0.6250877061451247, 'auprc': 0.716503148278071, 'loss_val': 0.7375701967298767, 'psi': 0.6616538829983032}-{'f1_val': 0.6037475996945566, 'auprc': 0.7273533614918622, 'loss_val': 0.8296328877998308, 'psi': 0.6531899044134788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=40 head_norm_before_train=1.598196 cos_to_last_merge=0.9607 (last merge round=22)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963375338307721, 'auprc': 0.9953706422883803, 'loss_val': 0.03570972016406828, 'psi': 0.9959507772138154}-{'f1_val': 0.9974095353784286, 'auprc': 0.9984434875341301, 'loss_val': 0.03281646354093308, 'psi': 0.9978231162407092}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.915788 cos_to_last_merge=0.8122 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.812
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9969744250752512, 'loss_val': 0.025635074502435646, 'psi': 0.9968377710626128}-{'f1_val': 0.9968061796928895, 'auprc': 0.9979732499523023, 'loss_val': 0.022721458974098354, 'psi': 0.9972730077966547}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.739816 cos_to_last_merge=0.9195 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9913080206785505, 'auprc': 0.9953272482441451, 'loss_val': 0.04439051838393638, 'psi': 0.9929157117047884}-{'f1_val': 0.9915582458472608, 'auprc': 0.9977414460580797, 'loss_val': 0.04575312310406326, 'psi': 0.9940315259315884}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.977363 (no previous merge yet)
[S17] round=40 local utility u=0.025894 metrics={'f1_val': 0.6741105160118706, 'auprc': 0.824376221903006, 'loss_val': 1.3865545011557132, 'psi': 0.7342167983683248}-{'f1_val': 0.6679702443215694, 'auprc': 0.8246271704440351, 'loss_val': 1.4022544290811385, 'psi': 0.7306330147705556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.849604 cos_to_last_merge=0.8036 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=41 local utility u=0.195348 metrics={'f1_val': 0.826927255863298, 'auprc': 0.7599544335707419, 'loss_val': 0.4561768478860654, 'psi': 0.8001381269462755}-{'f1_val': 0.7203071440928712, 'auprc': 0.8624130162479305, 'loss_val': 0.514527808261655, 'psi': 0.777149492954895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=41 head_norm_before_train=1.918279 cos_to_last_merge=0.9245 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=41 local utility u=0.680565 metrics={'f1_val': 0.9149536861623301, 'auprc': 0.9487937744297623, 'loss_val': 0.2879229067014859, 'psi': 0.9284897214693031}-{'f1_val': 0.7322750710176483, 'auprc': 0.949362645521942, 'loss_val': 0.554687942841138, 'psi': 0.8191101008193659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=41 head_norm_before_train=1.673386 cos_to_last_merge=0.9818 (last merge round=22)
[S4] round=41 local utility u=0.007000 metrics={'f1_val': 0.947891162751936, 'auprc': 0.9676525955626419, 'loss_val': 0.27697166731811707, 'psi': 0.9557957358762184}-{'f1_val': 0.9464254895430304, 'auprc': 0.966569165906612, 'loss_val': 0.27892744028078165, 'psi': 0.954482960088463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=41 head_norm_before_train=1.644200 cos_to_last_merge=0.9872 (last merge round=21)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.4831826295643382, 'auprc': 0.7553150147203553, 'loss_val': 0.8856740806724164, 'psi': 0.592035583626745}-{'f1_val': 0.6854839950205279, 'auprc': 0.7239821580329244, 'loss_val': 0.46414542450652335, 'psi': 0.7008832602254865}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.590845 cos_to_last_merge=0.9733 (last merge round=20)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.9154177871699994, 'auprc': 0.9686307161591818, 'loss_val': 0.21438651165344563, 'psi': 0.9367029587656723}-{'f1_val': 0.5953170050105449, 'auprc': 0.7788509430994652, 'loss_val': 1.0399675726525948, 'psi': 0.668730580246113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=41 head_norm_before_train=1.711851 cos_to_last_merge=0.9874 (last merge round=22)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5712960931393523, 'auprc': 0.7932152872920553, 'loss_val': 0.9383101235014859, 'psi': 0.6600637708004335}-{'f1_val': 0.6184560820153917, 'auprc': 0.7997161123940126, 'loss_val': 0.6182272542287294, 'psi': 0.6909600941668401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.724347 cos_to_last_merge=0.9710 (last merge round=16)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9877832848288643, 'loss_val': 0.0406122487284333, 'psi': 0.9904374698902305}-{'f1_val': 0.9933016371923923, 'auprc': 0.9884456208265812, 'loss_val': 0.04085650532808245, 'psi': 0.9913592306460679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.639384 cos_to_last_merge=0.9802 (last merge round=23)
[S9] round=41 local utility u=0.000418 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.995950752149235, 'loss_val': 0.023797072315901655, 'psi': 0.9962264122600265}-{'f1_val': 0.9955763922175147, 'auprc': 0.9982275455911961, 'loss_val': 0.02646075174865048, 'psi': 0.9966368535669872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=41 head_norm_before_train=2.081676 (no previous merge yet)
[S10] round=41 local utility u=0.019397 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9935786923160767, 'loss_val': 0.04910481239889948, 'psi': 0.994376059533911}-{'f1_val': 0.9914432168572603, 'auprc': 0.9936194337998675, 'loss_val': 0.06723498951479001, 'psi': 0.9923137036343033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=41 head_norm_before_train=2.123238 (no previous merge yet)
[S11] round=41 local utility u=0.004733 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984426784621308, 'loss_val': 0.023513336918068988, 'psi': 0.9970695562312996}-{'f1_val': 0.9947108083319763, 'auprc': 0.9984491242823033, 'loss_val': 0.024338990320807136, 'psi': 0.9962061347121072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=41 head_norm_before_train=1.482096 cos_to_last_merge=0.9226 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=41 local utility u=0.049070 metrics={'f1_val': 0.6125202000093093, 'auprc': 0.7839317047633036, 'loss_val': 0.7663099910057168, 'psi': 0.681084801910907}-{'f1_val': 0.6250877061451247, 'auprc': 0.716503148278071, 'loss_val': 0.7375701967298767, 'psi': 0.6616538829983032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=41 head_norm_before_train=1.606930 cos_to_last_merge=0.9595 (last merge round=22)
[S14] round=41 local utility u=0.005711 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9991185997554444, 'loss_val': 0.036712187013115294, 'psi': 0.9975681186111366}-{'f1_val': 0.9963375338307721, 'auprc': 0.9953706422883803, 'loss_val': 0.03570972016406828, 'psi': 0.9959507772138154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=41 head_norm_before_train=1.924695 cos_to_last_merge=0.8115 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8207271585867947, 'auprc': 0.9949747525036867, 'loss_val': 0.31186220368646644, 'psi': 0.8904261961535515}-{'f1_val': 0.9967466683875206, 'auprc': 0.9969744250752512, 'loss_val': 0.025635074502435646, 'psi': 0.9968377710626128}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.751585 cos_to_last_merge=0.9178 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=41 local utility u=0.003881 metrics={'f1_val': 0.991726697920398, 'auprc': 0.9966793660392872, 'loss_val': 0.04319782362194612, 'psi': 0.9937077651679537}-{'f1_val': 0.9913080206785505, 'auprc': 0.9953272482441451, 'loss_val': 0.04439051838393638, 'psi': 0.9929157117047884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=41 head_norm_before_train=1.986993 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6702848148750788, 'auprc': 0.8251612190556182, 'loss_val': 1.432296605697207, 'psi': 0.7322353765472946}-{'f1_val': 0.6741105160118706, 'auprc': 0.824376221903006, 'loss_val': 1.3865545011557132, 'psi': 0.7342167983683248}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.857028 cos_to_last_merge=0.8027 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7496484925151926, 'auprc': 0.870387257359752, 'loss_val': 0.48338931858671313, 'psi': 0.7979439984530163}-{'f1_val': 0.826927255863298, 'auprc': 0.7599544335707419, 'loss_val': 0.4561768478860654, 'psi': 0.8001381269462755}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.931393 cos_to_last_merge=0.9238 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.721357893482899, 'auprc': 0.954861513529317, 'loss_val': 0.7184819955998374, 'psi': 0.8147593415014662}-{'f1_val': 0.9149536861623301, 'auprc': 0.9487937744297623, 'loss_val': 0.2879229067014859, 'psi': 0.9284897214693031}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.682653 cos_to_last_merge=0.9808 (last merge round=22)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9463082982046632, 'auprc': 0.9700920966301203, 'loss_val': 0.28042171171284247, 'psi': 0.9558218175748461}-{'f1_val': 0.947891162751936, 'auprc': 0.9676525955626419, 'loss_val': 0.27697166731811707, 'psi': 0.9557957358762184}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.649065 cos_to_last_merge=0.9865 (last merge round=21)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8556648558565048, 'loss_val': 1.1240831734683325, 'psi': 0.6043256806458251}-{'f1_val': 0.4831826295643382, 'auprc': 0.7553150147203553, 'loss_val': 0.8856740806724164, 'psi': 0.592035583626745}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.599264 cos_to_last_merge=0.9725 (last merge round=20)
[S6] round=42 local utility u=0.103749 metrics={'f1_val': 0.9435991776119563, 'auprc': 0.9777762474329752, 'loss_val': 0.20341286727150135, 'psi': 0.9572700055403638}-{'f1_val': 0.9154177871699994, 'auprc': 0.9686307161591818, 'loss_val': 0.21438651165344563, 'psi': 0.9367029587656723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=42 head_norm_before_train=1.719686 cos_to_last_merge=0.9867 (last merge round=22)
[S7] round=42 local utility u=0.189786 metrics={'f1_val': 0.5999538944768621, 'auprc': 0.7982035597128838, 'loss_val': 0.7456503206157136, 'psi': 0.6792537605712707}-{'f1_val': 0.5712960931393523, 'auprc': 0.7932152872920553, 'loss_val': 0.9383101235014859, 'psi': 0.6600637708004335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=42 head_norm_before_train=1.739216 cos_to_last_merge=0.9702 (last merge round=16)
[S8] round=42 local utility u=0.014811 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9987324224430654, 'loss_val': 0.04171441764601073, 'psi': 0.9946048980835356}-{'f1_val': 0.9922069265978078, 'auprc': 0.9877832848288643, 'loss_val': 0.0406122487284333, 'psi': 0.9904374698902305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=42 head_norm_before_train=1.652128 cos_to_last_merge=0.9793 (last merge round=23)
[S9] round=42 local utility u=0.003448 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9983664820911228, 'loss_val': 0.024148364087173236, 'psi': 0.9971927042367816}-{'f1_val': 0.9964101856672208, 'auprc': 0.995950752149235, 'loss_val': 0.023797072315901655, 'psi': 0.9962264122600265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=2.090537 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9943672180685432, 'auprc': 0.9947093092824882, 'loss_val': 0.061876991466461057, 'psi': 0.9945040545541212}-{'f1_val': 0.9949076376791339, 'auprc': 0.9935786923160767, 'loss_val': 0.04910481239889948, 'psi': 0.994376059533911}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.131898 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9780303599996787, 'auprc': 0.9978876390776941, 'loss_val': 0.08036732116262332, 'psi': 0.9859732716308849}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984426784621308, 'loss_val': 0.023513336918068988, 'psi': 0.9970695562312996}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.491971 cos_to_last_merge=0.9217 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=42 local utility u=0.126383 metrics={'f1_val': 0.6212213331403611, 'auprc': 0.8262156064837891, 'loss_val': 0.6926022666975029, 'psi': 0.7032190424777323}-{'f1_val': 0.6125202000093093, 'auprc': 0.7839317047633036, 'loss_val': 0.7663099910057168, 'psi': 0.681084801910907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.615026 cos_to_last_merge=0.9583 (last merge round=22)
[S14] round=42 local utility u=0.001575 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.998935882976996, 'loss_val': 0.03200952749618623, 'psi': 0.9973946520541892}-{'f1_val': 0.9965344645149313, 'auprc': 0.9991185997554444, 'loss_val': 0.036712187013115294, 'psi': 0.9975681186111366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=42 head_norm_before_train=1.933227 cos_to_last_merge=0.8108 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=42 local utility u=0.679276 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.998023686815713, 'loss_val': 0.02115846367478403, 'psi': 0.9975158779330572}-{'f1_val': 0.8207271585867947, 'auprc': 0.9949747525036867, 'loss_val': 0.31186220368646644, 'psi': 0.8904261961535515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=42 head_norm_before_train=1.763227 cos_to_last_merge=0.9160 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9416143303643353, 'auprc': 0.9839073691083673, 'loss_val': 0.23555201777694137, 'psi': 0.9585315458619481}-{'f1_val': 0.991726697920398, 'auprc': 0.9966793660392872, 'loss_val': 0.04319782362194612, 'psi': 0.9937077651679537}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.995908 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6674833481661886, 'auprc': 0.8276268102560952, 'loss_val': 1.4640729834747275, 'psi': 0.7315407330021513}-{'f1_val': 0.6702848148750788, 'auprc': 0.8251612190556182, 'loss_val': 1.432296605697207, 'psi': 0.7322353765472946}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.864492 cos_to_last_merge=0.8018 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.802
[S2] round=43 local utility u=0.206155 metrics={'f1_val': 0.8117775120686044, 'auprc': 0.8773415425214997, 'loss_val': 0.46471568760248266, 'psi': 0.8380031242497625}-{'f1_val': 0.7496484925151926, 'auprc': 0.870387257359752, 'loss_val': 0.48338931858671313, 'psi': 0.7979439984530163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=43 head_norm_before_train=1.944009 cos_to_last_merge=0.9229 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9990500218386555, 'loss_val': 0.15178651650516897, 'psi': 0.9762411593987284}-{'f1_val': 0.721357893482899, 'auprc': 0.954861513529317, 'loss_val': 0.7184819955998374, 'psi': 0.8147593415014662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=43 head_norm_before_train=1.688032 cos_to_last_merge=0.9798 (last merge round=22)
[S4] round=43 local utility u=0.001565 metrics={'f1_val': 0.9457794451207842, 'auprc': 0.9727588953766214, 'loss_val': 0.2821184162339414, 'psi': 0.956571225223119}-{'f1_val': 0.9463082982046632, 'auprc': 0.9700920966301203, 'loss_val': 0.28042171171284247, 'psi': 0.9558218175748461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=43 head_norm_before_train=1.656085 cos_to_last_merge=0.9861 (last merge round=21)
[S5] round=43 local utility u=0.941151 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7312732073946395, 'loss_val': 0.4499332335601667, 'psi': 0.7127016420526713}-{'f1_val': 0.43676623050537206, 'auprc': 0.8556648558565048, 'loss_val': 1.1240831734683325, 'psi': 0.6043256806458251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=43 head_norm_before_train=1.606336 cos_to_last_merge=0.9719 (last merge round=20)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7943157242386404, 'auprc': 0.9513694799483869, 'loss_val': 0.4985722770452576, 'psi': 0.857137226522539}-{'f1_val': 0.9435991776119563, 'auprc': 0.9777762474329752, 'loss_val': 0.20341286727150135, 'psi': 0.9572700055403638}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.722915 cos_to_last_merge=0.9863 (last merge round=22)
[S7] round=43 local utility u=0.353396 metrics={'f1_val': 0.6664611667180418, 'auprc': 0.8149960599220883, 'loss_val': 0.48828035315431206, 'psi': 0.7258751239996604}-{'f1_val': 0.5999538944768621, 'auprc': 0.7982035597128838, 'loss_val': 0.7456503206157136, 'psi': 0.6792537605712707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=43 head_norm_before_train=1.752696 cos_to_last_merge=0.9693 (last merge round=16)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9948769203197908, 'loss_val': 0.03971062225447339, 'psi': 0.993274924086601}-{'f1_val': 0.9918532151771823, 'auprc': 0.9987324224430654, 'loss_val': 0.04171441764601073, 'psi': 0.9946048980835356}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.663748 cos_to_last_merge=0.9786 (last merge round=23)
[S9] round=43 local utility u=0.001969 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983533533122143, 'loss_val': 0.02167253832596045, 'psi': 0.9973376484132206}-{'f1_val': 0.9964101856672208, 'auprc': 0.9983664820911228, 'loss_val': 0.024148364087173236, 'psi': 0.9971927042367816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=2.099957 (no previous merge yet)
[S10] round=43 local utility u=0.007296 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9950691064805922, 'loss_val': 0.05160645448157197, 'psi': 0.9949722251997172}-{'f1_val': 0.9943672180685432, 'auprc': 0.9947093092824882, 'loss_val': 0.061876991466461057, 'psi': 0.9945040545541212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=43 head_norm_before_train=2.139887 (no previous merge yet)
[S11] round=43 local utility u=0.067532 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978442744333893, 'loss_val': 0.053915815310916736, 'psi': 0.9968301946198029}-{'f1_val': 0.9780303599996787, 'auprc': 0.9978876390776941, 'loss_val': 0.08036732116262332, 'psi': 0.9859732716308849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=43 head_norm_before_train=1.499014 cos_to_last_merge=0.9208 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6043424697010041, 'auprc': 0.6784258481533827, 'loss_val': 0.8898011823533852, 'psi': 0.6339758210819555}-{'f1_val': 0.6212213331403611, 'auprc': 0.8262156064837891, 'loss_val': 0.6926022666975029, 'psi': 0.7032190424777323}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.624040 cos_to_last_merge=0.9574 (last merge round=22)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.9967344937324472, 'loss_val': 0.03011061975900276, 'psi': 0.9965278108740827}-{'f1_val': 0.9963671647723179, 'auprc': 0.998935882976996, 'loss_val': 0.03200952749618623, 'psi': 0.9973946520541892}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.941614 cos_to_last_merge=0.8101 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9966984457043269, 'loss_val': 0.02454208306129425, 'psi': 0.9965046864679246}-{'f1_val': 0.9971773386779533, 'auprc': 0.998023686815713, 'loss_val': 0.02115846367478403, 'psi': 0.9975158779330572}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.770470 cos_to_last_merge=0.9154 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=43 local utility u=0.258637 metrics={'f1_val': 0.9911477559979187, 'auprc': 0.993012903978489, 'loss_val': 0.04279481305446892, 'psi': 0.9918938151901469}-{'f1_val': 0.9416143303643353, 'auprc': 0.9839073691083673, 'loss_val': 0.23555201777694137, 'psi': 0.9585315458619481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=43 head_norm_before_train=2.006890 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6515059401860566, 'auprc': 0.8316919667638077, 'loss_val': 1.5001593364609342, 'psi': 0.723580350817157}-{'f1_val': 0.6674833481661886, 'auprc': 0.8276268102560952, 'loss_val': 1.4640729834747275, 'psi': 0.7315407330021513}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.874510 cos_to_last_merge=0.8007 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8268488861691461, 'auprc': 0.8064523080834645, 'loss_val': 0.431936895542828, 'psi': 0.8186902549348735}-{'f1_val': 0.8117775120686044, 'auprc': 0.8773415425214997, 'loss_val': 0.46471568760248266, 'psi': 0.8380031242497625}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.955204 cos_to_last_merge=0.9221 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=44 local utility u=0.176503 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9989752226177133, 'loss_val': 0.016563039345398302, 'psi': 0.9980119076421377}-{'f1_val': 0.9610352511054436, 'auprc': 0.9990500218386555, 'loss_val': 0.15178651650516897, 'psi': 0.9762411593987284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=44 head_norm_before_train=1.694673 cos_to_last_merge=0.9786 (last merge round=22)
[S4] round=44 local utility u=0.016787 metrics={'f1_val': 0.9510848475913573, 'auprc': 0.9709437774206412, 'loss_val': 0.2749311170879468, 'psi': 0.9590284195230709}-{'f1_val': 0.9457794451207842, 'auprc': 0.9727588953766214, 'loss_val': 0.2821184162339414, 'psi': 0.956571225223119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.661784 cos_to_last_merge=0.9858 (last merge round=21)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.42231908839020493, 'auprc': 0.7876744397001286, 'loss_val': 1.1358745823456493, 'psi': 0.5684612289141744}-{'f1_val': 0.700320598491359, 'auprc': 0.7312732073946395, 'loss_val': 0.4499332335601667, 'psi': 0.7127016420526713}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.616964 cos_to_last_merge=0.9710 (last merge round=20)
[S6] round=44 local utility u=0.837445 metrics={'f1_val': 0.9864218604854393, 'auprc': 0.9876563324396349, 'loss_val': 0.08518019601050404, 'psi': 0.9869156492671176}-{'f1_val': 0.7943157242386404, 'auprc': 0.9513694799483869, 'loss_val': 0.4985722770452576, 'psi': 0.857137226522539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=44 head_norm_before_train=1.726770 cos_to_last_merge=0.9859 (last merge round=22)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5713897781441478, 'auprc': 0.7909207358122536, 'loss_val': 0.9525609585263299, 'psi': 0.6592021612113902}-{'f1_val': 0.6664611667180418, 'auprc': 0.8149960599220883, 'loss_val': 0.48828035315431206, 'psi': 0.7258751239996604}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.763657 cos_to_last_merge=0.9686 (last merge round=16)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9925530904813786, 'auprc': 0.9862704911487212, 'loss_val': 0.04018558171152693, 'psi': 0.9900400507483157}-{'f1_val': 0.9922069265978078, 'auprc': 0.9948769203197908, 'loss_val': 0.03971062225447339, 'psi': 0.993274924086601}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.675729 cos_to_last_merge=0.9777 (last merge round=23)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964376673269987, 'loss_val': 0.021413260991324148, 'psi': 0.9965713740191343}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983533533122143, 'loss_val': 0.02167253832596045, 'psi': 0.9973376484132206}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.108327 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948323623228077, 'loss_val': 0.05705173731692898, 'psi': 0.9946326591250669}-{'f1_val': 0.9949076376791339, 'auprc': 0.9950691064805922, 'loss_val': 0.05160645448157197, 'psi': 0.9949722251997172}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.148825 (no previous merge yet)
[S11] round=44 local utility u=0.015929 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985038701233697, 'loss_val': 0.02403707534861069, 'psi': 0.9970940328957951}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978442744333893, 'loss_val': 0.053915815310916736, 'psi': 0.9968301946198029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.509953 cos_to_last_merge=0.9197 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=44 local utility u=0.388181 metrics={'f1_val': 0.6283355877430579, 'auprc': 0.7974993635726937, 'loss_val': 0.6146183009179493, 'psi': 0.6960010980749123}-{'f1_val': 0.6043424697010041, 'auprc': 0.6784258481533827, 'loss_val': 0.8898011823533852, 'psi': 0.6339758210819555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=44 head_norm_before_train=1.634181 cos_to_last_merge=0.9565 (last merge round=22)
[S14] round=44 local utility u=0.003968 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9982572904903626, 'loss_val': 0.029205514127862393, 'psi': 0.9973830950216438}-{'f1_val': 0.9963900223018398, 'auprc': 0.9967344937324472, 'loss_val': 0.03011061975900276, 'psi': 0.9965278108740827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=44 head_norm_before_train=1.950149 cos_to_last_merge=0.8094 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.967809070316488, 'auprc': 0.99573311774839, 'loss_val': 0.0588038344502976, 'psi': 0.9789786892892489}-{'f1_val': 0.9963755136436562, 'auprc': 0.9966984457043269, 'loss_val': 0.02454208306129425, 'psi': 0.9965046864679246}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.778375 cos_to_last_merge=0.9144 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=44 local utility u=0.008742 metrics={'f1_val': 0.991726697920398, 'auprc': 0.9973379588655258, 'loss_val': 0.04175900455943778, 'psi': 0.993971202298449}-{'f1_val': 0.9911477559979187, 'auprc': 0.993012903978489, 'loss_val': 0.04279481305446892, 'psi': 0.9918938151901469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=44 head_norm_before_train=2.013898 (no previous merge yet)
[S17] round=44 local utility u=0.389786 metrics={'f1_val': 0.6871071166877004, 'auprc': 0.8705582036144859, 'loss_val': 1.0507924613150794, 'psi': 0.7604875514584146}-{'f1_val': 0.6515059401860566, 'auprc': 0.8316919667638077, 'loss_val': 1.5001593364609342, 'psi': 0.723580350817157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=45 head_norm_before_train=1.884083 cos_to_last_merge=0.7997 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=45 local utility u=0.058930 metrics={'f1_val': 0.8213023298290648, 'auprc': 0.8651589256773571, 'loss_val': 0.45691678317660706, 'psi': 0.8388449681683817}-{'f1_val': 0.8268488861691461, 'auprc': 0.8064523080834645, 'loss_val': 0.431936895542828, 'psi': 0.8186902549348735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=45 head_norm_before_train=1.968224 cos_to_last_merge=0.9212 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9782121117051181, 'auprc': 0.999598127408396, 'loss_val': 0.0648101642779607, 'psi': 0.9867665179864293}-{'f1_val': 0.9973696976584205, 'auprc': 0.9989752226177133, 'loss_val': 0.016563039345398302, 'psi': 0.9980119076421377}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.699270 cos_to_last_merge=0.9778 (last merge round=22)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9442794379053618, 'auprc': 0.9704482171054731, 'loss_val': 0.28977852348525546, 'psi': 0.9547469495854064}-{'f1_val': 0.9510848475913573, 'auprc': 0.9709437774206412, 'loss_val': 0.2749311170879468, 'psi': 0.9590284195230709}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.670097 cos_to_last_merge=0.9850 (last merge round=21)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.9964359871706532, 'auprc': 0.9969673184408379, 'loss_val': 0.1348475901986751, 'psi': 0.996648519678727}-{'f1_val': 0.42231908839020493, 'auprc': 0.7876744397001286, 'loss_val': 1.1358745823456493, 'psi': 0.5684612289141744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=45 head_norm_before_train=1.626899 cos_to_last_merge=0.9704 (last merge round=20)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.9786938096571056, 'auprc': 0.9922520764814065, 'loss_val': 0.12194500991270343, 'psi': 0.9841171163868259}-{'f1_val': 0.9864218604854393, 'auprc': 0.9876563324396349, 'loss_val': 0.08518019601050404, 'psi': 0.9869156492671176}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.733916 cos_to_last_merge=0.9850 (last merge round=22)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5181098525625507, 'auprc': 0.7769443574447177, 'loss_val': 1.2553363210403559, 'psi': 0.6216436545154175}-{'f1_val': 0.5713897781441478, 'auprc': 0.7909207358122536, 'loss_val': 0.9525609585263299, 'psi': 0.6592021612113902}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.770821 cos_to_last_merge=0.9684 (last merge round=16)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9873594458568917, 'auprc': 0.9987579589720954, 'loss_val': 0.04673991312088569, 'psi': 0.9919188511029732}-{'f1_val': 0.9925530904813786, 'auprc': 0.9862704911487212, 'loss_val': 0.04018558171152693, 'psi': 0.9900400507483157}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.685888 cos_to_last_merge=0.9771 (last merge round=23)
[S9] round=45 local utility u=0.000382 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9983207196820999, 'loss_val': 0.022483000309935542, 'psi': 0.9969430260763841}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964376673269987, 'loss_val': 0.021413260991324148, 'psi': 0.9965713740191343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=45 head_norm_before_train=2.112874 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.994843460469661, 'loss_val': 0.0574923046505698, 'psi': 0.9946370983838082}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948323623228077, 'loss_val': 0.05705173731692898, 'psi': 0.9946326591250669}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.155275 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.7931740722014331, 'auprc': 0.9969271992524598, 'loss_val': 0.3842649865273469, 'psi': 0.8746753230218438}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985038701233697, 'loss_val': 0.02403707534861069, 'psi': 0.9970940328957951}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.519130 cos_to_last_merge=0.9185 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5823677809258208, 'auprc': 0.7949600400247732, 'loss_val': 0.9436027849373156, 'psi': 0.6674046845654017}-{'f1_val': 0.6283355877430579, 'auprc': 0.7974993635726937, 'loss_val': 0.6146183009179493, 'psi': 0.6960010980749123}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.643785 cos_to_last_merge=0.9558 (last merge round=22)
[S14] round=45 local utility u=0.001397 metrics={'f1_val': 0.9970633655553506, 'auprc': 0.9984404920605758, 'loss_val': 0.02853978365125035, 'psi': 0.9976142161574406}-{'f1_val': 0.9968002980424979, 'auprc': 0.9982572904903626, 'loss_val': 0.029205514127862393, 'psi': 0.9973830950216438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=45 head_norm_before_train=1.958916 cos_to_last_merge=0.8087 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9617949455121251, 'auprc': 0.9974466468280716, 'loss_val': 0.06729695503467131, 'psi': 0.9760556260385036}-{'f1_val': 0.967809070316488, 'auprc': 0.99573311774839, 'loss_val': 0.0588038344502976, 'psi': 0.9789786892892489}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.787457 cos_to_last_merge=0.9131 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9914570070691986, 'auprc': 0.996633769607961, 'loss_val': 0.04180765362560346, 'psi': 0.9935277120847036}-{'f1_val': 0.991726697920398, 'auprc': 0.9973379588655258, 'loss_val': 0.04175900455943778, 'psi': 0.993971202298449}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.018749 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6586003575555855, 'auprc': 0.8419159872955514, 'loss_val': 1.4508406312716544, 'psi': 0.731926609451572}-{'f1_val': 0.6871071166877004, 'auprc': 0.8705582036144859, 'loss_val': 1.0507924613150794, 'psi': 0.7604875514584146}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.893031 cos_to_last_merge=0.7987 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7098515370681948, 'auprc': 0.9211140108192429, 'loss_val': 0.5660060475564774, 'psi': 0.7943565265686141}-{'f1_val': 0.8213023298290648, 'auprc': 0.8651589256773571, 'loss_val': 0.45691678317660706, 'psi': 0.8388449681683817}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.973351 cos_to_last_merge=0.9201 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9431140444777053, 'auprc': 0.950066598774064, 'loss_val': 0.2563937336677001, 'psi': 0.9458950661962489}-{'f1_val': 0.9782121117051181, 'auprc': 0.999598127408396, 'loss_val': 0.0648101642779607, 'psi': 0.9867665179864293}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.704146 cos_to_last_merge=0.9770 (last merge round=22)
[S4] round=46 local utility u=0.045440 metrics={'f1_val': 0.9508921570192301, 'auprc': 0.9811625403950986, 'loss_val': 0.2707185905486236, 'psi': 0.9630003103695775}-{'f1_val': 0.9442794379053618, 'auprc': 0.9704482171054731, 'loss_val': 0.28977852348525546, 'psi': 0.9547469495854064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.674075 cos_to_last_merge=0.9848 (last merge round=21)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.42423153604461883, 'auprc': 0.8260435188991718, 'loss_val': 1.273874395184529, 'psi': 0.58495632918644}-{'f1_val': 0.9964359871706532, 'auprc': 0.9969673184408379, 'loss_val': 0.1348475901986751, 'psi': 0.996648519678727}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.634954 cos_to_last_merge=0.9697 (last merge round=20)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6053772087242586, 'auprc': 0.7921981886822953, 'loss_val': 0.9386342890599434, 'psi': 0.6801056007074733}-{'f1_val': 0.9786938096571056, 'auprc': 0.9922520764814065, 'loss_val': 0.12194500991270343, 'psi': 0.9841171163868259}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.737991 cos_to_last_merge=0.9845 (last merge round=22)
[S7] round=46 local utility u=0.841688 metrics={'f1_val': 0.6428562161685674, 'auprc': 0.8263177164580238, 'loss_val': 0.46855883854216357, 'psi': 0.7162408162843499}-{'f1_val': 0.5181098525625507, 'auprc': 0.7769443574447177, 'loss_val': 1.2553363210403559, 'psi': 0.6216436545154175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=46 head_norm_before_train=1.780815 cos_to_last_merge=0.9675 (last merge round=16)
[S8] round=46 local utility u=0.002102 metrics={'f1_val': 0.992543926000205, 'auprc': 0.9873893790298249, 'loss_val': 0.03953611065838383, 'psi': 0.990482107212053}-{'f1_val': 0.9873594458568917, 'auprc': 0.9987579589720954, 'loss_val': 0.04673991312088569, 'psi': 0.9919188511029732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=1.693889 cos_to_last_merge=0.9766 (last merge round=23)
[S9] round=46 local utility u=0.000651 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.996909713353882, 'loss_val': 0.02191672697656417, 'psi': 0.9968754365969071}-{'f1_val': 0.9960245636725735, 'auprc': 0.9983207196820999, 'loss_val': 0.022483000309935542, 'psi': 0.9969430260763841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=46 head_norm_before_train=2.114146 (no previous merge yet)
[S10] round=46 local utility u=0.001300 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9952001928828212, 'loss_val': 0.055962773519240804, 'psi': 0.9947797913490724}-{'f1_val': 0.9944995236599065, 'auprc': 0.994843460469661, 'loss_val': 0.0574923046505698, 'psi': 0.9946370983838082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=46 head_norm_before_train=2.160566 (no previous merge yet)
[S11] round=46 local utility u=0.792691 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986403805019328, 'loss_val': 0.021902934226690728, 'psi': 0.9971486370472203}-{'f1_val': 0.7931740722014331, 'auprc': 0.9969271992524598, 'loss_val': 0.3842649865273469, 'psi': 0.8746753230218438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=46 head_norm_before_train=1.527310 cos_to_last_merge=0.9173 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.917
[S13] round=46 local utility u=0.209207 metrics={'f1_val': 0.6259108453694676, 'auprc': 0.7655001770174181, 'loss_val': 0.6980684665910829, 'psi': 0.6817465780286478}-{'f1_val': 0.5823677809258208, 'auprc': 0.7949600400247732, 'loss_val': 0.9436027849373156, 'psi': 0.6674046845654017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=46 head_norm_before_train=1.655127 cos_to_last_merge=0.9549 (last merge round=22)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9987225041546491, 'loss_val': 0.02859437619082654, 'psi': 0.9975813494439321}-{'f1_val': 0.9970633655553506, 'auprc': 0.9984404920605758, 'loss_val': 0.02853978365125035, 'psi': 0.9976142161574406}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.967351 cos_to_last_merge=0.8080 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9003013057428324, 'auprc': 0.9968630913988762, 'loss_val': 0.19207230024974659, 'psi': 0.9389260200052499}-{'f1_val': 0.9617949455121251, 'auprc': 0.9974466468280716, 'loss_val': 0.06729695503467131, 'psi': 0.9760556260385036}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.796082 cos_to_last_merge=0.9119 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9886661092537677, 'auprc': 0.9974004704128894, 'loss_val': 0.057248127144199086, 'psi': 0.9921598537174164}-{'f1_val': 0.9914570070691986, 'auprc': 0.996633769607961, 'loss_val': 0.04180765362560346, 'psi': 0.9935277120847036}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.025546 (no previous merge yet)
[S17] round=46 local utility u=0.073577 metrics={'f1_val': 0.6737265241420182, 'auprc': 0.8402676698752837, 'loss_val': 1.3894990603754573, 'psi': 0.7403429824353244}-{'f1_val': 0.6586003575555855, 'auprc': 0.8419159872955514, 'loss_val': 1.4508406312716544, 'psi': 0.731926609451572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=47 head_norm_before_train=1.902194 cos_to_last_merge=0.7977 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=47 local utility u=0.016973 metrics={'f1_val': 0.7086455793729353, 'auprc': 0.9492925632030982, 'loss_val': 0.609359103429818, 'psi': 0.8049043729050005}-{'f1_val': 0.7098515370681948, 'auprc': 0.9211140108192429, 'loss_val': 0.5660060475564774, 'psi': 0.7943565265686141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=47 head_norm_before_train=1.978339 cos_to_last_merge=0.9194 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=47 local utility u=0.203639 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995232433548871, 'loss_val': 0.10525211614791456, 'psi': 0.976454348581627}-{'f1_val': 0.9431140444777053, 'auprc': 0.950066598774064, 'loss_val': 0.2563937336677001, 'psi': 0.9458950661962489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=47 head_norm_before_train=1.707091 cos_to_last_merge=0.9765 (last merge round=22)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9441327204872121, 'auprc': 0.9611625633044525, 'loss_val': 0.29241108660449355, 'psi': 0.9509446576141083}-{'f1_val': 0.9508921570192301, 'auprc': 0.9811625403950986, 'loss_val': 0.2707185905486236, 'psi': 0.9630003103695775}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.676711 cos_to_last_merge=0.9847 (last merge round=21)
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9883368685319254, 'loss_val': 0.2931683809492709, 'psi': 0.8155275378731184}-{'f1_val': 0.42423153604461883, 'auprc': 0.8260435188991718, 'loss_val': 1.273874395184529, 'psi': 0.58495632918644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=47 head_norm_before_train=1.643097 cos_to_last_merge=0.9690 (last merge round=20)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8451894825628752, 'auprc': 0.9748623829989844, 'loss_val': 0.3410426653422425, 'psi': 0.8970586427373188}-{'f1_val': 0.6053772087242586, 'auprc': 0.7921981886822953, 'loss_val': 0.9386342890599434, 'psi': 0.6801056007074733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.741366 cos_to_last_merge=0.9841 (last merge round=22)
[S7] round=47 local utility u=0.722989 metrics={'f1_val': 0.8270129161230648, 'auprc': 0.9224524643883492, 'loss_val': 0.41592540313702037, 'psi': 0.8651887354291785}-{'f1_val': 0.6428562161685674, 'auprc': 0.8263177164580238, 'loss_val': 0.46855883854216357, 'psi': 0.7162408162843499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=47 head_norm_before_train=1.789980 cos_to_last_merge=0.9667 (last merge round=16)
[S8] round=47 local utility u=0.010168 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9918166265364947, 'loss_val': 0.037027450312464676, 'psi': 0.9927076329300333}-{'f1_val': 0.992543926000205, 'auprc': 0.9873893790298249, 'loss_val': 0.03953611065838383, 'psi': 0.990482107212053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=47 head_norm_before_train=1.703567 cos_to_last_merge=0.9760 (last merge round=23)
[S9] round=47 local utility u=0.003998 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984263482001396, 'loss_val': 0.019973434264668265, 'psi': 0.9976322867873415}-{'f1_val': 0.9968525854255906, 'auprc': 0.996909713353882, 'loss_val': 0.02191672697656417, 'psi': 0.9968754365969071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=47 head_norm_before_train=2.119035 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9943672180685432, 'auprc': 0.9943999940062145, 'loss_val': 0.05841101896791255, 'psi': 0.9943803284436117}-{'f1_val': 0.9944995236599065, 'auprc': 0.9952001928828212, 'loss_val': 0.055962773519240804, 'psi': 0.9947797913490724}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.167636 (no previous merge yet)
[S11] round=47 local utility u=0.000800 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986366393286782, 'loss_val': 0.02029122327969511, 'psi': 0.9971471405779185}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986403805019328, 'loss_val': 0.021902934226690728, 'psi': 0.9971486370472203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=47 head_norm_before_train=1.534006 cos_to_last_merge=0.9164 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5959820161766822, 'auprc': 0.7832534513661653, 'loss_val': 0.860571402086752, 'psi': 0.6708905902524755}-{'f1_val': 0.6259108453694676, 'auprc': 0.7655001770174181, 'loss_val': 0.6980684665910829, 'psi': 0.6817465780286478}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.665910 cos_to_last_merge=0.9538 (last merge round=22)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9949318426517025, 'auprc': 0.9983673617737054, 'loss_val': 0.03441856254570783, 'psi': 0.9963060503005037}-{'f1_val': 0.9968205796367875, 'auprc': 0.9987225041546491, 'loss_val': 0.02859437619082654, 'psi': 0.9975813494439321}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.976201 cos_to_last_merge=0.8073 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8879003763609608, 'auprc': 0.9964617771058482, 'loss_val': 0.23343105482585, 'psi': 0.9313249366589157}-{'f1_val': 0.9003013057428324, 'auprc': 0.9968630913988762, 'loss_val': 0.19207230024974659, 'psi': 0.9389260200052499}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.803184 cos_to_last_merge=0.9109 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8454232456221163, 'auprc': 0.858173873360222, 'loss_val': 1.0562275997226964, 'psi': 0.8505234967173586}-{'f1_val': 0.9886661092537677, 'auprc': 0.9974004704128894, 'loss_val': 0.057248127144199086, 'psi': 0.9921598537174164}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.031503 (no previous merge yet)
[S17] round=47 local utility u=0.235032 metrics={'f1_val': 0.6941640935573649, 'auprc': 0.8663886365783604, 'loss_val': 1.1204223811649818, 'psi': 0.763053910765763}-{'f1_val': 0.6737265241420182, 'auprc': 0.8402676698752837, 'loss_val': 1.3894990603754573, 'psi': 0.7403429824353244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=48 head_norm_before_train=1.910075 cos_to_last_merge=0.7967 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=48 local utility u=0.213260 metrics={'f1_val': 0.828459097984185, 'auprc': 0.7972381365578777, 'loss_val': 0.4455577251219036, 'psi': 0.8159707134136621}-{'f1_val': 0.7086455793729353, 'auprc': 0.9492925632030982, 'loss_val': 0.609359103429818, 'psi': 0.8049043729050005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=48 head_norm_before_train=1.987329 cos_to_last_merge=0.9188 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=48 local utility u=0.063392 metrics={'f1_val': 0.9777313909650378, 'auprc': 0.9985910844939601, 'loss_val': 0.07560879971943488, 'psi': 0.9860752683766068}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995232433548871, 'loss_val': 0.10525211614791456, 'psi': 0.976454348581627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=48 head_norm_before_train=1.711729 cos_to_last_merge=0.9760 (last merge round=22)
[S4] round=48 local utility u=0.055319 metrics={'f1_val': 0.9515281048934922, 'auprc': 0.9781676364759138, 'loss_val': 0.27716136569488514, 'psi': 0.9621839175264608}-{'f1_val': 0.9441327204872121, 'auprc': 0.9611625633044525, 'loss_val': 0.29241108660449355, 'psi': 0.9509446576141083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=48 head_norm_before_train=1.677588 cos_to_last_merge=0.9844 (last merge round=21)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9564132861743889, 'loss_val': 0.30146602550101465, 'psi': 0.802757673564571}-{'f1_val': 0.7003213174339138, 'auprc': 0.9883368685319254, 'loss_val': 0.2931683809492709, 'psi': 0.8155275378731184}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.649488 cos_to_last_merge=0.9686 (last merge round=20)
[S6] round=48 local utility u=0.196226 metrics={'f1_val': 0.8877139160219508, 'auprc': 0.9814282272229633, 'loss_val': 0.22343450373729112, 'psi': 0.9251996405023559}-{'f1_val': 0.8451894825628752, 'auprc': 0.9748623829989844, 'loss_val': 0.3410426653422425, 'psi': 0.8970586427373188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=48 head_norm_before_train=1.748416 cos_to_last_merge=0.9834 (last merge round=22)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5615564168943817, 'auprc': 0.7900033086844405, 'loss_val': 0.9245560485290467, 'psi': 0.6529351736104052}-{'f1_val': 0.8270129161230648, 'auprc': 0.9224524643883492, 'loss_val': 0.41592540313702037, 'psi': 0.8651887354291785}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.801214 cos_to_last_merge=0.9656 (last merge round=16)
[S8] round=48 local utility u=0.003156 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.995070234970157, 'loss_val': 0.03609396766099524, 'psi': 0.993570861661348}-{'f1_val': 0.9933016371923923, 'auprc': 0.9918166265364947, 'loss_val': 0.037027450312464676, 'psi': 0.9927076329300333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=48 head_norm_before_train=1.713658 cos_to_last_merge=0.9754 (last merge round=23)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962422795474182, 'loss_val': 0.019978277102874916, 'psi': 0.996758659326253}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984263482001396, 'loss_val': 0.019973434264668265, 'psi': 0.9976322867873415}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.125973 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9943672180685432, 'auprc': 0.9943544175724373, 'loss_val': 0.058750700605144986, 'psi': 0.9943620978701008}-{'f1_val': 0.9943672180685432, 'auprc': 0.9943999940062145, 'loss_val': 0.05841101896791255, 'psi': 0.9943803284436117}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.175483 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986240034126006, 'loss_val': 0.020298194833061167, 'psi': 0.9971420862114875}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986366393286782, 'loss_val': 0.02029122327969511, 'psi': 0.9971471405779185}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.542182 cos_to_last_merge=0.9152 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=48 local utility u=0.272212 metrics={'f1_val': 0.6788808201157791, 'auprc': 0.7793817710223003, 'loss_val': 0.8019252172093253, 'psi': 0.7190812004783876}-{'f1_val': 0.5959820161766822, 'auprc': 0.7832534513661653, 'loss_val': 0.860571402086752, 'psi': 0.6708905902524755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=48 head_norm_before_train=1.674663 cos_to_last_merge=0.9530 (last merge round=22)
[S14] round=48 local utility u=0.008355 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9987701570929699, 'loss_val': 0.028671084223878523, 'psi': 0.9974425326003853}-{'f1_val': 0.9949318426517025, 'auprc': 0.9983673617737054, 'loss_val': 0.03441856254570783, 'psi': 0.9963060503005037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=48 head_norm_before_train=1.984902 cos_to_last_merge=0.8066 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=48 local utility u=0.132467 metrics={'f1_val': 0.9163758049289272, 'auprc': 0.9970751756491687, 'loss_val': 0.14119051872990973, 'psi': 0.9486555532170238}-{'f1_val': 0.8879003763609608, 'auprc': 0.9964617771058482, 'loss_val': 0.23343105482585, 'psi': 0.9313249366589157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=48 head_norm_before_train=1.808560 cos_to_last_merge=0.9103 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=48 local utility u=1.000000 metrics={'f1_val': 0.9875946859154177, 'auprc': 0.9929600812047686, 'loss_val': 0.05686069974343734, 'psi': 0.989740844031158}-{'f1_val': 0.8454232456221163, 'auprc': 0.858173873360222, 'loss_val': 1.0562275997226964, 'psi': 0.8505234967173586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=48 head_norm_before_train=2.037383 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6554256314868259, 'auprc': 0.8403061087499928, 'loss_val': 1.4766769247235998, 'psi': 0.7293778223920926}-{'f1_val': 0.6941640935573649, 'auprc': 0.8663886365783604, 'loss_val': 1.1204223811649818, 'psi': 0.763053910765763}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.918103 cos_to_last_merge=0.7958 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8030971812623264, 'auprc': 0.8564912251044738, 'loss_val': 0.5427766667440814, 'psi': 0.8244547987991854}-{'f1_val': 0.828459097984185, 'auprc': 0.7972381365578777, 'loss_val': 0.4455577251219036, 'psi': 0.8159707134136621}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.998316 cos_to_last_merge=0.9180 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9934223364454488, 'loss_val': 0.18633718786952425, 'psi': 0.9735237636228877}-{'f1_val': 0.9777313909650378, 'auprc': 0.9985910844939601, 'loss_val': 0.07560879971943488, 'psi': 0.9860752683766068}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.714872 cos_to_last_merge=0.9755 (last merge round=22)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9511431852934062, 'auprc': 0.960219815002697, 'loss_val': 0.28268476872533255, 'psi': 0.9547738371771226}-{'f1_val': 0.9515281048934922, 'auprc': 0.9781676364759138, 'loss_val': 0.27716136569488514, 'psi': 0.9621839175264608}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.677605 cos_to_last_merge=0.9844 (last merge round=21)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6833297555025774, 'auprc': 0.8817252880688051, 'loss_val': 0.34091547269031836, 'psi': 0.7626879685290685}-{'f1_val': 0.700320598491359, 'auprc': 0.9564132861743889, 'loss_val': 0.30146602550101465, 'psi': 0.802757673564571}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.655045 cos_to_last_merge=0.9680 (last merge round=20)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8109996634995335, 'auprc': 0.9541183207736932, 'loss_val': 0.5039767579992095, 'psi': 0.8682471264091973}-{'f1_val': 0.8877139160219508, 'auprc': 0.9814282272229633, 'loss_val': 0.22343450373729112, 'psi': 0.9251996405023559}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.757210 cos_to_last_merge=0.9824 (last merge round=22)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5357942362000131, 'auprc': 0.7759320820155265, 'loss_val': 1.2025347011840655, 'psi': 0.6318493745262185}-{'f1_val': 0.5615564168943817, 'auprc': 0.7900033086844405, 'loss_val': 0.9245560485290467, 'psi': 0.6529351736104052}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.812419 cos_to_last_merge=0.9644 (last merge round=16)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9904055349873329, 'auprc': 0.9987350319583255, 'loss_val': 0.0402793421647431, 'psi': 0.9937373337757299}-{'f1_val': 0.9925712794554754, 'auprc': 0.995070234970157, 'loss_val': 0.03609396766099524, 'psi': 0.993570861661348}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.723984 cos_to_last_merge=0.9747 (last merge round=23)
[S9] round=49 local utility u=0.002292 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.998401756321985, 'loss_val': 0.019389816537892506, 'psi': 0.9973741915074972}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962422795474182, 'loss_val': 0.019978277102874916, 'psi': 0.996758659326253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=49 head_norm_before_train=2.133709 (no previous merge yet)
[S10] round=49 local utility u=0.003898 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948343344220673, 'loss_val': 0.05318924156687801, 'psi': 0.9946334479647707}-{'f1_val': 0.9943672180685432, 'auprc': 0.9943544175724373, 'loss_val': 0.058750700605144986, 'psi': 0.9943620978701008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=49 head_norm_before_train=2.183110 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985749209378355, 'loss_val': 0.02099807786410901, 'psi': 0.9971101733231198}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986240034126006, 'loss_val': 0.020298194833061167, 'psi': 0.9971420862114875}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.552328 cos_to_last_merge=0.9135 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6565086032435709, 'auprc': 0.7267992366001905, 'loss_val': 0.6580399155679222, 'psi': 0.6846248565862187}-{'f1_val': 0.6788808201157791, 'auprc': 0.7793817710223003, 'loss_val': 0.8019252172093253, 'psi': 0.7190812004783876}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.681774 cos_to_last_merge=0.9524 (last merge round=22)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9970451067700439, 'loss_val': 0.028791930206382817, 'psi': 0.9965063470268198}-{'f1_val': 0.9965574496053289, 'auprc': 0.9987701570929699, 'loss_val': 0.028671084223878523, 'psi': 0.9974425326003853}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.993291 cos_to_last_merge=0.8059 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=49 local utility u=0.045899 metrics={'f1_val': 0.9270199019487131, 'auprc': 0.9971772495086157, 'loss_val': 0.11356282150906924, 'psi': 0.9550828409726742}-{'f1_val': 0.9163758049289272, 'auprc': 0.9970751756491687, 'loss_val': 0.14119051872990973, 'psi': 0.9486555532170238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=49 head_norm_before_train=1.813564 cos_to_last_merge=0.9095 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9416472817323135, 'auprc': 0.9884856376426654, 'loss_val': 0.24954340938512, 'psi': 0.9603826240964543}-{'f1_val': 0.9875946859154177, 'auprc': 0.9929600812047686, 'loss_val': 0.05686069974343734, 'psi': 0.989740844031158}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.041859 (no previous merge yet)
[S17] round=49 local utility u=0.556401 metrics={'f1_val': 0.7230817723138573, 'auprc': 0.886019824182295, 'loss_val': 0.9069537026959349, 'psi': 0.7882569930612324}-{'f1_val': 0.6554256314868259, 'auprc': 0.8403061087499928, 'loss_val': 1.4766769247235998, 'psi': 0.7293778223920926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=50 head_norm_before_train=1.927312 cos_to_last_merge=0.7948 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.7048424355785489, 'auprc': 0.7386332541566882, 'loss_val': 0.8787557947839174, 'psi': 0.7183587630098046}-{'f1_val': 0.8030971812623264, 'auprc': 0.8564912251044738, 'loss_val': 0.5427766667440814, 'psi': 0.8244547987991854}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=50 head_norm_before_train=2.009738 cos_to_last_merge=0.9173 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=50 local utility u=0.107780 metrics={'f1_val': 0.9747179186294904, 'auprc': 0.9991613601380107, 'loss_val': 0.0747531450831228, 'psi': 0.9844952952328985}-{'f1_val': 0.9602580484078469, 'auprc': 0.9934223364454488, 'loss_val': 0.18633718786952425, 'psi': 0.9735237636228877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=50 head_norm_before_train=1.717512 cos_to_last_merge=0.9751 (last merge round=22)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9530054824920107, 'auprc': 0.9471545950799232, 'loss_val': 0.2878564216440543, 'psi': 0.9506651275271757}-{'f1_val': 0.9511431852934062, 'auprc': 0.960219815002697, 'loss_val': 0.28268476872533255, 'psi': 0.9547738371771226}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.680485 cos_to_last_merge=0.9836 (last merge round=21)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.6664358362216488, 'auprc': 0.8639472609068617, 'loss_val': 0.41483022836125794, 'psi': 0.745440406095734}-{'f1_val': 0.6833297555025774, 'auprc': 0.8817252880688051, 'loss_val': 0.34091547269031836, 'psi': 0.7626879685290685}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=1.663403 cos_to_last_merge=0.9667 (last merge round=20)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.5953750418695691, 'auprc': 0.7778557405756167, 'loss_val': 1.0215259861592172, 'psi': 0.6683673213519882}-{'f1_val': 0.8109996634995335, 'auprc': 0.9541183207736932, 'loss_val': 0.5039767579992095, 'psi': 0.8682471264091973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.764404 cos_to_last_merge=0.9814 (last merge round=22)
[S7] round=50 local utility u=0.157592 metrics={'f1_val': 0.557719748951047, 'auprc': 0.7807357389522008, 'loss_val': 1.0333140452874865, 'psi': 0.6469261449515086}-{'f1_val': 0.5357942362000131, 'auprc': 0.7759320820155265, 'loss_val': 1.2025347011840655, 'psi': 0.6318493745262185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=50 head_norm_before_train=1.818797 cos_to_last_merge=0.9648 (last merge round=16)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9987421507751413, 'loss_val': 0.04291569293190928, 'psi': 0.9933078068273393}-{'f1_val': 0.9904055349873329, 'auprc': 0.9987350319583255, 'loss_val': 0.0402793421647431, 'psi': 0.9937373337757299}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.734606 cos_to_last_merge=0.9740 (last merge round=23)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9982744967006432, 'loss_val': 0.025372804563875844, 'psi': 0.9955729501228339}-{'f1_val': 0.9966891482978385, 'auprc': 0.998401756321985, 'loss_val': 0.019389816537892506, 'psi': 0.9973741915074972}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.141842 (no previous merge yet)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943787450479147, 'loss_val': 0.055436798792654854, 'psi': 0.9944512122151097}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948343344220673, 'loss_val': 0.05318924156687801, 'psi': 0.9946334479647707}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=2.190622 (no previous merge yet)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9936866002387977, 'auprc': 0.9985759354125291, 'loss_val': 0.027482833390726845, 'psi': 0.9956423343082903}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985749209378355, 'loss_val': 0.02099807786410901, 'psi': 0.9971101733231198}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.562413 cos_to_last_merge=0.9121 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.912
[S13] round=50 local utility u=0.012171 metrics={'f1_val': 0.6566940602741634, 'auprc': 0.8012662539018982, 'loss_val': 0.858210762659856, 'psi': 0.7145229377252573}-{'f1_val': 0.6565086032435709, 'auprc': 0.7267992366001905, 'loss_val': 0.6580399155679222, 'psi': 0.6846248565862187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=50 head_norm_before_train=1.688717 cos_to_last_merge=0.9516 (last merge round=22)
[S14] round=50 local utility u=0.001798 metrics={'f1_val': 0.9961901736218755, 'auprc': 0.9978093070185471, 'loss_val': 0.02774668191071587, 'psi': 0.996837826980544}-{'f1_val': 0.9961471738646706, 'auprc': 0.9970451067700439, 'loss_val': 0.028791930206382817, 'psi': 0.9965063470268198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=50 head_norm_before_train=2.001574 cos_to_last_merge=0.8052 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.805
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.915854658503641, 'auprc': 0.9966859034590013, 'loss_val': 0.13338442511820536, 'psi': 0.9481871564857851}-{'f1_val': 0.9270199019487131, 'auprc': 0.9971772495086157, 'loss_val': 0.11356282150906924, 'psi': 0.9550828409726742}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.819519 cos_to_last_merge=0.9086 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.909
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8439034513335706, 'auprc': 0.9914746858198388, 'loss_val': 0.9538139793740811, 'psi': 0.902931945128078}-{'f1_val': 0.9416472817323135, 'auprc': 0.9884856376426654, 'loss_val': 0.24954340938512, 'psi': 0.9603826240964543}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=2.045640 (no previous merge yet)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6706741736269376, 'auprc': 0.8503513996959404, 'loss_val': 1.3776836491202673, 'psi': 0.7425450640545388}-{'f1_val': 0.7230817723138573, 'auprc': 0.886019824182295, 'loss_val': 0.9069537026959349, 'psi': 0.7882569930612324}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.935029 cos_to_last_merge=0.7939 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=51 local utility u=0.484019 metrics={'f1_val': 0.7186003608504941, 'auprc': 0.9144031957893255, 'loss_val': 0.5205741959619251, 'psi': 0.7969214948260266}-{'f1_val': 0.7048424355785489, 'auprc': 0.7386332541566882, 'loss_val': 0.8787557947839174, 'psi': 0.7183587630098046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=51 head_norm_before_train=2.022613 cos_to_last_merge=0.9165 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=51 local utility u=0.050488 metrics={'f1_val': 0.9859423240786731, 'auprc': 0.9990925646251448, 'loss_val': 0.04091658582547239, 'psi': 0.9912024202972618}-{'f1_val': 0.9747179186294904, 'auprc': 0.9991613601380107, 'loss_val': 0.0747531450831228, 'psi': 0.9844952952328985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=51 head_norm_before_train=1.721392 cos_to_last_merge=0.9747 (last merge round=22)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9499187755065226, 'auprc': 0.9400156801140269, 'loss_val': 0.2910832067417524, 'psi': 0.9459575373495243}-{'f1_val': 0.9530054824920107, 'auprc': 0.9471545950799232, 'loss_val': 0.2878564216440543, 'psi': 0.9506651275271757}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.684793 cos_to_last_merge=0.9832 (last merge round=21)
[S5] round=51 local utility u=0.477016 metrics={'f1_val': 0.7496638507336094, 'auprc': 0.9695288202392394, 'loss_val': 0.27691096414740335, 'psi': 0.8376098385358615}-{'f1_val': 0.6664358362216488, 'auprc': 0.8639472609068617, 'loss_val': 0.41483022836125794, 'psi': 0.745440406095734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=51 head_norm_before_train=1.672658 cos_to_last_merge=0.9655 (last merge round=20)
[S6] round=51 local utility u=1.000000 metrics={'f1_val': 0.8878409857339871, 'auprc': 0.9751944328137184, 'loss_val': 0.22575878368291127, 'psi': 0.9227823645658796}-{'f1_val': 0.5953750418695691, 'auprc': 0.7778557405756167, 'loss_val': 1.0215259861592172, 'psi': 0.6683673213519882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=51 head_norm_before_train=1.774006 cos_to_last_merge=0.9802 (last merge round=22)
[S7] round=51 local utility u=0.429622 metrics={'f1_val': 0.6142979052351554, 'auprc': 0.8370167038777427, 'loss_val': 0.6823826615560425, 'psi': 0.7033854246921903}-{'f1_val': 0.557719748951047, 'auprc': 0.7807357389522008, 'loss_val': 1.0333140452874865, 'psi': 0.6469261449515086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=51 head_norm_before_train=1.824781 cos_to_last_merge=0.9651 (last merge round=16)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9919702074593876, 'auprc': 0.9859440168225481, 'loss_val': 0.05187859490875098, 'psi': 0.9895597312046518}-{'f1_val': 0.9896849108621378, 'auprc': 0.9987421507751413, 'loss_val': 0.04291569293190928, 'psi': 0.9933078068273393}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.742827 cos_to_last_merge=0.9735 (last merge round=23)
[S9] round=51 local utility u=0.013228 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982860754722669, 'loss_val': 0.018936708814557744, 'psi': 0.9975761776961924}-{'f1_val': 0.9937719190709611, 'auprc': 0.9982744967006432, 'loss_val': 0.025372804563875844, 'psi': 0.9955729501228339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=51 head_norm_before_train=2.150032 (no previous merge yet)
[S10] round=51 local utility u=0.000122 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943771227719161, 'loss_val': 0.05518826864294403, 'psi': 0.9944505633047103}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943787450479147, 'loss_val': 0.055436798792654854, 'psi': 0.9944512122151097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=51 head_norm_before_train=2.197303 (no previous merge yet)
[S11] round=51 local utility u=0.011396 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982347943878445, 'loss_val': 0.02082916357639603, 'psi': 0.9972221204632915}-{'f1_val': 0.9936866002387977, 'auprc': 0.9985759354125291, 'loss_val': 0.027482833390726845, 'psi': 0.9956423343082903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=51 head_norm_before_train=1.569491 cos_to_last_merge=0.9111 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6262631732278521, 'auprc': 0.7666337034241116, 'loss_val': 0.9110947731050684, 'psi': 0.6824113853063558}-{'f1_val': 0.6566940602741634, 'auprc': 0.8012662539018982, 'loss_val': 0.858210762659856, 'psi': 0.7145229377252573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.697130 cos_to_last_merge=0.9505 (last merge round=22)
[S14] round=51 local utility u=0.004599 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9984274583201677, 'loss_val': 0.025250663609557616, 'psi': 0.9975698685993027}-{'f1_val': 0.9961901736218755, 'auprc': 0.9978093070185471, 'loss_val': 0.02774668191071587, 'psi': 0.996837826980544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=51 head_norm_before_train=2.009361 cos_to_last_merge=0.8046 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.805
[S15] round=51 local utility u=0.058321 metrics={'f1_val': 0.9301590831068729, 'auprc': 0.9968412097185502, 'loss_val': 0.10303573831186436, 'psi': 0.9568319337515439}-{'f1_val': 0.915854658503641, 'auprc': 0.9966859034590013, 'loss_val': 0.13338442511820536, 'psi': 0.9481871564857851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=51 head_norm_before_train=1.826193 cos_to_last_merge=0.9075 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=51 local utility u=0.791299 metrics={'f1_val': 0.966946980436364, 'auprc': 0.9910663060939142, 'loss_val': 0.10825104587441409, 'psi': 0.9765947106993841}-{'f1_val': 0.8439034513335706, 'auprc': 0.9914746858198388, 'loss_val': 0.9538139793740811, 'psi': 0.902931945128078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=51 head_norm_before_train=2.049541 (no previous merge yet)
[S17] round=51 local utility u=0.139560 metrics={'f1_val': 0.6838389754870718, 'auprc': 0.8795677896848599, 'loss_val': 1.2652015927968843, 'psi': 0.7621305011661871}-{'f1_val': 0.6706741736269376, 'auprc': 0.8503513996959404, 'loss_val': 1.3776836491202673, 'psi': 0.7425450640545388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=52 head_norm_before_train=1.941779 cos_to_last_merge=0.7930 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.793
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.7096195863969175, 'auprc': 0.914225996323516, 'loss_val': 0.5990188508512243, 'psi': 0.791462150367557}-{'f1_val': 0.7186003608504941, 'auprc': 0.9144031957893255, 'loss_val': 0.5205741959619251, 'psi': 0.7969214948260266}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.032535 cos_to_last_merge=0.9158 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8818354986624393, 'auprc': 0.9958029115309281, 'loss_val': 0.2093923303903251, 'psi': 0.9274224638098347}-{'f1_val': 0.9859423240786731, 'auprc': 0.9990925646251448, 'loss_val': 0.04091658582547239, 'psi': 0.9912024202972618}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.727288 cos_to_last_merge=0.9741 (last merge round=22)
[S4] round=52 local utility u=0.015003 metrics={'f1_val': 0.948944743545106, 'auprc': 0.9510103955899974, 'loss_val': 0.288217113780471, 'psi': 0.9497710043630625}-{'f1_val': 0.9499187755065226, 'auprc': 0.9400156801140269, 'loss_val': 0.2910832067417524, 'psi': 0.9459575373495243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=52 head_norm_before_train=1.692158 cos_to_last_merge=0.9826 (last merge round=21)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.6042243335946795, 'auprc': 0.6855476487953197, 'loss_val': 0.7342888043755319, 'psi': 0.6367536596749357}-{'f1_val': 0.7496638507336094, 'auprc': 0.9695288202392394, 'loss_val': 0.27691096414740335, 'psi': 0.8376098385358615}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.674352 cos_to_last_merge=0.9649 (last merge round=20)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.8703601391501967, 'auprc': 0.9596842265438719, 'loss_val': 0.30061728999311, 'psi': 0.9060897741076668}-{'f1_val': 0.8878409857339871, 'auprc': 0.9751944328137184, 'loss_val': 0.22575878368291127, 'psi': 0.9227823645658796}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.783306 cos_to_last_merge=0.9791 (last merge round=22)
[S7] round=52 local utility u=0.445924 metrics={'f1_val': 0.7012546198863565, 'auprc': 0.9320457768065123, 'loss_val': 0.5973612560366114, 'psi': 0.7935710826544189}-{'f1_val': 0.6142979052351554, 'auprc': 0.8370167038777427, 'loss_val': 0.6823826615560425, 'psi': 0.7033854246921903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=52 head_norm_before_train=1.830441 cos_to_last_merge=0.9650 (last merge round=16)
[S8] round=52 local utility u=0.027123 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9984157399012639, 'loss_val': 0.03646881787103723, 'psi': 0.9946904519191903}-{'f1_val': 0.9919702074593876, 'auprc': 0.9859440168225481, 'loss_val': 0.05187859490875098, 'psi': 0.9895597312046518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=52 head_norm_before_train=1.749165 cos_to_last_merge=0.9732 (last merge round=23)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.994945406105223, 'loss_val': 0.019662892183452057, 'psi': 0.9962399099493748}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982860754722669, 'loss_val': 0.018936708814557744, 'psi': 0.9975761776961924}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=2.158198 (no previous merge yet)
[S10] round=52 local utility u=0.004678 metrics={'f1_val': 0.9949076376791339, 'auprc': 0.9952618424678693, 'loss_val': 0.050935994871724635, 'psi': 0.9950493195946281}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943771227719161, 'loss_val': 0.05518826864294403, 'psi': 0.9944505633047103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=52 head_norm_before_train=2.204564 (no previous merge yet)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980539992329949, 'loss_val': 0.021834461959289418, 'psi': 0.9970047001745146}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982347943878445, 'loss_val': 0.02082916357639603, 'psi': 0.9972221204632915}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.576671 cos_to_last_merge=0.9102 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=52 local utility u=0.029985 metrics={'f1_val': 0.6440195734579839, 'auprc': 0.7320650443946287, 'loss_val': 0.8539562110911645, 'psi': 0.6792377618326418}-{'f1_val': 0.6262631732278521, 'auprc': 0.7666337034241116, 'loss_val': 0.9110947731050684, 'psi': 0.6824113853063558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=52 head_norm_before_train=1.703639 cos_to_last_merge=0.9497 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.996748294078148, 'auprc': 0.9987264523337691, 'loss_val': 0.030547748553744983, 'psi': 0.9975395573803965}-{'f1_val': 0.9969981421187261, 'auprc': 0.9984274583201677, 'loss_val': 0.025250663609557616, 'psi': 0.9975698685993027}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=2.016382 cos_to_last_merge=0.8040 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.804
[S15] round=52 local utility u=0.134601 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9973612271625086, 'loss_val': 0.05836847155710524, 'psi': 0.9793374020283421}-{'f1_val': 0.9301590831068729, 'auprc': 0.9968412097185502, 'loss_val': 0.10303573831186436, 'psi': 0.9568319337515439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=52 head_norm_before_train=1.832522 cos_to_last_merge=0.9067 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9394085082038753, 'auprc': 0.9937325842229319, 'loss_val': 0.2846883511790903, 'psi': 0.961138138611498}-{'f1_val': 0.966946980436364, 'auprc': 0.9910663060939142, 'loss_val': 0.10825104587441409, 'psi': 0.9765947106993841}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=2.053277 (no previous merge yet)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.680415024065623, 'auprc': 0.8791898789069772, 'loss_val': 1.2507180022709539, 'psi': 0.7599249660021647}-{'f1_val': 0.6838389754870718, 'auprc': 0.8795677896848599, 'loss_val': 1.2652015927968843, 'psi': 0.7621305011661871}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.948180 cos_to_last_merge=0.7923 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.7144579951054718, 'auprc': 0.8702947258358604, 'loss_val': 0.5285388984755591, 'psi': 0.7767926873976273}-{'f1_val': 0.7096195863969175, 'auprc': 0.914225996323516, 'loss_val': 0.5990188508512243, 'psi': 0.791462150367557}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.040779 cos_to_last_merge=0.9150 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=53 local utility u=0.027531 metrics={'f1_val': 0.9032736268920649, 'auprc': 0.9850027146181088, 'loss_val': 0.25055893377147215, 'psi': 0.9359652619824825}-{'f1_val': 0.8818354986624393, 'auprc': 0.9958029115309281, 'loss_val': 0.2093923303903251, 'psi': 0.9274224638098347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=53 head_norm_before_train=1.735250 cos_to_last_merge=0.9733 (last merge round=22)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9463082982046632, 'auprc': 0.9341368682239559, 'loss_val': 0.2936037697822601, 'psi': 0.9414397262123803}-{'f1_val': 0.948944743545106, 'auprc': 0.9510103955899974, 'loss_val': 0.288217113780471, 'psi': 0.9497710043630625}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.702780 cos_to_last_merge=0.9822 (last merge round=21)
[S5] round=53 local utility u=0.683963 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8403551022396432, 'loss_val': 0.4073623826294454, 'psi': 0.7563343999906726}-{'f1_val': 0.6042243335946795, 'auprc': 0.6855476487953197, 'loss_val': 0.7342888043755319, 'psi': 0.6367536596749357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=53 head_norm_before_train=1.678122 cos_to_last_merge=0.9645 (last merge round=20)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.6174542558054157, 'auprc': 0.8928452297921752, 'loss_val': 0.9066370079709012, 'psi': 0.7276106454001194}-{'f1_val': 0.8703601391501967, 'auprc': 0.9596842265438719, 'loss_val': 0.30061728999311, 'psi': 0.9060897741076668}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.794718 cos_to_last_merge=0.9774 (last merge round=22)
[S7] round=53 local utility u=0.812862 metrics={'f1_val': 0.9037598193066888, 'auprc': 0.9732342963274758, 'loss_val': 0.3102331142558585, 'psi': 0.9315496101150036}-{'f1_val': 0.7012546198863565, 'auprc': 0.9320457768065123, 'loss_val': 0.5973612560366114, 'psi': 0.7935710826544189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=53 head_norm_before_train=1.832194 cos_to_last_merge=0.9648 (last merge round=16)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9987823317340098, 'loss_val': 0.04157714293808156, 'psi': 0.9932985291779743}-{'f1_val': 0.9922069265978078, 'auprc': 0.9984157399012639, 'loss_val': 0.03646881787103723, 'psi': 0.9946904519191903}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.755923 cos_to_last_merge=0.9728 (last merge round=23)
[S9] round=53 local utility u=0.004270 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984243173660403, 'loss_val': 0.018904974244674872, 'psi': 0.997366034034751}-{'f1_val': 0.9971029125121428, 'auprc': 0.994945406105223, 'loss_val': 0.019662892183452057, 'psi': 0.9962399099493748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=53 head_norm_before_train=2.166190 (no previous merge yet)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943974271313538, 'loss_val': 0.05450117665737723, 'psi': 0.9944586850484853}-{'f1_val': 0.9949076376791339, 'auprc': 0.9952618424678693, 'loss_val': 0.050935994871724635, 'psi': 0.9950493195946281}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=2.211131 (no previous merge yet)
[S11] round=53 local utility u=0.001019 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986062283951729, 'loss_val': 0.020424202916325455, 'psi': 0.9971226963060548}-{'f1_val': 0.996305167468861, 'auprc': 0.9980539992329949, 'loss_val': 0.021834461959289418, 'psi': 0.9970047001745146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=53 head_norm_before_train=1.584869 cos_to_last_merge=0.9091 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=53 local utility u=0.083528 metrics={'f1_val': 0.6644222763930456, 'auprc': 0.745274118300631, 'loss_val': 0.8489437226844985, 'psi': 0.6967630131560798}-{'f1_val': 0.6440195734579839, 'auprc': 0.7320650443946287, 'loss_val': 0.8539562110911645, 'psi': 0.6792377618326418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=53 head_norm_before_train=1.710583 cos_to_last_merge=0.9491 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9949318426517025, 'auprc': 0.9987288234239199, 'loss_val': 0.03604932957530421, 'psi': 0.9964506349605895}-{'f1_val': 0.996748294078148, 'auprc': 0.9987264523337691, 'loss_val': 0.030547748553744983, 'psi': 0.9975395573803965}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=2.023476 cos_to_last_merge=0.8034 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.803
[S15] round=53 local utility u=0.005936 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9979380743593395, 'loss_val': 0.0536606459645091, 'psi': 0.9801115489514012}-{'f1_val': 0.9673215186055643, 'auprc': 0.9973612271625086, 'loss_val': 0.05836847155710524, 'psi': 0.9793374020283421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=53 head_norm_before_train=1.839567 cos_to_last_merge=0.9058 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8462439382106004, 'auprc': 0.9816728674534231, 'loss_val': 0.9947737457492234, 'psi': 0.9004155099077294}-{'f1_val': 0.9394085082038753, 'auprc': 0.9937325842229319, 'loss_val': 0.2846883511790903, 'psi': 0.961138138611498}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=2.059304 (no previous merge yet)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6783884711227521, 'auprc': 0.8796789507208853, 'loss_val': 1.2710619754550232, 'psi': 0.7589046629620054}-{'f1_val': 0.680415024065623, 'auprc': 0.8791898789069772, 'loss_val': 1.2507180022709539, 'psi': 0.7599249660021647}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.956044 cos_to_last_merge=0.7916 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=54 local utility u=0.046123 metrics={'f1_val': 0.7096708974499177, 'auprc': 0.9182698968354184, 'loss_val': 0.551495570691658, 'psi': 0.7931104972041181}-{'f1_val': 0.7144579951054718, 'auprc': 0.8702947258358604, 'loss_val': 0.5285388984755591, 'psi': 0.7767926873976273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=54 head_norm_before_train=2.050569 cos_to_last_merge=0.9143 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.8555957521979676, 'auprc': 0.9981837255025101, 'loss_val': 0.254382137840562, 'psi': 0.9126309415197846}-{'f1_val': 0.9032736268920649, 'auprc': 0.9850027146181088, 'loss_val': 0.25055893377147215, 'psi': 0.9359652619824825}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.739994 cos_to_last_merge=0.9725 (last merge round=22)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9461835888987546, 'auprc': 0.928684659568864, 'loss_val': 0.29536223577337023, 'psi': 0.9391840171667984}-{'f1_val': 0.9463082982046632, 'auprc': 0.9341368682239559, 'loss_val': 0.2936037697822601, 'psi': 0.9414397262123803}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.712253 cos_to_last_merge=0.9820 (last merge round=21)
[S5] round=54 local utility u=0.298346 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9936275613835186, 'loss_val': 0.2704871756296473, 'psi': 0.8176433836482229}-{'f1_val': 0.700320598491359, 'auprc': 0.8403551022396432, 'loss_val': 0.4073623826294454, 'psi': 0.7563343999906726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=54 head_norm_before_train=1.684907 cos_to_last_merge=0.9640 (last merge round=20)
[S6] round=54 local utility u=0.784719 metrics={'f1_val': 0.7771105243969578, 'auprc': 0.9532241661397316, 'loss_val': 0.47627420437306306, 'psi': 0.8475559810940674}-{'f1_val': 0.6174542558054157, 'auprc': 0.8928452297921752, 'loss_val': 0.9066370079709012, 'psi': 0.7276106454001194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=54 head_norm_before_train=1.809265 cos_to_last_merge=0.9753 (last merge round=22)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5786354406808519, 'auprc': 0.7700839360399201, 'loss_val': 0.9343018888782506, 'psi': 0.6552148388244792}-{'f1_val': 0.9037598193066888, 'auprc': 0.9732342963274758, 'loss_val': 0.3102331142558585, 'psi': 0.9315496101150036}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.836777 cos_to_last_merge=0.9644 (last merge round=16)
[S8] round=54 local utility u=0.011253 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9986617507054207, 'loss_val': 0.036334923203057354, 'psi': 0.9950128830116117}-{'f1_val': 0.9896426608072839, 'auprc': 0.9987823317340098, 'loss_val': 0.04157714293808156, 'psi': 0.9932985291779743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=54 head_norm_before_train=1.763635 cos_to_last_merge=0.9723 (last merge round=23)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962461869510288, 'loss_val': 0.019062915027121843, 'psi': 0.9967602222876972}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984243173660403, 'loss_val': 0.018904974244674872, 'psi': 0.997366034034751}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.169081 (no previous merge yet)
[S10] round=54 local utility u=0.001702 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948020143002286, 'loss_val': 0.052310024092300914, 'psi': 0.9946205199160353}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943974271313538, 'loss_val': 0.05450117665737723, 'psi': 0.9944586850484853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=54 head_norm_before_train=2.215031 (no previous merge yet)
[S11] round=54 local utility u=0.000399 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986432832120877, 'loss_val': 0.01986011443435386, 'psi': 0.9971497981312823}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986062283951729, 'loss_val': 0.020424202916325455, 'psi': 0.9971226963060548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=54 head_norm_before_train=1.594692 cos_to_last_merge=0.9079 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.6132847055639099, 'auprc': 0.7136291416912022, 'loss_val': 1.0091604462783728, 'psi': 0.6534224800148267}-{'f1_val': 0.6644222763930456, 'auprc': 0.745274118300631, 'loss_val': 0.8489437226844985, 'psi': 0.6967630131560798}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.718903 cos_to_last_merge=0.9483 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=54 local utility u=0.010957 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9984257967685357, 'loss_val': 0.02702347045522365, 'psi': 0.997709123295923}-{'f1_val': 0.9949318426517025, 'auprc': 0.9987288234239199, 'loss_val': 0.03604932957530421, 'psi': 0.9964506349605895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=54 head_norm_before_train=2.030653 cos_to_last_merge=0.8028 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.803
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9572251977844842, 'auprc': 0.9978833175201296, 'loss_val': 0.0698291806322194, 'psi': 0.9734884456787424}-{'f1_val': 0.9682271986794423, 'auprc': 0.9979380743593395, 'loss_val': 0.0536606459645091, 'psi': 0.9801115489514012}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.845645 cos_to_last_merge=0.9050 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=54 local utility u=0.935417 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.992400959718242, 'loss_val': 0.035765045162613134, 'psi': 0.9926708912320203}-{'f1_val': 0.8462439382106004, 'auprc': 0.9816728674534231, 'loss_val': 0.9947737457492234, 'psi': 0.9004155099077294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=54 head_norm_before_train=2.064685 (no previous merge yet)
[S17] round=54 local utility u=0.429274 metrics={'f1_val': 0.7098391983189103, 'auprc': 0.9419677119707545, 'loss_val': 0.7880837594839504, 'psi': 0.802690603779648}-{'f1_val': 0.6783884711227521, 'auprc': 0.8796789507208853, 'loss_val': 1.2710619754550232, 'psi': 0.7589046629620054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=55 head_norm_before_train=1.960432 cos_to_last_merge=0.7909 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=55 local utility u=0.164256 metrics={'f1_val': 0.7703639201232164, 'auprc': 0.8807479590909271, 'loss_val': 0.474576483951773, 'psi': 0.8145175357103007}-{'f1_val': 0.7096708974499177, 'auprc': 0.9182698968354184, 'loss_val': 0.551495570691658, 'psi': 0.7931104972041181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=55 head_norm_before_train=2.060407 cos_to_last_merge=0.9137 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=55 local utility u=0.273917 metrics={'f1_val': 0.9320139977112011, 'auprc': 0.9982700063821788, 'loss_val': 0.16531731958371715, 'psi': 0.9585164011795921}-{'f1_val': 0.8555957521979676, 'auprc': 0.9981837255025101, 'loss_val': 0.254382137840562, 'psi': 0.9126309415197846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=55 head_norm_before_train=1.743814 cos_to_last_merge=0.9718 (last merge round=22)
[S4] round=55 local utility u=0.041596 metrics={'f1_val': 0.9476713124110916, 'auprc': 0.9518115998453138, 'loss_val': 0.29047646091568213, 'psi': 0.9493274273847805}-{'f1_val': 0.9461835888987546, 'auprc': 0.928684659568864, 'loss_val': 0.29536223577337023, 'psi': 0.9391840171667984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=55 head_norm_before_train=1.714137 cos_to_last_merge=0.9817 (last merge round=21)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8966245476895154, 'loss_val': 0.39666784304812297, 'psi': 0.7788421781706216}-{'f1_val': 0.700320598491359, 'auprc': 0.9936275613835186, 'loss_val': 0.2704871756296473, 'psi': 0.8176433836482229}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.695399 cos_to_last_merge=0.9633 (last merge round=20)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.6233400057561854, 'auprc': 0.944213745035932, 'loss_val': 0.7459521387632879, 'psi': 0.7516895014680841}-{'f1_val': 0.7771105243969578, 'auprc': 0.9532241661397316, 'loss_val': 0.47627420437306306, 'psi': 0.8475559810940674}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.817851 cos_to_last_merge=0.9733 (last merge round=22)
[S7] round=55 local utility u=0.553908 metrics={'f1_val': 0.6440544707306863, 'auprc': 0.9226286348509096, 'loss_val': 0.6766346223110357, 'psi': 0.7554841363787757}-{'f1_val': 0.5786354406808519, 'auprc': 0.7700839360399201, 'loss_val': 0.9343018888782506, 'psi': 0.6552148388244792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=55 head_norm_before_train=1.844977 cos_to_last_merge=0.9637 (last merge round=16)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9987660067599301, 'loss_val': 0.038547931033323164, 'psi': 0.9946183318102815}-{'f1_val': 0.9925803045490724, 'auprc': 0.9986617507054207, 'loss_val': 0.036334923203057354, 'psi': 0.9950128830116117}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=1.772331 cos_to_last_merge=0.9717 (last merge round=23)
[S9] round=55 local utility u=0.001230 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986114927381261, 'loss_val': 0.019542159903729154, 'psi': 0.997290708495583}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962461869510288, 'loss_val': 0.019062915027121843, 'psi': 0.9967602222876972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=55 head_norm_before_train=2.173430 (no previous merge yet)
[S10] round=55 local utility u=0.000028 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9947816187018768, 'loss_val': 0.05219285332135725, 'psi': 0.9946123616766945}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948020143002286, 'loss_val': 0.052310024092300914, 'psi': 0.9946205199160353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=55 head_norm_before_train=2.217704 (no previous merge yet)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986377748732985, 'loss_val': 0.02083942822250941, 'psi': 0.9971475947957666}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986432832120877, 'loss_val': 0.01986011443435386, 'psi': 0.9971497981312823}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.605284 cos_to_last_merge=0.9065 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.906
[S13] round=55 local utility u=0.237411 metrics={'f1_val': 0.6483229826639689, 'auprc': 0.7592705252235361, 'loss_val': 0.8814921378906696, 'psi': 0.6927019996877958}-{'f1_val': 0.6132847055639099, 'auprc': 0.7136291416912022, 'loss_val': 1.0091604462783728, 'psi': 0.6534224800148267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=55 head_norm_before_train=1.728476 cos_to_last_merge=0.9475 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=55 local utility u=0.001148 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9984388552649368, 'loss_val': 0.024765840195883227, 'psi': 0.9977143466944836}-{'f1_val': 0.997231340980848, 'auprc': 0.9984257967685357, 'loss_val': 0.02702347045522365, 'psi': 0.997709123295923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=55 head_norm_before_train=2.037782 cos_to_last_merge=0.8022 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.802
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9370623060950007, 'auprc': 0.9977693255616343, 'loss_val': 0.09205806962243623, 'psi': 0.9613451138816541}-{'f1_val': 0.9572251977844842, 'auprc': 0.9978833175201296, 'loss_val': 0.0698291806322194, 'psi': 0.9734884456787424}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.850245 cos_to_last_merge=0.9044 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.904
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.7351090961658883, 'auprc': 0.9192305112042978, 'loss_val': 1.11758194732076, 'psi': 0.808757662181252}-{'f1_val': 0.9928508455745393, 'auprc': 0.992400959718242, 'loss_val': 0.035765045162613134, 'psi': 0.9926708912320203}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=2.062574 (no previous merge yet)
[S17] round=55 local utility u=0.359146 metrics={'f1_val': 0.7467485136853039, 'auprc': 0.9923007472516054, 'loss_val': 0.4422463990029915, 'psi': 0.8449694071118246}-{'f1_val': 0.7098391983189103, 'auprc': 0.9419677119707545, 'loss_val': 0.7880837594839504, 'psi': 0.802690603779648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=56 head_norm_before_train=1.965992 cos_to_last_merge=0.7903 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=56 local utility u=0.138104 metrics={'f1_val': 0.8199257261762304, 'auprc': 0.8716183023733131, 'loss_val': 0.46835128531971254, 'psi': 0.8406027566550635}-{'f1_val': 0.7703639201232164, 'auprc': 0.8807479590909271, 'loss_val': 0.474576483951773, 'psi': 0.8145175357103007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=56 head_norm_before_train=2.070202 cos_to_last_merge=0.9131 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.7982579409275922, 'auprc': 0.9980184896264298, 'loss_val': 0.39285224451521494, 'psi': 0.8781621604071272}-{'f1_val': 0.9320139977112011, 'auprc': 0.9982700063821788, 'loss_val': 0.16531731958371715, 'psi': 0.9585164011795921}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.750009 cos_to_last_merge=0.9711 (last merge round=22)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9464990859411324, 'auprc': 0.9313823817716822, 'loss_val': 0.2938426839002694, 'psi': 0.9404524042733524}-{'f1_val': 0.9476713124110916, 'auprc': 0.9518115998453138, 'loss_val': 0.29047646091568213, 'psi': 0.9493274273847805}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.715072 cos_to_last_merge=0.9808 (last merge round=21)
[S5] round=56 local utility u=0.320991 metrics={'f1_val': 0.7755418500915309, 'auprc': 0.9299872826744133, 'loss_val': 0.3061025450091304, 'psi': 0.8373200231246838}-{'f1_val': 0.700320598491359, 'auprc': 0.8966245476895154, 'loss_val': 0.39666784304812297, 'psi': 0.7788421781706216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=56 head_norm_before_train=1.702459 cos_to_last_merge=0.9629 (last merge round=20)
[S6] round=56 local utility u=0.435788 metrics={'f1_val': 0.7301274968372724, 'auprc': 0.9644723573041647, 'loss_val': 0.5758763453819306, 'psi': 0.8238654410240294}-{'f1_val': 0.6233400057561854, 'auprc': 0.944213745035932, 'loss_val': 0.7459521387632879, 'psi': 0.7516895014680841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=56 head_norm_before_train=1.828931 cos_to_last_merge=0.9712 (last merge round=22)
[S7] round=56 local utility u=0.482639 metrics={'f1_val': 0.7972151567158716, 'auprc': 0.9301370964084931, 'loss_val': 0.652847104362358, 'psi': 0.8503839325929202}-{'f1_val': 0.6440544707306863, 'auprc': 0.9226286348509096, 'loss_val': 0.6766346223110357, 'psi': 0.7554841363787757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=56 head_norm_before_train=1.852454 cos_to_last_merge=0.9633 (last merge round=16)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9987617185971407, 'loss_val': 0.0399663118320203, 'psi': 0.9946166165451658}-{'f1_val': 0.9918532151771823, 'auprc': 0.9987660067599301, 'loss_val': 0.038547931033323164, 'psi': 0.9946183318102815}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.778498 cos_to_last_merge=0.9713 (last merge round=23)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9949900793535547, 'loss_val': 0.01936755861884439, 'psi': 0.9960115265002791}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986114927381261, 'loss_val': 0.019542159903729154, 'psi': 0.997290708495583}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.179166 (no previous merge yet)
[S10] round=56 local utility u=0.001737 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9951207707206979, 'loss_val': 0.04973674858648868, 'psi': 0.994748022484223}-{'f1_val': 0.9944995236599065, 'auprc': 0.9947816187018768, 'loss_val': 0.05219285332135725, 'psi': 0.9946123616766945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=56 head_norm_before_train=2.221630 (no previous merge yet)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984694686793704, 'loss_val': 0.021194532981961826, 'psi': 0.9970802723181954}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986377748732985, 'loss_val': 0.02083942822250941, 'psi': 0.9971475947957666}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.614193 cos_to_last_merge=0.9052 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=56 local utility u=0.268874 metrics={'f1_val': 0.7070951822044931, 'auprc': 0.7513419683049837, 'loss_val': 0.6725910166571217, 'psi': 0.7247938966446894}-{'f1_val': 0.6483229826639689, 'auprc': 0.7592705252235361, 'loss_val': 0.8814921378906696, 'psi': 0.6927019996877958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=1.735366 cos_to_last_merge=0.9469 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9969919268970505, 'loss_val': 0.026916155193850422, 'psi': 0.996732997529079}-{'f1_val': 0.997231340980848, 'auprc': 0.9984388552649368, 'loss_val': 0.024765840195883227, 'psi': 0.9977143466944836}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=2.044881 cos_to_last_merge=0.8017 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.802
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.922304964278244, 'auprc': 0.996896521817441, 'loss_val': 0.12282621521987873, 'psi': 0.9521415872939228}-{'f1_val': 0.9370623060950007, 'auprc': 0.9977693255616343, 'loss_val': 0.09205806962243623, 'psi': 0.9613451138816541}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.856193 cos_to_last_merge=0.9035 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.904
[S16] round=56 local utility u=0.597278 metrics={'f1_val': 0.8627347850750887, 'auprc': 0.983255805772407, 'loss_val': 0.8808551620604601, 'psi': 0.910943193354016}-{'f1_val': 0.7351090961658883, 'auprc': 0.9192305112042978, 'loss_val': 1.11758194732076, 'psi': 0.808757662181252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=56 head_norm_before_train=2.064317 (no previous merge yet)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.7188391244932053, 'auprc': 0.9543976469421415, 'loss_val': 0.9509193842633642, 'psi': 0.8130625334727798}-{'f1_val': 0.7467485136853039, 'auprc': 0.9923007472516054, 'loss_val': 0.4422463990029915, 'psi': 0.8449694071118246}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=1.973616 cos_to_last_merge=0.7895 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.716988560833745, 'auprc': 0.9912446293227645, 'loss_val': 0.5467285171612216, 'psi': 0.8266909882293527}-{'f1_val': 0.8199257261762304, 'auprc': 0.8716183023733131, 'loss_val': 0.46835128531971254, 'psi': 0.8406027566550635}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.078149 cos_to_last_merge=0.9125 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=57 local utility u=0.014712 metrics={'f1_val': 0.8224356387660949, 'auprc': 0.9717030620895845, 'loss_val': 0.4295483677455954, 'psi': 0.8821426080954907}-{'f1_val': 0.7982579409275922, 'auprc': 0.9980184896264298, 'loss_val': 0.39285224451521494, 'psi': 0.8781621604071272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=57 head_norm_before_train=1.755361 cos_to_last_merge=0.9703 (last merge round=22)
[S4] round=57 local utility u=0.011475 metrics={'f1_val': 0.9466237805271103, 'auprc': 0.9385295359950155, 'loss_val': 0.2930814821052883, 'psi': 0.9433860827142724}-{'f1_val': 0.9464990859411324, 'auprc': 0.9313823817716822, 'loss_val': 0.2938426839002694, 'psi': 0.9404524042733524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=57 head_norm_before_train=1.720871 cos_to_last_merge=0.9801 (last merge round=21)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9490525414096511, 'loss_val': 0.37641947334311016, 'psi': 0.7998651623924216}-{'f1_val': 0.7755418500915309, 'auprc': 0.9299872826744133, 'loss_val': 0.3061025450091304, 'psi': 0.8373200231246838}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.708589 cos_to_last_merge=0.9625 (last merge round=20)
[S6] round=57 local utility u=0.625864 metrics={'f1_val': 0.8861333712866585, 'auprc': 0.9723193629473428, 'loss_val': 0.28372452724658953, 'psi': 0.9206077679509322}-{'f1_val': 0.7301274968372724, 'auprc': 0.9644723573041647, 'loss_val': 0.5758763453819306, 'psi': 0.8238654410240294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=57 head_norm_before_train=1.846236 cos_to_last_merge=0.9687 (last merge round=22)
[S7] round=57 local utility u=0.264385 metrics={'f1_val': 0.852187241222548, 'auprc': 0.9512975943544737, 'loss_val': 0.5173913770038054, 'psi': 0.8918313824753182}-{'f1_val': 0.7972151567158716, 'auprc': 0.9301370964084931, 'loss_val': 0.652847104362358, 'psi': 0.8503839325929202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=57 head_norm_before_train=1.858945 cos_to_last_merge=0.9625 (last merge round=16)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9801438729447547, 'auprc': 0.9864988072108501, 'loss_val': 0.07953947226791029, 'psi': 0.9826858466511929}-{'f1_val': 0.9918532151771823, 'auprc': 0.9987617185971407, 'loss_val': 0.0399663118320203, 'psi': 0.9946166165451658}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=1.785866 cos_to_last_merge=0.9709 (last merge round=23)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9987759781813687, 'loss_val': 0.02917970985736519, 'psi': 0.994599387712581}-{'f1_val': 0.9966924912647621, 'auprc': 0.9949900793535547, 'loss_val': 0.01936755861884439, 'psi': 0.9960115265002791}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.184564 (no previous merge yet)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948027109794594, 'loss_val': 0.050050803048235976, 'psi': 0.9946207985877276}-{'f1_val': 0.9944995236599065, 'auprc': 0.9951207707206979, 'loss_val': 0.04973674858648868, 'psi': 0.994748022484223}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=2.227309 (no previous merge yet)
[S11] round=57 local utility u=0.000004 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984672170751719, 'loss_val': 0.02118003327175282, 'psi': 0.9970793716765161}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984694686793704, 'loss_val': 0.021194532981961826, 'psi': 0.9970802723181954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=57 head_norm_before_train=1.622966 cos_to_last_merge=0.9039 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6129028913863472, 'auprc': 0.6899020426144786, 'loss_val': 1.1382840303408555, 'psi': 0.6437025518775998}-{'f1_val': 0.7070951822044931, 'auprc': 0.7513419683049837, 'loss_val': 0.6725910166571217, 'psi': 0.7247938966446894}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.743204 cos_to_last_merge=0.9463 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=57 local utility u=0.003838 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9982777372030022, 'loss_val': 0.023262052842093987, 'psi': 0.9972638142242876}-{'f1_val': 0.9965603779504312, 'auprc': 0.9969919268970505, 'loss_val': 0.026916155193850422, 'psi': 0.996732997529079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=57 head_norm_before_train=2.051385 cos_to_last_merge=0.8012 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.801
[S15] round=57 local utility u=0.142017 metrics={'f1_val': 0.9604732115488015, 'auprc': 0.9971626143681149, 'loss_val': 0.06859975439469788, 'psi': 0.9751489726765269}-{'f1_val': 0.922304964278244, 'auprc': 0.996896521817441, 'loss_val': 0.12282621521987873, 'psi': 0.9521415872939228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=57 head_norm_before_train=1.860654 cos_to_last_merge=0.9029 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=57 local utility u=0.165024 metrics={'f1_val': 0.8767372473622412, 'auprc': 0.9862325058924041, 'loss_val': 0.6437516199462304, 'psi': 0.9205353507743064}-{'f1_val': 0.8627347850750887, 'auprc': 0.983255805772407, 'loss_val': 0.8808551620604601, 'psi': 0.910943193354016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=57 head_norm_before_train=2.070927 (no previous merge yet)
[S17] round=57 local utility u=0.250324 metrics={'f1_val': 0.7452737931473901, 'auprc': 0.983037929371062, 'loss_val': 0.6948010124658375, 'psi': 0.8403794476368589}-{'f1_val': 0.7188391244932053, 'auprc': 0.9543976469421415, 'loss_val': 0.9509193842633642, 'psi': 0.8130625334727798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=58 head_norm_before_train=1.981483 cos_to_last_merge=0.7887 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=58 local utility u=0.109013 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.8168959631215444, 'loss_val': 0.4709332312224289, 'psi': 0.8234791211736661}-{'f1_val': 0.716988560833745, 'auprc': 0.9912446293227645, 'loss_val': 0.5467285171612216, 'psi': 0.8266909882293527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=58 head_norm_before_train=2.085241 cos_to_last_merge=0.9121 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.7894794669128685, 'auprc': 0.9981644857317965, 'loss_val': 0.5226414717995806, 'psi': 0.8729534744404397}-{'f1_val': 0.8224356387660949, 'auprc': 0.9717030620895845, 'loss_val': 0.4295483677455954, 'psi': 0.8821426080954907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.764531 cos_to_last_merge=0.9693 (last merge round=22)
[S4] round=58 local utility u=0.034295 metrics={'f1_val': 0.9503442513656707, 'auprc': 0.9529316569203903, 'loss_val': 0.2900206619868193, 'psi': 0.9513792135875585}-{'f1_val': 0.9466237805271103, 'auprc': 0.9385295359950155, 'loss_val': 0.2930814821052883, 'psi': 0.9433860827142724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=58 head_norm_before_train=1.727539 cos_to_last_merge=0.9797 (last merge round=21)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.6767604030505469, 'loss_val': 0.5178612745177771, 'psi': 0.6908965203150341}-{'f1_val': 0.7004069097142683, 'auprc': 0.9490525414096511, 'loss_val': 0.37641947334311016, 'psi': 0.7998651623924216}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.713698 cos_to_last_merge=0.9615 (last merge round=20)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7029711138826141, 'auprc': 0.9596229771394202, 'loss_val': 0.5365310454397303, 'psi': 0.8056318591853366}-{'f1_val': 0.8861333712866585, 'auprc': 0.9723193629473428, 'loss_val': 0.28372452724658953, 'psi': 0.9206077679509322}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.865987 cos_to_last_merge=0.9663 (last merge round=22)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6316268944031689, 'auprc': 0.8823773904814429, 'loss_val': 0.8136875213620886, 'psi': 0.7319270928344785}-{'f1_val': 0.852187241222548, 'auprc': 0.9512975943544737, 'loss_val': 0.5173913770038054, 'psi': 0.8918313824753182}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.863419 cos_to_last_merge=0.9621 (last merge round=16)
[S8] round=58 local utility u=0.052889 metrics={'f1_val': 0.9864681279937945, 'auprc': 0.9987980895087855, 'loss_val': 0.048604499523254206, 'psi': 0.9914001125997909}-{'f1_val': 0.9801438729447547, 'auprc': 0.9864988072108501, 'loss_val': 0.07953947226791029, 'psi': 0.9826858466511929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=58 head_norm_before_train=1.793798 cos_to_last_merge=0.9704 (last merge round=23)
[S9] round=58 local utility u=0.015685 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952074528324297, 'loss_val': 0.018831804355053938, 'psi': 0.9963447286402576}-{'f1_val': 0.9918149940667227, 'auprc': 0.9987759781813687, 'loss_val': 0.02917970985736519, 'psi': 0.994599387712581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=58 head_norm_before_train=2.186450 (no previous merge yet)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944106042723638, 'loss_val': 0.05140941649348309, 'psi': 0.9944639559048893}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948027109794594, 'loss_val': 0.050050803048235976, 'psi': 0.9946207985877276}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.232392 (no previous merge yet)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9947121564977282, 'auprc': 0.9987112883722896, 'loss_val': 0.024827465923594146, 'psi': 0.9963118092475527}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984672170751719, 'loss_val': 0.02118003327175282, 'psi': 0.9970793716765161}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.630439 cos_to_last_merge=0.9029 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=58 local utility u=0.441316 metrics={'f1_val': 0.7124302774014072, 'auprc': 0.7324472294578102, 'loss_val': 0.9804518462851535, 'psi': 0.7204370582239683}-{'f1_val': 0.6129028913863472, 'auprc': 0.6899020426144786, 'loss_val': 1.1382840303408555, 'psi': 0.6437025518775998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=58 head_norm_before_train=1.750883 cos_to_last_merge=0.9457 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=58 local utility u=0.000436 metrics={'f1_val': 0.9966004498019938, 'auprc': 0.9988089785871621, 'loss_val': 0.024060094362181532, 'psi': 0.997483861316061}-{'f1_val': 0.9965878655718112, 'auprc': 0.9982777372030022, 'loss_val': 0.023262052842093987, 'psi': 0.9972638142242876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=58 head_norm_before_train=2.057810 cos_to_last_merge=0.8007 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.801
[S15] round=58 local utility u=0.080143 metrics={'f1_val': 0.9819337168190745, 'auprc': 0.9977389239327681, 'loss_val': 0.03880499996204073, 'psi': 0.988255799664552}-{'f1_val': 0.9604732115488015, 'auprc': 0.9971626143681149, 'loss_val': 0.06859975439469788, 'psi': 0.9751489726765269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=58 head_norm_before_train=1.863293 cos_to_last_merge=0.9027 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=58 local utility u=0.667191 metrics={'f1_val': 0.993017306607709, 'auprc': 0.9959818912832981, 'loss_val': 0.0362986757486147, 'psi': 0.9942031404779446}-{'f1_val': 0.8767372473622412, 'auprc': 0.9862325058924041, 'loss_val': 0.6437516199462304, 'psi': 0.9205353507743064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=58 head_norm_before_train=2.073379 (no previous merge yet)
[S17] round=58 local utility u=0.747808 metrics={'f1_val': 0.9191760338581245, 'auprc': 0.9969175885272031, 'loss_val': 0.28423809325017346, 'psi': 0.9502726557257559}-{'f1_val': 0.7452737931473901, 'auprc': 0.983037929371062, 'loss_val': 0.6948010124658375, 'psi': 0.8403794476368589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=59 head_norm_before_train=1.988813 cos_to_last_merge=0.7880 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6759526060982359, 'auprc': 0.8128122253417857, 'loss_val': 0.7678624461196287, 'psi': 0.7306964537956558}-{'f1_val': 0.8278678932084138, 'auprc': 0.8168959631215444, 'loss_val': 0.4709332312224289, 'psi': 0.8234791211736661}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.731 u=0.0000 p_local=0.0714 f1=0.676 auprc=0.813 bytes=63068
[S3] START round=59 head_norm_before_train=2.092609 cos_to_last_merge=0.9115 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=59 local utility u=0.329299 metrics={'f1_val': 0.8640904852483946, 'auprc': 0.9982817822089042, 'loss_val': 0.31206181066549565, 'psi': 0.9177670040325985}-{'f1_val': 0.7894794669128685, 'auprc': 0.9981644857317965, 'loss_val': 0.5226414717995806, 'psi': 0.8729534744404397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S3] r=60 psi=0.918 u=0.3293 p_local=0.1100 f1=0.864 auprc=0.998 bytes=55787
[S4] START round=59 head_norm_before_train=1.772010 cos_to_last_merge=0.9688 (last merge round=22)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9412665661649415, 'auprc': 0.9249034695196847, 'loss_val': 0.31086435029754256, 'psi': 0.9347213275068388}-{'f1_val': 0.9503442513656707, 'auprc': 0.9529316569203903, 'loss_val': 0.2900206619868193, 'psi': 0.9513792135875585}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.935 u=0.0000 p_local=0.0128 f1=0.941 auprc=0.925 bytes=64710
[S5] START round=59 head_norm_before_train=1.733397 cos_to_last_merge=0.9793 (last merge round=21)
[S5] round=59 local utility u=1.000000 metrics={'f1_val': 0.8960458908243867, 'auprc': 0.996168791459297, 'loss_val': 0.14493060531663363, 'psi': 0.9360950510783508}-{'f1_val': 0.700320598491359, 'auprc': 0.6767604030505469, 'loss_val': 0.5178612745177771, 'psi': 0.6908965203150341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=60 psi=0.936 u=1.0000 p_local=0.3358 f1=0.896 auprc=0.996 bytes=52205
[S6] START round=59 head_norm_before_train=1.718574 cos_to_last_merge=0.9604 (last merge round=20)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6328867949412063, 'auprc': 0.9558084082926617, 'loss_val': 0.7500937135491379, 'psi': 0.7620554402817884}-{'f1_val': 0.7029711138826141, 'auprc': 0.9596229771394202, 'loss_val': 0.5365310454397303, 'psi': 0.8056318591853366}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.762 u=0.0000 p_local=0.2413 f1=0.633 auprc=0.956 bytes=52153
[S7] START round=59 head_norm_before_train=1.886831 cos_to_last_merge=0.9638 (last merge round=22)
[S7] round=59 local utility u=0.682523 metrics={'f1_val': 0.8044042419033361, 'auprc': 0.9322011533082877, 'loss_val': 0.6347774407366251, 'psi': 0.8555230064653168}-{'f1_val': 0.6316268944031689, 'auprc': 0.8823773904814429, 'loss_val': 0.8136875213620886, 'psi': 0.7319270928344785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=60 psi=0.856 u=0.6825 p_local=0.3681 f1=0.804 auprc=0.932 bytes=61122
[S8] START round=59 head_norm_before_train=1.869830 cos_to_last_merge=0.9616 (last merge round=16)
[S8] round=59 local utility u=0.006321 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9863021692337166, 'loss_val': 0.0350930735336546, 'psi': 0.9900636353667718}-{'f1_val': 0.9864681279937945, 'auprc': 0.9987980895087855, 'loss_val': 0.048604499523254206, 'psi': 0.9914001125997909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S8] r=60 psi=0.990 u=0.0063 p_local=0.0139 f1=0.993 auprc=0.986 bytes=59321
[S9] START round=59 head_norm_before_train=1.799651 cos_to_last_merge=0.9701 (last merge round=23)
[S9] round=59 local utility u=0.001468 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9961520111700186, 'loss_val': 0.01873002925125254, 'psi': 0.9967225519752931}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952074528324297, 'loss_val': 0.018831804355053938, 'psi': 0.9963447286402576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=60 psi=0.997 u=0.0015 p_local=0.0038 f1=0.997 auprc=0.996 bytes=68443
[S10] START round=59 head_norm_before_train=2.190734 (no previous merge yet)
[S10] round=59 local utility u=0.001477 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948141506992102, 'loss_val': 0.049665357833708686, 'psi': 0.9946253744756279}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944106042723638, 'loss_val': 0.05140941649348309, 'psi': 0.9944639559048893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=60 psi=0.995 u=0.0015 p_local=0.0011 f1=0.994 auprc=0.995 bytes=70072
[S11] START round=59 head_norm_before_train=2.233132 (no previous merge yet)
[S11] round=59 local utility u=0.006081 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986272686082462, 'loss_val': 0.021065048694484945, 'psi': 0.9971433922897457}-{'f1_val': 0.9947121564977282, 'auprc': 0.9987112883722896, 'loss_val': 0.024827465923594146, 'psi': 0.9963118092475527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] r=60 psi=0.997 u=0.0061 p_local=0.0120 f1=0.996 auprc=0.999 bytes=70190
[S13] START round=59 head_norm_before_train=1.636470 cos_to_last_merge=0.9021 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.902
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6325168419756322, 'auprc': 0.7476686719439649, 'loss_val': 0.9507740900814922, 'psi': 0.6785775739629654}-{'f1_val': 0.7124302774014072, 'auprc': 0.7324472294578102, 'loss_val': 0.9804518462851535, 'psi': 0.7204370582239683}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.679 u=0.0000 p_local=0.1348 f1=0.633 auprc=0.748 bytes=61195
[S14] START round=59 head_norm_before_train=1.754026 cos_to_last_merge=0.9453 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=59 local utility u=0.000801 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9988159003031755, 'loss_val': 0.024686041737494564, 'psi': 0.9977072862957368}-{'f1_val': 0.9966004498019938, 'auprc': 0.9988089785871621, 'loss_val': 0.024060094362181532, 'psi': 0.997483861316061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] r=60 psi=0.998 u=0.0008 p_local=0.0020 f1=0.997 auprc=0.999 bytes=66561
[S15] START round=59 head_norm_before_train=2.064320 cos_to_last_merge=0.8002 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.800
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9793226882296449, 'auprc': 0.9977118613298316, 'loss_val': 0.041405506877197365, 'psi': 0.9866783574697195}-{'f1_val': 0.9819337168190745, 'auprc': 0.9977389239327681, 'loss_val': 0.03880499996204073, 'psi': 0.988255799664552}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.987 u=0.0000 p_local=0.0502 f1=0.979 auprc=0.998 bytes=59321
[S16] START round=59 head_norm_before_train=1.867787 cos_to_last_merge=0.9021 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.995451530205391, 'loss_val': 0.04039854503070693, 'psi': 0.9933481283739609}-{'f1_val': 0.993017306607709, 'auprc': 0.9959818912832981, 'loss_val': 0.0362986757486147, 'psi': 0.9942031404779446}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.993 u=0.0000 p_local=0.2988 f1=0.992 auprc=0.995 bytes=57582
[S17] START round=59 head_norm_before_train=2.078352 (no previous merge yet)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6922179056121043, 'auprc': 0.8866484597750205, 'loss_val': 1.1001265599919183, 'psi': 0.7699901272772708}-{'f1_val': 0.9191760338581245, 'auprc': 0.9969175885272031, 'loss_val': 0.28423809325017346, 'psi': 0.9502726557257559}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.770 u=0.0000 p_local=0.2334 f1=0.692 auprc=0.887 bytes=57579
[S2] START round=60 head_norm_before_train=1.993237 cos_to_last_merge=0.7876 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.6552519613933778, 'auprc': 0.7048088061139522, 'loss_val': 1.3388333020546372, 'psi': 0.6750746992816076}-{'f1_val': 0.6759526060982359, 'auprc': 0.8128122253417857, 'loss_val': 0.7678624461196287, 'psi': 0.7306964537956558}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=60 head_norm_before_train=2.101094 cos_to_last_merge=0.9110 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=60 local utility u=0.379004 metrics={'f1_val': 0.9540338253835181, 'auprc': 0.998651042246161, 'loss_val': 0.0948214346513032, 'psi': 0.9718807121285753}-{'f1_val': 0.8640904852483946, 'auprc': 0.9982817822089042, 'loss_val': 0.31206181066549565, 'psi': 0.9177670040325985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=60 head_norm_before_train=1.776951 cos_to_last_merge=0.9685 (last merge round=22)
[S4] round=60 local utility u=0.053758 metrics={'f1_val': 0.9494973284758412, 'auprc': 0.9401482311332577, 'loss_val': 0.2984677307640824, 'psi': 0.9457576895388078}-{'f1_val': 0.9412665661649415, 'auprc': 0.9249034695196847, 'loss_val': 0.31086435029754256, 'psi': 0.9347213275068388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=60 head_norm_before_train=1.729149 cos_to_last_merge=0.9794 (last merge round=21)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.6532071564989395, 'auprc': 0.6752671721852924, 'loss_val': 0.5337975334460716, 'psi': 0.6620311627734807}-{'f1_val': 0.8960458908243867, 'auprc': 0.996168791459297, 'loss_val': 0.14493060531663363, 'psi': 0.9360950510783508}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.725114 cos_to_last_merge=0.9596 (last merge round=20)
[S6] round=60 local utility u=1.000000 metrics={'f1_val': 0.982799314654086, 'auprc': 0.9837047289709524, 'loss_val': 0.09815833676944528, 'psi': 0.9831614803808325}-{'f1_val': 0.6328867949412063, 'auprc': 0.9558084082926617, 'loss_val': 0.7500937135491379, 'psi': 0.7620554402817884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=60 head_norm_before_train=1.904503 cos_to_last_merge=0.9620 (last merge round=22)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.582944972967885, 'auprc': 0.8493049475436769, 'loss_val': 1.1698232261403552, 'psi': 0.6894889627982017}-{'f1_val': 0.8044042419033361, 'auprc': 0.9322011533082877, 'loss_val': 0.6347774407366251, 'psi': 0.8555230064653168}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=1.874837 cos_to_last_merge=0.9611 (last merge round=16)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.9861153444009513, 'loss_val': 0.05670995132497583, 'psi': 0.9899629147734366}-{'f1_val': 0.9925712794554754, 'auprc': 0.9863021692337166, 'loss_val': 0.0350930735336546, 'psi': 0.9900636353667718}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=1.804319 cos_to_last_merge=0.9698 (last merge round=23)
[S9] round=60 local utility u=0.001657 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.998795950851523, 'loss_val': 0.0191911928144268, 'psi': 0.9973644917409417}-{'f1_val': 0.9971029125121428, 'auprc': 0.9961520111700186, 'loss_val': 0.01873002925125254, 'psi': 0.9967225519752931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=60 head_norm_before_train=2.196202 (no previous merge yet)
[S10] round=60 local utility u=0.000589 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948986334508907, 'loss_val': 0.04874064919516616, 'psi': 0.9946591675763001}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948141506992102, 'loss_val': 0.049665357833708686, 'psi': 0.9946253744756279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=60 head_norm_before_train=2.234525 (no previous merge yet)
[S11] round=60 local utility u=0.000057 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986276078520147, 'loss_val': 0.020952771194847387, 'psi': 0.9971435279872531}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986272686082462, 'loss_val': 0.021065048694484945, 'psi': 0.9971433922897457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=60 head_norm_before_train=1.641424 cos_to_last_merge=0.9015 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=60 local utility u=0.215732 metrics={'f1_val': 0.6850976214856681, 'auprc': 0.7820017902259258, 'loss_val': 0.937794868047875, 'psi': 0.7238592889817712}-{'f1_val': 0.6325168419756322, 'auprc': 0.7476686719439649, 'loss_val': 0.9507740900814922, 'psi': 0.6785775739629654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=60 head_norm_before_train=1.760301 cos_to_last_merge=0.9447 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9535941993631862, 'auprc': 0.9970932946628797, 'loss_val': 0.0801043637341943, 'psi': 0.9709938374830636}-{'f1_val': 0.9969682102907778, 'auprc': 0.9988159003031755, 'loss_val': 0.024686041737494564, 'psi': 0.9977072862957368}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.070921 cos_to_last_merge=0.7996 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.800
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9030426372207844, 'auprc': 0.9968309167185382, 'loss_val': 0.1857223960744396, 'psi': 0.9405579490198859}-{'f1_val': 0.9793226882296449, 'auprc': 0.9977118613298316, 'loss_val': 0.041405506877197365, 'psi': 0.9866783574697195}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.873676 cos_to_last_merge=0.9014 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.901
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9913361711213216, 'auprc': 0.9926679741293264, 'loss_val': 0.03958753395985709, 'psi': 0.9918688923245235}-{'f1_val': 0.9919458604863408, 'auprc': 0.995451530205391, 'loss_val': 0.04039854503070693, 'psi': 0.9933481283739609}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=2.083116 (no previous merge yet)
[S17] round=60 local utility u=0.292847 metrics={'f1_val': 0.7214854238758095, 'auprc': 0.9688910497670745, 'loss_val': 0.9367654917708118, 'psi': 0.8204476742323155}-{'f1_val': 0.6922179056121043, 'auprc': 0.8866484597750205, 'loss_val': 1.1001265599919183, 'psi': 0.7699901272772708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=61 head_norm_before_train=1.997221 cos_to_last_merge=0.7870 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=61 local utility u=1.000000 metrics={'f1_val': 0.7912107952856721, 'auprc': 0.9189729600749581, 'loss_val': 0.5132881494757008, 'psi': 0.8423156612013865}-{'f1_val': 0.6552519613933778, 'auprc': 0.7048088061139522, 'loss_val': 1.3388333020546372, 'psi': 0.6750746992816076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=61 head_norm_before_train=2.108831 cos_to_last_merge=0.9105 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.726867110880169, 'auprc': 0.9883331264375967, 'loss_val': 0.8355842696395841, 'psi': 0.8314535171031401}-{'f1_val': 0.9540338253835181, 'auprc': 0.998651042246161, 'loss_val': 0.0948214346513032, 'psi': 0.9718807121285753}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.779263 cos_to_last_merge=0.9679 (last merge round=22)
[S4] round=61 local utility u=0.068096 metrics={'f1_val': 0.9551911774255355, 'auprc': 0.9701392652163078, 'loss_val': 0.28641248961352717, 'psi': 0.9611704125418443}-{'f1_val': 0.9494973284758412, 'auprc': 0.9401482311332577, 'loss_val': 0.2984677307640824, 'psi': 0.9457576895388078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=61 head_norm_before_train=1.726678 cos_to_last_merge=0.9792 (last merge round=21)
[S5] round=61 local utility u=0.450481 metrics={'f1_val': 0.6930010134509419, 'auprc': 0.8489334317074053, 'loss_val': 0.3925967488573321, 'psi': 0.7553739807535274}-{'f1_val': 0.6532071564989395, 'auprc': 0.6752671721852924, 'loss_val': 0.5337975334460716, 'psi': 0.6620311627734807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=61 head_norm_before_train=1.732338 cos_to_last_merge=0.9589 (last merge round=20)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.8095630751165601, 'auprc': 0.9450817679530724, 'loss_val': 0.5901699597915161, 'psi': 0.8637705522511651}-{'f1_val': 0.982799314654086, 'auprc': 0.9837047289709524, 'loss_val': 0.09815833676944528, 'psi': 0.9831614803808325}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.920162 cos_to_last_merge=0.9607 (last merge round=22)
[S7] round=61 local utility u=1.000000 metrics={'f1_val': 0.8298089988284516, 'auprc': 0.955280963919463, 'loss_val': 0.6857947658280757, 'psi': 0.8799977848648561}-{'f1_val': 0.582944972967885, 'auprc': 0.8493049475436769, 'loss_val': 1.1698232261403552, 'psi': 0.6894889627982017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=61 head_norm_before_train=1.879019 cos_to_last_merge=0.9611 (last merge round=16)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9644320007685006, 'auprc': 0.9989568154932363, 'loss_val': 0.11007638218999621, 'psi': 0.9782419266583948}-{'f1_val': 0.9925279616884268, 'auprc': 0.9861153444009513, 'loss_val': 0.05670995132497583, 'psi': 0.9899629147734366}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=1.808222 cos_to_last_merge=0.9696 (last merge round=23)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996462216838215, 'loss_val': 0.018499907302130858, 'psi': 0.9968466342425717}-{'f1_val': 0.9964101856672208, 'auprc': 0.998795950851523, 'loss_val': 0.0191911928144268, 'psi': 0.9973644917409417}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.202406 (no previous merge yet)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946536510257178, 'loss_val': 0.05002892364751428, 'psi': 0.994561174606231}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948986334508907, 'loss_val': 0.04874064919516616, 'psi': 0.9946591675763001}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=2.235359 (no previous merge yet)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.8695456370350154, 'auprc': 0.997247724093873, 'loss_val': 0.1435433017171219, 'psi': 0.9206264718585584}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986276078520147, 'loss_val': 0.020952771194847387, 'psi': 0.9971435279872531}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.648509 cos_to_last_merge=0.9005 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6522470531041057, 'auprc': 0.7743453081328872, 'loss_val': 0.8552753684030041, 'psi': 0.7010863551156183}-{'f1_val': 0.6850976214856681, 'auprc': 0.7820017902259258, 'loss_val': 0.937794868047875, 'psi': 0.7238592889817712}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.765506 cos_to_last_merge=0.9439 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=61 local utility u=0.148126 metrics={'f1_val': 0.9940556819516879, 'auprc': 0.9987924055417339, 'loss_val': 0.03171916822989316, 'psi': 0.9959503713877063}-{'f1_val': 0.9535941993631862, 'auprc': 0.9970932946628797, 'loss_val': 0.0801043637341943, 'psi': 0.9709938374830636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=61 head_norm_before_train=2.077635 cos_to_last_merge=0.7991 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.8736268552322604, 'auprc': 0.9961466916045474, 'loss_val': 0.2765064385994851, 'psi': 0.9226347897811752}-{'f1_val': 0.9030426372207844, 'auprc': 0.9968309167185382, 'loss_val': 0.1857223960744396, 'psi': 0.9405579490198859}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.879819 cos_to_last_merge=0.9006 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.901
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9458707219583687, 'auprc': 0.9889988688528675, 'loss_val': 0.2559692911757835, 'psi': 0.9631219807161683}-{'f1_val': 0.9913361711213216, 'auprc': 0.9926679741293264, 'loss_val': 0.03958753395985709, 'psi': 0.9918688923245235}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=2.082211 (no previous merge yet)
[S17] round=61 local utility u=1.000000 metrics={'f1_val': 0.9322477775335243, 'auprc': 0.9974301495606184, 'loss_val': 0.23695352901321134, 'psi': 0.9583207263443618}-{'f1_val': 0.7214854238758095, 'auprc': 0.9688910497670745, 'loss_val': 0.9367654917708118, 'psi': 0.8204476742323155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=62 head_norm_before_train=2.003409 cos_to_last_merge=0.7864 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7246303880476435, 'auprc': 0.8832087854295244, 'loss_val': 0.6294413719891038, 'psi': 0.7880617470003959}-{'f1_val': 0.7912107952856721, 'auprc': 0.9189729600749581, 'loss_val': 0.5132881494757008, 'psi': 0.8423156612013865}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.116836 cos_to_last_merge=0.9099 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=62 local utility u=0.970489 metrics={'f1_val': 0.930033913846588, 'auprc': 0.9985830077799185, 'loss_val': 0.14435689313143343, 'psi': 0.9574535514199202}-{'f1_val': 0.726867110880169, 'auprc': 0.9883331264375967, 'loss_val': 0.8355842696395841, 'psi': 0.8314535171031401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=62 head_norm_before_train=1.780229 cos_to_last_merge=0.9671 (last merge round=22)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9472731240869319, 'auprc': 0.9692771922525694, 'loss_val': 0.2968647696257025, 'psi': 0.9560747513531869}-{'f1_val': 0.9551911774255355, 'auprc': 0.9701392652163078, 'loss_val': 0.28641248961352717, 'psi': 0.9611704125418443}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.726097 cos_to_last_merge=0.9791 (last merge round=21)
[S5] round=62 local utility u=0.445418 metrics={'f1_val': 0.7385669031462112, 'auprc': 0.9938310487239916, 'loss_val': 0.2098483640388199, 'psi': 0.8406725613773234}-{'f1_val': 0.6930010134509419, 'auprc': 0.8489334317074053, 'loss_val': 0.3925967488573321, 'psi': 0.7553739807535274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=62 head_norm_before_train=1.736484 cos_to_last_merge=0.9582 (last merge round=20)
[S6] round=62 local utility u=0.082901 metrics={'f1_val': 0.8287619710422303, 'auprc': 0.9254894936029981, 'loss_val': 0.4807852627424196, 'psi': 0.8674529800665374}-{'f1_val': 0.8095630751165601, 'auprc': 0.9450817679530724, 'loss_val': 0.5901699597915161, 'psi': 0.8637705522511651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=62 head_norm_before_train=1.932506 cos_to_last_merge=0.9594 (last merge round=22)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.577977907616541, 'auprc': 0.8573511092351194, 'loss_val': 1.234130165586652, 'psi': 0.6897271882639724}-{'f1_val': 0.8298089988284516, 'auprc': 0.955280963919463, 'loss_val': 0.6857947658280757, 'psi': 0.8799977848648561}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=1.884939 cos_to_last_merge=0.9607 (last merge round=16)
[S8] round=62 local utility u=0.118718 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9988614079346536, 'loss_val': 0.036880521486830894, 'psi': 0.9946564922801708}-{'f1_val': 0.9644320007685006, 'auprc': 0.9989568154932363, 'loss_val': 0.11007638218999621, 'psi': 0.9782419266583948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=62 head_norm_before_train=1.815364 cos_to_last_merge=0.9692 (last merge round=23)
[S9] round=62 local utility u=0.000327 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966608928514872, 'loss_val': 0.01844238415528938, 'psi': 0.9969261046478806}-{'f1_val': 0.9971029125121428, 'auprc': 0.996462216838215, 'loss_val': 0.018499907302130858, 'psi': 0.9968466342425717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] START round=62 head_norm_before_train=2.208847 (no previous merge yet)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.994347116929024, 'loss_val': 0.054099586758886306, 'psi': 0.9944385609675535}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946536510257178, 'loss_val': 0.05002892364751428, 'psi': 0.994561174606231}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.237203 (no previous merge yet)
[S11] round=62 local utility u=0.441903 metrics={'f1_val': 0.995672955508997, 'auprc': 0.9985831597772256, 'loss_val': 0.02050778664212999, 'psi': 0.9968370372162885}-{'f1_val': 0.8695456370350154, 'auprc': 0.997247724093873, 'loss_val': 0.1435433017171219, 'psi': 0.9206264718585584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=62 head_norm_before_train=1.653840 cos_to_last_merge=0.8998 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.6236415679347476, 'auprc': 0.6635112742778679, 'loss_val': 1.1326389313951097, 'psi': 0.6395894504719957}-{'f1_val': 0.6522470531041057, 'auprc': 0.7743453081328872, 'loss_val': 0.8552753684030041, 'psi': 0.7010863551156183}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.770772 cos_to_last_merge=0.9434 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=62 local utility u=0.010922 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9987702524857459, 'loss_val': 0.024819544400675426, 'psi': 0.9974425707574957}-{'f1_val': 0.9940556819516879, 'auprc': 0.9987924055417339, 'loss_val': 0.03171916822989316, 'psi': 0.9959503713877063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=62 head_norm_before_train=2.083898 cos_to_last_merge=0.7986 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=62 local utility u=0.036410 metrics={'f1_val': 0.88179948317925, 'auprc': 0.9963523095294149, 'loss_val': 0.25333909024738466, 'psi': 0.927620613719316}-{'f1_val': 0.8736268552322604, 'auprc': 0.9961466916045474, 'loss_val': 0.2765064385994851, 'psi': 0.9226347897811752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=62 head_norm_before_train=1.884691 cos_to_last_merge=0.8999 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.900
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.8541602703606463, 'auprc': 0.8786173926367399, 'loss_val': 1.0573815378568359, 'psi': 0.8639431192710838}-{'f1_val': 0.9458707219583687, 'auprc': 0.9889988688528675, 'loss_val': 0.2559692911757835, 'psi': 0.9631219807161683}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.080878 (no previous merge yet)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.7251961389629894, 'auprc': 0.9768871398321974, 'loss_val': 0.887545524854234, 'psi': 0.8258725393106726}-{'f1_val': 0.9322477775335243, 'auprc': 0.9974301495606184, 'loss_val': 0.23695352901321134, 'psi': 0.9583207263443618}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.009368 cos_to_last_merge=0.7859 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.616255851628777, 'auprc': 0.6852258033073857, 'loss_val': 1.5518385952294864, 'psi': 0.6438438323002205}-{'f1_val': 0.7246303880476435, 'auprc': 0.8832087854295244, 'loss_val': 0.6294413719891038, 'psi': 0.7880617470003959}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.125236 cos_to_last_merge=0.9093 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.7155369021806239, 'auprc': 0.9883371621642505, 'loss_val': 0.7438409917934637, 'psi': 0.8246570061740746}-{'f1_val': 0.930033913846588, 'auprc': 0.9985830077799185, 'loss_val': 0.14435689313143343, 'psi': 0.9574535514199202}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.780972 cos_to_last_merge=0.9665 (last merge round=22)
[S4] round=63 local utility u=0.014649 metrics={'f1_val': 0.9495528428242429, 'auprc': 0.9729412315344549, 'loss_val': 0.29223630717167287, 'psi': 0.9589081983083276}-{'f1_val': 0.9472731240869319, 'auprc': 0.9692771922525694, 'loss_val': 0.2968647696257025, 'psi': 0.9560747513531869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=63 head_norm_before_train=1.729032 cos_to_last_merge=0.9788 (last merge round=21)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.615295661512061, 'auprc': 0.7720538516400941, 'loss_val': 0.6456458219000017, 'psi': 0.6779989375632742}-{'f1_val': 0.7385669031462112, 'auprc': 0.9938310487239916, 'loss_val': 0.2098483640388199, 'psi': 0.8406725613773234}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.742355 cos_to_last_merge=0.9575 (last merge round=20)
[S6] round=63 local utility u=0.324925 metrics={'f1_val': 0.8716918980631619, 'auprc': 0.9646341636463219, 'loss_val': 0.20594889913288048, 'psi': 0.9088688042964259}-{'f1_val': 0.8287619710422303, 'auprc': 0.9254894936029981, 'loss_val': 0.4807852627424196, 'psi': 0.8674529800665374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=63 head_norm_before_train=1.947554 cos_to_last_merge=0.9579 (last merge round=22)
[S7] round=63 local utility u=1.000000 metrics={'f1_val': 0.8175103722007238, 'auprc': 0.9337504874684873, 'loss_val': 0.8111975763213894, 'psi': 0.8640064183078292}-{'f1_val': 0.577977907616541, 'auprc': 0.8573511092351194, 'loss_val': 1.234130165586652, 'psi': 0.6897271882639724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=63 head_norm_before_train=1.889362 cos_to_last_merge=0.9609 (last merge round=16)
[S8] round=63 local utility u=0.002383 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.998336097352905, 'loss_val': 0.034901147890067014, 'psi': 0.9948826216706055}-{'f1_val': 0.9918532151771823, 'auprc': 0.9988614079346536, 'loss_val': 0.036880521486830894, 'psi': 0.9946564922801708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=63 head_norm_before_train=1.823473 cos_to_last_merge=0.9686 (last merge round=23)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.994918157285241, 'loss_val': 0.018870081131576445, 'psi': 0.9959827576729537}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966608928514872, 'loss_val': 0.01844238415528938, 'psi': 0.9969261046478806}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.212291 (no previous merge yet)
[S10] round=63 local utility u=0.002583 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948297262637926, 'loss_val': 0.05038224181031106, 'psi': 0.994631604701461}-{'f1_val': 0.9944995236599065, 'auprc': 0.994347116929024, 'loss_val': 0.054099586758886306, 'psi': 0.9944385609675535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=63 head_norm_before_train=2.241369 (no previous merge yet)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9954312449678927, 'auprc': 0.9986264737523792, 'loss_val': 0.019447871942612723, 'psi': 0.9967093364816872}-{'f1_val': 0.995672955508997, 'auprc': 0.9985831597772256, 'loss_val': 0.02050778664212999, 'psi': 0.9968370372162885}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.662123 cos_to_last_merge=0.8988 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=63 local utility u=0.552442 metrics={'f1_val': 0.7300513444471001, 'auprc': 0.7564834626248901, 'loss_val': 0.9451299846920522, 'psi': 0.7406241917182161}-{'f1_val': 0.6236415679347476, 'auprc': 0.6635112742778679, 'loss_val': 1.1326389313951097, 'psi': 0.6395894504719957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=63 head_norm_before_train=1.772782 cos_to_last_merge=0.9431 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=63 local utility u=0.000415 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9988181038464226, 'loss_val': 0.02413259024443437, 'psi': 0.9974617113017663}-{'f1_val': 0.9965574496053289, 'auprc': 0.9987702524857459, 'loss_val': 0.024819544400675426, 'psi': 0.9974425707574957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=63 head_norm_before_train=2.089803 cos_to_last_merge=0.7982 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.798
[S15] round=63 local utility u=0.137573 metrics={'f1_val': 0.9125493608016491, 'auprc': 0.9970394849993516, 'loss_val': 0.1647537054092297, 'psi': 0.9463454104807301}-{'f1_val': 0.88179948317925, 'auprc': 0.9963523095294149, 'loss_val': 0.25333909024738466, 'psi': 0.927620613719316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=63 head_norm_before_train=1.890111 cos_to_last_merge=0.8991 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.899
[S16] round=63 local utility u=0.267437 metrics={'f1_val': 0.8651498325874686, 'auprc': 0.9823214422445344, 'loss_val': 0.8995563328713602, 'psi': 0.9120184764502949}-{'f1_val': 0.8541602703606463, 'auprc': 0.8786173926367399, 'loss_val': 1.0573815378568359, 'psi': 0.8639431192710838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=63 head_norm_before_train=2.083644 (no previous merge yet)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.7123254922444967, 'auprc': 0.9411519739257448, 'loss_val': 1.0260191702675945, 'psi': 0.803856084916996}-{'f1_val': 0.7251961389629894, 'auprc': 0.9768871398321974, 'loss_val': 0.887545524854234, 'psi': 0.8258725393106726}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.014049 cos_to_last_merge=0.7854 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=64 local utility u=1.000000 metrics={'f1_val': 0.7569703222373274, 'auprc': 0.8801521302678154, 'loss_val': 0.5081446242774299, 'psi': 0.8062430454495226}-{'f1_val': 0.616255851628777, 'auprc': 0.6852258033073857, 'loss_val': 1.5518385952294864, 'psi': 0.6438438323002205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=64 head_norm_before_train=2.132705 cos_to_last_merge=0.9086 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=64 local utility u=0.544794 metrics={'f1_val': 0.8337120062542268, 'auprc': 0.9968782616009132, 'loss_val': 0.3889268626487687, 'psi': 0.8989785083929014}-{'f1_val': 0.7155369021806239, 'auprc': 0.9883371621642505, 'loss_val': 0.7438409917934637, 'psi': 0.8246570061740746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=64 head_norm_before_train=1.780020 cos_to_last_merge=0.9661 (last merge round=22)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.950002698423035, 'auprc': 0.9427378342295232, 'loss_val': 0.2962133952445108, 'psi': 0.9470967527456302}-{'f1_val': 0.9495528428242429, 'auprc': 0.9729412315344549, 'loss_val': 0.29223630717167287, 'psi': 0.9589081983083276}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.731354 cos_to_last_merge=0.9787 (last merge round=21)
[S5] round=64 local utility u=0.792832 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9923981574993788, 'loss_val': 0.231164306615041, 'psi': 0.8171516220945669}-{'f1_val': 0.615295661512061, 'auprc': 0.7720538516400941, 'loss_val': 0.6456458219000017, 'psi': 0.6779989375632742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=64 head_norm_before_train=1.746850 cos_to_last_merge=0.9572 (last merge round=20)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.4508481379222387, 'auprc': 0.7632007266363412, 'loss_val': 1.2282565841468907, 'psi': 0.5757891734078797}-{'f1_val': 0.8716918980631619, 'auprc': 0.9646341636463219, 'loss_val': 0.20594889913288048, 'psi': 0.9088688042964259}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.960338 cos_to_last_merge=0.9567 (last merge round=22)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.581704697142934, 'auprc': 0.8430620594918198, 'loss_val': 1.218507856119782, 'psi': 0.6862476420824883}-{'f1_val': 0.8175103722007238, 'auprc': 0.9337504874684873, 'loss_val': 0.8111975763213894, 'psi': 0.8640064183078292}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=1.895309 cos_to_last_merge=0.9607 (last merge round=16)
[S8] round=64 local utility u=0.000545 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9986581289095282, 'loss_val': 0.034777483552067716, 'psi': 0.9950114342932548}-{'f1_val': 0.9925803045490724, 'auprc': 0.998336097352905, 'loss_val': 0.034901147890067014, 'psi': 0.9948826216706055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=64 head_norm_before_train=1.830846 cos_to_last_merge=0.9682 (last merge round=23)
[S9] round=64 local utility u=0.000575 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9953856286436786, 'loss_val': 0.019123405223579037, 'psi': 0.9961697462163288}-{'f1_val': 0.9966924912647621, 'auprc': 0.994918157285241, 'loss_val': 0.018870081131576445, 'psi': 0.9959827576729537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=64 head_norm_before_train=2.214905 (no previous merge yet)
[S10] round=64 local utility u=0.000096 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948411573574827, 'loss_val': 0.05022481812463605, 'psi': 0.9946361771389369}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948297262637926, 'loss_val': 0.05038224181031106, 'psi': 0.994631604701461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=64 head_norm_before_train=2.247226 (no previous merge yet)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9915362262757211, 'auprc': 0.9984996144587936, 'loss_val': 0.036919645401809045, 'psi': 0.9943215815489501}-{'f1_val': 0.9954312449678927, 'auprc': 0.9986264737523792, 'loss_val': 0.019447871942612723, 'psi': 0.9967093364816872}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.669949 cos_to_last_merge=0.8979 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6271841278103709, 'auprc': 0.7082001264085096, 'loss_val': 1.0450616156038695, 'psi': 0.6595905272496263}-{'f1_val': 0.7300513444471001, 'auprc': 0.7564834626248901, 'loss_val': 0.9451299846920522, 'psi': 0.7406241917182161}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.774818 cos_to_last_merge=0.9429 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=64 local utility u=0.001866 metrics={'f1_val': 0.997011210853081, 'auprc': 0.99883384155826, 'loss_val': 0.023171203825015745, 'psi': 0.9977402631351526}-{'f1_val': 0.9965574496053289, 'auprc': 0.9988181038464226, 'loss_val': 0.02413259024443437, 'psi': 0.9974617113017663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=64 head_norm_before_train=2.095580 cos_to_last_merge=0.7977 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.798
[S15] round=64 local utility u=0.062783 metrics={'f1_val': 0.9264974456156649, 'auprc': 0.9972131945441776, 'loss_val': 0.12339768501204616, 'psi': 0.95478374518707}-{'f1_val': 0.9125493608016491, 'auprc': 0.9970394849993516, 'loss_val': 0.1647537054092297, 'psi': 0.9463454104807301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=64 head_norm_before_train=1.896523 cos_to_last_merge=0.8982 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.898
[S16] round=64 local utility u=0.547871 metrics={'f1_val': 0.9441956071379141, 'auprc': 0.9908992187446268, 'loss_val': 0.3038226773669995, 'psi': 0.9628770517805992}-{'f1_val': 0.8651498325874686, 'auprc': 0.9823214422445344, 'loss_val': 0.8995563328713602, 'psi': 0.9120184764502949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=64 head_norm_before_train=2.087989 (no previous merge yet)
[S17] round=64 local utility u=0.981821 metrics={'f1_val': 0.9000306932201665, 'auprc': 0.9971469415544922, 'loss_val': 0.356593922201487, 'psi': 0.9388771925538968}-{'f1_val': 0.7123254922444967, 'auprc': 0.9411519739257448, 'loss_val': 1.0260191702675945, 'psi': 0.803856084916996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=65 head_norm_before_train=2.017836 cos_to_last_merge=0.7849 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.714993107519371, 'auprc': 0.9283744274533123, 'loss_val': 0.5603147781866278, 'psi': 0.8003456354929475}-{'f1_val': 0.7569703222373274, 'auprc': 0.8801521302678154, 'loss_val': 0.5081446242774299, 'psi': 0.8062430454495226}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.141050 cos_to_last_merge=0.9080 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.791214869091345, 'auprc': 0.9980590512115305, 'loss_val': 0.5264684564406016, 'psi': 0.8739525419394192}-{'f1_val': 0.8337120062542268, 'auprc': 0.9968782616009132, 'loss_val': 0.3889268626487687, 'psi': 0.8989785083929014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.781710 cos_to_last_merge=0.9655 (last merge round=22)
[S4] round=65 local utility u=0.028103 metrics={'f1_val': 0.9528419964731589, 'auprc': 0.9555784679114554, 'loss_val': 0.2955644006095419, 'psi': 0.9539365850484774}-{'f1_val': 0.950002698423035, 'auprc': 0.9427378342295232, 'loss_val': 0.2962133952445108, 'psi': 0.9470967527456302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=65 head_norm_before_train=1.736875 cos_to_last_merge=0.9790 (last merge round=21)
[S5] round=65 local utility u=0.019131 metrics={'f1_val': 0.7263084244111757, 'auprc': 0.9695592874292613, 'loss_val': 0.2803118748537013, 'psi': 0.82360876961841}-{'f1_val': 0.700320598491359, 'auprc': 0.9923981574993788, 'loss_val': 0.231164306615041, 'psi': 0.8171516220945669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=65 head_norm_before_train=1.752044 cos_to_last_merge=0.9570 (last merge round=20)
[S6] round=65 local utility u=1.000000 metrics={'f1_val': 0.7786679139958642, 'auprc': 0.9567440828949199, 'loss_val': 0.4995699606344032, 'psi': 0.8498983815554865}-{'f1_val': 0.4508481379222387, 'auprc': 0.7632007266363412, 'loss_val': 1.2282565841468907, 'psi': 0.5757891734078797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=65 head_norm_before_train=1.967654 cos_to_last_merge=0.9561 (last merge round=22)
[S7] round=65 local utility u=0.963867 metrics={'f1_val': 0.7769200884098292, 'auprc': 0.9613359170916543, 'loss_val': 0.8168883392001309, 'psi': 0.8506864198825592}-{'f1_val': 0.581704697142934, 'auprc': 0.8430620594918198, 'loss_val': 1.218507856119782, 'psi': 0.6862476420824883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=65 head_norm_before_train=1.903920 cos_to_last_merge=0.9599 (last merge round=16)
[S8] round=65 local utility u=0.000108 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9987946117654302, 'loss_val': 0.03497000243553145, 'psi': 0.9950660274356156}-{'f1_val': 0.9925803045490724, 'auprc': 0.9986581289095282, 'loss_val': 0.034777483552067716, 'psi': 0.9950114342932548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=65 head_norm_before_train=1.834231 cos_to_last_merge=0.9680 (last merge round=23)
[S9] round=65 local utility u=0.004513 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988058481209976, 'loss_val': 0.01866332377091085, 'psi': 0.9973684506487316}-{'f1_val': 0.9966924912647621, 'auprc': 0.9953856286436786, 'loss_val': 0.019123405223579037, 'psi': 0.9961697462163288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=65 head_norm_before_train=2.218204 (no previous merge yet)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943983735987947, 'loss_val': 0.052912324857114335, 'psi': 0.9944590636354618}-{'f1_val': 0.9944995236599065, 'auprc': 0.9948411573574827, 'loss_val': 0.05022481812463605, 'psi': 0.9946361771389369}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.253333 (no previous merge yet)
[S11] round=65 local utility u=0.023352 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982552664569205, 'loss_val': 0.019547997652967504, 'psi': 0.9972303092909219}-{'f1_val': 0.9915362262757211, 'auprc': 0.9984996144587936, 'loss_val': 0.036919645401809045, 'psi': 0.9943215815489501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=65 head_norm_before_train=1.676084 cos_to_last_merge=0.8972 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=65 local utility u=0.497689 metrics={'f1_val': 0.7367110063023867, 'auprc': 0.7519237288408421, 'loss_val': 0.8380162604863397, 'psi': 0.7427960953177689}-{'f1_val': 0.6271841278103709, 'auprc': 0.7082001264085096, 'loss_val': 1.0450616156038695, 'psi': 0.6595905272496263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=65 head_norm_before_train=1.778685 cos_to_last_merge=0.9423 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966004498019938, 'auprc': 0.9988276330718013, 'loss_val': 0.023210993764380093, 'psi': 0.9974913231099167}-{'f1_val': 0.997011210853081, 'auprc': 0.99883384155826, 'loss_val': 0.023171203825015745, 'psi': 0.9977402631351526}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=2.101219 cos_to_last_merge=0.7973 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=65 local utility u=0.023553 metrics={'f1_val': 0.9321906105447348, 'auprc': 0.9972850371479333, 'loss_val': 0.11066607233878527, 'psi': 0.9582283811860142}-{'f1_val': 0.9264974456156649, 'auprc': 0.9972131945441776, 'loss_val': 0.12339768501204616, 'psi': 0.95478374518707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=65 head_norm_before_train=1.901860 cos_to_last_merge=0.8974 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=65 local utility u=0.266924 metrics={'f1_val': 0.9893666400609082, 'auprc': 0.9951515724818542, 'loss_val': 0.05375729682278434, 'psi': 0.9916806130292866}-{'f1_val': 0.9441956071379141, 'auprc': 0.9908992187446268, 'loss_val': 0.3038226773669995, 'psi': 0.9628770517805992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=65 head_norm_before_train=2.091202 (no previous merge yet)
[S17] round=65 local utility u=0.006563 metrics={'f1_val': 0.9001797412561279, 'auprc': 0.9970971965890739, 'loss_val': 0.3442137177692279, 'psi': 0.9389467233893063}-{'f1_val': 0.9000306932201665, 'auprc': 0.9971469415544922, 'loss_val': 0.356593922201487, 'psi': 0.9388771925538968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=66 head_norm_before_train=2.021433 cos_to_last_merge=0.7843 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.6772175793386424, 'auprc': 0.7708373466354712, 'loss_val': 1.1264376720362035, 'psi': 0.7146654862573738}-{'f1_val': 0.714993107519371, 'auprc': 0.9283744274533123, 'loss_val': 0.5603147781866278, 'psi': 0.8003456354929475}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.149163 cos_to_last_merge=0.9074 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=66 local utility u=0.684412 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.998865190415505, 'loss_val': 0.1761990216159198, 'psi': 0.9758886605875774}-{'f1_val': 0.791214869091345, 'auprc': 0.9980590512115305, 'loss_val': 0.5264684564406016, 'psi': 0.8739525419394192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=66 head_norm_before_train=1.786898 cos_to_last_merge=0.9650 (last merge round=22)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9503115228113339, 'auprc': 0.9384907554866971, 'loss_val': 0.30366814942229636, 'psi': 0.9455832158814792}-{'f1_val': 0.9528419964731589, 'auprc': 0.9555784679114554, 'loss_val': 0.2955644006095419, 'psi': 0.9539365850484774}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.745178 cos_to_last_merge=0.9782 (last merge round=21)
[S5] round=66 local utility u=0.160816 metrics={'f1_val': 0.760826025178353, 'auprc': 0.9907590103733696, 'loss_val': 0.22938457307105378, 'psi': 0.8527992192563596}-{'f1_val': 0.7263084244111757, 'auprc': 0.9695592874292613, 'loss_val': 0.2803118748537013, 'psi': 0.82360876961841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=66 head_norm_before_train=1.755012 cos_to_last_merge=0.9568 (last merge round=20)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.7539313849600738, 'auprc': 0.9612934587136572, 'loss_val': 0.5623994486254785, 'psi': 0.8368762144615072}-{'f1_val': 0.7786679139958642, 'auprc': 0.9567440828949199, 'loss_val': 0.4995699606344032, 'psi': 0.8498983815554865}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.975365 cos_to_last_merge=0.9554 (last merge round=22)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.7586348635277893, 'auprc': 0.8639583698600859, 'loss_val': 0.7150377476442523, 'psi': 0.8007642660607079}-{'f1_val': 0.7769200884098292, 'auprc': 0.9613359170916543, 'loss_val': 0.8168883392001309, 'psi': 0.8506864198825592}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.906736 cos_to_last_merge=0.9599 (last merge round=16)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9853456431056832, 'loss_val': 0.33196382538403024, 'psi': 0.822337840732666}-{'f1_val': 0.9925803045490724, 'auprc': 0.9987946117654302, 'loss_val': 0.03497000243553145, 'psi': 0.9950660274356156}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=1.839414 cos_to_last_merge=0.9677 (last merge round=23)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.998807710872816, 'loss_val': 0.019268441686457655, 'psi': 0.9973670958407707}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988058481209976, 'loss_val': 0.01866332377091085, 'psi': 0.9973684506487316}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.218803 (no previous merge yet)
[S10] round=66 local utility u=0.000437 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944091920396645, 'loss_val': 0.05207147652258923, 'psi': 0.9944633910118097}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943983735987947, 'loss_val': 0.052912324857114335, 'psi': 0.9944590636354618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=66 head_norm_before_train=2.258972 (no previous merge yet)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981892812823019, 'loss_val': 0.020433349947163316, 'psi': 0.9972039152210745}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982552664569205, 'loss_val': 0.019547997652967504, 'psi': 0.9972303092909219}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.683499 cos_to_last_merge=0.8962 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6518107160750468, 'auprc': 0.7246351304105288, 'loss_val': 0.9971490337695765, 'psi': 0.6809404818092397}-{'f1_val': 0.7367110063023867, 'auprc': 0.7519237288408421, 'loss_val': 0.8380162604863397, 'psi': 0.7427960953177689}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=1.784646 cos_to_last_merge=0.9417 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9971432758171966, 'loss_val': 0.024694861818267588, 'psi': 0.9967935370971374}-{'f1_val': 0.9966004498019938, 'auprc': 0.9988276330718013, 'loss_val': 0.023210993764380093, 'psi': 0.9974913231099167}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.106794 cos_to_last_merge=0.7969 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=66 local utility u=0.077636 metrics={'f1_val': 0.9533968179993169, 'auprc': 0.9973966315630856, 'loss_val': 0.08296512378819985, 'psi': 0.9709967434248243}-{'f1_val': 0.9321906105447348, 'auprc': 0.9972850371479333, 'loss_val': 0.11066607233878527, 'psi': 0.9582283811860142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=66 head_norm_before_train=1.906972 cos_to_last_merge=0.8967 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.9032864962877627, 'auprc': 0.9880817968060889, 'loss_val': 0.5203523569443927, 'psi': 0.9372046164950932}-{'f1_val': 0.9893666400609082, 'auprc': 0.9951515724818542, 'loss_val': 0.05375729682278434, 'psi': 0.9916806130292866}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=2.094175 (no previous merge yet)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.7503861928063285, 'auprc': 0.9923519022163335, 'loss_val': 0.7235487978750451, 'psi': 0.8471724765703305}-{'f1_val': 0.9001797412561279, 'auprc': 0.9970971965890739, 'loss_val': 0.3442137177692279, 'psi': 0.9389467233893063}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.026257 cos_to_last_merge=0.7838 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=67 local utility u=0.661959 metrics={'f1_val': 0.709610928379004, 'auprc': 0.9697225683593457, 'loss_val': 0.5935347039570308, 'psi': 0.8136555843711406}-{'f1_val': 0.6772175793386424, 'auprc': 0.7708373466354712, 'loss_val': 1.1264376720362035, 'psi': 0.7146654862573738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=67 head_norm_before_train=2.156784 cos_to_last_merge=0.9070 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=67 local utility u=0.190488 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9988466943372928, 'loss_val': 0.015960320245849504, 'psi': 0.9979604963299694}-{'f1_val': 0.9605709740356257, 'auprc': 0.998865190415505, 'loss_val': 0.1761990216159198, 'psi': 0.9758886605875774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=67 head_norm_before_train=1.792217 cos_to_last_merge=0.9643 (last merge round=22)
[S4] round=67 local utility u=0.014638 metrics={'f1_val': 0.9510175934815096, 'auprc': 0.946171524169489, 'loss_val': 0.30167084333050853, 'psi': 0.9490791657567014}-{'f1_val': 0.9503115228113339, 'auprc': 0.9384907554866971, 'loss_val': 0.30366814942229636, 'psi': 0.9455832158814792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=67 head_norm_before_train=1.752409 cos_to_last_merge=0.9778 (last merge round=21)
[S5] round=67 local utility u=0.496693 metrics={'f1_val': 0.9079091395055833, 'auprc': 0.9948825714456948, 'loss_val': 0.13086704612658226, 'psi': 0.9426985122816279}-{'f1_val': 0.760826025178353, 'auprc': 0.9907590103733696, 'loss_val': 0.22938457307105378, 'psi': 0.8527992192563596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=67 head_norm_before_train=1.757290 cos_to_last_merge=0.9563 (last merge round=20)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.6698044686352951, 'auprc': 0.9212667686902105, 'loss_val': 0.8435169626306097, 'psi': 0.7703893886572613}-{'f1_val': 0.7539313849600738, 'auprc': 0.9612934587136572, 'loss_val': 0.5623994486254785, 'psi': 0.8368762144615072}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.987690 cos_to_last_merge=0.9540 (last merge round=22)
[S7] round=67 local utility u=0.384320 metrics={'f1_val': 0.8310337143912823, 'auprc': 0.9523942007046691, 'loss_val': 0.6460980716636243, 'psi': 0.879577908916637}-{'f1_val': 0.7586348635277893, 'auprc': 0.8639583698600859, 'loss_val': 0.7150377476442523, 'psi': 0.8007642660607079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=67 head_norm_before_train=1.908528 cos_to_last_merge=0.9605 (last merge round=16)
[S8] round=67 local utility u=0.984198 metrics={'f1_val': 0.9868234720888559, 'auprc': 0.9989353248354892, 'loss_val': 0.043282042746671724, 'psi': 0.9916682131875092}-{'f1_val': 0.713665972483988, 'auprc': 0.9853456431056832, 'loss_val': 0.33196382538403024, 'psi': 0.822337840732666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=67 head_norm_before_train=1.844441 cos_to_last_merge=0.9674 (last merge round=23)
[S9] round=67 local utility u=0.000257 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988093593912578, 'loss_val': 0.018780234922146016, 'psi': 0.9973698551568356}-{'f1_val': 0.9964066858194072, 'auprc': 0.998807710872816, 'loss_val': 0.019268441686457655, 'psi': 0.9973670958407707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=67 head_norm_before_train=2.222256 (no previous merge yet)
[S10] round=67 local utility u=0.000491 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944416006896625, 'loss_val': 0.05118692767911618, 'psi': 0.9944763544718088}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944091920396645, 'loss_val': 0.05207147652258923, 'psi': 0.9944633910118097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=67 head_norm_before_train=2.265031 (no previous merge yet)
[S11] round=67 local utility u=0.000984 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982419098518887, 'loss_val': 0.018622879236833964, 'psi': 0.9972249666489093}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981892812823019, 'loss_val': 0.020433349947163316, 'psi': 0.9972039152210745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=67 head_norm_before_train=1.691161 cos_to_last_merge=0.8951 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=67 local utility u=0.249464 metrics={'f1_val': 0.7240426923916201, 'auprc': 0.7253724017806836, 'loss_val': 0.9338239881075087, 'psi': 0.7245745761472455}-{'f1_val': 0.6518107160750468, 'auprc': 0.7246351304105288, 'loss_val': 0.9971490337695765, 'psi': 0.6809404818092397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=67 head_norm_before_train=1.791068 cos_to_last_merge=0.9410 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=67 local utility u=0.000438 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9974504927409574, 'loss_val': 0.02473967450619132, 'psi': 0.9969164238666417}-{'f1_val': 0.9965603779504312, 'auprc': 0.9971432758171966, 'loss_val': 0.024694861818267588, 'psi': 0.9967935370971374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=67 head_norm_before_train=2.112356 cos_to_last_merge=0.7965 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9529211306736085, 'auprc': 0.9974110106067857, 'loss_val': 0.08365612625881624, 'psi': 0.9707170826468794}-{'f1_val': 0.9533968179993169, 'auprc': 0.9973966315630856, 'loss_val': 0.08296512378819985, 'psi': 0.9709967434248243}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.912356 cos_to_last_merge=0.8960 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.896
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.8660766003832812, 'auprc': 0.901225584374123, 'loss_val': 0.9237805586030855, 'psi': 0.880136193979618}-{'f1_val': 0.9032864962877627, 'auprc': 0.9880817968060889, 'loss_val': 0.5203523569443927, 'psi': 0.9372046164950932}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.099244 (no previous merge yet)
[S17] round=67 local utility u=0.355512 metrics={'f1_val': 0.829300243181911, 'auprc': 0.9877031032429708, 'loss_val': 0.472062000497198, 'psi': 0.8926613872063349}-{'f1_val': 0.7503861928063285, 'auprc': 0.9923519022163335, 'loss_val': 0.7235487978750451, 'psi': 0.8471724765703305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=68 head_norm_before_train=2.032877 cos_to_last_merge=0.7832 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=68 local utility u=0.213903 metrics={'f1_val': 0.8268679227616944, 'auprc': 0.8315200606003521, 'loss_val': 0.4546624633376842, 'psi': 0.8287287778971575}-{'f1_val': 0.709610928379004, 'auprc': 0.9697225683593457, 'loss_val': 0.5935347039570308, 'psi': 0.8136555843711406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=68 head_norm_before_train=2.162821 cos_to_last_merge=0.9065 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9817440278244994, 'auprc': 0.9989042402788523, 'loss_val': 0.05749984172004805, 'psi': 0.9886081128062405}-{'f1_val': 0.9973696976584205, 'auprc': 0.9988466943372928, 'loss_val': 0.015960320245849504, 'psi': 0.9979604963299694}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.794006 cos_to_last_merge=0.9636 (last merge round=22)
[S4] round=68 local utility u=0.051039 metrics={'f1_val': 0.9525648064941997, 'auprc': 0.9745935372643774, 'loss_val': 0.2941411626172036, 'psi': 0.9613762988022708}-{'f1_val': 0.9510175934815096, 'auprc': 0.946171524169489, 'loss_val': 0.30167084333050853, 'psi': 0.9490791657567014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=68 head_norm_before_train=1.762299 cos_to_last_merge=0.9772 (last merge round=21)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.7110123735727442, 'auprc': 0.9910904092303106, 'loss_val': 0.26606591182980033, 'psi': 0.8230435878357707}-{'f1_val': 0.9079091395055833, 'auprc': 0.9948825714456948, 'loss_val': 0.13086704612658226, 'psi': 0.9426985122816279}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.763681 cos_to_last_merge=0.9557 (last merge round=20)
[S6] round=68 local utility u=1.000000 metrics={'f1_val': 0.9861526342920566, 'auprc': 0.9749802596595831, 'loss_val': 0.08372142330364155, 'psi': 0.9816836844390673}-{'f1_val': 0.6698044686352951, 'auprc': 0.9212667686902105, 'loss_val': 0.8435169626306097, 'psi': 0.7703893886572613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=68 head_norm_before_train=2.000212 cos_to_last_merge=0.9525 (last merge round=22)
[S7] round=68 local utility u=0.514075 metrics={'f1_val': 0.9219908069302297, 'auprc': 0.9879820992302828, 'loss_val': 0.2704537917879064, 'psi': 0.9483873238502509}-{'f1_val': 0.8310337143912823, 'auprc': 0.9523942007046691, 'loss_val': 0.6460980716636243, 'psi': 0.879577908916637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=68 head_norm_before_train=1.912090 cos_to_last_merge=0.9604 (last merge round=16)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9857354242324556, 'auprc': 0.9989440820374513, 'loss_val': 0.04723582256454147, 'psi': 0.9910188873544539}-{'f1_val': 0.9868234720888559, 'auprc': 0.9989353248354892, 'loss_val': 0.043282042746671724, 'psi': 0.9916682131875092}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.851336 cos_to_last_merge=0.9670 (last merge round=23)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9943182614872088, 'loss_val': 0.019234063589334195, 'psi': 0.9957427993537409}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988093593912578, 'loss_val': 0.018780234922146016, 'psi': 0.9973698551568356}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.227202 (no previous merge yet)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944001680805575, 'loss_val': 0.05135645091860675, 'psi': 0.9944597814281668}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944416006896625, 'loss_val': 0.05118692767911618, 'psi': 0.9944763544718088}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.267107 (no previous merge yet)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9917746927570964, 'auprc': 0.998568708761523, 'loss_val': 0.03719436253288689, 'psi': 0.994492299158867}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982419098518887, 'loss_val': 0.018622879236833964, 'psi': 0.9972249666489093}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.699794 cos_to_last_merge=0.8939 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6173073799196858, 'auprc': 0.667365738085246, 'loss_val': 1.199572280015291, 'psi': 0.6373307231859098}-{'f1_val': 0.7240426923916201, 'auprc': 0.7253724017806836, 'loss_val': 0.9338239881075087, 'psi': 0.7245745761472455}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.796012 cos_to_last_merge=0.9408 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=68 local utility u=0.002964 metrics={'f1_val': 0.9966035163566963, 'auprc': 0.9988136041718397, 'loss_val': 0.0231606354483519, 'psi': 0.9974875514827537}-{'f1_val': 0.9965603779504312, 'auprc': 0.9974504927409574, 'loss_val': 0.02473967450619132, 'psi': 0.9969164238666417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=68 head_norm_before_train=2.117760 cos_to_last_merge=0.7961 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9466648143105535, 'auprc': 0.9973839026225887, 'loss_val': 0.09111113223603504, 'psi': 0.9669524496353676}-{'f1_val': 0.9529211306736085, 'auprc': 0.9974110106067857, 'loss_val': 0.08365612625881624, 'psi': 0.9707170826468794}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.918129 cos_to_last_merge=0.8952 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.895
[S16] round=68 local utility u=0.958019 metrics={'f1_val': 0.9921238409786317, 'auprc': 0.9935034932776252, 'loss_val': 0.040859978421616316, 'psi': 0.9926757018982291}-{'f1_val': 0.8660766003832812, 'auprc': 0.901225584374123, 'loss_val': 0.9237805586030855, 'psi': 0.880136193979618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=68 head_norm_before_train=2.102900 (no previous merge yet)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.717844244255063, 'auprc': 0.9535727819767043, 'loss_val': 0.918112799626314, 'psi': 0.8121356593437195}-{'f1_val': 0.829300243181911, 'auprc': 0.9877031032429708, 'loss_val': 0.472062000497198, 'psi': 0.8926613872063349}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.036585 cos_to_last_merge=0.7825 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7110172327963904, 'auprc': 0.8640780270465908, 'loss_val': 0.6701117755012801, 'psi': 0.7722415504964706}-{'f1_val': 0.8268679227616944, 'auprc': 0.8315200606003521, 'loss_val': 0.4546624633376842, 'psi': 0.8287287778971575}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.166481 cos_to_last_merge=0.9066 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9710375863641826, 'auprc': 0.9987923238878301, 'loss_val': 0.08462328429200774, 'psi': 0.9821394813736416}-{'f1_val': 0.9817440278244994, 'auprc': 0.9989042402788523, 'loss_val': 0.05749984172004805, 'psi': 0.9886081128062405}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.800278 cos_to_last_merge=0.9630 (last merge round=22)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9501263964571748, 'auprc': 0.9465805753800266, 'loss_val': 0.302516973275951, 'psi': 0.9487080680263155}-{'f1_val': 0.9525648064941997, 'auprc': 0.9745935372643774, 'loss_val': 0.2941411626172036, 'psi': 0.9613762988022708}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.768452 cos_to_last_merge=0.9768 (last merge round=21)
[S5] round=69 local utility u=0.340559 metrics={'f1_val': 0.8119144751264545, 'auprc': 0.9918321767594401, 'loss_val': 0.19258567875612986, 'psi': 0.8838815557796488}-{'f1_val': 0.7110123735727442, 'auprc': 0.9910904092303106, 'loss_val': 0.26606591182980033, 'psi': 0.8230435878357707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=69 head_norm_before_train=1.770276 cos_to_last_merge=0.9552 (last merge round=20)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7186179754106766, 'auprc': 0.8775495066704755, 'loss_val': 0.8805826602458275, 'psi': 0.7821905879145962}-{'f1_val': 0.9861526342920566, 'auprc': 0.9749802596595831, 'loss_val': 0.08372142330364155, 'psi': 0.9816836844390673}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=2.011822 cos_to_last_merge=0.9513 (last merge round=22)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.7998539549013555, 'auprc': 0.9860429354923995, 'loss_val': 0.6456351672410352, 'psi': 0.874329547137773}-{'f1_val': 0.9219908069302297, 'auprc': 0.9879820992302828, 'loss_val': 0.2704537917879064, 'psi': 0.9483873238502509}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.918246 cos_to_last_merge=0.9599 (last merge round=16)
[S8] round=69 local utility u=0.009547 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9873725411686833, 'loss_val': 0.034441505878425635, 'psi': 0.9904917841407586}-{'f1_val': 0.9857354242324556, 'auprc': 0.9989440820374513, 'loss_val': 0.04723582256454147, 'psi': 0.9910188873544539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=69 head_norm_before_train=1.858332 cos_to_last_merge=0.9665 (last merge round=23)
[S9] round=69 local utility u=0.007558 metrics={'f1_val': 0.9968497224526777, 'auprc': 0.998806933286758, 'loss_val': 0.018526926232771086, 'psi': 0.9976326067863098}-{'f1_val': 0.9966924912647621, 'auprc': 0.9943182614872088, 'loss_val': 0.019234063589334195, 'psi': 0.9957427993537409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=69 head_norm_before_train=2.232820 (no previous merge yet)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943958474140975, 'loss_val': 0.05166465473870595, 'psi': 0.9944580531615828}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944001680805575, 'loss_val': 0.05135645091860675, 'psi': 0.9944597814281668}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=2.265745 (no previous merge yet)
[S11] round=69 local utility u=0.021462 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985985985747188, 'loss_val': 0.020513504489745427, 'psi': 0.9971196443778731}-{'f1_val': 0.9917746927570964, 'auprc': 0.998568708761523, 'loss_val': 0.03719436253288689, 'psi': 0.994492299158867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=69 head_norm_before_train=1.708041 cos_to_last_merge=0.8930 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=69 local utility u=0.474412 metrics={'f1_val': 0.7155290674133239, 'auprc': 0.7041934676863661, 'loss_val': 0.9505624199963386, 'psi': 0.7109948275225408}-{'f1_val': 0.6173073799196858, 'auprc': 0.667365738085246, 'loss_val': 1.199572280015291, 'psi': 0.6373307231859098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=69 head_norm_before_train=1.799415 cos_to_last_merge=0.9407 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=69 local utility u=0.001919 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9984444043247269, 'loss_val': 0.02198189614154877, 'psi': 0.9977165663183996}-{'f1_val': 0.9966035163566963, 'auprc': 0.9988136041718397, 'loss_val': 0.0231606354483519, 'psi': 0.9974875514827537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=69 head_norm_before_train=2.123044 cos_to_last_merge=0.7957 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=69 local utility u=0.022100 metrics={'f1_val': 0.9529211306736085, 'auprc': 0.9973875286181884, 'loss_val': 0.08445961465535974, 'psi': 0.9707076898514404}-{'f1_val': 0.9466648143105535, 'auprc': 0.9973839026225887, 'loss_val': 0.09111113223603504, 'psi': 0.9669524496353676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=69 head_norm_before_train=1.923216 cos_to_last_merge=0.8947 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.895
[S16] round=69 local utility u=0.006173 metrics={'f1_val': 0.9912953646695531, 'auprc': 0.9983279222003589, 'loss_val': 0.03801631136606663, 'psi': 0.9941083876818755}-{'f1_val': 0.9921238409786317, 'auprc': 0.9935034932776252, 'loss_val': 0.040859978421616316, 'psi': 0.9926757018982291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=69 head_norm_before_train=2.106593 (no previous merge yet)
[S17] round=69 local utility u=0.205137 metrics={'f1_val': 0.7424677247573603, 'auprc': 0.9664812946219019, 'loss_val': 0.694304322356663, 'psi': 0.832073152703177}-{'f1_val': 0.717844244255063, 'auprc': 0.9535727819767043, 'loss_val': 0.918112799626314, 'psi': 0.8121356593437195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=70 head_norm_before_train=2.040486 cos_to_last_merge=0.7820 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=70 local utility u=0.519853 metrics={'f1_val': 0.8183127041800082, 'auprc': 0.9286700012767198, 'loss_val': 0.4679551708813378, 'psi': 0.8624556230186928}-{'f1_val': 0.7110172327963904, 'auprc': 0.8640780270465908, 'loss_val': 0.6701117755012801, 'psi': 0.7722415504964706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=70 head_norm_before_train=2.170064 cos_to_last_merge=0.9061 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987957050291373, 'loss_val': 0.12189152495978166, 'psi': 0.9761394326749211}-{'f1_val': 0.9710375863641826, 'auprc': 0.9987923238878301, 'loss_val': 0.08462328429200774, 'psi': 0.9821394813736416}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.803206 cos_to_last_merge=0.9622 (last merge round=22)
[S4] round=70 local utility u=0.040505 metrics={'f1_val': 0.9533037998647816, 'auprc': 0.9636584653497777, 'loss_val': 0.2918050781506804, 'psi': 0.95744566605878}-{'f1_val': 0.9501263964571748, 'auprc': 0.9465805753800266, 'loss_val': 0.302516973275951, 'psi': 0.9487080680263155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=70 head_norm_before_train=1.772818 cos_to_last_merge=0.9764 (last merge round=21)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.6679425808885076, 'auprc': 0.7077508266781928, 'loss_val': 0.5237192199052584, 'psi': 0.6838658792043817}-{'f1_val': 0.8119144751264545, 'auprc': 0.9918321767594401, 'loss_val': 0.19258567875612986, 'psi': 0.8838815557796488}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.774628 cos_to_last_merge=0.9544 (last merge round=20)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6915982822236172, 'auprc': 0.8581808338940232, 'loss_val': 0.9591987794135838, 'psi': 0.7582313028917796}-{'f1_val': 0.7186179754106766, 'auprc': 0.8775495066704755, 'loss_val': 0.8805826602458275, 'psi': 0.7821905879145962}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=2.019108 cos_to_last_merge=0.9505 (last merge round=22)
[S7] round=70 local utility u=0.692735 metrics={'f1_val': 0.9509870161784233, 'auprc': 0.9878596589220148, 'loss_val': 0.17241447204944033, 'psi': 0.9657360732758599}-{'f1_val': 0.7998539549013555, 'auprc': 0.9860429354923995, 'loss_val': 0.6456351672410352, 'psi': 0.874329547137773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=70 head_norm_before_train=1.923369 cos_to_last_merge=0.9599 (last merge round=16)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9875357054597707, 'auprc': 0.9987462612973594, 'loss_val': 0.04193144741383408, 'psi': 0.9920199277948061}-{'f1_val': 0.9925712794554754, 'auprc': 0.9873725411686833, 'loss_val': 0.034441505878425635, 'psi': 0.9904917841407586}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=1.861962 cos_to_last_merge=0.9663 (last merge round=23)
[S9] round=70 local utility u=0.001159 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988086068324571, 'loss_val': 0.01773212206730927, 'psi': 0.9977851902402686}-{'f1_val': 0.9968497224526777, 'auprc': 0.998806933286758, 'loss_val': 0.018526926232771086, 'psi': 0.9976326067863098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=70 head_norm_before_train=2.234279 (no previous merge yet)
[S10] round=70 local utility u=0.003422 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9953092191033143, 'loss_val': 0.04756151289275584, 'psi': 0.9948234018372695}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943958474140975, 'loss_val': 0.05166465473870595, 'psi': 0.9944580531615828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=70 head_norm_before_train=2.267789 (no previous merge yet)
[S11] round=70 local utility u=0.000667 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987738511262632, 'loss_val': 0.019828842217949182, 'psi': 0.9972020252969525}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985985985747188, 'loss_val': 0.020513504489745427, 'psi': 0.9971196443778731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=70 head_norm_before_train=1.714686 cos_to_last_merge=0.8921 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6148361242451126, 'auprc': 0.6664643996598034, 'loss_val': 1.257773242387845, 'psi': 0.6354874344109889}-{'f1_val': 0.7155290674133239, 'auprc': 0.7041934676863661, 'loss_val': 0.9505624199963386, 'psi': 0.7109948275225408}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.802224 cos_to_last_merge=0.9408 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9965515368176185, 'auprc': 0.9988147656764331, 'loss_val': 0.02722302443702143, 'psi': 0.9974568283611444}-{'f1_val': 0.997231340980848, 'auprc': 0.9984444043247269, 'loss_val': 0.02198189614154877, 'psi': 0.9977165663183996}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.128293 cos_to_last_merge=0.7953 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9357534448119964, 'auprc': 0.9973342583138206, 'loss_val': 0.10351562934039439, 'psi': 0.9603857702127261}-{'f1_val': 0.9529211306736085, 'auprc': 0.9973875286181884, 'loss_val': 0.08445961465535974, 'psi': 0.9707076898514404}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.928212 cos_to_last_merge=0.8943 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=70 local utility u=0.002623 metrics={'f1_val': 0.992074503211585, 'auprc': 0.9983262536342111, 'loss_val': 0.0374397442625916, 'psi': 0.9945752033806354}-{'f1_val': 0.9912953646695531, 'auprc': 0.9983279222003589, 'loss_val': 0.03801631136606663, 'psi': 0.9941083876818755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=70 head_norm_before_train=2.109764 (no previous merge yet)
[S17] round=70 local utility u=0.651297 metrics={'f1_val': 0.8977835765800389, 'auprc': 0.9826241270213958, 'loss_val': 0.37203361804797713, 'psi': 0.9317197967565817}-{'f1_val': 0.7424677247573603, 'auprc': 0.9664812946219019, 'loss_val': 0.694304322356663, 'psi': 0.832073152703177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=71 head_norm_before_train=2.043971 cos_to_last_merge=0.7816 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=71 local utility u=0.020845 metrics={'f1_val': 0.8263172691985475, 'auprc': 0.9299689929464161, 'loss_val': 0.47819009370154214, 'psi': 0.8677779586976949}-{'f1_val': 0.8183127041800082, 'auprc': 0.9286700012767198, 'loss_val': 0.4679551708813378, 'psi': 0.8624556230186928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=71 head_norm_before_train=2.169355 cos_to_last_merge=0.9055 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=71 local utility u=0.008585 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988779889409238, 'loss_val': 0.10496766131219203, 'psi': 0.9761723462396357}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987957050291373, 'loss_val': 0.12189152495978166, 'psi': 0.9761394326749211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=71 head_norm_before_train=1.808830 cos_to_last_merge=0.9614 (last merge round=22)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9503115228113339, 'auprc': 0.9379376962114438, 'loss_val': 0.3067587562835865, 'psi': 0.9453619921713778}-{'f1_val': 0.9533037998647816, 'auprc': 0.9636584653497777, 'loss_val': 0.2918050781506804, 'psi': 0.95744566605878}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.774654 cos_to_last_merge=0.9764 (last merge round=21)
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.6082922168872439, 'auprc': 0.6876310204248324, 'loss_val': 0.738622396148671, 'psi': 0.6400277383022793}-{'f1_val': 0.6679425808885076, 'auprc': 0.7077508266781928, 'loss_val': 0.5237192199052584, 'psi': 0.6838658792043817}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.782490 cos_to_last_merge=0.9539 (last merge round=20)
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.888607322072528, 'auprc': 0.9723606260741977, 'loss_val': 0.22168975192945634, 'psi': 0.922108643673196}-{'f1_val': 0.6915982822236172, 'auprc': 0.8581808338940232, 'loss_val': 0.9591987794135838, 'psi': 0.7582313028917796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=71 head_norm_before_train=2.029585 cos_to_last_merge=0.9498 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.8878005244880757, 'auprc': 0.9736200007775382, 'loss_val': 0.4464771793079343, 'psi': 0.9221283150038606}-{'f1_val': 0.9509870161784233, 'auprc': 0.9878596589220148, 'loss_val': 0.17241447204944033, 'psi': 0.9657360732758599}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.927486 cos_to_last_merge=0.9600 (last merge round=16)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9989094859586289, 'loss_val': 0.04319954542421285, 'psi': 0.9912064182927939}-{'f1_val': 0.9875357054597707, 'auprc': 0.9987462612973594, 'loss_val': 0.04193144741383408, 'psi': 0.9920199277948061}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=1.864790 cos_to_last_merge=0.9662 (last merge round=23)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.998799606275895, 'loss_val': 0.020560868482747137, 'psi': 0.9968656778408669}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988086068324571, 'loss_val': 0.01773212206730927, 'psi': 0.9977851902402686}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.237482 (no previous merge yet)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9951203656338975, 'loss_val': 0.04797513171795772, 'psi': 0.9947478604495028}-{'f1_val': 0.9944995236599065, 'auprc': 0.9953092191033143, 'loss_val': 0.04756151289275584, 'psi': 0.9948234018372695}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=2.271717 (no previous merge yet)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9894568207168896, 'auprc': 0.9986653571342907, 'loss_val': 0.0501213573018473, 'psi': 0.99314023528385}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987738511262632, 'loss_val': 0.019828842217949182, 'psi': 0.9972020252969525}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.719424 cos_to_last_merge=0.8916 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=71 local utility u=0.265313 metrics={'f1_val': 0.648593071435253, 'auprc': 0.6988775161060934, 'loss_val': 1.0269287871827137, 'psi': 0.6687068493035891}-{'f1_val': 0.6148361242451126, 'auprc': 0.6664643996598034, 'loss_val': 1.257773242387845, 'psi': 0.6354874344109889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=71 head_norm_before_train=1.806315 cos_to_last_merge=0.9405 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9960945575929834, 'auprc': 0.9968613343923449, 'loss_val': 0.025628035279737667, 'psi': 0.996401268312728}-{'f1_val': 0.9965515368176185, 'auprc': 0.9988147656764331, 'loss_val': 0.02722302443702143, 'psi': 0.9974568283611444}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=2.133439 cos_to_last_merge=0.7949 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.9321906105447348, 'auprc': 0.9973130172413841, 'loss_val': 0.1117185968883315, 'psi': 0.9582395732233945}-{'f1_val': 0.9357534448119964, 'auprc': 0.9973342583138206, 'loss_val': 0.10351562934039439, 'psi': 0.9603857702127261}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.933868 cos_to_last_merge=0.8937 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=71 local utility u=0.000641 metrics={'f1_val': 0.9922935913444343, 'auprc': 0.9983914466762644, 'loss_val': 0.03766863351852169, 'psi': 0.9947327334771663}-{'f1_val': 0.992074503211585, 'auprc': 0.9983262536342111, 'loss_val': 0.0374397442625916, 'psi': 0.9945752033806354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=71 head_norm_before_train=2.116551 (no previous merge yet)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8968602310751392, 'auprc': 0.9813868974747444, 'loss_val': 0.38060273158539365, 'psi': 0.9306708976349813}-{'f1_val': 0.8977835765800389, 'auprc': 0.9826241270213958, 'loss_val': 0.37203361804797713, 'psi': 0.9317197967565817}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.047395 cos_to_last_merge=0.7812 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7084722287552142, 'auprc': 0.9890364980956753, 'loss_val': 0.6392315815182007, 'psi': 0.8206979364913987}-{'f1_val': 0.8263172691985475, 'auprc': 0.9299689929464161, 'loss_val': 0.47819009370154214, 'psi': 0.8677779586976949}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.173463 cos_to_last_merge=0.9049 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=72 local utility u=0.100695 metrics={'f1_val': 0.9835800728454073, 'auprc': 0.9991547492818638, 'loss_val': 0.03967602182653495, 'psi': 0.9898099434199898}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988779889409238, 'loss_val': 0.10496766131219203, 'psi': 0.9761723462396357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=72 head_norm_before_train=1.814540 cos_to_last_merge=0.9608 (last merge round=22)
[S4] round=72 local utility u=0.007265 metrics={'f1_val': 0.9528730813313322, 'auprc': 0.9388986542448687, 'loss_val': 0.3104814055612731, 'psi': 0.9472833104967469}-{'f1_val': 0.9503115228113339, 'auprc': 0.9379376962114438, 'loss_val': 0.3067587562835865, 'psi': 0.9453619921713778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=72 head_norm_before_train=1.777759 cos_to_last_merge=0.9760 (last merge round=21)
[S5] round=72 local utility u=1.000000 metrics={'f1_val': 0.8867315098711726, 'auprc': 0.9912831067334262, 'loss_val': 0.1438467745735051, 'psi': 0.928552148616074}-{'f1_val': 0.6082922168872439, 'auprc': 0.6876310204248324, 'loss_val': 0.738622396148671, 'psi': 0.6400277383022793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=72 head_norm_before_train=1.784887 cos_to_last_merge=0.9534 (last merge round=20)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.6323643062638552, 'auprc': 0.9104671465007035, 'loss_val': 1.0411428482719363, 'psi': 0.7436054423585945}-{'f1_val': 0.888607322072528, 'auprc': 0.9723606260741977, 'loss_val': 0.22168975192945634, 'psi': 0.922108643673196}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=2.040816 cos_to_last_merge=0.9490 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.7824857672361446, 'auprc': 0.894613466434931, 'loss_val': 0.5465212430125832, 'psi': 0.8273368469156592}-{'f1_val': 0.8878005244880757, 'auprc': 0.9736200007775382, 'loss_val': 0.4464771793079343, 'psi': 0.9221283150038606}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.929294 cos_to_last_merge=0.9600 (last merge round=16)
[S8] round=72 local utility u=0.003750 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.985562107132427, 'loss_val': 0.0378254661086927, 'psi': 0.9900842719751908}-{'f1_val': 0.9860710398489039, 'auprc': 0.9989094859586289, 'loss_val': 0.04319954542421285, 'psi': 0.9912064182927939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=72 head_norm_before_train=1.869431 cos_to_last_merge=0.9659 (last merge round=23)
[S9] round=72 local utility u=0.004616 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9988052996456651, 'loss_val': 0.018041741260876463, 'psi': 0.9975376146171233}-{'f1_val': 0.9955763922175147, 'auprc': 0.998799606275895, 'loss_val': 0.020560868482747137, 'psi': 0.9968656778408669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=72 head_norm_before_train=2.242159 (no previous merge yet)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9943433331041724, 'loss_val': 0.052135654907968086, 'psi': 0.9944370474376127}-{'f1_val': 0.9944995236599065, 'auprc': 0.9951203656338975, 'loss_val': 0.04797513171795772, 'psi': 0.9947478604495028}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.276615 (no previous merge yet)
[S11] round=72 local utility u=0.035896 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990204236305128, 'loss_val': 0.019577993698731845, 'psi': 0.9973006542986523}-{'f1_val': 0.9894568207168896, 'auprc': 0.9986653571342907, 'loss_val': 0.0501213573018473, 'psi': 0.99314023528385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=72 head_norm_before_train=1.721220 cos_to_last_merge=0.8912 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6122798930064954, 'auprc': 0.6664276689527941, 'loss_val': 1.2556732446965997, 'psi': 0.633939003385015}-{'f1_val': 0.648593071435253, 'auprc': 0.6988775161060934, 'loss_val': 1.0269287871827137, 'psi': 0.6687068493035891}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.812380 cos_to_last_merge=0.9401 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=72 local utility u=0.008357 metrics={'f1_val': 0.9972340657469505, 'auprc': 0.9988865804338201, 'loss_val': 0.02182601733413595, 'psi': 0.9978950716216983}-{'f1_val': 0.9960945575929834, 'auprc': 0.9968613343923449, 'loss_val': 0.025628035279737667, 'psi': 0.996401268312728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=72 head_norm_before_train=2.138515 cos_to_last_merge=0.7945 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9311641934997591, 'auprc': 0.9973066659730736, 'loss_val': 0.11557320547409389, 'psi': 0.9576211824890849}-{'f1_val': 0.9321906105447348, 'auprc': 0.9973130172413841, 'loss_val': 0.1117185968883315, 'psi': 0.9582395732233945}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.937280 cos_to_last_merge=0.8932 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9918755575684484, 'auprc': 0.9983960298802472, 'loss_val': 0.037750173813675486, 'psi': 0.994483746493168}-{'f1_val': 0.9922935913444343, 'auprc': 0.9983914466762644, 'loss_val': 0.03766863351852169, 'psi': 0.9947327334771663}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.123030 (no previous merge yet)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.8119088668497234, 'auprc': 0.9606891564592183, 'loss_val': 0.6010829796974534, 'psi': 0.8714209826935213}-{'f1_val': 0.8968602310751392, 'auprc': 0.9813868974747444, 'loss_val': 0.38060273158539365, 'psi': 0.9306708976349813}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.051718 cos_to_last_merge=0.7808 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.8028155620809845, 'auprc': 0.7492859794584417, 'loss_val': 0.556601378335634, 'psi': 0.7814037290319673}-{'f1_val': 0.7084722287552142, 'auprc': 0.9890364980956753, 'loss_val': 0.6392315815182007, 'psi': 0.8206979364913987}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.169884 cos_to_last_merge=0.9041 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.9839014957448758, 'auprc': 0.9994588818594116, 'loss_val': 0.04728824142443623, 'psi': 0.9901244501906902}-{'f1_val': 0.9835800728454073, 'auprc': 0.9991547492818638, 'loss_val': 0.03967602182653495, 'psi': 0.9898099434199898}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.818920 cos_to_last_merge=0.9602 (last merge round=22)
[S4] round=73 local utility u=0.043038 metrics={'f1_val': 0.9546035728419946, 'auprc': 0.9585500601457744, 'loss_val': 0.2937418330936727, 'psi': 0.9561821677635065}-{'f1_val': 0.9528730813313322, 'auprc': 0.9388986542448687, 'loss_val': 0.3104814055612731, 'psi': 0.9472833104967469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=73 head_norm_before_train=1.783979 cos_to_last_merge=0.9753 (last merge round=21)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.6713757049526505, 'auprc': 0.8733820201880074, 'loss_val': 0.40421768673876995, 'psi': 0.7521782310467933}-{'f1_val': 0.8867315098711726, 'auprc': 0.9912831067334262, 'loss_val': 0.1438467745735051, 'psi': 0.928552148616074}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.781920 cos_to_last_merge=0.9527 (last merge round=20)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.61779132334208, 'auprc': 0.7948351347163406, 'loss_val': 1.2278462950247497, 'psi': 0.6886088478917842}-{'f1_val': 0.6323643062638552, 'auprc': 0.9104671465007035, 'loss_val': 1.0411428482719363, 'psi': 0.7436054423585945}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=2.049872 cos_to_last_merge=0.9481 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=73 local utility u=0.339448 metrics={'f1_val': 0.8439870924183445, 'auprc': 0.9486028383537559, 'loss_val': 0.3986005100783747, 'psi': 0.885833390792509}-{'f1_val': 0.7824857672361446, 'auprc': 0.894613466434931, 'loss_val': 0.5465212430125832, 'psi': 0.8273368469156592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=73 head_norm_before_train=1.933283 cos_to_last_merge=0.9598 (last merge round=16)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9822245623330763, 'auprc': 0.9989480975689092, 'loss_val': 0.05644667051744878, 'psi': 0.9889139764274095}-{'f1_val': 0.9930990485370332, 'auprc': 0.985562107132427, 'loss_val': 0.0378254661086927, 'psi': 0.9900842719751908}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.873358 cos_to_last_merge=0.9657 (last merge round=23)
[S9] round=73 local utility u=0.001299 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988062366190448, 'loss_val': 0.017908097115280835, 'psi': 0.9977842421549036}-{'f1_val': 0.9966924912647621, 'auprc': 0.9988052996456651, 'loss_val': 0.018041741260876463, 'psi': 0.9975376146171233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=73 head_norm_before_train=2.247583 (no previous merge yet)
[S10] round=73 local utility u=0.001722 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944776939410979, 'loss_val': 0.04909541301397206, 'psi': 0.994490791772383}-{'f1_val': 0.9944995236599065, 'auprc': 0.9943433331041724, 'loss_val': 0.052135654907968086, 'psi': 0.9944370474376127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=73 head_norm_before_train=2.280463 (no previous merge yet)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9983870424222863, 'loss_val': 0.028096988242139125, 'psi': 0.9972975658361892}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990204236305128, 'loss_val': 0.019577993698731845, 'psi': 0.9973006542986523}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.726298 cos_to_last_merge=0.8905 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=73 local utility u=0.439534 metrics={'f1_val': 0.7033342332256193, 'auprc': 0.71403971804112, 'loss_val': 1.0657669596553923, 'psi': 0.7076164271518195}-{'f1_val': 0.6122798930064954, 'auprc': 0.6664276689527941, 'loss_val': 1.2556732446965997, 'psi': 0.633939003385015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=73 head_norm_before_train=1.819215 cos_to_last_merge=0.9396 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9988360608401259, 'loss_val': 0.021871962638348785, 'psi': 0.9978732289245591}-{'f1_val': 0.9972340657469505, 'auprc': 0.9988865804338201, 'loss_val': 0.02182601733413595, 'psi': 0.9978950716216983}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.143473 cos_to_last_merge=0.7941 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9228120573364997, 'auprc': 0.9972573883146534, 'loss_val': 0.13970393724702593, 'psi': 0.9525901897277612}-{'f1_val': 0.9311641934997591, 'auprc': 0.9973066659730736, 'loss_val': 0.11557320547409389, 'psi': 0.9576211824890849}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.942061 cos_to_last_merge=0.8926 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=73 local utility u=0.000656 metrics={'f1_val': 0.992074503211585, 'auprc': 0.9983834363034381, 'loss_val': 0.03759325329651901, 'psi': 0.9945980764483262}-{'f1_val': 0.9918755575684484, 'auprc': 0.9983960298802472, 'loss_val': 0.037750173813675486, 'psi': 0.994483746493168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=73 head_norm_before_train=2.129598 (no previous merge yet)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.7003354739313831, 'auprc': 0.9361616304875046, 'loss_val': 1.1912241360343043, 'psi': 0.7946659365538317}-{'f1_val': 0.8119088668497234, 'auprc': 0.9606891564592183, 'loss_val': 0.6010829796974534, 'psi': 0.8714209826935213}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.056839 cos_to_last_merge=0.7804 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=74 local utility u=0.028074 metrics={'f1_val': 0.7086500354432845, 'auprc': 0.9906953628476316, 'loss_val': 0.659687713463194, 'psi': 0.8214681664050234}-{'f1_val': 0.8028155620809845, 'auprc': 0.7492859794584417, 'loss_val': 0.556601378335634, 'psi': 0.7814037290319673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=74 head_norm_before_train=2.165546 cos_to_last_merge=0.9040 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9998717658418055, 'loss_val': 0.14817548542075656, 'psi': 0.9765937575763944}-{'f1_val': 0.9839014957448758, 'auprc': 0.9994588818594116, 'loss_val': 0.04728824142443623, 'psi': 0.9901244501906902}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.822349 cos_to_last_merge=0.9600 (last merge round=22)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9468580415856621, 'auprc': 0.9358976993345868, 'loss_val': 0.30626344383743487, 'psi': 0.942473904685232}-{'f1_val': 0.9546035728419946, 'auprc': 0.9585500601457744, 'loss_val': 0.2937418330936727, 'psi': 0.9561821677635065}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.791883 cos_to_last_merge=0.9750 (last merge round=21)
[S5] round=74 local utility u=0.143396 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9015016397455413, 'loss_val': 0.37597087318114747, 'psi': 0.7808448017267775}-{'f1_val': 0.6713757049526505, 'auprc': 0.8733820201880074, 'loss_val': 0.40421768673876995, 'psi': 0.7521782310467933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=74 head_norm_before_train=1.782605 cos_to_last_merge=0.9519 (last merge round=20)
[S6] round=74 local utility u=1.000000 metrics={'f1_val': 0.8868744674589819, 'auprc': 0.9654958789339568, 'loss_val': 0.22865480108043731, 'psi': 0.9183230320489718}-{'f1_val': 0.61779132334208, 'auprc': 0.7948351347163406, 'loss_val': 1.2278462950247497, 'psi': 0.6886088478917842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=74 head_norm_before_train=2.059028 cos_to_last_merge=0.9472 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6436286181384726, 'auprc': 0.9549579609381773, 'loss_val': 1.260455255479193, 'psi': 0.7681603552583545}-{'f1_val': 0.8439870924183445, 'auprc': 0.9486028383537559, 'loss_val': 0.3986005100783747, 'psi': 0.885833390792509}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.937924 cos_to_last_merge=0.9596 (last merge round=16)
[S8] round=74 local utility u=0.034871 metrics={'f1_val': 0.9907666479363691, 'auprc': 0.9987467251548825, 'loss_val': 0.03735277786357696, 'psi': 0.9939586788237745}-{'f1_val': 0.9822245623330763, 'auprc': 0.9989480975689092, 'loss_val': 0.05644667051744878, 'psi': 0.9889139764274095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=74 head_norm_before_train=1.877761 cos_to_last_merge=0.9654 (last merge round=23)
[S9] round=74 local utility u=0.000205 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988154919657057, 'loss_val': 0.017526158645593357, 'psi': 0.997787944293568}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988062366190448, 'loss_val': 0.017908097115280835, 'psi': 0.9977842421549036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=74 head_norm_before_train=2.249740 (no previous merge yet)
[S10] round=74 local utility u=0.000185 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9945221489044587, 'loss_val': 0.04885963560323181, 'psi': 0.9945085737577273}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944776939410979, 'loss_val': 0.04909541301397206, 'psi': 0.994490791772383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=74 head_norm_before_train=2.284324 (no previous merge yet)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9953694973449114, 'auprc': 0.9983433938339584, 'loss_val': 0.036872662200024026, 'psi': 0.9965590559405302}-{'f1_val': 0.9965712481121245, 'auprc': 0.9983870424222863, 'loss_val': 0.028096988242139125, 'psi': 0.9972975658361892}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.730415 cos_to_last_merge=0.8900 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.890
[S13] round=74 local utility u=0.298981 metrics={'f1_val': 0.7584920228121834, 'auprc': 0.7493394462584344, 'loss_val': 0.9046512174244175, 'psi': 0.7548309921906838}-{'f1_val': 0.7033342332256193, 'auprc': 0.71403971804112, 'loss_val': 1.0657669596553923, 'psi': 0.7076164271518195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=74 head_norm_before_train=1.822909 cos_to_last_merge=0.9391 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.996748294078148, 'auprc': 0.9966981659316102, 'loss_val': 0.02497426561904288, 'psi': 0.996728242819533}-{'f1_val': 0.997231340980848, 'auprc': 0.9988360608401259, 'loss_val': 0.021871962638348785, 'psi': 0.9978732289245591}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.148309 cos_to_last_merge=0.7938 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=74 local utility u=0.008371 metrics={'f1_val': 0.9243975981634922, 'auprc': 0.9972939063970382, 'loss_val': 0.13258377898813717, 'psi': 0.9535561214569106}-{'f1_val': 0.9228120573364997, 'auprc': 0.9972573883146534, 'loss_val': 0.13970393724702593, 'psi': 0.9525901897277612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=74 head_norm_before_train=1.946764 cos_to_last_merge=0.8921 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.892
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9918554892289619, 'auprc': 0.9945295237192417, 'loss_val': 0.038977916654355134, 'psi': 0.9929251030250739}-{'f1_val': 0.992074503211585, 'auprc': 0.9983834363034381, 'loss_val': 0.03759325329651901, 'psi': 0.9945980764483262}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.134854 (no previous merge yet)
[S17] round=74 local utility u=0.311893 metrics={'f1_val': 0.7675154703243185, 'auprc': 0.9535281793583295, 'loss_val': 1.0226169732668544, 'psi': 0.8419205539379229}-{'f1_val': 0.7003354739313831, 'auprc': 0.9361616304875046, 'loss_val': 1.1912241360343043, 'psi': 0.7946659365538317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=75 head_norm_before_train=2.061402 cos_to_last_merge=0.7800 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=75 local utility u=0.245596 metrics={'f1_val': 0.7664302709945261, 'auprc': 0.9915423435373658, 'loss_val': 0.5177185275275847, 'psi': 0.8564751000116619}-{'f1_val': 0.7086500354432845, 'auprc': 0.9906953628476316, 'loss_val': 0.659687713463194, 'psi': 0.8214681664050234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=75 head_norm_before_train=2.162453 cos_to_last_merge=0.9040 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9316474107643319, 'auprc': 0.9951299424349033, 'loss_val': 0.2332960402958688, 'psi': 0.9570404234325605}-{'f1_val': 0.9610750853994537, 'auprc': 0.9998717658418055, 'loss_val': 0.14817548542075656, 'psi': 0.9765937575763944}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.828834 cos_to_last_merge=0.9597 (last merge round=22)
[S4] round=75 local utility u=0.082963 metrics={'f1_val': 0.9527970568858821, 'auprc': 0.9748897865900867, 'loss_val': 0.2929468235685619, 'psi': 0.961634148767564}-{'f1_val': 0.9468580415856621, 'auprc': 0.9358976993345868, 'loss_val': 0.30626344383743487, 'psi': 0.942473904685232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=75 head_norm_before_train=1.801428 cos_to_last_merge=0.9743 (last merge round=21)
[S5] round=75 local utility u=0.274367 metrics={'f1_val': 0.7396320492551484, 'auprc': 0.986173129323062, 'loss_val': 0.3166029309469804, 'psi': 0.8382484812823139}-{'f1_val': 0.7004069097142683, 'auprc': 0.9015016397455413, 'loss_val': 0.37597087318114747, 'psi': 0.7808448017267775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=75 head_norm_before_train=1.785215 cos_to_last_merge=0.9515 (last merge round=20)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.8377510814308695, 'auprc': 0.9601523859375718, 'loss_val': 0.458705687541963, 'psi': 0.8867116032335505}-{'f1_val': 0.8868744674589819, 'auprc': 0.9654958789339568, 'loss_val': 0.22865480108043731, 'psi': 0.9183230320489718}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=2.066062 cos_to_last_merge=0.9470 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.9701880060160875, 'auprc': 0.9898554520208944, 'loss_val': 0.10925753376837673, 'psi': 0.9780549844180102}-{'f1_val': 0.6436286181384726, 'auprc': 0.9549579609381773, 'loss_val': 1.260455255479193, 'psi': 0.7681603552583545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=75 head_norm_before_train=1.942379 cos_to_last_merge=0.9594 (last merge round=16)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9854220453767792, 'loss_val': 0.042615659975296226, 'psi': 0.9902488804758351}-{'f1_val': 0.9907666479363691, 'auprc': 0.9987467251548825, 'loss_val': 0.03735277786357696, 'psi': 0.9939586788237745}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=1.883789 cos_to_last_merge=0.9650 (last merge round=23)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988086798353202, 'loss_val': 0.017726215303566502, 'psi': 0.9977852194414137}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988154919657057, 'loss_val': 0.017526158645593357, 'psi': 0.997787944293568}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.252436 (no previous merge yet)
[S10] round=75 local utility u=0.000215 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9947281246871253, 'loss_val': 0.049048106014591676, 'psi': 0.994590964070794}-{'f1_val': 0.9944995236599065, 'auprc': 0.9945221489044587, 'loss_val': 0.04885963560323181, 'psi': 0.9945085737577273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=75 head_norm_before_train=2.288877 (no previous merge yet)
[S11] round=75 local utility u=0.012027 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987602041346837, 'loss_val': 0.018776374586980664, 'psi': 0.9971965665003207}-{'f1_val': 0.9953694973449114, 'auprc': 0.9983433938339584, 'loss_val': 0.036872662200024026, 'psi': 0.9965590559405302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=75 head_norm_before_train=1.737102 cos_to_last_merge=0.8890 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6158451453638161, 'auprc': 0.6687603393982199, 'loss_val': 1.2502300359538905, 'psi': 0.6370112229775775}-{'f1_val': 0.7584920228121834, 'auprc': 0.7493394462584344, 'loss_val': 0.9046512174244175, 'psi': 0.7548309921906838}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=1.827048 cos_to_last_merge=0.9385 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.996748294078148, 'auprc': 0.9953303818359179, 'loss_val': 0.024883047789141476, 'psi': 0.996181129181256}-{'f1_val': 0.996748294078148, 'auprc': 0.9966981659316102, 'loss_val': 0.02497426561904288, 'psi': 0.996728242819533}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.153015 cos_to_last_merge=0.7934 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=75 local utility u=0.068090 metrics={'f1_val': 0.9412618979763847, 'auprc': 0.9974203486354198, 'loss_val': 0.09796810967912296, 'psi': 0.9637252782399988}-{'f1_val': 0.9243975981634922, 'auprc': 0.9972939063970382, 'loss_val': 0.13258377898813717, 'psi': 0.9535561214569106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=75 head_norm_before_train=1.950941 cos_to_last_merge=0.8919 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.892
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9420345783428381, 'auprc': 0.976352849605788, 'loss_val': 0.35495302307990745, 'psi': 0.955761886848018}-{'f1_val': 0.9918554892289619, 'auprc': 0.9945295237192417, 'loss_val': 0.038977916654355134, 'psi': 0.9929251030250739}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=2.143652 (no previous merge yet)
[S17] round=75 local utility u=0.130456 metrics={'f1_val': 0.7781840702313501, 'auprc': 0.9605199972781788, 'loss_val': 0.8466920420063285, 'psi': 0.8511184410500816}-{'f1_val': 0.7675154703243185, 'auprc': 0.9535281793583295, 'loss_val': 1.0226169732668544, 'psi': 0.8419205539379229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=76 head_norm_before_train=2.066798 cos_to_last_merge=0.7795 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7273645645635012, 'auprc': 0.990079575588792, 'loss_val': 0.5288920061082473, 'psi': 0.8324505689736175}-{'f1_val': 0.7664302709945261, 'auprc': 0.9915423435373658, 'loss_val': 0.5177185275275847, 'psi': 0.8564751000116619}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.162290 cos_to_last_merge=0.9040 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8514381628010559, 'auprc': 0.9836481987603664, 'loss_val': 0.36754692160353175, 'psi': 0.90432217718478}-{'f1_val': 0.9316474107643319, 'auprc': 0.9951299424349033, 'loss_val': 0.2332960402958688, 'psi': 0.9570404234325605}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.834785 cos_to_last_merge=0.9595 (last merge round=22)
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9504771284545506, 'auprc': 0.9366158949029554, 'loss_val': 0.3061282380285244, 'psi': 0.9449326350339124}-{'f1_val': 0.9527970568858821, 'auprc': 0.9748897865900867, 'loss_val': 0.2929468235685619, 'psi': 0.961634148767564}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.810576 cos_to_last_merge=0.9730 (last merge round=21)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8066668316326393, 'loss_val': 0.4834173136173757, 'psi': 0.7428590917478711}-{'f1_val': 0.7396320492551484, 'auprc': 0.986173129323062, 'loss_val': 0.3166029309469804, 'psi': 0.8382484812823139}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.790627 cos_to_last_merge=0.9510 (last merge round=20)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.6048350132855652, 'auprc': 0.6625586381550639, 'loss_val': 1.4816274811248094, 'psi': 0.6279244632333647}-{'f1_val': 0.8377510814308695, 'auprc': 0.9601523859375718, 'loss_val': 0.458705687541963, 'psi': 0.8867116032335505}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=2.079352 cos_to_last_merge=0.9462 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.9326139824313695, 'auprc': 0.9857730237047058, 'loss_val': 0.23672372955746654, 'psi': 0.953877598940704}-{'f1_val': 0.9701880060160875, 'auprc': 0.9898554520208944, 'loss_val': 0.10925753376837673, 'psi': 0.9780549844180102}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.947417 cos_to_last_merge=0.9591 (last merge round=16)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9706410948880866, 'auprc': 0.9981271537921483, 'loss_val': 0.07738404232976628, 'psi': 0.9816355184497112}-{'f1_val': 0.9934667705418724, 'auprc': 0.9854220453767792, 'loss_val': 0.042615659975296226, 'psi': 0.9902488804758351}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=1.890087 cos_to_last_merge=0.9646 (last merge round=23)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988167528886575, 'loss_val': 0.018467925078887303, 'psi': 0.9975230082437978}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988086798353202, 'loss_val': 0.017726215303566502, 'psi': 0.9977852194414137}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.256756 (no previous merge yet)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944304616741343, 'loss_val': 0.05047206524285051, 'psi': 0.9944718988655976}-{'f1_val': 0.9944995236599065, 'auprc': 0.9947281246871253, 'loss_val': 0.049048106014591676, 'psi': 0.994590964070794}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.293925 (no previous merge yet)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990079624091878, 'loss_val': 0.02032389195117444, 'psi': 0.9972956698101223}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987602041346837, 'loss_val': 0.018776374586980664, 'psi': 0.9971965665003207}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=1.745577 cos_to_last_merge=0.8878 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=76 local utility u=0.650794 metrics={'f1_val': 0.7548870156057735, 'auprc': 0.7390657576142796, 'loss_val': 0.9938087254659911, 'psi': 0.748558512409176}-{'f1_val': 0.6158451453638161, 'auprc': 0.6687603393982199, 'loss_val': 1.2502300359538905, 'psi': 0.6370112229775775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=76 head_norm_before_train=1.831384 cos_to_last_merge=0.9382 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=76 local utility u=0.000535 metrics={'f1_val': 0.996748294078148, 'auprc': 0.9952773319866433, 'loss_val': 0.023653802845162226, 'psi': 0.9961599092415461}-{'f1_val': 0.996748294078148, 'auprc': 0.9953303818359179, 'loss_val': 0.024883047789141476, 'psi': 0.996181129181256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=76 head_norm_before_train=2.157656 cos_to_last_merge=0.7931 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=76 local utility u=0.096445 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9975926950361775, 'loss_val': 0.05923038526454493, 'psi': 0.9791576765863677}-{'f1_val': 0.9412618979763847, 'auprc': 0.9974203486354198, 'loss_val': 0.09796810967912296, 'psi': 0.9637252782399988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=76 head_norm_before_train=1.955559 cos_to_last_merge=0.8914 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9020412987817108, 'auprc': 0.8795617965993622, 'loss_val': 0.5754119910709191, 'psi': 0.8930494979087713}-{'f1_val': 0.9420345783428381, 'auprc': 0.976352849605788, 'loss_val': 0.35495302307990745, 'psi': 0.955761886848018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.149010 (no previous merge yet)
[S17] round=76 local utility u=0.597766 metrics={'f1_val': 0.8862107621677171, 'auprc': 0.9772719056060573, 'loss_val': 0.34957627213211556, 'psi': 0.9226352195430532}-{'f1_val': 0.7781840702313501, 'auprc': 0.9605199972781788, 'loss_val': 0.8466920420063285, 'psi': 0.8511184410500816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=77 head_norm_before_train=2.070880 cos_to_last_merge=0.7789 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=77 local utility u=0.056711 metrics={'f1_val': 0.7651971299553504, 'auprc': 0.9405391969392873, 'loss_val': 0.4938444367144065, 'psi': 0.8353339567489251}-{'f1_val': 0.7273645645635012, 'auprc': 0.990079575588792, 'loss_val': 0.5288920061082473, 'psi': 0.8324505689736175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=77 head_norm_before_train=2.162568 cos_to_last_merge=0.9042 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=77 local utility u=0.417293 metrics={'f1_val': 0.9595400699656497, 'auprc': 0.9876229035941022, 'loss_val': 0.19349642714360243, 'psi': 0.9707732034170307}-{'f1_val': 0.8514381628010559, 'auprc': 0.9836481987603664, 'loss_val': 0.36754692160353175, 'psi': 0.90432217718478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=77 head_norm_before_train=1.838211 cos_to_last_merge=0.9591 (last merge round=22)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9507721816696869, 'auprc': 0.9364714575999977, 'loss_val': 0.3120573833339361, 'psi': 0.9450518920418112}-{'f1_val': 0.9504771284545506, 'auprc': 0.9366158949029554, 'loss_val': 0.3061282380285244, 'psi': 0.9449326350339124}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.818547 cos_to_last_merge=0.9721 (last merge round=21)
[S5] round=77 local utility u=0.196895 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9220514435762333, 'loss_val': 0.43629886415958996, 'psi': 0.7890647232590544}-{'f1_val': 0.700320598491359, 'auprc': 0.8066668316326393, 'loss_val': 0.4834173136173757, 'psi': 0.7428590917478711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=77 head_norm_before_train=1.796581 cos_to_last_merge=0.9506 (last merge round=20)
[S6] round=77 local utility u=1.000000 metrics={'f1_val': 0.851718197068743, 'auprc': 0.9573784973600062, 'loss_val': 0.3237694214526109, 'psi': 0.8939823171852483}-{'f1_val': 0.6048350132855652, 'auprc': 0.6625586381550639, 'loss_val': 1.4816274811248094, 'psi': 0.6279244632333647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=77 head_norm_before_train=2.089432 cos_to_last_merge=0.9454 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.8869792889433428, 'auprc': 0.9724711229530616, 'loss_val': 0.42292264283784137, 'psi': 0.9211760225472303}-{'f1_val': 0.9326139824313695, 'auprc': 0.9857730237047058, 'loss_val': 0.23672372955746654, 'psi': 0.953877598940704}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.948229 cos_to_last_merge=0.9588 (last merge round=16)
[S8] round=77 local utility u=0.085979 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.998259726082623, 'loss_val': 0.03521957425217088, 'psi': 0.994628046391734}-{'f1_val': 0.9706410948880866, 'auprc': 0.9981271537921483, 'loss_val': 0.07738404232976628, 'psi': 0.9816355184497112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=77 head_norm_before_train=1.891496 cos_to_last_merge=0.9645 (last merge round=23)
[S9] round=77 local utility u=0.000190 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988104759985499, 'loss_val': 0.018069281742855596, 'psi': 0.9975204974877548}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988167528886575, 'loss_val': 0.018467925078887303, 'psi': 0.9975230082437978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=77 head_norm_before_train=2.261929 (no previous merge yet)
[S10] round=77 local utility u=0.000319 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944666323146807, 'loss_val': 0.049943434846389925, 'psi': 0.994486367121816}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944304616741343, 'loss_val': 0.05047206524285051, 'psi': 0.9944718988655976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=77 head_norm_before_train=2.299650 (no previous merge yet)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9865580991094289, 'auprc': 0.9981828332143334, 'loss_val': 0.06889652775430377, 'psi': 0.9912079927513908}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990079624091878, 'loss_val': 0.02032389195117444, 'psi': 0.9972956698101223}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.751022 cos_to_last_merge=0.8871 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6637895331107903, 'auprc': 0.7053885348758124, 'loss_val': 1.1083681073839364, 'psi': 0.6804291338167991}-{'f1_val': 0.7548870156057735, 'auprc': 0.7390657576142796, 'loss_val': 0.9938087254659911, 'psi': 0.748558512409176}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=1.837736 cos_to_last_merge=0.9378 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=77 local utility u=0.006753 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9988374990388045, 'loss_val': 0.022148557598466366, 'psi': 0.9977159257899884}-{'f1_val': 0.996748294078148, 'auprc': 0.9952773319866433, 'loss_val': 0.023653802845162226, 'psi': 0.9961599092415461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=77 head_norm_before_train=2.162408 cos_to_last_merge=0.7927 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=77 local utility u=0.045317 metrics={'f1_val': 0.9788928787035713, 'auprc': 0.9977005091715475, 'loss_val': 0.04107083082214951, 'psi': 0.9864159308907618}-{'f1_val': 0.9668676642864944, 'auprc': 0.9975926950361775, 'loss_val': 0.05923038526454493, 'psi': 0.9791576765863677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=77 head_norm_before_train=1.957157 cos_to_last_merge=0.8913 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=77 local utility u=0.706183 metrics={'f1_val': 0.9920251888873803, 'auprc': 0.9913581673847253, 'loss_val': 0.038339080655783904, 'psi': 0.9917583802863184}-{'f1_val': 0.9020412987817108, 'auprc': 0.8795617965993622, 'loss_val': 0.5754119910709191, 'psi': 0.8930494979087713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=77 head_norm_before_train=2.153837 (no previous merge yet)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8167183932908892, 'auprc': 0.9705840641568978, 'loss_val': 0.7641725934989247, 'psi': 0.8782646616372927}-{'f1_val': 0.8862107621677171, 'auprc': 0.9772719056060573, 'loss_val': 0.34957627213211556, 'psi': 0.9226352195430532}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.074778 cos_to_last_merge=0.7783 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7105472260835031, 'auprc': 0.942098659883602, 'loss_val': 0.6044442041977635, 'psi': 0.8031677996035427}-{'f1_val': 0.7651971299553504, 'auprc': 0.9405391969392873, 'loss_val': 0.4938444367144065, 'psi': 0.8353339567489251}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.163460 cos_to_last_merge=0.9043 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=78 local utility u=0.140160 metrics={'f1_val': 0.979287248495996, 'auprc': 0.996561744308636, 'loss_val': 0.05847515636121541, 'psi': 0.986197046821052}-{'f1_val': 0.9595400699656497, 'auprc': 0.9876229035941022, 'loss_val': 0.19349642714360243, 'psi': 0.9707732034170307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=78 head_norm_before_train=1.840453 cos_to_last_merge=0.9586 (last merge round=22)
[S4] round=78 local utility u=0.022327 metrics={'f1_val': 0.9516982481072386, 'auprc': 0.947365194968774, 'loss_val': 0.3056419341844749, 'psi': 0.9499650268518527}-{'f1_val': 0.9507721816696869, 'auprc': 0.9364714575999977, 'loss_val': 0.3120573833339361, 'psi': 0.9450518920418112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=78 head_norm_before_train=1.823772 cos_to_last_merge=0.9713 (last merge round=21)
[S5] round=78 local utility u=1.000000 metrics={'f1_val': 0.9961420887187077, 'auprc': 0.9957564215412502, 'loss_val': 0.0636001172540601, 'psi': 0.9959878218477247}-{'f1_val': 0.7004069097142683, 'auprc': 0.9220514435762333, 'loss_val': 0.43629886415958996, 'psi': 0.7890647232590544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=78 head_norm_before_train=1.799995 cos_to_last_merge=0.9504 (last merge round=20)
[S6] round=78 local utility u=0.555060 metrics={'f1_val': 0.987006070958112, 'auprc': 0.9740005652972338, 'loss_val': 0.07524337276692138, 'psi': 0.9818038686937607}-{'f1_val': 0.851718197068743, 'auprc': 0.9573784973600062, 'loss_val': 0.3237694214526109, 'psi': 0.8939823171852483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=78 head_norm_before_train=2.094520 cos_to_last_merge=0.9450 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.8370069070433515, 'auprc': 0.9669630793606715, 'loss_val': 0.7500412238969182, 'psi': 0.8889893759702795}-{'f1_val': 0.8869792889433428, 'auprc': 0.9724711229530616, 'loss_val': 0.42292264283784137, 'psi': 0.9211760225472303}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.950744 cos_to_last_merge=0.9587 (last merge round=16)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9876015268112659, 'loss_val': 0.03598386271807418, 'psi': 0.9911251059022347}-{'f1_val': 0.9922069265978078, 'auprc': 0.998259726082623, 'loss_val': 0.03521957425217088, 'psi': 0.994628046391734}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.895371 cos_to_last_merge=0.9643 (last merge round=23)
[S9] round=78 local utility u=0.001174 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998610451054177, 'loss_val': 0.017775354500888574, 'psi': 0.9977059279289565}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988104759985499, 'loss_val': 0.018069281742855596, 'psi': 0.9975204974877548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=78 head_norm_before_train=2.267523 (no previous merge yet)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944115712265247, 'loss_val': 0.05144296795926696, 'psi': 0.9944643426865537}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944666323146807, 'loss_val': 0.049943434846389925, 'psi': 0.994486367121816}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.298947 (no previous merge yet)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.8259781353309473, 'auprc': 0.9971595298879096, 'loss_val': 0.2770789998026676, 'psi': 0.8944506931537322}-{'f1_val': 0.9865580991094289, 'auprc': 0.9981828332143334, 'loss_val': 0.06889652775430377, 'psi': 0.9912079927513908}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.760489 cos_to_last_merge=0.8857 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=78 local utility u=0.000910 metrics={'f1_val': 0.6942487918340497, 'auprc': 0.6774706174496924, 'loss_val': 1.205550327215485, 'psi': 0.6875375220803068}-{'f1_val': 0.6637895331107903, 'auprc': 0.7053885348758124, 'loss_val': 1.1083681073839364, 'psi': 0.6804291338167991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=78 head_norm_before_train=1.844398 cos_to_last_merge=0.9373 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=78 local utility u=0.001688 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9988392689685005, 'loss_val': 0.022564349577696367, 'psi': 0.9980953777371802}-{'f1_val': 0.9969682102907778, 'auprc': 0.9988374990388045, 'loss_val': 0.022148557598466366, 'psi': 0.9977159257899884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=78 head_norm_before_train=2.167071 cos_to_last_merge=0.7924 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.792
[S15] round=78 local utility u=0.009391 metrics={'f1_val': 0.9815036917622131, 'auprc': 0.9977373493266151, 'loss_val': 0.03806511309598544, 'psi': 0.9879971547879739}-{'f1_val': 0.9788928787035713, 'auprc': 0.9977005091715475, 'loss_val': 0.04107083082214951, 'psi': 0.9864159308907618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=78 head_norm_before_train=1.958172 cos_to_last_merge=0.8912 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=78 local utility u=0.001320 metrics={'f1_val': 0.9897002729705668, 'auprc': 0.9979647328676019, 'loss_val': 0.04156867769287188, 'psi': 0.9930060569293808}-{'f1_val': 0.9920251888873803, 'auprc': 0.9913581673847253, 'loss_val': 0.038339080655783904, 'psi': 0.9917583802863184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=78 head_norm_before_train=2.157999 (no previous merge yet)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6795691179463326, 'auprc': 0.9392664586333686, 'loss_val': 1.28824137725744, 'psi': 0.783448054221147}-{'f1_val': 0.8167183932908892, 'auprc': 0.9705840641568978, 'loss_val': 0.7641725934989247, 'psi': 0.8782646616372927}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.075735 cos_to_last_merge=0.7779 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.5679804972767193, 'auprc': 0.7965174403293422, 'loss_val': 1.3676662489752747, 'psi': 0.6593952744977685}-{'f1_val': 0.7105472260835031, 'auprc': 0.942098659883602, 'loss_val': 0.6044442041977635, 'psi': 0.8031677996035427}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.659 u=0.0000 p_local=0.0681 f1=0.568 auprc=0.797 bytes=79293
[S3] START round=79 head_norm_before_train=2.168916 cos_to_last_merge=0.9042 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9999403157186858, 'loss_val': 0.143532872770225, 'psi': 0.9766211775271466}-{'f1_val': 0.979287248495996, 'auprc': 0.996561744308636, 'loss_val': 0.05847515636121541, 'psi': 0.986197046821052}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.977 u=0.0000 p_local=0.1011 f1=0.961 auprc=1.000 bytes=71964
[S4] START round=79 head_norm_before_train=1.847371 cos_to_last_merge=0.9582 (last merge round=22)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9516710546108692, 'auprc': 0.9411492419715335, 'loss_val': 0.3115535986401025, 'psi': 0.947462329555135}-{'f1_val': 0.9516982481072386, 'auprc': 0.947365194968774, 'loss_val': 0.3056419341844749, 'psi': 0.9499650268518527}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.947 u=0.0000 p_local=0.0160 f1=0.952 auprc=0.941 bytes=84500
[S5] START round=79 head_norm_before_train=1.829112 cos_to_last_merge=0.9708 (last merge round=21)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.6616704946167768, 'auprc': 0.9122013783269527, 'loss_val': 0.49983143380593953, 'psi': 0.7618828481008473}-{'f1_val': 0.9961420887187077, 'auprc': 0.9957564215412502, 'loss_val': 0.0636001172540601, 'psi': 0.9959878218477247}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.762 u=0.0000 p_local=0.2882 f1=0.662 auprc=0.912 bytes=73837
[S6] START round=79 head_norm_before_train=1.802398 cos_to_last_merge=0.9502 (last merge round=20)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.8016720010300818, 'auprc': 0.9354959624752609, 'loss_val': 0.5989111763688225, 'psi': 0.8552015856081534}-{'f1_val': 0.987006070958112, 'auprc': 0.9740005652972338, 'loss_val': 0.07524337276692138, 'psi': 0.9818038686937607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.855 u=0.0000 p_local=0.3497 f1=0.802 auprc=0.935 bytes=68358
[S7] START round=79 head_norm_before_train=2.103141 cos_to_last_merge=0.9440 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=79 local utility u=0.036407 metrics={'f1_val': 0.8147557149179744, 'auprc': 0.9411696262843392, 'loss_val': 0.4663403891013949, 'psi': 0.8653212794645203}-{'f1_val': 0.8370069070433515, 'auprc': 0.9669630793606715, 'loss_val': 0.7500412238969182, 'psi': 0.8889893759702795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=80 psi=0.865 u=0.0364 p_local=0.1617 f1=0.815 auprc=0.941 bytes=77317
[S8] START round=79 head_norm_before_train=1.956537 cos_to_last_merge=0.9582 (last merge round=16)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9677011925461891, 'auprc': 0.9966296238970713, 'loss_val': 0.09159751087271331, 'psi': 0.9792725650865419}-{'f1_val': 0.9934741586295472, 'auprc': 0.9876015268112659, 'loss_val': 0.03598386271807418, 'psi': 0.9911251059022347}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.979 u=0.0000 p_local=0.0279 f1=0.968 auprc=0.997 bytes=75522
[S9] START round=79 head_norm_before_train=1.900350 cos_to_last_merge=0.9640 (last merge round=23)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988130879327495, 'loss_val': 0.018109523559250808, 'psi': 0.9975215422614346}-{'f1_val': 0.9971029125121428, 'auprc': 0.998610451054177, 'loss_val': 0.017775354500888574, 'psi': 0.9977059279289565}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.998 u=0.0000 p_local=0.0008 f1=0.997 auprc=0.999 bytes=90068
[S10] START round=79 head_norm_before_train=2.273233 (no previous merge yet)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944130151937829, 'loss_val': 0.0532861500278948, 'psi': 0.994464920273457}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944115712265247, 'loss_val': 0.05144296795926696, 'psi': 0.9944643426865537}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.994 u=0.0000 p_local=0.0003 f1=0.994 auprc=0.994 bytes=88023
[S11] START round=79 head_norm_before_train=2.301202 (no previous merge yet)
[S11] round=79 local utility u=0.640742 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9986251774534873, 'loss_val': 0.022098618541602142, 'psi': 0.9972477172780092}-{'f1_val': 0.8259781353309473, 'auprc': 0.9971595298879096, 'loss_val': 0.2770789998026676, 'psi': 0.8944506931537322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] r=80 psi=0.997 u=0.6407 p_local=0.1335 f1=0.996 auprc=0.999 bytes=86345
[S13] START round=79 head_norm_before_train=1.770195 cos_to_last_merge=0.8844 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6393915216893995, 'auprc': 0.6847231056379488, 'loss_val': 1.122751207578477, 'psi': 0.6575241552688191}-{'f1_val': 0.6942487918340497, 'auprc': 0.6774706174496924, 'loss_val': 1.205550327215485, 'psi': 0.6875375220803068}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.658 u=0.0000 p_local=0.1416 f1=0.639 auprc=0.685 bytes=79221
[S14] START round=79 head_norm_before_train=1.848900 cos_to_last_merge=0.9367 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9988011473892474, 'loss_val': 0.022412882643409834, 'psi': 0.9978592635442077}-{'f1_val': 0.9975994502496334, 'auprc': 0.9988392689685005, 'loss_val': 0.022564349577696367, 'psi': 0.9980953777371802}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0023 f1=0.997 auprc=0.999 bytes=86378
[S15] START round=79 head_norm_before_train=2.171597 cos_to_last_merge=0.7921 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.792
[S15] round=79 local utility u=0.000125 metrics={'f1_val': 0.9815036917622131, 'auprc': 0.997744505787955, 'loss_val': 0.037836744548199304, 'psi': 0.9880000173725099}-{'f1_val': 0.9815036917622131, 'auprc': 0.9977373493266151, 'loss_val': 0.03806511309598544, 'psi': 0.9879971547879739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=80 psi=0.988 u=0.0001 p_local=0.0268 f1=0.982 auprc=0.998 bytes=80871
[S16] START round=79 head_norm_before_train=1.961385 cos_to_last_merge=0.8907 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.99190242253695, 'auprc': 0.9847791072292308, 'loss_val': 0.04198695575668794, 'psi': 0.9890530964138623}-{'f1_val': 0.9897002729705668, 'auprc': 0.9979647328676019, 'loss_val': 0.04156867769287188, 'psi': 0.9930060569293808}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.989 u=0.0000 p_local=0.1185 f1=0.992 auprc=0.985 bytes=75623
[S17] START round=79 head_norm_before_train=2.163464 (no previous merge yet)
[S17] round=79 local utility u=0.685093 metrics={'f1_val': 0.7897408320392167, 'auprc': 0.968334019395626, 'loss_val': 0.666289342231171, 'psi': 0.8611781069817804}-{'f1_val': 0.6795691179463326, 'auprc': 0.9392664586333686, 'loss_val': 1.28824137725744, 'psi': 0.783448054221147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S17] r=80 psi=0.861 u=0.6851 p_local=0.2702 f1=0.790 auprc=0.968 bytes=77343
[S2] START round=80 head_norm_before_train=2.078595 cos_to_last_merge=0.7775 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=80 local utility u=0.400097 metrics={'f1_val': 0.6885266788558275, 'auprc': 0.7229318008631871, 'loss_val': 1.069992751778882, 'psi': 0.7022887276587714}-{'f1_val': 0.5679804972767193, 'auprc': 0.7965174403293422, 'loss_val': 1.3676662489752747, 'psi': 0.6593952744977685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=80 head_norm_before_train=2.175638 cos_to_last_merge=0.9041 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8493394554997328, 'auprc': 0.9866393805542342, 'loss_val': 0.33549173916948916, 'psi': 0.9042594255215334}-{'f1_val': 0.9610750853994537, 'auprc': 0.9999403157186858, 'loss_val': 0.143532872770225, 'psi': 0.9766211775271466}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.853014 cos_to_last_merge=0.9579 (last merge round=22)
[S4] round=80 local utility u=0.004295 metrics={'f1_val': 0.9512609959541651, 'auprc': 0.944346462750842, 'loss_val': 0.3100947977580575, 'psi': 0.9484951826728358}-{'f1_val': 0.9516710546108692, 'auprc': 0.9411492419715335, 'loss_val': 0.3115535986401025, 'psi': 0.947462329555135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=80 head_norm_before_train=1.833442 cos_to_last_merge=0.9705 (last merge round=21)
[S5] round=80 local utility u=1.000000 metrics={'f1_val': 0.9398321284870088, 'auprc': 0.9931501776959015, 'loss_val': 0.10517701210484512, 'psi': 0.9611593481705658}-{'f1_val': 0.6616704946167768, 'auprc': 0.9122013783269527, 'loss_val': 0.49983143380593953, 'psi': 0.7618828481008473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=80 head_norm_before_train=1.808357 cos_to_last_merge=0.9499 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.7317602468076543, 'auprc': 0.8868591835485419, 'loss_val': 0.9094548340872471, 'psi': 0.7937998215040093}-{'f1_val': 0.8016720010300818, 'auprc': 0.9354959624752609, 'loss_val': 0.5989111763688225, 'psi': 0.8552015856081534}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=2.105277 cos_to_last_merge=0.9426 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.7160615594769503, 'auprc': 0.9854536054815205, 'loss_val': 1.0156838069880791, 'psi': 0.8238183778787784}-{'f1_val': 0.8147557149179744, 'auprc': 0.9411696262843392, 'loss_val': 0.4663403891013949, 'psi': 0.8653212794645203}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=1.958656 cos_to_last_merge=0.9578 (last merge round=16)
[S8] round=80 local utility u=0.097239 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.9990586301893705, 'loss_val': 0.03846868886851302, 'psi': 0.9936504260652436}-{'f1_val': 0.9677011925461891, 'auprc': 0.9966296238970713, 'loss_val': 0.09159751087271331, 'psi': 0.9792725650865419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=80 head_norm_before_train=1.904130 cos_to_last_merge=0.9638 (last merge round=23)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988141475075215, 'loss_val': 0.017854472462700624, 'psi': 0.9973717704033411}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988130879327495, 'loss_val': 0.018109523559250808, 'psi': 0.9975215422614346}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.275252 (no previous merge yet)
[S10] round=80 local utility u=0.001335 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9944829956232157, 'loss_val': 0.05082580586566421, 'psi': 0.9944929124452302}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944130151937829, 'loss_val': 0.0532861500278948, 'psi': 0.994464920273457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=80 head_norm_before_train=2.305861 (no previous merge yet)
[S11] round=80 local utility u=0.001987 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988214227367851, 'loss_val': 0.017660978306938177, 'psi': 0.9972210539411612}-{'f1_val': 0.9963294104943571, 'auprc': 0.9986251774534873, 'loss_val': 0.022098618541602142, 'psi': 0.9972477172780092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=80 head_norm_before_train=1.777623 cos_to_last_merge=0.8834 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=80 local utility u=0.065797 metrics={'f1_val': 0.6643317772655741, 'auprc': 0.6799884952959792, 'loss_val': 1.12659510110477, 'psi': 0.6705944644777362}-{'f1_val': 0.6393915216893995, 'auprc': 0.6847231056379488, 'loss_val': 1.122751207578477, 'psi': 0.6575241552688191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=80 head_norm_before_train=1.852713 cos_to_last_merge=0.9363 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=80 local utility u=0.000778 metrics={'f1_val': 0.997231340980848, 'auprc': 0.9988402660598317, 'loss_val': 0.020974287677997184, 'psi': 0.9978749110124414}-{'f1_val': 0.997231340980848, 'auprc': 0.9988011473892474, 'loss_val': 0.022412882643409834, 'psi': 0.9978592635442077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=80 head_norm_before_train=2.176046 cos_to_last_merge=0.7917 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.792
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9659579114815917, 'auprc': 0.997580709222988, 'loss_val': 0.06095085483262337, 'psi': 0.9786070305781502}-{'f1_val': 0.9815036917622131, 'auprc': 0.997744505787955, 'loss_val': 0.037836744548199304, 'psi': 0.9880000173725099}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.965634 cos_to_last_merge=0.8902 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.890
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9919319555880118, 'auprc': 0.9823020105816784, 'loss_val': 0.04340200902123239, 'psi': 0.9880799775854785}-{'f1_val': 0.99190242253695, 'auprc': 0.9847791072292308, 'loss_val': 0.04198695575668794, 'psi': 0.9890530964138623}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.168893 (no previous merge yet)
[S17] round=80 local utility u=0.398517 metrics={'f1_val': 0.8791072168977311, 'auprc': 0.9804193907137678, 'loss_val': 0.4417103040336282, 'psi': 0.9196320864241457}-{'f1_val': 0.7897408320392167, 'auprc': 0.968334019395626, 'loss_val': 0.666289342231171, 'psi': 0.8611781069817804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=81 head_norm_before_train=2.079371 cos_to_last_merge=0.7770 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=81 local utility u=0.696744 metrics={'f1_val': 0.7098586196571611, 'auprc': 0.9896785331264328, 'loss_val': 0.6047372724677695, 'psi': 0.8217865850448698}-{'f1_val': 0.6885266788558275, 'auprc': 0.7229318008631871, 'loss_val': 1.069992751778882, 'psi': 0.7022887276587714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=81 head_norm_before_train=2.181701 cos_to_last_merge=0.9036 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=81 local utility u=0.349247 metrics={'f1_val': 0.9512059985307558, 'auprc': 0.9779431366858862, 'loss_val': 0.22210867985935417, 'psi': 0.961900853792808}-{'f1_val': 0.8493394554997328, 'auprc': 0.9866393805542342, 'loss_val': 0.33549173916948916, 'psi': 0.9042594255215334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=81 head_norm_before_train=1.857843 cos_to_last_merge=0.9572 (last merge round=22)
[S4] round=81 local utility u=0.014508 metrics={'f1_val': 0.9516709207464931, 'auprc': 0.952280976351843, 'loss_val': 0.307342492900076, 'psi': 0.951914942988633}-{'f1_val': 0.9512609959541651, 'auprc': 0.944346462750842, 'loss_val': 0.3100947977580575, 'psi': 0.9484951826728358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=81 head_norm_before_train=1.835318 cos_to_last_merge=0.9699 (last merge round=21)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.7311268923569703, 'auprc': 0.9892553814545961, 'loss_val': 0.3263833624010977, 'psi': 0.8343782879960207}-{'f1_val': 0.9398321284870088, 'auprc': 0.9931501776959015, 'loss_val': 0.10517701210484512, 'psi': 0.9611593481705658}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.815644 cos_to_last_merge=0.9498 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=81 local utility u=0.571863 metrics={'f1_val': 0.8004512952431515, 'auprc': 0.9631367822018553, 'loss_val': 0.40670739780833165, 'psi': 0.865525490026633}-{'f1_val': 0.7317602468076543, 'auprc': 0.8868591835485419, 'loss_val': 0.9094548340872471, 'psi': 0.7937998215040093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=81 head_norm_before_train=2.108729 cos_to_last_merge=0.9418 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=81 local utility u=0.582371 metrics={'f1_val': 0.858001674993625, 'auprc': 0.9827305166690378, 'loss_val': 0.694413185187306, 'psi': 0.9078932116637901}-{'f1_val': 0.7160615594769503, 'auprc': 0.9854536054815205, 'loss_val': 1.0156838069880791, 'psi': 0.8238183778787784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=81 head_norm_before_train=1.959979 cos_to_last_merge=0.9578 (last merge round=16)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.987213710175836, 'loss_val': 0.03719863457336579, 'psi': 0.9907449131925543}-{'f1_val': 0.9900449566491589, 'auprc': 0.9990586301893705, 'loss_val': 0.03846868886851302, 'psi': 0.9936504260652436}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=1.909285 cos_to_last_merge=0.9635 (last merge round=23)
[S9] round=81 local utility u=0.002209 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988115692874113, 'loss_val': 0.017584489463040028, 'psi': 0.9977863752222502}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988141475075215, 'loss_val': 0.017854472462700624, 'psi': 0.9973717704033411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=81 head_norm_before_train=2.277731 (no previous merge yet)
[S10] round=81 local utility u=0.001106 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9947794019500198, 'loss_val': 0.04950399991530823, 'psi': 0.9946114749759518}-{'f1_val': 0.9944995236599065, 'auprc': 0.9944829956232157, 'loss_val': 0.05082580586566421, 'psi': 0.9944929124452302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=81 head_norm_before_train=2.310623 (no previous merge yet)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.8236101647960599, 'auprc': 0.9968446074229738, 'loss_val': 0.38621001997911325, 'psi': 0.8929039418468254}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988214227367851, 'loss_val': 0.017660978306938177, 'psi': 0.9972210539411612}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.782413 cos_to_last_merge=0.8828 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6398127340591315, 'auprc': 0.7271166550882222, 'loss_val': 1.1717498920335638, 'psi': 0.6747343024707678}-{'f1_val': 0.6643317772655741, 'auprc': 0.6799884952959792, 'loss_val': 1.12659510110477, 'psi': 0.6705944644777362}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.857558 cos_to_last_merge=0.9361 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9988398998916457, 'loss_val': 0.020001948074002348, 'psi': 0.997716886131125}-{'f1_val': 0.997231340980848, 'auprc': 0.9988402660598317, 'loss_val': 0.020974287677997184, 'psi': 0.9978749110124414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.180461 cos_to_last_merge=0.7914 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9212172399746946, 'auprc': 0.9973072295018106, 'loss_val': 0.15201703143095874, 'psi': 0.9516532357855411}-{'f1_val': 0.9659579114815917, 'auprc': 0.997580709222988, 'loss_val': 0.06095085483262337, 'psi': 0.9786070305781502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.970640 cos_to_last_merge=0.8896 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.890
[S16] round=81 local utility u=0.021039 metrics={'f1_val': 0.9936851625653845, 'auprc': 0.9888156738843992, 'loss_val': 0.03138512834840283, 'psi': 0.9917373670929904}-{'f1_val': 0.9919319555880118, 'auprc': 0.9823020105816784, 'loss_val': 0.04340200902123239, 'psi': 0.9880799775854785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=81 head_norm_before_train=2.176460 (no previous merge yet)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.8632068561007449, 'auprc': 0.9811376112135857, 'loss_val': 0.605564018853485, 'psi': 0.9103791581458811}-{'f1_val': 0.8791072168977311, 'auprc': 0.9804193907137678, 'loss_val': 0.4417103040336282, 'psi': 0.9196320864241457}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.079998 cos_to_last_merge=0.7766 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=82 local utility u=0.005319 metrics={'f1_val': 0.7193267924419439, 'auprc': 0.9436427751372243, 'loss_val': 0.5128012246041606, 'psi': 0.809053185520056}-{'f1_val': 0.7098586196571611, 'auprc': 0.9896785331264328, 'loss_val': 0.6047372724677695, 'psi': 0.8217865850448698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=82 head_norm_before_train=2.190918 cos_to_last_merge=0.9030 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.8731750346839862, 'auprc': 0.9982242536880527, 'loss_val': 0.26729471697612917, 'psi': 0.9231947222856127}-{'f1_val': 0.9512059985307558, 'auprc': 0.9779431366858862, 'loss_val': 0.22210867985935417, 'psi': 0.961900853792808}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.863622 cos_to_last_merge=0.9562 (last merge round=22)
[S4] round=82 local utility u=0.023349 metrics={'f1_val': 0.9545942612384807, 'auprc': 0.9635320265408552, 'loss_val': 0.31193731368256916, 'psi': 0.9581693673594305}-{'f1_val': 0.9516709207464931, 'auprc': 0.952280976351843, 'loss_val': 0.307342492900076, 'psi': 0.951914942988633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=82 head_norm_before_train=1.845085 cos_to_last_merge=0.9680 (last merge round=21)
[S5] round=82 local utility u=0.582898 metrics={'f1_val': 0.895775947060661, 'auprc': 0.9928162882226864, 'loss_val': 0.15916481781941666, 'psi': 0.9345920835254712}-{'f1_val': 0.7311268923569703, 'auprc': 0.9892553814545961, 'loss_val': 0.3263833624010977, 'psi': 0.8343782879960207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=82 head_norm_before_train=1.821922 cos_to_last_merge=0.9496 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=82 local utility u=0.133335 metrics={'f1_val': 0.8424460607170485, 'auprc': 0.9748782945574823, 'loss_val': 0.42722966587686595, 'psi': 0.895418954253222}-{'f1_val': 0.8004512952431515, 'auprc': 0.9631367822018553, 'loss_val': 0.40670739780833165, 'psi': 0.865525490026633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=82 head_norm_before_train=2.119476 cos_to_last_merge=0.9409 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.8499114157721959, 'auprc': 0.9739570324398957, 'loss_val': 0.7205828484554166, 'psi': 0.8995296624392758}-{'f1_val': 0.858001674993625, 'auprc': 0.9827305166690378, 'loss_val': 0.694413185187306, 'psi': 0.9078932116637901}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.962805 cos_to_last_merge=0.9579 (last merge round=16)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9838460548583284, 'auprc': 0.9989931112249086, 'loss_val': 0.05435455050212752, 'psi': 0.9899048774049605}-{'f1_val': 0.9930990485370332, 'auprc': 0.987213710175836, 'loss_val': 0.03719863457336579, 'psi': 0.9907449131925543}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=1.911894 cos_to_last_merge=0.9633 (last merge round=23)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.998821161412116, 'loss_val': 0.020017470798308738, 'psi': 0.9968742998953553}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988115692874113, 'loss_val': 0.017584489463040028, 'psi': 0.9977863752222502}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.281733 (no previous merge yet)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.994525715430552, 'loss_val': 0.05220628382242832, 'psi': 0.9945100003681646}-{'f1_val': 0.9944995236599065, 'auprc': 0.9947794019500198, 'loss_val': 0.04950399991530823, 'psi': 0.9946114749759518}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.315277 (no previous merge yet)
[S11] round=82 local utility u=0.696648 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9983429311188186, 'loss_val': 0.033724278638763816, 'psi': 0.9971348187441417}-{'f1_val': 0.8236101647960599, 'auprc': 0.9968446074229738, 'loss_val': 0.38621001997911325, 'psi': 0.8929039418468254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=82 head_norm_before_train=1.788121 cos_to_last_merge=0.8820 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6221897738477143, 'auprc': 0.6372454177374308, 'loss_val': 1.3087631311388768, 'psi': 0.6282120314036009}-{'f1_val': 0.6398127340591315, 'auprc': 0.7271166550882222, 'loss_val': 1.1717498920335638, 'psi': 0.6747343024707678}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.863964 cos_to_last_merge=0.9357 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9988393821894694, 'loss_val': 0.019856816596082367, 'psi': 0.9974702226389851}-{'f1_val': 0.9969682102907778, 'auprc': 0.9988398998916457, 'loss_val': 0.020001948074002348, 'psi': 0.997716886131125}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.184858 cos_to_last_merge=0.7911 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9060084171951897, 'auprc': 0.9971874187605816, 'loss_val': 0.20961384896003407, 'psi': 0.9424800178213465}-{'f1_val': 0.9212172399746946, 'auprc': 0.9973072295018106, 'loss_val': 0.15201703143095874, 'psi': 0.9516532357855411}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.976002 cos_to_last_merge=0.8889 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.889
[S16] round=82 local utility u=0.004340 metrics={'f1_val': 0.9932187487813045, 'auprc': 0.9925792919968746, 'loss_val': 0.031196583501564668, 'psi': 0.9929629660675324}-{'f1_val': 0.9936851625653845, 'auprc': 0.9888156738843992, 'loss_val': 0.03138512834840283, 'psi': 0.9917373670929904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=82 head_norm_before_train=2.184433 (no previous merge yet)
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.8456965373751324, 'auprc': 0.9646435683764798, 'loss_val': 0.8676596616125568, 'psi': 0.8932753497756714}-{'f1_val': 0.8632068561007449, 'auprc': 0.9811376112135857, 'loss_val': 0.605564018853485, 'psi': 0.9103791581458811}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.082932 cos_to_last_merge=0.7761 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=83 local utility u=0.061255 metrics={'f1_val': 0.7181569708339559, 'auprc': 0.9827629827003975, 'loss_val': 0.500632344598305, 'psi': 0.8239993755805326}-{'f1_val': 0.7193267924419439, 'auprc': 0.9436427751372243, 'loss_val': 0.5128012246041606, 'psi': 0.809053185520056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=83 head_norm_before_train=2.195884 cos_to_last_merge=0.9030 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=83 local utility u=0.065369 metrics={'f1_val': 0.891331541243903, 'auprc': 0.9978186932146145, 'loss_val': 0.24427864321821402, 'psi': 0.9339264020321876}-{'f1_val': 0.8731750346839862, 'auprc': 0.9982242536880527, 'loss_val': 0.26729471697612917, 'psi': 0.9231947222856127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=83 head_norm_before_train=1.867702 cos_to_last_merge=0.9558 (last merge round=22)
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9539901074255258, 'auprc': 0.9577957323217805, 'loss_val': 0.31125891097356967, 'psi': 0.9555123573840277}-{'f1_val': 0.9545942612384807, 'auprc': 0.9635320265408552, 'loss_val': 0.31193731368256916, 'psi': 0.9581693673594305}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=1.853641 cos_to_last_merge=0.9664 (last merge round=21)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.7909902216543994, 'auprc': 0.9865594570889119, 'loss_val': 0.2774077977330315, 'psi': 0.8692179158282043}-{'f1_val': 0.895775947060661, 'auprc': 0.9928162882226864, 'loss_val': 0.15916481781941666, 'psi': 0.9345920835254712}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.828995 cos_to_last_merge=0.9493 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7977458986123852, 'auprc': 0.9745188941336209, 'loss_val': 0.4266338764839365, 'psi': 0.8684550968208795}-{'f1_val': 0.8424460607170485, 'auprc': 0.9748782945574823, 'loss_val': 0.42722966587686595, 'psi': 0.895418954253222}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=2.133344 cos_to_last_merge=0.9397 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.8313098411369689, 'auprc': 0.9552353544927205, 'loss_val': 0.9144835463170917, 'psi': 0.8808800464792695}-{'f1_val': 0.8499114157721959, 'auprc': 0.9739570324398957, 'loss_val': 0.7205828484554166, 'psi': 0.8995296624392758}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.963847 cos_to_last_merge=0.9579 (last merge round=16)
[S8] round=83 local utility u=0.010466 metrics={'f1_val': 0.9861132963230042, 'auprc': 0.998953328474534, 'loss_val': 0.04690682066175581, 'psi': 0.9912493091836161}-{'f1_val': 0.9838460548583284, 'auprc': 0.9989931112249086, 'loss_val': 0.05435455050212752, 'psi': 0.9899048774049605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=83 head_norm_before_train=1.915718 cos_to_last_merge=0.9630 (last merge round=23)
[S9] round=83 local utility u=0.004301 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988057971615726, 'loss_val': 0.01787331934574981, 'psi': 0.9975186259529639}-{'f1_val': 0.9955763922175147, 'auprc': 0.998821161412116, 'loss_val': 0.020017470798308738, 'psi': 0.9968742998953553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=83 head_norm_before_train=2.282389 (no previous merge yet)
[S10] round=83 local utility u=0.001962 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9949374593845453, 'loss_val': 0.04951722707705429, 'psi': 0.9946746979497619}-{'f1_val': 0.9944995236599065, 'auprc': 0.994525715430552, 'loss_val': 0.05220628382242832, 'psi': 0.9945100003681646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=83 head_norm_before_train=2.320275 (no previous merge yet)
[S11] round=83 local utility u=0.009150 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.998716195134503, 'loss_val': 0.017995001168564922, 'psi': 0.9974292269210759}-{'f1_val': 0.9963294104943571, 'auprc': 0.9983429311188186, 'loss_val': 0.033724278638763816, 'psi': 0.9971348187441417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=83 head_norm_before_train=1.792741 cos_to_last_merge=0.8815 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=83 local utility u=0.357659 metrics={'f1_val': 0.7011350084082145, 'auprc': 0.6777070126839431, 'loss_val': 1.1885003922884918, 'psi': 0.691763810118506}-{'f1_val': 0.6221897738477143, 'auprc': 0.6372454177374308, 'loss_val': 1.3087631311388768, 'psi': 0.6282120314036009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=83 head_norm_before_train=1.870284 cos_to_last_merge=0.9353 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=83 local utility u=0.002015 metrics={'f1_val': 0.9976425894463408, 'auprc': 0.9988397677518154, 'loss_val': 0.022339222819746714, 'psi': 0.9981214607685306}-{'f1_val': 0.9965574496053289, 'auprc': 0.9988393821894694, 'loss_val': 0.019856816596082367, 'psi': 0.9974702226389851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=83 head_norm_before_train=2.189126 cos_to_last_merge=0.7908 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9971489136241499, 'loss_val': 0.23044469905487905, 'psi': 0.9397311114507836}-{'f1_val': 0.9060084171951897, 'auprc': 0.9971874187605816, 'loss_val': 0.20961384896003407, 'psi': 0.9424800178213465}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.981687 cos_to_last_merge=0.8882 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.888
[S16] round=83 local utility u=0.000348 metrics={'f1_val': 0.9932187487813045, 'auprc': 0.9925887746529393, 'loss_val': 0.030529755568950507, 'psi': 0.9929667591299584}-{'f1_val': 0.9932187487813045, 'auprc': 0.9925792919968746, 'loss_val': 0.031196583501564668, 'psi': 0.9929629660675324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=83 head_norm_before_train=2.192588 (no previous merge yet)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8304714292230347, 'auprc': 0.9448949760128664, 'loss_val': 0.9978895673437042, 'psi': 0.8762408479389674}-{'f1_val': 0.8456965373751324, 'auprc': 0.9646435683764798, 'loss_val': 0.8676596616125568, 'psi': 0.8932753497756714}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.084537 cos_to_last_merge=0.7755 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=84 local utility u=0.139255 metrics={'f1_val': 0.7826959309259776, 'auprc': 0.9327384400796327, 'loss_val': 0.45928254830068543, 'psi': 0.8427129345874396}-{'f1_val': 0.7181569708339559, 'auprc': 0.9827629827003975, 'loss_val': 0.500632344598305, 'psi': 0.8239993755805326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=84 head_norm_before_train=2.203124 cos_to_last_merge=0.9027 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7726178566936562, 'auprc': 0.9690828068993825, 'loss_val': 0.5904927008553511, 'psi': 0.8512038367759467}-{'f1_val': 0.891331541243903, 'auprc': 0.9978186932146145, 'loss_val': 0.24427864321821402, 'psi': 0.9339264020321876}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.872172 cos_to_last_merge=0.9553 (last merge round=22)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9487513919101218, 'auprc': 0.93143550050617, 'loss_val': 0.312167357021906, 'psi': 0.9418250353485411}-{'f1_val': 0.9539901074255258, 'auprc': 0.9577957323217805, 'loss_val': 0.31125891097356967, 'psi': 0.9555123573840277}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.864838 cos_to_last_merge=0.9643 (last merge round=21)
[S5] round=84 local utility u=0.733034 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9901038229556322, 'loss_val': 0.05227738527658381, 'psi': 0.993666195686576}-{'f1_val': 0.7909902216543994, 'auprc': 0.9865594570889119, 'loss_val': 0.2774077977330315, 'psi': 0.8692179158282043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=84 head_norm_before_train=1.834248 cos_to_last_merge=0.9488 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.6537277480639758, 'auprc': 0.8727356979504813, 'loss_val': 0.9085914548150799, 'psi': 0.741330928018578}-{'f1_val': 0.7977458986123852, 'auprc': 0.9745188941336209, 'loss_val': 0.4266338764839365, 'psi': 0.8684550968208795}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=2.148329 cos_to_last_merge=0.9384 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=84 local utility u=0.007592 metrics={'f1_val': 0.8358599133917803, 'auprc': 0.9525987519929078, 'loss_val': 0.9186905093923319, 'psi': 0.8825554488322314}-{'f1_val': 0.8313098411369689, 'auprc': 0.9552353544927205, 'loss_val': 0.9144835463170917, 'psi': 0.8808800464792695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=84 head_norm_before_train=1.967203 cos_to_last_merge=0.9578 (last merge round=16)
[S8] round=84 local utility u=0.024013 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9975173549358827, 'loss_val': 0.03332085594044898, 'psi': 0.9945497096476383}-{'f1_val': 0.9861132963230042, 'auprc': 0.998953328474534, 'loss_val': 0.04690682066175581, 'psi': 0.9912493091836161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=84 head_norm_before_train=1.920151 cos_to_last_merge=0.9628 (last merge round=23)
[S9] round=84 local utility u=0.000274 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988168879878003, 'loss_val': 0.0173586277415733, 'psi': 0.997523062283455}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988057971615726, 'loss_val': 0.01787331934574981, 'psi': 0.9975186259529639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=84 head_norm_before_train=2.284990 (no previous merge yet)
[S10] round=84 local utility u=0.000647 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9950243912673351, 'loss_val': 0.0484837975132423, 'psi': 0.9947094707028779}-{'f1_val': 0.9944995236599065, 'auprc': 0.9949374593845453, 'loss_val': 0.04951722707705429, 'psi': 0.9946746979497619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=84 head_norm_before_train=2.324886 (no previous merge yet)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9877398710858983, 'auprc': 0.9983595984988207, 'loss_val': 0.06018094945127821, 'psi': 0.9919877620510673}-{'f1_val': 0.9965712481121245, 'auprc': 0.998716195134503, 'loss_val': 0.017995001168564922, 'psi': 0.9974292269210759}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.795154 cos_to_last_merge=0.8812 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6729240355347361, 'auprc': 0.6941895094183943, 'loss_val': 1.1727924882221972, 'psi': 0.6814302250881994}-{'f1_val': 0.7011350084082145, 'auprc': 0.6777070126839431, 'loss_val': 1.1885003922884918, 'psi': 0.691763810118506}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.873139 cos_to_last_merge=0.9347 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9504800356424404, 'auprc': 0.9988062484157387, 'loss_val': 0.08409977751262679, 'psi': 0.9698105207517598}-{'f1_val': 0.9976425894463408, 'auprc': 0.9988397677518154, 'loss_val': 0.022339222819746714, 'psi': 0.9981214607685306}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.193315 cos_to_last_merge=0.7905 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.900877565646653, 'auprc': 0.9971380943262887, 'loss_val': 0.23191081333855731, 'psi': 0.9393817771185073}-{'f1_val': 0.9014525766685394, 'auprc': 0.9971489136241499, 'loss_val': 0.23044469905487905, 'psi': 0.9397311114507836}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=1.987496 cos_to_last_merge=0.8874 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=84 local utility u=0.000975 metrics={'f1_val': 0.9934383988725008, 'auprc': 0.9926055023890243, 'loss_val': 0.02994769828785736, 'psi': 0.9931052402791103}-{'f1_val': 0.9932187487813045, 'auprc': 0.9925887746529393, 'loss_val': 0.030529755568950507, 'psi': 0.9929667591299584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=84 head_norm_before_train=2.201662 (no previous merge yet)
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.784490340570855, 'auprc': 0.9276104519098419, 'loss_val': 1.1502494250035573, 'psi': 0.8417383851064497}-{'f1_val': 0.8304714292230347, 'auprc': 0.9448949760128664, 'loss_val': 0.9978895673437042, 'psi': 0.8762408479389674}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.085630 cos_to_last_merge=0.7751 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7384685991449748, 'auprc': 0.9894974263627898, 'loss_val': 0.4820120006491084, 'psi': 0.8388801300321007}-{'f1_val': 0.7826959309259776, 'auprc': 0.9327384400796327, 'loss_val': 0.45928254830068543, 'psi': 0.8427129345874396}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.210285 cos_to_last_merge=0.9023 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=85 local utility u=0.130090 metrics={'f1_val': 0.7926161099028153, 'auprc': 0.9983107295685202, 'loss_val': 0.5379859526708385, 'psi': 0.8748939577690973}-{'f1_val': 0.7726178566936562, 'auprc': 0.9690828068993825, 'loss_val': 0.5904927008553511, 'psi': 0.8512038367759467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=85 head_norm_before_train=1.874139 cos_to_last_merge=0.9543 (last merge round=22)
[S4] round=85 local utility u=0.015907 metrics={'f1_val': 0.9499787974509166, 'auprc': 0.9377998412546467, 'loss_val': 0.30681125246023855, 'psi': 0.9451072149724087}-{'f1_val': 0.9487513919101218, 'auprc': 0.93143550050617, 'loss_val': 0.312167357021906, 'psi': 0.9418250353485411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=85 head_norm_before_train=1.877106 cos_to_last_merge=0.9623 (last merge round=21)
[S5] round=85 local utility u=0.017250 metrics={'f1_val': 0.9965549401573681, 'auprc': 0.994975023156942, 'loss_val': 0.03547308948501856, 'psi': 0.9959229733571977}-{'f1_val': 0.9960411108405385, 'auprc': 0.9901038229556322, 'loss_val': 0.05227738527658381, 'psi': 0.993666195686576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=85 head_norm_before_train=1.836586 cos_to_last_merge=0.9479 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=85 local utility u=0.631818 metrics={'f1_val': 0.7943723328684661, 'auprc': 0.9121259150706139, 'loss_val': 0.6069929009235557, 'psi': 0.8414737657493252}-{'f1_val': 0.6537277480639758, 'auprc': 0.8727356979504813, 'loss_val': 0.9085914548150799, 'psi': 0.741330928018578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=85 head_norm_before_train=2.162853 cos_to_last_merge=0.9372 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=85 local utility u=0.175954 metrics={'f1_val': 0.8562278052606729, 'auprc': 0.9757803340256324, 'loss_val': 0.7585352315082068, 'psi': 0.9040488167666567}-{'f1_val': 0.8358599133917803, 'auprc': 0.9525987519929078, 'loss_val': 0.9186905093923319, 'psi': 0.8825554488322314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=85 head_norm_before_train=1.971305 cos_to_last_merge=0.9577 (last merge round=16)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.8342890456538438, 'auprc': 0.9864109817452709, 'loss_val': 0.1583437270438204, 'psi': 0.8951378200904146}-{'f1_val': 0.9925712794554754, 'auprc': 0.9975173549358827, 'loss_val': 0.03332085594044898, 'psi': 0.9945497096476383}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=1.923685 cos_to_last_merge=0.9626 (last merge round=23)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988186394080131, 'loss_val': 0.017798905632212005, 'psi': 0.9975237628515401}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988168879878003, 'loss_val': 0.0173586277415733, 'psi': 0.997523062283455}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.289232 (no previous merge yet)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.994538712822219, 'loss_val': 0.05160141939600968, 'psi': 0.9945151993248313}-{'f1_val': 0.9944995236599065, 'auprc': 0.9950243912673351, 'loss_val': 0.0484837975132423, 'psi': 0.9947094707028779}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.329288 (no previous merge yet)
[S11] round=85 local utility u=0.046383 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990066001135939, 'loss_val': 0.019841902598708345, 'psi': 0.9972951248918848}-{'f1_val': 0.9877398710858983, 'auprc': 0.9983595984988207, 'loss_val': 0.06018094945127821, 'psi': 0.9919877620510673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=85 head_norm_before_train=1.801861 cos_to_last_merge=0.8801 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=85 local utility u=0.380022 metrics={'f1_val': 0.7438097727140963, 'auprc': 0.7566524535997492, 'loss_val': 1.0254511619242563, 'psi': 0.7489468450683575}-{'f1_val': 0.6729240355347361, 'auprc': 0.6941895094183943, 'loss_val': 1.1727924882221972, 'psi': 0.6814302250881994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=85 head_norm_before_train=1.875502 cos_to_last_merge=0.9341 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=85 local utility u=0.130938 metrics={'f1_val': 0.9868816328835236, 'auprc': 0.9988030852290162, 'loss_val': 0.04062291460736309, 'psi': 0.9916502138217207}-{'f1_val': 0.9504800356424404, 'auprc': 0.9988062484157387, 'loss_val': 0.08409977751262679, 'psi': 0.9698105207517598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=85 head_norm_before_train=2.197437 cos_to_last_merge=0.7902 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=85 local utility u=0.087869 metrics={'f1_val': 0.9179992482439876, 'auprc': 0.9973168690231432, 'loss_val': 0.1594394743447329, 'psi': 0.9497262965556498}-{'f1_val': 0.900877565646653, 'auprc': 0.9971380943262887, 'loss_val': 0.23191081333855731, 'psi': 0.9393817771185073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=85 head_norm_before_train=1.990133 cos_to_last_merge=0.8873 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9611479987806768, 'auprc': 0.9918174948413808, 'loss_val': 0.10137080006388914, 'psi': 0.9734157972049584}-{'f1_val': 0.9934383988725008, 'auprc': 0.9926055023890243, 'loss_val': 0.02994769828785736, 'psi': 0.9931052402791103}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.208106 (no previous merge yet)
[S17] round=85 local utility u=0.666619 metrics={'f1_val': 0.8799204761201809, 'auprc': 0.9860982223056762, 'loss_val': 0.5650547336497909, 'psi': 0.922391574594379}-{'f1_val': 0.784490340570855, 'auprc': 0.9276104519098419, 'loss_val': 1.1502494250035573, 'psi': 0.8417383851064497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=86 head_norm_before_train=2.089053 cos_to_last_merge=0.7746 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7086441048557771, 'auprc': 0.9283051856203759, 'loss_val': 0.6240787769351203, 'psi': 0.7965085371616166}-{'f1_val': 0.7384685991449748, 'auprc': 0.9894974263627898, 'loss_val': 0.4820120006491084, 'psi': 0.8388801300321007}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.217040 cos_to_last_merge=0.9020 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=86 local utility u=0.122798 metrics={'f1_val': 0.8191266727516022, 'auprc': 0.9957963256209328, 'loss_val': 0.443910072794796, 'psi': 0.8897945338993345}-{'f1_val': 0.7926161099028153, 'auprc': 0.9983107295685202, 'loss_val': 0.5379859526708385, 'psi': 0.8748939577690973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=86 head_norm_before_train=1.877221 cos_to_last_merge=0.9535 (last merge round=22)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.94798564586983, 'auprc': 0.9352787685272695, 'loss_val': 0.31114887545000774, 'psi': 0.9429028949328058}-{'f1_val': 0.9499787974509166, 'auprc': 0.9377998412546467, 'loss_val': 0.30681125246023855, 'psi': 0.9451072149724087}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.891383 cos_to_last_merge=0.9601 (last merge round=21)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.8014273624491958, 'auprc': 0.9870655854160475, 'loss_val': 0.2628573619946285, 'psi': 0.8756826516359365}-{'f1_val': 0.9965549401573681, 'auprc': 0.994975023156942, 'loss_val': 0.03547308948501856, 'psi': 0.9959229733571977}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.840296 cos_to_last_merge=0.9474 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=86 local utility u=0.427581 metrics={'f1_val': 0.8622739434554662, 'auprc': 0.963216986152537, 'loss_val': 0.3125140853259451, 'psi': 0.9026511605342944}-{'f1_val': 0.7943723328684661, 'auprc': 0.9121259150706139, 'loss_val': 0.6069929009235557, 'psi': 0.8414737657493252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=86 head_norm_before_train=2.174003 cos_to_last_merge=0.9364 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6490748533151933, 'auprc': 0.9612241344003886, 'loss_val': 1.3529485268688926, 'psi': 0.7739345657492713}-{'f1_val': 0.8562278052606729, 'auprc': 0.9757803340256324, 'loss_val': 0.7585352315082068, 'psi': 0.9040488167666567}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.973733 cos_to_last_merge=0.9573 (last merge round=16)
[S8] round=86 local utility u=0.446636 metrics={'f1_val': 0.966388667120204, 'auprc': 0.9992315945131703, 'loss_val': 0.09613110158069252, 'psi': 0.9795258380773906}-{'f1_val': 0.8342890456538438, 'auprc': 0.9864109817452709, 'loss_val': 0.1583437270438204, 'psi': 0.8951378200904146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=86 head_norm_before_train=1.928063 cos_to_last_merge=0.9623 (last merge round=23)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9964758477365845, 'loss_val': 0.018017345201831274, 'psi': 0.9966058338534911}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988186394080131, 'loss_val': 0.017798905632212005, 'psi': 0.9975237628515401}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.294262 (no previous merge yet)
[S10] round=86 local utility u=0.000314 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9945472859315266, 'loss_val': 0.05099867609231093, 'psi': 0.9945186285685546}-{'f1_val': 0.9944995236599065, 'auprc': 0.994538712822219, 'loss_val': 0.05160141939600968, 'psi': 0.9945151993248313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=86 head_norm_before_train=2.331923 (no previous merge yet)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998754133923244, 'loss_val': 0.01959202137326885, 'psi': 0.9971941384157448}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990066001135939, 'loss_val': 0.019841902598708345, 'psi': 0.9972951248918848}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.810000 cos_to_last_merge=0.8786 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6245531248145754, 'auprc': 0.6529695808595559, 'loss_val': 1.3506625913091832, 'psi': 0.6359197072325675}-{'f1_val': 0.7438097727140963, 'auprc': 0.7566524535997492, 'loss_val': 1.0254511619242563, 'psi': 0.7489468450683575}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.879072 cos_to_last_merge=0.9338 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=86 local utility u=0.035090 metrics={'f1_val': 0.9967506042112828, 'auprc': 0.9963947080212677, 'loss_val': 0.022431584357801394, 'psi': 0.9966082457352767}-{'f1_val': 0.9868816328835236, 'auprc': 0.9988030852290162, 'loss_val': 0.04062291460736309, 'psi': 0.9916502138217207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=86 head_norm_before_train=2.201537 cos_to_last_merge=0.7899 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=86 local utility u=0.084937 metrics={'f1_val': 0.9372665255493237, 'auprc': 0.9974716261502727, 'loss_val': 0.10563421777416877, 'psi': 0.9613485657897033}-{'f1_val': 0.9179992482439876, 'auprc': 0.9973168690231432, 'loss_val': 0.1594394743447329, 'psi': 0.9497262965556498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=86 head_norm_before_train=1.992485 cos_to_last_merge=0.8871 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9439416354705132, 'auprc': 0.991696522844183, 'loss_val': 0.13321090352183662, 'psi': 0.9630435904199812}-{'f1_val': 0.9611479987806768, 'auprc': 0.9918174948413808, 'loss_val': 0.10137080006388914, 'psi': 0.9734157972049584}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.211504 (no previous merge yet)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8363209718011388, 'auprc': 0.9743308611710105, 'loss_val': 0.8151592111123628, 'psi': 0.8915249275490875}-{'f1_val': 0.8799204761201809, 'auprc': 0.9860982223056762, 'loss_val': 0.5650547336497909, 'psi': 0.922391574594379}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.092293 cos_to_last_merge=0.7743 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=87 local utility u=0.408734 metrics={'f1_val': 0.8247406991858245, 'auprc': 0.9161519459369194, 'loss_val': 0.4667306062069393, 'psi': 0.8613051978862625}-{'f1_val': 0.7086441048557771, 'auprc': 0.9283051856203759, 'loss_val': 0.6240787769351203, 'psi': 0.7965085371616166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=87 head_norm_before_train=2.224765 cos_to_last_merge=0.9017 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=87 local utility u=0.376331 metrics={'f1_val': 0.9215028719502446, 'auprc': 0.9799833845398038, 'loss_val': 0.2580663487173458, 'psi': 0.9448950769860682}-{'f1_val': 0.8191266727516022, 'auprc': 0.9957963256209328, 'loss_val': 0.443910072794796, 'psi': 0.8897945338993345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=87 head_norm_before_train=1.881506 cos_to_last_merge=0.9529 (last merge round=22)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.948248104851522, 'auprc': 0.9278310962618906, 'loss_val': 0.31595891285739447, 'psi': 0.9400813014156695}-{'f1_val': 0.94798564586983, 'auprc': 0.9352787685272695, 'loss_val': 0.31114887545000774, 'psi': 0.9429028949328058}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.897072 cos_to_last_merge=0.9589 (last merge round=21)
[S5] round=87 local utility u=0.707083 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9938167423524119, 'loss_val': 0.03750214611188267, 'psi': 0.9952387646156924}-{'f1_val': 0.8014273624491958, 'auprc': 0.9870655854160475, 'loss_val': 0.2628573619946285, 'psi': 0.8756826516359365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=87 head_norm_before_train=1.846188 cos_to_last_merge=0.9469 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.6279873898581081, 'auprc': 0.6826680046855316, 'loss_val': 1.3446178334385062, 'psi': 0.6498596357890775}-{'f1_val': 0.8622739434554662, 'auprc': 0.963216986152537, 'loss_val': 0.3125140853259451, 'psi': 0.9026511605342944}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=2.182351 cos_to_last_merge=0.9358 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=87 local utility u=0.922887 metrics={'f1_val': 0.8550363458780366, 'auprc': 0.9685099836636661, 'loss_val': 0.764801624754606, 'psi': 0.9004258009922884}-{'f1_val': 0.6490748533151933, 'auprc': 0.9612241344003886, 'loss_val': 1.3529485268688926, 'psi': 0.7739345657492713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=87 head_norm_before_train=1.974962 cos_to_last_merge=0.9563 (last merge round=16)
[S8] round=87 local utility u=0.093814 metrics={'f1_val': 0.9887878044561169, 'auprc': 0.9991784457303047, 'loss_val': 0.04273896529393535, 'psi': 0.992944060965792}-{'f1_val': 0.966388667120204, 'auprc': 0.9992315945131703, 'loss_val': 0.09613110158069252, 'psi': 0.9795258380773906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=87 head_norm_before_train=1.932916 cos_to_last_merge=0.9620 (last merge round=23)
[S9] round=87 local utility u=0.002231 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988247655747021, 'loss_val': 0.018907641446733504, 'psi': 0.9973760176302133}-{'f1_val': 0.9966924912647621, 'auprc': 0.9964758477365845, 'loss_val': 0.018017345201831274, 'psi': 0.9966058338534911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=87 head_norm_before_train=2.299656 (no previous merge yet)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946013600975984, 'loss_val': 0.051914821925005177, 'psi': 0.9945402582349832}-{'f1_val': 0.9944995236599065, 'auprc': 0.9945472859315266, 'loss_val': 0.05099867609231093, 'psi': 0.9945186285685546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.331054 (no previous merge yet)
[S11] round=87 local utility u=0.000152 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986999942713035, 'loss_val': 0.019125601398779432, 'psi': 0.9971724825549686}-{'f1_val': 0.9961541414107454, 'auprc': 0.998754133923244, 'loss_val': 0.01959202137326885, 'psi': 0.9971941384157448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=87 head_norm_before_train=1.814903 cos_to_last_merge=0.8779 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=87 local utility u=0.432492 metrics={'f1_val': 0.7128110698490278, 'auprc': 0.6893794972985159, 'loss_val': 1.1244565543891503, 'psi': 0.703438440828823}-{'f1_val': 0.6245531248145754, 'auprc': 0.6529695808595559, 'loss_val': 1.3506625913091832, 'psi': 0.6359197072325675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=87 head_norm_before_train=1.884032 cos_to_last_merge=0.9335 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=87 local utility u=0.006150 metrics={'f1_val': 0.9972340657469505, 'auprc': 0.998836332910163, 'loss_val': 0.02035783923300013, 'psi': 0.9978749726122356}-{'f1_val': 0.9967506042112828, 'auprc': 0.9963947080212677, 'loss_val': 0.022431584357801394, 'psi': 0.9966082457352767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=87 head_norm_before_train=2.205596 cos_to_last_merge=0.7896 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=87 local utility u=0.071329 metrics={'f1_val': 0.9567050645070998, 'auprc': 0.9975529969614368, 'loss_val': 0.07985170741933845, 'psi': 0.9730442374888346}-{'f1_val': 0.9372665255493237, 'auprc': 0.9974716261502727, 'loss_val': 0.10563421777416877, 'psi': 0.9613485657897033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=87 head_norm_before_train=1.996445 cos_to_last_merge=0.8867 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=87 local utility u=0.188459 metrics={'f1_val': 0.9928105097221221, 'auprc': 0.9870006072762874, 'loss_val': 0.03541742834451105, 'psi': 0.9904865487437883}-{'f1_val': 0.9439416354705132, 'auprc': 0.991696522844183, 'loss_val': 0.13321090352183662, 'psi': 0.9630435904199812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=87 head_norm_before_train=2.214253 (no previous merge yet)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8087927034805201, 'auprc': 0.9718571393129783, 'loss_val': 0.8152497477816539, 'psi': 0.8740184778135034}-{'f1_val': 0.8363209718011388, 'auprc': 0.9743308611710105, 'loss_val': 0.8151592111123628, 'psi': 0.8915249275490875}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.096582 cos_to_last_merge=0.7738 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.6128995682236811, 'auprc': 0.8159862934616485, 'loss_val': 1.0824071922191127, 'psi': 0.6941342583188681}-{'f1_val': 0.8247406991858245, 'auprc': 0.9161519459369194, 'loss_val': 0.4667306062069393, 'psi': 0.8613051978862625}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.232600 cos_to_last_merge=0.9012 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.7060199077873784, 'auprc': 0.9822100721983666, 'loss_val': 0.835997170902552, 'psi': 0.8164959735517738}-{'f1_val': 0.9215028719502446, 'auprc': 0.9799833845398038, 'loss_val': 0.2580663487173458, 'psi': 0.9448950769860682}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.886416 cos_to_last_merge=0.9527 (last merge round=22)
[S4] round=88 local utility u=0.073987 metrics={'f1_val': 0.9554777247678417, 'auprc': 0.9585775945289206, 'loss_val': 0.3036018607429912, 'psi': 0.9567176726722733}-{'f1_val': 0.948248104851522, 'auprc': 0.9278310962618906, 'loss_val': 0.31595891285739447, 'psi': 0.9400813014156695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=88 head_norm_before_train=1.906838 cos_to_last_merge=0.9576 (last merge round=21)
[S5] round=88 local utility u=0.002742 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9945882846959494, 'loss_val': 0.03345938878606135, 'psi': 0.9954599803827029}-{'f1_val': 0.9961867794578795, 'auprc': 0.9938167423524119, 'loss_val': 0.03750214611188267, 'psi': 0.9952387646156924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=88 head_norm_before_train=1.850908 cos_to_last_merge=0.9466 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.8468756734733317, 'auprc': 0.9495730356927936, 'loss_val': 0.5756918308126987, 'psi': 0.8879546183611164}-{'f1_val': 0.6279873898581081, 'auprc': 0.6826680046855316, 'loss_val': 1.3446178334385062, 'psi': 0.6498596357890775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=88 head_norm_before_train=2.191015 cos_to_last_merge=0.9350 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=88 local utility u=0.140736 metrics={'f1_val': 0.848264769005325, 'auprc': 0.9557074325982382, 'loss_val': 0.4042919467503305, 'psi': 0.8912418344424904}-{'f1_val': 0.8550363458780366, 'auprc': 0.9685099836636661, 'loss_val': 0.764801624754606, 'psi': 0.9004258009922884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=88 head_norm_before_train=1.976046 cos_to_last_merge=0.9557 (last merge round=16)
[S8] round=88 local utility u=0.016325 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9991649503979165, 'loss_val': 0.03421768902201579, 'psi': 0.9953555243518684}-{'f1_val': 0.9887878044561169, 'auprc': 0.9991784457303047, 'loss_val': 0.04273896529393535, 'psi': 0.992944060965792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=88 head_norm_before_train=1.938244 cos_to_last_merge=0.9616 (last merge round=23)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988263480334396, 'loss_val': 0.01902882628355902, 'psi': 0.9973766506137084}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988247655747021, 'loss_val': 0.018907641446733504, 'psi': 0.9973760176302133}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.300629 (no previous merge yet)
[S10] round=88 local utility u=0.000596 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946487677918623, 'loss_val': 0.05086420803078975, 'psi': 0.9945592213126888}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946013600975984, 'loss_val': 0.051914821925005177, 'psi': 0.9945402582349832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=88 head_norm_before_train=2.333239 (no previous merge yet)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.8145057893093233, 'auprc': 0.9968379255070945, 'loss_val': 0.46085812460898173, 'psi': 0.8874386437884318}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986999942713035, 'loss_val': 0.019125601398779432, 'psi': 0.9971724825549686}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.819095 cos_to_last_merge=0.8771 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.7091959021263599, 'auprc': 0.6804628333577816, 'loss_val': 1.1684421985333144, 'psi': 0.6977026746189285}-{'f1_val': 0.7128110698490278, 'auprc': 0.6893794972985159, 'loss_val': 1.1244565543891503, 'psi': 0.703438440828823}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.888697 cos_to_last_merge=0.9330 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=88 local utility u=0.000322 metrics={'f1_val': 0.9972340657469505, 'auprc': 0.9988188184650091, 'loss_val': 0.019661257244420843, 'psi': 0.9978679668341739}-{'f1_val': 0.9972340657469505, 'auprc': 0.998836332910163, 'loss_val': 0.02035783923300013, 'psi': 0.9978749726122356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=88 head_norm_before_train=2.209602 cos_to_last_merge=0.7893 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.789
[S15] round=88 local utility u=0.019593 metrics={'f1_val': 0.961829667518989, 'auprc': 0.9975760205767541, 'loss_val': 0.07148238989373035, 'psi': 0.976128208742095}-{'f1_val': 0.9567050645070998, 'auprc': 0.9975529969614368, 'loss_val': 0.07985170741933845, 'psi': 0.9730442374888346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=88 head_norm_before_train=1.998364 cos_to_last_merge=0.8864 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9767326280971331, 'auprc': 0.984984267667711, 'loss_val': 0.0895869591152636, 'psi': 0.9800332839253643}-{'f1_val': 0.9928105097221221, 'auprc': 0.9870006072762874, 'loss_val': 0.03541742834451105, 'psi': 0.9904865487437883}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.217826 (no previous merge yet)
[S17] round=88 local utility u=0.338067 metrics={'f1_val': 0.8643605410158346, 'auprc': 0.9814263887450965, 'loss_val': 0.5012298309084272, 'psi': 0.9111868801075393}-{'f1_val': 0.8087927034805201, 'auprc': 0.9718571393129783, 'loss_val': 0.8152497477816539, 'psi': 0.8740184778135034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=89 head_norm_before_train=2.098908 cos_to_last_merge=0.7736 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=89 local utility u=0.767828 metrics={'f1_val': 0.7082122462096961, 'auprc': 0.9882084470580709, 'loss_val': 0.6352938166741271, 'psi': 0.8202107265490461}-{'f1_val': 0.6128995682236811, 'auprc': 0.8159862934616485, 'loss_val': 1.0824071922191127, 'psi': 0.6941342583188681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=89 head_norm_before_train=2.239011 cos_to_last_merge=0.9008 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=89 local utility u=1.000000 metrics={'f1_val': 0.9962390713303096, 'auprc': 0.9992463038218168, 'loss_val': 0.02325750844608744, 'psi': 0.9974419643269126}-{'f1_val': 0.7060199077873784, 'auprc': 0.9822100721983666, 'loss_val': 0.835997170902552, 'psi': 0.8164959735517738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=89 head_norm_before_train=1.893082 cos_to_last_merge=0.9524 (last merge round=22)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9527565266502263, 'auprc': 0.9401165937924685, 'loss_val': 0.3175306431598123, 'psi': 0.9477005535071231}-{'f1_val': 0.9554777247678417, 'auprc': 0.9585775945289206, 'loss_val': 0.3036018607429912, 'psi': 0.9567176726722733}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.915360 cos_to_last_merge=0.9564 (last merge round=21)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9905496398012027, 'loss_val': 0.040655120697379844, 'psi': 0.9940201430986151}-{'f1_val': 0.9960411108405385, 'auprc': 0.9945882846959494, 'loss_val': 0.03345938878606135, 'psi': 0.9954599803827029}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.853661 cos_to_last_merge=0.9464 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=89 local utility u=0.016037 metrics={'f1_val': 0.8455025419963291, 'auprc': 0.9581824594257293, 'loss_val': 0.561207766003101, 'psi': 0.8905745089680892}-{'f1_val': 0.8468756734733317, 'auprc': 0.9495730356927936, 'loss_val': 0.5756918308126987, 'psi': 0.8879546183611164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=89 head_norm_before_train=2.197860 cos_to_last_merge=0.9344 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.8519220839529793, 'auprc': 0.979629689690304, 'loss_val': 0.7663809468226419, 'psi': 0.9030051262479092}-{'f1_val': 0.848264769005325, 'auprc': 0.9557074325982382, 'loss_val': 0.4042919467503305, 'psi': 0.8912418344424904}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.977189 cos_to_last_merge=0.9560 (last merge round=16)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.992915672901943, 'loss_val': 0.036432549465490564, 'psi': 0.9932463314859007}-{'f1_val': 0.9928159069878363, 'auprc': 0.9991649503979165, 'loss_val': 0.03421768902201579, 'psi': 0.9953555243518684}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=1.944203 cos_to_last_merge=0.9613 (last merge round=23)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9938677072807713, 'loss_val': 0.019958975579141686, 'psi': 0.9954123814192345}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988263480334396, 'loss_val': 0.01902882628355902, 'psi': 0.9973766506137084}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.303951 (no previous merge yet)
[S10] round=89 local utility u=0.000395 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946513090837952, 'loss_val': 0.05008195433142251, 'psi': 0.9945602378294619}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946487677918623, 'loss_val': 0.05086420803078975, 'psi': 0.9945592213126888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=89 head_norm_before_train=2.336642 (no previous merge yet)
[S11] round=89 local utility u=0.745138 metrics={'f1_val': 0.9920338580844371, 'auprc': 0.9983615836737167, 'loss_val': 0.04032220591552322, 'psi': 0.9945649483201491}-{'f1_val': 0.8145057893093233, 'auprc': 0.9968379255070945, 'loss_val': 0.46085812460898173, 'psi': 0.8874386437884318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=89 head_norm_before_train=1.823520 cos_to_last_merge=0.8761 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6630413410436284, 'auprc': 0.6926914586775827, 'loss_val': 1.175252499089339, 'psi': 0.6749013880972101}-{'f1_val': 0.7091959021263599, 'auprc': 0.6804628333577816, 'loss_val': 1.1684421985333144, 'psi': 0.6977026746189285}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=1.891174 cos_to_last_merge=0.9327 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.998642838263454, 'loss_val': 0.023503522277042995, 'psi': 0.9973796539471619}-{'f1_val': 0.9972340657469505, 'auprc': 0.9988188184650091, 'loss_val': 0.019661257244420843, 'psi': 0.9978679668341739}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.213521 cos_to_last_merge=0.7890 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.789
[S15] round=89 local utility u=0.011263 metrics={'f1_val': 0.9645881246318284, 'auprc': 0.9975954818571783, 'loss_val': 0.06556634635390322, 'psi': 0.9777910675219683}-{'f1_val': 0.961829667518989, 'auprc': 0.9975760205767541, 'loss_val': 0.07148238989373035, 'psi': 0.976128208742095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=89 head_norm_before_train=2.001819 cos_to_last_merge=0.8860 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=89 local utility u=0.043952 metrics={'f1_val': 0.9851619055599483, 'auprc': 0.9882435279823604, 'loss_val': 0.06203725466589223, 'psi': 0.9863945545289131}-{'f1_val': 0.9767326280971331, 'auprc': 0.984984267667711, 'loss_val': 0.0895869591152636, 'psi': 0.9800332839253643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=89 head_norm_before_train=2.222017 (no previous merge yet)
[S17] round=89 local utility u=0.017058 metrics={'f1_val': 0.879278477428183, 'auprc': 0.9823552990287041, 'loss_val': 0.5594073143462475, 'psi': 0.9205092060683915}-{'f1_val': 0.8643605410158346, 'auprc': 0.9814263887450965, 'loss_val': 0.5012298309084272, 'psi': 0.9111868801075393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=90 head_norm_before_train=2.102854 cos_to_last_merge=0.7733 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=90 local utility u=0.400891 metrics={'f1_val': 0.8271583747647345, 'auprc': 0.9598758583683393, 'loss_val': 0.46219105327128474, 'psi': 0.8802453682061764}-{'f1_val': 0.7082122462096961, 'auprc': 0.9882084470580709, 'loss_val': 0.6352938166741271, 'psi': 0.8202107265490461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=90 head_norm_before_train=2.245764 cos_to_last_merge=0.9005 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8160645151405139, 'auprc': 0.9700433857816648, 'loss_val': 0.4810178228885201, 'psi': 0.8776560633969743}-{'f1_val': 0.9962390713303096, 'auprc': 0.9992463038218168, 'loss_val': 0.02325750844608744, 'psi': 0.9974419643269126}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.899819 cos_to_last_merge=0.9522 (last merge round=22)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9500509465313974, 'auprc': 0.9370807283648002, 'loss_val': 0.3193016583595942, 'psi': 0.9448628592647585}-{'f1_val': 0.9527565266502263, 'auprc': 0.9401165937924685, 'loss_val': 0.3175306431598123, 'psi': 0.9477005535071231}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.915483 cos_to_last_merge=0.9559 (last merge round=21)
[S5] round=90 local utility u=0.016663 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9970972789105859, 'loss_val': 0.02918002433728599, 'psi': 0.9968600926513089}-{'f1_val': 0.9963338119635569, 'auprc': 0.9905496398012027, 'loss_val': 0.040655120697379844, 'psi': 0.9940201430986151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=90 head_norm_before_train=1.856396 cos_to_last_merge=0.9462 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.6194267443298753, 'auprc': 0.7421816644324913, 'loss_val': 1.2170043172225236, 'psi': 0.6685287123709217}-{'f1_val': 0.8455025419963291, 'auprc': 0.9581824594257293, 'loss_val': 0.561207766003101, 'psi': 0.8905745089680892}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=2.202343 cos_to_last_merge=0.9340 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5337279773914616, 'auprc': 0.6473771221997981, 'loss_val': 1.9342036741530158, 'psi': 0.5791876353147962}-{'f1_val': 0.8519220839529793, 'auprc': 0.979629689690304, 'loss_val': 0.7663809468226419, 'psi': 0.9030051262479092}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=1.980132 cos_to_last_merge=0.9564 (last merge round=16)
[S8] round=90 local utility u=0.005738 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9990554229328394, 'loss_val': 0.035873139404647765, 'psi': 0.9949520615785499}-{'f1_val': 0.9934667705418724, 'auprc': 0.992915672901943, 'loss_val': 0.036432549465490564, 'psi': 0.9932463314859007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=90 head_norm_before_train=1.950769 cos_to_last_merge=0.9609 (last merge round=23)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9988262955231435, 'loss_val': 0.022613404748201553, 'psi': 0.9961268312168219}-{'f1_val': 0.99644216417821, 'auprc': 0.9938677072807713, 'loss_val': 0.019958975579141686, 'psi': 0.9954123814192345}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.308488 (no previous merge yet)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9945981461132899, 'loss_val': 0.05131010804148701, 'psi': 0.9945389726412598}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946513090837952, 'loss_val': 0.05008195433142251, 'psi': 0.9945602378294619}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.341520 (no previous merge yet)
[S11] round=90 local utility u=0.023692 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.999013008574182, 'loss_val': 0.01961444879678454, 'psi': 0.99729768827612}-{'f1_val': 0.9920338580844371, 'auprc': 0.9983615836737167, 'loss_val': 0.04032220591552322, 'psi': 0.9945649483201491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=90 head_norm_before_train=1.829541 cos_to_last_merge=0.8750 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=90 local utility u=0.538617 metrics={'f1_val': 0.7237936150727119, 'auprc': 0.8334518304443357, 'loss_val': 0.8848126346027122, 'psi': 0.7676569012213614}-{'f1_val': 0.6630413410436284, 'auprc': 0.6926914586775827, 'loss_val': 1.175252499089339, 'psi': 0.6749013880972101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=90 head_norm_before_train=1.892712 cos_to_last_merge=0.9323 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963403242578577, 'auprc': 0.9954089232152851, 'loss_val': 0.023537588191251322, 'psi': 0.9959677638408286}-{'f1_val': 0.9965375310696338, 'auprc': 0.998642838263454, 'loss_val': 0.023503522277042995, 'psi': 0.9973796539471619}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.217360 cos_to_last_merge=0.7887 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.789
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9599764271466189, 'auprc': 0.9975381373797987, 'loss_val': 0.07384506084182729, 'psi': 0.9750011112398907}-{'f1_val': 0.9645881246318284, 'auprc': 0.9975954818571783, 'loss_val': 0.06556634635390322, 'psi': 0.9777910675219683}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.006346 cos_to_last_merge=0.8854 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9847084574909916, 'auprc': 0.9890407242300481, 'loss_val': 0.06404736284507803, 'psi': 0.9864413641866141}-{'f1_val': 0.9851619055599483, 'auprc': 0.9882435279823604, 'loss_val': 0.06203725466589223, 'psi': 0.9863945545289131}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.227781 (no previous merge yet)
[S17] round=90 local utility u=0.181599 metrics={'f1_val': 0.9031471356699512, 'auprc': 0.9841546094852364, 'loss_val': 0.34482018685165805, 'psi': 0.9355501251960652}-{'f1_val': 0.879278477428183, 'auprc': 0.9823552990287041, 'loss_val': 0.5594073143462475, 'psi': 0.9205092060683915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=91 head_norm_before_train=2.105067 cos_to_last_merge=0.7727 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.714958466023027, 'auprc': 0.860653607272706, 'loss_val': 0.7020464731601795, 'psi': 0.7732365225228987}-{'f1_val': 0.8271583747647345, 'auprc': 0.9598758583683393, 'loss_val': 0.46219105327128474, 'psi': 0.8802453682061764}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.250497 cos_to_last_merge=0.9000 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=91 local utility u=0.010083 metrics={'f1_val': 0.8033576870133436, 'auprc': 0.9983958305467663, 'loss_val': 0.4696682984618638, 'psi': 0.8813729444267127}-{'f1_val': 0.8160645151405139, 'auprc': 0.9700433857816648, 'loss_val': 0.4810178228885201, 'psi': 0.8776560633969743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=91 head_norm_before_train=1.904920 cos_to_last_merge=0.9517 (last merge round=22)
[S4] round=91 local utility u=0.036876 metrics={'f1_val': 0.9540942001662225, 'auprc': 0.9502988331913051, 'loss_val': 0.30946345809075765, 'psi': 0.9525760533762555}-{'f1_val': 0.9500509465313974, 'auprc': 0.9370807283648002, 'loss_val': 0.3193016583595942, 'psi': 0.9448628592647585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=91 head_norm_before_train=1.924200 cos_to_last_merge=0.9546 (last merge round=21)
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965549401573681, 'auprc': 0.9963562905221109, 'loss_val': 0.02838013299957073, 'psi': 0.9964754803032653}-{'f1_val': 0.9967019684784577, 'auprc': 0.9970972789105859, 'loss_val': 0.02918002433728599, 'psi': 0.9968600926513089}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=1.857362 cos_to_last_merge=0.9455 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=91 local utility u=1.000000 metrics={'f1_val': 0.7759956731354417, 'auprc': 0.9601789771330878, 'loss_val': 0.5244523305374349, 'psi': 0.8496689947345002}-{'f1_val': 0.6194267443298753, 'auprc': 0.7421816644324913, 'loss_val': 1.2170043172225236, 'psi': 0.6685287123709217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=91 head_norm_before_train=2.203729 cos_to_last_merge=0.9339 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=91 local utility u=1.000000 metrics={'f1_val': 0.9753086227600236, 'auprc': 0.9920027675409997, 'loss_val': 0.08449573800622394, 'psi': 0.9819862806724141}-{'f1_val': 0.5337279773914616, 'auprc': 0.6473771221997981, 'loss_val': 1.9342036741530158, 'psi': 0.5791876353147962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] START round=91 head_norm_before_train=1.985878 cos_to_last_merge=0.9564 (last merge round=16)
[S8] round=91 local utility u=0.000376 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9988063801930749, 'loss_val': 0.03437408691980297, 'psi': 0.9948524444826441}-{'f1_val': 0.9922164873423569, 'auprc': 0.9990554229328394, 'loss_val': 0.035873139404647765, 'psi': 0.9949520615785499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=91 head_norm_before_train=1.955153 cos_to_last_merge=0.9606 (last merge round=23)
[S9] round=91 local utility u=0.010479 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982663482945435, 'loss_val': 0.016630868177995386, 'psi': 0.9975682868251031}-{'f1_val': 0.9943271883459407, 'auprc': 0.9988262955231435, 'loss_val': 0.022613404748201553, 'psi': 0.9961268312168219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=91 head_norm_before_train=2.312652 (no previous merge yet)
[S10] round=91 local utility u=0.001158 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946882674885433, 'loss_val': 0.04926416293307936, 'psi': 0.9945750211913611}-{'f1_val': 0.9944995236599065, 'auprc': 0.9945981461132899, 'loss_val': 0.05131010804148701, 'psi': 0.9945389726412598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=91 head_norm_before_train=2.346669 (no previous merge yet)
[S11] round=91 local utility u=0.000315 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990186868330615, 'loss_val': 0.019001855239981835, 'psi': 0.9972999595796719}-{'f1_val': 0.9961541414107454, 'auprc': 0.999013008574182, 'loss_val': 0.01961444879678454, 'psi': 0.99729768827612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=91 head_norm_before_train=1.835410 cos_to_last_merge=0.8741 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6266084248622813, 'auprc': 0.6597501333853176, 'loss_val': 1.3870822795235613, 'psi': 0.6398651082714959}-{'f1_val': 0.7237936150727119, 'auprc': 0.8334518304443357, 'loss_val': 0.8848126346027122, 'psi': 0.7676569012213614}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.897217 cos_to_last_merge=0.9319 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=91 local utility u=0.003011 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9953296057846106, 'loss_val': 0.021059753280017968, 'psi': 0.996314237319834}-{'f1_val': 0.9963403242578577, 'auprc': 0.9954089232152851, 'loss_val': 0.023537588191251322, 'psi': 0.9959677638408286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=91 head_norm_before_train=2.221228 cos_to_last_merge=0.7885 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9524446625184665, 'auprc': 0.9974805757108497, 'loss_val': 0.0898994639807191, 'psi': 0.9704590277954197}-{'f1_val': 0.9599764271466189, 'auprc': 0.9975381373797987, 'loss_val': 0.07384506084182729, 'psi': 0.9750011112398907}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.011412 cos_to_last_merge=0.8848 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9698826655189705, 'auprc': 0.9901748175662631, 'loss_val': 0.10930797437536734, 'psi': 0.9779995263378876}-{'f1_val': 0.9847084574909916, 'auprc': 0.9890407242300481, 'loss_val': 0.06404736284507803, 'psi': 0.9864413641866141}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.234749 (no previous merge yet)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.8593798933691927, 'auprc': 0.9812391965569118, 'loss_val': 0.5187289216937448, 'psi': 0.9081236146442804}-{'f1_val': 0.9031471356699512, 'auprc': 0.9841546094852364, 'loss_val': 0.34482018685165805, 'psi': 0.9355501251960652}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.107692 cos_to_last_merge=0.7723 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=92 local utility u=0.582489 metrics={'f1_val': 0.8269465324617882, 'auprc': 0.9424944647659366, 'loss_val': 0.4545185943720256, 'psi': 0.8731657053834476}-{'f1_val': 0.714958466023027, 'auprc': 0.860653607272706, 'loss_val': 0.7020464731601795, 'psi': 0.7732365225228987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=92 head_norm_before_train=2.256988 cos_to_last_merge=0.8996 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.7770400834344025, 'auprc': 0.9950215801625875, 'loss_val': 0.5677329842192712, 'psi': 0.8642326821256765}-{'f1_val': 0.8033576870133436, 'auprc': 0.9983958305467663, 'loss_val': 0.4696682984618638, 'psi': 0.8813729444267127}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.906470 cos_to_last_merge=0.9511 (last merge round=22)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9516709207464931, 'auprc': 0.9476124925440982, 'loss_val': 0.3111587723459066, 'psi': 0.950047549465535}-{'f1_val': 0.9540942001662225, 'auprc': 0.9502988331913051, 'loss_val': 0.30946345809075765, 'psi': 0.9525760533762555}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.934033 cos_to_last_merge=0.9536 (last merge round=21)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9946010627039313, 'loss_val': 0.03166013762563554, 'psi': 0.9954650915858957}-{'f1_val': 0.9965549401573681, 'auprc': 0.9963562905221109, 'loss_val': 0.02838013299957073, 'psi': 0.9964754803032653}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=1.859992 cos_to_last_merge=0.9450 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=92 local utility u=0.300124 metrics={'f1_val': 0.8475405978801365, 'auprc': 0.9644100065908066, 'loss_val': 0.36616733199255835, 'psi': 0.8942883613644046}-{'f1_val': 0.7759956731354417, 'auprc': 0.9601789771330878, 'loss_val': 0.5244523305374349, 'psi': 0.8496689947345002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=92 head_norm_before_train=2.205343 cos_to_last_merge=0.9338 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.9222086265660312, 'auprc': 0.9819549994449703, 'loss_val': 0.2759096895363428, 'psi': 0.9461071757176069}-{'f1_val': 0.9753086227600236, 'auprc': 0.9920027675409997, 'loss_val': 0.08449573800622394, 'psi': 0.9819862806724141}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=1.993613 cos_to_last_merge=0.9558 (last merge round=16)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9931069890632681, 'auprc': 0.9904188675263745, 'loss_val': 0.034285516527983576, 'psi': 0.9920317404485106}-{'f1_val': 0.9922164873423569, 'auprc': 0.9988063801930749, 'loss_val': 0.03437408691980297, 'psi': 0.9948524444826441}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=1.958307 cos_to_last_merge=0.9604 (last merge round=23)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9988245947389969, 'loss_val': 0.01789333022897791, 'psi': 0.997641389150953}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982663482945435, 'loss_val': 0.016630868177995386, 'psi': 0.9975682868251031}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.314164 (no previous merge yet)
[S10] round=92 local utility u=0.003142 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9955924194811293, 'loss_val': 0.04569167940852239, 'psi': 0.9949366819883956}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946882674885433, 'loss_val': 0.04926416293307936, 'psi': 0.9945750211913611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=92 head_norm_before_train=2.351354 (no previous merge yet)
[S11] round=92 local utility u=0.000116 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990175821842908, 'loss_val': 0.018766210173681457, 'psi': 0.9972995177201636}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990186868330615, 'loss_val': 0.019001855239981835, 'psi': 0.9972999595796719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=92 head_norm_before_train=1.840041 cos_to_last_merge=0.8734 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=92 local utility u=0.527277 metrics={'f1_val': 0.7350059930655733, 'auprc': 0.7071611386498038, 'loss_val': 1.125147511058383, 'psi': 0.7238680512992655}-{'f1_val': 0.6266084248622813, 'auprc': 0.6597501333853176, 'loss_val': 1.3870822795235613, 'psi': 0.6398651082714959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=92 head_norm_before_train=1.901074 cos_to_last_merge=0.9318 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=92 local utility u=0.006843 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9988427052614017, 'loss_val': 0.019233227967090663, 'psi': 0.9978515550646531}-{'f1_val': 0.9969706583433163, 'auprc': 0.9953296057846106, 'loss_val': 0.021059753280017968, 'psi': 0.996314237319834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=92 head_norm_before_train=2.225052 cos_to_last_merge=0.7882 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9372665255493237, 'auprc': 0.9974333045586538, 'loss_val': 0.10523892718731162, 'psi': 0.9613332371530556}-{'f1_val': 0.9524446625184665, 'auprc': 0.9974805757108497, 'loss_val': 0.0898994639807191, 'psi': 0.9704590277954197}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=2.016608 cos_to_last_merge=0.8842 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9468824640026051, 'auprc': 0.9902698698562157, 'loss_val': 0.17456678718646804, 'psi': 0.9642374263440493}-{'f1_val': 0.9698826655189705, 'auprc': 0.9901748175662631, 'loss_val': 0.10930797437536734, 'psi': 0.9779995263378876}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.239153 (no previous merge yet)
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.784712071282468, 'auprc': 0.9661244793366371, 'loss_val': 0.9284101695120541, 'psi': 0.8572770345041356}-{'f1_val': 0.8593798933691927, 'auprc': 0.9812391965569118, 'loss_val': 0.5187289216937448, 'psi': 0.9081236146442804}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.110755 cos_to_last_merge=0.7718 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7030594321195491, 'auprc': 0.8884335895083031, 'loss_val': 0.6447041494388294, 'psi': 0.7772090950750508}-{'f1_val': 0.8269465324617882, 'auprc': 0.9424944647659366, 'loss_val': 0.4545185943720256, 'psi': 0.8731657053834476}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.264226 cos_to_last_merge=0.8992 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=93 local utility u=0.259899 metrics={'f1_val': 0.8467854781244648, 'auprc': 0.9812534266631479, 'loss_val': 0.4251030700945267, 'psi': 0.900572657539938}-{'f1_val': 0.7770400834344025, 'auprc': 0.9950215801625875, 'loss_val': 0.5677329842192712, 'psi': 0.8642326821256765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=93 head_norm_before_train=1.910181 cos_to_last_merge=0.9506 (last merge round=22)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9511140733941698, 'auprc': 0.9304906700212163, 'loss_val': 0.3144713793495941, 'psi': 0.9428647120449885}-{'f1_val': 0.9516709207464931, 'auprc': 0.9476124925440982, 'loss_val': 0.3111587723459066, 'psi': 0.950047549465535}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=1.945286 cos_to_last_merge=0.9526 (last merge round=21)
[S5] round=93 local utility u=0.006962 metrics={'f1_val': 0.9965549401573681, 'auprc': 0.9965679663774454, 'loss_val': 0.026718857457531095, 'psi': 0.996560150645399}-{'f1_val': 0.9960411108405385, 'auprc': 0.9946010627039313, 'loss_val': 0.03166013762563554, 'psi': 0.9954650915858957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=93 head_norm_before_train=1.864108 cos_to_last_merge=0.9447 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.6553516605889964, 'auprc': 0.7830660721553291, 'loss_val': 1.1765864255552754, 'psi': 0.7064374252155294}-{'f1_val': 0.8475405978801365, 'auprc': 0.9644100065908066, 'loss_val': 0.36616733199255835, 'psi': 0.8942883613644046}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=2.206722 cos_to_last_merge=0.9336 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.7107500975317547, 'auprc': 0.9674636825625686, 'loss_val': 1.1894181359900047, 'psi': 0.8134355315440802}-{'f1_val': 0.9222086265660312, 'auprc': 0.9819549994449703, 'loss_val': 0.2759096895363428, 'psi': 0.9461071757176069}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.000951 cos_to_last_merge=0.9552 (last merge round=16)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9818152306621107, 'auprc': 0.9992209177550828, 'loss_val': 0.05349804085761254, 'psi': 0.9887775054992995}-{'f1_val': 0.9931069890632681, 'auprc': 0.9904188675263745, 'loss_val': 0.034285516527983576, 'psi': 0.9920317404485106}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=1.963545 cos_to_last_merge=0.9601 (last merge round=23)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938856773756167, 'loss_val': 0.01885896723210074, 'psi': 0.995569765709104}-{'f1_val': 0.9968525854255906, 'auprc': 0.9988245947389969, 'loss_val': 0.01789333022897791, 'psi': 0.997641389150953}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.317732 (no previous merge yet)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946544240951783, 'loss_val': 0.048918220201050064, 'psi': 0.9945614838340151}-{'f1_val': 0.9944995236599065, 'auprc': 0.9955924194811293, 'loss_val': 0.04569167940852239, 'psi': 0.9949366819883956}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.356299 (no previous merge yet)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9985906727995666, 'loss_val': 0.027302768427576157, 'psi': 0.9973790179871014}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990175821842908, 'loss_val': 0.018766210173681457, 'psi': 0.9972995177201636}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.844757 cos_to_last_merge=0.8727 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=93 local utility u=0.116723 metrics={'f1_val': 0.7471172806051215, 'auprc': 0.7449563046642103, 'loss_val': 1.0777550857007165, 'psi': 0.7462528902287571}-{'f1_val': 0.7350059930655733, 'auprc': 0.7071611386498038, 'loss_val': 1.125147511058383, 'psi': 0.7238680512992655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=93 head_norm_before_train=1.904974 cos_to_last_merge=0.9315 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9984592788514741, 'loss_val': 0.02088294462585944, 'psi': 0.9978546398218724}-{'f1_val': 0.9971907882668205, 'auprc': 0.9988427052614017, 'loss_val': 0.019233227967090663, 'psi': 0.9978515550646531}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.228818 cos_to_last_merge=0.7879 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=93 local utility u=0.001323 metrics={'f1_val': 0.9377690705194189, 'auprc': 0.9974633255036573, 'loss_val': 0.10569892431324084, 'psi': 0.9616467725131144}-{'f1_val': 0.9372665255493237, 'auprc': 0.9974333045586538, 'loss_val': 0.10523892718731162, 'psi': 0.9613332371530556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=93 head_norm_before_train=2.021854 cos_to_last_merge=0.8836 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9468824640026051, 'auprc': 0.9902743969807369, 'loss_val': 0.19613768305629614, 'psi': 0.9642392371938578}-{'f1_val': 0.9468824640026051, 'auprc': 0.9902698698562157, 'loss_val': 0.17456678718646804, 'psi': 0.9642374263440493}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.245235 (no previous merge yet)
[S17] round=93 local utility u=0.464847 metrics={'f1_val': 0.8767146415666857, 'auprc': 0.9827047383607749, 'loss_val': 0.6004731358230981, 'psi': 0.9191106802843214}-{'f1_val': 0.784712071282468, 'auprc': 0.9661244793366371, 'loss_val': 0.9284101695120541, 'psi': 0.8572770345041356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=94 head_norm_before_train=2.115150 cos_to_last_merge=0.7714 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=94 local utility u=0.305355 metrics={'f1_val': 0.7792879686020112, 'auprc': 0.9105559299349097, 'loss_val': 0.5577319684264118, 'psi': 0.8317951531351706}-{'f1_val': 0.7030594321195491, 'auprc': 0.8884335895083031, 'loss_val': 0.6447041494388294, 'psi': 0.7772090950750508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=94 head_norm_before_train=2.270933 cos_to_last_merge=0.8988 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=94 local utility u=0.107226 metrics={'f1_val': 0.8603934002910985, 'auprc': 0.9982323065967363, 'loss_val': 0.3432360970026557, 'psi': 0.9155289628133536}-{'f1_val': 0.8467854781244648, 'auprc': 0.9812534266631479, 'loss_val': 0.4251030700945267, 'psi': 0.900572657539938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=94 head_norm_before_train=1.910585 cos_to_last_merge=0.9499 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=94 local utility u=0.028838 metrics={'f1_val': 0.9529128552374677, 'auprc': 0.9442902040951684, 'loss_val': 0.30898705401565507, 'psi': 0.949463794780548}-{'f1_val': 0.9511140733941698, 'auprc': 0.9304906700212163, 'loss_val': 0.3144713793495941, 'psi': 0.9428647120449885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=94 head_norm_before_train=1.960670 cos_to_last_merge=0.9511 (last merge round=21)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9965754252315847, 'loss_val': 0.026875707479230796, 'psi': 0.996254836596957}-{'f1_val': 0.9965549401573681, 'auprc': 0.9965679663774454, 'loss_val': 0.026718857457531095, 'psi': 0.996560150645399}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=1.872160 cos_to_last_merge=0.9444 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=94 local utility u=1.000000 metrics={'f1_val': 0.8103701144441707, 'auprc': 0.9763380854286616, 'loss_val': 0.6042790633607573, 'psi': 0.8767573028379672}-{'f1_val': 0.6553516605889964, 'auprc': 0.7830660721553291, 'loss_val': 1.1765864255552754, 'psi': 0.7064374252155294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=94 head_norm_before_train=2.211129 cos_to_last_merge=0.9332 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=94 local utility u=0.922576 metrics={'f1_val': 0.8862771483472568, 'auprc': 0.9797807299239955, 'loss_val': 0.4343786760068172, 'psi': 0.9236785809779523}-{'f1_val': 0.7107500975317547, 'auprc': 0.9674636825625686, 'loss_val': 1.1894181359900047, 'psi': 0.8134355315440802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=94 head_norm_before_train=2.002804 cos_to_last_merge=0.9549 (last merge round=16)
[S8] round=94 local utility u=0.026183 metrics={'f1_val': 0.9886079483410091, 'auprc': 0.998951273309193, 'loss_val': 0.04107943620612932, 'psi': 0.9927452783282826}-{'f1_val': 0.9818152306621107, 'auprc': 0.9992209177550828, 'loss_val': 0.05349804085761254, 'psi': 0.9887775054992995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=94 head_norm_before_train=1.967599 cos_to_last_merge=0.9599 (last merge round=23)
[S9] round=94 local utility u=0.009713 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9988199888440267, 'loss_val': 0.016509468824199562, 'psi': 0.9977708434592307}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938856773756167, 'loss_val': 0.01885896723210074, 'psi': 0.995569765709104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=94 head_norm_before_train=2.322368 (no previous merge yet)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946263859225204, 'loss_val': 0.04935441725773897, 'psi': 0.994550268564952}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946544240951783, 'loss_val': 0.048918220201050064, 'psi': 0.9945614838340151}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.359665 (no previous merge yet)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.8588602497976621, 'auprc': 0.9983523905867409, 'loss_val': 0.19079408053029548, 'psi': 0.9146571061132935}-{'f1_val': 0.9965712481121245, 'auprc': 0.9985906727995666, 'loss_val': 0.027302768427576157, 'psi': 0.9973790179871014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.850471 cos_to_last_merge=0.8720 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.872
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6091403856316162, 'auprc': 0.6123534200462373, 'loss_val': 1.5470858925970639, 'psi': 0.6104255993974647}-{'f1_val': 0.7471172806051215, 'auprc': 0.7449563046642103, 'loss_val': 1.0777550857007165, 'psi': 0.7462528902287571}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=1.908329 cos_to_last_merge=0.9310 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9571453869508454, 'auprc': 0.9988422346936491, 'loss_val': 0.06703883205459364, 'psi': 0.973824126047967}-{'f1_val': 0.9974515471354712, 'auprc': 0.9984592788514741, 'loss_val': 0.02088294462585944, 'psi': 0.9978546398218724}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.232468 cos_to_last_merge=0.7876 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=94 local utility u=0.110575 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9976633107624613, 'loss_val': 0.059740346744489234, 'psi': 0.9791859228768811}-{'f1_val': 0.9377690705194189, 'auprc': 0.9974633255036573, 'loss_val': 0.10569892431324084, 'psi': 0.9616467725131144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=94 head_norm_before_train=2.026544 cos_to_last_merge=0.8831 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=94 local utility u=0.015068 metrics={'f1_val': 0.9470919177326814, 'auprc': 0.9908721862025934, 'loss_val': 0.16905227598287106, 'psi': 0.9646040251206462}-{'f1_val': 0.9468824640026051, 'auprc': 0.9902743969807369, 'loss_val': 0.19613768305629614, 'psi': 0.9642392371938578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=94 head_norm_before_train=2.251749 (no previous merge yet)
[S17] round=94 local utility u=0.057711 metrics={'f1_val': 0.8834080968245499, 'auprc': 0.9807338426838037, 'loss_val': 0.5192999043292509, 'psi': 0.9223383951682513}-{'f1_val': 0.8767146415666857, 'auprc': 0.9827047383607749, 'loss_val': 0.6004731358230981, 'psi': 0.9191106802843214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=95 head_norm_before_train=2.119478 cos_to_last_merge=0.7711 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=95 local utility u=0.121587 metrics={'f1_val': 0.8276015764961668, 'auprc': 0.8614393635335811, 'loss_val': 0.4570898784149025, 'psi': 0.8411366913111324}-{'f1_val': 0.7792879686020112, 'auprc': 0.9105559299349097, 'loss_val': 0.5577319684264118, 'psi': 0.8317951531351706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=95 head_norm_before_train=2.277446 cos_to_last_merge=0.8984 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.7973734885319579, 'auprc': 0.9920691986116719, 'loss_val': 0.5972682315158537, 'psi': 0.8752517725638436}-{'f1_val': 0.8603934002910985, 'auprc': 0.9982323065967363, 'loss_val': 0.3432360970026557, 'psi': 0.9155289628133536}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=1.911964 cos_to_last_merge=0.9493 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.950051959646113, 'auprc': 0.9253059414633042, 'loss_val': 0.31710507779994374, 'psi': 0.9401535523729896}-{'f1_val': 0.9529128552374677, 'auprc': 0.9442902040951684, 'loss_val': 0.30898705401565507, 'psi': 0.949463794780548}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.971929 cos_to_last_merge=0.9496 (last merge round=21)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=95 local utility u=0.002562 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9969796464583975, 'loss_val': 0.025173126603728058, 'psi': 0.9966374189966225}-{'f1_val': 0.9960411108405385, 'auprc': 0.9965754252315847, 'loss_val': 0.026875707479230796, 'psi': 0.996254836596957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=95 head_norm_before_train=1.878231 cos_to_last_merge=0.9440 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=95 local utility u=0.607959 metrics={'f1_val': 0.9296513629585199, 'auprc': 0.9936084057719798, 'loss_val': 0.15585876262312837, 'psi': 0.9552341800839039}-{'f1_val': 0.8103701144441707, 'auprc': 0.9763380854286616, 'loss_val': 0.6042790633607573, 'psi': 0.8767573028379672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=95 head_norm_before_train=2.217939 cos_to_last_merge=0.9328 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.8693001629950716, 'auprc': 0.9792776260658841, 'loss_val': 0.577189777320064, 'psi': 0.9132911482233966}-{'f1_val': 0.8862771483472568, 'auprc': 0.9797807299239955, 'loss_val': 0.4343786760068172, 'psi': 0.9236785809779523}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.002426 cos_to_last_merge=0.9552 (last merge round=16)
[S8] round=95 local utility u=0.013465 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.997449764108636, 'loss_val': 0.03342587744287257, 'psi': 0.9945226733167396}-{'f1_val': 0.9886079483410091, 'auprc': 0.998951273309193, 'loss_val': 0.04107943620612932, 'psi': 0.9927452783282826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=95 head_norm_before_train=1.967787 cos_to_last_merge=0.9599 (last merge round=23)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988026908780863, 'loss_val': 0.01712549281060939, 'psi': 0.9977828238585202}-{'f1_val': 0.9970714132027002, 'auprc': 0.9988199888440267, 'loss_val': 0.016509468824199562, 'psi': 0.9977708434592307}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.327478 (no previous merge yet)
[S10] round=95 local utility u=0.000999 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9946930345932723, 'loss_val': 0.04755713830435981, 'psi': 0.9945769280332528}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946263859225204, 'loss_val': 0.04935441725773897, 'psi': 0.994550268564952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=95 head_norm_before_train=2.364119 (no previous merge yet)
[S11] round=95 local utility u=0.498076 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989484072592879, 'loss_val': 0.020193586800695818, 'psi': 0.9972718477501624}-{'f1_val': 0.8588602497976621, 'auprc': 0.9983523905867409, 'loss_val': 0.19079408053029548, 'psi': 0.9146571061132935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=95 head_norm_before_train=1.857122 cos_to_last_merge=0.8711 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=95 local utility u=0.899359 metrics={'f1_val': 0.7528815493311051, 'auprc': 0.7458383696911923, 'loss_val': 1.0112700666909078, 'psi': 0.7500642774751399}-{'f1_val': 0.6091403856316162, 'auprc': 0.6123534200462373, 'loss_val': 1.5470858925970639, 'psi': 0.6104255993974647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=95 head_norm_before_train=1.912759 cos_to_last_merge=0.9306 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9426397232066835, 'auprc': 0.9974181279072065, 'loss_val': 0.1284605264850489, 'psi': 0.9645510850868928}-{'f1_val': 0.9571453869508454, 'auprc': 0.9988422346936491, 'loss_val': 0.06703883205459364, 'psi': 0.973824126047967}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.236094 cos_to_last_merge=0.7874 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=95 local utility u=0.063447 metrics={'f1_val': 0.9836632781139562, 'auprc': 0.9978473183038721, 'loss_val': 0.0341728279369904, 'psi': 0.9893368941899225}-{'f1_val': 0.9668676642864944, 'auprc': 0.9976633107624613, 'loss_val': 0.059740346744489234, 'psi': 0.9791859228768811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=95 head_norm_before_train=2.027127 cos_to_last_merge=0.8832 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9468824640026051, 'auprc': 0.9910277122514111, 'loss_val': 0.18884032376221266, 'psi': 0.9645405633021275}-{'f1_val': 0.9470919177326814, 'auprc': 0.9908721862025934, 'loss_val': 0.16905227598287106, 'psi': 0.9646040251206462}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.256531 (no previous merge yet)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8096004038315697, 'auprc': 0.9693877841254679, 'loss_val': 0.9058320968407424, 'psi': 0.873515355949129}-{'f1_val': 0.8834080968245499, 'auprc': 0.9807338426838037, 'loss_val': 0.5192999043292509, 'psi': 0.9223383951682513}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.122070 cos_to_last_merge=0.7706 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7090618936573208, 'auprc': 0.9345714178227175, 'loss_val': 0.6357919261381735, 'psi': 0.7992657033234795}-{'f1_val': 0.8276015764961668, 'auprc': 0.8614393635335811, 'loss_val': 0.4570898784149025, 'psi': 0.8411366913111324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.284440 cos_to_last_merge=0.8980 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=96 local utility u=0.560745 metrics={'f1_val': 0.9158339723849407, 'auprc': 0.9974138386465884, 'loss_val': 0.20257414675159133, 'psi': 0.9484659188895999}-{'f1_val': 0.7973734885319579, 'auprc': 0.9920691986116719, 'loss_val': 0.5972682315158537, 'psi': 0.8752517725638436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=96 head_norm_before_train=1.915572 cos_to_last_merge=0.9488 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=96 local utility u=0.016104 metrics={'f1_val': 0.9511564285671956, 'auprc': 0.9325411272781692, 'loss_val': 0.31322897296579466, 'psi': 0.9437103080515851}-{'f1_val': 0.950051959646113, 'auprc': 0.9253059414633042, 'loss_val': 0.31710507779994374, 'psi': 0.9401535523729896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=96 head_norm_before_train=1.988742 cos_to_last_merge=0.9480 (last merge round=21)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=96 local utility u=0.000810 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9981849646807689, 'loss_val': 0.0249609102224614, 'psi': 0.9968986523766307}-{'f1_val': 0.9964092673554392, 'auprc': 0.9969796464583975, 'loss_val': 0.025173126603728058, 'psi': 0.9966374189966225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=96 head_norm_before_train=1.882064 cos_to_last_merge=0.9434 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.7597786754217996, 'auprc': 0.9755871857023204, 'loss_val': 0.5806012701324531, 'psi': 0.846102079534008}-{'f1_val': 0.9296513629585199, 'auprc': 0.9936084057719798, 'loss_val': 0.15585876262312837, 'psi': 0.9552341800839039}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.224481 cos_to_last_merge=0.9324 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.7221206090633997, 'auprc': 0.964474240198254, 'loss_val': 1.2188670321136872, 'psi': 0.8190620615173414}-{'f1_val': 0.8693001629950716, 'auprc': 0.9792776260658841, 'loss_val': 0.577189777320064, 'psi': 0.9132911482233966}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.004975 cos_to_last_merge=0.9552 (last merge round=16)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9952770466274964, 'loss_val': 0.033225380930481684, 'psi': 0.9936535863242837}-{'f1_val': 0.9925712794554754, 'auprc': 0.997449764108636, 'loss_val': 0.03342587744287257, 'psi': 0.9945226733167396}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=1.971225 cos_to_last_merge=0.9597 (last merge round=23)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987943857097141, 'loss_val': 0.017213959142971788, 'psi': 0.9977795017911714}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988026908780863, 'loss_val': 0.01712549281060939, 'psi': 0.9977828238585202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.332775 (no previous merge yet)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9947287323521854, 'loss_val': 0.04786818519003398, 'psi': 0.9945912071368179}-{'f1_val': 0.9944995236599065, 'auprc': 0.9946930345932723, 'loss_val': 0.04755713830435981, 'psi': 0.9945769280332528}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.369173 (no previous merge yet)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989097680278486, 'loss_val': 0.02041759451696223, 'psi': 0.9972563920575866}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989484072592879, 'loss_val': 0.020193586800695818, 'psi': 0.9972718477501624}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.860447 cos_to_last_merge=0.8706 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6665026866173891, 'auprc': 0.6935997864622262, 'loss_val': 1.227258806187114, 'psi': 0.677341526555324}-{'f1_val': 0.7528815493311051, 'auprc': 0.7458383696911923, 'loss_val': 1.0112700666909078, 'psi': 0.7500642774751399}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.918628 cos_to_last_merge=0.9301 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=96 local utility u=0.184558 metrics={'f1_val': 0.9894314099252491, 'auprc': 0.996752032997198, 'loss_val': 0.038096840765187656, 'psi': 0.9923596591540287}-{'f1_val': 0.9426397232066835, 'auprc': 0.9974181279072065, 'loss_val': 0.1284605264850489, 'psi': 0.9645510850868928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=96 head_norm_before_train=2.239602 cos_to_last_merge=0.7872 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=96 local utility u=0.023912 metrics={'f1_val': 0.9904796716949915, 'auprc': 0.9979273204330337, 'loss_val': 0.02748685167417231, 'psi': 0.9934587311902083}-{'f1_val': 0.9836632781139562, 'auprc': 0.9978473183038721, 'loss_val': 0.0341728279369904, 'psi': 0.9893368941899225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=96 head_norm_before_train=2.029458 cos_to_last_merge=0.8830 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9464636167232477, 'auprc': 0.9908621617704223, 'loss_val': 0.2333439250596649, 'psi': 0.9642230347421175}-{'f1_val': 0.9468824640026051, 'auprc': 0.9910277122514111, 'loss_val': 0.18884032376221266, 'psi': 0.9645405633021275}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.261944 (no previous merge yet)
[S17] round=96 local utility u=0.421288 metrics={'f1_val': 0.880812652658905, 'auprc': 0.977171359972228, 'loss_val': 0.5138805130059644, 'psi': 0.9193561355842342}-{'f1_val': 0.8096004038315697, 'auprc': 0.9693877841254679, 'loss_val': 0.9058320968407424, 'psi': 0.873515355949129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=97 head_norm_before_train=2.124561 cos_to_last_merge=0.7702 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=97 local utility u=0.246971 metrics={'f1_val': 0.8279242066002275, 'auprc': 0.7980294607421968, 'loss_val': 0.4453977561528389, 'psi': 0.8159663082570152}-{'f1_val': 0.7090618936573208, 'auprc': 0.9345714178227175, 'loss_val': 0.6357919261381735, 'psi': 0.7992657033234795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=97 head_norm_before_train=2.291360 cos_to_last_merge=0.8977 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=97 local utility u=0.181287 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9998381087610425, 'loss_val': 0.11895986218839642, 'psi': 0.9766043978451084}-{'f1_val': 0.9158339723849407, 'auprc': 0.9974138386465884, 'loss_val': 0.20257414675159133, 'psi': 0.9484659188895999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=97 head_norm_before_train=1.920704 cos_to_last_merge=0.9483 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=97 local utility u=0.007882 metrics={'f1_val': 0.9512873970572239, 'auprc': 0.9372879914664766, 'loss_val': 0.31249198827011254, 'psi': 0.945687634820925}-{'f1_val': 0.9511564285671956, 'auprc': 0.9325411272781692, 'loss_val': 0.31322897296579466, 'psi': 0.9437103080515851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=97 head_norm_before_train=2.004258 cos_to_last_merge=0.9464 (last merge round=21)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=97 local utility u=0.004164 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9995778504867608, 'loss_val': 0.023019834797199518, 'psi': 0.9976767006079679}-{'f1_val': 0.9960411108405385, 'auprc': 0.9981849646807689, 'loss_val': 0.0249609102224614, 'psi': 0.9968986523766307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=97 head_norm_before_train=1.887812 cos_to_last_merge=0.9430 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6909496532158524, 'auprc': 0.9361608427537459, 'loss_val': 0.849402511353263, 'psi': 0.7890341290310099}-{'f1_val': 0.7597786754217996, 'auprc': 0.9755871857023204, 'loss_val': 0.5806012701324531, 'psi': 0.846102079534008}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=2.234920 cos_to_last_merge=0.9315 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=97 local utility u=0.700623 metrics={'f1_val': 0.8618324801310808, 'auprc': 0.9646741903446638, 'loss_val': 0.6564931062937868, 'psi': 0.9029691642165141}-{'f1_val': 0.7221206090633997, 'auprc': 0.964474240198254, 'loss_val': 1.2188670321136872, 'psi': 0.8190620615173414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=97 head_norm_before_train=2.010186 cos_to_last_merge=0.9548 (last merge round=16)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.847518772636008, 'auprc': 0.9990838311807735, 'loss_val': 0.27810924515828406, 'psi': 0.9081447960539142}-{'f1_val': 0.9925712794554754, 'auprc': 0.9952770466274964, 'loss_val': 0.033225380930481684, 'psi': 0.9936535863242837}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=1.975900 cos_to_last_merge=0.9595 (last merge round=23)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988084188716821, 'loss_val': 0.018505131862589824, 'psi': 0.9975196746370077}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987943857097141, 'loss_val': 0.017213959142971788, 'psi': 0.9977795017911714}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.334272 (no previous merge yet)
[S10] round=97 local utility u=0.001084 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9952623408864518, 'loss_val': 0.04730172458542386, 'psi': 0.9948046505505246}-{'f1_val': 0.9944995236599065, 'auprc': 0.9947287323521854, 'loss_val': 0.04786818519003398, 'psi': 0.9945912071368179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=97 head_norm_before_train=2.373910 (no previous merge yet)
[S11] round=97 local utility u=0.000433 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989800118845562, 'loss_val': 0.019761809699248765, 'psi': 0.9972844896002697}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989097680278486, 'loss_val': 0.02041759451696223, 'psi': 0.9972563920575866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=97 head_norm_before_train=1.864749 cos_to_last_merge=0.8700 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=97 local utility u=0.021758 metrics={'f1_val': 0.6690154752031543, 'auprc': 0.697041356981877, 'loss_val': 1.2091452010786339, 'psi': 0.6802258279146434}-{'f1_val': 0.6665026866173891, 'auprc': 0.6935997864622262, 'loss_val': 1.227258806187114, 'psi': 0.677341526555324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=97 head_norm_before_train=1.923649 cos_to_last_merge=0.9296 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=97 local utility u=0.031956 metrics={'f1_val': 0.9973814229168628, 'auprc': 0.9968507967797544, 'loss_val': 0.022181417490831908, 'psi': 0.9971691724620195}-{'f1_val': 0.9894314099252491, 'auprc': 0.996752032997198, 'loss_val': 0.038096840765187656, 'psi': 0.9923596591540287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=97 head_norm_before_train=2.243090 cos_to_last_merge=0.7869 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=97 local utility u=0.016392 metrics={'f1_val': 0.9955024063769649, 'auprc': 0.9979951935207917, 'loss_val': 0.025043440460916788, 'psi': 0.9964995212344956}-{'f1_val': 0.9904796716949915, 'auprc': 0.9979273204330337, 'loss_val': 0.02748685167417231, 'psi': 0.9934587311902083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=97 head_norm_before_train=2.033084 cos_to_last_merge=0.8827 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=97 local utility u=0.012029 metrics={'f1_val': 0.9468824640026051, 'auprc': 0.9913801190330737, 'loss_val': 0.21335357726576618, 'psi': 0.9646815260147925}-{'f1_val': 0.9464636167232477, 'auprc': 0.9908621617704223, 'loss_val': 0.2333439250596649, 'psi': 0.9642230347421175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=97 head_norm_before_train=2.266231 (no previous merge yet)
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8769415335913875, 'auprc': 0.9780101855619161, 'loss_val': 0.5378299299233823, 'psi': 0.917368994379599}-{'f1_val': 0.880812652658905, 'auprc': 0.977171359972228, 'loss_val': 0.5138805130059644, 'psi': 0.9193561355842342}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.127763 cos_to_last_merge=0.7697 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.6891424008486486, 'auprc': 0.8667720201926034, 'loss_val': 0.7069659899621494, 'psi': 0.7601942485862305}-{'f1_val': 0.8279242066002275, 'auprc': 0.7980294607421968, 'loss_val': 0.4453977561528389, 'psi': 0.8159663082570152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.297884 cos_to_last_merge=0.8972 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.7398970444642181, 'auprc': 0.9974617772014338, 'loss_val': 0.6888455529953608, 'psi': 0.8429229375591043}-{'f1_val': 0.9611152572344858, 'auprc': 0.9998381087610425, 'loss_val': 0.11895986218839642, 'psi': 0.9766043978451084}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=1.924682 cos_to_last_merge=0.9482 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9522385072518744, 'auprc': 0.9364893199638027, 'loss_val': 0.3182732014056871, 'psi': 0.9459388323366458}-{'f1_val': 0.9512873970572239, 'auprc': 0.9372879914664766, 'loss_val': 0.31249198827011254, 'psi': 0.945687634820925}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.017753 cos_to_last_merge=0.9450 (last merge round=21)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9925036376274983, 'loss_val': 0.029405192063924643, 'psi': 0.9948017422291333}-{'f1_val': 0.9964092673554392, 'auprc': 0.9995778504867608, 'loss_val': 0.023019834797199518, 'psi': 0.9976767006079679}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=1.893926 cos_to_last_merge=0.9424 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=98 local utility u=0.795868 metrics={'f1_val': 0.8717362824949275, 'auprc': 0.958561542823523, 'loss_val': 0.4095880181316624, 'psi': 0.9064663866263657}-{'f1_val': 0.6909496532158524, 'auprc': 0.9361608427537459, 'loss_val': 0.849402511353263, 'psi': 0.7890341290310099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=98 head_norm_before_train=2.244075 cos_to_last_merge=0.9308 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.8585762632305047, 'auprc': 0.9698364556351312, 'loss_val': 0.73457915022279, 'psi': 0.9030803401923554}-{'f1_val': 0.8618324801310808, 'auprc': 0.9646741903446638, 'loss_val': 0.6564931062937868, 'psi': 0.9029691642165141}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.013949 cos_to_last_merge=0.9544 (last merge round=16)
[S8] round=98 local utility u=0.552461 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9932240106482313, 'loss_val': 0.03362705831763966, 'psi': 0.9936028736276792}-{'f1_val': 0.847518772636008, 'auprc': 0.9990838311807735, 'loss_val': 0.27810924515828406, 'psi': 0.9081447960539142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=98 head_norm_before_train=1.974786 cos_to_last_merge=0.9595 (last merge round=23)
[S9] round=98 local utility u=0.000398 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988284008320525, 'loss_val': 0.017768285652922693, 'psi': 0.9975276674211558}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988084188716821, 'loss_val': 0.018505131862589824, 'psi': 0.9975196746370077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] START round=98 head_norm_before_train=2.337119 (no previous merge yet)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.994914809724269, 'loss_val': 0.0477629158895558, 'psi': 0.9946656380856514}-{'f1_val': 0.9944995236599065, 'auprc': 0.9952623408864518, 'loss_val': 0.04730172458542386, 'psi': 0.9948046505505246}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.377925 (no previous merge yet)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989346763926725, 'loss_val': 0.020027295298692824, 'psi': 0.9972663554035163}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989800118845562, 'loss_val': 0.019761809699248765, 'psi': 0.9972844896002697}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.872362 cos_to_last_merge=0.8689 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.869
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6185874988922496, 'auprc': 0.6289595962993499, 'loss_val': 1.500838358763284, 'psi': 0.6227363378550897}-{'f1_val': 0.6690154752031543, 'auprc': 0.697041356981877, 'loss_val': 1.2091452010786339, 'psi': 0.6802258279146434}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=1.927281 cos_to_last_merge=0.9291 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.929
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963403242578577, 'auprc': 0.9969715479801409, 'loss_val': 0.025121642240007017, 'psi': 0.996592813746771}-{'f1_val': 0.9973814229168628, 'auprc': 0.9968507967797544, 'loss_val': 0.022181417490831908, 'psi': 0.9971691724620195}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.246626 cos_to_last_merge=0.7867 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9412618979763847, 'auprc': 0.9975159683090702, 'loss_val': 0.10311108181978086, 'psi': 0.9637635261094588}-{'f1_val': 0.9955024063769649, 'auprc': 0.9979951935207917, 'loss_val': 0.025043440460916788, 'psi': 0.9964995212344956}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.035828 cos_to_last_merge=0.8823 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.882
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.8715025630785184, 'auprc': 0.9774895914921377, 'loss_val': 0.8425227447876422, 'psi': 0.9138973744439661}-{'f1_val': 0.9468824640026051, 'auprc': 0.9913801190330737, 'loss_val': 0.21335357726576618, 'psi': 0.9646815260147925}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.268317 (no previous merge yet)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8721195811440401, 'auprc': 0.9797746447128558, 'loss_val': 0.5488125440544825, 'psi': 0.9151816065715663}-{'f1_val': 0.8769415335913875, 'auprc': 0.9780101855619161, 'loss_val': 0.5378299299233823, 'psi': 0.917368994379599}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.128193 cos_to_last_merge=0.7696 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.6442382219684178, 'auprc': 0.7568804952558211, 'loss_val': 1.8970661672523452, 'psi': 0.6892951312833792}-{'f1_val': 0.6891424008486486, 'auprc': 0.8667720201926034, 'loss_val': 0.7069659899621494, 'psi': 0.7601942485862305}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.689 u=0.0000 p_local=0.1247 f1=0.644 auprc=0.757 bytes=100931
[S3] START round=99 head_norm_before_train=2.298775 cos_to_last_merge=0.8967 (last merge round=13)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=99 local utility u=0.392679 metrics={'f1_val': 0.8267482529346823, 'auprc': 0.9980421896361429, 'loss_val': 0.4263368996747067, 'psi': 0.8952658276152665}-{'f1_val': 0.7398970444642181, 'auprc': 0.9974617772014338, 'loss_val': 0.6888455529953608, 'psi': 0.8429229375591043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=100 psi=0.895 u=0.3927 p_local=0.2121 f1=0.827 auprc=0.998 bytes=93525
[S4] START round=99 head_norm_before_train=1.930508 cos_to_last_merge=0.9481 (last merge round=22)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=99 local utility u=0.037513 metrics={'f1_val': 0.9541715601898255, 'auprc': 0.9576908065054048, 'loss_val': 0.3184504444132943, 'psi': 0.9555792587160572}-{'f1_val': 0.9522385072518744, 'auprc': 0.9364893199638027, 'loss_val': 0.3182732014056871, 'psi': 0.9459388323366458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=100 psi=0.956 u=0.0375 p_local=0.0151 f1=0.954 auprc=0.958 bytes=102479
[S5] START round=99 head_norm_before_train=2.030576 cos_to_last_merge=0.9437 (last merge round=21)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=99 local utility u=0.014167 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.999210493575474, 'loss_val': 0.021643992964688732, 'psi': 0.9975297578434532}-{'f1_val': 0.9963338119635569, 'auprc': 0.9925036376274983, 'loss_val': 0.029405192063924643, 'psi': 0.9948017422291333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] r=100 psi=0.998 u=0.0142 p_local=0.0284 f1=0.996 auprc=0.999 bytes=95444
[S6] START round=99 head_norm_before_train=1.899178 cos_to_last_merge=0.9417 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.7900094386042096, 'auprc': 0.9164385556039649, 'loss_val': 0.5922966298959441, 'psi': 0.8405810854041118}-{'f1_val': 0.8717362824949275, 'auprc': 0.958561542823523, 'loss_val': 0.4095880181316624, 'psi': 0.9064663866263657}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.841 u=0.0000 p_local=0.3233 f1=0.790 auprc=0.916 bytes=88155
[S7] START round=99 head_norm_before_train=2.248439 cos_to_last_merge=0.9313 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.6614619051754101, 'auprc': 0.9582980850926317, 'loss_val': 1.4194500360893734, 'psi': 0.7801963771422988}-{'f1_val': 0.8585762632305047, 'auprc': 0.9698364556351312, 'loss_val': 0.73457915022279, 'psi': 0.9030803401923554}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.780 u=0.0000 p_local=0.2044 f1=0.661 auprc=0.958 bytes=91690
[S8] START round=99 head_norm_before_train=2.017565 cos_to_last_merge=0.9540 (last merge round=16)
[S8] round=99 local utility u=0.007968 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9986400468883743, 'loss_val': 0.03281332863016726, 'psi': 0.9956566065664894}-{'f1_val': 0.9938554489473111, 'auprc': 0.9932240106482313, 'loss_val': 0.03362705831763966, 'psi': 0.9936028736276792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=100 psi=0.996 u=0.0080 p_local=0.1003 f1=0.994 auprc=0.999 bytes=97105
[S9] START round=99 head_norm_before_train=1.978980 cos_to_last_merge=0.9593 (last merge round=23)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.998834718218872, 'loss_val': 0.019861991714580154, 'psi': 0.9968797226180577}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988284008320525, 'loss_val': 0.017768285652922693, 'psi': 0.9975276674211558}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.997 u=0.0000 p_local=0.0011 f1=0.996 auprc=0.999 bytes=102677
[S10] START round=99 head_norm_before_train=2.341240 (no previous merge yet)
[S10] round=99 local utility u=0.000016 metrics={'f1_val': 0.9944995236599065, 'auprc': 0.9948950477848577, 'loss_val': 0.047671066798152355, 'psi': 0.9946577333098869}-{'f1_val': 0.9944995236599065, 'auprc': 0.994914809724269, 'loss_val': 0.0477629158895558, 'psi': 0.9946656380856514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0004 f1=0.994 auprc=0.995 bytes=109551
[S11] START round=99 head_norm_before_train=2.379571 (no previous merge yet)
[S11] round=99 local utility u=0.000175 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989434606651734, 'loss_val': 0.019703846565459135, 'psi': 0.9972698691125166}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989346763926725, 'loss_val': 0.020027295298692824, 'psi': 0.9972663554035163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] r=100 psi=0.997 u=0.0002 p_local=0.0627 f1=0.996 auprc=0.999 bytes=107884
[S13] START round=99 head_norm_before_train=1.878558 cos_to_last_merge=0.8680 (last merge round=17)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=99 local utility u=0.739454 metrics={'f1_val': 0.7505916630408818, 'auprc': 0.7298799941739899, 'loss_val': 1.116716426396405, 'psi': 0.742306995494125}-{'f1_val': 0.6185874988922496, 'auprc': 0.6289595962993499, 'loss_val': 1.500838358763284, 'psi': 0.6227363378550897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=100 psi=0.742 u=0.7395 p_local=0.2802 f1=0.751 auprc=0.730 bytes=97219
[S14] START round=99 head_norm_before_train=1.929372 cos_to_last_merge=0.9285 (last merge round=22)
[S14] ⚠️ Model drifted since last merge! cos=0.928
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9962951436803226, 'loss_val': 0.024954907875278258, 'psi': 0.9964542842423878}-{'f1_val': 0.9963403242578577, 'auprc': 0.9969715479801409, 'loss_val': 0.025121642240007017, 'psi': 0.996592813746771}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.996 u=0.0000 p_local=0.0250 f1=0.997 auprc=0.996 bytes=104370
[S15] START round=99 head_norm_before_train=2.250219 cos_to_last_merge=0.7864 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9971761864787236, 'loss_val': 0.2446650678983624, 'psi': 0.9397420205926131}-{'f1_val': 0.9412618979763847, 'auprc': 0.9975159683090702, 'loss_val': 0.10311108181978086, 'psi': 0.9637635261094588}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.940 u=0.0000 p_local=0.0206 f1=0.901 auprc=0.997 bytes=98838
[S16] START round=99 head_norm_before_train=2.037578 cos_to_last_merge=0.8821 (last merge round=23)
[S16] ⚠️ Model drifted since last merge! cos=0.882
[S16] round=99 local utility u=0.550659 metrics={'f1_val': 0.9476731914848526, 'auprc': 0.9868711138058913, 'loss_val': 0.22637210364512833, 'psi': 0.9633523604132681}-{'f1_val': 0.8715025630785184, 'auprc': 0.9774895914921377, 'loss_val': 0.8425227447876422, 'psi': 0.9138973744439661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=100 psi=0.963 u=0.5507 p_local=0.1177 f1=0.948 auprc=0.987 bytes=91863
[S17] START round=99 head_norm_before_train=2.272826 (no previous merge yet)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8500352501475943, 'auprc': 0.9800811456865767, 'loss_val': 0.7145545368425251, 'psi': 0.9020536083631872}-{'f1_val': 0.8721195811440401, 'auprc': 0.9797746447128558, 'loss_val': 0.5488125440544825, 'psi': 0.9151816065715663}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.902 u=0.0000 p_local=0.0925 f1=0.850 auprc=0.980 bytes=91717
[runner] rounds complete.
[runner] all agents stopped.
