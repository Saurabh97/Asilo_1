[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61803
[S3] → join 127.0.0.1:61802
[S4] → join 127.0.0.1:61802
[S5] → join 127.0.0.1:61802
[S6] → join 127.0.0.1:61802
[S7] → join 127.0.0.1:61802
[S8] → join 127.0.0.1:61802
[S9] → join 127.0.0.1:61802
[S10] → join 127.0.0.1:61802
[S11] → join 127.0.0.1:61802
[S13] → join 127.0.0.1:61802
[S14] → join 127.0.0.1:61802
[S15] → join 127.0.0.1:61802
[S16] → join 127.0.0.1:61802
[S17] → join 127.0.0.1:61802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.185388 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.203459 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.204747 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.168102 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.198658 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.166431 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.118962 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.149045 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.165232 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.167728 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.160377 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.188859 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.126655 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.208063 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.132389 (no previous merge yet)
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3] + discovered S17
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S13
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S15
[S3] + discovered S7
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S10
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S13
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S9
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S6
[S7] + discovered S3
[S6] + discovered S10
[S7] + discovered S6
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S14
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S6
[S7] + discovered S13
[S7] + discovered S15
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S16
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S11
[S9] + discovered S4
[S8] + discovered S15
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S2
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S10
[S8] + discovered S17
[S8] + discovered S9
[S9] + discovered S10
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S3
[S9] + discovered S11
[S9] + discovered S17
[S10] + discovered S4
[S10] + discovered S8
[S10] + discovered S6
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S15
[S11] + discovered S6
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S8
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S8
[S13] + discovered S7
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S14
[S13] + discovered S9
[S13] + discovered S5
[S13] + discovered S2
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S13
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S5
[S14] + discovered S9
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S3
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S14
[S15] + discovered S11
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S5
[S14] + discovered S17
[S15] + discovered S13
[S15] + discovered S6
[S16] + discovered S6
[S16] + discovered S5
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S10
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S9
[S15] + discovered S17
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S7
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S13
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:61812
[S3] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:61804
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61815
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S5] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:61809
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] START round=1 head_norm_before_train=1.187963 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6264509862398476, 'loss_val': 1.3260379856007658, 'psi': 0.3356466745290791}-{'f1_val': 0.3157013402667757, 'auprc': 0.4024472970321441, 'loss_val': 1.372541866698834, 'psi': 0.3503997229729231}
[S3] START round=1 head_norm_before_train=1.200267 (no previous merge yet)
[S3] round=1 local utility u=0.344159 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6036136879641654, 'loss_val': 1.3523095456680723, 'psi': 0.3253495145541304}-{'f1_val': 0.13984006561410703, 'auprc': 0.3843745756105098, 'loss_val': 1.3829109654645555, 'psi': 0.23765386961266816}
[S4] START round=1 head_norm_before_train=1.211784 (no previous merge yet)
[S4] round=1 local utility u=1.000000 metrics={'f1_val': 0.6842094503937571, 'auprc': 0.6325644088000487, 'loss_val': 1.3357648005355787, 'psi': 0.6635514337562738}-{'f1_val': 0.1056786703601108, 'auprc': 0.5759931258434297, 'loss_val': 1.37022821098458, 'psi': 0.29380445255343834}
[S5] START round=1 head_norm_before_train=1.170763 (no previous merge yet)
[S5] round=1 local utility u=0.830210 metrics={'f1_val': 0.3936221224373692, 'auprc': 0.7455386052424837, 'loss_val': 1.3204986407166097, 'psi': 0.534388715559415}-{'f1_val': 0.10408432147562582, 'auprc': 0.7828927893676719, 'loss_val': 1.3557541733457883, 'psi': 0.3756077086324443}
[S6] START round=1 head_norm_before_train=1.199691 (no previous merge yet)
[S6] round=1 local utility u=0.034450 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.543133246441468, 'loss_val': 1.327056899373024, 'psi': 0.3021090678073564}-{'f1_val': 0.14142628205128205, 'auprc': 0.5311557517845475, 'loss_val': 1.3600234903179529, 'psi': 0.29731806994458826}
[S7] START round=1 head_norm_before_train=1.172463 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7509500732108736, 'loss_val': 1.3195459003287562, 'psi': 0.38561412292180447}-{'f1_val': 0.2146453858920347, 'auprc': 0.6268873999345808, 'loss_val': 1.3496401201115509, 'psi': 0.3795421915090531}
[S8] START round=1 head_norm_before_train=1.123067 (no previous merge yet)
[S8] round=1 local utility u=0.514171 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7644960630569764, 'loss_val': 1.3430072352328306, 'psi': 0.38977201465856487}-{'f1_val': 0.05479960415635824, 'auprc': 0.602597124282733, 'loss_val': 1.3747137354008556, 'psi': 0.27391861220690816}
[S9] START round=1 head_norm_before_train=1.157952 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.14341098649741643, 'auprc': 0.9993989354238164, 'loss_val': 1.307716697204483, 'psi': 0.48580616606797644}-{'f1_val': 0.385738029304422, 'auprc': 0.791591868603748, 'loss_val': 1.347511780202988, 'psi': 0.5480795650241524}
[S10] START round=1 head_norm_before_train=1.162528 (no previous merge yet)
[S10] round=1 local utility u=1.000000 metrics={'f1_val': 0.37794764067181175, 'auprc': 0.5742067741042488, 'loss_val': 1.3589318125041863, 'psi': 0.45645129404478657}-{'f1_val': 0.0010964912280701754, 'auprc': 0.39559254502729546, 'loss_val': 1.389113244722816, 'psi': 0.1588949127477603}
[S11] START round=1 head_norm_before_train=1.181318 (no previous merge yet)
[S11] round=1 local utility u=0.317375 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8019512411236307, 'loss_val': 1.292721680620402, 'psi': 0.4050287064733186}-{'f1_val': 0.14041368337311058, 'auprc': 0.6003721816024173, 'loss_val': 1.322733662098641, 'psi': 0.3243970826648333}
[S13] START round=1 head_norm_before_train=1.163423 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5959752565578338, 'loss_val': 1.3217438193821751, 'psi': 0.3226215601693654}-{'f1_val': 0.3808651913847318, 'auprc': 0.5313374185505235, 'loss_val': 1.3509212849051389, 'psi': 0.4410540822510485}
[S14] START round=1 head_norm_before_train=1.182299 (no previous merge yet)
[S14] round=1 local utility u=0.395265 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6633518043661054, 'loss_val': 1.3525899643115016, 'psi': 0.34955543347606444}-{'f1_val': 0.14035785288270378, 'auprc': 0.4080767191034623, 'loss_val': 1.3772947943638607, 'psi': 0.24744539937100718}
[S15] START round=1 head_norm_before_train=1.129001 (no previous merge yet)
[S15] round=1 local utility u=0.740218 metrics={'f1_val': 0.2542519958347796, 'auprc': 0.7665541207364913, 'loss_val': 1.3382304210098037, 'psi': 0.45917284579546425}-{'f1_val': 0.103651869669801, 'auprc': 0.5858298818585936, 'loss_val': 1.372893907465844, 'psi': 0.29652307454531807}
[S16] START round=1 head_norm_before_train=1.205035 (no previous merge yet)
[S16] round=1 local utility u=0.027179 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7839459558240582, 'loss_val': 1.332388420115816, 'psi': 0.39796085244914525}-{'f1_val': 0.14063745019920318, 'auprc': 0.7768961678642088, 'loss_val': 1.3655966570691338, 'psi': 0.3951409372652055}
[S17] START round=1 head_norm_before_train=1.133794 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.47662631149875906, 'loss_val': 1.3486579537629906, 'psi': 0.27521990258993423}-{'f1_val': 0.5745647209118026, 'auprc': 0.4588183196492407, 'loss_val': 1.3796852408504745, 'psi': 0.5282661604067778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S3@127.0.0.1:61803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S4] → sending delta(kind=head bytes=1785) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S7@127.0.0.1:61808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:61816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:61803
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:61805
[S11] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1785 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1785 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1786 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1786) from S6
[S7] cosine check vs S6: cos=-0.0196
[S7] DROPPED delta from S6 (cos=-0.0196 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1785) from S10
[S3] cosine check vs S10: cos=-0.0343
[S3] DROPPED delta from S10 (cos=-0.0343 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1786) from S15
[S16] cosine check vs S15: cos=-0.0444
[S16] DROPPED delta from S15 (cos=-0.0444 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S16
[S5] cosine check vs S16: cos=0.0428
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] cosine check vs S5: cos=0.0011
[S16] RECEIVED delta(kind=head bytes=1785) from S4
[S16] cosine check vs S4: cos=0.0841
[S10] RECEIVED delta(kind=head bytes=1790) from S8
[S10] cosine check vs S8: cos=0.0350
[S9] RECEIVED delta(kind=head bytes=1790) from S14
[S9] cosine check vs S14: cos=0.0360
[S3] RECEIVED delta(kind=head bytes=1790) from S11
[S3] cosine check vs S11: cos=-0.0062
[S3] DROPPED delta from S11 (cos=-0.0062 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1790) from S3
[S13] cosine check vs S3: cos=0.0653
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1434 head_norm=1.176350
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.205849e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.7003 head_norm=0.850717 delta_norm=0.820585
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.176342
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.149317e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.869949 delta_norm=0.814932
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.211699
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.260374e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.898697 delta_norm=0.826037
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.3779 head_norm=1.173421
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.179648e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1690 head_norm=0.734541 delta_norm=0.717965
[S10] aggregate: ROLLBACK (f1_val pre=0.378 post=0.169 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.3936 head_norm=1.184366
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.288578e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.865138 delta_norm=0.828858
[S5] aggregate: ROLLBACK (f1_val pre=0.394 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.199771 (no previous merge yet)
[S2] round=2 local utility u=0.021469 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6229051925605332, 'loss_val': 1.2724632298565084, 'psi': 0.3342283570573533}-{'f1_val': 0.1417771333885667, 'auprc': 0.6264509862398476, 'loss_val': 1.3260379856007658, 'psi': 0.3356466745290791}
[S3] START round=2 head_norm_before_train=1.207505 (no previous merge yet)
[S3] round=2 local utility u=0.461577 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9005738915660316, 'loss_val': 1.3200363963133965, 'psi': 0.4441335959948769}-{'f1_val': 0.13984006561410703, 'auprc': 0.6036136879641654, 'loss_val': 1.3523095456680723, 'psi': 0.3253495145541304}
[S4] START round=2 head_norm_before_train=1.229541 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.41234085793469244, 'auprc': 0.642527892987965, 'loss_val': 1.2959337869656302, 'psi': 0.5044156719560015}-{'f1_val': 0.6842094503937571, 'auprc': 0.6325644088000487, 'loss_val': 1.3357648005355787, 'psi': 0.6635514337562738}
[S5] START round=2 head_norm_before_train=0.865138 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7350868462818989, 'loss_val': 1.3204780238477911, 'psi': 0.37939188136990243}-{'f1_val': 0.3936221224373692, 'auprc': 0.7455386052424837, 'loss_val': 1.3204986407166097, 'psi': 0.534388715559415}
[S6] START round=2 head_norm_before_train=1.209626 (no previous merge yet)
[S6] round=2 local utility u=0.461835 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8399589699776366, 'loss_val': 1.293864980758862, 'psi': 0.42083935722182386}-{'f1_val': 0.14142628205128205, 'auprc': 0.543133246441468, 'loss_val': 1.327056899373024, 'psi': 0.3021090678073564}
[S7] START round=2 head_norm_before_train=1.187211 (no previous merge yet)
[S7] round=2 local utility u=0.053856 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776553609388733, 'loss_val': 1.2886437413899035, 'psi': 0.3958555373929482}-{'f1_val': 0.14205682272909165, 'auprc': 0.7509500732108736, 'loss_val': 1.3195459003287562, 'psi': 0.38561412292180447}
[S8] START round=2 head_norm_before_train=1.135487 (no previous merge yet)
[S8] round=2 local utility u=0.033779 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7748225261321792, 'loss_val': 1.3064278633581157, 'psi': 0.393902599888646}-{'f1_val': 0.13995598239295717, 'auprc': 0.7644960630569764, 'loss_val': 1.3430072352328306, 'psi': 0.38977201465856487}
[S9] START round=2 head_norm_before_train=0.850717 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655666592323596, 'loss_val': 1.3121444706862475, 'psi': 0.43106543797694147}-{'f1_val': 0.14341098649741643, 'auprc': 0.9993989354238164, 'loss_val': 1.307716697204483, 'psi': 0.48580616606797644}
[S10] START round=2 head_norm_before_train=0.734541 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5652952339669901, 'loss_val': 1.3508484482768857, 'psi': 0.3092910761118304}-{'f1_val': 0.37794764067181175, 'auprc': 0.5742067741042488, 'loss_val': 1.3589318125041863, 'psi': 0.45645129404478657}
[S11] START round=2 head_norm_before_train=1.199716 (no previous merge yet)
[S11] round=2 local utility u=0.016062 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8010501773461699, 'loss_val': 1.2578936614355969, 'psi': 0.4046682809623343}-{'f1_val': 0.14041368337311058, 'auprc': 0.8019512411236307, 'loss_val': 1.292721680620402, 'psi': 0.4050287064733186}
[S13] START round=2 head_norm_before_train=0.869949 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.179242 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7146069953613934, 'loss_val': 1.3191543368397176, 'psi': 0.3700742556907892}-{'f1_val': 0.1403857625770531, 'auprc': 0.5959752565578338, 'loss_val': 1.3217438193821751, 'psi': 0.3226215601693654}
[S14] START round=2 head_norm_before_train=1.187585 (no previous merge yet)
[S14] round=2 local utility u=0.221200 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8023084465957792, 'loss_val': 1.327059382980155, 'psi': 0.4051380903679339}-{'f1_val': 0.14035785288270378, 'auprc': 0.6633518043661054, 'loss_val': 1.3525899643115016, 'psi': 0.34955543347606444}
[S15] START round=2 head_norm_before_train=1.142265 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7675061100625379, 'loss_val': 1.294641026294018, 'psi': 0.3908426348419502}-{'f1_val': 0.2542519958347796, 'auprc': 0.7665541207364913, 'loss_val': 1.3382304210098037, 'psi': 0.45917284579546425}
[S16] START round=2 head_norm_before_train=0.898697 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.007086 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.785383768167364, 'loss_val': 1.3225301810407968, 'psi': 0.3985359773864675}-{'f1_val': 0.14063745019920318, 'auprc': 0.7839459558240582, 'loss_val': 1.332388420115816, 'psi': 0.39796085244914525}
[S17] START round=2 head_norm_before_train=1.144682 (no previous merge yet)
[S17] round=2 local utility u=0.067646 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5094770711889895, 'loss_val': 1.3119189293003486, 'psi': 0.28836020646602645}-{'f1_val': 0.14094896331738438, 'auprc': 0.47662631149875906, 'loss_val': 1.3486579537629906, 'psi': 0.27521990258993423}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:61802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S8
[S5] cosine check vs S8: cos=0.0236
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.5323
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.1594
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=0.1038
[S10] RECEIVED delta(kind=head bytes=1792) from S14
[S10] cosine check vs S14: cos=0.0396
[S16] RECEIVED delta(kind=head bytes=1789) from S2
[S16] cosine check vs S2: cos=0.0318
[S11] RECEIVED delta(kind=head bytes=1788) from S7
[S11] cosine check vs S7: cos=0.0979
[S2] RECEIVED delta(kind=head bytes=1790) from S3
[S2] cosine check vs S3: cos=0.0040
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.0192
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:61804
[S17] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S17
[S4] cosine check vs S17: cos=-0.0341
[S4] DROPPED delta from S17 (cos=-0.0341 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=0.882167
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.624488e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.663812 delta_norm=0.462449
[S5] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.873941
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.456316e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.759297 delta_norm=0.745632
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.751335
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.963205e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.721570 delta_norm=0.696321
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.217035
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.612360e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.864725 delta_norm=0.861236
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=0.914622
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.678589e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.618365 delta_norm=0.567859
[S16] aggregate: ACCEPT kept=['S13', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.225244
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.172631e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.901602 delta_norm=0.817263
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.155736
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.735250e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.4116 head_norm=0.908199 delta_norm=0.773525
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.864725 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000655 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6195155365540823, 'loss_val': 1.2609849516140448, 'psi': 0.332872494654773}-{'f1_val': 0.1417771333885667, 'auprc': 0.6229051925605332, 'loss_val': 1.2724632298565084, 'psi': 0.3342283570573533}
[S3] START round=3 head_norm_before_train=1.223838 (no previous merge yet)
[S3] round=3 local utility u=0.097163 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9532871606430575, 'loss_val': 1.2838495744807548, 'psi': 0.4652189036256873}-{'f1_val': 0.13984006561410703, 'auprc': 0.9005738915660316, 'loss_val': 1.3200363963133965, 'psi': 0.4441335959948769}
[S4] START round=3 head_norm_before_train=1.256948 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.34383564236712094, 'auprc': 0.7380628136552685, 'loss_val': 1.2424076147450112, 'psi': 0.50152651088238}-{'f1_val': 0.41234085793469244, 'auprc': 0.642527892987965, 'loss_val': 1.2959337869656302, 'psi': 0.5044156719560015}
[S5] START round=3 head_norm_before_train=0.663812 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7314907595733235, 'loss_val': 1.310427821951309, 'psi': 0.3779534466864723}-{'f1_val': 0.14226190476190476, 'auprc': 0.7350868462818989, 'loss_val': 1.3204780238477911, 'psi': 0.37939188136990243}
[S6] START round=3 head_norm_before_train=1.229067 (no previous merge yet)
[S6] round=3 local utility u=0.052798 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.862829904089241, 'loss_val': 1.2568815237061888, 'psi': 0.42998773086646563}-{'f1_val': 0.14142628205128205, 'auprc': 0.8399589699776366, 'loss_val': 1.293864980758862, 'psi': 0.42083935722182386}
[S7] START round=3 head_norm_before_train=1.208464 (no previous merge yet)
[S7] round=3 local utility u=0.016710 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777563303992896, 'loss_val': 1.25883199415591, 'psi': 0.3963366257971708}-{'f1_val': 0.14205682272909165, 'auprc': 0.776553609388733, 'loss_val': 1.2886437413899035, 'psi': 0.3958555373929482}
[S8] START round=3 head_norm_before_train=0.908199 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.077153 metrics={'f1_val': 0.16884923515753544, 'auprc': 0.7676991192727216, 'loss_val': 1.3041107389717013, 'psi': 0.40838918880360997}-{'f1_val': 0.13995598239295717, 'auprc': 0.7748225261321792, 'loss_val': 1.3064278633581157, 'psi': 0.393902599888646}
[S9] START round=3 head_norm_before_train=0.759297 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.202520 metrics={'f1_val': 0.141397957139996, 'auprc': 0.996458617600959, 'loss_val': 1.299779660564139, 'psi': 0.48342222132438123}-{'f1_val': 0.141397957139996, 'auprc': 0.8655666592323596, 'loss_val': 1.3121444706862475, 'psi': 0.43106543797694147}
[S10] START round=3 head_norm_before_train=0.721570 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.38424019741550686, 'loss_val': 1.3607734410002674, 'psi': 0.2368690614912371}-{'f1_val': 0.13862163754172394, 'auprc': 0.5652952339669901, 'loss_val': 1.3508484482768857, 'psi': 0.3092910761118304}
[S11] START round=3 head_norm_before_train=0.901602 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7767689313066825, 'loss_val': 1.262987895838578, 'psi': 0.39495578254653935}-{'f1_val': 0.14041368337311058, 'auprc': 0.8010501773461699, 'loss_val': 1.2578936614355969, 'psi': 0.4046682809623343}
[S13] START round=3 head_norm_before_train=0.889125 cos_to_last_merge=0.9970 (last merge round=1)
[S13] round=3 local utility u=0.022230 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7181472416593003, 'loss_val': 1.2853143723591638, 'psi': 0.37149035420995197}-{'f1_val': 0.1403857625770531, 'auprc': 0.7146069953613934, 'loss_val': 1.3191543368397176, 'psi': 0.3700742556907892}
[S14] START round=3 head_norm_before_train=1.202724 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7789761482294569, 'loss_val': 1.2975081090571243, 'psi': 0.39580517102140506}-{'f1_val': 0.14035785288270378, 'auprc': 0.8023084465957792, 'loss_val': 1.327059382980155, 'psi': 0.4051380903679339}
[S15] START round=3 head_norm_before_train=1.163893 (no previous merge yet)
[S15] round=3 local utility u=0.028370 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7709408880800789, 'loss_val': 1.248205837457952, 'psi': 0.39221654604896655}-{'f1_val': 0.13973365136155833, 'auprc': 0.7675061100625379, 'loss_val': 1.294641026294018, 'psi': 0.3908426348419502}
[S16] START round=3 head_norm_before_train=0.618365 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.061591 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8256741357142503, 'loss_val': 1.3202197906023483, 'psi': 0.41465212440522203}-{'f1_val': 0.14063745019920318, 'auprc': 0.785383768167364, 'loss_val': 1.3225301810407968, 'psi': 0.3985359773864675}
[S17] START round=3 head_norm_before_train=1.165365 (no previous merge yet)
[S17] round=3 local utility u=0.069023 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.538656764402964, 'loss_val': 1.2614112170733014, 'psi': 0.3000320837516162}-{'f1_val': 0.14094896331738438, 'auprc': 0.5094770711889895, 'loss_val': 1.3119189293003486, 'psi': 0.28836020646602645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:61813
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61809
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:61810
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.0717
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.0801
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=0.0225
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] cosine check vs S6: cos=0.0868
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.6174
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=-0.0493
[S15] DROPPED delta from S8 (cos=-0.0493 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.0298
[S11] RECEIVED delta(kind=head bytes=1795) from S9
[S11] cosine check vs S9: cos=0.5784
[S13] RECEIVED delta(kind=head bytes=1790) from S3
[S13] cosine check vs S3: cos=0.7042
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=-0.1157
[S13] DROPPED delta from S17 (cos=-0.1157 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.926264
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.975055e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.759994 delta_norm=0.397506
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.3438 head_norm=1.290980
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.533957e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.6864 head_norm=0.812030 delta_norm=0.753396
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.686366
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.876403e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.739927 delta_norm=0.687640
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.231301
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.398250e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.792460 delta_norm=0.739825
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1688 head_norm=0.927941
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.597846e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.3914 head_norm=0.781867 delta_norm=0.759785
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.783095
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.053483e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4039 head_norm=0.720084 delta_norm=0.705348
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.887336
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.520705e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.689148 delta_norm=0.352070
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.913546
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.433851e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.999702 delta_norm=0.443385
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.689148 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.005508 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6145853474220975, 'loss_val': 1.2351788030688629, 'psi': 0.33090041900197903}-{'f1_val': 0.1417771333885667, 'auprc': 0.6195155365540823, 'loss_val': 1.2609849516140448, 'psi': 0.332872494654773}
[S3] START round=4 head_norm_before_train=1.247968 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9291289860312955, 'loss_val': 1.254432437230897, 'psi': 0.4555556337809824}-{'f1_val': 0.13984006561410703, 'auprc': 0.9532871606430575, 'loss_val': 1.2838495744807548, 'psi': 0.4652189036256873}
[S4] START round=4 head_norm_before_train=0.812030 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.25349390890971246, 'auprc': 0.7428384715207489, 'loss_val': 1.2424567783933567, 'psi': 0.4492317339541271}-{'f1_val': 0.34383564236712094, 'auprc': 0.7380628136552685, 'loss_val': 1.2424076147450112, 'psi': 0.50152651088238}
[S5] START round=4 head_norm_before_train=0.739927 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.021640 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7379953277267908, 'loss_val': 1.2866609207287558, 'psi': 0.38055527394785915}-{'f1_val': 0.14226190476190476, 'auprc': 0.7314907595733235, 'loss_val': 1.310427821951309, 'psi': 0.3779534466864723}
[S6] START round=4 head_norm_before_train=1.252830 (no previous merge yet)
[S6] round=4 local utility u=0.022957 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8635984064640758, 'loss_val': 1.213272353860678, 'psi': 0.43029513181639956}-{'f1_val': 0.14142628205128205, 'auprc': 0.862829904089241, 'loss_val': 1.2568815237061888, 'psi': 0.42998773086646563}
[S7] START round=4 head_norm_before_train=0.792460 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778186816919352, 'loss_val': 1.2668568646764757, 'psi': 0.3963615663142291}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777563303992896, 'loss_val': 1.25883199415591, 'psi': 0.3963366257971708}
[S8] START round=4 head_norm_before_train=0.781867 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.668214 metrics={'f1_val': 0.3915344760648258, 'auprc': 0.7657766785202433, 'loss_val': 1.298026073217806, 'psi': 0.5412313570469929}-{'f1_val': 0.16884923515753544, 'auprc': 0.7676991192727216, 'loss_val': 1.3041107389717013, 'psi': 0.40838918880360997}
[S9] START round=4 head_norm_before_train=0.720084 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.009991 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9999798827980241, 'loss_val': 1.2903606147683628, 'psi': 0.48483072740320726}-{'f1_val': 0.141397957139996, 'auprc': 0.996458617600959, 'loss_val': 1.299779660564139, 'psi': 0.48342222132438123}
[S10] START round=4 head_norm_before_train=0.729820 cos_to_last_merge=0.9957 (last merge round=2)
[S10] round=4 local utility u=0.291917 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5677916123528864, 'loss_val': 1.3275941257546842, 'psi': 0.31028962746618893}-{'f1_val': 0.13862163754172394, 'auprc': 0.38424019741550686, 'loss_val': 1.3607734410002674, 'psi': 0.2368690614912371}
[S11] START round=4 head_norm_before_train=0.759994 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.004122 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7645042165128527, 'loss_val': 1.217949036657016, 'psi': 0.39004989662900746}-{'f1_val': 0.14041368337311058, 'auprc': 0.7767689313066825, 'loss_val': 1.262987895838578, 'psi': 0.39495578254653935}
[S13] START round=4 head_norm_before_train=0.999702 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.008011 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7188127959027917, 'loss_val': 1.2712889432449344, 'psi': 0.3717565759073485}-{'f1_val': 0.1403857625770531, 'auprc': 0.7181472416593003, 'loss_val': 1.2853143723591638, 'psi': 0.37149035420995197}
[S14] START round=4 head_norm_before_train=1.227530 (no previous merge yet)
[S14] round=4 local utility u=0.003366 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7727153383070219, 'loss_val': 1.2719931309033086, 'psi': 0.393300847052431}-{'f1_val': 0.14035785288270378, 'auprc': 0.7789761482294569, 'loss_val': 1.2975081090571243, 'psi': 0.39580517102140506}
[S15] START round=4 head_norm_before_train=1.191149 (no previous merge yet)
[S15] round=4 local utility u=0.031419 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.775959141234237, 'loss_val': 1.20042224217675, 'psi': 0.3942238473106298}-{'f1_val': 0.13973365136155833, 'auprc': 0.7709408880800789, 'loss_val': 1.248205837457952, 'psi': 0.39221654604896655}
[S16] START round=4 head_norm_before_train=0.640618 cos_to_last_merge=0.9954 (last merge round=2)
[S16] round=4 local utility u=0.021139 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.826383905695795, 'loss_val': 1.280070793266236, 'psi': 0.41493603239783994}-{'f1_val': 0.14063745019920318, 'auprc': 0.8256741357142503, 'loss_val': 1.3202197906023483, 'psi': 0.41465212440522203}
[S17] START round=4 head_norm_before_train=1.192495 (no previous merge yet)
[S17] round=4 local utility u=0.038113 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5449620387178166, 'loss_val': 1.2041009569148415, 'psi': 0.3025541934775573}-{'f1_val': 0.14094896331738438, 'auprc': 0.538656764402964, 'loss_val': 1.2614112170733014, 'psi': 0.3000320837516162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:61804
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:61808
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S5
[S13] cosine check vs S5: cos=0.0915
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.7190
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.8131
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=0.0024
[S7] RECEIVED delta(kind=head bytes=1792) from S13
[S7] cosine check vs S13: cos=0.5568
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.8308
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=0.0885
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.0257
[S7] DROPPED delta from S14 (cos=-0.0257 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=0.8679
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] cosine check vs S9: cos=0.4827
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.0645
[S15] DROPPED delta from S8 (cos=-0.0645 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S17
[S13] cosine check vs S17: cos=-0.0970
[S13] DROPPED delta from S17 (cos=-0.0970 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.818535
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.416004e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.812170 delta_norm=0.441600
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.2535 head_norm=0.843650
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.588370e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.4075 head_norm=0.587852 delta_norm=0.358837
[S4] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.743754
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.762693e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1046 head_norm=0.937803 delta_norm=0.376269
[S9] aggregate: ROLLBACK (f1_val pre=0.141 post=0.105 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=1.019442
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.075063e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.663336 delta_norm=0.607506
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.795394
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.920144e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.662748 delta_norm=0.392014
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.712403
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.023792e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.662991 delta_norm=0.202379
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.760852
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.824698e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.726928 delta_norm=0.282470
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.662991 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.014942 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6129365137654302, 'loss_val': 1.2003480538887343, 'psi': 0.33024088553931213}-{'f1_val': 0.1417771333885667, 'auprc': 0.6145853474220975, 'loss_val': 1.2351788030688629, 'psi': 0.33090041900197903}
[S3] START round=5 head_norm_before_train=1.273556 (no previous merge yet)
[S3] round=5 local utility u=0.019029 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9292806500140438, 'loss_val': 1.2168288212782061, 'psi': 0.45561629937408177}-{'f1_val': 0.13984006561410703, 'auprc': 0.9291289860312955, 'loss_val': 1.254432437230897, 'psi': 0.4555556337809824}
[S4] START round=5 head_norm_before_train=0.587852 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.076440 metrics={'f1_val': 0.2624634889427322, 'auprc': 0.7635764791217444, 'loss_val': 1.2056083143210004, 'psi': 0.46290868501433713}-{'f1_val': 0.25349390890971246, 'auprc': 0.7428384715207489, 'loss_val': 1.2424567783933567, 'psi': 0.4492317339541271}
[S5] START round=5 head_norm_before_train=0.726928 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6951271508279182, 'loss_val': 1.2693460326049963, 'psi': 0.3634080031883101}-{'f1_val': 0.14226190476190476, 'auprc': 0.7379953277267908, 'loss_val': 1.2866609207287558, 'psi': 0.38055527394785915}
[S6] START round=5 head_norm_before_train=1.277796 (no previous merge yet)
[S6] round=5 local utility u=0.035531 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8638111290039033, 'loss_val': 1.1428485654502072, 'psi': 0.4303802208323306}-{'f1_val': 0.14142628205128205, 'auprc': 0.8635984064640758, 'loss_val': 1.213272353860678, 'psi': 0.43029513181639956}
[S7] START round=5 head_norm_before_train=0.812170 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.002042 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778658447388391, 'loss_val': 1.2629150938451195, 'psi': 0.3963804315329907}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778186816919352, 'loss_val': 1.2668568646764757, 'psi': 0.3963615663142291}
[S8] START round=5 head_norm_before_train=0.802547 cos_to_last_merge=0.9965 (last merge round=3)
[S8] round=5 local utility u=0.123870 metrics={'f1_val': 0.42266693760322427, 'auprc': 0.7658137879728423, 'loss_val': 1.2371931398243865, 'psi': 0.5599256777510715}-{'f1_val': 0.3915344760648258, 'auprc': 0.7657766785202433, 'loss_val': 1.298026073217806, 'psi': 0.5412313570469929}
[S9] START round=5 head_norm_before_train=0.937803 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.019129 metrics={'f1_val': 0.141397957139996, 'auprc': 0.999980398218741, 'loss_val': 1.2521039717080307, 'psi': 0.48483093357149404}-{'f1_val': 0.141397957139996, 'auprc': 0.9999798827980241, 'loss_val': 1.2903606147683628, 'psi': 0.48483072740320726}
[S10] START round=5 head_norm_before_train=0.748456 cos_to_last_merge=0.9837 (last merge round=2)
[S10] round=5 local utility u=0.067396 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5954646996612808, 'loss_val': 1.2758223732350904, 'psi': 0.3213588623895467}-{'f1_val': 0.13862163754172394, 'auprc': 0.5677916123528864, 'loss_val': 1.3275941257546842, 'psi': 0.31028962746618893}
[S11] START round=5 head_norm_before_train=0.662748 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.509078 metrics={'f1_val': 0.3514993326712869, 'auprc': 0.6643954500143366, 'loss_val': 1.1659807111659268, 'psi': 0.47665777960850675}-{'f1_val': 0.14041368337311058, 'auprc': 0.7645042165128527, 'loss_val': 1.217949036657016, 'psi': 0.39004989662900746}
[S13] START round=5 head_norm_before_train=0.663336 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7029112888758152, 'loss_val': 1.2581544382220309, 'psi': 0.36539597309655797}-{'f1_val': 0.1403857625770531, 'auprc': 0.7188127959027917, 'loss_val': 1.2712889432449344, 'psi': 0.3717565759073485}
[S14] START round=5 head_norm_before_train=1.253435 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.704804808877534, 'loss_val': 1.2406980894636581, 'psi': 0.3661366352806359}-{'f1_val': 0.14035785288270378, 'auprc': 0.7727153383070219, 'loss_val': 1.2719931309033086, 'psi': 0.393300847052431}
[S15] START round=5 head_norm_before_train=1.220220 (no previous merge yet)
[S15] round=5 local utility u=0.549031 metrics={'f1_val': 0.3107179523190275, 'auprc': 0.7768106131391287, 'loss_val': 1.1308196487391224, 'psi': 0.49715501664706796}-{'f1_val': 0.13973365136155833, 'auprc': 0.775959141234237, 'loss_val': 1.20042224217675, 'psi': 0.3942238473106298}
[S16] START round=5 head_norm_before_train=0.673431 cos_to_last_merge=0.9819 (last merge round=2)
[S16] round=5 local utility u=0.035262 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8333644129834413, 'loss_val': 1.2304874116299438, 'psi': 0.4177282353128985}-{'f1_val': 0.14063745019920318, 'auprc': 0.826383905695795, 'loss_val': 1.280070793266236, 'psi': 0.41493603239783994}
[S17] START round=5 head_norm_before_train=1.225401 (no previous merge yet)
[S17] round=5 local utility u=0.058566 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5479463248382026, 'loss_val': 1.0959220934475373, 'psi': 0.3037479079257117}-{'f1_val': 0.14094896331738438, 'auprc': 0.5449620387178166, 'loss_val': 1.2041009569148415, 'psi': 0.3025541934775573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:61804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[S9] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.9551
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.3922
[S11] RECEIVED delta(kind=head bytes=1788) from S9
[S11] cosine check vs S9: cos=0.6277
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=0.2802
[S13] RECEIVED delta(kind=head bytes=1795) from S3
[S13] cosine check vs S3: cos=0.7438
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=0.3145
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=0.9109
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=-0.0692
[S15] DROPPED delta from S8 (cos=-0.0692 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S2
[S4] cosine check vs S2: cos=0.7724
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9217
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=-0.0185
[S11] DROPPED delta from S4 (cos=-0.0185 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0415
[S13] DROPPED delta from S17 (cos=-0.0415 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.691687
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.559391e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.936442 delta_norm=0.455939
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.350 → S7@127.0.0.1:61808
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.749361
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.608574e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.744605 delta_norm=0.160857
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.399 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.383 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.395 → S5@127.0.0.1:61805
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.2625 head_norm=0.627407
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.030760e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4090 head_norm=0.526162 delta_norm=0.203076
[S4] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.425 → S11@127.0.0.1:61812
[S7] ⇄ pheromone p=0.336 → S8@127.0.0.1:61809
[S15] ⇄ pheromone p=0.507 → S9@127.0.0.1:61810
[S16] ⇄ pheromone p=0.349 → S2@127.0.0.1:61802
[S3] ⇄ pheromone p=0.419 → S13@127.0.0.1:61813
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.4227 head_norm=0.830046
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.576583e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.692641 delta_norm=0.457658
[S8] aggregate: ROLLBACK (f1_val pre=0.423 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.515 → S15@127.0.0.1:61815
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.955968
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.195582e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.3984 head_norm=1.090141 delta_norm=0.219558
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.359 → S11@127.0.0.1:61812
[S10] ⇄ pheromone p=0.470 → S4@127.0.0.1:61804
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.689637
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.395403e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.688465 delta_norm=0.139540
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.334 → S4@127.0.0.1:61804
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.3515 head_norm=0.700468
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.754643e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.4228 head_norm=0.749194 delta_norm=0.375464
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.458 → S5@127.0.0.1:61805
[S17] ⇄ pheromone p=0.361 → S13@127.0.0.1:61813
[S2] START round=6 head_norm_before_train=0.688465 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.033142 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6133087302503007, 'loss_val': 1.1351805756452529, 'psi': 0.3303897721332603}-{'f1_val': 0.1417771333885667, 'auprc': 0.6129365137654302, 'loss_val': 1.2003480538887343, 'psi': 0.33024088553931213}
[S3] START round=6 head_norm_before_train=1.300453 (no previous merge yet)
[S3] round=6 local utility u=0.123463 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9841742562855615, 'loss_val': 1.1345841190331492, 'psi': 0.47757374188268886}-{'f1_val': 0.13984006561410703, 'auprc': 0.9292806500140438, 'loss_val': 1.2168288212782061, 'psi': 0.45561629937408177}
[S4] START round=6 head_norm_before_train=0.526162 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.496708 metrics={'f1_val': 0.4143997657321641, 'auprc': 0.7661683089944588, 'loss_val': 1.131584890842718, 'psi': 0.555107183037082}-{'f1_val': 0.2624634889427322, 'auprc': 0.7635764791217444, 'loss_val': 1.2056083143210004, 'psi': 0.46290868501433713}
[S5] START round=6 head_norm_before_train=0.744605 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.069761 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7360350475478776, 'loss_val': 1.2525483202795458, 'psi': 0.3797711618762939}-{'f1_val': 0.14226190476190476, 'auprc': 0.6951271508279182, 'loss_val': 1.2693460326049963, 'psi': 0.3634080031883101}
[S6] START round=6 head_norm_before_train=1.306906 (no previous merge yet)
[S6] round=6 local utility u=0.897980 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.8644004285465443, 'loss_val': 0.9976141346116355, 'psi': 0.5955116727930672}-{'f1_val': 0.14142628205128205, 'auprc': 0.8638111290039033, 'loss_val': 1.1428485654502072, 'psi': 0.4303802208323306}
[S7] START round=6 head_norm_before_train=0.830319 cos_to_last_merge=0.9977 (last merge round=4)
[S7] round=6 local utility u=0.019616 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778542901745028, 'loss_val': 1.2236476526381608, 'psi': 0.3963758097072561}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778658447388391, 'loss_val': 1.2629150938451195, 'psi': 0.3963804315329907}
[S8] START round=6 head_norm_before_train=0.692641 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658089964198038, 'loss_val': 1.2093676983603185, 'psi': 0.3902971880036959}-{'f1_val': 0.42266693760322427, 'auprc': 0.7658137879728423, 'loss_val': 1.2371931398243865, 'psi': 0.5599256777510715}
[S9] START round=6 head_norm_before_train=1.090141 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.004082 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9891658703415717, 'loss_val': 1.2114957499491077, 'psi': 0.4805051224206263}-{'f1_val': 0.141397957139996, 'auprc': 0.999980398218741, 'loss_val': 1.2521039717080307, 'psi': 0.48483093357149404}
[S10] START round=6 head_norm_before_train=0.779180 cos_to_last_merge=0.9653 (last merge round=2)
[S10] round=6 local utility u=0.024632 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5975325433525631, 'loss_val': 1.2327625764530077, 'psi': 0.3221859998660596}-{'f1_val': 0.13862163754172394, 'auprc': 0.5954646996612808, 'loss_val': 1.2758223732350904, 'psi': 0.3213588623895467}
[S11] START round=6 head_norm_before_train=0.749194 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.392618 metrics={'f1_val': 0.4158288004761874, 'auprc': 0.7660681800000434, 'loss_val': 1.071739212619981, 'psi': 0.5559245522857299}-{'f1_val': 0.3514993326712869, 'auprc': 0.6643954500143366, 'loss_val': 1.1659807111659268, 'psi': 0.47665777960850675}
[S13] START round=6 head_norm_before_train=0.936442 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.061275 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7250115032640946, 'loss_val': 1.201904832986047, 'psi': 0.37423605885186967}-{'f1_val': 0.1403857625770531, 'auprc': 0.7029112888758152, 'loss_val': 1.2581544382220309, 'psi': 0.36539597309655797}
[S14] START round=6 head_norm_before_train=1.281702 (no previous merge yet)
[S14] round=6 local utility u=0.200356 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8148610647807337, 'loss_val': 1.1701542446178497, 'psi': 0.41015913764191575}-{'f1_val': 0.14035785288270378, 'auprc': 0.704804808877534, 'loss_val': 1.2406980894636581, 'psi': 0.3661366352806359}
[S15] START round=6 head_norm_before_train=1.248740 (no previous merge yet)
[S15] round=6 local utility u=0.397477 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7960126048384645, 'loss_val': 1.0306781776085625, 'psi': 0.5685564600475032}-{'f1_val': 0.3107179523190275, 'auprc': 0.7768106131391287, 'loss_val': 1.1308196487391224, 'psi': 0.49715501664706796}
[S16] START round=6 head_norm_before_train=0.715061 cos_to_last_merge=0.9632 (last merge round=2)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8094788350022133, 'loss_val': 1.1891959759481234, 'psi': 0.4081740041204073}-{'f1_val': 0.14063745019920318, 'auprc': 0.8333644129834413, 'loss_val': 1.2304874116299438, 'psi': 0.4177282353128985}
[S17] START round=6 head_norm_before_train=1.256014 (no previous merge yet)
[S17] round=6 local utility u=0.911967 metrics={'f1_val': 0.39183458374649976, 'auprc': 0.6323566603475708, 'loss_val': 1.0305338182684143, 'psi': 0.48804341438692816}-{'f1_val': 0.14094896331738438, 'auprc': 0.5479463248382026, 'loss_val': 1.0959220934475373, 'psi': 0.3037479079257117}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.8240
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.7161
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.0240
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=0.2628
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=0.8522
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] cosine check vs S6: cos=0.9037
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.9566
[S7] RECEIVED delta(kind=head bytes=1785) from S13
[S7] cosine check vs S13: cos=0.8104
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.9794
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=0.3155
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.4776
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0280
[S11] DROPPED delta from S4 (cos=-0.0280 < 0.0)
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0671
[S13] DROPPED delta from S17 (cos=-0.0671 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.717579
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.404360e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.747809 delta_norm=0.240436
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4158 head_norm=0.781372
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.009196e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4150 head_norm=0.909955 delta_norm=0.300920
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.848019
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.275651e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.724913 delta_norm=0.427565
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=0.958418
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.850375e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.860418 delta_norm=0.185037
[S13] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4144 head_norm=0.570353
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.367318e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4148 head_norm=0.525239 delta_norm=0.136732
[S4] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=1.107520
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.465411e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.184832 delta_norm=0.146541
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.768424
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.548595e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.764713 delta_norm=0.154860
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.718022 cos_to_last_merge=0.9942 (last merge round=5)
[S2] round=7 local utility u=0.892214 metrics={'f1_val': 0.34167538848978307, 'auprc': 0.7779544914597913, 'loss_val': 1.0440786074547732, 'psi': 0.5161870296777864}-{'f1_val': 0.1417771333885667, 'auprc': 0.6133087302503007, 'loss_val': 1.1351805756452529, 'psi': 0.3303897721332603}
[S3] START round=7 head_norm_before_train=1.329175 (no previous merge yet)
[S3] round=7 local utility u=0.580581 metrics={'f1_val': 0.3008095151915623, 'auprc': 0.9990783508008168, 'loss_val': 0.9839501321231262, 'psi': 0.5801170494352641}-{'f1_val': 0.13984006561410703, 'auprc': 0.9841742562855615, 'loss_val': 1.1345841190331492, 'psi': 0.47757374188268886}
[S4] START round=7 head_norm_before_train=0.525239 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.027765 metrics={'f1_val': 0.4135850819951855, 'auprc': 0.7614328738875142, 'loss_val': 1.0569606192899723, 'psi': 0.552724198752117}-{'f1_val': 0.4143997657321641, 'auprc': 0.7661683089944588, 'loss_val': 1.131584890842718, 'psi': 0.555107183037082}
[S5] START round=7 head_norm_before_train=0.764713 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.048636 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7502541852107193, 'loss_val': 1.1979333263103926, 'psi': 0.3854588169414306}-{'f1_val': 0.14226190476190476, 'auprc': 0.7360350475478776, 'loss_val': 1.2525483202795458, 'psi': 0.3797711618762939}
[S6] START round=7 head_norm_before_train=1.342320 (no previous merge yet)
[S6] round=7 local utility u=0.079837 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.8628438269389241, 'loss_val': 0.8380885920603797, 'psi': 0.5953709535000901}-{'f1_val': 0.41625250229074906, 'auprc': 0.8644004285465443, 'loss_val': 0.9976141346116355, 'psi': 0.5955116727930672}
[S7] START round=7 head_norm_before_train=0.724913 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7729583114357231, 'loss_val': 1.2120590679162717, 'psi': 0.39441741821174425}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778542901745028, 'loss_val': 1.2236476526381608, 'psi': 0.3963758097072561}
[S8] START round=7 head_norm_before_train=0.747809 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.215287 metrics={'f1_val': 0.20058830879840664, 'auprc': 0.7658015169529326, 'loss_val': 1.1425644360590559, 'psi': 0.42667359206021704}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658089964198038, 'loss_val': 1.2093676983603185, 'psi': 0.3902971880036959}
[S9] START round=7 head_norm_before_train=1.184832 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8041412537935075, 'loss_val': 1.1395645587201235, 'psi': 0.40649527580140066}-{'f1_val': 0.141397957139996, 'auprc': 0.9891658703415717, 'loss_val': 1.2114957499491077, 'psi': 0.4805051224206263}
[S10] START round=7 head_norm_before_train=0.811640 cos_to_last_merge=0.9463 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=7 local utility u=0.029583 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5975191903123653, 'loss_val': 1.1735565586681993, 'psi': 0.32218065864998047}-{'f1_val': 0.13862163754172394, 'auprc': 0.5975325433525631, 'loss_val': 1.2327625764530077, 'psi': 0.3221859998660596}
[S11] START round=7 head_norm_before_train=0.909955 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.309091 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9593992198709658, 'loss_val': 0.9381297436664776, 'psi': 0.6237149396298496}-{'f1_val': 0.4158288004761874, 'auprc': 0.7660681800000434, 'loss_val': 1.071739212619981, 'psi': 0.5559245522857299}
[S13] START round=7 head_norm_before_train=0.860418 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.881833 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.7390810179506665, 'loss_val': 1.1346007712777042, 'psi': 0.5452791355090416}-{'f1_val': 0.1403857625770531, 'auprc': 0.7250115032640946, 'loss_val': 1.201904832986047, 'psi': 0.37423605885186967}
[S14] START round=7 head_norm_before_train=1.310184 (no previous merge yet)
[S14] round=7 local utility u=0.221494 metrics={'f1_val': 0.15374564459930315, 'auprc': 0.9048965682792753, 'loss_val': 1.077599604345184, 'psi': 0.454206014071292}-{'f1_val': 0.14035785288270378, 'auprc': 0.8148610647807337, 'loss_val': 1.1701542446178497, 'psi': 0.41015913764191575}
[S15] START round=7 head_norm_before_train=1.274363 (no previous merge yet)
[S15] round=7 local utility u=0.106629 metrics={'f1_val': 0.4178289890384971, 'auprc': 0.799844899304256, 'loss_val': 0.8343762742103786, 'psi': 0.5706353531448006}-{'f1_val': 0.41691903018686227, 'auprc': 0.7960126048384645, 'loss_val': 1.0306781776085625, 'psi': 0.5685564600475032}
[S16] START round=7 head_norm_before_train=0.754624 cos_to_last_merge=0.9459 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=7 local utility u=0.873209 metrics={'f1_val': 0.41625059973887696, 'auprc': 0.8130353982867332, 'loss_val': 1.1071259066257293, 'psi': 0.5749645191580195}-{'f1_val': 0.14063745019920318, 'auprc': 0.8094788350022133, 'loss_val': 1.1891959759481234, 'psi': 0.4081740041204073}
[S17] START round=7 head_norm_before_train=1.291078 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.37894390062422784, 'auprc': 0.5310229150640173, 'loss_val': 0.8696566397880847, 'psi': 0.4397755064001436}-{'f1_val': 0.39183458374649976, 'auprc': 0.6323566603475708, 'loss_val': 1.0305338182684143, 'psi': 0.48804341438692816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=0.9861
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=0.9212
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] cosine check vs S6: cos=0.8923
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=-0.0327
[S15] DROPPED delta from S8 (cos=-0.0327 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.4739
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0573
[S11] DROPPED delta from S4 (cos=-0.0573 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] cosine check vs S11: cos=0.3550
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=0.3892
[S13] RECEIVED delta(kind=head bytes=1798) from S3
[S13] cosine check vs S3: cos=0.9254
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.5748
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.6751
[S7] RECEIVED delta(kind=head bytes=1790) from S13
[S7] cosine check vs S13: cos=0.8122
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=1.202755
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.181402e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.1414 head_norm=1.252848 delta_norm=0.118140
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.746616
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.461010e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.752581 delta_norm=0.246101
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.782218
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.492817e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=0.796315 delta_norm=0.149282
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4161 head_norm=0.883985
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.212839e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.841724 delta_norm=0.121284
[S13] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4136 head_norm=0.564228
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.043061e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4135 head_norm=0.539078 delta_norm=0.104306
[S4] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.3417 head_norm=0.754265
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.526565e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4160 head_norm=0.751379 delta_norm=0.152656
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.751379 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.839668 metrics={'f1_val': 0.6053328855349019, 'auprc': 0.7744110826896091, 'loss_val': 0.9360575682994219, 'psi': 0.6729641643967847}-{'f1_val': 0.34167538848978307, 'auprc': 0.7779544914597913, 'loss_val': 1.0440786074547732, 'psi': 0.5161870296777864}
[S3] START round=8 head_norm_before_train=1.367302 (no previous merge yet)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9988628224063967, 'loss_val': 0.7894402082690377, 'psi': 0.8194428584808306}-{'f1_val': 0.3008095151915623, 'auprc': 0.9990783508008168, 'loss_val': 0.9839501321231262, 'psi': 0.5801170494352641}
[S4] START round=8 head_norm_before_train=0.539078 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.4130367737225976, 'auprc': 0.6318140993796011, 'loss_val': 0.9942754262783507, 'psi': 0.5005477039853989}-{'f1_val': 0.4135850819951855, 'auprc': 0.7614328738875142, 'loss_val': 1.0569606192899723, 'psi': 0.552724198752117}
[S5] START round=8 head_norm_before_train=0.796315 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.879480 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.7663348535702655, 'loss_val': 1.1389403810007939, 'psi': 0.5570636798397428}-{'f1_val': 0.14226190476190476, 'auprc': 0.7502541852107193, 'loss_val': 1.1979333263103926, 'psi': 0.3854588169414306}
[S6] START round=8 head_norm_before_train=1.380203 (no previous merge yet)
[S6] round=8 local utility u=0.115774 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.9219484372441953, 'loss_val': 0.7754082321611492, 'psi': 0.6181682460793252}-{'f1_val': 0.41705570454086727, 'auprc': 0.8628438269389241, 'loss_val': 0.8380885920603797, 'psi': 0.5953709535000901}
[S7] START round=8 head_norm_before_train=0.752581 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.017141 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7693301177467572, 'loss_val': 1.166892198294841, 'psi': 0.3929661407361579}-{'f1_val': 0.14205682272909165, 'auprc': 0.7729583114357231, 'loss_val': 1.2120590679162717, 'psi': 0.39441741821174425}
[S8] START round=8 head_norm_before_train=0.773476 cos_to_last_merge=0.9955 (last merge round=6)
[S8] round=8 local utility u=0.601500 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7766192393817911, 'loss_val': 1.0056813030864538, 'psi': 0.5343671160660224}-{'f1_val': 0.20058830879840664, 'auprc': 0.7658015169529326, 'loss_val': 1.1425644360590559, 'psi': 0.42667359206021704}
[S9] START round=8 head_norm_before_train=1.252848 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.904257 metrics={'f1_val': 0.4177305826382898, 'auprc': 0.802886239834922, 'loss_val': 0.985280661099322, 'psi': 0.5717928455169428}-{'f1_val': 0.141397957139996, 'auprc': 0.8041412537935075, 'loss_val': 1.1395645587201235, 'psi': 0.40649527580140066}
[S10] START round=8 head_norm_before_train=0.839075 cos_to_last_merge=0.9306 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=8 local utility u=0.787310 metrics={'f1_val': 0.35808462438994726, 'auprc': 0.6524184142031566, 'loss_val': 1.0804119248925859, 'psi': 0.475818140315231}-{'f1_val': 0.13862163754172394, 'auprc': 0.5975191903123653, 'loss_val': 1.1735565586681993, 'psi': 0.32218065864998047}
[S11] START round=8 head_norm_before_train=0.937508 cos_to_last_merge=0.9937 (last merge round=6)
[S11] round=8 local utility u=0.215940 metrics={'f1_val': 0.44503144602552136, 'auprc': 0.9477228846082557, 'loss_val': 0.7418575728294893, 'psi': 0.6461080214586151}-{'f1_val': 0.39992541946910537, 'auprc': 0.9593992198709658, 'loss_val': 0.9381297436664776, 'psi': 0.6237149396298496}
[S13] START round=8 head_norm_before_train=0.841724 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.37256644414024653, 'auprc': 0.734826730939258, 'loss_val': 1.0392962353617754, 'psi': 0.5174705588598512}-{'f1_val': 0.41607788054795825, 'auprc': 0.7390810179506665, 'loss_val': 1.1346007712777042, 'psi': 0.5452791355090416}
[S14] START round=8 head_norm_before_train=1.344241 (no previous merge yet)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7076645927303818, 'auprc': 0.9695572879022112, 'loss_val': 0.9048262691764581, 'psi': 0.8124216707991136}-{'f1_val': 0.15374564459930315, 'auprc': 0.9048965682792753, 'loss_val': 1.077599604345184, 'psi': 0.454206014071292}
[S15] START round=8 head_norm_before_train=1.311698 (no previous merge yet)
[S15] round=8 local utility u=0.233638 metrics={'f1_val': 0.4629791008530058, 'auprc': 0.8100527099029892, 'loss_val': 0.6686237241042109, 'psi': 0.6018085444729991}-{'f1_val': 0.4178289890384971, 'auprc': 0.799844899304256, 'loss_val': 0.8343762742103786, 'psi': 0.5706353531448006}
[S16] START round=8 head_norm_before_train=0.778995 cos_to_last_merge=0.9329 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.41672208089815915, 'auprc': 0.6153420085902428, 'loss_val': 0.9809696180400161, 'psi': 0.4961700519749926}-{'f1_val': 0.41625059973887696, 'auprc': 0.8130353982867332, 'loss_val': 1.1071259066257293, 'psi': 0.5749645191580195}
[S17] START round=8 head_norm_before_train=1.333557 (no previous merge yet)
[S17] round=8 local utility u=0.163628 metrics={'f1_val': 0.37271890124391427, 'auprc': 0.6497869889078267, 'loss_val': 0.8613434339513741, 'psi': 0.48354613630947924}-{'f1_val': 0.37894390062422784, 'auprc': 0.5310229150640173, 'loss_val': 0.8696566397880847, 'psi': 0.4397755064001436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.6486
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.8661
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=0.4702
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=0.9898
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=0.8958
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0407
[S15] DROPPED delta from S8 (cos=-0.0407 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=0.6135
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.6281
[S13] RECEIVED delta(kind=head bytes=1792) from S3
[S13] cosine check vs S3: cos=0.8996
[S13] RECEIVED delta(kind=head bytes=1796) from S5
[S13] cosine check vs S5: cos=0.4553
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.6867
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0600
[S13] DROPPED delta from S17 (cos=-0.0600 < 0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.3726 head_norm=0.872287
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.044501e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.3721 head_norm=0.852804 delta_norm=0.104450
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.773682
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.130197e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=1.000661 delta_norm=0.513020
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.4130 head_norm=0.582161
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.641279e-02
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.4106 head_norm=0.560435 delta_norm=0.096413
[S4] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4175 head_norm=0.813282
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.011610e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4175 head_norm=0.834018 delta_norm=0.101161
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4450 head_norm=0.977189
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.936023e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.5452 head_norm=1.094752 delta_norm=0.293602
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4177 head_norm=1.270617
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.025003e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7018 head_norm=1.309050 delta_norm=0.102500
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3729 head_norm=0.811583
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.422436e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.5418 head_norm=0.715189 delta_norm=0.342244
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.789567 cos_to_last_merge=0.9951 (last merge round=7)
[S2] round=9 local utility u=0.209095 metrics={'f1_val': 0.7011938325409155, 'auprc': 0.6872829001577099, 'loss_val': 0.8316490397451407, 'psi': 0.6956294595876333}-{'f1_val': 0.6053328855349019, 'auprc': 0.7744110826896091, 'loss_val': 0.9360575682994219, 'psi': 0.6729641643967847}
[S3] START round=9 head_norm_before_train=1.414218 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.6549792499342355, 'auprc': 0.9960707590322945, 'loss_val': 0.5757970794162254, 'psi': 0.7914158535734591}-{'f1_val': 0.69982954919712, 'auprc': 0.9988628224063967, 'loss_val': 0.7894402082690377, 'psi': 0.8194428584808306}
[S4] START round=9 head_norm_before_train=0.560435 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.36872375300113036, 'auprc': 0.6571646127984612, 'loss_val': 0.89529608852404, 'psi': 0.48410009692006273}-{'f1_val': 0.4130367737225976, 'auprc': 0.6318140993796011, 'loss_val': 0.9942754262783507, 'psi': 0.5005477039853989}
[S5] START round=9 head_norm_before_train=0.834018 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.075531 metrics={'f1_val': 0.4174279751372442, 'auprc': 0.7816406366774548, 'loss_val': 1.0330654339779297, 'psi': 0.5631130397533284}-{'f1_val': 0.41754956401939425, 'auprc': 0.7663348535702655, 'loss_val': 1.1389403810007939, 'psi': 0.5570636798397428}
[S6] START round=9 head_norm_before_train=1.415468 (no previous merge yet)
[S6] round=9 local utility u=0.064983 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.9488608545179418, 'loss_val': 0.7334213104626486, 'psi': 0.6296574533334971}-{'f1_val': 0.4156481186360783, 'auprc': 0.9219484372441953, 'loss_val': 0.7754082321611492, 'psi': 0.6181682460793252}
[S7] START round=9 head_norm_before_train=1.000661 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.849432 metrics={'f1_val': 0.41421630438823687, 'auprc': 0.774067414109038, 'loss_val': 1.1151960114195494, 'psi': 0.5581567482765574}-{'f1_val': 0.14205682272909165, 'auprc': 0.7693301177467572, 'loss_val': 1.166892198294841, 'psi': 0.3929661407361579}
[S8] START round=9 head_norm_before_train=0.715189 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.7143313310219598, 'auprc': 0.7710145218342556, 'loss_val': 0.949050828553872, 'psi': 0.7370046073468781}-{'f1_val': 0.3728657005221765, 'auprc': 0.7766192393817911, 'loss_val': 1.0056813030864538, 'psi': 0.5343671160660224}
[S9] START round=9 head_norm_before_train=1.309050 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.160342 metrics={'f1_val': 0.43821906574464176, 'auprc': 0.8040348481422991, 'loss_val': 0.7909724922921192, 'psi': 0.5845453787037047}-{'f1_val': 0.4177305826382898, 'auprc': 0.802886239834922, 'loss_val': 0.985280661099322, 'psi': 0.5717928455169428}
[S10] START round=9 head_norm_before_train=0.872053 cos_to_last_merge=0.9125 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=9 local utility u=0.270513 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.6635058715277046, 'loss_val': 0.9264526790318866, 'psi': 0.5156334663903311}-{'f1_val': 0.35808462438994726, 'auprc': 0.6524184142031566, 'loss_val': 1.0804119248925859, 'psi': 0.475818140315231}
[S11] START round=9 head_norm_before_train=1.094752 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.4012825464680092, 'auprc': 0.9364319201537941, 'loss_val': 0.7824669890958006, 'psi': 0.6153422959423231}-{'f1_val': 0.44503144602552136, 'auprc': 0.9477228846082557, 'loss_val': 0.7418575728294893, 'psi': 0.6461080214586151}
[S13] START round=9 head_norm_before_train=0.852804 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.015729 metrics={'f1_val': 0.37145502080491366, 'auprc': 0.7213813706226205, 'loss_val': 0.9608332226154483, 'psi': 0.5114255607319964}-{'f1_val': 0.37256644414024653, 'auprc': 0.734826730939258, 'loss_val': 1.0392962353617754, 'psi': 0.5174705588598512}
[S14] START round=9 head_norm_before_train=1.389402 (no previous merge yet)
[S14] round=9 local utility u=0.727479 metrics={'f1_val': 0.9174140634803459, 'auprc': 0.9774608906987763, 'loss_val': 0.7320757843975702, 'psi': 0.9414327943677181}-{'f1_val': 0.7076645927303818, 'auprc': 0.9695572879022112, 'loss_val': 0.9048262691764581, 'psi': 0.8124216707991136}
[S15] START round=9 head_norm_before_train=1.354167 (no previous merge yet)
[S15] round=9 local utility u=0.748810 metrics={'f1_val': 0.6400966895292926, 'auprc': 0.9210544636718428, 'loss_val': 0.5667145515428871, 'psi': 0.7524797991863127}-{'f1_val': 0.4629791008530058, 'auprc': 0.8100527099029892, 'loss_val': 0.6686237241042109, 'psi': 0.6018085444729991}
[S16] START round=9 head_norm_before_train=0.818078 cos_to_last_merge=0.9141 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=9 local utility u=0.327775 metrics={'f1_val': 0.3833320444509748, 'auprc': 0.8652985172282124, 'loss_val': 0.8749484220822963, 'psi': 0.5761186335618698}-{'f1_val': 0.41672208089815915, 'auprc': 0.6153420085902428, 'loss_val': 0.9809696180400161, 'psi': 0.4961700519749926}
[S17] START round=9 head_norm_before_train=1.372015 (no previous merge yet)
[S17] round=9 local utility u=0.054887 metrics={'f1_val': 0.3514392811453728, 'auprc': 0.746722375273383, 'loss_val': 0.9146979531865489, 'psi': 0.5095525187965769}-{'f1_val': 0.37271890124391427, 'auprc': 0.6497869889078267, 'loss_val': 0.8613434339513741, 'psi': 0.48354613630947924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:61804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S5
[S13] cosine check vs S5: cos=0.4956
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.6128
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=0.9174
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=0.8445
[S11] RECEIVED delta(kind=head bytes=1803) from S9
[S11] cosine check vs S9: cos=0.9601
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=-0.0643
[S15] DROPPED delta from S8 (cos=-0.0643 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=0.6340
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] cosine check vs S10: cos=0.6311
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] cosine check vs S13: cos=0.3531
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.9906
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9461
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0584
[S13] DROPPED delta from S17 (cos=-0.0584 < 0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3687 head_norm=0.612638
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.472436e-02
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3687 head_norm=0.591308 delta_norm=0.094724
[S4] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.4013 head_norm=1.124967
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.030322e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.4010 head_norm=1.218690 delta_norm=0.203032
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4174 head_norm=0.859316
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.285526e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4176 head_norm=1.111367 delta_norm=0.428553
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4142 head_norm=1.016113
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.605932e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4165 head_norm=0.937624 delta_norm=0.160593
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3715 head_norm=0.891550
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.398710e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3715 head_norm=0.757071 delta_norm=0.439871
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7012 head_norm=0.838774
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.733229e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7016 head_norm=0.833293 delta_norm=0.173323
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4382 head_norm=1.336901
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.724408e-02
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7019 head_norm=1.360932 delta_norm=0.097244
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7143 head_norm=0.750721
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.065462e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.6273 head_norm=0.795459 delta_norm=0.406546
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.627 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=0.833293 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7010136527697399, 'auprc': 0.654106725940401, 'loss_val': 0.7954321590353509, 'psi': 0.6822508820380043}-{'f1_val': 0.7011938325409155, 'auprc': 0.6872829001577099, 'loss_val': 0.8316490397451407, 'psi': 0.6956294595876333}
[S3] START round=10 head_norm_before_train=1.469351 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.5423395737364883, 'auprc': 0.9935164020934732, 'loss_val': 0.5454405251515761, 'psi': 0.7228103050792823}-{'f1_val': 0.6549792499342355, 'auprc': 0.9960707590322945, 'loss_val': 0.5757970794162254, 'psi': 0.7914158535734591}
[S4] START round=10 head_norm_before_train=0.591308 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.770508 metrics={'f1_val': 0.605690692592697, 'auprc': 0.6603796803852849, 'loss_val': 0.7857266892627377, 'psi': 0.6275662877097322}-{'f1_val': 0.36872375300113036, 'auprc': 0.6571646127984612, 'loss_val': 0.89529608852404, 'psi': 0.48410009692006273}
[S5] START round=10 head_norm_before_train=1.111367 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.068083 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7900040227387597, 'loss_val': 0.9229451162509478, 'psi': 0.5665540352227776}-{'f1_val': 0.4174279751372442, 'auprc': 0.7816406366774548, 'loss_val': 1.0330654339779297, 'psi': 0.5631130397533284}
[S6] START round=10 head_norm_before_train=1.448849 (no previous merge yet)
[S6] round=10 local utility u=0.057088 metrics={'f1_val': 0.4161675255257569, 'auprc': 0.9585288020397869, 'loss_val': 0.6441236567428098, 'psi': 0.6331120361313689}-{'f1_val': 0.4168551858772006, 'auprc': 0.9488608545179418, 'loss_val': 0.7334213104626486, 'psi': 0.6296574533334971}
[S7] START round=10 head_norm_before_train=0.937624 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.066414 metrics={'f1_val': 0.41695504393391747, 'auprc': 0.7769877097773357, 'loss_val': 1.0075609322665326, 'psi': 0.5609681102712848}-{'f1_val': 0.41421630438823687, 'auprc': 0.774067414109038, 'loss_val': 1.1151960114195494, 'psi': 0.5581567482765574}
[S8] START round=10 head_norm_before_train=0.795459 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9944303558012135, 'loss_val': 0.8781945506639791, 'psi': 0.6214511712982174}-{'f1_val': 0.7143313310219598, 'auprc': 0.7710145218342556, 'loss_val': 0.949050828553872, 'psi': 0.7370046073468781}
[S9] START round=10 head_norm_before_train=1.360932 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=1.000000 metrics={'f1_val': 0.7018648842933433, 'auprc': 0.9999790613921509, 'loss_val': 0.6150039854249763, 'psi': 0.8211105551328663}-{'f1_val': 0.43821906574464176, 'auprc': 0.8040348481422991, 'loss_val': 0.7909724922921192, 'psi': 0.5845453787037047}
[S10] START round=10 head_norm_before_train=0.919529 cos_to_last_merge=0.8893 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=10 local utility u=0.271523 metrics={'f1_val': 0.3921058105385693, 'auprc': 0.8569254560663352, 'loss_val': 0.8139883590134379, 'psi': 0.5780336687496757}-{'f1_val': 0.4170518629654155, 'auprc': 0.6635058715277046, 'loss_val': 0.9264526790318866, 'psi': 0.5156334663903311}
[S11] START round=10 head_norm_before_train=1.218690 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.914906 metrics={'f1_val': 0.6933973580815904, 'auprc': 0.8907784432588947, 'loss_val': 0.5683831776100368, 'psi': 0.7723497921525122}-{'f1_val': 0.4012825464680092, 'auprc': 0.9364319201537941, 'loss_val': 0.7824669890958006, 'psi': 0.6153422959423231}
[S13] START round=10 head_norm_before_train=0.757071 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.37127789452904514, 'auprc': 0.5298812153916789, 'loss_val': 1.0055557378961784, 'psi': 0.43471922287409864}-{'f1_val': 0.37145502080491366, 'auprc': 0.7213813706226205, 'loss_val': 0.9608332226154483, 'psi': 0.5114255607319964}
[S14] START round=10 head_norm_before_train=1.442660 (no previous merge yet)
[S14] round=10 local utility u=0.393986 metrics={'f1_val': 0.9978645182087221, 'auprc': 0.9975386778011371, 'loss_val': 0.48703989887725135, 'psi': 0.9977341820456881}-{'f1_val': 0.9174140634803459, 'auprc': 0.9774608906987763, 'loss_val': 0.7320757843975702, 'psi': 0.9414327943677181}
[S15] START round=10 head_norm_before_train=1.391360 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6900471685208741, 'auprc': 0.797473532074829, 'loss_val': 0.5784447385171754, 'psi': 0.7330177139424561}-{'f1_val': 0.6400966895292926, 'auprc': 0.9210544636718428, 'loss_val': 0.5667145515428871, 'psi': 0.7524797991863127}
[S16] START round=10 head_norm_before_train=0.863305 cos_to_last_merge=0.8927 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=10 local utility u=0.012933 metrics={'f1_val': 0.38534303795518504, 'auprc': 0.8509006264792092, 'loss_val': 0.8179549164105415, 'psi': 0.5715660733647947}-{'f1_val': 0.3833320444509748, 'auprc': 0.8652985172282124, 'loss_val': 0.8749484220822963, 'psi': 0.5761186335618698}
[S17] START round=10 head_norm_before_train=1.403381 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.28698058090339096, 'auprc': 0.7427376498460302, 'loss_val': 1.2707072996401625, 'psi': 0.46928340848044664}-{'f1_val': 0.3514392811453728, 'auprc': 0.746722375273383, 'loss_val': 0.9146979531865489, 'psi': 0.5095525187965769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:61802
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=0.1467
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9010
[S5] RECEIVED delta(kind=head bytes=1803) from S6
[S5] cosine check vs S6: cos=0.9708
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=0.9795
[S13] RECEIVED delta(kind=head bytes=1794) from S5
[S13] cosine check vs S5: cos=0.8131
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0847
[S11] DROPPED delta from S4 (cos=-0.0847 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.6390
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=0.9269
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=0.9552
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3728 head_norm=0.826697
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.831305e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3727 head_norm=0.877439 delta_norm=0.183130
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.428 → S15@127.0.0.1:61815
[S3] ⇄ pheromone p=0.335 → S13@127.0.0.1:61813
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7010 head_norm=0.879645
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.347382e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7014 head_norm=0.884828 delta_norm=0.134738
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.344 → S4@127.0.0.1:61804
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3713 head_norm=0.796470
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.376930e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3715 head_norm=0.922762 delta_norm=0.337693
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.213 → S7@127.0.0.1:61808
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6934 head_norm=1.246496
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.526925e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6932 head_norm=1.313964 delta_norm=0.152692
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.424 → S5@127.0.0.1:61805
[S6] ⇄ pheromone p=0.248 → S5@127.0.0.1:61805
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4176 head_norm=1.138722
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.976619e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4176 head_norm=1.005990 delta_norm=0.297662
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.280 → S13@127.0.0.1:61813
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4170 head_norm=0.960960
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.796714e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4170 head_norm=1.201311 delta_norm=0.379671
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.263 → S8@127.0.0.1:61809
[S9] ⇄ pheromone p=0.459 → S11@127.0.0.1:61812
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6057 head_norm=0.649197
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.750318e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.4500 head_norm=0.738154 delta_norm=0.375032
[S4] aggregate: ROLLBACK (f1_val pre=0.606 post=0.450 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.337 → S11@127.0.0.1:61812
[S16] ⇄ pheromone p=0.259 → S2@127.0.0.1:61802
[S10] ⇄ pheromone p=0.357 → S4@127.0.0.1:61804
[S15] ⇄ pheromone p=0.359 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=0.223 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.488 → S7@127.0.0.1:61808
[S2] START round=11 head_norm_before_train=0.884828 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.022103 metrics={'f1_val': 0.7005180533751962, 'auprc': 0.6566590664540614, 'loss_val': 0.7559091126988167, 'psi': 0.6829744586067423}-{'f1_val': 0.7010136527697399, 'auprc': 0.654106725940401, 'loss_val': 0.7954321590353509, 'psi': 0.6822508820380043}
[S3] START round=11 head_norm_before_train=1.524902 (no previous merge yet)
[S3] round=11 local utility u=0.512863 metrics={'f1_val': 0.6902002807210639, 'auprc': 0.9972765144065947, 'loss_val': 0.41816006391771526, 'psi': 0.8130307741952763}-{'f1_val': 0.5423395737364883, 'auprc': 0.9935164020934732, 'loss_val': 0.5454405251515761, 'psi': 0.7228103050792823}
[S4] START round=11 head_norm_before_train=0.738154 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.340583 metrics={'f1_val': 0.6107591770282151, 'auprc': 0.8585443635103122, 'loss_val': 0.7294652268648535, 'psi': 0.709873251621054}-{'f1_val': 0.605690692592697, 'auprc': 0.6603796803852849, 'loss_val': 0.7857266892627377, 'psi': 0.6275662877097322}
[S5] START round=11 head_norm_before_train=1.005990 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.027623 metrics={'f1_val': 0.41803072775632044, 'auprc': 0.7885441393708206, 'loss_val': 0.8659790657990161, 'psi': 0.5662360924021206}-{'f1_val': 0.4175873768787894, 'auprc': 0.7900040227387597, 'loss_val': 0.9229451162509478, 'psi': 0.5665540352227776}
[S6] START round=11 head_norm_before_train=1.482194 (no previous merge yet)
[S6] round=11 local utility u=0.990010 metrics={'f1_val': 0.7127405062092489, 'auprc': 0.9870648501826231, 'loss_val': 0.529150240113199, 'psi': 0.8224702437985987}-{'f1_val': 0.4161675255257569, 'auprc': 0.9585288020397869, 'loss_val': 0.6441236567428098, 'psi': 0.6331120361313689}
[S7] START round=11 head_norm_before_train=1.201311 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.767623 metrics={'f1_val': 0.6619339873350227, 'auprc': 0.7759601550585257, 'loss_val': 0.9391053503784795, 'psi': 0.7075444544244239}-{'f1_val': 0.41695504393391747, 'auprc': 0.7769877097773357, 'loss_val': 1.0075609322665326, 'psi': 0.5609681102712848}
[S8] START round=11 head_norm_before_train=0.877439 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.042753 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9924245177774886, 'loss_val': 0.786671695565118, 'psi': 0.6206488360887275}-{'f1_val': 0.3727983816295533, 'auprc': 0.9944303558012135, 'loss_val': 0.8781945506639791, 'psi': 0.6214511712982174}
[S9] START round=11 head_norm_before_train=1.394948 cos_to_last_merge=0.9984 (last merge round=9)
[S9] round=11 local utility u=0.076428 metrics={'f1_val': 0.700547999132285, 'auprc': 0.9992377712476821, 'loss_val': 0.452023701878117, 'psi': 0.8200239079784439}-{'f1_val': 0.7018648842933433, 'auprc': 0.9999790613921509, 'loss_val': 0.6150039854249763, 'psi': 0.8211105551328663}
[S10] START round=11 head_norm_before_train=0.974465 cos_to_last_merge=0.8650 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.865
[S10] round=11 local utility u=0.637324 metrics={'f1_val': 0.5781523956606544, 'auprc': 0.8648310103889587, 'loss_val': 0.6793371804595957, 'psi': 0.6928238415519761}-{'f1_val': 0.3921058105385693, 'auprc': 0.8569254560663352, 'loss_val': 0.8139883590134379, 'psi': 0.5780336687496757}
[S11] START round=11 head_norm_before_train=1.313964 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.050149 metrics={'f1_val': 0.6600940140820828, 'auprc': 0.9950970042434466, 'loss_val': 0.5812209133681858, 'psi': 0.7940952101466283}-{'f1_val': 0.6933973580815904, 'auprc': 0.8907784432588947, 'loss_val': 0.5683831776100368, 'psi': 0.7723497921525122}
[S13] START round=11 head_norm_before_train=0.922762 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.745519 metrics={'f1_val': 0.4837526067338244, 'auprc': 0.7421124534725898, 'loss_val': 0.8260606428644176, 'psi': 0.5870965454293305}-{'f1_val': 0.37127789452904514, 'auprc': 0.5298812153916789, 'loss_val': 1.0055557378961784, 'psi': 0.43471922287409864}
[S14] START round=11 head_norm_before_train=1.500385 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9287659800854402, 'auprc': 0.999206229660752, 'loss_val': 0.2786574365509904, 'psi': 0.9569420799155649}-{'f1_val': 0.9978645182087221, 'auprc': 0.9975386778011371, 'loss_val': 0.48703989887725135, 'psi': 0.9977341820456881}
[S15] START round=11 head_norm_before_train=1.428560 (no previous merge yet)
[S15] round=11 local utility u=0.024239 metrics={'f1_val': 0.6964530125660389, 'auprc': 0.7821799211790762, 'loss_val': 0.522520202364501, 'psi': 0.7307437760112538}-{'f1_val': 0.6900471685208741, 'auprc': 0.797473532074829, 'loss_val': 0.5784447385171754, 'psi': 0.7330177139424561}
[S16] START round=11 head_norm_before_train=0.910151 cos_to_last_merge=0.8730 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.873
[S16] round=11 local utility u=0.074087 metrics={'f1_val': 0.43792985709144105, 'auprc': 0.7959265068189303, 'loss_val': 0.820378779442024, 'psi': 0.5811285169824367}-{'f1_val': 0.38534303795518504, 'auprc': 0.8509006264792092, 'loss_val': 0.8179549164105415, 'psi': 0.5715660733647947}
[S17] START round=11 head_norm_before_train=1.430632 (no previous merge yet)
[S17] round=11 local utility u=0.387548 metrics={'f1_val': 0.35229538205016675, 'auprc': 0.7623508166909184, 'loss_val': 0.9463392055523362, 'psi': 0.5163175559064674}-{'f1_val': 0.28698058090339096, 'auprc': 0.7427376498460302, 'loss_val': 1.2707072996401625, 'psi': 0.46928340848044664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=0.3619
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.3266
[S7] RECEIVED delta(kind=head bytes=1790) from S13
[S7] cosine check vs S13: cos=0.2193
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=0.9879
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.9073
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.9051
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] cosine check vs S6: cos=0.9009
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.2171
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0832
[S15] DROPPED delta from S8 (cos=-0.0832 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=0.9407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=0.9797
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9692
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0559
[S11] DROPPED delta from S4 (cos=-0.0559 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.0130
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6601 head_norm=1.339843
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.181123e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.6580 head_norm=1.383658 delta_norm=0.118112
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7005 head_norm=0.932321
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.179722e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7015 head_norm=0.937661 delta_norm=0.117972
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4838 head_norm=0.951567
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.008715e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.3796 head_norm=0.808551 delta_norm=0.300872
[S13] aggregate: ROLLBACK (f1_val pre=0.484 post=0.380 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3728 head_norm=0.913421
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.734725e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3751 head_norm=1.041239 delta_norm=0.273473
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.6619 head_norm=1.218029
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.857133e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4169 head_norm=0.851079 delta_norm=0.685713
[S7] aggregate: ROLLBACK (f1_val pre=0.662 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4180 head_norm=1.033779
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.840498e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4180 head_norm=0.994554 delta_norm=0.184050
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7005 head_norm=1.435876
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.474286e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.6998 head_norm=1.445984 delta_norm=0.147429
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6108 head_norm=0.790552
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.932304e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6120 head_norm=0.698002 delta_norm=0.193230
[S4] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.937661 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.003710 metrics={'f1_val': 0.7005180533751962, 'auprc': 0.645556546370422, 'loss_val': 0.7151821428555477, 'psi': 0.6785334505732865}-{'f1_val': 0.7005180533751962, 'auprc': 0.6566590664540614, 'loss_val': 0.7559091126988167, 'psi': 0.6829744586067423}
[S3] START round=12 head_norm_before_train=1.571678 (no previous merge yet)
[S3] round=12 local utility u=0.040952 metrics={'f1_val': 0.6889081634569233, 'auprc': 0.9958574215880133, 'loss_val': 0.3242457636342222, 'psi': 0.8116878667093593}-{'f1_val': 0.6902002807210639, 'auprc': 0.9972765144065947, 'loss_val': 0.41816006391771526, 'psi': 0.8130307741952763}
[S4] START round=12 head_norm_before_train=0.698002 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.026970 metrics={'f1_val': 0.608943481367019, 'auprc': 0.8587599256156618, 'loss_val': 0.6652768671249221, 'psi': 0.7088700590664763}-{'f1_val': 0.6107591770282151, 'auprc': 0.8585443635103122, 'loss_val': 0.7294652268648535, 'psi': 0.709873251621054}
[S5] START round=12 head_norm_before_train=0.994554 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.802829 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7394621176115798, 'loss_val': 0.8100328705440407, 'psi': 0.7162990171341512}-{'f1_val': 0.41803072775632044, 'auprc': 0.7885441393708206, 'loss_val': 0.8659790657990161, 'psi': 0.5662360924021206}
[S6] START round=12 head_norm_before_train=1.513169 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.5919521660639571, 'auprc': 0.8088051962521924, 'loss_val': 0.5534506201538846, 'psi': 0.6786933781392512}-{'f1_val': 0.7127405062092489, 'auprc': 0.9870648501826231, 'loss_val': 0.529150240113199, 'psi': 0.8224702437985987}
[S7] START round=12 head_norm_before_train=0.851079 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6612125299096436, 'auprc': 0.776051386842507, 'loss_val': 0.9823579791735619, 'psi': 0.707148072682789}-{'f1_val': 0.6619339873350227, 'auprc': 0.7759601550585257, 'loss_val': 0.9391053503784795, 'psi': 0.7075444544244239}
[S8] START round=12 head_norm_before_train=1.041239 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.050275 metrics={'f1_val': 0.3750398065455588, 'auprc': 0.9917765869284033, 'loss_val': 0.6976270286439494, 'psi': 0.6217345186986967}-{'f1_val': 0.3727983816295533, 'auprc': 0.9924245177774886, 'loss_val': 0.786671695565118, 'psi': 0.6206488360887275}
[S9] START round=12 head_norm_before_train=1.445984 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.034336 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9989100963873576, 'loss_val': 0.38832389950977547, 'psi': 0.8204884370761063}-{'f1_val': 0.700547999132285, 'auprc': 0.9992377712476821, 'loss_val': 0.452023701878117, 'psi': 0.8200239079784439}
[S10] START round=12 head_norm_before_train=1.033769 cos_to_last_merge=0.8407 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=12 local utility u=0.627964 metrics={'f1_val': 0.699879115126486, 'auprc': 0.9839789499272515, 'loss_val': 0.5112137857928754, 'psi': 0.8135190490467923}-{'f1_val': 0.5781523956606544, 'auprc': 0.8648310103889587, 'loss_val': 0.6793371804595957, 'psi': 0.6928238415519761}
[S11] START round=12 head_norm_before_train=1.383658 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.173541 metrics={'f1_val': 0.6933631184012342, 'auprc': 0.9982897102844028, 'loss_val': 0.44333182744033783, 'psi': 0.8153337551545017}-{'f1_val': 0.6600940140820828, 'auprc': 0.9950970042434466, 'loss_val': 0.5812209133681858, 'psi': 0.7940952101466283}
[S13] START round=12 head_norm_before_train=0.808551 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.4503039004699376, 'auprc': 0.6596483262049131, 'loss_val': 0.8772750563761388, 'psi': 0.5340416707639278}-{'f1_val': 0.4837526067338244, 'auprc': 0.7421124534725898, 'loss_val': 0.8260606428644176, 'psi': 0.5870965454293305}
[S14] START round=12 head_norm_before_train=1.556048 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.9302763371447589, 'auprc': 0.993160922848926, 'loss_val': 0.3464751256725053, 'psi': 0.9554301714264257}-{'f1_val': 0.9287659800854402, 'auprc': 0.999206229660752, 'loss_val': 0.2786574365509904, 'psi': 0.9569420799155649}
[S15] START round=12 head_norm_before_train=1.470873 (no previous merge yet)
[S15] round=12 local utility u=0.398073 metrics={'f1_val': 0.6937030766989207, 'auprc': 0.9921604105398415, 'loss_val': 0.339815914968567, 'psi': 0.813086010235289}-{'f1_val': 0.6964530125660389, 'auprc': 0.7821799211790762, 'loss_val': 0.522520202364501, 'psi': 0.7307437760112538}
[S16] START round=12 head_norm_before_train=0.957617 cos_to_last_merge=0.8560 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=12 local utility u=0.725355 metrics={'f1_val': 0.5956392797681869, 'auprc': 0.9153867661669199, 'loss_val': 0.6743059604822219, 'psi': 0.7235382743276801}-{'f1_val': 0.43792985709144105, 'auprc': 0.7959265068189303, 'loss_val': 0.820378779442024, 'psi': 0.5811285169824367}
[S17] START round=12 head_norm_before_train=1.447598 (no previous merge yet)
[S17] round=12 local utility u=0.088456 metrics={'f1_val': 0.3523734983258404, 'auprc': 0.8169932610350239, 'loss_val': 0.9338228317778252, 'psi': 0.5382214034095139}-{'f1_val': 0.35229538205016675, 'auprc': 0.7623508166909184, 'loss_val': 0.9463392055523362, 'psi': 0.5163175559064674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:61802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:61813
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] cosine check vs S11: cos=0.4923
[S2] RECEIVED delta(kind=head bytes=1792) from S16
[S2] cosine check vs S16: cos=0.9769
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0767
[S11] DROPPED delta from S4 (cos=-0.0767 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.8064
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=0.9879
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.4194
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=-0.0905
[S15] DROPPED delta from S8 (cos=-0.0905 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=0.9915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] cosine check vs S17: cos=0.2308
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=0.8372
[S13] RECEIVED delta(kind=head bytes=1790) from S3
[S13] cosine check vs S3: cos=0.4664
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7015 head_norm=1.490074
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.164561e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7015 head_norm=1.492595 delta_norm=0.116456
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6089 head_norm=0.759521
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.301949e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6087 head_norm=0.713940 delta_norm=0.130195
[S4] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.4503 head_norm=0.843640
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.836162e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.3714 head_norm=0.784396 delta_norm=0.183616
[S13] aggregate: ROLLBACK (f1_val pre=0.450 post=0.371 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7005 head_norm=0.982439
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.081045e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7015 head_norm=0.991584 delta_norm=0.108104
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7009 head_norm=1.028505
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.347526e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7007 head_norm=1.055936 delta_norm=0.634753
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6934 head_norm=1.406415
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.031947e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6934 head_norm=1.445169 delta_norm=0.103195
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.991584 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.083647 metrics={'f1_val': 0.7007773267636337, 'auprc': 0.6842748414438578, 'loss_val': 0.6655981507517303, 'psi': 0.6941763326357233}-{'f1_val': 0.7005180533751962, 'auprc': 0.645556546370422, 'loss_val': 0.7151821428555477, 'psi': 0.6785334505732865}
[S3] START round=13 head_norm_before_train=1.612761 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6306378178658124, 'auprc': 0.997510052725739, 'loss_val': 0.3370720674669454, 'psi': 0.777386711809783}-{'f1_val': 0.6889081634569233, 'auprc': 0.9958574215880133, 'loss_val': 0.3242457636342222, 'psi': 0.8116878667093593}
[S4] START round=13 head_norm_before_train=0.713940 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.017210 metrics={'f1_val': 0.6075627116114362, 'auprc': 0.8587746102923222, 'loss_val': 0.6226154653574709, 'psi': 0.7080474710837905}-{'f1_val': 0.608943481367019, 'auprc': 0.8587599256156618, 'loss_val': 0.6652768671249221, 'psi': 0.7088700590664763}
[S5] START round=13 head_norm_before_train=1.055936 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.398176 metrics={'f1_val': 0.7028074021143919, 'auprc': 0.9863804896943813, 'loss_val': 0.7661386251918412, 'psi': 0.8162366371463876}-{'f1_val': 0.7008569501491988, 'auprc': 0.7394621176115798, 'loss_val': 0.8100328705440407, 'psi': 0.7162990171341512}
[S6] START round=13 head_norm_before_train=1.544194 (no previous merge yet)
[S6] round=13 local utility u=0.550054 metrics={'f1_val': 0.7106828585581777, 'auprc': 0.9030246481221781, 'loss_val': 0.4483861155518512, 'psi': 0.7876195743837779}-{'f1_val': 0.5919521660639571, 'auprc': 0.8088051962521924, 'loss_val': 0.5534506201538846, 'psi': 0.6786933781392512}
[S7] START round=13 head_norm_before_train=0.877524 cos_to_last_merge=0.9968 (last merge round=11)
[S7] round=13 local utility u=0.242044 metrics={'f1_val': 0.7106747998362939, 'auprc': 0.7769796811415425, 'loss_val': 0.7978285432822342, 'psi': 0.7371967523583933}-{'f1_val': 0.6612125299096436, 'auprc': 0.776051386842507, 'loss_val': 0.9823579791735619, 'psi': 0.707148072682789}
[S8] START round=13 head_norm_before_train=1.075825 cos_to_last_merge=0.9958 (last merge round=11)
[S8] round=13 local utility u=0.261189 metrics={'f1_val': 0.4455221956247615, 'auprc': 0.991824663881275, 'loss_val': 0.5982868305414005, 'psi': 0.6640431829273669}-{'f1_val': 0.3750398065455588, 'auprc': 0.9917765869284033, 'loss_val': 0.6976270286439494, 'psi': 0.6217345186986967}
[S9] START round=13 head_norm_before_train=1.492595 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.027071 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984383887196069, 'loss_val': 0.3327669802637309, 'psi': 0.820299754009006}-{'f1_val': 0.7015406642019387, 'auprc': 0.9989100963873576, 'loss_val': 0.38832389950977547, 'psi': 0.8204884370761063}
[S10] START round=13 head_norm_before_train=1.098158 cos_to_last_merge=0.8195 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=13 local utility u=0.030341 metrics={'f1_val': 0.6901885074675915, 'auprc': 0.9823345833879751, 'loss_val': 0.38745465430351644, 'psi': 0.807046937835745}-{'f1_val': 0.699879115126486, 'auprc': 0.9839789499272515, 'loss_val': 0.5112137857928754, 'psi': 0.8135190490467923}
[S11] START round=13 head_norm_before_train=1.445169 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.038017 metrics={'f1_val': 0.6933631184012342, 'auprc': 0.9985593664171617, 'loss_val': 0.36810770299651413, 'psi': 0.8154416176076051}-{'f1_val': 0.6933631184012342, 'auprc': 0.9982897102844028, 'loss_val': 0.44333182744033783, 'psi': 0.8153337551545017}
[S13] START round=13 head_norm_before_train=0.784396 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.37311340639489965, 'auprc': 0.5510926609771079, 'loss_val': 0.9849014674900979, 'psi': 0.4443051082277829}-{'f1_val': 0.4503039004699376, 'auprc': 0.6596483262049131, 'loss_val': 0.8772750563761388, 'psi': 0.5340416707639278}
[S14] START round=13 head_norm_before_train=1.600932 (no previous merge yet)
[S14] round=13 local utility u=0.301682 metrics={'f1_val': 0.9978879974110813, 'auprc': 0.9979153465532865, 'loss_val': 0.16304528278508212, 'psi': 0.9978989370679634}-{'f1_val': 0.9302763371447589, 'auprc': 0.993160922848926, 'loss_val': 0.3464751256725053, 'psi': 0.9554301714264257}
[S15] START round=13 head_norm_before_train=1.504155 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.7010722616442422, 'auprc': 0.7915804346317613, 'loss_val': 0.4851032556336385, 'psi': 0.7372755308392498}-{'f1_val': 0.6937030766989207, 'auprc': 0.9921604105398415, 'loss_val': 0.339815914968567, 'psi': 0.813086010235289}
[S16] START round=13 head_norm_before_train=1.012258 cos_to_last_merge=0.8391 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.48102768813662145, 'auprc': 0.816854193443888, 'loss_val': 0.7189672937105309, 'psi': 0.615358290259528}-{'f1_val': 0.5956392797681869, 'auprc': 0.9153867661669199, 'loss_val': 0.6743059604822219, 'psi': 0.7235382743276801}
[S17] START round=13 head_norm_before_train=1.452839 (no previous merge yet)
[S17] round=13 local utility u=0.038023 metrics={'f1_val': 0.353098839916504, 'auprc': 0.8415511769690547, 'loss_val': 0.9358025479661378, 'psi': 0.5484797747375243}-{'f1_val': 0.3523734983258404, 'auprc': 0.8169932610350239, 'loss_val': 0.9338228317778252, 'psi': 0.5382214034095139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61815
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:61811
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:61814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.9833
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9913
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.7466
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=0.8617
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.9924
[S11] RECEIVED delta(kind=head bytes=1792) from S5
[S11] cosine check vs S5: cos=0.8851
[S14] RECEIVED delta(kind=head bytes=1788) from S7
[S14] cosine check vs S7: cos=0.7366
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6902 head_norm=1.164429
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.899736e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6888 head_norm=0.910683 delta_norm=0.389974
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.7107 head_norm=0.905737
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.850768e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6807 head_norm=0.976645 delta_norm=0.285077
[S7] aggregate: ROLLBACK (f1_val pre=0.711 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9979 head_norm=1.643927
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.765023e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9981 head_norm=1.195439 delta_norm=0.576502
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7015 head_norm=1.534111
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.721171e-02
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7015 head_norm=1.501877 delta_norm=0.097212
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.6934 head_norm=1.475354
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.607692e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.6933 head_norm=1.243460 delta_norm=0.360769
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7011 head_norm=1.529616
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.009521e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7011 head_norm=1.528535 delta_norm=0.100952
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4810 head_norm=1.070074
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.776080e-02
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4570 head_norm=1.047474 delta_norm=0.097761
[S16] aggregate: ROLLBACK (f1_val pre=0.481 post=0.457 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.033662 cos_to_last_merge=0.9976 (last merge round=12)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7009546405023519, 'auprc': 0.6445867619690098, 'loss_val': 0.5925584204126897, 'psi': 0.678407489089015}-{'f1_val': 0.7007773267636337, 'auprc': 0.6842748414438578, 'loss_val': 0.6655981507517303, 'psi': 0.6941763326357233}
[S3] START round=14 head_norm_before_train=1.656326 (no previous merge yet)
[S3] round=14 local utility u=0.293331 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9984557442518598, 'loss_val': 0.17288193971799876, 'psi': 0.8197284790885133}-{'f1_val': 0.6306378178658124, 'auprc': 0.997510052725739, 'loss_val': 0.3370720674669454, 'psi': 0.777386711809783}
[S4] START round=14 head_norm_before_train=0.779071 cos_to_last_merge=0.9939 (last merge round=12)
[S4] round=14 local utility u=0.038469 metrics={'f1_val': 0.6071507243441832, 'auprc': 0.8658913985960273, 'loss_val': 0.5645565320316285, 'psi': 0.7106469940449208}-{'f1_val': 0.6075627116114362, 'auprc': 0.8587746102923222, 'loss_val': 0.6226154653574709, 'psi': 0.7080474710837905}
[S5] START round=14 head_norm_before_train=1.084446 cos_to_last_merge=0.9971 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008184048127608, 'auprc': 0.6615906361833429, 'loss_val': 0.6144578021358476, 'psi': 0.6851272973609936}-{'f1_val': 0.7028074021143919, 'auprc': 0.9863804896943813, 'loss_val': 0.7661386251918412, 'psi': 0.8162366371463876}
[S6] START round=14 head_norm_before_train=1.569446 (no previous merge yet)
[S6] round=14 local utility u=0.144244 metrics={'f1_val': 0.7089422398673382, 'auprc': 0.9804821975333335, 'loss_val': 0.38182719091481526, 'psi': 0.8175582229337364}-{'f1_val': 0.7106828585581777, 'auprc': 0.9030246481221781, 'loss_val': 0.4483861155518512, 'psi': 0.7876195743837779}
[S7] START round=14 head_norm_before_train=0.976645 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.580179706137177, 'auprc': 0.7799331575640418, 'loss_val': 0.8346408999356275, 'psi': 0.6600810867079229}-{'f1_val': 0.7106747998362939, 'auprc': 0.7769796811415425, 'loss_val': 0.7978285432822342, 'psi': 0.7371967523583933}
[S8] START round=14 head_norm_before_train=1.117967 cos_to_last_merge=0.9863 (last merge round=11)
[S8] round=14 local utility u=0.665513 metrics={'f1_val': 0.6552111618696831, 'auprc': 0.9933768291579523, 'loss_val': 0.5300511215432713, 'psi': 0.7904774287849908}-{'f1_val': 0.4455221956247615, 'auprc': 0.991824663881275, 'loss_val': 0.5982868305414005, 'psi': 0.6640431829273669}
[S9] START round=14 head_norm_before_train=1.501877 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.028567 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9986475328454779, 'loss_val': 0.2758160820706996, 'psi': 0.8203390695163942}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984383887196069, 'loss_val': 0.3327669802637309, 'psi': 0.820299754009006}
[S10] START round=14 head_norm_before_train=0.910683 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.017824 metrics={'f1_val': 0.6912346627731858, 'auprc': 0.9908714940751039, 'loss_val': 0.3836935564085772, 'psi': 0.8110893952939531}-{'f1_val': 0.6901885074675915, 'auprc': 0.9823345833879751, 'loss_val': 0.38745465430351644, 'psi': 0.807046937835745}
[S11] START round=14 head_norm_before_train=1.243460 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6809262463655124, 'auprc': 0.9952747935605326, 'loss_val': 0.39105036931683373, 'psi': 0.8066656652435205}-{'f1_val': 0.6933631184012342, 'auprc': 0.9985593664171617, 'loss_val': 0.36810770299651413, 'psi': 0.8154416176076051}
[S13] START round=14 head_norm_before_train=0.821229 cos_to_last_merge=0.9958 (last merge round=12)
[S13] round=14 local utility u=1.000000 metrics={'f1_val': 0.7132262943575028, 'auprc': 0.7455225692106336, 'loss_val': 0.6951424977423359, 'psi': 0.7261448042987552}-{'f1_val': 0.37311340639489965, 'auprc': 0.5510926609771079, 'loss_val': 0.9849014674900979, 'psi': 0.4443051082277829}
[S14] START round=14 head_norm_before_train=1.195439 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9967501565526162, 'auprc': 0.9987408586327899, 'loss_val': 0.24259089984657253, 'psi': 0.9975464373846857}-{'f1_val': 0.9978879974110813, 'auprc': 0.9979153465532865, 'loss_val': 0.16304528278508212, 'psi': 0.9978989370679634}
[S15] START round=14 head_norm_before_train=1.528535 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.128016 metrics={'f1_val': 0.6825991628340002, 'auprc': 0.8922781324633431, 'loss_val': 0.42032535761395223, 'psi': 0.7664707506857373}-{'f1_val': 0.7010722616442422, 'auprc': 0.7915804346317613, 'loss_val': 0.4851032556336385, 'psi': 0.7372755308392498}
[S16] START round=14 head_norm_before_train=1.047474 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.167940 metrics={'f1_val': 0.5304504564037011, 'auprc': 0.8528061579298942, 'loss_val': 0.7874803375406254, 'psi': 0.6593927370141783}-{'f1_val': 0.48102768813662145, 'auprc': 0.816854193443888, 'loss_val': 0.7189672937105309, 'psi': 0.615358290259528}
[S17] START round=14 head_norm_before_train=1.461552 (no previous merge yet)
[S17] round=14 local utility u=0.028050 metrics={'f1_val': 0.3564662020230824, 'auprc': 0.8547302888283458, 'loss_val': 0.9394438642106248, 'psi': 0.5557718367451878}-{'f1_val': 0.353098839916504, 'auprc': 0.8415511769690547, 'loss_val': 0.9358025479661378, 'psi': 0.5484797747375243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:61803
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S13
[S3] cosine check vs S13: cos=0.5303
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=-0.0920
[S8] DROPPED delta from S15 (cos=-0.0920 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] cosine check vs S9: cos=0.9896
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.8776
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=0.9637
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6912 head_norm=0.976155
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.340369e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6907 head_norm=0.884303 delta_norm=0.234037
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7006 head_norm=1.696501
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.195327e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.134011 delta_norm=0.719533
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6826 head_norm=1.550031
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.115790e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6840 head_norm=1.541777 delta_norm=0.111579
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.5802 head_norm=1.005500
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.660172e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6623 head_norm=1.075180 delta_norm=0.166017
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.079879 cos_to_last_merge=0.9924 (last merge round=12)
[S2] round=15 local utility u=0.164172 metrics={'f1_val': 0.701055136928628, 'auprc': 0.7320252041072496, 'loss_val': 0.5271329455886938, 'psi': 0.7134431638000767}-{'f1_val': 0.7009546405023519, 'auprc': 0.6445867619690098, 'loss_val': 0.5925584204126897, 'psi': 0.678407489089015}
[S3] START round=15 head_norm_before_train=1.134011 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9969259446075771, 'loss_val': 0.2761857064277863, 'psi': 0.8191789536422317}-{'f1_val': 0.7005769689796157, 'auprc': 0.9984557442518598, 'loss_val': 0.17288193971799876, 'psi': 0.8197284790885133}
[S4] START round=15 head_norm_before_train=0.848912 cos_to_last_merge=0.9814 (last merge round=12)
[S4] round=15 local utility u=0.114852 metrics={'f1_val': 0.6456751941471812, 'auprc': 0.8426049906592056, 'loss_val': 0.4961391775547835, 'psi': 0.7244471127519909}-{'f1_val': 0.6071507243441832, 'auprc': 0.8658913985960273, 'loss_val': 0.5645565320316285, 'psi': 0.7106469940449208}
[S5] START round=15 head_norm_before_train=1.118433 cos_to_last_merge=0.9899 (last merge round=12)
[S5] round=15 local utility u=0.266313 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8028799856978721, 'loss_val': 0.5027164254256156, 'psi': 0.7413447847394972}-{'f1_val': 0.7008184048127608, 'auprc': 0.6615906361833429, 'loss_val': 0.6144578021358476, 'psi': 0.6851272973609936}
[S6] START round=15 head_norm_before_train=1.591802 (no previous merge yet)
[S6] round=15 local utility u=0.022873 metrics={'f1_val': 0.7107107662437775, 'auprc': 0.9768547081996868, 'loss_val': 0.33581030325555594, 'psi': 0.8171683430261412}-{'f1_val': 0.7089422398673382, 'auprc': 0.9804821975333335, 'loss_val': 0.38182719091481526, 'psi': 0.8175582229337364}
[S7] START round=15 head_norm_before_train=1.075180 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.41011626869174556, 'auprc': 0.78354264472926, 'loss_val': 0.8687712280506374, 'psi': 0.5594868191067514}-{'f1_val': 0.580179706137177, 'auprc': 0.7799331575640418, 'loss_val': 0.8346408999356275, 'psi': 0.6600810867079229}
[S8] START round=15 head_norm_before_train=1.164524 cos_to_last_merge=0.9759 (last merge round=11)
[S8] round=15 local utility u=0.012167 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9942131845095996, 'loss_val': 0.5073404112427657, 'psi': 0.7907233264180844}-{'f1_val': 0.6552111618696831, 'auprc': 0.9933768291579523, 'loss_val': 0.5300511215432713, 'psi': 0.7904774287849908}
[S9] START round=15 head_norm_before_train=1.541576 cos_to_last_merge=0.9990 (last merge round=13)
[S9] round=15 local utility u=0.023736 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9980525207260013, 'loss_val': 0.22655864621583496, 'psi': 0.8201010646686036}-{'f1_val': 0.7014667606303384, 'auprc': 0.9986475328454779, 'loss_val': 0.2758160820706996, 'psi': 0.8203390695163942}
[S10] START round=15 head_norm_before_train=0.884303 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.015329 metrics={'f1_val': 0.6886193342413673, 'auprc': 0.997472545457101, 'loss_val': 0.3571466911299814, 'psi': 0.8121606187276608}-{'f1_val': 0.6912346627731858, 'auprc': 0.9908714940751039, 'loss_val': 0.3836935564085772, 'psi': 0.8110893952939531}
[S11] START round=15 head_norm_before_train=1.280018 cos_to_last_merge=0.9988 (last merge round=13)
[S11] round=15 local utility u=0.104473 metrics={'f1_val': 0.6981704675498933, 'auprc': 0.9969214847088177, 'loss_val': 0.2905103070394942, 'psi': 0.8176708744134631}-{'f1_val': 0.6809262463655124, 'auprc': 0.9952747935605326, 'loss_val': 0.39105036931683373, 'psi': 0.8066656652435205}
[S13] START round=15 head_norm_before_train=0.853989 cos_to_last_merge=0.9877 (last merge round=12)
[S13] round=15 local utility u=0.013044 metrics={'f1_val': 0.7117459811111688, 'auprc': 0.740036384702229, 'loss_val': 0.6437144943991668, 'psi': 0.7230621425475929}-{'f1_val': 0.7132262943575028, 'auprc': 0.7455225692106336, 'loss_val': 0.6951424977423359, 'psi': 0.7261448042987552}
[S14] START round=15 head_norm_before_train=1.230448 cos_to_last_merge=0.9996 (last merge round=13)
[S14] round=15 local utility u=0.036643 metrics={'f1_val': 0.9981300207600978, 'auprc': 0.9987497092782309, 'loss_val': 0.17761004690165488, 'psi': 0.9983778961673511}-{'f1_val': 0.9967501565526162, 'auprc': 0.9987408586327899, 'loss_val': 0.24259089984657253, 'psi': 0.9975464373846857}
[S15] START round=15 head_norm_before_train=1.541777 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.170430 metrics={'f1_val': 0.693611314201109, 'auprc': 0.9592844184295096, 'loss_val': 0.34655644686293, 'psi': 0.7998805558924693}-{'f1_val': 0.6825991628340002, 'auprc': 0.8922781324633431, 'loss_val': 0.42032535761395223, 'psi': 0.7664707506857373}
[S16] START round=15 head_norm_before_train=1.092164 cos_to_last_merge=0.9989 (last merge round=13)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.4947504321135229, 'auprc': 0.8640927490755745, 'loss_val': 0.6608768984405761, 'psi': 0.6424873588983435}-{'f1_val': 0.5304504564037011, 'auprc': 0.8528061579298942, 'loss_val': 0.7874803375406254, 'psi': 0.6593927370141783}
[S17] START round=15 head_norm_before_train=1.471594 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.31094402679931576, 'auprc': 0.8312072185322756, 'loss_val': 1.2865488118563722, 'psi': 0.5190493034924997}-{'f1_val': 0.3564662020230824, 'auprc': 0.8547302888283458, 'loss_val': 0.9394438642106248, 'psi': 0.5557718367451878}
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:61815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:61803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=0.9416
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=0.9786
[S3] RECEIVED delta(kind=head bytes=1798) from S13
[S3] cosine check vs S13: cos=0.7624
[S15] RECEIVED delta(kind=head bytes=1806) from S9
[S15] cosine check vs S9: cos=0.9943
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=0.9862
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.9356
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=0.9657
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=-0.0867
[S8] DROPPED delta from S15 (cos=-0.0867 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.291 → S7@127.0.0.1:61808
[S2] ⇄ pheromone p=0.159 → S16@127.0.0.1:61816
[S4] ⇄ pheromone p=0.172 → S10@127.0.0.1:61811
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7015 head_norm=1.578611
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.302819e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7015 head_norm=1.434119 delta_norm=0.230282
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.173 → S15@127.0.0.1:61815
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4101 head_norm=1.103160
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.103209e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4708 head_norm=1.153274 delta_norm=0.110321
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.180 → S14@127.0.0.1:61814
[S5] ⇄ pheromone p=0.280 → S11@127.0.0.1:61812
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.6982 head_norm=1.314323
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.356716e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.6995 head_norm=1.210416 delta_norm=0.235672
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.187 → S9@127.0.0.1:61810
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S13]  timeout peer S2
[S13]  timeout peer S4
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S9
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6936 head_norm=1.560593
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.426780e-02
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6938 head_norm=1.567364 delta_norm=0.084268
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.215 → S8@127.0.0.1:61809
[S13] ⇄ pheromone p=0.293 → S3@127.0.0.1:61803
[S14] ⇄ pheromone p=0.206 → S7@127.0.0.1:61808
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.4948 head_norm=1.134260
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.169930e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.4816 head_norm=1.123868 delta_norm=0.116993
[S16] aggregate: ROLLBACK (f1_val pre=0.495 post=0.482 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.192 → S2@127.0.0.1:61802
[S2] START round=16 head_norm_before_train=1.125605 cos_to_last_merge=0.9861 (last merge round=12)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008747778078441, 'auprc': 0.6743482476228781, 'loss_val': 0.43908917984699797, 'psi': 0.6902641657338577}-{'f1_val': 0.701055136928628, 'auprc': 0.7320252041072496, 'loss_val': 0.5271329455886938, 'psi': 0.7134431638000767}
[S3] START round=16 head_norm_before_train=1.186464 cos_to_last_merge=0.9989 (last merge round=14)
[S3] round=16 local utility u=0.905736 metrics={'f1_val': 0.9873007809781595, 'auprc': 0.9988689170498988, 'loss_val': 0.19026138198239656, 'psi': 0.9919280354068553}-{'f1_val': 0.7006809596653347, 'auprc': 0.9969259446075771, 'loss_val': 0.2761857064277863, 'psi': 0.8191789536422317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9873 head_norm=1.251330
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.151538e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9666 head_norm=1.002772 delta_norm=0.415154
[S3] aggregate: ROLLBACK (f1_val pre=0.987 post=0.967 tol_abs=0.005 tol_rel=0.0)
[S4] START round=16 head_norm_before_train=0.907475 cos_to_last_merge=0.9698 (last merge round=12)
[S4] round=16 local utility u=0.138118 metrics={'f1_val': 0.6886713060359142, 'auprc': 0.830999166807853, 'loss_val': 0.4430628068297431, 'psi': 0.7456024503446897}-{'f1_val': 0.6456751941471812, 'auprc': 0.8426049906592056, 'loss_val': 0.4961391775547835, 'psi': 0.7244471127519909}
[S5] START round=16 head_norm_before_train=1.146233 cos_to_last_merge=0.9829 (last merge round=12)
[S5] round=16 local utility u=0.179094 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8986418778181583, 'loss_val': 0.4335398029289814, 'psi': 0.7798222075307317}-{'f1_val': 0.7003213174339138, 'auprc': 0.8028799856978721, 'loss_val': 0.5027164254256156, 'psi': 0.7413447847394972}
[S6] START round=16 head_norm_before_train=1.615507 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6864302023057473, 'auprc': 0.8173985009335507, 'loss_val': 0.37976166642718634, 'psi': 0.7388175217568687}-{'f1_val': 0.7107107662437775, 'auprc': 0.9768547081996868, 'loss_val': 0.33581030325555594, 'psi': 0.8171683430261412}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=1.153274 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.679289 metrics={'f1_val': 0.6109569207788625, 'auprc': 0.785645905251135, 'loss_val': 0.7215476541215325, 'psi': 0.6808325145677715}-{'f1_val': 0.41011626869174556, 'auprc': 0.78354264472926, 'loss_val': 0.8687712280506374, 'psi': 0.5594868191067514}
[S8] START round=16 head_norm_before_train=1.211389 cos_to_last_merge=0.9673 (last merge round=11)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.6554792588344196, 'auprc': 0.9916472588692735, 'loss_val': 0.5290709549386358, 'psi': 0.7899464588483611}-{'f1_val': 0.6550634210237409, 'auprc': 0.9942131845095996, 'loss_val': 0.5073404112427657, 'psi': 0.7907233264180844}
[S9] START round=16 head_norm_before_train=1.434119 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.554889 metrics={'f1_val': 0.8825298784279239, 'auprc': 0.9980535171678969, 'loss_val': 0.20316250725238205, 'psi': 0.9287393339239131}-{'f1_val': 0.7014667606303384, 'auprc': 0.9980525207260013, 'loss_val': 0.22655864621583496, 'psi': 0.8201010646686036}
[S10] START round=16 head_norm_before_train=0.951089 cos_to_last_merge=0.9969 (last merge round=14)
[S10] round=16 local utility u=0.825515 metrics={'f1_val': 0.9510590791375758, 'auprc': 0.9966487774513292, 'loss_val': 0.27828418276753175, 'psi': 0.9692949584630772}-{'f1_val': 0.6886193342413673, 'auprc': 0.997472545457101, 'loss_val': 0.3571466911299814, 'psi': 0.8121606187276608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] sending update (kind=head size=1788 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9511 head_norm=1.023823
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.960831e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9514 head_norm=0.947319 delta_norm=0.196083
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] START round=16 head_norm_before_train=1.210416 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.708686 metrics={'f1_val': 0.9574176418412194, 'auprc': 0.97464262932795, 'loss_val': 0.3617838290556265, 'psi': 0.9643076368359116}-{'f1_val': 0.6981704675498933, 'auprc': 0.9969214847088177, 'loss_val': 0.2905103070394942, 'psi': 0.8176708744134631}
[S13] START round=16 head_norm_before_train=0.888809 cos_to_last_merge=0.9795 (last merge round=12)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008674925157418, 'auprc': 0.7337829037486393, 'loss_val': 0.6256006018033001, 'psi': 0.7140336570089008}-{'f1_val': 0.7117459811111688, 'auprc': 0.740036384702229, 'loss_val': 0.6437144943991668, 'psi': 0.7230621425475929}
[S14] START round=16 head_norm_before_train=1.275338 cos_to_last_merge=0.9983 (last merge round=13)
[S14] round=16 local utility u=0.016745 metrics={'f1_val': 0.997842298753406, 'auprc': 0.9989304960199489, 'loss_val': 0.1429366831705449, 'psi': 0.9982775776600232}-{'f1_val': 0.9981300207600978, 'auprc': 0.9987497092782309, 'loss_val': 0.17761004690165488, 'psi': 0.9983778961673511}
[S15] START round=16 head_norm_before_train=1.567364 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6994254499602601, 'auprc': 0.8120205103941974, 'loss_val': 0.37594201314219916, 'psi': 0.744463474133835}-{'f1_val': 0.693611314201109, 'auprc': 0.9592844184295096, 'loss_val': 0.34655644686293, 'psi': 0.7998805558924693}
[S16] START round=16 head_norm_before_train=1.123868 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8707621132024512, 'auprc': 0.989566286266725, 'loss_val': 0.3742797624028954, 'psi': 0.9182837824281608}-{'f1_val': 0.4947504321135229, 'auprc': 0.8640927490755745, 'loss_val': 0.6608768984405761, 'psi': 0.6424873588983435}
[S17] START round=16 head_norm_before_train=1.478212 (no previous merge yet)
[S17] round=16 local utility u=0.341069 metrics={'f1_val': 0.40144107928616757, 'auprc': 0.831390956872679, 'loss_val': 1.1479434588232347, 'psi': 0.5734210303207722}-{'f1_val': 0.31094402679931576, 'auprc': 0.8312072185322756, 'loss_val': 1.2865488118563722, 'psi': 0.5190493034924997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:61811
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9144
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=0.9874
[S15] RECEIVED delta(kind=head bytes=1802) from S9
[S15] cosine check vs S9: cos=0.9892
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.3818
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] cosine check vs S4: cos=0.9740
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6994 head_norm=1.590515
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.277911e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6994 head_norm=1.525187 delta_norm=0.127791
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:61812
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6110 head_norm=1.178015
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.696416e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5884 head_norm=1.226484 delta_norm=0.269642
[S7] aggregate: ROLLBACK (f1_val pre=0.611 post=0.588 tol_abs=0.005 tol_rel=0.0)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.9581
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.9729
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9574 head_norm=1.243030
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.445783e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9569 head_norm=1.201659 delta_norm=0.144578
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] RoundReady barrier timeout: have=1 need=2 — continuing
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S17
[S9]  timeout peer S15
[S8]  timeout peer S7
[S11]  timeout peer S4
[S11]  timeout peer S9
[S5]  timeout peer S6
[S5]  timeout peer S11
[S7]  timeout peer S13
[S15]  timeout peer S8
[S4]  timeout peer S2
[S4]  timeout peer S10
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.7009 head_norm=0.925630
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.941249e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6636 head_norm=0.877080 delta_norm=0.594125
[S13] aggregate: ROLLBACK (f1_val pre=0.701 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.169699 cos_to_last_merge=0.9789 (last merge round=12)
[S2] round=17 local utility u=0.002247 metrics={'f1_val': 0.7008747778078441, 'auprc': 0.6626141451723189, 'loss_val': 0.39939269973317704, 'psi': 0.685570524753634}-{'f1_val': 0.7008747778078441, 'auprc': 0.6743482476228781, 'loss_val': 0.43908917984699797, 'psi': 0.6902641657338577}
[S3] START round=17 head_norm_before_train=1.002772 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9970130599972069, 'loss_val': 0.27226933664198405, 'psi': 0.975426374662149}-{'f1_val': 0.9873007809781595, 'auprc': 0.9988689170498988, 'loss_val': 0.19026138198239656, 'psi': 0.9919280354068553}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=0.961084 cos_to_last_merge=0.9589 (last merge round=12)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6040373341573586, 'auprc': 0.9443168440996015, 'loss_val': 0.5110514830428855, 'psi': 0.7401491381342558}-{'f1_val': 0.6886713060359142, 'auprc': 0.830999166807853, 'loss_val': 0.4430628068297431, 'psi': 0.7456024503446897}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=1.176712 cos_to_last_merge=0.9755 (last merge round=12)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.674969529869871, 'auprc': 0.791339980042105, 'loss_val': 0.634675504491425, 'psi': 0.7215177099387646}-{'f1_val': 0.7006090940057808, 'auprc': 0.8986418778181583, 'loss_val': 0.4335398029289814, 'psi': 0.7798222075307317}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=17 head_norm_before_train=1.641677 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6210805542831876, 'auprc': 0.7689617143495427, 'loss_val': 0.4403391949688671, 'psi': 0.6802330183097297}-{'f1_val': 0.6864302023057473, 'auprc': 0.8173985009335507, 'loss_val': 0.37976166642718634, 'psi': 0.7388175217568687}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=1.226484 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5345229208769013, 'auprc': 0.7391471552971293, 'loss_val': 0.8234890760978586, 'psi': 0.6163726146449926}-{'f1_val': 0.6109569207788625, 'auprc': 0.785645905251135, 'loss_val': 0.7215476541215325, 'psi': 0.6808325145677715}
[S8] START round=17 head_norm_before_train=1.248159 cos_to_last_merge=0.9606 (last merge round=11)
[S8] round=17 local utility u=0.004013 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9924462167263198, 'loss_val': 0.5192593093994405, 'psi': 0.7898478168807039}-{'f1_val': 0.6554792588344196, 'auprc': 0.9916472588692735, 'loss_val': 0.5290709549386358, 'psi': 0.7899464588483611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=17 head_norm_before_train=1.468099 cos_to_last_merge=0.9994 (last merge round=15)
[S9] round=17 local utility u=0.352631 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.998312116960757, 'loss_val': 0.1457088984249396, 'psi': 0.993546057521879}-{'f1_val': 0.8825298784279239, 'auprc': 0.9980535171678969, 'loss_val': 0.20316250725238205, 'psi': 0.9287393339239131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9904 head_norm=1.501349
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.413553e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9899 head_norm=1.356958 delta_norm=0.241355
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=17 head_norm_before_train=0.947319 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.124774 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9954123960336321, 'loss_val': 0.2758909866072806, 'psi': 0.9938868065081905}-{'f1_val': 0.9510590791375758, 'auprc': 0.9966487774513292, 'loss_val': 0.27828418276753175, 'psi': 0.9692949584630772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9929 head_norm=1.007486
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.380488e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9929 head_norm=0.974832 delta_norm=0.138049
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] START round=17 head_norm_before_train=1.201659 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.194546 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9980463500239598, 'loss_val': 0.2787322262387991, 'psi': 0.9972519917584932}-{'f1_val': 0.9574176418412194, 'auprc': 0.97464262932795, 'loss_val': 0.3617838290556265, 'psi': 0.9643076368359116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=17 head_norm_before_train=0.877080 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.7087557992550573, 'auprc': 0.682955944653198, 'loss_val': 0.6578566686597164, 'psi': 0.6984358574143135}-{'f1_val': 0.7008674925157418, 'auprc': 0.7337829037486393, 'loss_val': 0.6256006018033001, 'psi': 0.7140336570089008}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.328992 cos_to_last_merge=0.9957 (last merge round=13)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9771458074986243, 'auprc': 0.9985049566288183, 'loss_val': 0.1245708684536162, 'psi': 0.9856894671507019}-{'f1_val': 0.997842298753406, 'auprc': 0.9989304960199489, 'loss_val': 0.1429366831705449, 'psi': 0.9982775776600232}
[S15] START round=17 head_norm_before_train=1.525187 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.086835 metrics={'f1_val': 0.6924296800597842, 'auprc': 0.8773044587914487, 'loss_val': 0.3561492491702914, 'psi': 0.7663795915524501}-{'f1_val': 0.6994254499602601, 'auprc': 0.8120205103941974, 'loss_val': 0.37594201314219916, 'psi': 0.744463474133835}
[S16] START round=17 head_norm_before_train=1.168577 cos_to_last_merge=0.9986 (last merge round=15)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8425219024741822, 'auprc': 0.997902431941629, 'loss_val': 0.4925800682314025, 'psi': 0.904674114261161}-{'f1_val': 0.8707621132024512, 'auprc': 0.989566286266725, 'loss_val': 0.3742797624028954, 'psi': 0.9182837824281608}
[S17] START round=17 head_norm_before_train=1.486831 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.34858938033049064, 'auprc': 0.8272940356206864, 'loss_val': 1.0133745962960505, 'psi': 0.540071242446569}-{'f1_val': 0.40144107928616757, 'auprc': 0.831390956872679, 'loss_val': 1.1479434588232347, 'psi': 0.5734210303207722}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:61816
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=0.9777
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9793
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7009 head_norm=1.213667
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.104791e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7009 head_norm=1.186202 delta_norm=0.110479
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.186202 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.701055136928628, 'auprc': 0.6598364726613752, 'loss_val': 0.41046140640513634, 'psi': 0.6845676712217268}-{'f1_val': 0.7008747778078441, 'auprc': 0.6626141451723189, 'loss_val': 0.39939269973317704, 'psi': 0.685570524753634}
[S3] START round=18 head_norm_before_train=1.068385 cos_to_last_merge=0.9976 (last merge round=16)
[S3] round=18 local utility u=0.076044 metrics={'f1_val': 0.973946656027713, 'auprc': 0.9981206912715744, 'loss_val': 0.20097289130335627, 'psi': 0.9836162701252577}-{'f1_val': 0.9610352511054436, 'auprc': 0.9970130599972069, 'loss_val': 0.27226933664198405, 'psi': 0.975426374662149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=18 head_norm_before_train=1.010633 cos_to_last_merge=0.9497 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=18 local utility u=0.026828 metrics={'f1_val': 0.6071622419574291, 'auprc': 0.9377970302529826, 'loss_val': 0.4565862337313522, 'psi': 0.7394161572756505}-{'f1_val': 0.6040373341573586, 'auprc': 0.9443168440996015, 'loss_val': 0.5110514830428855, 'psi': 0.7401491381342558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=18 head_norm_before_train=1.204046 cos_to_last_merge=0.9683 (last merge round=12)
[S5] round=18 local utility u=0.510688 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9926934419881103, 'loss_val': 0.3711977444915326, 'psi': 0.8174428331987126}-{'f1_val': 0.674969529869871, 'auprc': 0.791339980042105, 'loss_val': 0.634675504491425, 'psi': 0.7215177099387646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=18 head_norm_before_train=1.665245 (no previous merge yet)
[S6] round=18 local utility u=0.462275 metrics={'f1_val': 0.6914212108855116, 'auprc': 0.8991032543823871, 'loss_val': 0.328258117181536, 'psi': 0.7744940282842618}-{'f1_val': 0.6210805542831876, 'auprc': 0.7689617143495427, 'loss_val': 0.4403391949688671, 'psi': 0.6802330183097297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=18 head_norm_before_train=1.246593 cos_to_last_merge=0.9995 (last merge round=16)
[S7] round=18 local utility u=0.166890 metrics={'f1_val': 0.5637148582156215, 'auprc': 0.7771369869840159, 'loss_val': 0.7788311008894396, 'psi': 0.6490837097229794}-{'f1_val': 0.5345229208769013, 'auprc': 0.7391471552971293, 'loss_val': 0.8234890760978586, 'psi': 0.6163726146449926}
[S8] START round=18 head_norm_before_train=1.278224 cos_to_last_merge=0.9554 (last merge round=11)
[S8] round=18 local utility u=0.013528 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9917743266431969, 'loss_val': 0.4901886251087888, 'psi': 0.7895790608474549}-{'f1_val': 0.6547822169836268, 'auprc': 0.9924462167263198, 'loss_val': 0.5192593093994405, 'psi': 0.7898478168807039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=18 head_norm_before_train=1.356958 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9856836147752347, 'auprc': 0.9984850929331726, 'loss_val': 0.1545528882247934, 'psi': 0.9908042060384098}-{'f1_val': 0.9903686845626269, 'auprc': 0.998312116960757, 'loss_val': 0.1457088984249396, 'psi': 0.993546057521879}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9857 head_norm=1.390456
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.694150e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9861 head_norm=1.464856 delta_norm=0.169415
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] START round=18 head_norm_before_train=0.974832 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.002373 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9914901479185113, 'loss_val': 0.273254722017089, 'psi': 0.9937054647389196}-{'f1_val': 0.992869746824563, 'auprc': 0.9954123960336321, 'loss_val': 0.2758909866072806, 'psi': 0.9938868065081905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=18 head_norm_before_train=1.236544 cos_to_last_merge=0.9993 (last merge round=16)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9526191506046973, 'auprc': 0.9983999879579633, 'loss_val': 0.25439546968876453, 'psi': 0.9709314855460036}-{'f1_val': 0.9967224195815153, 'auprc': 0.9980463500239598, 'loss_val': 0.2787322262387991, 'psi': 0.9972519917584932}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=0.909238 cos_to_last_merge=0.9987 (last merge round=16)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6289800655219406, 'auprc': 0.6915110068098675, 'loss_val': 0.6558984011411237, 'psi': 0.6539924420371115}-{'f1_val': 0.7087557992550573, 'auprc': 0.682955944653198, 'loss_val': 0.6578566686597164, 'psi': 0.6984358574143135}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.387038 cos_to_last_merge=0.9923 (last merge round=13)
[S14] round=18 local utility u=0.014556 metrics={'f1_val': 0.9782522119123418, 'auprc': 0.9987841627391824, 'loss_val': 0.10293509881803847, 'psi': 0.986464992243078}-{'f1_val': 0.9771458074986243, 'auprc': 0.9985049566288183, 'loss_val': 0.1245708684536162, 'psi': 0.9856894671507019}
[S15] START round=18 head_norm_before_train=1.554233 cos_to_last_merge=0.9994 (last merge round=16)
[S15] round=18 local utility u=0.202924 metrics={'f1_val': 0.693435623841315, 'auprc': 0.9824505979197283, 'loss_val': 0.2717754671257382, 'psi': 0.8090416134726803}-{'f1_val': 0.6924296800597842, 'auprc': 0.8773044587914487, 'loss_val': 0.3561492491702914, 'psi': 0.7663795915524501}
[S16] START round=18 head_norm_before_train=1.221545 cos_to_last_merge=0.9945 (last merge round=15)
[S16] round=18 local utility u=0.481667 metrics={'f1_val': 0.9644905673910579, 'auprc': 0.9939012650265514, 'loss_val': 0.24905465115585546, 'psi': 0.9762548464452554}-{'f1_val': 0.8425219024741822, 'auprc': 0.997902431941629, 'loss_val': 0.4925800682314025, 'psi': 0.904674114261161}
[S17] START round=18 head_norm_before_train=1.497271 (no previous merge yet)
[S17] round=18 local utility u=0.062231 metrics={'f1_val': 0.3624382816978704, 'auprc': 0.8126098714754517, 'loss_val': 0.9279542961673893, 'psi': 0.5425069176089029}-{'f1_val': 0.34858938033049064, 'auprc': 0.8272940356206864, 'loss_val': 1.0133745962960505, 'psi': 0.540071242446569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:61810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9711
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9838
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9935
[S7] RECEIVED delta(kind=head bytes=1807) from S14
[S7] cosine check vs S14: cos=0.9711
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9645 head_norm=1.277243
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.552603e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9776 head_norm=1.236148 delta_norm=0.155260
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9783 head_norm=1.440456
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.852618e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9783 head_norm=1.340993 delta_norm=0.185262
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5637 head_norm=1.261053
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.852618e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5597 head_norm=1.340993 delta_norm=0.185262
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.227251 cos_to_last_merge=0.9991 (last merge round=17)
[S2] round=19 local utility u=0.021186 metrics={'f1_val': 0.7006147961933911, 'auprc': 0.6588126944887668, 'loss_val': 0.36237630544784016, 'psi': 0.6838939555115413}-{'f1_val': 0.701055136928628, 'auprc': 0.6598364726613752, 'loss_val': 0.41046140640513634, 'psi': 0.6845676712217268}
[S3] START round=19 head_norm_before_train=1.138804 cos_to_last_merge=0.9916 (last merge round=16)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9980426109849693, 'loss_val': 0.19468702726564982, 'psi': 0.9755596288153632}-{'f1_val': 0.973946656027713, 'auprc': 0.9981206912715744, 'loss_val': 0.20097289130335627, 'psi': 0.9836162701252577}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.976 u=0.0000 p_local=0.1880 f1=0.961 auprc=0.998 bytes=21528
[S4] START round=19 head_norm_before_train=1.055819 cos_to_last_merge=0.9409 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.6051333472074021, 'auprc': 0.9311681556272133, 'loss_val': 0.4449227476688554, 'psi': 0.7355472705753265}-{'f1_val': 0.6071622419574291, 'auprc': 0.9377970302529826, 'loss_val': 0.4565862337313522, 'psi': 0.7394161572756505}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.736 u=0.0000 p_local=0.0890 f1=0.605 auprc=0.931 bytes=21557
[S5] START round=19 head_norm_before_train=1.222388 cos_to_last_merge=0.9637 (last merge round=12)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7944773381777562, 'loss_val': 0.509860728800023, 'psi': 0.7462950671682964}-{'f1_val': 0.7006090940057808, 'auprc': 0.9926934419881103, 'loss_val': 0.3711977444915326, 'psi': 0.8174428331987126}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.746 u=0.0000 p_local=0.2149 f1=0.714 auprc=0.794 bytes=23371
[S6] START round=19 head_norm_before_train=1.685958 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6485678764928287, 'auprc': 0.8183344139515638, 'loss_val': 0.3506174077073384, 'psi': 0.7164744914763228}-{'f1_val': 0.6914212108855116, 'auprc': 0.8991032543823871, 'loss_val': 0.328258117181536, 'psi': 0.7744940282842618}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.716 u=0.0000 p_local=0.1806 f1=0.649 auprc=0.818 bytes=26945
[S7] START round=19 head_norm_before_train=1.340993 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.064056 metrics={'f1_val': 0.5819730689073389, 'auprc': 0.7833849950008227, 'loss_val': 0.7790133116067206, 'psi': 0.6625378393447324}-{'f1_val': 0.5637148582156215, 'auprc': 0.7771369869840159, 'loss_val': 0.7788311008894396, 'psi': 0.6490837097229794}
[S8] START round=19 head_norm_before_train=1.306909 cos_to_last_merge=0.9505 (last merge round=11)
[S8] round=19 local utility u=0.019891 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9921429059700034, 'loss_val': 0.45320047902716754, 'psi': 0.789895215002246}-{'f1_val': 0.6547822169836268, 'auprc': 0.9917743266431969, 'loss_val': 0.4901886251087888, 'psi': 0.7895790608474549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=20 psi=0.790 u=0.0199 p_local=0.1259 f1=0.655 auprc=0.992 bytes=28770
[S9] START round=19 head_norm_before_train=1.464856 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.028207 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.998479598830794, 'loss_val': 0.11350518145859333, 'psi': 0.992340251836186}-{'f1_val': 0.9856836147752347, 'auprc': 0.9984850929331726, 'loss_val': 0.1545528882247934, 'psi': 0.9908042060384098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9882 head_norm=1.498501
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.025558e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9882 head_norm=1.541505 delta_norm=0.102556
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.992 u=0.0282 p_local=0.1785 f1=0.988 auprc=0.998 bytes=26988
[S10] START round=19 head_norm_before_train=1.024894 cos_to_last_merge=0.9985 (last merge round=17)
[S10] round=19 local utility u=0.019446 metrics={'f1_val': 0.9947663626183323, 'auprc': 0.9892183165723816, 'loss_val': 0.22505047508385742, 'psi': 0.992547144199952}-{'f1_val': 0.995182342619192, 'auprc': 0.9914901479185113, 'loss_val': 0.273254722017089, 'psi': 0.9937054647389196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=20 psi=0.993 u=0.0194 p_local=0.2045 f1=0.995 auprc=0.989 bytes=30519
[S11] START round=19 head_norm_before_train=1.280864 cos_to_last_merge=0.9971 (last merge round=16)
[S11] round=19 local utility u=0.176210 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9980819059177198, 'loss_val': 0.16564146000286928, 'psi': 0.9972662141159971}-{'f1_val': 0.9526191506046973, 'auprc': 0.9983999879579633, 'loss_val': 0.25439546968876453, 'psi': 0.9709314855460036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=20 psi=0.997 u=0.1762 p_local=0.2092 f1=0.997 auprc=0.998 bytes=26983
[S13] START round=19 head_norm_before_train=0.945694 cos_to_last_merge=0.9948 (last merge round=16)
[S13] round=19 local utility u=0.217009 metrics={'f1_val': 0.696623966987067, 'auprc': 0.6766831811622201, 'loss_val': 0.5832611947593681, 'psi': 0.6886476526571282}-{'f1_val': 0.6289800655219406, 'auprc': 0.6915110068098675, 'loss_val': 0.6558984011411237, 'psi': 0.6539924420371115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S13] r=20 psi=0.689 u=0.2170 p_local=0.1636 f1=0.697 auprc=0.677 bytes=17922
[S14] START round=19 head_norm_before_train=1.340993 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9448113286732134, 'auprc': 0.9984571870794039, 'loss_val': 0.12658339450377323, 'psi': 0.9662696720356896}-{'f1_val': 0.9782522119123418, 'auprc': 0.9987841627391824, 'loss_val': 0.10293509881803847, 'psi': 0.986464992243078}
[S15] START round=19 head_norm_before_train=1.589970 cos_to_last_merge=0.9973 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7013090590240976, 'auprc': 0.8182339523369648, 'loss_val': 0.37044535483193536, 'psi': 0.7480790163492445}-{'f1_val': 0.693435623841315, 'auprc': 0.9824505979197283, 'loss_val': 0.2717754671257382, 'psi': 0.8090416134726803}
[S16] START round=19 head_norm_before_train=1.236148 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8745279956148766, 'auprc': 0.9916241120836601, 'loss_val': 0.40452672497624137, 'psi': 0.92136644220239}-{'f1_val': 0.9644905673910579, 'auprc': 0.9939012650265514, 'loss_val': 0.24905465115585546, 'psi': 0.9762548464452554}
[S17] START round=19 head_norm_before_train=1.507825 (no previous merge yet)
[S17] round=19 local utility u=0.083486 metrics={'f1_val': 0.371874274488129, 'auprc': 0.8395686057052648, 'loss_val': 0.8984742690022754, 'psi': 0.5589520069749834}-{'f1_val': 0.3624382816978704, 'auprc': 0.8126098714754517, 'loss_val': 0.9279542961673893, 'psi': 0.5425069176089029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=20 psi=0.559 u=0.0835 p_local=0.1120 f1=0.372 auprc=0.840 bytes=25164
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:61816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.748 u=0.0000 p_local=0.1317 f1=0.701 auprc=0.818 bytes=25200
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S14] r=20 psi=0.966 u=0.0000 p_local=0.0883 f1=0.945 auprc=0.998 bytes=21594
[S16] r=20 psi=0.921 u=0.0000 p_local=0.2581 f1=0.875 auprc=0.992 bytes=23344
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9993
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=0.9920
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7006 head_norm=1.266682
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.264468e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7006 head_norm=1.265673 delta_norm=0.126447
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.684 u=0.0212 p_local=0.0695 f1=0.701 auprc=0.659 bytes=25187
[S7] r=20 psi=0.663 u=0.0641 p_local=0.1828 f1=0.582 auprc=0.783 bytes=21552
[S2] START round=20 head_norm_before_train=1.265673 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.091265 metrics={'f1_val': 0.7009681364200602, 'auprc': 0.73159157326824, 'loss_val': 0.40030336570255354, 'psi': 0.7132175111593321}-{'f1_val': 0.7006147961933911, 'auprc': 0.6588126944887668, 'loss_val': 0.36237630544784016, 'psi': 0.6838939555115413}
[S3] START round=20 head_norm_before_train=1.207520 cos_to_last_merge=0.9847 (last merge round=16)
[S3] round=20 local utility u=0.137861 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9985345359794381, 'loss_val': 0.12641134941201926, 'psi': 0.9963534646237323}-{'f1_val': 0.9605709740356257, 'auprc': 0.9980426109849693, 'loss_val': 0.19468702726564982, 'psi': 0.9755596288153632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=20 head_norm_before_train=1.098394 cos_to_last_merge=0.9329 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=20 local utility u=0.021003 metrics={'f1_val': 0.6039621815775882, 'auprc': 0.9564784107208597, 'loss_val': 0.47182116176150746, 'psi': 0.7449686732348968}-{'f1_val': 0.6051333472074021, 'auprc': 0.9311681556272133, 'loss_val': 0.4449227476688554, 'psi': 0.7355472705753265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] sending update (kind=head size=1787 to 1 peers)
[S5] START round=20 head_norm_before_train=1.235736 cos_to_last_merge=0.9603 (last merge round=12)
[S5] round=20 local utility u=0.061377 metrics={'f1_val': 0.7011231719029499, 'auprc': 0.8224767051110959, 'loss_val': 0.3928033327526073, 'psi': 0.7496645851862083}-{'f1_val': 0.7141735531619898, 'auprc': 0.7944773381777562, 'loss_val': 0.509860728800023, 'psi': 0.7462950671682964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=20 head_norm_before_train=1.707206 (no previous merge yet)
[S6] round=20 local utility u=0.549764 metrics={'f1_val': 0.8250313259836445, 'auprc': 0.8416083671420749, 'loss_val': 0.37969287874583896, 'psi': 0.8316621424470166}-{'f1_val': 0.6485678764928287, 'auprc': 0.8183344139515638, 'loss_val': 0.3506174077073384, 'psi': 0.7164744914763228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=20 head_norm_before_train=1.351025 cos_to_last_merge=0.9999 (last merge round=18)
[S7] round=20 local utility u=0.393128 metrics={'f1_val': 0.6698443228980241, 'auprc': 0.8136677304158134, 'loss_val': 0.6108336099718218, 'psi': 0.7273736859051398}-{'f1_val': 0.5819730689073389, 'auprc': 0.7833849950008227, 'loss_val': 0.7790133116067206, 'psi': 0.6625378393447324}
[S8] START round=20 head_norm_before_train=1.335954 cos_to_last_merge=0.9459 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=20 local utility u=0.009986 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9923285714469123, 'loss_val': 0.43209893835770874, 'psi': 0.7898007587689411}-{'f1_val': 0.6550634210237409, 'auprc': 0.9921429059700034, 'loss_val': 0.45320047902716754, 'psi': 0.789895215002246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=20 head_norm_before_train=1.541505 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.042593 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984775061717939, 'loss_val': 0.07879115080006265, 'psi': 0.9973873095570525}-{'f1_val': 0.9882473538397808, 'auprc': 0.998479598830794, 'loss_val': 0.11350518145859333, 'psi': 0.992340251836186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=20 head_norm_before_train=1.067962 cos_to_last_merge=0.9954 (last merge round=17)
[S10] round=20 local utility u=0.018547 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9893744080107842, 'loss_val': 0.19092130726047032, 'psi': 0.9928591687758288}-{'f1_val': 0.9947663626183323, 'auprc': 0.9892183165723816, 'loss_val': 0.22505047508385742, 'psi': 0.992547144199952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=20 head_norm_before_train=1.323393 cos_to_last_merge=0.9940 (last merge round=16)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9857687565140019, 'auprc': 0.9984935153528498, 'loss_val': 0.16061383732198228, 'psi': 0.990858660049541}-{'f1_val': 0.9967224195815153, 'auprc': 0.9980819059177198, 'loss_val': 0.16564146000286928, 'psi': 0.9972662141159971}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=0.973760 cos_to_last_merge=0.9908 (last merge round=16)
[S13] round=20 local utility u=0.033938 metrics={'f1_val': 0.7002649643019924, 'auprc': 0.6732360508687034, 'loss_val': 0.5268890045608455, 'psi': 0.6894533989286767}-{'f1_val': 0.696623966987067, 'auprc': 0.6766831811622201, 'loss_val': 0.5832611947593681, 'psi': 0.6886476526571282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=20 head_norm_before_train=1.392232 cos_to_last_merge=0.9995 (last merge round=18)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.935622725243589, 'auprc': 0.9967719242140147, 'loss_val': 0.13816403340875272, 'psi': 0.9600824048317593}-{'f1_val': 0.9448113286732134, 'auprc': 0.9984571870794039, 'loss_val': 0.12658339450377323, 'psi': 0.9662696720356896}
[S15] START round=20 head_norm_before_train=1.621783 cos_to_last_merge=0.9944 (last merge round=16)
[S15] round=20 local utility u=0.666197 metrics={'f1_val': 0.8053025639844598, 'auprc': 0.9864240466787764, 'loss_val': 0.16658235366949317, 'psi': 0.8777511570621864}-{'f1_val': 0.7013090590240976, 'auprc': 0.8182339523369648, 'loss_val': 0.37044535483193536, 'psi': 0.7480790163492445}
[S16] START round=20 head_norm_before_train=1.287047 cos_to_last_merge=0.9986 (last merge round=18)
[S16] round=20 local utility u=0.205074 metrics={'f1_val': 0.9187939227544577, 'auprc': 0.9951156660413825, 'loss_val': 0.27044906759227655, 'psi': 0.9493226200692275}-{'f1_val': 0.8745279956148766, 'auprc': 0.9916241120836601, 'loss_val': 0.40452672497624137, 'psi': 0.92136644220239}
[S17] START round=20 head_norm_before_train=1.517257 (no previous merge yet)
[S17] round=20 local utility u=0.104201 metrics={'f1_val': 0.39823583956641145, 'auprc': 0.851163525677899, 'loss_val': 0.883027168468308, 'psi': 0.5794069140110065}-{'f1_val': 0.371874274488129, 'auprc': 0.8395686057052648, 'loss_val': 0.8984742690022754, 'psi': 0.5589520069749834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9356 head_norm=1.444940
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.457158e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9351 head_norm=1.397280 delta_norm=0.064572
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.071 → S7@127.0.0.1:61808
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S2
[S16] cosine check vs S2: cos=0.9959
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9992
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9946
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=0.9959
[S7] ⇄ pheromone p=0.225 → S14@127.0.0.1:61814
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7010 head_norm=1.301527
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.263220e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7010 head_norm=1.318502 delta_norm=0.062632
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.074 → S16@127.0.0.1:61816
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9188 head_norm=1.338196
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.507353e-02
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9185 head_norm=1.308107 delta_norm=0.085074
[S16] aggregate: ACCEPT kept=['S2', 'S2'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.248 → S2@127.0.0.1:61802
[S15] ⇄ pheromone p=0.239 → S9@127.0.0.1:61810
[S2] START round=21 head_norm_before_train=1.318502 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.001217 metrics={'f1_val': 0.7009612149238014, 'auprc': 0.7343574174011627, 'loss_val': 0.4061244401868287, 'psi': 0.714319695914746}-{'f1_val': 0.7009681364200602, 'auprc': 0.73159157326824, 'loss_val': 0.40030336570255354, 'psi': 0.7132175111593321}
[S3] START round=21 head_norm_before_train=1.274149 cos_to_last_merge=0.9777 (last merge round=16)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9985726047893546, 'loss_val': 0.1295917859957108, 'psi': 0.9763521550887504}-{'f1_val': 0.9948994170532618, 'auprc': 0.9985345359794381, 'loss_val': 0.12641134941201926, 'psi': 0.9963534646237323}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.134513 cos_to_last_merge=0.9268 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=21 local utility u=0.777754 metrics={'f1_val': 0.8536646774235218, 'auprc': 0.9534598904752815, 'loss_val': 0.4054723991418431, 'psi': 0.8935827626442256}-{'f1_val': 0.6039621815775882, 'auprc': 0.9564784107208597, 'loss_val': 0.47182116176150746, 'psi': 0.7449686732348968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] sending update (kind=head size=1789 to 1 peers)
[S5] START round=21 head_norm_before_train=1.246465 cos_to_last_merge=0.9580 (last merge round=12)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6874280518200319, 'auprc': 0.7919780462748446, 'loss_val': 0.4870398444348823, 'psi': 0.7292480496019569}-{'f1_val': 0.7011231719029499, 'auprc': 0.8224767051110959, 'loss_val': 0.3928033327526073, 'psi': 0.7496645851862083}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.722400 (no previous merge yet)
[S6] round=21 local utility u=0.769512 metrics={'f1_val': 0.9765353545598441, 'auprc': 0.9804690654600439, 'loss_val': 0.16627422261690114, 'psi': 0.9781088389199241}-{'f1_val': 0.8250313259836445, 'auprc': 0.8416083671420749, 'loss_val': 0.37969287874583896, 'psi': 0.8316621424470166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=21 head_norm_before_train=1.360571 cos_to_last_merge=0.9996 (last merge round=18)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6674957454062296, 'auprc': 0.7978416087694279, 'loss_val': 0.62770858511015, 'psi': 0.7196340907515089}-{'f1_val': 0.6698443228980241, 'auprc': 0.8136677304158134, 'loss_val': 0.6108336099718218, 'psi': 0.7273736859051398}
[S8] START round=21 head_norm_before_train=1.366664 cos_to_last_merge=0.9415 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=21 local utility u=0.005345 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.993848481357888, 'loss_val': 0.4276564823317881, 'psi': 0.7905774451573997}-{'f1_val': 0.6547822169836268, 'auprc': 0.9923285714469123, 'loss_val': 0.43209893835770874, 'psi': 0.7898007587689411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=21 head_norm_before_train=1.573668 cos_to_last_merge=0.9996 (last merge round=19)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9988580542031862, 'loss_val': 0.06733974383684413, 'psi': 0.9950525024034087}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984775061717939, 'loss_val': 0.07879115080006265, 'psi': 0.9973873095570525}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9925 head_norm=1.605183
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.584548e-02
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9925 head_norm=1.623742 delta_norm=0.095845
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] START round=21 head_norm_before_train=1.108975 cos_to_last_merge=0.9915 (last merge round=17)
[S10] round=21 local utility u=0.029434 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9955065628562302, 'loss_val': 0.14759317760166338, 'psi': 0.995026283911794}-{'f1_val': 0.995182342619192, 'auprc': 0.9893744080107842, 'loss_val': 0.19092130726047032, 'psi': 0.9928591687758288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=21 head_norm_before_train=1.367952 cos_to_last_merge=0.9900 (last merge round=16)
[S11] round=21 local utility u=0.064129 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987005080785802, 'loss_val': 0.09869782485942603, 'psi': 0.9975136549803414}-{'f1_val': 0.9857687565140019, 'auprc': 0.9984935153528498, 'loss_val': 0.16061383732198228, 'psi': 0.990858660049541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=21 head_norm_before_train=1.001161 cos_to_last_merge=0.9862 (last merge round=16)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6963846367506941, 'auprc': 0.6724693528092847, 'loss_val': 0.513649388058122, 'psi': 0.6868185231741303}-{'f1_val': 0.7002649643019924, 'auprc': 0.6732360508687034, 'loss_val': 0.5268890045608455, 'psi': 0.6894533989286767}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.397280 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.058126 metrics={'f1_val': 0.949968504056312, 'auprc': 0.9970322373293474, 'loss_val': 0.10876862535236545, 'psi': 0.9687939973655262}-{'f1_val': 0.935622725243589, 'auprc': 0.9967719242140147, 'loss_val': 0.13816403340875272, 'psi': 0.9600824048317593}
[S15] START round=21 head_norm_before_train=1.647676 cos_to_last_merge=0.9919 (last merge round=16)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7013083217262647, 'auprc': 0.8788753192183646, 'loss_val': 0.3661303958663071, 'psi': 0.7723351207231046}-{'f1_val': 0.8053025639844598, 'auprc': 0.9864240466787764, 'loss_val': 0.16658235366949317, 'psi': 0.8777511570621864}
[S16] START round=21 head_norm_before_train=1.308107 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8534810630691416, 'auprc': 0.9899657195786047, 'loss_val': 0.5311488958570147, 'psi': 0.9080749256729268}-{'f1_val': 0.9187939227544577, 'auprc': 0.9951156660413825, 'loss_val': 0.27044906759227655, 'psi': 0.9493226200692275}
[S17] START round=21 head_norm_before_train=1.525979 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3702680599068757, 'auprc': 0.8501400322285515, 'loss_val': 0.8607864376830286, 'psi': 0.562216848835546}-{'f1_val': 0.39823583956641145, 'auprc': 0.851163525677899, 'loss_val': 0.883027168468308, 'psi': 0.5794069140110065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.9995
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9975
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9500 head_norm=1.443711
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.109534e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9480 head_norm=1.401426 delta_norm=0.061095
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.350593 cos_to_last_merge=0.9997 (last merge round=20)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009756597039377, 'auprc': 0.6599590932799607, 'loss_val': 0.39230026618654124, 'psi': 0.6845690331343469}-{'f1_val': 0.7009612149238014, 'auprc': 0.7343574174011627, 'loss_val': 0.4061244401868287, 'psi': 0.714319695914746}
[S3] START round=22 head_norm_before_train=1.326924 cos_to_last_merge=0.9720 (last merge round=16)
[S3] round=22 local utility u=0.124474 metrics={'f1_val': 0.9961497684139329, 'auprc': 0.9983649130780444, 'loss_val': 0.08768725703912848, 'psi': 0.9970358262795775}-{'f1_val': 0.9615385219550141, 'auprc': 0.9985726047893546, 'loss_val': 0.1295917859957108, 'psi': 0.9763521550887504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=22 head_norm_before_train=1.158968 cos_to_last_merge=0.9229 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=22 local utility u=0.252496 metrics={'f1_val': 0.9388325534985209, 'auprc': 0.9336524699631474, 'loss_val': 0.3520651587192225, 'psi': 0.9367605200843716}-{'f1_val': 0.8536646774235218, 'auprc': 0.9534598904752815, 'loss_val': 0.4054723991418431, 'psi': 0.8935827626442256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] sending update (kind=head size=1789 to 1 peers)
[S5] START round=22 head_norm_before_train=1.260111 cos_to_last_merge=0.9555 (last merge round=12)
[S5] round=22 local utility u=0.412733 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9907643512110273, 'loss_val': 0.337015013275285, 'psi': 0.8166707760820155}-{'f1_val': 0.6874280518200319, 'auprc': 0.7919780462748446, 'loss_val': 0.4870398444348823, 'psi': 0.7292480496019569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=22 head_norm_before_train=1.738176 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5435487382237733, 'auprc': 0.7765214475617602, 'loss_val': 0.8744073268031703, 'psi': 0.6367378219589681}-{'f1_val': 0.9765353545598441, 'auprc': 0.9804690654600439, 'loss_val': 0.16627422261690114, 'psi': 0.9781088389199241}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.369899 cos_to_last_merge=0.9991 (last merge round=18)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4139862182389675, 'auprc': 0.7725906474631167, 'loss_val': 1.0492940573491796, 'psi': 0.5574279899286272}-{'f1_val': 0.6674957454062296, 'auprc': 0.7978416087694279, 'loss_val': 0.62770858511015, 'psi': 0.7196340907515089}
[S8] START round=22 head_norm_before_train=1.397314 cos_to_last_merge=0.9372 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.994188228540522, 'loss_val': 0.4345286292517761, 'psi': 0.7907133440304535}-{'f1_val': 0.6550634210237409, 'auprc': 0.993848481357888, 'loss_val': 0.4276564823317881, 'psi': 0.7905774451573997}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=1.623742 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.9988592438093231, 'loss_val': 0.07557207396503351, 'psi': 0.9919998457111219}-{'f1_val': 0.9925154678702236, 'auprc': 0.9988580542031862, 'loss_val': 0.06733974383684413, 'psi': 0.9950525024034087}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.157509 cos_to_last_merge=0.9859 (last merge round=17)
[S10] round=22 local utility u=0.014257 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995539392439592, 'loss_val': 0.1220676798915176, 'psi': 0.9953284603874617}-{'f1_val': 0.9947060979488367, 'auprc': 0.9955065628562302, 'loss_val': 0.14759317760166338, 'psi': 0.995026283911794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=22 head_norm_before_train=1.410794 cos_to_last_merge=0.9858 (last merge round=16)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9617291085030502, 'auprc': 0.9980955778028748, 'loss_val': 0.17585096852006107, 'psi': 0.97627569622298}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987005080785802, 'loss_val': 0.09869782485942603, 'psi': 0.9975136549803414}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.028913 cos_to_last_merge=0.9808 (last merge round=16)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6978528060969632, 'auprc': 0.6671398364594564, 'loss_val': 0.5193049594195227, 'psi': 0.6855676182419606}-{'f1_val': 0.6963846367506941, 'auprc': 0.6724693528092847, 'loss_val': 0.513649388058122, 'psi': 0.6868185231741303}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.401426 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.160898 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9975079898047396, 'loss_val': 0.07171781765204754, 'psi': 0.9973161171240099}-{'f1_val': 0.949968504056312, 'auprc': 0.9970322373293474, 'loss_val': 0.10876862535236545, 'psi': 0.9687939973655262}
[S15] START round=22 head_norm_before_train=1.677040 cos_to_last_merge=0.9894 (last merge round=16)
[S15] round=22 local utility u=0.055682 metrics={'f1_val': 0.6992071885927392, 'auprc': 0.9151630137475942, 'loss_val': 0.35102318317843256, 'psi': 0.7855895186546813}-{'f1_val': 0.7013083217262647, 'auprc': 0.8788753192183646, 'loss_val': 0.3661303958663071, 'psi': 0.7723351207231046}
[S16] START round=22 head_norm_before_train=1.348000 cos_to_last_merge=0.9993 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.7436940850246628, 'auprc': 0.8923427682596969, 'loss_val': 0.8304803345167135, 'psi': 0.8031535583186764}-{'f1_val': 0.8534810630691416, 'auprc': 0.9899657195786047, 'loss_val': 0.5311488958570147, 'psi': 0.9080749256729268}
[S17] START round=22 head_norm_before_train=1.539085 (no previous merge yet)
[S17] round=22 local utility u=0.086710 metrics={'f1_val': 0.3730211019074373, 'auprc': 0.8803026936745445, 'loss_val': 0.7943725043009869, 'psi': 0.5759337386142802}-{'f1_val': 0.3702680599068757, 'auprc': 0.8501400322285515, 'loss_val': 0.8607864376830286, 'psi': 0.562216848835546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.7437 head_norm=1.386326
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.593122e-02
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.7437 head_norm=1.367805 delta_norm=0.045931
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.4140 head_norm=1.379446
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.376765e-02
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4173 head_norm=1.410503 delta_norm=0.063768
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9995
[S2] START round=23 head_norm_before_train=1.379503 cos_to_last_merge=0.9988 (last merge round=20)
[S2] round=23 local utility u=0.026893 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6568074060622098, 'loss_val': 0.3306139034200328, 'psi': 0.683463832936842}-{'f1_val': 0.7009756597039377, 'auprc': 0.6599590932799607, 'loss_val': 0.39230026618654124, 'psi': 0.6845690331343469}
[S3] START round=23 head_norm_before_train=1.372765 cos_to_last_merge=0.9669 (last merge round=16)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9591738222712674, 'auprc': 0.9986873200894191, 'loss_val': 0.152339991867857, 'psi': 0.9749792213985281}-{'f1_val': 0.9961497684139329, 'auprc': 0.9983649130780444, 'loss_val': 0.08768725703912848, 'psi': 0.9970358262795775}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.176458 cos_to_last_merge=0.9203 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=23 local utility u=0.045427 metrics={'f1_val': 0.9388919609785432, 'auprc': 0.949191008799338, 'loss_val': 0.3081825999133996, 'psi': 0.9430115801068613}-{'f1_val': 0.9388325534985209, 'auprc': 0.9336524699631474, 'loss_val': 0.3520651587192225, 'psi': 0.9367605200843716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=23 head_norm_before_train=1.271992 cos_to_last_merge=0.9534 (last merge round=12)
[S5] round=23 local utility u=0.009751 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9920809890884906, 'loss_val': 0.32146307746459585, 'psi': 0.8171974312330008}-{'f1_val': 0.7006083926626743, 'auprc': 0.9907643512110273, 'loss_val': 0.337015013275285, 'psi': 0.8166707760820155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=23 head_norm_before_train=1.755965 (no previous merge yet)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.823965656433533, 'auprc': 0.961450195950724, 'loss_val': 0.29795113095995895, 'psi': 0.8789594722404095}-{'f1_val': 0.5435487382237733, 'auprc': 0.7765214475617602, 'loss_val': 0.8744073268031703, 'psi': 0.6367378219589681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=23 head_norm_before_train=1.410503 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.565347 metrics={'f1_val': 0.5560760859120863, 'auprc': 0.7836462398082835, 'loss_val': 0.8043061755830938, 'psi': 0.6471041474705652}-{'f1_val': 0.4139862182389675, 'auprc': 0.7725906474631167, 'loss_val': 1.0492940573491796, 'psi': 0.5574279899286272}
[S8] START round=23 head_norm_before_train=1.427425 cos_to_last_merge=0.9334 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=23 local utility u=0.025856 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9963163370855371, 'loss_val': 0.38751446548484547, 'psi': 0.7913958650243909}-{'f1_val': 0.6550634210237409, 'auprc': 0.994188228540522, 'loss_val': 0.4345286292517761, 'psi': 0.7907133440304535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=23 head_norm_before_train=1.652809 cos_to_last_merge=0.9997 (last merge round=21)
[S9] round=23 local utility u=0.041411 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984761061724434, 'loss_val': 0.04700166135766983, 'psi': 0.9973867495573122}-{'f1_val': 0.9874269136456545, 'auprc': 0.9988592438093231, 'loss_val': 0.07557207396503351, 'psi': 0.9919998457111219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=23 head_norm_before_train=1.207405 cos_to_last_merge=0.9797 (last merge round=17)
[S10] round=23 local utility u=0.005507 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950169689891452, 'loss_val': 0.10948577397402194, 'psi': 0.9951194910072829}-{'f1_val': 0.9951878390193748, 'auprc': 0.995539392439592, 'loss_val': 0.1220676798915176, 'psi': 0.9953284603874617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=23 head_norm_before_train=1.450718 cos_to_last_merge=0.9817 (last merge round=16)
[S11] round=23 local utility u=0.160917 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987340129808066, 'loss_val': 0.065892792869489, 'psi': 0.9975270569412318}-{'f1_val': 0.9617291085030502, 'auprc': 0.9980955778028748, 'loss_val': 0.17585096852006107, 'psi': 0.97627569622298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=23 head_norm_before_train=1.056184 cos_to_last_merge=0.9751 (last merge round=16)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6478110639789894, 'auprc': 0.6672845025018526, 'loss_val': 0.573750571763329, 'psi': 0.6556004393881346}-{'f1_val': 0.6978528060969632, 'auprc': 0.6671398364594564, 'loss_val': 0.5193049594195227, 'psi': 0.6855676182419606}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.446954 cos_to_last_merge=0.9996 (last merge round=21)
[S14] round=23 local utility u=0.011110 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9988093062525975, 'loss_val': 0.06010369932544716, 'psi': 0.9985067750166636}-{'f1_val': 0.9971882020035234, 'auprc': 0.9975079898047396, 'loss_val': 0.07171781765204754, 'psi': 0.9973161171240099}
[S15] START round=23 head_norm_before_train=1.702316 cos_to_last_merge=0.9871 (last merge round=16)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9951549650665892, 'auprc': 0.9923119860197936, 'loss_val': 0.0900892898059118, 'psi': 0.994017773447871}-{'f1_val': 0.6992071885927392, 'auprc': 0.9151630137475942, 'loss_val': 0.35102318317843256, 'psi': 0.7855895186546813}
[S16] START round=23 head_norm_before_train=1.367805 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=1.000000 metrics={'f1_val': 0.9408153098678748, 'auprc': 0.9935140716557811, 'loss_val': 0.185540433728486, 'psi': 0.9618948145830373}-{'f1_val': 0.7436940850246628, 'auprc': 0.8923427682596969, 'loss_val': 0.8304803345167135, 'psi': 0.8031535583186764}
[S17] START round=23 head_norm_before_train=1.556553 (no previous merge yet)
[S17] round=23 local utility u=0.294025 metrics={'f1_val': 0.4154545313642549, 'auprc': 0.9475646852435027, 'loss_val': 0.6627095486605761, 'psi': 0.628298592915954}-{'f1_val': 0.3730211019074373, 'auprc': 0.8803026936745445, 'loss_val': 0.7943725043009869, 'psi': 0.5759337386142802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9984
[S2] RECEIVED delta(kind=head bytes=1804) from S16
[S2] cosine check vs S16: cos=0.9969
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9984
[S16] RECEIVED delta(kind=head bytes=1802) from S2
[S16] cosine check vs S2: cos=0.9969
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9983 head_norm=1.491036
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.350325e-02
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9983 head_norm=1.455699 delta_norm=0.053503
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7012 head_norm=1.404637
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.537733e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7012 head_norm=1.400558 delta_norm=0.055377
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5561 head_norm=1.421498
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.131723e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5584 head_norm=1.444808 delta_norm=0.041317
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9408 head_norm=1.398661
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.537734e-02
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9410 head_norm=1.400558 delta_norm=0.055377
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.400558 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6576103337993656, 'loss_val': 0.35219927697386644, 'psi': 0.6837850040317044}-{'f1_val': 0.7012347841865968, 'auprc': 0.6568074060622098, 'loss_val': 0.3306139034200328, 'psi': 0.683463832936842}
[S3] START round=24 head_norm_before_train=1.410863 cos_to_last_merge=0.9630 (last merge round=16)
[S3] round=24 local utility u=0.132959 metrics={'f1_val': 0.991152338253556, 'auprc': 0.9988447731548323, 'loss_val': 0.07876499159293548, 'psi': 0.9942293122140664}-{'f1_val': 0.9591738222712674, 'auprc': 0.9986873200894191, 'loss_val': 0.152339991867857, 'psi': 0.9749792213985281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=24 head_norm_before_train=1.196501 cos_to_last_merge=0.9173 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9320790001643156, 'auprc': 0.9609702805026801, 'loss_val': 0.33259148083779344, 'psi': 0.9436355122996614}-{'f1_val': 0.9388919609785432, 'auprc': 0.949191008799338, 'loss_val': 0.3081825999133996, 'psi': 0.9430115801068613}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.287781 cos_to_last_merge=0.9501 (last merge round=12)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6653626424179315, 'auprc': 0.8700414643612631, 'loss_val': 0.4342631628772468, 'psi': 0.7472341711952641}-{'f1_val': 0.7006083926626743, 'auprc': 0.9920809890884906, 'loss_val': 0.32146307746459585, 'psi': 0.8171974312330008}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.771126 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7745093779280343, 'auprc': 0.838062259232796, 'loss_val': 0.540563224382601, 'psi': 0.799930530449939}-{'f1_val': 0.823965656433533, 'auprc': 0.961450195950724, 'loss_val': 0.29795113095995895, 'psi': 0.8789594722404095}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.444808 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.354549 metrics={'f1_val': 0.6324056429402025, 'auprc': 0.8015786641357845, 'loss_val': 0.6069832205033255, 'psi': 0.7000748514184354}-{'f1_val': 0.5560760859120863, 'auprc': 0.7836462398082835, 'loss_val': 0.8043061755830938, 'psi': 0.6471041474705652}
[S8] START round=24 head_norm_before_train=1.454076 cos_to_last_merge=0.9299 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=24 local utility u=0.012546 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9947907475339693, 'loss_val': 0.35953285108420713, 'psi': 0.7909543516278323}-{'f1_val': 0.6547822169836268, 'auprc': 0.9963163370855371, 'loss_val': 0.38751446548484547, 'psi': 0.7913958650243909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=24 head_norm_before_train=1.678820 cos_to_last_merge=0.9992 (last merge round=21)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.99847673995127, 'loss_val': 0.04717718094325572, 'psi': 0.994629888108544}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984761061724434, 'loss_val': 0.04700166135766983, 'psi': 0.9973867495573122}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.252284 cos_to_last_merge=0.9736 (last merge round=17)
[S10] round=24 local utility u=0.010717 metrics={'f1_val': 0.995475518495455, 'auprc': 0.9957181004532265, 'loss_val': 0.09188139857917486, 'psi': 0.9955725512785636}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950169689891452, 'loss_val': 0.10948577397402194, 'psi': 0.9951194910072829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=24 head_norm_before_train=1.484644 cos_to_last_merge=0.9781 (last merge round=16)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9518225496060998, 'auprc': 0.9982718067876224, 'loss_val': 0.2084182728684101, 'psi': 0.9704022524787088}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987340129808066, 'loss_val': 0.065892792869489, 'psi': 0.9975270569412318}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.078941 cos_to_last_merge=0.9701 (last merge round=16)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6594656229787832, 'auprc': 0.6156119853233437, 'loss_val': 0.5809775304590785, 'psi': 0.6419241679166074}-{'f1_val': 0.6478110639789894, 'auprc': 0.6672845025018526, 'loss_val': 0.573750571763329, 'psi': 0.6556004393881346}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.455699 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9973814229168628, 'auprc': 0.9975104061521537, 'loss_val': 0.05887178662131419, 'psi': 0.9974330162109792}-{'f1_val': 0.9983050875260411, 'auprc': 0.9988093062525975, 'loss_val': 0.06010369932544716, 'psi': 0.9985067750166636}
[S15] START round=24 head_norm_before_train=1.725090 cos_to_last_merge=0.9848 (last merge round=16)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7012218451287537, 'auprc': 0.801358291898133, 'loss_val': 0.5239616860046336, 'psi': 0.7412764238365055}-{'f1_val': 0.9951549650665892, 'auprc': 0.9923119860197936, 'loss_val': 0.0900892898059118, 'psi': 0.994017773447871}
[S16] START round=24 head_norm_before_train=1.400558 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.004959 metrics={'f1_val': 0.9402159445561392, 'auprc': 0.996514476945178, 'loss_val': 0.18102759541067184, 'psi': 0.9627353575117548}-{'f1_val': 0.9408153098678748, 'auprc': 0.9935140716557811, 'loss_val': 0.185540433728486, 'psi': 0.9618948145830373}
[S17] START round=24 head_norm_before_train=1.578412 (no previous merge yet)
[S17] round=24 local utility u=0.014385 metrics={'f1_val': 0.40440781334646064, 'auprc': 0.9528709103936102, 'loss_val': 0.5835771061201768, 'psi': 0.6237930521653204}-{'f1_val': 0.4154545313642549, 'auprc': 0.9475646852435027, 'loss_val': 0.6627095486605761, 'psi': 0.628298592915954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:61802
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S16
[S2] cosine check vs S16: cos=0.9995
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9994
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7012 head_norm=1.423442
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.279940e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7012 head_norm=1.427400 delta_norm=0.022799
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.427400 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.054171 metrics={'f1_val': 0.7012248454989554, 'auprc': 0.7090385598199038, 'loss_val': 0.3980831722672822, 'psi': 0.7043503312273347}-{'f1_val': 0.7012347841865968, 'auprc': 0.6576103337993656, 'loss_val': 0.35219927697386644, 'psi': 0.6837850040317044}
[S3] START round=25 head_norm_before_train=1.444433 cos_to_last_merge=0.9592 (last merge round=16)
[S3] round=25 local utility u=0.018207 metrics={'f1_val': 0.9949293084644328, 'auprc': 0.998833256912905, 'loss_val': 0.06497801921099121, 'psi': 0.9964908878438217}-{'f1_val': 0.991152338253556, 'auprc': 0.9988447731548323, 'loss_val': 0.07876499159293548, 'psi': 0.9942293122140664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=25 head_norm_before_train=1.214999 cos_to_last_merge=0.9148 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=25 local utility u=0.095841 metrics={'f1_val': 0.9465449041351172, 'auprc': 0.9519665999435549, 'loss_val': 0.2006944562548155, 'psi': 0.9487135824584922}-{'f1_val': 0.9320790001643156, 'auprc': 0.9609702805026801, 'loss_val': 0.33259148083779344, 'psi': 0.9436355122996614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=25 head_norm_before_train=1.307115 cos_to_last_merge=0.9463 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=25 local utility u=0.363476 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9945317236804556, 'loss_val': 0.2905337564944291, 'psi': 0.8180054799325305}-{'f1_val': 0.6653626424179315, 'auprc': 0.8700414643612631, 'loss_val': 0.4342631628772468, 'psi': 0.7472341711952641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=25 head_norm_before_train=1.788419 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7241112247861716, 'auprc': 0.9407190328077903, 'loss_val': 0.583807993169926, 'psi': 0.8107543479948192}-{'f1_val': 0.7745093779280343, 'auprc': 0.838062259232796, 'loss_val': 0.540563224382601, 'psi': 0.799930530449939}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.463611 cos_to_last_merge=0.9998 (last merge round=23)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5366032761975608, 'auprc': 0.7868050345361245, 'loss_val': 0.854714203314333, 'psi': 0.6366839795329863}-{'f1_val': 0.6324056429402025, 'auprc': 0.8015786641357845, 'loss_val': 0.6069832205033255, 'psi': 0.7000748514184354}
[S8] START round=25 head_norm_before_train=1.479183 cos_to_last_merge=0.9266 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=25 local utility u=0.030555 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9948298806674974, 'loss_val': 0.29685399974235227, 'psi': 0.7908012824571751}-{'f1_val': 0.6550634210237409, 'auprc': 0.9947907475339693, 'loss_val': 0.35953285108420713, 'psi': 0.7909543516278323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=25 head_norm_before_train=1.701954 cos_to_last_merge=0.9985 (last merge round=21)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9984773068776426, 'loss_val': 0.047924674746832666, 'psi': 0.9938657220353281}-{'f1_val': 0.9920653202133933, 'auprc': 0.99847673995127, 'loss_val': 0.04717718094325572, 'psi': 0.994629888108544}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.288111 cos_to_last_merge=0.9687 (last merge round=17)
[S10] round=25 local utility u=0.001968 metrics={'f1_val': 0.9945976568836169, 'auprc': 0.9957211843663808, 'loss_val': 0.08268674660112198, 'psi': 0.9950470678767225}-{'f1_val': 0.995475518495455, 'auprc': 0.9957181004532265, 'loss_val': 0.09188139857917486, 'psi': 0.9955725512785636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=25 head_norm_before_train=1.512445 cos_to_last_merge=0.9751 (last merge round=16)
[S11] round=25 local utility u=0.214298 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986495264622219, 'loss_val': 0.050354100811285885, 'psi': 0.997493262333798}-{'f1_val': 0.9518225496060998, 'auprc': 0.9982718067876224, 'loss_val': 0.2084182728684101, 'psi': 0.9704022524787088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=25 head_norm_before_train=1.100532 cos_to_last_merge=0.9657 (last merge round=16)
[S13] round=25 local utility u=0.187417 metrics={'f1_val': 0.6846824079400842, 'auprc': 0.6667828134168656, 'loss_val': 0.5109564902022906, 'psi': 0.6775225701307968}-{'f1_val': 0.6594656229787832, 'auprc': 0.6156119853233437, 'loss_val': 0.5809775304590785, 'psi': 0.6419241679166074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=25 head_norm_before_train=1.494474 cos_to_last_merge=0.9998 (last merge round=23)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9801970039779826, 'auprc': 0.9971029077811395, 'loss_val': 0.06936294508134874, 'psi': 0.9869593654992455}-{'f1_val': 0.9973814229168628, 'auprc': 0.9975104061521537, 'loss_val': 0.05887178662131419, 'psi': 0.9974330162109792}
[S15] START round=25 head_norm_before_train=1.747958 cos_to_last_merge=0.9826 (last merge round=16)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.961849572043666, 'auprc': 0.9905245375392333, 'loss_val': 0.09674508776489173, 'psi': 0.973319558241893}-{'f1_val': 0.7012218451287537, 'auprc': 0.801358291898133, 'loss_val': 0.5239616860046336, 'psi': 0.7412764238365055}
[S16] START round=25 head_norm_before_train=1.431710 cos_to_last_merge=0.9996 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9397992308525811, 'auprc': 0.9964955280025778, 'loss_val': 0.18158966079141584, 'psi': 0.9624777497125797}-{'f1_val': 0.9402159445561392, 'auprc': 0.996514476945178, 'loss_val': 0.18102759541067184, 'psi': 0.9627353575117548}
[S17] START round=25 head_norm_before_train=1.604859 (no previous merge yet)
[S17] round=25 local utility u=0.787968 metrics={'f1_val': 0.6502138139355554, 'auprc': 0.9603654243554636, 'loss_val': 0.5049605157838809, 'psi': 0.7742744581035187}-{'f1_val': 0.40440781334646064, 'auprc': 0.9528709103936102, 'loss_val': 0.5835771061201768, 'psi': 0.6237930521653204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] ⇄ pheromone p=0.210 → S2@127.0.0.1:61802
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9802 head_norm=1.530616
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.949680e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9802 head_norm=1.496670 delta_norm=0.049497
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.046 → S7@127.0.0.1:61808
[S7] ⇄ pheromone p=0.203 → S14@127.0.0.1:61814
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.9991
[S2] ⇄ pheromone p=0.039 → S16@127.0.0.1:61816
[S2] START round=26 head_norm_before_train=1.449006 cos_to_last_merge=0.9999 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6605977127680633, 'loss_val': 0.32688439339728104, 'psi': 0.6849799556191833}-{'f1_val': 0.7012248454989554, 'auprc': 0.7090385598199038, 'loss_val': 0.3980831722672822, 'psi': 0.7043503312273347}
[S3] START round=26 head_norm_before_train=1.477851 cos_to_last_merge=0.9553 (last merge round=16)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9987459379172527, 'loss_val': 0.15515944290184366, 'psi': 0.9604359003375349}-{'f1_val': 0.9949293084644328, 'auprc': 0.998833256912905, 'loss_val': 0.06497801921099121, 'psi': 0.9964908878438217}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.233599 cos_to_last_merge=0.9124 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=26 local utility u=0.027896 metrics={'f1_val': 0.9415123750489334, 'auprc': 0.9831322122390075, 'loss_val': 0.2082037790557393, 'psi': 0.9581603099249629}-{'f1_val': 0.9465449041351172, 'auprc': 0.9519665999435549, 'loss_val': 0.2006944562548155, 'psi': 0.9487135824584922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=26 head_norm_before_train=1.325487 cos_to_last_merge=0.9429 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.41806360926720204, 'auprc': 0.7805379607518403, 'loss_val': 0.7863321149329853, 'psi': 0.5630533498610574}-{'f1_val': 0.7003213174339138, 'auprc': 0.9945317236804556, 'loss_val': 0.2905337564944291, 'psi': 0.8180054799325305}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.803529 (no previous merge yet)
[S6] round=26 local utility u=0.985989 metrics={'f1_val': 0.964529283963668, 'auprc': 0.9756078202178065, 'loss_val': 0.15900490772733059, 'psi': 0.9689606984653234}-{'f1_val': 0.7241112247861716, 'auprc': 0.9407190328077903, 'loss_val': 0.583807993169926, 'psi': 0.8107543479948192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=26 head_norm_before_train=1.480246 cos_to_last_merge=0.9993 (last merge round=23)
[S7] round=26 local utility u=0.157025 metrics={'f1_val': 0.5649190996423339, 'auprc': 0.7957943156431568, 'loss_val': 0.73752635625974, 'psi': 0.657269186042663}-{'f1_val': 0.5366032761975608, 'auprc': 0.7868050345361245, 'loss_val': 0.854714203314333, 'psi': 0.6366839795329863}
[S8] START round=26 head_norm_before_train=1.501878 cos_to_last_merge=0.9235 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.923
[S8] round=26 local utility u=1.000000 metrics={'f1_val': 0.9963525581780791, 'auprc': 0.9952195218938089, 'loss_val': 0.11441852885793471, 'psi': 0.995899343664371}-{'f1_val': 0.6547822169836268, 'auprc': 0.9948298806674974, 'loss_val': 0.29685399974235227, 'psi': 0.7908012824571751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=26 head_norm_before_train=1.722912 cos_to_last_merge=0.9978 (last merge round=21)
[S9] round=26 local utility u=0.023791 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998471099129347, 'loss_val': 0.035539049453041496, 'psi': 0.9973847467400736}-{'f1_val': 0.9907913321404518, 'auprc': 0.9984773068776426, 'loss_val': 0.047924674746832666, 'psi': 0.9938657220353281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=26 head_norm_before_train=1.315973 cos_to_last_merge=0.9648 (last merge round=17)
[S10] round=26 local utility u=0.004989 metrics={'f1_val': 0.9949076444438805, 'auprc': 0.9949019349963304, 'loss_val': 0.07211184489499121, 'psi': 0.9949053606648603}-{'f1_val': 0.9945976568836169, 'auprc': 0.9957211843663808, 'loss_val': 0.08268674660112198, 'psi': 0.9950470678767225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=26 head_norm_before_train=1.534276 cos_to_last_merge=0.9728 (last merge round=16)
[S11] round=26 local utility u=0.003289 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.998614886254626, 'loss_val': 0.046293375556523464, 'psi': 0.9977415663612359}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986495264622219, 'loss_val': 0.050354100811285885, 'psi': 0.997493262333798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=26 head_norm_before_train=1.118756 cos_to_last_merge=0.9619 (last merge round=16)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6584182175360419, 'auprc': 0.6718678443304227, 'loss_val': 0.5325364093420579, 'psi': 0.6637980682537943}-{'f1_val': 0.6846824079400842, 'auprc': 0.6667828134168656, 'loss_val': 0.5109564902022906, 'psi': 0.6775225701307968}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.496670 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9322488600003207, 'auprc': 0.9957619029827838, 'loss_val': 0.14199424300757865, 'psi': 0.957654077193306}-{'f1_val': 0.9801970039779826, 'auprc': 0.9971029077811395, 'loss_val': 0.06936294508134874, 'psi': 0.9869593654992455}
[S15] START round=26 head_norm_before_train=1.765133 cos_to_last_merge=0.9808 (last merge round=16)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7013083217262647, 'auprc': 0.8540221087061092, 'loss_val': 0.44039688559394247, 'psi': 0.7623938365182025}-{'f1_val': 0.961849572043666, 'auprc': 0.9905245375392333, 'loss_val': 0.09674508776489173, 'psi': 0.973319558241893}
[S16] START round=26 head_norm_before_train=1.463986 cos_to_last_merge=0.9988 (last merge round=23)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8798044790518701, 'auprc': 0.9873476739750686, 'loss_val': 0.4577487660566936, 'psi': 0.9228217570211494}-{'f1_val': 0.9397992308525811, 'auprc': 0.9964955280025778, 'loss_val': 0.18158966079141584, 'psi': 0.9624777497125797}
[S17] START round=26 head_norm_before_train=1.634532 (no previous merge yet)
[S17] round=26 local utility u=0.156278 metrics={'f1_val': 0.6988102569508161, 'auprc': 0.9646918273489427, 'loss_val': 0.49696329219664104, 'psi': 0.8051628851100667}-{'f1_val': 0.6502138139355554, 'auprc': 0.9603654243554636, 'loss_val': 0.5049605157838809, 'psi': 0.7742744581035187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8798 head_norm=1.495111
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.035001e-02
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8807 head_norm=1.471377 delta_norm=0.050350
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9983
[S2] START round=27 head_norm_before_train=1.469797 cos_to_last_merge=0.9995 (last merge round=24)
[S2] round=27 local utility u=0.030540 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.677460446047806, 'loss_val': 0.31639259098521044, 'psi': 0.6917250489310804}-{'f1_val': 0.7012347841865968, 'auprc': 0.6605977127680633, 'loss_val': 0.32688439339728104, 'psi': 0.6849799556191833}
[S3] START round=27 head_norm_before_train=1.512652 cos_to_last_merge=0.9511 (last merge round=16)
[S3] round=27 local utility u=0.242139 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988358079753681, 'loss_val': 0.04863593004481283, 'psi': 0.998220343750723}-{'f1_val': 0.9348958752843897, 'auprc': 0.9987459379172527, 'loss_val': 0.15515944290184366, 'psi': 0.9604359003375349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=27 head_norm_before_train=1.250752 cos_to_last_merge=0.9100 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9339382923940083, 'auprc': 0.9804037367856361, 'loss_val': 0.24676840207791836, 'psi': 0.9525244701506593}-{'f1_val': 0.9415123750489334, 'auprc': 0.9831322122390075, 'loss_val': 0.2082037790557393, 'psi': 0.9581603099249629}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.338827 cos_to_last_merge=0.9405 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.992386928896124, 'loss_val': 0.2827276010895983, 'psi': 0.8171475620187978}-{'f1_val': 0.41806360926720204, 'auprc': 0.7805379607518403, 'loss_val': 0.7863321149329853, 'psi': 0.5630533498610574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=27 head_norm_before_train=1.815435 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8246616633106978, 'auprc': 0.9615400111389756, 'loss_val': 0.34356440900216834, 'psi': 0.8794130024420088}-{'f1_val': 0.964529283963668, 'auprc': 0.9756078202178065, 'loss_val': 0.15900490772733059, 'psi': 0.9689606984653234}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.492661 cos_to_last_merge=0.9988 (last merge round=23)
[S7] round=27 local utility u=0.049786 metrics={'f1_val': 0.5755642409112414, 'auprc': 0.7976136144587439, 'loss_val': 0.7072824998344613, 'psi': 0.6643839903302424}-{'f1_val': 0.5649190996423339, 'auprc': 0.7957943156431568, 'loss_val': 0.73752635625974, 'psi': 0.657269186042663}
[S8] START round=27 head_norm_before_train=1.525002 cos_to_last_merge=0.9202 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.920
[S8] round=27 local utility u=0.016296 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9967767859832748, 'loss_val': 0.08821896876481558, 'psi': 0.9966943626573072}-{'f1_val': 0.9963525581780791, 'auprc': 0.9952195218938089, 'loss_val': 0.11441852885793471, 'psi': 0.995899343664371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=27 head_norm_before_train=1.740301 cos_to_last_merge=0.9972 (last merge round=21)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9984706355221007, 'loss_val': 0.03410641141329045, 'psi': 0.9966377537308118}-{'f1_val': 0.9966605118138915, 'auprc': 0.998471099129347, 'loss_val': 0.035539049453041496, 'psi': 0.9973847467400736}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.342462 cos_to_last_merge=0.9610 (last merge round=17)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9888486361789661, 'loss_val': 0.06787577059488388, 'psi': 0.9921532934986392}-{'f1_val': 0.9949076444438805, 'auprc': 0.9949019349963304, 'loss_val': 0.07211184489499121, 'psi': 0.9949053606648603}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=1.553711 cos_to_last_merge=0.9707 (last merge round=16)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9930801897402096, 'auprc': 0.9988295119088576, 'loss_val': 0.05531843209699234, 'psi': 0.9953799186076688}-{'f1_val': 0.9971593530989756, 'auprc': 0.998614886254626, 'loss_val': 0.046293375556523464, 'psi': 0.9977415663612359}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.135480 cos_to_last_merge=0.9581 (last merge round=16)
[S13] round=27 local utility u=0.055732 metrics={'f1_val': 0.6751289627974915, 'auprc': 0.6642781826397097, 'loss_val': 0.4985676589638707, 'psi': 0.6707886507343788}-{'f1_val': 0.6584182175360419, 'auprc': 0.6718678443304227, 'loss_val': 0.5325364093420579, 'psi': 0.6637980682537943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=27 head_norm_before_train=1.530969 cos_to_last_merge=0.9999 (last merge round=25)
[S14] round=27 local utility u=0.237558 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.9988437188520907, 'loss_val': 0.053553401014137754, 'psi': 0.996629834781483}-{'f1_val': 0.9322488600003207, 'auprc': 0.9957619029827838, 'loss_val': 0.14199424300757865, 'psi': 0.957654077193306}
[S15] START round=27 head_norm_before_train=1.784265 cos_to_last_merge=0.9792 (last merge round=16)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.992956821865959, 'auprc': 0.9936105331076747, 'loss_val': 0.056117133219298634, 'psi': 0.9932183063626453}-{'f1_val': 0.7013083217262647, 'auprc': 0.8540221087061092, 'loss_val': 0.44039688559394247, 'psi': 0.7623938365182025}
[S16] START round=27 head_norm_before_train=1.471377 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.554239 metrics={'f1_val': 0.9926397267513719, 'auprc': 0.9975322775997397, 'loss_val': 0.056836900225243105, 'psi': 0.994596747090719}-{'f1_val': 0.8798044790518701, 'auprc': 0.9873476739750686, 'loss_val': 0.4577487660566936, 'psi': 0.9228217570211494}
[S17] START round=27 head_norm_before_train=1.663655 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6510085606746194, 'auprc': 0.8683170306381582, 'loss_val': 0.662579354292898, 'psi': 0.7379319486600349}-{'f1_val': 0.6988102569508161, 'auprc': 0.9646918273489427, 'loss_val': 0.49696329219664104, 'psi': 0.8051628851100667}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9971
[S16] RECEIVED delta(kind=head bytes=1805) from S2
[S16] cosine check vs S2: cos=0.9981
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9971
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9952 head_norm=1.564332
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.502350e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9947 head_norm=1.529945 delta_norm=0.065023
[S14] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5756 head_norm=1.502566
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.617867e-02
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.5766 head_norm=1.532332 delta_norm=0.066179
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:61802
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] cosine check vs S16: cos=0.9981
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9926 head_norm=1.499901
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.587760e-02
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9926 head_norm=1.493302 delta_norm=0.045878
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.488088 cos_to_last_merge=0.9989 (last merge round=24)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7058868589841288, 'auprc': 0.663330388563424, 'loss_val': 0.37317260686041476, 'psi': 0.6888642708158469}-{'f1_val': 0.7012347841865968, 'auprc': 0.677460446047806, 'loss_val': 0.31639259098521044, 'psi': 0.6917250489310804}
[S3] START round=28 head_norm_before_train=1.542532 cos_to_last_merge=0.9478 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9986988137579649, 'loss_val': 0.049490057588975275, 'psi': 0.9977576578050539}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988358079753681, 'loss_val': 0.04863593004481283, 'psi': 0.998220343750723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.266204 cos_to_last_merge=0.9077 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=28 local utility u=0.004401 metrics={'f1_val': 0.9348863728292947, 'auprc': 0.9769257132898209, 'loss_val': 0.2332207589628922, 'psi': 0.9517021090135052}-{'f1_val': 0.9339382923940083, 'auprc': 0.9804037367856361, 'loss_val': 0.24676840207791836, 'psi': 0.9525244701506593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=28 head_norm_before_train=1.348358 cos_to_last_merge=0.9397 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9383747042230175, 'loss_val': 0.3243863481893455, 'psi': 0.7955422407840225}-{'f1_val': 0.7003213174339138, 'auprc': 0.992386928896124, 'loss_val': 0.2827276010895983, 'psi': 0.8171475620187978}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.827364 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6052873423637118, 'auprc': 0.7619381479977025, 'loss_val': 0.9593993612607322, 'psi': 0.6679476646173081}-{'f1_val': 0.8246616633106978, 'auprc': 0.9615400111389756, 'loss_val': 0.34356440900216834, 'psi': 0.8794130024420088}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.532332 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5622638868350991, 'auprc': 0.7935581207940849, 'loss_val': 0.7583777761076772, 'psi': 0.6547815804186934}-{'f1_val': 0.5755642409112414, 'auprc': 0.7976136144587439, 'loss_val': 0.7072824998344613, 'psi': 0.6643839903302424}
[S8] START round=28 head_norm_before_train=1.547626 cos_to_last_merge=0.9174 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.917
[S8] round=28 local utility u=0.000975 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9966636117900007, 'loss_val': 0.0842117156122181, 'psi': 0.996477289677375}-{'f1_val': 0.9966394137733288, 'auprc': 0.9967767859832748, 'loss_val': 0.08821896876481558, 'psi': 0.9966943626573072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=28 head_norm_before_train=1.755003 cos_to_last_merge=0.9966 (last merge round=21)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9988525263781671, 'loss_val': 0.0462781855513533, 'psi': 0.993254077622093}-{'f1_val': 0.9954158325366191, 'auprc': 0.9984706355221007, 'loss_val': 0.03410641141329045, 'psi': 0.9966377537308118}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.368398 cos_to_last_merge=0.9572 (last merge round=17)
[S10] round=28 local utility u=0.012967 metrics={'f1_val': 0.994378377236979, 'auprc': 0.9955656415937149, 'loss_val': 0.06222385171118176, 'psi': 0.9948532829796732}-{'f1_val': 0.9943563983784213, 'auprc': 0.9888486361789661, 'loss_val': 0.06787577059488388, 'psi': 0.9921532934986392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=28 head_norm_before_train=1.574660 cos_to_last_merge=0.9685 (last merge round=16)
[S11] round=28 local utility u=0.020417 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9985824289615138, 'loss_val': 0.0382183253845308, 'psi': 0.997728583443991}-{'f1_val': 0.9930801897402096, 'auprc': 0.9988295119088576, 'loss_val': 0.05531843209699234, 'psi': 0.9953799186076688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=28 head_norm_before_train=1.151921 cos_to_last_merge=0.9545 (last merge round=16)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6278415513056463, 'auprc': 0.6763835425949977, 'loss_val': 0.6171013876449456, 'psi': 0.6472583478213869}-{'f1_val': 0.6751289627974915, 'auprc': 0.6642781826397097, 'loss_val': 0.4985676589638707, 'psi': 0.6707886507343788}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.529945 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.011936 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9992318163037638, 'loss_val': 0.0455325201561587, 'psi': 0.9982536584015097}-{'f1_val': 0.9951539120677446, 'auprc': 0.9988437188520907, 'loss_val': 0.053553401014137754, 'psi': 0.996629834781483}
[S15] START round=28 head_norm_before_train=1.802654 cos_to_last_merge=0.9776 (last merge round=16)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7036841403027653, 'auprc': 0.9171486037818776, 'loss_val': 0.3987619127305289, 'psi': 0.7890699256944103}-{'f1_val': 0.992956821865959, 'auprc': 0.9936105331076747, 'loss_val': 0.056117133219298634, 'psi': 0.9932183063626453}
[S16] START round=28 head_norm_before_train=1.493302 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.858792380399872, 'auprc': 0.9956561130348696, 'loss_val': 0.530375124665509, 'psi': 0.913537873453871}-{'f1_val': 0.9926397267513719, 'auprc': 0.9975322775997397, 'loss_val': 0.056836900225243105, 'psi': 0.994596747090719}
[S17] START round=28 head_norm_before_train=1.689281 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6268054073119016, 'auprc': 0.8487887412642731, 'loss_val': 0.7933750372751822, 'psi': 0.7155987408928501}-{'f1_val': 0.6510085606746194, 'auprc': 0.8683170306381582, 'loss_val': 0.662579354292898, 'psi': 0.7379319486600349}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7059 head_norm=1.504137
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.260170e-02
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7047 head_norm=1.501099 delta_norm=0.052602
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9998
[S2] START round=29 head_norm_before_train=1.501099 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.262230 metrics={'f1_val': 0.7008737635735156, 'auprc': 0.8181758661011522, 'loss_val': 0.28317065789737833, 'psi': 0.7477946045845703}-{'f1_val': 0.7058868589841288, 'auprc': 0.663330388563424, 'loss_val': 0.37317260686041476, 'psi': 0.6888642708158469}
[S3] START round=29 head_norm_before_train=1.565680 cos_to_last_merge=0.9452 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9333688439197494, 'auprc': 0.9972267004270118, 'loss_val': 0.1781718041514435, 'psi': 0.9589119865226544}-{'f1_val': 0.9971302205031132, 'auprc': 0.9986988137579649, 'loss_val': 0.049490057588975275, 'psi': 0.9977576578050539}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.284757 cos_to_last_merge=0.9048 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9344659092887696, 'auprc': 0.9700643201180127, 'loss_val': 0.23039744966714804, 'psi': 0.9487052736204669}-{'f1_val': 0.9348863728292947, 'auprc': 0.9769257132898209, 'loss_val': 0.2332207589628922, 'psi': 0.9517021090135052}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.361522 cos_to_last_merge=0.9378 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=29 local utility u=0.058697 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9693378125782287, 'loss_val': 0.2998826713233776, 'psi': 0.8079274841261068}-{'f1_val': 0.700320598491359, 'auprc': 0.9383747042230175, 'loss_val': 0.3243863481893455, 'psi': 0.7955422407840225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=29 head_norm_before_train=1.837788 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8581033469830756, 'auprc': 0.9678909073876065, 'loss_val': 0.22409696070382215, 'psi': 0.9020183711448879}-{'f1_val': 0.6052873423637118, 'auprc': 0.7619381479977025, 'loss_val': 0.9593993612607322, 'psi': 0.6679476646173081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=29 head_norm_before_train=1.539528 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5520826360770296, 'auprc': 0.7900845150426724, 'loss_val': 0.7661969740434258, 'psi': 0.6472833876632866}-{'f1_val': 0.5622638868350991, 'auprc': 0.7935581207940849, 'loss_val': 0.7583777761076772, 'psi': 0.6547815804186934}
[S8] START round=29 head_norm_before_train=1.567407 cos_to_last_merge=0.9150 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=29 local utility u=0.009188 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9970822520354631, 'loss_val': 0.06709129007197652, 'psi': 0.9966447457755601}-{'f1_val': 0.9963530749356245, 'auprc': 0.9966636117900007, 'loss_val': 0.0842117156122181, 'psi': 0.996477289677375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=29 head_norm_before_train=1.769916 cos_to_last_merge=0.9960 (last merge round=21)
[S9] round=29 local utility u=0.029579 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988450137852193, 'loss_val': 0.02992995789998565, 'psi': 0.9975343126024225}-{'f1_val': 0.9895217784513768, 'auprc': 0.9988525263781671, 'loss_val': 0.0462781855513533, 'psi': 0.993254077622093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=29 head_norm_before_train=1.390600 cos_to_last_merge=0.9540 (last merge round=17)
[S10] round=29 local utility u=0.004115 metrics={'f1_val': 0.9948413794931923, 'auprc': 0.9954963635826435, 'loss_val': 0.05656473678747082, 'psi': 0.9951033731289728}-{'f1_val': 0.994378377236979, 'auprc': 0.9955656415937149, 'loss_val': 0.06222385171118176, 'psi': 0.9948532829796732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=29 head_norm_before_train=1.595875 cos_to_last_merge=0.9664 (last merge round=16)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9957595517153559, 'auprc': 0.9985769871927196, 'loss_val': 0.0379335435895372, 'psi': 0.9968865259063014}-{'f1_val': 0.9971593530989756, 'auprc': 0.9985824289615138, 'loss_val': 0.0382183253845308, 'psi': 0.997728583443991}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.167033 cos_to_last_merge=0.9508 (last merge round=16)
[S13] round=29 local utility u=0.077899 metrics={'f1_val': 0.6493265603655469, 'auprc': 0.665971647537795, 'loss_val': 0.5589783624842491, 'psi': 0.6559845952344462}-{'f1_val': 0.6278415513056463, 'auprc': 0.6763835425949977, 'loss_val': 0.6171013876449456, 'psi': 0.6472583478213869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=29 head_norm_before_train=1.559645 cos_to_last_merge=0.9999 (last merge round=27)
[S14] round=29 local utility u=0.000398 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9988165748537313, 'loss_val': 0.04479799314388833, 'psi': 0.9982183407218236}-{'f1_val': 0.9976015531333403, 'auprc': 0.9992318163037638, 'loss_val': 0.0455325201561587, 'psi': 0.9982536584015097}
[S15] START round=29 head_norm_before_train=1.820085 cos_to_last_merge=0.9762 (last merge round=16)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.995386865233164, 'auprc': 0.9922594722729274, 'loss_val': 0.04712052570005659, 'psi': 0.9941359080490694}-{'f1_val': 0.7036841403027653, 'auprc': 0.9171486037818776, 'loss_val': 0.3987619127305289, 'psi': 0.7890699256944103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=29 head_norm_before_train=1.518639 cos_to_last_merge=0.9999 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8604448057055649, 'auprc': 0.9904712887759198, 'loss_val': 0.5592972416600396, 'psi': 0.9124553989337069}-{'f1_val': 0.858792380399872, 'auprc': 0.9956561130348696, 'loss_val': 0.530375124665509, 'psi': 0.913537873453871}
[S17] START round=29 head_norm_before_train=1.714002 (no previous merge yet)
[S17] round=29 local utility u=0.087386 metrics={'f1_val': 0.6716292654747841, 'auprc': 0.8256441283697032, 'loss_val': 0.8181123098518137, 'psi': 0.7332352106327518}-{'f1_val': 0.6268054073119016, 'auprc': 0.8487887412642731, 'loss_val': 0.7933750372751822, 'psi': 0.7155987408928501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5521 head_norm=1.548297
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.025794e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5519 head_norm=1.553849 delta_norm=0.020258
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1807) from S14
[S7] cosine check vs S14: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1802) from S2
[S16] cosine check vs S2: cos=0.9995
[S2] START round=30 head_norm_before_train=1.513916 cos_to_last_merge=0.9999 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.704668079481664, 'auprc': 0.6760789253990445, 'loss_val': 0.34838468935798195, 'psi': 0.6932324178486162}-{'f1_val': 0.7008737635735156, 'auprc': 0.8181758661011522, 'loss_val': 0.28317065789737833, 'psi': 0.7477946045845703}
[S3] START round=30 head_norm_before_train=1.580376 cos_to_last_merge=0.9441 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=30 local utility u=0.265636 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986770598065493, 'loss_val': 0.03772680474802742, 'psi': 0.9981397217495782}-{'f1_val': 0.9333688439197494, 'auprc': 0.9972267004270118, 'loss_val': 0.1781718041514435, 'psi': 0.9589119865226544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=30 head_norm_before_train=1.306664 cos_to_last_merge=0.9014 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9343269514213574, 'auprc': 0.9570021877698327, 'loss_val': 0.2354184919863328, 'psi': 0.9433970459607475}-{'f1_val': 0.9344659092887696, 'auprc': 0.9700643201180127, 'loss_val': 0.23039744966714804, 'psi': 0.9487052736204669}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.374856 cos_to_last_merge=0.9350 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6748463164860312, 'auprc': 0.9701154567887416, 'loss_val': 0.2996841782892196, 'psi': 0.7929539726071153}-{'f1_val': 0.700320598491359, 'auprc': 0.9693378125782287, 'loss_val': 0.2998826713233776, 'psi': 0.8079274841261068}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.845145 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8222493556489722, 'auprc': 0.9476490556155822, 'loss_val': 0.44945795474274347, 'psi': 0.8724092356356161}-{'f1_val': 0.8581033469830756, 'auprc': 0.9678909073876065, 'loss_val': 0.22409696070382215, 'psi': 0.9020183711448879}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.553849 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.684731 metrics={'f1_val': 0.6847714508298767, 'auprc': 0.8539383905885028, 'loss_val': 0.38442966203073714, 'psi': 0.7524382267333272}-{'f1_val': 0.5520826360770296, 'auprc': 0.7900845150426724, 'loss_val': 0.7661969740434258, 'psi': 0.6472833876632866}
[S8] START round=30 head_norm_before_train=1.588406 cos_to_last_merge=0.9123 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.912
[S8] round=30 local utility u=0.003759 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.997092214599373, 'loss_val': 0.05960416648625762, 'psi': 0.996648730801124}-{'f1_val': 0.9963530749356245, 'auprc': 0.9970822520354631, 'loss_val': 0.06709129007197652, 'psi': 0.9966447457755601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=30 head_norm_before_train=1.782997 cos_to_last_merge=0.9954 (last merge round=21)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9988465751087101, 'loss_val': 0.03740274640234121, 'psi': 0.99477782217152}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988450137852193, 'loss_val': 0.02992995789998565, 'psi': 0.9975343126024225}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.413252 cos_to_last_merge=0.9507 (last merge round=17)
[S10] round=30 local utility u=0.003383 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954234930579954, 'loss_val': 0.051658577591657706, 'psi': 0.9952821006348229}-{'f1_val': 0.9948413794931923, 'auprc': 0.9954963635826435, 'loss_val': 0.05656473678747082, 'psi': 0.9951033731289728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=30 head_norm_before_train=1.615772 cos_to_last_merge=0.9644 (last merge round=16)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9948671806073948, 'auprc': 0.9987255948553483, 'loss_val': 0.038373213745245216, 'psi': 0.9964105463065762}-{'f1_val': 0.9957595517153559, 'auprc': 0.9985769871927196, 'loss_val': 0.0379335435895372, 'psi': 0.9968865259063014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.184935 cos_to_last_merge=0.9470 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6280553485420991, 'auprc': 0.6739253045346788, 'loss_val': 0.6339103985378917, 'psi': 0.646403330939131}-{'f1_val': 0.6493265603655469, 'auprc': 0.665971647537795, 'loss_val': 0.5589783624842491, 'psi': 0.6559845952344462}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.591001 cos_to_last_merge=0.9996 (last merge round=27)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.997102793983838, 'loss_val': 0.04041198769796328, 'psi': 0.9975328283738663}-{'f1_val': 0.9978195179672185, 'auprc': 0.9988165748537313, 'loss_val': 0.04479799314388833, 'psi': 0.9982183407218236}
[S15] START round=30 head_norm_before_train=1.839692 cos_to_last_merge=0.9742 (last merge round=16)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8057257743684283, 'auprc': 0.9848245356129838, 'loss_val': 0.255427038635361, 'psi': 0.8773652788662505}-{'f1_val': 0.995386865233164, 'auprc': 0.9922594722729274, 'loss_val': 0.04712052570005659, 'psi': 0.9941359080490694}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.540676 cos_to_last_merge=0.9996 (last merge round=27)
[S16] round=30 local utility u=0.610492 metrics={'f1_val': 0.9846777734041126, 'auprc': 0.9955338958508663, 'loss_val': 0.09889931050304597, 'psi': 0.9890202223828141}-{'f1_val': 0.8604448057055649, 'auprc': 0.9904712887759198, 'loss_val': 0.5592972416600396, 'psi': 0.9124553989337069}
[S17] START round=30 head_norm_before_train=1.735896 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6411362606573188, 'auprc': 0.7839565728451643, 'loss_val': 1.0656803360602118, 'psi': 0.698264385532457}-{'f1_val': 0.6716292654747841, 'auprc': 0.8256441283697032, 'loss_val': 0.8181123098518137, 'psi': 0.7332352106327518}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:61814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.041 → S7@127.0.0.1:61808
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] ⇄ pheromone p=0.058 → S16@127.0.0.1:61816
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S16
[S2] cosine check vs S16: cos=0.9988
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9992
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6848 head_norm=1.562471
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.751158e-02
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6846 head_norm=1.576561 delta_norm=0.027512
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.221 → S14@127.0.0.1:61814
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9847 head_norm=1.560811
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.125069e-02
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9858 head_norm=1.536989 delta_norm=0.041251
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.248 → S2@127.0.0.1:61802
[S2] START round=31 head_norm_before_train=1.527038 cos_to_last_merge=0.9997 (last merge round=28)
[S2] round=31 local utility u=0.663987 metrics={'f1_val': 0.8184468472566535, 'auprc': 0.8758371770140029, 'loss_val': 0.30235721066413657, 'psi': 0.8414029791595932}-{'f1_val': 0.704668079481664, 'auprc': 0.6760789253990445, 'loss_val': 0.34838468935798195, 'psi': 0.6932324178486162}
[S3] START round=31 head_norm_before_train=1.593975 cos_to_last_merge=0.9426 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.998832595370605, 'loss_val': 0.04255201750171481, 'psi': 0.9982190587088178}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986770598065493, 'loss_val': 0.03772680474802742, 'psi': 0.9981397217495782}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.325215 cos_to_last_merge=0.8984 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=31 local utility u=0.012355 metrics={'f1_val': 0.9344878713197887, 'auprc': 0.9660821489025427, 'loss_val': 0.23891295082237687, 'psi': 0.9471255823528903}-{'f1_val': 0.9343269514213574, 'auprc': 0.9570021877698327, 'loss_val': 0.2354184919863328, 'psi': 0.9433970459607475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=31 head_norm_before_train=1.391422 cos_to_last_merge=0.9316 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.666597644759829, 'auprc': 0.9578002003619266, 'loss_val': 0.31941055214914477, 'psi': 0.783078667000668}-{'f1_val': 0.6748463164860312, 'auprc': 0.9701154567887416, 'loss_val': 0.2996841782892196, 'psi': 0.7929539726071153}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.854692 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7649071180136298, 'auprc': 0.9417242595509834, 'loss_val': 0.5976752218263572, 'psi': 0.8356339746285713}-{'f1_val': 0.8222493556489722, 'auprc': 0.9476490556155822, 'loss_val': 0.44945795474274347, 'psi': 0.8724092356356161}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.576561 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4560423402375817, 'auprc': 0.779321309576594, 'loss_val': 0.9790093303104839, 'psi': 0.5853539279731866}-{'f1_val': 0.6847714508298767, 'auprc': 0.8539383905885028, 'loss_val': 0.38442966203073714, 'psi': 0.7524382267333272}
[S8] START round=31 head_norm_before_train=1.608871 cos_to_last_merge=0.9097 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.910
[S8] round=31 local utility u=0.001677 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9965163123471528, 'loss_val': 0.05452274933604916, 'psi': 0.9964183699002358}-{'f1_val': 0.9963530749356245, 'auprc': 0.997092214599373, 'loss_val': 0.05960416648625762, 'psi': 0.996648730801124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=31 head_norm_before_train=1.795197 cos_to_last_merge=0.9948 (last merge round=21)
[S9] round=31 local utility u=0.001301 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9988464259677472, 'loss_val': 0.0348003270135298, 'psi': 0.9947777625151348}-{'f1_val': 0.9920653202133933, 'auprc': 0.9988465751087101, 'loss_val': 0.03740274640234121, 'psi': 0.99477782217152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=31 head_norm_before_train=1.439458 cos_to_last_merge=0.9470 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=31 local utility u=0.002186 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995427540262204, 'loss_val': 0.04729785427001809, 'psi': 0.9952837195165065}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954234930579954, 'loss_val': 0.051658577591657706, 'psi': 0.9952821006348229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=31 head_norm_before_train=1.631961 cos_to_last_merge=0.9628 (last merge round=16)
[S11] round=31 local utility u=0.009919 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9983586043891186, 'loss_val': 0.03118725168926156, 'psi': 0.9976390536150328}-{'f1_val': 0.9948671806073948, 'auprc': 0.9987255948553483, 'loss_val': 0.038373213745245216, 'psi': 0.9964105463065762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=31 head_norm_before_train=1.201316 cos_to_last_merge=0.9436 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6252387444879852, 'auprc': 0.6772896137858049, 'loss_val': 0.6864435435411615, 'psi': 0.6460590922071131}-{'f1_val': 0.6280553485420991, 'auprc': 0.6739253045346788, 'loss_val': 0.6339103985378917, 'psi': 0.646403330939131}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.619937 cos_to_last_merge=0.9992 (last merge round=27)
[S14] round=31 local utility u=0.000691 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9971080176010904, 'loss_val': 0.03772471579198808, 'psi': 0.9974028771902161}-{'f1_val': 0.9978195179672185, 'auprc': 0.997102793983838, 'loss_val': 0.04041198769796328, 'psi': 0.9975328283738663}
[S15] START round=31 head_norm_before_train=1.856423 cos_to_last_merge=0.9726 (last merge round=16)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7595498010986849, 'auprc': 0.9572105690738711, 'loss_val': 0.391935746139284, 'psi': 0.8386141082887594}-{'f1_val': 0.8057257743684283, 'auprc': 0.9848245356129838, 'loss_val': 0.255427038635361, 'psi': 0.8773652788662505}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.536989 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.051060 metrics={'f1_val': 0.9929244071547823, 'auprc': 0.9952290509646395, 'loss_val': 0.04534478181714113, 'psi': 0.9938462646787252}-{'f1_val': 0.9846777734041126, 'auprc': 0.9955338958508663, 'loss_val': 0.09889931050304597, 'psi': 0.9890202223828141}
[S17] START round=31 head_norm_before_train=1.755588 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6155280145724608, 'auprc': 0.7870031526736601, 'loss_val': 1.134197422279646, 'psi': 0.6841180698129405}-{'f1_val': 0.6411362606573188, 'auprc': 0.7839565728451643, 'loss_val': 1.0656803360602118, 'psi': 0.698264385532457}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:61816
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1807) from S2
[S16] cosine check vs S2: cos=0.9991
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9992
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.9991
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.8184 head_norm=1.539690
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.909506e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.8323 head_norm=1.548074 delta_norm=0.039095
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9929 head_norm=1.554047
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.443151e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9929 head_norm=1.546502 delta_norm=0.034432
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9976 head_norm=1.647634
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.800405e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9976 head_norm=1.604569 delta_norm=0.058004
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.548074 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7058886423773366, 'auprc': 0.8355082563834628, 'loss_val': 0.3007130636028312, 'psi': 0.7577364879797871}-{'f1_val': 0.8184468472566535, 'auprc': 0.8758371770140029, 'loss_val': 0.30235721066413657, 'psi': 0.8414029791595932}
[S3] START round=32 head_norm_before_train=1.608225 cos_to_last_merge=0.9410 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9972556251950542, 'loss_val': 0.10250732636318187, 'psi': 0.9758253632510302}-{'f1_val': 0.9978100342676263, 'auprc': 0.998832595370605, 'loss_val': 0.04255201750171481, 'psi': 0.9982190587088178}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.341062 cos_to_last_merge=0.8958 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.896
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9334031022269029, 'auprc': 0.9525767261184117, 'loss_val': 0.2562634511524038, 'psi': 0.9410725517835065}-{'f1_val': 0.9344878713197887, 'auprc': 0.9660821489025427, 'loss_val': 0.23891295082237687, 'psi': 0.9471255823528903}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.406509 cos_to_last_merge=0.9288 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=32 local utility u=0.162169 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9857833543316996, 'loss_val': 0.28136064457197646, 'psi': 0.8145057008274952}-{'f1_val': 0.666597644759829, 'auprc': 0.9578002003619266, 'loss_val': 0.31941055214914477, 'psi': 0.783078667000668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=32 head_norm_before_train=1.865354 (no previous merge yet)
[S6] round=32 local utility u=0.361754 metrics={'f1_val': 0.8394294824839382, 'auprc': 0.967022952202289, 'loss_val': 0.39719846144413307, 'psi': 0.8904668703712786}-{'f1_val': 0.7649071180136298, 'auprc': 0.9417242595509834, 'loss_val': 0.5976752218263572, 'psi': 0.8356339746285713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=32 head_norm_before_train=1.584825 cos_to_last_merge=0.9999 (last merge round=30)
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.6992859648344618, 'auprc': 0.9362528522515866, 'loss_val': 0.2975821791764412, 'psi': 0.7940727198013118}-{'f1_val': 0.4560423402375817, 'auprc': 0.779321309576594, 'loss_val': 0.9790093303104839, 'psi': 0.5853539279731866}
[S8] START round=32 head_norm_before_train=1.627125 cos_to_last_merge=0.9075 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.908
[S8] round=32 local utility u=0.000953 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9959679933445835, 'loss_val': 0.050971956200265366, 'psi': 0.9961990422992082}-{'f1_val': 0.9963530749356245, 'auprc': 0.9965163123471528, 'loss_val': 0.05452274933604916, 'psi': 0.9964183699002358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=32 head_norm_before_train=1.808519 cos_to_last_merge=0.9942 (last merge round=21)
[S9] round=32 local utility u=0.016986 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984726298696938, 'loss_val': 0.027278219357175917, 'psi': 0.9973853590362124}-{'f1_val': 0.9920653202133933, 'auprc': 0.9988464259677472, 'loss_val': 0.0348003270135298, 'psi': 0.9947777625151348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.467156 cos_to_last_merge=0.9432 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=32 local utility u=0.001882 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954312462288135, 'loss_val': 0.04354528000411097, 'psi': 0.9952852019031502}-{'f1_val': 0.9951878390193748, 'auprc': 0.995427540262204, 'loss_val': 0.04729785427001809, 'psi': 0.9952837195165065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=32 head_norm_before_train=1.646889 cos_to_last_merge=0.9613 (last merge round=16)
[S11] round=32 local utility u=0.001408 metrics={'f1_val': 0.9975731865293843, 'auprc': 0.9987562387323978, 'loss_val': 0.03204652877318948, 'psi': 0.9980464074105897}-{'f1_val': 0.9971593530989756, 'auprc': 0.9983586043891186, 'loss_val': 0.03118725168926156, 'psi': 0.9976390536150328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=32 head_norm_before_train=1.219277 cos_to_last_merge=0.9396 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=32 local utility u=0.061716 metrics={'f1_val': 0.6345419624762711, 'auprc': 0.6680759536563983, 'loss_val': 0.5911902290290887, 'psi': 0.647955558948322}-{'f1_val': 0.6252387444879852, 'auprc': 0.6772896137858049, 'loss_val': 0.6864435435411615, 'psi': 0.6460590922071131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=32 head_norm_before_train=1.604569 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.002038 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9988050930123094, 'loss_val': 0.036288659964396876, 'psi': 0.9978365101650161}-{'f1_val': 0.9975994502496334, 'auprc': 0.9971080176010904, 'loss_val': 0.03772471579198808, 'psi': 0.9974028771902161}
[S15] START round=32 head_norm_before_train=1.870603 cos_to_last_merge=0.9715 (last merge round=16)
[S15] round=32 local utility u=0.933375 metrics={'f1_val': 0.9960791940743108, 'auprc': 0.9908974917488848, 'loss_val': 0.04542230090552104, 'psi': 0.9940065131441405}-{'f1_val': 0.7595498010986849, 'auprc': 0.9572105690738711, 'loss_val': 0.391935746139284, 'psi': 0.8386141082887594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=32 head_norm_before_train=1.546502 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9852373265406331, 'auprc': 0.9902871679754444, 'loss_val': 0.07308038558017449, 'psi': 0.9872572631145576}-{'f1_val': 0.9929244071547823, 'auprc': 0.9952290509646395, 'loss_val': 0.04534478181714113, 'psi': 0.9938462646787252}
[S17] START round=32 head_norm_before_train=1.775111 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.4956645616108005, 'auprc': 0.7799162017500921, 'loss_val': 1.4909274449248013, 'psi': 0.6093652176665172}-{'f1_val': 0.6155280145724608, 'auprc': 0.7870031526736601, 'loss_val': 1.134197422279646, 'psi': 0.6841180698129405}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9996
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9972 head_norm=1.628635
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.997884e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9972 head_norm=1.609901 delta_norm=0.029979
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6993 head_norm=1.591511
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.740107e-02
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6980 head_norm=1.614532 delta_norm=0.037401
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.560178 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=33 local utility u=0.426948 metrics={'f1_val': 0.821923514421143, 'auprc': 0.8688583048324404, 'loss_val': 0.24307657810100808, 'psi': 0.840697430585662}-{'f1_val': 0.7058886423773366, 'auprc': 0.8355082563834628, 'loss_val': 0.3007130636028312, 'psi': 0.7577364879797871}
[S3] START round=33 head_norm_before_train=1.625866 cos_to_last_merge=0.9392 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=33 local utility u=0.080059 metrics={'f1_val': 0.9808347385591735, 'auprc': 0.9972515024774813, 'loss_val': 0.058153677572255535, 'psi': 0.9874014441264967}-{'f1_val': 0.9615385219550141, 'auprc': 0.9972556251950542, 'loss_val': 0.10250732636318187, 'psi': 0.9758253632510302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.355286 cos_to_last_merge=0.8936 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=33 local utility u=0.113628 metrics={'f1_val': 0.948138820722282, 'auprc': 0.9787285592824169, 'loss_val': 0.19587793612021498, 'psi': 0.9603747161463358}-{'f1_val': 0.9334031022269029, 'auprc': 0.9525767261184117, 'loss_val': 0.2562634511524038, 'psi': 0.9410725517835065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=33 head_norm_before_train=1.422400 cos_to_last_merge=0.9260 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898622067555438, 'loss_val': 0.31130794396728034, 'psi': 0.8161376731625658}-{'f1_val': 0.700320598491359, 'auprc': 0.9857833543316996, 'loss_val': 0.28136064457197646, 'psi': 0.8145057008274952}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.878034 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7880994470374406, 'auprc': 0.9236151541050028, 'loss_val': 0.6101358171398218, 'psi': 0.8423057298644655}-{'f1_val': 0.8394294824839382, 'auprc': 0.967022952202289, 'loss_val': 0.39719846144413307, 'psi': 0.8904668703712786}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.614532 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.533888418999954, 'auprc': 0.781187497874799, 'loss_val': 0.8424989532302227, 'psi': 0.632808050549892}-{'f1_val': 0.6992859648344618, 'auprc': 0.9362528522515866, 'loss_val': 0.2975821791764412, 'psi': 0.7940727198013118}
[S8] START round=33 head_norm_before_train=1.644292 cos_to_last_merge=0.9054 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.905
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9868020738719534, 'auprc': 0.9964320973277991, 'loss_val': 0.06379201302106619, 'psi': 0.9906540832542916}-{'f1_val': 0.9963530749356245, 'auprc': 0.9959679933445835, 'loss_val': 0.050971956200265366, 'psi': 0.9961990422992082}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.819453 cos_to_last_merge=0.9936 (last merge round=21)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984701502757316, 'loss_val': 0.027075776290967638, 'psi': 0.9968840911288039}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984726298696938, 'loss_val': 0.027278219357175917, 'psi': 0.9973853590362124}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.493455 cos_to_last_merge=0.9397 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=33 local utility u=0.001300 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954000576881454, 'loss_val': 0.0408519951317061, 'psi': 0.995272726486883}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954312462288135, 'loss_val': 0.04354528000411097, 'psi': 0.9952852019031502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=33 head_norm_before_train=1.662125 cos_to_last_merge=0.9598 (last merge round=16)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9586881267193936, 'auprc': 0.9988157924316695, 'loss_val': 0.08707348639310405, 'psi': 0.974739193004304}-{'f1_val': 0.9975731865293843, 'auprc': 0.9987562387323978, 'loss_val': 0.03204652877318948, 'psi': 0.9980464074105897}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.237713 cos_to_last_merge=0.9363 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=33 local utility u=0.123875 metrics={'f1_val': 0.6654641288738246, 'auprc': 0.6692837223579038, 'loss_val': 0.5325972765626872, 'psi': 0.6669919662674563}-{'f1_val': 0.6345419624762711, 'auprc': 0.6680759536563983, 'loss_val': 0.5911902290290887, 'psi': 0.647955558948322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=33 head_norm_before_train=1.609901 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.002195 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.998724040282839, 'loss_val': 0.03544213765962042, 'psi': 0.998182671725791}-{'f1_val': 0.9971907882668205, 'auprc': 0.9988050930123094, 'loss_val': 0.036288659964396876, 'psi': 0.9978365101650161}
[S15] START round=33 head_norm_before_train=1.884027 cos_to_last_merge=0.9703 (last merge round=16)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8983179677782638, 'auprc': 0.988535436795394, 'loss_val': 0.12495246029100486, 'psi': 0.9344049553851159}-{'f1_val': 0.9960791940743108, 'auprc': 0.9908974917488848, 'loss_val': 0.04542230090552104, 'psi': 0.9940065131441405}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.561636 cos_to_last_merge=0.9999 (last merge round=31)
[S16] round=33 local utility u=0.047090 metrics={'f1_val': 0.992197199381745, 'auprc': 0.9981291392394096, 'loss_val': 0.044184940635552075, 'psi': 0.994569975324811}-{'f1_val': 0.9852373265406331, 'auprc': 0.9902871679754444, 'loss_val': 0.07308038558017449, 'psi': 0.9872572631145576}
[S17] START round=33 head_norm_before_train=1.790059 (no previous merge yet)
[S17] round=33 local utility u=0.827415 metrics={'f1_val': 0.651282744513909, 'auprc': 0.8368369588347363, 'loss_val': 0.9405681765168422, 'psi': 0.72550443024224}-{'f1_val': 0.4956645616108005, 'auprc': 0.7799162017500921, 'loss_val': 1.4909274449248013, 'psi': 0.6093652176665172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:61816
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1802) from S16
[S2] cosine check vs S16: cos=0.9996
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9922 head_norm=1.579777
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.164485e-02
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9922 head_norm=1.574758 delta_norm=0.021645
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.8219 head_norm=1.570021
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.164485e-02
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.8049 head_norm=1.574758 delta_norm=0.021645
[S2] aggregate: ROLLBACK (f1_val pre=0.822 post=0.805 tol_abs=0.005 tol_rel=0.0)
[S2] START round=34 head_norm_before_train=1.574758 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.103571 metrics={'f1_val': 0.8277995767363576, 'auprc': 0.9191939395856842, 'loss_val': 0.2221978005972209, 'psi': 0.8643573218760883}-{'f1_val': 0.821923514421143, 'auprc': 0.8688583048324404, 'loss_val': 0.24307657810100808, 'psi': 0.840697430585662}
[S3] START round=34 head_norm_before_train=1.643302 cos_to_last_merge=0.9375 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9610844420559312, 'auprc': 0.9971780695789829, 'loss_val': 0.16057278892445873, 'psi': 0.9755218930651519}-{'f1_val': 0.9808347385591735, 'auprc': 0.9972515024774813, 'loss_val': 0.058153677572255535, 'psi': 0.9874014441264967}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.364976 cos_to_last_merge=0.8919 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9402375719887839, 'auprc': 0.9591087258707995, 'loss_val': 0.1939484939847799, 'psi': 0.9477860335415902}-{'f1_val': 0.948138820722282, 'auprc': 0.9787285592824169, 'loss_val': 0.19587793612021498, 'psi': 0.9603747161463358}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.439162 cos_to_last_merge=0.9237 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898411119499084, 'loss_val': 0.31303288000270046, 'psi': 0.8161292352403116}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898622067555438, 'loss_val': 0.31130794396728034, 'psi': 0.8161376731625658}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.890141 (no previous merge yet)
[S6] round=34 local utility u=0.264651 metrics={'f1_val': 0.8260219888033575, 'auprc': 0.9578038655753004, 'loss_val': 0.4109354078843851, 'psi': 0.8787347395121347}-{'f1_val': 0.7880994470374406, 'auprc': 0.9236151541050028, 'loss_val': 0.6101358171398218, 'psi': 0.8423057298644655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=34 head_norm_before_train=1.621143 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.786655 metrics={'f1_val': 0.6918809664503998, 'auprc': 0.8340476428984488, 'loss_val': 0.3757249001383801, 'psi': 0.7487476370296193}-{'f1_val': 0.533888418999954, 'auprc': 0.781187497874799, 'loss_val': 0.8424989532302227, 'psi': 0.632808050549892}
[S8] START round=34 head_norm_before_train=1.657281 cos_to_last_merge=0.9038 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.904
[S8] round=34 local utility u=0.035549 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9961434964629502, 'loss_val': 0.048235012156767884, 'psi': 0.9961792606252717}-{'f1_val': 0.9868020738719534, 'auprc': 0.9964320973277991, 'loss_val': 0.06379201302106619, 'psi': 0.9906540832542916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=34 head_norm_before_train=1.830206 cos_to_last_merge=0.9930 (last merge round=21)
[S9] round=34 local utility u=0.000445 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988429364421738, 'loss_val': 0.02730443767698404, 'psi': 0.9970332055953808}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984701502757316, 'loss_val': 0.027075776290967638, 'psi': 0.9968840911288039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=34 head_norm_before_train=1.518763 cos_to_last_merge=0.9363 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995480328248012, 'loss_val': 0.038458315759404726, 'psi': 0.9950412968308283}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954000576881454, 'loss_val': 0.0408519951317061, 'psi': 0.995272726486883}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.675430 cos_to_last_merge=0.9585 (last merge round=16)
[S11] round=34 local utility u=0.138224 metrics={'f1_val': 0.9955191415701834, 'auprc': 0.9985248377659666, 'loss_val': 0.030738757587450594, 'psi': 0.9967214200484967}-{'f1_val': 0.9586881267193936, 'auprc': 0.9988157924316695, 'loss_val': 0.08707348639310405, 'psi': 0.974739193004304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=34 head_norm_before_train=1.252101 cos_to_last_merge=0.9339 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6360743738021508, 'auprc': 0.6743211774758585, 'loss_val': 0.5960354886524089, 'psi': 0.6513730952716339}-{'f1_val': 0.6654641288738246, 'auprc': 0.6692837223579038, 'loss_val': 0.5325972765626872, 'psi': 0.6669919662674563}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.633081 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.997084594291564, 'loss_val': 0.03522807827497362, 'psi': 0.9973935078664056}-{'f1_val': 0.9978217593544257, 'auprc': 0.998724040282839, 'loss_val': 0.03544213765962042, 'psi': 0.998182671725791}
[S15] START round=34 head_norm_before_train=1.895141 cos_to_last_merge=0.9695 (last merge round=16)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6996680003162947, 'auprc': 0.8254523884803332, 'loss_val': 0.5995520092380582, 'psi': 0.7499817555819102}-{'f1_val': 0.8983179677782638, 'auprc': 0.988535436795394, 'loss_val': 0.12495246029100486, 'psi': 0.9344049553851159}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.574758 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000456 metrics={'f1_val': 0.992197199381745, 'auprc': 0.9981331019155494, 'loss_val': 0.04328490612720172, 'psi': 0.9945715603952667}-{'f1_val': 0.992197199381745, 'auprc': 0.9981291392394096, 'loss_val': 0.044184940635552075, 'psi': 0.994569975324811}
[S17] START round=34 head_norm_before_train=1.802681 (no previous merge yet)
[S17] round=34 local utility u=0.075792 metrics={'f1_val': 0.6553355992980326, 'auprc': 0.8464645166201863, 'loss_val': 0.8421838082252106, 'psi': 0.7317871662268941}-{'f1_val': 0.651282744513909, 'auprc': 0.8368369588347363, 'loss_val': 0.9405681765168422, 'psi': 0.72550443024224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:61802
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S2
[S16] cosine check vs S2: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] cosine check vs S16: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9998
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.8278 head_norm=1.587147
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.279531e-02
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.8278 head_norm=1.590272 delta_norm=0.012795
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9922 head_norm=1.593493
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.279531e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9922 head_norm=1.590272 delta_norm=0.012795
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6919 head_norm=1.629543
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.279869e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6923 head_norm=1.631263 delta_norm=0.012799
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.590272 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7107191511828707, 'auprc': 0.9737936695983934, 'loss_val': 0.2808905761839374, 'psi': 0.8159489585490798}-{'f1_val': 0.8277995767363576, 'auprc': 0.9191939395856842, 'loss_val': 0.2221978005972209, 'psi': 0.8643573218760883}
[S3] START round=35 head_norm_before_train=1.660333 cos_to_last_merge=0.9358 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=35 local utility u=0.156954 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9986786473172107, 'loss_val': 0.06812959367631194, 'psi': 0.9978184823360317}-{'f1_val': 0.9610844420559312, 'auprc': 0.9971780695789829, 'loss_val': 0.16057278892445873, 'psi': 0.9755218930651519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=35 head_norm_before_train=1.371330 cos_to_last_merge=0.8908 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9302748590913805, 'auprc': 0.9537007527510859, 'loss_val': 0.21829003557435916, 'psi': 0.9396452165552627}-{'f1_val': 0.9402375719887839, 'auprc': 0.9591087258707995, 'loss_val': 0.1939484939847799, 'psi': 0.9477860335415902}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.450415 cos_to_last_merge=0.9219 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9692841297579586, 'loss_val': 0.30204585267450745, 'psi': 0.8079060109979989}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898411119499084, 'loss_val': 0.31303288000270046, 'psi': 0.8161292352403116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.898796 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6002302850461949, 'auprc': 0.848376685107721, 'loss_val': 0.987479714002216, 'psi': 0.6994888450708054}-{'f1_val': 0.8260219888033575, 'auprc': 0.9578038655753004, 'loss_val': 0.4109354078843851, 'psi': 0.8787347395121347}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.631263 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.40979285629076845, 'auprc': 0.777939990644433, 'loss_val': 1.3106052810930742, 'psi': 0.5570517100322343}-{'f1_val': 0.6918809664503998, 'auprc': 0.8340476428984488, 'loss_val': 0.3757249001383801, 'psi': 0.7487476370296193}
[S8] START round=35 head_norm_before_train=1.670587 cos_to_last_merge=0.9022 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.902
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9963732554434723, 'loss_val': 0.04901052640639037, 'psi': 0.9962711642174806}-{'f1_val': 0.9962031034001528, 'auprc': 0.9961434964629502, 'loss_val': 0.048235012156767884, 'psi': 0.9961792606252717}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.841650 cos_to_last_merge=0.9924 (last merge round=21)
[S9] round=35 local utility u=0.002447 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9987575430335067, 'loss_val': 0.024670605568701567, 'psi': 0.9972506861929342}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988429364421738, 'loss_val': 0.02730443767698404, 'psi': 0.9970332055953808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=35 head_norm_before_train=1.542637 cos_to_last_merge=0.9330 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=35 local utility u=0.001828 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954225931265905, 'loss_val': 0.03726547257608137, 'psi': 0.995281740662261}-{'f1_val': 0.9947486092193725, 'auprc': 0.995480328248012, 'loss_val': 0.038458315759404726, 'psi': 0.9950412968308283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=35 head_norm_before_train=1.686942 cos_to_last_merge=0.9573 (last merge round=16)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9943853060473038, 'auprc': 0.9970947484863151, 'loss_val': 0.034289909683555025, 'psi': 0.9954690830229084}-{'f1_val': 0.9955191415701834, 'auprc': 0.9985248377659666, 'loss_val': 0.030738757587450594, 'psi': 0.9967214200484967}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.265356 cos_to_last_merge=0.9314 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6179323182486249, 'auprc': 0.6713279163017182, 'loss_val': 0.6544313455373253, 'psi': 0.6392905574698622}-{'f1_val': 0.6360743738021508, 'auprc': 0.6743211774758585, 'loss_val': 0.5960354886524089, 'psi': 0.6513730952716339}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.655123 cos_to_last_merge=0.9998 (last merge round=32)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9967227702918156, 'auprc': 0.9971473179967033, 'loss_val': 0.03907584524411133, 'psi': 0.9968925893737707}-{'f1_val': 0.9975994502496334, 'auprc': 0.997084594291564, 'loss_val': 0.03522807827497362, 'psi': 0.9973935078664056}
[S15] START round=35 head_norm_before_train=1.907556 cos_to_last_merge=0.9684 (last merge round=16)
[S15] round=35 local utility u=0.984558 metrics={'f1_val': 0.8743213353026452, 'auprc': 0.9903604631956093, 'loss_val': 0.17308095295150513, 'psi': 0.9207369864598309}-{'f1_val': 0.6996680003162947, 'auprc': 0.8254523884803332, 'loss_val': 0.5995520092380582, 'psi': 0.7499817555819102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=35 head_norm_before_train=1.590272 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8850344150859315, 'auprc': 0.9192585032295462, 'loss_val': 0.5177731440147865, 'psi': 0.8987240503433773}-{'f1_val': 0.992197199381745, 'auprc': 0.9981331019155494, 'loss_val': 0.04328490612720172, 'psi': 0.9945715603952667}
[S17] START round=35 head_norm_before_train=1.814409 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6513880761534481, 'auprc': 0.8428265997808309, 'loss_val': 0.9727544348949244, 'psi': 0.7279634856044013}-{'f1_val': 0.6553355992980326, 'auprc': 0.8464645166201863, 'loss_val': 0.8421838082252106, 'psi': 0.7317871662268941}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.301 → S14@127.0.0.1:61814
[S16] ⇄ pheromone p=0.091 → S2@127.0.0.1:61802
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9967 head_norm=1.676373
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.309190e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9967 head_norm=1.652792 delta_norm=0.033092
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.014 → S7@127.0.0.1:61808
[S2] ⇄ pheromone p=0.145 → S16@127.0.0.1:61816
[S2] START round=36 head_norm_before_train=1.604071 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=36 local utility u=0.312795 metrics={'f1_val': 0.8306719727634935, 'auprc': 0.9178971807354239, 'loss_val': 0.2073280610413292, 'psi': 0.8655620559522657}-{'f1_val': 0.7107191511828707, 'auprc': 0.9737936695983934, 'loss_val': 0.2808905761839374, 'psi': 0.8159489585490798}
[S3] START round=36 head_norm_before_train=1.674373 cos_to_last_merge=0.9343 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=36 local utility u=0.016612 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988565965875748, 'loss_val': 0.03882949926560831, 'psi': 0.9982286591956057}-{'f1_val': 0.9972450390152456, 'auprc': 0.9986786473172107, 'loss_val': 0.06812959367631194, 'psi': 0.9978184823360317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=36 head_norm_before_train=1.380150 cos_to_last_merge=0.8898 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=36 local utility u=0.086277 metrics={'f1_val': 0.9450326315852765, 'auprc': 0.9812602392719443, 'loss_val': 0.2169616721235118, 'psi': 0.9595236746599436}-{'f1_val': 0.9302748590913805, 'auprc': 0.9537007527510859, 'loss_val': 0.21829003557435916, 'psi': 0.9396452165552627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=36 head_norm_before_train=1.457217 cos_to_last_merge=0.9202 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.6294690869949111, 'auprc': 0.8540687407335923, 'loss_val': 0.4859938645008461, 'psi': 0.7193089484903836}-{'f1_val': 0.700320598491359, 'auprc': 0.9692841297579586, 'loss_val': 0.30204585267450745, 'psi': 0.8079060109979989}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.907393 (no previous merge yet)
[S6] round=36 local utility u=0.048429 metrics={'f1_val': 0.6001404582865173, 'auprc': 0.7892985571329205, 'loss_val': 0.7128481225098438, 'psi': 0.6758036978250785}-{'f1_val': 0.6002302850461949, 'auprc': 0.848376685107721, 'loss_val': 0.987479714002216, 'psi': 0.6994888450708054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=36 head_norm_before_train=1.639698 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.699747150039814, 'auprc': 0.9631121657404745, 'loss_val': 0.2787072353222225, 'psi': 0.8050931563200783}-{'f1_val': 0.40979285629076845, 'auprc': 0.777939990644433, 'loss_val': 1.3106052810930742, 'psi': 0.5570517100322343}
[S8] START round=36 head_norm_before_train=1.681918 cos_to_last_merge=0.9007 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.901
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9963580448752528, 'loss_val': 0.05057518548095294, 'psi': 0.9963550629114759}-{'f1_val': 0.9962031034001528, 'auprc': 0.9963732554434723, 'loss_val': 0.04901052640639037, 'psi': 0.9962711642174806}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.852869 cos_to_last_merge=0.9918 (last merge round=21)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.998845519563624, 'loss_val': 0.03349861491457812, 'psi': 0.9945250912081864}-{'f1_val': 0.9962461149658858, 'auprc': 0.9987575430335067, 'loss_val': 0.024670605568701567, 'psi': 0.9972506861929342}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.560869 cos_to_last_merge=0.9304 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=36 local utility u=0.000830 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954363839125111, 'loss_val': 0.035646621936507014, 'psi': 0.9952872569766293}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954225931265905, 'loss_val': 0.03726547257608137, 'psi': 0.995281740662261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=36 head_norm_before_train=1.698668 cos_to_last_merge=0.9562 (last merge round=16)
[S11] round=36 local utility u=0.009914 metrics={'f1_val': 0.9959551455935797, 'auprc': 0.998813658727467, 'loss_val': 0.029038349570669246, 'psi': 0.9970985508471346}-{'f1_val': 0.9943853060473038, 'auprc': 0.9970947484863151, 'loss_val': 0.034289909683555025, 'psi': 0.9954690830229084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=36 head_norm_before_train=1.277662 cos_to_last_merge=0.9281 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5640666110032028, 'auprc': 0.6776542645073069, 'loss_val': 0.6958852259330153, 'psi': 0.6095016724048444}-{'f1_val': 0.6179323182486249, 'auprc': 0.6713279163017182, 'loss_val': 0.6544313455373253, 'psi': 0.6392905574698622}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.652792 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9445748477621334, 'auprc': 0.9970463905583326, 'loss_val': 0.08401186903522967, 'psi': 0.9655634648806131}-{'f1_val': 0.9967227702918156, 'auprc': 0.9971473179967033, 'loss_val': 0.03907584524411133, 'psi': 0.9968925893737707}
[S15] START round=36 head_norm_before_train=1.919961 cos_to_last_merge=0.9675 (last merge round=16)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7010056609658452, 'auprc': 0.8666762894118261, 'loss_val': 0.5397359082260865, 'psi': 0.7672739123442376}-{'f1_val': 0.8743213353026452, 'auprc': 0.9903604631956093, 'loss_val': 0.17308095295150513, 'psi': 0.9207369864598309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.609175 cos_to_last_merge=0.9999 (last merge round=34)
[S16] round=36 local utility u=0.680628 metrics={'f1_val': 0.9929001652683519, 'auprc': 0.9982070971472343, 'loss_val': 0.04055691883269029, 'psi': 0.9950229380199049}-{'f1_val': 0.8850344150859315, 'auprc': 0.9192585032295462, 'loss_val': 0.5177731440147865, 'psi': 0.8987240503433773}
[S17] START round=36 head_norm_before_train=1.826359 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6526469770843603, 'auprc': 0.8213229053215243, 'loss_val': 1.0115545234062033, 'psi': 0.7201173483792258}-{'f1_val': 0.6513880761534481, 'auprc': 0.8428265997808309, 'loss_val': 0.9727544348949244, 'psi': 0.7279634856044013}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:61802
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S16
[S2] cosine check vs S16: cos=0.9995
[S14] RECEIVED delta(kind=head bytes=1807) from S7
[S14] cosine check vs S7: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=0.9995
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9929 head_norm=1.627723
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.574337e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9929 head_norm=1.623520 delta_norm=0.025743
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.8307 head_norm=1.619716
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.574337e-02
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.8307 head_norm=1.623520 delta_norm=0.025743
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9446 head_norm=1.672507
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.264774e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9446 head_norm=1.659796 delta_norm=0.022648
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.623520 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7807551009247035, 'auprc': 0.9839146323094046, 'loss_val': 0.2984585023831115, 'psi': 0.8620189134785838}-{'f1_val': 0.8306719727634935, 'auprc': 0.9178971807354239, 'loss_val': 0.2073280610413292, 'psi': 0.8655620559522657}
[S3] START round=37 head_norm_before_train=1.690035 cos_to_last_merge=0.9328 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.9973454165334454, 'loss_val': 0.13439637994701104, 'psi': 0.9757359898833473}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988565965875748, 'loss_val': 0.03882949926560831, 'psi': 0.9982286591956057}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.386491 cos_to_last_merge=0.8897 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9357399541580262, 'auprc': 0.9766715357790596, 'loss_val': 0.2104282956496406, 'psi': 0.9521125868064395}-{'f1_val': 0.9450326315852765, 'auprc': 0.9812602392719443, 'loss_val': 0.2169616721235118, 'psi': 0.9595236746599436}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.465344 cos_to_last_merge=0.9188 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.919
[S5] round=37 local utility u=0.572255 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9951314438486905, 'loss_val': 0.18978561537835348, 'psi': 0.8182453679998245}-{'f1_val': 0.6294690869949111, 'auprc': 0.8540687407335923, 'loss_val': 0.4859938645008461, 'psi': 0.7193089484903836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=37 head_norm_before_train=1.916060 (no previous merge yet)
[S6] round=37 local utility u=0.331075 metrics={'f1_val': 0.6784138837804691, 'auprc': 0.8909392984836711, 'loss_val': 0.8252599700145408, 'psi': 0.7634240496617499}-{'f1_val': 0.6001404582865173, 'auprc': 0.7892985571329205, 'loss_val': 0.7128481225098438, 'psi': 0.6758036978250785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=37 head_norm_before_train=1.647298 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.699336646419958, 'auprc': 0.9161446310475161, 'loss_val': 0.3098912427802014, 'psi': 0.7860598402709813}-{'f1_val': 0.699747150039814, 'auprc': 0.9631121657404745, 'loss_val': 0.2787072353222225, 'psi': 0.8050931563200783}
[S8] START round=37 head_norm_before_train=1.694451 cos_to_last_merge=0.8992 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.899
[S8] round=37 local utility u=0.003018 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9969667415533338, 'loss_val': 0.04636508683593595, 'psi': 0.9965985415827083}-{'f1_val': 0.9963530749356245, 'auprc': 0.9963580448752528, 'loss_val': 0.05057518548095294, 'psi': 0.9963550629114759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=37 head_norm_before_train=1.864176 cos_to_last_merge=0.9912 (last merge round=21)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9984689152082399, 'loss_val': 0.03257318247752868, 'psi': 0.9943744494660327}-{'f1_val': 0.9916448056378947, 'auprc': 0.998845519563624, 'loss_val': 0.03349861491457812, 'psi': 0.9945250912081864}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.578649 cos_to_last_merge=0.9280 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=37 local utility u=0.000501 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954316210604441, 'loss_val': 0.034630347336650456, 'psi': 0.9952853518358025}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954363839125111, 'loss_val': 0.035646621936507014, 'psi': 0.9952872569766293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.707974 cos_to_last_merge=0.9553 (last merge round=16)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9574937272755466, 'auprc': 0.9989190935351443, 'loss_val': 0.11571965772437941, 'psi': 0.9740638737793857}-{'f1_val': 0.9959551455935797, 'auprc': 0.998813658727467, 'loss_val': 0.029038349570669246, 'psi': 0.9970985508471346}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.286497 cos_to_last_merge=0.9247 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=37 local utility u=0.136724 metrics={'f1_val': 0.6023746856710779, 'auprc': 0.6616037739166039, 'loss_val': 0.6041342527848859, 'psi': 0.6260663209692883}-{'f1_val': 0.5640666110032028, 'auprc': 0.6776542645073069, 'loss_val': 0.6958852259330153, 'psi': 0.6095016724048444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=37 head_norm_before_train=1.659796 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.187965 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9988290243678797, 'loss_val': 0.03043030590679771, 'psi': 0.9979765714481872}-{'f1_val': 0.9445748477621334, 'auprc': 0.9970463905583326, 'loss_val': 0.08401186903522967, 'psi': 0.9655634648806131}
[S15] START round=37 head_norm_before_train=1.931412 cos_to_last_merge=0.9666 (last merge round=16)
[S15] round=37 local utility u=0.681026 metrics={'f1_val': 0.81987744096274, 'auprc': 0.9869442029482975, 'loss_val': 0.25171867387938635, 'psi': 0.886704145756963}-{'f1_val': 0.7010056609658452, 'auprc': 0.8666762894118261, 'loss_val': 0.5397359082260865, 'psi': 0.7672739123442376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=37 head_norm_before_train=1.623520 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9425087675248892, 'auprc': 0.9981760720136317, 'loss_val': 0.13612936674433948, 'psi': 0.9647756893203863}-{'f1_val': 0.9929001652683519, 'auprc': 0.9982070971472343, 'loss_val': 0.04055691883269029, 'psi': 0.9950229380199049}
[S17] START round=37 head_norm_before_train=1.840465 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5614231879762086, 'auprc': 0.7861191986501419, 'loss_val': 1.3554798563763446, 'psi': 0.6513015922457819}-{'f1_val': 0.6526469770843603, 'auprc': 0.8213229053215243, 'loss_val': 1.0115545234062033, 'psi': 0.7201173483792258}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9998
[S2] START round=38 head_norm_before_train=1.638687 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=38 local utility u=0.134679 metrics={'f1_val': 0.8316910161785136, 'auprc': 0.9470131678762972, 'loss_val': 0.22401082127610397, 'psi': 0.8778198768576271}-{'f1_val': 0.7807551009247035, 'auprc': 0.9839146323094046, 'loss_val': 0.2984585023831115, 'psi': 0.8620189134785838}
[S3] START round=38 head_norm_before_train=1.704481 cos_to_last_merge=0.9315 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=38 local utility u=0.107330 metrics={'f1_val': 0.982537901173439, 'auprc': 0.9985579335942774, 'loss_val': 0.050623992816180546, 'psi': 0.9889459141417744}-{'f1_val': 0.9613297054499484, 'auprc': 0.9973454165334454, 'loss_val': 0.13439637994701104, 'psi': 0.9757359898833473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=38 head_norm_before_train=1.393008 cos_to_last_merge=0.8891 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.932011409054281, 'auprc': 0.9663060850883646, 'loss_val': 0.21473452159588624, 'psi': 0.9457292794679144}-{'f1_val': 0.9357399541580262, 'auprc': 0.9766715357790596, 'loss_val': 0.2104282956496406, 'psi': 0.9521125868064395}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.472016 cos_to_last_merge=0.9178 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5848228278845785, 'auprc': 0.8114695461531155, 'loss_val': 0.6198935516953918, 'psi': 0.6754815151919933}-{'f1_val': 0.7003213174339138, 'auprc': 0.9951314438486905, 'loss_val': 0.18978561537835348, 'psi': 0.8182453679998245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.924410 (no previous merge yet)
[S6] round=38 local utility u=0.794727 metrics={'f1_val': 0.8326865376171637, 'auprc': 0.9558557234057061, 'loss_val': 0.35619110146299826, 'psi': 0.8819542119325807}-{'f1_val': 0.6784138837804691, 'auprc': 0.8909392984836711, 'loss_val': 0.8252599700145408, 'psi': 0.7634240496617499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=38 head_norm_before_train=1.650969 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.46637560874840056, 'auprc': 0.7788569265807996, 'loss_val': 1.1709250282425367, 'psi': 0.5913681358813603}-{'f1_val': 0.699336646419958, 'auprc': 0.9161446310475161, 'loss_val': 0.3098912427802014, 'psi': 0.7860598402709813}
[S8] START round=38 head_norm_before_train=1.705623 cos_to_last_merge=0.8978 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.898
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9965576412848777, 'loss_val': 0.04900016098001867, 'psi': 0.9963449185540427}-{'f1_val': 0.9963530749356245, 'auprc': 0.9969667415533338, 'loss_val': 0.04636508683593595, 'psi': 0.9965985415827083}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.874121 cos_to_last_merge=0.9906 (last merge round=21)
[S9] round=38 local utility u=0.019879 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984693185486413, 'loss_val': 0.02291116064915418, 'psi': 0.9973840345077913}-{'f1_val': 0.9916448056378947, 'auprc': 0.9984689152082399, 'loss_val': 0.03257318247752868, 'psi': 0.9943744494660327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=38 head_norm_before_train=1.596110 cos_to_last_merge=0.9256 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=38 local utility u=0.000228 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954427042368106, 'loss_val': 0.032889238453078826, 'psi': 0.99515799361377}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954316210604441, 'loss_val': 0.034630347336650456, 'psi': 0.9952853518358025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=38 head_norm_before_train=1.716106 cos_to_last_merge=0.9545 (last merge round=16)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9567975215855988, 'auprc': 0.9991806439266853, 'loss_val': 0.12929022975863308, 'psi': 0.9737507705220334}-{'f1_val': 0.9574937272755466, 'auprc': 0.9989190935351443, 'loss_val': 0.11571965772437941, 'psi': 0.9740638737793857}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.293535 cos_to_last_merge=0.9228 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5818840246864841, 'auprc': 0.6749535340969026, 'loss_val': 0.803344660973611, 'psi': 0.6191118284506516}-{'f1_val': 0.6023746856710779, 'auprc': 0.6616037739166039, 'loss_val': 0.6041342527848859, 'psi': 0.6260663209692883}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.679829 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=38 local utility u=0.001133 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9987682994030748, 'loss_val': 0.03046369553734436, 'psi': 0.9982003753738853}-{'f1_val': 0.9974082695017256, 'auprc': 0.9988290243678797, 'loss_val': 0.03043030590679771, 'psi': 0.9979765714481872}
[S15] START round=38 head_norm_before_train=1.943102 cos_to_last_merge=0.9656 (last merge round=16)
[S15] round=38 local utility u=0.233561 metrics={'f1_val': 0.8804527441962933, 'auprc': 0.9880154847613707, 'loss_val': 0.15126285931181474, 'psi': 0.9234778404223243}-{'f1_val': 0.81987744096274, 'auprc': 0.9869442029482975, 'loss_val': 0.25171867387938635, 'psi': 0.886704145756963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=38 head_norm_before_train=1.638291 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8527492813496748, 'auprc': 0.9956833302721149, 'loss_val': 0.6681782179300689, 'psi': 0.9099229009186508}-{'f1_val': 0.9425087675248892, 'auprc': 0.9981760720136317, 'loss_val': 0.13612936674433948, 'psi': 0.9647756893203863}
[S17] START round=38 head_norm_before_train=1.852756 (no previous merge yet)
[S17] round=38 local utility u=0.444310 metrics={'f1_val': 0.6630828376154548, 'auprc': 0.8043014313711991, 'loss_val': 1.1313639524653327, 'psi': 0.7195702751177526}-{'f1_val': 0.5614231879762086, 'auprc': 0.7861191986501419, 'loss_val': 1.3554798563763446, 'psi': 0.6513015922457819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:61816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.4664 head_norm=1.652209
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.241460e-02
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.4675 head_norm=1.665925 delta_norm=0.022415
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9999
[S2] START round=39 head_norm_before_train=1.652789 cos_to_last_merge=0.9997 (last merge round=36)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.832462452830113, 'auprc': 0.9321222660539836, 'loss_val': 0.2399026782392204, 'psi': 0.8723263781196613}-{'f1_val': 0.8316910161785136, 'auprc': 0.9470131678762972, 'loss_val': 0.22401082127610397, 'psi': 0.8778198768576271}
[S3] START round=39 head_norm_before_train=1.717139 cos_to_last_merge=0.9303 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9983867189518926, 'loss_val': 0.08665230906397349, 'psi': 0.9762539757447086}-{'f1_val': 0.982537901173439, 'auprc': 0.9985579335942774, 'loss_val': 0.050623992816180546, 'psi': 0.9889459141417744}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0506 f1=0.961 auprc=0.998 bytes=39504
[S4] START round=39 head_norm_before_train=1.400168 cos_to_last_merge=0.8884 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.888
[S4] round=39 local utility u=0.035977 metrics={'f1_val': 0.9385403045660698, 'auprc': 0.9808104611418484, 'loss_val': 0.22546631583863055, 'psi': 0.9554483671963814}-{'f1_val': 0.932011409054281, 'auprc': 0.9663060850883646, 'loss_val': 0.21473452159588624, 'psi': 0.9457292794679144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S4] r=40 psi=0.955 u=0.0360 p_local=0.0289 f1=0.939 auprc=0.981 bytes=41274
[S5] START round=39 head_norm_before_train=1.477478 cos_to_last_merge=0.9171 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.917
[S5] round=39 local utility u=0.838708 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9923543489209488, 'loss_val': 0.17812226349945803, 'psi': 0.8171345300287278}-{'f1_val': 0.5848228278845785, 'auprc': 0.8114695461531155, 'loss_val': 0.6198935516953918, 'psi': 0.6754815151919933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S5] r=40 psi=0.817 u=0.8387 p_local=0.2706 f1=0.700 auprc=0.992 bytes=39621
[S6] START round=39 head_norm_before_train=1.935150 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7570874939881944, 'auprc': 0.95990356733456, 'loss_val': 0.6173996556734894, 'psi': 0.8382139233267407}-{'f1_val': 0.8326865376171637, 'auprc': 0.9558557234057061, 'loss_val': 0.35619110146299826, 'psi': 0.8819542119325807}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.838 u=0.0000 p_local=0.2514 f1=0.757 auprc=0.960 bytes=44926
[S7] START round=39 head_norm_before_train=1.665925 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.705874760033659, 'auprc': 0.9937869802020322, 'loss_val': 0.21631311639961426, 'psi': 0.8210396481010083}-{'f1_val': 0.46637560874840056, 'auprc': 0.7788569265807996, 'loss_val': 1.1709250282425367, 'psi': 0.5913681358813603}
[S8] START round=39 head_norm_before_train=1.715212 cos_to_last_merge=0.8966 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.897
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.996229364399835, 'loss_val': 0.04821744390821893, 'psi': 0.9962136078000257}-{'f1_val': 0.9962031034001528, 'auprc': 0.9965576412848777, 'loss_val': 0.04900016098001867, 'psi': 0.9963449185540427}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.996 u=0.0000 p_local=0.0163 f1=0.996 auprc=0.996 bytes=53961
[S9] START round=39 head_norm_before_train=1.883495 cos_to_last_merge=0.9900 (last merge round=21)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.998470545080111, 'loss_val': 0.032489493792188705, 'psi': 0.9941162856872736}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984693185486413, 'loss_val': 0.02291116064915418, 'psi': 0.9973840345077913}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.994 u=0.0000 p_local=0.0075 f1=0.991 auprc=0.998 bytes=43174
[S10] START round=39 head_norm_before_train=1.612695 cos_to_last_merge=0.9235 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=39 local utility u=0.000795 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954324128636914, 'loss_val': 0.03258529138158212, 'psi': 0.9952856685571014}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954427042368106, 'loss_val': 0.032889238453078826, 'psi': 0.99515799361377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=40 psi=0.995 u=0.0008 p_local=0.0039 f1=0.995 auprc=0.995 bytes=62865
[S11] START round=39 head_norm_before_train=1.724391 cos_to_last_merge=0.9537 (last merge round=16)
[S11] round=39 local utility u=0.163243 metrics={'f1_val': 0.9950658921382118, 'auprc': 0.9987531659460337, 'loss_val': 0.031132510549598705, 'psi': 0.9965408016613406}-{'f1_val': 0.9567975215855988, 'auprc': 0.9991806439266853, 'loss_val': 0.12929022975863308, 'psi': 0.9737507705220334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=40 psi=0.997 u=0.1632 p_local=0.0489 f1=0.995 auprc=0.999 bytes=45004
[S13] START round=39 head_norm_before_train=1.303233 cos_to_last_merge=0.9216 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=39 local utility u=0.099982 metrics={'f1_val': 0.5970279740439165, 'auprc': 0.6571189366085809, 'loss_val': 0.6407401165958612, 'psi': 0.6210643590697823}-{'f1_val': 0.5818840246864841, 'auprc': 0.6749535340969026, 'loss_val': 0.803344660973611, 'psi': 0.6191118284506516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=40 psi=0.621 u=0.1000 p_local=0.0527 f1=0.597 auprc=0.657 bytes=32323
[S14] START round=39 head_norm_before_train=1.698203 cos_to_last_merge=0.9999 (last merge round=36)
[S14] round=39 local utility u=0.000660 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.999227633503005, 'loss_val': 0.02805765343925133, 'psi': 0.9981376499618989}-{'f1_val': 0.9978217593544257, 'auprc': 0.9987682994030748, 'loss_val': 0.03046369553734436, 'psi': 0.9982003753738853}
[S15] START round=39 head_norm_before_train=1.954003 cos_to_last_merge=0.9647 (last merge round=16)
[S15] round=39 local utility u=0.420881 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.9959826868783319, 'loss_val': 0.027917515037542515, 'psi': 0.9961163144010032}-{'f1_val': 0.8804527441962933, 'auprc': 0.9880154847613707, 'loss_val': 0.15126285931181474, 'psi': 0.9234778404223243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S15] r=40 psi=0.996 u=0.4209 p_local=0.3819 f1=0.996 auprc=0.996 bytes=45009
[S16] START round=39 head_norm_before_train=1.651301 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8353493901884567, 'auprc': 0.9955060131256267, 'loss_val': 0.8351584266159483, 'psi': 0.8994120393633247}-{'f1_val': 0.8527492813496748, 'auprc': 0.9956833302721149, 'loss_val': 0.6681782179300689, 'psi': 0.9099229009186508}
[S17] START round=39 head_norm_before_train=1.865312 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6442769722803192, 'auprc': 0.8236502424622014, 'loss_val': 1.2245214093684509, 'psi': 0.7160262803530721}-{'f1_val': 0.6630828376154548, 'auprc': 0.8043014313711991, 'loss_val': 1.1313639524653327, 'psi': 0.7195702751177526}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.716 u=0.0000 p_local=0.1337 f1=0.644 auprc=0.824 bytes=43166
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.8353 head_norm=1.663168
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.689357e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.8353 head_norm=1.657768 delta_norm=0.026894
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.899 u=0.0000 p_local=0.1071 f1=0.835 auprc=0.996 bytes=39562
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] r=40 psi=0.872 u=0.0000 p_local=0.1128 f1=0.832 auprc=0.932 bytes=45011
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9997
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9997
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9974 head_norm=1.715369
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.138169e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9974 head_norm=1.691534 delta_norm=0.031382
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0007 p_local=0.0301 f1=0.997 auprc=0.999 bytes=43216
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.7059 head_norm=1.667949
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.642086e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.7082 head_norm=1.687268 delta_norm=0.026421
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] r=40 psi=0.821 u=1.0000 p_local=0.4256 f1=0.706 auprc=0.994 bytes=39567
[S2] START round=40 head_norm_before_train=1.665637 cos_to_last_merge=0.9993 (last merge round=36)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9309203323727782, 'loss_val': 0.2529009931356502, 'psi': 0.8707561703648105}-{'f1_val': 0.832462452830113, 'auprc': 0.9321222660539836, 'loss_val': 0.2399026782392204, 'psi': 0.8723263781196613}
[S3] START round=40 head_norm_before_train=1.730722 cos_to_last_merge=0.9291 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=40 local utility u=0.042877 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.9972715567579231, 'loss_val': 0.06842664644052703, 'psi': 0.9828952917736481}-{'f1_val': 0.961498813606586, 'auprc': 0.9983867189518926, 'loss_val': 0.08665230906397349, 'psi': 0.9762539757447086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=40 head_norm_before_train=1.409189 cos_to_last_merge=0.8874 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.887
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9311585301534, 'auprc': 0.9789796410185398, 'loss_val': 0.26892343102088195, 'psi': 0.950286974499456}-{'f1_val': 0.9385403045660698, 'auprc': 0.9808104611418484, 'loss_val': 0.22546631583863055, 'psi': 0.9554483671963814}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.481347 cos_to_last_merge=0.9165 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.44193474756189655, 'auprc': 0.8477392553501825, 'loss_val': 0.6806248829410093, 'psi': 0.6042565506772108}-{'f1_val': 0.7003213174339138, 'auprc': 0.9923543489209488, 'loss_val': 0.17812226349945803, 'psi': 0.8171345300287278}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.946702 (no previous merge yet)
[S6] round=40 local utility u=0.381373 metrics={'f1_val': 0.8414991905147122, 'auprc': 0.9748125611141389, 'loss_val': 0.4058508909145423, 'psi': 0.8948245387544829}-{'f1_val': 0.7570874939881944, 'auprc': 0.95990356733456, 'loss_val': 0.6173996556734894, 'psi': 0.8382139233267407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=40 head_norm_before_train=1.687268 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5383389926838777, 'auprc': 0.7833622144422508, 'loss_val': 0.8956982373930777, 'psi': 0.636348281387227}-{'f1_val': 0.705874760033659, 'auprc': 0.9937869802020322, 'loss_val': 0.21631311639961426, 'psi': 0.8210396481010083}
[S8] START round=40 head_norm_before_train=1.725205 cos_to_last_merge=0.8954 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.895
[S8] round=40 local utility u=0.005056 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9971676115978821, 'loss_val': 0.04354160124563275, 'psi': 0.9968509692278126}-{'f1_val': 0.9962031034001528, 'auprc': 0.996229364399835, 'loss_val': 0.04821744390821893, 'psi': 0.9962136078000257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=40 head_norm_before_train=1.891509 cos_to_last_merge=0.9894 (last merge round=21)
[S9] round=40 local utility u=0.003803 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9988416209815555, 'loss_val': 0.031107581331890757, 'psi': 0.9947758405206582}-{'f1_val': 0.9912134460920485, 'auprc': 0.998470545080111, 'loss_val': 0.032489493792188705, 'psi': 0.9941162856872736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=40 head_norm_before_train=1.628838 cos_to_last_merge=0.9215 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=40 local utility u=0.000425 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954412815045599, 'loss_val': 0.03176114141769905, 'psi': 0.9952892160134488}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954324128636914, 'loss_val': 0.03258529138158212, 'psi': 0.9952856685571014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=40 head_norm_before_train=1.732687 cos_to_last_merge=0.9530 (last merge round=16)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9882640163347144, 'auprc': 0.9984373346839918, 'loss_val': 0.06532772743421922, 'psi': 0.9923333436744253}-{'f1_val': 0.9950658921382118, 'auprc': 0.9987531659460337, 'loss_val': 0.031132510549598705, 'psi': 0.9965408016613406}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.311643 cos_to_last_merge=0.9209 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5591705269821382, 'auprc': 0.6741717278977276, 'loss_val': 0.7284457230052827, 'psi': 0.6051710073483739}-{'f1_val': 0.5970279740439165, 'auprc': 0.6571189366085809, 'loss_val': 0.6407401165958612, 'psi': 0.6210643590697823}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.691534 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9992264469378032, 'loss_val': 0.028681806219794305, 'psi': 0.9977588832794045}-{'f1_val': 0.9974109942678281, 'auprc': 0.999227633503005, 'loss_val': 0.02805765343925133, 'psi': 0.9981376499618989}
[S15] START round=40 head_norm_before_train=1.962399 cos_to_last_merge=0.9645 (last merge round=16)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7008950840249477, 'auprc': 0.8057309141497009, 'loss_val': 0.6551698980076797, 'psi': 0.742829416074849}-{'f1_val': 0.9962053994161175, 'auprc': 0.9959826868783319, 'loss_val': 0.027917515037542515, 'psi': 0.9961163144010032}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.657768 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.743053 metrics={'f1_val': 0.9613395240161213, 'auprc': 0.9960447564878747, 'loss_val': 0.10661037307955419, 'psi': 0.9752216170048227}-{'f1_val': 0.8353493901884567, 'auprc': 0.9955060131256267, 'loss_val': 0.8351584266159483, 'psi': 0.8994120393633247}
[S17] START round=40 head_norm_before_train=1.879540 (no previous merge yet)
[S17] round=40 local utility u=0.232630 metrics={'f1_val': 0.6558987758325472, 'auprc': 0.8882498538400893, 'loss_val': 1.0227905250068134, 'psi': 0.7488392070355641}-{'f1_val': 0.6442769722803192, 'auprc': 0.8236502424622014, 'loss_val': 1.2245214093684509, 'psi': 0.7160262803530721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] ⇄ pheromone p=0.024 → S7@127.0.0.1:61808
[S7] ⇄ pheromone p=0.340 → S14@127.0.0.1:61814
[S2] ⇄ pheromone p=0.090 → S16@127.0.0.1:61816
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9993
[S16] ⇄ pheromone p=0.234 → S2@127.0.0.1:61802
[S2] START round=41 head_norm_before_train=1.680079 cos_to_last_merge=0.9989 (last merge round=36)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8298708403313281, 'auprc': 0.8870778825514879, 'loss_val': 0.29320568343414266, 'psi': 0.852753657219392}-{'f1_val': 0.8306467290261653, 'auprc': 0.9309203323727782, 'loss_val': 0.2529009931356502, 'psi': 0.8707561703648105}
[S3] START round=41 head_norm_before_train=1.744307 cos_to_last_merge=0.9279 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=41 local utility u=0.090309 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.997370997531069, 'loss_val': 0.03510024645749721, 'psi': 0.9976344195730034}-{'f1_val': 0.9733111151174647, 'auprc': 0.9972715567579231, 'loss_val': 0.06842664644052703, 'psi': 0.9828952917736481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=41 head_norm_before_train=1.418936 cos_to_last_merge=0.8860 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=41 local utility u=0.042722 metrics={'f1_val': 0.9357613282880237, 'auprc': 0.9817508820847833, 'loss_val': 0.2194107000257875, 'psi': 0.9541571498067276}-{'f1_val': 0.9311585301534, 'auprc': 0.9789796410185398, 'loss_val': 0.26892343102088195, 'psi': 0.950286974499456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=41 head_norm_before_train=1.487015 cos_to_last_merge=0.9154 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9240722557257063, 'loss_val': 0.34379541052703894, 'psi': 0.7899939378878871}-{'f1_val': 0.44193474756189655, 'auprc': 0.8477392553501825, 'loss_val': 0.6806248829410093, 'psi': 0.6042565506772108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=41 head_norm_before_train=1.959277 (no previous merge yet)
[S6] round=41 local utility u=0.207349 metrics={'f1_val': 0.8828306208426258, 'auprc': 0.9746600491659687, 'loss_val': 0.23868310916603344, 'psi': 0.9195623921719629}-{'f1_val': 0.8414991905147122, 'auprc': 0.9748125611141389, 'loss_val': 0.4058508909145423, 'psi': 0.8948245387544829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=41 head_norm_before_train=1.690882 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=0.423684 metrics={'f1_val': 0.6193105139634334, 'auprc': 0.7985563153546784, 'loss_val': 0.5797409806166518, 'psi': 0.6910088345199314}-{'f1_val': 0.5383389926838777, 'auprc': 0.7833622144422508, 'loss_val': 0.8956982373930777, 'psi': 0.636348281387227}
[S8] START round=41 head_norm_before_train=1.737105 cos_to_last_merge=0.8940 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.894
[S8] round=41 local utility u=0.000094 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.997496171191395, 'loss_val': 0.04261888715775779, 'psi': 0.9968103134379327}-{'f1_val': 0.9966398743144329, 'auprc': 0.9971676115978821, 'loss_val': 0.04354160124563275, 'psi': 0.9968509692278126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=41 head_norm_before_train=1.900183 cos_to_last_merge=0.9888 (last merge round=21)
[S9] round=41 local utility u=0.017144 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988411894940455, 'loss_val': 0.021902735425156233, 'psi': 0.9972841447771497}-{'f1_val': 0.9920653202133933, 'auprc': 0.9988416209815555, 'loss_val': 0.031107581331890757, 'psi': 0.9947758405206582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=41 head_norm_before_train=1.640415 cos_to_last_merge=0.9199 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=41 local utility u=0.000404 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954421193715882, 'loss_val': 0.030956358370228042, 'psi': 0.9952895511602602}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954412815045599, 'loss_val': 0.03176114141769905, 'psi': 0.9952892160134488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=1.739414 cos_to_last_merge=0.9524 (last merge round=16)
[S11] round=41 local utility u=0.043394 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9969751741565467, 'loss_val': 0.02490334223112808, 'psi': 0.996823521411528}-{'f1_val': 0.9882640163347144, 'auprc': 0.9984373346839918, 'loss_val': 0.06532772743421922, 'psi': 0.9923333436744253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=41 head_norm_before_train=1.318938 cos_to_last_merge=0.9198 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=41 local utility u=0.171825 metrics={'f1_val': 0.6121083833451437, 'auprc': 0.6609389278786848, 'loss_val': 0.6627238542507611, 'psi': 0.6316406011585601}-{'f1_val': 0.5591705269821382, 'auprc': 0.6741717278977276, 'loss_val': 0.7284457230052827, 'psi': 0.6051710073483739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=41 head_norm_before_train=1.708250 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=41 local utility u=0.002129 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9992268511612798, 'loss_val': 0.02688749324095426, 'psi': 0.9980052134246042}-{'f1_val': 0.9967805075071389, 'auprc': 0.9992264469378032, 'loss_val': 0.028681806219794305, 'psi': 0.9977588832794045}
[S15] START round=41 head_norm_before_train=1.969058 cos_to_last_merge=0.9643 (last merge round=16)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9927962672792573, 'auprc': 0.9979942092769967, 'loss_val': 0.0349566447241093, 'psi': 0.994875444078353}-{'f1_val': 0.7008950840249477, 'auprc': 0.8057309141497009, 'loss_val': 0.6551698980076797, 'psi': 0.742829416074849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=41 head_norm_before_train=1.669436 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=41 local utility u=0.117620 metrics={'f1_val': 0.9924511388258307, 'auprc': 0.9912714872217904, 'loss_val': 0.04372039432650451, 'psi': 0.9919792781842145}-{'f1_val': 0.9613395240161213, 'auprc': 0.9960447564878747, 'loss_val': 0.10661037307955419, 'psi': 0.9752216170048227}
[S17] START round=41 head_norm_before_train=1.887428 (no previous merge yet)
[S17] round=41 local utility u=0.025960 metrics={'f1_val': 0.6576198619693845, 'auprc': 0.8856458473754669, 'loss_val': 0.9733846812345547, 'psi': 0.7488302561318174}-{'f1_val': 0.6558987758325472, 'auprc': 0.8882498538400893, 'loss_val': 1.0227905250068134, 'psi': 0.7488392070355641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=41 metric=0.8299 head_norm=1.696270
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.196360e-02
[S2] stored merged vector for next round verification (round=41)
[S2] DEBUG after merge:  round=41 metric=0.8299 head_norm=1.682383 delta_norm=0.041964
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9997
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6193 head_norm=1.694378
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.252043e-02
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6195 head_norm=1.710212 delta_norm=0.022520
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9972 head_norm=1.726195
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.252043e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9972 head_norm=1.710212 delta_norm=0.022520
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.682383 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8294872933292823, 'auprc': 0.8616158596492391, 'loss_val': 0.31705062013210955, 'psi': 0.8423387198572649}-{'f1_val': 0.8298708403313281, 'auprc': 0.8870778825514879, 'loss_val': 0.29320568343414266, 'psi': 0.852753657219392}
[S3] START round=42 head_norm_before_train=1.756300 cos_to_last_merge=0.9267 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9605133082589568, 'auprc': 0.997250391260885, 'loss_val': 0.15295809353276044, 'psi': 0.975208141459728}-{'f1_val': 0.9978100342676263, 'auprc': 0.997370997531069, 'loss_val': 0.03510024645749721, 'psi': 0.9976344195730034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.425346 cos_to_last_merge=0.8849 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=42 local utility u=0.019869 metrics={'f1_val': 0.9453728328097406, 'auprc': 0.9751085689438507, 'loss_val': 0.21741448518328246, 'psi': 0.9572671272633846}-{'f1_val': 0.9357613282880237, 'auprc': 0.9817508820847833, 'loss_val': 0.2194107000257875, 'psi': 0.9541571498067276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.494115 cos_to_last_merge=0.9145 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=42 local utility u=0.149987 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898877470912311, 'loss_val': 0.239546376916017, 'psi': 0.8161478892968407}-{'f1_val': 0.7006083926626743, 'auprc': 0.9240722557257063, 'loss_val': 0.34379541052703894, 'psi': 0.7899939378878871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=42 head_norm_before_train=1.968584 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6073256977614669, 'auprc': 0.9070610661978247, 'loss_val': 0.9837976880919023, 'psi': 0.72721984513601}-{'f1_val': 0.8828306208426258, 'auprc': 0.9746600491659687, 'loss_val': 0.23868310916603344, 'psi': 0.9195623921719629}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.710212 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.146461 metrics={'f1_val': 0.6511269711949006, 'auprc': 0.8025125383472513, 'loss_val': 0.4895864423116728, 'psi': 0.7116811980558408}-{'f1_val': 0.6193105139634334, 'auprc': 0.7985563153546784, 'loss_val': 0.5797409806166518, 'psi': 0.6910088345199314}
[S8] START round=42 head_norm_before_train=1.746745 cos_to_last_merge=0.8928 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.893
[S8] round=42 local utility u=0.000982 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9977213062585463, 'loss_val': 0.041330599684989054, 'psi': 0.9969003674647933}-{'f1_val': 0.9963530749356245, 'auprc': 0.997496171191395, 'loss_val': 0.04261888715775779, 'psi': 0.9968103134379327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=42 head_norm_before_train=1.909299 cos_to_last_merge=0.9883 (last merge round=21)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959664569846244, 'loss_val': 0.02134448493868476, 'psi': 0.9963828898821846}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988411894940455, 'loss_val': 0.021902735425156233, 'psi': 0.9972841447771497}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.651552 cos_to_last_merge=0.9184 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=42 local utility u=0.000058 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954361995122865, 'loss_val': 0.030822033626441876, 'psi': 0.9952871832165394}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954421193715882, 'loss_val': 0.030956358370228042, 'psi': 0.9952895511602602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=42 head_norm_before_train=1.746836 cos_to_last_merge=0.9517 (last merge round=16)
[S11] round=42 local utility u=0.000696 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9969304744282792, 'loss_val': 0.023376984058079628, 'psi': 0.9968056415202209}-{'f1_val': 0.9967224195815153, 'auprc': 0.9969751741565467, 'loss_val': 0.02490334223112808, 'psi': 0.996823521411528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=42 head_norm_before_train=1.325659 cos_to_last_merge=0.9188 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.919
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5622230727944983, 'auprc': 0.6788392714104503, 'loss_val': 0.7109084779574941, 'psi': 0.6088695522408791}-{'f1_val': 0.6121083833451437, 'auprc': 0.6609389278786848, 'loss_val': 0.6627238542507611, 'psi': 0.6316406011585601}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.710212 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.001509 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991127256396165, 'loss_val': 0.027312805378274144, 'psi': 0.998338145868502}-{'f1_val': 0.9971907882668205, 'auprc': 0.9992268511612798, 'loss_val': 0.02688749324095426, 'psi': 0.9980052134246042}
[S15] START round=42 head_norm_before_train=1.975251 cos_to_last_merge=0.9641 (last merge round=16)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.936645267794735, 'auprc': 0.9907697315049055, 'loss_val': 0.08969143703933562, 'psi': 0.9582950532788033}-{'f1_val': 0.9927962672792573, 'auprc': 0.9979942092769967, 'loss_val': 0.0349566447241093, 'psi': 0.994875444078353}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.681927 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=42 local utility u=0.012137 metrics={'f1_val': 0.9931718136311698, 'auprc': 0.994987159808328, 'loss_val': 0.034917463875151614, 'psi': 0.993897952102033}-{'f1_val': 0.9924511388258307, 'auprc': 0.9912714872217904, 'loss_val': 0.04372039432650451, 'psi': 0.9919792781842145}
[S17] START round=42 head_norm_before_train=1.893240 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6567654661405294, 'auprc': 0.8863499388047221, 'loss_val': 0.9718360330046466, 'psi': 0.7485992552062065}-{'f1_val': 0.6576198619693845, 'auprc': 0.8856458473754669, 'loss_val': 0.9733846812345547, 'psi': 0.7488302561318174}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.8295 head_norm=1.698629
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.112044e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.8295 head_norm=1.690012 delta_norm=0.031120
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9978 head_norm=1.727224
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.830715e-03
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9978 head_norm=1.720097 delta_norm=0.009831
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6511 head_norm=1.712996
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.830720e-03
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6514 head_norm=1.720097 delta_norm=0.009831
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.690012 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.004100 metrics={'f1_val': 0.8308444940483801, 'auprc': 0.8554934636636209, 'loss_val': 0.29862641218219915, 'psi': 0.8407040818944764}-{'f1_val': 0.8294872933292823, 'auprc': 0.8616158596492391, 'loss_val': 0.31705062013210955, 'psi': 0.8423387198572649}
[S3] START round=43 head_norm_before_train=1.768470 cos_to_last_merge=0.9254 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=43 local utility u=0.081035 metrics={'f1_val': 0.9737928150552124, 'auprc': 0.9973147929030165, 'loss_val': 0.07075749763783581, 'psi': 0.983201606194334}-{'f1_val': 0.9605133082589568, 'auprc': 0.997250391260885, 'loss_val': 0.15295809353276044, 'psi': 0.975208141459728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=43 head_norm_before_train=1.434168 cos_to_last_merge=0.8833 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9354779001995362, 'auprc': 0.9820313791085256, 'loss_val': 0.2120034604489227, 'psi': 0.9540992917631319}-{'f1_val': 0.9453728328097406, 'auprc': 0.9751085689438507, 'loss_val': 0.21741448518328246, 'psi': 0.9572671272633846}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.503567 cos_to_last_merge=0.9136 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.914
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.4379714513622286, 'auprc': 0.8453037412129953, 'loss_val': 0.734655890749391, 'psi': 0.6009043673025354}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898877470912311, 'loss_val': 0.239546376916017, 'psi': 0.8161478892968407}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.977277 (no previous merge yet)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8470453884923197, 'auprc': 0.9511923346037936, 'loss_val': 0.32340670487454903, 'psi': 0.8887041669369092}-{'f1_val': 0.6073256977614669, 'auprc': 0.9070610661978247, 'loss_val': 0.9837976880919023, 'psi': 0.72721984513601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=43 head_norm_before_train=1.720097 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6388913342172118, 'auprc': 0.7981779891912143, 'loss_val': 0.5276086661376063, 'psi': 0.7026059962068127}-{'f1_val': 0.6511269711949006, 'auprc': 0.8025125383472513, 'loss_val': 0.4895864423116728, 'psi': 0.7116811980558408}
[S8] START round=43 head_norm_before_train=1.755997 cos_to_last_merge=0.8917 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.892
[S8] round=43 local utility u=0.001092 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9980559978622212, 'loss_val': 0.04015162000143108, 'psi': 0.9970342441062632}-{'f1_val': 0.9963530749356245, 'auprc': 0.9977213062585463, 'loss_val': 0.041330599684989054, 'psi': 0.9969003674647933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=43 head_norm_before_train=1.918132 cos_to_last_merge=0.9876 (last merge round=21)
[S9] round=43 local utility u=0.004773 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988373185555757, 'loss_val': 0.02041024377374515, 'psi': 0.9975312345105651}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959664569846244, 'loss_val': 0.02134448493868476, 'psi': 0.9963828898821846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=43 head_norm_before_train=1.661684 cos_to_last_merge=0.9170 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954444564700156, 'loss_val': 0.029851592290352277, 'psi': 0.9951586945070519}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954361995122865, 'loss_val': 0.030822033626441876, 'psi': 0.9952871832165394}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.753281 cos_to_last_merge=0.9510 (last merge round=16)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9930801897402096, 'auprc': 0.9984683339342606, 'loss_val': 0.034161788075435864, 'psi': 0.99523544741783}-{'f1_val': 0.9967224195815153, 'auprc': 0.9969304744282792, 'loss_val': 0.023376984058079628, 'psi': 0.9968056415202209}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.331715 cos_to_last_merge=0.9176 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=43 local utility u=0.030445 metrics={'f1_val': 0.5755047596392392, 'auprc': 0.6741269470925202, 'loss_val': 0.7155721625364655, 'psi': 0.6149536346205516}-{'f1_val': 0.5622230727944983, 'auprc': 0.6788392714104503, 'loss_val': 0.7109084779574941, 'psi': 0.6088695522408791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=43 head_norm_before_train=1.720097 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9537658767585036, 'auprc': 0.9971168018506796, 'loss_val': 0.06552455289168416, 'psi': 0.9711062467953739}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991127256396165, 'loss_val': 0.027312805378274144, 'psi': 0.998338145868502}
[S15] START round=43 head_norm_before_train=1.979373 cos_to_last_merge=0.9642 (last merge round=16)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.8731895371680976, 'loss_val': 0.5731400319498976, 'psi': 0.7699180685869007}-{'f1_val': 0.936645267794735, 'auprc': 0.9907697315049055, 'loss_val': 0.08969143703933562, 'psi': 0.9582950532788033}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.695278 cos_to_last_merge=0.9998 (last merge round=39)
[S16] round=43 local utility u=0.006852 metrics={'f1_val': 0.9937354904978282, 'auprc': 0.9982759406986899, 'loss_val': 0.03446286229059474, 'psi': 0.9955516705781728}-{'f1_val': 0.9931718136311698, 'auprc': 0.994987159808328, 'loss_val': 0.034917463875151614, 'psi': 0.993897952102033}
[S17] START round=43 head_norm_before_train=1.901021 (no previous merge yet)
[S17] round=43 local utility u=0.093055 metrics={'f1_val': 0.6684086255175357, 'auprc': 0.88737250170529, 'loss_val': 0.8586533662059005, 'psi': 0.7559941759926374}-{'f1_val': 0.6567654661405294, 'auprc': 0.8863499388047221, 'loss_val': 0.9718360330046466, 'psi': 0.7485992552062065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9995
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=0.9995
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.8308 head_norm=1.705904
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.620731e-02
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.8308 head_norm=1.703668 delta_norm=0.026207
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.703668 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8249987751183028, 'auprc': 0.8343057858288924, 'loss_val': 0.3234890618139005, 'psi': 0.8287215794025387}-{'f1_val': 0.8308444940483801, 'auprc': 0.8554934636636209, 'loss_val': 0.29862641218219915, 'psi': 0.8407040818944764}
[S3] START round=44 head_norm_before_train=1.781780 cos_to_last_merge=0.9241 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=44 local utility u=0.038003 metrics={'f1_val': 0.9825714639544857, 'auprc': 0.9980686239936087, 'loss_val': 0.04968425667749924, 'psi': 0.9887703279701349}-{'f1_val': 0.9737928150552124, 'auprc': 0.9973147929030165, 'loss_val': 0.07075749763783581, 'psi': 0.983201606194334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=1.442939 cos_to_last_merge=0.8818 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9352618963159949, 'auprc': 0.975237145493772, 'loss_val': 0.21459434735545338, 'psi': 0.9512519959871057}-{'f1_val': 0.9354779001995362, 'auprc': 0.9820313791085256, 'loss_val': 0.2120034604489227, 'psi': 0.9540992917631319}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.511921 cos_to_last_merge=0.9120 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9565234206444103, 'loss_val': 0.2973078369871956, 'psi': 0.8028017273525796}-{'f1_val': 0.4379714513622286, 'auprc': 0.8453037412129953, 'loss_val': 0.734655890749391, 'psi': 0.6009043673025354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S5] sending update (kind=head size=1811 to 1 peers)
[S6] START round=44 head_norm_before_train=1.983468 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6835645996422253, 'auprc': 0.933777215037009, 'loss_val': 0.5276011446538359, 'psi': 0.7836496458001387}-{'f1_val': 0.8470453884923197, 'auprc': 0.9511923346037936, 'loss_val': 0.32340670487454903, 'psi': 0.8887041669369092}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.722672 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.49976897235581585, 'auprc': 0.7802822993663107, 'loss_val': 0.9935574057810166, 'psi': 0.6119743031600138}-{'f1_val': 0.6388913342172118, 'auprc': 0.7981779891912143, 'loss_val': 0.5276086661376063, 'psi': 0.7026059962068127}
[S8] START round=44 head_norm_before_train=1.764665 cos_to_last_merge=0.8907 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.891
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9971714325288837, 'loss_val': 0.03828290760251536, 'psi': 0.9965904350516452}-{'f1_val': 0.9963530749356245, 'auprc': 0.9980559978622212, 'loss_val': 0.04015162000143108, 'psi': 0.9970342441062632}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.926241 cos_to_last_merge=0.9870 (last merge round=21)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9992205264060525, 'loss_val': 0.031023988156352968, 'psi': 0.9946933515560481}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988373185555757, 'loss_val': 0.02041024377374515, 'psi': 0.9975312345105651}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.670515 cos_to_last_merge=0.9158 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=44 local utility u=0.000417 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954550406982132, 'loss_val': 0.029049243030626584, 'psi': 0.995162928198331}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954444564700156, 'loss_val': 0.029851592290352277, 'psi': 0.9951586945070519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=44 head_norm_before_train=1.761574 cos_to_last_merge=0.9502 (last merge round=16)
[S11] round=44 local utility u=0.014517 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9971522149560326, 'loss_val': 0.023033599491520524, 'psi': 0.9968943377313222}-{'f1_val': 0.9930801897402096, 'auprc': 0.9984683339342606, 'loss_val': 0.034161788075435864, 'psi': 0.99523544741783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.343259 cos_to_last_merge=0.9157 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5426216278466214, 'auprc': 0.6847641867617407, 'loss_val': 0.8739200817944935, 'psi': 0.5994786514126691}-{'f1_val': 0.5755047596392392, 'auprc': 0.6741269470925202, 'loss_val': 0.7155721625364655, 'psi': 0.6149536346205516}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.732649 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.018368 metrics={'f1_val': 0.9587472885480384, 'auprc': 0.9971556520708449, 'loss_val': 0.05879384535864929, 'psi': 0.974110633957161}-{'f1_val': 0.9537658767585036, 'auprc': 0.9971168018506796, 'loss_val': 0.06552455289168416, 'psi': 0.9711062467953739}
[S15] START round=44 head_norm_before_train=1.984124 cos_to_last_merge=0.9639 (last merge round=16)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9908259621755239, 'auprc': 0.9974394170599975, 'loss_val': 0.041206385132758636, 'psi': 0.9934713441293134}-{'f1_val': 0.7010704228661029, 'auprc': 0.8731895371680976, 'loss_val': 0.5731400319498976, 'psi': 0.7699180685869007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=44 head_norm_before_train=1.708407 cos_to_last_merge=0.9997 (last merge round=39)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9932942728802157, 'auprc': 0.9982922915372224, 'loss_val': 0.03394872093715175, 'psi': 0.9952934803430183}-{'f1_val': 0.9937354904978282, 'auprc': 0.9982759406986899, 'loss_val': 0.03446286229059474, 'psi': 0.9955516705781728}
[S17] START round=44 head_norm_before_train=1.911102 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6538188673637739, 'auprc': 0.8898912688626491, 'loss_val': 1.063947807433036, 'psi': 0.748247827963324}-{'f1_val': 0.6684086255175357, 'auprc': 0.88737250170529, 'loss_val': 0.8586533662059005, 'psi': 0.7559941759926374}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9933 head_norm=1.716458
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.150759e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9933 head_norm=1.710899 delta_norm=0.031508
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9999
[S2] START round=45 head_norm_before_train=1.719637 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8222222800990815, 'auprc': 0.8294271500734748, 'loss_val': 0.3601801828268817, 'psi': 0.8251042280888388}-{'f1_val': 0.8249987751183028, 'auprc': 0.8343057858288924, 'loss_val': 0.3234890618139005, 'psi': 0.8287215794025387}
[S3] START round=45 head_norm_before_train=1.794801 cos_to_last_merge=0.9230 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9724918820927569, 'auprc': 0.9972883516966768, 'loss_val': 0.07658036651452595, 'psi': 0.9824104699343249}-{'f1_val': 0.9825714639544857, 'auprc': 0.9980686239936087, 'loss_val': 0.04968425667749924, 'psi': 0.9887703279701349}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.450783 cos_to_last_merge=0.8806 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.881
[S4] round=45 local utility u=0.011477 metrics={'f1_val': 0.9360269262440759, 'auprc': 0.9819919136232329, 'loss_val': 0.21649505366769697, 'psi': 0.9544129211957387}-{'f1_val': 0.9352618963159949, 'auprc': 0.975237145493772, 'loss_val': 0.21459434735545338, 'psi': 0.9512519959871057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=45 head_norm_before_train=1.517575 cos_to_last_merge=0.9111 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=45 local utility u=0.025925 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9753847244455254, 'loss_val': 0.3020417331121415, 'psi': 0.8103462488730255}-{'f1_val': 0.700320598491359, 'auprc': 0.9565234206444103, 'loss_val': 0.2973078369871956, 'psi': 0.8028017273525796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=45 head_norm_before_train=1.992893 (no previous merge yet)
[S6] round=45 local utility u=0.170121 metrics={'f1_val': 0.7829803434540369, 'auprc': 0.8972461802893265, 'loss_val': 0.6742599476957164, 'psi': 0.8286866781881528}-{'f1_val': 0.6835645996422253, 'auprc': 0.933777215037009, 'loss_val': 0.5276011446538359, 'psi': 0.7836496458001387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=45 head_norm_before_train=1.726504 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=45 local utility u=0.952637 metrics={'f1_val': 0.6877599837403406, 'auprc': 0.828631268440307, 'loss_val': 0.3612764185135014, 'psi': 0.7441084976203272}-{'f1_val': 0.49976897235581585, 'auprc': 0.7802822993663107, 'loss_val': 0.9935574057810166, 'psi': 0.6119743031600138}
[S8] START round=45 head_norm_before_train=1.773964 cos_to_last_merge=0.8896 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.890
[S8] round=45 local utility u=0.002101 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9978729622269273, 'loss_val': 0.03618526961971484, 'psi': 0.9968710469308626}-{'f1_val': 0.9962031034001528, 'auprc': 0.9971714325288837, 'loss_val': 0.03828290760251536, 'psi': 0.9965904350516452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] sending update (kind=head size=1808 to 1 peers)
[S9] START round=45 head_norm_before_train=1.934621 cos_to_last_merge=0.9864 (last merge round=21)
[S9] round=45 local utility u=0.019165 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984735234781701, 'loss_val': 0.020365484088512985, 'psi': 0.997385716479603}-{'f1_val': 0.9916752349893785, 'auprc': 0.9992205264060525, 'loss_val': 0.031023988156352968, 'psi': 0.9946933515560481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=45 head_norm_before_train=1.681062 cos_to_last_merge=0.9144 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=45 local utility u=0.000222 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953985821264503, 'loss_val': 0.029753645868795538, 'psi': 0.995272136262205}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954550406982132, 'loss_val': 0.029049243030626584, 'psi': 0.995162928198331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=45 head_norm_before_train=1.769291 cos_to_last_merge=0.9496 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.950
[S11] round=45 local utility u=0.002618 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9977887627502044, 'loss_val': 0.022329075376664807, 'psi': 0.9974111169594673}-{'f1_val': 0.9967224195815153, 'auprc': 0.9971522149560326, 'loss_val': 0.023033599491520524, 'psi': 0.9968943377313222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=45 head_norm_before_train=1.357153 cos_to_last_merge=0.9135 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=45 local utility u=0.250133 metrics={'f1_val': 0.5953827901272213, 'auprc': 0.6622957711259707, 'loss_val': 0.6228159168145947, 'psi': 0.6221479825267211}-{'f1_val': 0.5426216278466214, 'auprc': 0.6847641867617407, 'loss_val': 0.8739200817944935, 'psi': 0.5994786514126691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=45 head_norm_before_train=1.745112 cos_to_last_merge=0.9999 (last merge round=42)
[S14] round=45 local utility u=0.045892 metrics={'f1_val': 0.9728989794398739, 'auprc': 0.9971554948656483, 'loss_val': 0.05191901716343194, 'psi': 0.9826015856101836}-{'f1_val': 0.9587472885480384, 'auprc': 0.9971556520708449, 'loss_val': 0.05879384535864929, 'psi': 0.974110633957161}
[S15] START round=45 head_norm_before_train=1.990164 cos_to_last_merge=0.9639 (last merge round=16)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8898707038004618, 'auprc': 0.9906274487861623, 'loss_val': 0.17191705974748395, 'psi': 0.9301734017947421}-{'f1_val': 0.9908259621755239, 'auprc': 0.9974394170599975, 'loss_val': 0.041206385132758636, 'psi': 0.9934713441293134}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.710899 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.998026039687411, 'loss_val': 0.03407606573106831, 'psi': 0.9950965953649779}-{'f1_val': 0.9932942728802157, 'auprc': 0.9982922915372224, 'loss_val': 0.03394872093715175, 'psi': 0.9952934803430183}
[S17] START round=45 head_norm_before_train=1.923460 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6573378691895909, 'auprc': 0.862481171930392, 'loss_val': 1.0452672105132572, 'psi': 0.7393951902859114}-{'f1_val': 0.6538188673637739, 'auprc': 0.8898912688626491, 'loss_val': 1.063947807433036, 'psi': 0.748247827963324}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] ⇄ pheromone p=0.030 → S16@127.0.0.1:61816
[S16] ⇄ pheromone p=0.089 → S2@127.0.0.1:61802
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9998
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9729 head_norm=1.757388
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.264882e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9725 head_norm=1.743418 delta_norm=0.022649
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.020 → S7@127.0.0.1:61808
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=45 metric=0.6878 head_norm=1.729632
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.856915e-02
[S7] stored merged vector for next round verification (round=45)
[S7] DEBUG after merge:  round=45 metric=0.6877 head_norm=1.740369 delta_norm=0.018569
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.352 → S14@127.0.0.1:61814
[S2] START round=46 head_norm_before_train=1.734125 cos_to_last_merge=0.9998 (last merge round=43)
[S2] round=46 local utility u=0.128465 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.884436849181445, 'loss_val': 0.3188267403306723, 'psi': 0.8521627770882771}-{'f1_val': 0.8222222800990815, 'auprc': 0.8294271500734748, 'loss_val': 0.3601801828268817, 'psi': 0.8251042280888388}
[S3] START round=46 head_norm_before_train=1.805949 cos_to_last_merge=0.9221 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=46 local utility u=0.015584 metrics={'f1_val': 0.9800330614578661, 'auprc': 0.997069889856141, 'loss_val': 0.09000311971899125, 'psi': 0.9868477928171759}-{'f1_val': 0.9724918820927569, 'auprc': 0.9972883516966768, 'loss_val': 0.07658036651452595, 'psi': 0.9824104699343249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=46 head_norm_before_train=1.459360 cos_to_last_merge=0.8792 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9323770439711986, 'auprc': 0.9688362943619521, 'loss_val': 0.23356108453545718, 'psi': 0.9469607441275}-{'f1_val': 0.9360269262440759, 'auprc': 0.9819919136232329, 'loss_val': 0.21649505366769697, 'psi': 0.9544129211957387}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.521157 cos_to_last_merge=0.9111 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9543369119968779, 'loss_val': 0.3429756284721077, 'psi': 0.8019789106273122}-{'f1_val': 0.700320598491359, 'auprc': 0.9753847244455254, 'loss_val': 0.3020417331121415, 'psi': 0.8103462488730255}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=2.001516 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6640811877848898, 'auprc': 0.848937200951537, 'loss_val': 1.029582051446964, 'psi': 0.7380235930515486}-{'f1_val': 0.7829803434540369, 'auprc': 0.8972461802893265, 'loss_val': 0.6742599476957164, 'psi': 0.8286866781881528}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.740369 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5509298372498431, 'auprc': 0.780441558510402, 'loss_val': 0.8328327079017346, 'psi': 0.6427345257540666}-{'f1_val': 0.6877599837403406, 'auprc': 0.828631268440307, 'loss_val': 0.3612764185135014, 'psi': 0.7441084976203272}
[S8] START round=46 head_norm_before_train=1.784028 cos_to_last_merge=0.8885 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.889
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9973376040359705, 'loss_val': 0.03671883592806676, 'psi': 0.9966569036544799}-{'f1_val': 0.9962031034001528, 'auprc': 0.9978729622269273, 'loss_val': 0.03618526961971484, 'psi': 0.9968710469308626}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.942190 cos_to_last_merge=0.9859 (last merge round=21)
[S9] round=46 local utility u=0.000229 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986172088758754, 'loss_val': 0.020338809701207806, 'psi': 0.997443190638685}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984735234781701, 'loss_val': 0.020365484088512985, 'psi': 0.997385716479603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=46 head_norm_before_train=1.692215 cos_to_last_merge=0.9131 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954551371166214, 'loss_val': 0.02861537891413272, 'psi': 0.9951629667656943}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953985821264503, 'loss_val': 0.029753645868795538, 'psi': 0.995272136262205}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.776521 cos_to_last_merge=0.9489 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9976169962472877, 'loss_val': 0.022055463147960502, 'psi': 0.9970802502478243}-{'f1_val': 0.9971593530989756, 'auprc': 0.9977887627502044, 'loss_val': 0.022329075376664807, 'psi': 0.9974111169594673}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.366353 cos_to_last_merge=0.9121 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.912
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5819876877524588, 'auprc': 0.6683493742721819, 'loss_val': 0.69589550439826, 'psi': 0.616532362360348}-{'f1_val': 0.5953827901272213, 'auprc': 0.6622957711259707, 'loss_val': 0.6228159168145947, 'psi': 0.6221479825267211}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.743418 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9421058842751687, 'auprc': 0.9972666780326248, 'loss_val': 0.08977327766552144, 'psi': 0.9641702017781513}-{'f1_val': 0.9728989794398739, 'auprc': 0.9971554948656483, 'loss_val': 0.05191901716343194, 'psi': 0.9826015856101836}
[S15] START round=46 head_norm_before_train=1.996043 cos_to_last_merge=0.9639 (last merge round=16)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8167588126512075, 'auprc': 0.9897969837636558, 'loss_val': 0.3056598036573163, 'psi': 0.8859740810961868}-{'f1_val': 0.8898707038004618, 'auprc': 0.9906274487861623, 'loss_val': 0.17191705974748395, 'psi': 0.9301734017947421}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.718537 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.000119 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.998020265998175, 'loss_val': 0.033819777013194385, 'psi': 0.9950942858892835}-{'f1_val': 0.9931436324833557, 'auprc': 0.998026039687411, 'loss_val': 0.03407606573106831, 'psi': 0.9950965953649779}
[S17] START round=46 head_norm_before_train=1.935335 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6596812296515755, 'auprc': 0.865800094476095, 'loss_val': 1.105041240682978, 'psi': 0.7421287755813832}-{'f1_val': 0.6573378691895909, 'auprc': 0.862481171930392, 'loss_val': 1.0452672105132572, 'psi': 0.7393951902859114}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.9994
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9994
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.8306 head_norm=1.747844
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.146552e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.8306 head_norm=1.736076 delta_norm=0.031466
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9931 head_norm=1.724802
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.146553e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9931 head_norm=1.736076 delta_norm=0.031466
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.736076 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.8915909956604815, 'loss_val': 0.35748230072815174, 'psi': 0.8550244356798917}-{'f1_val': 0.8306467290261653, 'auprc': 0.884436849181445, 'loss_val': 0.3188267403306723, 'psi': 0.8521627770882771}
[S3] START round=47 head_norm_before_train=1.816694 cos_to_last_merge=0.9211 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9793220612134975, 'auprc': 0.997205305840754, 'loss_val': 0.0934291166385158, 'psi': 0.9864753590644001}-{'f1_val': 0.9800330614578661, 'auprc': 0.997069889856141, 'loss_val': 0.09000311971899125, 'psi': 0.9868477928171759}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.469798 cos_to_last_merge=0.8778 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=47 local utility u=0.011734 metrics={'f1_val': 0.9331707222594636, 'auprc': 0.9795794681851285, 'loss_val': 0.24708442229289326, 'psi': 0.9517342206297296}-{'f1_val': 0.9323770439711986, 'auprc': 0.9688362943619521, 'loss_val': 0.23356108453545718, 'psi': 0.9469607441275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=47 head_norm_before_train=1.525445 cos_to_last_merge=0.9106 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5782089390064978, 'auprc': 0.8404342357095704, 'loss_val': 0.6437860013996068, 'psi': 0.6830990576877269}-{'f1_val': 0.7004069097142683, 'auprc': 0.9543369119968779, 'loss_val': 0.3429756284721077, 'psi': 0.8019789106273122}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.008631 (no previous merge yet)
[S6] round=47 local utility u=0.969867 metrics={'f1_val': 0.8349015577481602, 'auprc': 0.950863920604581, 'loss_val': 0.42054954241401665, 'psi': 0.8812865028907285}-{'f1_val': 0.6640811877848898, 'auprc': 0.848937200951537, 'loss_val': 1.029582051446964, 'psi': 0.7380235930515486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=47 head_norm_before_train=1.746096 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=47 local utility u=0.813508 metrics={'f1_val': 0.693485872231411, 'auprc': 0.8610569610119585, 'loss_val': 0.3029987391585526, 'psi': 0.76051430774363}-{'f1_val': 0.5509298372498431, 'auprc': 0.780441558510402, 'loss_val': 0.8328327079017346, 'psi': 0.6427345257540666}
[S8] START round=47 head_norm_before_train=1.791914 cos_to_last_merge=0.8875 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.888
[S8] round=47 local utility u=0.001119 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.998052995479722, 'loss_val': 0.03752650510660281, 'psi': 0.9970330431532636}-{'f1_val': 0.9962031034001528, 'auprc': 0.9973376040359705, 'loss_val': 0.03671883592806676, 'psi': 0.9966569036544799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=47 head_norm_before_train=1.949625 cos_to_last_merge=0.9855 (last merge round=21)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9992165303321066, 'loss_val': 0.019893718586635727, 'psi': 0.9974342811123741}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986172088758754, 'loss_val': 0.020338809701207806, 'psi': 0.997443190638685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.703504 cos_to_last_merge=0.9117 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=47 local utility u=0.000327 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954531650626738, 'loss_val': 0.027955766429597167, 'psi': 0.9951621779441152}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954551371166214, 'loss_val': 0.02861537891413272, 'psi': 0.9951629667656943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=1.784826 cos_to_last_merge=0.9482 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9960832028107873, 'loss_val': 0.024014829940142614, 'psi': 0.9962187318945361}-{'f1_val': 0.9967224195815153, 'auprc': 0.9976169962472877, 'loss_val': 0.022055463147960502, 'psi': 0.9970802502478243}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.373828 cos_to_last_merge=0.9106 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5228627322829131, 'auprc': 0.6808620236518611, 'loss_val': 0.8770332270707145, 'psi': 0.5860624488304924}-{'f1_val': 0.5819876877524588, 'auprc': 0.6683493742721819, 'loss_val': 0.69589550439826, 'psi': 0.616532362360348}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.754021 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=47 local utility u=0.202028 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.999228516710627, 'loss_val': 0.024575924376150343, 'psi': 0.998252338564255}-{'f1_val': 0.9421058842751687, 'auprc': 0.9972666780326248, 'loss_val': 0.08977327766552144, 'psi': 0.9641702017781513}
[S15] START round=47 head_norm_before_train=2.002742 cos_to_last_merge=0.9637 (last merge round=16)
[S15] round=47 local utility u=0.217932 metrics={'f1_val': 0.874029554001719, 'auprc': 0.99305377936507, 'loss_val': 0.22319015271221723, 'psi': 0.9216392441470594}-{'f1_val': 0.8167588126512075, 'auprc': 0.9897969837636558, 'loss_val': 0.3056598036573163, 'psi': 0.8859740810961868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.736076 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9861263021881649, 'auprc': 0.9962209889775195, 'loss_val': 0.057441797195846744, 'psi': 0.9901641769039067}-{'f1_val': 0.9931436324833557, 'auprc': 0.998020265998175, 'loss_val': 0.033819777013194385, 'psi': 0.9950942858892835}
[S17] START round=47 head_norm_before_train=1.946524 (no previous merge yet)
[S17] round=47 local utility u=0.559010 metrics={'f1_val': 0.7296570633544116, 'auprc': 0.9227352380552503, 'loss_val': 0.5776811252277645, 'psi': 0.8068883332347471}-{'f1_val': 0.6596812296515755, 'auprc': 0.865800094476095, 'loss_val': 1.105041240682978, 'psi': 0.7421287755813832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] cosine check vs S14: cos=0.9998
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9976 head_norm=1.766404
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.757102e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9976 head_norm=1.758382 delta_norm=0.017571
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.749426 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8314203381400583, 'auprc': 0.8747097507789692, 'loss_val': 0.33886114017450536, 'psi': 0.8487361031956226}-{'f1_val': 0.8306467290261653, 'auprc': 0.8915909956604815, 'loss_val': 0.35748230072815174, 'psi': 0.8550244356798917}
[S3] START round=48 head_norm_before_train=1.828739 cos_to_last_merge=0.9200 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9667379243043737, 'auprc': 0.9972963200868914, 'loss_val': 0.09972445933778894, 'psi': 0.9789612826173808}-{'f1_val': 0.9793220612134975, 'auprc': 0.997205305840754, 'loss_val': 0.0934291166385158, 'psi': 0.9864753590644001}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.478019 cos_to_last_merge=0.8766 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=48 local utility u=0.046456 metrics={'f1_val': 0.9408327137804986, 'auprc': 0.9833850405818066, 'loss_val': 0.21156176365016086, 'psi': 0.9578536445010218}-{'f1_val': 0.9331707222594636, 'auprc': 0.9795794681851285, 'loss_val': 0.24708442229289326, 'psi': 0.9517342206297296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=48 head_norm_before_train=1.530984 cos_to_last_merge=0.9096 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=48 local utility u=0.908094 metrics={'f1_val': 0.7322296229823867, 'auprc': 0.9911626290349633, 'loss_val': 0.2039075068933033, 'psi': 0.8358028254034173}-{'f1_val': 0.5782089390064978, 'auprc': 0.8404342357095704, 'loss_val': 0.6437860013996068, 'psi': 0.6830990576877269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=48 head_norm_before_train=2.011908 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6867218623064296, 'auprc': 0.9327440091500757, 'loss_val': 0.853942514284519, 'psi': 0.785130721043888}-{'f1_val': 0.8349015577481602, 'auprc': 0.950863920604581, 'loss_val': 0.42054954241401665, 'psi': 0.8812865028907285}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.750499 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6145913738869677, 'auprc': 0.7915679980998755, 'loss_val': 0.6633591018109494, 'psi': 0.6853820235721308}-{'f1_val': 0.693485872231411, 'auprc': 0.8610569610119585, 'loss_val': 0.3029987391585526, 'psi': 0.76051430774363}
[S8] START round=48 head_norm_before_train=1.797871 cos_to_last_merge=0.8868 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.887
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9983389766095523, 'loss_val': 0.04077215122479968, 'psi': 0.9970574526839127}-{'f1_val': 0.9963530749356245, 'auprc': 0.998052995479722, 'loss_val': 0.03752650510660281, 'psi': 0.9970330431532636}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.956599 cos_to_last_merge=0.9852 (last merge round=21)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9995678459396601, 'loss_val': 0.022765506511698543, 'psi': 0.9970736311290009}-{'f1_val': 0.9962461149658858, 'auprc': 0.9992165303321066, 'loss_val': 0.019893718586635727, 'psi': 0.9974342811123741}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.714375 cos_to_last_merge=0.9105 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=48 local utility u=0.000252 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954179577892467, 'loss_val': 0.028664096163723445, 'psi': 0.9952798865273236}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954531650626738, 'loss_val': 0.027955766429597167, 'psi': 0.9951621779441152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=48 head_norm_before_train=1.792635 cos_to_last_merge=0.9475 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9574739339730765, 'auprc': 0.9970255604968554, 'loss_val': 0.17461596067657287, 'psi': 0.973294584582588}-{'f1_val': 0.9963090846170353, 'auprc': 0.9960832028107873, 'loss_val': 0.024014829940142614, 'psi': 0.9962187318945361}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.378991 cos_to_last_merge=0.9091 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=48 local utility u=0.355591 metrics={'f1_val': 0.6182955359859124, 'auprc': 0.6616893027458699, 'loss_val': 0.6809298490514535, 'psi': 0.6356530426898954}-{'f1_val': 0.5228627322829131, 'auprc': 0.6808620236518611, 'loss_val': 0.8770332270707145, 'psi': 0.5860624488304924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=48 head_norm_before_train=1.758382 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969485114736489, 'auprc': 0.9992148351508156, 'loss_val': 0.025741236646222368, 'psi': 0.9978550409445156}-{'f1_val': 0.9976015531333403, 'auprc': 0.999228516710627, 'loss_val': 0.024575924376150343, 'psi': 0.998252338564255}
[S15] START round=48 head_norm_before_train=2.011945 cos_to_last_merge=0.9631 (last merge round=16)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7005685173021767, 'auprc': 0.7523979045721727, 'loss_val': 0.7006224972813314, 'psi': 0.7213002722101751}-{'f1_val': 0.874029554001719, 'auprc': 0.99305377936507, 'loss_val': 0.22319015271221723, 'psi': 0.9216392441470594}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.744440 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9407407492575591, 'auprc': 0.9926507989391825, 'loss_val': 0.23209624099527768, 'psi': 0.9615047691302084}-{'f1_val': 0.9861263021881649, 'auprc': 0.9962209889775195, 'loss_val': 0.057441797195846744, 'psi': 0.9901641769039067}
[S17] START round=48 head_norm_before_train=1.957631 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6008249379419824, 'auprc': 0.9250197265612051, 'loss_val': 1.2712838555248123, 'psi': 0.7305028533896716}-{'f1_val': 0.7296570633544116, 'auprc': 0.9227352380552503, 'loss_val': 0.5776811252277645, 'psi': 0.8068883332347471}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6146 head_norm=1.757089
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.885085e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6155 head_norm=1.761652 delta_norm=0.018851
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.762838 cos_to_last_merge=0.9999 (last merge round=46)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7079714922966331, 'auprc': 0.7718589655478043, 'loss_val': 0.7302559557089131, 'psi': 0.7335264815971017}-{'f1_val': 0.8314203381400583, 'auprc': 0.8747097507789692, 'loss_val': 0.33886114017450536, 'psi': 0.8487361031956226}
[S3] START round=49 head_norm_before_train=1.840842 cos_to_last_merge=0.9190 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9977312865429017, 'loss_val': 0.13246989686061023, 'psi': 0.9754188383566289}-{'f1_val': 0.9667379243043737, 'auprc': 0.9972963200868914, 'loss_val': 0.09972445933778894, 'psi': 0.9789612826173808}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.486571 cos_to_last_merge=0.8754 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9367388568353885, 'auprc': 0.9594283373672297, 'loss_val': 0.22830569841965132, 'psi': 0.945814649048125}-{'f1_val': 0.9408327137804986, 'auprc': 0.9833850405818066, 'loss_val': 0.21156176365016086, 'psi': 0.9578536445010218}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.536134 cos_to_last_merge=0.9087 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6140948563129451, 'auprc': 0.846755611157186, 'loss_val': 0.5746343457042818, 'psi': 0.7071591582506416}-{'f1_val': 0.7322296229823867, 'auprc': 0.9911626290349633, 'loss_val': 0.2039075068933033, 'psi': 0.8358028254034173}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=2.019920 (no previous merge yet)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.9243814360332503, 'auprc': 0.9713303464347791, 'loss_val': 0.19117173066064563, 'psi': 0.9431610001938618}-{'f1_val': 0.6867218623064296, 'auprc': 0.9327440091500757, 'loss_val': 0.853942514284519, 'psi': 0.785130721043888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=49 head_norm_before_train=1.761652 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5987895468339769, 'auprc': 0.7939046527974298, 'loss_val': 0.739150444154044, 'psi': 0.676835589219358}-{'f1_val': 0.6145913738869677, 'auprc': 0.7915679980998755, 'loss_val': 0.6633591018109494, 'psi': 0.6853820235721308}
[S8] START round=49 head_norm_before_train=1.800711 cos_to_last_merge=0.8864 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.886
[S8] round=49 local utility u=0.001330 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.997867232929643, 'loss_val': 0.03669699166246236, 'psi': 0.9968687552119488}-{'f1_val': 0.9962031034001528, 'auprc': 0.9983389766095523, 'loss_val': 0.04077215122479968, 'psi': 0.9970574526839127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=1.964482 cos_to_last_merge=0.9847 (last merge round=21)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9995914306997831, 'loss_val': 0.027717684686323272, 'psi': 0.995327759467445}-{'f1_val': 0.9954108212552283, 'auprc': 0.9995678459396601, 'loss_val': 0.022765506511698543, 'psi': 0.9970736311290009}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.724938 cos_to_last_merge=0.9094 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=49 local utility u=0.000102 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953572069768035, 'loss_val': 0.02827860109227801, 'psi': 0.9952555862023462}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954179577892467, 'loss_val': 0.028664096163723445, 'psi': 0.9952798865273236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=49 head_norm_before_train=1.798180 cos_to_last_merge=0.9470 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=49 local utility u=0.191829 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9967076712011583, 'loss_val': 0.02301475386047957, 'psi': 0.9964685192506846}-{'f1_val': 0.9574739339730765, 'auprc': 0.9970255604968554, 'loss_val': 0.17461596067657287, 'psi': 0.973294584582588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=49 head_norm_before_train=1.386118 cos_to_last_merge=0.9075 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.907
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5509801320227842, 'auprc': 0.689782400433659, 'loss_val': 0.974412386240801, 'psi': 0.6065010393871342}-{'f1_val': 0.6182955359859124, 'auprc': 0.6616893027458699, 'loss_val': 0.6809298490514535, 'psi': 0.6356530426898954}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.772290 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.000770 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988517307510713, 'loss_val': 0.028205436808084138, 'psi': 0.9982191984563652}-{'f1_val': 0.9969485114736489, 'auprc': 0.9992148351508156, 'loss_val': 0.025741236646222368, 'psi': 0.9978550409445156}
[S15] START round=49 head_norm_before_train=2.021422 cos_to_last_merge=0.9623 (last merge round=16)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9856800700625283, 'auprc': 0.9914826726073823, 'loss_val': 0.04391894819045423, 'psi': 0.9880011110804698}-{'f1_val': 0.7005685173021767, 'auprc': 0.7523979045721727, 'loss_val': 0.7006224972813314, 'psi': 0.7213002722101751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=49 head_norm_before_train=1.753908 cos_to_last_merge=0.9999 (last merge round=46)
[S16] round=49 local utility u=0.237815 metrics={'f1_val': 0.9908731974463163, 'auprc': 0.9904380722813857, 'loss_val': 0.050623573901839726, 'psi': 0.990699147380344}-{'f1_val': 0.9407407492575591, 'auprc': 0.9926507989391825, 'loss_val': 0.23209624099527768, 'psi': 0.9615047691302084}
[S17] START round=49 head_norm_before_train=1.964354 (no previous merge yet)
[S17] round=49 local utility u=0.024302 metrics={'f1_val': 0.6012632837046931, 'auprc': 0.9489467919716998, 'loss_val': 1.2970908571411264, 'psi': 0.7403366870114958}-{'f1_val': 0.6008249379419824, 'auprc': 0.9250197265612051, 'loss_val': 1.2712838555248123, 'psi': 0.7305028533896716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9999
[S2] START round=50 head_norm_before_train=1.773117 cos_to_last_merge=0.9998 (last merge round=46)
[S2] round=50 local utility u=0.718590 metrics={'f1_val': 0.8304548478337643, 'auprc': 0.8733341829893708, 'loss_val': 0.33240204065494366, 'psi': 0.847606581896007}-{'f1_val': 0.7079714922966331, 'auprc': 0.7718589655478043, 'loss_val': 0.7302559557089131, 'psi': 0.7335264815971017}
[S3] START round=50 head_norm_before_train=1.853440 cos_to_last_merge=0.9180 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=50 local utility u=0.147047 metrics={'f1_val': 0.9943374116395723, 'auprc': 0.9977104244852302, 'loss_val': 0.041075041165814175, 'psi': 0.9956866167778355}-{'f1_val': 0.9605438728991138, 'auprc': 0.9977312865429017, 'loss_val': 0.13246989686061023, 'psi': 0.9754188383566289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=50 head_norm_before_train=1.496503 cos_to_last_merge=0.8742 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9326060500108976, 'auprc': 0.948780589818799, 'loss_val': 0.2531276824501229, 'psi': 0.9390758659340581}-{'f1_val': 0.9367388568353885, 'auprc': 0.9594283373672297, 'loss_val': 0.22830569841965132, 'psi': 0.945814649048125}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.542842 cos_to_last_merge=0.9079 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.908
[S5] round=50 local utility u=0.658549 metrics={'f1_val': 0.700407554886547, 'auprc': 0.991338964403948, 'loss_val': 0.2091633033155034, 'psi': 0.8167801186935074}-{'f1_val': 0.6140948563129451, 'auprc': 0.846755611157186, 'loss_val': 0.5746343457042818, 'psi': 0.7071591582506416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] sending update (kind=head size=1810 to 1 peers)
[S6] START round=50 head_norm_before_train=2.029949 (no previous merge yet)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.8617530640814202, 'auprc': 0.9648150086044474, 'loss_val': 0.31481805864012724, 'psi': 0.902977841890631}-{'f1_val': 0.9243814360332503, 'auprc': 0.9713303464347791, 'loss_val': 0.19117173066064563, 'psi': 0.9431610001938618}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.769400 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=50 local utility u=0.040983 metrics={'f1_val': 0.6077252301431928, 'auprc': 0.7942789854219185, 'loss_val': 0.711921450372483, 'psi': 0.6823467322546831}-{'f1_val': 0.5987895468339769, 'auprc': 0.7939046527974298, 'loss_val': 0.739150444154044, 'psi': 0.676835589219358}
[S8] START round=50 head_norm_before_train=1.804409 cos_to_last_merge=0.8859 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.886
[S8] round=50 local utility u=0.000797 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.998425576474182, 'loss_val': 0.037677204190115623, 'psi': 0.9971820755510475}-{'f1_val': 0.9962031034001528, 'auprc': 0.997867232929643, 'loss_val': 0.03669699166246236, 'psi': 0.9968687552119488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=50 head_norm_before_train=1.971201 cos_to_last_merge=0.9843 (last merge round=21)
[S9] round=50 local utility u=0.013428 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995914100293664, 'loss_val': 0.02090979056254571, 'psi': 0.9973325950302578}-{'f1_val': 0.9924853119792197, 'auprc': 0.9995914306997831, 'loss_val': 0.027717684686323272, 'psi': 0.995327759467445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=50 head_norm_before_train=1.731388 cos_to_last_merge=0.9084 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952057463692519, 'loss_val': 0.027994424096640488, 'psi': 0.9951950019593256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953572069768035, 'loss_val': 0.02827860109227801, 'psi': 0.9952555862023462}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=1.803242 cos_to_last_merge=0.9465 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=50 local utility u=0.006871 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9987659220103247, 'loss_val': 0.020548529896127724, 'psi': 0.9978019806635152}-{'f1_val': 0.9963090846170353, 'auprc': 0.9967076712011583, 'loss_val': 0.02301475386047957, 'psi': 0.9964685192506846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=50 head_norm_before_train=1.392735 cos_to_last_merge=0.9059 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.906
[S13] round=50 local utility u=0.008443 metrics={'f1_val': 0.5354940922706437, 'auprc': 0.6863447623078448, 'loss_val': 0.8542967287044151, 'psi': 0.5958343602855242}-{'f1_val': 0.5509801320227842, 'auprc': 0.689782400433659, 'loss_val': 0.974412386240801, 'psi': 0.6065010393871342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=50 head_norm_before_train=1.784707 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9430960689708028, 'auprc': 0.9986919442229257, 'loss_val': 0.0665227310939523, 'psi': 0.965334419071652}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988517307510713, 'loss_val': 0.028205436808084138, 'psi': 0.9982191984563652}
[S15] START round=50 head_norm_before_train=2.027328 cos_to_last_merge=0.9617 (last merge round=16)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.8768002647697088, 'auprc': 0.9867346741333276, 'loss_val': 0.1813685997693024, 'psi': 0.9207740285151563}-{'f1_val': 0.9856800700625283, 'auprc': 0.9914826726073823, 'loss_val': 0.04391894819045423, 'psi': 0.9880011110804698}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.761096 cos_to_last_merge=0.9999 (last merge round=46)
[S16] round=50 local utility u=0.020205 metrics={'f1_val': 0.9927096249673515, 'auprc': 0.9942659618821433, 'loss_val': 0.03271676387190756, 'psi': 0.9933321597332683}-{'f1_val': 0.9908731974463163, 'auprc': 0.9904380722813857, 'loss_val': 0.050623573901839726, 'psi': 0.990699147380344}
[S17] START round=50 head_norm_before_train=1.970643 (no previous merge yet)
[S17] round=50 local utility u=1.000000 metrics={'f1_val': 0.8639393381516837, 'auprc': 0.9853871599890955, 'loss_val': 0.3704405965573969, 'psi': 0.9125184668866484}-{'f1_val': 0.6012632837046931, 'auprc': 0.9489467919716998, 'loss_val': 1.2970908571411264, 'psi': 0.7403366870114958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] ⇄ pheromone p=0.027 → S7@127.0.0.1:61808
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.9993
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=0.9993
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=50 metric=0.6077 head_norm=1.774558
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.634485e-02
[S7] stored merged vector for next round verification (round=50)
[S7] DEBUG after merge:  round=50 metric=0.6068 head_norm=1.779565 delta_norm=0.016345
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.207 → S14@127.0.0.1:61814
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=50 metric=0.8305 head_norm=1.784194
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.244412e-02
[S2] stored merged vector for next round verification (round=50)
[S2] DEBUG after merge:  round=50 metric=0.8305 head_norm=1.774579 delta_norm=0.032444
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.164 → S16@127.0.0.1:61816
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=50 metric=0.9927 head_norm=1.769931
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.323925e-02
[S16] stored merged vector for next round verification (round=50)
[S16] DEBUG after merge:  round=50 metric=0.9927 head_norm=1.776766 delta_norm=0.033239
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.071 → S2@127.0.0.1:61802
[S2] START round=51 head_norm_before_train=1.774579 cos_to_last_merge=1.0000 (last merge round=50)
[S2] round=51 local utility u=0.046444 metrics={'f1_val': 0.8283121732527882, 'auprc': 0.9255611423105377, 'loss_val': 0.38333911207812754, 'psi': 0.867211760875888}-{'f1_val': 0.8304548478337643, 'auprc': 0.8733341829893708, 'loss_val': 0.33240204065494366, 'psi': 0.847606581896007}
[S3] START round=51 head_norm_before_train=1.865580 cos_to_last_merge=0.9171 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=51 local utility u=0.018811 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9987199256235141, 'loss_val': 0.025020150988720388, 'psi': 0.9979442478213402}-{'f1_val': 0.9943374116395723, 'auprc': 0.9977104244852302, 'loss_val': 0.041075041165814175, 'psi': 0.9956866167778355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=51 head_norm_before_train=1.504454 cos_to_last_merge=0.8734 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=51 local utility u=0.093890 metrics={'f1_val': 0.9407234998693015, 'auprc': 0.9843876213108981, 'loss_val': 0.22087317440024032, 'psi': 0.9581891484459402}-{'f1_val': 0.9326060500108976, 'auprc': 0.948780589818799, 'loss_val': 0.2531276824501229, 'psi': 0.9390758659340581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=51 head_norm_before_train=1.547951 cos_to_last_merge=0.9072 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9804484755068433, 'loss_val': 0.2896025523378885, 'psi': 0.8124753670840288}-{'f1_val': 0.700407554886547, 'auprc': 0.991338964403948, 'loss_val': 0.2091633033155034, 'psi': 0.8167801186935074}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=2.039466 (no previous merge yet)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.5982380615444434, 'auprc': 0.860081689308901, 'loss_val': 1.1802883104678357, 'psi': 0.7029755126502264}-{'f1_val': 0.8617530640814202, 'auprc': 0.9648150086044474, 'loss_val': 0.31481805864012724, 'psi': 0.902977841890631}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.779565 cos_to_last_merge=1.0000 (last merge round=50)
[S7] round=51 local utility u=0.047283 metrics={'f1_val': 0.6075327146962526, 'auprc': 0.7931193551469987, 'loss_val': 0.6127214475951341, 'psi': 0.681767370876551}-{'f1_val': 0.6077252301431928, 'auprc': 0.7942789854219185, 'loss_val': 0.711921450372483, 'psi': 0.6823467322546831}
[S8] START round=51 head_norm_before_train=1.807917 cos_to_last_merge=0.8855 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.886
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9953051132645551, 'auprc': 0.9935172271920242, 'loss_val': 0.03767307614905668, 'psi': 0.9945899588355427}-{'f1_val': 0.9963530749356245, 'auprc': 0.998425576474182, 'loss_val': 0.037677204190115623, 'psi': 0.9971820755510475}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.977449 cos_to_last_merge=0.9839 (last merge round=21)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9995991823895143, 'loss_val': 0.02989396635057837, 'psi': 0.9950788650838418}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995914100293664, 'loss_val': 0.02090979056254571, 'psi': 0.9973325950302578}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.738768 cos_to_last_merge=0.9075 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954521362350104, 'loss_val': 0.027421756009391222, 'psi': 0.9951617664130499}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952057463692519, 'loss_val': 0.027994424096640488, 'psi': 0.9951950019593256}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.806574 cos_to_last_merge=0.9461 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=51 local utility u=0.002125 metrics={'f1_val': 0.9975731865293843, 'auprc': 0.9992396545075999, 'loss_val': 0.020203068820082524, 'psi': 0.9982397737206705}-{'f1_val': 0.9971593530989756, 'auprc': 0.9987659220103247, 'loss_val': 0.020548529896127724, 'psi': 0.9978019806635152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=51 head_norm_before_train=1.396841 cos_to_last_merge=0.9046 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=51 local utility u=0.349288 metrics={'f1_val': 0.620205945259611, 'auprc': 0.675371338610923, 'loss_val': 0.6310711786929623, 'psi': 0.6422721026001359}-{'f1_val': 0.5354940922706437, 'auprc': 0.6863447623078448, 'loss_val': 0.8542967287044151, 'psi': 0.5958343602855242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=51 head_norm_before_train=1.796699 cos_to_last_merge=0.9999 (last merge round=47)
[S14] round=51 local utility u=0.110715 metrics={'f1_val': 0.9766599824465292, 'auprc': 0.9987362124511044, 'loss_val': 0.046609325406274174, 'psi': 0.9854904744483594}-{'f1_val': 0.9430960689708028, 'auprc': 0.9986919442229257, 'loss_val': 0.0665227310939523, 'psi': 0.965334419071652}
[S15] START round=51 head_norm_before_train=2.032987 cos_to_last_merge=0.9613 (last merge round=16)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.775690668237161, 'auprc': 0.985864367086972, 'loss_val': 0.3892551538907599, 'psi': 0.8597601477770854}-{'f1_val': 0.8768002647697088, 'auprc': 0.9867346741333276, 'loss_val': 0.1813685997693024, 'psi': 0.9207740285151563}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.776766 cos_to_last_merge=1.0000 (last merge round=50)
[S16] round=51 local utility u=0.004351 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9963071697446542, 'loss_val': 0.03274337762589467, 'psi': 0.9944090473878751}-{'f1_val': 0.9927096249673515, 'auprc': 0.9942659618821433, 'loss_val': 0.03271676387190756, 'psi': 0.9933321597332683}
[S17] START round=51 head_norm_before_train=1.975306 (no previous merge yet)
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6307836540691505, 'auprc': 0.9361047099379369, 'loss_val': 1.1597166362886402, 'psi': 0.752912076416665}-{'f1_val': 0.8639393381516837, 'auprc': 0.9853871599890955, 'loss_val': 0.3704405965573969, 'psi': 0.9125184668866484}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9997
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=51 metric=0.9931 head_norm=1.782215
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.625580e-03
[S16] stored merged vector for next round verification (round=51)
[S16] DEBUG after merge:  round=51 metric=0.9931 head_norm=1.783977 delta_norm=0.008626
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=51 metric=0.8283 head_norm=1.785780
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.625569e-03
[S2] stored merged vector for next round verification (round=51)
[S2] DEBUG after merge:  round=51 metric=0.8283 head_norm=1.783977 delta_norm=0.008626
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=51 metric=0.9767 head_norm=1.809210
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.570216e-02
[S14] stored merged vector for next round verification (round=51)
[S14] DEBUG after merge:  round=51 metric=0.9767 head_norm=1.794568 delta_norm=0.025702
[S14] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=51 metric=0.6075 head_norm=1.785826
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.347912e-02
[S7] stored merged vector for next round verification (round=51)
[S7] DEBUG after merge:  round=51 metric=0.6084 head_norm=1.797402 delta_norm=0.023479
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=52 head_norm_before_train=1.783977 cos_to_last_merge=1.0000 (last merge round=51)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.8344922300067578, 'auprc': 0.8524726063581312, 'loss_val': 0.29067769766681045, 'psi': 0.8416843805473071}-{'f1_val': 0.8283121732527882, 'auprc': 0.9255611423105377, 'loss_val': 0.38333911207812754, 'psi': 0.867211760875888}
[S3] START round=52 head_norm_before_train=1.876864 cos_to_last_merge=0.9162 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9977808210195229, 'loss_val': 0.13439760165930242, 'psi': 0.9757814827485006}-{'f1_val': 0.9974271292865575, 'auprc': 0.9987199256235141, 'loss_val': 0.025020150988720388, 'psi': 0.9979442478213402}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.508095 cos_to_last_merge=0.8734 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9368938306580309, 'auprc': 0.949797134465911, 'loss_val': 0.22974393141421712, 'psi': 0.9420551521811829}-{'f1_val': 0.9407234998693015, 'auprc': 0.9843876213108981, 'loss_val': 0.22087317440024032, 'psi': 0.9581891484459402}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.552707 cos_to_last_merge=0.9065 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=52 local utility u=0.437782 metrics={'f1_val': 0.8213780235536569, 'auprc': 0.9935173891238624, 'loss_val': 0.17855278800141453, 'psi': 0.8902337697817391}-{'f1_val': 0.7004932948021524, 'auprc': 0.9804484755068433, 'loss_val': 0.2896025523378885, 'psi': 0.8124753670840288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=52 head_norm_before_train=2.046860 (no previous merge yet)
[S6] round=52 local utility u=1.000000 metrics={'f1_val': 0.8151487365559407, 'auprc': 0.9131262639349695, 'loss_val': 0.4520032972962268, 'psi': 0.8543397475075523}-{'f1_val': 0.5982380615444434, 'auprc': 0.860081689308901, 'loss_val': 1.1802883104678357, 'psi': 0.7029755126502264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=52 head_norm_before_train=1.797402 cos_to_last_merge=1.0000 (last merge round=51)
[S7] round=52 local utility u=0.112928 metrics={'f1_val': 0.6239172832784413, 'auprc': 0.8011706165847183, 'loss_val': 0.5093262563022471, 'psi': 0.6948186166009521}-{'f1_val': 0.6075327146962526, 'auprc': 0.7931193551469987, 'loss_val': 0.6127214475951341, 'psi': 0.681767370876551}
[S8] START round=52 head_norm_before_train=1.812256 cos_to_last_merge=0.8850 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.885
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9982409394229791, 'loss_val': 0.07231485286352271, 'psi': 0.995558918813544}-{'f1_val': 0.9953051132645551, 'auprc': 0.9935172271920242, 'loss_val': 0.03767307614905668, 'psi': 0.9945899588355427}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=1.983400 cos_to_last_merge=0.9836 (last merge round=21)
[S9] round=52 local utility u=0.019108 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995928834198475, 'loss_val': 0.019229869470390855, 'psi': 0.9978334604562739}-{'f1_val': 0.9920653202133933, 'auprc': 0.9995991823895143, 'loss_val': 0.02989396635057837, 'psi': 0.9950788650838418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=52 head_norm_before_train=1.744557 cos_to_last_merge=0.9066 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=52 local utility u=0.000508 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995445187213424, 'loss_val': 0.027702033313041222, 'psi': 0.9952907782969944}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954521362350104, 'loss_val': 0.027421756009391222, 'psi': 0.9951617664130499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=52 head_norm_before_train=1.812732 cos_to_last_merge=0.9455 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9992631186220263, 'loss_val': 0.024171954810596627, 'psi': 0.9977489222224745}-{'f1_val': 0.9975731865293843, 'auprc': 0.9992396545075999, 'loss_val': 0.020203068820082524, 'psi': 0.9982397737206705}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.399331 cos_to_last_merge=0.9041 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.5362141943781518, 'auprc': 0.6913203224528041, 'loss_val': 0.9515480445124844, 'psi': 0.5982566456080127}-{'f1_val': 0.620205945259611, 'auprc': 0.675371338610923, 'loss_val': 0.6310711786929623, 'psi': 0.6422721026001359}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.794568 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=52 local utility u=0.073723 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9992243870353379, 'loss_val': 0.02381185736612044, 'psi': 0.9980042277742275}-{'f1_val': 0.9766599824465292, 'auprc': 0.9987362124511044, 'loss_val': 0.046609325406274174, 'psi': 0.9854904744483594}
[S15] START round=52 head_norm_before_train=2.039072 cos_to_last_merge=0.9609 (last merge round=16)
[S15] round=52 local utility u=0.673121 metrics={'f1_val': 0.964345639642995, 'auprc': 0.9817650107432101, 'loss_val': 0.16264539230688252, 'psi': 0.9713133880830811}-{'f1_val': 0.775690668237161, 'auprc': 0.985864367086972, 'loss_val': 0.3892551538907599, 'psi': 0.8597601477770854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=52 head_norm_before_train=1.783977 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=52 local utility u=0.000907 metrics={'f1_val': 0.9930751847473664, 'auprc': 0.9973558954516961, 'loss_val': 0.03366392737650639, 'psi': 0.9947874690290983}-{'f1_val': 0.9931436324833557, 'auprc': 0.9963071697446542, 'loss_val': 0.03274337762589467, 'psi': 0.9944090473878751}
[S17] START round=52 head_norm_before_train=1.977525 (no previous merge yet)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5882433531418719, 'auprc': 0.9672487909263767, 'loss_val': 1.3505658630559363, 'psi': 0.7398455282556738}-{'f1_val': 0.6307836540691505, 'auprc': 0.9361047099379369, 'loss_val': 1.1597166362886402, 'psi': 0.752912076416665}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=52 metric=0.9972 head_norm=1.806821
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.067277e-03
[S14] stored merged vector for next round verification (round=52)
[S14] DEBUG after merge:  round=52 metric=0.9972 head_norm=1.806180 delta_norm=0.009067
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=52 metric=0.6239 head_norm=1.805583
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.067286e-03
[S7] stored merged vector for next round verification (round=52)
[S7] DEBUG after merge:  round=52 metric=0.6257 head_norm=1.806180 delta_norm=0.009067
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.794826 cos_to_last_merge=1.0000 (last merge round=51)
[S2] round=53 local utility u=0.035754 metrics={'f1_val': 0.8283121732527882, 'auprc': 0.9253438484877455, 'loss_val': 0.4007040470651263, 'psi': 0.8671248433467711}-{'f1_val': 0.8344922300067578, 'auprc': 0.8524726063581312, 'loss_val': 0.29067769766681045, 'psi': 0.8416843805473071}
[S3] START round=53 head_norm_before_train=1.884612 cos_to_last_merge=0.9158 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9379376393055365, 'auprc': 0.997426264334658, 'loss_val': 0.11463339601905663, 'psi': 0.9617330893171852}-{'f1_val': 0.9611152572344858, 'auprc': 0.9977808210195229, 'loss_val': 0.13439760165930242, 'psi': 0.9757814827485006}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.509076 cos_to_last_merge=0.8732 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=53 local utility u=0.005537 metrics={'f1_val': 0.937253744336981, 'auprc': 0.9490981681056745, 'loss_val': 0.2187316006111716, 'psi': 0.9419915138444585}-{'f1_val': 0.9368938306580309, 'auprc': 0.949797134465911, 'loss_val': 0.22974393141421712, 'psi': 0.9420551521811829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=53 head_norm_before_train=1.558607 cos_to_last_merge=0.9054 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.6445674669335102, 'auprc': 0.9223882451753059, 'loss_val': 0.43836934015272844, 'psi': 0.7556957782302285}-{'f1_val': 0.8213780235536569, 'auprc': 0.9935173891238624, 'loss_val': 0.17855278800141453, 'psi': 0.8902337697817391}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.052533 (no previous merge yet)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.7420514750912964, 'auprc': 0.9277118494802401, 'loss_val': 0.6918193616197204, 'psi': 0.8163156248468739}-{'f1_val': 0.8151487365559407, 'auprc': 0.9131262639349695, 'loss_val': 0.4520032972962268, 'psi': 0.8543397475075523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.806180 cos_to_last_merge=1.0000 (last merge round=52)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5972933244401462, 'auprc': 0.7945415085736645, 'loss_val': 0.6922096504494413, 'psi': 0.6761925980935535}-{'f1_val': 0.6239172832784413, 'auprc': 0.8011706165847183, 'loss_val': 0.5093262563022471, 'psi': 0.6948186166009521}
[S8] START round=53 head_norm_before_train=1.815560 cos_to_last_merge=0.8846 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.885
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.7794495644728628, 'auprc': 0.9910597900358517, 'loss_val': 0.18333505310404938, 'psi': 0.8640936546980584}-{'f1_val': 0.9937709050739206, 'auprc': 0.9982409394229791, 'loss_val': 0.07231485286352271, 'psi': 0.995558918813544}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.989941 cos_to_last_merge=0.9832 (last merge round=21)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995940477458103, 'loss_val': 0.01944278003661989, 'psi': 0.997833926186659}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995928834198475, 'loss_val': 0.019229869470390855, 'psi': 0.9978334604562739}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.750453 cos_to_last_merge=0.9057 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=53 local utility u=0.000331 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954619679362376, 'loss_val': 0.02709107722565086, 'psi': 0.9952974905861198}-{'f1_val': 0.9951878390193748, 'auprc': 0.995445187213424, 'loss_val': 0.027702033313041222, 'psi': 0.9952907782969944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=53 head_norm_before_train=1.820551 cos_to_last_merge=0.9448 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=53 local utility u=0.001804 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9982511558829222, 'loss_val': 0.02004790265470184, 'psi': 0.9975960742125543}-{'f1_val': 0.9967394579561065, 'auprc': 0.9992631186220263, 'loss_val': 0.024171954810596627, 'psi': 0.9977489222224745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=53 head_norm_before_train=1.404093 cos_to_last_merge=0.9034 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=53 local utility u=0.194779 metrics={'f1_val': 0.5768161441587533, 'auprc': 0.6756997016523967, 'loss_val': 0.7587405881777143, 'psi': 0.6163695671562106}-{'f1_val': 0.5362141943781518, 'auprc': 0.6913203224528041, 'loss_val': 0.9515480445124844, 'psi': 0.5982566456080127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=53 head_norm_before_train=1.806180 cos_to_last_merge=1.0000 (last merge round=52)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9988515145328878, 'loss_val': 0.02343839067866362, 'psi': 0.9978418739289143}-{'f1_val': 0.9971907882668205, 'auprc': 0.9992243870353379, 'loss_val': 0.02381185736612044, 'psi': 0.9980042277742275}
[S15] START round=53 head_norm_before_train=2.045822 cos_to_last_merge=0.9607 (last merge round=16)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.6921740011922941, 'auprc': 0.8803699941735117, 'loss_val': 0.6934288790830487, 'psi': 0.7674523983847812}-{'f1_val': 0.964345639642995, 'auprc': 0.9817650107432101, 'loss_val': 0.16264539230688252, 'psi': 0.9713133880830811}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.791596 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9915937428357064, 'auprc': 0.9962083298987562, 'loss_val': 0.03856786115561053, 'psi': 0.9934395776609263}-{'f1_val': 0.9930751847473664, 'auprc': 0.9973558954516961, 'loss_val': 0.03366392737650639, 'psi': 0.9947874690290983}
[S17] START round=53 head_norm_before_train=1.982130 (no previous merge yet)
[S17] round=53 local utility u=0.161474 metrics={'f1_val': 0.6135202980673575, 'auprc': 0.9822495361743819, 'loss_val': 1.2242814355487466, 'psi': 0.7610119933101673}-{'f1_val': 0.5882433531418719, 'auprc': 0.9672487909263767, 'loss_val': 1.3505658630559363, 'psi': 0.7398455282556738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=53 metric=0.8283 head_norm=1.802258
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.055345e-02
[S2] stored merged vector for next round verification (round=53)
[S2] DEBUG after merge:  round=53 metric=0.8283 head_norm=1.796904 delta_norm=0.010553
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.796904 cos_to_last_merge=1.0000 (last merge round=53)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.835254628875715, 'auprc': 0.8402224039931478, 'loss_val': 0.2772914351753614, 'psi': 0.837241738922688}-{'f1_val': 0.8283121732527882, 'auprc': 0.9253438484877455, 'loss_val': 0.4007040470651263, 'psi': 0.8671248433467711}
[S3] START round=54 head_norm_before_train=1.891665 cos_to_last_merge=0.9153 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=54 local utility u=0.006611 metrics={'f1_val': 0.9393089935926795, 'auprc': 0.9974505812494323, 'loss_val': 0.10971148966501548, 'psi': 0.9625656286553805}-{'f1_val': 0.9379376393055365, 'auprc': 0.997426264334658, 'loss_val': 0.11463339601905663, 'psi': 0.9617330893171852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=54 head_norm_before_train=1.510793 cos_to_last_merge=0.8730 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=54 local utility u=0.039155 metrics={'f1_val': 0.9432233586035502, 'auprc': 0.9577513073952206, 'loss_val': 0.20219957777184033, 'psi': 0.9490345381202184}-{'f1_val': 0.937253744336981, 'auprc': 0.9490981681056745, 'loss_val': 0.2187316006111716, 'psi': 0.9419915138444585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=54 head_norm_before_train=1.563070 cos_to_last_merge=0.9047 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=54 local utility u=0.290869 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9669636858078918, 'loss_val': 0.32591197790592413, 'psi': 0.8070814512044482}-{'f1_val': 0.6445674669335102, 'auprc': 0.9223882451753059, 'loss_val': 0.43836934015272844, 'psi': 0.7556957782302285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=54 head_norm_before_train=2.056906 (no previous merge yet)
[S6] round=54 local utility u=0.480711 metrics={'f1_val': 0.8464472957743603, 'auprc': 0.9437080400874289, 'loss_val': 0.4047618189936205, 'psi': 0.8853515934995877}-{'f1_val': 0.7420514750912964, 'auprc': 0.9277118494802401, 'loss_val': 0.6918193616197204, 'psi': 0.8163156248468739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=54 head_norm_before_train=1.813062 cos_to_last_merge=1.0000 (last merge round=52)
[S7] round=54 local utility u=0.217787 metrics={'f1_val': 0.635715191389834, 'auprc': 0.8057246507258962, 'loss_val': 0.5207168421129588, 'psi': 0.703718975124259}-{'f1_val': 0.5972933244401462, 'auprc': 0.7945415085736645, 'loss_val': 0.6922096504494413, 'psi': 0.6761925980935535}
[S8] START round=54 head_norm_before_train=1.821151 cos_to_last_merge=0.8839 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.884
[S8] round=54 local utility u=0.602370 metrics={'f1_val': 0.9621451919255137, 'auprc': 0.9968435664979469, 'loss_val': 0.09211992465545492, 'psi': 0.9760245417544869}-{'f1_val': 0.7794495644728628, 'auprc': 0.9910597900358517, 'loss_val': 0.18333505310404938, 'psi': 0.8640936546980584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=54 head_norm_before_train=1.996938 cos_to_last_merge=0.9828 (last merge round=21)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.999590767294962, 'loss_val': 0.0399454183788007, 'psi': 0.9932948158304449}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995940477458103, 'loss_val': 0.01944278003661989, 'psi': 0.997833926186659}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.757861 cos_to_last_merge=0.9047 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954750543850309, 'loss_val': 0.026639651234058124, 'psi': 0.9951709336730581}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954619679362376, 'loss_val': 0.02709107722565086, 'psi': 0.9952974905861198}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.828727 cos_to_last_merge=0.9440 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9957161515329224, 'auprc': 0.9982143186609964, 'loss_val': 0.025076836016759772, 'psi': 0.996715418384152}-{'f1_val': 0.9971593530989756, 'auprc': 0.9982511558829222, 'loss_val': 0.02004790265470184, 'psi': 0.9975960742125543}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.409197 cos_to_last_merge=0.9028 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5773160481859515, 'auprc': 0.6737876261731461, 'loss_val': 0.8443993824407031, 'psi': 0.6159046793808294}-{'f1_val': 0.5768161441587533, 'auprc': 0.6756997016523967, 'loss_val': 0.7587405881777143, 'psi': 0.6163695671562106}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.812155 cos_to_last_merge=1.0000 (last merge round=52)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988512197863617, 'loss_val': 0.026760521500603308, 'psi': 0.9979722449032935}-{'f1_val': 0.9971687801929319, 'auprc': 0.9988515145328878, 'loss_val': 0.02343839067866362, 'psi': 0.9978418739289143}
[S15] START round=54 head_norm_before_train=2.050571 cos_to_last_merge=0.9606 (last merge round=16)
[S15] round=54 local utility u=0.585894 metrics={'f1_val': 0.782468031333748, 'auprc': 0.9900842189589214, 'loss_val': 0.3925468262340387, 'psi': 0.8655145063838174}-{'f1_val': 0.6921740011922941, 'auprc': 0.8803699941735117, 'loss_val': 0.6934288790830487, 'psi': 0.7674523983847812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=54 head_norm_before_train=1.798954 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.8975714747510619, 'auprc': 0.9306839857700678, 'loss_val': 0.522615051692047, 'psi': 0.9108164791586644}-{'f1_val': 0.9915937428357064, 'auprc': 0.9962083298987562, 'loss_val': 0.03856786115561053, 'psi': 0.9934395776609263}
[S17] START round=54 head_norm_before_train=1.984357 (no previous merge yet)
[S17] round=54 local utility u=0.195386 metrics={'f1_val': 0.651455540047482, 'auprc': 0.9493757132055175, 'loss_val': 0.962498516779136, 'psi': 0.7706236093106962}-{'f1_val': 0.6135202980673575, 'auprc': 0.9822495361743819, 'loss_val': 1.2242814355487466, 'psi': 0.7610119933101673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:61814
[S7] sending update (kind=head size=1804 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=54 metric=0.8976 head_norm=1.805733
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.538586e-02
[S16] stored merged vector for next round verification (round=54)
[S16] DEBUG after merge:  round=54 metric=0.8974 head_norm=1.803931 delta_norm=0.015386
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] START round=55 head_norm_before_train=1.805140 cos_to_last_merge=1.0000 (last merge round=53)
[S2] round=55 local utility u=0.076895 metrics={'f1_val': 0.860952276152694, 'auprc': 0.8381891636460301, 'loss_val': 0.2715870538689857, 'psi': 0.8518470311500284}-{'f1_val': 0.835254628875715, 'auprc': 0.8402224039931478, 'loss_val': 0.2772914351753614, 'psi': 0.837241738922688}
[S3] START round=55 head_norm_before_train=1.900490 cos_to_last_merge=0.9145 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9483244650433217, 'auprc': 0.9949334384416393, 'loss_val': 0.18544604428658612, 'psi': 0.9669680544026487}-{'f1_val': 0.9393089935926795, 'auprc': 0.9974505812494323, 'loss_val': 0.10971148966501548, 'psi': 0.9625656286553805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.509793 cos_to_last_merge=0.8732 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=55 local utility u=0.023489 metrics={'f1_val': 0.9534586729260954, 'auprc': 0.968866445028288, 'loss_val': 0.24997840933243407, 'psi': 0.9596217817669724}-{'f1_val': 0.9432233586035502, 'auprc': 0.9577513073952206, 'loss_val': 0.20219957777184033, 'psi': 0.9490345381202184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=55 head_norm_before_train=1.565904 cos_to_last_merge=0.9045 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=55 local utility u=0.098208 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9913676047188186, 'loss_val': 0.20271068371171833, 'psi': 0.8168433615532013}-{'f1_val': 0.7004932948021524, 'auprc': 0.9669636858078918, 'loss_val': 0.32591197790592413, 'psi': 0.8070814512044482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=55 head_norm_before_train=2.065146 (no previous merge yet)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.5958929384691805, 'auprc': 0.8440665009178837, 'loss_val': 1.1487325307198257, 'psi': 0.6951623634486618}-{'f1_val': 0.8464472957743603, 'auprc': 0.9437080400874289, 'loss_val': 0.4047618189936205, 'psi': 0.8853515934995877}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.819280 cos_to_last_merge=0.9999 (last merge round=52)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5921027460647971, 'auprc': 0.7929259412155677, 'loss_val': 0.717525058139481, 'psi': 0.6724320241251054}-{'f1_val': 0.635715191389834, 'auprc': 0.8057246507258962, 'loss_val': 0.5207168421129588, 'psi': 0.703718975124259}
[S8] START round=55 head_norm_before_train=1.827382 cos_to_last_merge=0.8831 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=55 local utility u=0.131180 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9984779761434932, 'loss_val': 0.03901121643206005, 'psi': 0.9971130524974889}-{'f1_val': 0.9621451919255137, 'auprc': 0.9968435664979469, 'loss_val': 0.09211992465545492, 'psi': 0.9760245417544869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=55 head_norm_before_train=2.003999 cos_to_last_merge=0.9824 (last merge round=21)
[S9] round=55 local utility u=0.029952 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995918038567329, 'loss_val': 0.020419385903092797, 'psi': 0.9973327525612043}-{'f1_val': 0.9890975148541, 'auprc': 0.999590767294962, 'loss_val': 0.0399454183788007, 'psi': 0.9932948158304449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=55 head_norm_before_train=1.765971 cos_to_last_merge=0.9037 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=55 local utility u=0.000197 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954204403968637, 'loss_val': 0.027398896371210676, 'psi': 0.9952808795703703}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954750543850309, 'loss_val': 0.026639651234058124, 'psi': 0.9951709336730581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=55 head_norm_before_train=1.834266 cos_to_last_merge=0.9436 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=55 local utility u=0.003679 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9971703946048092, 'loss_val': 0.020765719171407612, 'psi': 0.9969157661257926}-{'f1_val': 0.9957161515329224, 'auprc': 0.9982143186609964, 'loss_val': 0.025076836016759772, 'psi': 0.996715418384152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=55 head_norm_before_train=1.416823 cos_to_last_merge=0.9021 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.902
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.5657903560225634, 'auprc': 0.6857703839906648, 'loss_val': 0.9320183745308308, 'psi': 0.613782367209804}-{'f1_val': 0.5773160481859515, 'auprc': 0.6737876261731461, 'loss_val': 0.8443993824407031, 'psi': 0.6159046793808294}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.820458 cos_to_last_merge=1.0000 (last merge round=52)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9827480230144552, 'auprc': 0.9987079488877099, 'loss_val': 0.047773138674959824, 'psi': 0.989131993363757}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988512197863617, 'loss_val': 0.026760521500603308, 'psi': 0.9979722449032935}
[S15] START round=55 head_norm_before_train=2.054818 cos_to_last_merge=0.9603 (last merge round=16)
[S15] round=55 local utility u=0.464128 metrics={'f1_val': 0.8971551412565627, 'auprc': 0.9908439855217215, 'loss_val': 0.1546928193985883, 'psi': 0.9346306789626262}-{'f1_val': 0.782468031333748, 'auprc': 0.9900842189589214, 'loss_val': 0.3925468262340387, 'psi': 0.8655145063838174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=55 head_norm_before_train=1.803931 cos_to_last_merge=1.0000 (last merge round=54)
[S16] round=55 local utility u=0.608651 metrics={'f1_val': 0.9900459978520593, 'auprc': 0.9946479634694991, 'loss_val': 0.052052406550771556, 'psi': 0.9918867840990353}-{'f1_val': 0.8975714747510619, 'auprc': 0.9306839857700678, 'loss_val': 0.522615051692047, 'psi': 0.9108164791586644}
[S17] START round=55 head_norm_before_train=1.990032 (no previous merge yet)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6409332293797478, 'auprc': 0.9000183525123853, 'loss_val': 1.0253334737112998, 'psi': 0.7445672786328028}-{'f1_val': 0.651455540047482, 'auprc': 0.9493757132055175, 'loss_val': 0.962498516779136, 'psi': 0.7706236093106962}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:61816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] ⇄ pheromone p=0.118 → S14@127.0.0.1:61814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=55 metric=0.9827 head_norm=1.828574
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.965032e-02
[S14] stored merged vector for next round verification (round=55)
[S14] DEBUG after merge:  round=55 metric=0.9810 head_norm=1.823827 delta_norm=0.019650
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.026 → S7@127.0.0.1:61808
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=55 metric=0.9900 head_norm=1.811461
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.093784e-02
[S16] stored merged vector for next round verification (round=55)
[S16] DEBUG after merge:  round=55 metric=0.9898 head_norm=1.810950 delta_norm=0.010938
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.145 → S2@127.0.0.1:61802
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=55 metric=0.8610 head_norm=1.810505
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.093784e-02
[S2] stored merged vector for next round verification (round=55)
[S2] DEBUG after merge:  round=55 metric=0.8637 head_norm=1.810950 delta_norm=0.010938
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.078 → S16@127.0.0.1:61816
[S2] START round=56 head_norm_before_train=1.810950 cos_to_last_merge=1.0000 (last merge round=55)
[S2] round=56 local utility u=0.027227 metrics={'f1_val': 0.8259567550167839, 'auprc': 0.9769475786285533, 'loss_val': 0.4234347977528165, 'psi': 0.8863530844614916}-{'f1_val': 0.860952276152694, 'auprc': 0.8381891636460301, 'loss_val': 0.2715870538689857, 'psi': 0.8518470311500284}
[S3] START round=56 head_norm_before_train=1.909242 cos_to_last_merge=0.9139 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.8175546770521986, 'auprc': 0.9972782534166409, 'loss_val': 0.2216910160434493, 'psi': 0.8894441075979755}-{'f1_val': 0.9483244650433217, 'auprc': 0.9949334384416393, 'loss_val': 0.18544604428658612, 'psi': 0.9669680544026487}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.507925 cos_to_last_merge=0.8736 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.617831269630232, 'auprc': 0.9195846150903833, 'loss_val': 0.6448829487848635, 'psi': 0.7385326078142925}-{'f1_val': 0.9534586729260954, 'auprc': 0.968866445028288, 'loss_val': 0.24997840933243407, 'psi': 0.9596217817669724}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.569468 cos_to_last_merge=0.9041 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.619819329473522, 'auprc': 0.8595130174561301, 'loss_val': 0.5750961703132472, 'psi': 0.7156968046665653}-{'f1_val': 0.7004938661094564, 'auprc': 0.9913676047188186, 'loss_val': 0.20271068371171833, 'psi': 0.8168433615532013}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=2.072935 (no previous merge yet)
[S6] round=56 local utility u=1.000000 metrics={'f1_val': 0.84313345398292, 'auprc': 0.9545482882227124, 'loss_val': 0.39810513899478245, 'psi': 0.8876993876788369}-{'f1_val': 0.5958929384691805, 'auprc': 0.8440665009178837, 'loss_val': 1.1487325307198257, 'psi': 0.6951623634486618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=56 head_norm_before_train=1.824757 cos_to_last_merge=0.9999 (last merge round=52)
[S7] round=56 local utility u=0.240230 metrics={'f1_val': 0.631324147801392, 'auprc': 0.8045758250205055, 'loss_val': 0.5073426920109406, 'psi': 0.7006248186890374}-{'f1_val': 0.5921027460647971, 'auprc': 0.7929259412155677, 'loss_val': 0.717525058139481, 'psi': 0.6724320241251054}
[S8] START round=56 head_norm_before_train=1.833095 cos_to_last_merge=0.8825 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.882
[S8] round=56 local utility u=0.003539 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9985248316563465, 'loss_val': 0.03207282768948451, 'psi': 0.9971317947026304}-{'f1_val': 0.9962031034001528, 'auprc': 0.9984779761434932, 'loss_val': 0.03901121643206005, 'psi': 0.9971130524974889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=56 head_norm_before_train=2.009950 cos_to_last_merge=0.9821 (last merge round=21)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9938387965459319, 'loss_val': 0.020217956734872644, 'psi': 0.9952855754859393}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995918038567329, 'loss_val': 0.020419385903092797, 'psi': 0.9973327525612043}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.772630 cos_to_last_merge=0.9028 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954687257500927, 'loss_val': 0.02659015756493335, 'psi': 0.9951684022190828}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954204403968637, 'loss_val': 0.027398896371210676, 'psi': 0.9952808795703703}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.838474 cos_to_last_merge=0.9432 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9966040032980217, 'loss_val': 0.020995377176222546, 'psi': 0.9966892096030776}-{'f1_val': 0.9967460138064482, 'auprc': 0.9971703946048092, 'loss_val': 0.020765719171407612, 'psi': 0.9969157661257926}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.426739 cos_to_last_merge=0.9004 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=56 local utility u=0.126961 metrics={'f1_val': 0.5926426328176692, 'auprc': 0.671646173277539, 'loss_val': 0.7968379880163932, 'psi': 0.6242440490016171}-{'f1_val': 0.5657903560225634, 'auprc': 0.6857703839906648, 'loss_val': 0.9320183745308308, 'psi': 0.613782367209804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=56 head_norm_before_train=1.823827 cos_to_last_merge=1.0000 (last merge round=55)
[S14] round=56 local utility u=0.054245 metrics={'f1_val': 0.9967276819945218, 'auprc': 0.9992237274471116, 'loss_val': 0.02470792575610991, 'psi': 0.9977261001755577}-{'f1_val': 0.9827480230144552, 'auprc': 0.9987079488877099, 'loss_val': 0.047773138674959824, 'psi': 0.989131993363757}
[S15] START round=56 head_norm_before_train=2.060599 cos_to_last_merge=0.9597 (last merge round=16)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.8316952367846001, 'auprc': 0.9879523167272745, 'loss_val': 0.24521633616947422, 'psi': 0.8941980687616699}-{'f1_val': 0.8971551412565627, 'auprc': 0.9908439855217215, 'loss_val': 0.1546928193985883, 'psi': 0.9346306789626262}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.810950 cos_to_last_merge=1.0000 (last merge round=55)
[S16] round=56 local utility u=0.000387 metrics={'f1_val': 0.9904569424657547, 'auprc': 0.9933027374179669, 'loss_val': 0.0497083817848482, 'psi': 0.9915952604466396}-{'f1_val': 0.9900459978520593, 'auprc': 0.9946479634694991, 'loss_val': 0.052052406550771556, 'psi': 0.9918867840990353}
[S17] START round=56 head_norm_before_train=1.998362 (no previous merge yet)
[S17] round=56 local utility u=0.013960 metrics={'f1_val': 0.6381260567113741, 'auprc': 0.9578196743496906, 'loss_val': 1.1539743247586036, 'psi': 0.7660035037667008}-{'f1_val': 0.6409332293797478, 'auprc': 0.9000183525123853, 'loss_val': 1.0253334737112998, 'psi': 0.7445672786328028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:61816
[S7] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9998
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=56 metric=0.9967 head_norm=1.830808
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.840582e-02
[S14] stored merged vector for next round verification (round=56)
[S14] DEBUG after merge:  round=56 metric=0.9967 head_norm=1.830126 delta_norm=0.018406
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=56 metric=0.9905 head_norm=1.815234
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.827030e-03
[S16] stored merged vector for next round verification (round=56)
[S16] DEBUG after merge:  round=56 metric=0.9905 head_norm=1.815814 delta_norm=0.006827
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=56 metric=0.8260 head_norm=1.816419
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.827034e-03
[S2] stored merged vector for next round verification (round=56)
[S2] DEBUG after merge:  round=56 metric=0.8260 head_norm=1.815814 delta_norm=0.006827
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=56 metric=0.6313 head_norm=1.829629
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.840583e-02
[S7] stored merged vector for next round verification (round=56)
[S7] DEBUG after merge:  round=56 metric=0.6322 head_norm=1.830126 delta_norm=0.018406
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=1.815814 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.8337276138230121, 'auprc': 0.8477185741414598, 'loss_val': 0.30280557768619426, 'psi': 0.8393239979503913}-{'f1_val': 0.8259567550167839, 'auprc': 0.9769475786285533, 'loss_val': 0.4234347977528165, 'psi': 0.8863530844614916}
[S3] START round=57 head_norm_before_train=1.916420 cos_to_last_merge=0.9133 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=57 local utility u=0.461916 metrics={'f1_val': 0.952302300269641, 'auprc': 0.9979531150545953, 'loss_val': 0.10836943820365201, 'psi': 0.9705626261836228}-{'f1_val': 0.8175546770521986, 'auprc': 0.9972782534166409, 'loss_val': 0.2216910160434493, 'psi': 0.8894441075979755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=57 head_norm_before_train=1.511810 cos_to_last_merge=0.8730 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=57 local utility u=1.000000 metrics={'f1_val': 0.9325564653086371, 'auprc': 0.9542074614259014, 'loss_val': 0.2643924771113353, 'psi': 0.9412168637555429}-{'f1_val': 0.617831269630232, 'auprc': 0.9195846150903833, 'loss_val': 0.6448829487848635, 'psi': 0.7385326078142925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=57 head_norm_before_train=1.572775 cos_to_last_merge=0.9037 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=57 local utility u=1.000000 metrics={'f1_val': 0.8680887080179334, 'auprc': 0.9930732312204977, 'loss_val': 0.14696932110203326, 'psi': 0.9180825172989591}-{'f1_val': 0.619819329473522, 'auprc': 0.8595130174561301, 'loss_val': 0.5750961703132472, 'psi': 0.7156968046665653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=57 head_norm_before_train=2.079700 (no previous merge yet)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.6713307065582158, 'auprc': 0.9399793428022325, 'loss_val': 0.7179861176862935, 'psi': 0.7787901610558225}-{'f1_val': 0.84313345398292, 'auprc': 0.9545482882227124, 'loss_val': 0.39810513899478245, 'psi': 0.8876993876788369}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.830126 cos_to_last_merge=1.0000 (last merge round=56)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.6303529981944245, 'auprc': 0.8011154405820674, 'loss_val': 0.603625859847422, 'psi': 0.6986579751494817}-{'f1_val': 0.631324147801392, 'auprc': 0.8045758250205055, 'loss_val': 0.5073426920109406, 'psi': 0.7006248186890374}
[S8] START round=57 head_norm_before_train=1.840091 cos_to_last_merge=0.8817 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.882
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9952430317747349, 'auprc': 0.998756669272673, 'loss_val': 0.03452229575087748, 'psi': 0.9966484867739103}-{'f1_val': 0.9962031034001528, 'auprc': 0.9985248316563465, 'loss_val': 0.03207282768948451, 'psi': 0.9971317947026304}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.015498 cos_to_last_merge=0.9817 (last merge round=21)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9995954620456196, 'loss_val': 0.026568388376674947, 'psi': 0.995347465540382}-{'f1_val': 0.9962500947792776, 'auprc': 0.9938387965459319, 'loss_val': 0.020217956734872644, 'psi': 0.9952855754859393}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=1.777777 cos_to_last_merge=0.9019 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.902
[S10] round=57 local utility u=0.000232 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955066986321132, 'loss_val': 0.026239427319144245, 'psi': 0.9951835913718909}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954687257500927, 'loss_val': 0.02659015756493335, 'psi': 0.9951684022190828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=57 head_norm_before_train=1.844413 cos_to_last_merge=0.9427 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.996023119688514, 'auprc': 0.9971806458760888, 'loss_val': 0.021611044358583877, 'psi': 0.9964861301635439}-{'f1_val': 0.9967460138064482, 'auprc': 0.9966040032980217, 'loss_val': 0.020995377176222546, 'psi': 0.9966892096030776}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.432379 cos_to_last_merge=0.8990 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.5815045437045049, 'auprc': 0.675754183808622, 'loss_val': 0.8237847004616159, 'psi': 0.6192043997461517}-{'f1_val': 0.5926426328176692, 'auprc': 0.671646173277539, 'loss_val': 0.7968379880163932, 'psi': 0.6242440490016171}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.830126 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9975303080122626, 'loss_val': 0.025501808236367288, 'psi': 0.9973129338632216}-{'f1_val': 0.9967276819945218, 'auprc': 0.9992237274471116, 'loss_val': 0.02470792575610991, 'psi': 0.9977261001755577}
[S15] START round=57 head_norm_before_train=2.068028 cos_to_last_merge=0.9590 (last merge round=16)
[S15] round=57 local utility u=0.611108 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.9929316611251316, 'loss_val': 0.024999675865048615, 'psi': 0.9948959040997232}-{'f1_val': 0.8316952367846001, 'auprc': 0.9879523167272745, 'loss_val': 0.24521633616947422, 'psi': 0.8941980687616699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=57 head_norm_before_train=1.815814 cos_to_last_merge=1.0000 (last merge round=56)
[S16] round=57 local utility u=0.007953 metrics={'f1_val': 0.9917657469545138, 'auprc': 0.9937039624621653, 'loss_val': 0.042859695906066614, 'psi': 0.9925410331575744}-{'f1_val': 0.9904569424657547, 'auprc': 0.9933027374179669, 'loss_val': 0.0497083817848482, 'psi': 0.9915952604466396}
[S17] START round=57 head_norm_before_train=2.008817 (no previous merge yet)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6188779751682143, 'auprc': 0.9909865184033733, 'loss_val': 1.2295925466342912, 'psi': 0.7677213924622779}-{'f1_val': 0.6381260567113741, 'auprc': 0.9578196743496906, 'loss_val': 1.1539743247586036, 'psi': 0.7660035037667008}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=1.0000
[S2] START round=58 head_norm_before_train=1.820494 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=58 local utility u=0.141984 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.980907488103272, 'loss_val': 0.3999197829455062, 'psi': 0.890751032657008}-{'f1_val': 0.8337276138230121, 'auprc': 0.8477185741414598, 'loss_val': 0.30280557768619426, 'psi': 0.8393239979503913}
[S3] START round=58 head_norm_before_train=1.923659 cos_to_last_merge=0.9128 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=58 local utility u=0.031864 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9979264497968265, 'loss_val': 0.09997812740047947, 'psi': 0.9760936930917391}-{'f1_val': 0.952302300269641, 'auprc': 0.9979531150545953, 'loss_val': 0.10836943820365201, 'psi': 0.9705626261836228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=58 head_norm_before_train=1.514031 cos_to_last_merge=0.8725 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=58 local utility u=0.087891 metrics={'f1_val': 0.9512395120921127, 'auprc': 0.974228300319217, 'loss_val': 0.2607719270994, 'psi': 0.9604350273829544}-{'f1_val': 0.9325564653086371, 'auprc': 0.9542074614259014, 'loss_val': 0.2643924771113353, 'psi': 0.9412168637555429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=58 head_norm_before_train=1.575387 cos_to_last_merge=0.9031 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.6853506791911119, 'auprc': 0.9249633057187165, 'loss_val': 0.4083485020870935, 'psi': 0.7811957298021538}-{'f1_val': 0.8680887080179334, 'auprc': 0.9930732312204977, 'loss_val': 0.14696932110203326, 'psi': 0.9180825172989591}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=2.085090 (no previous merge yet)
[S6] round=58 local utility u=0.569262 metrics={'f1_val': 0.8066455715856532, 'auprc': 0.9518216840215378, 'loss_val': 0.426877917354802, 'psi': 0.864716016560007}-{'f1_val': 0.6713307065582158, 'auprc': 0.9399793428022325, 'loss_val': 0.7179861176862935, 'psi': 0.7787901610558225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=58 head_norm_before_train=1.833859 cos_to_last_merge=1.0000 (last merge round=56)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5792175158268151, 'auprc': 0.7865242613521172, 'loss_val': 0.9015276624823809, 'psi': 0.6621402140369359}-{'f1_val': 0.6303529981944245, 'auprc': 0.8011154405820674, 'loss_val': 0.603625859847422, 'psi': 0.6986579751494817}
[S8] START round=58 head_norm_before_train=1.843076 cos_to_last_merge=0.8813 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.881
[S8] round=58 local utility u=0.000171 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9964000019854802, 'loss_val': 0.032870650244729384, 'psi': 0.9962818628342838}-{'f1_val': 0.9952430317747349, 'auprc': 0.998756669272673, 'loss_val': 0.03452229575087748, 'psi': 0.9966484867739103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=58 head_norm_before_train=2.018281 cos_to_last_merge=0.9814 (last merge round=21)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9992263851806953, 'loss_val': 0.04221893991359724, 'psi': 0.9931678899182583}-{'f1_val': 0.9925154678702236, 'auprc': 0.9995954620456196, 'loss_val': 0.026568388376674947, 'psi': 0.995347465540382}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.784372 cos_to_last_merge=0.9011 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=58 local utility u=0.000405 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954563115303952, 'loss_val': 0.02659660389055399, 'psi': 0.9952952280237829}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955066986321132, 'loss_val': 0.026239427319144245, 'psi': 0.9951835913718909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=58 head_norm_before_train=1.851551 cos_to_last_merge=0.9420 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9941028602972538, 'auprc': 0.9974720239585471, 'loss_val': 0.028170736976142814, 'psi': 0.9954505257617712}-{'f1_val': 0.996023119688514, 'auprc': 0.9971806458760888, 'loss_val': 0.021611044358583877, 'psi': 0.9964861301635439}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.438137 cos_to_last_merge=0.8977 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=58 local utility u=0.015524 metrics={'f1_val': 0.587246220593627, 'auprc': 0.6881183658210925, 'loss_val': 0.864279029667527, 'psi': 0.6275950786846132}-{'f1_val': 0.5815045437045049, 'auprc': 0.675754183808622, 'loss_val': 0.8237847004616159, 'psi': 0.6192043997461517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=58 head_norm_before_train=1.835924 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=58 local utility u=0.002876 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9992278897498936, 'loss_val': 0.029773943490302462, 'psi': 0.9984851764739}-{'f1_val': 0.9971680177638609, 'auprc': 0.9975303080122626, 'loss_val': 0.025501808236367288, 'psi': 0.9973129338632216}
[S15] START round=58 head_norm_before_train=2.076043 cos_to_last_merge=0.9584 (last merge round=16)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7186277001834974, 'auprc': 0.9719515986978142, 'loss_val': 0.5245268579278392, 'psi': 0.8199572595892242}-{'f1_val': 0.9962053994161175, 'auprc': 0.9929316611251316, 'loss_val': 0.024999675865048615, 'psi': 0.9948959040997232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.819849 cos_to_last_merge=1.0000 (last merge round=56)
[S16] round=58 local utility u=0.000413 metrics={'f1_val': 0.9917657469545138, 'auprc': 0.9936527188343353, 'loss_val': 0.04188071480862345, 'psi': 0.9925205357064424}-{'f1_val': 0.9917657469545138, 'auprc': 0.9937039624621653, 'loss_val': 0.042859695906066614, 'psi': 0.9925410331575744}
[S17] START round=58 head_norm_before_train=2.017625 (no previous merge yet)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6256110606051093, 'auprc': 0.9666729471033422, 'loss_val': 1.2455977890277456, 'psi': 0.7620358152044024}-{'f1_val': 0.6188779751682143, 'auprc': 0.9909865184033733, 'loss_val': 1.2295925466342912, 'psi': 0.7677213924622779}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S14] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] cosine check vs S14: cos=1.0000
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=58 metric=0.9918 head_norm=1.826221
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.799555e-03
[S16] stored merged vector for next round verification (round=58)
[S16] DEBUG after merge:  round=58 metric=0.9918 head_norm=1.826513 delta_norm=0.009800
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=58 metric=0.8306 head_norm=1.826859
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.495692e-03
[S2] stored merged vector for next round verification (round=58)
[S2] DEBUG after merge:  round=58 metric=0.8306 head_norm=1.824926 delta_norm=0.008496
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.824926 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.8273196672569901, 'auprc': 0.9076528133915753, 'loss_val': 0.39976107621419166, 'psi': 0.8594529257108242}-{'f1_val': 0.8306467290261653, 'auprc': 0.980907488103272, 'loss_val': 0.3999197829455062, 'psi': 0.890751032657008}
[S3] START round=59 head_norm_before_train=1.930920 cos_to_last_merge=0.9122 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=59 local utility u=0.058601 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.9979730362700668, 'loss_val': 0.061774095165593186, 'psi': 0.9839981776767657}-{'f1_val': 0.9615385219550141, 'auprc': 0.9979264497968265, 'loss_val': 0.09997812740047947, 'psi': 0.9760936930917391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] r=60 psi=0.984 u=0.0586 p_local=0.0829 f1=0.975 auprc=0.998 bytes=59280
[S4] START round=59 head_norm_before_train=1.518678 cos_to_last_merge=0.8715 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9517156497378169, 'auprc': 0.9635615638348698, 'loss_val': 0.26557157365646694, 'psi': 0.9564540153766381}-{'f1_val': 0.9512395120921127, 'auprc': 0.974228300319217, 'loss_val': 0.2607719270994, 'psi': 0.9604350273829544}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.956 u=0.0000 p_local=0.1516 f1=0.952 auprc=0.964 bytes=61028
[S5] START round=59 head_norm_before_train=1.581031 cos_to_last_merge=0.9021 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.902
[S5] round=59 local utility u=0.962027 metrics={'f1_val': 0.9253008005050523, 'auprc': 0.9944116242305343, 'loss_val': 0.13233928954075294, 'psi': 0.9529451299952452}-{'f1_val': 0.6853506791911119, 'auprc': 0.9249633057187165, 'loss_val': 0.4083485020870935, 'psi': 0.7811957298021538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S5] r=60 psi=0.953 u=0.9620 p_local=0.4138 f1=0.925 auprc=0.994 bytes=59491
[S6] START round=59 head_norm_before_train=2.088046 (no previous merge yet)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.772069630552545, 'auprc': 0.9237046705332791, 'loss_val': 0.5519324687047622, 'psi': 0.8327236465448387}-{'f1_val': 0.8066455715856532, 'auprc': 0.9518216840215378, 'loss_val': 0.426877917354802, 'psi': 0.864716016560007}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.833 u=0.0000 p_local=0.3136 f1=0.772 auprc=0.924 bytes=62903
[S7] START round=59 head_norm_before_train=1.836565 cos_to_last_merge=1.0000 (last merge round=56)
[S7] round=59 local utility u=0.056755 metrics={'f1_val': 0.5865387038070895, 'auprc': 0.7884899110405728, 'loss_val': 0.8378408283659282, 'psi': 0.6673191867004828}-{'f1_val': 0.5792175158268151, 'auprc': 0.7865242613521172, 'loss_val': 0.9015276624823809, 'psi': 0.6621402140369359}
[S8] START round=59 head_norm_before_train=1.845897 cos_to_last_merge=0.8809 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.881
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9985009986111812, 'loss_val': 0.04733912681215719, 'psi': 0.9953559960525904}-{'f1_val': 0.9962031034001528, 'auprc': 0.9964000019854802, 'loss_val': 0.032870650244729384, 'psi': 0.9962818628342838}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.995 u=0.0000 p_local=0.0509 f1=0.993 auprc=0.999 bytes=75583
[S9] START round=59 head_norm_before_train=2.021689 cos_to_last_merge=0.9810 (last merge round=21)
[S9] round=59 local utility u=0.033660 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988407675093474, 'loss_val': 0.018931456757661832, 'psi': 0.9975326140920738}-{'f1_val': 0.9891288930766337, 'auprc': 0.9992263851806953, 'loss_val': 0.04221893991359724, 'psi': 0.9931678899182583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=60 psi=0.998 u=0.0337 p_local=0.0107 f1=0.997 auprc=0.999 bytes=59339
[S10] START round=59 head_norm_before_train=1.791597 cos_to_last_merge=0.9003 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953242914932602, 'loss_val': 0.02670014546669756, 'psi': 0.9952424200089289}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954563115303952, 'loss_val': 0.02659660389055399, 'psi': 0.9952952280237829}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.995 bytes=86282
[S11] START round=59 head_norm_before_train=1.859222 cos_to_last_merge=0.9414 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=59 local utility u=0.011492 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9971520807053851, 'loss_val': 0.020086420566538293, 'psi': 0.996908440566023}-{'f1_val': 0.9941028602972538, 'auprc': 0.9974720239585471, 'loss_val': 0.028170736976142814, 'psi': 0.9954505257617712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] r=60 psi=0.997 u=0.0115 p_local=0.0079 f1=0.997 auprc=0.997 bytes=63007
[S13] START round=59 head_norm_before_train=1.445060 cos_to_last_merge=0.8965 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=59 local utility u=0.078357 metrics={'f1_val': 0.6021532398421001, 'auprc': 0.67985255322662, 'loss_val': 0.7722089626152366, 'psi': 0.6332329651959081}-{'f1_val': 0.587246220593627, 'auprc': 0.6881183658210925, 'loss_val': 0.864279029667527, 'psi': 0.6275950786846132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=60 psi=0.633 u=0.0784 p_local=0.0630 f1=0.602 auprc=0.680 bytes=50334
[S14] START round=59 head_norm_before_train=1.843239 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=59 local utility u=0.000487 metrics={'f1_val': 0.9973592763401687, 'auprc': 0.9992284850858517, 'loss_val': 0.02501659520065706, 'psi': 0.998106959838442}-{'f1_val': 0.9979900342899044, 'auprc': 0.9992278897498936, 'loss_val': 0.029773943490302462, 'psi': 0.9984851764739}
[S15] START round=59 head_norm_before_train=2.085728 cos_to_last_merge=0.9578 (last merge round=16)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.8541801395368648, 'loss_val': 0.6831962974604773, 'psi': 0.7622235664357464}-{'f1_val': 0.7186277001834974, 'auprc': 0.9719515986978142, 'loss_val': 0.5245268579278392, 'psi': 0.8199572595892242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.762 u=0.0000 p_local=0.2224 f1=0.701 auprc=0.854 bytes=59404
[S16] START round=59 head_norm_before_train=1.826513 cos_to_last_merge=1.0000 (last merge round=58)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9747194648819495, 'auprc': 0.9925320822955377, 'loss_val': 0.08465404451029064, 'psi': 0.9818445118473847}-{'f1_val': 0.9917657469545138, 'auprc': 0.9936527188343353, 'loss_val': 0.04188071480862345, 'psi': 0.9925205357064424}
[S17] START round=59 head_norm_before_train=2.026400 (no previous merge yet)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6118244920624756, 'auprc': 0.7947729732390524, 'loss_val': 1.1509696096523674, 'psi': 0.6850038845331063}-{'f1_val': 0.6256110606051093, 'auprc': 0.9666729471033422, 'loss_val': 1.2455977890277456, 'psi': 0.7620358152044024}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.685 u=0.0000 p_local=0.0606 f1=0.612 auprc=0.795 bytes=59369
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.982 u=0.0000 p_local=0.0607 f1=0.975 auprc=0.993 bytes=62928
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] r=60 psi=0.859 u=0.0000 p_local=0.0573 f1=0.827 auprc=0.908 bytes=59395
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=59 metric=0.5865 head_norm=1.839100
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.176662e-02
[S7] stored merged vector for next round verification (round=59)
[S7] DEBUG after merge:  round=59 metric=0.5866 head_norm=1.843705 delta_norm=0.011767
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] r=60 psi=0.667 u=0.0568 p_local=0.0843 f1=0.587 auprc=0.788 bytes=57583
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=59 metric=0.9974 head_norm=1.853523
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.428696e-02
[S14] stored merged vector for next round verification (round=59)
[S14] DEBUG after merge:  round=59 metric=0.9974 head_norm=1.846270 delta_norm=0.014287
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=60 psi=0.998 u=0.0005 p_local=0.0166 f1=0.997 auprc=0.999 bytes=63009
[S2] START round=60 head_norm_before_train=1.831796 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.7661248778624491, 'auprc': 0.8276357014938858, 'loss_val': 0.5524343779354818, 'psi': 0.7907292073150238}-{'f1_val': 0.8273196672569901, 'auprc': 0.9076528133915753, 'loss_val': 0.39976107621419166, 'psi': 0.8594529257108242}
[S3] START round=60 head_norm_before_train=1.939065 cos_to_last_merge=0.9116 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=60 local utility u=0.075414 metrics={'f1_val': 0.9936445785345308, 'auprc': 0.997853920850187, 'loss_val': 0.024365909745399813, 'psi': 0.9953283154607933}-{'f1_val': 0.9746816052812316, 'auprc': 0.9979730362700668, 'loss_val': 0.061774095165593186, 'psi': 0.9839981776767657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=60 head_norm_before_train=1.524286 cos_to_last_merge=0.8703 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.870
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9281153869652792, 'auprc': 0.9620832746324832, 'loss_val': 0.3135409625364868, 'psi': 0.9417025420321607}-{'f1_val': 0.9517156497378169, 'auprc': 0.9635615638348698, 'loss_val': 0.26557157365646694, 'psi': 0.9564540153766381}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.588478 cos_to_last_merge=0.9010 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.5225434901686067, 'auprc': 0.8553532262840138, 'loss_val': 0.695177188170795, 'psi': 0.6556673846147696}-{'f1_val': 0.9253008005050523, 'auprc': 0.9944116242305343, 'loss_val': 0.13233928954075294, 'psi': 0.9529451299952452}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=2.091720 (no previous merge yet)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.7273931749456701, 'auprc': 0.8867246756338465, 'loss_val': 0.7542756414764054, 'psi': 0.7911257752209406}-{'f1_val': 0.772069630552545, 'auprc': 0.9237046705332791, 'loss_val': 0.5519324687047622, 'psi': 0.8327236465448387}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.843705 cos_to_last_merge=1.0000 (last merge round=59)
[S7] round=60 local utility u=0.053872 metrics={'f1_val': 0.5956309235355128, 'auprc': 0.7914320376415127, 'loss_val': 0.7934768600352712, 'psi': 0.6739513691779129}-{'f1_val': 0.5865387038070895, 'auprc': 0.7884899110405728, 'loss_val': 0.8378408283659282, 'psi': 0.6673191867004828}
[S8] START round=60 head_norm_before_train=1.851505 cos_to_last_merge=0.8801 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.880
[S8] round=60 local utility u=0.006603 metrics={'f1_val': 0.9954543001490541, 'auprc': 0.9959013974965442, 'loss_val': 0.03950435601669441, 'psi': 0.9956331390880501}-{'f1_val': 0.9932593276801964, 'auprc': 0.9985009986111812, 'loss_val': 0.04733912681215719, 'psi': 0.9953559960525904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=60 head_norm_before_train=2.026666 cos_to_last_merge=0.9806 (last merge round=21)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.996381878455862, 'loss_val': 0.01919010813671966, 'psi': 0.9965490584706796}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988407675093474, 'loss_val': 0.018931456757661832, 'psi': 0.9975326140920738}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=1.799024 cos_to_last_merge=0.8996 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995223286627311, 'loss_val': 0.026536771433174143, 'psi': 0.9952020180625492}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953242914932602, 'loss_val': 0.02670014546669756, 'psi': 0.9952424200089289}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.866453 cos_to_last_merge=0.9407 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=60 local utility u=0.000586 metrics={'f1_val': 0.9964364589810413, 'auprc': 0.9983517289499448, 'loss_val': 0.02065659220220163, 'psi': 0.9972025669686028}-{'f1_val': 0.9967460138064482, 'auprc': 0.9971520807053851, 'loss_val': 0.020086420566538293, 'psi': 0.996908440566023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=60 head_norm_before_train=1.453513 cos_to_last_merge=0.8950 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=60 local utility u=0.007028 metrics={'f1_val': 0.5984088882473879, 'auprc': 0.6901575961991714, 'loss_val': 0.766602028634724, 'psi': 0.6351083714281013}-{'f1_val': 0.6021532398421001, 'auprc': 0.67985255322662, 'loss_val': 0.7722089626152366, 'psi': 0.6332329651959081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=60 head_norm_before_train=1.846270 cos_to_last_merge=1.0000 (last merge round=59)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988547924489474, 'loss_val': 0.029759985648184197, 'psi': 0.9982204231355156}-{'f1_val': 0.9973592763401687, 'auprc': 0.9992284850858517, 'loss_val': 0.02501659520065706, 'psi': 0.998106959838442}
[S15] START round=60 head_norm_before_train=2.093644 cos_to_last_merge=0.9570 (last merge round=16)
[S15] round=60 local utility u=1.000000 metrics={'f1_val': 0.9950917198603518, 'auprc': 0.9983941648979029, 'loss_val': 0.02429855599631331, 'psi': 0.9964126978753722}-{'f1_val': 0.7009191843683342, 'auprc': 0.8541801395368648, 'loss_val': 0.6831962974604773, 'psi': 0.7622235664357464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=60 head_norm_before_train=1.832790 cos_to_last_merge=1.0000 (last merge round=58)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9251565720227226, 'auprc': 0.9487503687894666, 'loss_val': 0.4224513603994447, 'psi': 0.9345940907294202}-{'f1_val': 0.9747194648819495, 'auprc': 0.9925320822955377, 'loss_val': 0.08465404451029064, 'psi': 0.9818445118473847}
[S17] START round=60 head_norm_before_train=2.037993 (no previous merge yet)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.5844527099481475, 'auprc': 0.8026752178049513, 'loss_val': 1.399072502819288, 'psi': 0.6717417130908689}-{'f1_val': 0.6118244920624756, 'auprc': 0.7947729732390524, 'loss_val': 1.1509696096523674, 'psi': 0.6850038845331063}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.046 → S16@127.0.0.1:61816
[S14] ⇄ pheromone p=0.013 → S7@127.0.0.1:61808
[S7] sending update (kind=head size=1805 to 1 peers)
[S16] ⇄ pheromone p=0.049 → S2@127.0.0.1:61802
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=1.0000
[S7] ⇄ pheromone p=0.078 → S14@127.0.0.1:61814
[S2] START round=61 head_norm_before_train=1.841000 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=61 local utility u=0.182711 metrics={'f1_val': 0.7984004052373792, 'auprc': 0.873997082416152, 'loss_val': 0.5197488424145789, 'psi': 0.8286390761088883}-{'f1_val': 0.7661248778624491, 'auprc': 0.8276357014938858, 'loss_val': 0.5524343779354818, 'psi': 0.7907292073150238}
[S3] START round=61 head_norm_before_train=1.947444 cos_to_last_merge=0.9109 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=61 local utility u=0.012139 metrics={'f1_val': 0.9969808748199115, 'auprc': 0.9977129961521771, 'loss_val': 0.019682603892535542, 'psi': 0.9972737233528177}-{'f1_val': 0.9936445785345308, 'auprc': 0.997853920850187, 'loss_val': 0.024365909745399813, 'psi': 0.9953283154607933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=61 head_norm_before_train=1.529862 cos_to_last_merge=0.8692 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.869
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9362838435859805, 'auprc': 0.935530700718311, 'loss_val': 0.3028927298874803, 'psi': 0.9359825864389127}-{'f1_val': 0.9281153869652792, 'auprc': 0.9620832746324832, 'loss_val': 0.3135409625364868, 'psi': 0.9417025420321607}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.594400 cos_to_last_merge=0.8999 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=61 local utility u=1.000000 metrics={'f1_val': 0.8621872007994507, 'auprc': 0.9920476986534055, 'loss_val': 0.15118788813368983, 'psi': 0.9141313999410325}-{'f1_val': 0.5225434901686067, 'auprc': 0.8553532262840138, 'loss_val': 0.695177188170795, 'psi': 0.6556673846147696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=61 head_norm_before_train=2.097323 (no previous merge yet)
[S6] round=61 local utility u=0.036663 metrics={'f1_val': 0.7353773668827441, 'auprc': 0.905743426136893, 'loss_val': 0.7859113837640745, 'psi': 0.8035237905844037}-{'f1_val': 0.7273931749456701, 'auprc': 0.8867246756338465, 'loss_val': 0.7542756414764054, 'psi': 0.7911257752209406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=61 head_norm_before_train=1.846316 cos_to_last_merge=1.0000 (last merge round=59)
[S7] round=61 local utility u=1.000000 metrics={'f1_val': 0.9374422504502238, 'auprc': 0.9946640522607761, 'loss_val': 0.14806979481328475, 'psi': 0.9603309711744448}-{'f1_val': 0.5956309235355128, 'auprc': 0.7914320376415127, 'loss_val': 0.7934768600352712, 'psi': 0.6739513691779129}
[S8] START round=61 head_norm_before_train=1.857612 cos_to_last_merge=0.8793 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.879
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9988745407499914, 'loss_val': 0.04110949880644533, 'psi': 0.9945035273075695}-{'f1_val': 0.9954543001490541, 'auprc': 0.9959013974965442, 'loss_val': 0.03950435601669441, 'psi': 0.9956331390880501}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=2.032446 cos_to_last_merge=0.9802 (last merge round=21)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9992082228205689, 'loss_val': 0.04500382375594316, 'psi': 0.992631701432096}-{'f1_val': 0.9966605118138915, 'auprc': 0.996381878455862, 'loss_val': 0.01919010813671966, 'psi': 0.9965490584706796}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.806491 cos_to_last_merge=0.8988 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954683695255175, 'loss_val': 0.026186570168784777, 'psi': 0.9951682597292527}-{'f1_val': 0.9951878390193748, 'auprc': 0.995223286627311, 'loss_val': 0.026536771433174143, 'psi': 0.9952020180625492}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.874027 cos_to_last_merge=0.9401 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9962639607815889, 'auprc': 0.997746653702888, 'loss_val': 0.019940851189975992, 'psi': 0.9968570379501085}-{'f1_val': 0.9964364589810413, 'auprc': 0.9983517289499448, 'loss_val': 0.02065659220220163, 'psi': 0.9972025669686028}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.462733 cos_to_last_merge=0.8928 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.569853067932943, 'auprc': 0.7025446193024503, 'loss_val': 0.9833799598763342, 'psi': 0.6229296884807458}-{'f1_val': 0.5984088882473879, 'auprc': 0.6901575961991714, 'loss_val': 0.766602028634724, 'psi': 0.6351083714281013}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.853631 cos_to_last_merge=1.0000 (last merge round=59)
[S14] round=61 local utility u=0.000925 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988498236169302, 'loss_val': 0.027894648998464798, 'psi': 0.9982184356027087}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988547924489474, 'loss_val': 0.029759985648184197, 'psi': 0.9982204231355156}
[S15] START round=61 head_norm_before_train=2.098361 cos_to_last_merge=0.9565 (last merge round=16)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.9867174296556385, 'loss_val': 0.4880879290083705, 'psi': 0.8166726757633118}-{'f1_val': 0.9950917198603518, 'auprc': 0.9983941648979029, 'loss_val': 0.02429855599631331, 'psi': 0.9964126978753722}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.835233 cos_to_last_merge=1.0000 (last merge round=58)
[S16] round=61 local utility u=0.041288 metrics={'f1_val': 0.9340260572494476, 'auprc': 0.9483912721445659, 'loss_val': 0.39201495747002885, 'psi': 0.9397721432074949}-{'f1_val': 0.9251565720227226, 'auprc': 0.9487503687894666, 'loss_val': 0.4224513603994447, 'psi': 0.9345940907294202}
[S17] START round=61 head_norm_before_train=2.049473 (no previous merge yet)
[S17] round=61 local utility u=0.376461 metrics={'f1_val': 0.6243200163794278, 'auprc': 0.9548654474849296, 'loss_val': 1.3419244732198703, 'psi': 0.7565381888216285}-{'f1_val': 0.5844527099481475, 'auprc': 0.8026752178049513, 'loss_val': 1.399072502819288, 'psi': 0.6717417130908689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:61816
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=61 metric=0.9978 head_norm=1.860756
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.388045e-02
[S14] stored merged vector for next round verification (round=61)
[S14] DEBUG after merge:  round=61 metric=0.9978 head_norm=1.854029 delta_norm=0.013880
[S14] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=61 metric=0.9374 head_norm=1.848451
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.420358e-02
[S7] stored merged vector for next round verification (round=61)
[S7] DEBUG after merge:  round=61 metric=0.9590 head_norm=1.854559 delta_norm=0.014204
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=61 metric=0.7984 head_norm=1.849687
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.838040e-02
[S2] stored merged vector for next round verification (round=61)
[S2] DEBUG after merge:  round=61 metric=0.7984 head_norm=1.844378 delta_norm=0.018380
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=61 metric=0.9340 head_norm=1.839237
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.838039e-02
[S16] stored merged vector for next round verification (round=61)
[S16] DEBUG after merge:  round=61 metric=0.9340 head_norm=1.844378 delta_norm=0.018380
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.844378 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=62 local utility u=0.123566 metrics={'f1_val': 0.8111835709548799, 'auprc': 0.895131658254178, 'loss_val': 0.4127189715901281, 'psi': 0.8447628058745991}-{'f1_val': 0.7984004052373792, 'auprc': 0.873997082416152, 'loss_val': 0.5197488424145789, 'psi': 0.8286390761088883}
[S3] START round=62 head_norm_before_train=1.955436 cos_to_last_merge=0.9102 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9882998237075507, 'auprc': 0.9979373839547242, 'loss_val': 0.06517453372708658, 'psi': 0.99215484780642}-{'f1_val': 0.9969808748199115, 'auprc': 0.9977129961521771, 'loss_val': 0.019682603892535542, 'psi': 0.9972737233528177}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.531224 cos_to_last_merge=0.8688 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.869
[S4] round=62 local utility u=0.116555 metrics={'f1_val': 0.949296095081715, 'auprc': 0.9749779952894166, 'loss_val': 0.266197367904683, 'psi': 0.9595688551647956}-{'f1_val': 0.9362838435859805, 'auprc': 0.935530700718311, 'loss_val': 0.3028927298874803, 'psi': 0.9359825864389127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=62 head_norm_before_train=1.599289 cos_to_last_merge=0.8994 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9865616356216609, 'loss_val': 0.3723660615500812, 'psi': 0.8148691871805926}-{'f1_val': 0.8621872007994507, 'auprc': 0.9920476986534055, 'loss_val': 0.15118788813368983, 'psi': 0.9141313999410325}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=2.106033 (no previous merge yet)
[S6] round=62 local utility u=0.485202 metrics={'f1_val': 0.8437921225393078, 'auprc': 0.9466529389420908, 'loss_val': 0.5887246390863509, 'psi': 0.884936449100421}-{'f1_val': 0.7353773668827441, 'auprc': 0.905743426136893, 'loss_val': 0.7859113837640745, 'psi': 0.8035237905844037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=62 head_norm_before_train=1.854559 cos_to_last_merge=1.0000 (last merge round=61)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.49946560731571976, 'auprc': 0.7808702585036483, 'loss_val': 1.1125554692336488, 'psi': 0.6120274677908912}-{'f1_val': 0.9374422504502238, 'auprc': 0.9946640522607761, 'loss_val': 0.14806979481328475, 'psi': 0.9603309711744448}
[S8] START round=62 head_norm_before_train=1.862813 cos_to_last_merge=0.8787 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.879
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.7143056369659406, 'auprc': 0.9952366125650352, 'loss_val': 0.3286113232974151, 'psi': 0.8266780272055785}-{'f1_val': 0.9915895183459548, 'auprc': 0.9988745407499914, 'loss_val': 0.04110949880644533, 'psi': 0.9945035273075695}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.034750 cos_to_last_merge=0.9801 (last merge round=21)
[S9] round=62 local utility u=0.019094 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9992221295656865, 'loss_val': 0.029765917570893342, 'psi': 0.9949280439543107}-{'f1_val': 0.9882473538397808, 'auprc': 0.9992082228205689, 'loss_val': 0.04500382375594316, 'psi': 0.992631701432096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=62 head_norm_before_train=1.814130 cos_to_last_merge=0.8981 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=62 local utility u=0.000649 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995457278282062, 'loss_val': 0.026173729360092098, 'psi': 0.9952956147244496}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954683695255175, 'loss_val': 0.026186570168784777, 'psi': 0.9951682597292527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=62 head_norm_before_train=1.881472 cos_to_last_merge=0.9395 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=62 local utility u=0.000139 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9969329803941546, 'loss_val': 0.020113341642964966, 'psi': 0.9968208004415308}-{'f1_val': 0.9962639607815889, 'auprc': 0.997746653702888, 'loss_val': 0.019940851189975992, 'psi': 0.9968570379501085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=62 head_norm_before_train=1.471877 cos_to_last_merge=0.8908 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5654114520516105, 'auprc': 0.6981081729448869, 'loss_val': 0.9511574254686045, 'psi': 0.618490140408921}-{'f1_val': 0.569853067932943, 'auprc': 0.7025446193024503, 'loss_val': 0.9833799598763342, 'psi': 0.6229296884807458}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.854029 cos_to_last_merge=1.0000 (last merge round=61)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.963135083383778, 'auprc': 0.9988526415140868, 'loss_val': 0.05242507748517314, 'psi': 0.9774221066359016}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988498236169302, 'loss_val': 0.027894648998464798, 'psi': 0.9982184356027087}
[S15] START round=62 head_norm_before_train=2.101201 cos_to_last_merge=0.9565 (last merge round=16)
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9871335686697957, 'loss_val': 0.5269292390872022, 'psi': 0.8154049380889188}-{'f1_val': 0.7033095065017607, 'auprc': 0.9867174296556385, 'loss_val': 0.4880879290083705, 'psi': 0.8166726757633118}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=1.844378 cos_to_last_merge=1.0000 (last merge round=61)
[S16] round=62 local utility u=0.431567 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9979689526285946, 'loss_val': 0.03231890548876697, 'psi': 0.9950737605414512}-{'f1_val': 0.9340260572494476, 'auprc': 0.9483912721445659, 'loss_val': 0.39201495747002885, 'psi': 0.9397721432074949}
[S17] START round=62 head_norm_before_train=2.057782 (no previous merge yet)
[S17] round=62 local utility u=0.094126 metrics={'f1_val': 0.6326775163568725, 'auprc': 0.9899794544713569, 'loss_val': 1.3091591473692497, 'psi': 0.7755982916026662}-{'f1_val': 0.6243200163794278, 'auprc': 0.9548654474849296, 'loss_val': 1.3419244732198703, 'psi': 0.7565381888216285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=1.0000
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=62 metric=0.8112 head_norm=1.853123
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.297929e-03
[S2] stored merged vector for next round verification (round=62)
[S2] DEBUG after merge:  round=62 metric=0.8112 head_norm=1.851813 delta_norm=0.005298
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=62 metric=0.9931 head_norm=1.850517
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.297921e-03
[S16] stored merged vector for next round verification (round=62)
[S16] DEBUG after merge:  round=62 metric=0.9931 head_norm=1.851813 delta_norm=0.005298
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=1.851813 cos_to_last_merge=1.0000 (last merge round=62)
[S2] round=63 local utility u=0.088294 metrics={'f1_val': 0.8283882971096544, 'auprc': 0.9079647572129934, 'loss_val': 0.3778583178799749, 'psi': 0.86021888115099}-{'f1_val': 0.8111835709548799, 'auprc': 0.895131658254178, 'loss_val': 0.4127189715901281, 'psi': 0.8447628058745991}
[S3] START round=63 head_norm_before_train=1.960730 cos_to_last_merge=0.9095 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.8890651069451792, 'auprc': 0.9978981875517327, 'loss_val': 0.278006197793435, 'psi': 0.9325983391878006}-{'f1_val': 0.9882998237075507, 'auprc': 0.9979373839547242, 'loss_val': 0.06517453372708658, 'psi': 0.99215484780642}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.535484 cos_to_last_merge=0.8681 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.94209635704945, 'auprc': 0.9535354841611768, 'loss_val': 0.2757007752048694, 'psi': 0.9466720078941409}-{'f1_val': 0.949296095081715, 'auprc': 0.9749779952894166, 'loss_val': 0.266197367904683, 'psi': 0.9595688551647956}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.602397 cos_to_last_merge=0.8992 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9062649112168774, 'loss_val': 0.4172299390948853, 'psi': 0.782750110315312}-{'f1_val': 0.700407554886547, 'auprc': 0.9865616356216609, 'loss_val': 0.3723660615500812, 'psi': 0.8148691871805926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=2.110955 (no previous merge yet)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.8156340059005063, 'auprc': 0.9595887940084965, 'loss_val': 0.5041972213057283, 'psi': 0.8732159211437024}-{'f1_val': 0.8437921225393078, 'auprc': 0.9466529389420908, 'loss_val': 0.5887246390863509, 'psi': 0.884936449100421}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.854485 cos_to_last_merge=1.0000 (last merge round=61)
[S7] round=63 local utility u=0.926871 metrics={'f1_val': 0.6662117832680992, 'auprc': 0.8184974196436359, 'loss_val': 0.37217271181588496, 'psi': 0.7271260378183139}-{'f1_val': 0.49946560731571976, 'auprc': 0.7808702585036483, 'loss_val': 1.1125554692336488, 'psi': 0.6120274677908912}
[S8] START round=63 head_norm_before_train=1.867064 cos_to_last_merge=0.8781 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.878
[S8] round=63 local utility u=0.689723 metrics={'f1_val': 0.9098426445189635, 'auprc': 0.9958467716794719, 'loss_val': 0.12421854507601866, 'psi': 0.9442442953831668}-{'f1_val': 0.7143056369659406, 'auprc': 0.9952366125650352, 'loss_val': 0.3286113232974151, 'psi': 0.8266780272055785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=63 head_norm_before_train=2.038911 cos_to_last_merge=0.9799 (last merge round=21)
[S9] round=63 local utility u=0.018857 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988509241186997, 'loss_val': 0.01850907257455544, 'psi': 0.9975366767358147}-{'f1_val': 0.9920653202133933, 'auprc': 0.9992221295656865, 'loss_val': 0.029765917570893342, 'psi': 0.9949280439543107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=63 head_norm_before_train=1.817420 cos_to_last_merge=0.8973 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995511062565408, 'loss_val': 0.02574949156556816, 'psi': 0.9951853369452088}-{'f1_val': 0.9951878390193748, 'auprc': 0.995457278282062, 'loss_val': 0.026173729360092098, 'psi': 0.9952956147244496}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.886480 cos_to_last_merge=0.9390 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.991648388588299, 'auprc': 0.998839302863455, 'loss_val': 0.04741868710021717, 'psi': 0.9945247542983614}-{'f1_val': 0.9967460138064482, 'auprc': 0.9969329803941546, 'loss_val': 0.020113341642964966, 'psi': 0.9968208004415308}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.478666 cos_to_last_merge=0.8894 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=63 local utility u=0.135422 metrics={'f1_val': 0.5865841928510632, 'auprc': 0.6845710841569108, 'loss_val': 0.7667381203364675, 'psi': 0.6257789493734023}-{'f1_val': 0.5654114520516105, 'auprc': 0.6981081729448869, 'loss_val': 0.9511574254686045, 'psi': 0.618490140408921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=63 head_norm_before_train=1.861445 cos_to_last_merge=1.0000 (last merge round=61)
[S14] round=63 local utility u=0.112715 metrics={'f1_val': 0.9971856004327986, 'auprc': 0.9992291975347962, 'loss_val': 0.032428500697339574, 'psi': 0.9980030392735977}-{'f1_val': 0.963135083383778, 'auprc': 0.9988526415140868, 'loss_val': 0.05242507748517314, 'psi': 0.9774221066359016}
[S15] START round=63 head_norm_before_train=2.106012 cos_to_last_merge=0.9563 (last merge round=16)
[S15] round=63 local utility u=1.000000 metrics={'f1_val': 0.9686790306339246, 'auprc': 0.9940628553710502, 'loss_val': 0.05643859797152434, 'psi': 0.9788325605287749}-{'f1_val': 0.7009191843683342, 'auprc': 0.9871335686697957, 'loss_val': 0.5269292390872022, 'psi': 0.8154049380889188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=63 head_norm_before_train=1.851813 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9927306099290307, 'auprc': 0.9941593845761609, 'loss_val': 0.03210063720366295, 'psi': 0.9933021197878827}-{'f1_val': 0.9931436324833557, 'auprc': 0.9979689526285946, 'loss_val': 0.03231890548876697, 'psi': 0.9950737605414512}
[S17] START round=63 head_norm_before_train=2.063514 (no previous merge yet)
[S17] round=63 local utility u=0.053320 metrics={'f1_val': 0.6394440815365015, 'auprc': 0.9916257568480196, 'loss_val': 1.2480578952473005, 'psi': 0.7803167516611087}-{'f1_val': 0.6326775163568725, 'auprc': 0.9899794544713569, 'loss_val': 1.3091591473692497, 'psi': 0.7755982916026662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=63 metric=0.6662 head_norm=1.855001
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.155413e-02
[S7] stored merged vector for next round verification (round=63)
[S7] DEBUG after merge:  round=63 metric=0.6668 head_norm=1.862229 delta_norm=0.011554
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=63 metric=0.9972 head_norm=1.869500
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.155414e-02
[S14] stored merged vector for next round verification (round=63)
[S14] DEBUG after merge:  round=63 metric=0.9972 head_norm=1.862229 delta_norm=0.011554
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.859403 cos_to_last_merge=1.0000 (last merge round=62)
[S2] round=64 local utility u=0.069097 metrics={'f1_val': 0.8267442341193362, 'auprc': 0.9721657082153872, 'loss_val': 0.42240242949064244, 'psi': 0.8849128237577566}-{'f1_val': 0.8283882971096544, 'auprc': 0.9079647572129934, 'loss_val': 0.3778583178799749, 'psi': 0.86021888115099}
[S3] START round=64 head_norm_before_train=1.967034 cos_to_last_merge=0.9089 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=64 local utility u=0.000470 metrics={'f1_val': 0.8891783285766139, 'auprc': 0.997867310365185, 'loss_val': 0.2776534206718212, 'psi': 0.9326539212920424}-{'f1_val': 0.8890651069451792, 'auprc': 0.9978981875517327, 'loss_val': 0.278006197793435, 'psi': 0.9325983391878006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=64 head_norm_before_train=1.543615 cos_to_last_merge=0.8669 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=64 local utility u=0.001800 metrics={'f1_val': 0.9417238608751, 'auprc': 0.9577931010481865, 'loss_val': 0.28263861722502226, 'psi': 0.9481515569443346}-{'f1_val': 0.94209635704945, 'auprc': 0.9535354841611768, 'loss_val': 0.2757007752048694, 'psi': 0.9466720078941409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=64 head_norm_before_train=1.605756 cos_to_last_merge=0.8991 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=64 local utility u=0.774124 metrics={'f1_val': 0.8700266896233063, 'auprc': 0.9919927378127759, 'loss_val': 0.14388402887841098, 'psi': 0.9188131088990941}-{'f1_val': 0.7004069097142683, 'auprc': 0.9062649112168774, 'loss_val': 0.4172299390948853, 'psi': 0.782750110315312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=64 head_norm_before_train=2.115259 (no previous merge yet)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6895658875610212, 'auprc': 0.9033563893683141, 'loss_val': 0.895874257618255, 'psi': 0.7750820882839384}-{'f1_val': 0.8156340059005063, 'auprc': 0.9595887940084965, 'loss_val': 0.5041972213057283, 'psi': 0.8732159211437024}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.862229 cos_to_last_merge=1.0000 (last merge round=63)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5317023274383391, 'auprc': 0.7809527243320011, 'loss_val': 1.0144643079031623, 'psi': 0.631402486195804}-{'f1_val': 0.6662117832680992, 'auprc': 0.8184974196436359, 'loss_val': 0.37217271181588496, 'psi': 0.7271260378183139}
[S8] START round=64 head_norm_before_train=1.871071 cos_to_last_merge=0.8777 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.878
[S8] round=64 local utility u=0.298133 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9989643389276578, 'loss_val': 0.03342306796043247, 'psi': 0.9951031171654549}-{'f1_val': 0.9098426445189635, 'auprc': 0.9958467716794719, 'loss_val': 0.12421854507601866, 'psi': 0.9442442953831668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=64 head_norm_before_train=2.044749 cos_to_last_merge=0.9795 (last merge round=21)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988384281281067, 'loss_val': 0.018510817358867282, 'psi': 0.9975316783395776}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988509241186997, 'loss_val': 0.01850907257455544, 'psi': 0.9975366767358147}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.822624 cos_to_last_merge=0.8966 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954971308108224, 'loss_val': 0.025911489862125096, 'psi': 0.9951797642433746}-{'f1_val': 0.9949681865317428, 'auprc': 0.995511062565408, 'loss_val': 0.02574949156556816, 'psi': 0.9951853369452088}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.891405 cos_to_last_merge=0.9385 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.970161648342714, 'auprc': 0.996062504872538, 'loss_val': 0.13427266617181657, 'psi': 0.9805219909546435}-{'f1_val': 0.991648388588299, 'auprc': 0.998839302863455, 'loss_val': 0.04741868710021717, 'psi': 0.9945247542983614}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.482502 cos_to_last_merge=0.8886 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=64 local utility u=0.048671 metrics={'f1_val': 0.6102767352049283, 'auprc': 0.7042637689386804, 'loss_val': 0.8706299256834262, 'psi': 0.6478715486984291}-{'f1_val': 0.5865841928510632, 'auprc': 0.6845710841569108, 'loss_val': 0.7667381203364675, 'psi': 0.6257789493734023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=64 head_norm_before_train=1.862229 cos_to_last_merge=1.0000 (last merge round=63)
[S14] round=64 local utility u=0.006146 metrics={'f1_val': 0.9975795452795295, 'auprc': 0.9992277539965104, 'loss_val': 0.022495633998385493, 'psi': 0.9982388287663219}-{'f1_val': 0.9971856004327986, 'auprc': 0.9992291975347962, 'loss_val': 0.032428500697339574, 'psi': 0.9980030392735977}
[S15] START round=64 head_norm_before_train=2.111905 cos_to_last_merge=0.9559 (last merge round=16)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.934622979928375, 'auprc': 0.9921260070919025, 'loss_val': 0.0811119847682467, 'psi': 0.9576241907937859}-{'f1_val': 0.9686790306339246, 'auprc': 0.9940628553710502, 'loss_val': 0.05643859797152434, 'psi': 0.9788325605287749}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.856057 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.8551974298748674, 'auprc': 0.8788717320458468, 'loss_val': 0.9696475756322526, 'psi': 0.8646671507432591}-{'f1_val': 0.9927306099290307, 'auprc': 0.9941593845761609, 'loss_val': 0.03210063720366295, 'psi': 0.9933021197878827}
[S17] START round=64 head_norm_before_train=2.068735 (no previous merge yet)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6415499409218691, 'auprc': 0.9777999375449064, 'loss_val': 1.2411635220016293, 'psi': 0.776049939571084}-{'f1_val': 0.6394440815365015, 'auprc': 0.9916257568480196, 'loss_val': 1.2480578952473005, 'psi': 0.7803167516611087}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=64 metric=0.8552 head_norm=1.858152
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.311771e-03
[S16] stored merged vector for next round verification (round=64)
[S16] DEBUG after merge:  round=64 metric=0.8552 head_norm=1.858754 delta_norm=0.009312
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=1.0000
[S2] START round=65 head_norm_before_train=1.866572 cos_to_last_merge=1.0000 (last merge round=62)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.83065608937382, 'auprc': 0.925915321414322, 'loss_val': 0.367688573928623, 'psi': 0.8687597821900208}-{'f1_val': 0.8267442341193362, 'auprc': 0.9721657082153872, 'loss_val': 0.42240242949064244, 'psi': 0.8849128237577566}
[S3] START round=65 head_norm_before_train=1.972376 cos_to_last_merge=0.9085 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=65 local utility u=0.113856 metrics={'f1_val': 0.9067857524893322, 'auprc': 0.9964867577948715, 'loss_val': 0.1514451805066837, 'psi': 0.942666154611548}-{'f1_val': 0.8891783285766139, 'auprc': 0.997867310365185, 'loss_val': 0.2776534206718212, 'psi': 0.9326539212920424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=65 head_norm_before_train=1.552465 cos_to_last_merge=0.8658 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.866
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9403936528889892, 'auprc': 0.9451520998104317, 'loss_val': 0.28539154035342257, 'psi': 0.9422970316575663}-{'f1_val': 0.9417238608751, 'auprc': 0.9577931010481865, 'loss_val': 0.28263861722502226, 'psi': 0.9481515569443346}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.608935 cos_to_last_merge=0.8985 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.898
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.6438662516715443, 'auprc': 0.8557776701290857, 'loss_val': 0.5130579818661909, 'psi': 0.728630819054561}-{'f1_val': 0.8700266896233063, 'auprc': 0.9919927378127759, 'loss_val': 0.14388402887841098, 'psi': 0.9188131088990941}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.122667 (no previous merge yet)
[S6] round=65 local utility u=0.639756 metrics={'f1_val': 0.8228556339607168, 'auprc': 0.9149734928289684, 'loss_val': 0.4509528456378898, 'psi': 0.8597027775080175}-{'f1_val': 0.6895658875610212, 'auprc': 0.9033563893683141, 'loss_val': 0.895874257618255, 'psi': 0.7750820882839384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=65 head_norm_before_train=1.863497 cos_to_last_merge=1.0000 (last merge round=63)
[S7] round=65 local utility u=0.704275 metrics={'f1_val': 0.6530266109086895, 'auprc': 0.8085582622821302, 'loss_val': 0.4166762423620861, 'psi': 0.7152392714580658}-{'f1_val': 0.5317023274383391, 'auprc': 0.7809527243320011, 'loss_val': 1.0144643079031623, 'psi': 0.631402486195804}
[S8] START round=65 head_norm_before_train=1.876583 cos_to_last_merge=0.8770 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.877
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9963938811380696, 'loss_val': 0.03341126723811829, 'psi': 0.9947327547239257}-{'f1_val': 0.9925289693239863, 'auprc': 0.9989643389276578, 'loss_val': 0.03342306796043247, 'psi': 0.9951031171654549}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=2.051183 cos_to_last_merge=0.9792 (last merge round=21)
[S9] round=65 local utility u=0.000052 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988369542320924, 'loss_val': 0.018402841748736926, 'psi': 0.9975310887811718}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988384281281067, 'loss_val': 0.018510817358867282, 'psi': 0.9975316783395776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=65 head_norm_before_train=1.828768 cos_to_last_merge=0.8959 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=65 local utility u=0.000073 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955135533305535, 'loss_val': 0.02581567691848912, 'psi': 0.9951863332512672}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954971308108224, 'loss_val': 0.025911489862125096, 'psi': 0.9951797642433746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=65 head_norm_before_train=1.897146 cos_to_last_merge=0.9380 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=65 local utility u=0.143433 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9988754120714849, 'loss_val': 0.017832263256785875, 'psi': 0.9978457766879794}-{'f1_val': 0.970161648342714, 'auprc': 0.996062504872538, 'loss_val': 0.13427266617181657, 'psi': 0.9805219909546435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=65 head_norm_before_train=1.486079 cos_to_last_merge=0.8880 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.5926017919843323, 'auprc': 0.7082784195942895, 'loss_val': 0.8705477213562627, 'psi': 0.6388724430283153}-{'f1_val': 0.6102767352049283, 'auprc': 0.7042637689386804, 'loss_val': 0.8706299256834262, 'psi': 0.6478715486984291}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.868634 cos_to_last_merge=1.0000 (last merge round=63)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9988549206166519, 'loss_val': 0.021824436669817763, 'psi': 0.9979754433723991}-{'f1_val': 0.9975795452795295, 'auprc': 0.9992277539965104, 'loss_val': 0.022495633998385493, 'psi': 0.9982388287663219}
[S15] START round=65 head_norm_before_train=2.119225 cos_to_last_merge=0.9554 (last merge round=16)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.8280296575811806, 'auprc': 0.9902045146894032, 'loss_val': 0.27387761140243555, 'psi': 0.8928996004244696}-{'f1_val': 0.934622979928375, 'auprc': 0.9921260070919025, 'loss_val': 0.0811119847682467, 'psi': 0.9576241907937859}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.858754 cos_to_last_merge=1.0000 (last merge round=64)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8502245549743601, 'auprc': 0.8934569349449564, 'loss_val': 1.00597777266593, 'psi': 0.8675175069625987}-{'f1_val': 0.8551974298748674, 'auprc': 0.8788717320458468, 'loss_val': 0.9696475756322526, 'psi': 0.8646671507432591}
[S17] START round=65 head_norm_before_train=2.077017 (no previous merge yet)
[S17] round=65 local utility u=0.241900 metrics={'f1_val': 0.6756856720096192, 'auprc': 0.9730470376889786, 'loss_val': 0.9479188961204379, 'psi': 0.7946302182813629}-{'f1_val': 0.6415499409218691, 'auprc': 0.9777999375449064, 'loss_val': 1.2411635220016293, 'psi': 0.776049939571084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.065 → S16@127.0.0.1:61816
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] ⇄ pheromone p=0.020 → S7@127.0.0.1:61808
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=65 metric=0.8502 head_norm=1.862855
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.062127e-02
[S16] stored merged vector for next round verification (round=65)
[S16] DEBUG after merge:  round=65 metric=0.8502 head_norm=1.864684 delta_norm=0.010621
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.063 → S2@127.0.0.1:61802
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=65 metric=0.6530 head_norm=1.865378
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.366118e-03
[S7] stored merged vector for next round verification (round=65)
[S7] DEBUG after merge:  round=65 metric=0.6532 head_norm=1.866992 delta_norm=0.007366
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.367 → S14@127.0.0.1:61814
[S2] START round=66 head_norm_before_train=1.871858 cos_to_last_merge=0.9999 (last merge round=62)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9261107232319016, 'loss_val': 0.3774070462834823, 'psi': 0.8688379429170525}-{'f1_val': 0.83065608937382, 'auprc': 0.925915321414322, 'loss_val': 0.367688573928623, 'psi': 0.8687597821900208}
[S3] START round=66 head_norm_before_train=1.976281 cos_to_last_merge=0.9084 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=66 local utility u=0.218888 metrics={'f1_val': 0.9661342924476833, 'auprc': 0.9979818455496893, 'loss_val': 0.07424666349342657, 'psi': 0.9788733136884857}-{'f1_val': 0.9067857524893322, 'auprc': 0.9964867577948715, 'loss_val': 0.1514451805066837, 'psi': 0.942666154611548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=66 head_norm_before_train=1.563744 cos_to_last_merge=0.8645 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9320848627026201, 'auprc': 0.9326717860756748, 'loss_val': 0.34933760704451944, 'psi': 0.9323196320518421}-{'f1_val': 0.9403936528889892, 'auprc': 0.9451520998104317, 'loss_val': 0.28539154035342257, 'psi': 0.9422970316575663}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.612720 cos_to_last_merge=0.8980 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.898
[S5] round=66 local utility u=0.648698 metrics={'f1_val': 0.7406880491994292, 'auprc': 0.9912707382404278, 'loss_val': 0.20307100606448839, 'psi': 0.8409211248158286}-{'f1_val': 0.6438662516715443, 'auprc': 0.8557776701290857, 'loss_val': 0.5130579818661909, 'psi': 0.728630819054561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=66 head_norm_before_train=2.129463 (no previous merge yet)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.735778106856435, 'auprc': 0.8893331346045903, 'loss_val': 0.8143435912030993, 'psi': 0.7972001179556971}-{'f1_val': 0.8228556339607168, 'auprc': 0.9149734928289684, 'loss_val': 0.4509528456378898, 'psi': 0.8597027775080175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.866992 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6177898367052269, 'auprc': 0.795293413403494, 'loss_val': 0.5873135021724343, 'psi': 0.6887912673845338}-{'f1_val': 0.6530266109086895, 'auprc': 0.8085582622821302, 'loss_val': 0.4166762423620861, 'psi': 0.7152392714580658}
[S8] START round=66 head_norm_before_train=1.882457 cos_to_last_merge=0.8764 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.876
[S8] round=66 local utility u=0.003539 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9991412742905399, 'loss_val': 0.031052773763474324, 'psi': 0.9954794304672154}-{'f1_val': 0.9936253371144965, 'auprc': 0.9963938811380696, 'loss_val': 0.03341126723811829, 'psi': 0.9947327547239257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=66 head_norm_before_train=2.057654 cos_to_last_merge=0.9788 (last merge round=21)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9988541803309177, 'loss_val': 0.02932575813194121, 'psi': 0.994780864260403}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988369542320924, 'loss_val': 0.018402841748736926, 'psi': 0.9975310887811718}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=1.831202 cos_to_last_merge=0.8951 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.895
[S10] round=66 local utility u=0.000705 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959046320582234, 'loss_val': 0.025579278383610023, 'psi': 0.9953427647423351}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955135533305535, 'loss_val': 0.02581567691848912, 'psi': 0.9951863332512672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=66 head_norm_before_train=1.902537 cos_to_last_merge=0.9375 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984195161985067, 'loss_val': 0.017920922778978048, 'psi': 0.9974012582283118}-{'f1_val': 0.9971593530989756, 'auprc': 0.9988754120714849, 'loss_val': 0.017832263256785875, 'psi': 0.9978457766879794}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.492495 cos_to_last_merge=0.8870 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=66 local utility u=0.040901 metrics={'f1_val': 0.5900730358745144, 'auprc': 0.719780291542376, 'loss_val': 0.8080797601818709, 'psi': 0.6419559381416591}-{'f1_val': 0.5926017919843323, 'auprc': 0.7082784195942895, 'loss_val': 0.8705477213562627, 'psi': 0.6388724430283153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=66 head_norm_before_train=1.878164 cos_to_last_merge=0.9999 (last merge round=63)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9810396865714109, 'auprc': 0.9992207048468212, 'loss_val': 0.040783925008464075, 'psi': 0.988312093881575}-{'f1_val': 0.9973891252095638, 'auprc': 0.9988549206166519, 'loss_val': 0.021824436669817763, 'psi': 0.9979754433723991}
[S15] START round=66 head_norm_before_train=2.126982 cos_to_last_merge=0.9549 (last merge round=16)
[S15] round=66 local utility u=0.629678 metrics={'f1_val': 0.994374142940229, 'auprc': 0.995966363845932, 'loss_val': 0.029873230550756278, 'psi': 0.9950110313025102}-{'f1_val': 0.8280296575811806, 'auprc': 0.9902045146894032, 'loss_val': 0.27387761140243555, 'psi': 0.8928996004244696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=66 head_norm_before_train=1.864684 cos_to_last_merge=1.0000 (last merge round=65)
[S16] round=66 local utility u=0.467911 metrics={'f1_val': 0.8850129877873321, 'auprc': 0.9915948988958343, 'loss_val': 0.5732996497734011, 'psi': 0.9276457522307329}-{'f1_val': 0.8502245549743601, 'auprc': 0.8934569349449564, 'loss_val': 1.00597777266593, 'psi': 0.8675175069625987}
[S17] START round=66 head_norm_before_train=2.087700 (no previous merge yet)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.664392248413999, 'auprc': 0.9555066528474427, 'loss_val': 1.1414573753630957, 'psi': 0.7808380101873765}-{'f1_val': 0.6756856720096192, 'auprc': 0.9730470376889786, 'loss_val': 0.9479188961204379, 'psi': 0.7946302182813629}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=66 metric=0.9810 head_norm=1.885172
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.493861e-02
[S14] stored merged vector for next round verification (round=66)
[S14] DEBUG after merge:  round=66 metric=0.9806 head_norm=1.875242 delta_norm=0.014939
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9999
[S2] START round=67 head_norm_before_train=1.876201 cos_to_last_merge=0.9998 (last merge round=62)
[S2] round=67 local utility u=0.086239 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9888462507718214, 'loss_val': 0.3930789452612794, 'psi': 0.8939265377244278}-{'f1_val': 0.83065608937382, 'auprc': 0.9261107232319016, 'loss_val': 0.3774070462834823, 'psi': 0.8688379429170525}
[S3] START round=67 head_norm_before_train=1.973534 cos_to_last_merge=0.9097 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.7018019993546892, 'auprc': 0.9204224416670337, 'loss_val': 0.48839177177417703, 'psi': 0.789250176279627}-{'f1_val': 0.9661342924476833, 'auprc': 0.9979818455496893, 'loss_val': 0.07424666349342657, 'psi': 0.9788733136884857}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.573587 cos_to_last_merge=0.8633 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.863
[S4] round=67 local utility u=0.007446 metrics={'f1_val': 0.932470600436625, 'auprc': 0.9331505728641692, 'loss_val': 0.3381957740580397, 'psi': 0.9327425894076427}-{'f1_val': 0.9320848627026201, 'auprc': 0.9326717860756748, 'loss_val': 0.34933760704451944, 'psi': 0.9323196320518421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=67 head_norm_before_train=1.616220 cos_to_last_merge=0.8974 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.897
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.44403517404098014, 'auprc': 0.8555523913936962, 'loss_val': 0.7961024017457444, 'psi': 0.6086420609820666}-{'f1_val': 0.7406880491994292, 'auprc': 0.9912707382404278, 'loss_val': 0.20307100606448839, 'psi': 0.8409211248158286}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.136088 (no previous merge yet)
[S6] round=67 local utility u=0.053347 metrics={'f1_val': 0.7208311938270493, 'auprc': 0.9134512058649745, 'loss_val': 0.6903225974274968, 'psi': 0.7978791986422193}-{'f1_val': 0.735778106856435, 'auprc': 0.8893331346045903, 'loss_val': 0.8143435912030993, 'psi': 0.7972001179556971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=67 head_norm_before_train=1.870271 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6062203772418249, 'auprc': 0.7945089246847898, 'loss_val': 0.7615501143355242, 'psi': 0.6815357962190108}-{'f1_val': 0.6177898367052269, 'auprc': 0.795293413403494, 'loss_val': 0.5873135021724343, 'psi': 0.6887912673845338}
[S8] START round=67 head_norm_before_train=1.890219 cos_to_last_merge=0.8754 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.875
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9806257905912587, 'auprc': 0.9989682654188667, 'loss_val': 0.042861121253227816, 'psi': 0.9879627805223019}-{'f1_val': 0.9930382012516658, 'auprc': 0.9991412742905399, 'loss_val': 0.031052773763474324, 'psi': 0.9954794304672154}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.061388 cos_to_last_merge=0.9785 (last merge round=21)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9988274055484905, 'loss_val': 0.04762879667458481, 'psi': 0.99222383299769}-{'f1_val': 0.9920653202133933, 'auprc': 0.9988541803309177, 'loss_val': 0.02932575813194121, 'psi': 0.994780864260403}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.835813 cos_to_last_merge=0.8944 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.894
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955071446081288, 'loss_val': 0.025860311173257083, 'psi': 0.9953155612548763}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959046320582234, 'loss_val': 0.025579278383610023, 'psi': 0.9953427647423351}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=1.908671 cos_to_last_merge=0.9369 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984154545303995, 'loss_val': 0.017958883599639073, 'psi': 0.9973996335610691}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984195161985067, 'loss_val': 0.017920922778978048, 'psi': 0.9974012582283118}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.500988 cos_to_last_merge=0.8856 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.5881731972345421, 'auprc': 0.7093568083440457, 'loss_val': 0.9345837948599887, 'psi': 0.6366466416783436}-{'f1_val': 0.5900730358745144, 'auprc': 0.719780291542376, 'loss_val': 0.8080797601818709, 'psi': 0.6419559381416591}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.875242 cos_to_last_merge=1.0000 (last merge round=66)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9381097860544914, 'auprc': 0.9971573406497063, 'loss_val': 0.0817773761313406, 'psi': 0.9617288078925773}-{'f1_val': 0.9810396865714109, 'auprc': 0.9992207048468212, 'loss_val': 0.040783925008464075, 'psi': 0.988312093881575}
[S15] START round=67 head_norm_before_train=2.134948 cos_to_last_merge=0.9542 (last merge round=16)
[S15] round=67 local utility u=0.008721 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9948459844922859, 'loss_val': 0.023304384350195804, 'psi': 0.9959863948294267}-{'f1_val': 0.994374142940229, 'auprc': 0.995966363845932, 'loss_val': 0.029873230550756278, 'psi': 0.9950110313025102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=67 head_norm_before_train=1.870813 cos_to_last_merge=1.0000 (last merge round=65)
[S16] round=67 local utility u=0.266216 metrics={'f1_val': 0.9339429174050589, 'auprc': 0.9944707261097486, 'loss_val': 0.34307381177852286, 'psi': 0.9581540408869347}-{'f1_val': 0.8850129877873321, 'auprc': 0.9915948988958343, 'loss_val': 0.5732996497734011, 'psi': 0.9276457522307329}
[S17] START round=67 head_norm_before_train=2.098202 (no previous merge yet)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6314189657345173, 'auprc': 0.9655506191538714, 'loss_val': 1.4128909114624177, 'psi': 0.765071627102259}-{'f1_val': 0.664392248413999, 'auprc': 0.9555066528474427, 'loss_val': 1.1414573753630957, 'psi': 0.7808380101873765}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.9997
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=67 metric=0.8306 head_norm=1.881922
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.041224e-02
[S2] stored merged vector for next round verification (round=67)
[S2] DEBUG after merge:  round=67 metric=0.8306 head_norm=1.878035 delta_norm=0.020412
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=67 metric=0.9339 head_norm=1.877916
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.118048e-02
[S16] stored merged vector for next round verification (round=67)
[S16] DEBUG after merge:  round=67 metric=0.9337 head_norm=1.879801 delta_norm=0.021180
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=1.878035 cos_to_last_merge=1.0000 (last merge round=67)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.8283121732527882, 'auprc': 0.9876343215509533, 'loss_val': 0.411718119741535, 'psi': 0.8920410325720542}-{'f1_val': 0.8306467290261653, 'auprc': 0.9888462507718214, 'loss_val': 0.3930789452612794, 'psi': 0.8939265377244278}
[S3] START round=68 head_norm_before_train=1.973817 cos_to_last_merge=0.9103 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=68 local utility u=1.000000 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9973197741614604, 'loss_val': 0.01791334732341434, 'psi': 0.9973497282596364}-{'f1_val': 0.7018019993546892, 'auprc': 0.9204224416670337, 'loss_val': 0.48839177177417703, 'psi': 0.789250176279627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=68 head_norm_before_train=1.583140 cos_to_last_merge=0.8620 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.862
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9309847718765899, 'auprc': 0.9301791648871894, 'loss_val': 0.33984078952466124, 'psi': 0.9306625290808297}-{'f1_val': 0.932470600436625, 'auprc': 0.9331505728641692, 'loss_val': 0.3381957740580397, 'psi': 0.9327425894076427}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.620376 cos_to_last_merge=0.8967 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.897
[S5] round=68 local utility u=1.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9662141443288674, 'loss_val': 0.35845542701608263, 'psi': 0.8067819773972208}-{'f1_val': 0.44403517404098014, 'auprc': 0.8555523913936962, 'loss_val': 0.7961024017457444, 'psi': 0.6086420609820666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=68 head_norm_before_train=2.144450 (no previous merge yet)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7036878026073706, 'auprc': 0.8985543475280829, 'loss_val': 0.8354247026922099, 'psi': 0.7816344205756556}-{'f1_val': 0.7208311938270493, 'auprc': 0.9134512058649745, 'loss_val': 0.6903225974274968, 'psi': 0.7978791986422193}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.874927 cos_to_last_merge=0.9999 (last merge round=65)
[S7] round=68 local utility u=0.203785 metrics={'f1_val': 0.6434755339042191, 'auprc': 0.8007970096126911, 'loss_val': 0.5963761531157803, 'psi': 0.7064041241876079}-{'f1_val': 0.6062203772418249, 'auprc': 0.7945089246847898, 'loss_val': 0.7615501143355242, 'psi': 0.6815357962190108}
[S8] START round=68 head_norm_before_train=1.899680 cos_to_last_merge=0.8741 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.874
[S8] round=68 local utility u=0.040198 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9981161354484298, 'loss_val': 0.03351779714732039, 'psi': 0.9949827776583411}-{'f1_val': 0.9806257905912587, 'auprc': 0.9989682654188667, 'loss_val': 0.042861121253227816, 'psi': 0.9879627805223019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=68 head_norm_before_train=2.062451 cos_to_last_merge=0.9782 (last merge round=21)
[S9] round=68 local utility u=0.035246 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9961755990850191, 'loss_val': 0.019752523853452515, 'psi': 0.9962202965015742}-{'f1_val': 0.9878214512971564, 'auprc': 0.9988274055484905, 'loss_val': 0.04762879667458481, 'psi': 0.99222383299769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=68 head_norm_before_train=1.841402 cos_to_last_merge=0.8937 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.894
[S10] round=68 local utility u=0.000263 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956493990889913, 'loss_val': 0.025760861937582716, 'psi': 0.9953724630472214}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955071446081288, 'loss_val': 0.025860311173257083, 'psi': 0.9953155612548763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=68 head_norm_before_train=1.915139 cos_to_last_merge=0.9364 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=68 local utility u=0.001037 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988206964155194, 'loss_val': 0.017101568106696937, 'psi': 0.997561730315117}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984154545303995, 'loss_val': 0.017958883599639073, 'psi': 0.9973996335610691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=68 head_norm_before_train=1.508762 cos_to_last_merge=0.8840 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=68 local utility u=0.136274 metrics={'f1_val': 0.6161446104094094, 'auprc': 0.6972988325027981, 'loss_val': 0.7936897485559768, 'psi': 0.6486062992467649}-{'f1_val': 0.5881731972345421, 'auprc': 0.7093568083440457, 'loss_val': 0.9345837948599887, 'psi': 0.6366466416783436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=68 head_norm_before_train=1.882052 cos_to_last_merge=1.0000 (last merge round=66)
[S14] round=68 local utility u=0.010600 metrics={'f1_val': 0.9394110453195528, 'auprc': 0.999229977583344, 'loss_val': 0.07460217504173257, 'psi': 0.9633386182250693}-{'f1_val': 0.9381097860544914, 'auprc': 0.9971573406497063, 'loss_val': 0.0817773761313406, 'psi': 0.9617288078925773}
[S15] START round=68 head_norm_before_train=2.143222 cos_to_last_merge=0.9537 (last merge round=16)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9391527446139938, 'auprc': 0.9912366556138282, 'loss_val': 0.0756088946465631, 'psi': 0.9599863090139276}-{'f1_val': 0.9967466683875206, 'auprc': 0.9948459844922859, 'loss_val': 0.023304384350195804, 'psi': 0.9959863948294267}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.879801 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.9349258273209731, 'auprc': 0.9931286468469787, 'loss_val': 0.3451701674517742, 'psi': 0.9582069551313752}-{'f1_val': 0.9339429174050589, 'auprc': 0.9944707261097486, 'loss_val': 0.34307381177852286, 'psi': 0.9581540408869347}
[S17] START round=68 head_norm_before_train=2.107506 (no previous merge yet)
[S17] round=68 local utility u=0.070573 metrics={'f1_val': 0.6373240113161047, 'auprc': 0.9786473233468047, 'loss_val': 1.3464654192659913, 'psi': 0.7738533361283847}-{'f1_val': 0.6314189657345173, 'auprc': 0.9655506191538714, 'loss_val': 1.4128909114624177, 'psi': 0.765071627102259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=68 metric=0.6435 head_norm=1.878835
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.745064e-02
[S7] stored merged vector for next round verification (round=68)
[S7] DEBUG after merge:  round=68 metric=0.6443 head_norm=1.884959 delta_norm=0.017451
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=68 metric=0.9394 head_norm=1.891224
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.745064e-02
[S14] stored merged vector for next round verification (round=68)
[S14] DEBUG after merge:  round=68 metric=0.9394 head_norm=1.884959 delta_norm=0.017451
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=1.884309 cos_to_last_merge=1.0000 (last merge round=67)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.8918452238370347, 'loss_val': 0.38775721689054404, 'psi': 0.855126126950513}-{'f1_val': 0.8283121732527882, 'auprc': 0.9876343215509533, 'loss_val': 0.411718119741535, 'psi': 0.8920410325720542}
[S3] START round=69 head_norm_before_train=1.972232 cos_to_last_merge=0.9110 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=69 local utility u=0.002508 metrics={'f1_val': 0.9972129922395685, 'auprc': 0.9987519597840558, 'loss_val': 0.016252844474043585, 'psi': 0.9978285792573633}-{'f1_val': 0.9973696976584205, 'auprc': 0.9973197741614604, 'loss_val': 0.01791334732341434, 'psi': 0.9973497282596364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=69 head_norm_before_train=1.586498 cos_to_last_merge=0.8611 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.861
[S4] round=69 local utility u=0.008368 metrics={'f1_val': 0.9309578140280259, 'auprc': 0.9303731410525483, 'loss_val': 0.3235259568869816, 'psi': 0.9307239448378349}-{'f1_val': 0.9309847718765899, 'auprc': 0.9301791648871894, 'loss_val': 0.33984078952466124, 'psi': 0.9306625290808297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=69 head_norm_before_train=1.625125 cos_to_last_merge=0.8959 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.896
[S5] round=69 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9945844776273112, 'loss_val': 0.10387413563132061, 'psi': 0.995431559614619}-{'f1_val': 0.7004938661094564, 'auprc': 0.9662141443288674, 'loss_val': 0.35845542701608263, 'psi': 0.8067819773972208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=69 head_norm_before_train=2.154983 (no previous merge yet)
[S6] round=69 local utility u=0.887108 metrics={'f1_val': 0.8820563129187735, 'auprc': 0.9688669796046149, 'loss_val': 0.342358141687747, 'psi': 0.9167805795931101}-{'f1_val': 0.7036878026073706, 'auprc': 0.8985543475280829, 'loss_val': 0.8354247026922099, 'psi': 0.7816344205756556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=69 head_norm_before_train=1.884959 cos_to_last_merge=1.0000 (last merge round=68)
[S7] round=69 local utility u=0.152307 metrics={'f1_val': 0.6610388299428229, 'auprc': 0.8098682470072742, 'loss_val': 0.42435647879447824, 'psi': 0.7205705967686035}-{'f1_val': 0.6434755339042191, 'auprc': 0.8007970096126911, 'loss_val': 0.5963761531157803, 'psi': 0.7064041241876079}
[S8] START round=69 head_norm_before_train=1.908358 cos_to_last_merge=0.8731 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.873
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.864094435016275, 'auprc': 0.9393754337291552, 'loss_val': 0.23368145259568396, 'psi': 0.8942068345014271}-{'f1_val': 0.9928938724649488, 'auprc': 0.9981161354484298, 'loss_val': 0.03351779714732039, 'psi': 0.9949827776583411}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.064981 cos_to_last_merge=0.9779 (last merge round=21)
[S9] round=69 local utility u=0.005843 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988506754392024, 'loss_val': 0.01855499552470686, 'psi': 0.9975365772640158}-{'f1_val': 0.9962500947792776, 'auprc': 0.9961755990850191, 'loss_val': 0.019752523853452515, 'psi': 0.9962202965015742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=69 head_norm_before_train=1.847440 cos_to_last_merge=0.8931 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959047847160852, 'loss_val': 0.025459395119318676, 'psi': 0.9953428258054797}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956493990889913, 'loss_val': 0.025760861937582716, 'psi': 0.9953724630472214}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.920774 cos_to_last_merge=0.9359 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.989983159623077, 'auprc': 0.9985829918798322, 'loss_val': 0.054367866416157144, 'psi': 0.9934230925257791}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988206964155194, 'loss_val': 0.017101568106696937, 'psi': 0.997561730315117}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.517556 cos_to_last_merge=0.8821 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6027439479647294, 'auprc': 0.7186710463842709, 'loss_val': 0.9379042757189175, 'psi': 0.649114787332546}-{'f1_val': 0.6161446104094094, 'auprc': 0.6972988325027981, 'loss_val': 0.7936897485559768, 'psi': 0.6486062992467649}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=1.884959 cos_to_last_merge=1.0000 (last merge round=68)
[S14] round=69 local utility u=0.200324 metrics={'f1_val': 0.9973592763401687, 'auprc': 0.9992286911569987, 'loss_val': 0.021639825303085954, 'psi': 0.9981070422669007}-{'f1_val': 0.9394110453195528, 'auprc': 0.999229977583344, 'loss_val': 0.07460217504173257, 'psi': 0.9633386182250693}
[S15] START round=69 head_norm_before_train=2.151938 cos_to_last_merge=0.9531 (last merge round=16)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.8988974771758912, 'auprc': 0.9912206445995686, 'loss_val': 0.16398113044307122, 'psi': 0.9358267441453622}-{'f1_val': 0.9391527446139938, 'auprc': 0.9912366556138282, 'loss_val': 0.0756088946465631, 'psi': 0.9599863090139276}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.887226 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9326346915653719, 'auprc': 0.9911225019682649, 'loss_val': 0.370578322205649, 'psi': 0.9560298157265292}-{'f1_val': 0.9349258273209731, 'auprc': 0.9931286468469787, 'loss_val': 0.3451701674517742, 'psi': 0.9582069551313752}
[S17] START round=69 head_norm_before_train=2.113662 (no previous merge yet)
[S17] round=69 local utility u=0.663547 metrics={'f1_val': 0.7604955639446022, 'auprc': 0.9879745369933407, 'loss_val': 0.7863821969988803, 'psi': 0.8514871531640975}-{'f1_val': 0.6373240113161047, 'auprc': 0.9786473233468047, 'loss_val': 1.3464654192659913, 'psi': 0.7738533361283847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S7] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=69 metric=0.6610 head_norm=1.887258
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.294112e-03
[S7] stored merged vector for next round verification (round=69)
[S7] DEBUG after merge:  round=69 metric=0.6617 head_norm=1.890503 delta_norm=0.005294
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=69 metric=0.9974 head_norm=1.893758
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.294112e-03
[S14] stored merged vector for next round verification (round=69)
[S14] DEBUG after merge:  round=69 metric=0.9974 head_norm=1.890503 delta_norm=0.005294
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.892261 cos_to_last_merge=1.0000 (last merge round=67)
[S2] round=70 local utility u=0.126882 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.985002364396665, 'loss_val': 0.41346396310174033, 'psi': 0.8923889831743652}-{'f1_val': 0.8306467290261653, 'auprc': 0.8918452238370347, 'loss_val': 0.38775721689054404, 'psi': 0.855126126950513}
[S3] START round=70 head_norm_before_train=1.975172 cos_to_last_merge=0.9109 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.961289870742017, 'auprc': 0.9980932492303182, 'loss_val': 0.0833393725004829, 'psi': 0.9760112221373375}-{'f1_val': 0.9972129922395685, 'auprc': 0.9987519597840558, 'loss_val': 0.016252844474043585, 'psi': 0.9978285792573633}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.593026 cos_to_last_merge=0.8601 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.860
[S4] round=70 local utility u=0.055520 metrics={'f1_val': 0.9351298186961191, 'auprc': 0.9532532550131287, 'loss_val': 0.30615822123365677, 'psi': 0.9423791932229231}-{'f1_val': 0.9309578140280259, 'auprc': 0.9303731410525483, 'loss_val': 0.3235259568869816, 'psi': 0.9307239448378349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=70 head_norm_before_train=1.629233 cos_to_last_merge=0.8952 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.895
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.8330130286432372, 'auprc': 0.9699472041681261, 'loss_val': 0.24228911058198607, 'psi': 0.8877866988531928}-{'f1_val': 0.995996280939491, 'auprc': 0.9945844776273112, 'loss_val': 0.10387413563132061, 'psi': 0.995431559614619}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.161947 (no previous merge yet)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.7442135825364977, 'auprc': 0.9316778011377684, 'loss_val': 0.7743422394115863, 'psi': 0.8191992699770061}-{'f1_val': 0.8820563129187735, 'auprc': 0.9688669796046149, 'loss_val': 0.342358141687747, 'psi': 0.9167805795931101}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.890503 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6280405492671032, 'auprc': 0.7996472405569628, 'loss_val': 0.5445745060476466, 'psi': 0.6966832257830471}-{'f1_val': 0.6610388299428229, 'auprc': 0.8098682470072742, 'loss_val': 0.42435647879447824, 'psi': 0.7205705967686035}
[S8] START round=70 head_norm_before_train=1.915384 cos_to_last_merge=0.8723 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.872
[S8] round=70 local utility u=0.572093 metrics={'f1_val': 0.993235056744646, 'auprc': 0.997902207638004, 'loss_val': 0.03991857271801539, 'psi': 0.9951019171019891}-{'f1_val': 0.864094435016275, 'auprc': 0.9393754337291552, 'loss_val': 0.23368145259568396, 'psi': 0.8942068345014271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=70 head_norm_before_train=2.066456 cos_to_last_merge=0.9778 (last merge round=21)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9996118686195623, 'loss_val': 0.04384795603664174, 'psi': 0.9931718870418738}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988506754392024, 'loss_val': 0.01855499552470686, 'psi': 0.9975365772640158}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=1.849691 cos_to_last_merge=0.8924 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959044766729288, 'loss_val': 0.025500253621156946, 'psi': 0.9953427025882172}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959047847160852, 'loss_val': 0.025459395119318676, 'psi': 0.9953428258054797}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=1.926242 cos_to_last_merge=0.9355 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=70 local utility u=0.038289 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984134654133162, 'loss_val': 0.017717539605940243, 'psi': 0.9973988379142358}-{'f1_val': 0.989983159623077, 'auprc': 0.9985829918798322, 'loss_val': 0.054367866416157144, 'psi': 0.9934230925257791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=70 head_norm_before_train=1.524168 cos_to_last_merge=0.8809 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.5803826450246772, 'auprc': 0.7243123643185492, 'loss_val': 1.0390576874283128, 'psi': 0.637954532742226}-{'f1_val': 0.6027439479647294, 'auprc': 0.7186710463842709, 'loss_val': 0.9379042757189175, 'psi': 0.649114787332546}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.890503 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9975773038923221, 'auprc': 0.99923055646626, 'loss_val': 0.028057689693763783, 'psi': 0.9982386049218973}-{'f1_val': 0.9973592763401687, 'auprc': 0.9992286911569987, 'loss_val': 0.021639825303085954, 'psi': 0.9981070422669007}
[S15] START round=70 head_norm_before_train=2.160714 cos_to_last_merge=0.9525 (last merge round=16)
[S15] round=70 local utility u=0.143924 metrics={'f1_val': 0.9328677424515739, 'auprc': 0.9926490878546417, 'loss_val': 0.08424049507340463, 'psi': 0.9567802806128011}-{'f1_val': 0.8988974771758912, 'auprc': 0.9912206445995686, 'loss_val': 0.16398113044307122, 'psi': 0.9358267441453622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=70 head_norm_before_train=1.892988 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.8945934167163655, 'auprc': 0.9810634163827248, 'loss_val': 0.5364005132972807, 'psi': 0.9291814165829092}-{'f1_val': 0.9326346915653719, 'auprc': 0.9911225019682649, 'loss_val': 0.370578322205649, 'psi': 0.9560298157265292}
[S17] START round=70 head_norm_before_train=2.119335 (no previous merge yet)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.6598933987678832, 'auprc': 0.983468692238328, 'loss_val': 1.220373286177653, 'psi': 0.7893235161560611}-{'f1_val': 0.7604955639446022, 'auprc': 0.9879745369933407, 'loss_val': 0.7863821969988803, 'psi': 0.8514871531640975}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.040 → S7@127.0.0.1:61808
[S16] ⇄ pheromone p=0.086 → S2@127.0.0.1:61802
[S7] ⇄ pheromone p=0.171 → S14@127.0.0.1:61814
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.9999
[S2] ⇄ pheromone p=0.056 → S16@127.0.0.1:61816
[S2] START round=71 head_norm_before_train=1.900613 cos_to_last_merge=0.9999 (last merge round=67)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7605415524237191, 'auprc': 0.8485708952265837, 'loss_val': 0.6827249841975828, 'psi': 0.7957532895448649}-{'f1_val': 0.8306467290261653, 'auprc': 0.985002364396665, 'loss_val': 0.41346396310174033, 'psi': 0.8923889831743652}
[S3] START round=71 head_norm_before_train=1.979378 cos_to_last_merge=0.9106 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9983247680238662, 'loss_val': 0.11660748357710787, 'psi': 0.9759273596892482}-{'f1_val': 0.961289870742017, 'auprc': 0.9980932492303182, 'loss_val': 0.0833393725004829, 'psi': 0.9760112221373375}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.600509 cos_to_last_merge=0.8591 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9319129611460141, 'auprc': 0.9471002878026022, 'loss_val': 0.3105433822564395, 'psi': 0.9379878918086493}-{'f1_val': 0.9351298186961191, 'auprc': 0.9532532550131287, 'loss_val': 0.30615822123365677, 'psi': 0.9423791932229231}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.632408 cos_to_last_merge=0.8950 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.895
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.6690869960598994, 'auprc': 0.9593156034597693, 'loss_val': 0.34152795275607195, 'psi': 0.7851784390198474}-{'f1_val': 0.8330130286432372, 'auprc': 0.9699472041681261, 'loss_val': 0.24228911058198607, 'psi': 0.8877866988531928}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=2.164983 (no previous merge yet)
[S6] round=71 local utility u=0.350610 metrics={'f1_val': 0.8098135226076812, 'auprc': 0.9310746728798871, 'loss_val': 0.46491256349627774, 'psi': 0.8583179827165636}-{'f1_val': 0.7442135825364977, 'auprc': 0.9316778011377684, 'loss_val': 0.7743422394115863, 'psi': 0.8191992699770061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=71 head_norm_before_train=1.891969 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5805554967824673, 'auprc': 0.7853904142964466, 'loss_val': 0.7713484433657539, 'psi': 0.6624894637880591}-{'f1_val': 0.6280405492671032, 'auprc': 0.7996472405569628, 'loss_val': 0.5445745060476466, 'psi': 0.6966832257830471}
[S8] START round=71 head_norm_before_train=1.921748 cos_to_last_merge=0.8715 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.872
[S8] round=71 local utility u=0.008469 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990150652875537, 'loss_val': 0.028660325476512327, 'psi': 0.9957812283837194}-{'f1_val': 0.993235056744646, 'auprc': 0.997902207638004, 'loss_val': 0.03991857271801539, 'psi': 0.9951019171019891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=71 head_norm_before_train=2.069216 cos_to_last_merge=0.9776 (last merge round=21)
[S9] round=71 local utility u=0.024602 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9992279079026435, 'loss_val': 0.023857007261690683, 'psi': 0.9960547907594657}-{'f1_val': 0.9888785659900814, 'auprc': 0.9996118686195623, 'loss_val': 0.04384795603664174, 'psi': 0.9931718870418738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=71 head_norm_before_train=1.854047 cos_to_last_merge=0.8917 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958924307876705, 'loss_val': 0.025640162910927102, 'psi': 0.9953378842341138}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959044766729288, 'loss_val': 0.025500253621156946, 'psi': 0.9953427025882172}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.932272 cos_to_last_merge=0.9350 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9954743212262818, 'auprc': 0.9988045415431909, 'loss_val': 0.021425837363686306, 'psi': 0.9968064093530454}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984134654133162, 'loss_val': 0.017717539605940243, 'psi': 0.9973988379142358}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.528329 cos_to_last_merge=0.8795 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=71 local utility u=0.100602 metrics={'f1_val': 0.6030750082342319, 'auprc': 0.7260916675928275, 'loss_val': 0.9793462678037206, 'psi': 0.6522816719776701}-{'f1_val': 0.5803826450246772, 'auprc': 0.7243123643185492, 'loss_val': 1.0390576874283128, 'psi': 0.637954532742226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=71 head_norm_before_train=1.892417 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.937810628583913, 'auprc': 0.9988555541040538, 'loss_val': 0.08378279171148459, 'psi': 0.9622285987919693}-{'f1_val': 0.9975773038923221, 'auprc': 0.99923055646626, 'loss_val': 0.028057689693763783, 'psi': 0.9982386049218973}
[S15] START round=71 head_norm_before_train=2.168509 cos_to_last_merge=0.9520 (last merge round=16)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.9117754784451853, 'auprc': 0.9934339952808893, 'loss_val': 0.12326399629694738, 'psi': 0.9444388851794668}-{'f1_val': 0.9328677424515739, 'auprc': 0.9926490878546417, 'loss_val': 0.08424049507340463, 'psi': 0.9567802806128011}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.893729 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.8657775603834343, 'auprc': 0.8881140871184523, 'loss_val': 0.8831176628337746, 'psi': 0.8747121710774415}-{'f1_val': 0.8945934167163655, 'auprc': 0.9810634163827248, 'loss_val': 0.5364005132972807, 'psi': 0.9291814165829092}
[S17] START round=71 head_norm_before_train=2.126322 (no previous merge yet)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.6307836540691505, 'auprc': 0.994246433576975, 'loss_val': 1.4054577327062354, 'psi': 0.7761687658722802}-{'f1_val': 0.6598933987678832, 'auprc': 0.983468692238328, 'loss_val': 1.220373286177653, 'psi': 0.7893235161560611}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=71 metric=0.8658 head_norm=1.897711
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.613207e-02
[S16] stored merged vector for next round verification (round=71)
[S16] DEBUG after merge:  round=71 metric=0.8658 head_norm=1.899094 delta_norm=0.016132
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=1.906080 cos_to_last_merge=0.9999 (last merge round=67)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7352528643037091, 'auprc': 0.8491490297776183, 'loss_val': 0.7872818507698548, 'psi': 0.7808113304932727}-{'f1_val': 0.7605415524237191, 'auprc': 0.8485708952265837, 'loss_val': 0.6827249841975828, 'psi': 0.7957532895448649}
[S3] START round=72 head_norm_before_train=1.983077 cos_to_last_merge=0.9100 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=72 local utility u=0.017772 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9974390741166904, 'loss_val': 0.08142403931132818, 'psi': 0.9758749178106277}-{'f1_val': 0.960995754132836, 'auprc': 0.9983247680238662, 'loss_val': 0.11660748357710787, 'psi': 0.9759273596892482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=72 head_norm_before_train=1.605266 cos_to_last_merge=0.8584 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=72 local utility u=0.019376 metrics={'f1_val': 0.9330289937485758, 'auprc': 0.9558988661102914, 'loss_val': 0.3048842849804022, 'psi': 0.942176942693262}-{'f1_val': 0.9319129611460141, 'auprc': 0.9471002878026022, 'loss_val': 0.3105433822564395, 'psi': 0.9379878918086493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=72 head_norm_before_train=1.635903 cos_to_last_merge=0.8941 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=72 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9919266028315297, 'loss_val': 0.09194622444605594, 'psi': 0.9943684096963066}-{'f1_val': 0.6690869960598994, 'auprc': 0.9593156034597693, 'loss_val': 0.34152795275607195, 'psi': 0.7851784390198474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=72 head_norm_before_train=2.166721 (no previous merge yet)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.8100819339231672, 'auprc': 0.9447544694797846, 'loss_val': 0.5274057690992517, 'psi': 0.8639509481458141}-{'f1_val': 0.8098135226076812, 'auprc': 0.9310746728798871, 'loss_val': 0.46491256349627774, 'psi': 0.8583179827165636}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.892564 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=72 local utility u=0.020717 metrics={'f1_val': 0.579408313930112, 'auprc': 0.7869441727334073, 'loss_val': 0.7276921637768949, 'psi': 0.6624226574514303}-{'f1_val': 0.5805554967824673, 'auprc': 0.7853904142964466, 'loss_val': 0.7713484433657539, 'psi': 0.6624894637880591}
[S8] START round=72 head_norm_before_train=1.927304 cos_to_last_merge=0.8709 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.871
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9990719078338022, 'loss_val': 0.0290851737302787, 'psi': 0.9951461447279126}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990150652875537, 'loss_val': 0.028660325476512327, 'psi': 0.9957812283837194}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.068228 cos_to_last_merge=0.9775 (last merge round=21)
[S9] round=72 local utility u=0.013017 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991991754342916, 'loss_val': 0.0167171664075117, 'psi': 0.9979414176810023}-{'f1_val': 0.9939393793306803, 'auprc': 0.9992279079026435, 'loss_val': 0.023857007261690683, 'psi': 0.9960547907594657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=72 head_norm_before_train=1.859500 cos_to_last_merge=0.8911 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=72 local utility u=0.000505 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958062023337273, 'loss_val': 0.025688949195394106, 'psi': 0.9954351843451157}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958924307876705, 'loss_val': 0.025640162910927102, 'psi': 0.9953378842341138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=72 head_norm_before_train=1.936895 cos_to_last_merge=0.9346 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9952340914111621, 'auprc': 0.9987779597240047, 'loss_val': 0.0258256827943749, 'psi': 0.9966516387362993}-{'f1_val': 0.9954743212262818, 'auprc': 0.9988045415431909, 'loss_val': 0.021425837363686306, 'psi': 0.9968064093530454}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.531937 cos_to_last_merge=0.8785 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=72 local utility u=0.160536 metrics={'f1_val': 0.6227068809397851, 'auprc': 0.7128937856099945, 'loss_val': 0.736471301600469, 'psi': 0.6587816428078689}-{'f1_val': 0.6030750082342319, 'auprc': 0.7260916675928275, 'loss_val': 0.9793462678037206, 'psi': 0.6522816719776701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=72 head_norm_before_train=1.898015 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9357867705521205, 'auprc': 0.9988553008002155, 'loss_val': 0.09431081014728153, 'psi': 0.9610141826513584}-{'f1_val': 0.937810628583913, 'auprc': 0.9988555541040538, 'loss_val': 0.08378279171148459, 'psi': 0.9622285987919693}
[S15] START round=72 head_norm_before_train=2.176521 cos_to_last_merge=0.9514 (last merge round=16)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9017762279419838, 'auprc': 0.9911933015422643, 'loss_val': 0.16345797926152147, 'psi': 0.937543057382096}-{'f1_val': 0.9117754784451853, 'auprc': 0.9934339952808893, 'loss_val': 0.12326399629694738, 'psi': 0.9444388851794668}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.899094 cos_to_last_merge=1.0000 (last merge round=71)
[S16] round=72 local utility u=0.386294 metrics={'f1_val': 0.9050456151939057, 'auprc': 0.9331606251680928, 'loss_val': 0.48127776887241275, 'psi': 0.9162916191835806}-{'f1_val': 0.8657775603834343, 'auprc': 0.8881140871184523, 'loss_val': 0.8831176628337746, 'psi': 0.8747121710774415}
[S17] START round=72 head_norm_before_train=2.132214 (no previous merge yet)
[S17] round=72 local utility u=1.000000 metrics={'f1_val': 0.9070204497292259, 'auprc': 0.9919494158727609, 'loss_val': 0.4595268429246358, 'psi': 0.94099203618664}-{'f1_val': 0.6307836540691505, 'auprc': 0.994246433576975, 'loss_val': 1.4054577327062354, 'psi': 0.7761687658722802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] START round=73 head_norm_before_train=1.911347 cos_to_last_merge=0.9999 (last merge round=67)
[S2] round=73 local utility u=0.418188 metrics={'f1_val': 0.8008408105414919, 'auprc': 0.8984501154252422, 'loss_val': 0.49233764196152374, 'psi': 0.839884532494992}-{'f1_val': 0.7352528643037091, 'auprc': 0.8491490297776183, 'loss_val': 0.7872818507698548, 'psi': 0.7808113304932727}
[S3] START round=73 head_norm_before_train=1.988677 cos_to_last_merge=0.9093 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=73 local utility u=0.000806 metrics={'f1_val': 0.9617931420055088, 'auprc': 0.9975209622345071, 'loss_val': 0.08182326094245586, 'psi': 0.9760842700971081}-{'f1_val': 0.961498813606586, 'auprc': 0.9974390741166904, 'loss_val': 0.08142403931132818, 'psi': 0.9758749178106277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=73 head_norm_before_train=1.610854 cos_to_last_merge=0.8576 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=73 local utility u=0.029171 metrics={'f1_val': 0.9381268249316159, 'auprc': 0.9584019302506822, 'loss_val': 0.2846387908170964, 'psi': 0.9462368670592425}-{'f1_val': 0.9330289937485758, 'auprc': 0.9558988661102914, 'loss_val': 0.3048842849804022, 'psi': 0.942176942693262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=73 head_norm_before_train=1.638193 cos_to_last_merge=0.8936 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.9660662137362163, 'auprc': 0.9898414858708364, 'loss_val': 0.11274740711622552, 'psi': 0.9755763225900643}-{'f1_val': 0.995996280939491, 'auprc': 0.9919266028315297, 'loss_val': 0.09194622444605594, 'psi': 0.9943684096963066}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=2.171379 (no previous merge yet)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.7738132053812151, 'auprc': 0.9239747209352648, 'loss_val': 0.7118219970971758, 'psi': 0.8338778116028349}-{'f1_val': 0.8100819339231672, 'auprc': 0.9447544694797846, 'loss_val': 0.5274057690992517, 'psi': 0.8639509481458141}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.893442 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=73 local utility u=0.379010 metrics={'f1_val': 0.6465177750137294, 'auprc': 0.8070545968092279, 'loss_val': 0.4326599729583275, 'psi': 0.7107325037319288}-{'f1_val': 0.579408313930112, 'auprc': 0.7869441727334073, 'loss_val': 0.7276921637768949, 'psi': 0.6624226574514303}
[S8] START round=73 head_norm_before_train=1.932602 cos_to_last_merge=0.8703 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=73 local utility u=0.004747 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9987897806370465, 'loss_val': 0.027522003517239376, 'psi': 0.9959110540079267}-{'f1_val': 0.9925289693239863, 'auprc': 0.9990719078338022, 'loss_val': 0.0290851737302787, 'psi': 0.9951461447279126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=73 head_norm_before_train=2.067444 cos_to_last_merge=0.9772 (last merge round=21)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.999203408987057, 'loss_val': 0.0166154518367217, 'psi': 0.9977929148501772}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991991754342916, 'loss_val': 0.0167171664075117, 'psi': 0.9979414176810023}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=1.865497 cos_to_last_merge=0.8904 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955069008819499, 'loss_val': 0.025791536215444968, 'psi': 0.9953154637644048}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958062023337273, 'loss_val': 0.025688949195394106, 'psi': 0.9954351843451157}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.940013 cos_to_last_merge=0.9343 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=73 local utility u=0.007815 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984913117445902, 'loss_val': 0.01826483052093523, 'psi': 0.9974299764467454}-{'f1_val': 0.9952340914111621, 'auprc': 0.9987779597240047, 'loss_val': 0.0258256827943749, 'psi': 0.9966516387362993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=73 head_norm_before_train=1.532355 cos_to_last_merge=0.8779 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.5854389645562191, 'auprc': 0.7274778779332643, 'loss_val': 1.0376562934654887, 'psi': 0.6422545299070372}-{'f1_val': 0.6227068809397851, 'auprc': 0.7128937856099945, 'loss_val': 0.736471301600469, 'psi': 0.6587816428078689}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=1.905416 cos_to_last_merge=0.9999 (last merge round=69)
[S14] round=73 local utility u=0.150353 metrics={'f1_val': 0.9768744066075139, 'auprc': 0.9992310401786575, 'loss_val': 0.04125848024258483, 'psi': 0.9858170600359714}-{'f1_val': 0.9357867705521205, 'auprc': 0.9988553008002155, 'loss_val': 0.09431081014728153, 'psi': 0.9610141826513584}
[S15] START round=73 head_norm_before_train=2.184330 cos_to_last_merge=0.9509 (last merge round=16)
[S15] round=73 local utility u=0.256919 metrics={'f1_val': 0.9695806937748813, 'auprc': 0.9915260279838547, 'loss_val': 0.057445471317988855, 'psi': 0.9783588274584707}-{'f1_val': 0.9017762279419838, 'auprc': 0.9911933015422643, 'loss_val': 0.16345797926152147, 'psi': 0.937543057382096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=73 head_norm_before_train=1.902759 cos_to_last_merge=1.0000 (last merge round=71)
[S16] round=73 local utility u=0.576593 metrics={'f1_val': 0.9926771897808344, 'auprc': 0.9946726868162958, 'loss_val': 0.03841828805034, 'psi': 0.9934753885950189}-{'f1_val': 0.9050456151939057, 'auprc': 0.9331606251680928, 'loss_val': 0.48127776887241275, 'psi': 0.9162916191835806}
[S17] START round=73 head_norm_before_train=2.136476 (no previous merge yet)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.6319600925929915, 'auprc': 0.9755003046559672, 'loss_val': 1.420954813576345, 'psi': 0.7693761774181818}-{'f1_val': 0.9070204497292259, 'auprc': 0.9919494158727609, 'loss_val': 0.4595268429246358, 'psi': 0.94099203618664}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9998
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=73 metric=0.9769 head_norm=1.914161
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.848717e-02
[S14] stored merged vector for next round verification (round=73)
[S14] DEBUG after merge:  round=73 metric=0.9769 head_norm=1.904171 delta_norm=0.018487
[S14] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=73 metric=0.9927 head_norm=1.907030
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.810470e-02
[S16] stored merged vector for next round verification (round=73)
[S16] DEBUG after merge:  round=73 metric=0.9927 head_norm=1.912593 delta_norm=0.018105
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=73 metric=0.6465 head_norm=1.895187
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.879568e-02
[S7] stored merged vector for next round verification (round=73)
[S7] DEBUG after merge:  round=73 metric=0.6467 head_norm=1.904605 delta_norm=0.018796
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=73 metric=0.8008 head_norm=1.918311
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.762067e-02
[S2] stored merged vector for next round verification (round=73)
[S2] DEBUG after merge:  round=73 metric=0.8008 head_norm=1.911532 delta_norm=0.017621
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=74 head_norm_before_train=1.911532 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=74 local utility u=0.243110 metrics={'f1_val': 0.8259567550167839, 'auprc': 0.9905265330284033, 'loss_val': 0.43304339734331593, 'psi': 0.8917846662214317}-{'f1_val': 0.8008408105414919, 'auprc': 0.8984501154252422, 'loss_val': 0.49233764196152374, 'psi': 0.839884532494992}
[S3] START round=74 head_norm_before_train=1.994285 cos_to_last_merge=0.9086 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=74 local utility u=0.124833 metrics={'f1_val': 0.9945116724085847, 'auprc': 0.9976475905537452, 'loss_val': 0.02884794810370813, 'psi': 0.9957660396666489}-{'f1_val': 0.9617931420055088, 'auprc': 0.9975209622345071, 'loss_val': 0.08182326094245586, 'psi': 0.9760842700971081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=74 head_norm_before_train=1.612826 cos_to_last_merge=0.8567 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.857
[S4] round=74 local utility u=0.025675 metrics={'f1_val': 0.9431864485961041, 'auprc': 0.9645308965652674, 'loss_val': 0.28203393831490886, 'psi': 0.9517242277837694}-{'f1_val': 0.9381268249316159, 'auprc': 0.9584019302506822, 'loss_val': 0.2846387908170964, 'psi': 0.9462368670592425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=74 head_norm_before_train=1.641035 cos_to_last_merge=0.8932 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=74 local utility u=0.097839 metrics={'f1_val': 0.9958798017551914, 'auprc': 0.9899855621373965, 'loss_val': 0.09638390566173541, 'psi': 0.9935221059080734}-{'f1_val': 0.9660662137362163, 'auprc': 0.9898414858708364, 'loss_val': 0.11274740711622552, 'psi': 0.9755763225900643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=74 head_norm_before_train=2.177646 (no previous merge yet)
[S6] round=74 local utility u=0.084528 metrics={'f1_val': 0.7922980897761163, 'auprc': 0.9092281188485706, 'loss_val': 0.6094345750257274, 'psi': 0.8390701014050981}-{'f1_val': 0.7738132053812151, 'auprc': 0.9239747209352648, 'loss_val': 0.7118219970971758, 'psi': 0.8338778116028349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=74 head_norm_before_train=1.904605 cos_to_last_merge=1.0000 (last merge round=73)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.47294899179131433, 'auprc': 0.7791335949669429, 'loss_val': 1.269220470601309, 'psi': 0.5954228330615658}-{'f1_val': 0.6465177750137294, 'auprc': 0.8070545968092279, 'loss_val': 0.4326599729583275, 'psi': 0.7107325037319288}
[S8] START round=74 head_norm_before_train=1.938905 cos_to_last_merge=0.8696 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9982475521540913, 'loss_val': 0.030439365669127968, 'psi': 0.9943795073006458}-{'f1_val': 0.9939919029218467, 'auprc': 0.9987897806370465, 'loss_val': 0.027522003517239376, 'psi': 0.9959110540079267}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.066890 cos_to_last_merge=0.9769 (last merge round=21)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9968497224526777, 'auprc': 0.9992080550946123, 'loss_val': 0.017507582904406006, 'psi': 0.9977930555094516}-{'f1_val': 0.9968525854255906, 'auprc': 0.999203408987057, 'loss_val': 0.0166154518367217, 'psi': 0.9977929148501772}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=1.871654 cos_to_last_merge=0.8898 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956432015273426, 'loss_val': 0.02539194638355921, 'psi': 0.9952381925299827}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955069008819499, 'loss_val': 0.025791536215444968, 'psi': 0.9953154637644048}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.944314 cos_to_last_merge=0.9339 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9945161995897812, 'auprc': 0.9988394270683056, 'loss_val': 0.027806660903465383, 'psi': 0.9962454905811909}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984913117445902, 'loss_val': 0.01826483052093523, 'psi': 0.9974299764467454}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.533483 cos_to_last_merge=0.8776 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=74 local utility u=0.099949 metrics={'f1_val': 0.6015141852057843, 'auprc': 0.7306224217858933, 'loss_val': 0.9436427321799626, 'psi': 0.6531574798378279}-{'f1_val': 0.5854389645562191, 'auprc': 0.7274778779332643, 'loss_val': 1.0376562934654887, 'psi': 0.6422545299070372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=74 head_norm_before_train=1.904171 cos_to_last_merge=1.0000 (last merge round=73)
[S14] round=74 local utility u=0.072214 metrics={'f1_val': 0.9977705276331279, 'auprc': 0.9992294992023348, 'loss_val': 0.022202352008425928, 'psi': 0.9983541162608106}-{'f1_val': 0.9768744066075139, 'auprc': 0.9992310401786575, 'loss_val': 0.04125848024258483, 'psi': 0.9858170600359714}
[S15] START round=74 head_norm_before_train=2.191169 cos_to_last_merge=0.9504 (last merge round=16)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9367630757419951, 'auprc': 0.9917356404225844, 'loss_val': 0.07812712288630698, 'psi': 0.9587521016142309}-{'f1_val': 0.9695806937748813, 'auprc': 0.9915260279838547, 'loss_val': 0.057445471317988855, 'psi': 0.9783588274584707}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=1.912593 cos_to_last_merge=1.0000 (last merge round=73)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9913643003296534, 'auprc': 0.9938984571900635, 'loss_val': 0.04097446384861749, 'psi': 0.9923779630738174}-{'f1_val': 0.9926771897808344, 'auprc': 0.9946726868162958, 'loss_val': 0.03841828805034, 'psi': 0.9934753885950189}
[S17] START round=74 head_norm_before_train=2.138548 (no previous merge yet)
[S17] round=74 local utility u=0.282582 metrics={'f1_val': 0.676427963097973, 'auprc': 0.9754359673398786, 'loss_val': 1.1224051511033393, 'psi': 0.7960311647947353}-{'f1_val': 0.6319600925929915, 'auprc': 0.9755003046559672, 'loss_val': 1.420954813576345, 'psi': 0.7693761774181818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=1.0000
[S2] START round=75 head_norm_before_train=1.916694 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=75 local utility u=0.034985 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9918411241724161, 'loss_val': 0.3952129831269637, 'psi': 0.8951301032932584}-{'f1_val': 0.8259567550167839, 'auprc': 0.9905265330284033, 'loss_val': 0.43304339734331593, 'psi': 0.8917846662214317}
[S3] START round=75 head_norm_before_train=1.998378 cos_to_last_merge=0.9078 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.997778679066038, 'loss_val': 0.04651586820799047, 'psi': 0.9974584950355626}-{'f1_val': 0.9945116724085847, 'auprc': 0.9976475905537452, 'loss_val': 0.02884794810370813, 'psi': 0.9957660396666489}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.614064 cos_to_last_merge=0.8563 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.856
[S4] round=75 local utility u=0.022250 metrics={'f1_val': 0.9437765370230669, 'auprc': 0.9730203501428499, 'loss_val': 0.26654274323075755, 'psi': 0.9554740622709801}-{'f1_val': 0.9431864485961041, 'auprc': 0.9645308965652674, 'loss_val': 0.28203393831490886, 'psi': 0.9517242277837694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=75 head_norm_before_train=1.645418 cos_to_last_merge=0.8927 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.8633150580795895, 'auprc': 0.9893446241540499, 'loss_val': 0.16480392214808173, 'psi': 0.9137268845093737}-{'f1_val': 0.9958798017551914, 'auprc': 0.9899855621373965, 'loss_val': 0.09638390566173541, 'psi': 0.9935221059080734}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=2.183659 (no previous merge yet)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6762056324505201, 'auprc': 0.8798611933068371, 'loss_val': 1.0222813420470929, 'psi': 0.7576678567930469}-{'f1_val': 0.7922980897761163, 'auprc': 0.9092281188485706, 'loss_val': 0.6094345750257274, 'psi': 0.8390701014050981}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.907456 cos_to_last_merge=1.0000 (last merge round=73)
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.6766100612369603, 'auprc': 0.8283180423162962, 'loss_val': 0.34216330064738193, 'psi': 0.7372932536686947}-{'f1_val': 0.47294899179131433, 'auprc': 0.7791335949669429, 'loss_val': 1.269220470601309, 'psi': 0.5954228330615658}
[S8] START round=75 head_norm_before_train=1.944153 cos_to_last_merge=0.8690 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.869
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9773611464556267, 'auprc': 0.9967391004299553, 'loss_val': 0.0525925391371088, 'psi': 0.9851123280453581}-{'f1_val': 0.9918008107316822, 'auprc': 0.9982475521540913, 'loss_val': 0.030439365669127968, 'psi': 0.9943795073006458}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.069536 cos_to_last_merge=0.9766 (last merge round=21)
[S9] round=75 local utility u=0.001113 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992053918437727, 'loss_val': 0.016792635776046276, 'psi': 0.9979439042447947}-{'f1_val': 0.9968497224526777, 'auprc': 0.9992080550946123, 'loss_val': 0.017507582904406006, 'psi': 0.9977930555094516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=75 head_norm_before_train=1.875430 cos_to_last_merge=0.8892 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955082095731727, 'loss_val': 0.0254550759599145, 'psi': 0.9951841957483147}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956432015273426, 'loss_val': 0.02539194638355921, 'psi': 0.9952381925299827}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.946026 cos_to_last_merge=0.9337 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9906961505425218, 'auprc': 0.9988532128025658, 'loss_val': 0.05161077194096395, 'psi': 0.9939589754465394}-{'f1_val': 0.9945161995897812, 'auprc': 0.9988394270683056, 'loss_val': 0.027806660903465383, 'psi': 0.9962454905811909}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.535215 cos_to_last_merge=0.8771 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=75 local utility u=0.109769 metrics={'f1_val': 0.6271204190942967, 'auprc': 0.72947292819268, 'loss_val': 0.8742934044934523, 'psi': 0.66806142273365}-{'f1_val': 0.6015141852057843, 'auprc': 0.7306224217858933, 'loss_val': 0.9436427321799626, 'psi': 0.6531574798378279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=75 head_norm_before_train=1.909282 cos_to_last_merge=1.0000 (last merge round=73)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9847172521076833, 'auprc': 0.9992319201630422, 'loss_val': 0.03636024542639985, 'psi': 0.990523119329827}-{'f1_val': 0.9977705276331279, 'auprc': 0.9992294992023348, 'loss_val': 0.022202352008425928, 'psi': 0.9983541162608106}
[S15] START round=75 head_norm_before_train=2.198163 cos_to_last_merge=0.9500 (last merge round=16)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9699362441879835, 'loss_val': 0.607433217479265, 'psi': 0.808526008296194}-{'f1_val': 0.9367630757419951, 'auprc': 0.9917356404225844, 'loss_val': 0.07812712288630698, 'psi': 0.9587521016142309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=1.915844 cos_to_last_merge=1.0000 (last merge round=73)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9225579243201125, 'auprc': 0.9815027168593204, 'loss_val': 0.44617796273378446, 'psi': 0.9461358413357956}-{'f1_val': 0.9913643003296534, 'auprc': 0.9938984571900635, 'loss_val': 0.04097446384861749, 'psi': 0.9923779630738174}
[S17] START round=75 head_norm_before_train=2.139503 (no previous merge yet)
[S17] round=75 local utility u=0.625821 metrics={'f1_val': 0.7991552345582036, 'auprc': 0.9883341074842291, 'loss_val': 0.6458219726020232, 'psi': 0.8748267837286138}-{'f1_val': 0.676427963097973, 'auprc': 0.9754359673398786, 'loss_val': 1.1224051511033393, 'psi': 0.7960311647947353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S14] ⇄ pheromone p=0.044 → S7@127.0.0.1:61808
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=75 metric=0.9226 head_norm=1.920806
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.152422e-03
[S16] stored merged vector for next round verification (round=75)
[S16] DEBUG after merge:  round=75 metric=0.9226 head_norm=1.918729 delta_norm=0.009152
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.142 → S2@127.0.0.1:61802
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=75 metric=0.6766 head_norm=1.909474
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.190994e-03
[S7] stored merged vector for next round verification (round=75)
[S7] DEBUG after merge:  round=75 metric=0.6761 head_norm=1.909356 delta_norm=0.009191
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.307 → S14@127.0.0.1:61814
[S2] ⇄ pheromone p=0.118 → S16@127.0.0.1:61816
[S2] START round=76 head_norm_before_train=1.919754 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=76 local utility u=0.004757 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9904184065498914, 'loss_val': 0.38143001219933664, 'psi': 0.8945610162442486}-{'f1_val': 0.83065608937382, 'auprc': 0.9918411241724161, 'loss_val': 0.3952129831269637, 'psi': 0.8951301032932584}
[S3] START round=76 head_norm_before_train=2.003470 cos_to_last_merge=0.9072 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9856011921703364, 'auprc': 0.9975919666373676, 'loss_val': 0.0732320428001137, 'psi': 0.9903975019571489}-{'f1_val': 0.9972450390152456, 'auprc': 0.997778679066038, 'loss_val': 0.04651586820799047, 'psi': 0.9974584950355626}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.617624 cos_to_last_merge=0.8553 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.855
[S4] round=76 local utility u=0.022099 metrics={'f1_val': 0.9430970578644767, 'auprc': 0.9786055377085993, 'loss_val': 0.23502329083380274, 'psi': 0.9573004498021258}-{'f1_val': 0.9437765370230669, 'auprc': 0.9730203501428499, 'loss_val': 0.26654274323075755, 'psi': 0.9554740622709801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=76 head_norm_before_train=1.649393 cos_to_last_merge=0.8920 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.892
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.9779182842273388, 'loss_val': 0.3880521127625868, 'psi': 0.8116878741231407}-{'f1_val': 0.8633150580795895, 'auprc': 0.9893446241540499, 'loss_val': 0.16480392214808173, 'psi': 0.9137268845093737}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.192352 (no previous merge yet)
[S6] round=76 local utility u=0.523637 metrics={'f1_val': 0.7861207588549611, 'auprc': 0.9270718344598826, 'loss_val': 0.776130826502102, 'psi': 0.8425011890969297}-{'f1_val': 0.6762056324505201, 'auprc': 0.8798611933068371, 'loss_val': 1.0222813420470929, 'psi': 0.7576678567930469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=76 head_norm_before_train=1.909356 cos_to_last_merge=1.0000 (last merge round=75)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.5565606257725679, 'auprc': 0.7831333217952143, 'loss_val': 0.9186827154942354, 'psi': 0.6471897041816266}-{'f1_val': 0.6766100612369603, 'auprc': 0.8283180423162962, 'loss_val': 0.34216330064738193, 'psi': 0.7372932536686947}
[S8] START round=76 head_norm_before_train=1.949834 cos_to_last_merge=0.8685 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.868
[S8] round=76 local utility u=0.061189 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9985075677644983, 'loss_val': 0.028716857552326766, 'psi': 0.9951393505847685}-{'f1_val': 0.9773611464556267, 'auprc': 0.9967391004299553, 'loss_val': 0.0525925391371088, 'psi': 0.9851123280453581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=76 head_norm_before_train=2.074428 cos_to_last_merge=0.9763 (last merge round=21)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988288939279013, 'loss_val': 0.016812121920927004, 'psi': 0.9975278646594954}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992053918437727, 'loss_val': 0.016792635776046276, 'psi': 0.9979439042447947}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.878544 cos_to_last_merge=0.8886 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=76 local utility u=0.000749 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958951083151408, 'loss_val': 0.025117934748209142, 'psi': 0.995338955245102}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955082095731727, 'loss_val': 0.0254550759599145, 'psi': 0.9951841957483147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=76 head_norm_before_train=1.947508 cos_to_last_merge=0.9336 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=76 local utility u=0.033191 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9979949744599876, 'loss_val': 0.018810911376197833, 'psi': 0.9972314415329042}-{'f1_val': 0.9906961505425218, 'auprc': 0.9988532128025658, 'loss_val': 0.05161077194096395, 'psi': 0.9939589754465394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=76 head_norm_before_train=1.538583 cos_to_last_merge=0.8758 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6066082128919571, 'auprc': 0.7440161926649951, 'loss_val': 0.9432883910979951, 'psi': 0.6615714048011723}-{'f1_val': 0.6271204190942967, 'auprc': 0.72947292819268, 'loss_val': 0.8742934044934523, 'psi': 0.66806142273365}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=1.913286 cos_to_last_merge=1.0000 (last merge round=73)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9847172521076833, 'auprc': 0.9988550441536813, 'loss_val': 0.03619074884086704, 'psi': 0.9903723689260826}-{'f1_val': 0.9847172521076833, 'auprc': 0.9992319201630422, 'loss_val': 0.03636024542639985, 'psi': 0.990523119329827}
[S15] START round=76 head_norm_before_train=2.204665 cos_to_last_merge=0.9496 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=76 local utility u=1.000000 metrics={'f1_val': 0.9830688698885323, 'auprc': 0.9916688218895183, 'loss_val': 0.04196240218827798, 'psi': 0.9865088506889267}-{'f1_val': 0.7009191843683342, 'auprc': 0.9699362441879835, 'loss_val': 0.607433217479265, 'psi': 0.808526008296194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=76 head_norm_before_train=1.918729 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9085839985725537, 'auprc': 0.9758429398232499, 'loss_val': 0.4946122399526273, 'psi': 0.9354875750728321}-{'f1_val': 0.9225579243201125, 'auprc': 0.9815027168593204, 'loss_val': 0.44617796273378446, 'psi': 0.9461358413357956}
[S17] START round=76 head_norm_before_train=2.143319 (no previous merge yet)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6291507609340705, 'auprc': 0.9957394532524022, 'loss_val': 1.3675954549211773, 'psi': 0.7757862378614031}-{'f1_val': 0.7991552345582036, 'auprc': 0.9883341074842291, 'loss_val': 0.6458219726020232, 'psi': 0.8748267837286138}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=76 metric=0.9086 head_norm=1.924709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.039280e-02
[S16] stored merged vector for next round verification (round=76)
[S16] DEBUG after merge:  round=76 metric=0.9088 head_norm=1.922205 delta_norm=0.010393
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=1.0000
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=76 metric=0.9847 head_norm=1.918492
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.498603e-02
[S14] stored merged vector for next round verification (round=76)
[S14] DEBUG after merge:  round=76 metric=0.9847 head_norm=1.913930 delta_norm=0.014986
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=1.925345 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.8291018313669937, 'auprc': 0.9921928942528867, 'loss_val': 0.41154332027537865, 'psi': 0.8943382565213509}-{'f1_val': 0.83065608937382, 'auprc': 0.9904184065498914, 'loss_val': 0.38143001219933664, 'psi': 0.8945610162442486}
[S3] START round=77 head_norm_before_train=2.009749 cos_to_last_merge=0.9067 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=77 local utility u=0.046783 metrics={'f1_val': 0.996947988970087, 'auprc': 0.9975267056925886, 'loss_val': 0.0475514744588545, 'psi': 0.9971794756590877}-{'f1_val': 0.9856011921703364, 'auprc': 0.9975919666373676, 'loss_val': 0.0732320428001137, 'psi': 0.9903975019571489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] sending update (kind=head size=1788 to 1 peers)
[S4] START round=77 head_norm_before_train=1.624080 cos_to_last_merge=0.8542 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.854
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9433777580864828, 'auprc': 0.9718613960672582, 'loss_val': 0.22728738520374658, 'psi': 0.9547712132787929}-{'f1_val': 0.9430970578644767, 'auprc': 0.9786055377085993, 'loss_val': 0.23502329083380274, 'psi': 0.9573004498021258}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.654969 cos_to_last_merge=0.8909 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.891
[S5] round=77 local utility u=1.000000 metrics={'f1_val': 0.9962480140011919, 'auprc': 0.9920199546436372, 'loss_val': 0.06508489307796764, 'psi': 0.99455679025817}-{'f1_val': 0.7008676007203419, 'auprc': 0.9779182842273388, 'loss_val': 0.3880521127625868, 'psi': 0.8116878741231407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] sending update (kind=head size=1810 to 1 peers)
[S6] START round=77 head_norm_before_train=2.201184 (no previous merge yet)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.7799574974170405, 'auprc': 0.8992476665419501, 'loss_val': 0.9075049586702042, 'psi': 0.8276735650670044}-{'f1_val': 0.7861207588549611, 'auprc': 0.9270718344598826, 'loss_val': 0.776130826502102, 'psi': 0.8425011890969297}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.912680 cos_to_last_merge=1.0000 (last merge round=75)
[S7] round=77 local utility u=1.000000 metrics={'f1_val': 0.8024167860915531, 'auprc': 0.954736811969511, 'loss_val': 0.1948492434699933, 'psi': 0.8633447964427362}-{'f1_val': 0.5565606257725679, 'auprc': 0.7831333217952143, 'loss_val': 0.9186827154942354, 'psi': 0.6471897041816266}
[S8] START round=77 head_norm_before_train=1.956824 cos_to_last_merge=0.8677 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.868
[S8] round=77 local utility u=0.001173 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9989456146072251, 'loss_val': 0.02768471337922732, 'psi': 0.9953145693218592}-{'f1_val': 0.9928938724649488, 'auprc': 0.9985075677644983, 'loss_val': 0.028716857552326766, 'psi': 0.9951393505847685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=77 head_norm_before_train=2.079827 cos_to_last_merge=0.9760 (last merge round=21)
[S9] round=77 local utility u=0.000147 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9988271622576154, 'loss_val': 0.016492843599394017, 'psi': 0.9975250720826929}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988288939279013, 'loss_val': 0.016812121920927004, 'psi': 0.9975278646594954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=77 head_norm_before_train=1.883205 cos_to_last_merge=0.8879 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.888
[S10] round=77 local utility u=0.000147 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959116735961844, 'loss_val': 0.0248738705502439, 'psi': 0.9953455813575194}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958951083151408, 'loss_val': 0.025117934748209142, 'psi': 0.995338955245102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=77 head_norm_before_train=1.949615 cos_to_last_merge=0.9335 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=77 local utility u=0.000880 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983694434190511, 'loss_val': 0.018173994528200194, 'psi': 0.9973812291165296}-{'f1_val': 0.9967224195815153, 'auprc': 0.9979949744599876, 'loss_val': 0.018810911376197833, 'psi': 0.9972314415329042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=77 head_norm_before_train=1.543213 cos_to_last_merge=0.8745 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6042304356079786, 'auprc': 0.7441565216816896, 'loss_val': 1.0402225126567897, 'psi': 0.6602008700374631}-{'f1_val': 0.6066082128919571, 'auprc': 0.7440161926649951, 'loss_val': 0.9432883910979951, 'psi': 0.6615714048011723}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=1.913930 cos_to_last_merge=1.0000 (last merge round=76)
[S14] round=77 local utility u=0.043736 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9992308131127943, 'loss_val': 0.025843294574513096, 'psi': 0.9981223552623215}-{'f1_val': 0.9847172521076833, 'auprc': 0.9988550441536813, 'loss_val': 0.03619074884086704, 'psi': 0.9903723689260826}
[S15] START round=77 head_norm_before_train=2.210594 cos_to_last_merge=0.9492 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=77 local utility u=0.055516 metrics={'f1_val': 0.9962625367239556, 'auprc': 0.9953911784274343, 'loss_val': 0.02125943977686486, 'psi': 0.9959139934053471}-{'f1_val': 0.9830688698885323, 'auprc': 0.9916688218895183, 'loss_val': 0.04196240218827798, 'psi': 0.9865088506889267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=77 head_norm_before_train=1.922205 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=77 local utility u=0.504879 metrics={'f1_val': 0.9939820672939963, 'auprc': 0.9872203763357543, 'loss_val': 0.03137409282707905, 'psi': 0.9912773909106996}-{'f1_val': 0.9085839985725537, 'auprc': 0.9758429398232499, 'loss_val': 0.4946122399526273, 'psi': 0.9354875750728321}
[S17] START round=77 head_norm_before_train=2.149477 (no previous merge yet)
[S17] round=77 local utility u=0.019052 metrics={'f1_val': 0.6285984464456539, 'auprc': 0.9980270556404287, 'loss_val': 1.3330408533293012, 'psi': 0.7763698901235638}-{'f1_val': 0.6291507609340705, 'auprc': 0.9957394532524022, 'loss_val': 1.3675954549211773, 'psi': 0.7757862378614031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=77 metric=0.9940 head_norm=1.921844
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.089010e-02
[S16] stored merged vector for next round verification (round=77)
[S16] DEBUG after merge:  round=77 metric=0.9940 head_norm=1.923565 delta_norm=0.010890
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=77 metric=0.8024 head_norm=1.917167
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.065631e-02
[S7] stored merged vector for next round verification (round=77)
[S7] DEBUG after merge:  round=77 metric=0.7794 head_norm=1.918399 delta_norm=0.010656
[S7] aggregate: ROLLBACK (f1_val pre=0.802 post=0.779 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=77 metric=0.9974 head_norm=1.919689
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.065631e-02
[S14] stored merged vector for next round verification (round=77)
[S14] DEBUG after merge:  round=77 metric=0.9974 head_norm=1.918399 delta_norm=0.010656
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=1.932725 cos_to_last_merge=0.9999 (last merge round=73)
[S2] round=78 local utility u=0.012105 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9911357445306889, 'loss_val': 0.3934306643578182, 'psi': 0.8948423352279747}-{'f1_val': 0.8291018313669937, 'auprc': 0.9921928942528867, 'loss_val': 0.41154332027537865, 'psi': 0.8943382565213509}
[S3] START round=78 head_norm_before_train=2.017140 cos_to_last_merge=0.9061 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=78 local utility u=0.004478 metrics={'f1_val': 0.9949293084644328, 'auprc': 0.9976738815909745, 'loss_val': 0.026925769386142075, 'psi': 0.9960271377150496}-{'f1_val': 0.996947988970087, 'auprc': 0.9975267056925886, 'loss_val': 0.0475514744588545, 'psi': 0.9971794756590877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] sending update (kind=head size=1787 to 1 peers)
[S4] START round=78 head_norm_before_train=1.631692 cos_to_last_merge=0.8532 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.853
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.944621548410694, 'auprc': 0.9672441103131335, 'loss_val': 0.2286703724657768, 'psi': 0.9536705731716698}-{'f1_val': 0.9433777580864828, 'auprc': 0.9718613960672582, 'loss_val': 0.22728738520374658, 'psi': 0.9547712132787929}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.658689 cos_to_last_merge=0.8902 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.8621666258194158, 'auprc': 0.9711331939712732, 'loss_val': 0.22215363644923952, 'psi': 0.9057532530801589}-{'f1_val': 0.9962480140011919, 'auprc': 0.9920199546436372, 'loss_val': 0.06508489307796764, 'psi': 0.99455679025817}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.208098 (no previous merge yet)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.6067933840712586, 'auprc': 0.6997463823274281, 'loss_val': 1.4433787560371665, 'psi': 0.6439745833737265}-{'f1_val': 0.7799574974170405, 'auprc': 0.8992476665419501, 'loss_val': 0.9075049586702042, 'psi': 0.8276735650670044}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.918399 cos_to_last_merge=1.0000 (last merge round=77)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.4756108666214415, 'auprc': 0.7808630346489139, 'loss_val': 1.186592973768435, 'psi': 0.5977117338324305}-{'f1_val': 0.8024167860915531, 'auprc': 0.954736811969511, 'loss_val': 0.1948492434699933, 'psi': 0.8633447964427362}
[S8] START round=78 head_norm_before_train=1.964236 cos_to_last_merge=0.8670 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.867
[S8] round=78 local utility u=0.006986 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9992140082677543, 'loss_val': 0.025030522421247238, 'psi': 0.9964731822647277}-{'f1_val': 0.9928938724649488, 'auprc': 0.9989456146072251, 'loss_val': 0.02768471337922732, 'psi': 0.9953145693218592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=78 head_norm_before_train=2.085572 cos_to_last_merge=0.9758 (last merge round=21)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988187007772262, 'loss_val': 0.018893355162071756, 'psi': 0.9970235113294017}-{'f1_val': 0.9966570119660778, 'auprc': 0.9988271622576154, 'loss_val': 0.016492843599394017, 'psi': 0.9975250720826929}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=1.888621 cos_to_last_merge=0.8874 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.887
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959084941735756, 'loss_val': 0.025209680242251405, 'psi': 0.995344309588476}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959116735961844, 'loss_val': 0.0248738705502439, 'psi': 0.9953455813575194}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=1.952970 cos_to_last_merge=0.9332 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.996932440791898, 'loss_val': 0.019706385359106904, 'psi': 0.9965584270869804}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983694434190511, 'loss_val': 0.018173994528200194, 'psi': 0.9973812291165296}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.550709 cos_to_last_merge=0.8729 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=78 local utility u=0.247691 metrics={'f1_val': 0.6482489931086122, 'auprc': 0.75469878733971, 'loss_val': 0.8405787389898234, 'psi': 0.6908289108010512}-{'f1_val': 0.6042304356079786, 'auprc': 0.7441565216816896, 'loss_val': 1.0402225126567897, 'psi': 0.6602008700374631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=78 head_norm_before_train=1.918399 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9988545433145516, 'loss_val': 0.027907054762838827, 'psi': 0.9979718473430246}-{'f1_val': 0.9973833833620065, 'auprc': 0.9992308131127943, 'loss_val': 0.025843294574513096, 'psi': 0.9981223552623215}
[S15] START round=78 head_norm_before_train=2.215136 cos_to_last_merge=0.9492 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7485847677568672, 'auprc': 0.9908137585286911, 'loss_val': 0.5527407181183825, 'psi': 0.8454763640655968}-{'f1_val': 0.9962625367239556, 'auprc': 0.9953911784274343, 'loss_val': 0.02125943977686486, 'psi': 0.9959139934053471}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=1.923565 cos_to_last_merge=1.0000 (last merge round=77)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9871455570333898, 'auprc': 0.989864354704519, 'loss_val': 0.07003098995422553, 'psi': 0.9882330761018414}-{'f1_val': 0.9939820672939963, 'auprc': 0.9872203763357543, 'loss_val': 0.03137409282707905, 'psi': 0.9912773909106996}
[S17] START round=78 head_norm_before_train=2.154583 (no previous merge yet)
[S17] round=78 local utility u=0.264960 metrics={'f1_val': 0.6801910505157036, 'auprc': 0.9769404037424765, 'loss_val': 1.0494155934495388, 'psi': 0.7988907918064128}-{'f1_val': 0.6285984464456539, 'auprc': 0.9980270556404287, 'loss_val': 1.3330408533293012, 'psi': 0.7763698901235638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=78 metric=0.8306 head_norm=1.938589
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.652852e-02
[S2] stored merged vector for next round verification (round=78)
[S2] DEBUG after merge:  round=78 metric=0.8306 head_norm=1.930164 delta_norm=0.016529
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=1.930164 cos_to_last_merge=1.0000 (last merge round=78)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.8298708403313281, 'auprc': 0.990538856199028, 'loss_val': 0.4121975300600713, 'psi': 0.894138046678408}-{'f1_val': 0.8306467290261653, 'auprc': 0.9911357445306889, 'loss_val': 0.3934306643578182, 'psi': 0.8948423352279747}
[S3] START round=79 head_norm_before_train=2.024850 cos_to_last_merge=0.9055 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.9894285375218383, 'auprc': 0.9976008571968521, 'loss_val': 0.027511651089879893, 'psi': 0.9926974653918439}-{'f1_val': 0.9949293084644328, 'auprc': 0.9976738815909745, 'loss_val': 0.026925769386142075, 'psi': 0.9960271377150496}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.993 u=0.0000 p_local=0.0375 f1=0.989 auprc=0.998 bytes=80799
[S4] START round=79 head_norm_before_train=1.640713 cos_to_last_merge=0.8523 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.852
[S4] round=79 local utility u=0.007116 metrics={'f1_val': 0.946392250323435, 'auprc': 0.9694679483023465, 'loss_val': 0.2317333327137461, 'psi': 0.9556225295149996}-{'f1_val': 0.944621548410694, 'auprc': 0.9672441103131335, 'loss_val': 0.2286703724657768, 'psi': 0.9536705731716698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=80 psi=0.956 u=0.0071 p_local=0.0136 f1=0.946 auprc=0.969 bytes=80826
[S5] START round=79 head_norm_before_train=1.662217 cos_to_last_merge=0.8896 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=79 local utility u=0.506163 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9917631983334088, 'loss_val': 0.07892972875870974, 'psi': 0.9947264604204381}-{'f1_val': 0.8621666258194158, 'auprc': 0.9711331939712732, 'loss_val': 0.22215363644923952, 'psi': 0.9057532530801589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S5] r=80 psi=0.995 u=0.5062 p_local=0.3372 f1=0.997 auprc=0.992 bytes=75751
[S6] START round=79 head_norm_before_train=2.213239 (no previous merge yet)
[S6] round=79 local utility u=0.370485 metrics={'f1_val': 0.6140777972256617, 'auprc': 0.8764461418268328, 'loss_val': 1.2762146937794874, 'psi': 0.7190251350661301}-{'f1_val': 0.6067933840712586, 'auprc': 0.6997463823274281, 'loss_val': 1.4433787560371665, 'psi': 0.6439745833737265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S6] r=80 psi=0.719 u=0.3705 p_local=0.1764 f1=0.614 auprc=0.876 bytes=79098
[S7] START round=79 head_norm_before_train=1.921586 cos_to_last_merge=1.0000 (last merge round=77)
[S7] round=79 local utility u=0.610235 metrics={'f1_val': 0.5980601443690005, 'auprc': 0.7917495577856176, 'loss_val': 0.7334781490782969, 'psi': 0.6755359097356473}-{'f1_val': 0.4756108666214415, 'auprc': 0.7808630346489139, 'loss_val': 1.186592973768435, 'psi': 0.5977117338324305}
[S8] START round=79 head_norm_before_train=1.971692 cos_to_last_merge=0.8662 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.866
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9899126421634887, 'auprc': 0.999197267109053, 'loss_val': 0.031072399163239513, 'psi': 0.9936264921417144}-{'f1_val': 0.9946459649293765, 'auprc': 0.9992140082677543, 'loss_val': 0.025030522421247238, 'psi': 0.9964731822647277}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.994 u=0.0000 p_local=0.0307 f1=0.990 auprc=0.999 bytes=95399
[S9] START round=79 head_norm_before_train=2.091297 cos_to_last_merge=0.9755 (last merge round=21)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9988135320072611, 'loss_val': 0.01917999410332417, 'psi': 0.9967719055560413}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988187007772262, 'loss_val': 0.018893355162071756, 'psi': 0.9970235113294017}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.997 u=0.0000 p_local=0.0025 f1=0.995 auprc=0.999 bytes=75505
[S10] START round=79 head_norm_before_train=1.894355 cos_to_last_merge=0.8868 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.887
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959015225820199, 'loss_val': 0.025301631424089054, 'psi': 0.9953415209518537}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959084941735756, 'loss_val': 0.025209680242251405, 'psi': 0.995344309588476}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.996 bytes=98906
[S11] START round=79 head_norm_before_train=1.957134 cos_to_last_merge=0.9328 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.8852082972732153, 'auprc': 0.981012359204371, 'loss_val': 0.8509829187908132, 'psi': 0.9235299220456776}-{'f1_val': 0.9963090846170353, 'auprc': 0.996932440791898, 'loss_val': 0.019706385359106904, 'psi': 0.9965584270869804}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.924 u=0.0000 p_local=0.0063 f1=0.885 auprc=0.981 bytes=77393
[S13] START round=79 head_norm_before_train=1.558401 cos_to_last_merge=0.8715 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6525104618294719, 'auprc': 0.7596783296823166, 'loss_val': 0.9936464142891516, 'psi': 0.6953776089706099}-{'f1_val': 0.6482489931086122, 'auprc': 0.75469878733971, 'loss_val': 0.8405787389898234, 'psi': 0.6908289108010512}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.695 u=0.0000 p_local=0.0699 f1=0.653 auprc=0.760 bytes=68350
[S14] START round=79 head_norm_before_train=1.921762 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9764329280166866, 'auprc': 0.9988555541040538, 'loss_val': 0.04240074820266811, 'psi': 0.9854019784516335}-{'f1_val': 0.9973833833620065, 'auprc': 0.9988545433145516, 'loss_val': 0.027907054762838827, 'psi': 0.9979718473430246}
[S15] START round=79 head_norm_before_train=2.220045 cos_to_last_merge=0.9491 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.9085470158331479, 'loss_val': 0.7200391235086085, 'psi': 0.7840616123554147}-{'f1_val': 0.7485847677568672, 'auprc': 0.9908137585286911, 'loss_val': 0.5527407181183825, 'psi': 0.8454763640655968}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.784 u=0.0000 p_local=0.1450 f1=0.701 auprc=0.909 bytes=73790
[S16] START round=79 head_norm_before_train=1.926945 cos_to_last_merge=1.0000 (last merge round=77)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.9480384586250091, 'auprc': 0.9823741952847084, 'loss_val': 0.1508357998303732, 'psi': 0.9617727532888888}-{'f1_val': 0.9871455570333898, 'auprc': 0.989864354704519, 'loss_val': 0.07003098995422553, 'psi': 0.9882330761018414}
[S17] START round=79 head_norm_before_train=2.160999 (no previous merge yet)
[S17] round=79 local utility u=0.505288 metrics={'f1_val': 0.8117796767406019, 'auprc': 0.9154344293713024, 'loss_val': 0.6438526763918955, 'psi': 0.8532415777928821}-{'f1_val': 0.6801910505157036, 'auprc': 0.9769404037424765, 'loss_val': 1.0494155934495388, 'psi': 0.7988907918064128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=80 psi=0.853 u=0.5053 p_local=0.2780 f1=0.812 auprc=0.915 bytes=80997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.894 u=0.0000 p_local=0.0506 f1=0.830 auprc=0.991 bytes=79184
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] r=80 psi=0.985 u=0.0000 p_local=0.0236 f1=0.976 auprc=0.999 bytes=77406
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=79 metric=0.9480 head_norm=1.932256
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.359733e-02
[S16] stored merged vector for next round verification (round=79)
[S16] DEBUG after merge:  round=79 metric=0.9480 head_norm=1.935378 delta_norm=0.013597
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] r=80 psi=0.962 u=0.0000 p_local=0.1227 f1=0.948 auprc=0.982 bytes=75513
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] r=80 psi=0.676 u=0.6102 p_local=0.3756 f1=0.598 auprc=0.792 bytes=77388
[S2] START round=80 head_norm_before_train=1.934837 cos_to_last_merge=1.0000 (last merge round=78)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.8267442341193362, 'auprc': 0.9892191997037606, 'loss_val': 0.42022338339726784, 'psi': 0.891734220353106}-{'f1_val': 0.8298708403313281, 'auprc': 0.990538856199028, 'loss_val': 0.4121975300600713, 'psi': 0.894138046678408}
[S3] START round=80 head_norm_before_train=2.032244 cos_to_last_merge=0.9050 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=80 local utility u=0.020093 metrics={'f1_val': 0.9957630865773888, 'auprc': 0.9977184918899384, 'loss_val': 0.025684963814944582, 'psi': 0.9965452487024086}-{'f1_val': 0.9894285375218383, 'auprc': 0.9976008571968521, 'loss_val': 0.027511651089879893, 'psi': 0.9926974653918439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=80 head_norm_before_train=1.649920 cos_to_last_merge=0.8514 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9430010685477789, 'auprc': 0.9703523082027936, 'loss_val': 0.25880503486662554, 'psi': 0.9539415644097848}-{'f1_val': 0.946392250323435, 'auprc': 0.9694679483023465, 'loss_val': 0.2317333327137461, 'psi': 0.9556225295149996}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.667206 cos_to_last_merge=0.8889 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.889
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.8704332658557048, 'auprc': 0.989418846949206, 'loss_val': 0.15747996512520324, 'psi': 0.9180274982931053}-{'f1_val': 0.9967019684784577, 'auprc': 0.9917631983334088, 'loss_val': 0.07892972875870974, 'psi': 0.9947264604204381}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=2.216686 (no previous merge yet)
[S6] round=80 local utility u=0.906925 metrics={'f1_val': 0.7099166734203959, 'auprc': 0.9731117229659367, 'loss_val': 0.32739540156241564, 'psi': 0.8151946932386123}-{'f1_val': 0.6140777972256617, 'auprc': 0.8764461418268328, 'loss_val': 1.2762146937794874, 'psi': 0.7190251350661301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=80 head_norm_before_train=1.923344 cos_to_last_merge=1.0000 (last merge round=77)
[S7] round=80 local utility u=0.112733 metrics={'f1_val': 0.6161629385850482, 'auprc': 0.7941233265087879, 'loss_val': 0.6237504604003951, 'psi': 0.6873470937545441}-{'f1_val': 0.5980601443690005, 'auprc': 0.7917495577856176, 'loss_val': 0.7334781490782969, 'psi': 0.6755359097356473}
[S8] START round=80 head_norm_before_train=1.977745 cos_to_last_merge=0.8657 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.866
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.98220114491264, 'auprc': 0.9986216801830031, 'loss_val': 0.044706207818281676, 'psi': 0.9887693590207853}-{'f1_val': 0.9899126421634887, 'auprc': 0.999197267109053, 'loss_val': 0.031072399163239513, 'psi': 0.9936264921417144}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.097069 cos_to_last_merge=0.9753 (last merge round=21)
[S9] round=80 local utility u=0.005108 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988315383226384, 'loss_val': 0.016516973209907162, 'psi': 0.9975289224173902}-{'f1_val': 0.9954108212552283, 'auprc': 0.9988135320072611, 'loss_val': 0.01917999410332417, 'psi': 0.9967719055560413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=80 head_norm_before_train=1.900146 cos_to_last_merge=0.8863 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957866713834453, 'loss_val': 0.025423158471473632, 'psi': 0.9952955804724238}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959015225820199, 'loss_val': 0.025301631424089054, 'psi': 0.9953415209518537}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.961919 cos_to_last_merge=0.9324 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=80 local utility u=0.774309 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.997723354858817, 'loss_val': 0.019102359608500312, 'psi': 0.996874792713748}-{'f1_val': 0.8852082972732153, 'auprc': 0.981012359204371, 'loss_val': 0.8509829187908132, 'psi': 0.9235299220456776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=80 head_norm_before_train=1.564308 cos_to_last_merge=0.8703 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6183124500722001, 'auprc': 0.7640361257774028, 'loss_val': 0.9784731042290807, 'psi': 0.6766019203542812}-{'f1_val': 0.6525104618294719, 'auprc': 0.7596783296823166, 'loss_val': 0.9936464142891516, 'psi': 0.6953776089706099}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.927284 cos_to_last_merge=0.9999 (last merge round=77)
[S14] round=80 local utility u=0.075590 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9988555541040538, 'loss_val': 0.021890387328021895, 'psi': 0.9984689068151721}-{'f1_val': 0.9764329280166866, 'auprc': 0.9988555541040538, 'loss_val': 0.04240074820266811, 'psi': 0.9854019784516335}
[S15] START round=80 head_norm_before_train=2.224854 cos_to_last_merge=0.9488 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=80 local utility u=1.000000 metrics={'f1_val': 0.9856404425457774, 'auprc': 0.9923623613798049, 'loss_val': 0.036173501545169066, 'psi': 0.9883292100793885}-{'f1_val': 0.7010713433702593, 'auprc': 0.9085470158331479, 'loss_val': 0.7200391235086085, 'psi': 0.7840616123554147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=80 head_norm_before_train=1.935378 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.8389011794890706, 'auprc': 0.8446106464276354, 'loss_val': 1.3002632247372354, 'psi': 0.8411849662644965}-{'f1_val': 0.9480384586250091, 'auprc': 0.9823741952847084, 'loss_val': 0.1508357998303732, 'psi': 0.9617727532888888}
[S17] START round=80 head_norm_before_train=2.168571 (no previous merge yet)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.641900884575747, 'auprc': 0.9572379840601496, 'loss_val': 1.2267962233122855, 'psi': 0.7680357243695081}-{'f1_val': 0.8117796767406019, 'auprc': 0.9154344293713024, 'loss_val': 0.6438526763918955, 'psi': 0.8532415777928821}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] ⇄ pheromone p=0.098 → S2@127.0.0.1:61802
[S2] ⇄ pheromone p=0.040 → S16@127.0.0.1:61816
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=80 metric=0.6162 head_norm=1.925244
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.665192e-02
[S7] stored merged vector for next round verification (round=80)
[S7] DEBUG after merge:  round=80 metric=0.6173 head_norm=1.929838 delta_norm=0.016652
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.323 → S14@127.0.0.1:61814
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=80 metric=0.9982 head_norm=1.934563
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.608741e-02
[S14] stored merged vector for next round verification (round=80)
[S14] DEBUG after merge:  round=80 metric=0.9982 head_norm=1.929367 delta_norm=0.016087
[S14] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S7@127.0.0.1:61808
[S2] START round=81 head_norm_before_train=1.937711 cos_to_last_merge=1.0000 (last merge round=78)
[S2] round=81 local utility u=0.022540 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9899718494017166, 'loss_val': 0.4008153382920255, 'psi': 0.8943767771763858}-{'f1_val': 0.8267442341193362, 'auprc': 0.9892191997037606, 'loss_val': 0.42022338339726784, 'psi': 0.891734220353106}
[S3] START round=81 head_norm_before_train=2.038725 cos_to_last_merge=0.9045 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.9521895473026337, 'auprc': 0.994659472558005, 'loss_val': 0.20845021927342317, 'psi': 0.9691775174047823}-{'f1_val': 0.9957630865773888, 'auprc': 0.9977184918899384, 'loss_val': 0.025684963814944582, 'psi': 0.9965452487024086}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.656099 cos_to_last_merge=0.8507 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9401500775746677, 'auprc': 0.9610489108136367, 'loss_val': 0.2579886935069815, 'psi': 0.9485096108702553}-{'f1_val': 0.9430010685477789, 'auprc': 0.9703523082027936, 'loss_val': 0.25880503486662554, 'psi': 0.9539415644097848}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.673610 cos_to_last_merge=0.8880 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.888
[S5] round=81 local utility u=0.432862 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9922643321971334, 'loss_val': 0.06011078205664696, 'psi': 0.9951474680454919}-{'f1_val': 0.8704332658557048, 'auprc': 0.989418846949206, 'loss_val': 0.15747996512520324, 'psi': 0.9180274982931053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=81 head_norm_before_train=2.220155 (no previous merge yet)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6743184306391994, 'auprc': 0.875539380881446, 'loss_val': 0.9983222184851313, 'psi': 0.754806810736098}-{'f1_val': 0.7099166734203959, 'auprc': 0.9731117229659367, 'loss_val': 0.32739540156241564, 'psi': 0.8151946932386123}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.929838 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6133824085868924, 'auprc': 0.7945634731627057, 'loss_val': 0.6331862568743378, 'psi': 0.6858548344172177}-{'f1_val': 0.6161629385850482, 'auprc': 0.7941233265087879, 'loss_val': 0.6237504604003951, 'psi': 0.6873470937545441}
[S8] START round=81 head_norm_before_train=1.981732 cos_to_last_merge=0.8653 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.865
[S8] round=81 local utility u=0.015839 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9961008250515191, 'loss_val': 0.0372198295130987, 'psi': 0.9909364011257564}-{'f1_val': 0.98220114491264, 'auprc': 0.9986216801830031, 'loss_val': 0.044706207818281676, 'psi': 0.9887693590207853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=81 head_norm_before_train=2.101329 cos_to_last_merge=0.9749 (last merge round=21)
[S9] round=81 local utility u=0.000033 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9988317641394586, 'loss_val': 0.01643061277550017, 'psi': 0.9975269128354302}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988315383226384, 'loss_val': 0.016516973209907162, 'psi': 0.9975289224173902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=81 head_norm_before_train=1.903452 cos_to_last_merge=0.8857 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956131447785309, 'loss_val': 0.025443368850463947, 'psi': 0.9952261698304581}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957866713834453, 'loss_val': 0.025423158471473632, 'psi': 0.9952955804724238}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.965042 cos_to_last_merge=0.9322 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=81 local utility u=0.004665 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9985647338695546, 'loss_val': 0.017397313271762836, 'psi': 0.9977215054072073}-{'f1_val': 0.9963090846170353, 'auprc': 0.997723354858817, 'loss_val': 0.019102359608500312, 'psi': 0.996874792713748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=81 head_norm_before_train=1.569119 cos_to_last_merge=0.8695 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=81 local utility u=0.262569 metrics={'f1_val': 0.6757554333231395, 'auprc': 0.7579496797152661, 'loss_val': 0.7797335588987258, 'psi': 0.7086331318799901}-{'f1_val': 0.6183124500722001, 'auprc': 0.7640361257774028, 'loss_val': 0.9784731042290807, 'psi': 0.6766019203542812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=81 head_norm_before_train=1.929367 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988554259264678, 'loss_val': 0.022282457558768898, 'psi': 0.9982221046364546}-{'f1_val': 0.9982111419559175, 'auprc': 0.9988555541040538, 'loss_val': 0.021890387328021895, 'psi': 0.9984689068151721}
[S15] START round=81 head_norm_before_train=2.229515 cos_to_last_merge=0.9482 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=81 local utility u=0.045684 metrics={'f1_val': 0.9962625367239556, 'auprc': 0.9964298789528936, 'loss_val': 0.020740969313849965, 'psi': 0.9963294736155308}-{'f1_val': 0.9856404425457774, 'auprc': 0.9923623613798049, 'loss_val': 0.036173501545169066, 'psi': 0.9883292100793885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=81 head_norm_before_train=1.941580 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=81 local utility u=1.000000 metrics={'f1_val': 0.9670162052112148, 'auprc': 0.994485657173795, 'loss_val': 0.10248379891411208, 'psi': 0.9780039859962468}-{'f1_val': 0.8389011794890706, 'auprc': 0.8446106464276354, 'loss_val': 1.3002632247372354, 'psi': 0.8411849662644965}
[S17] START round=81 head_norm_before_train=2.174486 (no previous merge yet)
[S17] round=81 local utility u=0.499118 metrics={'f1_val': 0.7221814354374483, 'auprc': 0.9904259448415343, 'loss_val': 0.8098080612564976, 'psi': 0.8294792391990827}-{'f1_val': 0.641900884575747, 'auprc': 0.9572379840601496, 'loss_val': 1.2267962233122855, 'psi': 0.7680357243695081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=81 metric=0.8306 head_norm=1.941606
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.225122e-02
[S2] stored merged vector for next round verification (round=81)
[S2] DEBUG after merge:  round=81 metric=0.8306 head_norm=1.944726 delta_norm=0.012251
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=81 metric=0.9670 head_norm=1.947918
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.225121e-02
[S16] stored merged vector for next round verification (round=81)
[S16] DEBUG after merge:  round=81 metric=0.9668 head_norm=1.944726 delta_norm=0.012251
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=1.944726 cos_to_last_merge=1.0000 (last merge round=81)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.8267442341193362, 'auprc': 0.9909786127183031, 'loss_val': 0.42206318082549177, 'psi': 0.892437985558923}-{'f1_val': 0.8306467290261653, 'auprc': 0.9899718494017166, 'loss_val': 0.4008153382920255, 'psi': 0.8943767771763858}
[S3] START round=82 head_norm_before_train=2.043860 cos_to_last_merge=0.9039 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.933101817852636, 'auprc': 0.9972097010282478, 'loss_val': 0.11805684575765057, 'psi': 0.9587449711228808}-{'f1_val': 0.9521895473026337, 'auprc': 0.994659472558005, 'loss_val': 0.20845021927342317, 'psi': 0.9691775174047823}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.659761 cos_to_last_merge=0.8499 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.850
[S4] round=82 local utility u=0.011482 metrics={'f1_val': 0.9406093108703244, 'auprc': 0.9635396166557739, 'loss_val': 0.24525252530155345, 'psi': 0.9497814331845043}-{'f1_val': 0.9401500775746677, 'auprc': 0.9610489108136367, 'loss_val': 0.2579886935069815, 'psi': 0.9485096108702553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=82 head_norm_before_train=1.679310 cos_to_last_merge=0.8871 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9902919331108535, 'loss_val': 0.06184685960131974, 'psi': 0.9938747643705976}-{'f1_val': 0.9970695586110643, 'auprc': 0.9922643321971334, 'loss_val': 0.06011078205664696, 'psi': 0.9951474680454919}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.223237 (no previous merge yet)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.6209154469061111, 'auprc': 0.7457268478719535, 'loss_val': 1.241053344962045, 'psi': 0.6708400072924481}-{'f1_val': 0.6743184306391994, 'auprc': 0.875539380881446, 'loss_val': 0.9983222184851313, 'psi': 0.754806810736098}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.931687 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.5874521546040758, 'auprc': 0.7912500625255927, 'loss_val': 0.7950755183087149, 'psi': 0.6689713177726826}-{'f1_val': 0.6133824085868924, 'auprc': 0.7945634731627057, 'loss_val': 0.6331862568743378, 'psi': 0.6858548344172177}
[S8] START round=82 head_norm_before_train=1.987018 cos_to_last_merge=0.8647 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.865
[S8] round=82 local utility u=0.027725 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9983826419232064, 'loss_val': 0.027605302108972635, 'psi': 0.9957481985223906}-{'f1_val': 0.9874934518419147, 'auprc': 0.9961008250515191, 'loss_val': 0.0372198295130987, 'psi': 0.9909364011257564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=82 head_norm_before_train=2.103999 cos_to_last_merge=0.9746 (last merge round=21)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9992074661788257, 'loss_val': 0.016950192047621732, 'psi': 0.9971790174900416}-{'f1_val': 0.9966570119660778, 'auprc': 0.9988317641394586, 'loss_val': 0.01643061277550017, 'psi': 0.9975269128354302}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=1.906155 cos_to_last_merge=0.8851 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.885
[S10] round=82 local utility u=0.000301 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957531860194881, 'loss_val': 0.025262261745492443, 'psi': 0.995282186326841}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956131447785309, 'loss_val': 0.025443368850463947, 'psi': 0.9952261698304581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=82 head_norm_before_train=1.967848 cos_to_last_merge=0.9319 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.996023119688514, 'auprc': 0.9980039678357076, 'loss_val': 0.019335813854226672, 'psi': 0.9968154589473914}-{'f1_val': 0.9971593530989756, 'auprc': 0.9985647338695546, 'loss_val': 0.017397313271762836, 'psi': 0.9977215054072073}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.572911 cos_to_last_merge=0.8690 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.869
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6248702387610565, 'auprc': 0.7520407404391884, 'loss_val': 0.998973280424983, 'psi': 0.6757384394323094}-{'f1_val': 0.6757554333231395, 'auprc': 0.7579496797152661, 'loss_val': 0.7797335588987258, 'psi': 0.7086331318799901}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.935831 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.999229855166256, 'loss_val': 0.022365003752457292, 'psi': 0.9979927527248189}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988554259264678, 'loss_val': 0.022282457558768898, 'psi': 0.9982221046364546}
[S15] START round=82 head_norm_before_train=2.234150 cos_to_last_merge=0.9478 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.9277324006647152, 'loss_val': 0.6423593342027212, 'psi': 0.7930786641669425}-{'f1_val': 0.9962625367239556, 'auprc': 0.9964298789528936, 'loss_val': 0.020740969313849965, 'psi': 0.9963294736155308}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.944726 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=82 local utility u=0.112918 metrics={'f1_val': 0.9926572637434878, 'auprc': 0.9962668785081857, 'loss_val': 0.035838388225617676, 'psi': 0.9941011096493669}-{'f1_val': 0.9670162052112148, 'auprc': 0.994485657173795, 'loss_val': 0.10248379891411208, 'psi': 0.9780039859962468}
[S17] START round=82 head_norm_before_train=2.180536 (no previous merge yet)
[S17] round=82 local utility u=0.269923 metrics={'f1_val': 0.7891635058402748, 'auprc': 0.9885036433320942, 'loss_val': 0.6660884123223139, 'psi': 0.8688995608370026}-{'f1_val': 0.7221814354374483, 'auprc': 0.9904259448415343, 'loss_val': 0.8098080612564976, 'psi': 0.8294792391990827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=1.0000
[S2] START round=83 head_norm_before_train=1.949972 cos_to_last_merge=1.0000 (last merge round=81)
[S2] round=83 local utility u=0.026732 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9908915163707908, 'loss_val': 0.39175327255147524, 'psi': 0.8947446439640154}-{'f1_val': 0.8267442341193362, 'auprc': 0.9909786127183031, 'loss_val': 0.42206318082549177, 'psi': 0.892437985558923}
[S3] START round=83 head_norm_before_train=2.048438 cos_to_last_merge=0.9035 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=83 local utility u=0.044909 metrics={'f1_val': 0.9446705247650367, 'auprc': 0.9984755651665467, 'loss_val': 0.10144897034432566, 'psi': 0.9661925409256407}-{'f1_val': 0.933101817852636, 'auprc': 0.9972097010282478, 'loss_val': 0.11805684575765057, 'psi': 0.9587449711228808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=83 head_norm_before_train=1.662844 cos_to_last_merge=0.8493 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=83 local utility u=0.024746 metrics={'f1_val': 0.9426806847752168, 'auprc': 0.9739789355607676, 'loss_val': 0.23950658762190424, 'psi': 0.955199985089437}-{'f1_val': 0.9406093108703244, 'auprc': 0.9635396166557739, 'loss_val': 0.24525252530155345, 'psi': 0.9497814331845043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=83 head_norm_before_train=1.686619 cos_to_last_merge=0.8856 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9714256627136244, 'auprc': 0.9906700403792212, 'loss_val': 0.08446884836681842, 'psi': 0.9791234137798631}-{'f1_val': 0.9962633185437604, 'auprc': 0.9902919331108535, 'loss_val': 0.06184685960131974, 'psi': 0.9938747643705976}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.226869 (no previous merge yet)
[S6] round=83 local utility u=0.994101 metrics={'f1_val': 0.7969033569903944, 'auprc': 0.8983140530723943, 'loss_val': 0.7665412889342991, 'psi': 0.8374676354231944}-{'f1_val': 0.6209154469061111, 'auprc': 0.7457268478719535, 'loss_val': 1.241053344962045, 'psi': 0.6708400072924481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=83 head_norm_before_train=1.934130 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.5671973819046754, 'auprc': 0.7861556288385101, 'loss_val': 0.9020182895748916, 'psi': 0.6547806806782093}-{'f1_val': 0.5874521546040758, 'auprc': 0.7912500625255927, 'loss_val': 0.7950755183087149, 'psi': 0.6689713177726826}
[S8] START round=83 head_norm_before_train=1.990391 cos_to_last_merge=0.8643 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9915794263117453, 'auprc': 0.9990339447856442, 'loss_val': 0.029586142949301873, 'psi': 0.994561233701305}-{'f1_val': 0.9939919029218467, 'auprc': 0.9983826419232064, 'loss_val': 0.027605302108972635, 'psi': 0.9957481985223906}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.108315 cos_to_last_merge=0.9743 (last merge round=21)
[S9] round=83 local utility u=0.004602 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992046008140363, 'loss_val': 0.015395415201620643, 'psi': 0.9979435878329002}-{'f1_val': 0.9958267183641853, 'auprc': 0.9992074661788257, 'loss_val': 0.016950192047621732, 'psi': 0.9971790174900416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=83 head_norm_before_train=1.910361 cos_to_last_merge=0.8845 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.885
[S10] round=83 local utility u=0.000003 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957595314302259, 'loss_val': 0.02527495954702518, 'psi': 0.995284724491136}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957531860194881, 'loss_val': 0.025262261745492443, 'psi': 0.995282186326841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=83 head_norm_before_train=1.970103 cos_to_last_merge=0.9317 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9968382346373974, 'loss_val': 0.020115619657983537, 'psi': 0.9965207446251801}-{'f1_val': 0.996023119688514, 'auprc': 0.9980039678357076, 'loss_val': 0.019335813854226672, 'psi': 0.9968154589473914}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.575231 cos_to_last_merge=0.8685 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=83 local utility u=0.234712 metrics={'f1_val': 0.6848742347479471, 'auprc': 0.7657075177810453, 'loss_val': 0.9305728529372816, 'psi': 0.7172075479611864}-{'f1_val': 0.6248702387610565, 'auprc': 0.7520407404391884, 'loss_val': 0.998973280424983, 'psi': 0.6757384394323094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=83 head_norm_before_train=1.939762 cos_to_last_merge=0.9999 (last merge round=80)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9992307897541481, 'loss_val': 0.030292236420394733, 'psi': 0.9979898478308695}-{'f1_val': 0.9971680177638609, 'auprc': 0.999229855166256, 'loss_val': 0.022365003752457292, 'psi': 0.9979927527248189}
[S15] START round=83 head_norm_before_train=2.239388 cos_to_last_merge=0.9475 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=83 local utility u=0.522607 metrics={'f1_val': 0.8092000171436188, 'auprc': 0.991229480018967, 'loss_val': 0.4229795180450023, 'psi': 0.8820118022937581}-{'f1_val': 0.7033095065017607, 'auprc': 0.9277324006647152, 'loss_val': 0.6423593342027212, 'psi': 0.7930786641669425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=83 head_norm_before_train=1.951241 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9924576378987249, 'auprc': 0.996332985579887, 'loss_val': 0.03545810942149268, 'psi': 0.9940077769711897}-{'f1_val': 0.9926572637434878, 'auprc': 0.9962668785081857, 'loss_val': 0.035838388225617676, 'psi': 0.9941011096493669}
[S17] START round=83 head_norm_before_train=2.187896 (no previous merge yet)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.6357948294691786, 'auprc': 0.9789299705363345, 'loss_val': 1.3868237326997706, 'psi': 0.7730488858960409}-{'f1_val': 0.7891635058402748, 'auprc': 0.9885036433320942, 'loss_val': 0.6660884123223139, 'psi': 0.8688995608370026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=1.0000
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=83 metric=0.8306 head_norm=1.953340
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.324612e-03
[S2] stored merged vector for next round verification (round=83)
[S2] DEBUG after merge:  round=83 metric=0.8306 head_norm=1.952283 delta_norm=0.005325
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=1.952283 cos_to_last_merge=1.0000 (last merge round=83)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.990988617343286, 'loss_val': 0.39924699682576553, 'psi': 0.8947834843530136}-{'f1_val': 0.8306467290261653, 'auprc': 0.9908915163707908, 'loss_val': 0.39175327255147524, 'psi': 0.8947446439640154}
[S3] START round=84 head_norm_before_train=2.054134 cos_to_last_merge=0.9031 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7160715506577523, 'auprc': 0.9851849805310525, 'loss_val': 0.3675091435721223, 'psi': 0.8237169226070724}-{'f1_val': 0.9446705247650367, 'auprc': 0.9984755651665467, 'loss_val': 0.10144897034432566, 'psi': 0.9661925409256407}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.664089 cos_to_last_merge=0.8487 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9439981331427223, 'auprc': 0.9581640789734042, 'loss_val': 0.24250170601383791, 'psi': 0.949664511474995}-{'f1_val': 0.9426806847752168, 'auprc': 0.9739789355607676, 'loss_val': 0.23950658762190424, 'psi': 0.955199985089437}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.694192 cos_to_last_merge=0.8842 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=84 local utility u=0.092407 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9911009098698689, 'loss_val': 0.05217812493148073, 'psi': 0.994418906659772}-{'f1_val': 0.9714256627136244, 'auprc': 0.9906700403792212, 'loss_val': 0.08446884836681842, 'psi': 0.9791234137798631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=84 head_norm_before_train=2.233832 (no previous merge yet)
[S6] round=84 local utility u=0.074135 metrics={'f1_val': 0.8152554017134728, 'auprc': 0.910527229828272, 'loss_val': 0.7650239417343382, 'psi': 0.8533641329593924}-{'f1_val': 0.7969033569903944, 'auprc': 0.8983140530723943, 'loss_val': 0.7665412889342991, 'psi': 0.8374676354231944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=84 head_norm_before_train=1.936488 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=84 local utility u=0.769022 metrics={'f1_val': 0.6869206203971829, 'auprc': 0.8514282527588444, 'loss_val': 0.278130657299324, 'psi': 0.7527236733418475}-{'f1_val': 0.5671973819046754, 'auprc': 0.7861556288385101, 'loss_val': 0.9020182895748916, 'psi': 0.6547806806782093}
[S8] START round=84 head_norm_before_train=1.994418 cos_to_last_merge=0.8640 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=84 local utility u=0.005984 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9989127327516244, 'loss_val': 0.027333816745172077, 'psi': 0.9955206897087676}-{'f1_val': 0.9915794263117453, 'auprc': 0.9990339447856442, 'loss_val': 0.029586142949301873, 'psi': 0.994561233701305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=84 head_norm_before_train=2.111922 cos_to_last_merge=0.9738 (last merge round=21)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992005628698527, 'loss_val': 0.015398907496624781, 'psi': 0.9979419726552268}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992046008140363, 'loss_val': 0.015395415201620643, 'psi': 0.9979435878329002}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=1.915238 cos_to_last_merge=0.8840 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956740020277937, 'loss_val': 0.02527942980475143, 'psi': 0.9952505127301632}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957595314302259, 'loss_val': 0.02527495954702518, 'psi': 0.995284724491136}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=1.973613 cos_to_last_merge=0.9315 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9928412662561867, 'auprc': 0.9990269355158024, 'loss_val': 0.03390484873986432, 'psi': 0.995315533960033}-{'f1_val': 0.9963090846170353, 'auprc': 0.9968382346373974, 'loss_val': 0.020115619657983537, 'psi': 0.9965207446251801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.577120 cos_to_last_merge=0.8680 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6156118506749109, 'auprc': 0.7604993937646456, 'loss_val': 0.9588077260936547, 'psi': 0.6735668679108048}-{'f1_val': 0.6848742347479471, 'auprc': 0.7657075177810453, 'loss_val': 0.9305728529372816, 'psi': 0.7172075479611864}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.943415 cos_to_last_merge=0.9999 (last merge round=80)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9825579831124402, 'auprc': 0.9988564364483087, 'loss_val': 0.03788318526928612, 'psi': 0.9890773644467876}-{'f1_val': 0.9971625532153504, 'auprc': 0.9992307897541481, 'loss_val': 0.030292236420394733, 'psi': 0.9979898478308695}
[S15] START round=84 head_norm_before_train=2.244816 cos_to_last_merge=0.9471 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=84 local utility u=0.771938 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.996372964358093, 'loss_val': 0.01981347574163437, 'psi': 0.9965971867757495}-{'f1_val': 0.8092000171436188, 'auprc': 0.991229480018967, 'loss_val': 0.4229795180450023, 'psi': 0.8820118022937581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=84 head_norm_before_train=1.956310 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=84 local utility u=0.001651 metrics={'f1_val': 0.9930952402670012, 'auprc': 0.9955853848872361, 'loss_val': 0.033738340451214294, 'psi': 0.9940912981150952}-{'f1_val': 0.9924576378987249, 'auprc': 0.996332985579887, 'loss_val': 0.03545810942149268, 'psi': 0.9940077769711897}
[S17] START round=84 head_norm_before_train=2.194034 (no previous merge yet)
[S17] round=84 local utility u=0.250247 metrics={'f1_val': 0.6770819965344463, 'auprc': 0.9868500706263854, 'loss_val': 1.1578122655866794, 'psi': 0.8009892261712219}-{'f1_val': 0.6357948294691786, 'auprc': 0.9789299705363345, 'loss_val': 1.3868237326997706, 'psi': 0.7730488858960409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=1.0000
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=84 metric=0.9931 head_norm=1.957392
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.174756e-03
[S16] stored merged vector for next round verification (round=84)
[S16] DEBUG after merge:  round=84 metric=0.9931 head_norm=1.955350 delta_norm=0.008175
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=1.957248 cos_to_last_merge=1.0000 (last merge round=83)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7810430518411102, 'auprc': 0.8721651548001828, 'loss_val': 0.5861964049277373, 'psi': 0.8174918930247392}-{'f1_val': 0.8306467290261653, 'auprc': 0.990988617343286, 'loss_val': 0.39924699682576553, 'psi': 0.8947834843530136}
[S3] START round=85 head_norm_before_train=2.059857 cos_to_last_merge=0.9027 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=85 local utility u=0.858391 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9977175801566451, 'loss_val': 0.1551582422347123, 'psi': 0.9754133558021263}-{'f1_val': 0.7160715506577523, 'auprc': 0.9851849805310525, 'loss_val': 0.3675091435721223, 'psi': 0.8237169226070724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=85 head_norm_before_train=1.667767 cos_to_last_merge=0.8481 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=85 local utility u=0.021828 metrics={'f1_val': 0.9528207832225141, 'auprc': 0.9563123264666854, 'loss_val': 0.2462271719106023, 'psi': 0.9542174005201827}-{'f1_val': 0.9439981331427223, 'auprc': 0.9581640789734042, 'loss_val': 0.24250170601383791, 'psi': 0.949664511474995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=85 head_norm_before_train=1.700953 cos_to_last_merge=0.8831 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.883
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9887528572396073, 'auprc': 0.9901684304148555, 'loss_val': 0.07971657472011211, 'psi': 0.9893190865097066}-{'f1_val': 0.9966309045197074, 'auprc': 0.9911009098698689, 'loss_val': 0.05217812493148073, 'psi': 0.994418906659772}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.239388 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6592149957288552, 'auprc': 0.8740662834735214, 'loss_val': 1.1527463671727158, 'psi': 0.7451555108267217}-{'f1_val': 0.8152554017134728, 'auprc': 0.910527229828272, 'loss_val': 0.7650239417343382, 'psi': 0.8533641329593924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.938701 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.6181394625375208, 'auprc': 0.7951711694519921, 'loss_val': 0.6191241863600552, 'psi': 0.6889521453033094}-{'f1_val': 0.6869206203971829, 'auprc': 0.8514282527588444, 'loss_val': 0.278130657299324, 'psi': 0.7527236733418475}
[S8] START round=85 head_norm_before_train=1.999439 cos_to_last_merge=0.8635 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=85 local utility u=0.000114 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9984001703997564, 'loss_val': 0.02776331292031215, 'psi': 0.9955352704286005}-{'f1_val': 0.9932593276801964, 'auprc': 0.9989127327516244, 'loss_val': 0.027333816745172077, 'psi': 0.9955206897087676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=85 head_norm_before_train=2.115650 cos_to_last_merge=0.9734 (last merge round=21)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991984390889175, 'loss_val': 0.01678312905220889, 'psi': 0.9974419930738107}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992005628698527, 'loss_val': 0.015398907496624781, 'psi': 0.9979419726552268}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=1.920470 cos_to_last_merge=0.8836 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=85 local utility u=0.000606 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960450455201625, 'loss_val': 0.02518002282359735, 'psi': 0.9953989301271107}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956740020277937, 'loss_val': 0.02527942980475143, 'psi': 0.9952505127301632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=85 head_norm_before_train=1.977690 cos_to_last_merge=0.9311 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=85 local utility u=0.020659 metrics={'f1_val': 0.9969182646438458, 'auprc': 0.9990209659976271, 'loss_val': 0.017030976835447773, 'psi': 0.9977593451853584}-{'f1_val': 0.9928412662561867, 'auprc': 0.9990269355158024, 'loss_val': 0.03390484873986432, 'psi': 0.995315533960033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=85 head_norm_before_train=1.581179 cos_to_last_merge=0.8677 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=85 local utility u=0.183096 metrics={'f1_val': 0.654488165304647, 'auprc': 0.7568375447764699, 'loss_val': 0.8148881762177281, 'psi': 0.6954279170933761}-{'f1_val': 0.6156118506749109, 'auprc': 0.7604993937646456, 'loss_val': 0.9588077260936547, 'psi': 0.6735668679108048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=85 head_norm_before_train=1.949197 cos_to_last_merge=0.9999 (last merge round=80)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9751047262688567, 'auprc': 0.9988564364483087, 'loss_val': 0.04426743973807339, 'psi': 0.9846054103406375}-{'f1_val': 0.9825579831124402, 'auprc': 0.9988564364483087, 'loss_val': 0.03788318526928612, 'psi': 0.9890773644467876}
[S15] START round=85 head_norm_before_train=2.249785 cos_to_last_merge=0.9468 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9951094973742476, 'loss_val': 0.02510960111658769, 'psi': 0.9960917999822114}-{'f1_val': 0.9967466683875206, 'auprc': 0.996372964358093, 'loss_val': 0.01981347574163437, 'psi': 0.9965971867757495}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=1.955350 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9933629324616476, 'auprc': 0.9933195800791832, 'loss_val': 0.03340920306717351, 'psi': 0.9933455915086619}-{'f1_val': 0.9930952402670012, 'auprc': 0.9955853848872361, 'loss_val': 0.033738340451214294, 'psi': 0.9940912981150952}
[S17] START round=85 head_norm_before_train=2.198139 (no previous merge yet)
[S17] round=85 local utility u=0.178522 metrics={'f1_val': 0.6995406903861561, 'auprc': 0.9887649565265835, 'loss_val': 0.9412647824949059, 'psi': 0.8152303968423271}-{'f1_val': 0.6770819965344463, 'auprc': 0.9868500706263854, 'loss_val': 1.1578122655866794, 'psi': 0.8009892261712219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=85 metric=0.7810 head_norm=1.960935
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.282205e-03
[S2] stored merged vector for next round verification (round=85)
[S2] DEBUG after merge:  round=85 metric=0.7813 head_norm=1.959142 delta_norm=0.009282
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.019 → S16@127.0.0.1:61816
[S7] ⇄ pheromone p=0.229 → S14@127.0.0.1:61814
[S16] ⇄ pheromone p=0.126 → S2@127.0.0.1:61802
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=85 metric=0.9751 head_norm=1.957375
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.695265e-02
[S14] stored merged vector for next round verification (round=85)
[S14] DEBUG after merge:  round=85 metric=0.9751 head_norm=1.947986 delta_norm=0.016953
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.011 → S7@127.0.0.1:61808
[S2] START round=86 head_norm_before_train=1.959142 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=86 local utility u=0.108079 metrics={'f1_val': 0.7984887728894504, 'auprc': 0.8866902976046038, 'loss_val': 0.5182882837616408, 'psi': 0.8337693827755117}-{'f1_val': 0.7810430518411102, 'auprc': 0.8721651548001828, 'loss_val': 0.5861964049277373, 'psi': 0.8174918930247392}
[S3] START round=86 head_norm_before_train=2.066182 cos_to_last_merge=0.9022 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=86 local utility u=0.079256 metrics={'f1_val': 0.9741388352422122, 'auprc': 0.9978772868179536, 'loss_val': 0.07869455423659907, 'psi': 0.9836342158725088}-{'f1_val': 0.9605438728991138, 'auprc': 0.9977175801566451, 'loss_val': 0.1551582422347123, 'psi': 0.9754133558021263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=86 head_norm_before_train=1.673063 cos_to_last_merge=0.8475 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9425995008955838, 'auprc': 0.9748376437566106, 'loss_val': 0.2499567446703493, 'psi': 0.9554947580399946}-{'f1_val': 0.9528207832225141, 'auprc': 0.9563123264666854, 'loss_val': 0.2462271719106023, 'psi': 0.9542174005201827}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.706581 cos_to_last_merge=0.8822 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.882
[S5] round=86 local utility u=0.048682 metrics={'f1_val': 0.9969979269756446, 'auprc': 0.9976644089094577, 'loss_val': 0.05431046802446671, 'psi': 0.9972645197491699}-{'f1_val': 0.9887528572396073, 'auprc': 0.9901684304148555, 'loss_val': 0.07971657472011211, 'psi': 0.9893190865097066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=86 head_norm_before_train=2.243440 (no previous merge yet)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.6157532179009585, 'auprc': 0.8609571513522121, 'loss_val': 1.1443272818166956, 'psi': 0.71383479128146}-{'f1_val': 0.6592149957288552, 'auprc': 0.8740662834735214, 'loss_val': 1.1527463671727158, 'psi': 0.7451555108267217}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.940374 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6072958736572089, 'auprc': 0.7947772991702498, 'loss_val': 0.5835125381417571, 'psi': 0.6822884438624253}-{'f1_val': 0.6181394625375208, 'auprc': 0.7951711694519921, 'loss_val': 0.6191241863600552, 'psi': 0.6889521453033094}
[S8] START round=86 head_norm_before_train=2.005242 cos_to_last_merge=0.8629 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.863
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9703778840528637, 'auprc': 0.9987947220611665, 'loss_val': 0.061076603752277844, 'psi': 0.9817446192561848}-{'f1_val': 0.9936253371144965, 'auprc': 0.9984001703997564, 'loss_val': 0.02776331292031215, 'psi': 0.9955352704286005}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.120511 cos_to_last_merge=0.9730 (last merge round=21)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9887042205730695, 'auprc': 0.999181121690585, 'loss_val': 0.042841007179792535, 'psi': 0.9928949810200758}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991984390889175, 'loss_val': 0.01678312905220889, 'psi': 0.9974419930738107}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=1.921654 cos_to_last_merge=0.8828 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.883
[S10] round=86 local utility u=0.001168 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9968294244424958, 'loss_val': 0.02519694646268483, 'psi': 0.995712681696044}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960450455201625, 'loss_val': 0.02518002282359735, 'psi': 0.9953989301271107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=86 head_norm_before_train=1.982086 cos_to_last_merge=0.9308 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=86 local utility u=0.000807 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9990026637754305, 'loss_val': 0.01680915401048933, 'psi': 0.9978966773695577}-{'f1_val': 0.9969182646438458, 'auprc': 0.9990209659976271, 'loss_val': 0.017030976835447773, 'psi': 0.9977593451853584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=86 head_norm_before_train=1.587543 cos_to_last_merge=0.8668 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.867
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6589974128350584, 'auprc': 0.7708733993471484, 'loss_val': 0.9356801080620007, 'psi': 0.7037478074398944}-{'f1_val': 0.654488165304647, 'auprc': 0.7568375447764699, 'loss_val': 0.8148881762177281, 'psi': 0.6954279170933761}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.947986 cos_to_last_merge=1.0000 (last merge round=85)
[S14] round=86 local utility u=0.071429 metrics={'f1_val': 0.996333081002392, 'auprc': 0.9992307866841066, 'loss_val': 0.02990219753243984, 'psi': 0.9974921632750778}-{'f1_val': 0.9751047262688567, 'auprc': 0.9988564364483087, 'loss_val': 0.04426743973807339, 'psi': 0.9846054103406375}
[S15] START round=86 head_norm_before_train=2.255257 cos_to_last_merge=0.9465 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.7773144643648614, 'auprc': 0.9791314522829735, 'loss_val': 0.5027378699005304, 'psi': 0.8580412595321063}-{'f1_val': 0.9967466683875206, 'auprc': 0.9951094973742476, 'loss_val': 0.02510960111658769, 'psi': 0.9960917999822114}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=1.957208 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9906156093043648, 'loss_val': 0.03330257744466773, 'psi': 0.9921324232117594}-{'f1_val': 0.9933629324616476, 'auprc': 0.9933195800791832, 'loss_val': 0.03340920306717351, 'psi': 0.9933455915086619}
[S17] START round=86 head_norm_before_train=2.201779 (no previous merge yet)
[S17] round=86 local utility u=0.683986 metrics={'f1_val': 0.8680380916389288, 'auprc': 0.9862268608313829, 'loss_val': 0.5766620715834837, 'psi': 0.9153135993159104}-{'f1_val': 0.6995406903861561, 'auprc': 0.9887649565265835, 'loss_val': 0.9412647824949059, 'psi': 0.8152303968423271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=1.0000
[S2] START round=87 head_norm_before_train=1.964449 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=87 local utility u=0.305786 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9918983262097196, 'loss_val': 0.4152873848612682, 'psi': 0.895147367899587}-{'f1_val': 0.7984887728894504, 'auprc': 0.8866902976046038, 'loss_val': 0.5182882837616408, 'psi': 0.8337693827755117}
[S3] START round=87 head_norm_before_train=2.069836 cos_to_last_merge=0.9020 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=87 local utility u=0.014586 metrics={'f1_val': 0.9770615005749399, 'auprc': 0.997514763315227, 'loss_val': 0.06597031928881372, 'psi': 0.9852428056710547}-{'f1_val': 0.9741388352422122, 'auprc': 0.9978772868179536, 'loss_val': 0.07869455423659907, 'psi': 0.9836342158725088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=87 head_norm_before_train=1.678978 cos_to_last_merge=0.8469 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.933149635958506, 'auprc': 0.9631173412086604, 'loss_val': 0.29514117010755003, 'psi': 0.9451367180585678}-{'f1_val': 0.9425995008955838, 'auprc': 0.9748376437566106, 'loss_val': 0.2499567446703493, 'psi': 0.9554947580399946}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.710709 cos_to_last_merge=0.8815 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.881
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9911202796278603, 'loss_val': 0.05709162046296156, 'psi': 0.9944266545629685}-{'f1_val': 0.9969979269756446, 'auprc': 0.9976644089094577, 'loss_val': 0.05431046802446671, 'psi': 0.9972645197491699}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.248047 (no previous merge yet)
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.8764987992556258, 'auprc': 0.9691425364274164, 'loss_val': 0.30631471384738274, 'psi': 0.913556294124342}-{'f1_val': 0.6157532179009585, 'auprc': 0.8609571513522121, 'loss_val': 1.1443272818166956, 'psi': 0.71383479128146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=87 head_norm_before_train=1.942834 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=87 local utility u=0.012034 metrics={'f1_val': 0.6189738607498521, 'auprc': 0.7955587057224471, 'loss_val': 0.6318568584427687, 'psi': 0.6896077987388901}-{'f1_val': 0.6072958736572089, 'auprc': 0.7947772991702498, 'loss_val': 0.5835125381417571, 'psi': 0.6822884438624253}
[S8] START round=87 head_norm_before_train=2.011219 cos_to_last_merge=0.8621 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.862
[S8] round=87 local utility u=0.085553 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9994028167532588, 'loss_val': 0.02689077076066089, 'psi': 0.9954974501802727}-{'f1_val': 0.9703778840528637, 'auprc': 0.9987947220611665, 'loss_val': 0.061076603752277844, 'psi': 0.9817446192561848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=87 head_norm_before_train=2.125022 cos_to_last_merge=0.9728 (last merge round=21)
[S9] round=87 local utility u=0.039015 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999203024153488, 'loss_val': 0.015268927002068238, 'psi': 0.9979429571686809}-{'f1_val': 0.9887042205730695, 'auprc': 0.999181121690585, 'loss_val': 0.042841007179792535, 'psi': 0.9928949810200758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=87 head_norm_before_train=1.924938 cos_to_last_merge=0.8822 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.882
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967963099577877, 'loss_val': 0.025245586816326476, 'psi': 0.9956994359021607}-{'f1_val': 0.9949681865317428, 'auprc': 0.9968294244424958, 'loss_val': 0.02519694646268483, 'psi': 0.995712681696044}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=1.986963 cos_to_last_merge=0.9304 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9964364589810413, 'auprc': 0.9990536639596612, 'loss_val': 0.018229102656624547, 'psi': 0.9974833409724893}-{'f1_val': 0.9971593530989756, 'auprc': 0.9990026637754305, 'loss_val': 0.01680915401048933, 'psi': 0.9978966773695577}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.594007 cos_to_last_merge=0.8657 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.866
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6183279862424045, 'auprc': 0.7727831687669976, 'loss_val': 0.9700935866869688, 'psi': 0.6801100592522418}-{'f1_val': 0.6589974128350584, 'auprc': 0.7708733993471484, 'loss_val': 0.9356801080620007, 'psi': 0.7037478074398944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=1.954847 cos_to_last_merge=1.0000 (last merge round=85)
[S14] round=87 local utility u=0.003777 metrics={'f1_val': 0.9969426239952937, 'auprc': 0.9992307953958742, 'loss_val': 0.02600460679171267, 'psi': 0.9978578925555259}-{'f1_val': 0.996333081002392, 'auprc': 0.9992307866841066, 'loss_val': 0.02990219753243984, 'psi': 0.9974921632750778}
[S15] START round=87 head_norm_before_train=2.260370 cos_to_last_merge=0.9462 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.75143985491048, 'auprc': 0.9355668404124502, 'loss_val': 0.601952601138029, 'psi': 0.8250906491112682}-{'f1_val': 0.7773144643648614, 'auprc': 0.9791314522829735, 'loss_val': 0.5027378699005304, 'psi': 0.8580412595321063}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.961447 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9907021735795233, 'loss_val': 0.03374703977709851, 'psi': 0.9921670489218228}-{'f1_val': 0.9931436324833557, 'auprc': 0.9906156093043648, 'loss_val': 0.03330257744466773, 'psi': 0.9921324232117594}
[S17] START round=87 head_norm_before_train=2.206369 (no previous merge yet)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.6284437572975761, 'auprc': 0.992150756795663, 'loss_val': 1.5003520754547608, 'psi': 0.7739265570968108}-{'f1_val': 0.8680380916389288, 'auprc': 0.9862268608313829, 'loss_val': 0.5766620715834837, 'psi': 0.9153135993159104}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=87 metric=0.9931 head_norm=1.964458
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.357250e-03
[S16] stored merged vector for next round verification (round=87)
[S16] DEBUG after merge:  round=87 metric=0.9931 head_norm=1.964432 delta_norm=0.009357
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9998
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=87 metric=0.6190 head_norm=1.945988
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.593082e-02
[S7] stored merged vector for next round verification (round=87)
[S7] DEBUG after merge:  round=87 metric=0.6186 head_norm=1.951520 delta_norm=0.015931
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=87 metric=0.9969 head_norm=1.959507
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.822699e-02
[S14] stored merged vector for next round verification (round=87)
[S14] DEBUG after merge:  round=87 metric=0.9969 head_norm=1.952674 delta_norm=0.018227
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=1.971024 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=88 local utility u=0.004689 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9930648715247421, 'loss_val': 0.40946446537843967, 'psi': 0.8956196022341888}-{'f1_val': 0.8306467290261653, 'auprc': 0.9918983262097196, 'loss_val': 0.4152873848612682, 'psi': 0.895147367899587}
[S3] START round=88 head_norm_before_train=2.073829 cos_to_last_merge=0.9018 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=88 local utility u=0.080806 metrics={'f1_val': 0.9967134310892349, 'auprc': 0.9979339247284754, 'loss_val': 0.023527898958177317, 'psi': 0.9972016285449311}-{'f1_val': 0.9770615005749399, 'auprc': 0.997514763315227, 'loss_val': 0.06597031928881372, 'psi': 0.9852428056710547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=88 head_norm_before_train=1.684307 cos_to_last_merge=0.8468 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.932310422980058, 'auprc': 0.956660765592098, 'loss_val': 0.3012479585687477, 'psi': 0.942050560024874}-{'f1_val': 0.933149635958506, 'auprc': 0.9631173412086604, 'loss_val': 0.29514117010755003, 'psi': 0.9451367180585678}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.716549 cos_to_last_merge=0.8805 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.881
[S5] round=88 local utility u=0.004840 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9911047929451087, 'loss_val': 0.052200024807349935, 'psi': 0.9949038678896387}-{'f1_val': 0.9966309045197074, 'auprc': 0.9911202796278603, 'loss_val': 0.05709162046296156, 'psi': 0.9944266545629685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=88 head_norm_before_train=2.250343 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.8334130300240297, 'auprc': 0.9591323373756268, 'loss_val': 0.49446180802156153, 'psi': 0.8837007529646685}-{'f1_val': 0.8764987992556258, 'auprc': 0.9691425364274164, 'loss_val': 0.30631471384738274, 'psi': 0.913556294124342}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.951520 cos_to_last_merge=1.0000 (last merge round=87)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.562271073484705, 'auprc': 0.7851753155818814, 'loss_val': 0.9996044914220715, 'psi': 0.6514327703235755}-{'f1_val': 0.6189738607498521, 'auprc': 0.7955587057224471, 'loss_val': 0.6318568584427687, 'psi': 0.6896077987388901}
[S8] START round=88 head_norm_before_train=2.016464 cos_to_last_merge=0.8614 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.861
[S8] round=88 local utility u=0.003378 metrics={'f1_val': 0.9942365916980355, 'auprc': 0.9988366958444455, 'loss_val': 0.026491851898584357, 'psi': 0.9960766333565995}-{'f1_val': 0.9928938724649488, 'auprc': 0.9994028167532588, 'loss_val': 0.02689077076066089, 'psi': 0.9954974501802727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=88 head_norm_before_train=2.129738 cos_to_last_merge=0.9727 (last merge round=21)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988126627665007, 'loss_val': 0.0161684366174321, 'psi': 0.9975213721949352}-{'f1_val': 0.9971029125121428, 'auprc': 0.999203024153488, 'loss_val': 0.015268927002068238, 'psi': 0.9979429571686809}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=1.926374 cos_to_last_merge=0.8815 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=88 local utility u=0.000056 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967945107368805, 'loss_val': 0.025128607252810877, 'psi': 0.9956987162137979}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967963099577877, 'loss_val': 0.025245586816326476, 'psi': 0.9956994359021607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=88 head_norm_before_train=1.990875 cos_to_last_merge=0.9301 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9983386538035878, 'loss_val': 0.018287421861238242, 'psi': 0.9973830698053041}-{'f1_val': 0.9964364589810413, 'auprc': 0.9990536639596612, 'loss_val': 0.018229102656624547, 'psi': 0.9974833409724893}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.599153 cos_to_last_merge=0.8648 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=88 local utility u=0.120810 metrics={'f1_val': 0.6403441663718076, 'auprc': 0.7734549758729432, 'loss_val': 0.8625864488113932, 'psi': 0.6935884901722618}-{'f1_val': 0.6183279862424045, 'auprc': 0.7727831687669976, 'loss_val': 0.9700935866869688, 'psi': 0.6801100592522418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=88 head_norm_before_train=1.952674 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=88 local utility u=0.001864 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9992311657487456, 'loss_val': 0.02492158586350193, 'psi': 0.9981224963167021}-{'f1_val': 0.9969426239952937, 'auprc': 0.9992307953958742, 'loss_val': 0.02600460679171267, 'psi': 0.9978578925555259}
[S15] START round=88 head_norm_before_train=2.265650 cos_to_last_merge=0.9458 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=88 local utility u=1.000000 metrics={'f1_val': 0.9936080333345573, 'auprc': 0.9972707891799286, 'loss_val': 0.03347019192639724, 'psi': 0.9950731356727058}-{'f1_val': 0.75143985491048, 'auprc': 0.9355668404124502, 'loss_val': 0.601952601138029, 'psi': 0.8250906491112682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=88 head_norm_before_train=1.964432 cos_to_last_merge=1.0000 (last merge round=87)
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9809280160551774, 'auprc': 0.9858874118757406, 'loss_val': 0.07525669783666768, 'psi': 0.9829117743834026}-{'f1_val': 0.9931436324833557, 'auprc': 0.9907021735795233, 'loss_val': 0.03374703977709851, 'psi': 0.9921670489218228}
[S17] START round=88 head_norm_before_train=2.210371 (no previous merge yet)
[S17] round=88 local utility u=0.453577 metrics={'f1_val': 0.7124293198486319, 'auprc': 0.9909420696987712, 'loss_val': 1.0934855739117402, 'psi': 0.8238344197886877}-{'f1_val': 0.6284437572975761, 'auprc': 0.992150756795663, 'loss_val': 1.5003520754547608, 'psi': 0.7739265570968108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=88 metric=0.9809 head_norm=1.967154
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.204650e-03
[S16] stored merged vector for next round verification (round=88)
[S16] DEBUG after merge:  round=88 metric=0.9809 head_norm=1.969068 delta_norm=0.009205
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=1.0000
[S2] START round=89 head_norm_before_train=1.977771 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=89 local utility u=0.003549 metrics={'f1_val': 0.8306467290261653, 'auprc': 0.9922293010447996, 'loss_val': 0.3998032916834306, 'psi': 0.895279757833619}-{'f1_val': 0.83065608937382, 'auprc': 0.9930648715247421, 'loss_val': 0.40946446537843967, 'psi': 0.8956196022341888}
[S3] START round=89 head_norm_before_train=2.078995 cos_to_last_merge=0.9014 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=89 local utility u=0.004741 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9979561748674785, 'loss_val': 0.01839449633951626, 'psi': 0.9976387475189259}-{'f1_val': 0.9967134310892349, 'auprc': 0.9979339247284754, 'loss_val': 0.023527898958177317, 'psi': 0.9972016285449311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=89 head_norm_before_train=1.687569 cos_to_last_merge=0.8464 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=89 local utility u=0.033465 metrics={'f1_val': 0.9382017608546204, 'auprc': 0.9624267784745228, 'loss_val': 0.28696453668476224, 'psi': 0.9478917679025813}-{'f1_val': 0.932310422980058, 'auprc': 0.956660765592098, 'loss_val': 0.3012479585687477, 'psi': 0.942050560024874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=89 head_norm_before_train=1.721839 cos_to_last_merge=0.8797 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=89 local utility u=0.001170 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9911040592554394, 'loss_val': 0.04502333741108293, 'psi': 0.9944201664140002}-{'f1_val': 0.9974365845193254, 'auprc': 0.9911047929451087, 'loss_val': 0.052200024807349935, 'psi': 0.9949038678896387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=89 head_norm_before_train=2.256270 (no previous merge yet)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.798406273693049, 'auprc': 0.9403570467260096, 'loss_val': 0.6120349818293246, 'psi': 0.8551865829062333}-{'f1_val': 0.8334130300240297, 'auprc': 0.9591323373756268, 'loss_val': 0.49446180802156153, 'psi': 0.8837007529646685}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.954773 cos_to_last_merge=1.0000 (last merge round=87)
[S7] round=89 local utility u=0.703216 metrics={'f1_val': 0.6674869720577581, 'auprc': 0.8271633944008231, 'loss_val': 0.3504315483707954, 'psi': 0.7313575409949842}-{'f1_val': 0.562271073484705, 'auprc': 0.7851753155818814, 'loss_val': 0.9996044914220715, 'psi': 0.6514327703235755}
[S8] START round=89 head_norm_before_train=2.021586 cos_to_last_merge=0.8609 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.861
[S8] round=89 local utility u=0.003597 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9992847367909151, 'loss_val': 0.02397888435103837, 'psi': 0.9965894800087427}-{'f1_val': 0.9942365916980355, 'auprc': 0.9988366958444455, 'loss_val': 0.026491851898584357, 'psi': 0.9960766333565995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=89 head_norm_before_train=2.135092 cos_to_last_merge=0.9725 (last merge round=21)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988155445589996, 'loss_val': 0.017137623635045646, 'psi': 0.9975225249119347}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988126627665007, 'loss_val': 0.0161684366174321, 'psi': 0.9975213721949352}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=1.928729 cos_to_last_merge=0.8808 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=89 local utility u=0.000038 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996797308326904, 'loss_val': 0.02506013235264559, 'psi': 0.9956998352498073}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967945107368805, 'loss_val': 0.025128607252810877, 'psi': 0.9956987162137979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=89 head_norm_before_train=1.992896 cos_to_last_merge=0.9299 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9950625808443119, 'auprc': 0.9984700756140777, 'loss_val': 0.023417258490282773, 'psi': 0.9964255787522183}-{'f1_val': 0.9967460138064482, 'auprc': 0.9983386538035878, 'loss_val': 0.018287421861238242, 'psi': 0.9973830698053041}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.605780 cos_to_last_merge=0.8639 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.864
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6329602362245916, 'auprc': 0.7531647490925657, 'loss_val': 0.9378993067095177, 'psi': 0.6810420413717813}-{'f1_val': 0.6403441663718076, 'auprc': 0.7734549758729432, 'loss_val': 0.8625864488113932, 'psi': 0.6935884901722618}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=1.957060 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9501392258786329, 'auprc': 0.9988558046225331, 'loss_val': 0.06417303546996797, 'psi': 0.969625857376193}-{'f1_val': 0.9973833833620065, 'auprc': 0.9992311657487456, 'loss_val': 0.02492158586350193, 'psi': 0.9981224963167021}
[S15] START round=89 head_norm_before_train=2.270346 cos_to_last_merge=0.9457 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=89 local utility u=0.010429 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9964826297409265, 'loss_val': 0.026594724093520466, 'psi': 0.9963924984056551}-{'f1_val': 0.9936080333345573, 'auprc': 0.9972707891799286, 'loss_val': 0.03347019192639724, 'psi': 0.9950731356727058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=89 head_norm_before_train=1.969068 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9476280547049705, 'auprc': 0.9806769988868398, 'loss_val': 0.1742563586828051, 'psi': 0.9608476323777182}-{'f1_val': 0.9809280160551774, 'auprc': 0.9858874118757406, 'loss_val': 0.07525669783666768, 'psi': 0.9829117743834026}
[S17] START round=89 head_norm_before_train=2.212024 (no previous merge yet)
[S17] round=89 local utility u=0.893651 metrics={'f1_val': 0.9117170453086895, 'auprc': 0.9871348770641589, 'loss_val': 0.49048892978644504, 'psi': 0.9418841780108773}-{'f1_val': 0.7124293198486319, 'auprc': 0.9909420696987712, 'loss_val': 1.0934855739117402, 'psi': 0.8238344197886877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=89 metric=0.9476 head_norm=1.972652
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.007032e-03
[S16] stored merged vector for next round verification (round=89)
[S16] DEBUG after merge:  round=89 metric=0.9476 head_norm=1.975197 delta_norm=0.008007
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1794) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=89 metric=0.6675 head_norm=1.956965
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.293656e-03
[S7] stored merged vector for next round verification (round=89)
[S7] DEBUG after merge:  round=89 metric=0.6676 head_norm=1.957002 delta_norm=0.006294
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=1.980640 cos_to_last_merge=1.0000 (last merge round=85)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.8308251537373625, 'auprc': 0.9407326907284835, 'loss_val': 0.3925868261924654, 'psi': 0.8747881685338109}-{'f1_val': 0.8306467290261653, 'auprc': 0.9922293010447996, 'loss_val': 0.3998032916834306, 'psi': 0.895279757833619}
[S3] START round=90 head_norm_before_train=2.084738 cos_to_last_merge=0.9010 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8303413784202375, 'auprc': 0.9964953317726688, 'loss_val': 0.22918215396712446, 'psi': 0.8968029597612099}-{'f1_val': 0.9974271292865575, 'auprc': 0.9979561748674785, 'loss_val': 0.01839449633951626, 'psi': 0.9976387475189259}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.690743 cos_to_last_merge=0.8461 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9326178775751696, 'auprc': 0.9542239668051311, 'loss_val': 0.29450668402409313, 'psi': 0.9412603132671542}-{'f1_val': 0.9382017608546204, 'auprc': 0.9624267784745228, 'loss_val': 0.28696453668476224, 'psi': 0.9478917679025813}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.730896 cos_to_last_merge=0.8778 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.878
[S5] round=90 local utility u=0.002641 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.991102882225346, 'loss_val': 0.03973865422204497, 'psi': 0.9944196956019629}-{'f1_val': 0.9966309045197074, 'auprc': 0.9911040592554394, 'loss_val': 0.04502333741108293, 'psi': 0.9944201664140002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=90 head_norm_before_train=2.264005 (no previous merge yet)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.6589700735320737, 'auprc': 0.8513439458151401, 'loss_val': 0.9342258075487933, 'psi': 0.7359196224453002}-{'f1_val': 0.798406273693049, 'auprc': 0.9403570467260096, 'loss_val': 0.6120349818293246, 'psi': 0.8551865829062333}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.957002 cos_to_last_merge=1.0000 (last merge round=89)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5842943182663444, 'auprc': 0.7884854539568456, 'loss_val': 0.7946790177118699, 'psi': 0.6659707725425448}-{'f1_val': 0.6674869720577581, 'auprc': 0.8271633944008231, 'loss_val': 0.3504315483707954, 'psi': 0.7313575409949842}
[S8] START round=90 head_norm_before_train=2.025428 cos_to_last_merge=0.8607 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.861
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9990452284643381, 'loss_val': 0.025878749136926987, 'psi': 0.9956130917640197}-{'f1_val': 0.994792642153961, 'auprc': 0.9992847367909151, 'loss_val': 0.02397888435103837, 'psi': 0.9965894800087427}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=2.138788 cos_to_last_merge=0.9721 (last merge round=21)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998815011026302, 'loss_val': 0.017226597636593968, 'psi': 0.9975223114988556}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988155445589996, 'loss_val': 0.017137623635045646, 'psi': 0.9975225249119347}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=1.932598 cos_to_last_merge=0.8802 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967920534058367, 'loss_val': 0.02510787718746786, 'psi': 0.9956977332813803}-{'f1_val': 0.9949681865317428, 'auprc': 0.996797308326904, 'loss_val': 0.02506013235264559, 'psi': 0.9956998352498073}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=1.995370 cos_to_last_merge=0.9296 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=90 local utility u=0.007782 metrics={'f1_val': 0.9965049253513184, 'auprc': 0.9989140769676288, 'loss_val': 0.01783874069079475, 'psi': 0.9974685859978426}-{'f1_val': 0.9950625808443119, 'auprc': 0.9984700756140777, 'loss_val': 0.023417258490282773, 'psi': 0.9964255787522183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=90 head_norm_before_train=1.612111 cos_to_last_merge=0.8631 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.863
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.639333346123143, 'auprc': 0.7653190416845501, 'loss_val': 1.0559260567396616, 'psi': 0.6897276243477057}-{'f1_val': 0.6329602362245916, 'auprc': 0.7531647490925657, 'loss_val': 0.9378993067095177, 'psi': 0.6810420413717813}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=1.962582 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=90 local utility u=0.126501 metrics={'f1_val': 0.987289496046933, 'auprc': 0.9988565648232869, 'loss_val': 0.03407506384181785, 'psi': 0.9919163235574745}-{'f1_val': 0.9501392258786329, 'auprc': 0.9988558046225331, 'loss_val': 0.06417303546996797, 'psi': 0.969625857376193}
[S15] START round=90 head_norm_before_train=2.275024 cos_to_last_merge=0.9454 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.8741630918128686, 'auprc': 0.9913920952137794, 'loss_val': 0.31641001720386447, 'psi': 0.9210546931732329}-{'f1_val': 0.9963324108488076, 'auprc': 0.9964826297409265, 'loss_val': 0.026594724093520466, 'psi': 0.9963924984056551}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.975197 cos_to_last_merge=1.0000 (last merge round=89)
[S16] round=90 local utility u=0.216875 metrics={'f1_val': 0.9948368183563289, 'auprc': 0.9857189103421804, 'loss_val': 0.0388847149549666, 'psi': 0.9911896551506695}-{'f1_val': 0.9476280547049705, 'auprc': 0.9806769988868398, 'loss_val': 0.1742563586828051, 'psi': 0.9608476323777182}
[S17] START round=90 head_norm_before_train=2.216140 (no previous merge yet)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.6830976869486245, 'auprc': 0.9920236083449547, 'loss_val': 1.1999425074602594, 'psi': 0.8066680555071566}-{'f1_val': 0.9117170453086895, 'auprc': 0.9871348770641589, 'loss_val': 0.49048892978644504, 'psi': 0.9418841780108773}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61808
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S2] ⇄ pheromone p=0.047 → S16@127.0.0.1:61816
[S7] ⇄ pheromone p=0.189 → S14@127.0.0.1:61814
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=90 metric=0.9873 head_norm=1.970703
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.151201e-02
[S14] stored merged vector for next round verification (round=90)
[S14] DEBUG after merge:  round=90 metric=0.9873 head_norm=1.963812 delta_norm=0.011512
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.035 → S7@127.0.0.1:61808
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=90 metric=0.9948 head_norm=1.976895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.298893e-03
[S16] stored merged vector for next round verification (round=90)
[S16] DEBUG after merge:  round=90 metric=0.9946 head_norm=1.978751 delta_norm=0.008299
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.085 → S2@127.0.0.1:61802
[S2] START round=91 head_norm_before_train=1.982593 cos_to_last_merge=0.9999 (last merge round=85)
[S2] round=91 local utility u=0.014027 metrics={'f1_val': 0.8283121732527882, 'auprc': 0.9625305320942815, 'loss_val': 0.4148489770617717, 'psi': 0.8819995167893855}-{'f1_val': 0.8308251537373625, 'auprc': 0.9407326907284835, 'loss_val': 0.3925868261924654, 'psi': 0.8747881685338109}
[S3] START round=91 head_norm_before_train=2.088698 cos_to_last_merge=0.9007 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=91 local utility u=0.342371 metrics={'f1_val': 0.9420456500641247, 'auprc': 0.997079531192106, 'loss_val': 0.21641850287229164, 'psi': 0.9640592025153172}-{'f1_val': 0.8303413784202375, 'auprc': 0.9964953317726688, 'loss_val': 0.22918215396712446, 'psi': 0.8968029597612099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=91 head_norm_before_train=1.691957 cos_to_last_merge=0.8459 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=91 local utility u=0.006347 metrics={'f1_val': 0.9354387816874913, 'auprc': 0.9471269743623156, 'loss_val': 0.277447170652117, 'psi': 0.940114058757421}-{'f1_val': 0.9326178775751696, 'auprc': 0.9542239668051311, 'loss_val': 0.29450668402409313, 'psi': 0.9412603132671542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=91 head_norm_before_train=1.746468 cos_to_last_merge=0.8747 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=91 local utility u=0.000761 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9911515384729791, 'loss_val': 0.03836281551351933, 'psi': 0.994439158101016}-{'f1_val': 0.9966309045197074, 'auprc': 0.991102882225346, 'loss_val': 0.03973865422204497, 'psi': 0.9944196956019629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S5] sending update (kind=head size=1812 to 1 peers)
[S6] START round=91 head_norm_before_train=2.268766 (no previous merge yet)
[S6] round=91 local utility u=0.205782 metrics={'f1_val': 0.7269226834521895, 'auprc': 0.8644553350545894, 'loss_val': 0.9697107504499953, 'psi': 0.7819357440931494}-{'f1_val': 0.6589700735320737, 'auprc': 0.8513439458151401, 'loss_val': 0.9342258075487933, 'psi': 0.7359196224453002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=91 head_norm_before_train=1.959324 cos_to_last_merge=1.0000 (last merge round=89)
[S7] round=91 local utility u=0.093189 metrics={'f1_val': 0.6024841981634159, 'auprc': 0.7952764311421443, 'loss_val': 0.7378137378324042, 'psi': 0.6796010913549073}-{'f1_val': 0.5842943182663444, 'auprc': 0.7884854539568456, 'loss_val': 0.7946790177118699, 'psi': 0.6659707725425448}
[S8] START round=91 head_norm_before_train=2.028325 cos_to_last_merge=0.8606 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.861
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9905670338062451, 'auprc': 0.9983171654816536, 'loss_val': 0.03303029990314798, 'psi': 0.9936670864764084}-{'f1_val': 0.9933250006304741, 'auprc': 0.9990452284643381, 'loss_val': 0.025878749136926987, 'psi': 0.9956130917640197}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.142155 cos_to_last_merge=0.9717 (last merge round=21)
[S9] round=91 local utility u=0.000015 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988156506008014, 'loss_val': 0.017197735350103126, 'psi': 0.9975225673286554}-{'f1_val': 0.9966605118138915, 'auprc': 0.998815011026302, 'loss_val': 0.017226597636593968, 'psi': 0.9975223114988556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=91 head_norm_before_train=1.933913 cos_to_last_merge=0.8795 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=91 local utility u=0.000047 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967917359047681, 'loss_val': 0.025013416229979032, 'psi': 0.9956976062809529}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967920534058367, 'loss_val': 0.02510787718746786, 'psi': 0.9956977332813803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=91 head_norm_before_train=1.999509 cos_to_last_merge=0.9293 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9980255085750528, 'loss_val': 0.01857030886221559, 'psi': 0.99725781171389}-{'f1_val': 0.9965049253513184, 'auprc': 0.9989140769676288, 'loss_val': 0.01783874069079475, 'psi': 0.9974685859978426}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.617174 cos_to_last_merge=0.8623 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=91 local utility u=0.143958 metrics={'f1_val': 0.6780144307583725, 'auprc': 0.7744113161359982, 'loss_val': 1.027372926035481, 'psi': 0.7165731849094228}-{'f1_val': 0.639333346123143, 'auprc': 0.7653190416845501, 'loss_val': 1.0559260567396616, 'psi': 0.6897276243477057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=91 head_norm_before_train=1.963812 cos_to_last_merge=1.0000 (last merge round=90)
[S14] round=91 local utility u=0.039672 metrics={'f1_val': 0.9979907967189754, 'auprc': 0.9992310387817871, 'loss_val': 0.02006218688687262, 'psi': 0.9984868935441}-{'f1_val': 0.987289496046933, 'auprc': 0.9988565648232869, 'loss_val': 0.03407506384181785, 'psi': 0.9919163235574745}
[S15] START round=91 head_norm_before_train=2.280157 cos_to_last_merge=0.9450 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=91 local utility u=0.519390 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9964454166837265, 'loss_val': 0.025547818909770394, 'psi': 0.9963518727773665}-{'f1_val': 0.8741630918128686, 'auprc': 0.9913920952137794, 'loss_val': 0.31641001720386447, 'psi': 0.9210546931732329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=91 head_norm_before_train=1.978751 cos_to_last_merge=1.0000 (last merge round=90)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9926131711491226, 'auprc': 0.9905450215796732, 'loss_val': 0.04812533562210569, 'psi': 0.9917859113213429}-{'f1_val': 0.9948368183563289, 'auprc': 0.9857189103421804, 'loss_val': 0.0388847149549666, 'psi': 0.9911896551506695}
[S17] START round=91 head_norm_before_train=2.220416 (no previous merge yet)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.6726757980039125, 'auprc': 0.9967520832324659, 'loss_val': 1.2051320970271497, 'psi': 0.8023063120953339}-{'f1_val': 0.6830976869486245, 'auprc': 0.9920236083449547, 'loss_val': 1.1999425074602594, 'psi': 0.8066680555071566}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=1.0000
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=91 metric=0.6025 head_norm=1.963055
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.938643e-03
[S7] stored merged vector for next round verification (round=91)
[S7] DEBUG after merge:  round=91 metric=0.6032 head_norm=1.967482 delta_norm=0.008939
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=91 metric=0.8283 head_norm=1.986205
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.238289e-02
[S2] stored merged vector for next round verification (round=91)
[S2] DEBUG after merge:  round=91 metric=0.8283 head_norm=1.981517 delta_norm=0.012383
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=91 metric=0.9980 head_norm=1.973189
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.465526e-03
[S14] stored merged vector for next round verification (round=91)
[S14] DEBUG after merge:  round=91 metric=0.9980 head_norm=1.968110 delta_norm=0.008466
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=1.981517 cos_to_last_merge=1.0000 (last merge round=91)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.825965551981132, 'auprc': 0.9561944040061947, 'loss_val': 0.4149284555208082, 'psi': 0.8780570927911571}-{'f1_val': 0.8283121732527882, 'auprc': 0.9625305320942815, 'loss_val': 0.4148489770617717, 'psi': 0.8819995167893855}
[S3] START round=92 head_norm_before_train=2.092669 cos_to_last_merge=0.9006 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.8206422830568001, 'auprc': 0.9968201491540544, 'loss_val': 0.2591650119532386, 'psi': 0.8911134294957018}-{'f1_val': 0.9420456500641247, 'auprc': 0.997079531192106, 'loss_val': 0.21641850287229164, 'psi': 0.9640592025153172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.693550 cos_to_last_merge=0.8458 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=92 local utility u=0.023500 metrics={'f1_val': 0.9404778928501758, 'auprc': 0.9475484140295733, 'loss_val': 0.26194666024978075, 'psi': 0.9433061013219348}-{'f1_val': 0.9354387816874913, 'auprc': 0.9471269743623156, 'loss_val': 0.277447170652117, 'psi': 0.940114058757421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=92 head_norm_before_train=1.761643 cos_to_last_merge=0.8717 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=92 local utility u=0.001939 metrics={'f1_val': 0.9969979269756446, 'auprc': 0.9942080841873604, 'loss_val': 0.04585575026649429, 'psi': 0.9958819898603309}-{'f1_val': 0.9966309045197074, 'auprc': 0.9911515384729791, 'loss_val': 0.03836281551351933, 'psi': 0.994439158101016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=92 head_norm_before_train=2.272944 (no previous merge yet)
[S6] round=92 local utility u=0.717030 metrics={'f1_val': 0.8419743409915442, 'auprc': 0.9630711921598406, 'loss_val': 0.5218089795545968, 'psi': 0.8904130814588628}-{'f1_val': 0.7269226834521895, 'auprc': 0.8644553350545894, 'loss_val': 0.9697107504499953, 'psi': 0.7819357440931494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=92 head_norm_before_train=1.967482 cos_to_last_merge=1.0000 (last merge round=91)
[S7] round=92 local utility u=0.528364 metrics={'f1_val': 0.687709635580959, 'auprc': 0.8370262613500454, 'loss_val': 0.3176871696598378, 'psi': 0.7474362858885936}-{'f1_val': 0.6024841981634159, 'auprc': 0.7952764311421443, 'loss_val': 0.7378137378324042, 'psi': 0.6796010913549073}
[S8] START round=92 head_norm_before_train=2.030828 cos_to_last_merge=0.8604 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.860
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9774796919891368, 'auprc': 0.9987684080048629, 'loss_val': 0.04641644646020712, 'psi': 0.9859951783954273}-{'f1_val': 0.9905670338062451, 'auprc': 0.9983171654816536, 'loss_val': 0.03303029990314798, 'psi': 0.9936670864764084}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.143921 cos_to_last_merge=0.9712 (last merge round=21)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9924766112057334, 'auprc': 0.9988155818361021, 'loss_val': 0.025296109787044427, 'psi': 0.9950121994578809}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988156506008014, 'loss_val': 0.017197735350103126, 'psi': 0.9975225673286554}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=1.936930 cos_to_last_merge=0.8788 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967853698788692, 'loss_val': 0.025172568809533172, 'psi': 0.9956950598705934}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967917359047681, 'loss_val': 0.025013416229979032, 'psi': 0.9956976062809529}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.004414 cos_to_last_merge=0.9289 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9976219871781142, 'loss_val': 0.018818564100491233, 'psi': 0.9970964031551146}-{'f1_val': 0.9967460138064482, 'auprc': 0.9980255085750528, 'loss_val': 0.01857030886221559, 'psi': 0.99725781171389}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.623030 cos_to_last_merge=0.8610 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.861
[S13] round=92 local utility u=0.023222 metrics={'f1_val': 0.6572333731159156, 'auprc': 0.75221173495513, 'loss_val': 0.7896446011067568, 'psi': 0.6952247178516013}-{'f1_val': 0.6780144307583725, 'auprc': 0.7744113161359982, 'loss_val': 1.027372926035481, 'psi': 0.7165731849094228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=92 head_norm_before_train=1.968110 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9975795452795295, 'auprc': 0.9992298495864278, 'loss_val': 0.019602752507655963, 'psi': 0.9982396670022888}-{'f1_val': 0.9979907967189754, 'auprc': 0.9992310387817871, 'loss_val': 0.02006218688687262, 'psi': 0.9984868935441}
[S15] START round=92 head_norm_before_train=2.285435 cos_to_last_merge=0.9447 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9190535079784992, 'auprc': 0.9961662404831835, 'loss_val': 0.13370083866588267, 'psi': 0.9498986009803729}-{'f1_val': 0.9962895101731264, 'auprc': 0.9964454166837265, 'loss_val': 0.025547818909770394, 'psi': 0.9963518727773665}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=1.984035 cos_to_last_merge=1.0000 (last merge round=90)
[S16] round=92 local utility u=0.006764 metrics={'f1_val': 0.9931146216333134, 'auprc': 0.9900059091843135, 'loss_val': 0.0359886759669504, 'psi': 0.9918711366537135}-{'f1_val': 0.9926131711491226, 'auprc': 0.9905450215796732, 'loss_val': 0.04812533562210569, 'psi': 0.9917859113213429}
[S17] START round=92 head_norm_before_train=2.224708 (no previous merge yet)
[S17] round=92 local utility u=0.345647 metrics={'f1_val': 0.7382702243489356, 'auprc': 0.9894059918080239, 'loss_val': 0.8853668691606946, 'psi': 0.8387245313325709}-{'f1_val': 0.6726757980039125, 'auprc': 0.9967520832324659, 'loss_val': 1.2051320970271497, 'psi': 0.8023063120953339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=1.0000
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=92 metric=0.9931 head_norm=1.990542
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.553783e-03
[S16] stored merged vector for next round verification (round=92)
[S16] DEBUG after merge:  round=92 metric=0.9931 head_norm=1.988352 delta_norm=0.009554
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=1.984876 cos_to_last_merge=1.0000 (last merge round=91)
[S2] round=93 local utility u=0.069329 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9928443292563828, 'loss_val': 0.4143630850122493, 'psi': 0.8955313853268451}-{'f1_val': 0.825965551981132, 'auprc': 0.9561944040061947, 'loss_val': 0.4149284555208082, 'psi': 0.8780570927911571}
[S3] START round=93 head_norm_before_train=2.097463 cos_to_last_merge=0.9003 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=93 local utility u=0.411484 metrics={'f1_val': 0.9370807984033966, 'auprc': 0.9974881113323495, 'loss_val': 0.13683159236495807, 'psi': 0.9612437235749778}-{'f1_val': 0.8206422830568001, 'auprc': 0.9968201491540544, 'loss_val': 0.2591650119532386, 'psi': 0.8911134294957018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] sending update (kind=head size=1789 to 1 peers)
[S4] START round=93 head_norm_before_train=1.692593 cos_to_last_merge=0.8466 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=93 local utility u=0.025767 metrics={'f1_val': 0.942945824412826, 'auprc': 0.9590813432886995, 'loss_val': 0.25981847143433584, 'psi': 0.9494000319631755}-{'f1_val': 0.9404778928501758, 'auprc': 0.9475484140295733, 'loss_val': 0.26194666024978075, 'psi': 0.9433061013219348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=93 head_norm_before_train=1.774166 cos_to_last_merge=0.8695 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9836513175817466, 'auprc': 0.990604963740586, 'loss_val': 0.057769585627720436, 'psi': 0.9864327760452825}-{'f1_val': 0.9969979269756446, 'auprc': 0.9942080841873604, 'loss_val': 0.04585575026649429, 'psi': 0.9958819898603309}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.279513 (no previous merge yet)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7774300697420398, 'auprc': 0.9150155891307795, 'loss_val': 0.8888463031547704, 'psi': 0.8324642774975357}-{'f1_val': 0.8419743409915442, 'auprc': 0.9630711921598406, 'loss_val': 0.5218089795545968, 'psi': 0.8904130814588628}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.971610 cos_to_last_merge=1.0000 (last merge round=91)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.575287386277384, 'auprc': 0.7841236992073435, 'loss_val': 0.9097331596097277, 'psi': 0.6588219114493679}-{'f1_val': 0.687709635580959, 'auprc': 0.8370262613500454, 'loss_val': 0.3176871696598378, 'psi': 0.7474362858885936}
[S8] START round=93 head_norm_before_train=2.033753 cos_to_last_merge=0.8602 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.860
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9717155267819237, 'auprc': 0.9986772809827605, 'loss_val': 0.057523880102424346, 'psi': 0.9825002284622584}-{'f1_val': 0.9774796919891368, 'auprc': 0.9987684080048629, 'loss_val': 0.04641644646020712, 'psi': 0.9859951783954273}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.145377 cos_to_last_merge=0.9709 (last merge round=21)
[S9] round=93 local utility u=0.018951 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991783129149643, 'loss_val': 0.01623949745116809, 'psi': 0.9979330726732714}-{'f1_val': 0.9924766112057334, 'auprc': 0.9988155818361021, 'loss_val': 0.025296109787044427, 'psi': 0.9950121994578809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=93 head_norm_before_train=1.941182 cos_to_last_merge=0.8784 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=93 local utility u=0.000012 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967851651417011, 'loss_val': 0.025147950715679563, 'psi': 0.9956949779757261}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967853698788692, 'loss_val': 0.025172568809533172, 'psi': 0.9956950598705934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=93 head_norm_before_train=2.009674 cos_to_last_merge=0.9284 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=93 local utility u=0.001521 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9983189146902778, 'loss_val': 0.01786789478134011, 'psi': 0.9973751741599801}-{'f1_val': 0.9967460138064482, 'auprc': 0.9976219871781142, 'loss_val': 0.018818564100491233, 'psi': 0.9970964031551146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=93 head_norm_before_train=1.626230 cos_to_last_merge=0.8602 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.860
[S13] round=93 local utility u=0.030853 metrics={'f1_val': 0.6897571627830337, 'auprc': 0.7816767465898348, 'loss_val': 1.0114755745201547, 'psi': 0.7265249963057541}-{'f1_val': 0.6572333731159156, 'auprc': 0.75221173495513, 'loss_val': 0.7896446011067568, 'psi': 0.6952247178516013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=93 head_norm_before_train=1.973276 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=93 local utility u=0.000688 metrics={'f1_val': 0.9979907967189754, 'auprc': 0.9992307611783742, 'loss_val': 0.02069700133541885, 'psi': 0.9984867825027348}-{'f1_val': 0.9975795452795295, 'auprc': 0.9992298495864278, 'loss_val': 0.019602752507655963, 'psi': 0.9982396670022888}
[S15] START round=93 head_norm_before_train=2.290608 cos_to_last_merge=0.9445 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.7819471046886132, 'auprc': 0.9904771593425846, 'loss_val': 0.5112776565642391, 'psi': 0.8653591265502018}-{'f1_val': 0.9190535079784992, 'auprc': 0.9961662404831835, 'loss_val': 0.13370083866588267, 'psi': 0.9498986009803729}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=1.988352 cos_to_last_merge=1.0000 (last merge round=92)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9455193586994968, 'auprc': 0.9842716463327259, 'loss_val': 0.27403889572732687, 'psi': 0.9610202737527884}-{'f1_val': 0.9931146216333134, 'auprc': 0.9900059091843135, 'loss_val': 0.0359886759669504, 'psi': 0.9918711366537135}
[S17] START round=93 head_norm_before_train=2.229717 (no previous merge yet)
[S17] round=93 local utility u=0.697236 metrics={'f1_val': 0.9114135673467505, 'auprc': 0.9790625250496021, 'loss_val': 0.49872501739832825, 'psi': 0.9384731504278911}-{'f1_val': 0.7382702243489356, 'auprc': 0.9894059918080239, 'loss_val': 0.8853668691606946, 'psi': 0.8387245313325709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:61816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=93 metric=0.8307 head_norm=1.989964
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.739073e-03
[S2] stored merged vector for next round verification (round=93)
[S2] DEBUG after merge:  round=93 metric=0.8307 head_norm=1.990234 delta_norm=0.008739
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=93 metric=0.9980 head_norm=1.975021
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.873877e-03
[S14] stored merged vector for next round verification (round=93)
[S14] DEBUG after merge:  round=93 metric=0.9980 head_norm=1.973297 delta_norm=0.008874
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=1.990234 cos_to_last_merge=1.0000 (last merge round=93)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.8291018313669937, 'auprc': 0.992972919341085, 'loss_val': 0.43825576175812836, 'psi': 0.8946502665566303}-{'f1_val': 0.83065608937382, 'auprc': 0.9928443292563828, 'loss_val': 0.4143630850122493, 'psi': 0.8955313853268451}
[S3] START round=94 head_norm_before_train=2.102761 cos_to_last_merge=0.8999 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=94 local utility u=0.046669 metrics={'f1_val': 0.959400038305751, 'auprc': 0.9978822432378199, 'loss_val': 0.17859176258085033, 'psi': 0.9747929202785786}-{'f1_val': 0.9370807984033966, 'auprc': 0.9974881113323495, 'loss_val': 0.13683159236495807, 'psi': 0.9612437235749778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=94 head_norm_before_train=1.687666 cos_to_last_merge=0.8481 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=94 local utility u=0.014028 metrics={'f1_val': 0.9409326059202884, 'auprc': 0.9755828698164768, 'loss_val': 0.26918873569567114, 'psi': 0.9547927114787638}-{'f1_val': 0.942945824412826, 'auprc': 0.9590813432886995, 'loss_val': 0.25981847143433584, 'psi': 0.9494000319631755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=94 head_norm_before_train=1.783853 cos_to_last_merge=0.8679 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=94 local utility u=0.055268 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9939612869074272, 'loss_val': 0.035180751962774495, 'psi': 0.9955630574747953}-{'f1_val': 0.9836513175817466, 'auprc': 0.990604963740586, 'loss_val': 0.057769585627720436, 'psi': 0.9864327760452825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=94 head_norm_before_train=2.286667 (no previous merge yet)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.639413251793654, 'auprc': 0.8901902417439187, 'loss_val': 1.2028567781194894, 'psi': 0.7397240477737599}-{'f1_val': 0.7774300697420398, 'auprc': 0.9150155891307795, 'loss_val': 0.8888463031547704, 'psi': 0.8324642774975357}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.973935 cos_to_last_merge=1.0000 (last merge round=91)
[S7] round=94 local utility u=0.707927 metrics={'f1_val': 0.6873656732921782, 'auprc': 0.835498978315463, 'loss_val': 0.3204737268906037, 'psi': 0.7466189953014921}-{'f1_val': 0.575287386277384, 'auprc': 0.7841236992073435, 'loss_val': 0.9097331596097277, 'psi': 0.6588219114493679}
[S8] START round=94 head_norm_before_train=2.038081 cos_to_last_merge=0.8598 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.860
[S8] round=94 local utility u=0.085028 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9989537594059583, 'loss_val': 0.024553749587477525, 'psi': 0.996236439552353}-{'f1_val': 0.9717155267819237, 'auprc': 0.9986772809827605, 'loss_val': 0.057523880102424346, 'psi': 0.9825002284622584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=94 head_norm_before_train=2.149324 cos_to_last_merge=0.9707 (last merge round=21)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9991679653573013, 'loss_val': 0.016399387134920024, 'psi': 0.9976826809017778}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991783129149643, 'loss_val': 0.01623949745116809, 'psi': 0.9979330726732714}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=1.946089 cos_to_last_merge=0.8780 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967845163398366, 'loss_val': 0.025161755040605218, 'psi': 0.9956947184549803}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967851651417011, 'loss_val': 0.025147950715679563, 'psi': 0.9956949779757261}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.014921 cos_to_last_merge=0.9280 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9917118539908788, 'auprc': 0.9989798548027414, 'loss_val': 0.03738715798078779, 'psi': 0.9946190543156238}-{'f1_val': 0.9967460138064482, 'auprc': 0.9983189146902778, 'loss_val': 0.01786789478134011, 'psi': 0.9973751741599801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.628893 cos_to_last_merge=0.8597 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.860
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6548265129802637, 'auprc': 0.7805204646847744, 'loss_val': 1.0140184092594817, 'psi': 0.705104093662068}-{'f1_val': 0.6897571627830337, 'auprc': 0.7816767465898348, 'loss_val': 1.0114755745201547, 'psi': 0.7265249963057541}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=1.973297 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9572884137266877, 'auprc': 0.9988551772631862, 'loss_val': 0.057239258680621, 'psi': 0.9739151191412871}-{'f1_val': 0.9979907967189754, 'auprc': 0.9992307611783742, 'loss_val': 0.02069700133541885, 'psi': 0.9984867825027348}
[S15] START round=94 head_norm_before_train=2.295569 cos_to_last_merge=0.9442 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=94 local utility u=0.454999 metrics={'f1_val': 0.8926758553083725, 'auprc': 0.9932325755737301, 'loss_val': 0.27391809760199676, 'psi': 0.9328985434145156}-{'f1_val': 0.7819471046886132, 'auprc': 0.9904771593425846, 'loss_val': 0.5112776565642391, 'psi': 0.8653591265502018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=94 head_norm_before_train=1.994779 cos_to_last_merge=1.0000 (last merge round=92)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.8601161064211178, 'auprc': 0.8857420843575359, 'loss_val': 1.0930183855356808, 'psi': 0.870366497595685}-{'f1_val': 0.9455193586994968, 'auprc': 0.9842716463327259, 'loss_val': 0.27403889572732687, 'psi': 0.9610202737527884}
[S17] START round=94 head_norm_before_train=2.235086 (no previous merge yet)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7525574062946907, 'auprc': 0.954554620839881, 'loss_val': 0.9593223775642677, 'psi': 0.8333562921127668}-{'f1_val': 0.9114135673467505, 'auprc': 0.9790625250496021, 'loss_val': 0.49872501739832825, 'psi': 0.9384731504278911}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=94 metric=0.8601 head_norm=1.997577
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.056306e-02
[S16] stored merged vector for next round verification (round=94)
[S16] DEBUG after merge:  round=94 metric=0.8603 head_norm=1.993746 delta_norm=0.010563
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=94 metric=0.6874 head_norm=1.977457
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.998714e-03
[S7] stored merged vector for next round verification (round=94)
[S7] DEBUG after merge:  round=94 metric=0.6855 head_norm=1.976214 delta_norm=0.009999
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=95 head_norm_before_train=1.995107 cos_to_last_merge=1.0000 (last merge round=93)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.8275383534051775, 'auprc': 0.9926030816811658, 'loss_val': 0.4495437817605364, 'psi': 0.8935642447155728}-{'f1_val': 0.8291018313669937, 'auprc': 0.992972919341085, 'loss_val': 0.43825576175812836, 'psi': 0.8946502665566303}
[S3] START round=95 head_norm_before_train=2.108065 cos_to_last_merge=0.8996 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.9379345614463955, 'auprc': 0.9975870206961646, 'loss_val': 0.1733770745800886, 'psi': 0.9617955451463032}-{'f1_val': 0.959400038305751, 'auprc': 0.9978822432378199, 'loss_val': 0.17859176258085033, 'psi': 0.9747929202785786}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=1.687140 cos_to_last_merge=0.8484 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9328675513326224, 'auprc': 0.9597388807091131, 'loss_val': 0.2960981582850633, 'psi': 0.9436160830832186}-{'f1_val': 0.9409326059202884, 'auprc': 0.9755828698164768, 'loss_val': 0.26918873569567114, 'psi': 0.9547927114787638}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.789387 cos_to_last_merge=0.8670 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.995238992162401, 'loss_val': 0.0513561520746504, 'psi': 0.9965575475765557}-{'f1_val': 0.9966309045197074, 'auprc': 0.9939612869074272, 'loss_val': 0.035180751962774495, 'psi': 0.9955630574747953}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=2.295156 (no previous merge yet)
[S6] round=95 local utility u=1.000000 metrics={'f1_val': 0.8881442024574974, 'auprc': 0.9741980145963889, 'loss_val': 0.2983736107711594, 'psi': 0.9225657273130541}-{'f1_val': 0.639413251793654, 'auprc': 0.8901902417439187, 'loss_val': 1.2028567781194894, 'psi': 0.7397240477737599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=95 head_norm_before_train=1.976214 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6006350225877959, 'auprc': 0.7936219195595648, 'loss_val': 0.7263296223611334, 'psi': 0.6778297813765035}-{'f1_val': 0.6873656732921782, 'auprc': 0.835498978315463, 'loss_val': 0.3204737268906037, 'psi': 0.7466189953014921}
[S8] START round=95 head_norm_before_train=2.043691 cos_to_last_merge=0.8592 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.859
[S8] round=95 local utility u=0.001636 metrics={'f1_val': 0.994792642153961, 'auprc': 0.998933401677948, 'loss_val': 0.02342786492579564, 'psi': 0.9964489459635558}-{'f1_val': 0.9944248929832828, 'auprc': 0.9989537594059583, 'loss_val': 0.024553749587477525, 'psi': 0.996236439552353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=95 head_norm_before_train=2.154367 cos_to_last_merge=0.9705 (last merge round=21)
[S9] round=95 local utility u=0.000499 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9995277470316487, 'loss_val': 0.016480809518232494, 'psi': 0.9978265935715168}-{'f1_val': 0.9966924912647621, 'auprc': 0.9991679653573013, 'loss_val': 0.016399387134920024, 'psi': 0.9976826809017778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=95 head_norm_before_train=1.951294 cos_to_last_merge=0.8776 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=95 local utility u=0.000010 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967860534950628, 'loss_val': 0.025146401532471094, 'psi': 0.9956953333170708}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967845163398366, 'loss_val': 0.025161755040605218, 'psi': 0.9956947184549803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=95 head_norm_before_train=2.018140 cos_to_last_merge=0.9277 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=95 local utility u=0.024747 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9986203327882458, 'loss_val': 0.017019606769976714, 'psi': 0.9974957413991673}-{'f1_val': 0.9917118539908788, 'auprc': 0.9989798548027414, 'loss_val': 0.03738715798078779, 'psi': 0.9946190543156238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=95 head_norm_before_train=1.631438 cos_to_last_merge=0.8594 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.630958969976806, 'auprc': 0.6787997590604858, 'loss_val': 0.907398210597959, 'psi': 0.650095285610278}-{'f1_val': 0.6548265129802637, 'auprc': 0.7805204646847744, 'loss_val': 1.0140184092594817, 'psi': 0.705104093662068}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=1.976764 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9357867705521205, 'auprc': 0.9988555541040538, 'loss_val': 0.1077261672140596, 'psi': 0.9610142839728938}-{'f1_val': 0.9572884137266877, 'auprc': 0.9988551772631862, 'loss_val': 0.057239258680621, 'psi': 0.9739151191412871}
[S15] START round=95 head_norm_before_train=2.301472 cos_to_last_merge=0.9436 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=95 local utility u=0.137124 metrics={'f1_val': 0.9163758049289272, 'auprc': 0.991530663358512, 'loss_val': 0.13676367042843895, 'psi': 0.9464377483007611}-{'f1_val': 0.8926758553083725, 'auprc': 0.9932325755737301, 'loss_val': 0.27391809760199676, 'psi': 0.9328985434145156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=95 head_norm_before_train=1.993746 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=95 local utility u=0.869538 metrics={'f1_val': 0.9474492364850101, 'auprc': 0.9939474587803205, 'loss_val': 0.2025570937549069, 'psi': 0.9660485254031344}-{'f1_val': 0.8601161064211178, 'auprc': 0.8857420843575359, 'loss_val': 1.0930183855356808, 'psi': 0.870366497595685}
[S17] START round=95 head_norm_before_train=2.241666 (no previous merge yet)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.7285532413110343, 'auprc': 0.9359746637040465, 'loss_val': 1.0857046021535603, 'psi': 0.8115218102682391}-{'f1_val': 0.7525574062946907, 'auprc': 0.954554620839881, 'loss_val': 0.9593223775642677, 'psi': 0.8333562921127668}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.026 → S16@127.0.0.1:61816
[S7] ⇄ pheromone p=0.237 → S14@127.0.0.1:61814
[S16] sending update (kind=head size=1793 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=95 metric=0.9358 head_norm=1.981328
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.242476e-02
[S14] stored merged vector for next round verification (round=95)
[S14] DEBUG after merge:  round=95 metric=0.9358 head_norm=1.979354 delta_norm=0.012425
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.015 → S7@127.0.0.1:61808
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=1.0000
[S16] ⇄ pheromone p=0.202 → S2@127.0.0.1:61802
[S2] START round=96 head_norm_before_train=2.000325 cos_to_last_merge=1.0000 (last merge round=93)
[S2] round=96 local utility u=0.014562 metrics={'f1_val': 0.83065608937382, 'auprc': 0.9910971059187383, 'loss_val': 0.4346078644883369, 'psi': 0.8948324959917873}-{'f1_val': 0.8275383534051775, 'auprc': 0.9926030816811658, 'loss_val': 0.4495437817605364, 'psi': 0.8935642447155728}
[S3] START round=96 head_norm_before_train=2.113427 cos_to_last_merge=0.8992 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.8204292495630159, 'auprc': 0.9966415950435505, 'loss_val': 0.25022596245111645, 'psi': 0.8909141877552298}-{'f1_val': 0.9379345614463955, 'auprc': 0.9975870206961646, 'loss_val': 0.1733770745800886, 'psi': 0.9617955451463032}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.687423 cos_to_last_merge=0.8483 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9325801693990784, 'auprc': 0.9585864052041327, 'loss_val': 0.2983319115257791, 'psi': 0.9429826637211001}-{'f1_val': 0.9328675513326224, 'auprc': 0.9597388807091131, 'loss_val': 0.2960981582850633, 'psi': 0.9436160830832186}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.795551 cos_to_last_merge=0.8661 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=96 local utility u=0.003649 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9926337899354631, 'loss_val': 0.03140879124596268, 'psi': 0.9950320586860096}-{'f1_val': 0.9974365845193254, 'auprc': 0.995238992162401, 'loss_val': 0.0513561520746504, 'psi': 0.9965575475765557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=96 head_norm_before_train=2.303544 (no previous merge yet)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.8797251980806378, 'auprc': 0.9679092872157526, 'loss_val': 0.37579761011864526, 'psi': 0.9149988337346837}-{'f1_val': 0.8881442024574974, 'auprc': 0.9741980145963889, 'loss_val': 0.2983736107711594, 'psi': 0.9225657273130541}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.979508 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=96 local utility u=0.446368 metrics={'f1_val': 0.6779777607098685, 'auprc': 0.8189076233083965, 'loss_val': 0.3735080442140371, 'psi': 0.7343497057492797}-{'f1_val': 0.6006350225877959, 'auprc': 0.7936219195595648, 'loss_val': 0.7263296223611334, 'psi': 0.6778297813765035}
[S8] START round=96 head_norm_before_train=2.048631 cos_to_last_merge=0.8587 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.859
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9908122058378689, 'auprc': 0.9988450540734611, 'loss_val': 0.03132122822910068, 'psi': 0.9940253451321057}-{'f1_val': 0.994792642153961, 'auprc': 0.998933401677948, 'loss_val': 0.02342786492579564, 'psi': 0.9964489459635558}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.156553 cos_to_last_merge=0.9701 (last merge round=21)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999227130062365, 'loss_val': 0.015849082658111295, 'psi': 0.9977317026407383}-{'f1_val': 0.9966924912647621, 'auprc': 0.9995277470316487, 'loss_val': 0.016480809518232494, 'psi': 0.9978265935715168}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=1.956575 cos_to_last_merge=0.8774 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967843390743826, 'loss_val': 0.025157050176351562, 'psi': 0.9956946475487987}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967860534950628, 'loss_val': 0.025146401532471094, 'psi': 0.9956953333170708}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.022318 cos_to_last_merge=0.9273 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9985814901568794, 'loss_val': 0.017346032481977552, 'psi': 0.9974802043466207}-{'f1_val': 0.9967460138064482, 'auprc': 0.9986203327882458, 'loss_val': 0.017019606769976714, 'psi': 0.9974957413991673}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.636698 cos_to_last_merge=0.8587 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=96 local utility u=0.412955 metrics={'f1_val': 0.7126799069881102, 'auprc': 0.7845124956212499, 'loss_val': 0.8889511226531971, 'psi': 0.7414129424413661}-{'f1_val': 0.630958969976806, 'auprc': 0.6787997590604858, 'loss_val': 0.907398210597959, 'psi': 0.650095285610278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=96 head_norm_before_train=1.979354 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9342591273140564, 'auprc': 0.9988550441536813, 'loss_val': 0.12414403206645751, 'psi': 0.9600974940499064}-{'f1_val': 0.9357867705521205, 'auprc': 0.9988555541040538, 'loss_val': 0.1077261672140596, 'psi': 0.9610142839728938}
[S15] START round=96 head_norm_before_train=2.307177 cos_to_last_merge=0.9432 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=96 local utility u=0.308506 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9971820689992826, 'loss_val': 0.018672856351164027, 'psi': 0.9968950047735664}-{'f1_val': 0.9163758049289272, 'auprc': 0.991530663358512, 'loss_val': 0.13676367042843895, 'psi': 0.9464377483007611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=96 head_norm_before_train=1.997085 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=96 local utility u=0.222365 metrics={'f1_val': 0.9932942728802157, 'auprc': 0.9946053161375459, 'loss_val': 0.03487113721300038, 'psi': 0.9938186901831477}-{'f1_val': 0.9474492364850101, 'auprc': 0.9939474587803205, 'loss_val': 0.2025570937549069, 'psi': 0.9660485254031344}
[S17] START round=96 head_norm_before_train=2.247859 (no previous merge yet)
[S17] round=96 local utility u=0.241499 metrics={'f1_val': 0.7786090640691588, 'auprc': 0.9478712276825627, 'loss_val': 0.9387318028211327, 'psi': 0.8463139295145203}-{'f1_val': 0.7285532413110343, 'auprc': 0.9359746637040465, 'loss_val': 1.0857046021535603, 'psi': 0.8115218102682391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=96 metric=0.9933 head_norm=1.997174
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.409433e-02
[S16] stored merged vector for next round verification (round=96)
[S16] DEBUG after merge:  round=96 metric=0.9933 head_norm=2.001530 delta_norm=0.014094
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=96 metric=0.8307 head_norm=2.005976
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.190094e-02
[S2] stored merged vector for next round verification (round=96)
[S2] DEBUG after merge:  round=96 metric=0.8307 head_norm=2.001518 delta_norm=0.011901
[S2] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.001518 cos_to_last_merge=1.0000 (last merge round=96)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.8267531246518489, 'auprc': 0.992038200210863, 'loss_val': 0.45890097928296875, 'psi': 0.8928671548754545}-{'f1_val': 0.83065608937382, 'auprc': 0.9910971059187383, 'loss_val': 0.4346078644883369, 'psi': 0.8948324959917873}
[S3] START round=97 head_norm_before_train=2.118537 cos_to_last_merge=0.8988 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=97 local utility u=0.248955 metrics={'f1_val': 0.8953230745999883, 'auprc': 0.9972932052952737, 'loss_val': 0.2036334952030301, 'psi': 0.9361111268781025}-{'f1_val': 0.8204292495630159, 'auprc': 0.9966415950435505, 'loss_val': 0.25022596245111645, 'psi': 0.8909141877552298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=97 head_norm_before_train=1.688814 cos_to_last_merge=0.8479 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=97 local utility u=0.016042 metrics={'f1_val': 0.9344961300054492, 'auprc': 0.962719061613739, 'loss_val': 0.2901414406265333, 'psi': 0.9457853026487651}-{'f1_val': 0.9325801693990784, 'auprc': 0.9585864052041327, 'loss_val': 0.2983319115257791, 'psi': 0.9429826637211001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=97 head_norm_before_train=1.802736 cos_to_last_merge=0.8651 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=97 local utility u=0.001039 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9930934440489907, 'loss_val': 0.030709704468820258, 'psi': 0.9952159203314207}-{'f1_val': 0.9966309045197074, 'auprc': 0.9926337899354631, 'loss_val': 0.03140879124596268, 'psi': 0.9950320586860096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=97 head_norm_before_train=2.307851 (no previous merge yet)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6225188189661728, 'auprc': 0.8474259961132782, 'loss_val': 1.3418914773230652, 'psi': 0.712481689825015}-{'f1_val': 0.8797251980806378, 'auprc': 0.9679092872157526, 'loss_val': 0.37579761011864526, 'psi': 0.9149988337346837}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.984534 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.5842749271027535, 'auprc': 0.7848605015732832, 'loss_val': 0.9115418055131181, 'psi': 0.6645091568909655}-{'f1_val': 0.6779777607098685, 'auprc': 0.8189076233083965, 'loss_val': 0.3735080442140371, 'psi': 0.7343497057492797}
[S8] START round=97 head_norm_before_train=2.052790 cos_to_last_merge=0.8583 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9885508673565224, 'auprc': 0.9985375311064474, 'loss_val': 0.0342877061812647, 'psi': 0.9925455328564925}-{'f1_val': 0.9908122058378689, 'auprc': 0.9988450540734611, 'loss_val': 0.03132122822910068, 'psi': 0.9940253451321057}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.157038 cos_to_last_merge=0.9700 (last merge round=21)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9999242431169356, 'loss_val': 0.031880387354439384, 'psi': 0.9942094914295314}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999227130062365, 'loss_val': 0.015849082658111295, 'psi': 0.9977317026407383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=1.961884 cos_to_last_merge=0.8771 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=97 local utility u=0.000073 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967883669404098, 'loss_val': 0.025023141926824408, 'psi': 0.9956962586952096}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967843390743826, 'loss_val': 0.025157050176351562, 'psi': 0.9956946475487987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=97 head_norm_before_train=2.026917 cos_to_last_merge=0.9269 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9928412662561867, 'auprc': 0.9991488124722947, 'loss_val': 0.034688943198046135, 'psi': 0.99536428474263}-{'f1_val': 0.9967460138064482, 'auprc': 0.9985814901568794, 'loss_val': 0.017346032481977552, 'psi': 0.9974802043466207}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.642544 cos_to_last_merge=0.8577 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6348183896329982, 'auprc': 0.791629243159508, 'loss_val': 1.117963967310186, 'psi': 0.6975427310436021}-{'f1_val': 0.7126799069881102, 'auprc': 0.7845124956212499, 'loss_val': 0.8889511226531971, 'psi': 0.7414129424413661}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=1.985256 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=97 local utility u=0.018253 metrics={'f1_val': 0.9373060440103239, 'auprc': 0.9988551692799337, 'loss_val': 0.10592018785530226, 'psi': 0.9619256941181678}-{'f1_val': 0.9342591273140564, 'auprc': 0.9988550441536813, 'loss_val': 0.12414403206645751, 'psi': 0.9600974940499064}
[S15] START round=97 head_norm_before_train=2.312664 cos_to_last_merge=0.9429 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9148130078863488, 'auprc': 0.9969197211205756, 'loss_val': 0.14912356039559094, 'psi': 0.9476556931800395}-{'f1_val': 0.9967036286230888, 'auprc': 0.9971820689992826, 'loss_val': 0.018672856351164027, 'psi': 0.9968950047735664}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.001530 cos_to_last_merge=1.0000 (last merge round=96)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9926765262893891, 'auprc': 0.9940466285721782, 'loss_val': 0.0348650757972645, 'psi': 0.9932245672025047}-{'f1_val': 0.9932942728802157, 'auprc': 0.9946053161375459, 'loss_val': 0.03487113721300038, 'psi': 0.9938186901831477}
[S17] START round=97 head_norm_before_train=2.254192 (no previous merge yet)
[S17] round=97 local utility u=0.304849 metrics={'f1_val': 0.8247166759623582, 'auprc': 0.9590800018679377, 'loss_val': 0.6393058308733497, 'psi': 0.87846200632459}-{'f1_val': 0.7786090640691588, 'auprc': 0.9478712276825627, 'loss_val': 0.9387318028211327, 'psi': 0.8463139295145203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=97 metric=0.9373 head_norm=1.992402
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.000983e-02
[S14] stored merged vector for next round verification (round=97)
[S14] DEBUG after merge:  round=97 metric=0.9373 head_norm=1.988446 delta_norm=0.010010
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.007222 cos_to_last_merge=1.0000 (last merge round=96)
[S2] round=98 local utility u=0.002835 metrics={'f1_val': 0.8267442341193362, 'auprc': 0.9906833944922451, 'loss_val': 0.4491135387902979, 'psi': 0.8923198982684997}-{'f1_val': 0.8267531246518489, 'auprc': 0.992038200210863, 'loss_val': 0.45890097928296875, 'psi': 0.8928671548754545}
[S3] START round=98 head_norm_before_train=2.123742 cos_to_last_merge=0.8984 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=98 local utility u=0.166617 metrics={'f1_val': 0.9429232420729805, 'auprc': 0.9976029102600381, 'loss_val': 0.15693029198493103, 'psi': 0.9647951093478035}-{'f1_val': 0.8953230745999883, 'auprc': 0.9972932052952737, 'loss_val': 0.2036334952030301, 'psi': 0.9361111268781025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=98 head_norm_before_train=1.692945 cos_to_last_merge=0.8471 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=98 local utility u=0.022903 metrics={'f1_val': 0.9378533762538974, 'auprc': 0.96687128379075, 'loss_val': 0.27693499833523627, 'psi': 0.9494605392686385}-{'f1_val': 0.9344961300054492, 'auprc': 0.962719061613739, 'loss_val': 0.2901414406265333, 'psi': 0.9457853026487651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=98 head_norm_before_train=1.812185 cos_to_last_merge=0.8639 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9932331019489455, 'loss_val': 0.031592160429298216, 'psi': 0.9952717834914027}-{'f1_val': 0.9966309045197074, 'auprc': 0.9930934440489907, 'loss_val': 0.030709704468820258, 'psi': 0.9952159203314207}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.312426 (no previous merge yet)
[S6] round=98 local utility u=0.816375 metrics={'f1_val': 0.7537078469707574, 'auprc': 0.9129624331424593, 'loss_val': 0.6928843621615144, 'psi': 0.8174096814394382}-{'f1_val': 0.6225188189661728, 'auprc': 0.8474259961132782, 'loss_val': 1.3418914773230652, 'psi': 0.712481689825015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=98 head_norm_before_train=1.987353 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=98 local utility u=0.606301 metrics={'f1_val': 0.6701002894279158, 'auprc': 0.8293056033472563, 'loss_val': 0.34722676641997635, 'psi': 0.733782414995652}-{'f1_val': 0.5842749271027535, 'auprc': 0.7848605015732832, 'loss_val': 0.9115418055131181, 'psi': 0.6645091568909655}
[S8] START round=98 head_norm_before_train=2.055916 cos_to_last_merge=0.8580 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=98 local utility u=0.011526 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9982355018637946, 'loss_val': 0.029828363857823847, 'psi': 0.9943746871845272}-{'f1_val': 0.9885508673565224, 'auprc': 0.9985375311064474, 'loss_val': 0.0342877061812647, 'psi': 0.9925455328564925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=98 head_norm_before_train=2.159981 cos_to_last_merge=0.9699 (last merge round=21)
[S9] round=98 local utility u=0.026853 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991865682884672, 'loss_val': 0.016179924160611328, 'psi': 0.9979363748226726}-{'f1_val': 0.990399656971262, 'auprc': 0.9999242431169356, 'loss_val': 0.031880387354439384, 'psi': 0.9942094914295314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=98 head_norm_before_train=1.967172 cos_to_last_merge=0.8767 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967855639514415, 'loss_val': 0.025048533091940953, 'psi': 0.9956951374996224}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967883669404098, 'loss_val': 0.025023141926824408, 'psi': 0.9956962586952096}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.031524 cos_to_last_merge=0.9266 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9235174821183877, 'auprc': 0.9985175080544249, 'loss_val': 0.37366793864829084, 'psi': 0.9535174924928025}-{'f1_val': 0.9928412662561867, 'auprc': 0.9991488124722947, 'loss_val': 0.034688943198046135, 'psi': 0.99536428474263}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.650129 cos_to_last_merge=0.8567 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.622706917711327, 'auprc': 0.7711782855756357, 'loss_val': 1.0205241466682697, 'psi': 0.6820954648570505}-{'f1_val': 0.6348183896329982, 'auprc': 0.791629243159508, 'loss_val': 1.117963967310186, 'psi': 0.6975427310436021}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=1.988446 cos_to_last_merge=1.0000 (last merge round=97)
[S14] round=98 local utility u=0.216927 metrics={'f1_val': 0.9961380077959525, 'auprc': 0.9992325539474375, 'loss_val': 0.026190998379376787, 'psi': 0.9973758262565465}-{'f1_val': 0.9373060440103239, 'auprc': 0.9988551692799337, 'loss_val': 0.10592018785530226, 'psi': 0.9619256941181678}
[S15] START round=98 head_norm_before_train=2.317811 cos_to_last_merge=0.9427 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.8044365843471023, 'auprc': 0.9927614304890009, 'loss_val': 0.4788831442492372, 'psi': 0.8797665228038617}-{'f1_val': 0.9148130078863488, 'auprc': 0.9969197211205756, 'loss_val': 0.14912356039559094, 'psi': 0.9476556931800395}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.002395 cos_to_last_merge=1.0000 (last merge round=96)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9895754867619958, 'auprc': 0.9912176109058389, 'loss_val': 0.047318590523225935, 'psi': 0.9902323364195331}-{'f1_val': 0.9926765262893891, 'auprc': 0.9940466285721782, 'loss_val': 0.0348650757972645, 'psi': 0.9932245672025047}
[S17] START round=98 head_norm_before_train=2.257859 (no previous merge yet)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.7378849523702586, 'auprc': 0.9787461023924485, 'loss_val': 1.0118364833262454, 'psi': 0.8342294123791346}-{'f1_val': 0.8247166759623582, 'auprc': 0.9590800018679377, 'loss_val': 0.6393058308733497, 'psi': 0.87846200632459}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=98 metric=0.9961 head_norm=1.993525
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.069101e-02
[S14] stored merged vector for next round verification (round=98)
[S14] DEBUG after merge:  round=98 metric=0.9961 head_norm=1.992844 delta_norm=0.010691
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=98 metric=0.6701 head_norm=1.992220
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.170035e-02
[S7] stored merged vector for next round verification (round=98)
[S7] DEBUG after merge:  round=98 metric=0.6704 head_norm=1.992553 delta_norm=0.011700
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=2.010161 cos_to_last_merge=1.0000 (last merge round=96)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.8278020995457444, 'auprc': 0.9077115247641554, 'loss_val': 0.4499716831769439, 'psi': 0.8597658696331087}-{'f1_val': 0.8267442341193362, 'auprc': 0.9906833944922451, 'loss_val': 0.4491135387902979, 'psi': 0.8923198982684997}
[S3] START round=99 head_norm_before_train=2.129060 cos_to_last_merge=0.8980 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=99 local utility u=0.136485 metrics={'f1_val': 0.9730942132526033, 'auprc': 0.99753796461004, 'loss_val': 0.06479193391953143, 'psi': 0.982871713795578}-{'f1_val': 0.9429232420729805, 'auprc': 0.9976029102600381, 'loss_val': 0.15693029198493103, 'psi': 0.9647951093478035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] r=100 psi=0.983 u=0.1365 p_local=0.1328 f1=0.973 auprc=0.998 bytes=104110
[S4] START round=99 head_norm_before_train=1.695705 cos_to_last_merge=0.8465 (last merge round=12)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=99 local utility u=0.048055 metrics={'f1_val': 0.9543018587781488, 'auprc': 0.9675538538986295, 'loss_val': 0.28156283648144775, 'psi': 0.959602656826341}-{'f1_val': 0.9378533762538974, 'auprc': 0.96687128379075, 'loss_val': 0.27693499833523627, 'psi': 0.9494605392686385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=100 psi=0.960 u=0.0481 p_local=0.0201 f1=0.954 auprc=0.968 bytes=100626
[S5] START round=99 head_norm_before_train=1.822177 cos_to_last_merge=0.8627 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.863
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9936626008950282, 'loss_val': 0.03801383408711411, 'psi': 0.9954435830698357}-{'f1_val': 0.9966309045197074, 'auprc': 0.9932331019489455, 'loss_val': 0.031592160429298216, 'psi': 0.9952717834914027}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.995 u=0.0000 p_local=0.0110 f1=0.997 auprc=0.994 bytes=95627
[S6] START round=99 head_norm_before_train=2.317571 (no previous merge yet)
[S6] round=99 local utility u=0.319080 metrics={'f1_val': 0.8122886883264491, 'auprc': 0.9526228101244555, 'loss_val': 0.5251905861040911, 'psi': 0.8684223370456516}-{'f1_val': 0.7537078469707574, 'auprc': 0.9129624331424593, 'loss_val': 0.6928843621615144, 'psi': 0.8174096814394382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S6] r=100 psi=0.868 u=0.3191 p_local=0.3378 f1=0.812 auprc=0.953 bytes=95283
[S7] START round=99 head_norm_before_train=1.992553 cos_to_last_merge=1.0000 (last merge round=98)
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.5604262366059585, 'auprc': 0.7887954523804236, 'loss_val': 1.086893062426744, 'psi': 0.6517739229157444}-{'f1_val': 0.6701002894279158, 'auprc': 0.8293056033472563, 'loss_val': 0.34722676641997635, 'psi': 0.733782414995652}
[S8] START round=99 head_norm_before_train=2.059469 cos_to_last_merge=0.8578 (last merge round=11)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9869147793946973, 'auprc': 0.9989961576439473, 'loss_val': 0.03592943749253493, 'psi': 0.9917473306943974}-{'f1_val': 0.9918008107316822, 'auprc': 0.9982355018637946, 'loss_val': 0.029828363857823847, 'psi': 0.9943746871845272}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.992 u=0.0000 p_local=0.0094 f1=0.987 auprc=0.999 bytes=113402
[S9] START round=99 head_norm_before_train=2.164275 cos_to_last_merge=0.9697 (last merge round=21)
[S9] round=99 local utility u=0.000019 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999182951801181, 'loss_val': 0.01613024519729298, 'psi': 0.9979349282277581}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991865682884672, 'loss_val': 0.016179924160611328, 'psi': 0.9979363748226726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=100 psi=0.998 u=0.0000 p_local=0.0059 f1=0.997 auprc=0.999 bytes=91678
[S10] START round=99 head_norm_before_train=1.968387 cos_to_last_merge=0.8760 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.876
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996746915189721, 'loss_val': 0.025229239703853133, 'psi': 0.9956796779949342}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967855639514415, 'loss_val': 0.025048533091940953, 'psi': 0.9956951374996224}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.997 bytes=116901
[S11] START round=99 head_norm_before_train=2.036149 cos_to_last_merge=0.9262 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=99 local utility u=0.395356 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.998244437730391, 'loss_val': 0.01888727813830054, 'psi': 0.9970832258623776}-{'f1_val': 0.9235174821183877, 'auprc': 0.9985175080544249, 'loss_val': 0.37366793864829084, 'psi': 0.9535174924928025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S11] r=100 psi=0.997 u=0.3954 p_local=0.0839 f1=0.996 auprc=0.998 bytes=91784
[S13] START round=99 head_norm_before_train=1.655046 cos_to_last_merge=0.8560 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6174216843508047, 'auprc': 0.7703429055973847, 'loss_val': 1.0538538373304074, 'psi': 0.6785901728494368}-{'f1_val': 0.622706917711327, 'auprc': 0.7711782855756357, 'loss_val': 1.0205241466682697, 'psi': 0.6820954648570505}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.679 u=0.0000 p_local=0.0565 f1=0.617 auprc=0.770 bytes=82755
[S14] START round=99 head_norm_before_train=1.992844 cos_to_last_merge=1.0000 (last merge round=98)
[S14] round=99 local utility u=0.008582 metrics={'f1_val': 0.9976021243095224, 'auprc': 0.9992312873469589, 'loss_val': 0.01780718256755322, 'psi': 0.998253789524497}-{'f1_val': 0.9961380077959525, 'auprc': 0.9992325539474375, 'loss_val': 0.026190998379376787, 'psi': 0.9973758262565465}
[S15] START round=99 head_norm_before_train=2.322595 cos_to_last_merge=0.9424 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.759375213819739, 'auprc': 0.9583079417900893, 'loss_val': 0.6161947349043428, 'psi': 0.8389483050078792}-{'f1_val': 0.8044365843471023, 'auprc': 0.9927614304890009, 'loss_val': 0.4788831442492372, 'psi': 0.8797665228038617}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.839 u=0.0000 p_local=0.1206 f1=0.759 auprc=0.958 bytes=91769
[S16] START round=99 head_norm_before_train=2.006014 cos_to_last_merge=1.0000 (last merge round=96)
[S16] round=99 local utility u=0.020220 metrics={'f1_val': 0.9930952402670012, 'auprc': 0.9935083921404559, 'loss_val': 0.03486852086584328, 'psi': 0.9932605010163831}-{'f1_val': 0.9895754867619958, 'auprc': 0.9912176109058389, 'loss_val': 0.047318590523225935, 'psi': 0.9902323364195331}
[S17] START round=99 head_norm_before_train=2.262288 (no previous merge yet)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.6408122751282361, 'auprc': 0.9907516019241925, 'loss_val': 1.3391184987304101, 'psi': 0.7807880058466187}-{'f1_val': 0.7378849523702586, 'auprc': 0.9787461023924485, 'loss_val': 1.0118364833262454, 'psi': 0.8342294123791346}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.781 u=0.0000 p_local=0.1589 f1=0.641 auprc=0.991 bytes=100832
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] r=100 psi=0.652 u=0.0000 p_local=0.2397 f1=0.560 auprc=0.789 bytes=93595
[S2] r=100 psi=0.860 u=0.0000 p_local=0.0124 f1=0.828 auprc=0.908 bytes=97154
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=1.0000
[S14] r=100 psi=0.998 u=0.0086 p_local=0.0449 f1=0.998 auprc=0.999 bytes=95416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=99 metric=0.9931 head_norm=2.011123
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.224057e-03
[S16] stored merged vector for next round verification (round=99)
[S16] DEBUG after merge:  round=99 metric=0.9931 head_norm=2.010621 delta_norm=0.009224
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] r=100 psi=0.993 u=0.0202 p_local=0.1097 f1=0.993 auprc=0.994 bytes=89892
[runner] rounds complete.
[runner] all agents stopped.
