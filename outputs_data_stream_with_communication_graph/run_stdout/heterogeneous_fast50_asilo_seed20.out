[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49303
[S3] → join 127.0.0.1:49302
[S4] → join 127.0.0.1:49302
[S5] → join 127.0.0.1:49302
[S6] → join 127.0.0.1:49302
[S7] → join 127.0.0.1:49302
[S8] → join 127.0.0.1:49302
[S9] → join 127.0.0.1:49302
[S10] → join 127.0.0.1:49302
[S11] → join 127.0.0.1:49302
[S13] → join 127.0.0.1:49302
[S14] → join 127.0.0.1:49302
[S15] → join 127.0.0.1:49302
[S16] → join 127.0.0.1:49302
[S17] → join 127.0.0.1:49302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.147039 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.160176 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.210943 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.156876 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.139081 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.108102 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.164741 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.165949 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.127537 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.127809 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.116896 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.157903 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.142579 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.181541 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.137581 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S17
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S6
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S17
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S8
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S13
[S7] + discovered S6
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S3
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S11
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S4
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S14
[S7] + discovered S16
[S8] + discovered S6
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S16
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S4
[S8] + discovered S14
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S4
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S16
[S10] + discovered S6
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S4
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S16
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S6
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S15
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S11
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S4
[S13] + discovered S16
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S15
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S7
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S13
[S16] + discovered S4
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S17
[S17] + discovered S13
[S17] + discovered S15
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S10
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:49311
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:49302
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:49305
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:49314
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S2] START round=1 head_norm_before_train=1.164152 (no previous merge yet)
[S2] round=1 local utility u=0.117375 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7403995722137222, 'loss_val': 1.246627456204877, 'psi': 0.38122610891862896}-{'f1_val': 0.12614480781776727, 'auprc': 0.7213585038164987, 'loss_val': 1.3304598163181707, 'psi': 0.36423028621725984}
[S3] START round=1 head_norm_before_train=1.160346 (no previous merge yet)
[S3] round=1 local utility u=0.049796 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.614694050064992, 'loss_val': 1.334916372673753, 'psi': 0.329781659394461}-{'f1_val': 0.13984006561410703, 'auprc': 0.5927284649280093, 'loss_val': 1.3686125365948123, 'psi': 0.32099542533966796}
[S4] START round=1 head_norm_before_train=1.216401 (no previous merge yet)
[S4] round=1 local utility u=0.043161 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7778617028871608, 'loss_val': 1.2785312108815685, 'psi': 0.39528065849197486}-{'f1_val': 0.14022662889518414, 'auprc': 0.7689661079654309, 'loss_val': 1.3381668863277725, 'psi': 0.3917224205232828}
[S5] START round=1 head_norm_before_train=1.158416 (no previous merge yet)
[S5] round=1 local utility u=1.000000 metrics={'f1_val': 0.4247767552317834, 'auprc': 0.7425877989110283, 'loss_val': 1.3366628209285483, 'psi': 0.5519011727034814}-{'f1_val': 0.10408432147562582, 'auprc': 0.7255600090491797, 'loss_val': 1.3759292401663619, 'psi': 0.3526745965050474}
[S6] START round=1 head_norm_before_train=1.156632 (no previous merge yet)
[S6] round=1 local utility u=0.053692 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6430732923021409, 'loss_val': 1.2650349595666577, 'psi': 0.3420850861516256}-{'f1_val': 0.14142628205128205, 'auprc': 0.6291052473587863, 'loss_val': 1.3305139928630494, 'psi': 0.33649786817428373}
[S7] START round=1 head_norm_before_train=1.102953 (no previous merge yet)
[S7] round=1 local utility u=0.371421 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7751121389157797, 'loss_val': 1.3436886300254682, 'psi': 0.3952789492037669}-{'f1_val': 0.13800080938891138, 'auprc': 0.5467024610957384, 'loss_val': 1.3769649443297343, 'psi': 0.30148147007164217}
[S8] START round=1 head_norm_before_train=1.180074 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7672544035396379, 'loss_val': 1.2670027581849719, 'psi': 0.3908753508516295}-{'f1_val': 0.47627266528556245, 'auprc': 0.7667909641592826, 'loss_val': 1.337951994332693, 'psi': 0.5924799848350506}
[S9] START round=1 head_norm_before_train=1.179849 (no previous merge yet)
[S9] round=1 local utility u=0.269809 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9996730042632496, 'loss_val': 1.2749174330765842, 'psi': 0.48470797598929743}-{'f1_val': 0.14276996721886503, 'auprc': 0.8347883204575943, 'loss_val': 1.3281140480821134, 'psi': 0.41957730851435676}
[S10] START round=1 head_norm_before_train=1.142470 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5630166014263412, 'loss_val': 1.2965655359611548, 'psi': 0.3083796230955709}-{'f1_val': 0.4356520601867358, 'auprc': 0.5613197529945494, 'loss_val': 1.348275399234021, 'psi': 0.48591913730986125}
[S11] START round=1 head_norm_before_train=1.133927 (no previous merge yet)
[S11] round=1 local utility u=0.178736 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7687132190131847, 'loss_val': 1.3107276718143999, 'psi': 0.3917334976291402}-{'f1_val': 0.14041368337311058, 'auprc': 0.659382477587263, 'loss_val': 1.340207791157999, 'psi': 0.3480012010587715}
[S13] START round=1 head_norm_before_train=1.116155 (no previous merge yet)
[S13] round=1 local utility u=0.200330 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7094127900751224, 'loss_val': 1.2859565314314279, 'psi': 0.3679965735762808}-{'f1_val': 0.1403857625770531, 'auprc': 0.594619004003005, 'loss_val': 1.3422352516532636, 'psi': 0.3220790591474339}
[S14] START round=1 head_norm_before_train=1.160066 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8084455815267289, 'loss_val': 1.337551847468466, 'psi': 0.5612750583802062}-{'f1_val': 0.18437060747313444, 'auprc': 0.4488834753231764, 'loss_val': 1.3595805457411934, 'psi': 0.29017575461315126}
[S15] START round=1 head_norm_before_train=1.157080 (no previous merge yet)
[S15] round=1 local utility u=0.300955 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7755169226754911, 'loss_val': 1.2842115784128756, 'psi': 0.39404695988713145}-{'f1_val': 0.13973365136155833, 'auprc': 0.5899394712750765, 'loss_val': 1.3293891439745544, 'psi': 0.3198159793269656}
[S16] START round=1 head_norm_before_train=1.185530 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7891594907085308, 'loss_val': 1.3215982585435575, 'psi': 0.4000462664029343}-{'f1_val': 0.27518328570580686, 'auprc': 0.562259134833215, 'loss_val': 1.3521293414048896, 'psi': 0.3900136253567701}
[S17] START round=1 head_norm_before_train=1.149652 (no previous merge yet)
[S17] round=1 local utility u=0.186630 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6574022135003236, 'loss_val': 1.299316027303212, 'psi': 0.3475302633905601}-{'f1_val': 0.14094896331738438, 'auprc': 0.5470894508634759, 'loss_val': 1.3416369353283417, 'psi': 0.30340515833582105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:49315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49304
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S7
[S13] cosine check vs S7: cos=-0.0341
[S13] DROPPED delta from S7 (cos=-0.0341 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1790) from S15
[S17] cosine check vs S15: cos=0.0023
[S9] RECEIVED delta(kind=head bytes=1790) from S4
[S9] cosine check vs S4: cos=0.0442
[S10] RECEIVED delta(kind=head bytes=1799) from S9
[S10] cosine check vs S9: cos=-0.0046
[S10] DROPPED delta from S9 (cos=-0.0046 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.0359
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=0.0615
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=-0.0371
[S4] DROPPED delta from S3 (cos=-0.0371 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1787) from S11
[S2] cosine check vs S11: cos=-0.1028
[S2] DROPPED delta from S11 (cos=-0.1028 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1786) from S13
[S15] cosine check vs S13: cos=0.0585
[S6] RECEIVED delta(kind=head bytes=1791) from S14
[S6] cosine check vs S14: cos=0.0355
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=-0.0409
[S7] DROPPED delta from S6 (cos=-0.0409 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:49307
[S17] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S17
[S6] cosine check vs S17: cos=-0.0102
[S6] DROPPED delta from S17 (cos=-0.0102 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.191627
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.995796e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.847771 delta_norm=0.799580
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.203709
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.476627e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.885929 delta_norm=0.847663
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.200828
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.245817e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.854350 delta_norm=0.824582
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.197304
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.112265e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.3831 head_norm=0.862769 delta_norm=0.811226
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.192922
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.256303e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.744330 delta_norm=0.725630
[S17] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.206601 (no previous merge yet)
[S2] round=2 local utility u=0.013482 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7275940007740885, 'loss_val': 1.1812470176160472, 'psi': 0.3761038803427755}-{'f1_val': 0.1417771333885667, 'auprc': 0.7403995722137222, 'loss_val': 1.246627456204877, 'psi': 0.38122610891862896}
[S3] START round=2 head_norm_before_train=1.171281 (no previous merge yet)
[S3] round=2 local utility u=0.270686 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.781857672874326, 'loss_val': 1.2950360587089935, 'psi': 0.3966471085181946}-{'f1_val': 0.13984006561410703, 'auprc': 0.614694050064992, 'loss_val': 1.334916372673753, 'psi': 0.329781659394461}
[S4] START round=2 head_norm_before_train=1.248154 (no previous merge yet)
[S4] round=2 local utility u=0.053178 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7808035505993267, 'loss_val': 1.1810006347967053, 'psi': 0.3964573975768412}-{'f1_val': 0.14022662889518414, 'auprc': 0.7778617028871608, 'loss_val': 1.2785312108815685, 'psi': 0.39528065849197486}
[S5] START round=2 head_norm_before_train=1.171059 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7339245760214717, 'loss_val': 1.2899991665518922, 'psi': 0.37892697326573155}-{'f1_val': 0.4247767552317834, 'auprc': 0.7425877989110283, 'loss_val': 1.3366628209285483, 'psi': 0.5519011727034814}
[S6] START round=2 head_norm_before_train=0.854350 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.013606 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6429097157431972, 'loss_val': 1.2373327492132224, 'psi': 0.3420196555280481}-{'f1_val': 0.14142628205128205, 'auprc': 0.6430732923021409, 'loss_val': 1.2650349595666577, 'psi': 0.3420850861516256}
[S7] START round=2 head_norm_before_train=1.108197 (no previous merge yet)
[S7] round=2 local utility u=0.009816 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7705904032979111, 'loss_val': 1.3104924071492767, 'psi': 0.3934702549566194}-{'f1_val': 0.14205682272909165, 'auprc': 0.7751121389157797, 'loss_val': 1.3436886300254682, 'psi': 0.3952789492037669}
[S8] START round=2 head_norm_before_train=1.224575 (no previous merge yet)
[S8] round=2 local utility u=0.046124 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7659632492954488, 'loss_val': 1.1708813918126286, 'psi': 0.39035888915395384}-{'f1_val': 0.13995598239295717, 'auprc': 0.7672544035396379, 'loss_val': 1.2670027581849719, 'psi': 0.3908753508516295}
[S9] START round=2 head_norm_before_train=0.885929 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.99112190883122, 'loss_val': 1.2664860126660475, 'psi': 0.48128753781648564}-{'f1_val': 0.141397957139996, 'auprc': 0.9996730042632496, 'loss_val': 1.2749174330765842, 'psi': 0.48470797598929743}
[S10] START round=2 head_norm_before_train=1.182186 (no previous merge yet)
[S10] round=2 local utility u=0.085726 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5867928627243174, 'loss_val': 1.1964422933748244, 'psi': 0.3178901276147613}-{'f1_val': 0.13862163754172394, 'auprc': 0.5630166014263412, 'loss_val': 1.2965655359611548, 'psi': 0.3083796230955709}
[S11] START round=2 head_norm_before_train=1.146167 (no previous merge yet)
[S11] round=2 local utility u=0.049800 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7897039032309676, 'loss_val': 1.274100040503352, 'psi': 0.40012977131625344}-{'f1_val': 0.14041368337311058, 'auprc': 0.7687132190131847, 'loss_val': 1.3107276718143999, 'psi': 0.3917334976291402}
[S13] START round=2 head_norm_before_train=1.138468 (no previous merge yet)
[S13] round=2 local utility u=0.049635 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7211864535796817, 'loss_val': 1.2220084316901818, 'psi': 0.37270603897810456}-{'f1_val': 0.1403857625770531, 'auprc': 0.7094127900751224, 'loss_val': 1.2859565314314279, 'psi': 0.3679965735762808}
[S14] START round=2 head_norm_before_train=1.173759 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14303079416531606, 'auprc': 0.8199901128371911, 'loss_val': 1.3116150111940796, 'psi': 0.41381452163406607}-{'f1_val': 0.39649470961585787, 'auprc': 0.8084455815267289, 'loss_val': 1.337551847468466, 'psi': 0.5612750583802062}
[S15] START round=2 head_norm_before_train=0.847771 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.018648 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7761213650449376, 'loss_val': 1.2487297707533365, 'psi': 0.39428873683491006}-{'f1_val': 0.13973365136155833, 'auprc': 0.7755169226754911, 'loss_val': 1.2842115784128756, 'psi': 0.39404695988713145}
[S16] START round=2 head_norm_before_train=0.862769 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.768043 metrics={'f1_val': 0.3652246106926923, 'auprc': 0.8535011215287791, 'loss_val': 1.3260595679008176, 'psi': 0.560535215027127}-{'f1_val': 0.14063745019920318, 'auprc': 0.7891594907085308, 'loss_val': 1.3215982585435575, 'psi': 0.4000462664029343}
[S17] START round=2 head_norm_before_train=0.744330 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.082100 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7011768860894638, 'loss_val': 1.2664405763584283, 'psi': 0.3650401324262162}-{'f1_val': 0.14094896331738438, 'auprc': 0.6574022135003236, 'loss_val': 1.299316027303212, 'psi': 0.3475302633905601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S3] → sending delta(kind=head bytes=1783) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:49308
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:49308
[S3] sending update (kind=head size=1783 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S6
[S9] cosine check vs S6: cos=0.0521
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] cosine check vs S7: cos=-0.0249
[S5] DROPPED delta from S7 (cos=-0.0249 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S16
[S3] cosine check vs S16: cos=-0.0582
[S3] DROPPED delta from S16 (cos=-0.0582 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S2
[S7] cosine check vs S2: cos=0.0627
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=-0.0271
[S7] DROPPED delta from S13 (cos=-0.0271 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S11
[S6] cosine check vs S11: cos=0.0099
[S5] RECEIVED delta(kind=head bytes=1783) from S3
[S5] cosine check vs S3: cos=-0.0287
[S5] DROPPED delta from S3 (cos=-0.0287 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.0812
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0015
[S15] DROPPED delta from S8 (cos=-0.0015 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S4
[S15] cosine check vs S4: cos=-0.0532
[S15] DROPPED delta from S4 (cos=-0.0532 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S10
[S8] cosine check vs S10: cos=0.0964
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.0317
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.195087
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.685987e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.711451 delta_norm=0.668599
[S5] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.913585
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.260564e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.659554 delta_norm=0.626056
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.120021
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.200880e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.872818 delta_norm=0.820088
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.905139
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.341133e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.741159 delta_norm=0.734113
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.283713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.481891e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.5711 head_norm=0.934205 delta_norm=0.848189
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.270537 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.6394549984730146, 'auprc': 0.7614588899315644, 'loss_val': 1.055839435089147, 'psi': 0.6882565550564346}-{'f1_val': 0.1417771333885667, 'auprc': 0.7275940007740885, 'loss_val': 1.1812470176160472, 'psi': 0.3761038803427755}
[S3] START round=3 head_norm_before_train=1.191691 (no previous merge yet)
[S3] round=3 local utility u=0.063687 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8082389693094585, 'loss_val': 1.2468050022646249, 'psi': 0.40719962709224766}-{'f1_val': 0.13984006561410703, 'auprc': 0.781857672874326, 'loss_val': 1.2950360587089935, 'psi': 0.3966471085181946}
[S4] START round=3 head_norm_before_train=1.302987 (no previous merge yet)
[S4] round=3 local utility u=0.850930 metrics={'f1_val': 0.3900206607050303, 'auprc': 0.7851084877152753, 'loss_val': 0.9908201662102787, 'psi': 0.5480557915091283}-{'f1_val': 0.14022662889518414, 'auprc': 0.7808035505993267, 'loss_val': 1.1810006347967053, 'psi': 0.3964573975768412}
[S5] START round=3 head_norm_before_train=0.711451 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7290323210499756, 'loss_val': 1.2829411963892157, 'psi': 0.3769700712771331}-{'f1_val': 0.14226190476190476, 'auprc': 0.7339245760214717, 'loss_val': 1.2899991665518922, 'psi': 0.37892697326573155}
[S6] START round=3 head_norm_before_train=0.741159 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.044999 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.643169037348179, 'loss_val': 1.1481136400138894, 'psi': 0.3421233841700408}-{'f1_val': 0.14142628205128205, 'auprc': 0.6429097157431972, 'loss_val': 1.2373327492132224, 'psi': 0.3420196555280481}
[S7] START round=3 head_norm_before_train=0.872818 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5632870893388656, 'loss_val': 1.3128890826733863, 'psi': 0.31054892937300127}-{'f1_val': 0.14205682272909165, 'auprc': 0.7705904032979111, 'loss_val': 1.3104924071492767, 'psi': 0.3934702549566194}
[S8] START round=3 head_norm_before_train=0.934205 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.809393 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.7827113567339912, 'loss_val': 1.0009997769052492, 'psi': 0.5369241788034612}-{'f1_val': 0.13995598239295717, 'auprc': 0.7659632492954488, 'loss_val': 1.1708813918126286, 'psi': 0.39035888915395384}
[S9] START round=3 head_norm_before_train=0.659554 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.004361 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9792219305198757, 'loss_val': 1.2220635985053692, 'psi': 0.4765275464919479}-{'f1_val': 0.141397957139996, 'auprc': 0.99112190883122, 'loss_val': 1.2664860126660475, 'psi': 0.48128753781648564}
[S10] START round=3 head_norm_before_train=1.239519 (no previous merge yet)
[S10] round=3 local utility u=1.000000 metrics={'f1_val': 0.4170758964666951, 'auprc': 0.6608191470043748, 'loss_val': 0.998492494411225, 'psi': 0.514573196681767}-{'f1_val': 0.13862163754172394, 'auprc': 0.5867928627243174, 'loss_val': 1.1964422933748244, 'psi': 0.3178901276147613}
[S11] START round=3 head_norm_before_train=1.164990 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6032485980243489, 'loss_val': 1.2221063676881312, 'psi': 0.3255476492336059}-{'f1_val': 0.14041368337311058, 'auprc': 0.7897039032309676, 'loss_val': 1.274100040503352, 'psi': 0.40012977131625344}
[S13] START round=3 head_norm_before_train=1.173664 (no previous merge yet)
[S13] round=3 local utility u=0.899429 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.7323825483967847, 'loss_val': 1.1108923475331764, 'psi': 0.5425997476874889}-{'f1_val': 0.1403857625770531, 'auprc': 0.7211864535796817, 'loss_val': 1.2220084316901818, 'psi': 0.37270603897810456}
[S14] START round=3 head_norm_before_train=1.197076 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.805397535316418, 'loss_val': 1.2748337406452976, 'psi': 0.40637372585618947}-{'f1_val': 0.14303079416531606, 'auprc': 0.8199901128371911, 'loss_val': 1.3116150111940796, 'psi': 0.41381452163406607}
[S15] START round=3 head_norm_before_train=0.903087 cos_to_last_merge=0.9925 (last merge round=1)
[S15] round=3 local utility u=0.038414 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767681224110067, 'loss_val': 1.1738430099709483, 'psi': 0.3945474397813377}-{'f1_val': 0.13973365136155833, 'auprc': 0.7761213650449376, 'loss_val': 1.2487297707533365, 'psi': 0.39428873683491006}
[S16] START round=3 head_norm_before_train=0.883846 cos_to_last_merge=0.9965 (last merge round=1)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6515738833292257, 'loss_val': 1.2816642020690905, 'psi': 0.3450120234512122}-{'f1_val': 0.3652246106926923, 'auprc': 0.8535011215287791, 'loss_val': 1.3260595679008176, 'psi': 0.560535215027127}
[S17] START round=3 head_norm_before_train=0.807966 cos_to_last_merge=0.9883 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6148313143722695, 'loss_val': 1.1182068419735096, 'psi': 0.3305019037393384}-{'f1_val': 0.14094896331738438, 'auprc': 0.7011768860894638, 'loss_val': 1.2664405763584283, 'psi': 0.3650401324262162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:49312
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1792) from S4
[S11] cosine check vs S4: cos=0.0108
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=-0.0820
[S8] DROPPED delta from S6 (cos=-0.0820 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0098
[S9] DROPPED delta from S10 (cos=-0.0098 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=-0.0197
[S9] DROPPED delta from S8 (cos=-0.0197 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1789) from S3
[S2] cosine check vs S3: cos=0.0345
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=-0.0500
[S16] DROPPED delta from S9 (cos=-0.0500 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] cosine check vs S15: cos=0.4475
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.0315
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=-0.0316
[S10] DROPPED delta from S13 (cos=-0.0316 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.191098
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.036314e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.913366 delta_norm=0.903631
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.742204
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.559860e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.725195 delta_norm=0.455986
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.6395 head_norm=1.303025
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.775140e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.6291 head_norm=0.908220 delta_norm=0.877514
[S2] aggregate: ROLLBACK (f1_val pre=0.639 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.957494
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.962325e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.2022 head_norm=0.820578 delta_norm=0.796232
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.908220 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7762407666555408, 'loss_val': 1.001010547638182, 'psi': 0.5605328550785429}-{'f1_val': 0.6394549984730146, 'auprc': 0.7614588899315644, 'loss_val': 1.055839435089147, 'psi': 0.6882565550564346}
[S3] START round=4 head_norm_before_train=1.221439 (no previous merge yet)
[S3] round=4 local utility u=0.010739 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8004422376939202, 'loss_val': 1.2019374083060184, 'psi': 0.4040809344460323}-{'f1_val': 0.13984006561410703, 'auprc': 0.8082389693094585, 'loss_val': 1.2468050022646249, 'psi': 0.40719962709224766}
[S4] START round=4 head_norm_before_train=1.372174 (no previous merge yet)
[S4] round=4 local utility u=0.809693 metrics={'f1_val': 0.6672593687841668, 'auprc': 0.6599324317003088, 'loss_val': 0.6593373525018461, 'psi': 0.6643285939506236}-{'f1_val': 0.3900206607050303, 'auprc': 0.7851084877152753, 'loss_val': 0.9908201662102787, 'psi': 0.5480557915091283}
[S5] START round=4 head_norm_before_train=0.725195 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.024537 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7373194188348038, 'loss_val': 1.2587293196008078, 'psi': 0.3802849103910644}-{'f1_val': 0.14226190476190476, 'auprc': 0.7290323210499756, 'loss_val': 1.2829411963892157, 'psi': 0.3769700712771331}
[S6] START round=4 head_norm_before_train=0.795379 cos_to_last_merge=0.9929 (last merge round=2)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7322930368119778, 'loss_val': 0.9500562584738349, 'psi': 0.5431506374493115}-{'f1_val': 0.14142628205128205, 'auprc': 0.643169037348179, 'loss_val': 1.1481136400138894, 'psi': 0.3421233841700408}
[S7] START round=4 head_norm_before_train=0.887818 cos_to_last_merge=0.9978 (last merge round=2)
[S7] round=4 local utility u=0.024926 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5722589955282025, 'loss_val': 1.2899530785862467, 'psi': 0.31413769184873597}-{'f1_val': 0.14205682272909165, 'auprc': 0.5632870893388656, 'loss_val': 1.3128890826733863, 'psi': 0.31054892937300127}
[S8] START round=4 head_norm_before_train=0.994887 cos_to_last_merge=0.9957 (last merge round=2)
[S8] round=4 local utility u=0.112265 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.7792558646088388, 'loss_val': 0.7648973220959178, 'psi': 0.5354213430523804}-{'f1_val': 0.37306606018310795, 'auprc': 0.7827113567339912, 'loss_val': 1.0009997769052492, 'psi': 0.5369241788034612}
[S9] START round=4 head_norm_before_train=0.698254 cos_to_last_merge=0.9954 (last merge round=2)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7898573855071603, 'loss_val': 1.1756297352764002, 'psi': 0.4007817284868618}-{'f1_val': 0.141397957139996, 'auprc': 0.9792219305198757, 'loss_val': 1.2220635985053692, 'psi': 0.4765275464919479}
[S10] START round=4 head_norm_before_train=1.299204 (no previous merge yet)
[S10] round=4 local utility u=0.496090 metrics={'f1_val': 0.4360699934657673, 'auprc': 0.8638715738849683, 'loss_val': 0.7294340510364646, 'psi': 0.6071906256334477}-{'f1_val': 0.4170758964666951, 'auprc': 0.6608191470043748, 'loss_val': 0.998492494411225, 'psi': 0.514573196681767}
[S11] START round=4 head_norm_before_train=0.913366 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.205550 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7437309716843062, 'loss_val': 1.2324530083850986, 'psi': 0.38174059869758886}-{'f1_val': 0.14041368337311058, 'auprc': 0.6032485980243489, 'loss_val': 1.2221063676881312, 'psi': 0.3255476492336059}
[S13] START round=4 head_norm_before_train=1.211410 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.37186169211984377, 'auprc': 0.7352441874441602, 'loss_val': 0.9152846900342521, 'psi': 0.5172146902495703}-{'f1_val': 0.41607788054795825, 'auprc': 0.7323825483967847, 'loss_val': 1.1108923475331764, 'psi': 0.5425997476874889}
[S14] START round=4 head_norm_before_train=1.229281 (no previous merge yet)
[S14] round=4 local utility u=0.011622 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7938081646964377, 'loss_val': 1.2168212348464267, 'psi': 0.40173797760819735}-{'f1_val': 0.14035785288270378, 'auprc': 0.805397535316418, 'loss_val': 1.2748337406452976, 'psi': 0.40637372585618947}
[S15] START round=4 head_norm_before_train=0.820578 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.885314 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7808464683920143, 'loss_val': 1.0764545851511589, 'psi': 0.5622791908255631}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767681224110067, 'loss_val': 1.1738430099709483, 'psi': 0.3945474397813377}
[S16] START round=4 head_norm_before_train=0.914577 cos_to_last_merge=0.9880 (last merge round=1)
[S16] round=4 local utility u=0.248690 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7958611696285215, 'loss_val': 1.2171466377819369, 'psi': 0.4027269379709305}-{'f1_val': 0.14063745019920318, 'auprc': 0.6515738833292257, 'loss_val': 1.2816642020690905, 'psi': 0.3450120234512122}
[S17] START round=4 head_norm_before_train=0.880248 cos_to_last_merge=0.9658 (last merge round=1)
[S17] round=4 local utility u=1.000000 metrics={'f1_val': 0.39183458374649976, 'auprc': 0.8111982604227141, 'loss_val': 0.8939972233754019, 'psi': 0.5595800544169856}-{'f1_val': 0.14094896331738438, 'auprc': 0.6148313143722695, 'loss_val': 1.1182068419735096, 'psi': 0.3305019037393384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:49309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:49309
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.7328
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.0252
[S14] DROPPED delta from S16 (cos=-0.0252 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.3570
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.5949
[S8] RECEIVED delta(kind=head bytes=1792) from S14
[S8] cosine check vs S14: cos=0.0431
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] cosine check vs S3: cos=0.6508
[S3] RECEIVED delta(kind=head bytes=1791) from S7
[S3] cosine check vs S7: cos=0.0107
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=-0.0272
[S9] DROPPED delta from S8 (cos=-0.0272 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0023
[S9] DROPPED delta from S10 (cos=-0.0023 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] cosine check vs S11: cos=-0.1537
[S15] DROPPED delta from S11 (cos=-0.1537 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=-0.0918
[S8] DROPPED delta from S6 (cos=-0.0918 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=-0.0837
[S3] DROPPED delta from S17 (cos=-0.0837 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.4167 head_norm=0.957749
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.822690e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.4163 head_norm=1.008040 delta_norm=0.482269
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=1.257050
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.701249e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.777997 delta_norm=0.770125
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.748731
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.672507e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.721684 delta_norm=0.367251
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.938818
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.041199e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=1.124265 delta_norm=0.504120
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3729 head_norm=1.059033
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.100726e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3729 head_norm=0.845136 delta_norm=0.810073
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.951277
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.891092e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.702521 delta_norm=0.489109
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.008040 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.911603 metrics={'f1_val': 0.7025540705504474, 'auprc': 0.7734143291333018, 'loss_val': 0.8842836103215608, 'psi': 0.7308981739835891}-{'f1_val': 0.4167275806938775, 'auprc': 0.7762407666555408, 'loss_val': 1.001010547638182, 'psi': 0.5605328550785429}
[S3] START round=5 head_norm_before_train=0.777997 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.003658 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7980732775230682, 'loss_val': 1.187514094107091, 'psi': 0.4031333503776915}-{'f1_val': 0.13984006561410703, 'auprc': 0.8004422376939202, 'loss_val': 1.2019374083060184, 'psi': 0.4040809344460323}
[S4] START round=5 head_norm_before_train=1.467937 (no previous merge yet)
[S4] round=5 local utility u=0.034698 metrics={'f1_val': 0.6664480091078382, 'auprc': 0.6535110257786741, 'loss_val': 0.5658086547636392, 'psi': 0.6612732157761725}-{'f1_val': 0.6672593687841668, 'auprc': 0.6599324317003088, 'loss_val': 0.6593373525018461, 'psi': 0.6643285939506236}
[S5] START round=5 head_norm_before_train=0.721684 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.009113 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7373029207626696, 'loss_val': 1.2404544301152358, 'psi': 0.38027831116221067}-{'f1_val': 0.14226190476190476, 'auprc': 0.7373194188348038, 'loss_val': 1.2587293196008078, 'psi': 0.3802849103910644}
[S6] START round=5 head_norm_before_train=0.858357 cos_to_last_merge=0.9749 (last merge round=2)
[S6] round=5 local utility u=0.374083 metrics={'f1_val': 0.41673395620738773, 'auprc': 0.9384150078812441, 'loss_val': 0.8183261616384708, 'psi': 0.6254063768769302}-{'f1_val': 0.41705570454086727, 'auprc': 0.7322930368119778, 'loss_val': 0.9500562584738349, 'psi': 0.5431506374493115}
[S7] START round=5 head_norm_before_train=0.903642 cos_to_last_merge=0.9928 (last merge round=2)
[S7] round=5 local utility u=0.011627 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5732308126585838, 'loss_val': 1.2696148889396113, 'psi': 0.3145264187008885}-{'f1_val': 0.14205682272909165, 'auprc': 0.5722589955282025, 'loss_val': 1.2899530785862467, 'psi': 0.31413769184873597}
[S8] START round=5 head_norm_before_train=0.845136 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.319806 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.9957387533363046, 'loss_val': 0.775137607016522, 'psi': 0.6220548652224132}-{'f1_val': 0.3728649953480749, 'auprc': 0.7792558646088388, 'loss_val': 0.7648973220959178, 'psi': 0.5354213430523804}
[S9] START round=5 head_norm_before_train=0.739249 cos_to_last_merge=0.9850 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6693514742885669, 'loss_val': 1.0871646023089119, 'psi': 0.35257936399942436}-{'f1_val': 0.141397957139996, 'auprc': 0.7898573855071603, 'loss_val': 1.1756297352764002, 'psi': 0.4007817284868618}
[S10] START round=5 head_norm_before_train=1.363641 (no previous merge yet)
[S10] round=5 local utility u=0.383837 metrics={'f1_val': 0.5264210508902589, 'auprc': 0.8789387465545558, 'loss_val': 0.5490677466501012, 'psi': 0.6674281291559777}-{'f1_val': 0.4360699934657673, 'auprc': 0.8638715738849683, 'loss_val': 0.7294340510364646, 'psi': 0.6071906256334477}
[S11] START round=5 head_norm_before_train=1.124265 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.019320 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7527322019744953, 'loss_val': 1.2208157646531526, 'psi': 0.38534109081366447}-{'f1_val': 0.14041368337311058, 'auprc': 0.7437309716843062, 'loss_val': 1.2324530083850986, 'psi': 0.38174059869758886}
[S13] START round=5 head_norm_before_train=1.277045 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.3768641666810957, 'auprc': 0.6148833378062629, 'loss_val': 0.8480475854416656, 'psi': 0.4720718351311626}-{'f1_val': 0.37186169211984377, 'auprc': 0.7352441874441602, 'loss_val': 0.9152846900342521, 'psi': 0.5172146902495703}
[S14] START round=5 head_norm_before_train=1.272555 (no previous merge yet)
[S14] round=5 local utility u=0.008190 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7705267904624469, 'loss_val': 1.1305976169167116, 'psi': 0.392425427914601}-{'f1_val': 0.14035785288270378, 'auprc': 0.7938081646964377, 'loss_val': 1.2168212348464267, 'psi': 0.40173797760819735}
[S15] START round=5 head_norm_before_train=0.866490 cos_to_last_merge=0.9933 (last merge round=3)
[S15] round=5 local utility u=0.228190 metrics={'f1_val': 0.4527306579203169, 'auprc': 0.7980633710886564, 'loss_val': 0.888703037968365, 'psi': 0.5908637431876527}-{'f1_val': 0.416567672447929, 'auprc': 0.7808464683920143, 'loss_val': 1.0764545851511589, 'psi': 0.5622791908255631}
[S16] START round=5 head_norm_before_train=0.702521 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.023970 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7998750269164958, 'loss_val': 1.1812473943287056, 'psi': 0.4043324808861203}-{'f1_val': 0.14063745019920318, 'auprc': 0.7958611696285215, 'loss_val': 1.2171466377819369, 'psi': 0.4027269379709305}
[S17] START round=5 head_norm_before_train=0.974420 cos_to_last_merge=0.9329 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3524829542324496, 'auprc': 0.6292895370309579, 'loss_val': 0.8897507595598959, 'psi': 0.4632055873518529}-{'f1_val': 0.39183458374649976, 'auprc': 0.8111982604227141, 'loss_val': 0.8939972233754019, 'psi': 0.5595800544169856}
[S8] not sending this round → trigger blocked (psi=0.622)
[S10] not sending this round → trigger blocked (psi=0.667)
[S14] not sending this round → trigger blocked (psi=0.392)
[S11] not sending this round → trigger blocked (psi=0.385)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[S6] not sending this round → trigger blocked (psi=0.625)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S3] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9398
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=0.9038
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.6175
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.5585
[S15] RECEIVED delta(kind=head bytes=1790) from S2
[S15] cosine check vs S2: cos=0.3600
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=-0.0059
[S14] DROPPED delta from S16 (cos=-0.0059 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.8942
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.350 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=0.574 → S8@127.0.0.1:49309
[S8] ⇄ pheromone p=0.518 → S9@127.0.0.1:49310
[S13] ⇄ pheromone p=0.464 → S10@127.0.0.1:49311
[S10] ⇄ pheromone p=0.621 → S9@127.0.0.1:49310
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.140023
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.141938e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.332238 delta_norm=0.314194
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.384 → S15@127.0.0.1:49315
[S14] ⇄ pheromone p=0.413 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.812726
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.111177e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4225 head_norm=0.767247 delta_norm=0.411118
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.370 → S2@127.0.0.1:49302
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.7026 head_norm=1.049828
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.347301e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.7021 head_norm=0.908973 delta_norm=0.234730
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.649 → S15@127.0.0.1:49315
[S7] ⇄ pheromone p=0.365 → S3@127.0.0.1:49303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.742187
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.159647e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.818717 delta_norm=0.215965
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.415 → S16@127.0.0.1:49316
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.741928
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.245279e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1871 head_norm=0.667331 delta_norm=0.324528
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.451 → S14@127.0.0.1:49314
[S4] ⇄ pheromone p=0.582 → S11@127.0.0.1:49312
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.4527 head_norm=0.939699
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.645417e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.3796 head_norm=0.820901 delta_norm=0.564542
[S15] aggregate: ROLLBACK (f1_val pre=0.453 post=0.380 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.546 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.511 → S3@127.0.0.1:49303
[S2] START round=6 head_norm_before_train=0.908973 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.025714 metrics={'f1_val': 0.7019093540318158, 'auprc': 0.7264199532950759, 'loss_val': 0.688003989231237, 'psi': 0.7117135937371197}-{'f1_val': 0.7025540705504474, 'auprc': 0.7734143291333018, 'loss_val': 0.8842836103215608, 'psi': 0.7308981739835891}
[S3] START round=6 head_norm_before_train=0.767247 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.594042 metrics={'f1_val': 0.41009094881297237, 'auprc': 0.6399498406362076, 'loss_val': 1.1465653727716074, 'psi': 0.5020345055422665}-{'f1_val': 0.13984006561410703, 'auprc': 0.7980732775230682, 'loss_val': 1.187514094107091, 'psi': 0.4031333503776915}
[S4] START round=6 head_norm_before_train=1.564448 (no previous merge yet)
[S4] round=6 local utility u=0.017938 metrics={'f1_val': 0.664513127154549, 'auprc': 0.6520969630758118, 'loss_val': 0.5140821342104208, 'psi': 0.6595466615230541}-{'f1_val': 0.6664480091078382, 'auprc': 0.6535110257786741, 'loss_val': 0.5658086547636392, 'psi': 0.6612732157761725}
[S5] START round=6 head_norm_before_train=0.818717 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.044190 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7601409205392542, 'loss_val': 1.2205886788964444, 'psi': 0.38941351107284455}-{'f1_val': 0.14226190476190476, 'auprc': 0.7373029207626696, 'loss_val': 1.2404544301152358, 'psi': 0.38027831116221067}
[S6] START round=6 head_norm_before_train=0.921927 cos_to_last_merge=0.9487 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=6 local utility u=0.108826 metrics={'f1_val': 0.4170142901606496, 'auprc': 0.9837829173294773, 'loss_val': 0.7384603811128466, 'psi': 0.6437217410281807}-{'f1_val': 0.41673395620738773, 'auprc': 0.9384150078812441, 'loss_val': 0.8183261616384708, 'psi': 0.6254063768769302}
[S7] START round=6 head_norm_before_train=0.924579 cos_to_last_merge=0.9861 (last merge round=2)
[S7] round=6 local utility u=0.118957 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6452952035177656, 'loss_val': 1.2478938475213104, 'psi': 0.3433521750445612}-{'f1_val': 0.14205682272909165, 'auprc': 0.5732308126585838, 'loss_val': 1.2696148889396113, 'psi': 0.3145264187008885}
[S8] START round=6 head_norm_before_train=0.904711 cos_to_last_merge=0.9910 (last merge round=4)
[S8] round=6 local utility u=0.100523 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.996190263348248, 'loss_val': 0.5734394438439728, 'psi': 0.6220347930706379}-{'f1_val': 0.3729322731464855, 'auprc': 0.9957387533363046, 'loss_val': 0.775137607016522, 'psi': 0.6220548652224132}
[S9] START round=6 head_norm_before_train=0.766469 cos_to_last_merge=0.9761 (last merge round=2)
[S9] round=6 local utility u=0.757380 metrics={'f1_val': 0.3747446057460785, 'auprc': 0.6690407184496714, 'loss_val': 0.9715520656542163, 'psi': 0.4924630508275157}-{'f1_val': 0.141397957139996, 'auprc': 0.6693514742885669, 'loss_val': 1.0871646023089119, 'psi': 0.35257936399942436}
[S10] START round=6 head_norm_before_train=1.442482 (no previous merge yet)
[S10] round=6 local utility u=0.714551 metrics={'f1_val': 0.6885529692213563, 'auprc': 0.9749730901486254, 'loss_val': 0.38086104831675016, 'psi': 0.803121017592264}-{'f1_val': 0.5264210508902589, 'auprc': 0.8789387465545558, 'loss_val': 0.5490677466501012, 'psi': 0.6674281291559777}
[S11] START round=6 head_norm_before_train=1.332238 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6655628449228139, 'loss_val': 1.1459293745362749, 'psi': 0.3504733479929919}-{'f1_val': 0.14041368337311058, 'auprc': 0.7527322019744953, 'loss_val': 1.2208157646531526, 'psi': 0.38534109081366447}
[S13] START round=6 head_norm_before_train=1.337228 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.7127239687590521, 'auprc': 0.7625064030407397, 'loss_val': 0.6230444919830193, 'psi': 0.7326369424717272}-{'f1_val': 0.3768641666810957, 'auprc': 0.6148833378062629, 'loss_val': 0.8480475854416656, 'psi': 0.4720718351311626}
[S14] START round=6 head_norm_before_train=1.316965 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.9059459768232005, 'loss_val': 0.996941701380164, 'psi': 0.6002555614405464}-{'f1_val': 0.14035785288270378, 'auprc': 0.7705267904624469, 'loss_val': 1.1305976169167116, 'psi': 0.392425427914601}
[S15] START round=6 head_norm_before_train=0.820901 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.40787158483772334, 'auprc': 0.793655034393103, 'loss_val': 0.7383745127310803, 'psi': 0.5621849646598752}-{'f1_val': 0.4527306579203169, 'auprc': 0.7980633710886564, 'loss_val': 0.888703037968365, 'psi': 0.5908637431876527}
[S16] START round=6 head_norm_before_train=0.667331 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.613255 metrics={'f1_val': 0.3372256099032942, 'auprc': 0.7929390241090326, 'loss_val': 1.1134578211130974, 'psi': 0.5195109755855896}-{'f1_val': 0.14063745019920318, 'auprc': 0.7998750269164958, 'loss_val': 1.1812473943287056, 'psi': 0.4043324808861203}
[S17] START round=6 head_norm_before_train=1.074297 cos_to_last_merge=0.8974 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.24309720239211272, 'auprc': 0.6113119456637305, 'loss_val': 1.3966636909163972, 'psi': 0.3903830997007598}-{'f1_val': 0.3524829542324496, 'auprc': 0.6292895370309579, 'loss_val': 0.8897507595598959, 'psi': 0.4632055873518529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[S2] not sending this round → trigger blocked (psi=0.712)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49316
[S3] not sending this round → trigger blocked (psi=0.502)
[S4] not sending this round → trigger blocked (psi=0.660)
[S5] not sending this round → trigger blocked (psi=0.389)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S16] not sending this round → trigger blocked (psi=0.520)
[S7] not sending this round → trigger blocked (psi=0.343)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49310
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S9
[S16] cosine check vs S9: cos=-0.1104
[S16] DROPPED delta from S9 (cos=-0.1104 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.1540
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.6697
[S9] RECEIVED delta(kind=head bytes=1793) from S8
[S9] cosine check vs S8: cos=0.2499
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.0082
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0407
[S10] DROPPED delta from S13 (cos=-0.0407 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.3747 head_norm=0.804110
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.344142e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.4162 head_norm=0.711696 delta_norm=0.634414
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.3726 head_norm=0.985359
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.611444e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.3726 head_norm=0.859394 delta_norm=0.461144
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.974766 cos_to_last_merge=0.9846 (last merge round=5)
[S2] round=7 local utility u=0.002061 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6625658272923709, 'loss_val': 0.4907673211259338, 'psi': 0.6860166962724461}-{'f1_val': 0.7019093540318158, 'auprc': 0.7264199532950759, 'loss_val': 0.688003989231237, 'psi': 0.7117135937371197}
[S3] START round=7 head_norm_before_train=0.792198 cos_to_last_merge=0.9945 (last merge round=5)
[S3] round=7 local utility u=0.021417 metrics={'f1_val': 0.39504158637775766, 'auprc': 0.6250221489960743, 'loss_val': 0.9686517144977784, 'psi': 0.4870338114250843}-{'f1_val': 0.41009094881297237, 'auprc': 0.6399498406362076, 'loss_val': 1.1465653727716074, 'psi': 0.5020345055422665}
[S4] START round=7 head_norm_before_train=1.629153 (no previous merge yet)
[S4] round=7 local utility u=0.449653 metrics={'f1_val': 0.6666599488656557, 'auprc': 0.9438057672077608, 'loss_val': 0.5027825937250051, 'psi': 0.7775182762024977}-{'f1_val': 0.664513127154549, 'auprc': 0.6520969630758118, 'loss_val': 0.5140821342104208, 'psi': 0.6595466615230541}
[S5] START round=7 head_norm_before_train=0.836852 cos_to_last_merge=0.9966 (last merge round=5)
[S5] round=7 local utility u=0.849392 metrics={'f1_val': 0.40703708078271417, 'auprc': 0.7778138490447467, 'loss_val': 1.1634743857174397, 'psi': 0.5553477880875272}-{'f1_val': 0.14226190476190476, 'auprc': 0.7601409205392542, 'loss_val': 1.2205886788964444, 'psi': 0.38941351107284455}
[S6] START round=7 head_norm_before_train=0.988109 cos_to_last_merge=0.9218 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=7 local utility u=0.998046 metrics={'f1_val': 0.699237297554762, 'auprc': 0.9940017497750587, 'loss_val': 0.46636248688010223, 'psi': 0.8171430784428807}-{'f1_val': 0.4170142901606496, 'auprc': 0.9837829173294773, 'loss_val': 0.7384603811128466, 'psi': 0.6437217410281807}
[S7] START round=7 head_norm_before_train=0.942072 cos_to_last_merge=0.9807 (last merge round=2)
[S7] round=7 local utility u=0.023647 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6474011905435789, 'loss_val': 1.2069187405578794, 'psi': 0.34419456985488656}-{'f1_val': 0.14205682272909165, 'auprc': 0.6452952035177656, 'loss_val': 1.2478938475213104, 'psi': 0.3433521750445612}
[S8] START round=7 head_norm_before_train=0.859394 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.996024382359253, 'loss_val': 0.6313205217122543, 'psi': 0.6219684406750399}-{'f1_val': 0.3725978128855645, 'auprc': 0.996190263348248, 'loss_val': 0.5734394438439728, 'psi': 0.6220347930706379}
[S9] START round=7 head_norm_before_train=0.711696 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.117440 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.6680469018299333, 'loss_val': 0.9834462953053951, 'psi': 0.517041161868606}-{'f1_val': 0.3747446057460785, 'auprc': 0.6690407184496714, 'loss_val': 0.9715520656542163, 'psi': 0.4924630508275157}
[S10] START round=7 head_norm_before_train=1.524875 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.5674158726369936, 'auprc': 0.8974390746320732, 'loss_val': 0.4268703414660065, 'psi': 0.6994251534350253}-{'f1_val': 0.6885529692213563, 'auprc': 0.9749730901486254, 'loss_val': 0.38086104831675016, 'psi': 0.803121017592264}
[S11] START round=7 head_norm_before_train=1.344690 cos_to_last_merge=0.9982 (last merge round=5)
[S11] round=7 local utility u=0.916894 metrics={'f1_val': 0.41476539642733834, 'auprc': 0.6791780838004431, 'loss_val': 0.9990975674147062, 'psi': 0.5205304713765803}-{'f1_val': 0.14041368337311058, 'auprc': 0.6655628449228139, 'loss_val': 1.1459293745362749, 'psi': 0.3504733479929919}
[S13] START round=7 head_norm_before_train=1.397304 (no previous merge yet)
[S13] round=7 local utility u=0.041752 metrics={'f1_val': 0.712004967500554, 'auprc': 0.75254853237422, 'loss_val': 0.5053532249869748, 'psi': 0.7282223934500205}-{'f1_val': 0.7127239687590521, 'auprc': 0.7625064030407397, 'loss_val': 0.6230444919830193, 'psi': 0.7326369424717272}
[S14] START round=7 head_norm_before_train=1.366830 (no previous merge yet)
[S14] round=7 local utility u=0.246956 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9968380655219359, 'loss_val': 0.7759032174676109, 'psi': 0.6366320519782891}-{'f1_val': 0.3964619511854436, 'auprc': 0.9059459768232005, 'loss_val': 0.996941701380164, 'psi': 0.6002555614405464}
[S15] START round=7 head_norm_before_train=0.891564 cos_to_last_merge=0.9870 (last merge round=5)
[S15] round=7 local utility u=0.952782 metrics={'f1_val': 0.6973852571003788, 'auprc': 0.7928020271776055, 'loss_val': 0.5673344922929321, 'psi': 0.7355519651312694}-{'f1_val': 0.40787158483772334, 'auprc': 0.793655034393103, 'loss_val': 0.7383745127310803, 'psi': 0.5621849646598752}
[S16] START round=7 head_norm_before_train=0.707313 cos_to_last_merge=0.9933 (last merge round=5)
[S16] round=7 local utility u=0.091998 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.6418812632924034, 'loss_val': 0.9547178725520507, 'psi': 0.5069307389352953}-{'f1_val': 0.3372256099032942, 'auprc': 0.7929390241090326, 'loss_val': 1.1134578211130974, 'psi': 0.5195109755855896}
[S17] START round=7 head_norm_before_train=1.145854 cos_to_last_merge=0.8725 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=7 local utility u=0.751989 metrics={'f1_val': 0.3753539271941718, 'auprc': 0.698460758263618, 'loss_val': 0.9476731327532933, 'psi': 0.5045966596219503}-{'f1_val': 0.24309720239211272, 'auprc': 0.6113119456637305, 'loss_val': 1.3966636909163972, 'psi': 0.3903830997007598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:49314
[S13] not sending this round → trigger blocked (psi=0.728)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[S14] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[S6] not sending this round → trigger blocked (psi=0.817)
[S9] not sending this round → trigger blocked (psi=0.517)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] cosine check vs S11: cos=-0.1513
[S15] DROPPED delta from S11 (cos=-0.1513 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.7532
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=-0.0033
[S14] DROPPED delta from S16 (cos=-0.0033 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.7944
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.7621
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9605
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.8188
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.7884
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.1079
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7017 head_norm=1.064220
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.273452e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.7017 head_norm=0.896135 delta_norm=0.327345
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6974 head_norm=0.988073
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.622493e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6980 head_norm=0.960834 delta_norm=0.362249
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4070 head_norm=0.844986
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.015456e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1692 head_norm=0.868455 delta_norm=0.301546
[S5] aggregate: ROLLBACK (f1_val pre=0.407 post=0.169 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3950 head_norm=0.829374
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.954575e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3961 head_norm=0.731541 delta_norm=0.395458
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4170 head_norm=0.756703
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.792826e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4364 head_norm=0.751866 delta_norm=0.279283
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4148 head_norm=1.367709
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.629751e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3965 head_norm=1.507283 delta_norm=0.262975
[S11] aggregate: ROLLBACK (f1_val pre=0.415 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.896135 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.015168 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6572615252279681, 'loss_val': 0.4424751060528609, 'psi': 0.6836906889149084}-{'f1_val': 0.7016506089258296, 'auprc': 0.6625658272923709, 'loss_val': 0.4907673211259338, 'psi': 0.6860166962724461}
[S3] START round=8 head_norm_before_train=0.731541 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.272262 metrics={'f1_val': 0.3918947616800378, 'auprc': 0.8084174615759855, 'loss_val': 0.955431903288737, 'psi': 0.5585038416384169}-{'f1_val': 0.39504158637775766, 'auprc': 0.6250221489960743, 'loss_val': 0.9686517144977784, 'psi': 0.4870338114250843}
[S4] START round=8 head_norm_before_train=1.676750 (no previous merge yet)
[S4] round=8 local utility u=0.866494 metrics={'f1_val': 0.953002109037413, 'auprc': 0.9412697375534829, 'loss_val': 0.4802401406822468, 'psi': 0.948309160443841}-{'f1_val': 0.6666599488656557, 'auprc': 0.9438057672077608, 'loss_val': 0.5027825937250051, 'psi': 0.7775182762024977}
[S5] START round=8 head_norm_before_train=0.868455 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.41782938933607694, 'auprc': 0.6383178642680746, 'loss_val': 1.1663740837027565, 'psi': 0.506024779308876}-{'f1_val': 0.40703708078271417, 'auprc': 0.7778138490447467, 'loss_val': 1.1634743857174397, 'psi': 0.5553477880875272}
[S6] START round=8 head_norm_before_train=1.060515 cos_to_last_merge=0.8988 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6941168866791392, 'auprc': 0.9619571134229227, 'loss_val': 0.4237661778615735, 'psi': 0.8012529773766526}-{'f1_val': 0.699237297554762, 'auprc': 0.9940017497750587, 'loss_val': 0.46636248688010223, 'psi': 0.8171430784428807}
[S7] START round=8 head_norm_before_train=0.958096 cos_to_last_merge=0.9760 (last merge round=2)
[S7] round=8 local utility u=0.674046 metrics={'f1_val': 0.3764219109142447, 'auprc': 0.6030872419389671, 'loss_val': 1.1320758473546404, 'psi': 0.4670880433241337}-{'f1_val': 0.14205682272909165, 'auprc': 0.6474011905435789, 'loss_val': 1.2069187405578794, 'psi': 0.34419456985488656}
[S8] START round=8 head_norm_before_train=0.931981 cos_to_last_merge=0.9896 (last merge round=6)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.7138869500399027, 'auprc': 0.9973911085874387, 'loss_val': 0.3676226578754002, 'psi': 0.827288613458917}-{'f1_val': 0.3725978128855645, 'auprc': 0.996024382359253, 'loss_val': 0.6313205217122543, 'psi': 0.6219684406750399}
[S9] START round=8 head_norm_before_train=0.752158 cos_to_last_merge=0.9949 (last merge round=6)
[S9] round=8 local utility u=0.618998 metrics={'f1_val': 0.4361029275181792, 'auprc': 0.9815751949881808, 'loss_val': 0.8044293026606876, 'psi': 0.6542918345061799}-{'f1_val': 0.41637066856105454, 'auprc': 0.6680469018299333, 'loss_val': 0.9834462953053951, 'psi': 0.517041161868606}
[S10] START round=8 head_norm_before_train=1.589842 (no previous merge yet)
[S10] round=8 local utility u=0.299969 metrics={'f1_val': 0.6180111247015883, 'auprc': 0.9582267895537073, 'loss_val': 0.3128661980760938, 'psi': 0.7540973906424359}-{'f1_val': 0.5674158726369936, 'auprc': 0.8974390746320732, 'loss_val': 0.4268703414660065, 'psi': 0.6994251534350253}
[S11] START round=8 head_norm_before_train=1.507283 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.449900 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9600840364294045, 'loss_val': 0.8327369471064723, 'psi': 0.6219649561274856}-{'f1_val': 0.41476539642733834, 'auprc': 0.6791780838004431, 'loss_val': 0.9990975674147062, 'psi': 0.5205304713765803}
[S13] START round=8 head_norm_before_train=1.456224 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.7008707332708131, 'auprc': 0.7443088548714668, 'loss_val': 0.5002955082131307, 'psi': 0.7182459819110746}-{'f1_val': 0.712004967500554, 'auprc': 0.75254853237422, 'loss_val': 0.5053532249869748, 'psi': 0.7282223934500205}
[S14] START round=8 head_norm_before_train=1.418273 (no previous merge yet)
[S14] round=8 local utility u=0.430918 metrics={'f1_val': 0.5083961720669035, 'auprc': 0.9957002657324927, 'loss_val': 0.5820617590973935, 'psi': 0.7033178095331392}-{'f1_val': 0.39649470961585787, 'auprc': 0.9968380655219359, 'loss_val': 0.7759032174676109, 'psi': 0.6366320519782891}
[S15] START round=8 head_norm_before_train=0.960834 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.011554 metrics={'f1_val': 0.6964633626424093, 'auprc': 0.7780740521685873, 'loss_val': 0.49451066521381903, 'psi': 0.7291076384528805}-{'f1_val': 0.6973852571003788, 'auprc': 0.7928020271776055, 'loss_val': 0.5673344922929321, 'psi': 0.7355519651312694}
[S16] START round=8 head_norm_before_train=0.751866 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3854358134297104, 'auprc': 0.5796863362617823, 'loss_val': 0.9198208896027601, 'psi': 0.46313602256253916}-{'f1_val': 0.41696372269722326, 'auprc': 0.6418812632924034, 'loss_val': 0.9547178725520507, 'psi': 0.5069307389352953}
[S17] START round=8 head_norm_before_train=1.194529 cos_to_last_merge=0.8576 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.858
[S17] round=8 local utility u=0.044568 metrics={'f1_val': 0.3583124787004109, 'auprc': 0.7542823286799338, 'loss_val': 0.9237538774478784, 'psi': 0.51670041869222}-{'f1_val': 0.3753539271941718, 'auprc': 0.698460758263618, 'loss_val': 0.9476731327532933, 'psi': 0.5045966596219503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:49310
[S10] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9833
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.8557
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.7645
[S9] RECEIVED delta(kind=head bytes=1792) from S8
[S9] cosine check vs S8: cos=0.6364
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] cosine check vs S10: cos=0.6220
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=-0.1022
[S16] DROPPED delta from S9 (cos=-0.1022 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.8312
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.7790
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=-0.1291
[S15] DROPPED delta from S11 (cos=-0.1291 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.8695
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.4965
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4178 head_norm=0.876723
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.703665e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4175 head_norm=0.925612 delta_norm=0.270367
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7139 head_norm=1.020258
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.800973e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7139 head_norm=1.176627 delta_norm=0.480097
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.7013 head_norm=0.983447
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.083476e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.7013 head_norm=0.824738 delta_norm=0.308348
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6965 head_norm=1.044542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.606724e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6964 head_norm=0.980392 delta_norm=0.260672
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.528568
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.760697e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3965 head_norm=1.617119 delta_norm=0.176070
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4361 head_norm=0.807080
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.430915e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.3854 head_norm=0.889274 delta_norm=0.343091
[S9] aggregate: ROLLBACK (f1_val pre=0.436 post=0.385 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3919 head_norm=0.763789
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.361792e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3922 head_norm=0.773025 delta_norm=0.236179
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.824738 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.012537 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6568608331909321, 'loss_val': 0.4161995574316272, 'psi': 0.683530412100094}-{'f1_val': 0.7013101313728686, 'auprc': 0.6572615252279681, 'loss_val': 0.4424751060528609, 'psi': 0.6836906889149084}
[S3] START round=9 head_norm_before_train=0.773025 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.246583 metrics={'f1_val': 0.3933090800213241, 'auprc': 0.9518055189358718, 'loss_val': 0.9009153601032103, 'psi': 0.6167076555871432}-{'f1_val': 0.3918947616800378, 'auprc': 0.8084174615759855, 'loss_val': 0.955431903288737, 'psi': 0.5585038416384169}
[S4] START round=9 head_norm_before_train=1.719194 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6233937981565273, 'auprc': 0.9499949050994574, 'loss_val': 0.4824568939700108, 'psi': 0.7540342409336993}-{'f1_val': 0.953002109037413, 'auprc': 0.9412697375534829, 'loss_val': 0.4802401406822468, 'psi': 0.948309160443841}
[S5] START round=9 head_norm_before_train=0.925612 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.239726 metrics={'f1_val': 0.41786861343900883, 'auprc': 0.7756190102352443, 'loss_val': 1.0990607332735731, 'psi': 0.560968772157503}-{'f1_val': 0.41782938933607694, 'auprc': 0.6383178642680746, 'loss_val': 1.1663740837027565, 'psi': 0.506024779308876}
[S6] START round=9 head_norm_before_train=1.120443 cos_to_last_merge=0.8851 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=9 local utility u=0.014267 metrics={'f1_val': 0.6944904862411827, 'auprc': 0.9561653729516177, 'loss_val': 0.3800984028579558, 'psi': 0.7991604409253568}-{'f1_val': 0.6941168866791392, 'auprc': 0.9619571134229227, 'loss_val': 0.4237661778615735, 'psi': 0.8012529773766526}
[S7] START round=9 head_norm_before_train=0.976961 cos_to_last_merge=0.9699 (last merge round=2)
[S7] round=9 local utility u=0.176479 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.5958119515940813, 'loss_val': 1.001707638455943, 'psi': 0.48861957279669654}-{'f1_val': 0.3764219109142447, 'auprc': 0.6030872419389671, 'loss_val': 1.1320758473546404, 'psi': 0.4670880433241337}
[S8] START round=9 head_norm_before_train=1.176627 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.874493 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9973152392779225, 'loss_val': 0.3132052947044722, 'psi': 0.9967379406725438}-{'f1_val': 0.7138869500399027, 'auprc': 0.9973911085874387, 'loss_val': 0.3676226578754002, 'psi': 0.827288613458917}
[S9] START round=9 head_norm_before_train=0.889274 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.048867 metrics={'f1_val': 0.4373782222985246, 'auprc': 0.9981815645214419, 'loss_val': 0.7641660536600046, 'psi': 0.6616995591876915}-{'f1_val': 0.4361029275181792, 'auprc': 0.9815751949881808, 'loss_val': 0.8044293026606876, 'psi': 0.6542918345061799}
[S10] START round=9 head_norm_before_train=1.637748 (no previous merge yet)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.9811160555773537, 'auprc': 0.9966126686994148, 'loss_val': 0.16918602069057173, 'psi': 0.9873147008261781}-{'f1_val': 0.6180111247015883, 'auprc': 0.9582267895537073, 'loss_val': 0.3128661980760938, 'psi': 0.7540973906424359}
[S11] START round=9 head_norm_before_train=1.617119 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.645179 metrics={'f1_val': 0.5622705359993496, 'auprc': 0.9987364014809509, 'loss_val': 0.6526455466776153, 'psi': 0.7368568821919901}-{'f1_val': 0.39655223592620625, 'auprc': 0.9600840364294045, 'loss_val': 0.8327369471064723, 'psi': 0.6219649561274856}
[S13] START round=9 head_norm_before_train=1.504850 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6319791424597306, 'auprc': 0.7471381220019797, 'loss_val': 0.5189171711817568, 'psi': 0.6780427342766302}-{'f1_val': 0.7008707332708131, 'auprc': 0.7443088548714668, 'loss_val': 0.5002955082131307, 'psi': 0.7182459819110746}
[S14] START round=9 head_norm_before_train=1.479514 (no previous merge yet)
[S14] round=9 local utility u=0.653816 metrics={'f1_val': 0.7020599643945351, 'auprc': 0.997162083527125, 'loss_val': 0.44079868573187586, 'psi': 0.820100812047571}-{'f1_val': 0.5083961720669035, 'auprc': 0.9957002657324927, 'loss_val': 0.5820617590973935, 'psi': 0.7033178095331392}
[S15] START round=9 head_norm_before_train=0.980392 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.231535 metrics={'f1_val': 0.7114731113028185, 'auprc': 0.8791328843796041, 'loss_val': 0.42467554370580973, 'psi': 0.7785370205335328}-{'f1_val': 0.6964633626424093, 'auprc': 0.7780740521685873, 'loss_val': 0.49451066521381903, 'psi': 0.7291076384528805}
[S16] START round=9 head_norm_before_train=0.789900 cos_to_last_merge=0.9946 (last merge round=7)
[S16] round=9 local utility u=0.173477 metrics={'f1_val': 0.3842833007360029, 'auprc': 0.677052138970913, 'loss_val': 0.8580491729669224, 'psi': 0.5013908360299669}-{'f1_val': 0.3854358134297104, 'auprc': 0.5796863362617823, 'loss_val': 0.9198208896027601, 'psi': 0.46313602256253916}
[S17] START round=9 head_norm_before_train=1.221838 cos_to_last_merge=0.8484 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=9 local utility u=0.266700 metrics={'f1_val': 0.40921856574857085, 'auprc': 0.8103620345052635, 'loss_val': 0.8640296369065283, 'psi': 0.5696759532512479}-{'f1_val': 0.3583124787004109, 'auprc': 0.7542823286799338, 'loss_val': 0.9237538774478784, 'psi': 0.51670041869222}
[S9] not sending this round → trigger blocked (psi=0.662)
[S15] not sending this round → trigger blocked (psi=0.779)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S7] not sending this round → trigger blocked (psi=0.489)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:49316
[S14] not sending this round → trigger blocked (psi=0.820)
[S3] not sending this round → trigger blocked (psi=0.617)
[S11] not sending this round → trigger blocked (psi=0.737)
[S2] not sending this round → trigger blocked (psi=0.684)
[S10] not sending this round → trigger blocked (psi=0.987)
[S5] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.3536
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.6769
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.0082
[S17] not sending this round → trigger blocked (psi=0.570)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9964 head_norm=1.247212
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.865755e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9958 head_norm=0.992580 delta_norm=0.686576
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.7021 head_norm=1.532320
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.698253e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.7013 head_norm=0.875825 delta_norm=0.869825
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3843 head_norm=0.836257
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.598211e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3857 head_norm=0.812945 delta_norm=0.359821
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.920922 cos_to_last_merge=0.9871 (last merge round=8)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.5582390157466296, 'auprc': 0.6105580544596168, 'loss_val': 0.7403421345746425, 'psi': 0.5791666312318244}-{'f1_val': 0.7013101313728686, 'auprc': 0.6568608331909321, 'loss_val': 0.4161995574316272, 'psi': 0.683530412100094}
[S3] START round=10 head_norm_before_train=0.802303 cos_to_last_merge=0.9906 (last merge round=8)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.4008827131202587, 'auprc': 0.7139408442648498, 'loss_val': 0.9351110968445809, 'psi': 0.5261059655780951}-{'f1_val': 0.3933090800213241, 'auprc': 0.9518055189358718, 'loss_val': 0.9009153601032103, 'psi': 0.6167076555871432}
[S4] START round=10 head_norm_before_train=1.752620 (no previous merge yet)
[S4] round=10 local utility u=1.000000 metrics={'f1_val': 0.9478308564667848, 'auprc': 0.9526520945456695, 'loss_val': 0.40777959002166286, 'psi': 0.9497593516983387}-{'f1_val': 0.6233937981565273, 'auprc': 0.9499949050994574, 'loss_val': 0.4824568939700108, 'psi': 0.7540342409336993}
[S5] START round=10 head_norm_before_train=0.938817 cos_to_last_merge=0.9976 (last merge round=8)
[S5] round=10 local utility u=0.046930 metrics={'f1_val': 0.41940027707573757, 'auprc': 0.775587056048145, 'loss_val': 1.0142955240010383, 'psi': 0.5618749886647005}-{'f1_val': 0.41786861343900883, 'auprc': 0.7756190102352443, 'loss_val': 1.0990607332735731, 'psi': 0.560968772157503}
[S6] START round=10 head_norm_before_train=1.165188 cos_to_last_merge=0.8753 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=10 local utility u=0.029786 metrics={'f1_val': 0.694819619886693, 'auprc': 0.9652726900484628, 'loss_val': 0.34982256806600787, 'psi': 0.803000847951401}-{'f1_val': 0.6944904862411827, 'auprc': 0.9561653729516177, 'loss_val': 0.3800984028579558, 'psi': 0.7991604409253568}
[S7] START round=10 head_norm_before_train=1.004958 cos_to_last_merge=0.9601 (last merge round=2)
[S7] round=10 local utility u=0.098886 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.6253526551955194, 'loss_val': 0.8918230992803, 'psi': 0.5003623183709767}-{'f1_val': 0.4171579869317734, 'auprc': 0.5958119515940813, 'loss_val': 1.001707638455943, 'psi': 0.48861957279669654}
[S8] START round=10 head_norm_before_train=0.992580 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9989466649872526, 'loss_val': 0.3720683853541585, 'psi': 0.9967160529275927}-{'f1_val': 0.9963530749356245, 'auprc': 0.9973152392779225, 'loss_val': 0.3132052947044722, 'psi': 0.9967379406725438}
[S9] START round=10 head_norm_before_train=0.931740 cos_to_last_merge=0.9945 (last merge round=8)
[S9] round=10 local utility u=0.175621 metrics={'f1_val': 0.4714255682473857, 'auprc': 0.9985294996753934, 'loss_val': 0.6182515363408526, 'psi': 0.6822671408185887}-{'f1_val': 0.4373782222985246, 'auprc': 0.9981815645214419, 'loss_val': 0.7641660536600046, 'psi': 0.6616995591876915}
[S10] START round=10 head_norm_before_train=1.672951 (no previous merge yet)
[S10] round=10 local utility u=0.066086 metrics={'f1_val': 0.9950444545353663, 'auprc': 0.9966607901286728, 'loss_val': 0.12072952890074137, 'psi': 0.9956909887726889}-{'f1_val': 0.9811160555773537, 'auprc': 0.9966126686994148, 'loss_val': 0.16918602069057173, 'psi': 0.9873147008261781}
[S11] START round=10 head_norm_before_train=1.643273 cos_to_last_merge=0.9988 (last merge round=8)
[S11] round=10 local utility u=0.499959 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9999510485286582, 'loss_val': 0.49409301588346843, 'psi': 0.8211148039838285}-{'f1_val': 0.5622705359993496, 'auprc': 0.9987364014809509, 'loss_val': 0.6526455466776153, 'psi': 0.7368568821919901}
[S13] START round=10 head_norm_before_train=1.537957 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6063556142885687, 'auprc': 0.7146460435444145, 'loss_val': 0.5938297624776862, 'psi': 0.6496717859909069}-{'f1_val': 0.6319791424597306, 'auprc': 0.7471381220019797, 'loss_val': 0.5189171711817568, 'psi': 0.6780427342766302}
[S14] START round=10 head_norm_before_train=0.875825 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.7018171778232243, 'auprc': 0.9957282312407487, 'loss_val': 0.5395260096084064, 'psi': 0.819381599190234}-{'f1_val': 0.7020599643945351, 'auprc': 0.997162083527125, 'loss_val': 0.44079868573187586, 'psi': 0.820100812047571}
[S15] START round=10 head_norm_before_train=1.054144 cos_to_last_merge=0.9934 (last merge round=8)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6951756614025045, 'auprc': 0.804432204390656, 'loss_val': 0.405221048316387, 'psi': 0.7388782785977651}-{'f1_val': 0.7114731113028185, 'auprc': 0.8791328843796041, 'loss_val': 0.42467554370580973, 'psi': 0.7785370205335328}
[S16] START round=10 head_norm_before_train=0.812945 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.216000 metrics={'f1_val': 0.384782381133624, 'auprc': 0.8198436756674431, 'loss_val': 0.857419017585677, 'psi': 0.5588068989471517}-{'f1_val': 0.3842833007360029, 'auprc': 0.677052138970913, 'loss_val': 0.8580491729669224, 'psi': 0.5013908360299669}
[S17] START round=10 head_norm_before_train=1.254862 cos_to_last_merge=0.8410 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.39305620666458185, 'auprc': 0.8038004026161436, 'loss_val': 0.9169339576497908, 'psi': 0.5573538850452066}-{'f1_val': 0.40921856574857085, 'auprc': 0.8103620345052635, 'loss_val': 0.8640296369065283, 'psi': 0.5696759532512479}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.559)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S5] not sending this round → trigger blocked (psi=0.562)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.803)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=-0.0512
[S16] DROPPED delta from S9 (cos=-0.0512 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=-0.1202
[S15] DROPPED delta from S11 (cos=-0.1202 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.7401
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] cosine check vs S10: cos=0.7584
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9831
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.274 → S16@127.0.0.1:49316
[S14] ⇄ pheromone p=0.402 → S8@127.0.0.1:49309
[S6] ⇄ pheromone p=0.307 → S8@127.0.0.1:49309
[S13] ⇄ pheromone p=0.238 → S10@127.0.0.1:49311
[S8] ⇄ pheromone p=0.446 → S9@127.0.0.1:49310
[S2] ⇄ pheromone p=0.219 → S15@127.0.0.1:49315
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4009 head_norm=0.847063
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.512320e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4009 head_norm=0.879763 delta_norm=0.351232
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.246 → S2@127.0.0.1:49302
[S15] ⇄ pheromone p=0.315 → S5@127.0.0.1:49305
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.4714 head_norm=0.987369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.761311e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.6068 head_norm=1.268212 delta_norm=0.576131
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.311 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=0.266 → S3@127.0.0.1:49303
[S4] ⇄ pheromone p=0.549 → S11@127.0.0.1:49312
[S10] ⇄ pheromone p=0.474 → S9@127.0.0.1:49310
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7019 head_norm=1.677914
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.670529e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7019 head_norm=1.722044 delta_norm=0.167053
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.481 → S15@127.0.0.1:49315
[S16] ⇄ pheromone p=0.278 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.293 → S3@127.0.0.1:49303
[S2] START round=11 head_norm_before_train=1.012519 cos_to_last_merge=0.9692 (last merge round=8)
[S2] round=11 local utility u=0.709290 metrics={'f1_val': 0.701049040284694, 'auprc': 0.6639652376893659, 'loss_val': 0.3388445814460264, 'psi': 0.6862155192465627}-{'f1_val': 0.5582390157466296, 'auprc': 0.6105580544596168, 'loss_val': 0.7403421345746425, 'psi': 0.5791666312318244}
[S3] START round=11 head_norm_before_train=0.879763 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.560310 metrics={'f1_val': 0.4110629390495619, 'auprc': 0.9994191313360283, 'loss_val': 0.7320075094116244, 'psi': 0.6464054159641486}-{'f1_val': 0.4008827131202587, 'auprc': 0.7139408442648498, 'loss_val': 0.9351110968445809, 'psi': 0.5261059655780951}
[S4] START round=11 head_norm_before_train=1.780811 (no previous merge yet)
[S4] round=11 local utility u=0.015172 metrics={'f1_val': 0.9450213965444236, 'auprc': 0.955191743333841, 'loss_val': 0.3681982984416304, 'psi': 0.9490895352601906}-{'f1_val': 0.9478308564667848, 'auprc': 0.9526520945456695, 'loss_val': 0.40777959002166286, 'psi': 0.9497593516983387}
[S5] START round=11 head_norm_before_train=0.961303 cos_to_last_merge=0.9907 (last merge round=8)
[S5] round=11 local utility u=0.911464 metrics={'f1_val': 0.7043608984374712, 'auprc': 0.7754764090769688, 'loss_val': 0.9007991513851843, 'psi': 0.7328071026932703}-{'f1_val': 0.41940027707573757, 'auprc': 0.775587056048145, 'loss_val': 1.0142955240010383, 'psi': 0.5618749886647005}
[S6] START round=11 head_norm_before_train=1.198483 cos_to_last_merge=0.8689 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6940307065155036, 'auprc': 0.9559910639395635, 'loss_val': 0.3312516627326147, 'psi': 0.7988148494851275}-{'f1_val': 0.694819619886693, 'auprc': 0.9652726900484628, 'loss_val': 0.34982256806600787, 'psi': 0.803000847951401}
[S7] START round=11 head_norm_before_train=1.037871 cos_to_last_merge=0.9466 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=11 local utility u=0.239732 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7643525760020609, 'loss_val': 0.8286242812516014, 'psi': 0.555888888662299}-{'f1_val': 0.41703542715461484, 'auprc': 0.6253526551955194, 'loss_val': 0.8918230992803, 'psi': 0.5003623183709767}
[S8] START round=11 head_norm_before_train=1.070284 cos_to_last_merge=0.9906 (last merge round=9)
[S8] round=11 local utility u=0.054476 metrics={'f1_val': 0.9943863875486112, 'auprc': 0.9979661825178341, 'loss_val': 0.2551203561597884, 'psi': 0.9958183055363004}-{'f1_val': 0.9952289782211529, 'auprc': 0.9989466649872526, 'loss_val': 0.3720683853541585, 'psi': 0.9967160529275927}
[S9] START round=11 head_norm_before_train=1.268212 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.760996 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9992606824219277, 'loss_val': 0.477642787828204, 'psi': 0.8204785630933091}-{'f1_val': 0.4714255682473857, 'auprc': 0.9985294996753934, 'loss_val': 0.6182515363408526, 'psi': 0.6822671408185887}
[S10] START round=11 head_norm_before_train=1.704605 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9951131111941085, 'loss_val': 0.12226717837401928, 'psi': 0.9954925809246897}-{'f1_val': 0.9950444545353663, 'auprc': 0.9966607901286728, 'loss_val': 0.12072952890074137, 'psi': 0.9956909887726889}
[S11] START round=11 head_norm_before_train=1.722044 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.806792 metrics={'f1_val': 0.9580281394601605, 'auprc': 0.9963196859954097, 'loss_val': 0.4064389905892516, 'psi': 0.9733447580742602}-{'f1_val': 0.701890640953942, 'auprc': 0.9999510485286582, 'loss_val': 0.49409301588346843, 'psi': 0.8211148039838285}
[S13] START round=11 head_norm_before_train=1.570038 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.625429617047236, 'auprc': 0.6271634309730858, 'loss_val': 0.580655352329947, 'psi': 0.626123142617576}-{'f1_val': 0.6063556142885687, 'auprc': 0.7146460435444145, 'loss_val': 0.5938297624776862, 'psi': 0.6496717859909069}
[S14] START round=11 head_norm_before_train=0.931137 cos_to_last_merge=0.9980 (last merge round=9)
[S14] round=11 local utility u=0.575528 metrics={'f1_val': 0.8637349820750027, 'auprc': 0.997159756945323, 'loss_val': 0.36427181625487326, 'psi': 0.9171048920231308}-{'f1_val': 0.7018171778232243, 'auprc': 0.9957282312407487, 'loss_val': 0.5395260096084064, 'psi': 0.819381599190234}
[S15] START round=11 head_norm_before_train=1.116607 cos_to_last_merge=0.9838 (last merge round=8)
[S15] round=11 local utility u=0.188454 metrics={'f1_val': 0.7187719338516914, 'auprc': 0.8710068258990386, 'loss_val': 0.3696142893708417, 'psi': 0.7796658906706302}-{'f1_val': 0.6951756614025045, 'auprc': 0.804432204390656, 'loss_val': 0.405221048316387, 'psi': 0.7388782785977651}
[S16] START round=11 head_norm_before_train=0.852134 cos_to_last_merge=0.9948 (last merge round=9)
[S16] round=11 local utility u=0.103760 metrics={'f1_val': 0.38505294853927674, 'auprc': 0.8695999429985068, 'loss_val': 0.8007909960600865, 'psi': 0.5788717463229688}-{'f1_val': 0.384782381133624, 'auprc': 0.8198436756674431, 'loss_val': 0.857419017585677, 'psi': 0.5588068989471517}
[S17] START round=11 head_norm_before_train=1.294679 cos_to_last_merge=0.8356 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35702829129024094, 'auprc': 0.7162025306198825, 'loss_val': 1.0871468000473916, 'psi': 0.5006979870220976}-{'f1_val': 0.39305620666458185, 'auprc': 0.8038004026161436, 'loss_val': 0.9169339576497908, 'psi': 0.5573538850452066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:49302
[S4] not sending this round → trigger blocked (psi=0.949)
[S11] not sending this round → trigger blocked (psi=0.973)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S9] not sending this round → trigger blocked (psi=0.820)
[S7] not sending this round → trigger blocked (psi=0.556)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:49305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:49314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:49309
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.3023
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.7890
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.6176
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.8507
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.4182
[S5] RECEIVED delta(kind=head bytes=1791) from S15
[S5] cosine check vs S15: cos=0.9057
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.8785
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=1.306754
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.283065e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.992318 delta_norm=0.728306
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7188 head_norm=1.180835
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.127700e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7516 head_norm=1.088342 delta_norm=0.312770
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3851 head_norm=0.898672
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.368455e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3858 head_norm=0.915008 delta_norm=0.236845
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.8637 head_norm=0.995418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.124093e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.7022 head_norm=0.797916 delta_norm=0.512409
[S14] aggregate: ROLLBACK (f1_val pre=0.864 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7010 head_norm=1.081783
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.336857e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7010 head_norm=0.944381 delta_norm=0.333686
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7044 head_norm=0.989474
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.534564e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7011 head_norm=1.059469 delta_norm=0.253456
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9944 head_norm=1.150063
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.741773e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9363 head_norm=0.965353 delta_norm=0.474177
[S8] aggregate: ROLLBACK (f1_val pre=0.994 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=0.944381 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.701049040284694, 'auprc': 0.6621967921098839, 'loss_val': 0.3579126754011237, 'psi': 0.6855081410147699}-{'f1_val': 0.701049040284694, 'auprc': 0.6639652376893659, 'loss_val': 0.3388445814460264, 'psi': 0.6862155192465627}
[S3] START round=12 head_norm_before_train=0.914410 cos_to_last_merge=0.9944 (last merge round=10)
[S3] round=12 local utility u=0.507362 metrics={'f1_val': 0.6387790425725602, 'auprc': 0.8967651694790896, 'loss_val': 0.7756184145987914, 'psi': 0.741973493335172}-{'f1_val': 0.4110629390495619, 'auprc': 0.9994191313360283, 'loss_val': 0.7320075094116244, 'psi': 0.6464054159641486}
[S4] START round=12 head_norm_before_train=1.804688 (no previous merge yet)
[S4] round=12 local utility u=0.073469 metrics={'f1_val': 0.9550870127931548, 'auprc': 0.9577808140611015, 'loss_val': 0.2894204695294466, 'psi': 0.9561645333003335}-{'f1_val': 0.9450213965444236, 'auprc': 0.955191743333841, 'loss_val': 0.3681982984416304, 'psi': 0.9490895352601906}
[S5] START round=12 head_norm_before_train=1.059469 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.077773 metrics={'f1_val': 0.7143643250834455, 'auprc': 0.7755490192540536, 'loss_val': 0.8054912769757274, 'psi': 0.7388382027516888}-{'f1_val': 0.7043608984374712, 'auprc': 0.7754764090769688, 'loss_val': 0.9007991513851843, 'psi': 0.7328071026932703}
[S6] START round=12 head_norm_before_train=1.231161 cos_to_last_merge=0.8620 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=12 local utility u=0.596283 metrics={'f1_val': 0.8901773811766139, 'auprc': 0.9545562469074838, 'loss_val': 0.31126041760961964, 'psi': 0.9159289274689619}-{'f1_val': 0.6940307065155036, 'auprc': 0.9559910639395635, 'loss_val': 0.3312516627326147, 'psi': 0.7988148494851275}
[S7] START round=12 head_norm_before_train=1.074236 cos_to_last_merge=0.9317 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=12 local utility u=0.050273 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7828693676154695, 'loss_val': 0.7831453820471399, 'psi': 0.563247226705252}-{'f1_val': 0.4169130971024577, 'auprc': 0.7643525760020609, 'loss_val': 0.8286242812516014, 'psi': 0.555888888662299}
[S8] START round=12 head_norm_before_train=0.965353 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9958289931947908, 'auprc': 0.9957455531656167, 'loss_val': 0.26458636863321594, 'psi': 0.9957956171831212}-{'f1_val': 0.9943863875486112, 'auprc': 0.9979661825178341, 'loss_val': 0.2551203561597884, 'psi': 0.9958183055363004}
[S9] START round=12 head_norm_before_train=0.992318 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.017459 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9994046782224901, 'loss_val': 0.4427140786301952, 'psi': 0.8204918197530072}-{'f1_val': 0.7012904835408967, 'auprc': 0.9992606824219277, 'loss_val': 0.477642787828204, 'psi': 0.8204785630933091}
[S10] START round=12 head_norm_before_train=1.743432 (no previous merge yet)
[S10] round=12 local utility u=0.027810 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9958038967192874, 'loss_val': 0.0647677006302616, 'psi': 0.9953736558021729}-{'f1_val': 0.9957455607450773, 'auprc': 0.9951131111941085, 'loss_val': 0.12226717837401928, 'psi': 0.9954925809246897}
[S11] START round=12 head_norm_before_train=1.754106 cos_to_last_merge=0.9994 (last merge round=10)
[S11] round=12 local utility u=0.085708 metrics={'f1_val': 0.96041902381485, 'auprc': 0.9990812357294816, 'loss_val': 0.2576526291267046, 'psi': 0.9758839085807027}-{'f1_val': 0.9580281394601605, 'auprc': 0.9963196859954097, 'loss_val': 0.4064389905892516, 'psi': 0.9733447580742602}
[S13] START round=12 head_norm_before_train=1.596892 (no previous merge yet)
[S13] round=12 local utility u=0.188081 metrics={'f1_val': 0.64940865664439, 'auprc': 0.6656294153570883, 'loss_val': 0.46376525228139115, 'psi': 0.6558969601294693}-{'f1_val': 0.625429617047236, 'auprc': 0.6271634309730858, 'loss_val': 0.580655352329947, 'psi': 0.626123142617576}
[S14] START round=12 head_norm_before_train=0.797916 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.7019943617210709, 'auprc': 0.9971311978890984, 'loss_val': 0.4931437828129792, 'psi': 0.8200490961882818}-{'f1_val': 0.8637349820750027, 'auprc': 0.997159756945323, 'loss_val': 0.36427181625487326, 'psi': 0.9171048920231308}
[S15] START round=12 head_norm_before_train=1.088342 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6982553994441213, 'auprc': 0.7976658106686481, 'loss_val': 0.4601378613029329, 'psi': 0.738019563933932}-{'f1_val': 0.7187719338516914, 'auprc': 0.8710068258990386, 'loss_val': 0.3696142893708417, 'psi': 0.7796658906706302}
[S16] START round=12 head_norm_before_train=0.915008 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.012172 metrics={'f1_val': 0.38608926543580546, 'auprc': 0.8706722751720338, 'loss_val': 0.7858828378240694, 'psi': 0.5799224693302968}-{'f1_val': 0.38505294853927674, 'auprc': 0.8695999429985068, 'loss_val': 0.8007909960600865, 'psi': 0.5788717463229688}
[S17] START round=12 head_norm_before_train=1.335488 cos_to_last_merge=0.8300 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=12 local utility u=0.205364 metrics={'f1_val': 0.38880981501967105, 'auprc': 0.7764977113969671, 'loss_val': 1.047993939605315, 'psi': 0.5438849735705895}-{'f1_val': 0.35702829129024094, 'auprc': 0.7162025306198825, 'loss_val': 1.0871468000473916, 'psi': 0.5006979870220976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=-0.0427
[S10] DROPPED delta from S13 (cos=-0.0427 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=-0.1050
[S15] DROPPED delta from S11 (cos=-0.1050 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.7465
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9121
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=-0.0461
[S16] DROPPED delta from S9 (cos=-0.0461 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.5096
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9862
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.6752
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.9173
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.8833
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.3792
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7010 head_norm=1.003472
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.004448e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7010 head_norm=0.958094 delta_norm=0.200445
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9958 head_norm=1.052527
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.809463e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9962 head_norm=1.007798 delta_norm=0.580946
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7020 head_norm=0.853821
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.246680e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7022 head_norm=0.843819 delta_norm=0.324668
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3861 head_norm=0.951771
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.230975e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4564 head_norm=0.995731 delta_norm=0.223097
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=1.041838
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.615983e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=1.300150 delta_norm=0.661598
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.9604 head_norm=1.788504
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.525155e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.9978 head_norm=1.806375 delta_norm=0.152516
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6388 head_norm=0.953566
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.096096e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6429 head_norm=0.899899 delta_norm=0.309610
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.958094 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000907 metrics={'f1_val': 0.701049040284694, 'auprc': 0.6645200147509835, 'loss_val': 0.36306901220066307, 'psi': 0.6864374300712097}-{'f1_val': 0.701049040284694, 'auprc': 0.6621967921098839, 'loss_val': 0.3579126754011237, 'psi': 0.6855081410147699}
[S3] START round=13 head_norm_before_train=0.899899 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.407059 metrics={'f1_val': 0.7005014381049806, 'auprc': 0.9996246255255237, 'loss_val': 0.6404135654434162, 'psi': 0.8201507130731978}-{'f1_val': 0.6387790425725602, 'auprc': 0.8967651694790896, 'loss_val': 0.7756184145987914, 'psi': 0.741973493335172}
[S4] START round=13 head_norm_before_train=1.836779 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9501901828267995, 'auprc': 0.9570324932437161, 'loss_val': 0.29200535627932395, 'psi': 0.9529271069935661}-{'f1_val': 0.9550870127931548, 'auprc': 0.9577808140611015, 'loss_val': 0.2894204695294466, 'psi': 0.9561645333003335}
[S5] START round=13 head_norm_before_train=1.084729 cos_to_last_merge=0.9981 (last merge round=11)
[S5] round=13 local utility u=0.030097 metrics={'f1_val': 0.7014316176293985, 'auprc': 0.7793031342114003, 'loss_val': 0.6789627955616975, 'psi': 0.7325802242621993}-{'f1_val': 0.7143643250834455, 'auprc': 0.7755490192540536, 'loss_val': 0.8054912769757274, 'psi': 0.7388382027516888}
[S6] START round=13 head_norm_before_train=1.264318 cos_to_last_merge=0.8559 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6250890818564443, 'auprc': 0.850100330322215, 'loss_val': 0.4668630999012554, 'psi': 0.7150935812427526}-{'f1_val': 0.8901773811766139, 'auprc': 0.9545562469074838, 'loss_val': 0.31126041760961964, 'psi': 0.9159289274689619}
[S7] START round=13 head_norm_before_train=1.110626 cos_to_last_merge=0.9188 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=13 local utility u=0.863758 metrics={'f1_val': 0.6949078496686624, 'auprc': 0.7818003786345717, 'loss_val': 0.7208744755758013, 'psi': 0.729664861255026}-{'f1_val': 0.41683246609844005, 'auprc': 0.7828693676154695, 'loss_val': 0.7831453820471399, 'psi': 0.563247226705252}
[S8] START round=13 head_norm_before_train=1.007798 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9941443971419754, 'auprc': 0.99888721844409, 'loss_val': 0.30246173816387406, 'psi': 0.9960415256628212}-{'f1_val': 0.9958289931947908, 'auprc': 0.9957455531656167, 'loss_val': 0.26458636863321594, 'psi': 0.9957956171831212}
[S9] START round=13 head_norm_before_train=1.300150 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.053492 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9971727835404488, 'loss_val': 0.32903404203440695, 'psi': 0.8195990618801907}-{'f1_val': 0.7012165807733519, 'auprc': 0.9994046782224901, 'loss_val': 0.4427140786301952, 'psi': 0.8204918197530072}
[S10] START round=13 head_norm_before_train=1.780668 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9949004517022284, 'loss_val': 0.06421657484912653, 'psi': 0.9951540530191296}-{'f1_val': 0.9950868285240967, 'auprc': 0.9958038967192874, 'loss_val': 0.0647677006302616, 'psi': 0.9953736558021729}
[S11] START round=13 head_norm_before_train=1.806375 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.142151 metrics={'f1_val': 0.9977924134809988, 'auprc': 0.9995055210141921, 'loss_val': 0.19886302082887555, 'psi': 0.9984776564942761}-{'f1_val': 0.96041902381485, 'auprc': 0.9990812357294816, 'loss_val': 0.2576526291267046, 'psi': 0.9758839085807027}
[S13] START round=13 head_norm_before_train=1.618783 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6221918170329181, 'auprc': 0.6755368989739887, 'loss_val': 0.6299877372324296, 'psi': 0.6435298498093465}-{'f1_val': 0.64940865664439, 'auprc': 0.6656294153570883, 'loss_val': 0.46376525228139115, 'psi': 0.6558969601294693}
[S14] START round=13 head_norm_before_train=0.843819 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.7017495974233731, 'auprc': 0.997026332498459, 'loss_val': 0.5452153901445363, 'psi': 0.8198602914534074}-{'f1_val': 0.7019943617210709, 'auprc': 0.9971311978890984, 'loss_val': 0.4931437828129792, 'psi': 0.8200490961882818}
[S15] START round=13 head_norm_before_train=1.143091 cos_to_last_merge=0.9981 (last merge round=11)
[S15] round=13 local utility u=0.652228 metrics={'f1_val': 0.8115813510930965, 'auprc': 0.9509820938476863, 'loss_val': 0.29558681109705803, 'psi': 0.8673416481949324}-{'f1_val': 0.6982553994441213, 'auprc': 0.7976658106686481, 'loss_val': 0.4601378613029329, 'psi': 0.738019563933932}
[S16] START round=13 head_norm_before_train=0.995731 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.288455 metrics={'f1_val': 0.47754156916793866, 'auprc': 0.8715693793177457, 'loss_val': 0.7603787362849013, 'psi': 0.6351526932278615}-{'f1_val': 0.38608926543580546, 'auprc': 0.8706722751720338, 'loss_val': 0.7858828378240694, 'psi': 0.5799224693302968}
[S17] START round=13 head_norm_before_train=1.361918 cos_to_last_merge=0.8259 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.30505047741281666, 'auprc': 0.6940659161917365, 'loss_val': 1.4969075635766491, 'psi': 0.4606566529243846}-{'f1_val': 0.38880981501967105, 'auprc': 0.7764977113969671, 'loss_val': 1.047993939605315, 'psi': 0.5438849735705895}
[S7] not sending this round → trigger blocked (psi=0.730)
[S3] not sending this round → trigger blocked (psi=0.820)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[S9] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49316
[S16] not sending this round → trigger blocked (psi=0.635)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.9665
[S15] RECEIVED delta(kind=head bytes=1793) from S2
[S15] cosine check vs S2: cos=0.8410
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9241
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.8116 head_norm=1.192891
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.228532e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.8131 head_norm=1.064401 delta_norm=0.322853
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7014 head_norm=1.111852
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.279396e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7008 head_norm=1.130330 delta_norm=0.227940
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4775 head_norm=1.033131
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.441538e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5973 head_norm=1.063488 delta_norm=0.144154
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.025369 cos_to_last_merge=0.9957 (last merge round=12)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6094790290980855, 'auprc': 0.6861625487744624, 'loss_val': 0.574396972987252, 'psi': 0.6401524369686362}-{'f1_val': 0.701049040284694, 'auprc': 0.6645200147509835, 'loss_val': 0.36306901220066307, 'psi': 0.6864374300712097}
[S3] START round=14 head_norm_before_train=0.933788 cos_to_last_merge=0.9967 (last merge round=12)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6683098722807341, 'auprc': 0.9122303524472799, 'loss_val': 0.6553246062505059, 'psi': 0.7658780643473524}-{'f1_val': 0.7005014381049806, 'auprc': 0.9996246255255237, 'loss_val': 0.6404135654434162, 'psi': 0.8201507130731978}
[S4] START round=14 head_norm_before_train=1.862303 (no previous merge yet)
[S4] round=14 local utility u=0.028370 metrics={'f1_val': 0.9549412625199141, 'auprc': 0.9587113055400593, 'loss_val': 0.26880883979413145, 'psi': 0.9564492797279722}-{'f1_val': 0.9501901828267995, 'auprc': 0.9570324932437161, 'loss_val': 0.29200535627932395, 'psi': 0.9529271069935661}
[S5] START round=14 head_norm_before_train=1.130330 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.091270 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.812187160873994, 'loss_val': 0.5913872030308852, 'psi': 0.7453649796561118}-{'f1_val': 0.7014316176293985, 'auprc': 0.7793031342114003, 'loss_val': 0.6789627955616975, 'psi': 0.7325802242621993}
[S6] START round=14 head_norm_before_train=1.293113 cos_to_last_merge=0.8511 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=14 local utility u=0.809568 metrics={'f1_val': 0.8280375875359581, 'auprc': 0.9586174155938206, 'loss_val': 0.39096848551183044, 'psi': 0.8802695187591032}-{'f1_val': 0.6250890818564443, 'auprc': 0.850100330322215, 'loss_val': 0.4668630999012554, 'psi': 0.7150935812427526}
[S7] START round=14 head_norm_before_train=1.147746 cos_to_last_merge=0.9063 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.43146104104064165, 'auprc': 0.7821469026680332, 'loss_val': 0.7923571925550961, 'psi': 0.5717353856915983}-{'f1_val': 0.6949078496686624, 'auprc': 0.7818003786345717, 'loss_val': 0.7208744755758013, 'psi': 0.729664861255026}
[S8] START round=14 head_norm_before_train=1.085632 cos_to_last_merge=0.9923 (last merge round=12)
[S8] round=14 local utility u=0.035728 metrics={'f1_val': 0.9942019179894719, 'auprc': 0.9953635201398379, 'loss_val': 0.22077888729251915, 'psi': 0.9946665588496182}-{'f1_val': 0.9941443971419754, 'auprc': 0.99888721844409, 'loss_val': 0.30246173816387406, 'psi': 0.9960415256628212}
[S9] START round=14 head_norm_before_train=1.340631 cos_to_last_merge=0.9978 (last merge round=12)
[S9] round=14 local utility u=0.598580 metrics={'f1_val': 0.8847460773253083, 'auprc': 0.9971670400298431, 'loss_val': 0.23303311434852084, 'psi': 0.9297144624071223}-{'f1_val': 0.7012165807733519, 'auprc': 0.9971727835404488, 'loss_val': 0.32903404203440695, 'psi': 0.8195990618801907}
[S10] START round=14 head_norm_before_train=1.816942 (no previous merge yet)
[S10] round=14 local utility u=0.007147 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9950861074389319, 'loss_val': 0.05047898002739807, 'psi': 0.995228315313811}-{'f1_val': 0.9953231205637304, 'auprc': 0.9949004517022284, 'loss_val': 0.06421657484912653, 'psi': 0.9951540530191296}
[S11] START round=14 head_norm_before_train=1.840568 cos_to_last_merge=0.9996 (last merge round=12)
[S11] round=14 local utility u=0.027934 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9989160236428055, 'loss_val': 0.13611573603532945, 'psi': 0.9977308236268569}-{'f1_val': 0.9977924134809988, 'auprc': 0.9995055210141921, 'loss_val': 0.19886302082887555, 'psi': 0.9984776564942761}
[S13] START round=14 head_norm_before_train=1.638798 (no previous merge yet)
[S13] round=14 local utility u=0.040790 metrics={'f1_val': 0.6274665528863668, 'auprc': 0.6845674099391099, 'loss_val': 0.6071470962103027, 'psi': 0.650306895707464}-{'f1_val': 0.6221918170329181, 'auprc': 0.6755368989739887, 'loss_val': 0.6299877372324296, 'psi': 0.6435298498093465}
[S14] START round=14 head_norm_before_train=0.889479 cos_to_last_merge=0.9913 (last merge round=12)
[S14] round=14 local utility u=0.760075 metrics={'f1_val': 0.9289330955464234, 'auprc': 0.997026497798238, 'loss_val': 0.3881665351447508, 'psi': 0.9561704564471494}-{'f1_val': 0.7017495974233731, 'auprc': 0.997026332498459, 'loss_val': 0.5452153901445363, 'psi': 0.8198602914534074}
[S15] START round=14 head_norm_before_train=1.064401 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.475993 metrics={'f1_val': 0.9510195190224533, 'auprc': 0.9811318482263903, 'loss_val': 0.27067817788273646, 'psi': 0.9630644507040281}-{'f1_val': 0.8115813510930965, 'auprc': 0.9509820938476863, 'loss_val': 0.29558681109705803, 'psi': 0.8673416481949324}
[S16] START round=14 head_norm_before_train=1.063488 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.185391 metrics={'f1_val': 0.5211837412947304, 'auprc': 0.8846271647084345, 'loss_val': 0.6906230951911366, 'psi': 0.6665611106602121}-{'f1_val': 0.47754156916793866, 'auprc': 0.8715693793177457, 'loss_val': 0.7603787362849013, 'psi': 0.6351526932278615}
[S17] START round=14 head_norm_before_train=1.388272 cos_to_last_merge=0.8230 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=14 local utility u=0.563656 metrics={'f1_val': 0.40103076417911887, 'auprc': 0.7400904050290579, 'loss_val': 1.083549881207205, 'psi': 0.5366546205190945}-{'f1_val': 0.30505047741281666, 'auprc': 0.6940659161917365, 'loss_val': 1.4969075635766491, 'psi': 0.4606566529243846}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.963)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[S5] not sending this round → trigger blocked (psi=0.745)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:49309
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.3102
[S8] RECEIVED delta(kind=head bytes=1806) from S6
[S8] cosine check vs S6: cos=0.8128
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] cosine check vs S10: cos=0.9301
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9891
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0443
[S10] DROPPED delta from S13 (cos=-0.0443 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=-0.0864
[S15] DROPPED delta from S11 (cos=-0.0864 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.8107
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.0051
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.3368
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.6053
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.6683 head_norm=0.976648
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.663574e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.6933 head_norm=1.075701 delta_norm=0.566357
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.9969 head_norm=1.871342
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.389015e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.9969 head_norm=1.873602 delta_norm=0.138902
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5212 head_norm=1.103041
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.837515e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.2998 head_norm=0.888149 delta_norm=0.883752
[S16] aggregate: ROLLBACK (f1_val pre=0.521 post=0.300 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.8847 head_norm=1.386705
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.494540e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.8415 head_norm=1.237476 delta_norm=0.249454
[S9] aggregate: ROLLBACK (f1_val pre=0.885 post=0.841 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9289 head_norm=0.950526
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.240867e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7020 head_norm=0.977275 delta_norm=0.324087
[S14] aggregate: ROLLBACK (f1_val pre=0.929 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9942 head_norm=1.163675
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.318017e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9938 head_norm=0.952086 delta_norm=0.331802
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.089200 cos_to_last_merge=0.9866 (last merge round=12)
[S2] round=15 local utility u=0.400480 metrics={'f1_val': 0.701230889339113, 'auprc': 0.6811761936760273, 'loss_val': 0.30898931386382844, 'psi': 0.6932090110738787}-{'f1_val': 0.6094790290980855, 'auprc': 0.6861625487744624, 'loss_val': 0.574396972987252, 'psi': 0.6401524369686362}
[S3] START round=15 head_norm_before_train=1.075701 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.274152 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9996233561601766, 'loss_val': 0.5618977145226502, 'psi': 0.8201050592168646}-{'f1_val': 0.6683098722807341, 'auprc': 0.9122303524472799, 'loss_val': 0.6553246062505059, 'psi': 0.7658780643473524}
[S4] START round=15 head_norm_before_train=1.886116 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9503700691198687, 'auprc': 0.9371542946225261, 'loss_val': 0.29246908760000495, 'psi': 0.9450837593209316}-{'f1_val': 0.9549412625199141, 'auprc': 0.9587113055400593, 'loss_val': 0.26880883979413145, 'psi': 0.9564492797279722}
[S5] START round=15 head_norm_before_train=1.161322 cos_to_last_merge=0.9988 (last merge round=13)
[S5] round=15 local utility u=0.104363 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8540946721310686, 'loss_val': 0.5071361875067292, 'psi': 0.762003325255896}-{'f1_val': 0.7008168588441903, 'auprc': 0.812187160873994, 'loss_val': 0.5913872030308852, 'psi': 0.7453649796561118}
[S6] START round=15 head_norm_before_train=1.321220 cos_to_last_merge=0.8456 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8201377546094692, 'auprc': 0.9551208736297792, 'loss_val': 0.3982358547409633, 'psi': 0.8741310022175932}-{'f1_val': 0.8280375875359581, 'auprc': 0.9586174155938206, 'loss_val': 0.39096848551183044, 'psi': 0.8802695187591032}
[S7] START round=15 head_norm_before_train=1.178383 cos_to_last_merge=0.8958 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4039147772663435, 'auprc': 0.7836226344712596, 'loss_val': 0.8159945787689069, 'psi': 0.55579792014831}-{'f1_val': 0.43146104104064165, 'auprc': 0.7821469026680332, 'loss_val': 0.7923571925550961, 'psi': 0.5717353856915983}
[S8] START round=15 head_norm_before_train=0.952086 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.994827378662793, 'loss_val': 0.28916513436634084, 'psi': 0.995652813505209}-{'f1_val': 0.9942019179894719, 'auprc': 0.9953635201398379, 'loss_val': 0.22077888729251915, 'psi': 0.9946665588496182}
[S9] START round=15 head_norm_before_train=1.237476 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.336691 metrics={'f1_val': 0.9937350633245463, 'auprc': 0.9973411508300908, 'loss_val': 0.21410656015852983, 'psi': 0.995177498326764}-{'f1_val': 0.8847460773253083, 'auprc': 0.9971670400298431, 'loss_val': 0.23303311434852084, 'psi': 0.9297144624071223}
[S10] START round=15 head_norm_before_train=1.856756 (no previous merge yet)
[S10] round=15 local utility u=0.004888 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954733873970385, 'loss_val': 0.04186485948704096, 'psi': 0.9953832272970535}-{'f1_val': 0.9953231205637304, 'auprc': 0.9950861074389319, 'loss_val': 0.05047898002739807, 'psi': 0.995228315313811}
[S11] START round=15 head_norm_before_train=1.873602 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.013597 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9989515161218867, 'loss_val': 0.10757743778940955, 'psi': 0.9975999188034835}-{'f1_val': 0.9969406902828911, 'auprc': 0.9989160236428055, 'loss_val': 0.13611573603532945, 'psi': 0.9977308236268569}
[S13] START round=15 head_norm_before_train=1.656095 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6157147456629262, 'auprc': 0.6933064343265699, 'loss_val': 0.6844924251773555, 'psi': 0.6467514211283836}-{'f1_val': 0.6274665528863668, 'auprc': 0.6845674099391099, 'loss_val': 0.6071470962103027, 'psi': 0.650306895707464}
[S14] START round=15 head_norm_before_train=0.977275 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9318401440710319, 'auprc': 0.9969614422050878, 'loss_val': 0.4273669954998392, 'psi': 0.9578886633246542}-{'f1_val': 0.9289330955464234, 'auprc': 0.997026497798238, 'loss_val': 0.3881665351447508, 'psi': 0.9561704564471494}
[S15] START round=15 head_norm_before_train=1.118702 cos_to_last_merge=0.9974 (last merge round=13)
[S15] round=15 local utility u=0.094849 metrics={'f1_val': 0.9822880093173814, 'auprc': 0.966523542456549, 'loss_val': 0.22476602445475727, 'psi': 0.9759822225730485}-{'f1_val': 0.9510195190224533, 'auprc': 0.9811318482263903, 'loss_val': 0.27067817788273646, 'psi': 0.9630644507040281}
[S16] START round=15 head_norm_before_train=0.888149 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.779314 metrics={'f1_val': 0.8249329559715799, 'auprc': 0.8830294785182868, 'loss_val': 0.9496979716260825, 'psi': 0.8481715649902626}-{'f1_val': 0.5211837412947304, 'auprc': 0.8846271647084345, 'loss_val': 0.6906230951911366, 'psi': 0.6665611106602121}
[S17] START round=15 head_norm_before_train=1.414901 cos_to_last_merge=0.8204 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3786987062866384, 'auprc': 0.8125321536509338, 'loss_val': 1.2045584973592092, 'psi': 0.5522320852323566}-{'f1_val': 0.40103076417911887, 'auprc': 0.7400904050290579, 'loss_val': 1.083549881207205, 'psi': 0.5366546205190945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:49302
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49314
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S10
[S9] cosine check vs S10: cos=0.9004
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.7482
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=-0.0894
[S15] DROPPED delta from S11 (cos=-0.0894 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.6254
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] cosine check vs S2: cos=0.9273
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.6259
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.6607
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.9324
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.291 → S8@127.0.0.1:49309
[S4] ⇄ pheromone p=0.193 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.104 → S10@127.0.0.1:49311
[S8] ⇄ pheromone p=0.156 → S9@127.0.0.1:49310
[S7] ⇄ pheromone p=0.223 → S3@127.0.0.1:49303
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9318 head_norm=1.023181
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.029093e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.7020 head_norm=0.885609 delta_norm=0.402909
[S14] aggregate: ROLLBACK (f1_val pre=0.932 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.301 → S8@127.0.0.1:49309
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7012 head_norm=1.143784
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.875727e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.015161 delta_norm=0.487573
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.210 → S15@127.0.0.1:49315
[S3] ⇄ pheromone p=0.286 → S2@127.0.0.1:49302
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8249 head_norm=0.919989
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.254850e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8217 head_norm=0.895612 delta_norm=0.125485
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.323 → S14@127.0.0.1:49314
[S11] ⇄ pheromone p=0.258 → S15@127.0.0.1:49315
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9937 head_norm=1.283785
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.619722e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9942 head_norm=1.549387 delta_norm=0.461972
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.336 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.160 → S9@127.0.0.1:49310
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.196648
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.182506e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.165134 delta_norm=0.218251
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.212 → S16@127.0.0.1:49316
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9823 head_norm=1.174042
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.214773e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9823 head_norm=1.137654 delta_norm=0.221477
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.297 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.207 → S3@127.0.0.1:49303
[S2] START round=16 head_norm_before_train=1.015161 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013083232172098, 'auprc': 0.6797759886979192, 'loss_val': 0.3499448535917473, 'psi': 0.6926953894094936}-{'f1_val': 0.701230889339113, 'auprc': 0.6811761936760273, 'loss_val': 0.30898931386382844, 'psi': 0.6932090110738787}
[S3] START round=16 head_norm_before_train=1.108296 cos_to_last_merge=0.9978 (last merge round=14)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6036996567329836, 'auprc': 0.8154963378162408, 'loss_val': 0.6422448380810316, 'psi': 0.6884183291662864}-{'f1_val': 0.7004261945879899, 'auprc': 0.9996233561601766, 'loss_val': 0.5618977145226502, 'psi': 0.8201050592168646}
[S4] START round=16 head_norm_before_train=1.905829 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9494841801621831, 'auprc': 0.9354426544508294, 'loss_val': 0.30202363396925125, 'psi': 0.9438675698776415}-{'f1_val': 0.9503700691198687, 'auprc': 0.9371542946225261, 'loss_val': 0.29246908760000495, 'psi': 0.9450837593209316}
[S5] START round=16 head_norm_before_train=1.165134 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.221735 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9848287843814585, 'loss_val': 0.4558678152975423, 'psi': 0.8142969701560518}-{'f1_val': 0.7006090940057808, 'auprc': 0.8540946721310686, 'loss_val': 0.5071361875067292, 'psi': 0.762003325255896}
[S6] START round=16 head_norm_before_train=1.346365 cos_to_last_merge=0.8419 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8273993177629061, 'auprc': 0.9483026897031263, 'loss_val': 0.46970236082057193, 'psi': 0.8757606665389941}-{'f1_val': 0.8201377546094692, 'auprc': 0.9551208736297792, 'loss_val': 0.3982358547409633, 'psi': 0.8741310022175932}
[S7] START round=16 head_norm_before_train=1.205064 cos_to_last_merge=0.8879 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=16 local utility u=0.265888 metrics={'f1_val': 0.48563740491818685, 'auprc': 0.7789203176209588, 'loss_val': 0.7604468796453157, 'psi': 0.6029505699992956}-{'f1_val': 0.4039147772663435, 'auprc': 0.7836226344712596, 'loss_val': 0.8159945787689069, 'psi': 0.55579792014831}
[S8] START round=16 head_norm_before_train=1.014105 cos_to_last_merge=0.9959 (last merge round=14)
[S8] round=16 local utility u=0.042074 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9958647424259285, 'loss_val': 0.20812823795985635, 'psi': 0.9960677590104632}-{'f1_val': 0.9962031034001528, 'auprc': 0.994827378662793, 'loss_val': 0.28916513436634084, 'psi': 0.995652813505209}
[S9] START round=16 head_norm_before_train=1.549387 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.030933 metrics={'f1_val': 0.9934847371778757, 'auprc': 0.9968058664104826, 'loss_val': 0.14913371047326868, 'psi': 0.9948131888709184}-{'f1_val': 0.9937350633245463, 'auprc': 0.9973411508300908, 'loss_val': 0.21410656015852983, 'psi': 0.995177498326764}
[S10] START round=16 head_norm_before_train=1.892071 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9930303983071643, 'loss_val': 0.04742330076751152, 'psi': 0.9944060316611039}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954733873970385, 'loss_val': 0.04186485948704096, 'psi': 0.9953832272970535}
[S11] START round=16 head_norm_before_train=1.900427 cos_to_last_merge=0.9998 (last merge round=14)
[S11] round=16 local utility u=0.013088 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.998881357212174, 'loss_val': 0.08381463483321877, 'psi': 0.9978342925206481}-{'f1_val': 0.9966988539245482, 'auprc': 0.9989515161218867, 'loss_val': 0.10757743778940955, 'psi': 0.9975999188034835}
[S13] START round=16 head_norm_before_train=1.672871 (no previous merge yet)
[S13] round=16 local utility u=0.138165 metrics={'f1_val': 0.6437136112649484, 'auprc': 0.6785995380843641, 'loss_val': 0.5320357605988729, 'psi': 0.6576679819927147}-{'f1_val': 0.6157147456629262, 'auprc': 0.6933064343265699, 'loss_val': 0.6844924251773555, 'psi': 0.6467514211283836}
[S14] START round=16 head_norm_before_train=0.885609 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.199156 metrics={'f1_val': 0.9962260438606761, 'auprc': 0.9969288786820438, 'loss_val': 0.41527203671750357, 'psi': 0.9965071777892232}-{'f1_val': 0.9318401440710319, 'auprc': 0.9969614422050878, 'loss_val': 0.4273669954998392, 'psi': 0.9578886633246542}
[S15] START round=16 head_norm_before_train=1.137654 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8245850798110066, 'auprc': 0.9718691412838185, 'loss_val': 0.28413097138395094, 'psi': 0.8834987044001315}-{'f1_val': 0.9822880093173814, 'auprc': 0.966523542456549, 'loss_val': 0.22476602445475727, 'psi': 0.9759822225730485}
[S16] START round=16 head_norm_before_train=0.895612 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.6877560273285169, 'auprc': 0.9557992145446981, 'loss_val': 0.7509368553290944, 'psi': 0.7949733022149894}-{'f1_val': 0.8249329559715799, 'auprc': 0.8830294785182868, 'loss_val': 0.9496979716260825, 'psi': 0.8481715649902626}
[S17] START round=16 head_norm_before_train=1.438474 cos_to_last_merge=0.8179 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=16 local utility u=0.505554 metrics={'f1_val': 0.5849519831310126, 'auprc': 0.7948087529798359, 'loss_val': 1.3777994046986402, 'psi': 0.6688946910705419}-{'f1_val': 0.3786987062866384, 'auprc': 0.8125321536509338, 'loss_val': 1.2045584973592092, 'psi': 0.5522320852323566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:49311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.4307
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=-0.0427
[S10] DROPPED delta from S13 (cos=-0.0427 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.2245
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.6562
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=-0.0786
[S15] DROPPED delta from S11 (cos=-0.0786 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.7070
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.4818
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.8988
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.6037 head_norm=1.147711
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.171635e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.5771 head_norm=1.071725 delta_norm=0.217164
[S3] aggregate: ROLLBACK (f1_val pre=0.604 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9962 head_norm=1.090579
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.447896e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9962 head_norm=0.858486 delta_norm=0.544790
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9935 head_norm=1.587582
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.562165e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9910 head_norm=1.059142 delta_norm=0.856216
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.6878 head_norm=0.930223
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.561558e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8896 head_norm=0.955370 delta_norm=0.156156
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.074695 cos_to_last_merge=0.9973 (last merge round=15)
[S2] round=17 local utility u=0.018763 metrics={'f1_val': 0.7010472986067986, 'auprc': 0.6888587122212094, 'loss_val': 0.3381006756922913, 'psi': 0.6961718640525629}-{'f1_val': 0.7013083232172098, 'auprc': 0.6797759886979192, 'loss_val': 0.3499448535917473, 'psi': 0.6926953894094936}
[S3] START round=17 head_norm_before_train=1.071725 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.524711 metrics={'f1_val': 0.6927754426342754, 'auprc': 0.9497739280107016, 'loss_val': 0.5301106027925686, 'psi': 0.7955748367848459}-{'f1_val': 0.6036996567329836, 'auprc': 0.8154963378162408, 'loss_val': 0.6422448380810316, 'psi': 0.6884183291662864}
[S4] START round=17 head_norm_before_train=1.917457 (no previous merge yet)
[S4] round=17 local utility u=0.009749 metrics={'f1_val': 0.9491907828484121, 'auprc': 0.941409084635694, 'loss_val': 0.29866551870225505, 'psi': 0.9460781035633248}-{'f1_val': 0.9494841801621831, 'auprc': 0.9354426544508294, 'loss_val': 0.30202363396925125, 'psi': 0.9438675698776415}
[S5] START round=17 head_norm_before_train=1.200344 cos_to_last_merge=0.9987 (last merge round=15)
[S5] round=17 local utility u=0.039448 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9867019463349362, 'loss_val': 0.38086489368284465, 'psi': 0.8148735689943227}-{'f1_val': 0.7006090940057808, 'auprc': 0.9848287843814585, 'loss_val': 0.4558678152975423, 'psi': 0.8142969701560518}
[S6] START round=17 head_norm_before_train=1.375509 cos_to_last_merge=0.8360 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=17 local utility u=0.485050 metrics={'f1_val': 0.9412981719031293, 'auprc': 0.968674865947181, 'loss_val': 0.24411156709413623, 'psi': 0.95224884952075}-{'f1_val': 0.8273993177629061, 'auprc': 0.9483026897031263, 'loss_val': 0.46970236082057193, 'psi': 0.8757606665389941}
[S7] START round=17 head_norm_before_train=1.231786 cos_to_last_merge=0.8808 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.48324041977688614, 'auprc': 0.6438006006866598, 'loss_val': 0.7878646437122776, 'psi': 0.5474644921407956}-{'f1_val': 0.48563740491818685, 'auprc': 0.7789203176209588, 'loss_val': 0.7604468796453157, 'psi': 0.6029505699992956}
[S8] START round=17 head_norm_before_train=0.858486 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980696537429017, 'loss_val': 0.27469288649825063, 'psi': 0.9969497235372524}-{'f1_val': 0.9962031034001528, 'auprc': 0.9958647424259285, 'loss_val': 0.20812823795985635, 'psi': 0.9960677590104632}
[S9] START round=17 head_norm_before_train=1.059142 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9981967279714835, 'loss_val': 0.23579256380280447, 'psi': 0.9963749882537281}-{'f1_val': 0.9934847371778757, 'auprc': 0.9968058664104826, 'loss_val': 0.14913371047326868, 'psi': 0.9948131888709184}
[S10] START round=17 head_norm_before_train=1.920488 (no previous merge yet)
[S10] round=17 local utility u=0.006228 metrics={'f1_val': 0.9943532786287019, 'auprc': 0.9954418399515583, 'loss_val': 0.03638216521487266, 'psi': 0.9947887031578444}-{'f1_val': 0.9953231205637304, 'auprc': 0.9930303983071643, 'loss_val': 0.04742330076751152, 'psi': 0.9944060316611039}
[S11] START round=17 head_norm_before_train=1.926101 cos_to_last_merge=0.9991 (last merge round=14)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9110444888096021, 'auprc': 0.9994256404807343, 'loss_val': 0.24154617330984504, 'psi': 0.946396949478055}-{'f1_val': 0.9971362493929642, 'auprc': 0.998881357212174, 'loss_val': 0.08381463483321877, 'psi': 0.9978342925206481}
[S13] START round=17 head_norm_before_train=1.684939 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6305647993351461, 'auprc': 0.6748759013197546, 'loss_val': 0.6252877313782679, 'psi': 0.6482892401289895}-{'f1_val': 0.6437136112649484, 'auprc': 0.6785995380843641, 'loss_val': 0.5320357605988729, 'psi': 0.6576679819927147}
[S14] START round=17 head_norm_before_train=0.937137 cos_to_last_merge=0.9930 (last merge round=15)
[S14] round=17 local utility u=0.063748 metrics={'f1_val': 0.9974737445708615, 'auprc': 0.9968898728110874, 'loss_val': 0.2951448524976001, 'psi': 0.9972401958669519}-{'f1_val': 0.9962260438606761, 'auprc': 0.9969288786820438, 'loss_val': 0.41527203671750357, 'psi': 0.9965071777892232}
[S15] START round=17 head_norm_before_train=1.198625 cos_to_last_merge=0.9972 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6990229227622223, 'auprc': 0.8931399798878444, 'loss_val': 0.37889456476933026, 'psi': 0.7766697456124712}-{'f1_val': 0.8245850798110066, 'auprc': 0.9718691412838185, 'loss_val': 0.28413097138395094, 'psi': 0.8834987044001315}
[S16] START round=17 head_norm_before_train=0.955370 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.951639 metrics={'f1_val': 0.9773642468720607, 'auprc': 0.978431324031898, 'loss_val': 0.6532044166126066, 'psi': 0.9777910777359956}-{'f1_val': 0.6877560273285169, 'auprc': 0.9557992145446981, 'loss_val': 0.7509368553290944, 'psi': 0.7949733022149894}
[S17] START round=17 head_norm_before_train=1.475179 cos_to_last_merge=0.8161 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3776073971080742, 'auprc': 0.778334931632644, 'loss_val': 1.7115538588823973, 'psi': 0.5378984109179021}-{'f1_val': 0.5849519831310126, 'auprc': 0.7948087529798359, 'loss_val': 1.3777994046986402, 'psi': 0.6688946910705419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S5] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.8879
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.8393
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9915
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.7659
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.5031
[S2] RECEIVED delta(kind=head bytes=1790) from S3
[S2] cosine check vs S3: cos=0.8849
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9952 head_norm=1.105273
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.532543e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9958 head_norm=1.439243 delta_norm=0.653254
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.9110 head_norm=1.946600
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.263178e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9108 head_norm=1.931804 delta_norm=0.126318
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9975 head_norm=1.003350
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.829402e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9975 head_norm=0.957014 delta_norm=0.282940
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9962 head_norm=0.930328
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.152146e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9962 head_norm=1.016644 delta_norm=0.615215
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7010 head_norm=1.138221
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.700448e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7010 head_norm=1.091136 delta_norm=0.270045
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6990 head_norm=1.272708
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.927268e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6990 head_norm=1.171314 delta_norm=0.292727
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.091136 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.5602067353568936, 'auprc': 0.6321553579732917, 'loss_val': 0.6662962095745917, 'psi': 0.5889861844034529}-{'f1_val': 0.7010472986067986, 'auprc': 0.6888587122212094, 'loss_val': 0.3381006756922913, 'psi': 0.6961718640525629}
[S3] START round=18 head_norm_before_train=1.109710 cos_to_last_merge=0.9982 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.6962757309188854, 'auprc': 0.9170185748058624, 'loss_val': 0.47298103040817635, 'psi': 0.7845728684736761}-{'f1_val': 0.6927754426342754, 'auprc': 0.9497739280107016, 'loss_val': 0.5301106027925686, 'psi': 0.7955748367848459}
[S4] START round=18 head_norm_before_train=1.925201 (no previous merge yet)
[S4] round=18 local utility u=0.021632 metrics={'f1_val': 0.9543566278036171, 'auprc': 0.946325937748966, 'loss_val': 0.30114740744292906, 'psi': 0.9511443517817566}-{'f1_val': 0.9491907828484121, 'auprc': 0.941409084635694, 'loss_val': 0.29866551870225505, 'psi': 0.9460781035633248}
[S5] START round=18 head_norm_before_train=1.238797 cos_to_last_merge=0.9950 (last merge round=15)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9323414311467775, 'loss_val': 0.36230892389632874, 'psi': 0.7931289315535264}-{'f1_val': 0.7003213174339138, 'auprc': 0.9867019463349362, 'loss_val': 0.38086489368284465, 'psi': 0.8148735689943227}
[S6] START round=18 head_norm_before_train=1.399500 cos_to_last_merge=0.8323 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8543364071175801, 'auprc': 0.9372717092386926, 'loss_val': 0.5239041934968, 'psi': 0.8875105279660251}-{'f1_val': 0.9412981719031293, 'auprc': 0.968674865947181, 'loss_val': 0.24411156709413623, 'psi': 0.95224884952075}
[S7] START round=18 head_norm_before_train=1.254641 cos_to_last_merge=0.8749 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.4550760868098454, 'auprc': 0.6231176600244825, 'loss_val': 0.8748902400617349, 'psi': 0.5222927160957003}-{'f1_val': 0.48324041977688614, 'auprc': 0.6438006006866598, 'loss_val': 0.7878646437122776, 'psi': 0.5474644921407956}
[S8] START round=18 head_norm_before_train=1.016644 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000364 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990468232688943, 'loss_val': 0.27689675224607885, 'psi': 0.9973405913476494}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980696537429017, 'loss_val': 0.27469288649825063, 'psi': 0.9969497235372524}
[S9] START round=18 head_norm_before_train=1.439243 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.021287 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9970530210379045, 'loss_val': 0.14169204225543597, 'psi': 0.991108011105039}-{'f1_val': 0.9951604951085576, 'auprc': 0.9981967279714835, 'loss_val': 0.23579256380280447, 'psi': 0.9963749882537281}
[S10] START round=18 head_norm_before_train=1.942857 (no previous merge yet)
[S10] round=18 local utility u=0.003110 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.995141857208728, 'loss_val': 0.03508053973989434, 'psi': 0.9952506152217294}-{'f1_val': 0.9943532786287019, 'auprc': 0.9954418399515583, 'loss_val': 0.03638216521487266, 'psi': 0.9947887031578444}
[S11] START round=18 head_norm_before_train=1.931804 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.339852 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9990008604104057, 'loss_val': 0.0720114356718833, 'psi': 0.9973713612465358}-{'f1_val': 0.9110444888096021, 'auprc': 0.9994256404807343, 'loss_val': 0.24154617330984504, 'psi': 0.946396949478055}
[S13] START round=18 head_norm_before_train=1.698499 (no previous merge yet)
[S13] round=18 local utility u=0.070516 metrics={'f1_val': 0.6348058518195135, 'auprc': 0.6912704215085925, 'loss_val': 0.5588855866941796, 'psi': 0.6573916796951451}-{'f1_val': 0.6305647993351461, 'auprc': 0.6748759013197546, 'loss_val': 0.6252877313782679, 'psi': 0.6482892401289895}
[S14] START round=18 head_norm_before_train=0.957014 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9613064831981835, 'auprc': 0.9974144425303656, 'loss_val': 0.32879465678224945, 'psi': 0.9757496669310564}-{'f1_val': 0.9974737445708615, 'auprc': 0.9968898728110874, 'loss_val': 0.2951448524976001, 'psi': 0.9972401958669519}
[S15] START round=18 head_norm_before_train=1.171314 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.851888 metrics={'f1_val': 0.9143600294703895, 'auprc': 0.9733828441538688, 'loss_val': 0.20786976880464522, 'psi': 0.9379691553437812}-{'f1_val': 0.6990229227622223, 'auprc': 0.8931399798878444, 'loss_val': 0.37889456476933026, 'psi': 0.7766697456124712}
[S16] START round=18 head_norm_before_train=0.992548 cos_to_last_merge=0.9951 (last merge round=16)
[S16] round=18 local utility u=0.092526 metrics={'f1_val': 0.9801953116132531, 'auprc': 0.9856060582991046, 'loss_val': 0.5066639884755567, 'psi': 0.9823596102875938}-{'f1_val': 0.9773642468720607, 'auprc': 0.978431324031898, 'loss_val': 0.6532044166126066, 'psi': 0.9777910777359956}
[S17] START round=18 head_norm_before_train=1.499548 cos_to_last_merge=0.8152 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=18 local utility u=1.000000 metrics={'f1_val': 0.6497278176457448, 'auprc': 0.8212178275161499, 'loss_val': 1.2572326602217927, 'psi': 0.718323821593907}-{'f1_val': 0.3776073971080742, 'auprc': 0.778334931632644, 'loss_val': 1.7115538588823973, 'psi': 0.5378984109179021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:49310
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:49314
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9970
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=0.3104
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0421
[S10] DROPPED delta from S13 (cos=-0.0421 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=-0.0644
[S15] DROPPED delta from S11 (cos=-0.0644 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9392
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.7209
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.9643
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9064
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.8469
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9613 head_norm=1.013289
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.791097e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9446 head_norm=1.009683 delta_norm=0.179110
[S14] aggregate: ROLLBACK (f1_val pre=0.961 post=0.945 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.271284
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.731671e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=1.232246 delta_norm=0.273167
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.6963 head_norm=1.149962
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.118688e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.6966 head_norm=1.286807 delta_norm=0.411869
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9963 head_norm=1.948173
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.560762e-02
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9967 head_norm=1.940466 delta_norm=0.075608
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9871 head_norm=1.484408
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.445856e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9871 head_norm=1.309527 delta_norm=0.244586
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9802 head_norm=1.037461
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.146158e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9784 head_norm=1.172633 delta_norm=0.514616
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.141680 cos_to_last_merge=0.9982 (last merge round=17)
[S2] round=19 local utility u=0.607847 metrics={'f1_val': 0.6945494391236433, 'auprc': 0.678475545105195, 'loss_val': 0.39561975212697037, 'psi': 0.688119881516264}-{'f1_val': 0.5602067353568936, 'auprc': 0.6321553579732917, 'loss_val': 0.6662962095745917, 'psi': 0.5889861844034529}
[S3] START round=19 head_norm_before_train=1.286807 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.065086 metrics={'f1_val': 0.6927290670481991, 'auprc': 0.964227817771981, 'loss_val': 0.4631572599239711, 'psi': 0.8013285673377119}-{'f1_val': 0.6962757309188854, 'auprc': 0.9170185748058624, 'loss_val': 0.47298103040817635, 'psi': 0.7845728684736761}
[S4] START round=19 head_norm_before_train=1.935684 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9417083079919661, 'auprc': 0.9412062737712195, 'loss_val': 0.3045868744723113, 'psi': 0.9415074943036675}-{'f1_val': 0.9543566278036171, 'auprc': 0.946325937748966, 'loss_val': 0.30114740744292906, 'psi': 0.9511443517817566}
[S5] START round=19 head_norm_before_train=1.232246 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8510003398009851, 'loss_val': 0.40023929109264395, 'psi': 0.7605924950152094}-{'f1_val': 0.700320598491359, 'auprc': 0.9323414311467775, 'loss_val': 0.36230892389632874, 'psi': 0.7931289315535264}
[S6] START round=19 head_norm_before_train=1.427461 cos_to_last_merge=0.8296 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7246899419013273, 'auprc': 0.9449215465955475, 'loss_val': 0.6025568616583427, 'psi': 0.8127825837790154}-{'f1_val': 0.8543364071175801, 'auprc': 0.9372717092386926, 'loss_val': 0.5239041934968, 'psi': 0.8875105279660251}
[S7] START round=19 head_norm_before_train=1.272485 cos_to_last_merge=0.8699 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.38565703787050926, 'auprc': 0.5965331820936622, 'loss_val': 1.094602086576417, 'psi': 0.47000749555977045}-{'f1_val': 0.4550760868098454, 'auprc': 0.6231176600244825, 'loss_val': 0.8748902400617349, 'psi': 0.5222927160957003}
[S8] START round=19 head_norm_before_train=1.085343 cos_to_last_merge=0.9950 (last merge round=17)
[S8] round=19 local utility u=0.021942 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9930895503490502, 'loss_val': 0.20191601590517835, 'psi': 0.9936351125597117}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990468232688943, 'loss_val': 0.27689675224607885, 'psi': 0.9973405913476494}
[S9] START round=19 head_norm_before_train=1.309527 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.032788 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981867290984393, 'loss_val': 0.1366130314094214, 'psi': 0.9972709987277106}-{'f1_val': 0.9871446711497952, 'auprc': 0.9970530210379045, 'loss_val': 0.14169204225543597, 'psi': 0.991108011105039}
[S10] START round=19 head_norm_before_train=1.963090 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9939771952548717, 'loss_val': 0.036911654917084584, 'psi': 0.9947847504401869}-{'f1_val': 0.9953231205637304, 'auprc': 0.995141857208728, 'loss_val': 0.03508053973989434, 'psi': 0.9952506152217294}
[S11] START round=19 head_norm_before_train=1.940466 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990174396351472, 'loss_val': 0.07824270735335861, 'psi': 0.9977855298298052}-{'f1_val': 0.9962850284706224, 'auprc': 0.9990008604104057, 'loss_val': 0.0720114356718833, 'psi': 0.9973713612465358}
[S13] START round=19 head_norm_before_train=1.712185 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6262593204086376, 'auprc': 0.6897396484447026, 'loss_val': 0.6849095434259299, 'psi': 0.6516514516230636}-{'f1_val': 0.6348058518195135, 'auprc': 0.6912704215085925, 'loss_val': 0.5588855866941796, 'psi': 0.6573916796951451}
[S14] START round=19 head_norm_before_train=1.009683 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.107620 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9970299467950524, 'loss_val': 0.32415800055561184, 'psi': 0.996771530476515}-{'f1_val': 0.9613064831981835, 'auprc': 0.9974144425303656, 'loss_val': 0.32879465678224945, 'psi': 0.9757496669310564}
[S15] START round=19 head_norm_before_train=1.252971 cos_to_last_merge=0.9965 (last merge round=17)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7123945118463093, 'auprc': 0.9103763731089622, 'loss_val': 0.3851868761814268, 'psi': 0.7915872563513705}-{'f1_val': 0.9143600294703895, 'auprc': 0.9733828441538688, 'loss_val': 0.20786976880464522, 'psi': 0.9379691553437812}
[S16] START round=19 head_norm_before_train=1.172633 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.9800484301004959, 'auprc': 0.9812072680901684, 'loss_val': 0.574553767739296, 'psi': 0.9805119652963649}-{'f1_val': 0.9801953116132531, 'auprc': 0.9856060582991046, 'loss_val': 0.5066639884755567, 'psi': 0.9823596102875938}
[S17] START round=19 head_norm_before_train=1.525977 cos_to_last_merge=0.8129 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=19 local utility u=0.332529 metrics={'f1_val': 0.7011559144297201, 'auprc': 0.8468700059775498, 'loss_val': 0.9776989598790935, 'psi': 0.759441551048852}-{'f1_val': 0.6497278176457448, 'auprc': 0.8212178275161499, 'loss_val': 1.2572326602217927, 'psi': 0.718323821593907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] cosine check vs S2: cos=0.8990
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=0.4261
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.8581
[S17] not sending this round → trigger blocked (psi=0.759)
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0669 f1=0.995 auprc=0.994 bytes=19819
[S5] r=20 psi=0.761 u=0.0000 p_local=0.1145 f1=0.700 auprc=0.851 bytes=17968
[S4] r=20 psi=0.942 u=0.0000 p_local=0.0839 f1=0.942 auprc=0.941 bytes=21560
[S7] r=20 psi=0.470 u=0.0000 p_local=0.1184 f1=0.386 auprc=0.597 bytes=16163
[S11] r=20 psi=0.998 u=0.0000 p_local=0.1613 f1=0.997 auprc=0.999 bytes=19774
[S6] r=20 psi=0.813 u=0.0000 p_local=0.1814 f1=0.725 auprc=0.945 bytes=16182
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7124 head_norm=1.332517
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.917368e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7203 head_norm=1.233744 delta_norm=0.291737
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.792 u=0.0000 p_local=0.2581 f1=0.712 auprc=0.910 bytes=19759
[S13] r=20 psi=0.652 u=0.0000 p_local=0.0680 f1=0.626 auprc=0.690 bytes=14380
[S9] r=20 psi=0.997 u=0.0328 p_local=0.1508 f1=0.997 auprc=0.998 bytes=17995
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9940 head_norm=1.172683
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.999594e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9940 head_norm=0.943321 delta_norm=0.599959
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.994 u=0.0219 p_local=0.0728 f1=0.994 auprc=0.993 bytes=16170
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.6945 head_norm=1.199528
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.401462e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.6747 head_norm=1.213530 delta_norm=0.340146
[S2] aggregate: ROLLBACK (f1_val pre=0.695 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S2] r=20 psi=0.688 u=0.6078 p_local=0.2100 f1=0.695 auprc=0.678 bytes=19764
[S3] r=20 psi=0.801 u=0.0651 p_local=0.1971 f1=0.693 auprc=0.964 bytes=21531
[S14] r=20 psi=0.997 u=0.1076 p_local=0.1732 f1=0.997 auprc=0.997 bytes=14364
[S16] r=20 psi=0.981 u=0.0000 p_local=0.2691 f1=0.980 auprc=0.981 bytes=19765
[S17] r=20 psi=0.759 u=0.3325 p_local=0.3631 f1=0.701 auprc=0.847 bytes=16181
[S2] START round=20 head_norm_before_train=1.213530 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.5019844839318041, 'auprc': 0.6167392679057453, 'loss_val': 0.9562775287487677, 'psi': 0.5478863975213806}-{'f1_val': 0.6945494391236433, 'auprc': 0.678475545105195, 'loss_val': 0.39561975212697037, 'psi': 0.688119881516264}
[S3] START round=20 head_norm_before_train=1.318273 cos_to_last_merge=0.9991 (last merge round=18)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.5838692504292393, 'auprc': 0.819685763538321, 'loss_val': 0.5404544147769588, 'psi': 0.678195855672872}-{'f1_val': 0.6927290670481991, 'auprc': 0.964227817771981, 'loss_val': 0.4631572599239711, 'psi': 0.8013285673377119}
[S4] START round=20 head_norm_before_train=1.946371 (no previous merge yet)
[S4] round=20 local utility u=0.018340 metrics={'f1_val': 0.9494841801621831, 'auprc': 0.9366245176732901, 'loss_val': 0.3008172243877448, 'psi': 0.9443403151666259}-{'f1_val': 0.9417083079919661, 'auprc': 0.9412062737712195, 'loss_val': 0.3045868744723113, 'psi': 0.9415074943036675}
[S5] START round=20 head_norm_before_train=1.260113 cos_to_last_merge=0.9995 (last merge round=18)
[S5] round=20 local utility u=0.157121 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9433673026095918, 'loss_val': 0.3630990283673651, 'psi': 0.797539280138652}-{'f1_val': 0.700320598491359, 'auprc': 0.8510003398009851, 'loss_val': 0.40023929109264395, 'psi': 0.7605924950152094}
[S6] START round=20 head_norm_before_train=1.448757 cos_to_last_merge=0.8268 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.827
[S6] round=20 local utility u=0.854493 metrics={'f1_val': 0.9240942832283588, 'auprc': 0.9791800338325035, 'loss_val': 0.19277209814983698, 'psi': 0.9461285834700167}-{'f1_val': 0.7246899419013273, 'auprc': 0.9449215465955475, 'loss_val': 0.6025568616583427, 'psi': 0.8127825837790154}
[S7] START round=20 head_norm_before_train=1.289311 cos_to_last_merge=0.8660 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.673786777402567, 'auprc': 0.7552638040253837, 'loss_val': 0.4589584841891827, 'psi': 0.7063775880516937}-{'f1_val': 0.38565703787050926, 'auprc': 0.5965331820936622, 'loss_val': 1.094602086576417, 'psi': 0.47000749555977045}
[S8] START round=20 head_norm_before_train=0.943321 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.011353 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9978199923562534, 'loss_val': 0.2092484131842721, 'psi': 0.997111921531161}-{'f1_val': 0.9939988207001527, 'auprc': 0.9930895503490502, 'loss_val': 0.20191601590517835, 'psi': 0.9936351125597117}
[S9] START round=20 head_norm_before_train=1.350361 cos_to_last_merge=0.9990 (last merge round=18)
[S9] round=20 local utility u=0.007147 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9981484706848069, 'loss_val': 0.10569984328240842, 'psi': 0.9956052526095944}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981867290984393, 'loss_val': 0.1366130314094214, 'psi': 0.9972709987277106}
[S10] START round=20 head_norm_before_train=1.981381 (no previous merge yet)
[S10] round=20 local utility u=0.003428 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951114444535041, 'loss_val': 0.03345751281671786, 'psi': 0.9952384501196399}-{'f1_val': 0.9953231205637304, 'auprc': 0.9939771952548717, 'loss_val': 0.036911654917084584, 'psi': 0.9947847504401869}
[S11] START round=20 head_norm_before_train=1.954938 cos_to_last_merge=0.9999 (last merge round=18)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9049819342082347, 'auprc': 0.9995719711182198, 'loss_val': 0.3000050233713515, 'psi': 0.9428179489722288}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990174396351472, 'loss_val': 0.07824270735335861, 'psi': 0.9977855298298052}
[S13] START round=20 head_norm_before_train=1.725597 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5768737315076401, 'auprc': 0.7335732304271837, 'loss_val': 0.9284053787850058, 'psi': 0.6395535310754575}-{'f1_val': 0.6262593204086376, 'auprc': 0.6897396484447026, 'loss_val': 0.6849095434259299, 'psi': 0.6516514516230636}
[S14] START round=20 head_norm_before_train=1.060389 cos_to_last_merge=0.9956 (last merge round=18)
[S14] round=20 local utility u=0.052318 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9984572514597854, 'loss_val': 0.2286420687779006, 'psi': 0.9978262184155047}-{'f1_val': 0.9965992529308234, 'auprc': 0.9970299467950524, 'loss_val': 0.32415800055561184, 'psi': 0.996771530476515}
[S15] START round=20 head_norm_before_train=1.233744 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6944538971575176, 'auprc': 0.8779505213585007, 'loss_val': 0.42007886259431715, 'psi': 0.7678525468379109}-{'f1_val': 0.7123945118463093, 'auprc': 0.9103763731089622, 'loss_val': 0.3851868761814268, 'psi': 0.7915872563513705}
[S16] START round=20 head_norm_before_train=1.202319 cos_to_last_merge=0.9971 (last merge round=18)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9226591198305895, 'auprc': 0.9881120828632315, 'loss_val': 0.500657495282333, 'psi': 0.9488403050436462}-{'f1_val': 0.9800484301004959, 'auprc': 0.9812072680901684, 'loss_val': 0.574553767739296, 'psi': 0.9805119652963649}
[S17] START round=20 head_norm_before_train=1.550176 cos_to_last_merge=0.8114 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.699954726733748, 'auprc': 0.8506950186908159, 'loss_val': 0.9897592377653109, 'psi': 0.7602508435165751}-{'f1_val': 0.7011559144297201, 'auprc': 0.8468700059775498, 'loss_val': 0.9776989598790935, 'psi': 0.759441551048852}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S14] not sending this round → trigger blocked (psi=0.998)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.3787
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9978
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.5440
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.9298
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.3504
[S9] RECEIVED delta(kind=head bytes=1794) from S8
[S9] cosine check vs S8: cos=0.6420
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.9110
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.054 → S10@127.0.0.1:49311
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9050 head_norm=1.969961
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.497126e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9045 head_norm=1.964564 delta_norm=0.064971
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.129 → S15@127.0.0.1:49315
[S14] ⇄ pheromone p=0.149 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.5839 head_norm=1.356589
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.413608e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.5706 head_norm=1.103970 delta_norm=0.741361
[S3] aggregate: ROLLBACK (f1_val pre=0.584 post=0.571 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.158 → S2@127.0.0.1:49302
[S2] ⇄ pheromone p=0.168 → S15@127.0.0.1:49315
[S15] ⇄ pheromone p=0.206 → S5@127.0.0.1:49305
[S5] ⇄ pheromone p=0.123 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=0.316 → S8@127.0.0.1:49309
[S10] ⇄ pheromone p=0.054 → S9@127.0.0.1:49310
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9966 head_norm=1.017974
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.261242e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9961 head_norm=1.098059 delta_norm=0.626124
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.060 → S9@127.0.0.1:49310
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9939 head_norm=1.390806
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.519652e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9942 head_norm=1.330244 delta_norm=0.151965
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.122 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=0.295 → S3@127.0.0.1:49303
[S4] ⇄ pheromone p=0.071 → S11@127.0.0.1:49312
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9227 head_norm=1.241361
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.952903e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9210 head_norm=1.074343 delta_norm=0.295290
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.215 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.291 → S3@127.0.0.1:49303
[S2] START round=21 head_norm_before_train=1.255262 cos_to_last_merge=0.9986 (last merge round=19)
[S2] round=21 local utility u=1.000000 metrics={'f1_val': 0.7080201451758205, 'auprc': 0.7158396582956595, 'loss_val': 0.3945260511955708, 'psi': 0.7111479504237561}-{'f1_val': 0.5019844839318041, 'auprc': 0.6167392679057453, 'loss_val': 0.9562775287487677, 'psi': 0.5478863975213806}
[S3] START round=21 head_norm_before_train=1.103970 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=1.000000 metrics={'f1_val': 0.8389521339124899, 'auprc': 0.9852047853417252, 'loss_val': 0.4680455409378072, 'psi': 0.8974531944841839}-{'f1_val': 0.5838692504292393, 'auprc': 0.819685763538321, 'loss_val': 0.5404544147769588, 'psi': 0.678195855672872}
[S4] START round=21 head_norm_before_train=1.961306 (no previous merge yet)
[S4] round=21 local utility u=0.009114 metrics={'f1_val': 0.9498600277059948, 'auprc': 0.941425710138295, 'loss_val': 0.2992485579714864, 'psi': 0.9464863006789148}-{'f1_val': 0.9494841801621831, 'auprc': 0.9366245176732901, 'loss_val': 0.3008172243877448, 'psi': 0.9443403151666259}
[S5] START round=21 head_norm_before_train=1.290170 cos_to_last_merge=0.9981 (last merge round=18)
[S5] round=21 local utility u=0.101134 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9847800494289516, 'loss_val': 0.28507285599409266, 'psi': 0.8141048102319288}-{'f1_val': 0.700320598491359, 'auprc': 0.9433673026095918, 'loss_val': 0.3630990283673651, 'psi': 0.797539280138652}
[S6] START round=21 head_norm_before_train=1.469442 cos_to_last_merge=0.8240 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8493556847531, 'auprc': 0.9565961580049861, 'loss_val': 0.4993148058910913, 'psi': 0.8922518740538544}-{'f1_val': 0.9240942832283588, 'auprc': 0.9791800338325035, 'loss_val': 0.19277209814983698, 'psi': 0.9461285834700167}
[S7] START round=21 head_norm_before_train=1.302459 cos_to_last_merge=0.8627 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.3975138866311348, 'auprc': 0.6186677405219925, 'loss_val': 1.0505047822473657, 'psi': 0.48597542818747785}-{'f1_val': 0.673786777402567, 'auprc': 0.7552638040253837, 'loss_val': 0.4589584841891827, 'psi': 0.7063775880516937}
[S8] START round=21 head_norm_before_train=1.098059 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9956762830907544, 'loss_val': 0.21246037836281254, 'psi': 0.9948859295956177}-{'f1_val': 0.9966398743144329, 'auprc': 0.9978199923562534, 'loss_val': 0.2092484131842721, 'psi': 0.997111921531161}
[S9] START round=21 head_norm_before_train=1.330244 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.007287 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982874351740082, 'loss_val': 0.10804652138948839, 'psi': 0.9973112811579381}-{'f1_val': 0.993909773892786, 'auprc': 0.9981484706848069, 'loss_val': 0.10569984328240842, 'psi': 0.9956052526095944}
[S10] START round=21 head_norm_before_train=1.998080 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9948435364448711, 'loss_val': 0.032815172339220204, 'psi': 0.9951312869161866}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951114444535041, 'loss_val': 0.03345751281671786, 'psi': 0.9952384501196399}
[S11] START round=21 head_norm_before_train=1.964564 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.391998 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9990202363336734, 'loss_val': 0.06479672075549904, 'psi': 0.9976415462823787}-{'f1_val': 0.9049819342082347, 'auprc': 0.9995719711182198, 'loss_val': 0.3000050233713515, 'psi': 0.9428179489722288}
[S13] START round=21 head_norm_before_train=1.733784 (no previous merge yet)
[S13] round=21 local utility u=0.169420 metrics={'f1_val': 0.5913484467211307, 'auprc': 0.7785314262158032, 'loss_val': 0.8112885317664765, 'psi': 0.6662216385189997}-{'f1_val': 0.5768737315076401, 'auprc': 0.7335732304271837, 'loss_val': 0.9284053787850058, 'psi': 0.6395535310754575}
[S14] START round=21 head_norm_before_train=1.122163 cos_to_last_merge=0.9844 (last merge round=18)
[S14] round=21 local utility u=0.024041 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969144103438774, 'loss_val': 0.1746279612618815, 'psi': 0.9970786853396649}-{'f1_val': 0.9974055297193176, 'auprc': 0.9984572514597854, 'loss_val': 0.2286420687779006, 'psi': 0.9978262184155047}
[S15] START round=21 head_norm_before_train=1.293566 cos_to_last_merge=0.9984 (last merge round=19)
[S15] round=21 local utility u=0.685576 metrics={'f1_val': 0.8356736896788202, 'auprc': 0.9891583016001193, 'loss_val': 0.22986968922371206, 'psi': 0.8970675344473398}-{'f1_val': 0.6944538971575176, 'auprc': 0.8779505213585007, 'loss_val': 0.42007886259431715, 'psi': 0.7678525468379109}
[S16] START round=21 head_norm_before_train=1.074343 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.066841 metrics={'f1_val': 0.9342722353353968, 'auprc': 0.9864223283690443, 'loss_val': 0.4315843215533886, 'psi': 0.9551322725488558}-{'f1_val': 0.9226591198305895, 'auprc': 0.9881120828632315, 'loss_val': 0.500657495282333, 'psi': 0.9488403050436462}
[S17] START round=21 head_norm_before_train=1.576068 cos_to_last_merge=0.8096 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=21 local utility u=0.155074 metrics={'f1_val': 0.7090655843767278, 'auprc': 0.8589990543607819, 'loss_val': 0.7591875054903521, 'psi': 0.7690389723703495}-{'f1_val': 0.699954726733748, 'auprc': 0.8506950186908159, 'loss_val': 0.9897592377653109, 'psi': 0.7602508435165751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.9104
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.0404
[S10] DROPPED delta from S13 (cos=-0.0404 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=-0.0511
[S15] DROPPED delta from S11 (cos=-0.0511 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.8923
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.5340
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.8759
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9341
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=0.4465
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] cosine check vs S4: cos=0.9988
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] cosine check vs S16: cos=0.8885
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.6831
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9944 head_norm=1.168613
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.177043e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9947 head_norm=0.998509 delta_norm=0.617704
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.8390 head_norm=1.146489
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.843565e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.8017 head_norm=1.262286 delta_norm=0.584356
[S3] aggregate: ROLLBACK (f1_val pre=0.839 post=0.802 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.319766
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.427893e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7004 head_norm=1.312509 delta_norm=0.242789
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9343 head_norm=1.122788
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.774354e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9328 head_norm=1.048946 delta_norm=0.177435
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8357 head_norm=1.349618
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.080364e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8357 head_norm=1.286472 delta_norm=0.308036
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7080 head_norm=1.295501
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.685533e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7068 head_norm=1.193423 delta_norm=0.268553
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9967 head_norm=1.976058
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.881581e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9967 head_norm=1.973716 delta_norm=0.048816
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9972 head_norm=1.179619
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.732399e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9972 head_norm=1.118668 delta_norm=0.273240
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.193423 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.042555 metrics={'f1_val': 0.7109326503049432, 'auprc': 0.7640763576086212, 'loss_val': 0.4716008417912259, 'psi': 0.7321901332264145}-{'f1_val': 0.7080201451758205, 'auprc': 0.7158396582956595, 'loss_val': 0.3945260511955708, 'psi': 0.7111479504237561}
[S3] START round=22 head_norm_before_train=1.262286 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7525045441160814, 'auprc': 0.9346845934227201, 'loss_val': 0.5409830867957369, 'psi': 0.8253765638387369}-{'f1_val': 0.8389521339124899, 'auprc': 0.9852047853417252, 'loss_val': 0.4680455409378072, 'psi': 0.8974531944841839}
[S4] START round=22 head_norm_before_train=1.972579 (no previous merge yet)
[S4] round=22 local utility u=0.029875 metrics={'f1_val': 0.9542417313140941, 'auprc': 0.9530343652388952, 'loss_val': 0.3006152440571727, 'psi': 0.9537587848840146}-{'f1_val': 0.9498600277059948, 'auprc': 0.941425710138295, 'loss_val': 0.2992485579714864, 'psi': 0.9464863006789148}
[S5] START round=22 head_norm_before_train=1.312509 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.5615019429521073, 'auprc': 0.8063850843929817, 'loss_val': 0.6644103984166538, 'psi': 0.6594551995284571}-{'f1_val': 0.7003213174339138, 'auprc': 0.9847800494289516, 'loss_val': 0.28507285599409266, 'psi': 0.8141048102319288}
[S6] START round=22 head_norm_before_train=1.483764 cos_to_last_merge=0.8227 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5797942967573155, 'auprc': 0.863635491125449, 'loss_val': 0.9403615949525057, 'psi': 0.6933307745045689}-{'f1_val': 0.8493556847531, 'auprc': 0.9565961580049861, 'loss_val': 0.4993148058910913, 'psi': 0.8922518740538544}
[S7] START round=22 head_norm_before_train=1.311942 cos_to_last_merge=0.8606 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=22 local utility u=0.262853 metrics={'f1_val': 0.4578695417954128, 'auprc': 0.6297837841284318, 'loss_val': 0.9202802778738852, 'psi': 0.5266352387286204}-{'f1_val': 0.3975138866311348, 'auprc': 0.6186677405219925, 'loss_val': 1.0505047822473657, 'psi': 0.48597542818747785}
[S8] START round=22 head_norm_before_train=0.998509 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.022989 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9973762366137227, 'loss_val': 0.16937960826764692, 'psi': 0.9953456363985971}-{'f1_val': 0.9943590272655265, 'auprc': 0.9956762830907544, 'loss_val': 0.21246037836281254, 'psi': 0.9948859295956177}
[S9] START round=22 head_norm_before_train=1.368982 cos_to_last_merge=0.9993 (last merge round=20)
[S9] round=22 local utility u=0.003063 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9982144168595364, 'loss_val': 0.08519622446164188, 'psi': 0.9956316310794862}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982874351740082, 'loss_val': 0.10804652138948839, 'psi': 0.9973112811579381}
[S10] START round=22 head_norm_before_train=2.017312 (no previous merge yet)
[S10] round=22 local utility u=0.001412 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951588577943007, 'loss_val': 0.030936706761147483, 'psi': 0.9952574154559585}-{'f1_val': 0.9953231205637304, 'auprc': 0.9948435364448711, 'loss_val': 0.032815172339220204, 'psi': 0.9951312869161866}
[S11] START round=22 head_norm_before_train=1.973716 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.001213 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9990207442196226, 'loss_val': 0.062372170721375894, 'psi': 0.9976417494367582}-{'f1_val': 0.9967224195815153, 'auprc': 0.9990202363336734, 'loss_val': 0.06479672075549904, 'psi': 0.9976415462823787}
[S13] START round=22 head_norm_before_train=1.739533 (no previous merge yet)
[S13] round=22 local utility u=0.034068 metrics={'f1_val': 0.6070824562701643, 'auprc': 0.7330519872061148, 'loss_val': 0.7011187015278354, 'psi': 0.6574702686445445}-{'f1_val': 0.5913484467211307, 'auprc': 0.7785314262158032, 'loss_val': 0.8112885317664765, 'psi': 0.6662216385189997}
[S14] START round=22 head_norm_before_train=1.118668 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.994561072857577, 'auprc': 0.9985490620135034, 'loss_val': 0.22247879156290512, 'psi': 0.9961562685199475}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969144103438774, 'loss_val': 0.1746279612618815, 'psi': 0.9970786853396649}
[S15] START round=22 head_norm_before_train=1.286472 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7045598248440215, 'auprc': 0.8947010858968794, 'loss_val': 0.4154269557667575, 'psi': 0.7806163292651647}-{'f1_val': 0.8356736896788202, 'auprc': 0.9891583016001193, 'loss_val': 0.22986968922371206, 'psi': 0.8970675344473398}
[S16] START round=22 head_norm_before_train=1.048946 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8282733715183079, 'auprc': 0.9316422073168661, 'loss_val': 0.8141509025358598, 'psi': 0.8696209058377312}-{'f1_val': 0.9342722353353968, 'auprc': 0.9864223283690443, 'loss_val': 0.4315843215533886, 'psi': 0.9551322725488558}
[S17] START round=22 head_norm_before_train=1.598512 cos_to_last_merge=0.8075 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.7059693014849725, 'auprc': 0.8602652034541781, 'loss_val': 0.8334196428309775, 'psi': 0.7676876622726547}-{'f1_val': 0.7090655843767278, 'auprc': 0.8589990543607819, 'loss_val': 0.7591875054903521, 'psi': 0.7690389723703495}
[S4] not sending this round → trigger blocked (psi=0.954)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.657)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.732)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S9] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.4772
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.6648
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.9278
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7525 head_norm=1.305732
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.723229e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7430 head_norm=1.130059 delta_norm=0.672323
[S3] aggregate: ROLLBACK (f1_val pre=0.753 post=0.743 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9939 head_norm=1.408960
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.311093e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9939 head_norm=1.362751 delta_norm=0.131109
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.240517 cos_to_last_merge=0.9986 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.5695942131826324, 'auprc': 0.6260337469587727, 'loss_val': 0.9770354495596332, 'psi': 0.5921700266930885}-{'f1_val': 0.7109326503049432, 'auprc': 0.7640763576086212, 'loss_val': 0.4716008417912259, 'psi': 0.7321901332264145}
[S3] START round=23 head_norm_before_train=1.130059 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.631924 metrics={'f1_val': 0.9118618578607307, 'auprc': 0.9998769957454219, 'loss_val': 0.4288564335011923, 'psi': 0.9470679130146071}-{'f1_val': 0.7525045441160814, 'auprc': 0.9346845934227201, 'loss_val': 0.5409830867957369, 'psi': 0.8253765638387369}
[S4] START round=23 head_norm_before_train=1.978893 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9464346545616024, 'auprc': 0.9497953509211232, 'loss_val': 0.2980648348560793, 'psi': 0.9477789331054107}-{'f1_val': 0.9542417313140941, 'auprc': 0.9530343652388952, 'loss_val': 0.3006152440571727, 'psi': 0.9537587848840146}
[S5] START round=23 head_norm_before_train=1.332632 cos_to_last_merge=0.9998 (last merge round=21)
[S5] round=23 local utility u=0.638755 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8610126733346067, 'loss_val': 0.3836944613888528, 'psi': 0.7645974284286581}-{'f1_val': 0.5615019429521073, 'auprc': 0.8063850843929817, 'loss_val': 0.6644103984166538, 'psi': 0.6594551995284571}
[S6] START round=23 head_norm_before_train=1.497116 cos_to_last_merge=0.8220 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.8254080771131618, 'auprc': 0.9532989571062455, 'loss_val': 0.47699630254552483, 'psi': 0.8765644291103953}-{'f1_val': 0.5797942967573155, 'auprc': 0.863635491125449, 'loss_val': 0.9403615949525057, 'psi': 0.6933307745045689}
[S7] START round=23 head_norm_before_train=1.324072 cos_to_last_merge=0.8578 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=23 local utility u=0.179041 metrics={'f1_val': 0.4983750571095031, 'auprc': 0.6464055098294182, 'loss_val': 0.8550971103390627, 'psi': 0.5575872381974691}-{'f1_val': 0.4578695417954128, 'auprc': 0.6297837841284318, 'loss_val': 0.9202802778738852, 'psi': 0.5266352387286204}
[S8] START round=23 head_norm_before_train=1.096306 cos_to_last_merge=0.9945 (last merge round=21)
[S8] round=23 local utility u=0.027935 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9984719198465654, 'loss_val': 0.11679684408850805, 'psi': 0.9957839096917342}-{'f1_val': 0.9939919029218467, 'auprc': 0.9973762366137227, 'loss_val': 0.16937960826764692, 'psi': 0.9953456363985971}
[S9] START round=23 head_norm_before_train=1.362751 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.998107683793781, 'loss_val': 0.09522981748865882, 'psi': 0.9958570670352026}-{'f1_val': 0.993909773892786, 'auprc': 0.9982144168595364, 'loss_val': 0.08519622446164188, 'psi': 0.9956316310794862}
[S10] START round=23 head_norm_before_train=2.029362 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9948307489409289, 'loss_val': 0.0320982961926594, 'psi': 0.9951261719146098}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951588577943007, 'loss_val': 0.030936706761147483, 'psi': 0.9952574154559585}
[S11] START round=23 head_norm_before_train=1.987447 cos_to_last_merge=0.9999 (last merge round=21)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9527599045231243, 'auprc': 0.9996305631160398, 'loss_val': 0.12066324341035949, 'psi': 0.9715081679602905}-{'f1_val': 0.9967224195815153, 'auprc': 0.9990207442196226, 'loss_val': 0.062372170721375894, 'psi': 0.9976417494367582}
[S13] START round=23 head_norm_before_train=1.750052 (no previous merge yet)
[S13] round=23 local utility u=0.278231 metrics={'f1_val': 0.6815823132777864, 'auprc': 0.7886970893090517, 'loss_val': 0.7585908282744916, 'psi': 0.7244282236902926}-{'f1_val': 0.6070824562701643, 'auprc': 0.7330519872061148, 'loss_val': 0.7011187015278354, 'psi': 0.6574702686445445}
[S14] START round=23 head_norm_before_train=1.166827 cos_to_last_merge=0.9979 (last merge round=21)
[S14] round=23 local utility u=0.033187 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9968945190660343, 'loss_val': 0.16690353961484225, 'psi': 0.9970707288285278}-{'f1_val': 0.994561072857577, 'auprc': 0.9985490620135034, 'loss_val': 0.22247879156290512, 'psi': 0.9961562685199475}
[S15] START round=23 head_norm_before_train=1.343555 cos_to_last_merge=0.9987 (last merge round=21)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9915886459486265, 'auprc': 0.9925123181561545, 'loss_val': 0.09097239948144582, 'psi': 0.9919581148316378}-{'f1_val': 0.7045598248440215, 'auprc': 0.8947010858968794, 'loss_val': 0.4154269557667575, 'psi': 0.7806163292651647}
[S16] START round=23 head_norm_before_train=1.098375 cos_to_last_merge=0.9976 (last merge round=21)
[S16] round=23 local utility u=0.606924 metrics={'f1_val': 0.9287688285557727, 'auprc': 0.9880859436341709, 'loss_val': 0.37260772450768614, 'psi': 0.952495674587132}-{'f1_val': 0.8282733715183079, 'auprc': 0.9316422073168661, 'loss_val': 0.8141509025358598, 'psi': 0.8696209058377312}
[S17] START round=23 head_norm_before_train=1.626542 cos_to_last_merge=0.8052 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=23 local utility u=0.279796 metrics={'f1_val': 0.7685041369629304, 'auprc': 0.8825447381823414, 'loss_val': 0.715874821712206, 'psi': 0.8141203774506949}-{'f1_val': 0.7059693014849725, 'auprc': 0.8602652034541781, 'loss_val': 0.8334196428309775, 'psi': 0.7676876622726547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.558)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:49314
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9417
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0403
[S10] DROPPED delta from S13 (cos=-0.0403 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.6261
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.8260
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.5459
[S2] RECEIVED delta(kind=head bytes=1803) from S3
[S2] cosine check vs S3: cos=0.9467
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] cosine check vs S16: cos=0.9488
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=0.6439
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9940 head_norm=1.184793
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.541799e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9940 head_norm=1.072844 delta_norm=0.254180
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.5696 head_norm=1.282706
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.074204e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.5688 head_norm=1.212697 delta_norm=0.207420
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9972 head_norm=1.219299
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.926192e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9972 head_norm=1.172337 delta_norm=0.192619
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9119 head_norm=1.175577
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.341182e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9045 head_norm=1.285219 delta_norm=0.634118
[S3] aggregate: ROLLBACK (f1_val pre=0.912 post=0.905 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=1.350885
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.362108e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=1.355455 delta_norm=0.236211
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9288 head_norm=1.155968
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.490578e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9292 head_norm=1.130978 delta_norm=0.549058
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.212697 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.454508 metrics={'f1_val': 0.6209580029574937, 'auprc': 0.7264968862729525, 'loss_val': 0.6775912212757743, 'psi': 0.6631735562836771}-{'f1_val': 0.5695942131826324, 'auprc': 0.6260337469587727, 'loss_val': 0.9770354495596332, 'psi': 0.5921700266930885}
[S3] START round=24 head_norm_before_train=1.285219 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.44384903121984826, 'auprc': 0.7788308674461087, 'loss_val': 0.7832088204815052, 'psi': 0.5778417657103525}-{'f1_val': 0.9118618578607307, 'auprc': 0.9998769957454219, 'loss_val': 0.4288564335011923, 'psi': 0.9470679130146071}
[S4] START round=24 head_norm_before_train=1.987725 (no previous merge yet)
[S4] round=24 local utility u=0.012979 metrics={'f1_val': 0.9504418241758112, 'auprc': 0.9513765051572649, 'loss_val': 0.3008935521720354, 'psi': 0.9508156965683927}-{'f1_val': 0.9464346545616024, 'auprc': 0.9497953509211232, 'loss_val': 0.2980648348560793, 'psi': 0.9477789331054107}
[S5] START round=24 head_norm_before_train=1.355455 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.227270 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9830837607562105, 'loss_val': 0.2953716658362847, 'psi': 0.8134262947628325}-{'f1_val': 0.700320598491359, 'auprc': 0.8610126733346067, 'loss_val': 0.3836944613888528, 'psi': 0.7645974284286581}
[S6] START round=24 head_norm_before_train=1.514401 cos_to_last_merge=0.8198 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=24 local utility u=0.099394 metrics={'f1_val': 0.8663253433609007, 'auprc': 0.950524054670096, 'loss_val': 0.5153870195156451, 'psi': 0.9000048278845788}-{'f1_val': 0.8254080771131618, 'auprc': 0.9532989571062455, 'loss_val': 0.47699630254552483, 'psi': 0.8765644291103953}
[S7] START round=24 head_norm_before_train=1.339710 cos_to_last_merge=0.8544 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=24 local utility u=0.855992 metrics={'f1_val': 0.639547574749187, 'auprc': 0.8254569672434731, 'loss_val': 0.5273031995292516, 'psi': 0.7139113317469015}-{'f1_val': 0.4983750571095031, 'auprc': 0.6464055098294182, 'loss_val': 0.8550971103390627, 'psi': 0.5575872381974691}
[S8] START round=24 head_norm_before_train=1.072844 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9990837659179246, 'loss_val': 0.13645257167582017, 'psi': 0.9957612655735978}-{'f1_val': 0.9939919029218467, 'auprc': 0.9984719198465654, 'loss_val': 0.11679684408850805, 'psi': 0.9957839096917342}
[S9] START round=24 head_norm_before_train=1.395618 cos_to_last_merge=0.9995 (last merge round=22)
[S9] round=24 local utility u=0.015365 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9982704263718335, 'loss_val': 0.07730889948284855, 'psi': 0.997154281949066}-{'f1_val': 0.994356655862817, 'auprc': 0.998107683793781, 'loss_val': 0.09522981748865882, 'psi': 0.9958570670352026}
[S10] START round=24 head_norm_before_train=2.045199 (no previous merge yet)
[S10] round=24 local utility u=0.000608 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9949169670730549, 'loss_val': 0.031141880698816793, 'psi': 0.9951606591674602}-{'f1_val': 0.9953231205637304, 'auprc': 0.9948307489409289, 'loss_val': 0.0320982961926594, 'psi': 0.9951261719146098}
[S11] START round=24 head_norm_before_train=1.999789 cos_to_last_merge=0.9998 (last merge round=21)
[S11] round=24 local utility u=0.164231 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990277622853188, 'loss_val': 0.051687190892590454, 'psi': 0.9973965556843487}-{'f1_val': 0.9527599045231243, 'auprc': 0.9996305631160398, 'loss_val': 0.12066324341035949, 'psi': 0.9715081679602905}
[S13] START round=24 head_norm_before_train=1.758309 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6033500574688813, 'auprc': 0.758972931884376, 'loss_val': 0.7927968786916567, 'psi': 0.6655992072350791}-{'f1_val': 0.6815823132777864, 'auprc': 0.7886970893090517, 'loss_val': 0.7585908282744916, 'psi': 0.7244282236902926}
[S14] START round=24 head_norm_before_train=1.172337 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9982733360302964, 'loss_val': 0.19516945524459822, 'psi': 0.9977542961131539}-{'f1_val': 0.9971882020035234, 'auprc': 0.9968945190660343, 'loss_val': 0.16690353961484225, 'psi': 0.9970707288285278}
[S15] START round=24 head_norm_before_train=1.400435 cos_to_last_merge=0.9955 (last merge round=21)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7752476661488517, 'auprc': 0.9240863270276144, 'loss_val': 0.36957149883603074, 'psi': 0.8347831305003568}-{'f1_val': 0.9915886459486265, 'auprc': 0.9925123181561545, 'loss_val': 0.09097239948144582, 'psi': 0.9919581148316378}
[S16] START round=24 head_norm_before_train=1.130978 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.242963 metrics={'f1_val': 0.9877976042040338, 'auprc': 0.9897549746205733, 'loss_val': 0.24586125495284553, 'psi': 0.9885805523706496}-{'f1_val': 0.9287688285557727, 'auprc': 0.9880859436341709, 'loss_val': 0.37260772450768614, 'psi': 0.952495674587132}
[S17] START round=24 head_norm_before_train=1.651002 cos_to_last_merge=0.8019 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.692470784554117, 'auprc': 0.8582593446711257, 'loss_val': 0.8968742006137975, 'psi': 0.7587862086009205}-{'f1_val': 0.7685041369629304, 'auprc': 0.8825447381823414, 'loss_val': 0.715874821712206, 'psi': 0.8141203774506949}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.9252
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.8727
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9980
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.6665
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.8822
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.9254
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.4959
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=-0.0324
[S15] DROPPED delta from S11 (cos=-0.0324 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.4964
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9974 head_norm=1.214559
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.030470e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9974 head_norm=1.160954 delta_norm=0.303047
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9935 head_norm=1.153448
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.757392e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9925 head_norm=1.229310 delta_norm=0.575739
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.4438 head_norm=1.324813
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.722549e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.4863 head_norm=1.158580 delta_norm=0.672255
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9878 head_norm=1.184968
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.384491e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9874 head_norm=1.091761 delta_norm=0.238449
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9964 head_norm=1.425758
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.591813e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.712176 delta_norm=0.459181
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9963 head_norm=2.011129
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.367970e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9963 head_norm=2.004730 delta_norm=0.063680
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7752 head_norm=1.449893
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.782692e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7751 head_norm=1.327879 delta_norm=0.278269
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.256663 cos_to_last_merge=0.9990 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.5718168615554315, 'auprc': 0.6665560576480112, 'loss_val': 0.9864879075067805, 'psi': 0.6097125399924634}-{'f1_val': 0.6209580029574937, 'auprc': 0.7264968862729525, 'loss_val': 0.6775912212757743, 'psi': 0.6631735562836771}
[S3] START round=25 head_norm_before_train=1.158580 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=1.000000 metrics={'f1_val': 0.9200766111344407, 'auprc': 0.9945703157302976, 'loss_val': 0.3822222786710001, 'psi': 0.9498740929727835}-{'f1_val': 0.44384903121984826, 'auprc': 0.7788308674461087, 'loss_val': 0.7832088204815052, 'psi': 0.5778417657103525}
[S4] START round=25 head_norm_before_train=2.000338 (no previous merge yet)
[S4] round=25 local utility u=0.017584 metrics={'f1_val': 0.9500553903935466, 'auprc': 0.9566646251167077, 'loss_val': 0.2792720682394251, 'psi': 0.952699084282811}-{'f1_val': 0.9504418241758112, 'auprc': 0.9513765051572649, 'loss_val': 0.3008935521720354, 'psi': 0.9508156965683927}
[S5] START round=25 head_norm_before_train=1.370134 cos_to_last_merge=0.9999 (last merge round=23)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9838287012631517, 'loss_val': 0.31586497559963234, 'psi': 0.813724270965609}-{'f1_val': 0.7003213174339138, 'auprc': 0.9830837607562105, 'loss_val': 0.2953716658362847, 'psi': 0.8134262947628325}
[S6] START round=25 head_norm_before_train=1.534572 cos_to_last_merge=0.8173 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=25 local utility u=0.079130 metrics={'f1_val': 0.847570945810889, 'auprc': 0.9678563011940564, 'loss_val': 0.29659766595510983, 'psi': 0.895685087964156}-{'f1_val': 0.8663253433609007, 'auprc': 0.950524054670096, 'loss_val': 0.5153870195156451, 'psi': 0.9000048278845788}
[S7] START round=25 head_norm_before_train=1.354008 cos_to_last_merge=0.8517 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4288370171568783, 'auprc': 0.7667759143061039, 'loss_val': 0.992456990704509, 'psi': 0.5640125760165686}-{'f1_val': 0.639547574749187, 'auprc': 0.8254569672434731, 'loss_val': 0.5273031995292516, 'psi': 0.7139113317469015}
[S8] START round=25 head_norm_before_train=1.229310 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9932663098914926, 'auprc': 0.9987412501943268, 'loss_val': 0.17511704603224465, 'psi': 0.9954562860126263}-{'f1_val': 0.9935462653440466, 'auprc': 0.9990837659179246, 'loss_val': 0.13645257167582017, 'psi': 0.9957612655735978}
[S9] START round=25 head_norm_before_train=1.712176 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9964779308624198, 'loss_val': 0.07610421936422854, 'psi': 0.9911529161512442}-{'f1_val': 0.9964101856672208, 'auprc': 0.9982704263718335, 'loss_val': 0.07730889948284855, 'psi': 0.997154281949066}
[S10] START round=25 head_norm_before_train=2.062039 (no previous merge yet)
[S10] round=25 local utility u=0.002106 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954170728496264, 'loss_val': 0.028429289434797573, 'psi': 0.9953607014780887}-{'f1_val': 0.9953231205637304, 'auprc': 0.9949169670730549, 'loss_val': 0.031141880698816793, 'psi': 0.9951606591674602}
[S11] START round=25 head_norm_before_train=2.004730 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.001575 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9992964232669284, 'loss_val': 0.05182270148654712, 'psi': 0.9977520210556805}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990277622853188, 'loss_val': 0.051687190892590454, 'psi': 0.9973965556843487}
[S13] START round=25 head_norm_before_train=1.763284 (no previous merge yet)
[S13] round=25 local utility u=0.233855 metrics={'f1_val': 0.6517716472329358, 'auprc': 0.7905670795337311, 'loss_val': 0.7103993081448892, 'psi': 0.7072898201532538}-{'f1_val': 0.6033500574688813, 'auprc': 0.758972931884376, 'loss_val': 0.7927968786916567, 'psi': 0.6655992072350791}
[S14] START round=25 head_norm_before_train=1.160954 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9981212894092182, 'loss_val': 0.2098698101097253, 'psi': 0.9974431419771566}-{'f1_val': 0.9974082695017256, 'auprc': 0.9982733360302964, 'loss_val': 0.19516945524459822, 'psi': 0.9977542961131539}
[S15] START round=25 head_norm_before_train=1.327879 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6975894049252358, 'auprc': 0.8074379570083821, 'loss_val': 0.47426141540956257, 'psi': 0.7415288257584943}-{'f1_val': 0.7752476661488517, 'auprc': 0.9240863270276144, 'loss_val': 0.36957149883603074, 'psi': 0.8347831305003568}
[S16] START round=25 head_norm_before_train=1.091761 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.912143672451129, 'auprc': 0.9881354480368929, 'loss_val': 0.46687943645966273, 'psi': 0.9425403826854346}-{'f1_val': 0.9877976042040338, 'auprc': 0.9897549746205733, 'loss_val': 0.24586125495284553, 'psi': 0.9885805523706496}
[S17] START round=25 head_norm_before_train=1.677129 cos_to_last_merge=0.7984 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6493124146844914, 'auprc': 0.8327049061372944, 'loss_val': 1.1639245825395965, 'psi': 0.7226694112656127}-{'f1_val': 0.692470784554117, 'auprc': 0.8582593446711257, 'loss_val': 0.8968742006137975, 'psi': 0.7587862086009205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S3] → sending delta(kind=head bytes=1810) to S2@127.0.0.1:49302
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1810 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] cosine check vs S11: cos=-0.0225
[S15] DROPPED delta from S11 (cos=-0.0225 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9990
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9148
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.9857
[S2] RECEIVED delta(kind=head bytes=1810) from S3
[S2] cosine check vs S3: cos=0.9668
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0401
[S10] DROPPED delta from S13 (cos=-0.0401 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.283 → S3@127.0.0.1:49303
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9876 head_norm=1.737648
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.324389e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9876 head_norm=1.898985 delta_norm=0.232439
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.043 → S16@127.0.0.1:49316
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.5718 head_norm=1.304733
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.706857e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.5726 head_norm=1.236056 delta_norm=0.170686
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.214 → S15@127.0.0.1:49315
[S5] ⇄ pheromone p=0.167 → S16@127.0.0.1:49316
[S14] ⇄ pheromone p=0.055 → S8@127.0.0.1:49309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9933 head_norm=1.298899
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.175592e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9931 head_norm=1.392220 delta_norm=0.317559
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.026 → S9@127.0.0.1:49310
[S15] ⇄ pheromone p=0.252 → S5@127.0.0.1:49305
[S3] ⇄ pheromone p=0.414 → S2@127.0.0.1:49302
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=2.017720
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.495045e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=2.010326 delta_norm=0.044950
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.101 → S15@127.0.0.1:49315
[S4] ⇄ pheromone p=0.033 → S11@127.0.0.1:49312
[S10] ⇄ pheromone p=0.018 → S9@127.0.0.1:49310
[S13] ⇄ pheromone p=0.118 → S10@127.0.0.1:49311
[S6] ⇄ pheromone p=0.263 → S8@127.0.0.1:49309
[S17] ⇄ pheromone p=0.144 → S3@127.0.0.1:49303
[S16] ⇄ pheromone p=0.193 → S14@127.0.0.1:49314
[S2] START round=26 head_norm_before_train=1.236056 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.778443 metrics={'f1_val': 0.7156956153785242, 'auprc': 0.7526608790212648, 'loss_val': 0.5511897380188654, 'psi': 0.7304817208356205}-{'f1_val': 0.5718168615554315, 'auprc': 0.6665560576480112, 'loss_val': 0.9864879075067805, 'psi': 0.6097125399924634}
[S3] START round=26 head_norm_before_train=1.188112 cos_to_last_merge=0.9992 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.775286652949738, 'auprc': 0.9484913465347785, 'loss_val': 0.5147154846855128, 'psi': 0.8445685303837542}-{'f1_val': 0.9200766111344407, 'auprc': 0.9945703157302976, 'loss_val': 0.3822222786710001, 'psi': 0.9498740929727835}
[S4] START round=26 head_norm_before_train=2.003914 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9493422783995107, 'auprc': 0.9506881025720086, 'loss_val': 0.27892764227866496, 'psi': 0.9498806080685099}-{'f1_val': 0.9500553903935466, 'auprc': 0.9566646251167077, 'loss_val': 0.2792720682394251, 'psi': 0.952699084282811}
[S5] START round=26 head_norm_before_train=1.390232 cos_to_last_merge=0.9994 (last merge round=23)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8495672967900454, 'loss_val': 0.400016964641111, 'psi': 0.7600192778108336}-{'f1_val': 0.7003213174339138, 'auprc': 0.9838287012631517, 'loss_val': 0.31586497559963234, 'psi': 0.813724270965609}
[S6] START round=26 head_norm_before_train=1.546319 cos_to_last_merge=0.8160 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=26 local utility u=0.410957 metrics={'f1_val': 0.9617490517807288, 'auprc': 0.9726918383199386, 'loss_val': 0.17425877021903158, 'psi': 0.9661261663964127}-{'f1_val': 0.847570945810889, 'auprc': 0.9678563011940564, 'loss_val': 0.29659766595510983, 'psi': 0.895685087964156}
[S7] START round=26 head_norm_before_train=1.364482 cos_to_last_merge=0.8496 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.674670131193571, 'auprc': 0.8463228729559453, 'loss_val': 0.4288059974214569, 'psi': 0.7433312278985207}-{'f1_val': 0.4288370171568783, 'auprc': 0.7667759143061039, 'loss_val': 0.992456990704509, 'psi': 0.5640125760165686}
[S8] START round=26 head_norm_before_train=1.392220 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.004352 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9985238448390759, 'loss_val': 0.15915127513590754, 'psi': 0.9947083076086617}-{'f1_val': 0.9932663098914926, 'auprc': 0.9987412501943268, 'loss_val': 0.17511704603224465, 'psi': 0.9954562860126263}
[S9] START round=26 head_norm_before_train=1.898985 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.040927 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9974789600005363, 'loss_val': 0.04761159740916016, 'psi': 0.9965890572917435}-{'f1_val': 0.9876029063437939, 'auprc': 0.9964779308624198, 'loss_val': 0.07610421936422854, 'psi': 0.9911529161512442}
[S10] START round=26 head_norm_before_train=2.073866 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951879519237868, 'loss_val': 0.029456383248591612, 'psi': 0.9952690531077529}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954170728496264, 'loss_val': 0.028429289434797573, 'psi': 0.9953607014780887}
[S11] START round=26 head_norm_before_train=2.010326 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.001101 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9996394474210267, 'loss_val': 0.054583725642538175, 'psi': 0.9982826308310264}-{'f1_val': 0.9967224195815153, 'auprc': 0.9992964232669284, 'loss_val': 0.05182270148654712, 'psi': 0.9977520210556805}
[S13] START round=26 head_norm_before_train=1.770105 (no previous merge yet)
[S13] round=26 local utility u=0.069071 metrics={'f1_val': 0.6677370520128229, 'auprc': 0.8105628869970698, 'loss_val': 0.7280367399355065, 'psi': 0.7248673860065217}-{'f1_val': 0.6517716472329358, 'auprc': 0.7905670795337311, 'loss_val': 0.7103993081448892, 'psi': 0.7072898201532538}
[S14] START round=26 head_norm_before_train=1.203910 cos_to_last_merge=0.9985 (last merge round=24)
[S14] round=26 local utility u=0.026941 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9983445351355744, 'loss_val': 0.16162841358122884, 'psi': 0.9980295248345608}-{'f1_val': 0.9969910436891155, 'auprc': 0.9981212894092182, 'loss_val': 0.2098698101097253, 'psi': 0.9974431419771566}
[S15] START round=26 head_norm_before_train=1.370047 cos_to_last_merge=0.9994 (last merge round=24)
[S15] round=26 local utility u=0.064255 metrics={'f1_val': 0.6988157833113708, 'auprc': 0.8470019496241716, 'loss_val': 0.4718021850394567, 'psi': 0.7580902498364912}-{'f1_val': 0.6975894049252358, 'auprc': 0.8074379570083821, 'loss_val': 0.47426141540956257, 'psi': 0.7415288257584943}
[S16] START round=26 head_norm_before_train=1.143811 cos_to_last_merge=0.9981 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8340108763529531, 'auprc': 0.9425250349850642, 'loss_val': 0.8090772787651197, 'psi': 0.8774165398057976}-{'f1_val': 0.912143672451129, 'auprc': 0.9881354480368929, 'loss_val': 0.46687943645966273, 'psi': 0.9425403826854346}
[S17] START round=26 head_norm_before_train=1.703884 cos_to_last_merge=0.7954 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=26 local utility u=0.733642 metrics={'f1_val': 0.7832780747520959, 'auprc': 0.8769282864052983, 'loss_val': 0.6331047243639212, 'psi': 0.8207381594133769}-{'f1_val': 0.6493124146844914, 'auprc': 0.8327049061372944, 'loss_val': 1.1639245825395965, 'psi': 0.7226694112656127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=0.1031
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9674
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.0397
[S10] DROPPED delta from S13 (cos=-0.0397 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.2493
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] cosine check vs S2: cos=0.9535
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=-0.0230
[S15] DROPPED delta from S11 (cos=-0.0230 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.5217
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.8517
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9662
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.6383
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.7753 head_norm=1.220221
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.803228e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.7638 head_norm=1.189968 delta_norm=0.180323
[S3] aggregate: ROLLBACK (f1_val pre=0.775 post=0.764 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.409648
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.832770e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.398676 delta_norm=0.183277
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9960 head_norm=1.918141
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.140428e+00
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9960 head_norm=1.259661 delta_norm=1.140428
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9922 head_norm=1.447542
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.595631e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9925 head_norm=1.204678 delta_norm=0.359563
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6988 head_norm=1.411616
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.151801e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6988 head_norm=1.330210 delta_norm=0.215180
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8340 head_norm=1.195549
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.239916e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8336 head_norm=1.369430 delta_norm=0.823992
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.280180 cos_to_last_merge=0.9990 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7157856103650293, 'auprc': 0.7578383825902693, 'loss_val': 0.5689083754996804, 'psi': 0.7326067192551253}-{'f1_val': 0.7156956153785242, 'auprc': 0.7526608790212648, 'loss_val': 0.5511897380188654, 'psi': 0.7304817208356205}
[S3] START round=27 head_norm_before_train=1.189968 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.268376 metrics={'f1_val': 0.8366195138525017, 'auprc': 0.9734925620648271, 'loss_val': 0.4209638713910409, 'psi': 0.8913687331374318}-{'f1_val': 0.775286652949738, 'auprc': 0.9484913465347785, 'loss_val': 0.5147154846855128, 'psi': 0.8445685303837542}
[S4] START round=27 head_norm_before_train=2.012615 (no previous merge yet)
[S4] round=27 local utility u=0.007280 metrics={'f1_val': 0.9497511374006109, 'auprc': 0.9554102358237841, 'loss_val': 0.2809879741591391, 'psi': 0.9520147767698802}-{'f1_val': 0.9493422783995107, 'auprc': 0.9506881025720086, 'loss_val': 0.27892764227866496, 'psi': 0.9498806080685099}
[S5] START round=27 head_norm_before_train=1.398676 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.268828 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9865170905373579, 'loss_val': 0.273214543756733, 'psi': 0.8147996266752915}-{'f1_val': 0.700320598491359, 'auprc': 0.8495672967900454, 'loss_val': 0.400016964641111, 'psi': 0.7600192778108336}
[S6] START round=27 head_norm_before_train=1.565507 cos_to_last_merge=0.8143 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6263440062059263, 'auprc': 0.9552734076258447, 'loss_val': 0.7713877337897231, 'psi': 0.7579157667738936}-{'f1_val': 0.9617490517807288, 'auprc': 0.9726918383199386, 'loss_val': 0.17425877021903158, 'psi': 0.9661261663964127}
[S7] START round=27 head_norm_before_train=1.374782 cos_to_last_merge=0.8475 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6185719128276159, 'auprc': 0.7959397281399256, 'loss_val': 0.6410634170640911, 'psi': 0.6895190389525399}-{'f1_val': 0.674670131193571, 'auprc': 0.8463228729559453, 'loss_val': 0.4288059974214569, 'psi': 0.7433312278985207}
[S8] START round=27 head_norm_before_train=1.204678 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.004982 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9987956360522935, 'loss_val': 0.1478815306228042, 'psi': 0.9946048351186232}-{'f1_val': 0.9921646161217188, 'auprc': 0.9985238448390759, 'loss_val': 0.15915127513590754, 'psi': 0.9947083076086617}
[S9] START round=27 head_norm_before_train=1.259661 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9914249079028262, 'auprc': 0.9980798156900633, 'loss_val': 0.13563901427140262, 'psi': 0.9940868710177211}-{'f1_val': 0.9959957888192151, 'auprc': 0.9974789600005363, 'loss_val': 0.04761159740916016, 'psi': 0.9965890572917435}
[S10] START round=27 head_norm_before_train=2.084748 (no previous merge yet)
[S10] round=27 local utility u=0.001013 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9953729754717616, 'loss_val': 0.027985286119338437, 'psi': 0.9953430625269428}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951879519237868, 'loss_val': 0.029456383248591612, 'psi': 0.9952690531077529}
[S11] START round=27 head_norm_before_train=2.025681 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=27 local utility u=0.003636 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9992939462130581, 'loss_val': 0.04234042853702564, 'psi': 0.9977510302341325}-{'f1_val': 0.9973780864376928, 'auprc': 0.9996394474210267, 'loss_val': 0.054583725642538175, 'psi': 0.9982826308310264}
[S13] START round=27 head_norm_before_train=1.785887 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6227762958707078, 'auprc': 0.7857244603486069, 'loss_val': 0.8121796402519506, 'psi': 0.6879555616618674}-{'f1_val': 0.6677370520128229, 'auprc': 0.8105628869970698, 'loss_val': 0.7280367399355065, 'psi': 0.7248673860065217}
[S14] START round=27 head_norm_before_train=1.251917 cos_to_last_merge=0.9944 (last merge round=24)
[S14] round=27 local utility u=0.014929 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9966984308561276, 'loss_val': 0.1268317987665937, 'psi': 0.9973710831227821}-{'f1_val': 0.9978195179672185, 'auprc': 0.9983445351355744, 'loss_val': 0.16162841358122884, 'psi': 0.9980295248345608}
[S15] START round=27 head_norm_before_train=1.330210 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9859700537828631, 'auprc': 0.9955993891752473, 'loss_val': 0.12544383970659015, 'psi': 0.9898217879398168}-{'f1_val': 0.6988157833113708, 'auprc': 0.8470019496241716, 'loss_val': 0.4718021850394567, 'psi': 0.7580902498364912}
[S16] START round=27 head_norm_before_train=1.369430 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.227932 metrics={'f1_val': 0.8621191288925663, 'auprc': 0.9707660139156675, 'loss_val': 0.6065856198890944, 'psi': 0.9055778829018067}-{'f1_val': 0.8340108763529531, 'auprc': 0.9425250349850642, 'loss_val': 0.8090772787651197, 'psi': 0.8774165398057976}
[S17] START round=27 head_norm_before_train=1.718090 cos_to_last_merge=0.7940 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.683813483362703, 'auprc': 0.8547730921222072, 'loss_val': 0.9940807318138367, 'psi': 0.7521973268665048}-{'f1_val': 0.7832780747520959, 'auprc': 0.8769282864052983, 'loss_val': 0.6331047243639212, 'psi': 0.8207381594133769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.990)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S11] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=0.7990
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.3636
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9987
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.7855
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9767
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9978 head_norm=1.298012
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.320284e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.283246 delta_norm=0.432028
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9914 head_norm=1.285428
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.740371e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9918 head_norm=1.604004 delta_norm=0.674037
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9967 head_norm=2.043422
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.203438e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9967 head_norm=2.033532 delta_norm=0.052034
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7158 head_norm=1.330462
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.482916e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.7157 head_norm=1.267910 delta_norm=0.148292
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8621 head_norm=1.407800
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.967855e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8612 head_norm=1.166358 delta_norm=0.796786
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.267910 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.022282 metrics={'f1_val': 0.7155309792244248, 'auprc': 0.7608595174510225, 'loss_val': 0.5318796803211423, 'psi': 0.7336623945150639}-{'f1_val': 0.7157856103650293, 'auprc': 0.7578383825902693, 'loss_val': 0.5689083754996804, 'psi': 0.7326067192551253}
[S3] START round=28 head_norm_before_train=1.220262 cos_to_last_merge=0.9994 (last merge round=26)
[S3] round=28 local utility u=0.338780 metrics={'f1_val': 0.9187848144946009, 'auprc': 0.996255624125603, 'loss_val': 0.30468506678296775, 'psi': 0.9497731383470018}-{'f1_val': 0.8366195138525017, 'auprc': 0.9734925620648271, 'loss_val': 0.4209638713910409, 'psi': 0.8913687331374318}
[S4] START round=28 head_norm_before_train=2.024932 (no previous merge yet)
[S4] round=28 local utility u=0.005132 metrics={'f1_val': 0.9516484082821206, 'auprc': 0.955501264374418, 'loss_val': 0.28238039238270995, 'psi': 0.9531895507190395}-{'f1_val': 0.9497511374006109, 'auprc': 0.9554102358237841, 'loss_val': 0.2809879741591391, 'psi': 0.9520147767698802}
[S5] START round=28 head_norm_before_train=1.417256 cos_to_last_merge=0.9998 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7001068319244501, 'auprc': 0.9702771171537707, 'loss_val': 0.30560742791809853, 'psi': 0.8081749460161785}-{'f1_val': 0.7003213174339138, 'auprc': 0.9865170905373579, 'loss_val': 0.273214543756733, 'psi': 0.8147996266752915}
[S6] START round=28 head_norm_before_train=1.579021 cos_to_last_merge=0.8134 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.9433050727181262, 'auprc': 0.9632067060925713, 'loss_val': 0.26330046462938217, 'psi': 0.9512657260679043}-{'f1_val': 0.6263440062059263, 'auprc': 0.9552734076258447, 'loss_val': 0.7713877337897231, 'psi': 0.7579157667738936}
[S7] START round=28 head_norm_before_train=1.384547 cos_to_last_merge=0.8456 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=28 local utility u=0.247010 metrics={'f1_val': 0.6562611480353541, 'auprc': 0.8300567674719809, 'loss_val': 0.4755299456906724, 'psi': 0.7257793958100048}-{'f1_val': 0.6185719128276159, 'auprc': 0.7959397281399256, 'loss_val': 0.6410634170640911, 'psi': 0.6895190389525399}
[S8] START round=28 head_norm_before_train=1.283289 cos_to_last_merge=0.9956 (last merge round=26)
[S8] round=28 local utility u=0.009243 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9866634308581804, 'loss_val': 0.09736137959823506, 'psi': 0.9901882070925734}-{'f1_val': 0.9918109678295097, 'auprc': 0.9987956360522935, 'loss_val': 0.1478815306228042, 'psi': 0.9946048351186232}
[S9] START round=28 head_norm_before_train=1.604004 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.036733 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9979391396620709, 'loss_val': 0.06829420318771083, 'psi': 0.9946849365869626}-{'f1_val': 0.9914249079028262, 'auprc': 0.9980798156900633, 'loss_val': 0.13563901427140262, 'psi': 0.9940868710177211}
[S10] START round=28 head_norm_before_train=2.098091 (no previous merge yet)
[S10] round=28 local utility u=0.000534 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954134563859243, 'loss_val': 0.027038227338742588, 'psi': 0.9953592548926079}-{'f1_val': 0.9953231205637304, 'auprc': 0.9953729754717616, 'loss_val': 0.027985286119338437, 'psi': 0.9953430625269428}
[S11] START round=28 head_norm_before_train=2.033532 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9966557483747401, 'auprc': 0.9994774159305139, 'loss_val': 0.052302301704919674, 'psi': 0.9977844153970497}-{'f1_val': 0.9967224195815153, 'auprc': 0.9992939462130581, 'loss_val': 0.04234042853702564, 'psi': 0.9977510302341325}
[S13] START round=28 head_norm_before_train=1.798111 (no previous merge yet)
[S13] round=28 local utility u=0.071122 metrics={'f1_val': 0.6350142762483488, 'auprc': 0.8226599647194098, 'loss_val': 0.8541697311588308, 'psi': 0.7100725516367732}-{'f1_val': 0.6227762958707078, 'auprc': 0.7857244603486069, 'loss_val': 0.8121796402519506, 'psi': 0.6879555616618674}
[S14] START round=28 head_norm_before_train=1.283246 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9944249821366621, 'auprc': 0.9966845649583747, 'loss_val': 0.16055333690155366, 'psi': 0.9953288152653471}-{'f1_val': 0.9978195179672185, 'auprc': 0.9966984308561276, 'loss_val': 0.1268317987665937, 'psi': 0.9973710831227821}
[S15] START round=28 head_norm_before_train=1.378373 cos_to_last_merge=0.9991 (last merge round=26)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7727050911592781, 'auprc': 0.9896532695195526, 'loss_val': 0.3743151506614066, 'psi': 0.8594843625033879}-{'f1_val': 0.9859700537828631, 'auprc': 0.9955993891752473, 'loss_val': 0.12544383970659015, 'psi': 0.9898217879398168}
[S16] START round=28 head_norm_before_train=1.166358 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.554066 metrics={'f1_val': 0.9765209936965915, 'auprc': 0.9870240438885779, 'loss_val': 0.23363857816943556, 'psi': 0.9807222137733861}-{'f1_val': 0.8621191288925663, 'auprc': 0.9707660139156675, 'loss_val': 0.6065856198890944, 'psi': 0.9055778829018067}
[S17] START round=28 head_norm_before_train=1.730826 cos_to_last_merge=0.7937 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6673640291595667, 'auprc': 0.8437127213002982, 'loss_val': 1.1477604269697756, 'psi': 0.7379035060158593}-{'f1_val': 0.683813483362703, 'auprc': 0.8547730921222072, 'loss_val': 0.9940807318138367, 'psi': 0.7521973268665048}
[S16] not sending this round → trigger blocked (psi=0.981)
[S4] not sending this round → trigger blocked (psi=0.953)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:49303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → trigger blocked (psi=0.950)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.5469
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.8782
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.3929
[S3] RECEIVED delta(kind=head bytes=1808) from S7
[S3] cosine check vs S7: cos=0.7725
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0386
[S10] DROPPED delta from S13 (cos=-0.0386 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.9708
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9188 head_norm=1.251128
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.519881e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9161 head_norm=1.246980 delta_norm=0.451988
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7727 head_norm=1.430124
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.761752e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7727 head_norm=1.359133 delta_norm=0.176175
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9925 head_norm=1.633044
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.318464e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9923 head_norm=1.250160 delta_norm=0.831846
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9925 head_norm=1.357537
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.799321e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9925 head_norm=1.427089 delta_norm=0.379932
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9765 head_norm=1.214381
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.022319e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9742 head_norm=1.256045 delta_norm=0.702232
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.308169 cos_to_last_merge=0.9993 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6176139672487957, 'auprc': 0.7278505027053417, 'loss_val': 0.7148461913491845, 'psi': 0.6617085814314141}-{'f1_val': 0.7155309792244248, 'auprc': 0.7608595174510225, 'loss_val': 0.5318796803211423, 'psi': 0.7336623945150639}
[S3] START round=29 head_norm_before_train=1.246980 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8282002060774343, 'auprc': 0.9821104807227918, 'loss_val': 0.5228672863132506, 'psi': 0.8897643159355773}-{'f1_val': 0.9187848144946009, 'auprc': 0.996255624125603, 'loss_val': 0.30468506678296775, 'psi': 0.9497731383470018}
[S4] START round=29 head_norm_before_train=2.035238 (no previous merge yet)
[S4] round=29 local utility u=0.037262 metrics={'f1_val': 0.9551601612617575, 'auprc': 0.9749767275074037, 'loss_val': 0.2873523043194076, 'psi': 0.963086787760016}-{'f1_val': 0.9516484082821206, 'auprc': 0.955501264374418, 'loss_val': 0.28238039238270995, 'psi': 0.9531895507190395}
[S5] START round=29 head_norm_before_train=1.433517 cos_to_last_merge=0.9992 (last merge round=26)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.630197426945683, 'auprc': 0.9308493891876248, 'loss_val': 0.3833891886085508, 'psi': 0.7504582118424598}-{'f1_val': 0.7001068319244501, 'auprc': 0.9702771171537707, 'loss_val': 0.30560742791809853, 'psi': 0.8081749460161785}
[S6] START round=29 head_norm_before_train=1.587123 cos_to_last_merge=0.8131 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8127248631276931, 'auprc': 0.9417275504680975, 'loss_val': 0.46409761489608764, 'psi': 0.8643259380638548}-{'f1_val': 0.9433050727181262, 'auprc': 0.9632067060925713, 'loss_val': 0.26330046462938217, 'psi': 0.9512657260679043}
[S7] START round=29 head_norm_before_train=1.397564 cos_to_last_merge=0.8438 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.4105495070535044, 'auprc': 0.7786672144125798, 'loss_val': 1.0589580002382686, 'psi': 0.5577965899971346}-{'f1_val': 0.6562611480353541, 'auprc': 0.8300567674719809, 'loss_val': 0.4755299456906724, 'psi': 0.7257793958100048}
[S8] START round=29 head_norm_before_train=1.427089 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.006679 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.9986041726181779, 'loss_val': 0.11461590764456953, 'psi': 0.9944435646342652}-{'f1_val': 0.9925380579155019, 'auprc': 0.9866634308581804, 'loss_val': 0.09736137959823506, 'psi': 0.9901882070925734}
[S9] START round=29 head_norm_before_train=1.250160 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9981824975365357, 'loss_val': 0.1358473885100865, 'psi': 0.9942781400082414}-{'f1_val': 0.9925154678702236, 'auprc': 0.9979391396620709, 'loss_val': 0.06829420318771083, 'psi': 0.9946849365869626}
[S10] START round=29 head_norm_before_train=2.111940 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.995366534102827, 'loss_val': 0.02748563459943508, 'psi': 0.9953404859793691}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954134563859243, 'loss_val': 0.027038227338742588, 'psi': 0.9953592548926079}
[S11] START round=29 head_norm_before_train=2.049121 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.007547 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9992616458227211, 'loss_val': 0.036961363957357864, 'psi': 0.9977381100779976}-{'f1_val': 0.9966557483747401, 'auprc': 0.9994774159305139, 'loss_val': 0.052302301704919674, 'psi': 0.9977844153970497}
[S13] START round=29 head_norm_before_train=1.807822 (no previous merge yet)
[S13] round=29 local utility u=0.130320 metrics={'f1_val': 0.674448922291671, 'auprc': 0.7878246538146485, 'loss_val': 0.7256316072085377, 'psi': 0.7197992149008621}-{'f1_val': 0.6350142762483488, 'auprc': 0.8226599647194098, 'loss_val': 0.8541697311588308, 'psi': 0.7100725516367732}
[S14] START round=29 head_norm_before_train=1.324374 cos_to_last_merge=0.9988 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9558726245548859, 'auprc': 0.9985354689435926, 'loss_val': 0.14306021593688167, 'psi': 0.9729377623103685}-{'f1_val': 0.9944249821366621, 'auprc': 0.9966845649583747, 'loss_val': 0.16055333690155366, 'psi': 0.9953288152653471}
[S15] START round=29 head_norm_before_train=1.359133 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6951377261032485, 'auprc': 0.9512466983772294, 'loss_val': 0.4888465862313094, 'psi': 0.7975813150128408}-{'f1_val': 0.7727050911592781, 'auprc': 0.9896532695195526, 'loss_val': 0.3743151506614066, 'psi': 0.8594843625033879}
[S16] START round=29 head_norm_before_train=1.256045 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.013535 metrics={'f1_val': 0.9875420803595296, 'auprc': 0.9870558311850004, 'loss_val': 0.2727906156238121, 'psi': 0.9873475806897178}-{'f1_val': 0.9765209936965915, 'auprc': 0.9870240438885779, 'loss_val': 0.23363857816943556, 'psi': 0.9807222137733861}
[S17] START round=29 head_norm_before_train=1.754829 cos_to_last_merge=0.7919 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=29 local utility u=0.783998 metrics={'f1_val': 0.8098463064301872, 'auprc': 0.8971415659697088, 'loss_val': 0.594943681282654, 'psi': 0.8447644102459959}-{'f1_val': 0.6673640291595667, 'auprc': 0.8437127213002982, 'loss_val': 1.1477604269697756, 'psi': 0.7379035060158593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:49314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=-0.0156
[S15] DROPPED delta from S11 (cos=-0.0156 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9988
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.7119
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0377
[S10] DROPPED delta from S13 (cos=-0.0377 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] cosine check vs S16: cos=0.9353
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.4772
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.8282 head_norm=1.273940
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.050669e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.7902 head_norm=1.311993 delta_norm=0.805067
[S3] aggregate: ROLLBACK (f1_val pre=0.828 post=0.790 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9917 head_norm=1.281874
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.327386e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9914 head_norm=1.279274 delta_norm=0.532739
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9559 head_norm=1.358526
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.408032e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9530 head_norm=1.307323 delta_norm=0.240803
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9967 head_norm=2.064045
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.128285e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9967 head_norm=2.052489 delta_norm=0.051283
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.345511 cos_to_last_merge=0.9977 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.5978788585441133, 'auprc': 0.7237847447410822, 'loss_val': 0.8151160996456246, 'psi': 0.6482412130229008}-{'f1_val': 0.6176139672487957, 'auprc': 0.7278505027053417, 'loss_val': 0.7148461913491845, 'psi': 0.6617085814314141}
[S3] START round=30 head_norm_before_train=1.311993 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.399622 metrics={'f1_val': 0.9131422630162822, 'auprc': 0.9999900953695317, 'loss_val': 0.28691373384882346, 'psi': 0.947881395957582}-{'f1_val': 0.8282002060774343, 'auprc': 0.9821104807227918, 'loss_val': 0.5228672863132506, 'psi': 0.8897643159355773}
[S4] START round=30 head_norm_before_train=2.042156 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9494663164682662, 'auprc': 0.9797744282716355, 'loss_val': 0.2771048392593342, 'psi': 0.9615895611896139}-{'f1_val': 0.9551601612617575, 'auprc': 0.9749767275074037, 'loss_val': 0.2873523043194076, 'psi': 0.963086787760016}
[S5] START round=30 head_norm_before_train=1.448205 cos_to_last_merge=0.9986 (last merge round=26)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6600545964759654, 'auprc': 0.8638223266961385, 'loss_val': 0.42447848456860154, 'psi': 0.7415616885640346}-{'f1_val': 0.630197426945683, 'auprc': 0.9308493891876248, 'loss_val': 0.3833891886085508, 'psi': 0.7504582118424598}
[S6] START round=30 head_norm_before_train=1.599296 cos_to_last_merge=0.8114 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.41604531394212996, 'auprc': 0.7503369444081258, 'loss_val': 1.7608488005830887, 'psi': 0.5497619661285283}-{'f1_val': 0.8127248631276931, 'auprc': 0.9417275504680975, 'loss_val': 0.46409761489608764, 'psi': 0.8643259380638548}
[S7] START round=30 head_norm_before_train=1.406595 cos_to_last_merge=0.8426 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.843
[S7] round=30 local utility u=1.000000 metrics={'f1_val': 0.6507379290592741, 'auprc': 0.8238137432528784, 'loss_val': 0.48993971852967694, 'psi': 0.7199682547367159}-{'f1_val': 0.4105495070535044, 'auprc': 0.7786672144125798, 'loss_val': 1.0589580002382686, 'psi': 0.5577965899971346}
[S8] START round=30 head_norm_before_train=1.482398 cos_to_last_merge=0.9983 (last merge round=28)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9868089304130516, 'loss_val': 0.23951384495880715, 'psi': 0.8231090883727056}-{'f1_val': 0.9916698259783234, 'auprc': 0.9986041726181779, 'loss_val': 0.11461590764456953, 'psi': 0.9944435646342652}
[S9] START round=30 head_norm_before_train=1.279274 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985549919373047, 'loss_val': 0.1893283992253572, 'psi': 0.9974183038632567}-{'f1_val': 0.9916752349893785, 'auprc': 0.9981824975365357, 'loss_val': 0.1358473885100865, 'psi': 0.9942781400082414}
[S10] START round=30 head_norm_before_train=2.119510 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951414282374169, 'loss_val': 0.02813621499461168, 'psi': 0.995250443633205}-{'f1_val': 0.9953231205637304, 'auprc': 0.995366534102827, 'loss_val': 0.02748563459943508, 'psi': 0.9953404859793691}
[S11] START round=30 head_norm_before_train=2.052489 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.001008 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992517727450219, 'loss_val': 0.03636673792499275, 'psi': 0.997879263073755}-{'f1_val': 0.9967224195815153, 'auprc': 0.9992616458227211, 'loss_val': 0.036961363957357864, 'psi': 0.9977381100779976}
[S13] START round=30 head_norm_before_train=1.817110 (no previous merge yet)
[S13] round=30 local utility u=0.368437 metrics={'f1_val': 0.7764804350707503, 'auprc': 0.8077469264461377, 'loss_val': 0.6607139492113203, 'psi': 0.7889870316209052}-{'f1_val': 0.674448922291671, 'auprc': 0.7878246538146485, 'loss_val': 0.7256316072085377, 'psi': 0.7197992149008621}
[S14] START round=30 head_norm_before_train=1.307323 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.098678 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9972485879218451, 'loss_val': 0.18741017383744005, 'psi': 0.9969796139942367}-{'f1_val': 0.9558726245548859, 'auprc': 0.9985354689435926, 'loss_val': 0.14306021593688167, 'psi': 0.9729377623103685}
[S15] START round=30 head_norm_before_train=1.407955 cos_to_last_merge=0.9989 (last merge round=28)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9939759221388862, 'auprc': 0.9954810265351688, 'loss_val': 0.06549723229543143, 'psi': 0.9945779638973992}-{'f1_val': 0.6951377261032485, 'auprc': 0.9512466983772294, 'loss_val': 0.4888465862313094, 'psi': 0.7975813150128408}
[S16] START round=30 head_norm_before_train=1.299448 cos_to_last_merge=0.9980 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8582988334426611, 'auprc': 0.9677358672047026, 'loss_val': 0.6066374890200597, 'psi': 0.9020736469474777}-{'f1_val': 0.9875420803595296, 'auprc': 0.9870558311850004, 'loss_val': 0.2727906156238121, 'psi': 0.9873475806897178}
[S17] START round=30 head_norm_before_train=1.765218 cos_to_last_merge=0.7908 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6967339813630311, 'auprc': 0.8580622715716866, 'loss_val': 0.9383025477072195, 'psi': 0.7612652974464933}-{'f1_val': 0.8098463064301872, 'auprc': 0.8971415659697088, 'loss_val': 0.594943681282654, 'psi': 0.8447644102459959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:49311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1808 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.0373
[S10] DROPPED delta from S13 (cos=-0.0373 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=-0.0160
[S15] DROPPED delta from S11 (cos=-0.0160 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1808) from S15
[S5] cosine check vs S15: cos=0.9601
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.5714
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.9265
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.2854
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.6601 head_norm=1.465785
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.065187e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.6650 head_norm=1.446347 delta_norm=0.206519
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.082 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.006 → S9@127.0.0.1:49310
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.5979 head_norm=1.379252
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.617713e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.5930 head_norm=1.338131 delta_norm=0.261771
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.137 → S15@127.0.0.1:49315
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.7140 head_norm=1.534999
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.593099e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.7140 head_norm=1.148719 delta_norm=0.859310
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.012 → S9@127.0.0.1:49310
[S6] ⇄ pheromone p=0.248 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.022 → S16@127.0.0.1:49316
[S4] ⇄ pheromone p=0.018 → S11@127.0.0.1:49312
[S11] ⇄ pheromone p=0.035 → S15@127.0.0.1:49315
[S15] ⇄ pheromone p=0.390 → S5@127.0.0.1:49305
[S14] ⇄ pheromone p=0.042 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9131 head_norm=1.347553
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.397042e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9312 head_norm=1.223640 delta_norm=0.639704
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.287 → S2@127.0.0.1:49302
[S7] ⇄ pheromone p=0.406 → S3@127.0.0.1:49303
[S13] ⇄ pheromone p=0.148 → S10@127.0.0.1:49311
[S16] ⇄ pheromone p=0.160 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.233 → S3@127.0.0.1:49303
[S2] START round=31 head_norm_before_train=1.338131 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.169680 metrics={'f1_val': 0.6198811556404556, 'auprc': 0.7522354952666923, 'loss_val': 0.693121222196549, 'psi': 0.6728228914909503}-{'f1_val': 0.5978788585441133, 'auprc': 0.7237847447410822, 'loss_val': 0.8151160996456246, 'psi': 0.6482412130229008}
[S3] START round=31 head_norm_before_train=1.223640 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.6380575987371373, 'auprc': 0.8236819769170725, 'loss_val': 0.8137297522320321, 'psi': 0.7123073500091114}-{'f1_val': 0.9131422630162822, 'auprc': 0.9999900953695317, 'loss_val': 0.28691373384882346, 'psi': 0.947881395957582}
[S4] START round=31 head_norm_before_train=2.052372 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9508107537115273, 'auprc': 0.9540943838409631, 'loss_val': 0.2934434572327209, 'psi': 0.9521242057633017}-{'f1_val': 0.9494663164682662, 'auprc': 0.9797744282716355, 'loss_val': 0.2771048392593342, 'psi': 0.9615895611896139}
[S5] START round=31 head_norm_before_train=1.446347 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.6472028084771113, 'auprc': 0.829645126863132, 'loss_val': 0.5046465254362057, 'psi': 0.7201797358315196}-{'f1_val': 0.6600545964759654, 'auprc': 0.8638223266961385, 'loss_val': 0.42447848456860154, 'psi': 0.7415616885640346}
[S6] START round=31 head_norm_before_train=1.610440 cos_to_last_merge=0.8098 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9833332231694999, 'auprc': 0.959931087551419, 'loss_val': 0.09258850833396107, 'psi': 0.9739723689222675}-{'f1_val': 0.41604531394212996, 'auprc': 0.7503369444081258, 'loss_val': 1.7608488005830887, 'psi': 0.5497619661285283}
[S7] START round=31 head_norm_before_train=1.413200 cos_to_last_merge=0.8422 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=31 local utility u=0.040681 metrics={'f1_val': 0.6572026071167679, 'auprc': 0.8281403054624615, 'loss_val': 0.4603447966100134, 'psi': 0.7255776864550454}-{'f1_val': 0.6507379290592741, 'auprc': 0.8238137432528784, 'loss_val': 0.48993971852967694, 'psi': 0.7199682547367159}
[S8] START round=31 head_norm_before_train=1.148719 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.837318 metrics={'f1_val': 0.979674920548767, 'auprc': 0.9930801456886889, 'loss_val': 0.177885830940582, 'psi': 0.9850370106047358}-{'f1_val': 0.7139758603458082, 'auprc': 0.9868089304130516, 'loss_val': 0.23951384495880715, 'psi': 0.8231090883727056}
[S9] START round=31 head_norm_before_train=1.316107 cos_to_last_merge=0.9982 (last merge round=29)
[S9] round=31 local utility u=0.031117 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99806661246057, 'loss_val': 0.12562970937717738, 'psi': 0.9972229520725628}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985549919373047, 'loss_val': 0.1893283992253572, 'psi': 0.9974183038632567}
[S10] START round=31 head_norm_before_train=2.129241 (no previous merge yet)
[S10] round=31 local utility u=0.000548 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9952889159927725, 'loss_val': 0.027481987858397613, 'psi': 0.9953094387353472}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951414282374169, 'loss_val': 0.02813621499461168, 'psi': 0.995250443633205}
[S11] START round=31 head_norm_before_train=2.067349 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.995040468269231, 'auprc': 0.9991979759569682, 'loss_val': 0.04151671505994299, 'psi': 0.9967034713443259}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992517727450219, 'loss_val': 0.03636673792499275, 'psi': 0.997879263073755}
[S13] START round=31 head_norm_before_train=1.824291 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.7726998552335929, 'auprc': 0.8087957700953754, 'loss_val': 0.7408912978604268, 'psi': 0.7871382211783059}-{'f1_val': 0.7764804350707503, 'auprc': 0.8077469264461377, 'loss_val': 0.6607139492113203, 'psi': 0.7889870316209052}
[S14] START round=31 head_norm_before_train=1.326543 cos_to_last_merge=0.9997 (last merge round=29)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9556639101391778, 'auprc': 0.9981009435709447, 'loss_val': 0.1757727612489439, 'psi': 0.9726387235118846}-{'f1_val': 0.9968002980424979, 'auprc': 0.9972485879218451, 'loss_val': 0.18741017383744005, 'psi': 0.9969796139942367}
[S15] START round=31 head_norm_before_train=1.456233 cos_to_last_merge=0.9963 (last merge round=28)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9879364530414683, 'auprc': 0.9976175367141455, 'loss_val': 0.08728916595867547, 'psi': 0.9918088865105392}-{'f1_val': 0.9939759221388862, 'auprc': 0.9954810265351688, 'loss_val': 0.06549723229543143, 'psi': 0.9945779638973992}
[S16] START round=31 head_norm_before_train=1.348174 cos_to_last_merge=0.9926 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8281939252272587, 'auprc': 0.8235748971405565, 'loss_val': 0.8823865035104477, 'psi': 0.8263463139925777}-{'f1_val': 0.8582988334426611, 'auprc': 0.9677358672047026, 'loss_val': 0.6066374890200597, 'psi': 0.9020736469474777}
[S17] START round=31 head_norm_before_train=1.772539 cos_to_last_merge=0.7895 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=31 local utility u=0.725247 metrics={'f1_val': 0.8300346201533377, 'auprc': 0.9245386567064569, 'loss_val': 0.48704074727289803, 'psi': 0.8678362347745854}-{'f1_val': 0.6967339813630311, 'auprc': 0.8580622715716866, 'loss_val': 0.9383025477072195, 'psi': 0.7612652974464933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S6] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:49309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S7] not sending this round → trigger blocked (psi=0.726)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:49310
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1809 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.9598
[S8] RECEIVED delta(kind=head bytes=1809) from S6
[S8] cosine check vs S6: cos=0.6723
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.9436
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=0.4407
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.5913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.6013
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9879 head_norm=1.495412
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.125398e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9879 head_norm=1.417357 delta_norm=0.212540
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.6381 head_norm=1.257471
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.201539e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.6366 head_norm=1.367744 delta_norm=0.720154
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8282 head_norm=1.394990
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.232556e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8270 head_norm=1.229410 delta_norm=0.623256
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9797 head_norm=1.190503
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.997130e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9725 head_norm=1.285051 delta_norm=0.599713
[S8] aggregate: ROLLBACK (f1_val pre=0.980 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9967 head_norm=1.361541
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.391518e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.302344 delta_norm=0.539152
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.368170 cos_to_last_merge=0.9995 (last merge round=30)
[S2] round=32 local utility u=0.372723 metrics={'f1_val': 0.7135733528095155, 'auprc': 0.7674922371729751, 'loss_val': 0.555599534972455, 'psi': 0.7351409065548994}-{'f1_val': 0.6198811556404556, 'auprc': 0.7522354952666923, 'loss_val': 0.693121222196549, 'psi': 0.6728228914909503}
[S3] START round=32 head_norm_before_train=1.367744 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=1.000000 metrics={'f1_val': 0.9979732518176809, 'auprc': 0.9999954252649039, 'loss_val': 0.18143899822493864, 'psi': 0.9987821211965702}-{'f1_val': 0.6380575987371373, 'auprc': 0.8236819769170725, 'loss_val': 0.8137297522320321, 'psi': 0.7123073500091114}
[S4] START round=32 head_norm_before_train=2.064561 (no previous merge yet)
[S4] round=32 local utility u=0.008763 metrics={'f1_val': 0.9554515606475005, 'auprc': 0.9528044934661506, 'loss_val': 0.2998928225150094, 'psi': 0.9543927337749605}-{'f1_val': 0.9508107537115273, 'auprc': 0.9540943838409631, 'loss_val': 0.2934434572327209, 'psi': 0.9521242057633017}
[S5] START round=32 head_norm_before_train=1.464829 cos_to_last_merge=0.9999 (last merge round=30)
[S5] round=32 local utility u=0.459780 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9683890125339656, 'loss_val': 0.32002561448381334, 'psi': 0.8075479641084016}-{'f1_val': 0.6472028084771113, 'auprc': 0.829645126863132, 'loss_val': 0.5046465254362057, 'psi': 0.7201797358315196}
[S6] START round=32 head_norm_before_train=1.613916 cos_to_last_merge=0.8099 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.792581249262442, 'auprc': 0.953925751440093, 'loss_val': 0.521017332586369, 'psi': 0.8571190501335024}-{'f1_val': 0.9833332231694999, 'auprc': 0.959931087551419, 'loss_val': 0.09258850833396107, 'psi': 0.9739723689222675}
[S7] START round=32 head_norm_before_train=1.419135 cos_to_last_merge=0.8418 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5363767750369361, 'auprc': 0.7830747529118437, 'loss_val': 0.7808845089082026, 'psi': 0.6350559661868991}-{'f1_val': 0.6572026071167679, 'auprc': 0.8281403054624615, 'loss_val': 0.4603447966100134, 'psi': 0.7255776864550454}
[S8] START round=32 head_norm_before_train=1.285051 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.059411 metrics={'f1_val': 0.9934242076394499, 'auprc': 0.9912550954090878, 'loss_val': 0.13608531388949874, 'psi': 0.9925565627473051}-{'f1_val': 0.979674920548767, 'auprc': 0.9930801456886889, 'loss_val': 0.177885830940582, 'psi': 0.9850370106047358}
[S9] START round=32 head_norm_before_train=1.302344 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9982739926511244, 'loss_val': 0.10379141417107578, 'psi': 0.9916155489959112}-{'f1_val': 0.9966605118138915, 'auprc': 0.99806661246057, 'loss_val': 0.12562970937717738, 'psi': 0.9972229520725628}
[S10] START round=32 head_norm_before_train=2.135589 (no previous merge yet)
[S10] round=32 local utility u=0.000934 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.995594740213064, 'loss_val': 0.026530997079833273, 'psi': 0.9954317684234638}-{'f1_val': 0.9953231205637304, 'auprc': 0.9952889159927725, 'loss_val': 0.027481987858397613, 'psi': 0.9953094387353472}
[S11] START round=32 head_norm_before_train=2.082056 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=32 local utility u=0.010015 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9989013697844145, 'loss_val': 0.03068942502615661, 'psi': 0.997593999662675}-{'f1_val': 0.995040468269231, 'auprc': 0.9991979759569682, 'loss_val': 0.04151671505994299, 'psi': 0.9967034713443259}
[S13] START round=32 head_norm_before_train=1.828482 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.7435810532644413, 'auprc': 0.804044594921369, 'loss_val': 0.6037943999265878, 'psi': 0.7677664699272124}-{'f1_val': 0.7726998552335929, 'auprc': 0.8087957700953754, 'loss_val': 0.7408912978604268, 'psi': 0.7871382211783059}
[S14] START round=32 head_norm_before_train=1.348327 cos_to_last_merge=0.9987 (last merge round=29)
[S14] round=32 local utility u=0.151076 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9984234581193341, 'loss_val': 0.1250551422703097, 'psi': 0.997814344948769}-{'f1_val': 0.9556639101391778, 'auprc': 0.9981009435709447, 'loss_val': 0.1757727612489439, 'psi': 0.9726387235118846}
[S15] START round=32 head_norm_before_train=1.417357 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6954037335132974, 'auprc': 0.7970399075886241, 'loss_val': 0.5308591807186901, 'psi': 0.7360582031434282}-{'f1_val': 0.9879364530414683, 'auprc': 0.9976175367141455, 'loss_val': 0.08728916595867547, 'psi': 0.9918088865105392}
[S16] START round=32 head_norm_before_train=1.229410 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.697826 metrics={'f1_val': 0.9096538297089555, 'auprc': 0.9858336283275387, 'loss_val': 0.46226913670590725, 'psi': 0.9401257491563888}-{'f1_val': 0.8281939252272587, 'auprc': 0.8235748971405565, 'loss_val': 0.8823865035104477, 'psi': 0.8263463139925777}
[S17] START round=32 head_norm_before_train=1.788144 cos_to_last_merge=0.7881 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.710390352337145, 'auprc': 0.891124611679978, 'loss_val': 0.8184349609631121, 'psi': 0.7826840560742783}-{'f1_val': 0.8300346201533377, 'auprc': 0.9245386567064569, 'loss_val': 0.48704074727289803, 'psi': 0.8678362347745854}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.8835
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.2935
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] cosine check vs S2: cos=0.9882
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] cosine check vs S14: cos=0.4103
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.7577
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9984
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.7680
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.9567
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=-0.0069
[S15] DROPPED delta from S11 (cos=-0.0069 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9872 head_norm=1.351846
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.640716e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9872 head_norm=1.345479 delta_norm=0.164072
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9097 head_norm=1.272639
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.242576e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9050 head_norm=1.111043 delta_norm=0.824258
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9934 head_norm=1.324470
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.340789e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9937 head_norm=1.134812 delta_norm=0.734079
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9967 head_norm=2.095304
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.032944e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9967 head_norm=2.080925 delta_norm=0.060329
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.7136 head_norm=1.403566
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.059850e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7114 head_norm=1.384060 delta_norm=0.205985
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9974 head_norm=1.378086
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.238975e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9974 head_norm=1.286257 delta_norm=0.323898
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.6954 head_norm=1.437415
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.104582e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.6954 head_norm=1.416291 delta_norm=0.110458
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.384060 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.120427 metrics={'f1_val': 0.7168464278375475, 'auprc': 0.8327137104039768, 'loss_val': 0.5300484627003875, 'psi': 0.7631933408641192}-{'f1_val': 0.7135733528095155, 'auprc': 0.7674922371729751, 'loss_val': 0.555599534972455, 'psi': 0.7351409065548994}
[S3] START round=33 head_norm_before_train=1.395030 cos_to_last_merge=0.9996 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8834389253740308, 'auprc': 0.999790047283806, 'loss_val': 0.3616960081325288, 'psi': 0.929979374137941}-{'f1_val': 0.9979732518176809, 'auprc': 0.9999954252649039, 'loss_val': 0.18143899822493864, 'psi': 0.9987821211965702}
[S4] START round=33 head_norm_before_train=2.068208 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9501735176788394, 'auprc': 0.9560949778414022, 'loss_val': 0.27904423480883056, 'psi': 0.9525421017438644}-{'f1_val': 0.9554515606475005, 'auprc': 0.9528044934661506, 'loss_val': 0.2998928225150094, 'psi': 0.9543927337749605}
[S5] START round=33 head_norm_before_train=1.485943 cos_to_last_merge=0.9994 (last merge round=30)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6992478964330195, 'auprc': 0.9485280882781528, 'loss_val': 0.3370366945305101, 'psi': 0.7989599731710728}-{'f1_val': 0.700320598491359, 'auprc': 0.9683890125339656, 'loss_val': 0.32002561448381334, 'psi': 0.8075479641084016}
[S6] START round=33 head_norm_before_train=1.619976 cos_to_last_merge=0.8093 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6227615088745438, 'auprc': 0.9448121221232365, 'loss_val': 0.8253592308476051, 'psi': 0.7515817541740208}-{'f1_val': 0.792581249262442, 'auprc': 0.953925751440093, 'loss_val': 0.521017332586369, 'psi': 0.8571190501335024}
[S7] START round=33 head_norm_before_train=1.426019 cos_to_last_merge=0.8412 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.841
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.43314163430733843, 'auprc': 0.7806077358693435, 'loss_val': 0.9538324453320561, 'psi': 0.5721280749321405}-{'f1_val': 0.5363767750369361, 'auprc': 0.7830747529118437, 'loss_val': 0.7808845089082026, 'psi': 0.6350559661868991}
[S8] START round=33 head_norm_before_train=1.134812 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9673312530805136, 'auprc': 0.9985669210178529, 'loss_val': 0.24413205494192242, 'psi': 0.9798255202554493}-{'f1_val': 0.9934242076394499, 'auprc': 0.9912550954090878, 'loss_val': 0.13608531388949874, 'psi': 0.9925565627473051}
[S9] START round=33 head_norm_before_train=1.345479 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.034357 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9931116853870231, 'loss_val': 0.07649406942348023, 'psi': 0.9952409812431441}-{'f1_val': 0.9871765865591023, 'auprc': 0.9982739926511244, 'loss_val': 0.10379141417107578, 'psi': 0.9916155489959112}
[S10] START round=33 head_norm_before_train=2.139887 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954018543294618, 'loss_val': 0.027160519297980485, 'psi': 0.9953546140700229}-{'f1_val': 0.9953231205637304, 'auprc': 0.995594740213064, 'loss_val': 0.026530997079833273, 'psi': 0.9954317684234638}
[S11] START round=33 head_norm_before_train=2.080925 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9988993622031664, 'loss_val': 0.03207349110120673, 'psi': 0.9974902978783249}-{'f1_val': 0.9967224195815153, 'auprc': 0.9989013697844145, 'loss_val': 0.03068942502615661, 'psi': 0.997593999662675}
[S13] START round=33 head_norm_before_train=1.832346 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.657361839075369, 'auprc': 0.7756045625283741, 'loss_val': 0.8684664509345382, 'psi': 0.7046589284565711}-{'f1_val': 0.7435810532644413, 'auprc': 0.804044594921369, 'loss_val': 0.6037943999265878, 'psi': 0.7677664699272124}
[S14] START round=33 head_norm_before_train=1.286257 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.998604938285709, 'loss_val': 0.14324660361771835, 'psi': 0.9975084398857453}-{'f1_val': 0.9974082695017256, 'auprc': 0.9984234581193341, 'loss_val': 0.1250551422703097, 'psi': 0.997814344948769}
[S15] START round=33 head_norm_before_train=1.416291 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9941029385030195, 'auprc': 0.9970456032171133, 'loss_val': 0.0821080794217587, 'psi': 0.9952800043886569}-{'f1_val': 0.6954037335132974, 'auprc': 0.7970399075886241, 'loss_val': 0.5308591807186901, 'psi': 0.7360582031434282}
[S16] START round=33 head_norm_before_train=1.111043 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.365280 metrics={'f1_val': 0.9880792379332194, 'auprc': 0.9854016670193699, 'loss_val': 0.20096650010122455, 'psi': 0.9870082095676795}-{'f1_val': 0.9096538297089555, 'auprc': 0.9858336283275387, 'loss_val': 0.46226913670590725, 'psi': 0.9401257491563888}
[S17] START round=33 head_norm_before_train=1.807236 cos_to_last_merge=0.7871 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=33 local utility u=0.043347 metrics={'f1_val': 0.7171005143730929, 'auprc': 0.8944025290589004, 'loss_val': 0.7818364906232609, 'psi': 0.7880213202474159}-{'f1_val': 0.710390352337145, 'auprc': 0.891124611679978, 'loss_val': 0.8184349609631121, 'psi': 0.7826840560742783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] → sending delta(kind=head bytes=1809) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1809 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=0.8335
[S5] RECEIVED delta(kind=head bytes=1809) from S15
[S5] cosine check vs S15: cos=0.9606
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.5868
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.9823
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.9254
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9968 head_norm=1.320725
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.662287e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9968 head_norm=1.189376 delta_norm=0.366229
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6992 head_norm=1.506649
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.094909e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7003 head_norm=1.463037 delta_norm=0.209491
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.8834 head_norm=1.420092
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.708234e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.8619 head_norm=1.592125 delta_norm=0.370823
[S3] aggregate: ROLLBACK (f1_val pre=0.883 post=0.862 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9881 head_norm=1.163256
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.878507e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9876 head_norm=1.136539 delta_norm=0.587851
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9941 head_norm=1.448701
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.359323e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9941 head_norm=1.435563 delta_norm=0.135932
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.435236 cos_to_last_merge=0.9986 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7221166222131005, 'auprc': 0.7666977008292408, 'loss_val': 0.601069931691259, 'psi': 0.7399490536595565}-{'f1_val': 0.7168464278375475, 'auprc': 0.8327137104039768, 'loss_val': 0.5300484627003875, 'psi': 0.7631933408641192}
[S3] START round=34 head_norm_before_train=1.592125 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8086468858503749, 'auprc': 0.9625473339432029, 'loss_val': 0.4653591990470318, 'psi': 0.8702070650875061}-{'f1_val': 0.8834389253740308, 'auprc': 0.999790047283806, 'loss_val': 0.3616960081325288, 'psi': 0.929979374137941}
[S4] START round=34 head_norm_before_train=2.072374 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9474945429175671, 'auprc': 0.9493658600670681, 'loss_val': 0.28611767703879104, 'psi': 0.9482430697773675}-{'f1_val': 0.9501735176788394, 'auprc': 0.9560949778414022, 'loss_val': 0.27904423480883056, 'psi': 0.9525421017438644}
[S5] START round=34 head_norm_before_train=1.463037 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.026385 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9658837251397646, 'loss_val': 0.3432870856195702, 'psi': 0.8065976358844669}-{'f1_val': 0.6992478964330195, 'auprc': 0.9485280882781528, 'loss_val': 0.3370366945305101, 'psi': 0.7989599731710728}
[S6] START round=34 head_norm_before_train=1.632566 cos_to_last_merge=0.8077 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.808
[S6] round=34 local utility u=0.617889 metrics={'f1_val': 0.7848086065793685, 'auprc': 0.9444631458456466, 'loss_val': 0.5608161859709693, 'psi': 0.8486704222858796}-{'f1_val': 0.6227615088745438, 'auprc': 0.9448121221232365, 'loss_val': 0.8253592308476051, 'psi': 0.7515817541740208}
[S7] START round=34 head_norm_before_train=1.433396 cos_to_last_merge=0.8408 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.841
[S7] round=34 local utility u=0.639990 metrics={'f1_val': 0.5954086474843978, 'auprc': 0.7900872813487455, 'loss_val': 0.6758928388499152, 'psi': 0.6732801010301369}-{'f1_val': 0.43314163430733843, 'auprc': 0.7806077358693435, 'loss_val': 0.9538324453320561, 'psi': 0.5721280749321405}
[S8] START round=34 head_norm_before_train=1.189305 cos_to_last_merge=0.9984 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.979579185309104, 'loss_val': 0.3440194688986666, 'psi': 0.8200839676829432}-{'f1_val': 0.9673312530805136, 'auprc': 0.9985669210178529, 'loss_val': 0.24413205494192242, 'psi': 0.9798255202554493}
[S9] START round=34 head_norm_before_train=1.386152 cos_to_last_merge=0.9995 (last merge round=32)
[S9] round=34 local utility u=0.011229 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956994370725234, 'loss_val': 0.06179889433117351, 'psi': 0.9962760819173442}-{'f1_val': 0.9966605118138915, 'auprc': 0.9931116853870231, 'loss_val': 0.07649406942348023, 'psi': 0.9952409812431441}
[S10] START round=34 head_norm_before_train=2.146005 (no previous merge yet)
[S10] round=34 local utility u=0.000914 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956117256864665, 'loss_val': 0.0259615474047452, 'psi': 0.9954385626128248}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954018543294618, 'loss_val': 0.027160519297980485, 'psi': 0.9953546140700229}
[S11] START round=34 head_norm_before_train=2.094495 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=34 local utility u=0.002358 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992403695061411, 'loss_val': 0.030859706232490278, 'psi': 0.9978747017782028}-{'f1_val': 0.9965509216617638, 'auprc': 0.9988993622031664, 'loss_val': 0.03207349110120673, 'psi': 0.9974902978783249}
[S13] START round=34 head_norm_before_train=1.840615 (no previous merge yet)
[S13] round=34 local utility u=0.334407 metrics={'f1_val': 0.7604931451862558, 'auprc': 0.7754535636416008, 'loss_val': 0.8179865910422681, 'psi': 0.7664773125683938}-{'f1_val': 0.657361839075369, 'auprc': 0.7756045625283741, 'loss_val': 0.8684664509345382, 'psi': 0.7046589284565711}
[S14] START round=34 head_norm_before_train=1.189376 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.99846984754587, 'loss_val': 0.1529399451491633, 'psi': 0.9977282743606941}-{'f1_val': 0.9967774409524363, 'auprc': 0.998604938285709, 'loss_val': 0.14324660361771835, 'psi': 0.9975084398857453}
[S15] START round=34 head_norm_before_train=1.435563 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9904096283383054, 'auprc': 0.9962436051237038, 'loss_val': 0.0952395105598689, 'psi': 0.9927432190524648}-{'f1_val': 0.9941029385030195, 'auprc': 0.9970456032171133, 'loss_val': 0.0821080794217587, 'psi': 0.9952800043886569}
[S16] START round=34 head_norm_before_train=1.136539 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.892615246960805, 'auprc': 0.9687815853567744, 'loss_val': 0.4975761057181907, 'psi': 0.9230817823191927}-{'f1_val': 0.9880792379332194, 'auprc': 0.9854016670193699, 'loss_val': 0.20096650010122455, 'psi': 0.9870082095676795}
[S17] START round=34 head_norm_before_train=1.824304 cos_to_last_merge=0.7862 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=34 local utility u=0.488794 metrics={'f1_val': 0.8175329622073333, 'auprc': 0.9322099275052524, 'loss_val': 0.5202651064556761, 'psi': 0.8634037483265009}-{'f1_val': 0.7171005143730929, 'auprc': 0.8944025290589004, 'loss_val': 0.7818364906232609, 'psi': 0.7880213202474159}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S16@127.0.0.1:49316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1808 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1810 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.8236
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=-0.0360
[S10] DROPPED delta from S13 (cos=-0.0360 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1810) from S5
[S16] cosine check vs S5: cos=0.4545
[S8] RECEIVED delta(kind=head bytes=1808) from S6
[S8] cosine check vs S6: cos=0.5956
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.3372
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.0041
[S17] not sending this round → trigger blocked (psi=0.863)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9904 head_norm=1.475891
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.284338e+00
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9900 head_norm=1.289298 delta_norm=1.284338
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9967 head_norm=1.421792
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.366263e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9967 head_norm=1.711791 delta_norm=0.636626
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.8086 head_norm=1.611914
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.814638e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.8046 head_norm=1.249093 delta_norm=0.881464
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.7138 head_norm=1.234584
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.749979e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.7504 head_norm=1.292234 delta_norm=0.674998
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.8926 head_norm=1.186181
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.068141e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.8839 head_norm=1.138693 delta_norm=0.706814
[S16] aggregate: ROLLBACK (f1_val pre=0.893 post=0.884 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.481829 cos_to_last_merge=0.9958 (last merge round=32)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6471819875724771, 'auprc': 0.7598562883908385, 'loss_val': 0.7390453231624198, 'psi': 0.6922517078998217}-{'f1_val': 0.7221166222131005, 'auprc': 0.7666977008292408, 'loss_val': 0.601069931691259, 'psi': 0.7399490536595565}
[S3] START round=35 head_norm_before_train=1.249093 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.746503 metrics={'f1_val': 0.9976458899154624, 'auprc': 0.9999962620344063, 'loss_val': 0.21869450364182824, 'psi': 0.99858603876304}-{'f1_val': 0.8086468858503749, 'auprc': 0.9625473339432029, 'loss_val': 0.4653591990470318, 'psi': 0.8702070650875061}
[S4] START round=35 head_norm_before_train=2.082668 (no previous merge yet)
[S4] round=35 local utility u=0.018557 metrics={'f1_val': 0.9497146614577835, 'auprc': 0.9571624897298057, 'loss_val': 0.28571341843176173, 'psi': 0.9526937927665924}-{'f1_val': 0.9474945429175671, 'auprc': 0.9493658600670681, 'loss_val': 0.28611767703879104, 'psi': 0.9482430697773675}
[S5] START round=35 head_norm_before_train=1.478306 cos_to_last_merge=0.9999 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6720436317074145, 'auprc': 0.8554501515994193, 'loss_val': 0.4561562144862444, 'psi': 0.7454062396642165}-{'f1_val': 0.7004069097142683, 'auprc': 0.9658837251397646, 'loss_val': 0.3432870856195702, 'psi': 0.8065976358844669}
[S6] START round=35 head_norm_before_train=1.651298 cos_to_last_merge=0.8056 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=35 local utility u=0.146152 metrics={'f1_val': 0.8147324678339682, 'auprc': 0.9413832711817705, 'loss_val': 0.43881603500044636, 'psi': 0.865392789173089}-{'f1_val': 0.7848086065793685, 'auprc': 0.9444631458456466, 'loss_val': 0.5608161859709693, 'psi': 0.8486704222858796}
[S7] START round=35 head_norm_before_train=1.440887 cos_to_last_merge=0.8402 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=35 local utility u=0.162606 metrics={'f1_val': 0.6256290349711704, 'auprc': 0.8021752783931295, 'loss_val': 0.5682661892997337, 'psi': 0.6962475323399541}-{'f1_val': 0.5954086474843978, 'auprc': 0.7900872813487455, 'loss_val': 0.6758928388499152, 'psi': 0.6732801010301369}
[S8] START round=35 head_norm_before_train=1.292234 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.635439 metrics={'f1_val': 0.9090081523136795, 'auprc': 0.9950913262257061, 'loss_val': 0.29120359581716415, 'psi': 0.9434414218784901}-{'f1_val': 0.7137538225988359, 'auprc': 0.979579185309104, 'loss_val': 0.3440194688986666, 'psi': 0.8200839676829432}
[S9] START round=35 head_norm_before_train=1.711791 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.008562 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983699690695155, 'loss_val': 0.047884255397613734, 'psi': 0.9968640701535995}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956994370725234, 'loss_val': 0.06179889433117351, 'psi': 0.9962760819173442}
[S10] START round=35 head_norm_before_train=2.156282 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955803665090566, 'loss_val': 0.02598354255591121, 'psi': 0.9954260189418609}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956117256864665, 'loss_val': 0.0259615474047452, 'psi': 0.9954385626128248}
[S11] START round=35 head_norm_before_train=2.108404 cos_to_last_merge=0.9999 (last merge round=32)
[S11] round=35 local utility u=0.002180 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992163595263219, 'loss_val': 0.026427341041842932, 'psi': 0.9978650977862751}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992403695061411, 'loss_val': 0.030859706232490278, 'psi': 0.9978747017782028}
[S13] START round=35 head_norm_before_train=1.846877 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.7232992135209005, 'auprc': 0.7810836651251241, 'loss_val': 0.7641566637547336, 'psi': 0.7464129941625899}-{'f1_val': 0.7604931451862558, 'auprc': 0.7754535636416008, 'loss_val': 0.8179865910422681, 'psi': 0.7664773125683938}
[S14] START round=35 head_norm_before_train=1.231066 cos_to_last_merge=0.9988 (last merge round=33)
[S14] round=35 local utility u=0.015322 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9966520588682839, 'loss_val': 0.11788898551755958, 'psi': 0.9971057852483489}-{'f1_val': 0.9972338922372435, 'auprc': 0.99846984754587, 'loss_val': 0.1529399451491633, 'psi': 0.9977282743606941}
[S15] START round=35 head_norm_before_train=1.289298 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7691362172958871, 'auprc': 0.8697613801553641, 'loss_val': 0.4877176649972175, 'psi': 0.8093862824396779}-{'f1_val': 0.9904096283383054, 'auprc': 0.9962436051237038, 'loss_val': 0.0952395105598689, 'psi': 0.9927432190524648}
[S16] START round=35 head_norm_before_train=1.138693 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.461580 metrics={'f1_val': 0.9897474329170022, 'auprc': 0.9861745376772487, 'loss_val': 0.2093874276731617, 'psi': 0.9883182748211008}-{'f1_val': 0.892615246960805, 'auprc': 0.9687815853567744, 'loss_val': 0.4975761057181907, 'psi': 0.9230817823191927}
[S17] START round=35 head_norm_before_train=1.832983 cos_to_last_merge=0.7855 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.7267484416127873, 'auprc': 0.9043400626289205, 'loss_val': 0.7819245911960043, 'psi': 0.7977850900192406}-{'f1_val': 0.8175329622073333, 'auprc': 0.9322099275052524, 'loss_val': 0.5202651064556761, 'psi': 0.8634037483265009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.696)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.865)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49307
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1809 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9147
[S8] RECEIVED delta(kind=head bytes=1809) from S9
[S8] cosine check vs S9: cos=0.4466
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.7910
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.8773
[S16] RECEIVED delta(kind=head bytes=1804) from S14
[S16] cosine check vs S14: cos=0.9020
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.013 → S4@127.0.0.1:49304
[S2] ⇄ pheromone p=0.112 → S3@127.0.0.1:49303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.6720 head_norm=1.493621
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.642622e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.6626 head_norm=1.295891 delta_norm=0.364262
[S5] aggregate: ROLLBACK (f1_val pre=0.672 post=0.663 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.078 → S15@127.0.0.1:49315
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8147 head_norm=1.669785
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.501156e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8109 head_norm=1.472802 delta_norm=0.350116
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:49313
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6256 head_norm=1.450505
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.479832e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6340 head_norm=1.288108 delta_norm=0.447983
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9897 head_norm=1.180312
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.761854e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9897 head_norm=1.198462 delta_norm=0.276185
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.263 → S5@127.0.0.1:49305
[S3] ⇄ pheromone p=0.346 → S7@127.0.0.1:49308
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9090 head_norm=1.339877
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.262191e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.8873 head_norm=1.311949 delta_norm=0.826219
[S8] aggregate: ROLLBACK (f1_val pre=0.909 post=0.887 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.206 → S6@127.0.0.1:49307
[S9] ⇄ pheromone p=0.018 → S8@127.0.0.1:49309
[S14] ⇄ pheromone p=0.032 → S16@127.0.0.1:49316
[S15] ⇄ pheromone p=0.256 → S2@127.0.0.1:49302
[S2] START round=36 head_norm_before_train=1.524009 cos_to_last_merge=0.9928 (last merge round=32)
[S2] round=36 local utility u=0.264152 metrics={'f1_val': 0.7093562467710087, 'auprc': 0.7728816283160804, 'loss_val': 0.6228628914988661, 'psi': 0.7347663993890374}-{'f1_val': 0.6471819875724771, 'auprc': 0.7598562883908385, 'loss_val': 0.7390453231624198, 'psi': 0.6922517078998217}
[S3] START round=36 head_norm_before_train=1.271163 cos_to_last_merge=0.9997 (last merge round=34)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7541996253489562, 'auprc': 0.9365779670783909, 'loss_val': 0.5946650383905473, 'psi': 0.82715096204073}-{'f1_val': 0.9976458899154624, 'auprc': 0.9999962620344063, 'loss_val': 0.21869450364182824, 'psi': 0.99858603876304}
[S4] START round=36 head_norm_before_train=2.086243 (no previous merge yet)
[S4] round=36 local utility u=0.014014 metrics={'f1_val': 0.9511678906480481, 'auprc': 0.9617767926539963, 'loss_val': 0.2802473232347165, 'psi': 0.9554114514504274}-{'f1_val': 0.9497146614577835, 'auprc': 0.9571624897298057, 'loss_val': 0.28571341843176173, 'psi': 0.9526937927665924}
[S5] START round=36 head_norm_before_train=1.295891 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.370763 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9890641888718702, 'loss_val': 0.2856568648372479, 'psi': 0.8158702084806764}-{'f1_val': 0.6720436317074145, 'auprc': 0.8554501515994193, 'loss_val': 0.4561562144862444, 'psi': 0.7454062396642165}
[S6] START round=36 head_norm_before_train=1.472802 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6008787118592153, 'auprc': 0.9391821952561304, 'loss_val': 0.8660310360039937, 'psi': 0.7362001052179814}-{'f1_val': 0.8147324678339682, 'auprc': 0.9413832711817705, 'loss_val': 0.43881603500044636, 'psi': 0.865392789173089}
[S7] START round=36 head_norm_before_train=1.288108 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.049499 metrics={'f1_val': 0.6337767245839123, 'auprc': 0.8068553612653451, 'loss_val': 0.5321947777670427, 'psi': 0.7030081792564854}-{'f1_val': 0.6256290349711704, 'auprc': 0.8021752783931295, 'loss_val': 0.5682661892997337, 'psi': 0.6962475323399541}
[S8] START round=36 head_norm_before_train=1.311949 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.321773 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9875258120289165, 'loss_val': 0.1331797141114856, 'psi': 0.9912370119935465}-{'f1_val': 0.9090081523136795, 'auprc': 0.9950913262257061, 'loss_val': 0.29120359581716415, 'psi': 0.9434414218784901}
[S9] START round=36 head_norm_before_train=1.735635 cos_to_last_merge=0.9998 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9981294204863433, 'loss_val': 0.04352072856231872, 'psi': 0.9962660188430147}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983699690695155, 'loss_val': 0.047884255397613734, 'psi': 0.9968640701535995}
[S10] START round=36 head_norm_before_train=2.163256 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955598884922179, 'loss_val': 0.02594892219744142, 'psi': 0.9954178277351253}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955803665090566, 'loss_val': 0.02598354255591121, 'psi': 0.9954260189418609}
[S11] START round=36 head_norm_before_train=2.123258 cos_to_last_merge=0.9997 (last merge round=32)
[S11] round=36 local utility u=0.000522 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991222195393142, 'loss_val': 0.025101275844119145, 'psi': 0.997827441791472}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992163595263219, 'loss_val': 0.026427341041842932, 'psi': 0.9978650977862751}
[S13] START round=36 head_norm_before_train=1.855213 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6406352975906314, 'auprc': 0.7817896570703193, 'loss_val': 0.9663517133111542, 'psi': 0.6970970413825066}-{'f1_val': 0.7232992135209005, 'auprc': 0.7810836651251241, 'loss_val': 0.7641566637547336, 'psi': 0.7464129941625899}
[S14] START round=36 head_norm_before_train=1.277514 cos_to_last_merge=0.9958 (last merge round=33)
[S14] round=36 local utility u=0.012543 metrics={'f1_val': 0.9978627957474508, 'auprc': 0.9982247539429908, 'loss_val': 0.10024839037785749, 'psi': 0.9980075790256668}-{'f1_val': 0.9974082695017256, 'auprc': 0.9966520588682839, 'loss_val': 0.11788898551755958, 'psi': 0.9971057852483489}
[S15] START round=36 head_norm_before_train=1.355255 cos_to_last_merge=0.9898 (last merge round=34)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8191198157292968, 'loss_val': 0.498724562508972, 'psi': 0.7481981125934929}-{'f1_val': 0.7691362172958871, 'auprc': 0.8697613801553641, 'loss_val': 0.4877176649972175, 'psi': 0.8093862824396779}
[S16] START round=36 head_norm_before_train=1.198462 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.045454 metrics={'f1_val': 0.9898048545219384, 'auprc': 0.9913092336791418, 'loss_val': 0.13422748204293214, 'psi': 0.9904066061848198}-{'f1_val': 0.9897474329170022, 'auprc': 0.9861745376772487, 'loss_val': 0.2093874276731617, 'psi': 0.9883182748211008}
[S17] START round=36 head_norm_before_train=1.844700 cos_to_last_merge=0.7843 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=36 local utility u=0.728311 metrics={'f1_val': 0.8704585122939806, 'auprc': 0.967895025455637, 'loss_val': 0.37822876271255734, 'psi': 0.9094331175586432}-{'f1_val': 0.7267484416127873, 'auprc': 0.9043400626289205, 'loss_val': 0.7819245911960043, 'psi': 0.7977850900192406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9976
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=0.9753
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=0.8723
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.6497
[S3] RECEIVED delta(kind=head bytes=1807) from S2
[S3] cosine check vs S2: cos=0.9551
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.9346
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] cosine check vs S8: cos=0.6910
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9976
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.7542 head_norm=1.293743
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.611434e-02
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.7502 head_norm=1.329175 delta_norm=0.096114
[S3] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.7004 head_norm=1.312884
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.244115e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.7004 head_norm=1.234467 delta_norm=0.324412
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9512 head_norm=2.091251
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.623678e-02
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9512 head_norm=2.113061 delta_norm=0.076237
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.6009 head_norm=1.493518
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.613491e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.6025 head_norm=1.303226 delta_norm=0.561349
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9970 head_norm=2.137368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.623678e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9970 head_norm=2.113061 delta_norm=0.076237
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9898 head_norm=1.238806
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.473858e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9898 head_norm=1.270568 delta_norm=0.147386
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7009 head_norm=1.464318
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.852207e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7009 head_norm=1.261532 delta_norm=0.585221
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.568279 cos_to_last_merge=0.9895 (last merge round=32)
[S2] round=37 local utility u=0.009435 metrics={'f1_val': 0.7144164370876137, 'auprc': 0.7776823917249397, 'loss_val': 0.648756891056707, 'psi': 0.7397228189425442}-{'f1_val': 0.7093562467710087, 'auprc': 0.7728816283160804, 'loss_val': 0.6228628914988661, 'psi': 0.7347663993890374}
[S3] START round=37 head_norm_before_train=1.329175 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.215200 metrics={'f1_val': 0.7973836464341584, 'auprc': 0.9640001461693006, 'loss_val': 0.5056361851876123, 'psi': 0.8640302463282152}-{'f1_val': 0.7541996253489562, 'auprc': 0.9365779670783909, 'loss_val': 0.5946650383905473, 'psi': 0.82715096204073}
[S4] START round=37 head_norm_before_train=2.113061 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.031975 metrics={'f1_val': 0.9506883829775679, 'auprc': 0.9842568640097733, 'loss_val': 0.28086111348352677, 'psi': 0.9641157753904501}-{'f1_val': 0.9511678906480481, 'auprc': 0.9617767926539963, 'loss_val': 0.2802473232347165, 'psi': 0.9554114514504274}
[S5] START round=37 head_norm_before_train=1.234467 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8449653933172928, 'loss_val': 0.9458099566750822, 'psi': 0.6000458956301404}-{'f1_val': 0.700407554886547, 'auprc': 0.9890641888718702, 'loss_val': 0.2856568648372479, 'psi': 0.8158702084806764}
[S6] START round=37 head_norm_before_train=1.303226 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.570766 metrics={'f1_val': 0.7312556454635779, 'auprc': 0.9577906572964104, 'loss_val': 0.5625857957834723, 'psi': 0.8218696501967109}-{'f1_val': 0.6008787118592153, 'auprc': 0.9391821952561304, 'loss_val': 0.8660310360039937, 'psi': 0.7362001052179814}
[S7] START round=37 head_norm_before_train=1.304330 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5570772343852204, 'auprc': 0.7846328920006606, 'loss_val': 0.7650136750339971, 'psi': 0.6480994974313965}-{'f1_val': 0.6337767245839123, 'auprc': 0.8068553612653451, 'loss_val': 0.5321947777670427, 'psi': 0.7030081792564854}
[S8] START round=37 head_norm_before_train=1.340308 cos_to_last_merge=0.9995 (last merge round=35)
[S8] round=37 local utility u=0.027018 metrics={'f1_val': 0.9923860096923637, 'auprc': 0.9986410547730757, 'loss_val': 0.10453924234827887, 'psi': 0.9948880277246486}-{'f1_val': 0.9937111453033, 'auprc': 0.9875258120289165, 'loss_val': 0.1331797141114856, 'psi': 0.9912370119935465}
[S9] START round=37 head_norm_before_train=1.754321 cos_to_last_merge=0.9993 (last merge round=34)
[S9] round=37 local utility u=0.004963 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9981228743824204, 'loss_val': 0.038593479074348444, 'psi': 0.9967652322787615}-{'f1_val': 0.9950237510807955, 'auprc': 0.9981294204863433, 'loss_val': 0.04352072856231872, 'psi': 0.9962660188430147}
[S10] START round=37 head_norm_before_train=2.170624 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954205032229899, 'loss_val': 0.026442478407400865, 'psi': 0.9953620736274342}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955598884922179, 'loss_val': 0.02594892219744142, 'psi': 0.9954178277351253}
[S11] START round=37 head_norm_before_train=2.113061 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991538675583395, 'loss_val': 0.026152521912310524, 'psi': 0.997840100999082}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991222195393142, 'loss_val': 0.025101275844119145, 'psi': 0.997827441791472}
[S13] START round=37 head_norm_before_train=1.860141 (no previous merge yet)
[S13] round=37 local utility u=0.142216 metrics={'f1_val': 0.6675252052081987, 'auprc': 0.7773586407215952, 'loss_val': 0.829965939880411, 'psi': 0.7114585794135573}-{'f1_val': 0.6406352975906314, 'auprc': 0.7817896570703193, 'loss_val': 0.9663517133111542, 'psi': 0.6970970413825066}
[S14] START round=37 head_norm_before_train=1.318139 cos_to_last_merge=0.9923 (last merge round=33)
[S14] round=37 local utility u=0.000504 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9970402436768496, 'loss_val': 0.08787283505657974, 'psi': 0.9967523242409986}-{'f1_val': 0.9978627957474508, 'auprc': 0.9982247539429908, 'loss_val': 0.10024839037785749, 'psi': 0.9980075790256668}
[S15] START round=37 head_norm_before_train=1.261532 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9950242077208795, 'auprc': 0.9971630012213291, 'loss_val': 0.058091984948384565, 'psi': 0.9958797251210594}-{'f1_val': 0.7009169771696235, 'auprc': 0.8191198157292968, 'loss_val': 0.498724562508972, 'psi': 0.7481981125934929}
[S16] START round=37 head_norm_before_train=1.270568 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8428805523800387, 'auprc': 0.9333531717317188, 'loss_val': 0.8355658937409676, 'psi': 0.8790696001207108}-{'f1_val': 0.9898048545219384, 'auprc': 0.9913092336791418, 'loss_val': 0.13422748204293214, 'psi': 0.9904066061848198}
[S17] START round=37 head_norm_before_train=1.861203 cos_to_last_merge=0.7832 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=37 local utility u=0.006490 metrics={'f1_val': 0.8784285254060066, 'auprc': 0.9626084576206644, 'loss_val': 0.39720854243090936, 'psi': 0.9121004982918697}-{'f1_val': 0.8704585122939806, 'auprc': 0.967895025455637, 'loss_val': 0.37822876271255734, 'psi': 0.9094331175586432}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:49302
[S15] sending update (kind=head size=1806 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1806) from S15
[S2] cosine check vs S15: cos=0.8615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.9613
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1805) from S9
[S8] cosine check vs S9: cos=0.8806
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=0.9924
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0354
[S10] DROPPED delta from S13 (cos=-0.0354 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9054
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49307
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.9054
[S7] RECEIVED delta(kind=head bytes=1805) from S3
[S7] cosine check vs S3: cos=0.9358
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9924 head_norm=1.365986
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.615885e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9924 head_norm=1.377777 delta_norm=0.096159
[S8] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.7974 head_norm=1.357950
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.397048e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.7750 head_norm=1.467302 delta_norm=0.239705
[S3] aggregate: ROLLBACK (f1_val pre=0.797 post=0.775 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7313 head_norm=1.333064
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.938960e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7155 head_norm=1.317237 delta_norm=0.293896
[S6] aggregate: ROLLBACK (f1_val pre=0.731 post=0.716 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9970 head_norm=2.125381
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.926720e-03
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9970 head_norm=2.124971 delta_norm=0.009927
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=37 metric=0.7144 head_norm=1.605253
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.076854e-01
[S2] stored merged vector for next round verification (round=37)
[S2] DEBUG after merge:  round=37 metric=0.7140 head_norm=1.430914 delta_norm=0.407685
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.5571 head_norm=1.323259
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.407104e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.5771 head_norm=1.318931 delta_norm=0.240710
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8429 head_norm=1.303313
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.477841e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8427 head_norm=1.323854 delta_norm=0.084778
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.430914 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=38 local utility u=0.008794 metrics={'f1_val': 0.7135426936699494, 'auprc': 0.7747894163466599, 'loss_val': 0.6172477568398379, 'psi': 0.7380413827406336}-{'f1_val': 0.7144164370876137, 'auprc': 0.7776823917249397, 'loss_val': 0.648756891056707, 'psi': 0.7397228189425442}
[S3] START round=38 head_norm_before_train=1.467302 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.608485 metrics={'f1_val': 0.936427080069693, 'auprc': 0.9851678497799973, 'loss_val': 0.1864304071429047, 'psi': 0.9559233879538147}-{'f1_val': 0.7973836464341584, 'auprc': 0.9640001461693006, 'loss_val': 0.5056361851876123, 'psi': 0.8640302463282152}
[S4] START round=38 head_norm_before_train=2.124608 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9526742187959938, 'auprc': 0.9779073789554186, 'loss_val': 0.29577490801296175, 'psi': 0.9627674828597637}-{'f1_val': 0.9506883829775679, 'auprc': 0.9842568640097733, 'loss_val': 0.28086111348352677, 'psi': 0.9641157753904501}
[S5] START round=38 head_norm_before_train=1.253011 cos_to_last_merge=0.9998 (last merge round=36)
[S5] round=38 local utility u=0.942574 metrics={'f1_val': 0.6287530307199625, 'auprc': 0.9181981639808166, 'loss_val': 0.4322809077259631, 'psi': 0.7445310840243041}-{'f1_val': 0.43676623050537206, 'auprc': 0.8449653933172928, 'loss_val': 0.9458099566750822, 'psi': 0.6000458956301404}
[S6] START round=38 head_norm_before_train=1.317237 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.253512 metrics={'f1_val': 0.803179325134348, 'auprc': 0.9532795686894121, 'loss_val': 0.47356976375264376, 'psi': 0.8632194225563736}-{'f1_val': 0.7312556454635779, 'auprc': 0.9577906572964104, 'loss_val': 0.5625857957834723, 'psi': 0.8218696501967109}
[S7] START round=38 head_norm_before_train=1.318931 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.600333 metrics={'f1_val': 0.6755420011913207, 'auprc': 0.8350870888944009, 'loss_val': 0.42649831138044336, 'psi': 0.7393600362725528}-{'f1_val': 0.5570772343852204, 'auprc': 0.7846328920006606, 'loss_val': 0.7650136750339971, 'psi': 0.6480994974313965}
[S8] START round=38 head_norm_before_train=1.377777 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.002899 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990160654826314, 'loss_val': 0.0985963311553488, 'psi': 0.9949109704111196}-{'f1_val': 0.9923860096923637, 'auprc': 0.9986410547730757, 'loss_val': 0.10453924234827887, 'psi': 0.9948880277246486}
[S9] START round=38 head_norm_before_train=1.770072 cos_to_last_merge=0.9987 (last merge round=34)
[S9] round=38 local utility u=0.000822 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9981291087728523, 'loss_val': 0.03546671038867687, 'psi': 0.9966175297830029}-{'f1_val': 0.9958601375429889, 'auprc': 0.9981228743824204, 'loss_val': 0.038593479074348444, 'psi': 0.9967652322787615}
[S10] START round=38 head_norm_before_train=2.180687 (no previous merge yet)
[S10] round=38 local utility u=0.001337 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958732702362189, 'loss_val': 0.025126548169924767, 'psi': 0.9955431804327257}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954205032229899, 'loss_val': 0.026442478407400865, 'psi': 0.9953620736274342}
[S11] START round=38 head_norm_before_train=2.124971 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000576 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992160114818893, 'loss_val': 0.025186680266133965, 'psi': 0.997864958568502}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991538675583395, 'loss_val': 0.026152521912310524, 'psi': 0.997840100999082}
[S13] START round=38 head_norm_before_train=1.860085 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6543655406941561, 'auprc': 0.7903283354037918, 'loss_val': 0.818524554118063, 'psi': 0.7087506585780103}-{'f1_val': 0.6675252052081987, 'auprc': 0.7773586407215952, 'loss_val': 0.829965939880411, 'psi': 0.7114585794135573}
[S14] START round=38 head_norm_before_train=1.349419 cos_to_last_merge=0.9894 (last merge round=33)
[S14] round=38 local utility u=0.011635 metrics={'f1_val': 0.9978627957474508, 'auprc': 0.9986940515565361, 'loss_val': 0.07737820437391366, 'psi': 0.998195298071085}-{'f1_val': 0.9965603779504312, 'auprc': 0.9970402436768496, 'loss_val': 0.08787283505657974, 'psi': 0.9967523242409986}
[S15] START round=38 head_norm_before_train=1.360369 cos_to_last_merge=0.9978 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.717254257545734, 'auprc': 0.9137174334662144, 'loss_val': 0.44557994214187807, 'psi': 0.7958395279139262}-{'f1_val': 0.9950242077208795, 'auprc': 0.9971630012213291, 'loss_val': 0.058091984948384565, 'psi': 0.9958797251210594}
[S16] START round=38 head_norm_before_train=1.323854 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.730328 metrics={'f1_val': 0.9500158329721896, 'auprc': 0.9900302082621093, 'loss_val': 0.18775334151038478, 'psi': 0.9660215830881574}-{'f1_val': 0.8428805523800387, 'auprc': 0.9333531717317188, 'loss_val': 0.8355658937409676, 'psi': 0.8790696001207108}
[S17] START round=38 head_norm_before_train=1.879730 cos_to_last_merge=0.7825 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.7227035584647042, 'auprc': 0.8948865553302442, 'loss_val': 0.9787047987601073, 'psi': 0.7915767572109202}-{'f1_val': 0.8784285254060066, 'auprc': 0.9626084576206644, 'loss_val': 0.39720854243090936, 'psi': 0.9121004982918697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.9669
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9456
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] → sending delta(kind=head bytes=1809) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:49313
[S7] sending update (kind=head size=1809 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.9567
[S3] RECEIVED delta(kind=head bytes=1809) from S7
[S3] cosine check vs S7: cos=0.9456
[S16] RECEIVED delta(kind=head bytes=1796) from S14
[S16] cosine check vs S14: cos=0.9967
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.8993
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.8557
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=-0.0354
[S13] DROPPED delta from S10 (cos=-0.0354 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9048
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9567
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9527 head_norm=2.126543
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.778148e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9527 head_norm=2.131747 delta_norm=0.017781
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9364 head_norm=1.496285
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.389209e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9412 head_norm=1.423180 delta_norm=0.138921
[S3] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.7173 head_norm=1.418943
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.682922e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.7284 head_norm=1.296304 delta_norm=0.368292
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.6288 head_norm=1.272275
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.890835e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.6168 head_norm=1.281176 delta_norm=0.289083
[S5] aggregate: ROLLBACK (f1_val pre=0.629 post=0.617 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6755 head_norm=1.335019
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.466615e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6830 head_norm=1.396328 delta_norm=0.246662
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9922 head_norm=1.411174
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.092209e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9922 head_norm=1.439177 delta_norm=0.109221
[S8] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9500 head_norm=1.353247
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.652198e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9485 head_norm=1.364892 delta_norm=0.056522
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8032 head_norm=1.373342
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.057678e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.7938 head_norm=1.377098 delta_norm=0.205768
[S6] aggregate: ROLLBACK (f1_val pre=0.803 post=0.794 tol_abs=0.005 tol_rel=0.0)
[S2] START round=39 head_norm_before_train=1.467754 cos_to_last_merge=0.9998 (last merge round=37)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6951790829115463, 'auprc': 0.7685668736539778, 'loss_val': 0.6582629637499112, 'psi': 0.7245341992085189}-{'f1_val': 0.7135426936699494, 'auprc': 0.7747894163466599, 'loss_val': 0.6172477568398379, 'psi': 0.7380413827406336}
[S3] START round=39 head_norm_before_train=1.423180 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.238143 metrics={'f1_val': 0.994070966211684, 'auprc': 0.9999941581411185, 'loss_val': 0.10048566613738384, 'psi': 0.9964402429834578}-{'f1_val': 0.936427080069693, 'auprc': 0.9851678497799973, 'loss_val': 0.1864304071429047, 'psi': 0.9559233879538147}
[S4] START round=39 head_norm_before_train=2.131747 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9459012836210459, 'auprc': 0.9705398276317454, 'loss_val': 0.2868139356774687, 'psi': 0.9557567012253256}-{'f1_val': 0.9526742187959938, 'auprc': 0.9779073789554186, 'loss_val': 0.29577490801296175, 'psi': 0.9627674828597637}
[S5] START round=39 head_norm_before_train=1.281176 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.386532 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9891036215578851, 'loss_val': 0.30133795266683344, 'psi': 0.8158338077179694}-{'f1_val': 0.6287530307199625, 'auprc': 0.9181981639808166, 'loss_val': 0.4322809077259631, 'psi': 0.7445310840243041}
[S6] START round=39 head_norm_before_train=1.377098 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.438662 metrics={'f1_val': 0.9140790357667666, 'auprc': 0.9731199946915756, 'loss_val': 0.32116462090645714, 'psi': 0.9376954193366902}-{'f1_val': 0.803179325134348, 'auprc': 0.9532795686894121, 'loss_val': 0.47356976375264376, 'psi': 0.8632194225563736}
[S7] START round=39 head_norm_before_train=1.396328 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6331532754302448, 'auprc': 0.7964852910651063, 'loss_val': 0.5878700462687664, 'psi': 0.6984860816841895}-{'f1_val': 0.6755420011913207, 'auprc': 0.8350870888944009, 'loss_val': 0.42649831138044336, 'psi': 0.7393600362725528}
[S8] START round=39 head_norm_before_train=1.439177 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9977552619073182, 'loss_val': 0.08988622599553192, 'psi': 0.9933200763205805}-{'f1_val': 0.992174240363445, 'auprc': 0.9990160654826314, 'loss_val': 0.0985963311553488, 'psi': 0.9949109704111196}
[S9] START round=39 head_norm_before_train=1.784386 cos_to_last_merge=0.9981 (last merge round=34)
[S9] round=39 local utility u=0.001111 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9981369433065326, 'loss_val': 0.03326880408370524, 'psi': 0.9966206635964749}-{'f1_val': 0.9956098104564366, 'auprc': 0.9981291087728523, 'loss_val': 0.03546671038867687, 'psi': 0.9966175297830029}
[S10] START round=39 head_norm_before_train=2.184626 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954209914584567, 'loss_val': 0.02619830910306938, 'psi': 0.9953622689216208}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958732702362189, 'loss_val': 0.025126548169924767, 'psi': 0.9955431804327257}
[S11] START round=39 head_norm_before_train=2.137086 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=39 local utility u=0.000423 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989025578762842, 'loss_val': 0.02340115815645679, 'psi': 0.99773957712626}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992160114818893, 'loss_val': 0.025186680266133965, 'psi': 0.997864958568502}
[S13] START round=39 head_norm_before_train=1.870310 (no previous merge yet)
[S13] round=39 local utility u=0.180894 metrics={'f1_val': 0.6943132238418049, 'auprc': 0.8092539151202689, 'loss_val': 0.7531989771933413, 'psi': 0.7402895003531905}-{'f1_val': 0.6543655406941561, 'auprc': 0.7903283354037918, 'loss_val': 0.818524554118063, 'psi': 0.7087506585780103}
[S14] START round=39 head_norm_before_train=1.378757 cos_to_last_merge=0.9867 (last merge round=33)
[S14] round=39 local utility u=0.003064 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9982980311181311, 'loss_val': 0.06980153598880631, 'psi': 0.9980109232275834}-{'f1_val': 0.9978627957474508, 'auprc': 0.9986940515565361, 'loss_val': 0.07737820437391366, 'psi': 0.998195298071085}
[S15] START round=39 head_norm_before_train=1.296304 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.633431 metrics={'f1_val': 0.85650672715938, 'auprc': 0.9922672764177971, 'loss_val': 0.24988259873116878, 'psi': 0.9108109468627468}-{'f1_val': 0.717254257545734, 'auprc': 0.9137174334662144, 'loss_val': 0.44557994214187807, 'psi': 0.7958395279139262}
[S16] START round=39 head_norm_before_train=1.364892 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8810520011327586, 'auprc': 0.9859783232544962, 'loss_val': 0.30714684978910806, 'psi': 0.9230225299814536}-{'f1_val': 0.9500158329721896, 'auprc': 0.9900302082621093, 'loss_val': 0.18775334151038478, 'psi': 0.9660215830881574}
[S17] START round=39 head_norm_before_train=1.894577 cos_to_last_merge=0.7816 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.9063868705903755, 'auprc': 0.9716757556954552, 'loss_val': 0.24026374903659067, 'psi': 0.9325024246324074}-{'f1_val': 0.7227035584647042, 'auprc': 0.8948865553302442, 'loss_val': 0.9787047987601073, 'psi': 0.7915767572109202}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] → sending delta(kind=head bytes=1808) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9980
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0352
[S10] DROPPED delta from S13 (cos=-0.0352 < 0.0)
[S15] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9685
[S15] RECEIVED delta(kind=head bytes=1806) from S5
[S15] cosine check vs S5: cos=0.8967
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.9202
[S2] RECEIVED delta(kind=head bytes=1808) from S15
[S2] cosine check vs S15: cos=0.9506
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=0.9908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=39 metric=0.6952 head_norm=1.505622
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.377927e-01
[S2] stored merged vector for next round verification (round=39)
[S2] DEBUG after merge:  round=39 metric=0.6915 head_norm=1.407151 delta_norm=0.237793
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] r=40 psi=0.725 u=0.0000 p_local=0.0757 f1=0.695 auprc=0.769 bytes=37780
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0012 f1=0.995 auprc=0.995 bytes=36017
[S6] r=40 psi=0.938 u=0.4387 p_local=0.3207 f1=0.914 auprc=0.973 bytes=36005
[S5] r=40 psi=0.816 u=0.3865 p_local=0.2981 f1=0.700 auprc=0.989 bytes=36006
[S9] r=40 psi=0.997 u=0.0011 p_local=0.0083 f1=0.996 auprc=0.998 bytes=37829
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9459 head_norm=2.131980
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.290943e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9466 head_norm=2.140831 delta_norm=0.022909
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.956 u=0.0000 p_local=0.0098 f1=0.946 auprc=0.971 bytes=39525
[S3] r=40 psi=0.996 u=0.2381 p_local=0.3141 f1=0.994 auprc=1.000 bytes=39554
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6332 head_norm=1.411153
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.903246e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6368 head_norm=1.428183 delta_norm=0.099032
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.698 u=0.0000 p_local=0.2123 f1=0.633 auprc=0.796 bytes=32405
[S13] r=40 psi=0.740 u=0.1809 p_local=0.0961 f1=0.694 auprc=0.809 bytes=32386
[S11] r=40 psi=0.998 u=0.0004 p_local=0.0057 f1=0.997 auprc=0.999 bytes=39549
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.8811 head_norm=1.392887
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.492439e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.8822 head_norm=1.399846 delta_norm=0.044924
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.923 u=0.0000 p_local=0.2292 f1=0.881 auprc=0.986 bytes=37779
[S14] r=40 psi=0.998 u=0.0031 p_local=0.0170 f1=0.998 auprc=0.998 bytes=32351
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.8565 head_norm=1.344001
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.008400e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.8678 head_norm=1.285453 delta_norm=0.300840
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.911 u=0.6334 p_local=0.3595 f1=0.857 auprc=0.992 bytes=32393
[S17] r=40 psi=0.933 u=1.0000 p_local=0.3653 f1=0.906 auprc=0.972 bytes=32367
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9904 head_norm=1.479642
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.015581e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9904 head_norm=1.505063 delta_norm=0.101558
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] r=40 psi=0.993 u=0.0000 p_local=0.1211 f1=0.990 auprc=0.998 bytes=35941
[S2] START round=40 head_norm_before_train=1.407151 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=40 local utility u=0.111506 metrics={'f1_val': 0.7153937442816716, 'auprc': 0.7980604692420449, 'loss_val': 0.6450192702619857, 'psi': 0.748460434265821}-{'f1_val': 0.6951790829115463, 'auprc': 0.7685668736539778, 'loss_val': 0.6582629637499112, 'psi': 0.7245341992085189}
[S3] START round=40 head_norm_before_train=1.451784 cos_to_last_merge=0.9998 (last merge round=38)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9998630877462926, 'loss_val': 0.10703021317963904, 'psi': 0.9777237812294342}-{'f1_val': 0.994070966211684, 'auprc': 0.9999941581411185, 'loss_val': 0.10048566613738384, 'psi': 0.9964402429834578}
[S4] START round=40 head_norm_before_train=2.140831 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.037171 metrics={'f1_val': 0.9487194740509319, 'auprc': 0.985583956067336, 'loss_val': 0.27451435685251807, 'psi': 0.9634652668574936}-{'f1_val': 0.9459012836210459, 'auprc': 0.9705398276317454, 'loss_val': 0.2868139356774687, 'psi': 0.9557567012253256}
[S5] START round=40 head_norm_before_train=1.295934 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6688375904765398, 'auprc': 0.8548185797167152, 'loss_val': 0.478747251283037, 'psi': 0.7432299861726099}-{'f1_val': 0.700320598491359, 'auprc': 0.9891036215578851, 'loss_val': 0.30133795266683344, 'psi': 0.8158338077179694}
[S6] START round=40 head_norm_before_train=1.440641 cos_to_last_merge=0.9977 (last merge round=38)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7470694912680801, 'auprc': 0.9512617133187529, 'loss_val': 0.6007463179560261, 'psi': 0.8287463800883492}-{'f1_val': 0.9140790357667666, 'auprc': 0.9731199946915756, 'loss_val': 0.32116462090645714, 'psi': 0.9376954193366902}
[S7] START round=40 head_norm_before_train=1.428183 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.359224 metrics={'f1_val': 0.6889493586010869, 'auprc': 0.8561947271615368, 'loss_val': 0.3833261430421236, 'psi': 0.7558475060252668}-{'f1_val': 0.6331532754302448, 'auprc': 0.7964852910651063, 'loss_val': 0.5878700462687664, 'psi': 0.6984860816841895}
[S8] START round=40 head_norm_before_train=1.505063 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9987180907092684, 'loss_val': 0.0847189189447836, 'psi': 0.9924118922838452}-{'f1_val': 0.990363285929422, 'auprc': 0.9977552619073182, 'loss_val': 0.08988622599553192, 'psi': 0.9933200763205805}
[S9] START round=40 head_norm_before_train=1.796025 cos_to_last_merge=0.9974 (last merge round=34)
[S9] round=40 local utility u=0.003954 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9981422851661577, 'loss_val': 0.03035184484629341, 'psi': 0.9971202067932348}-{'f1_val': 0.9956098104564366, 'auprc': 0.9981369433065326, 'loss_val': 0.03326880408370524, 'psi': 0.9966206635964749}
[S10] START round=40 head_norm_before_train=2.193440 (no previous merge yet)
[S10] round=40 local utility u=0.000661 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956388661169581, 'loss_val': 0.025529491802943727, 'psi': 0.9954494187850214}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954209914584567, 'loss_val': 0.02619830910306938, 'psi': 0.9953622689216208}
[S11] START round=40 head_norm_before_train=2.149889 cos_to_last_merge=0.9999 (last merge round=37)
[S11] round=40 local utility u=0.000445 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988808799946285, 'loss_val': 0.02244613415428158, 'psi': 0.9977309059735977}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989025578762842, 'loss_val': 0.02340115815645679, 'psi': 0.99773957712626}
[S13] START round=40 head_norm_before_train=1.876512 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.61928605011774, 'auprc': 0.7294273444027974, 'loss_val': 1.0559236597865096, 'psi': 0.663342567831763}-{'f1_val': 0.6943132238418049, 'auprc': 0.8092539151202689, 'loss_val': 0.7531989771933413, 'psi': 0.7402895003531905}
[S14] START round=40 head_norm_before_train=1.408205 cos_to_last_merge=0.9839 (last merge round=33)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9864600136269213, 'auprc': 0.9983525251148191, 'loss_val': 0.07237798837035152, 'psi': 0.9912170182220803}-{'f1_val': 0.9978195179672185, 'auprc': 0.9982980311181311, 'loss_val': 0.06980153598880631, 'psi': 0.9980109232275834}
[S15] START round=40 head_norm_before_train=1.285453 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7398937583347157, 'auprc': 0.9337848825397524, 'loss_val': 0.3821136027289335, 'psi': 0.8174502080167304}-{'f1_val': 0.85650672715938, 'auprc': 0.9922672764177971, 'loss_val': 0.24988259873116878, 'psi': 0.9108109468627468}
[S16] START round=40 head_norm_before_train=1.399846 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.450016 metrics={'f1_val': 0.9908629932913957, 'auprc': 0.9924536943611106, 'loss_val': 0.08540665382550576, 'psi': 0.9914992737192817}-{'f1_val': 0.8810520011327586, 'auprc': 0.9859783232544962, 'loss_val': 0.30714684978910806, 'psi': 0.9230225299814536}
[S17] START round=40 head_norm_before_train=1.906677 cos_to_last_merge=0.7811 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.7962086646594912, 'auprc': 0.9358071149892313, 'loss_val': 0.6984116908523789, 'psi': 0.8520480447913873}-{'f1_val': 0.9063868705903755, 'auprc': 0.9716757556954552, 'loss_val': 0.24026374903659067, 'psi': 0.9325024246324074}
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.014 → S16@127.0.0.1:49316
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] ⇄ pheromone p=0.077 → S10@127.0.0.1:49311
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=-0.0360
[S13] DROPPED delta from S10 (cos=-0.0360 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9962
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.9517
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9351
[S7] ⇄ pheromone p=0.242 → S3@127.0.0.1:49303
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:49313
[S4] ⇄ pheromone p=0.015 → S11@127.0.0.1:49312
[S9] ⇄ pheromone p=0.007 → S8@127.0.0.1:49309
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9630 head_norm=1.480085
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.017571e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9625 head_norm=1.445899 delta_norm=0.101757
[S3] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.251 → S7@127.0.0.1:49308
[S2] ⇄ pheromone p=0.083 → S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.239 → S15@127.0.0.1:49315
[S6] ⇄ pheromone p=0.257 → S8@127.0.0.1:49309
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S5] RECEIVED delta(kind=head bytes=1803) from S16
[S5] cosine check vs S16: cos=0.9617
[S15] ⇄ pheromone p=0.288 → S5@127.0.0.1:49305
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9882 head_norm=1.547339
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.277513e-01
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9882 head_norm=1.649488 delta_norm=0.327751
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.097 → S6@127.0.0.1:49307
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9970 head_norm=2.162004
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.239950e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9970 head_norm=2.152810 delta_norm=0.022400
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.005 → S4@127.0.0.1:49304
[S16] ⇄ pheromone p=0.273 → S5@127.0.0.1:49305
[S2] START round=41 head_norm_before_train=1.443079 cos_to_last_merge=0.9997 (last merge round=39)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6918214516197772, 'auprc': 0.7567443503033675, 'loss_val': 0.7342725501428774, 'psi': 0.7177906110932133}-{'f1_val': 0.7153937442816716, 'auprc': 0.7980604692420449, 'loss_val': 0.6450192702619857, 'psi': 0.748460434265821}
[S3] START round=41 head_norm_before_train=1.445899 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9369131206861159, 'auprc': 0.984477019194668, 'loss_val': 0.18576641013640324, 'psi': 0.9559386800895368}-{'f1_val': 0.9629642435515284, 'auprc': 0.9998630877462926, 'loss_val': 0.10703021317963904, 'psi': 0.9777237812294342}
[S4] START round=41 head_norm_before_train=2.143810 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9504562818557433, 'auprc': 0.9667197735313141, 'loss_val': 0.28468886371001706, 'psi': 0.9569616785259716}-{'f1_val': 0.9487194740509319, 'auprc': 0.985583956067336, 'loss_val': 0.27451435685251807, 'psi': 0.9634652668574936}
[S5] START round=41 head_norm_before_train=1.313216 cos_to_last_merge=0.9992 (last merge round=38)
[S5] round=41 local utility u=0.147291 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8650439699599852, 'loss_val': 0.40373922640031285, 'psi': 0.7662099470788095}-{'f1_val': 0.6688375904765398, 'auprc': 0.8548185797167152, 'loss_val': 0.478747251283037, 'psi': 0.7432299861726099}
[S6] START round=41 head_norm_before_train=1.497064 cos_to_last_merge=0.9929 (last merge round=38)
[S6] round=41 local utility u=0.379334 metrics={'f1_val': 0.8448184011297584, 'auprc': 0.9607469766590119, 'loss_val': 0.457027191086505, 'psi': 0.8911898313414597}-{'f1_val': 0.7470694912680801, 'auprc': 0.9512617133187529, 'loss_val': 0.6007463179560261, 'psi': 0.8287463800883492}
[S7] START round=41 head_norm_before_train=1.443041 cos_to_last_merge=0.9998 (last merge round=39)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5381934873217763, 'auprc': 0.7815172915693804, 'loss_val': 0.8548520773943836, 'psi': 0.6355230090208179}-{'f1_val': 0.6889493586010869, 'auprc': 0.8561947271615368, 'loss_val': 0.3833261430421236, 'psi': 0.7558475060252668}
[S8] START round=41 head_norm_before_train=1.649488 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.017124 metrics={'f1_val': 0.9920222688347867, 'auprc': 0.9986859925845201, 'loss_val': 0.07326087444118355, 'psi': 0.99468775833468}-{'f1_val': 0.9882077600002297, 'auprc': 0.9987180907092684, 'loss_val': 0.0847189189447836, 'psi': 0.9924118922838452}
[S9] START round=41 head_norm_before_train=1.806158 cos_to_last_merge=0.9969 (last merge round=34)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9981426271990435, 'loss_val': 0.044867399440819224, 'psi': 0.993606594695905}-{'f1_val': 0.9964388212112862, 'auprc': 0.9981422851661577, 'loss_val': 0.03035184484629341, 'psi': 0.9971202067932348}
[S10] START round=41 head_norm_before_train=2.203568 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956370827711986, 'loss_val': 0.02585679823466188, 'psi': 0.9954487054467176}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956388661169581, 'loss_val': 0.025529491802943727, 'psi': 0.9954494187850214}
[S11] START round=41 head_norm_before_train=2.152810 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988809379062629, 'loss_val': 0.022699416766532164, 'psi': 0.9977309291382515}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988808799946285, 'loss_val': 0.02244613415428158, 'psi': 0.9977309059735977}
[S13] START round=41 head_norm_before_train=1.874843 (no previous merge yet)
[S13] round=41 local utility u=0.280035 metrics={'f1_val': 0.6538848277319362, 'auprc': 0.7872462028901995, 'loss_val': 0.8769028110922078, 'psi': 0.7072293777952415}-{'f1_val': 0.61928605011774, 'auprc': 0.7294273444027974, 'loss_val': 1.0559236597865096, 'psi': 0.663342567831763}
[S14] START round=41 head_norm_before_train=1.434186 cos_to_last_merge=0.9814 (last merge round=33)
[S14] round=41 local utility u=0.041352 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9984452423828395, 'loss_val': 0.05317767191349087, 'psi': 0.9975766018477348}-{'f1_val': 0.9864600136269213, 'auprc': 0.9983525251148191, 'loss_val': 0.07237798837035152, 'psi': 0.9912170182220803}
[S15] START round=41 head_norm_before_train=1.334946 cos_to_last_merge=0.9993 (last merge round=39)
[S15] round=41 local utility u=0.907642 metrics={'f1_val': 0.9660192887430612, 'auprc': 0.9894168571126961, 'loss_val': 0.09047947293209406, 'psi': 0.9753783160909151}-{'f1_val': 0.7398937583347157, 'auprc': 0.9337848825397524, 'loss_val': 0.3821136027289335, 'psi': 0.8174502080167304}
[S16] START round=41 head_norm_before_train=1.426542 cos_to_last_merge=0.9998 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8384168330163326, 'auprc': 0.8389999938192486, 'loss_val': 0.9368904786289649, 'psi': 0.8386500973374991}-{'f1_val': 0.9908629932913957, 'auprc': 0.9924536943611106, 'loss_val': 0.08540665382550576, 'psi': 0.9914992737192817}
[S17] START round=41 head_norm_before_train=1.918610 cos_to_last_merge=0.7805 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=41 local utility u=0.558702 metrics={'f1_val': 0.909340946177243, 'auprc': 0.9657891294868816, 'loss_val': 0.34974764430411015, 'psi': 0.9319202195010985}-{'f1_val': 0.7962086646594912, 'auprc': 0.9358071149892313, 'loss_val': 0.6984116908523789, 'psi': 0.8520480447913873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:49315
[S6] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9505 head_norm=2.145866
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.592125e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9505 head_norm=2.153794 delta_norm=0.025921
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1807) from S6
[S8] cosine check vs S6: cos=0.8613
[S16] RECEIVED delta(kind=head bytes=1806) from S14
[S16] cosine check vs S14: cos=0.9973
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1806) from S5
[S15] cosine check vs S5: cos=0.9661
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9661
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.7003 head_norm=1.331587
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.548137e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.7003 head_norm=1.343211 delta_norm=0.075481
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0367
[S10] DROPPED delta from S13 (cos=-0.0367 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:49307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.8613
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9660 head_norm=1.380575
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.782741e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9687 head_norm=1.344535 delta_norm=0.178274
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.8384 head_norm=1.450311
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.348698e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.8382 head_norm=1.452710 delta_norm=0.053487
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9920 head_norm=1.686212
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.311279e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9920 head_norm=1.560552 delta_norm=0.431128
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.478218 cos_to_last_merge=0.9989 (last merge round=39)
[S2] round=42 local utility u=0.133784 metrics={'f1_val': 0.7127392704829134, 'auprc': 0.7842196809689395, 'loss_val': 0.67463768959108, 'psi': 0.7413314346773239}-{'f1_val': 0.6918214516197772, 'auprc': 0.7567443503033675, 'loss_val': 0.7342725501428774, 'psi': 0.7177906110932133}
[S3] START round=42 head_norm_before_train=1.470291 cos_to_last_merge=0.9999 (last merge round=40)
[S3] round=42 local utility u=0.253263 metrics={'f1_val': 0.9953464457261353, 'auprc': 0.9997621066936785, 'loss_val': 0.07569478569930219, 'psi': 0.9971127101131525}-{'f1_val': 0.9369131206861159, 'auprc': 0.984477019194668, 'loss_val': 0.18576641013640324, 'psi': 0.9559386800895368}
[S4] START round=42 head_norm_before_train=2.153794 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.015631 metrics={'f1_val': 0.952291648091128, 'auprc': 0.9729713590000677, 'loss_val': 0.2831935969828085, 'psi': 0.9605635324547038}-{'f1_val': 0.9504562818557433, 'auprc': 0.9667197735313141, 'loss_val': 0.28468886371001706, 'psi': 0.9569616785259716}
[S5] START round=42 head_norm_before_train=1.343211 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.048526 metrics={'f1_val': 0.6651900325082571, 'auprc': 0.9499864220503893, 'loss_val': 0.3507317870008887, 'psi': 0.7791085883251101}-{'f1_val': 0.700320598491359, 'auprc': 0.8650439699599852, 'loss_val': 0.40373922640031285, 'psi': 0.7662099470788095}
[S6] START round=42 head_norm_before_train=1.548894 cos_to_last_merge=0.9875 (last merge round=38)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7866366773541702, 'auprc': 0.9621974019352857, 'loss_val': 0.5247884634179296, 'psi': 0.8568609671866164}-{'f1_val': 0.8448184011297584, 'auprc': 0.9607469766590119, 'loss_val': 0.457027191086505, 'psi': 0.8911898313414597}
[S7] START round=42 head_norm_before_train=1.459920 cos_to_last_merge=0.9993 (last merge round=39)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.6999222856845486, 'auprc': 0.9940990002410282, 'loss_val': 0.23423793631661324, 'psi': 0.8175929715071404}-{'f1_val': 0.5381934873217763, 'auprc': 0.7815172915693804, 'loss_val': 0.8548520773943836, 'psi': 0.6355230090208179}
[S8] START round=42 head_norm_before_train=1.560552 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.006612 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9943230739590914, 'loss_val': 0.05569717131998091, 'psi': 0.993817546425011}-{'f1_val': 0.9920222688347867, 'auprc': 0.9986859925845201, 'loss_val': 0.07326087444118355, 'psi': 0.99468775833468}
[S9] START round=42 head_norm_before_train=1.815727 cos_to_last_merge=0.9964 (last merge round=34)
[S9] round=42 local utility u=0.027370 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9981418924126119, 'loss_val': 0.027744723710364294, 'psi': 0.997368308220399}-{'f1_val': 0.990582573027146, 'auprc': 0.9981426271990435, 'loss_val': 0.044867399440819224, 'psi': 0.993606594695905}
[S10] START round=42 head_norm_before_train=2.208419 (no previous merge yet)
[S10] round=42 local utility u=0.000477 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958647677523167, 'loss_val': 0.025585997831041204, 'psi': 0.9955397794391649}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956370827711986, 'loss_val': 0.02585679823466188, 'psi': 0.9954487054467176}
[S11] START round=42 head_norm_before_train=2.163929 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990539761249101, 'loss_val': 0.022479907877771717, 'psi': 0.9975521434470224}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988809379062629, 'loss_val': 0.022699416766532164, 'psi': 0.9977309291382515}
[S13] START round=42 head_norm_before_train=1.874170 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6302868145004408, 'auprc': 0.7472423210214119, 'loss_val': 0.977235640439009, 'psi': 0.6770690171088292}-{'f1_val': 0.6538848277319362, 'auprc': 0.7872462028901995, 'loss_val': 0.8769028110922078, 'psi': 0.7072293777952415}
[S14] START round=42 head_norm_before_train=1.457068 cos_to_last_merge=0.9793 (last merge round=33)
[S14] round=42 local utility u=0.002225 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9985449342784847, 'loss_val': 0.04902649779133665, 'psi': 0.9976164786059929}-{'f1_val': 0.9969975081576651, 'auprc': 0.9984452423828395, 'loss_val': 0.05317767191349087, 'psi': 0.9975766018477348}
[S15] START round=42 head_norm_before_train=1.344535 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.116981 metrics={'f1_val': 0.995476843408438, 'auprc': 0.996679887067177, 'loss_val': 0.05505254041419437, 'psi': 0.9959580608719336}-{'f1_val': 0.9660192887430612, 'auprc': 0.9894168571126961, 'loss_val': 0.09047947293209406, 'psi': 0.9753783160909151}
[S16] START round=42 head_norm_before_train=1.452710 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.976695 metrics={'f1_val': 0.9580449149721284, 'auprc': 0.9912721668987792, 'loss_val': 0.1580848604516205, 'psi': 0.9713358157427887}-{'f1_val': 0.8384168330163326, 'auprc': 0.8389999938192486, 'loss_val': 0.9368904786289649, 'psi': 0.8386500973374991}
[S17] START round=42 head_norm_before_train=1.935960 cos_to_last_merge=0.7793 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.7670812784676747, 'auprc': 0.9239756274660521, 'loss_val': 0.8412856453819957, 'psi': 0.8298390180670256}-{'f1_val': 0.909340946177243, 'auprc': 0.9657891294868816, 'loss_val': 0.34974764430411015, 'psi': 0.9319202195010985}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.7866 head_norm=1.579900
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.455600e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.7661 head_norm=1.571997 delta_norm=0.445560
[S6] aggregate: ROLLBACK (f1_val pre=0.787 post=0.766 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.0366
[S13] DROPPED delta from S10 (cos=-0.0366 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9873
[S16] RECEIVED delta(kind=head bytes=1794) from S14
[S16] cosine check vs S14: cos=0.9986
[S2] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:49305
[S3] RECEIVED delta(kind=head bytes=1805) from S2
[S3] cosine check vs S2: cos=0.9686
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9897
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=0.9897
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9873
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9953 head_norm=1.491491
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.319194e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9953 head_norm=1.478016 delta_norm=0.063192
[S3] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] cosine check vs S9: cos=0.9009
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9935 head_norm=1.598541
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.965526e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9935 head_norm=1.668751 delta_norm=0.396553
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9586
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9955 head_norm=1.389905
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.956574e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9955 head_norm=1.374356 delta_norm=0.099566
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9580 head_norm=1.472290
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.976190e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9570 head_norm=1.475266 delta_norm=0.039762
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.6652 head_norm=1.365906
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.657527e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.6640 head_norm=1.381211 delta_norm=0.066575
[S5] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.514156 cos_to_last_merge=0.9977 (last merge round=39)
[S2] round=43 local utility u=0.015102 metrics={'f1_val': 0.7147053453589338, 'auprc': 0.7957078195761415, 'loss_val': 0.6906937919219924, 'psi': 0.7471063350458169}-{'f1_val': 0.7127392704829134, 'auprc': 0.7842196809689395, 'loss_val': 0.67463768959108, 'psi': 0.7413314346773239}
[S3] START round=43 head_norm_before_train=1.478016 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.953513151713435, 'auprc': 0.9860518660626765, 'loss_val': 0.15308080874093055, 'psi': 0.9665286374531316}-{'f1_val': 0.9953464457261353, 'auprc': 0.9997621066936785, 'loss_val': 0.07569478569930219, 'psi': 0.9971127101131525}
[S4] START round=43 head_norm_before_train=2.156988 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.014860 metrics={'f1_val': 0.9528246068278415, 'auprc': 0.9810566829816112, 'loss_val': 0.2809264696839389, 'psi': 0.9641174372893495}-{'f1_val': 0.952291648091128, 'auprc': 0.9729713590000677, 'loss_val': 0.2831935969828085, 'psi': 0.9605635324547038}
[S5] START round=43 head_norm_before_train=1.381211 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.5812535976521477, 'auprc': 0.8592302865972512, 'loss_val': 0.6784539841334997, 'psi': 0.6924442732301891}-{'f1_val': 0.6651900325082571, 'auprc': 0.9499864220503893, 'loss_val': 0.3507317870008887, 'psi': 0.7791085883251101}
[S6] START round=43 head_norm_before_train=1.571997 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6224516764953272, 'auprc': 0.9462698119630187, 'loss_val': 0.7506754359109729, 'psi': 0.7519789306824038}-{'f1_val': 0.7866366773541702, 'auprc': 0.9621974019352857, 'loss_val': 0.5247884634179296, 'psi': 0.8568609671866164}
[S7] START round=43 head_norm_before_train=1.475993 cos_to_last_merge=0.9985 (last merge round=39)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.4113738871663766, 'auprc': 0.779459844833345, 'loss_val': 1.1569619032291156, 'psi': 0.558608270233164}-{'f1_val': 0.6999222856845486, 'auprc': 0.9940990002410282, 'loss_val': 0.23423793631661324, 'psi': 0.8175929715071404}
[S8] START round=43 head_norm_before_train=1.668751 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9988313365689797, 'loss_val': 0.06773772688855441, 'psi': 0.9948370788456589}-{'f1_val': 0.9934805280689575, 'auprc': 0.9943230739590914, 'loss_val': 0.05569717131998091, 'psi': 0.993817546425011}
[S9] START round=43 head_norm_before_train=1.824455 cos_to_last_merge=0.9960 (last merge round=34)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.998152589354922, 'loss_val': 0.027790238328843, 'psi': 0.9971243284687406}-{'f1_val': 0.9968525854255906, 'auprc': 0.9981418924126119, 'loss_val': 0.027744723710364294, 'psi': 0.997368308220399}
[S10] START round=43 head_norm_before_train=2.215581 (no previous merge yet)
[S10] round=43 local utility u=0.000077 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958897776287704, 'loss_val': 0.02550674330347504, 'psi': 0.9955497833897464}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958647677523167, 'loss_val': 0.025585997831041204, 'psi': 0.9955397794391649}
[S11] START round=43 head_norm_before_train=2.174324 cos_to_last_merge=0.9999 (last merge round=40)
[S11] round=43 local utility u=0.001327 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990055048085817, 'loss_val': 0.02216101026479475, 'psi': 0.9977807558991789}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990539761249101, 'loss_val': 0.022479907877771717, 'psi': 0.9975521434470224}
[S13] START round=43 head_norm_before_train=1.880102 (no previous merge yet)
[S13] round=43 local utility u=0.223814 metrics={'f1_val': 0.6911328956105508, 'auprc': 0.7271861296493368, 'loss_val': 0.8345149417658736, 'psi': 0.7055541892260653}-{'f1_val': 0.6302868145004408, 'auprc': 0.7472423210214119, 'loss_val': 0.977235640439009, 'psi': 0.6770690171088292}
[S14] START round=43 head_norm_before_train=1.479306 cos_to_last_merge=0.9771 (last merge round=33)
[S14] round=43 local utility u=0.001252 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9982457498806641, 'loss_val': 0.050424041637848506, 'psi': 0.9979768061082023}-{'f1_val': 0.9969975081576651, 'auprc': 0.9985449342784847, 'loss_val': 0.04902649779133665, 'psi': 0.9976164786059929}
[S15] START round=43 head_norm_before_train=1.374356 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.777629516574415, 'auprc': 0.992666954456457, 'loss_val': 0.3529786931143549, 'psi': 0.8636444917272318}-{'f1_val': 0.995476843408438, 'auprc': 0.996679887067177, 'loss_val': 0.05505254041419437, 'psi': 0.9959580608719336}
[S16] START round=43 head_norm_before_train=1.475266 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.139748 metrics={'f1_val': 0.9902245449521159, 'auprc': 0.9928472562619773, 'loss_val': 0.07639190982781524, 'psi': 0.9912736294760605}-{'f1_val': 0.9580449149721284, 'auprc': 0.9912721668987792, 'loss_val': 0.1580848604516205, 'psi': 0.9713358157427887}
[S17] START round=43 head_norm_before_train=1.946563 cos_to_last_merge=0.7788 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=43 local utility u=0.257142 metrics={'f1_val': 0.8147129705150129, 'auprc': 0.9426911555737059, 'loss_val': 0.6689375703462149, 'psi': 0.8659042445384901}-{'f1_val': 0.7670812784676747, 'auprc': 0.9239756274660521, 'loss_val': 0.8412856453819957, 'psi': 0.8298390180670256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:49311
[S4] not sending this round → trigger blocked (psi=0.964)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.747)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.4114 head_norm=1.484430
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.234863e-01
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.4119 head_norm=1.482832 delta_norm=0.123486
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=-0.0364
[S10] DROPPED delta from S13 (cos=-0.0364 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0364
[S13] DROPPED delta from S10 (cos=-0.0364 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9998
[S16] not sending this round → trigger blocked (psi=0.991)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9970 head_norm=2.184179
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.548630e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9970 head_norm=2.170477 delta_norm=0.025486
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.538764 cos_to_last_merge=0.9968 (last merge round=39)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.721917139936282, 'auprc': 0.746228340243739, 'loss_val': 0.749229239741381, 'psi': 0.7316416200592648}-{'f1_val': 0.7147053453589338, 'auprc': 0.7957078195761415, 'loss_val': 0.6906937919219924, 'psi': 0.7471063350458169}
[S3] START round=44 head_norm_before_train=1.500170 cos_to_last_merge=0.9999 (last merge round=42)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8966925948231823, 'auprc': 0.9923554688357555, 'loss_val': 0.22637253348285966, 'psi': 0.9349577444282116}-{'f1_val': 0.953513151713435, 'auprc': 0.9860518660626765, 'loss_val': 0.15308080874093055, 'psi': 0.9665286374531316}
[S4] START round=44 head_norm_before_train=2.168008 cos_to_last_merge=0.9999 (last merge round=41)
[S4] round=44 local utility u=0.009062 metrics={'f1_val': 0.9525294695696207, 'auprc': 0.9855832495674215, 'loss_val': 0.2746111332251183, 'psi': 0.9657509815687411}-{'f1_val': 0.9528246068278415, 'auprc': 0.9810566829816112, 'loss_val': 0.2809264696839389, 'psi': 0.9641174372893495}
[S5] START round=44 head_norm_before_train=1.403791 cos_to_last_merge=0.9996 (last merge round=42)
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.8332280552576501, 'auprc': 0.9645747575484604, 'loss_val': 0.32301862324636893, 'psi': 0.8857667361739743}-{'f1_val': 0.5812535976521477, 'auprc': 0.8592302865972512, 'loss_val': 0.6784539841334997, 'psi': 0.6924442732301891}
[S6] START round=44 head_norm_before_train=1.615926 cos_to_last_merge=0.9992 (last merge round=42)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.9633386884341948, 'auprc': 0.9924993315536697, 'loss_val': 0.1475592462916484, 'psi': 0.9750029456819846}-{'f1_val': 0.6224516764953272, 'auprc': 0.9462698119630187, 'loss_val': 0.7506754359109729, 'psi': 0.7519789306824038}
[S7] START round=44 head_norm_before_train=1.482832 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=1.000000 metrics={'f1_val': 0.6952726706758381, 'auprc': 0.9339395024440283, 'loss_val': 0.2778527450504776, 'psi': 0.7907394033831141}-{'f1_val': 0.4113738871663766, 'auprc': 0.779459844833345, 'loss_val': 1.1569619032291156, 'psi': 0.558608270233164}
[S8] START round=44 head_norm_before_train=1.696232 cos_to_last_merge=0.9997 (last merge round=42)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9815282929982607, 'auprc': 0.9988097084035544, 'loss_val': 0.08404402750889167, 'psi': 0.9884408591603782}-{'f1_val': 0.992174240363445, 'auprc': 0.9988313365689797, 'loss_val': 0.06773772688855441, 'psi': 0.9948370788456589}
[S9] START round=44 head_norm_before_train=1.830766 cos_to_last_merge=0.9956 (last merge round=34)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.998161313924693, 'loss_val': 0.03764784811224849, 'psi': 0.9938669282420906}-{'f1_val': 0.9964388212112862, 'auprc': 0.998152589354922, 'loss_val': 0.027790238328843, 'psi': 0.9971243284687406}
[S10] START round=44 head_norm_before_train=2.224921 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956631380061446, 'loss_val': 0.025933525967310543, 'psi': 0.9954591275406961}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958897776287704, 'loss_val': 0.02550674330347504, 'psi': 0.9955497833897464}
[S11] START round=44 head_norm_before_train=2.170477 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000439 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988971466644385, 'loss_val': 0.02095782623955563, 'psi': 0.9977374126415217}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990055048085817, 'loss_val': 0.02216101026479475, 'psi': 0.9977807558991789}
[S13] START round=44 head_norm_before_train=1.885346 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.636562075882314, 'auprc': 0.7495835613174009, 'loss_val': 0.8664284760241248, 'psi': 0.6817706700563487}-{'f1_val': 0.6911328956105508, 'auprc': 0.7271861296493368, 'loss_val': 0.8345149417658736, 'psi': 0.7055541892260653}
[S14] START round=44 head_norm_before_train=1.499681 cos_to_last_merge=0.9751 (last merge round=33)
[S14] round=44 local utility u=0.000631 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9988881822270166, 'loss_val': 0.049901217622850214, 'psi': 0.9981149430405867}-{'f1_val': 0.9977975102598944, 'auprc': 0.9982457498806641, 'loss_val': 0.050424041637848506, 'psi': 0.9979768061082023}
[S15] START round=44 head_norm_before_train=1.420865 cos_to_last_merge=0.9994 (last merge round=42)
[S15] round=44 local utility u=0.450980 metrics={'f1_val': 0.8975786713734765, 'auprc': 0.9950183682397096, 'loss_val': 0.17776721007593177, 'psi': 0.9365545501199697}-{'f1_val': 0.777629516574415, 'auprc': 0.992666954456457, 'loss_val': 0.3529786931143549, 'psi': 0.8636444917272318}
[S16] START round=44 head_norm_before_train=1.492355 cos_to_last_merge=0.9999 (last merge round=42)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9732735332382324, 'auprc': 0.9863588602206277, 'loss_val': 0.12314361585081585, 'psi': 0.9785076640311905}-{'f1_val': 0.9902245449521159, 'auprc': 0.9928472562619773, 'loss_val': 0.07639190982781524, 'psi': 0.9912736294760605}
[S17] START round=44 head_norm_before_train=1.957189 cos_to_last_merge=0.7781 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=44 local utility u=0.135033 metrics={'f1_val': 0.8394291630436187, 'auprc': 0.9478877737520827, 'loss_val': 0.5627590305345537, 'psi': 0.8828126073270043}-{'f1_val': 0.8147129705150129, 'auprc': 0.9426911555737059, 'loss_val': 0.6689375703462149, 'psi': 0.8659042445384901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[S16] RECEIVED delta(kind=head bytes=1802) from S14
[S16] cosine check vs S14: cos=0.9984
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9941
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9544
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9998
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=44 metric=0.9970 head_norm=2.180298
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.213887e-02
[S11] stored merged vector for next round verification (round=44)
[S11] DEBUG after merge:  round=44 metric=0.9970 head_norm=2.180749 delta_norm=0.022139
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=44 metric=0.9525 head_norm=2.181425
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.490119e-02
[S4] stored merged vector for next round verification (round=44)
[S4] DEBUG after merge:  round=44 metric=0.9525 head_norm=2.181682 delta_norm=0.024901
[S4] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9901
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S15
[S5] cosine check vs S15: cos=0.9901
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.8332 head_norm=1.421716
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.035070e-01
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.8205 head_norm=1.438206 delta_norm=0.103507
[S5] aggregate: ROLLBACK (f1_val pre=0.833 post=0.820 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9733 head_norm=1.509921
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.330092e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9726 head_norm=1.512318 delta_norm=0.043301
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9815 head_norm=1.717821
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.571714e-01
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9815 head_norm=1.678864 delta_norm=0.257171
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.8967 head_norm=1.520505
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.340421e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.8972 head_norm=1.502738 delta_norm=0.083404
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.8976 head_norm=1.461856
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.035070e-01
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9033 head_norm=1.438206 delta_norm=0.103507
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.552752 cos_to_last_merge=0.9962 (last merge round=39)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.5947307460130942, 'auprc': 0.7524686188162352, 'loss_val': 1.2820414194080565, 'psi': 0.6578258951343505}-{'f1_val': 0.721917139936282, 'auprc': 0.746228340243739, 'loss_val': 0.749229239741381, 'psi': 0.7316416200592648}
[S3] START round=45 head_norm_before_train=1.502738 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.844564546537641, 'auprc': 0.9839594185733753, 'loss_val': 0.33368283167772406, 'psi': 0.9003224953519346}-{'f1_val': 0.8966925948231823, 'auprc': 0.9923554688357555, 'loss_val': 0.22637253348285966, 'psi': 0.9349577444282116}
[S4] START round=45 head_norm_before_train=2.181682 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9517360387849683, 'auprc': 0.9714592673771367, 'loss_val': 0.28801896366719826, 'psi': 0.9596253302218356}-{'f1_val': 0.9525294695696207, 'auprc': 0.9855832495674215, 'loss_val': 0.2746111332251183, 'psi': 0.9657509815687411}
[S5] START round=45 head_norm_before_train=1.438206 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.5303006071931192, 'auprc': 0.8416229855706556, 'loss_val': 0.8140267506653154, 'psi': 0.6548295585441338}-{'f1_val': 0.8332280552576501, 'auprc': 0.9645747575484604, 'loss_val': 0.32301862324636893, 'psi': 0.8857667361739743}
[S6] START round=45 head_norm_before_train=1.678849 cos_to_last_merge=0.9957 (last merge round=42)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.5968447359640989, 'auprc': 0.7124078428459488, 'loss_val': 1.1774486054322157, 'psi': 0.6430699787168389}-{'f1_val': 0.9633386884341948, 'auprc': 0.9924993315536697, 'loss_val': 0.1475592462916484, 'psi': 0.9750029456819846}
[S7] START round=45 head_norm_before_train=1.489437 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5323245100794467, 'auprc': 0.7819481368282325, 'loss_val': 0.7907481109003222, 'psi': 0.632173960778961}-{'f1_val': 0.6952726706758381, 'auprc': 0.9339395024440283, 'loss_val': 0.2778527450504776, 'psi': 0.7907394033831141}
[S8] START round=45 head_norm_before_train=1.678864 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.054866 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9988954405801256, 'loss_val': 0.04847907241912709, 'psi': 0.9958660601805289}-{'f1_val': 0.9815282929982607, 'auprc': 0.9988097084035544, 'loss_val': 0.08404402750889167, 'psi': 0.9884408591603782}
[S9] START round=45 head_norm_before_train=1.837576 cos_to_last_merge=0.9952 (last merge round=34)
[S9] round=45 local utility u=0.022987 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9978723663882575, 'loss_val': 0.02589779098050534, 'psi': 0.9972604978106574}-{'f1_val': 0.9910040044536889, 'auprc': 0.998161313924693, 'loss_val': 0.03764784811224849, 'psi': 0.9938669282420906}
[S10] START round=45 head_norm_before_train=2.234929 (no previous merge yet)
[S10] round=45 local utility u=0.001932 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966569424383009, 'loss_val': 0.025050689016731627, 'psi': 0.9958566493135586}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956631380061446, 'loss_val': 0.025933525967310543, 'psi': 0.9954591275406961}
[S11] START round=45 head_norm_before_train=2.180749 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988739115396448, 'loss_val': 0.02121714046976647, 'psi': 0.9975830163647672}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988971466644385, 'loss_val': 0.02095782623955563, 'psi': 0.9977374126415217}
[S13] START round=45 head_norm_before_train=1.885114 (no previous merge yet)
[S13] round=45 local utility u=0.225002 metrics={'f1_val': 0.7186427264133725, 'auprc': 0.7725487802264503, 'loss_val': 0.977804074827546, 'psi': 0.7402051479386036}-{'f1_val': 0.636562075882314, 'auprc': 0.7495835613174009, 'loss_val': 0.8664284760241248, 'psi': 0.6817706700563487}
[S14] START round=45 head_norm_before_train=1.515948 cos_to_last_merge=0.9735 (last merge round=33)
[S14] round=45 local utility u=0.001277 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9988970832184791, 'loss_val': 0.04737433005342047, 'psi': 0.9981185034371716}-{'f1_val': 0.9975994502496334, 'auprc': 0.9988881822270166, 'loss_val': 0.049901217622850214, 'psi': 0.9981149430405867}
[S15] START round=45 head_norm_before_train=1.438206 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7680111138990597, 'auprc': 0.9904957070790057, 'loss_val': 0.34835301497688415, 'psi': 0.8570049511710381}-{'f1_val': 0.8975786713734765, 'auprc': 0.9950183682397096, 'loss_val': 0.17776721007593177, 'psi': 0.9365545501199697}
[S16] START round=45 head_norm_before_train=1.512318 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.084434 metrics={'f1_val': 0.9906525202417691, 'auprc': 0.9901475187141628, 'loss_val': 0.06991520767788872, 'psi': 0.9904505196307266}-{'f1_val': 0.9732735332382324, 'auprc': 0.9863588602206277, 'loss_val': 0.12314361585081585, 'psi': 0.9785076640311905}
[S17] START round=45 head_norm_before_train=1.967037 cos_to_last_merge=0.7773 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.79326301102294, 'auprc': 0.9406967992843529, 'loss_val': 0.7490565399754994, 'psi': 0.8522365263275051}-{'f1_val': 0.8394291630436187, 'auprc': 0.9478877737520827, 'loss_val': 0.5627590305345537, 'psi': 0.8828126073270043}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] ⇄ pheromone p=0.275 → S8@127.0.0.1:49309
[S7] ⇄ pheromone p=0.342 → S3@127.0.0.1:49303
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:49304
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.010 → S11@127.0.0.1:49312
[S16] RECEIVED delta(kind=head bytes=1802) from S14
[S16] cosine check vs S14: cos=0.9991
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0364
[S10] DROPPED delta from S13 (cos=-0.0364 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0364
[S13] DROPPED delta from S10 (cos=-0.0364 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:49313
[S13] ⇄ pheromone p=0.122 → S10@127.0.0.1:49311
[S14] ⇄ pheromone p=0.009 → S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9840
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9396
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.9285
[S3] ⇄ pheromone p=0.108 → S7@127.0.0.1:49308
[S15] ⇄ pheromone p=0.253 → S5@127.0.0.1:49305
[S9] ⇄ pheromone p=0.010 → S8@127.0.0.1:49309
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.9907 head_norm=1.529877
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.267442e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.9907 head_norm=1.531319 delta_norm=0.032674
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.224 → S5@127.0.0.1:49305
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9938 head_norm=1.698057
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.423838e-01
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9935 head_norm=1.739297 delta_norm=0.342384
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.045 → S6@127.0.0.1:49307
[S2] ⇄ pheromone p=0.043 → S3@127.0.0.1:49303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.5303 head_norm=1.452268
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.619492e-01
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.5066 head_norm=1.468395 delta_norm=0.261949
[S5] aggregate: ROLLBACK (f1_val pre=0.530 post=0.507 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.255 → S16@127.0.0.1:49316
[S2] START round=46 head_norm_before_train=1.565893 cos_to_last_merge=0.9957 (last merge round=39)
[S2] round=46 local utility u=0.984270 metrics={'f1_val': 0.709743140820475, 'auprc': 0.931764451643473, 'loss_val': 0.54146295275802, 'psi': 0.7985516651496742}-{'f1_val': 0.5947307460130942, 'auprc': 0.7524686188162352, 'loss_val': 1.2820414194080565, 'psi': 0.6578258951343505}
[S3] START round=46 head_norm_before_train=1.522452 cos_to_last_merge=0.9999 (last merge round=44)
[S3] round=46 local utility u=0.247296 metrics={'f1_val': 0.9065773906322523, 'auprc': 0.9841744568523538, 'loss_val': 0.21181350550573294, 'psi': 0.9376162171202929}-{'f1_val': 0.844564546537641, 'auprc': 0.9839594185733753, 'loss_val': 0.33368283167772406, 'psi': 0.9003224953519346}
[S4] START round=46 head_norm_before_train=2.185033 cos_to_last_merge=0.9999 (last merge round=44)
[S4] round=46 local utility u=0.018048 metrics={'f1_val': 0.9550273919146068, 'auprc': 0.9786501232385665, 'loss_val': 0.2932434186646021, 'psi': 0.9644764844441907}-{'f1_val': 0.9517360387849683, 'auprc': 0.9714592673771367, 'loss_val': 0.28801896366719826, 'psi': 0.9596253302218356}
[S5] START round=46 head_norm_before_train=1.468395 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.628932 metrics={'f1_val': 0.6662313950904155, 'auprc': 0.8645467497805233, 'loss_val': 0.4405187422896794, 'psi': 0.7455575369664587}-{'f1_val': 0.5303006071931192, 'auprc': 0.8416229855706556, 'loss_val': 0.8140267506653154, 'psi': 0.6548295585441338}
[S6] START round=46 head_norm_before_train=1.718815 cos_to_last_merge=0.9926 (last merge round=42)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.950847120572635, 'auprc': 0.9871595430631351, 'loss_val': 0.145518339061235, 'psi': 0.965372089568835}-{'f1_val': 0.5968447359640989, 'auprc': 0.7124078428459488, 'loss_val': 1.1774486054322157, 'psi': 0.6430699787168389}
[S7] START round=46 head_norm_before_train=1.495715 cos_to_last_merge=0.9998 (last merge round=43)
[S7] round=46 local utility u=0.628188 metrics={'f1_val': 0.6618235714255023, 'auprc': 0.8258867517276132, 'loss_val': 0.4431817820615677, 'psi': 0.7274488435463466}-{'f1_val': 0.5323245100794467, 'auprc': 0.7819481368282325, 'loss_val': 0.7907481109003222, 'psi': 0.632173960778961}
[S8] START round=46 head_norm_before_train=1.739297 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9780756445643195, 'auprc': 0.9935236398638485, 'loss_val': 0.08822452768184932, 'psi': 0.9842548426841311}-{'f1_val': 0.9938464732474644, 'auprc': 0.9988954405801256, 'loss_val': 0.04847907241912709, 'psi': 0.9958660601805289}
[S9] START round=46 head_norm_before_train=1.844278 cos_to_last_merge=0.9948 (last merge round=34)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9960794186613022, 'loss_val': 0.025717248710248587, 'psi': 0.9965433187198752}-{'f1_val': 0.9968525854255906, 'auprc': 0.9978723663882575, 'loss_val': 0.02589779098050534, 'psi': 0.9972604978106574}
[S10] START round=46 head_norm_before_train=2.237079 (no previous merge yet)
[S10] round=46 local utility u=0.000028 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9967272542559719, 'loss_val': 0.025204812842860084, 'psi': 0.9958847740406269}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966569424383009, 'loss_val': 0.025050689016731627, 'psi': 0.9958566493135586}
[S11] START round=46 head_norm_before_train=2.191075 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=46 local utility u=0.000152 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988419089315219, 'loss_val': 0.020817169144850874, 'psi': 0.997570215321518}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988739115396448, 'loss_val': 0.02121714046976647, 'psi': 0.9975830163647672}
[S13] START round=46 head_norm_before_train=1.890635 (no previous merge yet)
[S13] round=46 local utility u=0.380200 metrics={'f1_val': 0.759396366461391, 'auprc': 0.8132409395246407, 'loss_val': 0.5840017248877568, 'psi': 0.7809341956866909}-{'f1_val': 0.7186427264133725, 'auprc': 0.7725487802264503, 'loss_val': 0.977804074827546, 'psi': 0.7402051479386036}
[S14] START round=46 head_norm_before_train=1.533457 cos_to_last_merge=0.9717 (last merge round=33)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9969687589007382, 'auprc': 0.9982866322804991, 'loss_val': 0.046814325324515974, 'psi': 0.9974959082526424}-{'f1_val': 0.9975994502496334, 'auprc': 0.9988970832184791, 'loss_val': 0.04737433005342047, 'psi': 0.9981185034371716}
[S15] START round=46 head_norm_before_train=1.475772 cos_to_last_merge=0.9997 (last merge round=44)
[S15] round=46 local utility u=0.526243 metrics={'f1_val': 0.9095207359246194, 'auprc': 0.9955368444638082, 'loss_val': 0.16004864009772526, 'psi': 0.9439271793402949}-{'f1_val': 0.7680111138990597, 'auprc': 0.9904957070790057, 'loss_val': 0.34835301497688415, 'psi': 0.8570049511710381}
[S16] START round=46 head_norm_before_train=1.531319 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.009029 metrics={'f1_val': 0.9915212706861152, 'auprc': 0.9938078031116927, 'loss_val': 0.06805118285889994, 'psi': 0.9924358836563463}-{'f1_val': 0.9906525202417691, 'auprc': 0.9901475187141628, 'loss_val': 0.06991520767788872, 'psi': 0.9904505196307266}
[S17] START round=46 head_norm_before_train=1.974935 cos_to_last_merge=0.7769 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7713141702912719, 'auprc': 0.9293724358230746, 'loss_val': 0.829193491740053, 'psi': 0.834537476503993}-{'f1_val': 0.79326301102294, 'auprc': 0.9406967992843529, 'loss_val': 0.7490565399754994, 'psi': 0.8522365263275051}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.0363
[S10] DROPPED delta from S13 (cos=-0.0363 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.9970
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=-0.0363
[S13] DROPPED delta from S10 (cos=-0.0363 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.9294
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:49308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.9550 head_norm=2.192527
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.120126e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.9551 head_norm=2.196868 delta_norm=0.021201
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.9508 head_norm=1.745057
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.706676e-01
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.9528 head_norm=1.713238 delta_norm=0.170668
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9967 head_norm=2.201405
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.120127e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9967 head_norm=2.196868 delta_norm=0.021201
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9802
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.9621
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9835
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9802
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.9970
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9781 head_norm=1.760426
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.294740e-01
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9784 head_norm=1.721514 delta_norm=0.329474
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.9066 head_norm=1.540816
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.096720e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.9050 head_norm=1.529680 delta_norm=0.090967
[S3] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9095 head_norm=1.513582
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.497016e-01
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9123 head_norm=1.488642 delta_norm=0.149702
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.6662 head_norm=1.478513
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.516910e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.6662 head_norm=1.491005 delta_norm=0.025169
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.582289 cos_to_last_merge=0.9951 (last merge round=39)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7114590859138381, 'auprc': 0.9128511324229349, 'loss_val': 0.5733716253676637, 'psi': 0.7920159045174768}-{'f1_val': 0.709743140820475, 'auprc': 0.931764451643473, 'loss_val': 0.54146295275802, 'psi': 0.7985516651496742}
[S3] START round=47 head_norm_before_train=1.529680 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.214551 metrics={'f1_val': 0.9574782533984617, 'auprc': 0.9978927629712444, 'loss_val': 0.12927251156450273, 'psi': 0.9736440572275747}-{'f1_val': 0.9065773906322523, 'auprc': 0.9841744568523538, 'loss_val': 0.21181350550573294, 'psi': 0.9376162171202929}
[S4] START round=47 head_norm_before_train=2.196868 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9486015739430381, 'auprc': 0.9606469719139422, 'loss_val': 0.2545743901409576, 'psi': 0.9534197331313998}-{'f1_val': 0.9550273919146068, 'auprc': 0.9786501232385665, 'loss_val': 0.2932434186646021, 'psi': 0.9644764844441907}
[S5] START round=47 head_norm_before_train=1.491005 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.378328 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.987662285960342, 'loss_val': 0.2593025245693303, 'psi': 0.8154130651025411}-{'f1_val': 0.6662313950904155, 'auprc': 0.8645467497805233, 'loss_val': 0.4405187422896794, 'psi': 0.7455575369664587}
[S6] START round=47 head_norm_before_train=1.713238 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7269537246209654, 'auprc': 0.938061637780083, 'loss_val': 0.7177355148482499, 'psi': 0.8113968898846124}-{'f1_val': 0.950847120572635, 'auprc': 0.9871595430631351, 'loss_val': 0.145518339061235, 'psi': 0.965372089568835}
[S7] START round=47 head_norm_before_train=1.508693 cos_to_last_merge=0.9997 (last merge round=43)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6380546056015972, 'auprc': 0.7988586168052778, 'loss_val': 0.5782586725777092, 'psi': 0.7023762100830695}-{'f1_val': 0.6618235714255023, 'auprc': 0.8258867517276132, 'loss_val': 0.4431817820615677, 'psi': 0.7274488435463466}
[S8] START round=47 head_norm_before_train=1.721514 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9683198107991999, 'auprc': 0.9970929004546317, 'loss_val': 0.10855232604029957, 'psi': 0.9798290466613726}-{'f1_val': 0.9780756445643195, 'auprc': 0.9935236398638485, 'loss_val': 0.08822452768184932, 'psi': 0.9842548426841311}
[S9] START round=47 head_norm_before_train=1.850322 cos_to_last_merge=0.9945 (last merge round=34)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9981585430119088, 'loss_val': 0.030442347450579676, 'psi': 0.9958774107224537}-{'f1_val': 0.9968525854255906, 'auprc': 0.9960794186613022, 'loss_val': 0.025717248710248587, 'psi': 0.9965433187198752}
[S10] START round=47 head_norm_before_train=2.238186 (no previous merge yet)
[S10] round=47 local utility u=0.000582 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970212140347134, 'loss_val': 0.024923251307281524, 'psi': 0.9960023579521236}-{'f1_val': 0.9953231205637304, 'auprc': 0.9967272542559719, 'loss_val': 0.025204812842860084, 'psi': 0.9958847740406269}
[S11] START round=47 head_norm_before_train=2.196868 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.945634252272828, 'auprc': 0.9986232292478543, 'loss_val': 0.14551824443677533, 'psi': 0.9668298430628386}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988419089315219, 'loss_val': 0.020817169144850874, 'psi': 0.997570215321518}
[S13] START round=47 head_norm_before_train=1.895322 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6574026131054612, 'auprc': 0.8089532205434747, 'loss_val': 1.053424660036474, 'psi': 0.7180228560806666}-{'f1_val': 0.759396366461391, 'auprc': 0.8132409395246407, 'loss_val': 0.5840017248877568, 'psi': 0.7809341956866909}
[S14] START round=47 head_norm_before_train=1.549437 cos_to_last_merge=0.9701 (last merge round=33)
[S14] round=47 local utility u=0.002724 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9974552819814564, 'loss_val': 0.03758616200232688, 'psi': 0.9970348317848013}-{'f1_val': 0.9969687589007382, 'auprc': 0.9982866322804991, 'loss_val': 0.046814325324515974, 'psi': 0.9974959082526424}
[S15] START round=47 head_norm_before_train=1.488642 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7043537236536646, 'auprc': 0.9081481110637335, 'loss_val': 0.46170231328827743, 'psi': 0.7858714786176921}-{'f1_val': 0.9095207359246194, 'auprc': 0.9955368444638082, 'loss_val': 0.16004864009772526, 'psi': 0.9439271793402949}
[S16] START round=47 head_norm_before_train=1.548185 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9334975037723506, 'auprc': 0.9924503263953306, 'loss_val': 0.17012782856382466, 'psi': 0.9570786328215426}-{'f1_val': 0.9915212706861152, 'auprc': 0.9938078031116927, 'loss_val': 0.06805118285889994, 'psi': 0.9924358836563463}
[S17] START round=47 head_norm_before_train=1.991765 cos_to_last_merge=0.7755 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=47 local utility u=0.469775 metrics={'f1_val': 0.8604481926118166, 'auprc': 0.9532242289712205, 'loss_val': 0.49600325928274686, 'psi': 0.8975586071555782}-{'f1_val': 0.7713141702912719, 'auprc': 0.9293724358230746, 'loss_val': 0.829193491740053, 'psi': 0.834537476503993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1806 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.815)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6381 head_norm=1.521688
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.575181e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6363 head_norm=1.529870 delta_norm=0.065752
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1806) from S14
[S16] cosine check vs S14: cos=0.9989
[S3] not sending this round → trigger blocked (psi=0.974)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=47 metric=0.9335 head_norm=1.565521
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.727315e-02
[S16] stored merged vector for next round verification (round=47)
[S16] DEBUG after merge:  round=47 metric=0.9350 head_norm=1.563632 delta_norm=0.037273
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.598959 cos_to_last_merge=0.9942 (last merge round=39)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7126940608242673, 'auprc': 0.8939186695225485, 'loss_val': 0.6224861083603932, 'psi': 0.7851839043035798}-{'f1_val': 0.7114590859138381, 'auprc': 0.9128511324229349, 'loss_val': 0.5733716253676637, 'psi': 0.7920159045174768}
[S3] START round=48 head_norm_before_train=1.549100 cos_to_last_merge=0.9999 (last merge round=46)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.8122324595007241, 'auprc': 0.9673074766497032, 'loss_val': 0.46302437771124866, 'psi': 0.8742624663603158}-{'f1_val': 0.9574782533984617, 'auprc': 0.9978927629712444, 'loss_val': 0.12927251156450273, 'psi': 0.9736440572275747}
[S4] START round=48 head_norm_before_train=2.206271 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.022612 metrics={'f1_val': 0.9531692476439817, 'auprc': 0.9787803761070593, 'loss_val': 0.291156808524157, 'psi': 0.9634136990292127}-{'f1_val': 0.9486015739430381, 'auprc': 0.9606469719139422, 'loss_val': 0.2545743901409576, 'psi': 0.9534197331313998}
[S5] START round=48 head_norm_before_train=1.500708 cos_to_last_merge=0.9999 (last merge round=46)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.721639455205606, 'auprc': 0.9535551459407658, 'loss_val': 0.3348861373696401, 'psi': 0.81440573149967}-{'f1_val': 0.7005802511973405, 'auprc': 0.987662285960342, 'loss_val': 0.2593025245693303, 'psi': 0.8154130651025411}
[S6] START round=48 head_norm_before_train=1.730735 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5949626531636194, 'auprc': 0.843823369969244, 'loss_val': 1.0435940495643525, 'psi': 0.6945069398858692}-{'f1_val': 0.7269537246209654, 'auprc': 0.938061637780083, 'loss_val': 0.7177355148482499, 'psi': 0.8113968898846124}
[S7] START round=48 head_norm_before_train=1.529870 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.638384536223845, 'auprc': 0.7954630133683755, 'loss_val': 0.5753442607545831, 'psi': 0.7012159270816571}-{'f1_val': 0.6380546056015972, 'auprc': 0.7988586168052778, 'loss_val': 0.5782586725777092, 'psi': 0.7023762100830695}
[S8] START round=48 head_norm_before_train=1.743286 cos_to_last_merge=0.9999 (last merge round=46)
[S8] round=48 local utility u=0.099870 metrics={'f1_val': 0.9923860096923637, 'auprc': 0.9947763683813482, 'loss_val': 0.04625934792195503, 'psi': 0.9933421531679575}-{'f1_val': 0.9683198107991999, 'auprc': 0.9970929004546317, 'loss_val': 0.10855232604029957, 'psi': 0.9798290466613726}
[S9] START round=48 head_norm_before_train=1.856343 cos_to_last_merge=0.9941 (last merge round=34)
[S9] round=48 local utility u=0.000439 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9981633918777547, 'loss_val': 0.02957816227410828, 'psi': 0.9958793502687922}-{'f1_val': 0.994356655862817, 'auprc': 0.9981585430119088, 'loss_val': 0.030442347450579676, 'psi': 0.9958774107224537}
[S10] START round=48 head_norm_before_train=2.245566 (no previous merge yet)
[S10] round=48 local utility u=0.000453 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971409666216373, 'loss_val': 0.024375517354349927, 'psi': 0.9960502589868931}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970212140347134, 'loss_val': 0.024923251307281524, 'psi': 0.9960023579521236}
[S11] START round=48 head_norm_before_train=2.205262 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=48 local utility u=0.215154 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990068041828367, 'loss_val': 0.02041023449212005, 'psi': 0.9973881724433559}-{'f1_val': 0.945634252272828, 'auprc': 0.9986232292478543, 'loss_val': 0.14551824443677533, 'psi': 0.9668298430628386}
[S13] START round=48 head_norm_before_train=1.906385 (no previous merge yet)
[S13] round=48 local utility u=0.130190 metrics={'f1_val': 0.671795264315761, 'auprc': 0.7626958793007063, 'loss_val': 0.7406291149478901, 'psi': 0.7081555103097391}-{'f1_val': 0.6574026131054612, 'auprc': 0.8089532205434747, 'loss_val': 1.053424660036474, 'psi': 0.7180228560806666}
[S14] START round=48 head_norm_before_train=1.562630 cos_to_last_merge=0.9687 (last merge round=33)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9945950733921716, 'loss_val': 0.037835054149167026, 'psi': 0.995892671383035}-{'f1_val': 0.996754531653698, 'auprc': 0.9974552819814564, 'loss_val': 0.03758616200232688, 'psi': 0.9970348317848013}
[S15] START round=48 head_norm_before_train=1.521687 cos_to_last_merge=0.9997 (last merge round=46)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9959859022807959, 'loss_val': 0.034281247127289693, 'psi': 0.9964423619448307}-{'f1_val': 0.7043537236536646, 'auprc': 0.9081481110637335, 'loss_val': 0.46170231328827743, 'psi': 0.7858714786176921}
[S16] START round=48 head_norm_before_train=1.563632 cos_to_last_merge=1.0000 (last merge round=47)
[S16] round=48 local utility u=0.198502 metrics={'f1_val': 0.9856776015404667, 'auprc': 0.993549726341706, 'loss_val': 0.08950257898164138, 'psi': 0.9888264514609624}-{'f1_val': 0.9334975037723506, 'auprc': 0.9924503263953306, 'loss_val': 0.17012782856382466, 'psi': 0.9570786328215426}
[S17] START round=48 head_norm_before_train=2.010108 cos_to_last_merge=0.7742 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.776440654000879, 'auprc': 0.9292889332491302, 'loss_val': 1.1473558081497484, 'psi': 0.8375799657001795}-{'f1_val': 0.8604481926118166, 'auprc': 0.9532242289712205, 'loss_val': 0.49600325928274686, 'psi': 0.8975586071555782}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0353
[S13] DROPPED delta from S10 (cos=-0.0353 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0353
[S10] DROPPED delta from S13 (cos=-0.0353 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=48 metric=0.9963 head_norm=2.210808
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.299295e-02
[S11] stored merged vector for next round verification (round=48)
[S11] DEBUG after merge:  round=48 metric=0.9963 head_norm=2.209659 delta_norm=0.012993
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=48 metric=0.9532 head_norm=2.208586
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.299296e-02
[S4] stored merged vector for next round verification (round=48)
[S4] DEBUG after merge:  round=48 metric=0.9532 head_norm=2.209659 delta_norm=0.012993
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[S16] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9932
[S6] RECEIVED delta(kind=head bytes=1792) from S8
[S6] cosine check vs S8: cos=0.9937
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.9800
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S9
[S8] cosine check vs S9: cos=0.9268
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9924 head_norm=1.764318
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.503201e-01
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9924 head_norm=1.780237 delta_norm=0.350320
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.7216 head_norm=1.510131
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.559473e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.6988 head_norm=1.526811 delta_norm=0.045595
[S5] aggregate: ROLLBACK (f1_val pre=0.722 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S2] START round=49 head_norm_before_train=1.619559 cos_to_last_merge=0.9933 (last merge round=39)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7136656663621072, 'auprc': 0.8872225375304632, 'loss_val': 0.6416347387585993, 'psi': 0.7830884148294496}-{'f1_val': 0.7126940608242673, 'auprc': 0.8939186695225485, 'loss_val': 0.6224861083603932, 'psi': 0.7851839043035798}
[S3] START round=49 head_norm_before_train=1.568959 cos_to_last_merge=0.9998 (last merge round=46)
[S3] round=49 local utility u=0.387669 metrics={'f1_val': 0.8884530238136963, 'auprc': 0.9942392663654737, 'loss_val': 0.22580435510924032, 'psi': 0.9307675208344072}-{'f1_val': 0.8122324595007241, 'auprc': 0.9673074766497032, 'loss_val': 0.46302437771124866, 'psi': 0.8742624663603158}
[S4] START round=49 head_norm_before_train=2.209659 cos_to_last_merge=1.0000 (last merge round=48)
[S4] round=49 local utility u=0.009001 metrics={'f1_val': 0.951036367096983, 'auprc': 0.9839477603928348, 'loss_val': 0.27586039157698544, 'psi': 0.9642009244153237}-{'f1_val': 0.9531692476439817, 'auprc': 0.9787803761070593, 'loss_val': 0.291156808524157, 'psi': 0.9634136990292127}
[S5] START round=49 head_norm_before_train=1.526811 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6323368437774985, 'auprc': 0.8824440234128729, 'loss_val': 0.5000633301431958, 'psi': 0.7323797156316483}-{'f1_val': 0.721639455205606, 'auprc': 0.9535551459407658, 'loss_val': 0.3348861373696401, 'psi': 0.81440573149967}
[S6] START round=49 head_norm_before_train=1.746273 cos_to_last_merge=0.9995 (last merge round=46)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5930143083567588, 'auprc': 0.8332796924246875, 'loss_val': 1.0585411375098062, 'psi': 0.6891204619839303}-{'f1_val': 0.5949626531636194, 'auprc': 0.843823369969244, 'loss_val': 1.0435940495643525, 'psi': 0.6945069398858692}
[S7] START round=49 head_norm_before_train=1.539286 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6182776323823649, 'auprc': 0.7870450537727657, 'loss_val': 0.6364233968057116, 'psi': 0.6857846009385252}-{'f1_val': 0.638384536223845, 'auprc': 0.7954630133683755, 'loss_val': 0.5753442607545831, 'psi': 0.7012159270816571}
[S8] START round=49 head_norm_before_train=1.780237 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9935250394006067, 'loss_val': 0.051112901404161526, 'psi': 0.9930601948191349}-{'f1_val': 0.9923860096923637, 'auprc': 0.9947763683813482, 'loss_val': 0.04625934792195503, 'psi': 0.9933421531679575}
[S9] START round=49 head_norm_before_train=1.863094 cos_to_last_merge=0.9937 (last merge round=34)
[S9] round=49 local utility u=0.010008 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9981620329801023, 'loss_val': 0.024533773942653426, 'psi': 0.9973763644473952}-{'f1_val': 0.994356655862817, 'auprc': 0.9981633918777547, 'loss_val': 0.02957816227410828, 'psi': 0.9958793502687922}
[S10] START round=49 head_norm_before_train=2.254865 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996262327216134, 'loss_val': 0.025608886758211852, 'psi': 0.9956988032246918}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971409666216373, 'loss_val': 0.024375517354349927, 'psi': 0.9960502589868931}
[S11] START round=49 head_norm_before_train=2.209659 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990283272150129, 'loss_val': 0.021250818342800157, 'psi': 0.9973967816562264}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990068041828367, 'loss_val': 0.02041023449212005, 'psi': 0.9973881724433559}
[S13] START round=49 head_norm_before_train=1.914767 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6359319944711083, 'auprc': 0.6915878707588471, 'loss_val': 1.131048874304951, 'psi': 0.6581943449862038}-{'f1_val': 0.671795264315761, 'auprc': 0.7626958793007063, 'loss_val': 0.7406291149478901, 'psi': 0.7081555103097391}
[S14] START round=49 head_norm_before_train=1.575091 cos_to_last_merge=0.9675 (last merge round=33)
[S14] round=49 local utility u=0.005084 metrics={'f1_val': 0.9967978715641003, 'auprc': 0.997416866069045, 'loss_val': 0.03637361018718746, 'psi': 0.9970454693660782}-{'f1_val': 0.9967577367102773, 'auprc': 0.9945950733921716, 'loss_val': 0.037835054149167026, 'psi': 0.995892671383035}
[S15] START round=49 head_norm_before_train=1.546611 cos_to_last_merge=0.9993 (last merge round=46)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7033184273321893, 'auprc': 0.9394966641509838, 'loss_val': 0.4351012622911227, 'psi': 0.7977897220597071}-{'f1_val': 0.9967466683875206, 'auprc': 0.9959859022807959, 'loss_val': 0.034281247127289693, 'psi': 0.9964423619448307}
[S16] START round=49 head_norm_before_train=1.580007 cos_to_last_merge=0.9999 (last merge round=47)
[S16] round=49 local utility u=0.029352 metrics={'f1_val': 0.9915212706861152, 'auprc': 0.991228143832897, 'loss_val': 0.05889542324828132, 'psi': 0.991404019944828}-{'f1_val': 0.9856776015404667, 'auprc': 0.993549726341706, 'loss_val': 0.08950257898164138, 'psi': 0.9888264514609624}
[S17] START round=49 head_norm_before_train=2.015547 cos_to_last_merge=0.7739 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=49 local utility u=0.355309 metrics={'f1_val': 0.8428017334863722, 'auprc': 0.9535165839637507, 'loss_val': 0.9075875645234358, 'psi': 0.8870876736773237}-{'f1_val': 0.776440654000879, 'auprc': 0.9292889332491302, 'loss_val': 1.1473558081497484, 'psi': 0.8375799657001795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.964)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S14] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.5930 head_norm=1.761360
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.071646e-01
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.5897 head_norm=1.759580 delta_norm=0.107165
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1804) from S14
[S16] cosine check vs S14: cos=0.9989
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[S9] not sending this round → trigger blocked (psi=0.997)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9944
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=49 metric=0.9915 head_norm=1.595821
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.790594e-02
[S16] stored merged vector for next round verification (round=49)
[S16] DEBUG after merge:  round=49 metric=0.9915 head_norm=1.591550 delta_norm=0.037906
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.636312 cos_to_last_merge=0.9923 (last merge round=39)
[S2] round=50 local utility u=0.030015 metrics={'f1_val': 0.712055909487713, 'auprc': 0.9012790010938893, 'loss_val': 0.6141154775621073, 'psi': 0.7877451461301834}-{'f1_val': 0.7136656663621072, 'auprc': 0.8872225375304632, 'loss_val': 0.6416347387585993, 'psi': 0.7830884148294496}
[S3] START round=50 head_norm_before_train=1.585642 cos_to_last_merge=0.9996 (last merge round=46)
[S3] round=50 local utility u=0.430695 metrics={'f1_val': 0.9983835929041498, 'auprc': 0.9997760418258214, 'loss_val': 0.04060790570231829, 'psi': 0.9989405724728184}-{'f1_val': 0.8884530238136963, 'auprc': 0.9942392663654737, 'loss_val': 0.22580435510924032, 'psi': 0.9307675208344072}
[S4] START round=50 head_norm_before_train=2.205580 cos_to_last_merge=1.0000 (last merge round=48)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9529163300779833, 'auprc': 0.9752875164224326, 'loss_val': 0.3142443225616455, 'psi': 0.961864804615763}-{'f1_val': 0.951036367096983, 'auprc': 0.9839477603928348, 'loss_val': 0.27586039157698544, 'psi': 0.9642009244153237}
[S5] START round=50 head_norm_before_train=1.539003 cos_to_last_merge=0.9999 (last merge round=48)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.42560472379982545, 'auprc': 0.8108893505900913, 'loss_val': 1.227634630464151, 'psi': 0.5797185745159318}-{'f1_val': 0.6323368437774985, 'auprc': 0.8824440234128729, 'loss_val': 0.5000633301431958, 'psi': 0.7323797156316483}
[S6] START round=50 head_norm_before_train=1.759580 cos_to_last_merge=1.0000 (last merge round=49)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8640094548446562, 'auprc': 0.9549610683857289, 'loss_val': 0.4206784744768015, 'psi': 0.9003901002610853}-{'f1_val': 0.5930143083567588, 'auprc': 0.8332796924246875, 'loss_val': 1.0585411375098062, 'psi': 0.6891204619839303}
[S7] START round=50 head_norm_before_train=1.551316 cos_to_last_merge=0.9998 (last merge round=47)
[S7] round=50 local utility u=0.453745 metrics={'f1_val': 0.6874293440188834, 'auprc': 0.8480828737734356, 'loss_val': 0.32695671008160626, 'psi': 0.7516907559207043}-{'f1_val': 0.6182776323823649, 'auprc': 0.7870450537727657, 'loss_val': 0.6364233968057116, 'psi': 0.6857846009385252}
[S8] START round=50 head_norm_before_train=1.802930 cos_to_last_merge=0.9999 (last merge round=48)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9891462001880631, 'auprc': 0.9962310804687258, 'loss_val': 0.05505577335161288, 'psi': 0.9919801523003281}-{'f1_val': 0.992750298431487, 'auprc': 0.9935250394006067, 'loss_val': 0.051112901404161526, 'psi': 0.9930601948191349}
[S9] START round=50 head_norm_before_train=1.870361 cos_to_last_merge=0.9933 (last merge round=34)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9981640449711847, 'loss_val': 0.02416432422980633, 'psi': 0.9971289107152457}-{'f1_val': 0.9968525854255906, 'auprc': 0.9981620329801023, 'loss_val': 0.024533773942653426, 'psi': 0.9973763644473952}
[S10] START round=50 head_norm_before_train=2.264482 (no previous merge yet)
[S10] round=50 local utility u=0.001354 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969723722392605, 'loss_val': 0.02503045259927358, 'psi': 0.9959828212339423}-{'f1_val': 0.9953231205637304, 'auprc': 0.996262327216134, 'loss_val': 0.025608886758211852, 'psi': 0.9956988032246918}
[S11] START round=50 head_norm_before_train=2.215521 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=50 local utility u=0.000790 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989005684847891, 'loss_val': 0.02073888007274745, 'psi': 0.997490780390974}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990283272150129, 'loss_val': 0.021250818342800157, 'psi': 0.9973967816562264}
[S13] START round=50 head_norm_before_train=1.925057 (no previous merge yet)
[S13] round=50 local utility u=0.735965 metrics={'f1_val': 0.7643411681376397, 'auprc': 0.7874728422319018, 'loss_val': 0.7172297721662033, 'psi': 0.7735938377753446}-{'f1_val': 0.6359319944711083, 'auprc': 0.6915878707588471, 'loss_val': 1.131048874304951, 'psi': 0.6581943449862038}
[S14] START round=50 head_norm_before_train=1.588173 cos_to_last_merge=0.9663 (last merge round=33)
[S14] round=50 local utility u=0.001983 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9975268826281132, 'loss_val': 0.03382360920015909, 'psi': 0.9971980594123679}-{'f1_val': 0.9967978715641003, 'auprc': 0.997416866069045, 'loss_val': 0.03637361018718746, 'psi': 0.9970454693660782}
[S15] START round=50 head_norm_before_train=1.568738 cos_to_last_merge=0.9987 (last merge round=46)
[S15] round=50 local utility u=0.457126 metrics={'f1_val': 0.8119994152197132, 'auprc': 0.9941247158060084, 'loss_val': 0.33681907446812204, 'psi': 0.8848495354542313}-{'f1_val': 0.7033184273321893, 'auprc': 0.9394966641509838, 'loss_val': 0.4351012622911227, 'psi': 0.7977897220597071}
[S16] START round=50 head_norm_before_train=1.591550 cos_to_last_merge=1.0000 (last merge round=49)
[S16] round=50 local utility u=0.001125 metrics={'f1_val': 0.9915212706861152, 'auprc': 0.9916768283670623, 'loss_val': 0.057991586464772545, 'psi': 0.9915834937584941}-{'f1_val': 0.9915212706861152, 'auprc': 0.991228143832897, 'loss_val': 0.05889542324828132, 'psi': 0.991404019944828}
[S17] START round=50 head_norm_before_train=2.028827 cos_to_last_merge=0.7730 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=50 local utility u=0.299451 metrics={'f1_val': 0.8641672133224023, 'auprc': 0.9661332863523981, 'loss_val': 0.4747287573178565, 'psi': 0.9049536425344007}-{'f1_val': 0.8428017334863722, 'auprc': 0.9535165839637507, 'loss_val': 0.9075875645234358, 'psi': 0.8870876736773237}
[S17] not sending this round → trigger blocked (psi=0.905)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:49303
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] ⇄ pheromone p=0.004 → S16@127.0.0.1:49316
[S4] ⇄ pheromone p=0.009 → S11@127.0.0.1:49312
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=0.9677
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0350
[S10] DROPPED delta from S13 (cos=-0.0350 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9932
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=-0.0350
[S13] DROPPED delta from S10 (cos=-0.0350 < 0.0)
[S3] not sending this round → trigger blocked (psi=0.999)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:49313
[S13] ⇄ pheromone p=0.235 → S10@127.0.0.1:49311
[S2] sending update (kind=head size=1806 to 1 peers)
[S11] ⇄ pheromone p=0.028 → S4@127.0.0.1:49304
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.372 → S8@127.0.0.1:49309
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=50 metric=0.6874 head_norm=1.564537
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.027008e-02
[S7] stored merged vector for next round verification (round=50)
[S7] DEBUG after merge:  round=50 metric=0.6899 head_norm=1.572536 delta_norm=0.090270
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.254 → S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S3] RECEIVED delta(kind=head bytes=1806) from S2
[S3] cosine check vs S2: cos=0.9730
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9807
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9893
[S2] ⇄ pheromone p=0.101 → S3@127.0.0.1:49303
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=50 metric=0.9984 head_norm=1.600039
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.960034e-02
[S3] stored merged vector for next round verification (round=50)
[S3] DEBUG after merge:  round=50 metric=0.9984 head_norm=1.591680 delta_norm=0.069600
[S3] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.226 → S7@127.0.0.1:49308
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=50 metric=0.4256 head_norm=1.552842
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.045066e-02
[S5] stored merged vector for next round verification (round=50)
[S5] DEBUG after merge:  round=50 metric=0.4256 head_norm=1.565055 delta_norm=0.040451
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.174 → S15@127.0.0.1:49315
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=50 metric=0.9891 head_norm=1.822397
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.298502e-01
[S8] stored merged vector for next round verification (round=50)
[S8] DEBUG after merge:  round=50 metric=0.9891 head_norm=1.786097 delta_norm=0.229850
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.027 → S6@127.0.0.1:49307
[S15] ⇄ pheromone p=0.345 → S5@127.0.0.1:49305
[S9] ⇄ pheromone p=0.005 → S8@127.0.0.1:49309
[S16] ⇄ pheromone p=0.105 → S5@127.0.0.1:49305
[S2] START round=51 head_norm_before_train=1.651288 cos_to_last_merge=0.9913 (last merge round=39)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.690791403518846, 'auprc': 0.813460708026336, 'loss_val': 0.6267742192434611, 'psi': 0.7398591253218421}-{'f1_val': 0.712055909487713, 'auprc': 0.9012790010938893, 'loss_val': 0.6141154775621073, 'psi': 0.7877451461301834}
[S3] START round=51 head_norm_before_train=1.591680 cos_to_last_merge=1.0000 (last merge round=50)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.8946805577331824, 'auprc': 0.9693573849239869, 'loss_val': 0.2834593957416363, 'psi': 0.9245512886095042}-{'f1_val': 0.9983835929041498, 'auprc': 0.9997760418258214, 'loss_val': 0.04060790570231829, 'psi': 0.9989405724728184}
[S4] START round=51 head_norm_before_train=2.205750 cos_to_last_merge=0.9998 (last merge round=48)
[S4] round=51 local utility u=0.049750 metrics={'f1_val': 0.9551751801865437, 'auprc': 0.9860142686678619, 'loss_val': 0.26047847014052306, 'psi': 0.9675108155790709}-{'f1_val': 0.9529163300779833, 'auprc': 0.9752875164224326, 'loss_val': 0.3142443225616455, 'psi': 0.961864804615763}
[S5] START round=51 head_norm_before_train=1.565055 cos_to_last_merge=1.0000 (last merge round=50)
[S5] round=51 local utility u=1.000000 metrics={'f1_val': 0.7110779240256426, 'auprc': 0.9890151881035307, 'loss_val': 0.21620437187679226, 'psi': 0.8222528296567979}-{'f1_val': 0.42560472379982545, 'auprc': 0.8108893505900913, 'loss_val': 1.227634630464151, 'psi': 0.5797185745159318}
[S6] START round=51 head_norm_before_train=1.778993 cos_to_last_merge=0.9999 (last merge round=49)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.5956142989900671, 'auprc': 0.8625704204237639, 'loss_val': 1.0841954249825796, 'psi': 0.7023967475635458}-{'f1_val': 0.8640094548446562, 'auprc': 0.9549610683857289, 'loss_val': 0.4206784744768015, 'psi': 0.9003901002610853}
[S7] START round=51 head_norm_before_train=1.572536 cos_to_last_merge=1.0000 (last merge round=50)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.590356349618282, 'auprc': 0.7825002082096559, 'loss_val': 0.7223817566271299, 'psi': 0.6672138930548316}-{'f1_val': 0.6874293440188834, 'auprc': 0.8480828737734356, 'loss_val': 0.32695671008160626, 'psi': 0.7516907559207043}
[S8] START round=51 head_norm_before_train=1.786097 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9841756587624003, 'auprc': 0.9963640558882291, 'loss_val': 0.06515517621878764, 'psi': 0.9890510176127318}-{'f1_val': 0.9891462001880631, 'auprc': 0.9962310804687258, 'loss_val': 0.05505577335161288, 'psi': 0.9919801523003281}
[S9] START round=51 head_norm_before_train=1.877581 cos_to_last_merge=0.9929 (last merge round=34)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9981559418069839, 'loss_val': 0.027721668024343976, 'psi': 0.9958763702404838}-{'f1_val': 0.9964388212112862, 'auprc': 0.9981640449711847, 'loss_val': 0.02416432422980633, 'psi': 0.9971289107152457}
[S10] START round=51 head_norm_before_train=2.274054 (no previous merge yet)
[S10] round=51 local utility u=0.000593 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971324764324707, 'loss_val': 0.02432407703737806, 'psi': 0.9960468629112265}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969723722392605, 'loss_val': 0.02503045259927358, 'psi': 0.9959828212339423}
[S11] START round=51 head_norm_before_train=2.221418 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=51 local utility u=0.000324 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989814809012896, 'loss_val': 0.020332674877345414, 'psi': 0.9975231453575741}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989005684847891, 'loss_val': 0.02073888007274745, 'psi': 0.997490780390974}
[S13] START round=51 head_norm_before_train=1.932828 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6335617006509202, 'auprc': 0.7093003681290189, 'loss_val': 1.080386381058463, 'psi': 0.6638571676421596}-{'f1_val': 0.7643411681376397, 'auprc': 0.7874728422319018, 'loss_val': 0.7172297721662033, 'psi': 0.7735938377753446}
[S14] START round=51 head_norm_before_train=1.600885 cos_to_last_merge=0.9651 (last merge round=33)
[S14] round=51 local utility u=0.000627 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.998222523427564, 'loss_val': 0.03217453894950415, 'psi': 0.9972281433168015}-{'f1_val': 0.9969788439352044, 'auprc': 0.9975268826281132, 'loss_val': 0.03382360920015909, 'psi': 0.9971980594123679}
[S15] START round=51 head_norm_before_train=1.593311 cos_to_last_merge=0.9979 (last merge round=46)
[S15] round=51 local utility u=0.142052 metrics={'f1_val': 0.8481610828108673, 'auprc': 0.9945259954886467, 'loss_val': 0.2708893893216949, 'psi': 0.9067070478819791}-{'f1_val': 0.8119994152197132, 'auprc': 0.9941247158060084, 'loss_val': 0.33681907446812204, 'psi': 0.8848495354542313}
[S16] START round=51 head_norm_before_train=1.607484 cos_to_last_merge=1.0000 (last merge round=49)
[S16] round=51 local utility u=0.001950 metrics={'f1_val': 0.9917208371331422, 'auprc': 0.9919419542429277, 'loss_val': 0.05608525069271672, 'psi': 0.9918092839770564}-{'f1_val': 0.9915212706861152, 'auprc': 0.9916768283670623, 'loss_val': 0.057991586464772545, 'psi': 0.9915834937584941}
[S17] START round=51 head_norm_before_train=2.042760 cos_to_last_merge=0.7720 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=51 local utility u=0.318215 metrics={'f1_val': 0.9268901311211247, 'auprc': 0.9789765780717193, 'loss_val': 0.2531657199936802, 'psi': 0.9477247099013626}-{'f1_val': 0.8641672133224023, 'auprc': 0.9661332863523981, 'loss_val': 0.4747287573178565, 'psi': 0.9049536425344007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49316
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0349
[S13] DROPPED delta from S10 (cos=-0.0349 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9997
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9997
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=51 metric=0.9966 head_norm=2.228511
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.961110e-02
[S11] stored merged vector for next round verification (round=51)
[S11] DEBUG after merge:  round=51 metric=0.9966 head_norm=2.217463 delta_norm=0.029611
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=51 metric=0.9552 head_norm=2.206757
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.847286e-02
[S4] stored merged vector for next round verification (round=51)
[S4] DEBUG after merge:  round=51 metric=0.9548 head_norm=2.215695 delta_norm=0.028473
[S4] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9868
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S14
[S16] cosine check vs S14: cos=0.9990
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9827
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9868
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=51 metric=0.8482 head_norm=1.617942
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.313113e-01
[S15] stored merged vector for next round verification (round=51)
[S15] DEBUG after merge:  round=51 metric=0.8572 head_norm=1.590716 delta_norm=0.131311
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=51 metric=0.9917 head_norm=1.621901
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.715604e-02
[S16] stored merged vector for next round verification (round=51)
[S16] DEBUG after merge:  round=51 metric=0.9917 head_norm=1.616791 delta_norm=0.037156
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=51 metric=0.7111 head_norm=1.574008
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.810688e-02
[S5] stored merged vector for next round verification (round=51)
[S5] DEBUG after merge:  round=51 metric=0.7064 head_norm=1.584842 delta_norm=0.028107
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=52 head_norm_before_train=1.666522 cos_to_last_merge=0.9906 (last merge round=39)
[S2] round=52 local utility u=0.137657 metrics={'f1_val': 0.7104200165592212, 'auprc': 0.8587318236187867, 'loss_val': 0.6050450536432792, 'psi': 0.7697447393830474}-{'f1_val': 0.690791403518846, 'auprc': 0.813460708026336, 'loss_val': 0.6267742192434611, 'psi': 0.7398591253218421}
[S3] START round=52 head_norm_before_train=1.602711 cos_to_last_merge=1.0000 (last merge round=50)
[S3] round=52 local utility u=0.474270 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9999254577904986, 'loss_val': 0.04140148810405513, 'psi': 0.9982562652056424}-{'f1_val': 0.8946805577331824, 'auprc': 0.9693573849239869, 'loss_val': 0.2834593957416363, 'psi': 0.9245512886095042}
[S4] START round=52 head_norm_before_train=2.215695 cos_to_last_merge=1.0000 (last merge round=51)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9539196366760201, 'auprc': 0.9841420864335754, 'loss_val': 0.27739932723232663, 'psi': 0.9660086165790421}-{'f1_val': 0.9551751801865437, 'auprc': 0.9860142686678619, 'loss_val': 0.26047847014052306, 'psi': 0.9675108155790709}
[S5] START round=52 head_norm_before_train=1.584842 cos_to_last_merge=1.0000 (last merge round=51)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.42069198411460296, 'auprc': 0.7536176500238303, 'loss_val': 1.240380498592247, 'psi': 0.553862250478294}-{'f1_val': 0.7110779240256426, 'auprc': 0.9890151881035307, 'loss_val': 0.21620437187679226, 'psi': 0.8222528296567979}
[S6] START round=52 head_norm_before_train=1.806051 cos_to_last_merge=0.9993 (last merge round=49)
[S6] round=52 local utility u=0.945105 metrics={'f1_val': 0.7805514268849403, 'auprc': 0.9506847486072523, 'loss_val': 0.5679517971373694, 'psi': 0.848604755573865}-{'f1_val': 0.5956142989900671, 'auprc': 0.8625704204237639, 'loss_val': 1.0841954249825796, 'psi': 0.7023967475635458}
[S7] START round=52 head_norm_before_train=1.586285 cos_to_last_merge=0.9999 (last merge round=50)
[S7] round=52 local utility u=0.295496 metrics={'f1_val': 0.6506932318629002, 'auprc': 0.7993902697225609, 'loss_val': 0.544082113999864, 'psi': 0.7101720470067645}-{'f1_val': 0.590356349618282, 'auprc': 0.7825002082096559, 'loss_val': 0.7223817566271299, 'psi': 0.6672138930548316}
[S8] START round=52 head_norm_before_train=1.804328 cos_to_last_merge=0.9999 (last merge round=50)
[S8] round=52 local utility u=0.023370 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9989195317913069, 'loss_val': 0.05027327655989742, 'psi': 0.9924924687166605}-{'f1_val': 0.9841756587624003, 'auprc': 0.9963640558882291, 'loss_val': 0.06515517621878764, 'psi': 0.9890510176127318}
[S9] START round=52 head_norm_before_train=1.884325 cos_to_last_merge=0.9926 (last merge round=34)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.998152081940956, 'loss_val': 0.03876114844242877, 'psi': 0.993103702536928}-{'f1_val': 0.994356655862817, 'auprc': 0.9981559418069839, 'loss_val': 0.027721668024343976, 'psi': 0.9958763702404838}
[S10] START round=52 head_norm_before_train=2.276574 (no previous merge yet)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996441616689611, 'loss_val': 0.025474412188766896, 'psi': 0.9957705190140826}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971324764324707, 'loss_val': 0.02432407703737806, 'psi': 0.9960468629112265}
[S11] START round=52 head_norm_before_train=2.217463 cos_to_last_merge=1.0000 (last merge round=51)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9964825747812232, 'auprc': 0.9987493506583806, 'loss_val': 0.01999176689592274, 'psi': 0.9973892851320861}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989814809012896, 'loss_val': 0.020332674877345414, 'psi': 0.9975231453575741}
[S13] START round=52 head_norm_before_train=1.938596 (no previous merge yet)
[S13] round=52 local utility u=0.521677 metrics={'f1_val': 0.736654965135526, 'auprc': 0.7930821549610417, 'loss_val': 0.9069364642286815, 'psi': 0.7592258410657322}-{'f1_val': 0.6335617006509202, 'auprc': 0.7093003681290189, 'loss_val': 1.080386381058463, 'psi': 0.6638571676421596}
[S14] START round=52 head_norm_before_train=1.612521 cos_to_last_merge=0.9641 (last merge round=33)
[S14] round=52 local utility u=0.001928 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9981368015863302, 'loss_val': 0.0315301486230541, 'psi': 0.9975406920724117}-{'f1_val': 0.9965652232429598, 'auprc': 0.998222523427564, 'loss_val': 0.03217453894950415, 'psi': 0.9972281433168015}
[S15] START round=52 head_norm_before_train=1.590716 cos_to_last_merge=1.0000 (last merge round=51)
[S15] round=52 local utility u=0.217384 metrics={'f1_val': 0.9025988760013092, 'auprc': 0.9962916932033585, 'loss_val': 0.16804611741183098, 'psi': 0.9400760028821289}-{'f1_val': 0.8481610828108673, 'auprc': 0.9945259954886467, 'loss_val': 0.2708893893216949, 'psi': 0.9067070478819791}
[S16] START round=52 head_norm_before_train=1.616791 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9915012738001124, 'auprc': 0.9924752386068846, 'loss_val': 0.05649727906100145, 'psi': 0.9918908597228213}-{'f1_val': 0.9917208371331422, 'auprc': 0.9919419542429277, 'loss_val': 0.05608525069271672, 'psi': 0.9918092839770564}
[S17] START round=52 head_norm_before_train=2.056209 cos_to_last_merge=0.7711 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.9131517381031391, 'auprc': 0.9778408426360031, 'loss_val': 0.3591384482880554, 'psi': 0.9390273799162847}-{'f1_val': 0.9268901311211247, 'auprc': 0.9789765780717193, 'loss_val': 0.2531657199936802, 'psi': 0.9477247099013626}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:49311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9880
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.9951
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] cosine check vs S13: cos=-0.0348
[S10] DROPPED delta from S13 (cos=-0.0348 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9880
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49308
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S2
[S3] cosine check vs S2: cos=0.9800
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=52 metric=0.9882 head_norm=1.817804
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.413324e-01
[S8] stored merged vector for next round verification (round=52)
[S8] DEBUG after merge:  round=52 metric=0.9882 head_norm=1.817009 delta_norm=0.141332
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9954
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9951
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=52 metric=0.9971 head_norm=1.613605
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.176870e-02
[S3] stored merged vector for next round verification (round=52)
[S3] DEBUG after merge:  round=52 metric=0.9971 head_norm=1.616970 delta_norm=0.051769
[S3] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.679702 cos_to_last_merge=0.9901 (last merge round=39)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.7109295270339171, 'auprc': 0.8552598743679464, 'loss_val': 0.6345632583114371, 'psi': 0.7686616659675288}-{'f1_val': 0.7104200165592212, 'auprc': 0.8587318236187867, 'loss_val': 0.6050450536432792, 'psi': 0.7697447393830474}
[S3] START round=53 head_norm_before_train=1.616970 cos_to_last_merge=1.0000 (last merge round=52)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9494935376263958, 'auprc': 0.9894522533113297, 'loss_val': 0.1251524690345577, 'psi': 0.9654770239003694}-{'f1_val': 0.9971434701490716, 'auprc': 0.9999254577904986, 'loss_val': 0.04140148810405513, 'psi': 0.9982562652056424}
[S4] START round=53 head_norm_before_train=2.221230 cos_to_last_merge=1.0000 (last merge round=51)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9546990860416824, 'auprc': 0.9588082196370465, 'loss_val': 0.32458682172830755, 'psi': 0.9563427394798281}-{'f1_val': 0.9539196366760201, 'auprc': 0.9841420864335754, 'loss_val': 0.27739932723232663, 'psi': 0.9660086165790421}
[S5] START round=53 head_norm_before_train=1.594030 cos_to_last_merge=0.9999 (last merge round=51)
[S5] round=53 local utility u=1.000000 metrics={'f1_val': 0.9363076973352262, 'auprc': 0.9921321474128989, 'loss_val': 0.15291028403544868, 'psi': 0.9586374773662953}-{'f1_val': 0.42069198411460296, 'auprc': 0.7536176500238303, 'loss_val': 1.240380498592247, 'psi': 0.553862250478294}
[S6] START round=53 head_norm_before_train=1.827180 cos_to_last_merge=0.9988 (last merge round=49)
[S6] round=53 local utility u=0.199646 metrics={'f1_val': 0.8360065857228738, 'auprc': 0.9372996856328227, 'loss_val': 0.4612363166179738, 'psi': 0.8765238256868534}-{'f1_val': 0.7805514268849403, 'auprc': 0.9506847486072523, 'loss_val': 0.5679517971373694, 'psi': 0.848604755573865}
[S7] START round=53 head_norm_before_train=1.599114 cos_to_last_merge=0.9997 (last merge round=50)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5743350131340226, 'auprc': 0.7843101967349121, 'loss_val': 0.8068904603413463, 'psi': 0.6583250865743784}-{'f1_val': 0.6506932318629002, 'auprc': 0.7993902697225609, 'loss_val': 0.544082113999864, 'psi': 0.7101720470067645}
[S8] START round=53 head_norm_before_train=1.817009 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=53 local utility u=0.016111 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9987628670873119, 'loss_val': 0.041321892515765526, 'psi': 0.9948039165079561}-{'f1_val': 0.9882077600002297, 'auprc': 0.9989195317913069, 'loss_val': 0.05027327655989742, 'psi': 0.9924924687166605}
[S9] START round=53 head_norm_before_train=1.890608 cos_to_last_merge=0.9923 (last merge round=34)
[S9] round=53 local utility u=0.024658 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9981391138697493, 'loss_val': 0.023472901906916213, 'psi': 0.9965051450698712}-{'f1_val': 0.9897381162675762, 'auprc': 0.998152081940956, 'loss_val': 0.03876114844242877, 'psi': 0.993103702536928}
[S10] START round=53 head_norm_before_train=2.276755 (no previous merge yet)
[S10] round=53 local utility u=0.000747 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966677833457012, 'loss_val': 0.02465842916819331, 'psi': 0.9958609856765186}-{'f1_val': 0.9953231205637304, 'auprc': 0.996441616689611, 'loss_val': 0.025474412188766896, 'psi': 0.9957705190140826}
[S11] START round=53 head_norm_before_train=2.225554 cos_to_last_merge=1.0000 (last merge round=51)
[S11] round=53 local utility u=0.002502 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987370037777377, 'loss_val': 0.01784112254923239, 'psi': 0.9976733554868413}-{'f1_val': 0.9964825747812232, 'auprc': 0.9987493506583806, 'loss_val': 0.01999176689592274, 'psi': 0.9973892851320861}
[S13] START round=53 head_norm_before_train=1.942661 (no previous merge yet)
[S13] round=53 local utility u=0.040690 metrics={'f1_val': 0.7435172219903532, 'auprc': 0.7617945121598957, 'loss_val': 0.7728675651580657, 'psi': 0.7508281380581702}-{'f1_val': 0.736654965135526, 'auprc': 0.7930821549610417, 'loss_val': 0.9069364642286815, 'psi': 0.7592258410657322}
[S14] START round=53 head_norm_before_train=1.622048 cos_to_last_merge=0.9631 (last merge round=33)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9967069220853351, 'loss_val': 0.031668653247654825, 'psi': 0.9969819446327892}-{'f1_val': 0.9971432857297993, 'auprc': 0.9981368015863302, 'loss_val': 0.0315301486230541, 'psi': 0.9975406920724117}
[S15] START round=53 head_norm_before_train=1.616565 cos_to_last_merge=0.9999 (last merge round=51)
[S15] round=53 local utility u=0.078229 metrics={'f1_val': 0.9228356422667017, 'auprc': 0.9962891662061535, 'loss_val': 0.13300163524999273, 'psi': 0.9522170518424824}-{'f1_val': 0.9025988760013092, 'auprc': 0.9962916932033585, 'loss_val': 0.16804611741183098, 'psi': 0.9400760028821289}
[S16] START round=53 head_norm_before_train=1.631450 cos_to_last_merge=1.0000 (last merge round=51)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9899947248651302, 'auprc': 0.990299402802228, 'loss_val': 0.060507116421641256, 'psi': 0.9901165960399693}-{'f1_val': 0.9915012738001124, 'auprc': 0.9924752386068846, 'loss_val': 0.05649727906100145, 'psi': 0.9918908597228213}
[S17] START round=53 head_norm_before_train=2.069472 cos_to_last_merge=0.7702 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=53 local utility u=0.115591 metrics={'f1_val': 0.9260498202616305, 'auprc': 0.9822229040724594, 'loss_val': 0.21849135134445352, 'psi': 0.9485190537859621}-{'f1_val': 0.9131517381031391, 'auprc': 0.9778408426360031, 'loss_val': 0.3591384482880554, 'psi': 0.9390273799162847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:49309
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1808 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0343
[S10] DROPPED delta from S13 (cos=-0.0343 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0343
[S13] DROPPED delta from S10 (cos=-0.0343 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1808) from S6
[S8] cosine check vs S6: cos=0.9961
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:49305
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=53 metric=0.8360 head_norm=1.845098
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.516699e-01
[S6] stored merged vector for next round verification (round=53)
[S6] DEBUG after merge:  round=53 metric=0.8345 head_norm=1.825211 delta_norm=0.151670
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9944
[S15] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S15
[S5] cosine check vs S15: cos=0.9944
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=53 metric=0.9363 head_norm=1.600076
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.167823e-02
[S5] stored merged vector for next round verification (round=53)
[S5] DEBUG after merge:  round=53 metric=0.9348 head_norm=1.612410 delta_norm=0.081678
[S5] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=53 metric=0.5743 head_norm=1.610213
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.474240e-02
[S7] stored merged vector for next round verification (round=53)
[S7] DEBUG after merge:  round=53 metric=0.5744 head_norm=1.609681 delta_norm=0.084742
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S9
[S8] cosine check vs S9: cos=0.9171
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=53 metric=0.9922 head_norm=1.831923
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.561268e-01
[S8] stored merged vector for next round verification (round=53)
[S8] DEBUG after merge:  round=53 metric=0.9922 head_norm=1.816594 delta_norm=0.156127
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=53 metric=0.9228 head_norm=1.641023
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.806603e-02
[S15] stored merged vector for next round verification (round=53)
[S15] DEBUG after merge:  round=53 metric=0.9239 head_norm=1.618284 delta_norm=0.088066
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.692342 cos_to_last_merge=0.9897 (last merge round=39)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.660356418308665, 'auprc': 0.7953508895740471, 'loss_val': 0.8958586217970176, 'psi': 0.7143542068148179}-{'f1_val': 0.7109295270339171, 'auprc': 0.8552598743679464, 'loss_val': 0.6345632583114371, 'psi': 0.7686616659675288}
[S3] START round=54 head_norm_before_train=1.630002 cos_to_last_merge=1.0000 (last merge round=52)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.92354156652712, 'auprc': 0.98812256099487, 'loss_val': 0.20192129019805222, 'psi': 0.94937396431422}-{'f1_val': 0.9494935376263958, 'auprc': 0.9894522533113297, 'loss_val': 0.1251524690345577, 'psi': 0.9654770239003694}
[S4] START round=54 head_norm_before_train=2.228061 cos_to_last_merge=0.9999 (last merge round=51)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9370445022619545, 'auprc': 0.9662751693038392, 'loss_val': 0.27290506393350344, 'psi': 0.9487367690787083}-{'f1_val': 0.9546990860416824, 'auprc': 0.9588082196370465, 'loss_val': 0.32458682172830755, 'psi': 0.9563427394798281}
[S5] START round=54 head_norm_before_train=1.612410 cos_to_last_merge=1.0000 (last merge round=53)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9593131405973726, 'loss_val': 0.434257844468314, 'psi': 0.8039694020675101}-{'f1_val': 0.9363076973352262, 'auprc': 0.9921321474128989, 'loss_val': 0.15291028403544868, 'psi': 0.9586374773662953}
[S6] START round=54 head_norm_before_train=1.825211 cos_to_last_merge=1.0000 (last merge round=53)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6763386714624356, 'auprc': 0.9363338028974959, 'loss_val': 0.7682393101149037, 'psi': 0.7803367240364598}-{'f1_val': 0.8360065857228738, 'auprc': 0.9372996856328227, 'loss_val': 0.4612363166179738, 'psi': 0.8765238256868534}
[S7] START round=54 head_norm_before_train=1.609681 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=54 local utility u=0.582045 metrics={'f1_val': 0.6769642282234891, 'auprc': 0.8269332058934449, 'loss_val': 0.3864446573948522, 'psi': 0.7369518192914715}-{'f1_val': 0.5743350131340226, 'auprc': 0.7843101967349121, 'loss_val': 0.8068904603413463, 'psi': 0.6583250865743784}
[S8] START round=54 head_norm_before_train=1.816594 cos_to_last_merge=1.0000 (last merge round=53)
[S8] round=54 local utility u=0.002810 metrics={'f1_val': 0.9931151371785213, 'auprc': 0.9987534712946302, 'loss_val': 0.04137585605200074, 'psi': 0.9953704708249649}-{'f1_val': 0.9921646161217188, 'auprc': 0.9987628670873119, 'loss_val': 0.041321892515765526, 'psi': 0.9948039165079561}
[S9] START round=54 head_norm_before_train=1.895278 cos_to_last_merge=0.9920 (last merge round=34)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9981432474453251, 'loss_val': 0.03689211894203442, 'psi': 0.9933351634620073}-{'f1_val': 0.9954158325366191, 'auprc': 0.9981391138697493, 'loss_val': 0.023472901906916213, 'psi': 0.9965051450698712}
[S10] START round=54 head_norm_before_train=2.282633 (no previous merge yet)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9966488309139522, 'loss_val': 0.024753926683033403, 'psi': 0.995853404703819}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966677833457012, 'loss_val': 0.02465842916819331, 'psi': 0.9958609856765186}
[S11] START round=54 head_norm_before_train=2.234084 cos_to_last_merge=1.0000 (last merge round=51)
[S11] round=54 local utility u=0.001593 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9987336243248186, 'loss_val': 0.017127289374376183, 'psi': 0.9979203015925431}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987370037777377, 'loss_val': 0.01784112254923239, 'psi': 0.9976733554868413}
[S13] START round=54 head_norm_before_train=1.953058 (no previous merge yet)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.7407998777204087, 'auprc': 0.7922316393735418, 'loss_val': 0.9749903282213014, 'psi': 0.7613725823816619}-{'f1_val': 0.7435172219903532, 'auprc': 0.7617945121598957, 'loss_val': 0.7728675651580657, 'psi': 0.7508281380581702}
[S14] START round=54 head_norm_before_train=1.633558 cos_to_last_merge=0.9620 (last merge round=33)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9430960689708028, 'auprc': 0.9970423230919955, 'loss_val': 0.0879786388086455, 'psi': 0.9646745706192799}-{'f1_val': 0.9971652929977585, 'auprc': 0.9967069220853351, 'loss_val': 0.031668653247654825, 'psi': 0.9969819446327892}
[S15] START round=54 head_norm_before_train=1.618284 cos_to_last_merge=1.0000 (last merge round=53)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.802646649435898, 'auprc': 0.993381846587521, 'loss_val': 0.32980910805310354, 'psi': 0.8789407282965472}-{'f1_val': 0.9228356422667017, 'auprc': 0.9962891662061535, 'loss_val': 0.13300163524999273, 'psi': 0.9522170518424824}
[S16] START round=54 head_norm_before_train=1.645087 cos_to_last_merge=0.9999 (last merge round=51)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.9836270132488294, 'auprc': 0.9888679582641674, 'loss_val': 0.08543896890406798, 'psi': 0.9857233912549646}-{'f1_val': 0.9899947248651302, 'auprc': 0.990299402802228, 'loss_val': 0.060507116421641256, 'psi': 0.9901165960399693}
[S17] START round=54 head_norm_before_train=2.074028 cos_to_last_merge=0.7695 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.8313764135626885, 'auprc': 0.9546742420009304, 'loss_val': 0.8029742790550933, 'psi': 0.8806955449379853}-{'f1_val': 0.9260498202616305, 'auprc': 0.9822229040724594, 'loss_val': 0.21849135134445352, 'psi': 0.9485190537859621}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=54 metric=0.6763 head_norm=1.842642
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.737592e-02
[S6] stored merged vector for next round verification (round=54)
[S6] DEBUG after merge:  round=54 metric=0.6779 head_norm=1.837086 delta_norm=0.027376
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=54 metric=0.9370 head_norm=2.235068
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.757806e-02
[S4] stored merged vector for next round verification (round=54)
[S4] DEBUG after merge:  round=54 metric=0.9378 head_norm=2.234507 delta_norm=0.017578
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.9966
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9999
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=54 metric=0.9235 head_norm=1.642813
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.807549e-02
[S3] stored merged vector for next round verification (round=54)
[S3] DEBUG after merge:  round=54 metric=0.9235 head_norm=1.629312 delta_norm=0.068075
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9963
[S2] START round=55 head_norm_before_train=1.702947 cos_to_last_merge=0.9889 (last merge round=39)
[S2] round=55 local utility u=0.318553 metrics={'f1_val': 0.703439377194013, 'auprc': 0.8260851788825263, 'loss_val': 0.6094541073578409, 'psi': 0.7524976978694182}-{'f1_val': 0.660356418308665, 'auprc': 0.7953508895740471, 'loss_val': 0.8958586217970176, 'psi': 0.7143542068148179}
[S3] START round=55 head_norm_before_train=1.629312 cos_to_last_merge=1.0000 (last merge round=54)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.7434602453418461, 'auprc': 0.9768631281109259, 'loss_val': 0.5974377478315214, 'psi': 0.836821398449478}-{'f1_val': 0.92354156652712, 'auprc': 0.98812256099487, 'loss_val': 0.20192129019805222, 'psi': 0.94937396431422}
[S4] START round=55 head_norm_before_train=2.234507 cos_to_last_merge=1.0000 (last merge round=54)
[S4] round=55 local utility u=0.056488 metrics={'f1_val': 0.9504921045654264, 'auprc': 0.9813440052022049, 'loss_val': 0.28582165606772825, 'psi': 0.9628328648201377}-{'f1_val': 0.9370445022619545, 'auprc': 0.9662751693038392, 'loss_val': 0.27290506393350344, 'psi': 0.9487367690787083}
[S5] START round=55 head_norm_before_train=1.618505 cos_to_last_merge=0.9999 (last merge round=53)
[S5] round=55 local utility u=0.433865 metrics={'f1_val': 0.7823216644797018, 'auprc': 0.9941025923976474, 'loss_val': 0.1623848698196431, 'psi': 0.86703403564688}-{'f1_val': 0.7004069097142683, 'auprc': 0.9593131405973726, 'loss_val': 0.434257844468314, 'psi': 0.8039694020675101}
[S6] START round=55 head_norm_before_train=1.837086 cos_to_last_merge=1.0000 (last merge round=54)
[S6] round=55 local utility u=0.513556 metrics={'f1_val': 0.804507901980519, 'auprc': 0.9374998089673472, 'loss_val': 0.5136407498393576, 'psi': 0.8577046647752503}-{'f1_val': 0.6763386714624356, 'auprc': 0.9363338028974959, 'loss_val': 0.7682393101149037, 'psi': 0.7803367240364598}
[S7] START round=55 head_norm_before_train=1.618564 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.4658403284741943, 'auprc': 0.7806745236989698, 'loss_val': 1.0900912800790028, 'psi': 0.5917740065641045}-{'f1_val': 0.6769642282234891, 'auprc': 0.8269332058934449, 'loss_val': 0.3864446573948522, 'psi': 0.7369518192914715}
[S8] START round=55 head_norm_before_train=1.829569 cos_to_last_merge=0.9999 (last merge round=53)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9657348410316102, 'auprc': 0.9928594255018918, 'loss_val': 0.1140485593296511, 'psi': 0.9765846748197229}-{'f1_val': 0.9931151371785213, 'auprc': 0.9987534712946302, 'loss_val': 0.04137585605200074, 'psi': 0.9953704708249649}
[S9] START round=55 head_norm_before_train=1.899715 cos_to_last_merge=0.9917 (last merge round=34)
[S9] round=55 local utility u=0.026413 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980358809862571, 'loss_val': 0.02292904668554355, 'psi': 0.9972106594828377}-{'f1_val': 0.9901297741397954, 'auprc': 0.9981432474453251, 'loss_val': 0.03689211894203442, 'psi': 0.9933351634620073}
[S10] START round=55 head_norm_before_train=2.291087 (no previous merge yet)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996488140335765, 'loss_val': 0.025366924729092622, 'psi': 0.9957891284725442}-{'f1_val': 0.9953231205637304, 'auprc': 0.9966488309139522, 'loss_val': 0.024753926683033403, 'psi': 0.995853404703819}
[S11] START round=55 head_norm_before_train=2.242563 cos_to_last_merge=0.9999 (last merge round=51)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9775371859862062, 'auprc': 0.998788718504859, 'loss_val': 0.08426902257952662, 'psi': 0.9860377989936673}-{'f1_val': 0.9973780864376928, 'auprc': 0.9987336243248186, 'loss_val': 0.017127289374376183, 'psi': 0.9979203015925431}
[S13] START round=55 head_norm_before_train=1.962608 (no previous merge yet)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.7399943018497813, 'auprc': 0.7479005362381589, 'loss_val': 0.9020173532601236, 'psi': 0.7431567956051324}-{'f1_val': 0.7407998777204087, 'auprc': 0.7922316393735418, 'loss_val': 0.9749903282213014, 'psi': 0.7613725823816619}
[S14] START round=55 head_norm_before_train=1.644477 cos_to_last_merge=0.9609 (last merge round=33)
[S14] round=55 local utility u=0.191802 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9976099926176207, 'loss_val': 0.030492399789875245, 'psi': 0.9973431728457034}-{'f1_val': 0.9430960689708028, 'auprc': 0.9970423230919955, 'loss_val': 0.0879786388086455, 'psi': 0.9646745706192799}
[S15] START round=55 head_norm_before_train=1.641682 cos_to_last_merge=0.9999 (last merge round=53)
[S15] round=55 local utility u=0.738500 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971573650919792, 'loss_val': 0.02873623940175394, 'psi': 0.996910947069304}-{'f1_val': 0.802646649435898, 'auprc': 0.993381846587521, 'loss_val': 0.32980910805310354, 'psi': 0.8789407282965472}
[S16] START round=55 head_norm_before_train=1.657951 cos_to_last_merge=0.9997 (last merge round=51)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9792966706047798, 'auprc': 0.9895046721723881, 'loss_val': 0.09276097226632957, 'psi': 0.9833798712318231}-{'f1_val': 0.9836270132488294, 'auprc': 0.9888679582641674, 'loss_val': 0.08543896890406798, 'psi': 0.9857233912549646}
[S17] START round=55 head_norm_before_train=2.081332 cos_to_last_merge=0.7686 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=55 local utility u=0.719768 metrics={'f1_val': 0.9481351296460718, 'auprc': 0.9808368733939972, 'loss_val': 0.14247807521139857, 'psi': 0.961215827145242}-{'f1_val': 0.8313764135626885, 'auprc': 0.9546742420009304, 'loss_val': 0.8029742790550933, 'psi': 0.8806955449379853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] ⇄ pheromone p=0.010 → S4@127.0.0.1:49304
[S7] ⇄ pheromone p=0.207 → S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] ⇄ pheromone p=0.136 → S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9983
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9954
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=55 metric=0.8045 head_norm=1.856209
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.180269e-02
[S6] stored merged vector for next round verification (round=55)
[S6] DEBUG after merge:  round=55 metric=0.8039 head_norm=1.840649 delta_norm=0.091803
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.347 → S8@127.0.0.1:49309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.040 → S16@127.0.0.1:49316
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=55 metric=0.9505 head_norm=2.237321
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.890630e-02
[S4] stored merged vector for next round verification (round=55)
[S4] DEBUG after merge:  round=55 metric=0.9505 head_norm=2.239864 delta_norm=0.018906
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.018 → S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:49305
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=0.9763
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S15] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1808) from S15
[S5] cosine check vs S15: cos=0.9994
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S9
[S8] cosine check vs S9: cos=0.9453
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=55 metric=0.7823 head_norm=1.625109
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.586514e-02
[S5] stored merged vector for next round verification (round=55)
[S5] DEBUG after merge:  round=55 metric=0.8387 head_norm=1.645735 delta_norm=0.035865
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.354 → S15@127.0.0.1:49315
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=55 metric=0.9793 head_norm=1.669842
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.975951e-02
[S16] stored merged vector for next round verification (round=55)
[S16] DEBUG after merge:  round=55 metric=0.9784 head_norm=1.660996 delta_norm=0.049760
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.034 → S5@127.0.0.1:49305
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=55 metric=0.9657 head_norm=1.844875
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.129500e-01
[S8] stored merged vector for next round verification (round=55)
[S8] DEBUG after merge:  round=55 metric=0.9657 head_norm=1.837536 delta_norm=0.112950
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.014 → S6@127.0.0.1:49307
[S9] ⇄ pheromone p=0.010 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=0.111 → S3@127.0.0.1:49303
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=55 metric=0.9967 head_norm=1.666877
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.586515e-02
[S15] stored merged vector for next round verification (round=55)
[S15] DEBUG after merge:  round=55 metric=0.9967 head_norm=1.645735 delta_norm=0.035865
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.305 → S5@127.0.0.1:49305
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=55 metric=0.7435 head_norm=1.642349
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.861249e-01
[S3] stored merged vector for next round verification (round=55)
[S3] DEBUG after merge:  round=55 metric=0.7296 head_norm=1.667711 delta_norm=0.186125
[S3] aggregate: ROLLBACK (f1_val pre=0.743 post=0.730 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.123 → S17@127.0.0.1:49317
[S2] START round=56 head_norm_before_train=1.713037 cos_to_last_merge=0.9881 (last merge round=39)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.7213419384884773, 'auprc': 0.8036896475515327, 'loss_val': 0.770327514327267, 'psi': 0.7542810221136995}-{'f1_val': 0.703439377194013, 'auprc': 0.8260851788825263, 'loss_val': 0.6094541073578409, 'psi': 0.7524976978694182}
[S3] START round=56 head_norm_before_train=1.667711 cos_to_last_merge=1.0000 (last merge round=55)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.6979549119679693, 'auprc': 0.9449295740005819, 'loss_val': 0.7577713057283041, 'psi': 0.7967447767810143}-{'f1_val': 0.7434602453418461, 'auprc': 0.9768631281109259, 'loss_val': 0.5974377478315214, 'psi': 0.836821398449478}
[S4] START round=56 head_norm_before_train=2.239864 cos_to_last_merge=1.0000 (last merge round=55)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9525429979580093, 'auprc': 0.9664317053023458, 'loss_val': 0.32262700812100903, 'psi': 0.9580984808957439}-{'f1_val': 0.9504921045654264, 'auprc': 0.9813440052022049, 'loss_val': 0.28582165606772825, 'psi': 0.9628328648201377}
[S5] START round=56 head_norm_before_train=1.645735 cos_to_last_merge=1.0000 (last merge round=55)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.6294757852792057, 'auprc': 0.8706475853999835, 'loss_val': 0.6163256572181346, 'psi': 0.7259445053275169}-{'f1_val': 0.7823216644797018, 'auprc': 0.9941025923976474, 'loss_val': 0.1623848698196431, 'psi': 0.86703403564688}
[S6] START round=56 head_norm_before_train=1.840649 cos_to_last_merge=1.0000 (last merge round=55)
[S6] round=56 local utility u=0.176866 metrics={'f1_val': 0.8477522952154888, 'auprc': 0.9529437602268642, 'loss_val': 0.4657069775582954, 'psi': 0.8898288812200389}-{'f1_val': 0.804507901980519, 'auprc': 0.9374998089673472, 'loss_val': 0.5136407498393576, 'psi': 0.8577046647752503}
[S7] START round=56 head_norm_before_train=1.627085 cos_to_last_merge=0.9999 (last merge round=53)
[S7] round=56 local utility u=1.000000 metrics={'f1_val': 0.6993057363435196, 'auprc': 0.9499633494653323, 'loss_val': 0.23256969374181494, 'psi': 0.7995687815922448}-{'f1_val': 0.4658403284741943, 'auprc': 0.7806745236989698, 'loss_val': 1.0900912800790028, 'psi': 0.5917740065641045}
[S8] START round=56 head_norm_before_train=1.837536 cos_to_last_merge=1.0000 (last merge round=55)
[S8] round=56 local utility u=0.099678 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9988875686833355, 'loss_val': 0.05692399457264246, 'psi': 0.9914105508353677}-{'f1_val': 0.9657348410316102, 'auprc': 0.9928594255018918, 'loss_val': 0.1140485593296511, 'psi': 0.9765846748197229}
[S9] START round=56 head_norm_before_train=1.903071 cos_to_last_merge=0.9917 (last merge round=34)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.997754453185064, 'loss_val': 0.02321852237804667, 'psi': 0.9970980883623605}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980358809862571, 'loss_val': 0.02292904668554355, 'psi': 0.9972106594828377}
[S10] START round=56 head_norm_before_train=2.300430 (no previous merge yet)
[S10] round=56 local utility u=0.000703 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996677195199751, 'loss_val': 0.024528580759685455, 'psi': 0.9958647504181386}-{'f1_val': 0.9953231205637304, 'auprc': 0.996488140335765, 'loss_val': 0.025366924729092622, 'psi': 0.9957891284725442}
[S11] START round=56 head_norm_before_train=2.249480 cos_to_last_merge=0.9999 (last merge round=51)
[S11] round=56 local utility u=0.090219 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987644732160573, 'loss_val': 0.018868921469830154, 'psi': 0.9975392410353321}-{'f1_val': 0.9775371859862062, 'auprc': 0.998788718504859, 'loss_val': 0.08426902257952662, 'psi': 0.9860377989936673}
[S13] START round=56 head_norm_before_train=1.967798 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6320912489115775, 'auprc': 0.6745134420414429, 'loss_val': 1.1488692032959633, 'psi': 0.6490601261635237}-{'f1_val': 0.7399943018497813, 'auprc': 0.7479005362381589, 'loss_val': 0.9020173532601236, 'psi': 0.7431567956051324}
[S14] START round=56 head_norm_before_train=1.653600 cos_to_last_merge=0.9599 (last merge round=33)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9965382307139673, 'auprc': 0.996447661459819, 'loss_val': 0.03172755112482826, 'psi': 0.996502003012308}-{'f1_val': 0.9971652929977585, 'auprc': 0.9976099926176207, 'loss_val': 0.030492399789875245, 'psi': 0.9973431728457034}
[S15] START round=56 head_norm_before_train=1.645735 cos_to_last_merge=1.0000 (last merge round=55)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9229645488277421, 'auprc': 0.9962342487078648, 'loss_val': 0.13383507893814994, 'psi': 0.9522724287797912}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971573650919792, 'loss_val': 0.02873623940175394, 'psi': 0.996910947069304}
[S16] START round=56 head_norm_before_train=1.660996 cos_to_last_merge=1.0000 (last merge round=55)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9611319210525604, 'auprc': 0.9907487136399284, 'loss_val': 0.14359679906202044, 'psi': 0.9729786380875076}-{'f1_val': 0.9792966706047798, 'auprc': 0.9895046721723881, 'loss_val': 0.09276097226632957, 'psi': 0.9833798712318231}
[S17] START round=56 head_norm_before_train=2.092583 cos_to_last_merge=0.7677 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.8451062978524301, 'auprc': 0.9603871616281252, 'loss_val': 0.6056839602580233, 'psi': 0.8912186433627081}-{'f1_val': 0.9481351296460718, 'auprc': 0.9808368733939972, 'loss_val': 0.14247807521139857, 'psi': 0.961215827145242}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9876
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9933
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0331
[S13] DROPPED delta from S10 (cos=-0.0331 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=56 metric=0.9967 head_norm=2.254504
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.397971e-02
[S11] stored merged vector for next round verification (round=56)
[S11] DEBUG after merge:  round=56 metric=0.9967 head_norm=2.245801 delta_norm=0.023980
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=56 metric=0.6980 head_norm=1.680858
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.324739e-01
[S3] stored merged vector for next round verification (round=56)
[S3] DEBUG after merge:  round=56 metric=0.7127 head_norm=1.652649 delta_norm=0.132474
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49307
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.9933
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=56 metric=0.9864 head_norm=1.852101
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.073558e-01
[S8] stored merged vector for next round verification (round=56)
[S8] DEBUG after merge:  round=56 metric=0.9864 head_norm=1.852893 delta_norm=0.107356
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=1.722779 cos_to_last_merge=0.9876 (last merge round=39)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.7213086732602245, 'auprc': 0.7387040314928446, 'loss_val': 0.9084144108078153, 'psi': 0.7282668165532725}-{'f1_val': 0.7213419384884773, 'auprc': 0.8036896475515327, 'loss_val': 0.770327514327267, 'psi': 0.7542810221136995}
[S3] START round=57 head_norm_before_train=1.652649 cos_to_last_merge=1.0000 (last merge round=56)
[S3] round=57 local utility u=0.279080 metrics={'f1_val': 0.7842653765386864, 'auprc': 0.9295446200891629, 'loss_val': 0.671319370746569, 'psi': 0.8423770739588771}-{'f1_val': 0.6979549119679693, 'auprc': 0.9449295740005819, 'loss_val': 0.7577713057283041, 'psi': 0.7967447767810143}
[S4] START round=57 head_norm_before_train=2.240960 cos_to_last_merge=0.9999 (last merge round=55)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.953034252195812, 'auprc': 0.964469818632101, 'loss_val': 0.3265227803974783, 'psi': 0.9576084787703275}-{'f1_val': 0.9525429979580093, 'auprc': 0.9664317053023458, 'loss_val': 0.32262700812100903, 'psi': 0.9580984808957439}
[S5] START round=57 head_norm_before_train=1.651386 cos_to_last_merge=1.0000 (last merge round=55)
[S5] round=57 local utility u=0.584232 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9878932558022936, 'loss_val': 0.22570701653964917, 'psi': 0.8154536219865913}-{'f1_val': 0.6294757852792057, 'auprc': 0.8706475853999835, 'loss_val': 0.6163256572181346, 'psi': 0.7259445053275169}
[S6] START round=57 head_norm_before_train=1.859892 cos_to_last_merge=0.9999 (last merge round=55)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.596495991810609, 'auprc': 0.8891217696570749, 'loss_val': 1.181765071825483, 'psi': 0.7135463029491953}-{'f1_val': 0.8477522952154888, 'auprc': 0.9529437602268642, 'loss_val': 0.4657069775582954, 'psi': 0.8898288812200389}
[S7] START round=57 head_norm_before_train=1.634722 cos_to_last_merge=0.9997 (last merge round=53)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5416042536102279, 'auprc': 0.7809443141567478, 'loss_val': 0.886521092678882, 'psi': 0.637340277828836}-{'f1_val': 0.6993057363435196, 'auprc': 0.9499633494653323, 'loss_val': 0.23256969374181494, 'psi': 0.7995687815922448}
[S8] START round=57 head_norm_before_train=1.852893 cos_to_last_merge=1.0000 (last merge round=56)
[S8] round=57 local utility u=0.011255 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9865829877586381, 'loss_val': 0.038501139335304684, 'psi': 0.990588791711573}-{'f1_val': 0.9864258722700556, 'auprc': 0.9988875686833355, 'loss_val': 0.05692399457264246, 'psi': 0.9914105508353677}
[S9] START round=57 head_norm_before_train=1.907114 cos_to_last_merge=0.9915 (last merge round=34)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9981386561316433, 'loss_val': 0.03046213030485823, 'psi': 0.9942423458353942}-{'f1_val': 0.9966605118138915, 'auprc': 0.997754453185064, 'loss_val': 0.02321852237804667, 'psi': 0.9970980883623605}
[S10] START round=57 head_norm_before_train=2.305471 (no previous merge yet)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9965322139839344, 'loss_val': 0.025065226856976725, 'psi': 0.995806757931812}-{'f1_val': 0.9953231205637304, 'auprc': 0.996677195199751, 'loss_val': 0.024528580759685455, 'psi': 0.9958647504181386}
[S11] START round=57 head_norm_before_train=2.245801 cos_to_last_merge=1.0000 (last merge round=56)
[S11] round=57 local utility u=0.001474 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988653650705767, 'loss_val': 0.01767528001079148, 'psi': 0.997724700003977}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987644732160573, 'loss_val': 0.018868921469830154, 'psi': 0.9975392410353321}
[S13] START round=57 head_norm_before_train=1.980780 (no previous merge yet)
[S13] round=57 local utility u=0.143026 metrics={'f1_val': 0.6679508079373876, 'auprc': 0.7013236103967933, 'loss_val': 1.1584055008433007, 'psi': 0.6812999289211499}-{'f1_val': 0.6320912489115775, 'auprc': 0.6745134420414429, 'loss_val': 1.1488692032959633, 'psi': 0.6490601261635237}
[S14] START round=57 head_norm_before_train=1.662652 cos_to_last_merge=0.9591 (last merge round=33)
[S14] round=57 local utility u=0.005749 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9982232565110694, 'loss_val': 0.028200587978126045, 'psi': 0.9974766089655503}-{'f1_val': 0.9965382307139673, 'auprc': 0.996447661459819, 'loss_val': 0.03172755112482826, 'psi': 0.996502003012308}
[S15] START round=57 head_norm_before_train=1.671331 cos_to_last_merge=0.9999 (last merge round=55)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.828840976562648, 'auprc': 0.9934330952964385, 'loss_val': 0.3182601032526488, 'psi': 0.8946778240561641}-{'f1_val': 0.9229645488277421, 'auprc': 0.9962342487078648, 'loss_val': 0.13383507893814994, 'psi': 0.9522724287797912}
[S16] START round=57 head_norm_before_train=1.672380 cos_to_last_merge=1.0000 (last merge round=55)
[S16] round=57 local utility u=0.133070 metrics={'f1_val': 0.9899947248651302, 'auprc': 0.9931939858290945, 'loss_val': 0.05796978862195798, 'psi': 0.9912744292507158}-{'f1_val': 0.9611319210525604, 'auprc': 0.9907487136399284, 'loss_val': 0.14359679906202044, 'psi': 0.9729786380875076}
[S17] START round=57 head_norm_before_train=2.102824 cos_to_last_merge=0.7670 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=57 local utility u=0.179487 metrics={'f1_val': 0.8754022063275133, 'auprc': 0.9761189000394407, 'loss_val': 0.475680559170942, 'psi': 0.9156888838122843}-{'f1_val': 0.8451062978524301, 'auprc': 0.9603871616281252, 'loss_val': 0.6056839602580233, 'psi': 0.8912186433627081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=57 metric=0.5965 head_norm=1.883963
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.231333e-01
[S6] stored merged vector for next round verification (round=57)
[S6] DEBUG after merge:  round=57 metric=0.5965 head_norm=1.864038 delta_norm=0.123133
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:49315
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0329
[S10] DROPPED delta from S13 (cos=-0.0329 < 0.0)
[S8] not sending this round → trigger blocked (psi=0.991)
[S5] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S15] RECEIVED delta(kind=head bytes=1808) from S5
[S15] cosine check vs S5: cos=0.9996
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=0.9966
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=0.9658
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=57 metric=0.9530 head_norm=2.245344
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.584567e-02
[S4] stored merged vector for next round verification (round=57)
[S4] DEBUG after merge:  round=57 metric=0.9530 head_norm=2.249780 delta_norm=0.025846
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=57 metric=0.7005 head_norm=1.655320
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.186462e-01
[S5] stored merged vector for next round verification (round=57)
[S5] DEBUG after merge:  round=57 metric=0.7004 head_norm=1.655014 delta_norm=0.218646
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=57 metric=0.8288 head_norm=1.695295
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.140553e-02
[S15] stored merged vector for next round verification (round=57)
[S15] DEBUG after merge:  round=57 metric=0.8296 head_norm=1.675132 delta_norm=0.031406
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=58 head_norm_before_train=1.724855 cos_to_last_merge=0.9876 (last merge round=39)
[S2] round=58 local utility u=0.416172 metrics={'f1_val': 0.7074396209677571, 'auprc': 0.9147143633205888, 'loss_val': 0.5208879683250489, 'psi': 0.7903495179088897}-{'f1_val': 0.7213086732602245, 'auprc': 0.7387040314928446, 'loss_val': 0.9084144108078153, 'psi': 0.7282668165532725}
[S3] START round=58 head_norm_before_train=1.665820 cos_to_last_merge=1.0000 (last merge round=56)
[S3] round=58 local utility u=0.903373 metrics={'f1_val': 0.9578860128802906, 'auprc': 0.994784600464351, 'loss_val': 0.10201726363121912, 'psi': 0.9726454479139148}-{'f1_val': 0.7842653765386864, 'auprc': 0.9295446200891629, 'loss_val': 0.671319370746569, 'psi': 0.8423770739588771}
[S4] START round=58 head_norm_before_train=2.249780 cos_to_last_merge=1.0000 (last merge round=57)
[S4] round=58 local utility u=0.036486 metrics={'f1_val': 0.951490682062841, 'auprc': 0.9780179748173807, 'loss_val': 0.28493452110222167, 'psi': 0.9621015991646569}-{'f1_val': 0.953034252195812, 'auprc': 0.964469818632101, 'loss_val': 0.3265227803974783, 'psi': 0.9576084787703275}
[S5] START round=58 head_norm_before_train=1.655014 cos_to_last_merge=1.0000 (last merge round=57)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.6814407979996933, 'auprc': 0.9530704871827478, 'loss_val': 0.3130456349914842, 'psi': 0.790092673672915}-{'f1_val': 0.7004938661094564, 'auprc': 0.9878932558022936, 'loss_val': 0.22570701653964917, 'psi': 0.8154536219865913}
[S6] START round=58 head_norm_before_train=1.864038 cos_to_last_merge=1.0000 (last merge round=57)
[S6] round=58 local utility u=1.000000 metrics={'f1_val': 0.8577693909099788, 'auprc': 0.9645847337666429, 'loss_val': 0.3915185036133036, 'psi': 0.9004955280526444}-{'f1_val': 0.596495991810609, 'auprc': 0.8891217696570749, 'loss_val': 1.181765071825483, 'psi': 0.7135463029491953}
[S7] START round=58 head_norm_before_train=1.638921 cos_to_last_merge=0.9997 (last merge round=53)
[S7] round=58 local utility u=1.000000 metrics={'f1_val': 0.6969803733869859, 'auprc': 0.9286476026938735, 'loss_val': 0.23810982210260312, 'psi': 0.7896472651097409}-{'f1_val': 0.5416042536102279, 'auprc': 0.7809443141567478, 'loss_val': 0.886521092678882, 'psi': 0.637340277828836}
[S8] START round=58 head_norm_before_train=1.867064 cos_to_last_merge=1.0000 (last merge round=56)
[S8] round=58 local utility u=0.009524 metrics={'f1_val': 0.9909461167088028, 'auprc': 0.9988881440860188, 'loss_val': 0.04248907053978874, 'psi': 0.9941229276596892}-{'f1_val': 0.9932593276801964, 'auprc': 0.9865829877586381, 'loss_val': 0.038501139335304684, 'psi': 0.990588791711573}
[S9] START round=58 head_norm_before_train=1.912265 cos_to_last_merge=0.9913 (last merge round=34)
[S9] round=58 local utility u=0.008124 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9981414000633531, 'loss_val': 0.026805653504783842, 'psi': 0.9955018650191663}-{'f1_val': 0.9916448056378947, 'auprc': 0.9981386561316433, 'loss_val': 0.03046213030485823, 'psi': 0.9942423458353942}
[S10] START round=58 head_norm_before_train=2.310716 (no previous merge yet)
[S10] round=58 local utility u=0.000595 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996691971157434, 'loss_val': 0.024353798758975205, 'psi': 0.9958706608012118}-{'f1_val': 0.9953231205637304, 'auprc': 0.9965322139839344, 'loss_val': 0.025065226856976725, 'psi': 0.995806757931812}
[S11] START round=58 head_norm_before_train=2.250900 cos_to_last_merge=1.0000 (last merge round=56)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9962419185632914, 'auprc': 0.9988761804158792, 'loss_val': 0.01935058061769922, 'psi': 0.9972956233043264}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988653650705767, 'loss_val': 0.01767528001079148, 'psi': 0.997724700003977}
[S13] START round=58 head_norm_before_train=1.991054 (no previous merge yet)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6416526478291806, 'auprc': 0.7245759792864501, 'loss_val': 1.1912965773953543, 'psi': 0.6748219804120885}-{'f1_val': 0.6679508079373876, 'auprc': 0.7013236103967933, 'loss_val': 1.1584055008433007, 'psi': 0.6812999289211499}
[S14] START round=58 head_norm_before_train=1.671536 cos_to_last_merge=0.9583 (last merge round=33)
[S14] round=58 local utility u=0.000332 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9981139116500639, 'loss_val': 0.02720878617469978, 'psi': 0.9974328710211482}-{'f1_val': 0.9969788439352044, 'auprc': 0.9982232565110694, 'loss_val': 0.028200587978126045, 'psi': 0.9974766089655503}
[S15] START round=58 head_norm_before_train=1.675132 cos_to_last_merge=1.0000 (last merge round=57)
[S15] round=58 local utility u=0.220908 metrics={'f1_val': 0.88426375635475, 'auprc': 0.9949017217972322, 'loss_val': 0.21338758862430146, 'psi': 0.9285189425317428}-{'f1_val': 0.828840976562648, 'auprc': 0.9934330952964385, 'loss_val': 0.3182601032526488, 'psi': 0.8946778240561641}
[S16] START round=58 head_norm_before_train=1.683351 cos_to_last_merge=0.9999 (last merge round=55)
[S16] round=58 local utility u=0.008086 metrics={'f1_val': 0.9908478780768186, 'auprc': 0.9946248164203281, 'loss_val': 0.0512099169768367, 'psi': 0.9923586534142224}-{'f1_val': 0.9899947248651302, 'auprc': 0.9931939858290945, 'loss_val': 0.05796978862195798, 'psi': 0.9912744292507158}
[S17] START round=58 head_norm_before_train=2.108797 cos_to_last_merge=0.7665 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=58 local utility u=0.007235 metrics={'f1_val': 0.8792416963392056, 'auprc': 0.9735012652308467, 'loss_val': 0.4763949976390408, 'psi': 0.916945523895862}-{'f1_val': 0.8754022063275133, 'auprc': 0.9761189000394407, 'loss_val': 0.475680559170942, 'psi': 0.9156888838122843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=-0.0324
[S13] DROPPED delta from S10 (cos=-0.0324 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9964
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[S2] sending update (kind=head size=1805 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=58 metric=0.6970 head_norm=1.642260
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.017890e-02
[S7] stored merged vector for next round verification (round=58)
[S7] DEBUG after merge:  round=58 metric=0.6976 head_norm=1.652592 delta_norm=0.070179
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=0.7852
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=58 metric=0.9909 head_norm=1.877945
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.763679e-02
[S8] stored merged vector for next round verification (round=58)
[S8] DEBUG after merge:  round=58 metric=0.9909 head_norm=1.881093 delta_norm=0.027637
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1808) from S15
[S5] cosine check vs S15: cos=0.9892
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:49308
[S3] sending update (kind=head size=1807 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S3
[S7] cosine check vs S3: cos=0.9991
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=58 metric=0.8843 head_norm=1.696639
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.611284e-01
[S15] stored merged vector for next round verification (round=58)
[S15] DEBUG after merge:  round=58 metric=0.8812 head_norm=1.617226 delta_norm=0.561128
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=58 metric=0.6814 head_norm=1.662742
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.246345e-01
[S5] stored merged vector for next round verification (round=58)
[S5] DEBUG after merge:  round=58 metric=0.6852 head_norm=1.675146 delta_norm=0.124635
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9784
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=58 metric=0.9579 head_norm=1.678853
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.248459e-02
[S3] stored merged vector for next round verification (round=58)
[S3] DEBUG after merge:  round=58 metric=0.9579 head_norm=1.659074 delta_norm=0.072485
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.726843 cos_to_last_merge=0.9876 (last merge round=39)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.5670181473149611, 'auprc': 0.7420676961490826, 'loss_val': 1.2386324157756101, 'psi': 0.6370379668486097}-{'f1_val': 0.7074396209677571, 'auprc': 0.9147143633205888, 'loss_val': 0.5208879683250489, 'psi': 0.7903495179088897}
[S3] START round=59 head_norm_before_train=1.659074 cos_to_last_merge=1.0000 (last merge round=58)
[S3] round=59 local utility u=0.001407 metrics={'f1_val': 0.9599735875112269, 'auprc': 0.9969317491358938, 'loss_val': 0.11816940708064634, 'psi': 0.9747568521610936}-{'f1_val': 0.9578860128802906, 'auprc': 0.994784600464351, 'loss_val': 0.10201726363121912, 'psi': 0.9726454479139148}
[S4] START round=59 head_norm_before_train=2.257171 cos_to_last_merge=1.0000 (last merge round=57)
[S4] round=59 local utility u=0.028432 metrics={'f1_val': 0.955068107173531, 'auprc': 0.9858084019628696, 'loss_val': 0.2729067616331715, 'psi': 0.9673642250892664}-{'f1_val': 0.951490682062841, 'auprc': 0.9780179748173807, 'loss_val': 0.28493452110222167, 'psi': 0.9621015991646569}
[S5] START round=59 head_norm_before_train=1.675146 cos_to_last_merge=1.0000 (last merge round=58)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.44443925179076726, 'auprc': 0.8525951895471316, 'loss_val': 0.8679686955230608, 'psi': 0.6077016268933131}-{'f1_val': 0.6814407979996933, 'auprc': 0.9530704871827478, 'loss_val': 0.3130456349914842, 'psi': 0.790092673672915}
[S6] START round=59 head_norm_before_train=1.884640 cos_to_last_merge=0.9999 (last merge round=57)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6119404069962728, 'auprc': 0.9256820169716304, 'loss_val': 0.7640142971040556, 'psi': 0.7374370509864159}-{'f1_val': 0.8577693909099788, 'auprc': 0.9645847337666429, 'loss_val': 0.3915185036133036, 'psi': 0.9004955280526444}
[S7] START round=59 head_norm_before_train=1.652592 cos_to_last_merge=1.0000 (last merge round=58)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.541183897398686, 'auprc': 0.7814073667338639, 'loss_val': 0.8453453171361326, 'psi': 0.6372732851327572}-{'f1_val': 0.6969803733869859, 'auprc': 0.9286476026938735, 'loss_val': 0.23810982210260312, 'psi': 0.7896472651097409}
[S8] START round=59 head_norm_before_train=1.881093 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=59 local utility u=0.007174 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9988619311972328, 'loss_val': 0.03888753198902935, 'psi': 0.9951949515377854}-{'f1_val': 0.9909461167088028, 'auprc': 0.9988881440860188, 'loss_val': 0.04248907053978874, 'psi': 0.9941229276596892}
[S9] START round=59 head_norm_before_train=1.917696 cos_to_last_merge=0.9910 (last merge round=34)
[S9] round=59 local utility u=0.011202 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981427227247085, 'loss_val': 0.021916395390060132, 'psi': 0.9972533961782183}-{'f1_val': 0.9937421749897083, 'auprc': 0.9981414000633531, 'loss_val': 0.026805653504783842, 'psi': 0.9955018650191663}
[S10] START round=59 head_norm_before_train=2.316536 (no previous merge yet)
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960929006163601, 'loss_val': 0.025185011980492833, 'psi': 0.9956310325847822}-{'f1_val': 0.9953231205637304, 'auprc': 0.996691971157434, 'loss_val': 0.024353798758975205, 'psi': 0.9958706608012118}
[S11] START round=59 head_norm_before_train=2.256164 cos_to_last_merge=1.0000 (last merge round=56)
[S11] round=59 local utility u=0.000500 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990146904396462, 'loss_val': 0.019169349099325814, 'psi': 0.9973913269460797}-{'f1_val': 0.9962419185632914, 'auprc': 0.9988761804158792, 'loss_val': 0.01935058061769922, 'psi': 0.9972956233043264}
[S13] START round=59 head_norm_before_train=2.004267 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6302398396943532, 'auprc': 0.686197666552551, 'loss_val': 1.2427119406088871, 'psi': 0.6526229704376323}-{'f1_val': 0.6416526478291806, 'auprc': 0.7245759792864501, 'loss_val': 1.1912965773953543, 'psi': 0.6748219804120885}
[S14] START round=59 head_norm_before_train=1.681120 cos_to_last_merge=0.9574 (last merge round=33)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9979463889099598, 'loss_val': 0.02758229662015993, 'psi': 0.9972200763742373}-{'f1_val': 0.9969788439352044, 'auprc': 0.9981139116500639, 'loss_val': 0.02720878617469978, 'psi': 0.9974328710211482}
[S15] START round=59 head_norm_before_train=1.617226 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=59 local utility u=0.034553 metrics={'f1_val': 0.8932865463932466, 'auprc': 0.9956955903871368, 'loss_val': 0.2007991012732614, 'psi': 0.9342501639908027}-{'f1_val': 0.88426375635475, 'auprc': 0.9949017217972322, 'loss_val': 0.21338758862430146, 'psi': 0.9285189425317428}
[S16] START round=59 head_norm_before_train=1.694882 cos_to_last_merge=0.9998 (last merge round=55)
[S16] round=59 local utility u=0.001502 metrics={'f1_val': 0.9910145569688099, 'auprc': 0.9946954831546386, 'loss_val': 0.04941769137001925, 'psi': 0.9924869274431414}-{'f1_val': 0.9908478780768186, 'auprc': 0.9946248164203281, 'loss_val': 0.0512099169768367, 'psi': 0.9923586534142224}
[S17] START round=59 head_norm_before_train=2.118755 cos_to_last_merge=0.7658 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.8695548903034043, 'auprc': 0.9689926754428556, 'loss_val': 0.571563249109303, 'psi': 0.9093300043591849}-{'f1_val': 0.8792416963392056, 'auprc': 0.9735012652308467, 'loss_val': 0.4763949976390408, 'psi': 0.916945523895862}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.909 u=0.0000 p_local=0.1306 f1=0.870 auprc=0.969 bytes=50359
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.967)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.653 u=0.0000 p_local=0.0739 f1=0.630 auprc=0.686 bytes=48580
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=59 metric=0.6119 head_norm=1.910264
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.758269e-02
[S6] stored merged vector for next round verification (round=59)
[S6] DEBUG after merge:  round=59 metric=0.6105 head_norm=1.893576 delta_norm=0.047583
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] r=60 psi=0.737 u=0.0000 p_local=0.3202 f1=0.612 auprc=0.926 bytes=52190
[S10] r=60 psi=0.996 u=0.0000 p_local=0.0003 f1=0.995 auprc=0.996 bytes=55788
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.967 u=0.0284 p_local=0.0190 f1=0.955 auprc=0.986 bytes=53912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0172 f1=0.997 auprc=0.998 bytes=50377
[S16] not sending this round → trigger blocked (psi=0.992)
[S15] not sending this round → trigger blocked (psi=0.934)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49307
[S15] r=60 psi=0.934 u=0.0346 p_local=0.1671 f1=0.893 auprc=0.996 bytes=52242
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] r=60 psi=0.637 u=0.0000 p_local=0.1120 f1=0.567 auprc=0.742 bytes=50408
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=59 metric=0.4444 head_norm=1.684045
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.788563e-01
[S5] stored merged vector for next round verification (round=59)
[S5] DEBUG after merge:  round=59 metric=0.4436 head_norm=1.679978 delta_norm=0.178856
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] r=60 psi=0.608 u=0.0000 p_local=0.2196 f1=0.444 auprc=0.853 bytes=50438
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=59 metric=0.5412 head_norm=1.655619
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.889854e-02
[S7] stored merged vector for next round verification (round=59)
[S7] DEBUG after merge:  round=59 metric=0.5440 head_norm=1.666822 delta_norm=0.038899
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] r=60 psi=0.637 u=0.0000 p_local=0.3470 f1=0.541 auprc=0.781 bytes=48617
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:49308
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=59 metric=0.9963 head_norm=2.261898
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.608221e-02
[S11] stored merged vector for next round verification (round=59)
[S11] DEBUG after merge:  round=59 metric=0.9963 head_norm=2.259478 delta_norm=0.016082
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=60 psi=0.997 u=0.0005 p_local=0.0136 f1=0.996 auprc=0.999 bytes=59340
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S16] r=60 psi=0.992 u=0.0015 p_local=0.0327 f1=0.991 auprc=0.995 bytes=53983
[S8] r=60 psi=0.995 u=0.0072 p_local=0.0203 f1=0.993 auprc=0.999 bytes=52117
[S9] r=60 psi=0.997 u=0.0112 p_local=0.0077 f1=0.997 auprc=0.998 bytes=52234
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9998
[S3] r=60 psi=0.975 u=0.0014 p_local=0.2308 f1=0.960 auprc=0.997 bytes=52167
[S2] START round=60 head_norm_before_train=1.734813 cos_to_last_merge=0.9873 (last merge round=39)
[S2] round=60 local utility u=0.825866 metrics={'f1_val': 0.7192490936048602, 'auprc': 0.8320089137327641, 'loss_val': 0.7701104560260706, 'psi': 0.7643530216560217}-{'f1_val': 0.5670181473149611, 'auprc': 0.7420676961490826, 'loss_val': 1.2386324157756101, 'psi': 0.6370379668486097}
[S3] START round=60 head_norm_before_train=1.671161 cos_to_last_merge=1.0000 (last merge round=58)
[S3] round=60 local utility u=0.160727 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9999527475820942, 'loss_val': 0.030325709745335674, 'psi': 0.9984200405004722}-{'f1_val': 0.9599735875112269, 'auprc': 0.9969317491358938, 'loss_val': 0.11816940708064634, 'psi': 0.9747568521610936}
[S4] START round=60 head_norm_before_train=2.266547 cos_to_last_merge=0.9999 (last merge round=57)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.95170502644726, 'auprc': 0.9847598002625153, 'loss_val': 0.2768216856171249, 'psi': 0.9649269359733621}-{'f1_val': 0.955068107173531, 'auprc': 0.9858084019628696, 'loss_val': 0.2729067616331715, 'psi': 0.9673642250892664}
[S5] START round=60 head_norm_before_train=1.679978 cos_to_last_merge=1.0000 (last merge round=59)
[S5] round=60 local utility u=0.982802 metrics={'f1_val': 0.6733774260523814, 'auprc': 0.8876844409163414, 'loss_val': 0.38126237555745696, 'psi': 0.7591002319979654}-{'f1_val': 0.44443925179076726, 'auprc': 0.8525951895471316, 'loss_val': 0.8679686955230608, 'psi': 0.6077016268933131}
[S6] START round=60 head_norm_before_train=1.893576 cos_to_last_merge=1.0000 (last merge round=59)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.5967052799260302, 'auprc': 0.9181874178006952, 'loss_val': 1.0419763829943354, 'psi': 0.7252981350758962}-{'f1_val': 0.6119404069962728, 'auprc': 0.9256820169716304, 'loss_val': 0.7640142971040556, 'psi': 0.7374370509864159}
[S7] START round=60 head_norm_before_train=1.666822 cos_to_last_merge=1.0000 (last merge round=59)
[S7] round=60 local utility u=0.613446 metrics={'f1_val': 0.664303820416721, 'auprc': 0.8082752940749576, 'loss_val': 0.437776308408899, 'psi': 0.7218924098800157}-{'f1_val': 0.541183897398686, 'auprc': 0.7814073667338639, 'loss_val': 0.8453453171361326, 'psi': 0.6372732851327572}
[S8] START round=60 head_norm_before_train=1.892108 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=60 local utility u=0.000514 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9989057872718472, 'loss_val': 0.037990395336677744, 'psi': 0.995212493967631}-{'f1_val': 0.992750298431487, 'auprc': 0.9988619311972328, 'loss_val': 0.03888753198902935, 'psi': 0.9951949515377854}
[S9] START round=60 head_norm_before_train=1.923164 cos_to_last_merge=0.9906 (last merge round=34)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.994994420763055, 'auprc': 0.99815032665053, 'loss_val': 0.023949221599095447, 'psi': 0.996256783118045}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981427227247085, 'loss_val': 0.021916395390060132, 'psi': 0.9972533961782183}
[S10] START round=60 head_norm_before_train=2.319843 (no previous merge yet)
[S10] round=60 local utility u=0.000572 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996267757501305, 'loss_val': 0.02456558873434303, 'psi': 0.9957009753387602}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960929006163601, 'loss_val': 0.025185011980492833, 'psi': 0.9956310325847822}
[S11] START round=60 head_norm_before_train=2.259478 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=60 local utility u=0.001007 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990164692285519, 'loss_val': 0.01861213723792689, 'psi': 0.9975371406884791}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990146904396462, 'loss_val': 0.019169349099325814, 'psi': 0.9973913269460797}
[S13] START round=60 head_norm_before_train=2.015386 (no previous merge yet)
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6110423373827236, 'auprc': 0.6483960081689149, 'loss_val': 1.386627151863953, 'psi': 0.6259838056972}-{'f1_val': 0.6302398396943532, 'auprc': 0.686197666552551, 'loss_val': 1.2427119406088871, 'psi': 0.6526229704376323}
[S14] START round=60 head_norm_before_train=1.689707 cos_to_last_merge=0.9566 (last merge round=33)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963875947232834, 'auprc': 0.9980009044420763, 'loss_val': 0.027060930324047373, 'psi': 0.9970329186108007}-{'f1_val': 0.9967358680170888, 'auprc': 0.9979463889099598, 'loss_val': 0.02758229662015993, 'psi': 0.9972200763742373}
[S15] START round=60 head_norm_before_train=1.639657 cos_to_last_merge=0.9999 (last merge round=58)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8027144415879207, 'auprc': 0.9921019327840659, 'loss_val': 0.3890691073732137, 'psi': 0.8784694380663788}-{'f1_val': 0.8932865463932466, 'auprc': 0.9956955903871368, 'loss_val': 0.2007991012732614, 'psi': 0.9342501639908027}
[S16] START round=60 head_norm_before_train=1.706615 cos_to_last_merge=0.9997 (last merge round=55)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9906525202417691, 'auprc': 0.9924781017767563, 'loss_val': 0.05156417664750846, 'psi': 0.991382752855764}-{'f1_val': 0.9910145569688099, 'auprc': 0.9946954831546386, 'loss_val': 0.04941769137001925, 'psi': 0.9924869274431414}
[S17] START round=60 head_norm_before_train=2.125817 cos_to_last_merge=0.7650 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=60 local utility u=0.030760 metrics={'f1_val': 0.8698071216146351, 'auprc': 0.9795325891683264, 'loss_val': 0.543176017766901, 'psi': 0.9136973086361116}-{'f1_val': 0.8695548903034043, 'auprc': 0.9689926754428556, 'loss_val': 0.571563249109303, 'psi': 0.9093300043591849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.059 → S10@127.0.0.1:49311
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=60 metric=0.5967 head_norm=1.915473
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.069555e-02
[S6] stored merged vector for next round verification (round=60)
[S6] DEBUG after merge:  round=60 metric=0.5967 head_norm=1.903579 delta_norm=0.030696
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.256 → S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=60 metric=0.9517 head_norm=2.270970
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.888428e-02
[S4] stored merged vector for next round verification (round=60)
[S4] DEBUG after merge:  round=60 metric=0.9517 head_norm=2.266360 delta_norm=0.018884
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.015 → S11@127.0.0.1:49312
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.0315
[S13] DROPPED delta from S10 (cos=-0.0315 < 0.0)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.998)
[S11] ⇄ pheromone p=0.011 → S4@127.0.0.1:49304
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.8899
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49307
[S5] ⇄ pheromone p=0.372 → S15@127.0.0.1:49315
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=60 metric=0.6643 head_norm=1.672323
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.501637e-02
[S7] stored merged vector for next round verification (round=60)
[S7] DEBUG after merge:  round=60 metric=0.6652 head_norm=1.671675 delta_norm=0.015016
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.400 → S3@127.0.0.1:49303
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=60 metric=0.9974 head_norm=1.683331
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.768482e-02
[S3] stored merged vector for next round verification (round=60)
[S3] DEBUG after merge:  round=60 metric=0.9974 head_norm=1.677743 delta_norm=0.017685
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.217 → S7@127.0.0.1:49308
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=60 metric=0.8027 head_norm=1.660018
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.930458e-01
[S15] stored merged vector for next round verification (round=60)
[S15] DEBUG after merge:  round=60 metric=0.8052 head_norm=1.627556 delta_norm=0.393046
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.134 → S5@127.0.0.1:49305
[S8] ⇄ pheromone p=0.016 → S6@127.0.0.1:49307
[S16] ⇄ pheromone p=0.026 → S5@127.0.0.1:49305
[S2] START round=61 head_norm_before_train=1.741702 cos_to_last_merge=0.9871 (last merge round=39)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7224928149224414, 'auprc': 0.7382197124858256, 'loss_val': 0.9216984037392495, 'psi': 0.7287835739477951}-{'f1_val': 0.7192490936048602, 'auprc': 0.8320089137327641, 'loss_val': 0.7701104560260706, 'psi': 0.7643530216560217}
[S3] START round=61 head_norm_before_train=1.677743 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.934690982905843, 'auprc': 0.9886784430798318, 'loss_val': 0.1596269776544665, 'psi': 0.9562859669754384}-{'f1_val': 0.9973982357793907, 'auprc': 0.9999527475820942, 'loss_val': 0.030325709745335674, 'psi': 0.9984200405004722}
[S4] START round=61 head_norm_before_train=2.266360 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9509297452121427, 'auprc': 0.9780990136827339, 'loss_val': 0.2877756067283348, 'psi': 0.9617974526003792}-{'f1_val': 0.95170502644726, 'auprc': 0.9847598002625153, 'loss_val': 0.2768216856171249, 'psi': 0.9649269359733621}
[S5] START round=61 head_norm_before_train=1.688545 cos_to_last_merge=1.0000 (last merge round=59)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.6507555789072518, 'auprc': 0.8523430122370277, 'loss_val': 0.536666091405284, 'psi': 0.7313905522391622}-{'f1_val': 0.6733774260523814, 'auprc': 0.8876844409163414, 'loss_val': 0.38126237555745696, 'psi': 0.7591002319979654}
[S6] START round=61 head_norm_before_train=1.903579 cos_to_last_merge=1.0000 (last merge round=60)
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.8622240328360511, 'auprc': 0.9471990061236899, 'loss_val': 0.4137314275143032, 'psi': 0.8962140221511066}-{'f1_val': 0.5967052799260302, 'auprc': 0.9181874178006952, 'loss_val': 1.0419763829943354, 'psi': 0.7252981350758962}
[S7] START round=61 head_norm_before_train=1.671675 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6290717571999522, 'auprc': 0.7949802997583805, 'loss_val': 0.5657903692533814, 'psi': 0.6954351742233236}-{'f1_val': 0.664303820416721, 'auprc': 0.8082752940749576, 'loss_val': 0.437776308408899, 'psi': 0.7218924098800157}
[S8] START round=61 head_norm_before_train=1.902433 cos_to_last_merge=0.9999 (last merge round=58)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9905850682009775, 'auprc': 0.994905040730643, 'loss_val': 0.04305501323160292, 'psi': 0.9923130572128437}-{'f1_val': 0.992750298431487, 'auprc': 0.9989057872718472, 'loss_val': 0.037990395336677744, 'psi': 0.995212493967631}
[S9] START round=61 head_norm_before_train=1.928558 cos_to_last_merge=0.9903 (last merge round=34)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.998157329542668, 'loss_val': 0.032589387197090466, 'psi': 0.9937377311013382}-{'f1_val': 0.994994420763055, 'auprc': 0.99815032665053, 'loss_val': 0.023949221599095447, 'psi': 0.996256783118045}
[S10] START round=61 head_norm_before_train=2.321111 (no previous merge yet)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996223050214613, 'loss_val': 0.024704063467498715, 'psi': 0.9956830924240834}-{'f1_val': 0.9953231205637304, 'auprc': 0.996267757501305, 'loss_val': 0.02456558873434303, 'psi': 0.9957009753387602}
[S11] START round=61 head_norm_before_train=2.264264 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=61 local utility u=0.000275 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990090016792234, 'loss_val': 0.018040245391374155, 'psi': 0.9975341536687476}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990164692285519, 'loss_val': 0.01861213723792689, 'psi': 0.9975371406884791}
[S13] START round=61 head_norm_before_train=2.024595 (no previous merge yet)
[S13] round=61 local utility u=0.115897 metrics={'f1_val': 0.6277935706824895, 'auprc': 0.655205138405637, 'loss_val': 1.2757680182688889, 'psi': 0.6387581977717485}-{'f1_val': 0.6110423373827236, 'auprc': 0.6483960081689149, 'loss_val': 1.386627151863953, 'psi': 0.6259838056972}
[S14] START round=61 head_norm_before_train=1.698293 cos_to_last_merge=0.9559 (last merge round=33)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9969612240564939, 'loss_val': 0.027501987631784183, 'psi': 0.996839131648764}-{'f1_val': 0.9963875947232834, 'auprc': 0.9980009044420763, 'loss_val': 0.027060930324047373, 'psi': 0.9970329186108007}
[S15] START round=61 head_norm_before_train=1.627556 cos_to_last_merge=1.0000 (last merge round=60)
[S15] round=61 local utility u=0.756049 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9970140856097389, 'loss_val': 0.03593155200615297, 'psi': 0.9948567919541431}-{'f1_val': 0.8027144415879207, 'auprc': 0.9921019327840659, 'loss_val': 0.3890691073732137, 'psi': 0.8784694380663788}
[S16] START round=61 head_norm_before_train=1.716042 cos_to_last_merge=0.9996 (last merge round=55)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.989952520831351, 'auprc': 0.9846227525286402, 'loss_val': 0.06260918953408491, 'psi': 0.9878206135102666}-{'f1_val': 0.9906525202417691, 'auprc': 0.9924781017767563, 'loss_val': 0.05156417664750846, 'psi': 0.991382752855764}
[S17] START round=61 head_norm_before_train=2.134928 cos_to_last_merge=0.7644 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=61 local utility u=0.003685 metrics={'f1_val': 0.8519982306379996, 'auprc': 0.9847575654764721, 'loss_val': 0.4446285964238006, 'psi': 0.9051019645733887}-{'f1_val': 0.8698071216146351, 'auprc': 0.9795325891683264, 'loss_val': 0.543176017766901, 'psi': 0.9136973086361116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=61 metric=0.9509 head_norm=2.273521
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.257222e-02
[S4] stored merged vector for next round verification (round=61)
[S4] DEBUG after merge:  round=61 metric=0.9508 head_norm=2.268862 delta_norm=0.012572
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0311
[S10] DROPPED delta from S13 (cos=-0.0311 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9995
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=61 metric=0.8622 head_norm=1.923111
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.037180e-02
[S6] stored merged vector for next round verification (round=61)
[S6] DEBUG after merge:  round=61 metric=0.8622 head_norm=1.912559 delta_norm=0.030372
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:49305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.9722
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=61 metric=0.6508 head_norm=1.698105
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.989434e-01
[S5] stored merged vector for next round verification (round=61)
[S5] DEBUG after merge:  round=61 metric=0.6533 head_norm=1.661036 delta_norm=0.198943
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=61 metric=0.9906 head_norm=1.911393
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.048917e-02
[S8] stored merged vector for next round verification (round=61)
[S8] DEBUG after merge:  round=61 metric=0.9906 head_norm=1.917019 delta_norm=0.030489
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.752871 cos_to_last_merge=0.9867 (last merge round=39)
[S2] round=62 local utility u=0.090184 metrics={'f1_val': 0.7221300519333198, 'auprc': 0.7795538978218302, 'loss_val': 0.8631556631765893, 'psi': 0.745099590288724}-{'f1_val': 0.7224928149224414, 'auprc': 0.7382197124858256, 'loss_val': 0.9216984037392495, 'psi': 0.7287835739477951}
[S3] START round=62 head_norm_before_train=1.689521 cos_to_last_merge=1.0000 (last merge round=60)
[S3] round=62 local utility u=0.000711 metrics={'f1_val': 0.9394058284960571, 'auprc': 0.9826685172457341, 'loss_val': 0.16846354326845236, 'psi': 0.956710903995928}-{'f1_val': 0.934690982905843, 'auprc': 0.9886784430798318, 'loss_val': 0.1596269776544665, 'psi': 0.9562859669754384}
[S4] START round=62 head_norm_before_train=2.268862 cos_to_last_merge=1.0000 (last merge round=61)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9503049424118881, 'auprc': 0.9765941082034855, 'loss_val': 0.28252748641784814, 'psi': 0.9608206087285271}-{'f1_val': 0.9509297452121427, 'auprc': 0.9780990136827339, 'loss_val': 0.2877756067283348, 'psi': 0.9617974526003792}
[S5] START round=62 head_norm_before_train=1.661036 cos_to_last_merge=1.0000 (last merge round=61)
[S5] round=62 local utility u=0.001719 metrics={'f1_val': 0.6318529282714599, 'auprc': 0.8811052035945087, 'loss_val': 0.5060988383571537, 'psi': 0.7315538384006794}-{'f1_val': 0.6507555789072518, 'auprc': 0.8523430122370277, 'loss_val': 0.536666091405284, 'psi': 0.7313905522391622}
[S6] START round=62 head_norm_before_train=1.912559 cos_to_last_merge=1.0000 (last merge round=61)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6213598278198933, 'auprc': 0.854964911874813, 'loss_val': 0.9736884043751725, 'psi': 0.7148018614418612}-{'f1_val': 0.8622240328360511, 'auprc': 0.9471990061236899, 'loss_val': 0.4137314275143032, 'psi': 0.8962140221511066}
[S7] START round=62 head_norm_before_train=1.679688 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.5148963636739475, 'auprc': 0.781622661225481, 'loss_val': 0.9621963406726844, 'psi': 0.621586882694561}-{'f1_val': 0.6290717571999522, 'auprc': 0.7949802997583805, 'loss_val': 0.5657903692533814, 'psi': 0.6954351742233236}
[S8] START round=62 head_norm_before_train=1.917019 cos_to_last_merge=1.0000 (last merge round=61)
[S8] round=62 local utility u=0.015765 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.998770561774604, 'loss_val': 0.036973505518566104, 'psi': 0.9952445481888108}-{'f1_val': 0.9905850682009775, 'auprc': 0.994905040730643, 'loss_val': 0.04305501323160292, 'psi': 0.9923130572128437}
[S9] START round=62 head_norm_before_train=1.934445 cos_to_last_merge=0.9899 (last merge round=34)
[S9] round=62 local utility u=0.023193 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981510012766194, 'loss_val': 0.02140038712388697, 'psi': 0.9972567075989827}-{'f1_val': 0.9907913321404518, 'auprc': 0.998157329542668, 'loss_val': 0.032589387197090466, 'psi': 0.9937377311013382}
[S10] START round=62 head_norm_before_train=2.328336 (no previous merge yet)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961599494050568, 'loss_val': 0.024808295611793024, 'psi': 0.9956578521002609}-{'f1_val': 0.9953231205637304, 'auprc': 0.996223050214613, 'loss_val': 0.024704063467498715, 'psi': 0.9956830924240834}
[S11] START round=62 head_norm_before_train=2.269583 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=62 local utility u=0.000165 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990063750601479, 'loss_val': 0.017701545187825622, 'psi': 0.9975331030211175}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990090016792234, 'loss_val': 0.018040245391374155, 'psi': 0.9975341536687476}
[S13] START round=62 head_norm_before_train=2.028504 (no previous merge yet)
[S13] round=62 local utility u=0.064178 metrics={'f1_val': 0.6474065326590919, 'auprc': 0.6714530780257678, 'loss_val': 1.3138333334807313, 'psi': 0.6570251508057623}-{'f1_val': 0.6277935706824895, 'auprc': 0.655205138405637, 'loss_val': 1.2757680182688889, 'psi': 0.6387581977717485}
[S14] START round=62 head_norm_before_train=1.706949 cos_to_last_merge=0.9550 (last merge round=33)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.9974999232408599, 'loss_val': 0.027801991534714, 'psi': 0.9969224879381242}-{'f1_val': 0.9967577367102773, 'auprc': 0.9969612240564939, 'loss_val': 0.027501987631784183, 'psi': 0.996839131648764}
[S15] START round=62 head_norm_before_train=1.647324 cos_to_last_merge=0.9999 (last merge round=60)
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.8276738809786665, 'auprc': 0.9952005745799519, 'loss_val': 0.31143730191662106, 'psi': 0.8946845584191806}-{'f1_val': 0.9934185961837458, 'auprc': 0.9970140856097389, 'loss_val': 0.03593155200615297, 'psi': 0.9948567919541431}
[S16] START round=62 head_norm_before_train=1.725539 cos_to_last_merge=0.9994 (last merge round=55)
[S16] round=62 local utility u=0.005128 metrics={'f1_val': 0.9906102553019002, 'auprc': 0.9848087914307918, 'loss_val': 0.05685847083340475, 'psi': 0.9882896697534568}-{'f1_val': 0.989952520831351, 'auprc': 0.9846227525286402, 'loss_val': 0.06260918953408491, 'psi': 0.9878206135102666}
[S17] START round=62 head_norm_before_train=2.144454 cos_to_last_merge=0.7636 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=62 local utility u=0.111277 metrics={'f1_val': 0.8757248452608734, 'auprc': 0.9911262799258345, 'loss_val': 0.38354063820980727, 'psi': 0.9218854191268577}-{'f1_val': 0.8519982306379996, 'auprc': 0.9847575654764721, 'loss_val': 0.4446285964238006, 'psi': 0.9051019645733887}
[S17] not sending this round → trigger blocked (psi=0.922)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.657)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=62 metric=0.9503 head_norm=2.274392
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.082665e-02
[S4] stored merged vector for next round verification (round=62)
[S4] DEBUG after merge:  round=62 metric=0.9503 head_norm=2.271963 delta_norm=0.010827
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9923
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=0.9741
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=62 metric=0.6319 head_norm=1.668166
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.964410e-01
[S5] stored merged vector for next round verification (round=62)
[S5] DEBUG after merge:  round=62 metric=0.6215 head_norm=1.690427 delta_norm=0.196441
[S5] aggregate: ROLLBACK (f1_val pre=0.632 post=0.621 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1808 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S3
[S7] cosine check vs S3: cos=0.9998
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=62 metric=0.8277 head_norm=1.668804
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.033573e-01
[S15] stored merged vector for next round verification (round=62)
[S15] DEBUG after merge:  round=62 metric=0.8292 head_norm=1.665281 delta_norm=0.103357
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=1.763318 cos_to_last_merge=0.9862 (last merge round=39)
[S2] round=63 local utility u=0.283852 metrics={'f1_val': 0.7053663819177991, 'auprc': 0.9050796776275161, 'loss_val': 0.5714466562257859, 'psi': 0.7852517002016859}-{'f1_val': 0.7221300519333198, 'auprc': 0.7795538978218302, 'loss_val': 0.8631556631765893, 'psi': 0.745099590288724}
[S3] START round=63 head_norm_before_train=1.700475 cos_to_last_merge=0.9999 (last merge round=60)
[S3] round=63 local utility u=0.211798 metrics={'f1_val': 0.9824749185702665, 'auprc': 0.9998691137395197, 'loss_val': 0.05488346321752798, 'psi': 0.9894325966379678}-{'f1_val': 0.9394058284960571, 'auprc': 0.9826685172457341, 'loss_val': 0.16846354326845236, 'psi': 0.956710903995928}
[S4] START round=63 head_norm_before_train=2.271963 cos_to_last_merge=1.0000 (last merge round=62)
[S4] round=63 local utility u=0.001646 metrics={'f1_val': 0.9442681367096066, 'auprc': 0.9852168779189829, 'loss_val': 0.26888384847848185, 'psi': 0.9606476331933571}-{'f1_val': 0.9503049424118881, 'auprc': 0.9765941082034855, 'loss_val': 0.28252748641784814, 'psi': 0.9608206087285271}
[S5] START round=63 head_norm_before_train=1.690427 cos_to_last_merge=1.0000 (last merge round=62)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.44117151684898437, 'auprc': 0.8467326828916019, 'loss_val': 1.163022140311294, 'psi': 0.6033959832660314}-{'f1_val': 0.6318529282714599, 'auprc': 0.8811052035945087, 'loss_val': 0.5060988383571537, 'psi': 0.7315538384006794}
[S6] START round=63 head_norm_before_train=1.935264 cos_to_last_merge=0.9998 (last merge round=61)
[S6] round=63 local utility u=0.936941 metrics={'f1_val': 0.8141758443983418, 'auprc': 0.9342222774318847, 'loss_val': 0.49447458307814396, 'psi': 0.862194417611759}-{'f1_val': 0.6213598278198933, 'auprc': 0.854964911874813, 'loss_val': 0.9736884043751725, 'psi': 0.7148018614418612}
[S7] START round=63 head_norm_before_train=1.688750 cos_to_last_merge=0.9999 (last merge round=60)
[S7] round=63 local utility u=0.649200 metrics={'f1_val': 0.6535121339690342, 'auprc': 0.7998599773771882, 'loss_val': 0.5502022842361234, 'psi': 0.7120512713322957}-{'f1_val': 0.5148963636739475, 'auprc': 0.781622661225481, 'loss_val': 0.9621963406726844, 'psi': 0.621586882694561}
[S8] START round=63 head_norm_before_train=1.928998 cos_to_last_merge=1.0000 (last merge round=61)
[S8] round=63 local utility u=0.000559 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9989221059955198, 'loss_val': 0.036310944937526, 'psi': 0.9953051658771772}-{'f1_val': 0.9928938724649488, 'auprc': 0.998770561774604, 'loss_val': 0.036973505518566104, 'psi': 0.9952445481888108}
[S9] START round=63 head_norm_before_train=1.939595 cos_to_last_merge=0.9896 (last merge round=34)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957101513273154, 'loss_val': 0.02155173841924849, 'psi': 0.9962803676192611}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981510012766194, 'loss_val': 0.02140038712388697, 'psi': 0.9972567075989827}
[S10] START round=63 head_norm_before_train=2.337451 (no previous merge yet)
[S10] round=63 local utility u=0.000337 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962709011085087, 'loss_val': 0.024467316162200776, 'psi': 0.9957022327816416}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961599494050568, 'loss_val': 0.024808295611793024, 'psi': 0.9956578521002609}
[S11] START round=63 head_norm_before_train=2.275878 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990031994322578, 'loss_val': 0.018036656635051537, 'psi': 0.9975318327699615}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990063750601479, 'loss_val': 0.017701545187825622, 'psi': 0.9975331030211175}
[S13] START round=63 head_norm_before_train=2.037493 (no previous merge yet)
[S13] round=63 local utility u=0.707994 metrics={'f1_val': 0.6895004751574438, 'auprc': 0.9358968638991418, 'loss_val': 0.943739603065882, 'psi': 0.7880590306541231}-{'f1_val': 0.6474065326590919, 'auprc': 0.6714530780257678, 'loss_val': 1.3138333334807313, 'psi': 0.6570251508057623}
[S14] START round=63 head_norm_before_train=1.714593 cos_to_last_merge=0.9543 (last merge round=33)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9385740874193704, 'auprc': 0.9979825620984657, 'loss_val': 0.1004822544128577, 'psi': 0.9623374772910085}-{'f1_val': 0.9965375310696338, 'auprc': 0.9974999232408599, 'loss_val': 0.027801991534714, 'psi': 0.9969224879381242}
[S15] START round=63 head_norm_before_train=1.665281 cos_to_last_merge=1.0000 (last merge round=62)
[S15] round=63 local utility u=0.182662 metrics={'f1_val': 0.8774152092916521, 'auprc': 0.9958009980144986, 'loss_val': 0.2463615491292244, 'psi': 0.9247695247807908}-{'f1_val': 0.8276738809786665, 'auprc': 0.9952005745799519, 'loss_val': 0.31143730191662106, 'psi': 0.8946845584191806}
[S16] START round=63 head_norm_before_train=1.734787 cos_to_last_merge=0.9992 (last merge round=55)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9427624038750715, 'auprc': 0.9773244353897708, 'loss_val': 0.2779586052713367, 'psi': 0.9565872164809512}-{'f1_val': 0.9906102553019002, 'auprc': 0.9848087914307918, 'loss_val': 0.05685847083340475, 'psi': 0.9882896697534568}
[S17] START round=63 head_norm_before_train=2.153824 cos_to_last_merge=0.7629 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.7979602769264239, 'auprc': 0.8913222085480941, 'loss_val': 0.5349739602318541, 'psi': 0.835305049575092}-{'f1_val': 0.8757248452608734, 'auprc': 0.9911262799258345, 'loss_val': 0.38354063820980727, 'psi': 0.9218854191268577}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S2
[S15]  timeout peer S11
[S9]  timeout peer S8
[S9]  timeout peer S10
[S3]  timeout peer S17
[S14]  timeout peer S16
[S8]  timeout peer S14
[S16]  timeout peer S9
[S2]  timeout peer S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S2] sending update (kind=head size=1811 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0306
[S13] DROPPED delta from S10 (cos=-0.0306 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9994
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.0306
[S10] DROPPED delta from S13 (cos=-0.0306 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=63 metric=0.6535 head_norm=1.696843
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.241876e-02
[S7] stored merged vector for next round verification (round=63)
[S7] DEBUG after merge:  round=63 metric=0.6540 head_norm=1.698512 delta_norm=0.022419
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S15] → sending delta(kind=head bytes=1810) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1810 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1810) from S15
[S5] cosine check vs S15: cos=0.9836
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:49307
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=63 metric=0.4412 head_norm=1.697700
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.533231e-01
[S5] stored merged vector for next round verification (round=63)
[S5] DEBUG after merge:  round=63 metric=0.4444 head_norm=1.685953 delta_norm=0.153323
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9994
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=63 metric=0.8142 head_norm=1.957968
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.459159e-02
[S6] stored merged vector for next round verification (round=63)
[S6] DEBUG after merge:  round=63 metric=0.8141 head_norm=1.945758 delta_norm=0.034592
[S6] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:49308
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9929 head_norm=1.939197
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.461463e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9929 head_norm=1.948298 delta_norm=0.034615
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=63 metric=0.9825 head_norm=1.711215
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.646179e-02
[S3] stored merged vector for next round verification (round=63)
[S3] DEBUG after merge:  round=63 metric=0.9820 head_norm=1.703839 delta_norm=0.026462
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.771620 cos_to_last_merge=0.9855 (last merge round=39)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6926815018624719, 'auprc': 0.8444154805704678, 'loss_val': 0.6814564028455921, 'psi': 0.7533750933456702}-{'f1_val': 0.7053663819177991, 'auprc': 0.9050796776275161, 'loss_val': 0.5714466562257859, 'psi': 0.7852517002016859}
[S3] START round=64 head_norm_before_train=1.703839 cos_to_last_merge=1.0000 (last merge round=63)
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.6835338456497455, 'auprc': 0.8659698708804402, 'loss_val': 1.0455447554385506, 'psi': 0.7565082557420234}-{'f1_val': 0.9824749185702665, 'auprc': 0.9998691137395197, 'loss_val': 0.05488346321752798, 'psi': 0.9894325966379678}
[S4] START round=64 head_norm_before_train=2.271693 cos_to_last_merge=0.9999 (last merge round=62)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9438455976226049, 'auprc': 0.9792051804127069, 'loss_val': 0.2743681069290058, 'psi': 0.9579894307386457}-{'f1_val': 0.9442681367096066, 'auprc': 0.9852168779189829, 'loss_val': 0.26888384847848185, 'psi': 0.9606476331933571}
[S5] START round=64 head_norm_before_train=1.685953 cos_to_last_merge=1.0000 (last merge round=63)
[S5] round=64 local utility u=1.000000 metrics={'f1_val': 0.8385004120116664, 'auprc': 0.9765965687752877, 'loss_val': 0.2180250988485012, 'psi': 0.8937388747171149}-{'f1_val': 0.44117151684898437, 'auprc': 0.8467326828916019, 'loss_val': 1.163022140311294, 'psi': 0.6033959832660314}
[S6] START round=64 head_norm_before_train=1.945758 cos_to_last_merge=1.0000 (last merge round=63)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6148550406752177, 'auprc': 0.886047217405477, 'loss_val': 0.8348978258159423, 'psi': 0.7233319113673213}-{'f1_val': 0.8141758443983418, 'auprc': 0.9342222774318847, 'loss_val': 0.49447458307814396, 'psi': 0.862194417611759}
[S7] START round=64 head_norm_before_train=1.698512 cos_to_last_merge=1.0000 (last merge round=63)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.6025909537440141, 'auprc': 0.7862685593960026, 'loss_val': 0.7044649643823698, 'psi': 0.6760619960048095}-{'f1_val': 0.6535121339690342, 'auprc': 0.7998599773771882, 'loss_val': 0.5502022842361234, 'psi': 0.7120512713322957}
[S8] START round=64 head_norm_before_train=1.948298 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9933243300107073, 'loss_val': 0.04671002307147566, 'psi': 0.9900399394520045}-{'f1_val': 0.9928938724649488, 'auprc': 0.9989221059955198, 'loss_val': 0.036310944937526, 'psi': 0.9953051658771772}
[S9] START round=64 head_norm_before_train=1.944879 cos_to_last_merge=0.9893 (last merge round=34)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9858942912577657, 'auprc': 0.9981596174224105, 'loss_val': 0.054268439396183844, 'psi': 0.9908004217236236}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957101513273154, 'loss_val': 0.02155173841924849, 'psi': 0.9962803676192611}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.342802 (no previous merge yet)
[S10] round=64 local utility u=0.000766 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9967132415917566, 'loss_val': 0.024261710149327667, 'psi': 0.9958791689749409}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962709011085087, 'loss_val': 0.024467316162200776, 'psi': 0.9957022327816416}
[S11] START round=64 head_norm_before_train=2.281690 cos_to_last_merge=1.0000 (last merge round=59)
[S11] round=64 local utility u=0.001647 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989783288408345, 'loss_val': 0.017148035823449204, 'psi': 0.99776988551208}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990031994322578, 'loss_val': 0.018036656635051537, 'psi': 0.9975318327699615}
[S13] START round=64 head_norm_before_train=2.037635 (no previous merge yet)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7346275236867494, 'auprc': 0.8173179601938125, 'loss_val': 1.0487380636370804, 'psi': 0.7677036982895746}-{'f1_val': 0.6895004751574438, 'auprc': 0.9358968638991418, 'loss_val': 0.943739603065882, 'psi': 0.7880590306541231}
[S14] START round=64 head_norm_before_train=1.718153 cos_to_last_merge=0.9540 (last merge round=33)
[S14] round=64 local utility u=0.214327 metrics={'f1_val': 0.9975545343417789, 'auprc': 0.9985766985874591, 'loss_val': 0.02749372147700369, 'psi': 0.997963400040051}-{'f1_val': 0.9385740874193704, 'auprc': 0.9979825620984657, 'loss_val': 0.1004822544128577, 'psi': 0.9623374772910085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=64 head_norm_before_train=1.688107 cos_to_last_merge=0.9999 (last merge round=62)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.8481499314143911, 'auprc': 0.9955765215261679, 'loss_val': 0.28934847742261394, 'psi': 0.9071205674591019}-{'f1_val': 0.8774152092916521, 'auprc': 0.9958009980144986, 'loss_val': 0.2463615491292244, 'psi': 0.9247695247807908}
[S16] START round=64 head_norm_before_train=1.744269 cos_to_last_merge=0.9991 (last merge round=55)
[S16] round=64 local utility u=0.286175 metrics={'f1_val': 0.9913109835493623, 'auprc': 0.9933981417530858, 'loss_val': 0.045121345739278784, 'psi': 0.9921458468308517}-{'f1_val': 0.9427624038750715, 'auprc': 0.9773244353897708, 'loss_val': 0.2779586052713367, 'psi': 0.9565872164809512}
[S17] START round=64 head_norm_before_train=2.162839 cos_to_last_merge=0.7624 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.7906695981608608, 'auprc': 0.9297213317247504, 'loss_val': 0.7748231221095826, 'psi': 0.8462902915864167}-{'f1_val': 0.7979602769264239, 'auprc': 0.8913222085480941, 'loss_val': 0.5349739602318541, 'psi': 0.835305049575092}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:49315
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=64 metric=0.6026 head_norm=1.704473
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.847215e-02
[S7] stored merged vector for next round verification (round=64)
[S7] DEBUG after merge:  round=64 metric=0.6029 head_norm=1.707747 delta_norm=0.018472
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9998
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=64 metric=0.9970 head_norm=2.287845
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.849646e-02
[S11] stored merged vector for next round verification (round=64)
[S11] DEBUG after merge:  round=64 metric=0.9970 head_norm=2.279708 delta_norm=0.018496
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S5
[S15] cosine check vs S5: cos=0.9953
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9783
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=64 metric=0.9438 head_norm=2.277034
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.327932e-02
[S4] stored merged vector for next round verification (round=64)
[S4] DEBUG after merge:  round=64 metric=0.9438 head_norm=2.282327 delta_norm=0.023279
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=1.779857 cos_to_last_merge=0.9847 (last merge round=39)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.667102481408537, 'auprc': 0.7868206793762259, 'loss_val': 0.8196647083789189, 'psi': 0.7149897605956126}-{'f1_val': 0.6926815018624719, 'auprc': 0.8444154805704678, 'loss_val': 0.6814564028455921, 'psi': 0.7533750933456702}
[S3] START round=65 head_norm_before_train=1.711903 cos_to_last_merge=1.0000 (last merge round=63)
[S3] round=65 local utility u=1.000000 metrics={'f1_val': 0.8789605398275029, 'auprc': 0.997155072881505, 'loss_val': 0.27811335480364613, 'psi': 0.9262383530491036}-{'f1_val': 0.6835338456497455, 'auprc': 0.8659698708804402, 'loss_val': 1.0455447554385506, 'psi': 0.7565082557420234}
[S4] START round=65 head_norm_before_train=2.282327 cos_to_last_merge=1.0000 (last merge round=64)
[S4] round=65 local utility u=0.021501 metrics={'f1_val': 0.9481467125908672, 'auprc': 0.9828444364698308, 'loss_val': 0.2680905851485808, 'psi': 0.9620258021424526}-{'f1_val': 0.9438455976226049, 'auprc': 0.9792051804127069, 'loss_val': 0.2743681069290058, 'psi': 0.9579894307386457}
[S5] START round=65 head_norm_before_train=1.691406 cos_to_last_merge=1.0000 (last merge round=63)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.7028786763329812, 'auprc': 0.9656882667072988, 'loss_val': 0.3131230753693693, 'psi': 0.8080025124827082}-{'f1_val': 0.8385004120116664, 'auprc': 0.9765965687752877, 'loss_val': 0.2180250988485012, 'psi': 0.8937388747171149}
[S6] START round=65 head_norm_before_train=1.959364 cos_to_last_merge=0.9998 (last merge round=63)
[S6] round=65 local utility u=1.000000 metrics={'f1_val': 0.8507020016143467, 'auprc': 0.9688991228103899, 'loss_val': 0.43221757559940627, 'psi': 0.897980850092764}-{'f1_val': 0.6148550406752177, 'auprc': 0.886047217405477, 'loss_val': 0.8348978258159423, 'psi': 0.7233319113673213}
[S7] START round=65 head_norm_before_train=1.707747 cos_to_last_merge=1.0000 (last merge round=64)
[S7] round=65 local utility u=0.161035 metrics={'f1_val': 0.6236356158900626, 'auprc': 0.7970163615014274, 'loss_val': 0.540906035725682, 'psi': 0.6929879141346085}-{'f1_val': 0.6025909537440141, 'auprc': 0.7862685593960026, 'loss_val': 0.7044649643823698, 'psi': 0.6760619960048095}
[S8] START round=65 head_norm_before_train=1.957323 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.8178492614170751, 'auprc': 0.9926913378634229, 'loss_val': 0.468568039771553, 'psi': 0.8877860919956142}-{'f1_val': 0.9878503457462027, 'auprc': 0.9933243300107073, 'loss_val': 0.04671002307147566, 'psi': 0.9900399394520045}
[S9] START round=65 head_norm_before_train=1.950065 cos_to_last_merge=0.9889 (last merge round=34)
[S9] round=65 local utility u=0.049511 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981632932725437, 'loss_val': 0.019855613404033665, 'psi': 0.9972616243973523}-{'f1_val': 0.9858942912577657, 'auprc': 0.9981596174224105, 'loss_val': 0.054268439396183844, 'psi': 0.9908004217236236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=65 head_norm_before_train=2.348155 (no previous merge yet)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961544822602313, 'loss_val': 0.0249785255770711, 'psi': 0.9956556652423307}-{'f1_val': 0.9953231205637304, 'auprc': 0.9967132415917566, 'loss_val': 0.024261710149327667, 'psi': 0.9958791689749409}
[S11] START round=65 head_norm_before_train=2.279708 cos_to_last_merge=1.0000 (last merge round=64)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988907715132823, 'loss_val': 0.016924431116508088, 'psi': 0.9977348625810591}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989783288408345, 'loss_val': 0.017148035823449204, 'psi': 0.99776988551208}
[S13] START round=65 head_norm_before_train=2.038082 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.7203646420046798, 'auprc': 0.7806820985515126, 'loss_val': 1.0496525306315232, 'psi': 0.7444916246234129}-{'f1_val': 0.7346275236867494, 'auprc': 0.8173179601938125, 'loss_val': 1.0487380636370804, 'psi': 0.7677036982895746}
[S14] START round=65 head_norm_before_train=1.723477 cos_to_last_merge=0.9534 (last merge round=33)
[S14] round=65 local utility u=0.000480 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9986198147185967, 'loss_val': 0.024348810812749744, 'psi': 0.9977491940031978}-{'f1_val': 0.9975545343417789, 'auprc': 0.9985766985874591, 'loss_val': 0.02749372147700369, 'psi': 0.997963400040051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=65 head_norm_before_train=1.710075 cos_to_last_merge=0.9997 (last merge round=62)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.774859286225757, 'auprc': 0.9808566234125736, 'loss_val': 0.43201684630401105, 'psi': 0.8572582211004837}-{'f1_val': 0.8481499314143911, 'auprc': 0.9955765215261679, 'loss_val': 0.28934847742261394, 'psi': 0.9071205674591019}
[S16] START round=65 head_norm_before_train=1.752852 cos_to_last_merge=0.9989 (last merge round=55)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9788117807240774, 'auprc': 0.9928334649825629, 'loss_val': 0.08993840317917322, 'psi': 0.9844204544274716}-{'f1_val': 0.9913109835493623, 'auprc': 0.9933981417530858, 'loss_val': 0.045121345739278784, 'psi': 0.9921458468308517}
[S17] START round=65 head_norm_before_train=2.169769 cos_to_last_merge=0.7617 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=65 local utility u=0.258155 metrics={'f1_val': 0.8240351396396753, 'auprc': 0.9175223445169786, 'loss_val': 0.42210910759968373, 'psi': 0.8614300215905966}-{'f1_val': 0.7906695981608608, 'auprc': 0.9297213317247504, 'loss_val': 0.7748231221095826, 'psi': 0.8462902915864167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.126 → S10@127.0.0.1:49311
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] ⇄ pheromone p=0.004 → S4@127.0.0.1:49304
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=65 metric=0.7749 head_norm=1.729726
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.122360e-02
[S15] stored merged vector for next round verification (round=65)
[S15] DEBUG after merge:  round=65 metric=0.7749 head_norm=1.708239 delta_norm=0.091224
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.129 → S5@127.0.0.1:49305
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S3] RECEIVED delta(kind=head bytes=1805) from S7
[S3] cosine check vs S7: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9999
[S4] ⇄ pheromone p=0.010 → S11@127.0.0.1:49312
[S7] ⇄ pheromone p=0.246 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=0.486 → S8@127.0.0.1:49309
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=65 metric=0.8178 head_norm=1.964667
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.753662e-02
[S8] stored merged vector for next round verification (round=65)
[S8] DEBUG after merge:  round=65 metric=0.8178 head_norm=1.967866 delta_norm=0.027537
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.007 → S6@127.0.0.1:49307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=65 metric=0.8790 head_norm=1.717737
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.115083e-03
[S3] stored merged vector for next round verification (round=65)
[S3] DEBUG after merge:  round=65 metric=0.8790 head_norm=1.717501 delta_norm=0.008115
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.298 → S7@127.0.0.1:49308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=65 metric=0.7029 head_norm=1.698841
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.844531e-01
[S5] stored merged vector for next round verification (round=65)
[S5] DEBUG after merge:  round=65 metric=0.6971 head_norm=1.716174 delta_norm=0.184453
[S5] aggregate: ROLLBACK (f1_val pre=0.703 post=0.697 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.282 → S15@127.0.0.1:49315
[S16] ⇄ pheromone p=0.055 → S5@127.0.0.1:49305
[S2] START round=66 head_norm_before_train=1.787769 cos_to_last_merge=0.9844 (last merge round=39)
[S2] round=66 local utility u=0.381407 metrics={'f1_val': 0.7004379754950376, 'auprc': 0.9081688510488748, 'loss_val': 0.6209086981409544, 'psi': 0.7835303257165724}-{'f1_val': 0.667102481408537, 'auprc': 0.7868206793762259, 'loss_val': 0.8196647083789189, 'psi': 0.7149897605956126}
[S3] START round=66 head_norm_before_train=1.717501 cos_to_last_merge=1.0000 (last merge round=65)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.6483704404621617, 'auprc': 0.8200184125336218, 'loss_val': 1.2437609835089336, 'psi': 0.7170296292907458}-{'f1_val': 0.8789605398275029, 'auprc': 0.997155072881505, 'loss_val': 0.27811335480364613, 'psi': 0.9262383530491036}
[S4] START round=66 head_norm_before_train=2.288761 cos_to_last_merge=0.9999 (last merge round=64)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9457120541139538, 'auprc': 0.9846007987779515, 'loss_val': 0.26597233958998917, 'psi': 0.9612675519795528}-{'f1_val': 0.9481467125908672, 'auprc': 0.9828444364698308, 'loss_val': 0.2680905851485808, 'psi': 0.9620258021424526}
[S5] START round=66 head_norm_before_train=1.716174 cos_to_last_merge=1.0000 (last merge round=65)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.6131276924453102, 'auprc': 0.8517846187961683, 'loss_val': 0.6786293106034248, 'psi': 0.7085904629856534}-{'f1_val': 0.7028786763329812, 'auprc': 0.9656882667072988, 'loss_val': 0.3131230753693693, 'psi': 0.8080025124827082}
[S6] START round=66 head_norm_before_train=1.971444 cos_to_last_merge=0.9997 (last merge round=63)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6669015752403381, 'auprc': 0.9423885555060915, 'loss_val': 0.8919792197087073, 'psi': 0.7770963673466394}-{'f1_val': 0.8507020016143467, 'auprc': 0.9688991228103899, 'loss_val': 0.43221757559940627, 'psi': 0.897980850092764}
[S7] START round=66 head_norm_before_train=1.717303 cos_to_last_merge=1.0000 (last merge round=64)
[S7] round=66 local utility u=0.094002 metrics={'f1_val': 0.6407912715869537, 'auprc': 0.8040092254306439, 'loss_val': 0.47681393361126734, 'psi': 0.7060784531244297}-{'f1_val': 0.6236356158900626, 'auprc': 0.7970163615014274, 'loss_val': 0.540906035725682, 'psi': 0.6929879141346085}
[S8] START round=66 head_norm_before_train=1.967866 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=66 local utility u=0.754236 metrics={'f1_val': 0.9936602072557493, 'auprc': 0.9986668349324692, 'loss_val': 0.032888699888488845, 'psi': 0.9956628583264373}-{'f1_val': 0.8178492614170751, 'auprc': 0.9926913378634229, 'loss_val': 0.468568039771553, 'psi': 0.8877860919956142}
[S9] START round=66 head_norm_before_train=1.954394 cos_to_last_merge=0.9887 (last merge round=34)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982176597207072, 'loss_val': 0.020121510902898744, 'psi': 0.9972833709766178}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981632932725437, 'loss_val': 0.019855613404033665, 'psi': 0.9972616243973523}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.350247 (no previous merge yet)
[S10] round=66 local utility u=0.000439 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962276525516531, 'loss_val': 0.024320456135839448, 'psi': 0.9956849333588995}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961544822602313, 'loss_val': 0.0249785255770711, 'psi': 0.9956556652423307}
[S11] START round=66 head_norm_before_train=2.286377 cos_to_last_merge=1.0000 (last merge round=64)
[S11] round=66 local utility u=0.000205 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989652993852457, 'loss_val': 0.01673876596468099, 'psi': 0.9977646737298446}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988907715132823, 'loss_val': 0.016924431116508088, 'psi': 0.9977348625810591}
[S13] START round=66 head_norm_before_train=2.039099 (no previous merge yet)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6661404493718408, 'auprc': 0.7135283655798834, 'loss_val': 1.1735045969734335, 'psi': 0.6850956158550578}-{'f1_val': 0.7203646420046798, 'auprc': 0.7806820985515126, 'loss_val': 1.0496525306315232, 'psi': 0.7444916246234129}
[S14] START round=66 head_norm_before_train=1.729367 cos_to_last_merge=0.9529 (last merge round=33)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9982360150383276, 'loss_val': 0.022971156847906345, 'psi': 0.9974797060655969}-{'f1_val': 0.9971687801929319, 'auprc': 0.9986198147185967, 'loss_val': 0.024348810812749744, 'psi': 0.9977491940031978}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.708239 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=66 local utility u=0.376524 metrics={'f1_val': 0.8658360155994211, 'auprc': 0.9956907528944696, 'loss_val': 0.2693318489117834, 'psi': 0.9177779105174405}-{'f1_val': 0.774859286225757, 'auprc': 0.9808566234125736, 'loss_val': 0.43201684630401105, 'psi': 0.8572582211004837}
[S16] START round=66 head_norm_before_train=1.760995 cos_to_last_merge=0.9987 (last merge round=55)
[S16] round=66 local utility u=0.060973 metrics={'f1_val': 0.9903802604750188, 'auprc': 0.9957826058263337, 'loss_val': 0.046249972253200905, 'psi': 0.9925411986155448}-{'f1_val': 0.9788117807240774, 'auprc': 0.9928334649825629, 'loss_val': 0.08993840317917322, 'psi': 0.9844204544274716}
[S17] START round=66 head_norm_before_train=2.174906 cos_to_last_merge=0.7611 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=66 local utility u=0.143526 metrics={'f1_val': 0.8480625064313283, 'auprc': 0.9821815496345734, 'loss_val': 0.4731993634139318, 'psi': 0.9017101237126264}-{'f1_val': 0.8240351396396753, 'auprc': 0.9175223445169786, 'loss_val': 0.42210910759968373, 'psi': 0.8614300215905966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:49305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49307
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9997
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0311
[S13] DROPPED delta from S10 (cos=-0.0311 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=0.9871
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=66 metric=0.9970 head_norm=2.290878
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.983488e-02
[S11] stored merged vector for next round verification (round=66)
[S11] DEBUG after merge:  round=66 metric=0.9970 head_norm=2.289734 delta_norm=0.019835
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9998
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=66 metric=0.6131 head_norm=1.724000
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.386347e-01
[S5] stored merged vector for next round verification (round=66)
[S5] DEBUG after merge:  round=66 metric=0.6159 head_norm=1.720349 delta_norm=0.138635
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9822
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=66 metric=0.6408 head_norm=1.729854
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.730871e-02
[S7] stored merged vector for next round verification (round=66)
[S7] DEBUG after merge:  round=66 metric=0.6430 head_norm=1.723719 delta_norm=0.017309
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=66 metric=0.6484 head_norm=1.722911
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.412880e-02
[S3] stored merged vector for next round verification (round=66)
[S3] DEBUG after merge:  round=66 metric=0.6484 head_norm=1.726328 delta_norm=0.014129
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=67 head_norm_before_train=1.793421 cos_to_last_merge=0.9843 (last merge round=39)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.6850179671272421, 'auprc': 0.8127027797352858, 'loss_val': 0.7206855258696487, 'psi': 0.7360918921704596}-{'f1_val': 0.7004379754950376, 'auprc': 0.9081688510488748, 'loss_val': 0.6209086981409544, 'psi': 0.7835303257165724}
[S3] START round=67 head_norm_before_train=1.726328 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=67 local utility u=1.000000 metrics={'f1_val': 0.8419740266351133, 'auprc': 0.9815847706396157, 'loss_val': 0.4656904225593551, 'psi': 0.8978183242369143}-{'f1_val': 0.6483704404621617, 'auprc': 0.8200184125336218, 'loss_val': 1.2437609835089336, 'psi': 0.7170296292907458}
[S4] START round=67 head_norm_before_train=2.298967 cos_to_last_merge=0.9998 (last merge round=64)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9513808116606617, 'auprc': 0.9801658927049658, 'loss_val': 0.291071989836085, 'psi': 0.9628948440783833}-{'f1_val': 0.9457120541139538, 'auprc': 0.9846007987779515, 'loss_val': 0.26597233958998917, 'psi': 0.9612675519795528}
[S5] START round=67 head_norm_before_train=1.720349 cos_to_last_merge=1.0000 (last merge round=66)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.5849284055443034, 'auprc': 0.8605709838841803, 'loss_val': 0.677906296145523, 'psi': 0.6951854368802541}-{'f1_val': 0.6131276924453102, 'auprc': 0.8517846187961683, 'loss_val': 0.6786293106034248, 'psi': 0.7085904629856534}
[S6] START round=67 head_norm_before_train=1.983918 cos_to_last_merge=0.9996 (last merge round=63)
[S6] round=67 local utility u=0.007254 metrics={'f1_val': 0.6971358376497228, 'auprc': 0.8693511215511147, 'loss_val': 0.8397653934769386, 'psi': 0.7660219512102795}-{'f1_val': 0.6669015752403381, 'auprc': 0.9423885555060915, 'loss_val': 0.8919792197087073, 'psi': 0.7770963673466394}
[S7] START round=67 head_norm_before_train=1.723719 cos_to_last_merge=1.0000 (last merge round=66)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6067937158050809, 'auprc': 0.7938418812694727, 'loss_val': 0.7544099352429178, 'psi': 0.6816129819908376}-{'f1_val': 0.6407912715869537, 'auprc': 0.8040092254306439, 'loss_val': 0.47681393361126734, 'psi': 0.7060784531244297}
[S8] START round=67 head_norm_before_train=1.973665 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=67 local utility u=0.001107 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9988485468434118, 'loss_val': 0.032337654358954096, 'psi': 0.9958473026858434}-{'f1_val': 0.9936602072557493, 'auprc': 0.9986668349324692, 'loss_val': 0.032888699888488845, 'psi': 0.9956628583264373}
[S9] START round=67 head_norm_before_train=1.958342 cos_to_last_merge=0.9885 (last merge round=34)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9981826516757123, 'loss_val': 0.028347000998687342, 'psi': 0.9953860158609302}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982176597207072, 'loss_val': 0.020121510902898744, 'psi': 0.9972833709766178}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.356992 (no previous merge yet)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961885561503319, 'loss_val': 0.024781631053003367, 'psi': 0.995669294798371}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962276525516531, 'loss_val': 0.024320456135839448, 'psi': 0.9956849333588995}
[S11] START round=67 head_norm_before_train=2.289734 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=67 local utility u=0.000448 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992357466144806, 'loss_val': 0.016653580139445224, 'psi': 0.9978728526215386}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989652993852457, 'loss_val': 0.01673876596468099, 'psi': 0.9977646737298446}
[S13] START round=67 head_norm_before_train=2.041723 (no previous merge yet)
[S13] round=67 local utility u=0.419736 metrics={'f1_val': 0.6966113779852543, 'auprc': 0.8828132860309179, 'loss_val': 1.0247120302060138, 'psi': 0.7710921412035197}-{'f1_val': 0.6661404493718408, 'auprc': 0.7135283655798834, 'loss_val': 1.1735045969734335, 'psi': 0.6850956158550578}
[S14] START round=67 head_norm_before_train=1.735643 cos_to_last_merge=0.9523 (last merge round=33)
[S14] round=67 local utility u=0.000218 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.998073745825427, 'loss_val': 0.023071671932873735, 'psi': 0.9975171879050397}-{'f1_val': 0.9969755000837764, 'auprc': 0.9982360150383276, 'loss_val': 0.022971156847906345, 'psi': 0.9974797060655969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=67 head_norm_before_train=1.727850 cos_to_last_merge=0.9999 (last merge round=65)
[S15] round=67 local utility u=0.234752 metrics={'f1_val': 0.9217014030926843, 'auprc': 0.9967887623582544, 'loss_val': 0.13831349795964626, 'psi': 0.9517363467989124}-{'f1_val': 0.8658360155994211, 'auprc': 0.9956907528944696, 'loss_val': 0.2693318489117834, 'psi': 0.9177779105174405}
[S16] START round=67 head_norm_before_train=1.769620 cos_to_last_merge=0.9986 (last merge round=55)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9123419491332958, 'auprc': 0.9695777809435281, 'loss_val': 0.5030139475800661, 'psi': 0.9352362818573887}-{'f1_val': 0.9903802604750188, 'auprc': 0.9957826058263337, 'loss_val': 0.046249972253200905, 'psi': 0.9925411986155448}
[S17] START round=67 head_norm_before_train=2.181670 cos_to_last_merge=0.7604 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.8404475974960647, 'auprc': 0.9753556014086772, 'loss_val': 0.6188275751266891, 'psi': 0.8944107990611097}-{'f1_val': 0.8480625064313283, 'auprc': 0.9821815496345734, 'loss_val': 0.4731993634139318, 'psi': 0.9017101237126264}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:49311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.952)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=67 metric=0.9514 head_norm=2.303072
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.544579e-02
[S4] stored merged vector for next round verification (round=67)
[S4] DEBUG after merge:  round=67 metric=0.9514 head_norm=2.296842 delta_norm=0.025446
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:49308
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.0306
[S10] DROPPED delta from S13 (cos=-0.0306 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.9997
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=67 metric=0.6971 head_norm=1.999066
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.697867e-02
[S6] stored merged vector for next round verification (round=67)
[S6] DEBUG after merge:  round=67 metric=0.6975 head_norm=1.986223 delta_norm=0.026979
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1807 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S3
[S7] cosine check vs S3: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=67 metric=0.9938 head_norm=1.978344
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.819506e-02
[S8] stored merged vector for next round verification (round=67)
[S8] DEBUG after merge:  round=67 metric=0.9938 head_norm=1.988532 delta_norm=0.028195
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=67 metric=0.5849 head_norm=1.725728
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.683789e-01
[S5] stored merged vector for next round verification (round=67)
[S5] DEBUG after merge:  round=67 metric=0.5771 head_norm=1.739682 delta_norm=0.168379
[S5] aggregate: ROLLBACK (f1_val pre=0.585 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S2] START round=68 head_norm_before_train=1.797030 cos_to_last_merge=0.9842 (last merge round=39)
[S2] round=68 local utility u=0.176049 metrics={'f1_val': 0.6992012852573567, 'auprc': 0.8676026759879343, 'loss_val': 0.6183874335531315, 'psi': 0.7665618415495877}-{'f1_val': 0.6850179671272421, 'auprc': 0.8127027797352858, 'loss_val': 0.7206855258696487, 'psi': 0.7360918921704596}
[S3] START round=68 head_norm_before_train=1.732331 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=68 local utility u=0.710190 metrics={'f1_val': 0.9968752412829052, 'auprc': 0.9999395304369941, 'loss_val': 0.029782877802264882, 'psi': 0.9981009569445407}-{'f1_val': 0.8419740266351133, 'auprc': 0.9815847706396157, 'loss_val': 0.4656904225593551, 'psi': 0.8978183242369143}
[S4] START round=68 head_norm_before_train=2.296842 cos_to_last_merge=1.0000 (last merge round=67)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9491344853895425, 'auprc': 0.9794593053263762, 'loss_val': 0.286020676602775, 'psi': 0.9612644133642759}-{'f1_val': 0.9513808116606617, 'auprc': 0.9801658927049658, 'loss_val': 0.291071989836085, 'psi': 0.9628948440783833}
[S5] START round=68 head_norm_before_train=1.739682 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=68 local utility u=0.694453 metrics={'f1_val': 0.7308515971914112, 'auprc': 0.9446063025067366, 'loss_val': 0.4166460046919951, 'psi': 0.8163534793175413}-{'f1_val': 0.5849284055443034, 'auprc': 0.8605709838841803, 'loss_val': 0.677906296145523, 'psi': 0.6951854368802541}
[S6] START round=68 head_norm_before_train=1.986223 cos_to_last_merge=1.0000 (last merge round=67)
[S6] round=68 local utility u=0.224173 metrics={'f1_val': 0.7550480514415535, 'auprc': 0.8592651654363411, 'loss_val': 0.7086352749840663, 'psi': 0.7967348970394685}-{'f1_val': 0.6971358376497228, 'auprc': 0.8693511215511147, 'loss_val': 0.8397653934769386, 'psi': 0.7660219512102795}
[S7] START round=68 head_norm_before_train=1.738203 cos_to_last_merge=0.9999 (last merge round=66)
[S7] round=68 local utility u=0.322958 metrics={'f1_val': 0.6559735656743547, 'auprc': 0.8119127769877453, 'loss_val': 0.4577858806255238, 'psi': 0.7183492501997111}-{'f1_val': 0.6067937158050809, 'auprc': 0.7938418812694727, 'loss_val': 0.7544099352429178, 'psi': 0.6816129819908376}
[S8] START round=68 head_norm_before_train=1.988532 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9991380152274291, 'loss_val': 0.035081559775144266, 'psi': 0.9953915295699409}-{'f1_val': 0.9938464732474644, 'auprc': 0.9988485468434118, 'loss_val': 0.032337654358954096, 'psi': 0.9958473026858434}
[S9] START round=68 head_norm_before_train=1.961287 cos_to_last_merge=0.9884 (last merge round=34)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9981936149705615, 'loss_val': 0.04879521691462938, 'psi': 0.992094650664386}-{'f1_val': 0.9935215919844088, 'auprc': 0.9981826516757123, 'loss_val': 0.028347000998687342, 'psi': 0.9953860158609302}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.365581 (no previous merge yet)
[S10] round=68 local utility u=0.000240 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962626128925735, 'loss_val': 0.024524659965539715, 'psi': 0.9956989174952675}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961885561503319, 'loss_val': 0.024781631053003367, 'psi': 0.995669294798371}
[S11] START round=68 head_norm_before_train=2.295314 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991887926370813, 'loss_val': 0.01757758301307529, 'psi': 0.9976060700518908}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992357466144806, 'loss_val': 0.016653580139445224, 'psi': 0.9978728526215386}
[S13] START round=68 head_norm_before_train=2.054605 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6814560082040226, 'auprc': 0.854146456979197, 'loss_val': 1.1365943262091978, 'psi': 0.7505321877140925}-{'f1_val': 0.6966113779852543, 'auprc': 0.8828132860309179, 'loss_val': 1.0247120302060138, 'psi': 0.7710921412035197}
[S14] START round=68 head_norm_before_train=1.742373 cos_to_last_merge=0.9517 (last merge round=33)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9981902275349026, 'loss_val': 0.023922261001622157, 'psi': 0.9973307330401275}-{'f1_val': 0.9971461492914482, 'auprc': 0.998073745825427, 'loss_val': 0.023071671932873735, 'psi': 0.9975171879050397}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.747770 cos_to_last_merge=0.9998 (last merge round=65)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.818188278080822, 'auprc': 0.9919605428583333, 'loss_val': 0.36265365861086074, 'psi': 0.8876971839918265}-{'f1_val': 0.9217014030926843, 'auprc': 0.9967887623582544, 'loss_val': 0.13831349795964626, 'psi': 0.9517363467989124}
[S16] START round=68 head_norm_before_train=1.777596 cos_to_last_merge=0.9984 (last merge round=55)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.8556873049591379, 'auprc': 0.9565063926842251, 'loss_val': 0.9412937040952976, 'psi': 0.8960149400491728}-{'f1_val': 0.9123419491332958, 'auprc': 0.9695777809435281, 'loss_val': 0.5030139475800661, 'psi': 0.9352362818573887}
[S17] START round=68 head_norm_before_train=2.189757 cos_to_last_merge=0.7597 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=68 local utility u=0.430386 metrics={'f1_val': 0.9257042646962969, 'auprc': 0.945761480171061, 'loss_val': 0.18081229741433347, 'psi': 0.9337271508862026}-{'f1_val': 0.8404475974960647, 'auprc': 0.9753556014086772, 'loss_val': 0.6188275751266891, 'psi': 0.8944107990611097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2]  timeout peer S15
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:49313
[S6] not sending this round → trigger blocked (psi=0.797)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=-0.0303
[S13] DROPPED delta from S10 (cos=-0.0303 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S7
[S3] cosine check vs S7: cos=0.9998
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=68 metric=0.6560 head_norm=1.750498
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.932946e-02
[S7] stored merged vector for next round verification (round=68)
[S7] DEBUG after merge:  round=68 metric=0.6566 head_norm=1.741331 delta_norm=0.019329
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9827
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=68 metric=0.9969 head_norm=1.739676
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.932595e-02
[S3] stored merged vector for next round verification (round=68)
[S3] DEBUG after merge:  round=68 metric=0.9969 head_norm=1.744988 delta_norm=0.019326
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=1.802098 cos_to_last_merge=0.9838 (last merge round=39)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.5795274024262874, 'auprc': 0.785298846696329, 'loss_val': 1.3906531168606096, 'psi': 0.6618359801343041}-{'f1_val': 0.6992012852573567, 'auprc': 0.8676026759879343, 'loss_val': 0.6183874335531315, 'psi': 0.7665618415495877}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=1.744988 cos_to_last_merge=1.0000 (last merge round=68)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9558137345256009, 'auprc': 0.9832983098713106, 'loss_val': 0.15655037292250112, 'psi': 0.9668075646638847}-{'f1_val': 0.9968752412829052, 'auprc': 0.9999395304369941, 'loss_val': 0.029782877802264882, 'psi': 0.9981009569445407}
[S4] START round=69 head_norm_before_train=2.303934 cos_to_last_merge=1.0000 (last merge round=67)
[S4] round=69 local utility u=0.005498 metrics={'f1_val': 0.9534910850627742, 'auprc': 0.976049417142658, 'loss_val': 0.2909337538527221, 'psi': 0.9625144178947278}-{'f1_val': 0.9491344853895425, 'auprc': 0.9794593053263762, 'loss_val': 0.286020676602775, 'psi': 0.9612644133642759}
[S5] START round=69 head_norm_before_train=1.744822 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=69 local utility u=0.579867 metrics={'f1_val': 0.8621872007994507, 'auprc': 0.9898118037871334, 'loss_val': 0.18054221300616313, 'psi': 0.9132370419945237}-{'f1_val': 0.7308515971914112, 'auprc': 0.9446063025067366, 'loss_val': 0.4166460046919951, 'psi': 0.8163534793175413}
[S6] START round=69 head_norm_before_train=1.999027 cos_to_last_merge=1.0000 (last merge round=67)
[S6] round=69 local utility u=0.301231 metrics={'f1_val': 0.802723139400981, 'auprc': 0.9193344926403126, 'loss_val': 0.5724314577559177, 'psi': 0.8493676806967136}-{'f1_val': 0.7550480514415535, 'auprc': 0.8592651654363411, 'loss_val': 0.7086352749840663, 'psi': 0.7967348970394685}
[S7] START round=69 head_norm_before_train=1.741331 cos_to_last_merge=1.0000 (last merge round=68)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.578750502903937, 'auprc': 0.7853388791808728, 'loss_val': 0.7832262783248036, 'psi': 0.6613858534147113}-{'f1_val': 0.6559735656743547, 'auprc': 0.8119127769877453, 'loss_val': 0.4577858806255238, 'psi': 0.7183492501997111}
[S8] START round=69 head_norm_before_train=1.994364 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=69 local utility u=0.000232 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9991250344454339, 'loss_val': 0.03457898389180053, 'psi': 0.9953863372571428}-{'f1_val': 0.9928938724649488, 'auprc': 0.9991380152274291, 'loss_val': 0.035081559775144266, 'psi': 0.9953915295699409}
[S9] START round=69 head_norm_before_train=1.964072 cos_to_last_merge=0.9884 (last merge round=34)
[S9] round=69 local utility u=0.033224 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9944368835167172, 'loss_val': 0.020404918293444867, 'psi': 0.9955248102742534}-{'f1_val': 0.9880286744602689, 'auprc': 0.9981936149705615, 'loss_val': 0.04879521691462938, 'psi': 0.992094650664386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=69 head_norm_before_train=2.374474 (no previous merge yet)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961363266664917, 'loss_val': 0.024910187159277137, 'psi': 0.9956484030048349}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962626128925735, 'loss_val': 0.024524659965539715, 'psi': 0.9956989174952675}
[S11] START round=69 head_norm_before_train=2.298203 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=69 local utility u=0.000031 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991223800165232, 'loss_val': 0.01731579586642402, 'psi': 0.9975795050036677}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991887926370813, 'loss_val': 0.01757758301307529, 'psi': 0.9976060700518908}
[S13] START round=69 head_norm_before_train=2.065490 (no previous merge yet)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.7140465370923201, 'auprc': 0.744967806954259, 'loss_val': 1.0958063374806915, 'psi': 0.7264150450370956}-{'f1_val': 0.6814560082040226, 'auprc': 0.854146456979197, 'loss_val': 1.1365943262091978, 'psi': 0.7505321877140925}
[S14] START round=69 head_norm_before_train=1.748752 cos_to_last_merge=0.9510 (last merge round=33)
[S14] round=69 local utility u=0.000025 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9981455846841505, 'loss_val': 0.023738495364757806, 'psi': 0.9973128758998266}-{'f1_val': 0.9967577367102773, 'auprc': 0.9981902275349026, 'loss_val': 0.023922261001622157, 'psi': 0.9973307330401275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=69 head_norm_before_train=1.766620 cos_to_last_merge=0.9995 (last merge round=65)
[S15] round=69 local utility u=0.522780 metrics={'f1_val': 0.9442216867616, 'auprc': 0.9967305232856767, 'loss_val': 0.08760413194573628, 'psi': 0.9652252213712307}-{'f1_val': 0.818188278080822, 'auprc': 0.9919605428583333, 'loss_val': 0.36265365861086074, 'psi': 0.8876971839918265}
[S16] START round=69 head_norm_before_train=1.785675 cos_to_last_merge=0.9982 (last merge round=55)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.81412567043302, 'auprc': 0.9676999889183205, 'loss_val': 0.7949854852220338, 'psi': 0.8755553978271402}-{'f1_val': 0.8556873049591379, 'auprc': 0.9565063926842251, 'loss_val': 0.9412937040952976, 'psi': 0.8960149400491728}
[S17] START round=69 head_norm_before_train=2.198314 cos_to_last_merge=0.7591 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.8173926549207352, 'auprc': 0.9644761343132012, 'loss_val': 0.7308290716769716, 'psi': 0.8762260466777216}-{'f1_val': 0.9257042646962969, 'auprc': 0.945761480171061, 'loss_val': 0.18081229741433347, 'psi': 0.9337271508862026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:49307
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9821
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9998
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=69 metric=0.9442 head_norm=1.783534
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.707325e-01
[S15] stored merged vector for next round verification (round=69)
[S15] DEBUG after merge:  round=69 metric=0.9491 head_norm=1.756003 delta_norm=0.170733
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9955
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=69 metric=0.8622 head_norm=1.751822
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.681593e-01
[S5] stored merged vector for next round verification (round=69)
[S5] DEBUG after merge:  round=69 metric=0.8668 head_norm=1.759733 delta_norm=0.168159
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=69 metric=0.9929 head_norm=2.002018
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.775183e-02
[S8] stored merged vector for next round verification (round=69)
[S8] DEBUG after merge:  round=69 metric=0.9929 head_norm=2.007243 delta_norm=0.017752
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=69 metric=0.9535 head_norm=2.306266
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.058457e-02
[S4] stored merged vector for next round verification (round=69)
[S4] DEBUG after merge:  round=69 metric=0.9535 head_norm=2.304118 delta_norm=0.020585
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.807209 cos_to_last_merge=0.9835 (last merge round=39)
[S2] round=70 local utility u=1.000000 metrics={'f1_val': 0.7088300931767343, 'auprc': 0.9674755323595575, 'loss_val': 0.5139065966838879, 'psi': 0.8122882688498636}-{'f1_val': 0.5795274024262874, 'auprc': 0.785298846696329, 'loss_val': 1.3906531168606096, 'psi': 0.6618359801343041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=70 head_norm_before_train=1.752701 cos_to_last_merge=1.0000 (last merge round=68)
[S3] round=70 local utility u=0.008823 metrics={'f1_val': 0.9482131115846716, 'auprc': 0.9970864681274099, 'loss_val': 0.1346655186287195, 'psi': 0.9677624542017669}-{'f1_val': 0.9558137345256009, 'auprc': 0.9832983098713106, 'loss_val': 0.15655037292250112, 'psi': 0.9668075646638847}
[S4] START round=70 head_norm_before_train=2.304118 cos_to_last_merge=1.0000 (last merge round=69)
[S4] round=70 local utility u=0.008238 metrics={'f1_val': 0.9527004734424291, 'auprc': 0.9800155622178244, 'loss_val': 0.2816125633518044, 'psi': 0.9636265089525873}-{'f1_val': 0.9534910850627742, 'auprc': 0.976049417142658, 'loss_val': 0.2909337538527221, 'psi': 0.9625144178947278}
[S5] START round=70 head_norm_before_train=1.759733 cos_to_last_merge=1.0000 (last merge round=69)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9537053124894025, 'loss_val': 0.41187028377646034, 'psi': 0.801726270824322}-{'f1_val': 0.8621872007994507, 'auprc': 0.9898118037871334, 'loss_val': 0.18054221300616313, 'psi': 0.9132370419945237}
[S6] START round=70 head_norm_before_train=2.012612 cos_to_last_merge=0.9999 (last merge round=67)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.591850123872006, 'auprc': 0.8588826080625076, 'loss_val': 1.249935224881507, 'psi': 0.6986631175482066}-{'f1_val': 0.802723139400981, 'auprc': 0.9193344926403126, 'loss_val': 0.5724314577559177, 'psi': 0.8493676806967136}
[S7] START round=70 head_norm_before_train=1.749383 cos_to_last_merge=1.0000 (last merge round=68)
[S7] round=70 local utility u=0.611826 metrics={'f1_val': 0.6745883704717273, 'auprc': 0.8437068416521232, 'loss_val': 0.3097055746093795, 'psi': 0.7422357589438856}-{'f1_val': 0.578750502903937, 'auprc': 0.7853388791808728, 'loss_val': 0.7832262783248036, 'psi': 0.6613858534147113}
[S8] START round=70 head_norm_before_train=2.007243 cos_to_last_merge=1.0000 (last merge round=69)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9683198107991999, 'auprc': 0.9956900684276812, 'loss_val': 0.10290306264015377, 'psi': 0.9792679138505924}-{'f1_val': 0.9928938724649488, 'auprc': 0.9991250344454339, 'loss_val': 0.03457898389180053, 'psi': 0.9953863372571428}
[S9] START round=70 head_norm_before_train=1.967371 cos_to_last_merge=0.9883 (last merge round=34)
[S9] round=70 local utility u=0.000577 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9981777643297707, 'loss_val': 0.023936306909863102, 'psi': 0.9963674027970428}-{'f1_val': 0.9962500947792776, 'auprc': 0.9944368835167172, 'loss_val': 0.020404918293444867, 'psi': 0.9955248102742534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=70 head_norm_before_train=2.377773 (no previous merge yet)
[S10] round=70 local utility u=0.000342 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962549178387391, 'loss_val': 0.024581655543191725, 'psi': 0.9956958394737339}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961363266664917, 'loss_val': 0.024910187159277137, 'psi': 0.9956484030048349}
[S11] START round=70 head_norm_before_train=2.302153 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=70 local utility u=0.000367 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990927532736449, 'loss_val': 0.016493591108191326, 'psi': 0.9975676543065163}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991223800165232, 'loss_val': 0.01731579586642402, 'psi': 0.9975795050036677}
[S13] START round=70 head_norm_before_train=2.069691 (no previous merge yet)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.7065979120710835, 'auprc': 0.7365546117348527, 'loss_val': 1.2327608593359072, 'psi': 0.7185805919365912}-{'f1_val': 0.7140465370923201, 'auprc': 0.744967806954259, 'loss_val': 1.0958063374806915, 'psi': 0.7264150450370956}
[S14] START round=70 head_norm_before_train=1.756057 cos_to_last_merge=0.9503 (last merge round=33)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9981443687716401, 'loss_val': 0.02380724073702713, 'psi': 0.9973123895348225}-{'f1_val': 0.9967577367102773, 'auprc': 0.9981455846841505, 'loss_val': 0.023738495364757806, 'psi': 0.9973128758998266}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=1.756003 cos_to_last_merge=1.0000 (last merge round=69)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9176105571326671, 'auprc': 0.9966798940661041, 'loss_val': 0.14219731782186515, 'psi': 0.9492382919060419}-{'f1_val': 0.9442216867616, 'auprc': 0.9967305232856767, 'loss_val': 0.08760413194573628, 'psi': 0.9652252213712307}
[S16] START round=70 head_norm_before_train=1.791685 cos_to_last_merge=0.9980 (last merge round=55)
[S16] round=70 local utility u=0.462631 metrics={'f1_val': 0.8808556876158797, 'auprc': 0.9924108956537895, 'loss_val': 0.34423650750051227, 'psi': 0.9254777708310435}-{'f1_val': 0.81412567043302, 'auprc': 0.9676999889183205, 'loss_val': 0.7949854852220338, 'psi': 0.8755553978271402}
[S17] START round=70 head_norm_before_train=2.208090 cos_to_last_merge=0.7587 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=70 local utility u=0.458651 metrics={'f1_val': 0.8931757116523569, 'auprc': 0.9652532340464186, 'loss_val': 0.2705561323524842, 'psi': 0.9220067206099816}-{'f1_val': 0.8173926549207352, 'auprc': 0.9644761343132012, 'loss_val': 0.7308290716769716, 'psi': 0.8762260466777216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.084 → S10@127.0.0.1:49311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:49308
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=70 metric=0.5919 head_norm=2.027806
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.654917e-02
[S6] stored merged vector for next round verification (round=70)
[S6] DEBUG after merge:  round=70 metric=0.5917 head_norm=2.014778 delta_norm=0.026549
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.237 → S8@127.0.0.1:49309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=70 metric=0.9176 head_norm=1.771826
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.009374e-02
[S15] stored merged vector for next round verification (round=70)
[S15] DEBUG after merge:  round=70 metric=0.9192 head_norm=1.759548 delta_norm=0.090094
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.181 → S5@127.0.0.1:49305
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=-0.0300
[S13] DROPPED delta from S10 (cos=-0.0300 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=70 metric=0.9966 head_norm=2.307311
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.145005e-02
[S11] stored merged vector for next round verification (round=70)
[S11] DEBUG after merge:  round=70 metric=0.9966 head_norm=2.306689 delta_norm=0.021450
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.001 → S4@127.0.0.1:49304
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9999
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9799
[S8] ⇄ pheromone p=0.064 → S6@127.0.0.1:49307
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=70 metric=0.7004 head_norm=1.766165
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.789699e-01
[S5] stored merged vector for next round verification (round=70)
[S5] DEBUG after merge:  round=70 metric=0.7004 head_norm=1.771937 delta_norm=0.178970
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.274 → S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] ⇄ pheromone p=0.116 → S5@127.0.0.1:49305
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=70 metric=0.6746 head_norm=1.756534
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.359328e-02
[S7] stored merged vector for next round verification (round=70)
[S7] DEBUG after merge:  round=70 metric=0.6745 head_norm=1.758150 delta_norm=0.013593
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.252 → S3@127.0.0.1:49303
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=70 metric=0.9527 head_norm=2.309302
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.420935e-02
[S4] stored merged vector for next round verification (round=70)
[S4] DEBUG after merge:  round=70 metric=0.9527 head_norm=2.308263 delta_norm=0.014209
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.006 → S11@127.0.0.1:49312
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=70 metric=0.9482 head_norm=1.759869
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.359328e-02
[S3] stored merged vector for next round verification (round=70)
[S3] DEBUG after merge:  round=70 metric=0.9482 head_norm=1.758150 delta_norm=0.013593
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.293 → S7@127.0.0.1:49308
[S2] START round=71 head_norm_before_train=1.813635 cos_to_last_merge=0.9831 (last merge round=39)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7159501381702283, 'auprc': 0.8487159685109474, 'loss_val': 0.7626993084032276, 'psi': 0.7690564703065159}-{'f1_val': 0.7088300931767343, 'auprc': 0.9674755323595575, 'loss_val': 0.5139065966838879, 'psi': 0.8122882688498636}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=1.758150 cos_to_last_merge=1.0000 (last merge round=70)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8113915158310884, 'auprc': 0.9893606959665459, 'loss_val': 0.5149477696850462, 'psi': 0.8825791878852713}-{'f1_val': 0.9482131115846716, 'auprc': 0.9970864681274099, 'loss_val': 0.1346655186287195, 'psi': 0.9677624542017669}
[S4] START round=71 head_norm_before_train=2.308263 cos_to_last_merge=1.0000 (last merge round=70)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9506919267462873, 'auprc': 0.9806375339456148, 'loss_val': 0.27979264145039284, 'psi': 0.9626701696260183}-{'f1_val': 0.9527004734424291, 'auprc': 0.9800155622178244, 'loss_val': 0.2816125633518044, 'psi': 0.9636265089525873}
[S5] START round=71 head_norm_before_train=1.771937 cos_to_last_merge=1.0000 (last merge round=70)
[S5] round=71 local utility u=0.451175 metrics={'f1_val': 0.8195428635051076, 'auprc': 0.9683761637529327, 'loss_val': 0.2683487922152604, 'psi': 0.8790761836042376}-{'f1_val': 0.7004069097142683, 'auprc': 0.9537053124894025, 'loss_val': 0.41187028377646034, 'psi': 0.801726270824322}
[S6] START round=71 head_norm_before_train=2.014778 cos_to_last_merge=1.0000 (last merge round=70)
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.9118691460301924, 'auprc': 0.9825752055403967, 'loss_val': 0.20279872256613143, 'psi': 0.9401515698342742}-{'f1_val': 0.591850123872006, 'auprc': 0.8588826080625076, 'loss_val': 1.249935224881507, 'psi': 0.6986631175482066}
[S7] START round=71 head_norm_before_train=1.758150 cos_to_last_merge=1.0000 (last merge round=70)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5692757494431487, 'auprc': 0.7855795416326794, 'loss_val': 0.9113791125821936, 'psi': 0.6557972663189611}-{'f1_val': 0.6745883704717273, 'auprc': 0.8437068416521232, 'loss_val': 0.3097055746093795, 'psi': 0.7422357589438856}
[S8] START round=71 head_norm_before_train=2.016097 cos_to_last_merge=1.0000 (last merge round=69)
[S8] round=71 local utility u=0.044431 metrics={'f1_val': 0.9825157098216825, 'auprc': 0.986208959505757, 'loss_val': 0.07077223471641325, 'psi': 0.9839930096953123}-{'f1_val': 0.9683198107991999, 'auprc': 0.9956900684276812, 'loss_val': 0.10290306264015377, 'psi': 0.9792679138505924}
[S9] START round=71 head_norm_before_train=1.970048 cos_to_last_merge=0.9882 (last merge round=34)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9981666040843286, 'loss_val': 0.02811324915610871, 'psi': 0.995361750939554}-{'f1_val': 0.9951604951085576, 'auprc': 0.9981777643297707, 'loss_val': 0.023936306909863102, 'psi': 0.9963674027970428}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.383028 (no previous merge yet)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962298712450776, 'loss_val': 0.02471209118289891, 'psi': 0.9956858208362692}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962549178387391, 'loss_val': 0.024581655543191725, 'psi': 0.9956958394737339}
[S11] START round=71 head_norm_before_train=2.306689 cos_to_last_merge=1.0000 (last merge round=70)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9962419185632914, 'auprc': 0.9992967451385912, 'loss_val': 0.01715064927725363, 'psi': 0.9974638491934114}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990927532736449, 'loss_val': 0.016493591108191326, 'psi': 0.9975676543065163}
[S13] START round=71 head_norm_before_train=2.074517 (no previous merge yet)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.640793066500513, 'auprc': 0.6740683029543624, 'loss_val': 1.3199705148480587, 'psi': 0.6541031610820528}-{'f1_val': 0.7065979120710835, 'auprc': 0.7365546117348527, 'loss_val': 1.2327608593359072, 'psi': 0.7185805919365912}
[S14] START round=71 head_norm_before_train=1.762817 cos_to_last_merge=0.9496 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=71 local utility u=0.001808 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9981263451759703, 'loss_val': 0.02259896421216036, 'psi': 0.9975513487287047}-{'f1_val': 0.9967577367102773, 'auprc': 0.9981443687716401, 'loss_val': 0.02380724073702713, 'psi': 0.9973123895348225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=71 head_norm_before_train=1.759548 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.8928515812716926, 'auprc': 0.990105966937338, 'loss_val': 0.20714346708333625, 'psi': 0.9317533355379507}-{'f1_val': 0.9176105571326671, 'auprc': 0.9966798940661041, 'loss_val': 0.14219731782186515, 'psi': 0.9492382919060419}
[S16] START round=71 head_norm_before_train=1.795618 cos_to_last_merge=0.9978 (last merge round=55)
[S16] round=71 local utility u=0.486998 metrics={'f1_val': 0.9920875221017437, 'auprc': 0.994051364919932, 'loss_val': 0.042553363244494366, 'psi': 0.992873059229019}-{'f1_val': 0.8808556876158797, 'auprc': 0.9924108956537895, 'loss_val': 0.34423650750051227, 'psi': 0.9254777708310435}
[S17] START round=71 head_norm_before_train=2.199833 cos_to_last_merge=0.7582 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8420380710167525, 'auprc': 0.9301040930542847, 'loss_val': 0.4756639885403401, 'psi': 0.8772644798317654}-{'f1_val': 0.8931757116523569, 'auprc': 0.9652532340464186, 'loss_val': 0.2705561323524842, 'psi': 0.9220067206099816}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=71 metric=0.9962 head_norm=2.312351
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.501332e-03
[S11] stored merged vector for next round verification (round=71)
[S11] DEBUG after merge:  round=71 metric=0.9962 head_norm=2.310818 delta_norm=0.006501
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9982
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=71 metric=0.9825 head_norm=2.022666
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.095334e-02
[S8] stored merged vector for next round verification (round=71)
[S8] DEBUG after merge:  round=71 metric=0.9825 head_norm=2.023548 delta_norm=0.010953
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9946
[S2] START round=72 head_norm_before_train=1.820962 cos_to_last_merge=0.9830 (last merge round=39)
[S2] round=72 local utility u=0.063778 metrics={'f1_val': 0.7148751890817252, 'auprc': 0.8764971867858367, 'loss_val': 0.7120365834197004, 'psi': 0.7795239881633698}-{'f1_val': 0.7159501381702283, 'auprc': 0.8487159685109474, 'loss_val': 0.7626993084032276, 'psi': 0.7690564703065159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=72 head_norm_before_train=1.765929 cos_to_last_merge=1.0000 (last merge round=70)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.6848441354498803, 'auprc': 0.8896501704225774, 'loss_val': 1.002637355766683, 'psi': 0.7667665494389592}-{'f1_val': 0.8113915158310884, 'auprc': 0.9893606959665459, 'loss_val': 0.5149477696850462, 'psi': 0.8825791878852713}
[S4] START round=72 head_norm_before_train=2.317252 cos_to_last_merge=1.0000 (last merge round=70)
[S4] round=72 local utility u=0.000799 metrics={'f1_val': 0.9541550704810987, 'auprc': 0.9821616544037131, 'loss_val': 0.30354496255960883, 'psi': 0.9653577040501444}-{'f1_val': 0.9506919267462873, 'auprc': 0.9806375339456148, 'loss_val': 0.27979264145039284, 'psi': 0.9626701696260183}
[S5] START round=72 head_norm_before_train=1.780123 cos_to_last_merge=1.0000 (last merge round=70)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.7171949223484589, 'auprc': 0.9503304679463106, 'loss_val': 0.3673382157655054, 'psi': 0.8104491405875995}-{'f1_val': 0.8195428635051076, 'auprc': 0.9683761637529327, 'loss_val': 0.2683487922152604, 'psi': 0.8790761836042376}
[S6] START round=72 head_norm_before_train=2.024489 cos_to_last_merge=1.0000 (last merge round=70)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.59583144622034, 'auprc': 0.9307407446795589, 'loss_val': 1.2774050572064675, 'psi': 0.7297951656040276}-{'f1_val': 0.9118691460301924, 'auprc': 0.9825752055403967, 'loss_val': 0.20279872256613143, 'psi': 0.9401515698342742}
[S7] START round=72 head_norm_before_train=1.765100 cos_to_last_merge=0.9999 (last merge round=70)
[S7] round=72 local utility u=0.484564 metrics={'f1_val': 0.6576822922932901, 'auprc': 0.8050054792934378, 'loss_val': 0.5309683781491072, 'psi': 0.7166115670933493}-{'f1_val': 0.5692757494431487, 'auprc': 0.7855795416326794, 'loss_val': 0.9113791125821936, 'psi': 0.6557972663189611}
[S8] START round=72 head_norm_before_train=2.023548 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=72 local utility u=0.014816 metrics={'f1_val': 0.9824244394955325, 'auprc': 0.9931890763372102, 'loss_val': 0.061533535710953303, 'psi': 0.9867302942322036}-{'f1_val': 0.9825157098216825, 'auprc': 0.986208959505757, 'loss_val': 0.07077223471641325, 'psi': 0.9839930096953123}
[S9] START round=72 head_norm_before_train=1.973018 cos_to_last_merge=0.9880 (last merge round=34)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9981838194842549, 'loss_val': 0.04190200518754541, 'psi': 0.9931092967821835}-{'f1_val': 0.9934918488430377, 'auprc': 0.9981666040843286, 'loss_val': 0.02811324915610871, 'psi': 0.995361750939554}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.390315 (no previous merge yet)
[S10] round=72 local utility u=0.000122 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962675497596827, 'loss_val': 0.02458028882251827, 'psi': 0.9957008922421113}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962298712450776, 'loss_val': 0.02471209118289891, 'psi': 0.9956858208362692}
[S11] START round=72 head_norm_before_train=2.310818 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=72 local utility u=0.002698 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992627457989148, 'loss_val': 0.01598713209544082, 'psi': 0.9978836522953123}-{'f1_val': 0.9962419185632914, 'auprc': 0.9992967451385912, 'loss_val': 0.01715064927725363, 'psi': 0.9974638491934114}
[S13] START round=72 head_norm_before_train=2.078577 (no previous merge yet)
[S13] round=72 local utility u=0.301848 metrics={'f1_val': 0.710060288996281, 'auprc': 0.7155674567112237, 'loss_val': 1.2563759244908015, 'psi': 0.7122631560822581}-{'f1_val': 0.640793066500513, 'auprc': 0.6740683029543624, 'loss_val': 1.3199705148480587, 'psi': 0.6541031610820528}
[S14] START round=72 head_norm_before_train=1.769379 cos_to_last_merge=0.9491 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9982633714533735, 'loss_val': 0.022143833599289824, 'psi': 0.997344863080746}-{'f1_val': 0.9971680177638609, 'auprc': 0.9981263451759703, 'loss_val': 0.02259896421216036, 'psi': 0.9975513487287047}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=1.777595 cos_to_last_merge=0.9999 (last merge round=70)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.7021207024995553, 'auprc': 0.9773398616490073, 'loss_val': 0.5036522678668055, 'psi': 0.8122083661593361}-{'f1_val': 0.8928515812716926, 'auprc': 0.990105966937338, 'loss_val': 0.20714346708333625, 'psi': 0.9317533355379507}
[S16] START round=72 head_norm_before_train=1.801555 cos_to_last_merge=0.9977 (last merge round=55)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9914575406613149, 'auprc': 0.9923535294222294, 'loss_val': 0.042611001439238655, 'psi': 0.9918159361656806}-{'f1_val': 0.9920875221017437, 'auprc': 0.994051364919932, 'loss_val': 0.042553363244494366, 'psi': 0.992873059229019}
[S17] START round=72 head_norm_before_train=2.199169 cos_to_last_merge=0.7576 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.702749578922318, 'auprc': 0.9484852666288511, 'loss_val': 0.7428477262615595, 'psi': 0.8010438540049314}-{'f1_val': 0.8420380710167525, 'auprc': 0.9301040930542847, 'loss_val': 0.4756639885403401, 'psi': 0.8772644798317654}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=72 metric=0.7021 head_norm=1.793586
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.976170e-02
[S15] stored merged vector for next round verification (round=72)
[S15] DEBUG after merge:  round=72 metric=0.7021 head_norm=1.785867 delta_norm=0.059762
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=72 metric=0.5958 head_norm=2.028638
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.641293e-02
[S6] stored merged vector for next round verification (round=72)
[S6] DEBUG after merge:  round=72 metric=0.5958 head_norm=2.025588 delta_norm=0.016413
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → trigger blocked (psi=0.987)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0295
[S13] DROPPED delta from S10 (cos=-0.0295 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S7
[S3] cosine check vs S7: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=-0.0295
[S10] DROPPED delta from S13 (cos=-0.0295 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=1.0000
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=72 metric=0.9542 head_norm=2.324305
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.137982e-02
[S4] stored merged vector for next round verification (round=72)
[S4] DEBUG after merge:  round=72 metric=0.9542 head_norm=2.320617 delta_norm=0.011380
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=72 metric=0.6848 head_norm=1.774270
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.626546e-02
[S3] stored merged vector for next round verification (round=72)
[S3] DEBUG after merge:  round=72 metric=0.6855 head_norm=1.771854 delta_norm=0.016265
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=72 metric=0.7172 head_norm=1.788856
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.703571e-02
[S5] stored merged vector for next round verification (round=72)
[S5] DEBUG after merge:  round=72 metric=0.7008 head_norm=1.792592 delta_norm=0.097036
[S5] aggregate: ROLLBACK (f1_val pre=0.717 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=72 metric=0.9970 head_norm=2.316979
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.137982e-02
[S11] stored merged vector for next round verification (round=72)
[S11] DEBUG after merge:  round=72 metric=0.9970 head_norm=2.320617 delta_norm=0.011380
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=1.826896 cos_to_last_merge=0.9822 (last merge round=39)
[S2] round=73 local utility u=0.072295 metrics={'f1_val': 0.7123953528006798, 'auprc': 0.908515779379578, 'loss_val': 0.6486228697381857, 'psi': 0.7908435234322391}-{'f1_val': 0.7148751890817252, 'auprc': 0.8764971867858367, 'loss_val': 0.7120365834197004, 'psi': 0.7795239881633698}
[S2] not sending this round → trigger blocked (psi=0.791)
[S3] START round=73 head_norm_before_train=1.771854 cos_to_last_merge=1.0000 (last merge round=72)
[S3] round=73 local utility u=1.000000 metrics={'f1_val': 0.9440915877800597, 'auprc': 0.9788149762298567, 'loss_val': 0.17473320197853692, 'psi': 0.9579809431599785}-{'f1_val': 0.6848441354498803, 'auprc': 0.8896501704225774, 'loss_val': 1.002637355766683, 'psi': 0.7667665494389592}
[S4] START round=73 head_norm_before_train=2.320617 cos_to_last_merge=1.0000 (last merge round=72)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9461653583515759, 'auprc': 0.9814727984316565, 'loss_val': 0.2681158601341219, 'psi': 0.9602883343836082}-{'f1_val': 0.9541550704810987, 'auprc': 0.9821616544037131, 'loss_val': 0.30354496255960883, 'psi': 0.9653577040501444}
[S5] START round=73 head_norm_before_train=1.792592 cos_to_last_merge=1.0000 (last merge round=72)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.6701210360027623, 'auprc': 0.9460753724374777, 'loss_val': 0.36292481012136996, 'psi': 0.7805027705766485}-{'f1_val': 0.7171949223484589, 'auprc': 0.9503304679463106, 'loss_val': 0.3673382157655054, 'psi': 0.8104491405875995}
[S6] START round=73 head_norm_before_train=2.025588 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=73 local utility u=0.245196 metrics={'f1_val': 0.6783225549854012, 'auprc': 0.8470852654431228, 'loss_val': 1.030992592209566, 'psi': 0.7458276391684898}-{'f1_val': 0.59583144622034, 'auprc': 0.9307407446795589, 'loss_val': 1.2774050572064675, 'psi': 0.7297951656040276}
[S7] START round=73 head_norm_before_train=1.769584 cos_to_last_merge=0.9999 (last merge round=70)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6386294707424087, 'auprc': 0.8028905373966562, 'loss_val': 0.5587238241490561, 'psi': 0.7043338974041077}-{'f1_val': 0.6576822922932901, 'auprc': 0.8050054792934378, 'loss_val': 0.5309683781491072, 'psi': 0.7166115670933493}
[S8] START round=73 head_norm_before_train=2.027595 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=73 local utility u=0.056954 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9992811085028851, 'loss_val': 0.03223749173702676, 'psi': 0.9958007602425285}-{'f1_val': 0.9824244394955325, 'auprc': 0.9931890763372102, 'loss_val': 0.061533535710953303, 'psi': 0.9867302942322036}
[S9] START round=73 head_norm_before_train=1.977134 cos_to_last_merge=0.9877 (last merge round=34)
[S9] round=73 local utility u=0.029507 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9981866505763575, 'loss_val': 0.020662761148095666, 'psi': 0.9968870814168553}-{'f1_val': 0.9897262816474692, 'auprc': 0.9981838194842549, 'loss_val': 0.04190200518754541, 'psi': 0.9931092967821835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=73 head_norm_before_train=2.392424 (no previous merge yet)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961391693752492, 'loss_val': 0.025157629857395322, 'psi': 0.9956495400883378}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962675497596827, 'loss_val': 0.02458028882251827, 'psi': 0.9957008922421113}
[S11] START round=73 head_norm_before_train=2.320617 cos_to_last_merge=1.0000 (last merge round=72)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.99888379035285, 'loss_val': 0.01631145150811257, 'psi': 0.9977320701168864}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992627457989148, 'loss_val': 0.01598713209544082, 'psi': 0.9978836522953123}
[S13] START round=73 head_norm_before_train=2.085542 (no previous merge yet)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6084530948285471, 'auprc': 0.6506568488751929, 'loss_val': 1.4198940481134514, 'psi': 0.6253345964472055}-{'f1_val': 0.710060288996281, 'auprc': 0.7155674567112237, 'loss_val': 1.2563759244908015, 'psi': 0.7122631560822581}
[S14] START round=73 head_norm_before_train=1.775811 cos_to_last_merge=0.9486 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=73 local utility u=0.000865 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9982283579055076, 'loss_val': 0.02277359940903329, 'psi': 0.9975773146000826}-{'f1_val': 0.9967325241656609, 'auprc': 0.9982633714533735, 'loss_val': 0.022143833599289824, 'psi': 0.997344863080746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=73 head_norm_before_train=1.785867 cos_to_last_merge=1.0000 (last merge round=72)
[S15] round=73 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982214883800199, 'loss_val': 0.02520908736396777, 'psi': 0.9973365963845203}-{'f1_val': 0.7021207024995553, 'auprc': 0.9773398616490073, 'loss_val': 0.5036522678668055, 'psi': 0.8122083661593361}
[S16] START round=73 head_norm_before_train=1.807776 cos_to_last_merge=0.9975 (last merge round=55)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9908719334180285, 'auprc': 0.9910876425816879, 'loss_val': 0.043899422166879754, 'psi': 0.9909582170834923}-{'f1_val': 0.9914575406613149, 'auprc': 0.9923535294222294, 'loss_val': 0.042611001439238655, 'psi': 0.9918159361656806}
[S17] START round=73 head_norm_before_train=2.207076 cos_to_last_merge=0.7572 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=73 local utility u=0.209656 metrics={'f1_val': 0.7460307450897034, 'auprc': 0.9753026955157874, 'loss_val': 0.6636753549544406, 'psi': 0.837739525260137}-{'f1_val': 0.702749578922318, 'auprc': 0.9484852666288511, 'loss_val': 0.7428477262615595, 'psi': 0.8010438540049314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9961
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=73 metric=0.6701 head_norm=1.799043
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.911915e-02
[S5] stored merged vector for next round verification (round=73)
[S5] DEBUG after merge:  round=73 metric=0.6721 head_norm=1.798691 delta_norm=0.079119
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:49307
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:49308
[S3] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S3
[S7] cosine check vs S3: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=73 metric=0.9935 head_norm=2.033762
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.064896e-02
[S8] stored merged vector for next round verification (round=73)
[S8] DEBUG after merge:  round=73 metric=0.9935 head_norm=2.034445 delta_norm=0.010649
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=73 metric=0.6386 head_norm=1.772135
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.261074e-02
[S7] stored merged vector for next round verification (round=73)
[S7] DEBUG after merge:  round=73 metric=0.6381 head_norm=1.776645 delta_norm=0.012611
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S5
[S8]  timeout peer S9
[S16]  timeout peer S14
[S3]  timeout peer S2
[S2] START round=74 head_norm_before_train=1.835809 cos_to_last_merge=0.9816 (last merge round=39)
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7160862463038786, 'auprc': 0.8400459533750682, 'loss_val': 0.7816608146957669, 'psi': 0.7656701291323544}-{'f1_val': 0.7123953528006798, 'auprc': 0.908515779379578, 'loss_val': 0.6486228697381857, 'psi': 0.7908435234322391}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=1.781232 cos_to_last_merge=1.0000 (last merge round=72)
[S3] round=74 local utility u=0.266829 metrics={'f1_val': 0.9969839020385951, 'auprc': 0.9999367014964312, 'loss_val': 0.021793540558589043, 'psi': 0.9981650218217295}-{'f1_val': 0.9440915877800597, 'auprc': 0.9788149762298567, 'loss_val': 0.17473320197853692, 'psi': 0.9579809431599785}
[S4] START round=74 head_norm_before_train=2.328296 cos_to_last_merge=1.0000 (last merge round=72)
[S4] round=74 local utility u=0.027344 metrics={'f1_val': 0.9541602474062331, 'auprc': 0.9859607117064595, 'loss_val': 0.27486046099985995, 'psi': 0.9668804331263237}-{'f1_val': 0.9461653583515759, 'auprc': 0.9814727984316565, 'loss_val': 0.2681158601341219, 'psi': 0.9602883343836082}
[S5] START round=74 head_norm_before_train=1.798691 cos_to_last_merge=1.0000 (last merge round=73)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.6893479588428622, 'auprc': 0.8944279208187629, 'loss_val': 0.5387794846631055, 'psi': 0.7713799436332225}-{'f1_val': 0.6701210360027623, 'auprc': 0.9460753724374777, 'loss_val': 0.36292481012136996, 'psi': 0.7805027705766485}
[S6] START round=74 head_norm_before_train=2.035184 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.6103922559891256, 'auprc': 0.8086656988266244, 'loss_val': 1.1484399783785264, 'psi': 0.6897016331241251}-{'f1_val': 0.6783225549854012, 'auprc': 0.8470852654431228, 'loss_val': 1.030992592209566, 'psi': 0.7458276391684898}
[S7] START round=74 head_norm_before_train=1.776645 cos_to_last_merge=1.0000 (last merge round=73)
[S7] round=74 local utility u=0.061927 metrics={'f1_val': 0.6439484932782382, 'auprc': 0.8066333853833785, 'loss_val': 0.47801260629697984, 'psi': 0.7090224501202943}-{'f1_val': 0.6386294707424087, 'auprc': 0.8028905373966562, 'loss_val': 0.5587238241490561, 'psi': 0.7043338974041077}
[S8] START round=74 head_norm_before_train=2.034445 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.8828810173834658, 'auprc': 0.9955907867610977, 'loss_val': 0.32140760877147045, 'psi': 0.9279649251345186}-{'f1_val': 0.9934805280689575, 'auprc': 0.9992811085028851, 'loss_val': 0.03223749173702676, 'psi': 0.9958007602425285}
[S9] START round=74 head_norm_before_train=1.980925 cos_to_last_merge=0.9876 (last merge round=34)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9953978773673271, 'loss_val': 0.01979990383977463, 'psi': 0.9960244494538568}-{'f1_val': 0.9960207019771873, 'auprc': 0.9981866505763575, 'loss_val': 0.020662761148095666, 'psi': 0.9968870814168553}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.391706 (no previous merge yet)
[S10] round=74 local utility u=0.000719 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962574099911197, 'loss_val': 0.024073847724969406, 'psi': 0.9956968363346861}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961391693752492, 'loss_val': 0.025157629857395322, 'psi': 0.9956495400883378}
[S11] START round=74 head_norm_before_train=2.326948 cos_to_last_merge=1.0000 (last merge round=72)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9990160960164336, 'loss_val': 0.01701705468746369, 'psi': 0.9976398901554826}-{'f1_val': 0.9969642566262439, 'auprc': 0.99888379035285, 'loss_val': 0.01631145150811257, 'psi': 0.9977320701168864}
[S13] START round=74 head_norm_before_train=2.089021 (no previous merge yet)
[S13] round=74 local utility u=0.342450 metrics={'f1_val': 0.6713011805201061, 'auprc': 0.7087872260269888, 'loss_val': 1.2864734112411325, 'psi': 0.6862955987228592}-{'f1_val': 0.6084530948285471, 'auprc': 0.6506568488751929, 'loss_val': 1.4198940481134514, 'psi': 0.6253345964472055}
[S14] START round=74 head_norm_before_train=1.779952 cos_to_last_merge=0.9482 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=74 local utility u=0.000509 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9983368314674381, 'loss_val': 0.02208097256091416, 'psi': 0.9976207040248548}-{'f1_val': 0.9971432857297993, 'auprc': 0.9982283579055076, 'loss_val': 0.02277359940903329, 'psi': 0.9975773146000826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=74 head_norm_before_train=1.801816 cos_to_last_merge=1.0000 (last merge round=72)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.8983839729122098, 'auprc': 0.9798781164683297, 'loss_val': 0.2137984339194529, 'psi': 0.9309816303346579}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982214883800199, 'loss_val': 0.02520908736396777, 'psi': 0.9973365963845203}
[S16] START round=74 head_norm_before_train=1.814123 cos_to_last_merge=0.9973 (last merge round=55)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9756121843870014, 'auprc': 0.9814397734490985, 'loss_val': 0.0946553092448989, 'psi': 0.9779432200118403}-{'f1_val': 0.9908719334180285, 'auprc': 0.9910876425816879, 'loss_val': 0.043899422166879754, 'psi': 0.9909582170834923}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.218279 cos_to_last_merge=0.7568 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=74 local utility u=0.396965 metrics={'f1_val': 0.8506453684294298, 'auprc': 0.9719317900653537, 'loss_val': 0.48732108259926044, 'psi': 0.8991599370837994}-{'f1_val': 0.7460307450897034, 'auprc': 0.9753026955157874, 'loss_val': 0.6636753549544406, 'psi': 0.837739525260137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=74 metric=0.6104 head_norm=2.040451
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.708946e-02
[S6] stored merged vector for next round verification (round=74)
[S6] DEBUG after merge:  round=74 metric=0.6129 head_norm=2.037037 delta_norm=0.017089
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0302
[S10] DROPPED delta from S13 (cos=-0.0302 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0302
[S13] DROPPED delta from S10 (cos=-0.0302 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9999
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=74 metric=0.9970 head_norm=1.790984
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.262740e-02
[S3] stored merged vector for next round verification (round=74)
[S3] DEBUG after merge:  round=74 metric=0.9966 head_norm=1.785944 delta_norm=0.012627
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=1.844129 cos_to_last_merge=0.9812 (last merge round=39)
[S2] round=75 local utility u=0.005947 metrics={'f1_val': 0.7158557046195209, 'auprc': 0.8398545687444072, 'loss_val': 0.7678101494097133, 'psi': 0.7654552502694754}-{'f1_val': 0.7160862463038786, 'auprc': 0.8400459533750682, 'loss_val': 0.7816608146957669, 'psi': 0.7656701291323544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=75 head_norm_before_train=1.785944 cos_to_last_merge=1.0000 (last merge round=74)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9936445785345308, 'auprc': 0.9998945671285571, 'loss_val': 0.02706556324694482, 'psi': 0.9961445739721413}-{'f1_val': 0.9969839020385951, 'auprc': 0.9999367014964312, 'loss_val': 0.021793540558589043, 'psi': 0.9981650218217295}
[S4] START round=75 head_norm_before_train=2.335141 cos_to_last_merge=0.9999 (last merge round=72)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9534396002695371, 'auprc': 0.956448480693768, 'loss_val': 0.3089484023601081, 'psi': 0.9546431524392294}-{'f1_val': 0.9541602474062331, 'auprc': 0.9859607117064595, 'loss_val': 0.27486046099985995, 'psi': 0.9668804331263237}
[S5] START round=75 head_norm_before_train=1.805173 cos_to_last_merge=1.0000 (last merge round=73)
[S5] round=75 local utility u=0.436025 metrics={'f1_val': 0.754062191138659, 'auprc': 0.969636782471624, 'loss_val': 0.28064080852653284, 'psi': 0.840292027671845}-{'f1_val': 0.6893479588428622, 'auprc': 0.8944279208187629, 'loss_val': 0.5387794846631055, 'psi': 0.7713799436332225}
[S6] START round=75 head_norm_before_train=2.037037 cos_to_last_merge=1.0000 (last merge round=74)
[S6] round=75 local utility u=0.935905 metrics={'f1_val': 0.7774278981815751, 'auprc': 0.9242386534208331, 'loss_val': 0.6255636076947005, 'psi': 0.8361522002772783}-{'f1_val': 0.6103922559891256, 'auprc': 0.8086656988266244, 'loss_val': 1.1484399783785264, 'psi': 0.6897016331241251}
[S7] START round=75 head_norm_before_train=1.780978 cos_to_last_merge=1.0000 (last merge round=73)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6083239081335687, 'auprc': 0.7941836565865652, 'loss_val': 0.6371197698646166, 'psi': 0.6826678075147673}-{'f1_val': 0.6439484932782382, 'auprc': 0.8066333853833785, 'loss_val': 0.47801260629697984, 'psi': 0.7090224501202943}
[S8] START round=75 head_norm_before_train=2.040415 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=75 local utility u=0.481545 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9990058988431041, 'loss_val': 0.03215947410717116, 'psi': 0.9956906763786161}-{'f1_val': 0.8828810173834658, 'auprc': 0.9955907867610977, 'loss_val': 0.32140760877147045, 'psi': 0.9279649251345186}
[S9] START round=75 head_norm_before_train=1.984127 cos_to_last_merge=0.9875 (last merge round=34)
[S9] round=75 local utility u=0.006201 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9986486822273839, 'loss_val': 0.01961283472299392, 'psi': 0.9975710241463078}-{'f1_val': 0.99644216417821, 'auprc': 0.9953978773673271, 'loss_val': 0.01979990383977463, 'psi': 0.9960244494538568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=75 head_norm_before_train=2.397566 (no previous merge yet)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961212141985848, 'loss_val': 0.025180720834817014, 'psi': 0.9956423580176721}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962574099911197, 'loss_val': 0.024073847724969406, 'psi': 0.9956968363346861}
[S11] START round=75 head_norm_before_train=2.330344 cos_to_last_merge=1.0000 (last merge round=72)
[S11] round=75 local utility u=0.001170 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9990792447232618, 'loss_val': 0.016459779631867965, 'psi': 0.9978244087438342}-{'f1_val': 0.9967224195815153, 'auprc': 0.9990160960164336, 'loss_val': 0.01701705468746369, 'psi': 0.9976398901554826}
[S13] START round=75 head_norm_before_train=2.090134 (no previous merge yet)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6206236326677389, 'auprc': 0.6872676636941624, 'loss_val': 1.3065834554063793, 'psi': 0.6472812450783083}-{'f1_val': 0.6713011805201061, 'auprc': 0.7087872260269888, 'loss_val': 1.2864734112411325, 'psi': 0.6862955987228592}
[S14] START round=75 head_norm_before_train=1.784506 cos_to_last_merge=0.9477 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9579854956415055, 'auprc': 0.9978975099832247, 'loss_val': 0.060116115707707106, 'psi': 0.9739503013781932}-{'f1_val': 0.9971432857297993, 'auprc': 0.9983368314674381, 'loss_val': 0.02208097256091416, 'psi': 0.9976207040248548}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=1.819423 cos_to_last_merge=0.9998 (last merge round=72)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.7695059484128184, 'auprc': 0.9744017618602351, 'loss_val': 0.39849382906376635, 'psi': 0.851464273791785}-{'f1_val': 0.8983839729122098, 'auprc': 0.9798781164683297, 'loss_val': 0.2137984339194529, 'psi': 0.9309816303346579}
[S16] START round=75 head_norm_before_train=1.819643 cos_to_last_merge=0.9971 (last merge round=55)
[S16] round=75 local utility u=0.090760 metrics={'f1_val': 0.9912381159053756, 'auprc': 0.9934972202114543, 'loss_val': 0.043063345480480644, 'psi': 0.9921417576278071}-{'f1_val': 0.9756121843870014, 'auprc': 0.9814397734490985, 'loss_val': 0.0946553092448989, 'psi': 0.9779432200118403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=75 head_norm_before_train=2.226335 cos_to_last_merge=0.7562 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=75 local utility u=0.033126 metrics={'f1_val': 0.8738752473039393, 'auprc': 0.8870947926849911, 'loss_val': 0.3059378985245127, 'psi': 0.87916306545636}-{'f1_val': 0.8506453684294298, 'auprc': 0.9719317900653537, 'loss_val': 0.48732108259926044, 'psi': 0.8991599370837994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] ⇄ pheromone p=0.006 → S11@127.0.0.1:49312
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] ⇄ pheromone p=0.113 → S10@127.0.0.1:49311
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=75 metric=0.6083 head_norm=1.788790
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.861122e-02
[S7] stored merged vector for next round verification (round=75)
[S7] DEBUG after merge:  round=75 metric=0.6083 head_norm=1.789791 delta_norm=0.018611
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.142 → S3@127.0.0.1:49303
[S3] ⇄ pheromone p=0.267 → S7@127.0.0.1:49308
[S15] ⇄ pheromone p=0.187 → S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=75 metric=0.9970 head_norm=2.333353
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.674881e-02
[S11] stored merged vector for next round verification (round=75)
[S11] DEBUG after merge:  round=75 metric=0.9970 head_norm=2.334187 delta_norm=0.016749
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.001 → S4@127.0.0.1:49304
[S8] ⇄ pheromone p=0.130 → S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9984
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=1.0000
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=75 metric=0.7774 head_norm=2.049396
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.023698e-02
[S6] stored merged vector for next round verification (round=75)
[S6] DEBUG after merge:  round=75 metric=0.7767 head_norm=2.046719 delta_norm=0.010237
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.378 → S8@127.0.0.1:49309
[S5] ⇄ pheromone p=0.214 → S15@127.0.0.1:49315
[S2] START round=76 head_norm_before_train=1.843125 cos_to_last_merge=0.9806 (last merge round=39)
[S2] round=76 local utility u=0.112831 metrics={'f1_val': 0.7128605781378385, 'auprc': 0.8849863476436037, 'loss_val': 0.659571975137258, 'psi': 0.7817108859401446}-{'f1_val': 0.7158557046195209, 'auprc': 0.8398545687444072, 'loss_val': 0.7678101494097133, 'psi': 0.7654552502694754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=76 head_norm_before_train=1.795419 cos_to_last_merge=1.0000 (last merge round=74)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8938421147342925, 'auprc': 0.958940132010228, 'loss_val': 0.305176199069865, 'psi': 0.9198813216446667}-{'f1_val': 0.9936445785345308, 'auprc': 0.9998945671285571, 'loss_val': 0.02706556324694482, 'psi': 0.9961445739721413}
[S4] START round=76 head_norm_before_train=2.330129 cos_to_last_merge=0.9999 (last merge round=72)
[S4] round=76 local utility u=0.019047 metrics={'f1_val': 0.939647646536879, 'auprc': 0.980810842595591, 'loss_val': 0.2611891571212566, 'psi': 0.9561129249603638}-{'f1_val': 0.9534396002695371, 'auprc': 0.956448480693768, 'loss_val': 0.3089484023601081, 'psi': 0.9546431524392294}
[S5] START round=76 head_norm_before_train=1.813731 cos_to_last_merge=0.9999 (last merge round=73)
[S5] round=76 local utility u=0.021087 metrics={'f1_val': 0.7672578730709508, 'auprc': 0.9652951957654943, 'loss_val': 0.3046152179307723, 'psi': 0.8464728021487682}-{'f1_val': 0.754062191138659, 'auprc': 0.969636782471624, 'loss_val': 0.28064080852653284, 'psi': 0.840292027671845}
[S6] START round=76 head_norm_before_train=2.046719 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7212705774590982, 'auprc': 0.9012161996194838, 'loss_val': 0.8135115550253034, 'psi': 0.7932488263232524}-{'f1_val': 0.7774278981815751, 'auprc': 0.9242386534208331, 'loss_val': 0.6255636076947005, 'psi': 0.8361522002772783}
[S7] START round=76 head_norm_before_train=1.789791 cos_to_last_merge=1.0000 (last merge round=75)
[S7] round=76 local utility u=0.388312 metrics={'f1_val': 0.6683833004287416, 'auprc': 0.8355684519300128, 'loss_val': 0.34500642574709134, 'psi': 0.7352573610292501}-{'f1_val': 0.6083239081335687, 'auprc': 0.7941836565865652, 'loss_val': 0.6371197698646166, 'psi': 0.6826678075147673}
[S8] START round=76 head_norm_before_train=2.044090 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9994490030572427, 'loss_val': 0.04724641983877578, 'psi': 0.9924898086706188}-{'f1_val': 0.9934805280689575, 'auprc': 0.9990058988431041, 'loss_val': 0.03215947410717116, 'psi': 0.9956906763786161}
[S9] START round=76 head_norm_before_train=1.988242 cos_to_last_merge=0.9873 (last merge round=34)
[S9] round=76 local utility u=0.001032 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986301658816613, 'loss_val': 0.018995316893648237, 'psi': 0.9977138138599502}-{'f1_val': 0.9968525854255906, 'auprc': 0.9986486822273839, 'loss_val': 0.01961283472299392, 'psi': 0.9975710241463078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=76 head_norm_before_train=2.404729 (no previous merge yet)
[S10] round=76 local utility u=0.000629 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963064509916608, 'loss_val': 0.02447805418505743, 'psi': 0.9957164527349025}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961212141985848, 'loss_val': 0.025180720834817014, 'psi': 0.9956423580176721}
[S11] START round=76 head_norm_before_train=2.334187 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9012545428437844, 'auprc': 0.9989293478975617, 'loss_val': 0.3483172924455056, 'psi': 0.9403244648652953}-{'f1_val': 0.9969878514242156, 'auprc': 0.9990792447232618, 'loss_val': 0.016459779631867965, 'psi': 0.9978244087438342}
[S13] START round=76 head_norm_before_train=2.095841 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.631621201332934, 'auprc': 0.6874255606420387, 'loss_val': 1.3936983599113224, 'psi': 0.6539429450565759}-{'f1_val': 0.6206236326677389, 'auprc': 0.6872676636941624, 'loss_val': 1.3065834554063793, 'psi': 0.6472812450783083}
[S14] START round=76 head_norm_before_train=1.790477 cos_to_last_merge=0.9472 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9440456960161101, 'auprc': 0.998270576284174, 'loss_val': 0.07788334199493947, 'psi': 0.9657356481233357}-{'f1_val': 0.9579854956415055, 'auprc': 0.9978975099832247, 'loss_val': 0.060116115707707106, 'psi': 0.9739503013781932}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.832793 cos_to_last_merge=0.9996 (last merge round=72)
[S15] round=76 local utility u=0.886578 metrics={'f1_val': 0.9929362098134823, 'auprc': 0.9985061550361951, 'loss_val': 0.038231716007979276, 'psi': 0.9951641879025674}-{'f1_val': 0.7695059484128184, 'auprc': 0.9744017618602351, 'loss_val': 0.39849382906376635, 'psi': 0.851464273791785}
[S16] START round=76 head_norm_before_train=1.825329 cos_to_last_merge=0.9969 (last merge round=55)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.8745566706398487, 'auprc': 0.9790565984812456, 'loss_val': 0.3882411450567253, 'psi': 0.9163566417764075}-{'f1_val': 0.9912381159053756, 'auprc': 0.9934972202114543, 'loss_val': 0.043063345480480644, 'psi': 0.9921417576278071}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.230631 cos_to_last_merge=0.7557 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6409049691765268, 'auprc': 0.9862607838612163, 'loss_val': 1.1376403341156518, 'psi': 0.7790472950504026}-{'f1_val': 0.8738752473039393, 'auprc': 0.8870947926849911, 'loss_val': 0.3059378985245127, 'psi': 0.87916306545636}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:49313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=76 metric=0.9879 head_norm=2.049434
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.099093e-02
[S8] stored merged vector for next round verification (round=76)
[S8] DEBUG after merge:  round=76 metric=0.9879 head_norm=2.049386 delta_norm=0.010991
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9981
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=-0.0295
[S13] DROPPED delta from S10 (cos=-0.0295 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=76 metric=0.9396 head_norm=2.333345
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.383918e-02
[S4] stored merged vector for next round verification (round=76)
[S4] DEBUG after merge:  round=76 metric=0.9397 head_norm=2.333227 delta_norm=0.023839
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=76 metric=0.9929 head_norm=1.845947
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.931521e-02
[S15] stored merged vector for next round verification (round=76)
[S15] DEBUG after merge:  round=76 metric=0.9932 head_norm=1.828948 delta_norm=0.059315
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9995
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=76 metric=0.7673 head_norm=1.821312
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.810973e-02
[S5] stored merged vector for next round verification (round=76)
[S5] DEBUG after merge:  round=76 metric=0.7583 head_norm=1.832750 delta_norm=0.058110
[S5] aggregate: ROLLBACK (f1_val pre=0.767 post=0.758 tol_abs=0.005 tol_rel=0.0)
[S2] START round=77 head_norm_before_train=1.848149 cos_to_last_merge=0.9802 (last merge round=39)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7156575832276204, 'auprc': 0.8268998818966246, 'loss_val': 0.7653081700002871, 'psi': 0.7601545026952221}-{'f1_val': 0.7128605781378385, 'auprc': 0.8849863476436037, 'loss_val': 0.659571975137258, 'psi': 0.7817108859401446}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=1.803624 cos_to_last_merge=1.0000 (last merge round=74)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.7531511396488675, 'auprc': 0.9204773779434088, 'loss_val': 0.7671966504863056, 'psi': 0.820081634966684}-{'f1_val': 0.8938421147342925, 'auprc': 0.958940132010228, 'loss_val': 0.305176199069865, 'psi': 0.9198813216446667}
[S4] START round=77 head_norm_before_train=2.333227 cos_to_last_merge=1.0000 (last merge round=76)
[S4] round=77 local utility u=0.014031 metrics={'f1_val': 0.9518790216839025, 'auprc': 0.9755370277123412, 'loss_val': 0.2906937710300429, 'psi': 0.9613422240952779}-{'f1_val': 0.939647646536879, 'auprc': 0.980810842595591, 'loss_val': 0.2611891571212566, 'psi': 0.9561129249603638}
[S5] START round=77 head_norm_before_train=1.832750 cos_to_last_merge=1.0000 (last merge round=76)
[S5] round=77 local utility u=0.841081 metrics={'f1_val': 0.9964353361434509, 'auprc': 0.9974266820855854, 'loss_val': 0.09391323474231272, 'psi': 0.9968318745203046}-{'f1_val': 0.7672578730709508, 'auprc': 0.9652951957654943, 'loss_val': 0.3046152179307723, 'psi': 0.8464728021487682}
[S6] START round=77 head_norm_before_train=2.058374 cos_to_last_merge=1.0000 (last merge round=75)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.5907624895806959, 'auprc': 0.6870104506181901, 'loss_val': 1.5143972465561828, 'psi': 0.6292616739956935}-{'f1_val': 0.7212705774590982, 'auprc': 0.9012161996194838, 'loss_val': 0.8135115550253034, 'psi': 0.7932488263232524}
[S7] START round=77 head_norm_before_train=1.797112 cos_to_last_merge=1.0000 (last merge round=75)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.4624818175472255, 'auprc': 0.7814600942336292, 'loss_val': 1.1798459267227428, 'psi': 0.590073128221787}-{'f1_val': 0.6683833004287416, 'auprc': 0.8355684519300128, 'loss_val': 0.34500642574709134, 'psi': 0.7352573610292501}
[S8] START round=77 head_norm_before_train=2.049386 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9797960432034141, 'auprc': 0.9994255621863402, 'loss_val': 0.06639314642495454, 'psi': 0.9876478507965845}-{'f1_val': 0.9878503457462027, 'auprc': 0.9994490030572427, 'loss_val': 0.04724641983877578, 'psi': 0.9924898086706188}
[S9] START round=77 head_norm_before_train=1.992657 cos_to_last_merge=0.9871 (last merge round=34)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982448966327077, 'loss_val': 0.019045041688116604, 'psi': 0.9972942657414179}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986301658816613, 'loss_val': 0.018995316893648237, 'psi': 0.9977138138599502}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.407805 (no previous merge yet)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962026929438118, 'loss_val': 0.02489639561585054, 'psi': 0.9956749495157629}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963064509916608, 'loss_val': 0.02447805418505743, 'psi': 0.9957164527349025}
[S11] START round=77 head_norm_before_train=2.338404 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=77 local utility u=0.450251 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990874723518239, 'loss_val': 0.01861657124573747, 'psi': 0.9974204397109507}-{'f1_val': 0.9012545428437844, 'auprc': 0.9989293478975617, 'loss_val': 0.3483172924455056, 'psi': 0.9403244648652953}
[S13] START round=77 head_norm_before_train=2.106915 (no previous merge yet)
[S13] round=77 local utility u=0.029281 metrics={'f1_val': 0.6312172964763245, 'auprc': 0.6798629159667854, 'loss_val': 1.310024238077303, 'psi': 0.650675544272509}-{'f1_val': 0.631621201332934, 'auprc': 0.6874255606420387, 'loss_val': 1.3936983599113224, 'psi': 0.6539429450565759}
[S14] START round=77 head_norm_before_train=1.797797 cos_to_last_merge=0.9466 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=77 local utility u=0.181345 metrics={'f1_val': 0.9961134279895458, 'auprc': 0.9983518547929162, 'loss_val': 0.027843543364187304, 'psi': 0.997008798710894}-{'f1_val': 0.9440456960161101, 'auprc': 0.998270576284174, 'loss_val': 0.07788334199493947, 'psi': 0.9657356481233357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=77 head_norm_before_train=1.828948 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.7711214050090349, 'auprc': 0.9159877159664518, 'loss_val': 0.44999658884813093, 'psi': 0.8290679293920017}-{'f1_val': 0.9929362098134823, 'auprc': 0.9985061550361951, 'loss_val': 0.038231716007979276, 'psi': 0.9951641879025674}
[S16] START round=77 head_norm_before_train=1.831609 cos_to_last_merge=0.9967 (last merge round=55)
[S16] round=77 local utility u=0.536065 metrics={'f1_val': 0.989673924886642, 'auprc': 0.9924832268729437, 'loss_val': 0.04709513612650926, 'psi': 0.9907976456811627}-{'f1_val': 0.8745566706398487, 'auprc': 0.9790565984812456, 'loss_val': 0.3882411450567253, 'psi': 0.9163566417764075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=77 head_norm_before_train=2.235025 cos_to_last_merge=0.7554 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=77 local utility u=1.000000 metrics={'f1_val': 0.9061120238212494, 'auprc': 0.9977756370240523, 'loss_val': 0.4216186207036726, 'psi': 0.9427774691023706}-{'f1_val': 0.6409049691765268, 'auprc': 0.9862607838612163, 'loss_val': 1.1376403341156518, 'psi': 0.7790472950504026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:49311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.997)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=77 metric=0.7711 head_norm=1.844389
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.794548e-02
[S15] stored merged vector for next round verification (round=77)
[S15] DEBUG after merge:  round=77 metric=0.7721 head_norm=1.832494 delta_norm=0.037945
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=77 metric=0.7532 head_norm=1.811630
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.692540e-02
[S3] stored merged vector for next round verification (round=77)
[S3] DEBUG after merge:  round=77 metric=0.7532 head_norm=1.804306 delta_norm=0.016925
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=-0.0292
[S10] DROPPED delta from S13 (cos=-0.0292 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=77 metric=0.9519 head_norm=2.338230
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.442162e-02
[S4] stored merged vector for next round verification (round=77)
[S4] DEBUG after merge:  round=77 metric=0.9513 head_norm=2.340069 delta_norm=0.014422
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=77 metric=0.9963 head_norm=2.341995
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.859029e-02
[S11] stored merged vector for next round verification (round=77)
[S11] DEBUG after merge:  round=77 metric=0.9963 head_norm=2.338805 delta_norm=0.018590
[S11] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=1.855255 cos_to_last_merge=0.9797 (last merge round=39)
[S2] round=78 local utility u=0.148496 metrics={'f1_val': 0.7107927074427177, 'auprc': 0.8775110764678014, 'loss_val': 0.5909600708260203, 'psi': 0.7774800550527512}-{'f1_val': 0.7156575832276204, 'auprc': 0.8268998818966246, 'loss_val': 0.7653081700002871, 'psi': 0.7601545026952221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=78 head_norm_before_train=1.804306 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=78 local utility u=1.000000 metrics={'f1_val': 0.9466551692547657, 'auprc': 0.9993015543077534, 'loss_val': 0.133339841249319, 'psi': 0.9677137232759607}-{'f1_val': 0.7531511396488675, 'auprc': 0.9204773779434088, 'loss_val': 0.7671966504863056, 'psi': 0.820081634966684}
[S4] START round=78 head_norm_before_train=2.340069 cos_to_last_merge=1.0000 (last merge round=77)
[S4] round=78 local utility u=0.002911 metrics={'f1_val': 0.9482990656610085, 'auprc': 0.9779176291672451, 'loss_val': 0.27053445452267544, 'psi': 0.9601464910635031}-{'f1_val': 0.9518790216839025, 'auprc': 0.9755370277123412, 'loss_val': 0.2906937710300429, 'psi': 0.9613422240952779}
[S5] START round=78 head_norm_before_train=1.837965 cos_to_last_merge=1.0000 (last merge round=76)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.6296295722842038, 'auprc': 0.9225900607784352, 'loss_val': 0.5423641624900927, 'psi': 0.7468137676818964}-{'f1_val': 0.9964353361434509, 'auprc': 0.9974266820855854, 'loss_val': 0.09391323474231272, 'psi': 0.9968318745203046}
[S6] START round=78 head_norm_before_train=2.067673 cos_to_last_merge=0.9999 (last merge round=75)
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.8652862418697536, 'auprc': 0.9258677576647144, 'loss_val': 0.3865042201459735, 'psi': 0.889518848187738}-{'f1_val': 0.5907624895806959, 'auprc': 0.6870104506181901, 'loss_val': 1.5143972465561828, 'psi': 0.6292616739956935}
[S7] START round=78 head_norm_before_train=1.803029 cos_to_last_merge=0.9999 (last merge round=75)
[S7] round=78 local utility u=0.925463 metrics={'f1_val': 0.6463918963027362, 'auprc': 0.8052094869421565, 'loss_val': 0.5036281609966995, 'psi': 0.7099189325585044}-{'f1_val': 0.4624818175472255, 'auprc': 0.7814600942336292, 'loss_val': 1.1798459267227428, 'psi': 0.590073128221787}
[S8] START round=78 head_norm_before_train=2.054037 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=78 local utility u=0.056345 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9993070094343346, 'loss_val': 0.03193356928560474, 'psi': 0.9954591272527031}-{'f1_val': 0.9797960432034141, 'auprc': 0.9994255621863402, 'loss_val': 0.06639314642495454, 'psi': 0.9876478507965845}
[S9] START round=78 head_norm_before_train=1.997284 cos_to_last_merge=0.9868 (last merge round=34)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9982577035106626, 'loss_val': 0.030113754049080798, 'psi': 0.9940556803284096}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982448966327077, 'loss_val': 0.019045041688116604, 'psi': 0.9972942657414179}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.414791 (no previous merge yet)
[S10] round=78 local utility u=0.000542 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963298377461415, 'loss_val': 0.024193789939114384, 'psi': 0.9957258074366948}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962026929438118, 'loss_val': 0.02489639561585054, 'psi': 0.9956749495157629}
[S11] START round=78 head_norm_before_train=2.338805 cos_to_last_merge=1.0000 (last merge round=77)
[S11] round=78 local utility u=0.001693 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990840850940217, 'loss_val': 0.016670928114061064, 'psi': 0.997564187034667}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990874723518239, 'loss_val': 0.01861657124573747, 'psi': 0.9974204397109507}
[S13] START round=78 head_norm_before_train=2.117561 (no previous merge yet)
[S13] round=78 local utility u=0.693850 metrics={'f1_val': 0.7306836269299879, 'auprc': 0.8692789560370263, 'loss_val': 1.0873700771679349, 'psi': 0.7861217585728033}-{'f1_val': 0.6312172964763245, 'auprc': 0.6798629159667854, 'loss_val': 1.310024238077303, 'psi': 0.650675544272509}
[S14] START round=78 head_norm_before_train=1.803853 cos_to_last_merge=0.9459 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9527771921396037, 'auprc': 0.9983653492330489, 'loss_val': 0.07074717167539235, 'psi': 0.9710124549769819}-{'f1_val': 0.9961134279895458, 'auprc': 0.9983518547929162, 'loss_val': 0.027843543364187304, 'psi': 0.997008798710894}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.832494 cos_to_last_merge=1.0000 (last merge round=77)
[S15] round=78 local utility u=0.503820 metrics={'f1_val': 0.8800740496265608, 'auprc': 0.9821202610561949, 'loss_val': 0.29447078872602306, 'psi': 0.9208925341984144}-{'f1_val': 0.7711214050090349, 'auprc': 0.9159877159664518, 'loss_val': 0.44999658884813093, 'psi': 0.8290679293920017}
[S16] START round=78 head_norm_before_train=1.838622 cos_to_last_merge=0.9965 (last merge round=55)
[S16] round=78 local utility u=0.000512 metrics={'f1_val': 0.9910187657145617, 'auprc': 0.9894469590419895, 'loss_val': 0.045031566472395326, 'psi': 0.9903900430455329}-{'f1_val': 0.989673924886642, 'auprc': 0.9924832268729437, 'loss_val': 0.04709513612650926, 'psi': 0.9907976456811627}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=78 head_norm_before_train=2.243451 cos_to_last_merge=0.7552 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.8805782222297781, 'auprc': 0.9985701812005053, 'loss_val': 0.4347485328077739, 'psi': 0.927775005818069}-{'f1_val': 0.9061120238212494, 'auprc': 0.9977756370240523, 'loss_val': 0.4216186207036726, 'psi': 0.9427774691023706}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:49303
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → trigger blocked (psi=0.786)
[S4] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:49308
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0288
[S13] DROPPED delta from S10 (cos=-0.0288 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1805) from S3
[S7] cosine check vs S3: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1806) from S7
[S3] cosine check vs S7: cos=0.9998
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=78 metric=0.9467 head_norm=1.810229
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.662554e-02
[S3] stored merged vector for next round verification (round=78)
[S3] DEBUG after merge:  round=78 metric=0.9467 head_norm=1.808935 delta_norm=0.016626
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=78 metric=0.9929 head_norm=2.058722
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.795477e-02
[S8] stored merged vector for next round verification (round=78)
[S8] DEBUG after merge:  round=78 metric=0.9929 head_norm=2.066073 delta_norm=0.017955
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=78 metric=0.8653 head_norm=2.073554
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.795478e-02
[S6] stored merged vector for next round verification (round=78)
[S6] DEBUG after merge:  round=78 metric=0.8653 head_norm=2.066073 delta_norm=0.017955
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=78 metric=0.6296 head_norm=1.840732
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.321287e-02
[S5] stored merged vector for next round verification (round=78)
[S5] DEBUG after merge:  round=78 metric=0.6294 head_norm=1.845406 delta_norm=0.013213
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=78 metric=0.6464 head_norm=1.807794
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.662554e-02
[S7] stored merged vector for next round verification (round=78)
[S7] DEBUG after merge:  round=78 metric=0.6448 head_norm=1.808935 delta_norm=0.016626
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=1.864117 cos_to_last_merge=0.9790 (last merge round=39)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.6899750400050606, 'auprc': 0.8019770411113045, 'loss_val': 0.6515388781776948, 'psi': 0.7347758404475582}-{'f1_val': 0.7107927074427177, 'auprc': 0.8775110764678014, 'loss_val': 0.5909600708260203, 'psi': 0.7774800550527512}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.735 u=0.0000 p_local=0.0820 f1=0.690 auprc=0.802 bytes=68471
[S3] START round=79 head_norm_before_train=1.808935 cos_to_last_merge=1.0000 (last merge round=78)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.8764785045156249, 'auprc': 0.9970384925953715, 'loss_val': 0.30835168895599874, 'psi': 0.9247024997475235}-{'f1_val': 0.9466551692547657, 'auprc': 0.9993015543077534, 'loss_val': 0.133339841249319, 'psi': 0.9677137232759607}
[S4] START round=79 head_norm_before_train=2.345019 cos_to_last_merge=1.0000 (last merge round=77)
[S4] round=79 local utility u=0.008534 metrics={'f1_val': 0.9483067306625459, 'auprc': 0.9818832673666468, 'loss_val': 0.2654085974143243, 'psi': 0.9617373453441862}-{'f1_val': 0.9482990656610085, 'auprc': 0.9779176291672451, 'loss_val': 0.27053445452267544, 'psi': 0.9601464910635031}
[S5] START round=79 head_norm_before_train=1.845406 cos_to_last_merge=1.0000 (last merge round=78)
[S5] round=79 local utility u=0.964549 metrics={'f1_val': 0.8834886545687217, 'auprc': 0.9696272984701284, 'loss_val': 0.27753155779045435, 'psi': 0.9179441121292844}-{'f1_val': 0.6296295722842038, 'auprc': 0.9225900607784352, 'loss_val': 0.5423641624900927, 'psi': 0.7468137676818964}
[S6] START round=79 head_norm_before_train=2.066073 cos_to_last_merge=1.0000 (last merge round=78)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.6126459593318452, 'auprc': 0.8702068630470539, 'loss_val': 1.3586681336186766, 'psi': 0.7156703208179287}-{'f1_val': 0.8652862418697536, 'auprc': 0.9258677576647144, 'loss_val': 0.3865042201459735, 'psi': 0.889518848187738}
[S7] START round=79 head_norm_before_train=1.808935 cos_to_last_merge=1.0000 (last merge round=78)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6062862793901602, 'auprc': 0.7942449870516212, 'loss_val': 0.6915471296530434, 'psi': 0.6814697624547446}-{'f1_val': 0.6463918963027362, 'auprc': 0.8052094869421565, 'loss_val': 0.5036281609966995, 'psi': 0.7099189325585044}
[S8] START round=79 head_norm_before_train=2.066073 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=79 local utility u=0.002832 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9994796447172196, 'loss_val': 0.0311764509479945, 'psi': 0.9959670601555858}-{'f1_val': 0.9928938724649488, 'auprc': 0.9993070094343346, 'loss_val': 0.03193356928560474, 'psi': 0.9954591272527031}
[S9] START round=79 head_norm_before_train=2.001922 cos_to_last_merge=0.9865 (last merge round=34)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9982367014708273, 'loss_val': 0.04804114111538217, 'psi': 0.9921118852644922}-{'f1_val': 0.991254331540241, 'auprc': 0.9982577035106626, 'loss_val': 0.030113754049080798, 'psi': 0.9940556803284096}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.992 u=0.0000 p_local=0.0035 f1=0.988 auprc=0.998 bytes=64839
[S10] START round=79 head_norm_before_train=2.422948 (no previous merge yet)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962004936155116, 'loss_val': 0.024909739332599462, 'psi': 0.9956740697844428}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963298377461415, 'loss_val': 0.024193789939114384, 'psi': 0.9957258074366948}
[S11] START round=79 head_norm_before_train=2.343016 cos_to_last_merge=1.0000 (last merge round=77)
[S11] round=79 local utility u=0.000042 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990970105675303, 'loss_val': 0.016625039740074222, 'psi': 0.9975693572240705}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990840850940217, 'loss_val': 0.016670928114061064, 'psi': 0.997564187034667}
[S13] START round=79 head_norm_before_train=2.124286 (no previous merge yet)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.7433432668896324, 'auprc': 0.8017742685175693, 'loss_val': 1.003768328653356, 'psi': 0.7667156675408071}-{'f1_val': 0.7306836269299879, 'auprc': 0.8692789560370263, 'loss_val': 1.0873700771679349, 'psi': 0.7861217585728033}
[S14] START round=79 head_norm_before_train=1.808824 cos_to_last_merge=0.9454 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9395769043394536, 'auprc': 0.9977731505794847, 'loss_val': 0.10828888034161598, 'psi': 0.9628554028354661}-{'f1_val': 0.9527771921396037, 'auprc': 0.9983653492330489, 'loss_val': 0.07074717167539235, 'psi': 0.9710124549769819}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.963 u=0.0000 p_local=0.0251 f1=0.940 auprc=0.998 bytes=64798
[S15] START round=79 head_norm_before_train=1.850161 cos_to_last_merge=0.9999 (last merge round=77)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.8711931896271677, 'auprc': 0.980761088902797, 'loss_val': 0.3187206118402918, 'psi': 0.9150203493374195}-{'f1_val': 0.8800740496265608, 'auprc': 0.9821202610561949, 'loss_val': 0.29447078872602306, 'psi': 0.9208925341984144}
[S16] START round=79 head_norm_before_train=1.844474 cos_to_last_merge=0.9963 (last merge round=55)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.9881980410252849, 'auprc': 0.980227853825144, 'loss_val': 0.06349845556947108, 'psi': 0.9850099661452285}-{'f1_val': 0.9910187657145617, 'auprc': 0.9894469590419895, 'loss_val': 0.045031566472395326, 'psi': 0.9903900430455329}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.985 u=0.0000 p_local=0.1080 f1=0.988 auprc=0.980 bytes=66588
[S17] START round=79 head_norm_before_train=2.250768 cos_to_last_merge=0.7550 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.8518831477530453, 'auprc': 0.9976175129596272, 'loss_val': 0.5643394896487172, 'psi': 0.910176893835678}-{'f1_val': 0.8805782222297781, 'auprc': 0.9985701812005053, 'loss_val': 0.4347485328077739, 'psi': 0.927775005818069}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.910 u=0.0000 p_local=0.1934 f1=0.852 auprc=0.998 bytes=68332
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] r=80 psi=0.716 u=0.0000 p_local=0.3149 f1=0.613 auprc=0.870 bytes=68379
[S3] r=80 psi=0.925 u=0.0000 p_local=0.2692 f1=0.876 auprc=0.997 bytes=66605
[S13] r=80 psi=0.767 u=0.0000 p_local=0.1612 f1=0.743 auprc=0.802 bytes=59375
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9999
[S8] r=80 psi=0.996 u=0.0028 p_local=0.0628 f1=0.994 auprc=0.999 bytes=70095
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=79 metric=0.9966 head_norm=2.347812
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.805297e-02
[S11] stored merged vector for next round verification (round=79)
[S11] DEBUG after merge:  round=79 metric=0.9966 head_norm=2.350310 delta_norm=0.018053
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=80 psi=0.998 u=0.0000 p_local=0.0583 f1=0.997 auprc=0.999 bytes=77310
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=79 metric=0.9483 head_norm=2.352944
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.805296e-02
[S4] stored merged vector for next round verification (round=79)
[S4] DEBUG after merge:  round=79 metric=0.9484 head_norm=2.350310 delta_norm=0.018053
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=80 psi=0.962 u=0.0085 p_local=0.0085 f1=0.948 auprc=0.982 bytes=70084
[S7] r=80 psi=0.681 u=0.0000 p_local=0.2461 f1=0.606 auprc=0.794 bytes=66649
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.915 u=0.0000 p_local=0.2481 f1=0.871 auprc=0.981 bytes=64865
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] r=80 psi=0.918 u=0.9645 p_local=0.3904 f1=0.883 auprc=0.970 bytes=66648
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.996 bytes=71965
[S2] START round=80 head_norm_before_train=1.870697 cos_to_last_merge=0.9782 (last merge round=39)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.6853775127986678, 'auprc': 0.7953461343859567, 'loss_val': 0.667521474272914, 'psi': 0.7293649614335833}-{'f1_val': 0.6899750400050606, 'auprc': 0.8019770411113045, 'loss_val': 0.6515388781776948, 'psi': 0.7347758404475582}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=1.814809 cos_to_last_merge=1.0000 (last merge round=78)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8037574042199628, 'auprc': 0.9634279209631925, 'loss_val': 0.55486773633129, 'psi': 0.8676256109172547}-{'f1_val': 0.8764785045156249, 'auprc': 0.9970384925953715, 'loss_val': 0.30835168895599874, 'psi': 0.9247024997475235}
[S4] START round=80 head_norm_before_train=2.350310 cos_to_last_merge=1.0000 (last merge round=79)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.952551581022083, 'auprc': 0.9661775025734312, 'loss_val': 0.2901386506246614, 'psi': 0.9580019496426223}-{'f1_val': 0.9483067306625459, 'auprc': 0.9818832673666468, 'loss_val': 0.2654085974143243, 'psi': 0.9617373453441862}
[S5] START round=80 head_norm_before_train=1.848780 cos_to_last_merge=1.0000 (last merge round=78)
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9883039360829118, 'loss_val': 0.29277345917619274, 'psi': 0.815669725151569}-{'f1_val': 0.8834886545687217, 'auprc': 0.9696272984701284, 'loss_val': 0.27753155779045435, 'psi': 0.9179441121292844}
[S6] START round=80 head_norm_before_train=2.076449 cos_to_last_merge=1.0000 (last merge round=78)
[S6] round=80 local utility u=0.806286 metrics={'f1_val': 0.757572642676662, 'auprc': 0.9318259840315573, 'loss_val': 0.8005128301622974, 'psi': 0.8272739792186201}-{'f1_val': 0.6126459593318452, 'auprc': 0.8702068630470539, 'loss_val': 1.3586681336186766, 'psi': 0.7156703208179287}
[S7] START round=80 head_norm_before_train=1.812941 cos_to_last_merge=1.0000 (last merge round=78)
[S7] round=80 local utility u=0.174730 metrics={'f1_val': 0.625557716851264, 'auprc': 0.8044415421525822, 'loss_val': 0.4883059094274204, 'psi': 0.6971112469717913}-{'f1_val': 0.6062862793901602, 'auprc': 0.7942449870516212, 'loss_val': 0.6915471296530434, 'psi': 0.6814697624547446}
[S8] START round=80 head_norm_before_train=2.069509 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=80 local utility u=0.000101 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9994235355040375, 'loss_val': 0.03080630253748377, 'psi': 0.995944616470313}-{'f1_val': 0.9936253371144965, 'auprc': 0.9994796447172196, 'loss_val': 0.0311764509479945, 'psi': 0.9959670601555858}
[S9] START round=80 head_norm_before_train=2.006804 cos_to_last_merge=0.9862 (last merge round=34)
[S9] round=80 local utility u=0.028534 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9982482566931232, 'loss_val': 0.025289322222619856, 'psi': 0.9955446076710743}-{'f1_val': 0.9880286744602689, 'auprc': 0.9982367014708273, 'loss_val': 0.04804114111538217, 'psi': 0.9921118852644922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=80 head_norm_before_train=2.431000 (no previous merge yet)
[S10] round=80 local utility u=0.000096 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962436158038555, 'loss_val': 0.024846999828702962, 'psi': 0.9956913186597804}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962004936155116, 'loss_val': 0.024909739332599462, 'psi': 0.9956740697844428}
[S11] START round=80 head_norm_before_train=2.350310 cos_to_last_merge=1.0000 (last merge round=79)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991018904235699, 'loss_val': 0.01729165052320764, 'psi': 0.9975713091664863}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990970105675303, 'loss_val': 0.016625039740074222, 'psi': 0.9975693572240705}
[S13] START round=80 head_norm_before_train=2.126046 (no previous merge yet)
[S13] round=80 local utility u=0.061856 metrics={'f1_val': 0.743585843753346, 'auprc': 0.8114194765863721, 'loss_val': 0.9104466313418039, 'psi': 0.7707192968865565}-{'f1_val': 0.7433432668896324, 'auprc': 0.8017742685175693, 'loss_val': 1.003768328653356, 'psi': 0.7667156675408071}
[S14] START round=80 head_norm_before_train=1.814127 cos_to_last_merge=0.9449 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=80 local utility u=0.216245 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9982706696094763, 'loss_val': 0.02280579846565817, 'psi': 0.9976057997730008}-{'f1_val': 0.9395769043394536, 'auprc': 0.9977731505794847, 'loss_val': 0.10828888034161598, 'psi': 0.9628554028354661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=80 head_norm_before_train=1.868047 cos_to_last_merge=0.9998 (last merge round=77)
[S15] round=80 local utility u=0.142367 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.995884369398211, 'loss_val': 0.2575789693631263, 'psi': 0.9388918242428783}-{'f1_val': 0.8711931896271677, 'auprc': 0.980761088902797, 'loss_val': 0.3187206118402918, 'psi': 0.9150203493374195}
[S16] START round=80 head_norm_before_train=1.849704 cos_to_last_merge=0.9961 (last merge round=55)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9394485414168153, 'auprc': 0.9736185872576439, 'loss_val': 0.31736059041454895, 'psi': 0.9531165597531468}-{'f1_val': 0.9881980410252849, 'auprc': 0.980227853825144, 'loss_val': 0.06349845556947108, 'psi': 0.9850099661452285}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.254597 cos_to_last_merge=0.7545 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=80 local utility u=0.132037 metrics={'f1_val': 0.8735866409743417, 'auprc': 0.989230486864701, 'loss_val': 0.40532483820379445, 'psi': 0.9198441793304855}-{'f1_val': 0.8518831477530453, 'auprc': 0.9976175129596272, 'loss_val': 0.5643394896487172, 'psi': 0.910176893835678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:49303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.007 → S11@127.0.0.1:49312
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.215 → S7@127.0.0.1:49308
[S3] RECEIVED delta(kind=head bytes=1806) from S7
[S3] cosine check vs S7: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9997
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=80 metric=0.7576 head_norm=2.085407
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.348472e-02
[S6] stored merged vector for next round verification (round=80)
[S6] DEBUG after merge:  round=80 metric=0.7576 head_norm=2.077430 delta_norm=0.013485
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.413 → S8@127.0.0.1:49309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=80 metric=0.9009 head_norm=1.886170
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.697929e-02
[S15] stored merged vector for next round verification (round=80)
[S15] DEBUG after merge:  round=80 metric=0.9009 head_norm=1.867373 delta_norm=0.026979
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.227 → S5@127.0.0.1:49305
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] ⇄ pheromone p=0.232 → S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49313
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0282
[S10] DROPPED delta from S13 (cos=-0.0282 < 0.0)
[S13] ⇄ pheromone p=0.141 → S10@127.0.0.1:49311
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] cosine check vs S10: cos=-0.0282
[S13] DROPPED delta from S10 (cos=-0.0282 < 0.0)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=80 metric=0.9936 head_norm=2.077183
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.255282e-02
[S8] stored merged vector for next round verification (round=80)
[S8] DEBUG after merge:  round=80 metric=0.9936 head_norm=2.081261 delta_norm=0.012553
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.050 → S6@127.0.0.1:49307
[S11] ⇄ pheromone p=0.047 → S4@127.0.0.1:49304
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=80 metric=0.7006 head_norm=1.854129
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.698108e-02
[S5] stored merged vector for next round verification (round=80)
[S5] DEBUG after merge:  round=80 metric=0.7006 head_norm=1.870023 delta_norm=0.026981
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.312 → S15@127.0.0.1:49315
[S2] START round=81 head_norm_before_train=1.874625 cos_to_last_merge=0.9780 (last merge round=39)
[S2] round=81 local utility u=0.243461 metrics={'f1_val': 0.7113454761040221, 'auprc': 0.8923925944713329, 'loss_val': 0.6275462100249602, 'psi': 0.7837643234509464}-{'f1_val': 0.6853775127986678, 'auprc': 0.7953461343859567, 'loss_val': 0.667521474272914, 'psi': 0.7293649614335833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=81 head_norm_before_train=1.822030 cos_to_last_merge=1.0000 (last merge round=78)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.7117164764446386, 'auprc': 0.9314680844481764, 'loss_val': 0.8633530480881589, 'psi': 0.7996171196460538}-{'f1_val': 0.8037574042199628, 'auprc': 0.9634279209631925, 'loss_val': 0.55486773633129, 'psi': 0.8676256109172547}
[S4] START round=81 head_norm_before_train=2.351147 cos_to_last_merge=1.0000 (last merge round=79)
[S4] round=81 local utility u=0.022412 metrics={'f1_val': 0.945570654176027, 'auprc': 0.9839644567088012, 'loss_val': 0.2567909142908517, 'psi': 0.9609281751891368}-{'f1_val': 0.952551581022083, 'auprc': 0.9661775025734312, 'loss_val': 0.2901386506246614, 'psi': 0.9580019496426223}
[S5] START round=81 head_norm_before_train=1.870023 cos_to_last_merge=1.0000 (last merge round=80)
[S5] round=81 local utility u=0.365900 metrics={'f1_val': 0.8247093048113455, 'auprc': 0.972413066675617, 'loss_val': 0.25807557933419384, 'psi': 0.8837908095570541}-{'f1_val': 0.7005802511973405, 'auprc': 0.9883039360829118, 'loss_val': 0.29277345917619274, 'psi': 0.815669725151569}
[S6] START round=81 head_norm_before_train=2.077430 cos_to_last_merge=1.0000 (last merge round=80)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.644664694211595, 'auprc': 0.8893802741169672, 'loss_val': 0.9939928561150978, 'psi': 0.7425509261737439}-{'f1_val': 0.757572642676662, 'auprc': 0.9318259840315573, 'loss_val': 0.8005128301622974, 'psi': 0.8272739792186201}
[S7] START round=81 head_norm_before_train=1.817439 cos_to_last_merge=0.9999 (last merge round=78)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.5969865765174382, 'auprc': 0.7927844270020903, 'loss_val': 0.6705871040866523, 'psi': 0.675305716711299}-{'f1_val': 0.625557716851264, 'auprc': 0.8044415421525822, 'loss_val': 0.4883059094274204, 'psi': 0.6971112469717913}
[S8] START round=81 head_norm_before_train=2.081261 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9676603585262462, 'auprc': 0.9932574930352649, 'loss_val': 0.10547607591041215, 'psi': 0.9778992123298537}-{'f1_val': 0.9936253371144965, 'auprc': 0.9994235355040375, 'loss_val': 0.03080630253748377, 'psi': 0.995944616470313}
[S9] START round=81 head_norm_before_train=2.009957 cos_to_last_merge=0.9861 (last merge round=34)
[S9] round=81 local utility u=0.011716 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982362431909203, 'loss_val': 0.01933226348132377, 'psi': 0.997290804364703}-{'f1_val': 0.9937421749897083, 'auprc': 0.9982482566931232, 'loss_val': 0.025289322222619856, 'psi': 0.9955446076710743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=81 head_norm_before_train=2.435865 (no previous merge yet)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962380348276216, 'loss_val': 0.0248416009683779, 'psi': 0.9956890862692869}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962436158038555, 'loss_val': 0.024846999828702962, 'psi': 0.9956913186597804}
[S11] START round=81 head_norm_before_train=2.355476 cos_to_last_merge=1.0000 (last merge round=79)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9837155752320474, 'auprc': 0.9991177052937943, 'loss_val': 0.06000337813453213, 'psi': 0.9898764272567462}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991018904235699, 'loss_val': 0.01729165052320764, 'psi': 0.9975713091664863}
[S13] START round=81 head_norm_before_train=2.133381 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.628066495839934, 'auprc': 0.6759017249503607, 'loss_val': 1.4483679130893128, 'psi': 0.6472005874841047}-{'f1_val': 0.743585843753346, 'auprc': 0.8114194765863721, 'loss_val': 0.9104466313418039, 'psi': 0.7707192968865565}
[S14] START round=81 head_norm_before_train=1.820678 cos_to_last_merge=0.9443 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=81 local utility u=0.000577 metrics={'f1_val': 0.9969452255660185, 'auprc': 0.9983794920426594, 'loss_val': 0.02067362636931681, 'psi': 0.9975189321566749}-{'f1_val': 0.9971625532153504, 'auprc': 0.9982706696094763, 'loss_val': 0.02280579846565817, 'psi': 0.9976057997730008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=81 head_norm_before_train=1.867373 cos_to_last_merge=1.0000 (last merge round=80)
[S15] round=81 local utility u=0.034525 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.9963458354883455, 'loss_val': 0.2069746454072086, 'psi': 0.9407824849625401}-{'f1_val': 0.9008967941393231, 'auprc': 0.995884369398211, 'loss_val': 0.2575789693631263, 'psi': 0.9388918242428783}
[S16] START round=81 head_norm_before_train=1.854907 cos_to_last_merge=0.9959 (last merge round=55)
[S16] round=81 local utility u=0.322112 metrics={'f1_val': 0.9916770402665274, 'auprc': 0.9912214341218148, 'loss_val': 0.0393164287096545, 'psi': 0.9914947978086424}-{'f1_val': 0.9394485414168153, 'auprc': 0.9736185872576439, 'loss_val': 0.31736059041454895, 'psi': 0.9531165597531468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=81 head_norm_before_train=2.262983 cos_to_last_merge=0.7541 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.8667656469458469, 'auprc': 0.9982590274575324, 'loss_val': 0.5193270464663681, 'psi': 0.919362999150521}-{'f1_val': 0.8735866409743417, 'auprc': 0.989230486864701, 'loss_val': 0.40532483820379445, 'psi': 0.9198441793304855}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=81 metric=0.7117 head_norm=1.830182
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.623311e-02
[S3] stored merged vector for next round verification (round=81)
[S3] DEBUG after merge:  round=81 metric=0.7117 head_norm=1.823750 delta_norm=0.016233
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=81 metric=0.6447 head_norm=2.088567
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.261687e-02
[S6] stored merged vector for next round verification (round=81)
[S6] DEBUG after merge:  round=81 metric=0.6446 head_norm=2.082844 delta_norm=0.012617
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9999
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=81 metric=0.8247 head_norm=1.875071
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.147004e-02
[S5] stored merged vector for next round verification (round=81)
[S5] DEBUG after merge:  round=81 metric=0.8204 head_norm=1.880000 delta_norm=0.011470
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=1.882067 cos_to_last_merge=0.9779 (last merge round=39)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.7170766748237172, 'auprc': 0.7851300645461672, 'loss_val': 0.8245061038647109, 'psi': 0.7442980307126972}-{'f1_val': 0.7113454761040221, 'auprc': 0.8923925944713329, 'loss_val': 0.6275462100249602, 'psi': 0.7837643234509464}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=1.823750 cos_to_last_merge=1.0000 (last merge round=81)
[S3] round=82 local utility u=1.000000 metrics={'f1_val': 0.9975573226023611, 'auprc': 0.9999000064499854, 'loss_val': 0.019457220371578564, 'psi': 0.9984943961414108}-{'f1_val': 0.7117164764446386, 'auprc': 0.9314680844481764, 'loss_val': 0.8633530480881589, 'psi': 0.7996171196460538}
[S4] START round=82 head_norm_before_train=2.356667 cos_to_last_merge=1.0000 (last merge round=79)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9522047551429612, 'auprc': 0.9680006022352899, 'loss_val': 0.29570419590012725, 'psi': 0.9585230939798927}-{'f1_val': 0.945570654176027, 'auprc': 0.9839644567088012, 'loss_val': 0.2567909142908517, 'psi': 0.9609281751891368}
[S5] START round=82 head_norm_before_train=1.880000 cos_to_last_merge=1.0000 (last merge round=81)
[S5] round=82 local utility u=0.638298 metrics={'f1_val': 0.9963644980511829, 'auprc': 0.9935824947637033, 'loss_val': 0.0749187385117545, 'psi': 0.9952516967361911}-{'f1_val': 0.8247093048113455, 'auprc': 0.972413066675617, 'loss_val': 0.25807557933419384, 'psi': 0.8837908095570541}
[S6] START round=82 head_norm_before_train=2.082844 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=82 local utility u=0.807289 metrics={'f1_val': 0.8149938143478801, 'auprc': 0.9363056140514332, 'loss_val': 0.5421652056721296, 'psi': 0.8635185342293012}-{'f1_val': 0.644664694211595, 'auprc': 0.8893802741169672, 'loss_val': 0.9939928561150978, 'psi': 0.7425509261737439}
[S7] START round=82 head_norm_before_train=1.823353 cos_to_last_merge=0.9998 (last merge round=78)
[S7] round=82 local utility u=0.315082 metrics={'f1_val': 0.6647335474469862, 'auprc': 0.8090754588048255, 'loss_val': 0.49577771432884593, 'psi': 0.7224703119901219}-{'f1_val': 0.5969865765174382, 'auprc': 0.7927844270020903, 'loss_val': 0.6705871040866523, 'psi': 0.675305716711299}
[S8] START round=82 head_norm_before_train=2.090257 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=82 local utility u=0.093427 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9993881584663928, 'loss_val': 0.04747802174620403, 'psi': 0.9913978872958995}-{'f1_val': 0.9676603585262462, 'auprc': 0.9932574930352649, 'loss_val': 0.10547607591041215, 'psi': 0.9778992123298537}
[S9] START round=82 head_norm_before_train=2.012129 cos_to_last_merge=0.9861 (last merge round=34)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964004398979387, 'loss_val': 0.019519229599894036, 'psi': 0.9965564830475103}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982362431909203, 'loss_val': 0.01933226348132377, 'psi': 0.997290804364703}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.438300 (no previous merge yet)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961723570157508, 'loss_val': 0.024860051829151922, 'psi': 0.9956628151445386}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962380348276216, 'loss_val': 0.0248416009683779, 'psi': 0.9956890862692869}
[S11] START round=82 head_norm_before_train=2.360906 cos_to_last_merge=1.0000 (last merge round=79)
[S11] round=82 local utility u=0.061524 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989537131519743, 'loss_val': 0.01595516832026631, 'psi': 0.997760039236536}-{'f1_val': 0.9837155752320474, 'auprc': 0.9991177052937943, 'loss_val': 0.06000337813453213, 'psi': 0.9898764272567462}
[S13] START round=82 head_norm_before_train=2.140562 (no previous merge yet)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6102610409298747, 'auprc': 0.6669658253010717, 'loss_val': 1.400210198542442, 'psi': 0.6329429546783535}-{'f1_val': 0.628066495839934, 'auprc': 0.6759017249503607, 'loss_val': 1.4483679130893128, 'psi': 0.6472005874841047}
[S14] START round=82 head_norm_before_train=1.826919 cos_to_last_merge=0.9438 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=82 local utility u=0.001032 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9982648784506631, 'loss_val': 0.019586214315179554, 'psi': 0.9976051271789204}-{'f1_val': 0.9969452255660185, 'auprc': 0.9983794920426594, 'loss_val': 0.02067362636931681, 'psi': 0.9975189321566749}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=82 head_norm_before_train=1.884986 cos_to_last_merge=1.0000 (last merge round=80)
[S15] round=82 local utility u=0.028246 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9967382131026274, 'loss_val': 0.17876234306574956, 'psi': 0.9436497518422478}-{'f1_val': 0.9037402512786699, 'auprc': 0.9963458354883455, 'loss_val': 0.2069746454072086, 'psi': 0.9407824849625401}
[S16] START round=82 head_norm_before_train=1.860437 cos_to_last_merge=0.9957 (last merge round=55)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.6869104037905305, 'auprc': 0.9782326081285687, 'loss_val': 1.1853130338392388, 'psi': 0.8034392855257457}-{'f1_val': 0.9916770402665274, 'auprc': 0.9912214341218148, 'loss_val': 0.0393164287096545, 'psi': 0.9914947978086424}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.272791 cos_to_last_merge=0.7540 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=82 local utility u=0.128312 metrics={'f1_val': 0.8886883205214148, 'auprc': 0.9921240564759697, 'loss_val': 0.3758336355112535, 'psi': 0.9300626149032367}-{'f1_val': 0.8667656469458469, 'auprc': 0.9982590274575324, 'loss_val': 0.5193270464663681, 'psi': 0.919362999150521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49307
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.944)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] → sending delta(kind=head bytes=1809) to S7@127.0.0.1:49308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.995)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=82 metric=0.9083 head_norm=1.901551
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.161130e-02
[S15] stored merged vector for next round verification (round=82)
[S15] DEBUG after merge:  round=82 metric=0.9083 head_norm=1.888234 delta_norm=0.021611
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1809 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1791) from S8
[S6] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=1.0000
[S7] RECEIVED delta(kind=head bytes=1809) from S3
[S7] cosine check vs S3: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=82 metric=0.8150 head_norm=2.094063
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.051405e-02
[S6] stored merged vector for next round verification (round=82)
[S6] DEBUG after merge:  round=82 metric=0.8153 head_norm=2.095251 delta_norm=0.010514
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=82 metric=0.9861 head_norm=2.096492
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.051405e-02
[S8] stored merged vector for next round verification (round=82)
[S8] DEBUG after merge:  round=82 metric=0.9861 head_norm=2.095251 delta_norm=0.010514
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=82 metric=0.9970 head_norm=2.365625
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.435805e-02
[S11] stored merged vector for next round verification (round=82)
[S11] DEBUG after merge:  round=82 metric=0.9970 head_norm=2.361107 delta_norm=0.014358
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49303
[S7] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=82 metric=0.6647 head_norm=1.830433
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.410162e-02
[S7] stored merged vector for next round verification (round=82)
[S7] DEBUG after merge:  round=82 metric=0.6648 head_norm=1.831336 delta_norm=0.014102
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=82 metric=0.9522 head_norm=2.362100
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.160149e-02
[S4] stored merged vector for next round verification (round=82)
[S4] DEBUG after merge:  round=82 metric=0.9522 head_norm=2.363765 delta_norm=0.021601
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=1.887151 cos_to_last_merge=0.9777 (last merge round=39)
[S2] round=83 local utility u=0.129199 metrics={'f1_val': 0.7129204694872203, 'auprc': 0.8344766898989165, 'loss_val': 0.6892111942242614, 'psi': 0.7615429576518988}-{'f1_val': 0.7170766748237172, 'auprc': 0.7851300645461672, 'loss_val': 0.8245061038647109, 'psi': 0.7442980307126972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=83 head_norm_before_train=1.832347 cos_to_last_merge=1.0000 (last merge round=81)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.9932252906909314, 'auprc': 0.9998718577887369, 'loss_val': 0.02514717869235415, 'psi': 0.9958839175300536}-{'f1_val': 0.9975573226023611, 'auprc': 0.9999000064499854, 'loss_val': 0.019457220371578564, 'psi': 0.9984943961414108}
[S4] START round=83 head_norm_before_train=2.363765 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=83 local utility u=0.046150 metrics={'f1_val': 0.954168180495768, 'auprc': 0.9861473666548303, 'loss_val': 0.26962426847640125, 'psi': 0.966959854959393}-{'f1_val': 0.9522047551429612, 'auprc': 0.9680006022352899, 'loss_val': 0.29570419590012725, 'psi': 0.9585230939798927}
[S5] START round=83 head_norm_before_train=1.887190 cos_to_last_merge=1.0000 (last merge round=81)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9801624994856781, 'auprc': 0.9933282967101957, 'loss_val': 0.10133754186460385, 'psi': 0.9854288183754852}-{'f1_val': 0.9963644980511829, 'auprc': 0.9935824947637033, 'loss_val': 0.0749187385117545, 'psi': 0.9952516967361911}
[S6] START round=83 head_norm_before_train=2.095251 cos_to_last_merge=1.0000 (last merge round=82)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.618646181927437, 'auprc': 0.8929168815974862, 'loss_val': 1.0176644229719933, 'psi': 0.7283544617954567}-{'f1_val': 0.8149938143478801, 'auprc': 0.9363056140514332, 'loss_val': 0.5421652056721296, 'psi': 0.8635185342293012}
[S7] START round=83 head_norm_before_train=1.831336 cos_to_last_merge=1.0000 (last merge round=82)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.5963313381335263, 'auprc': 0.7877599309664277, 'loss_val': 0.8718846725020244, 'psi': 0.672902775266687}-{'f1_val': 0.6647335474469862, 'auprc': 0.8090754588048255, 'loss_val': 0.49577771432884593, 'psi': 0.7224703119901219}
[S8] START round=83 head_norm_before_train=2.095251 cos_to_last_merge=1.0000 (last merge round=82)
[S8] round=83 local utility u=0.021678 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9957553168993996, 'loss_val': 0.033691880952175936, 'psi': 0.9939916709524615}-{'f1_val': 0.9860710398489039, 'auprc': 0.9993881584663928, 'loss_val': 0.04747802174620403, 'psi': 0.9913978872958995}
[S9] START round=83 head_norm_before_train=2.014609 cos_to_last_merge=0.9861 (last merge round=34)
[S9] round=83 local utility u=0.001682 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984416945055958, 'loss_val': 0.019792384659125948, 'psi': 0.9971243467817699}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964004398979387, 'loss_val': 0.019519229599894036, 'psi': 0.9965564830475103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=83 head_norm_before_train=2.441250 (no previous merge yet)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962066329246076, 'loss_val': 0.02500746363725834, 'psi': 0.9956765255080813}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961723570157508, 'loss_val': 0.024860051829151922, 'psi': 0.9956628151445386}
[S11] START round=83 head_norm_before_train=2.361107 cos_to_last_merge=1.0000 (last merge round=82)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988674951148049, 'loss_val': 0.01570179264722425, 'psi': 0.9977255520216682}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989537131519743, 'loss_val': 0.01595516832026631, 'psi': 0.997760039236536}
[S13] START round=83 head_norm_before_train=2.143055 (no previous merge yet)
[S13] round=83 local utility u=0.486203 metrics={'f1_val': 0.6319061009332382, 'auprc': 0.962011400991025, 'loss_val': 1.4428111107088395, 'psi': 0.763948220956353}-{'f1_val': 0.6102610409298747, 'auprc': 0.6669658253010717, 'loss_val': 1.400210198542442, 'psi': 0.6329429546783535}
[S14] START round=83 head_norm_before_train=1.831245 cos_to_last_merge=0.9435 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9981348072821815, 'loss_val': 0.019760263796522893, 'psi': 0.9975547335711892}-{'f1_val': 0.9971652929977585, 'auprc': 0.9982648784506631, 'loss_val': 0.019586214315179554, 'psi': 0.9976051271789204}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=1.888234 cos_to_last_merge=1.0000 (last merge round=82)
[S15] round=83 local utility u=0.011793 metrics={'f1_val': 0.9104876945584951, 'auprc': 0.9967860432938784, 'loss_val': 0.16870101705614993, 'psi': 0.9450070340526484}-{'f1_val': 0.9082574443353278, 'auprc': 0.9967382131026274, 'loss_val': 0.17876234306574956, 'psi': 0.9436497518422478}
[S16] START round=83 head_norm_before_train=1.864649 cos_to_last_merge=0.9955 (last merge round=55)
[S16] round=83 local utility u=0.404560 metrics={'f1_val': 0.8530894454353171, 'auprc': 0.8575150659950682, 'loss_val': 1.011114490129245, 'psi': 0.8548596936592174}-{'f1_val': 0.6869104037905305, 'auprc': 0.9782326081285687, 'loss_val': 1.1853130338392388, 'psi': 0.8034392855257457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=83 head_norm_before_train=2.278100 cos_to_last_merge=0.7533 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=83 local utility u=0.067223 metrics={'f1_val': 0.9039907695321815, 'auprc': 0.9835705808681852, 'loss_val': 0.3075414468827636, 'psi': 0.9358226940665829}-{'f1_val': 0.8886883205214148, 'auprc': 0.9921240564759697, 'loss_val': 0.3758336355112535, 'psi': 0.9300626149032367}
[S17] not sending this round → trigger blocked (psi=0.936)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=83 metric=0.9932 head_norm=1.840662
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.718823e-02
[S3] stored merged vector for next round verification (round=83)
[S3] DEBUG after merge:  round=83 metric=0.9932 head_norm=1.835474 delta_norm=0.017188
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0285
[S10] DROPPED delta from S13 (cos=-0.0285 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=1.0000
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=83 metric=0.9802 head_norm=1.893907
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.637741e-02
[S5] stored merged vector for next round verification (round=83)
[S5] DEBUG after merge:  round=83 metric=0.9802 head_norm=1.898867 delta_norm=0.016377
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=1.888853 cos_to_last_merge=0.9769 (last merge round=39)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7156842428421664, 'auprc': 0.7807957995918213, 'loss_val': 0.8036341186577692, 'psi': 0.7417288655420283}-{'f1_val': 0.7129204694872203, 'auprc': 0.8344766898989165, 'loss_val': 0.6892111942242614, 'psi': 0.7615429576518988}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=1.835474 cos_to_last_merge=1.0000 (last merge round=83)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9957648123266789, 'loss_val': 0.13347034305992478, 'psi': 0.974975079271363}-{'f1_val': 0.9932252906909314, 'auprc': 0.9998718577887369, 'loss_val': 0.02514717869235415, 'psi': 0.9958839175300536}
[S4] START round=84 head_norm_before_train=2.370501 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9532934375057103, 'auprc': 0.9802681524986133, 'loss_val': 0.2956915943015646, 'psi': 0.9640833235028715}-{'f1_val': 0.954168180495768, 'auprc': 0.9861473666548303, 'loss_val': 0.26962426847640125, 'psi': 0.966959854959393}
[S5] START round=84 head_norm_before_train=1.898867 cos_to_last_merge=1.0000 (last merge round=83)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.9647779645461455, 'auprc': 0.9895235847838123, 'loss_val': 0.12977669180223983, 'psi': 0.9746762126412123}-{'f1_val': 0.9801624994856781, 'auprc': 0.9933282967101957, 'loss_val': 0.10133754186460385, 'psi': 0.9854288183754852}
[S6] START round=84 head_norm_before_train=2.103523 cos_to_last_merge=0.9999 (last merge round=82)
[S6] round=84 local utility u=1.000000 metrics={'f1_val': 0.8611433060047734, 'auprc': 0.9498551224903781, 'loss_val': 0.4149551493502085, 'psi': 0.8966280325990152}-{'f1_val': 0.618646181927437, 'auprc': 0.8929168815974862, 'loss_val': 1.0176644229719933, 'psi': 0.7283544617954567}
[S7] START round=84 head_norm_before_train=1.837061 cos_to_last_merge=1.0000 (last merge round=82)
[S7] round=84 local utility u=0.105877 metrics={'f1_val': 0.6099038124328967, 'auprc': 0.7939535635636263, 'loss_val': 0.7601472426678096, 'psi': 0.6835237128851885}-{'f1_val': 0.5963313381335263, 'auprc': 0.7877599309664277, 'loss_val': 0.8718846725020244, 'psi': 0.672902775266687}
[S8] START round=84 head_norm_before_train=2.101070 cos_to_last_merge=1.0000 (last merge round=82)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9993028003496018, 'loss_val': 0.035818730995484986, 'psi': 0.993939091697494}-{'f1_val': 0.9928159069878363, 'auprc': 0.9957553168993996, 'loss_val': 0.033691880952175936, 'psi': 0.9939916709524615}
[S9] START round=84 head_norm_before_train=2.017035 cos_to_last_merge=0.9859 (last merge round=34)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9984259518182819, 'loss_val': 0.041705919357005274, 'psi': 0.9931874855444373}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984416945055958, 'loss_val': 0.019792384659125948, 'psi': 0.9971243467817699}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.441553 (no previous merge yet)
[S10] round=84 local utility u=0.000013 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961480595671836, 'loss_val': 0.02480555309842059, 'psi': 0.9956530961651116}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962066329246076, 'loss_val': 0.02500746363725834, 'psi': 0.9956765255080813}
[S11] START round=84 head_norm_before_train=2.365773 cos_to_last_merge=1.0000 (last merge round=82)
[S11] round=84 local utility u=0.000621 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992330572343672, 'loss_val': 0.015556312815509699, 'psi': 0.9978717768694931}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988674951148049, 'loss_val': 0.01570179264722425, 'psi': 0.9977255520216682}
[S13] START round=84 head_norm_before_train=2.148486 (no previous merge yet)
[S13] round=84 local utility u=0.385987 metrics={'f1_val': 0.7514122195936684, 'auprc': 0.8083590171282464, 'loss_val': 0.9269163054271087, 'psi': 0.7741909386074997}-{'f1_val': 0.6319061009332382, 'auprc': 0.962011400991025, 'loss_val': 1.4428111107088395, 'psi': 0.763948220956353}
[S14] START round=84 head_norm_before_train=1.836171 cos_to_last_merge=0.9430 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.995062261950327, 'auprc': 0.9978191261070839, 'loss_val': 0.029027750709673818, 'psi': 0.9961650076130297}-{'f1_val': 0.9971680177638609, 'auprc': 0.9981348072821815, 'loss_val': 0.019760263796522893, 'psi': 0.9975547335711892}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=1.903954 cos_to_last_merge=1.0000 (last merge round=82)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.996417196792649, 'loss_val': 0.21191600332558294, 'psi': 0.9408110294842615}-{'f1_val': 0.9104876945584951, 'auprc': 0.9967860432938784, 'loss_val': 0.16870101705614993, 'psi': 0.9450070340526484}
[S16] START round=84 head_norm_before_train=1.867403 cos_to_last_merge=0.9953 (last merge round=55)
[S16] round=84 local utility u=0.809406 metrics={'f1_val': 0.9394931620023632, 'auprc': 0.988053805403866, 'loss_val': 0.3023405274919977, 'psi': 0.9589174193629644}-{'f1_val': 0.8530894454353171, 'auprc': 0.8575150659950682, 'loss_val': 1.011114490129245, 'psi': 0.8548596936592174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=84 head_norm_before_train=2.280965 cos_to_last_merge=0.7530 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.7958489167875421, 'auprc': 0.9874024720190567, 'loss_val': 0.7913330144583595, 'psi': 0.872470338880148}-{'f1_val': 0.9039907695321815, 'auprc': 0.9835705808681852, 'loss_val': 0.3075414468827636, 'psi': 0.9358226940665829}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:49313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49304
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] → sending delta(kind=head bytes=1809) to S3@127.0.0.1:49303
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0281
[S10] DROPPED delta from S13 (cos=-0.0281 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1809) from S7
[S3] cosine check vs S7: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=-0.0281
[S13] DROPPED delta from S10 (cos=-0.0281 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=84 metric=0.9970 head_norm=2.370837
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.062984e-02
[S11] stored merged vector for next round verification (round=84)
[S11] DEBUG after merge:  round=84 metric=0.9970 head_norm=2.370645 delta_norm=0.010630
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=1.893292 cos_to_last_merge=0.9763 (last merge round=39)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7139852024393555, 'auprc': 0.7573528650818497, 'loss_val': 0.7651380918620603, 'psi': 0.7313322674963532}-{'f1_val': 0.7156842428421664, 'auprc': 0.7807957995918213, 'loss_val': 0.8036341186577692, 'psi': 0.7417288655420283}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=1.842713 cos_to_last_merge=1.0000 (last merge round=83)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.949325095333508, 'auprc': 0.9892694175367748, 'loss_val': 0.13419637735574266, 'psi': 0.9653028242148147}-{'f1_val': 0.9611152572344858, 'auprc': 0.9957648123266789, 'loss_val': 0.13347034305992478, 'psi': 0.974975079271363}
[S4] START round=85 head_norm_before_train=2.375036 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=85 local utility u=0.029641 metrics={'f1_val': 0.9542310382087057, 'auprc': 0.9868070433962058, 'loss_val': 0.2616526728626291, 'psi': 0.9672614402837058}-{'f1_val': 0.9532934375057103, 'auprc': 0.9802681524986133, 'loss_val': 0.2956915943015646, 'psi': 0.9640833235028715}
[S5] START round=85 head_norm_before_train=1.907469 cos_to_last_merge=1.0000 (last merge round=83)
[S5] round=85 local utility u=0.091327 metrics={'f1_val': 0.9853339336056078, 'auprc': 0.993630383767089, 'loss_val': 0.08277834261894523, 'psi': 0.9886525136702002}-{'f1_val': 0.9647779645461455, 'auprc': 0.9895235847838123, 'loss_val': 0.12977669180223983, 'psi': 0.9746762126412123}
[S6] START round=85 head_norm_before_train=2.114681 cos_to_last_merge=1.0000 (last merge round=82)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6151406836230334, 'auprc': 0.9237742031611368, 'loss_val': 1.2163315376593336, 'psi': 0.7385940914382747}-{'f1_val': 0.8611433060047734, 'auprc': 0.9498551224903781, 'loss_val': 0.4149551493502085, 'psi': 0.8966280325990152}
[S7] START round=85 head_norm_before_train=1.841997 cos_to_last_merge=0.9999 (last merge round=82)
[S7] round=85 local utility u=0.229650 metrics={'f1_val': 0.6350045191211946, 'auprc': 0.8056901722950602, 'loss_val': 0.48666225447314354, 'psi': 0.7032787803907409}-{'f1_val': 0.6099038124328967, 'auprc': 0.7939535635636263, 'loss_val': 0.7601472426678096, 'psi': 0.6835237128851885}
[S8] START round=85 head_norm_before_train=2.109772 cos_to_last_merge=1.0000 (last merge round=82)
[S8] round=85 local utility u=0.007070 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9966925940458568, 'loss_val': 0.032468795359641804, 'psi': 0.9947570999434662}-{'f1_val': 0.990363285929422, 'auprc': 0.9993028003496018, 'loss_val': 0.035818730995484986, 'psi': 0.993939091697494}
[S9] START round=85 head_norm_before_train=2.018376 cos_to_last_merge=0.9857 (last merge round=34)
[S9] round=85 local utility u=0.019414 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984376762240663, 'loss_val': 0.027195731886444516, 'psi': 0.9956203754834516}-{'f1_val': 0.9896951746952075, 'auprc': 0.9984259518182819, 'loss_val': 0.041705919357005274, 'psi': 0.9931874855444373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=85 head_norm_before_train=2.442846 (no previous merge yet)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960929853836837, 'loss_val': 0.025081485504713407, 'psi': 0.9956310664917116}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961480595671836, 'loss_val': 0.02480555309842059, 'psi': 0.9956530961651116}
[S11] START round=85 head_norm_before_train=2.370645 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9926465604644317, 'auprc': 0.9990110344436532, 'loss_val': 0.02293620798651808, 'psi': 0.9951923500561204}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992330572343672, 'loss_val': 0.015556312815509699, 'psi': 0.9978717768694931}
[S13] START round=85 head_norm_before_train=2.155555 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.7337346216163798, 'auprc': 0.8191146879287357, 'loss_val': 1.124508283078454, 'psi': 0.7678866481413222}-{'f1_val': 0.7514122195936684, 'auprc': 0.8083590171282464, 'loss_val': 0.9269163054271087, 'psi': 0.7741909386074997}
[S14] START round=85 head_norm_before_train=1.838561 cos_to_last_merge=0.9427 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.986619220918381, 'auprc': 0.9979146950021871, 'loss_val': 0.03265674574092165, 'psi': 0.9911374105519034}-{'f1_val': 0.995062261950327, 'auprc': 0.9978191261070839, 'loss_val': 0.029027750709673818, 'psi': 0.9961650076130297}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.918979 cos_to_last_merge=0.9999 (last merge round=82)
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.901471908377172, 'auprc': 0.9963414438653687, 'loss_val': 0.2398229752112975, 'psi': 0.9394197225724508}-{'f1_val': 0.9037402512786699, 'auprc': 0.996417196792649, 'loss_val': 0.21191600332558294, 'psi': 0.9408110294842615}
[S16] START round=85 head_norm_before_train=1.871660 cos_to_last_merge=0.9951 (last merge round=55)
[S16] round=85 local utility u=0.282907 metrics={'f1_val': 0.9891160209923816, 'auprc': 0.9924709066869173, 'loss_val': 0.04751406172159436, 'psi': 0.9904579752701959}-{'f1_val': 0.9394931620023632, 'auprc': 0.988053805403866, 'loss_val': 0.3023405274919977, 'psi': 0.9589174193629644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=85 head_norm_before_train=2.285627 cos_to_last_merge=0.7526 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=85 local utility u=0.368420 metrics={'f1_val': 0.8684918285344831, 'auprc': 0.9976661172399803, 'loss_val': 0.5211414379495022, 'psi': 0.920161544016682}-{'f1_val': 0.7958489167875421, 'auprc': 0.9874024720190567, 'loss_val': 0.7913330144583595, 'psi': 0.872470338880148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.703)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] ⇄ pheromone p=0.378 → S8@127.0.0.1:49309
[S15] ⇄ pheromone p=0.082 → S5@127.0.0.1:49305
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S7] ⇄ pheromone p=0.171 → S3@127.0.0.1:49303
[S13] ⇄ pheromone p=0.170 → S10@127.0.0.1:49311
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=85 metric=0.9493 head_norm=1.847795
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.375250e-02
[S3] stored merged vector for next round verification (round=85)
[S3] DEBUG after merge:  round=85 metric=0.9493 head_norm=1.844847 delta_norm=0.013752
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.173 → S7@127.0.0.1:49308
[S11] ⇄ pheromone p=0.022 → S4@127.0.0.1:49304
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=85 metric=0.9542 head_norm=2.378022
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.640132e-02
[S4] stored merged vector for next round verification (round=85)
[S4] DEBUG after merge:  round=85 metric=0.9542 head_norm=2.374375 delta_norm=0.016401
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.016 → S11@127.0.0.1:49312
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=85 metric=0.9935 head_norm=2.115480
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.374839e-02
[S8] stored merged vector for next round verification (round=85)
[S8] DEBUG after merge:  round=85 metric=0.9935 head_norm=2.115036 delta_norm=0.013748
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.030 → S6@127.0.0.1:49307
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9995
[S5] ⇄ pheromone p=0.216 → S15@127.0.0.1:49315
[S2] START round=86 head_norm_before_train=1.899557 cos_to_last_merge=0.9760 (last merge round=39)
[S2] round=86 local utility u=0.108692 metrics={'f1_val': 0.7117273629266605, 'auprc': 0.8111366398588392, 'loss_val': 0.6955578359375384, 'psi': 0.7514910736995319}-{'f1_val': 0.7139852024393555, 'auprc': 0.7573528650818497, 'loss_val': 0.7651380918620603, 'psi': 0.7313322674963532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=86 head_norm_before_train=1.844847 cos_to_last_merge=1.0000 (last merge round=85)
[S3] round=86 local utility u=0.001771 metrics={'f1_val': 0.9470289036584065, 'auprc': 0.9919221039648255, 'loss_val': 0.12483588361050377, 'psi': 0.9649861837809741}-{'f1_val': 0.949325095333508, 'auprc': 0.9892694175367748, 'loss_val': 0.13419637735574266, 'psi': 0.9653028242148147}
[S4] START round=86 head_norm_before_train=2.374375 cos_to_last_merge=1.0000 (last merge round=85)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9525590499902317, 'auprc': 0.9778671444412417, 'loss_val': 0.2752019546055933, 'psi': 0.9626822877706357}-{'f1_val': 0.9542310382087057, 'auprc': 0.9868070433962058, 'loss_val': 0.2616526728626291, 'psi': 0.9672614402837058}
[S5] START round=86 head_norm_before_train=1.914565 cos_to_last_merge=0.9998 (last merge round=83)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.8653162242618764, 'auprc': 0.9522598605870233, 'loss_val': 0.4253742808842614, 'psi': 0.9000936787919351}-{'f1_val': 0.9853339336056078, 'auprc': 0.993630383767089, 'loss_val': 0.08277834261894523, 'psi': 0.9886525136702002}
[S6] START round=86 head_norm_before_train=2.127278 cos_to_last_merge=0.9999 (last merge round=82)
[S6] round=86 local utility u=0.701735 metrics={'f1_val': 0.778040831909901, 'auprc': 0.8958109993525379, 'loss_val': 0.7063721539516697, 'psi': 0.8251488988869558}-{'f1_val': 0.6151406836230334, 'auprc': 0.9237742031611368, 'loss_val': 1.2163315376593336, 'psi': 0.7385940914382747}
[S7] START round=86 head_norm_before_train=1.847508 cos_to_last_merge=0.9999 (last merge round=82)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6089332474412501, 'auprc': 0.7946977192658418, 'loss_val': 0.6695047444004184, 'psi': 0.6832390361710867}-{'f1_val': 0.6350045191211946, 'auprc': 0.8056901722950602, 'loss_val': 0.48666225447314354, 'psi': 0.7032787803907409}
[S8] START round=86 head_norm_before_train=2.115036 cos_to_last_merge=1.0000 (last merge round=85)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9815282929982607, 'auprc': 0.9994182396886815, 'loss_val': 0.06117556196002875, 'psi': 0.9886842716744291}-{'f1_val': 0.9934667705418724, 'auprc': 0.9966925940458568, 'loss_val': 0.032468795359641804, 'psi': 0.9947570999434662}
[S9] START round=86 head_norm_before_train=2.021182 cos_to_last_merge=0.9855 (last merge round=34)
[S9] round=86 local utility u=0.012027 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982224818966805, 'loss_val': 0.020006412719789098, 'psi': 0.9972852998470071}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984376762240663, 'loss_val': 0.027195731886444516, 'psi': 0.9956203754834516}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=86 head_norm_before_train=2.449282 (no previous merge yet)
[S10] round=86 local utility u=0.000455 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962879091602672, 'loss_val': 0.024755500801818892, 'psi': 0.9957090360023451}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960929853836837, 'loss_val': 0.025081485504713407, 'psi': 0.9956310664917116}
[S11] START round=86 head_norm_before_train=2.375309 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=86 local utility u=0.016663 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991840325366963, 'loss_val': 0.016035285882305, 'psi': 0.9978521669904248}-{'f1_val': 0.9926465604644317, 'auprc': 0.9990110344436532, 'loss_val': 0.02293620798651808, 'psi': 0.9951923500561204}
[S13] START round=86 head_norm_before_train=2.151730 (no previous merge yet)
[S13] round=86 local utility u=0.086451 metrics={'f1_val': 0.7395680942457924, 'auprc': 0.8060148184727589, 'loss_val': 0.9473065746695701, 'psi': 0.766146783936579}-{'f1_val': 0.7337346216163798, 'auprc': 0.8191146879287357, 'loss_val': 1.124508283078454, 'psi': 0.7678866481413222}
[S14] START round=86 head_norm_before_train=1.842972 cos_to_last_merge=0.9422 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9792673226415509, 'auprc': 0.997938559154991, 'loss_val': 0.038495510029831925, 'psi': 0.9867358172469269}-{'f1_val': 0.986619220918381, 'auprc': 0.9979146950021871, 'loss_val': 0.03265674574092165, 'psi': 0.9911374105519034}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=1.933113 cos_to_last_merge=0.9998 (last merge round=82)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9003204311674137, 'auprc': 0.9962244934447269, 'loss_val': 0.2604736124500053, 'psi': 0.9386820560783389}-{'f1_val': 0.901471908377172, 'auprc': 0.9963414438653687, 'loss_val': 0.2398229752112975, 'psi': 0.9394197225724508}
[S16] START round=86 head_norm_before_train=1.876772 cos_to_last_merge=0.9950 (last merge round=55)
[S16] round=86 local utility u=0.008046 metrics={'f1_val': 0.990218050461623, 'auprc': 0.9955425641797104, 'loss_val': 0.047248627392832254, 'psi': 0.992347855948858}-{'f1_val': 0.9891160209923816, 'auprc': 0.9924709066869173, 'loss_val': 0.04751406172159436, 'psi': 0.9904579752701959}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=86 head_norm_before_train=2.290870 cos_to_last_merge=0.7522 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=86 local utility u=0.173781 metrics={'f1_val': 0.9075115327179878, 'auprc': 0.991417843392634, 'loss_val': 0.38895210469229646, 'psi': 0.9410740569878463}-{'f1_val': 0.8684918285344831, 'auprc': 0.9976661172399803, 'loss_val': 0.5211414379495022, 'psi': 0.920161544016682}
[S17] not sending this round → trigger blocked (psi=0.941)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=86 metric=0.9003 head_norm=1.946135
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.657772e-02
[S15] stored merged vector for next round verification (round=86)
[S15] DEBUG after merge:  round=86 metric=0.9009 head_norm=1.930068 delta_norm=0.036578
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1805) from S3
[S7] cosine check vs S3: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0283
[S13] DROPPED delta from S10 (cos=-0.0283 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0283
[S10] DROPPED delta from S13 (cos=-0.0283 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=86 metric=0.7780 head_norm=2.134007
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.436949e-02
[S6] stored merged vector for next round verification (round=86)
[S6] DEBUG after merge:  round=86 metric=0.7781 head_norm=2.124624 delta_norm=0.024369
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=86 metric=0.9970 head_norm=2.379688
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.440703e-02
[S11] stored merged vector for next round verification (round=86)
[S11] DEBUG after merge:  round=86 metric=0.9970 head_norm=2.378812 delta_norm=0.014407
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=1.905182 cos_to_last_merge=0.9760 (last merge round=39)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.6992594768117658, 'auprc': 0.8051019868932393, 'loss_val': 0.6434336790410408, 'psi': 0.7415964808443551}-{'f1_val': 0.7117273629266605, 'auprc': 0.8111366398588392, 'loss_val': 0.6955578359375384, 'psi': 0.7514910736995319}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=1.850700 cos_to_last_merge=1.0000 (last merge round=85)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.7151230582543151, 'auprc': 0.9135935521188554, 'loss_val': 0.9025876992929586, 'psi': 0.7945112558001313}-{'f1_val': 0.9470289036584065, 'auprc': 0.9919221039648255, 'loss_val': 0.12483588361050377, 'psi': 0.9649861837809741}
[S4] START round=87 head_norm_before_train=2.377556 cos_to_last_merge=1.0000 (last merge round=85)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9537076703605994, 'auprc': 0.9715075973443532, 'loss_val': 0.28001861822143403, 'psi': 0.9608276411541009}-{'f1_val': 0.9525590499902317, 'auprc': 0.9778671444412417, 'loss_val': 0.2752019546055933, 'psi': 0.9626822877706357}
[S5] START round=87 head_norm_before_train=1.919602 cos_to_last_merge=0.9996 (last merge round=83)
[S5] round=87 local utility u=0.647517 metrics={'f1_val': 0.9967768574880458, 'auprc': 0.9957545414913522, 'loss_val': 0.049587281621850825, 'psi': 0.9963679310893683}-{'f1_val': 0.8653162242618764, 'auprc': 0.9522598605870233, 'loss_val': 0.4253742808842614, 'psi': 0.9000936787919351}
[S6] START round=87 head_norm_before_train=2.124624 cos_to_last_merge=1.0000 (last merge round=86)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.6894613717421558, 'auprc': 0.8614765558305647, 'loss_val': 0.8689297173025837, 'psi': 0.7582674453775193}-{'f1_val': 0.778040831909901, 'auprc': 0.8958109993525379, 'loss_val': 0.7063721539516697, 'psi': 0.8251488988869558}
[S7] START round=87 head_norm_before_train=1.852547 cos_to_last_merge=0.9998 (last merge round=82)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.6113597638090635, 'auprc': 0.7948685512976059, 'loss_val': 0.7268928213915508, 'psi': 0.6847632788044805}-{'f1_val': 0.6089332474412501, 'auprc': 0.7946977192658418, 'loss_val': 0.6695047444004184, 'psi': 0.6832390361710867}
[S8] START round=87 head_norm_before_train=2.118071 cos_to_last_merge=1.0000 (last merge round=85)
[S8] round=87 local utility u=0.041912 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.9994787422061239, 'loss_val': 0.0362099916597769, 'psi': 0.9945761180477617}-{'f1_val': 0.9815282929982607, 'auprc': 0.9994182396886815, 'loss_val': 0.06117556196002875, 'psi': 0.9886842716744291}
[S9] START round=87 head_norm_before_train=2.024558 cos_to_last_merge=0.9852 (last merge round=34)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9982604736138944, 'loss_val': 0.020020233777076585, 'psi': 0.9971503008458903}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982224818966805, 'loss_val': 0.020006412719789098, 'psi': 0.9972852998470071}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.457253 (no previous merge yet)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962233346862599, 'loss_val': 0.025053511149944963, 'psi': 0.9956832062127421}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962879091602672, 'loss_val': 0.024755500801818892, 'psi': 0.9957090360023451}
[S11] START round=87 head_norm_before_train=2.378812 cos_to_last_merge=1.0000 (last merge round=86)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991025975925126, 'loss_val': 0.015818428347091747, 'psi': 0.9978195930127514}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991840325366963, 'loss_val': 0.016035285882305, 'psi': 0.9978521669904248}
[S13] START round=87 head_norm_before_train=2.142759 (no previous merge yet)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.7072527192790837, 'auprc': 0.8893316293536107, 'loss_val': 1.1830187264200642, 'psi': 0.7800842833088946}-{'f1_val': 0.7395680942457924, 'auprc': 0.8060148184727589, 'loss_val': 0.9473065746695701, 'psi': 0.766146783936579}
[S14] START round=87 head_norm_before_train=1.848586 cos_to_last_merge=0.9417 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9735278383948751, 'auprc': 0.9978773644367741, 'loss_val': 0.04933868406338723, 'psi': 0.9832676488116348}-{'f1_val': 0.9792673226415509, 'auprc': 0.997938559154991, 'loss_val': 0.038495510029831925, 'psi': 0.9867358172469269}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=1.930068 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=87 local utility u=0.006634 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.9961062227573685, 'loss_val': 0.2503093712587378, 'psi': 0.9389805655865413}-{'f1_val': 0.9003204311674137, 'auprc': 0.9962244934447269, 'loss_val': 0.2604736124500053, 'psi': 0.9386820560783389}
[S16] START round=87 head_norm_before_train=1.881440 cos_to_last_merge=0.9947 (last merge round=55)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9438677567329342, 'auprc': 0.9791752073177413, 'loss_val': 0.27424066497774374, 'psi': 0.957990736966857}-{'f1_val': 0.990218050461623, 'auprc': 0.9955425641797104, 'loss_val': 0.047248627392832254, 'psi': 0.992347855948858}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.297663 cos_to_last_merge=0.7520 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8482213790773724, 'auprc': 0.994606332215322, 'loss_val': 0.6589720692789125, 'psi': 0.9067753603325522}-{'f1_val': 0.9075115327179878, 'auprc': 0.991417843392634, 'loss_val': 0.38895210469229646, 'psi': 0.9410740569878463}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=87 metric=0.6114 head_norm=1.857986
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.962279e-02
[S7] stored merged vector for next round verification (round=87)
[S7] DEBUG after merge:  round=87 metric=0.6123 head_norm=1.854243 delta_norm=0.019623
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=87 metric=0.9537 head_norm=2.381164
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.694631e-02
[S4] stored merged vector for next round verification (round=87)
[S4] DEBUG after merge:  round=87 metric=0.9537 head_norm=2.380366 delta_norm=0.016946
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9996
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=87 metric=0.9913 head_norm=2.122968
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.941462e-02
[S8] stored merged vector for next round verification (round=87)
[S8] DEBUG after merge:  round=87 metric=0.9913 head_norm=2.128406 delta_norm=0.019415
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=0.9996
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=87 metric=0.9968 head_norm=1.925020
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.020508e-02
[S5] stored merged vector for next round verification (round=87)
[S5] DEBUG after merge:  round=87 metric=0.9968 head_norm=1.933599 delta_norm=0.030205
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=1.910999 cos_to_last_merge=0.9756 (last merge round=39)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.6904502020364638, 'auprc': 0.7970222522359118, 'loss_val': 0.6737561996211272, 'psi': 0.7330790221162431}-{'f1_val': 0.6992594768117658, 'auprc': 0.8051019868932393, 'loss_val': 0.6434336790410408, 'psi': 0.7415964808443551}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=1.855701 cos_to_last_merge=1.0000 (last merge round=85)
[S3] round=88 local utility u=0.773165 metrics={'f1_val': 0.8496758540619079, 'auprc': 0.9957102430112209, 'loss_val': 0.4099245599345605, 'psi': 0.9080896096416331}-{'f1_val': 0.7151230582543151, 'auprc': 0.9135935521188554, 'loss_val': 0.9025876992929586, 'psi': 0.7945112558001313}
[S4] START round=88 head_norm_before_train=2.380366 cos_to_last_merge=1.0000 (last merge round=87)
[S4] round=88 local utility u=0.024486 metrics={'f1_val': 0.9498140487960989, 'auprc': 0.9861293410232154, 'loss_val': 0.2515497343858395, 'psi': 0.9643401656869455}-{'f1_val': 0.9537076703605994, 'auprc': 0.9715075973443532, 'loss_val': 0.28001861822143403, 'psi': 0.9608276411541009}
[S5] START round=88 head_norm_before_train=1.933599 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9673391437002039, 'auprc': 0.9906020450752959, 'loss_val': 0.11972658186498239, 'psi': 0.9766443042502406}-{'f1_val': 0.9967768574880458, 'auprc': 0.9957545414913522, 'loss_val': 0.049587281621850825, 'psi': 0.9963679310893683}
[S6] START round=88 head_norm_before_train=2.132521 cos_to_last_merge=1.0000 (last merge round=86)
[S6] round=88 local utility u=0.464386 metrics={'f1_val': 0.7887671930837714, 'auprc': 0.8972751141140174, 'loss_val': 0.6433885213943821, 'psi': 0.8321703614958698}-{'f1_val': 0.6894613717421558, 'auprc': 0.8614765558305647, 'loss_val': 0.8689297173025837, 'psi': 0.7582674453775193}
[S7] START round=88 head_norm_before_train=1.854243 cos_to_last_merge=1.0000 (last merge round=87)
[S7] round=88 local utility u=0.104771 metrics={'f1_val': 0.6251884731419506, 'auprc': 0.8024568242242964, 'loss_val': 0.6230877429921563, 'psi': 0.6960958135748889}-{'f1_val': 0.6113597638090635, 'auprc': 0.7948685512976059, 'loss_val': 0.7268928213915508, 'psi': 0.6847632788044805}
[S8] START round=88 head_norm_before_train=2.128406 cos_to_last_merge=1.0000 (last merge round=87)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9713081436470392, 'auprc': 0.9994267618051089, 'loss_val': 0.08824135586012258, 'psi': 0.9825555909102671}-{'f1_val': 0.9913077019421868, 'auprc': 0.9994787422061239, 'loss_val': 0.0362099916597769, 'psi': 0.9945761180477617}
[S9] START round=88 head_norm_before_train=2.028594 cos_to_last_merge=0.9849 (last merge round=34)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984792543583998, 'loss_val': 0.02057952926292067, 'psi': 0.9967375370738687}-{'f1_val': 0.9964101856672208, 'auprc': 0.9982604736138944, 'loss_val': 0.020020233777076585, 'psi': 0.9971503008458903}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.464136 (no previous merge yet)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961879237198106, 'loss_val': 0.02518106824604348, 'psi': 0.9956690418261624}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962233346862599, 'loss_val': 0.025053511149944963, 'psi': 0.9956832062127421}
[S11] START round=88 head_norm_before_train=2.382316 cos_to_last_merge=1.0000 (last merge round=86)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9924279269636593, 'auprc': 0.9990705553526658, 'loss_val': 0.025863088414709585, 'psi': 0.9950849783192619}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991025975925126, 'loss_val': 0.015818428347091747, 'psi': 0.9978195930127514}
[S13] START round=88 head_norm_before_train=2.144604 (no previous merge yet)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6215458869136126, 'auprc': 0.6907626523379812, 'loss_val': 1.382961175868087, 'psi': 0.64923259308336}-{'f1_val': 0.7072527192790837, 'auprc': 0.8893316293536107, 'loss_val': 1.1830187264200642, 'psi': 0.7800842833088946}
[S14] START round=88 head_norm_before_train=1.850927 cos_to_last_merge=0.9414 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=88 local utility u=0.086364 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.998396737470899, 'loss_val': 0.01987852862138376, 'psi': 0.9976463845632285}-{'f1_val': 0.9735278383948751, 'auprc': 0.9978773644367741, 'loss_val': 0.04933868406338723, 'psi': 0.9832676488116348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=88 head_norm_before_train=1.942610 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.8980023709116863, 'auprc': 0.9960904435152653, 'loss_val': 0.2637810225541096, 'psi': 0.937237599953118}-{'f1_val': 0.9008967941393231, 'auprc': 0.9961062227573685, 'loss_val': 0.2503093712587378, 'psi': 0.9389805655865413}
[S16] START round=88 head_norm_before_train=1.885634 cos_to_last_merge=0.9946 (last merge round=55)
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.8797951571131218, 'auprc': 0.9211145602650092, 'loss_val': 0.6451645282566161, 'psi': 0.8963229183738768}-{'f1_val': 0.9438677567329342, 'auprc': 0.9791752073177413, 'loss_val': 0.27424066497774374, 'psi': 0.957990736966857}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.304390 cos_to_last_merge=0.7518 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=88 local utility u=0.208652 metrics={'f1_val': 0.8893324263153785, 'auprc': 0.9688393273151583, 'loss_val': 0.4110341428321409, 'psi': 0.9211351867152904}-{'f1_val': 0.8482213790773724, 'auprc': 0.994606332215322, 'loss_val': 0.6589720692789125, 'psi': 0.9067753603325522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=88 metric=0.8980 head_norm=1.955158
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.544683e-02
[S15] stored merged vector for next round verification (round=88)
[S15] DEBUG after merge:  round=88 metric=0.8997 head_norm=1.939824 delta_norm=0.035447
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1807 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S3
[S7] cosine check vs S3: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1807) from S7
[S3] cosine check vs S7: cos=0.9998
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=88 metric=0.7888 head_norm=2.146916
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.050652e-02
[S6] stored merged vector for next round verification (round=88)
[S6] DEBUG after merge:  round=88 metric=0.7888 head_norm=2.134877 delta_norm=0.020507
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=88 metric=0.8497 head_norm=1.861270
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.777271e-02
[S3] stored merged vector for next round verification (round=88)
[S3] DEBUG after merge:  round=88 metric=0.8497 head_norm=1.860894 delta_norm=0.017773
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=88 metric=0.6252 head_norm=1.860687
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.777271e-02
[S7] stored merged vector for next round verification (round=88)
[S7] DEBUG after merge:  round=88 metric=0.6253 head_norm=1.860894 delta_norm=0.017773
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=1.919297 cos_to_last_merge=0.9754 (last merge round=39)
[S2] round=89 local utility u=0.072669 metrics={'f1_val': 0.7137614158234482, 'auprc': 0.8214146181261751, 'loss_val': 0.7414629458840082, 'psi': 0.756822696744539}-{'f1_val': 0.6904502020364638, 'auprc': 0.7970222522359118, 'loss_val': 0.6737561996211272, 'psi': 0.7330790221162431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=89 head_norm_before_train=1.860894 cos_to_last_merge=1.0000 (last merge round=88)
[S3] round=89 local utility u=0.595968 metrics={'f1_val': 0.9856306103827697, 'auprc': 0.9995653319853337, 'loss_val': 0.045282061013149716, 'psi': 0.9912044990237953}-{'f1_val': 0.8496758540619079, 'auprc': 0.9957102430112209, 'loss_val': 0.4099245599345605, 'psi': 0.9080896096416331}
[S4] START round=89 head_norm_before_train=2.390192 cos_to_last_merge=1.0000 (last merge round=87)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9453853643198743, 'auprc': 0.9864508118629391, 'loss_val': 0.25400354024829647, 'psi': 0.9618115433371003}-{'f1_val': 0.9498140487960989, 'auprc': 0.9861293410232154, 'loss_val': 0.2515497343858395, 'psi': 0.9643401656869455}
[S5] START round=89 head_norm_before_train=1.939521 cos_to_last_merge=1.0000 (last merge round=87)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9636088703492367, 'auprc': 0.9900852481634415, 'loss_val': 0.12513549337406807, 'psi': 0.9741994214749186}-{'f1_val': 0.9673391437002039, 'auprc': 0.9906020450752959, 'loss_val': 0.11972658186498239, 'psi': 0.9766443042502406}
[S6] START round=89 head_norm_before_train=2.134877 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.6205270917843669, 'auprc': 0.9078533359382882, 'loss_val': 1.3265628431781917, 'psi': 0.7354575894459354}-{'f1_val': 0.7887671930837714, 'auprc': 0.8972751141140174, 'loss_val': 0.6433885213943821, 'psi': 0.8321703614958698}
[S7] START round=89 head_norm_before_train=1.860894 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5726524607693053, 'auprc': 0.7852020390088481, 'loss_val': 0.9140501171864669, 'psi': 0.6576722920651225}-{'f1_val': 0.6251884731419506, 'auprc': 0.8024568242242964, 'loss_val': 0.6230877429921563, 'psi': 0.6960958135748889}
[S8] START round=89 head_norm_before_train=2.135324 cos_to_last_merge=1.0000 (last merge round=87)
[S8] round=89 local utility u=0.029501 metrics={'f1_val': 0.9773907530582948, 'auprc': 0.9994146400845566, 'loss_val': 0.06569906135479851, 'psi': 0.9862003078687995}-{'f1_val': 0.9713081436470392, 'auprc': 0.9994267618051089, 'loss_val': 0.08824135586012258, 'psi': 0.9825555909102671}
[S9] START round=89 head_norm_before_train=2.032777 cos_to_last_merge=0.9846 (last merge round=34)
[S9] round=89 local utility u=0.000655 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984535902308451, 'loss_val': 0.020695062089719246, 'psi': 0.9968774671108493}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984792543583998, 'loss_val': 0.02057952926292067, 'psi': 0.9967375370738687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=89 head_norm_before_train=2.465728 (no previous merge yet)
[S10] round=89 local utility u=0.000353 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962849238581527, 'loss_val': 0.02476518854258796, 'psi': 0.9957078418814993}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961879237198106, 'loss_val': 0.02518106824604348, 'psi': 0.9956690418261624}
[S11] START round=89 head_norm_before_train=2.385874 cos_to_last_merge=1.0000 (last merge round=86)
[S11] round=89 local utility u=0.018470 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9990855616551734, 'loss_val': 0.01632764439985928, 'psi': 0.9978269355165987}-{'f1_val': 0.9924279269636593, 'auprc': 0.9990705553526658, 'loss_val': 0.025863088414709585, 'psi': 0.9950849783192619}
[S13] START round=89 head_norm_before_train=2.146206 (no previous merge yet)
[S13] round=89 local utility u=0.177607 metrics={'f1_val': 0.6569583444786868, 'auprc': 0.7376685387444604, 'loss_val': 1.3809390635581051, 'psi': 0.6892424221849962}-{'f1_val': 0.6215458869136126, 'auprc': 0.6907626523379812, 'loss_val': 1.382961175868087, 'psi': 0.64923259308336}
[S14] START round=89 head_norm_before_train=1.853094 cos_to_last_merge=0.9410 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=89 local utility u=0.000093 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.9983801655471676, 'loss_val': 0.01964310776622195, 'psi': 0.997639755793736}-{'f1_val': 0.9971461492914482, 'auprc': 0.998396737470899, 'loss_val': 0.01987852862138376, 'psi': 0.9976463845632285}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=89 head_norm_before_train=1.939824 cos_to_last_merge=1.0000 (last merge round=88)
[S15] round=89 local utility u=0.007243 metrics={'f1_val': 0.8997428134355263, 'auprc': 0.9961119652271921, 'loss_val': 0.25980292318311726, 'psi': 0.9382904741521926}-{'f1_val': 0.8980023709116863, 'auprc': 0.9960904435152653, 'loss_val': 0.2637810225541096, 'psi': 0.937237599953118}
[S16] START round=89 head_norm_before_train=1.890156 cos_to_last_merge=0.9944 (last merge round=55)
[S16] round=89 local utility u=0.746575 metrics={'f1_val': 0.9919393366423058, 'auprc': 0.992377623083895, 'loss_val': 0.038669454114612964, 'psi': 0.9921146512189414}-{'f1_val': 0.8797951571131218, 'auprc': 0.9211145602650092, 'loss_val': 0.6451645282566161, 'psi': 0.8963229183738768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=89 head_norm_before_train=2.309001 cos_to_last_merge=0.7514 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=89 local utility u=0.065455 metrics={'f1_val': 0.9027416284904655, 'auprc': 0.9892631918779611, 'loss_val': 0.4218509608426584, 'psi': 0.9373502538454637}-{'f1_val': 0.8893324263153785, 'auprc': 0.9688393273151583, 'loss_val': 0.4110341428321409, 'psi': 0.9211351867152904}
[S17] not sending this round → trigger blocked (psi=0.937)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.991)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0281
[S13] DROPPED delta from S10 (cos=-0.0281 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0281
[S10] DROPPED delta from S13 (cos=-0.0281 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=89 metric=0.9970 head_norm=2.390346
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.217403e-02
[S11] stored merged vector for next round verification (round=89)
[S11] DEBUG after merge:  round=89 metric=0.9970 head_norm=2.390238 delta_norm=0.012174
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=89 metric=0.9774 head_norm=2.141704
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.259633e-02
[S8] stored merged vector for next round verification (round=89)
[S8] DEBUG after merge:  round=89 metric=0.9774 head_norm=2.144275 delta_norm=0.012596
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=89 metric=0.9636 head_norm=1.949589
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.483249e-02
[S5] stored merged vector for next round verification (round=89)
[S5] DEBUG after merge:  round=89 metric=0.9634 head_norm=1.950670 delta_norm=0.014832
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=1.927485 cos_to_last_merge=0.9752 (last merge round=39)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7157925382718868, 'auprc': 0.7972387339594194, 'loss_val': 0.8543301887266109, 'psi': 0.7483710165468999}-{'f1_val': 0.7137614158234482, 'auprc': 0.8214146181261751, 'loss_val': 0.7414629458840082, 'psi': 0.756822696744539}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=1.867245 cos_to_last_merge=1.0000 (last merge round=88)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.6854682805869827, 'auprc': 0.9037495468052038, 'loss_val': 1.0250032722280642, 'psi': 0.7727807870742711}-{'f1_val': 0.9856306103827697, 'auprc': 0.9995653319853337, 'loss_val': 0.045282061013149716, 'psi': 0.9912044990237953}
[S4] START round=90 head_norm_before_train=2.396073 cos_to_last_merge=1.0000 (last merge round=87)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9556914628970186, 'auprc': 0.9604230470282247, 'loss_val': 0.331786790500162, 'psi': 0.957584096549501}-{'f1_val': 0.9453853643198743, 'auprc': 0.9864508118629391, 'loss_val': 0.25400354024829647, 'psi': 0.9618115433371003}
[S5] START round=90 head_norm_before_train=1.950670 cos_to_last_merge=1.0000 (last merge round=89)
[S5] round=90 local utility u=0.136821 metrics={'f1_val': 0.9967768574880458, 'auprc': 0.9936428255749958, 'loss_val': 0.06117364520698744, 'psi': 0.9955232447228257}-{'f1_val': 0.9636088703492367, 'auprc': 0.9900852481634415, 'loss_val': 0.12513549337406807, 'psi': 0.9741994214749186}
[S6] START round=90 head_norm_before_train=2.149795 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=90 local utility u=0.703375 metrics={'f1_val': 0.7699424018156504, 'auprc': 0.9167908957439479, 'loss_val': 0.8431172653794405, 'psi': 0.8286817993869695}-{'f1_val': 0.6205270917843669, 'auprc': 0.9078533359382882, 'loss_val': 1.3265628431781917, 'psi': 0.7354575894459354}
[S7] START round=90 head_norm_before_train=1.868011 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=90 local utility u=0.363543 metrics={'f1_val': 0.6231661413525514, 'auprc': 0.8049110649579394, 'loss_val': 0.5491729305820696, 'psi': 0.6958641107947066}-{'f1_val': 0.5726524607693053, 'auprc': 0.7852020390088481, 'loss_val': 0.9140501171864669, 'psi': 0.6576722920651225}
[S8] START round=90 head_norm_before_train=2.144275 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=90 local utility u=0.053983 metrics={'f1_val': 0.9944013360228022, 'auprc': 0.990020910977572, 'loss_val': 0.031616182609377076, 'psi': 0.9926491660047101}-{'f1_val': 0.9773907530582948, 'auprc': 0.9994146400845566, 'loss_val': 0.06569906135479851, 'psi': 0.9862003078687995}
[S9] START round=90 head_norm_before_train=2.035437 cos_to_last_merge=0.9845 (last merge round=34)
[S9] round=90 local utility u=0.000135 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984529294555096, 'loss_val': 0.02042316775269591, 'psi': 0.9968772028007151}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984535902308451, 'loss_val': 0.020695062089719246, 'psi': 0.9968774671108493}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=90 head_norm_before_train=2.469438 (no previous merge yet)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960941470774816, 'loss_val': 0.025054803614256535, 'psi': 0.9956315311692308}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962849238581527, 'loss_val': 0.02476518854258796, 'psi': 0.9957078418814993}
[S11] START round=90 head_norm_before_train=2.390238 cos_to_last_merge=1.0000 (last merge round=89)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963100190352135, 'auprc': 0.9990675194701686, 'loss_val': 0.016665483573111036, 'psi': 0.9974130192091956}-{'f1_val': 0.9969878514242156, 'auprc': 0.9990855616551734, 'loss_val': 0.01632764439985928, 'psi': 0.9978269355165987}
[S13] START round=90 head_norm_before_train=2.150337 (no previous merge yet)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6102277336885625, 'auprc': 0.6693061261751965, 'loss_val': 1.273873986558466, 'psi': 0.6338590906832161}-{'f1_val': 0.6569583444786868, 'auprc': 0.7376685387444604, 'loss_val': 1.3809390635581051, 'psi': 0.6892424221849962}
[S14] START round=90 head_norm_before_train=1.856577 cos_to_last_merge=0.9407 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963106585872605, 'auprc': 0.9978573515006683, 'loss_val': 0.027280319157135056, 'psi': 0.9969293357526237}-{'f1_val': 0.9971461492914482, 'auprc': 0.9983801655471676, 'loss_val': 0.01964310776622195, 'psi': 0.997639755793736}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=1.951864 cos_to_last_merge=1.0000 (last merge round=88)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.8997428134355263, 'auprc': 0.9961232761925588, 'loss_val': 0.26185200847456935, 'psi': 0.9382949985383393}-{'f1_val': 0.8997428134355263, 'auprc': 0.9961119652271921, 'loss_val': 0.25980292318311726, 'psi': 0.9382904741521926}
[S16] START round=90 head_norm_before_train=1.895260 cos_to_last_merge=0.9943 (last merge round=55)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9862850946990047, 'auprc': 0.9923774320004938, 'loss_val': 0.06052824137397783, 'psi': 0.9887220296196003}-{'f1_val': 0.9919393366423058, 'auprc': 0.992377623083895, 'loss_val': 0.038669454114612964, 'psi': 0.9921146512189414}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.316832 cos_to_last_merge=0.7512 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8826561737746799, 'auprc': 0.9970138507005227, 'loss_val': 0.46996963134177605, 'psi': 0.928399244545017}-{'f1_val': 0.9027416284904655, 'auprc': 0.9892631918779611, 'loss_val': 0.4218509608426584, 'psi': 0.9373502538454637}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.993)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=90 metric=0.9557 head_norm=2.398931
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.007888e-02
[S4] stored merged vector for next round verification (round=90)
[S4] DEBUG after merge:  round=90 metric=0.9557 head_norm=2.394558 delta_norm=0.020079
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.008 → S11@127.0.0.1:49312
[S11] ⇄ pheromone p=0.011 → S4@127.0.0.1:49304
[S3] ⇄ pheromone p=0.251 → S7@127.0.0.1:49308
[S13] ⇄ pheromone p=0.091 → S10@127.0.0.1:49311
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S8] ⇄ pheromone p=0.030 → S6@127.0.0.1:49307
[S15] ⇄ pheromone p=0.029 → S5@127.0.0.1:49305
[S3] RECEIVED delta(kind=head bytes=1806) from S7
[S3] cosine check vs S7: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9999
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=90 metric=0.7699 head_norm=2.160286
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.759496e-02
[S6] stored merged vector for next round verification (round=90)
[S6] DEBUG after merge:  round=90 metric=0.7696 head_norm=2.150943 delta_norm=0.017595
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.381 → S8@127.0.0.1:49309
[S7] ⇄ pheromone p=0.142 → S3@127.0.0.1:49303
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] ⇄ pheromone p=0.164 → S15@127.0.0.1:49315
[S2] START round=91 head_norm_before_train=1.932286 cos_to_last_merge=0.9752 (last merge round=39)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.6908521878634654, 'auprc': 0.7755457702287841, 'loss_val': 0.7463356567419716, 'psi': 0.7247296208095929}-{'f1_val': 0.7157925382718868, 'auprc': 0.7972387339594194, 'loss_val': 0.8543301887266109, 'psi': 0.7483710165468999}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=1.873999 cos_to_last_merge=1.0000 (last merge round=88)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.6469584701057274, 'auprc': 0.8519988457186427, 'loss_val': 1.282458096116481, 'psi': 0.7289746203508936}-{'f1_val': 0.6854682805869827, 'auprc': 0.9037495468052038, 'loss_val': 1.0250032722280642, 'psi': 0.7727807870742711}
[S4] START round=91 head_norm_before_train=2.394558 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9406107271101454, 'auprc': 0.9626979978676429, 'loss_val': 0.27727242868511337, 'psi': 0.9494456354131444}-{'f1_val': 0.9556914628970186, 'auprc': 0.9604230470282247, 'loss_val': 0.331786790500162, 'psi': 0.957584096549501}
[S5] START round=91 head_norm_before_train=1.957067 cos_to_last_merge=1.0000 (last merge round=89)
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9709389202737333, 'auprc': 0.9933330419089945, 'loss_val': 0.09603633089695993, 'psi': 0.9798965689278378}-{'f1_val': 0.9967768574880458, 'auprc': 0.9936428255749958, 'loss_val': 0.06117364520698744, 'psi': 0.9955232447228257}
[S6] START round=91 head_norm_before_train=2.150943 cos_to_last_merge=1.0000 (last merge round=90)
[S6] round=91 local utility u=0.494915 metrics={'f1_val': 0.8600142294877315, 'auprc': 0.8999409193621404, 'loss_val': 0.3431679807781344, 'psi': 0.8759849054374951}-{'f1_val': 0.7699424018156504, 'auprc': 0.9167908957439479, 'loss_val': 0.8431172653794405, 'psi': 0.8286817993869695}
[S7] START round=91 head_norm_before_train=1.874133 cos_to_last_merge=0.9999 (last merge round=88)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.553105351999382, 'auprc': 0.7838508614541478, 'loss_val': 1.0117030588499294, 'psi': 0.6454035557812883}-{'f1_val': 0.6231661413525514, 'auprc': 0.8049110649579394, 'loss_val': 0.5491729305820696, 'psi': 0.6958641107947066}
[S8] START round=91 head_norm_before_train=2.151835 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=91 local utility u=0.004520 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9995371905062702, 'loss_val': 0.033406879459108994, 'psi': 0.9946838191283441}-{'f1_val': 0.9944013360228022, 'auprc': 0.990020910977572, 'loss_val': 0.031616182609377076, 'psi': 0.9926491660047101}
[S9] START round=91 head_norm_before_train=2.038733 cos_to_last_merge=0.9844 (last merge round=34)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984569732321491, 'loss_val': 0.021076674895797797, 'psi': 0.9968788203113709}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984529294555096, 'loss_val': 0.02042316775269591, 'psi': 0.9968772028007151}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.471331 (no previous merge yet)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956363457400255, 'loss_val': 0.025441739249986682, 'psi': 0.9954484106342484}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960941470774816, 'loss_val': 0.025054803614256535, 'psi': 0.9956315311692308}
[S11] START round=91 head_norm_before_train=2.394149 cos_to_last_merge=1.0000 (last merge round=89)
[S11] round=91 local utility u=0.000816 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999071934502231, 'loss_val': 0.016491890967383023, 'psi': 0.9975593267979508}-{'f1_val': 0.9963100190352135, 'auprc': 0.9990675194701686, 'loss_val': 0.016665483573111036, 'psi': 0.9974130192091956}
[S13] START round=91 head_norm_before_train=2.146540 (no previous merge yet)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.5781582749000534, 'auprc': 0.6448603729904709, 'loss_val': 1.5053937385670755, 'psi': 0.6048391141362205}-{'f1_val': 0.6102277336885625, 'auprc': 0.6693061261751965, 'loss_val': 1.273873986558466, 'psi': 0.6338590906832161}
[S14] START round=91 head_norm_before_train=1.861272 cos_to_last_merge=0.9403 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9681334807063762, 'auprc': 0.9978751822215743, 'loss_val': 0.04981914803587217, 'psi': 0.9800301613124554}-{'f1_val': 0.9963106585872605, 'auprc': 0.9978573515006683, 'loss_val': 0.027280319157135056, 'psi': 0.9969293357526237}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=1.963801 cos_to_last_merge=0.9999 (last merge round=88)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.8927112889875611, 'auprc': 0.9959859843100538, 'loss_val': 0.28002514867327644, 'psi': 0.9340211671165581}-{'f1_val': 0.8997428134355263, 'auprc': 0.9961232761925588, 'loss_val': 0.26185200847456935, 'psi': 0.9382949985383393}
[S16] START round=91 head_norm_before_train=1.901025 cos_to_last_merge=0.9941 (last merge round=55)
[S16] round=91 local utility u=0.020247 metrics={'f1_val': 0.9910187657145617, 'auprc': 0.9903934758225361, 'loss_val': 0.04248435022456492, 'psi': 0.9907686497577515}-{'f1_val': 0.9862850946990047, 'auprc': 0.9923774320004938, 'loss_val': 0.06052824137397783, 'psi': 0.9887220296196003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=91 head_norm_before_train=2.324844 cos_to_last_merge=0.7512 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=91 local utility u=0.008118 metrics={'f1_val': 0.8950368194525087, 'auprc': 0.9563269565563901, 'loss_val': 0.40595770995958375, 'psi': 0.9195528742940613}-{'f1_val': 0.8826561737746799, 'auprc': 0.9970138507005227, 'loss_val': 0.46996963134177605, 'psi': 0.928399244545017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S5]  timeout peer S16
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.876)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=91 metric=0.6470 head_norm=1.881481
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.473789e-02
[S3] stored merged vector for next round verification (round=91)
[S3] DEBUG after merge:  round=91 metric=0.6470 head_norm=1.877753 delta_norm=0.014738
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=91 metric=0.8927 head_norm=1.975375
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.145696e-02
[S15] stored merged vector for next round verification (round=91)
[S15] DEBUG after merge:  round=91 metric=0.8939 head_norm=1.966125 delta_norm=0.021457
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=91 metric=0.9914 head_norm=2.154298
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.211721e-02
[S8] stored merged vector for next round verification (round=91)
[S8] DEBUG after merge:  round=91 metric=0.9914 head_norm=2.157260 delta_norm=0.012117
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=1.936698 cos_to_last_merge=0.9749 (last merge round=39)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6338775345659153, 'auprc': 0.7540945845249448, 'loss_val': 1.1994333795651, 'psi': 0.6819643545495271}-{'f1_val': 0.6908521878634654, 'auprc': 0.7755457702287841, 'loss_val': 0.7463356567419716, 'psi': 0.7247296208095929}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=1.877753 cos_to_last_merge=1.0000 (last merge round=91)
[S3] round=92 local utility u=1.000000 metrics={'f1_val': 0.9972888067730694, 'auprc': 0.9997698563329755, 'loss_val': 0.024028665165531912, 'psi': 0.9982812265970318}-{'f1_val': 0.6469584701057274, 'auprc': 0.8519988457186427, 'loss_val': 1.282458096116481, 'psi': 0.7289746203508936}
[S4] START round=92 head_norm_before_train=2.401194 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9426495520586822, 'auprc': 0.960648154954922, 'loss_val': 0.294551556579497, 'psi': 0.9498489932171781}-{'f1_val': 0.9406107271101454, 'auprc': 0.9626979978676429, 'loss_val': 0.27727242868511337, 'psi': 0.9494456354131444}
[S5] START round=92 head_norm_before_train=1.965976 cos_to_last_merge=0.9999 (last merge round=89)
[S5] round=92 local utility u=0.102711 metrics={'f1_val': 0.9967768574880458, 'auprc': 0.9934753087704359, 'loss_val': 0.04606783633091438, 'psi': 0.9954562380010018}-{'f1_val': 0.9709389202737333, 'auprc': 0.9933330419089945, 'loss_val': 0.09603633089695993, 'psi': 0.9798965689278378}
[S6] START round=92 head_norm_before_train=2.157844 cos_to_last_merge=0.9999 (last merge round=90)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7998212898274486, 'auprc': 0.892053064365813, 'loss_val': 0.6552391467804171, 'psi': 0.8367139996427944}-{'f1_val': 0.8600142294877315, 'auprc': 0.8999409193621404, 'loss_val': 0.3431679807781344, 'psi': 0.8759849054374951}
[S7] START round=92 head_norm_before_train=1.879036 cos_to_last_merge=0.9999 (last merge round=88)
[S7] round=92 local utility u=0.502576 metrics={'f1_val': 0.6287896158305568, 'auprc': 0.8058836882086712, 'loss_val': 0.5267551152956795, 'psi': 0.6996272447818026}-{'f1_val': 0.553105351999382, 'auprc': 0.7838508614541478, 'loss_val': 1.0117030588499294, 'psi': 0.6454035557812883}
[S8] START round=92 head_norm_before_train=2.157260 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=92 local utility u=0.003405 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9994105498428002, 'loss_val': 0.036612879071252054, 'psi': 0.9956727060143994}-{'f1_val': 0.9914482382097267, 'auprc': 0.9995371905062702, 'loss_val': 0.033406879459108994, 'psi': 0.9946838191283441}
[S9] START round=92 head_norm_before_train=2.042682 cos_to_last_merge=0.9842 (last merge round=34)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.998447346705335, 'loss_val': 0.049111094715134015, 'psi': 0.9916657413720111}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984569732321491, 'loss_val': 0.021076674895797797, 'psi': 0.9968788203113709}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.477345 (no previous merge yet)
[S10] round=92 local utility u=0.001337 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963026592320202, 'loss_val': 0.0247665471749284, 'psi': 0.9957149360310462}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956363457400255, 'loss_val': 0.025441739249986682, 'psi': 0.9954484106342484}
[S11] START round=92 head_norm_before_train=2.396858 cos_to_last_merge=1.0000 (last merge round=89)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990552819901464, 'loss_val': 0.0171802104627048, 'psi': 0.9975526657931169}-{'f1_val': 0.9965509216617638, 'auprc': 0.999071934502231, 'loss_val': 0.016491890967383023, 'psi': 0.9975593267979508}
[S13] START round=92 head_norm_before_train=2.146821 (no previous merge yet)
[S13] round=92 local utility u=1.000000 metrics={'f1_val': 0.7471709284465108, 'auprc': 0.8573034612848702, 'loss_val': 1.0225802301140432, 'psi': 0.7912239415818545}-{'f1_val': 0.5781582749000534, 'auprc': 0.6448603729904709, 'loss_val': 1.5053937385670755, 'psi': 0.6048391141362205}
[S14] START round=92 head_norm_before_train=1.863985 cos_to_last_merge=0.9400 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=92 local utility u=0.055210 metrics={'f1_val': 0.984043579018347, 'auprc': 0.9979394896912434, 'loss_val': 0.0350527849516788, 'psi': 0.9896019432875056}-{'f1_val': 0.9681334807063762, 'auprc': 0.9978751822215743, 'loss_val': 0.04981914803587217, 'psi': 0.9800301613124554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=92 head_norm_before_train=1.966125 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.8921167952729744, 'auprc': 0.9959763670330523, 'loss_val': 0.2838208787060711, 'psi': 0.9336606239770056}-{'f1_val': 0.8927112889875611, 'auprc': 0.9959859843100538, 'loss_val': 0.28002514867327644, 'psi': 0.9340211671165581}
[S16] START round=92 head_norm_before_train=1.906592 cos_to_last_merge=0.9940 (last merge round=55)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.8713370806517888, 'auprc': 0.9355474152692594, 'loss_val': 0.7733696981386031, 'psi': 0.897021214498777}-{'f1_val': 0.9910187657145617, 'auprc': 0.9903934758225361, 'loss_val': 0.04248435022456492, 'psi': 0.9907686497577515}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.329749 cos_to_last_merge=0.7510 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.8729703216165221, 'auprc': 0.9860032856112392, 'loss_val': 0.49208896089885634, 'psi': 0.9181835072144089}-{'f1_val': 0.8950368194525087, 'auprc': 0.9563269565563901, 'loss_val': 0.40595770995958375, 'psi': 0.9195528742940613}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S7] → sending delta(kind=head bytes=1812) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[S8] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1812 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=92 metric=0.7998 head_norm=2.170645
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.861914e-02
[S6] stored merged vector for next round verification (round=92)
[S6] DEBUG after merge:  round=92 metric=0.8001 head_norm=2.162407 delta_norm=0.018619
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=92 metric=0.9426 head_norm=2.404508
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.270048e-02
[S4] stored merged vector for next round verification (round=92)
[S4] DEBUG after merge:  round=92 metric=0.9426 head_norm=2.400652 delta_norm=0.012700
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0285
[S10] DROPPED delta from S13 (cos=-0.0285 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] cosine check vs S5: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1812) from S7
[S3] cosine check vs S7: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=-0.0285
[S13] DROPPED delta from S10 (cos=-0.0285 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=92 metric=0.6288 head_norm=1.883715
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.276792e-02
[S7] stored merged vector for next round verification (round=92)
[S7] DEBUG after merge:  round=92 metric=0.6288 head_norm=1.884432 delta_norm=0.012768
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=92 metric=0.9973 head_norm=1.885236
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.276791e-02
[S3] stored merged vector for next round verification (round=92)
[S3] DEBUG after merge:  round=92 metric=0.9973 head_norm=1.884432 delta_norm=0.012768
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=1.939815 cos_to_last_merge=0.9745 (last merge round=39)
[S2] round=93 local utility u=0.317516 metrics={'f1_val': 0.7220910329389756, 'auprc': 0.7133956260088217, 'loss_val': 0.9715856001563438, 'psi': 0.7186128701669141}-{'f1_val': 0.6338775345659153, 'auprc': 0.7540945845249448, 'loss_val': 1.1994333795651, 'psi': 0.6819643545495271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=93 head_norm_before_train=1.884432 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9951951181741213, 'loss_val': 0.13662572367521061, 'psi': 0.97474720161034}-{'f1_val': 0.9972888067730694, 'auprc': 0.9997698563329755, 'loss_val': 0.024028665165531912, 'psi': 0.9982812265970318}
[S4] START round=93 head_norm_before_train=2.400652 cos_to_last_merge=1.0000 (last merge round=92)
[S4] round=93 local utility u=0.000327 metrics={'f1_val': 0.9429910392178515, 'auprc': 0.9606878476480516, 'loss_val': 0.2960664873562319, 'psi': 0.9500697625899315}-{'f1_val': 0.9426495520586822, 'auprc': 0.960648154954922, 'loss_val': 0.294551556579497, 'psi': 0.9498489932171781}
[S5] START round=93 head_norm_before_train=1.974546 cos_to_last_merge=0.9997 (last merge round=89)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9379379380676908, 'auprc': 0.987636049223776, 'loss_val': 0.11695592484112986, 'psi': 0.9578171825301249}-{'f1_val': 0.9967768574880458, 'auprc': 0.9934753087704359, 'loss_val': 0.04606783633091438, 'psi': 0.9954562380010018}
[S6] START round=93 head_norm_before_train=2.162407 cos_to_last_merge=1.0000 (last merge round=92)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7504027146560849, 'auprc': 0.9189579898632443, 'loss_val': 0.8912136773161083, 'psi': 0.8178248247389487}-{'f1_val': 0.7998212898274486, 'auprc': 0.892053064365813, 'loss_val': 0.6552391467804171, 'psi': 0.8367139996427944}
[S7] START round=93 head_norm_before_train=1.884432 cos_to_last_merge=1.0000 (last merge round=92)
[S7] round=93 local utility u=0.110016 metrics={'f1_val': 0.6586778342645909, 'auprc': 0.8087914111659544, 'loss_val': 0.49477655916392793, 'psi': 0.7187232650251363}-{'f1_val': 0.6287896158305568, 'auprc': 0.8058836882086712, 'loss_val': 0.5267551152956795, 'psi': 0.6996272447818026}
[S8] START round=93 head_norm_before_train=2.159923 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.8322985379176204, 'auprc': 0.993114010007041, 'loss_val': 0.4603620969737167, 'psi': 0.8966247267533887}-{'f1_val': 0.9931808101287989, 'auprc': 0.9994105498428002, 'loss_val': 0.036612879071252054, 'psi': 0.9956727060143994}
[S9] START round=93 head_norm_before_train=2.046622 cos_to_last_merge=0.9839 (last merge round=34)
[S9] round=93 local utility u=0.043377 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984517411263905, 'loss_val': 0.019464472600446023, 'psi': 0.997377003538891}-{'f1_val': 0.9871446711497952, 'auprc': 0.998447346705335, 'loss_val': 0.049111094715134015, 'psi': 0.9916657413720111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=93 head_norm_before_train=2.482660 (no previous merge yet)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961124673115346, 'loss_val': 0.02509624532157796, 'psi': 0.995638859262852}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963026592320202, 'loss_val': 0.0247665471749284, 'psi': 0.9957149360310462}
[S11] START round=93 head_norm_before_train=2.400697 cos_to_last_merge=1.0000 (last merge round=89)
[S11] round=93 local utility u=0.000191 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990550056131429, 'loss_val': 0.016796778223151284, 'psi': 0.9975525552423155}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990552819901464, 'loss_val': 0.0171802104627048, 'psi': 0.9975526657931169}
[S13] START round=93 head_norm_before_train=2.147543 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6664924002727798, 'auprc': 0.7376880825571605, 'loss_val': 1.2428852296405744, 'psi': 0.694970673186532}-{'f1_val': 0.7471709284465108, 'auprc': 0.8573034612848702, 'loss_val': 1.0225802301140432, 'psi': 0.7912239415818545}
[S14] START round=93 head_norm_before_train=1.867769 cos_to_last_merge=0.9396 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=93 local utility u=0.045580 metrics={'f1_val': 0.9971404074438908, 'auprc': 0.9983665791594083, 'loss_val': 0.023754360277771433, 'psi': 0.9976308761300978}-{'f1_val': 0.984043579018347, 'auprc': 0.9979394896912434, 'loss_val': 0.0350527849516788, 'psi': 0.9896019432875056}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=93 head_norm_before_train=1.977160 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.888663639677141, 'auprc': 0.9958822947179873, 'loss_val': 0.29545256139818055, 'psi': 0.9315511016934795}-{'f1_val': 0.8921167952729744, 'auprc': 0.9959763670330523, 'loss_val': 0.2838208787060711, 'psi': 0.9336606239770056}
[S16] START round=93 head_norm_before_train=1.911738 cos_to_last_merge=0.9938 (last merge round=55)
[S16] round=93 local utility u=0.753163 metrics={'f1_val': 0.9809626923316529, 'auprc': 0.9871775002544426, 'loss_val': 0.07968665890586582, 'psi': 0.9834486155007687}-{'f1_val': 0.8713370806517888, 'auprc': 0.9355474152692594, 'loss_val': 0.7733696981386031, 'psi': 0.897021214498777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=93 head_norm_before_train=2.335424 cos_to_last_merge=0.7509 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=93 local utility u=0.068409 metrics={'f1_val': 0.8881509752621292, 'auprc': 0.9882784855254986, 'loss_val': 0.4531810607824316, 'psi': 0.928201979367477}-{'f1_val': 0.8729703216165221, 'auprc': 0.9860032856112392, 'loss_val': 0.49208896089885634, 'psi': 0.9181835072144089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:49304
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.719)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=93 metric=0.8887 head_norm=1.988138
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.934402e-02
[S15] stored merged vector for next round verification (round=93)
[S15] DEBUG after merge:  round=93 metric=0.8899 head_norm=1.981137 delta_norm=0.029344
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1792) from S11
[S4] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=93 metric=0.9966 head_norm=2.404874
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.274003e-02
[S11] stored merged vector for next round verification (round=93)
[S11] DEBUG after merge:  round=93 metric=0.9966 head_norm=2.401274 delta_norm=0.012740
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=93 metric=0.9430 head_norm=2.397737
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.274003e-02
[S4] stored merged vector for next round verification (round=93)
[S4] DEBUG after merge:  round=93 metric=0.9430 head_norm=2.401274 delta_norm=0.012740
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=1.945506 cos_to_last_merge=0.9743 (last merge round=39)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7224928149224414, 'auprc': 0.7093255000145398, 'loss_val': 1.019553098379434, 'psi': 0.7172258889592807}-{'f1_val': 0.7220910329389756, 'auprc': 0.7133956260088217, 'loss_val': 0.9715856001563438, 'psi': 0.7186128701669141}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=1.890715 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.7773166972028002, 'auprc': 0.9580739561736525, 'loss_val': 0.6344454177022018, 'psi': 0.8496196007911412}-{'f1_val': 0.9611152572344858, 'auprc': 0.9951951181741213, 'loss_val': 0.13662572367521061, 'psi': 0.97474720161034}
[S4] START round=94 head_norm_before_train=2.401274 cos_to_last_merge=1.0000 (last merge round=93)
[S4] round=94 local utility u=0.029356 metrics={'f1_val': 0.948406733961752, 'auprc': 0.9732263797793368, 'loss_val': 0.30746371341334494, 'psi': 0.9583345922887858}-{'f1_val': 0.9429910392178515, 'auprc': 0.9606878476480516, 'loss_val': 0.2960664873562319, 'psi': 0.9500697625899315}
[S5] START round=94 head_norm_before_train=1.980856 cos_to_last_merge=0.9995 (last merge round=89)
[S5] round=94 local utility u=0.223636 metrics={'f1_val': 0.9967768574880458, 'auprc': 0.9934121382411392, 'loss_val': 0.040044773537121596, 'psi': 0.9954309697892831}-{'f1_val': 0.9379379380676908, 'auprc': 0.987636049223776, 'loss_val': 0.11695592484112986, 'psi': 0.9578171825301249}
[S6] START round=94 head_norm_before_train=2.175094 cos_to_last_merge=1.0000 (last merge round=92)
[S6] round=94 local utility u=0.221627 metrics={'f1_val': 0.7763271743320567, 'auprc': 0.9469764235481748, 'loss_val': 0.6875613020312771, 'psi': 0.8445868740185039}-{'f1_val': 0.7504027146560849, 'auprc': 0.9189579898632443, 'loss_val': 0.8912136773161083, 'psi': 0.8178248247389487}
[S7] START round=94 head_norm_before_train=1.888998 cos_to_last_merge=1.0000 (last merge round=92)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6169808388492002, 'auprc': 0.7950225215527044, 'loss_val': 0.7683662952328496, 'psi': 0.6881975119306019}-{'f1_val': 0.6586778342645909, 'auprc': 0.8087914111659544, 'loss_val': 0.49477655916392793, 'psi': 0.7187232650251363}
[S8] START round=94 head_norm_before_train=2.166229 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=94 local utility u=0.689582 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9869221422807759, 'loss_val': 0.036707731952591124, 'psi': 0.9915564358699362}-{'f1_val': 0.8322985379176204, 'auprc': 0.993114010007041, 'loss_val': 0.4603620969737167, 'psi': 0.8966247267533887}
[S9] START round=94 head_norm_before_train=2.050237 cos_to_last_merge=0.9837 (last merge round=34)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9947237374179614, 'loss_val': 0.0207051825024544, 'psi': 0.9956395518347512}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984517411263905, 'loss_val': 0.019464472600446023, 'psi': 0.997377003538891}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.484798 (no previous merge yet)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961203016031446, 'loss_val': 0.025190999999329184, 'psi': 0.995641992979496}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961124673115346, 'loss_val': 0.02509624532157796, 'psi': 0.995638859262852}
[S11] START round=94 head_norm_before_train=2.401274 cos_to_last_merge=1.0000 (last merge round=93)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9931243966782941, 'auprc': 0.9990175821263261, 'loss_val': 0.02551568612992608, 'psi': 0.9954816708575069}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990550056131429, 'loss_val': 0.016796778223151284, 'psi': 0.9975525552423155}
[S13] START round=94 head_norm_before_train=2.155278 (no previous merge yet)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.5443940132007687, 'auprc': 0.5729146426525171, 'loss_val': 1.7468920870107116, 'psi': 0.5558022649814681}-{'f1_val': 0.6664924002727798, 'auprc': 0.7376880825571605, 'loss_val': 1.2428852296405744, 'psi': 0.694970673186532}
[S14] START round=94 head_norm_before_train=1.871042 cos_to_last_merge=0.9392 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9962952549510243, 'auprc': 0.9968807721166507, 'loss_val': 0.022665246617441372, 'psi': 0.9965294618172749}-{'f1_val': 0.9971404074438908, 'auprc': 0.9983665791594083, 'loss_val': 0.023754360277771433, 'psi': 0.9976308761300978}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=1.981137 cos_to_last_merge=1.0000 (last merge round=93)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8880593332849052, 'auprc': 0.9958672742659079, 'loss_val': 0.2964417772717767, 'psi': 0.9311825096773063}-{'f1_val': 0.888663639677141, 'auprc': 0.9958822947179873, 'loss_val': 0.29545256139818055, 'psi': 0.9315511016934795}
[S16] START round=94 head_norm_before_train=1.916118 cos_to_last_merge=0.9936 (last merge round=55)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.8591113150785398, 'auprc': 0.9855658900781057, 'loss_val': 0.5894765159932839, 'psi': 0.9096931450783661}-{'f1_val': 0.9809626923316529, 'auprc': 0.9871775002544426, 'loss_val': 0.07968665890586582, 'psi': 0.9834486155007687}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.342634 cos_to_last_merge=0.7508 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8887869632460581, 'auprc': 0.9452745430788919, 'loss_val': 0.45997221669338295, 'psi': 0.9113819951791916}-{'f1_val': 0.8881509752621292, 'auprc': 0.9882784855254986, 'loss_val': 0.4531810607824316, 'psi': 0.928201979367477}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:49307
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S4] not sending this round → trigger blocked (psi=0.958)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9996
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=94 metric=0.7763 head_norm=2.186211
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.035408e-02
[S6] stored merged vector for next round verification (round=94)
[S6] DEBUG after merge:  round=94 metric=0.7769 head_norm=2.179072 delta_norm=0.020354
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=94 metric=0.9946 head_norm=2.172101
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.035409e-02
[S8] stored merged vector for next round verification (round=94)
[S8] DEBUG after merge:  round=94 metric=0.9946 head_norm=2.179072 delta_norm=0.020354
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=95 head_norm_before_train=1.949875 cos_to_last_merge=0.9739 (last merge round=39)
[S2] round=95 local utility u=0.186598 metrics={'f1_val': 0.7160695494317324, 'auprc': 0.7901591373370271, 'loss_val': 0.8503176783546541, 'psi': 0.7457053845938503}-{'f1_val': 0.7224928149224414, 'auprc': 0.7093255000145398, 'loss_val': 1.019553098379434, 'psi': 0.7172258889592807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=95 head_norm_before_train=1.896110 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.6959459940925523, 'auprc': 0.9715957488159837, 'loss_val': 0.8656098109109818, 'psi': 0.8062058959819249}-{'f1_val': 0.7773166972028002, 'auprc': 0.9580739561736525, 'loss_val': 0.6344454177022018, 'psi': 0.8496196007911412}
[S4] START round=95 head_norm_before_train=2.399194 cos_to_last_merge=0.9999 (last merge round=93)
[S4] round=95 local utility u=0.034508 metrics={'f1_val': 0.9519598578778418, 'auprc': 0.9796521775247589, 'loss_val': 0.27904484191152357, 'psi': 0.9630367857366087}-{'f1_val': 0.948406733961752, 'auprc': 0.9732263797793368, 'loss_val': 0.30746371341334494, 'psi': 0.9583345922887858}
[S5] START round=95 head_norm_before_train=1.988446 cos_to_last_merge=0.9993 (last merge round=89)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9933427796392507, 'loss_val': 0.04854047696277277, 'psi': 0.9951826722689638}-{'f1_val': 0.9967768574880458, 'auprc': 0.9934121382411392, 'loss_val': 0.040044773537121596, 'psi': 0.9954309697892831}
[S6] START round=95 head_norm_before_train=2.179072 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.7778417075094277, 'auprc': 0.9423982414547216, 'loss_val': 0.8595361973453701, 'psi': 0.8436643210875452}-{'f1_val': 0.7763271743320567, 'auprc': 0.9469764235481748, 'loss_val': 0.6875613020312771, 'psi': 0.8445868740185039}
[S7] START round=95 head_norm_before_train=1.893325 cos_to_last_merge=1.0000 (last merge round=92)
[S7] round=95 local utility u=0.103940 metrics={'f1_val': 0.6247039954007718, 'auprc': 0.7997786086443149, 'loss_val': 0.6210943048452154, 'psi': 0.6947338406981891}-{'f1_val': 0.6169808388492002, 'auprc': 0.7950225215527044, 'loss_val': 0.7683662952328496, 'psi': 0.6881975119306019}
[S8] START round=95 head_norm_before_train=2.179072 cos_to_last_merge=1.0000 (last merge round=94)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9880725843114774, 'auprc': 0.9992720506726721, 'loss_val': 0.03941571690973568, 'psi': 0.9925523708559553}-{'f1_val': 0.9946459649293765, 'auprc': 0.9869221422807759, 'loss_val': 0.036707731952591124, 'psi': 0.9915564358699362}
[S9] START round=95 head_norm_before_train=2.054007 cos_to_last_merge=0.9835 (last merge round=34)
[S9] round=95 local utility u=0.007875 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9985067389027396, 'loss_val': 0.01874641860993636, 'psi': 0.9973969027407426}-{'f1_val': 0.9962500947792776, 'auprc': 0.9947237374179614, 'loss_val': 0.0207051825024544, 'psi': 0.9956395518347512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=95 head_norm_before_train=2.490773 (no previous merge yet)
[S10] round=95 local utility u=0.000402 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962931325407054, 'loss_val': 0.02490625239341384, 'psi': 0.9957111253545203}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961203016031446, 'loss_val': 0.025190999999329184, 'psi': 0.995641992979496}
[S11] START round=95 head_norm_before_train=2.405479 cos_to_last_merge=1.0000 (last merge round=93)
[S11] round=95 local utility u=0.016254 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990329390543057, 'loss_val': 0.016091918554147072, 'psi': 0.9977917295974685}-{'f1_val': 0.9931243966782941, 'auprc': 0.9990175821263261, 'loss_val': 0.02551568612992608, 'psi': 0.9954816708575069}
[S13] START round=95 head_norm_before_train=2.162152 (no previous merge yet)
[S13] round=95 local utility u=1.000000 metrics={'f1_val': 0.7200115546168524, 'auprc': 0.8861750099232518, 'loss_val': 1.2021461599547196, 'psi': 0.7864769367394122}-{'f1_val': 0.5443940132007687, 'auprc': 0.5729146426525171, 'loss_val': 1.7468920870107116, 'psi': 0.5558022649814681}
[S14] START round=95 head_norm_before_train=1.876079 cos_to_last_merge=0.9388 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=95 local utility u=0.006078 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.9981662105331586, 'loss_val': 0.019471418147208337, 'psi': 0.9975541737881324}-{'f1_val': 0.9962952549510243, 'auprc': 0.9968807721166507, 'loss_val': 0.022665246617441372, 'psi': 0.9965294618172749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=95 head_norm_before_train=1.991781 cos_to_last_merge=1.0000 (last merge round=93)
[S15] round=95 local utility u=0.013464 metrics={'f1_val': 0.8915209587659093, 'auprc': 0.9959620891174008, 'loss_val': 0.29056803049216984, 'psi': 0.933297410906506}-{'f1_val': 0.8880593332849052, 'auprc': 0.9958672742659079, 'loss_val': 0.2964417772717767, 'psi': 0.9311825096773063}
[S16] START round=95 head_norm_before_train=1.920432 cos_to_last_merge=0.9934 (last merge round=55)
[S16] round=95 local utility u=0.243875 metrics={'f1_val': 0.8956485248745611, 'auprc': 0.9883816375143646, 'loss_val': 0.3293963346161229, 'psi': 0.9327417699304825}-{'f1_val': 0.8591113150785398, 'auprc': 0.9855658900781057, 'loss_val': 0.5894765159932839, 'psi': 0.9096931450783661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=95 head_norm_before_train=2.343101 cos_to_last_merge=0.7503 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.750
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8750051894117913, 'auprc': 0.973778835211175, 'loss_val': 0.4910722111945322, 'psi': 0.9145146477315448}-{'f1_val': 0.8887869632460581, 'auprc': 0.9452745430788919, 'loss_val': 0.45997221669338295, 'psi': 0.9113819951791916}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S7] → sending delta(kind=head bytes=1811) to S3@127.0.0.1:49303
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.201 → S8@127.0.0.1:49309
[S5] ⇄ pheromone p=0.100 → S15@127.0.0.1:49315
[S7] sending update (kind=head size=1811 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] ⇄ pheromone p=0.121 → S6@127.0.0.1:49307
[S3] ⇄ pheromone p=0.185 → S7@127.0.0.1:49308
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0279
[S10] DROPPED delta from S13 (cos=-0.0279 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9998
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9995
[S3] RECEIVED delta(kind=head bytes=1811) from S7
[S3] cosine check vs S7: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.0279
[S13] DROPPED delta from S10 (cos=-0.0279 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9998
[S13] ⇄ pheromone p=0.332 → S10@127.0.0.1:49311
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=95 metric=0.8915 head_norm=2.002108
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.945461e-02
[S15] stored merged vector for next round verification (round=95)
[S15] DEBUG after merge:  round=95 metric=0.8921 head_norm=1.995071 delta_norm=0.029455
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.012 → S5@127.0.0.1:49305
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=95 metric=0.9970 head_norm=2.410113
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.581089e-02
[S11] stored merged vector for next round verification (round=95)
[S11] DEBUG after merge:  round=95 metric=0.9970 head_norm=2.404309 delta_norm=0.025811
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.007 → S4@127.0.0.1:49304
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=95 metric=0.9520 head_norm=2.398768
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.581091e-02
[S4] stored merged vector for next round verification (round=95)
[S4] DEBUG after merge:  round=95 metric=0.9520 head_norm=2.404309 delta_norm=0.025811
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.014 → S11@127.0.0.1:49312
[S7] ⇄ pheromone p=0.133 → S3@127.0.0.1:49303
[S2] START round=96 head_norm_before_train=1.954829 cos_to_last_merge=0.9736 (last merge round=39)
[S2] round=96 local utility u=0.161077 metrics={'f1_val': 0.7145363485854208, 'auprc': 0.861674552826838, 'loss_val': 0.7335115637432627, 'psi': 0.7733916302819877}-{'f1_val': 0.7160695494317324, 'auprc': 0.7901591373370271, 'loss_val': 0.8503176783546541, 'psi': 0.7457053845938503}
[S2] not sending this round → trigger blocked (psi=0.773)
[S3] START round=96 head_norm_before_train=1.900828 cos_to_last_merge=1.0000 (last merge round=92)
[S3] round=96 local utility u=0.116147 metrics={'f1_val': 0.7324353528455747, 'auprc': 0.9680546677664358, 'loss_val': 0.8416292985419659, 'psi': 0.8266830788139192}-{'f1_val': 0.6959459940925523, 'auprc': 0.9715957488159837, 'loss_val': 0.8656098109109818, 'psi': 0.8062058959819249}
[S4] START round=96 head_norm_before_train=2.404309 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.947713093688971, 'auprc': 0.9705183198804652, 'loss_val': 0.2797947575136665, 'psi': 0.9568351841655687}-{'f1_val': 0.9519598578778418, 'auprc': 0.9796521775247589, 'loss_val': 0.27904484191152357, 'psi': 0.9630367857366087}
[S5] START round=96 head_norm_before_train=1.994589 cos_to_last_merge=0.9992 (last merge round=89)
[S5] round=96 local utility u=0.004703 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9934649841577562, 'loss_val': 0.039500587354662935, 'psi': 0.9952315540763661}-{'f1_val': 0.9964092673554392, 'auprc': 0.9933427796392507, 'loss_val': 0.04854047696277277, 'psi': 0.9951826722689638}
[S6] START round=96 head_norm_before_train=2.187442 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.6844872369859729, 'auprc': 0.8119510114974893, 'loss_val': 1.051546799349526, 'psi': 0.7354727467905795}-{'f1_val': 0.7778417075094277, 'auprc': 0.9423982414547216, 'loss_val': 0.8595361973453701, 'psi': 0.8436643210875452}
[S7] START round=96 head_norm_before_train=1.896801 cos_to_last_merge=0.9999 (last merge round=92)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.6084753967107841, 'auprc': 0.7938896519041783, 'loss_val': 0.7919124401778137, 'psi': 0.6826410987881417}-{'f1_val': 0.6247039954007718, 'auprc': 0.7997786086443149, 'loss_val': 0.6210943048452154, 'psi': 0.6947338406981891}
[S8] START round=96 head_norm_before_train=2.184897 cos_to_last_merge=1.0000 (last merge round=94)
[S8] round=96 local utility u=0.021111 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9995295653613986, 'loss_val': 0.0291356260603266, 'psi': 0.9957722280654834}-{'f1_val': 0.9880725843114774, 'auprc': 0.9992720506726721, 'loss_val': 0.03941571690973568, 'psi': 0.9925523708559553}
[S9] START round=96 head_norm_before_train=2.052664 cos_to_last_merge=0.9833 (last merge round=34)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9984254914610684, 'loss_val': 0.03915336584856352, 'psi': 0.9931873014015519}-{'f1_val': 0.9966570119660778, 'auprc': 0.9985067389027396, 'loss_val': 0.01874641860993636, 'psi': 0.9973969027407426}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.497976 (no previous merge yet)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9960915395552528, 'loss_val': 0.02544671931968868, 'psi': 0.9956304881603393}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962931325407054, 'loss_val': 0.02490625239341384, 'psi': 0.9957111253545203}
[S11] START round=96 head_norm_before_train=2.404309 cos_to_last_merge=1.0000 (last merge round=95)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999044876084927, 'loss_val': 0.017544154660870018, 'psi': 0.9975485034310292}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990329390543057, 'loss_val': 0.016091918554147072, 'psi': 0.9977917295974685}
[S13] START round=96 head_norm_before_train=2.166832 (no previous merge yet)
[S13] round=96 local utility u=0.294942 metrics={'f1_val': 0.7761492395540411, 'auprc': 0.8805546431986864, 'loss_val': 0.9322273105333727, 'psi': 0.8179114010118993}-{'f1_val': 0.7200115546168524, 'auprc': 0.8861750099232518, 'loss_val': 1.2021461599547196, 'psi': 0.7864769367394122}
[S14] START round=96 head_norm_before_train=1.881446 cos_to_last_merge=0.9383 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=96 local utility u=0.000204 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.9981682706202208, 'loss_val': 0.01906888301666264, 'psi': 0.9975549978229572}-{'f1_val': 0.9971461492914482, 'auprc': 0.9981662105331586, 'loss_val': 0.019471418147208337, 'psi': 0.9975541737881324}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=96 head_norm_before_train=1.995071 cos_to_last_merge=1.0000 (last merge round=95)
[S15] round=96 local utility u=0.000427 metrics={'f1_val': 0.8915209587659093, 'auprc': 0.9959809630641294, 'loss_val': 0.2897703056453918, 'psi': 0.9333049604851974}-{'f1_val': 0.8915209587659093, 'auprc': 0.9959620891174008, 'loss_val': 0.29056803049216984, 'psi': 0.933297410906506}
[S16] START round=96 head_norm_before_train=1.925130 cos_to_last_merge=0.9933 (last merge round=55)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.7717273449910619, 'auprc': 0.9741793052028193, 'loss_val': 1.0344674348790397, 'psi': 0.8527081290757648}-{'f1_val': 0.8956485248745611, 'auprc': 0.9883816375143646, 'loss_val': 0.3293963346161229, 'psi': 0.9327417699304825}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.343313 cos_to_last_merge=0.7495 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=96 local utility u=0.110390 metrics={'f1_val': 0.8975267308783109, 'auprc': 0.957208752687137, 'loss_val': 0.3557116405808948, 'psi': 0.9213995396018413}-{'f1_val': 0.8750051894117913, 'auprc': 0.973778835211175, 'loss_val': 0.4910722111945322, 'psi': 0.9145146477315448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49307
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.933)
[S13] not sending this round → trigger blocked (psi=0.818)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:49308
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1805) from S3
[S7] cosine check vs S3: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=1.0000
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=96 metric=0.7324 head_norm=1.904394
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.500546e-02
[S3] stored merged vector for next round verification (round=96)
[S3] DEBUG after merge:  round=96 metric=0.7324 head_norm=1.900542 delta_norm=0.015005
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=96 metric=0.9964 head_norm=1.999128
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.389271e-02
[S5] stored merged vector for next round verification (round=96)
[S5] DEBUG after merge:  round=96 metric=0.9964 head_norm=2.000331 delta_norm=0.033893
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=1.959905 cos_to_last_merge=0.9735 (last merge round=39)
[S2] round=97 local utility u=0.068649 metrics={'f1_val': 0.710460183136989, 'auprc': 0.8666344323146515, 'loss_val': 0.5866360168764064, 'psi': 0.772929882808054}-{'f1_val': 0.7145363485854208, 'auprc': 0.861674552826838, 'loss_val': 0.7335115637432627, 'psi': 0.7733916302819877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=97 head_norm_before_train=1.900542 cos_to_last_merge=1.0000 (last merge round=96)
[S3] round=97 local utility u=0.824070 metrics={'f1_val': 0.8978833532749458, 'auprc': 0.9841160489383479, 'loss_val': 0.23436198200461172, 'psi': 0.9323764315403067}-{'f1_val': 0.7324353528455747, 'auprc': 0.9680546677664358, 'loss_val': 0.8416292985419659, 'psi': 0.8266830788139192}
[S4] START round=97 head_norm_before_train=2.409443 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=97 local utility u=0.050368 metrics={'f1_val': 0.9540234151790232, 'auprc': 0.9865168945570539, 'loss_val': 0.2649155732319977, 'psi': 0.9670208069302355}-{'f1_val': 0.947713093688971, 'auprc': 0.9705183198804652, 'loss_val': 0.2797947575136665, 'psi': 0.9568351841655687}
[S5] START round=97 head_norm_before_train=2.000331 cos_to_last_merge=1.0000 (last merge round=96)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9737941075548734, 'auprc': 0.9912299833886253, 'loss_val': 0.09653081902952759, 'psi': 0.9807684578883742}-{'f1_val': 0.9964092673554392, 'auprc': 0.9934649841577562, 'loss_val': 0.039500587354662935, 'psi': 0.9952315540763661}
[S6] START round=97 head_norm_before_train=2.196584 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=97 local utility u=0.549918 metrics={'f1_val': 0.7699263726551899, 'auprc': 0.9347400218288218, 'loss_val': 0.8327131576604293, 'psi': 0.8358518323246427}-{'f1_val': 0.6844872369859729, 'auprc': 0.8119510114974893, 'loss_val': 1.051546799349526, 'psi': 0.7354727467905795}
[S7] START round=97 head_norm_before_train=1.900601 cos_to_last_merge=0.9999 (last merge round=92)
[S7] round=97 local utility u=0.453929 metrics={'f1_val': 0.6700007882449402, 'auprc': 0.8305310341153693, 'loss_val': 0.3631315585171429, 'psi': 0.7342128865931119}-{'f1_val': 0.6084753967107841, 'auprc': 0.7938896519041783, 'loss_val': 0.7919124401778137, 'psi': 0.6826410987881417}
[S8] START round=97 head_norm_before_train=2.190727 cos_to_last_merge=1.0000 (last merge round=94)
[S8] round=97 local utility u=0.003167 metrics={'f1_val': 0.9942129748679404, 'auprc': 0.9992594313911431, 'loss_val': 0.02766529741730208, 'psi': 0.9962315574772215}-{'f1_val': 0.9932673365348732, 'auprc': 0.9995295653613986, 'loss_val': 0.0291356260603266, 'psi': 0.9957722280654834}
[S9] START round=97 head_norm_before_train=2.053974 cos_to_last_merge=0.9830 (last merge round=34)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9981861585102104, 'loss_val': 0.04382271725427119, 'psi': 0.9928373347869079}-{'f1_val': 0.9896951746952075, 'auprc': 0.9984254914610684, 'loss_val': 0.03915336584856352, 'psi': 0.9931873014015519}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.501199 (no previous merge yet)
[S10] round=97 local utility u=0.000403 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996154825899388, 'loss_val': 0.024829874310947495, 'psi': 0.9956558026979934}-{'f1_val': 0.9953231205637304, 'auprc': 0.9960915395552528, 'loss_val': 0.02544671931968868, 'psi': 0.9956304881603393}
[S11] START round=97 head_norm_before_train=2.408976 cos_to_last_merge=1.0000 (last merge round=95)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9940814807447171, 'auprc': 0.9991303354632041, 'loss_val': 0.022491506725667725, 'psi': 0.996101022632112}-{'f1_val': 0.9965509216617638, 'auprc': 0.999044876084927, 'loss_val': 0.017544154660870018, 'psi': 0.9975485034310292}
[S13] START round=97 head_norm_before_train=2.170119 (no previous merge yet)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6617814054853435, 'auprc': 0.9740183958413927, 'loss_val': 1.2102323094573382, 'psi': 0.7866762016277632}-{'f1_val': 0.7761492395540411, 'auprc': 0.8805546431986864, 'loss_val': 0.9322273105333727, 'psi': 0.8179114010118993}
[S14] START round=97 head_norm_before_train=1.886049 cos_to_last_merge=0.9378 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9981008948612339, 'loss_val': 0.02017672736902692, 'psi': 0.9972818787547468}-{'f1_val': 0.9971461492914482, 'auprc': 0.9981682706202208, 'loss_val': 0.01906888301666264, 'psi': 0.9975549978229572}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.005258 cos_to_last_merge=1.0000 (last merge round=95)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.8880593332849052, 'auprc': 0.9958758879938769, 'loss_val': 0.3021408192669708, 'psi': 0.9311859551684939}-{'f1_val': 0.8915209587659093, 'auprc': 0.9959809630641294, 'loss_val': 0.2897703056453918, 'psi': 0.9333049604851974}
[S16] START round=97 head_norm_before_train=1.929736 cos_to_last_merge=0.9931 (last merge round=55)
[S16] round=97 local utility u=1.000000 metrics={'f1_val': 0.9924973589780135, 'auprc': 0.9943418924773438, 'loss_val': 0.03838669405904893, 'psi': 0.9932351723777456}-{'f1_val': 0.7717273449910619, 'auprc': 0.9741793052028193, 'loss_val': 1.0344674348790397, 'psi': 0.8527081290757648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=97 head_norm_before_train=2.349233 cos_to_last_merge=0.7494 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.6929430690775235, 'auprc': 0.9825379607741085, 'loss_val': 1.1743672106163656, 'psi': 0.8087810257561575}-{'f1_val': 0.8975267308783109, 'auprc': 0.957208752687137, 'loss_val': 0.3557116405808948, 'psi': 0.9213995396018413}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:49303
[S3] not sending this round → trigger blocked (psi=0.932)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=97 metric=0.8881 head_norm=2.015120
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.589550e-02
[S15] stored merged vector for next round verification (round=97)
[S15] DEBUG after merge:  round=97 metric=0.8881 head_norm=2.006973 delta_norm=0.025896
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] cosine check vs S6: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.0274
[S13] DROPPED delta from S10 (cos=-0.0274 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=97 metric=0.6700 head_norm=1.904111
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.803619e-02
[S7] stored merged vector for next round verification (round=97)
[S7] DEBUG after merge:  round=97 metric=0.6697 head_norm=1.904167 delta_norm=0.018036
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=97 metric=0.7699 head_norm=2.205214
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.506032e-02
[S6] stored merged vector for next round verification (round=97)
[S6] DEBUG after merge:  round=97 metric=0.7699 head_norm=2.197931 delta_norm=0.015060
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=1.964267 cos_to_last_merge=0.9734 (last merge round=39)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7158200411496447, 'auprc': 0.7329868618604889, 'loss_val': 0.8028718053554819, 'psi': 0.7226867694339824}-{'f1_val': 0.710460183136989, 'auprc': 0.8666344323146515, 'loss_val': 0.5866360168764064, 'psi': 0.772929882808054}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=1.904639 cos_to_last_merge=1.0000 (last merge round=96)
[S3] round=98 local utility u=0.251314 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9940153313259965, 'loss_val': 0.1392938651537411, 'psi': 0.9741224272435731}-{'f1_val': 0.8978833532749458, 'auprc': 0.9841160489383479, 'loss_val': 0.23436198200461172, 'psi': 0.9323764315403067}
[S4] START round=98 head_norm_before_train=2.413788 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9526873157582252, 'auprc': 0.9711038891446112, 'loss_val': 0.2951446239647504, 'psi': 0.9600539451127796}-{'f1_val': 0.9540234151790232, 'auprc': 0.9865168945570539, 'loss_val': 0.2649155732319977, 'psi': 0.9670208069302355}
[S5] START round=98 head_norm_before_train=2.007105 cos_to_last_merge=1.0000 (last merge round=96)
[S5] round=98 local utility u=0.101806 metrics={'f1_val': 0.9967768574880458, 'auprc': 0.9935426165717121, 'loss_val': 0.03775333831991972, 'psi': 0.9954831611215122}-{'f1_val': 0.9737941075548734, 'auprc': 0.9912299833886253, 'loss_val': 0.09653081902952759, 'psi': 0.9807684578883742}
[S6] START round=98 head_norm_before_train=2.197931 cos_to_last_merge=1.0000 (last merge round=97)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.5730346350991725, 'auprc': 0.8057693510623488, 'loss_val': 1.6775540142236107, 'psi': 0.666128521484443}-{'f1_val': 0.7699263726551899, 'auprc': 0.9347400218288218, 'loss_val': 0.8327131576604293, 'psi': 0.8358518323246427}
[S7] START round=98 head_norm_before_train=1.904167 cos_to_last_merge=1.0000 (last merge round=97)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6359809326711995, 'auprc': 0.8055580512699354, 'loss_val': 0.481293163646787, 'psi': 0.7038117801106939}-{'f1_val': 0.6700007882449402, 'auprc': 0.8305310341153693, 'loss_val': 0.3631315585171429, 'psi': 0.7342128865931119}
[S8] START round=98 head_norm_before_train=2.196645 cos_to_last_merge=1.0000 (last merge round=94)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.999357400498498, 'loss_val': 0.035446405205270114, 'psi': 0.9945275813647112}-{'f1_val': 0.9942129748679404, 'auprc': 0.9992594313911431, 'loss_val': 0.02766529741730208, 'psi': 0.9962315574772215}
[S9] START round=98 head_norm_before_train=2.056378 cos_to_last_merge=0.9828 (last merge round=34)
[S9] round=98 local utility u=0.034295 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982421843084057, 'loss_val': 0.019734463133510453, 'psi': 0.9972931808116972}-{'f1_val': 0.9892714523047061, 'auprc': 0.9981861585102104, 'loss_val': 0.04382271725427119, 'psi': 0.9928373347869079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=98 head_norm_before_train=2.503517 (no previous merge yet)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9957023100158897, 'loss_val': 0.025358663880794982, 'psi': 0.995474796344594}-{'f1_val': 0.9953231205637304, 'auprc': 0.996154825899388, 'loss_val': 0.024829874310947495, 'psi': 0.9956558026979934}
[S11] START round=98 head_norm_before_train=2.412756 cos_to_last_merge=1.0000 (last merge round=95)
[S11] round=98 local utility u=0.012657 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991331371261647, 'loss_val': 0.01448298327375772, 'psi': 0.9978318088262121}-{'f1_val': 0.9940814807447171, 'auprc': 0.9991303354632041, 'loss_val': 0.022491506725667725, 'psi': 0.996101022632112}
[S13] START round=98 head_norm_before_train=2.167819 (no previous merge yet)
[S13] round=98 local utility u=0.110765 metrics={'f1_val': 0.7216709535847508, 'auprc': 0.8171830501286478, 'loss_val': 0.877533568049397, 'psi': 0.7598757922023096}-{'f1_val': 0.6617814054853435, 'auprc': 0.9740183958413927, 'loss_val': 1.2102323094573382, 'psi': 0.7866762016277632}
[S14] START round=98 head_norm_before_train=1.891718 cos_to_last_merge=0.9373 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=98 local utility u=0.000636 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9984468547093377, 'loss_val': 0.019942521463956503, 'psi': 0.9974202626939884}-{'f1_val': 0.9967358680170888, 'auprc': 0.9981008948612339, 'loss_val': 0.02017672736902692, 'psi': 0.9972818787547468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=98 head_norm_before_train=2.006973 cos_to_last_merge=1.0000 (last merge round=97)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.8868465346055179, 'auprc': 0.9958554988173057, 'loss_val': 0.3031776495472636, 'psi': 0.930450120290233}-{'f1_val': 0.8880593332849052, 'auprc': 0.9958758879938769, 'loss_val': 0.3021408192669708, 'psi': 0.9311859551684939}
[S16] START round=98 head_norm_before_train=1.935044 cos_to_last_merge=0.9929 (last merge round=55)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9918666712997605, 'auprc': 0.9926057737011812, 'loss_val': 0.03897919293743235, 'psi': 0.9921623122603287}-{'f1_val': 0.9924973589780135, 'auprc': 0.9943418924773438, 'loss_val': 0.03838669405904893, 'psi': 0.9932351723777456}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.354845 cos_to_last_merge=0.7493 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=98 local utility u=1.000000 metrics={'f1_val': 0.9063775086230574, 'auprc': 0.9885949860991761, 'loss_val': 0.4506817410205941, 'psi': 0.9392644996135049}-{'f1_val': 0.6929430690775235, 'auprc': 0.9825379607741085, 'loss_val': 1.1743672106163656, 'psi': 0.8087810257561575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=98 metric=0.9913 head_norm=2.200385
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.496037e-02
[S8] stored merged vector for next round verification (round=98)
[S8] DEBUG after merge:  round=98 metric=0.9913 head_norm=2.202750 delta_norm=0.014960
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0270
[S10] DROPPED delta from S13 (cos=-0.0270 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=1.0000
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=98 metric=0.9609 head_norm=1.910644
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.439864e-02
[S3] stored merged vector for next round verification (round=98)
[S3] DEBUG after merge:  round=98 metric=0.9609 head_norm=1.907326 delta_norm=0.014399
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=98 metric=0.9970 head_norm=2.416253
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.101391e-02
[S11] stored merged vector for next round verification (round=98)
[S11] DEBUG after merge:  round=98 metric=0.9970 head_norm=2.414996 delta_norm=0.011014
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=1.965204 cos_to_last_merge=0.9732 (last merge round=39)
[S2] round=99 local utility u=0.006940 metrics={'f1_val': 0.6882140569150317, 'auprc': 0.7730427459634928, 'loss_val': 0.74352306798555, 'psi': 0.7221455325344162}-{'f1_val': 0.7158200411496447, 'auprc': 0.7329868618604889, 'loss_val': 0.8028718053554819, 'psi': 0.7226867694339824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=100 psi=0.722 u=0.0069 p_local=0.0639 f1=0.688 auprc=0.773 bytes=82887
[S3] START round=99 head_norm_before_train=1.907326 cos_to_last_merge=1.0000 (last merge round=98)
[S3] round=99 local utility u=0.008991 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9994374946299699, 'loss_val': 0.13733652443411978, 'psi': 0.9762671897134687}-{'f1_val': 0.9608604911886242, 'auprc': 0.9940153313259965, 'loss_val': 0.1392938651537411, 'psi': 0.9741224272435731}
[S4] START round=99 head_norm_before_train=2.422460 cos_to_last_merge=1.0000 (last merge round=95)
[S4] round=99 local utility u=0.013939 metrics={'f1_val': 0.9504194945716978, 'auprc': 0.9791901910515247, 'loss_val': 0.27791809229741965, 'psi': 0.9619277731636287}-{'f1_val': 0.9526873157582252, 'auprc': 0.9711038891446112, 'loss_val': 0.2951446239647504, 'psi': 0.9600539451127796}
[S5] START round=99 head_norm_before_train=2.012576 cos_to_last_merge=1.0000 (last merge round=96)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9619668561725558, 'auprc': 0.9934110476435911, 'loss_val': 0.11651377713296113, 'psi': 0.97454453276097}-{'f1_val': 0.9967768574880458, 'auprc': 0.9935426165717121, 'loss_val': 0.03775333831991972, 'psi': 0.9954831611215122}
[S6] START round=99 head_norm_before_train=2.205086 cos_to_last_merge=1.0000 (last merge round=97)
[S6] round=99 local utility u=0.404300 metrics={'f1_val': 0.6290215385594717, 'auprc': 0.8003273603182917, 'loss_val': 1.1885500006107867, 'psi': 0.6975438672629997}-{'f1_val': 0.5730346350991725, 'auprc': 0.8057693510623488, 'loss_val': 1.6775540142236107, 'psi': 0.666128521484443}
[S7] START round=99 head_norm_before_train=1.907840 cos_to_last_merge=1.0000 (last merge round=97)
[S7] round=99 local utility u=0.464916 metrics={'f1_val': 0.6933136727300466, 'auprc': 0.9159352197514086, 'loss_val': 0.22658988048149686, 'psi': 0.7823622915385915}-{'f1_val': 0.6359809326711995, 'auprc': 0.8055580512699354, 'loss_val': 0.481293163646787, 'psi': 0.7038117801106939}
[S8] START round=99 head_norm_before_train=2.202750 cos_to_last_merge=1.0000 (last merge round=98)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9574282876713107, 'auprc': 0.9992515499419987, 'loss_val': 0.12516339890158373, 'psi': 0.9741575925795859}-{'f1_val': 0.9913077019421868, 'auprc': 0.999357400498498, 'loss_val': 0.035446405205270114, 'psi': 0.9945275813647112}
[S9] START round=99 head_norm_before_train=2.057289 cos_to_last_merge=0.9829 (last merge round=34)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969150656831297, 'loss_val': 0.019909711824747427, 'psi': 0.9967623333615867}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982421843084057, 'loss_val': 0.019734463133510453, 'psi': 0.9972931808116972}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.997 u=0.0000 p_local=0.0089 f1=0.997 auprc=0.997 bytes=79228
[S10] START round=99 head_norm_before_train=2.505313 (no previous merge yet)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956300327764147, 'loss_val': 0.02556267651222217, 'psi': 0.9954458854488041}-{'f1_val': 0.9953231205637304, 'auprc': 0.9957023100158897, 'loss_val': 0.025358663880794982, 'psi': 0.995474796344594}
[S11] START round=99 head_norm_before_train=2.414996 cos_to_last_merge=1.0000 (last merge round=98)
[S11] round=99 local utility u=0.000979 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9991085502001683, 'loss_val': 0.014934261782743312, 'psi': 0.998070271942683}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991331371261647, 'loss_val': 0.01448298327375772, 'psi': 0.9978318088262121}
[S13] START round=99 head_norm_before_train=2.172775 (no previous merge yet)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6274701461317014, 'auprc': 0.7134427292764939, 'loss_val': 1.4179692917346183, 'psi': 0.6618591793896184}-{'f1_val': 0.7216709535847508, 'auprc': 0.8171830501286478, 'loss_val': 0.877533568049397, 'psi': 0.7598757922023096}
[S14] START round=99 head_norm_before_train=1.895205 cos_to_last_merge=0.9371 (last merge round=33)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965155232876948, 'auprc': 0.9984556249210387, 'loss_val': 0.02123086491811504, 'psi': 0.9972915639410322}-{'f1_val': 0.9967358680170888, 'auprc': 0.9984468547093377, 'loss_val': 0.019942521463956503, 'psi': 0.9974202626939884}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.997 u=0.0000 p_local=0.0077 f1=0.997 auprc=0.998 bytes=75606
[S15] START round=99 head_norm_before_train=2.016703 cos_to_last_merge=1.0000 (last merge round=97)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.8856281088240949, 'auprc': 0.9958593188285078, 'loss_val': 0.30740588966178095, 'psi': 0.9297205928258601}-{'f1_val': 0.8868465346055179, 'auprc': 0.9958554988173057, 'loss_val': 0.3031776495472636, 'psi': 0.930450120290233}
[S16] START round=99 head_norm_before_train=1.939198 cos_to_last_merge=0.9928 (last merge round=55)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9905705886875666, 'auprc': 0.9802481856677403, 'loss_val': 0.049328418866987966, 'psi': 0.986441627479636}-{'f1_val': 0.9918666712997605, 'auprc': 0.9926057737011812, 'loss_val': 0.03897919293743235, 'psi': 0.9921623122603287}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.986 u=0.0000 p_local=0.2171 f1=0.991 auprc=0.980 bytes=82782
[S17] START round=99 head_norm_before_train=2.361419 cos_to_last_merge=0.7493 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8600970908331789, 'auprc': 0.9867057057068686, 'loss_val': 0.6138255775889674, 'psi': 0.9107405367826547}-{'f1_val': 0.9063775086230574, 'auprc': 0.9885949860991761, 'loss_val': 0.4506817410205941, 'psi': 0.9392644996135049}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.911 u=0.0000 p_local=0.1889 f1=0.860 auprc=0.987 bytes=82711
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:49303
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[S3] not sending this round → trigger blocked (psi=0.976)
[S6] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=99 metric=0.8856 head_norm=2.026248
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.080136e-02
[S15] stored merged vector for next round verification (round=99)
[S15] DEBUG after merge:  round=99 metric=0.8856 head_norm=2.019395 delta_norm=0.010801
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=100 psi=0.930 u=0.0000 p_local=0.0050 f1=0.886 auprc=0.996 bytes=75658
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] r=100 psi=0.976 u=0.0090 p_local=0.2350 f1=0.961 auprc=0.999 bytes=77436
[S8] r=100 psi=0.974 u=0.0000 p_local=0.0520 f1=0.957 auprc=0.999 bytes=84464
[S5] r=100 psi=0.975 u=0.0000 p_local=0.0578 f1=0.962 auprc=0.993 bytes=81035
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.996 bytes=84549
[S11] r=100 psi=0.998 u=0.0010 p_local=0.0051 f1=0.997 auprc=0.999 bytes=91680
[S13] r=100 psi=0.662 u=0.0000 p_local=0.1840 f1=0.627 auprc=0.713 bytes=73763
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=99 metric=0.6933 head_norm=1.913148
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.957126e-03
[S7] stored merged vector for next round verification (round=99)
[S7] DEBUG after merge:  round=99 metric=0.6932 head_norm=1.911871 delta_norm=0.009957
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] r=100 psi=0.782 u=0.4649 p_local=0.2055 f1=0.693 auprc=0.916 bytes=82915
[S6] r=100 psi=0.698 u=0.4043 p_local=0.2336 f1=0.629 auprc=0.800 bytes=84539
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=99 metric=0.9504 head_norm=2.430295
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.892122e-02
[S4] stored merged vector for next round verification (round=99)
[S4] DEBUG after merge:  round=99 metric=0.9504 head_norm=2.423210 delta_norm=0.018921
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=100 psi=0.962 u=0.0139 p_local=0.0151 f1=0.950 auprc=0.979 bytes=84463
[runner] rounds complete.
[runner] all agents stopped.
