[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:59803
[S3] → join 127.0.0.1:59802
[S4] → join 127.0.0.1:59802
[S5] → join 127.0.0.1:59802
[S6] → join 127.0.0.1:59802
[S7] → join 127.0.0.1:59802
[S8] → join 127.0.0.1:59802
[S9] → join 127.0.0.1:59802
[S10] → join 127.0.0.1:59802
[S11] → join 127.0.0.1:59802
[S13] → join 127.0.0.1:59802
[S14] → join 127.0.0.1:59802
[S15] → join 127.0.0.1:59802
[S16] → join 127.0.0.1:59802
[S17] → join 127.0.0.1:59802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.123614 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.204117 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.165780 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.154542 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.228776 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.160973 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.162879 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.149947 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.129990 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.235080 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.188982 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.139760 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.173395 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.157252 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.189201 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S15
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S13
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S15
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S8
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S17
[S6] + discovered S5
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S5
[S6] + discovered S13
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S15
[S7] + discovered S4
[S6] + discovered S17
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S6
[S7] + discovered S9
[S8] + discovered S5
[S7] + discovered S11
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S8
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S14
[S9] + discovered S8
[S9] + discovered S3
[S8] + discovered S17
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S6
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S13
[S10] + discovered S2
[S9] + discovered S17
[S10] + discovered S4
[S9] + discovered S16
[S10] + discovered S8
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S15
[S10] + discovered S3
[S9] + discovered S10
[S10] + discovered S6
[S9] + discovered S14
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S11
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S4
[S10] + discovered S13
[S10] + discovered S17
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S6
[S13] + discovered S7
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S9
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S5
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S10
[S14] + discovered S15
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S8
[S14] + discovered S17
[S15] + discovered S7
[S14] + discovered S16
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S2
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S10
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S6
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:59815
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:59802
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:59812
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S2] START round=1 head_norm_before_train=1.129361 (no previous merge yet)
[S2] round=1 local utility u=0.089406 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7159758516702701, 'loss_val': 1.2671470429906966, 'psi': 0.3714566207012481}-{'f1_val': 0.1417771333885667, 'auprc': 0.6816303633319204, 'loss_val': 1.3429222007958357, 'psi': 0.3577184253659082}
[S3] START round=1 head_norm_before_train=1.210015 (no previous merge yet)
[S3] round=1 local utility u=0.126006 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7805149080456789, 'loss_val': 1.3420536199644346, 'psi': 0.3961100025867358}-{'f1_val': 0.13254555808656038, 'auprc': 0.7232556648618783, 'loss_val': 1.3785212666763833, 'psi': 0.3688296007966876}
[S4] START round=1 head_norm_before_train=1.179205 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7690306119078771, 'loss_val': 1.2655985760001458, 'psi': 0.39174822210026133}-{'f1_val': 0.39998081813502895, 'auprc': 0.7365834976981487, 'loss_val': 1.3487267518005939, 'psi': 0.5346218899602768}
[S5] START round=1 head_norm_before_train=1.160041 (no previous merge yet)
[S5] round=1 local utility u=0.132047 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289517543824326, 'loss_val': 1.3056522971349227, 'psi': 0.3769378446101159}-{'f1_val': 0.10410718207775094, 'auprc': 0.727466846763352, 'loss_val': 1.3363626307552516, 'psi': 0.35345104795199134}
[S6] START round=1 head_norm_before_train=1.240018 (no previous merge yet)
[S6] round=1 local utility u=0.037035 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8691373750954225, 'loss_val': 1.2880245786438402, 'psi': 0.43251071926893825}-{'f1_val': 0.14142628205128205, 'auprc': 0.8626889724282618, 'loss_val': 1.3427493933557006, 'psi': 0.42993135820207395}
[S7] START round=1 head_norm_before_train=1.162083 (no previous merge yet)
[S7] round=1 local utility u=0.079901 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6333855189211561, 'loss_val': 1.3440693994729525, 'psi': 0.33858830120591743}-{'f1_val': 0.14205682272909165, 'auprc': 0.5907516403326055, 'loss_val': 1.3759688179712546, 'psi': 0.32153474977049723}
[S8] START round=1 head_norm_before_train=1.186667 (no previous merge yet)
[S8] round=1 local utility u=0.056623 metrics={'f1_val': 0.22786158658513667, 'auprc': 0.7683401861216373, 'loss_val': 1.2377134071550135, 'psi': 0.444053026399737}-{'f1_val': 0.21700651676302124, 'auprc': 0.7772151642738696, 'loss_val': 1.3124547078899307, 'psi': 0.4410899757673606}
[S9] START round=1 head_norm_before_train=1.147938 (no previous merge yet)
[S9] round=1 local utility u=0.398704 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6997611192499603, 'loss_val': 1.3286054955550033, 'psi': 0.36474322198398174}-{'f1_val': 0.141397957139996, 'auprc': 0.44474098513576954, 'loss_val': 1.3609524177244785, 'psi': 0.2627351683383054}
[S10] START round=1 head_norm_before_train=1.144233 (no previous merge yet)
[S10] round=1 local utility u=0.000045 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5976360730684549, 'loss_val': 1.2737404517216793, 'psi': 0.3222274117524163}-{'f1_val': 0.13862163754172394, 'auprc': 0.6142029978678236, 'loss_val': 1.3235318275015922, 'psi': 0.32885418167216385}
[S11] START round=1 head_norm_before_train=1.241431 (no previous merge yet)
[S11] round=1 local utility u=0.216196 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5690342822915115, 'loss_val': 1.3293338898871847, 'psi': 0.311861922940471}-{'f1_val': 0.08347009236839745, 'auprc': 0.551930155892379, 'loss_val': 1.3687528307995764, 'psi': 0.27085411777799007}
[S13] START round=1 head_norm_before_train=1.202552 (no previous merge yet)
[S13] round=1 local utility u=0.187287 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.5637559647564644, 'loss_val': 1.2872839971324532, 'psi': 0.4751491142313607}-{'f1_val': 0.3751825651088718, 'auprc': 0.5429080568576627, 'loss_val': 1.3539417588014888, 'psi': 0.44227276180838815}
[S14] START round=1 head_norm_before_train=1.138818 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6267721255748064, 'loss_val': 1.354636169400713, 'psi': 0.3349235619595448}-{'f1_val': 0.46311416957445417, 'auprc': 0.6359471579592041, 'loss_val': 1.380336158265688, 'psi': 0.5322473649283541}
[S15] START round=1 head_norm_before_train=1.185108 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7760513154804879, 'loss_val': 1.2858180359220026, 'psi': 0.3942607170091302}-{'f1_val': 0.7147828364644235, 'auprc': 0.7728017553760513, 'loss_val': 1.3483101768870582, 'psi': 0.7379904040290746}
[S16] START round=1 head_norm_before_train=1.155876 (no previous merge yet)
[S16] round=1 local utility u=0.693421 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7404775177611695, 'loss_val': 1.3250943256816514, 'psi': 0.3805734772239897}-{'f1_val': 0.14063745019920318, 'auprc': 0.28694869761041286, 'loss_val': 1.3513503022731328, 'psi': 0.19916194916368707}
[S17] START round=1 head_norm_before_train=1.209793 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5467910938275637, 'loss_val': 1.2683700735059686, 'psi': 0.30328581552145617}-{'f1_val': 0.38935982586834833, 'auprc': 0.5299706956026411, 'loss_val': 1.3497969184658463, 'psi': 0.4456041737620654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:59811
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:59809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S11] → sending delta(kind=head bytes=1784) to S4@127.0.0.1:59804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:59811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:59809
[S13] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1784 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S16
[S10] cosine check vs S16: cos=-0.0633
[S10] DROPPED delta from S16 (cos=-0.0633 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] cosine check vs S7: cos=0.0165
[S8] RECEIVED delta(kind=head bytes=1791) from S9
[S8] cosine check vs S9: cos=0.0316
[S17] RECEIVED delta(kind=head bytes=1791) from S10
[S17] cosine check vs S10: cos=-0.0596
[S17] DROPPED delta from S10 (cos=-0.0596 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.0062
[S11] RECEIVED delta(kind=head bytes=1792) from S5
[S11] cosine check vs S5: cos=0.0374
[S10] RECEIVED delta(kind=head bytes=1792) from S3
[S10] cosine check vs S3: cos=0.1202
[S4] RECEIVED delta(kind=head bytes=1784) from S11
[S4] cosine check vs S11: cos=0.0192
[S14] RECEIVED delta(kind=head bytes=1790) from S6
[S14] cosine check vs S6: cos=0.0341
[S2] RECEIVED delta(kind=head bytes=1792) from S13
[S2] cosine check vs S13: cos=-0.1634
[S2] DROPPED delta from S13 (cos=-0.1634 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S2
[S14] cosine check vs S2: cos=-0.0874
[S14] DROPPED delta from S2 (cos=-0.0874 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.147511
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.444403e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.2583 head_norm=0.873593 delta_norm=0.844440
[S14] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.224263
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.692340e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1416 head_norm=0.886120 delta_norm=0.869234
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.258067
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.456384e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.2605 head_norm=0.877824 delta_norm=0.845638
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.2279 head_norm=1.231279
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.186831e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.2260 head_norm=0.742224 delta_norm=0.718683
[S8] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.178873
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.972233e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.899471 delta_norm=0.797223
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.264154
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.796230e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.885060 delta_norm=0.879623
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.166225 (no previous merge yet)
[S2] round=2 local utility u=0.076639 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7405634681662487, 'loss_val': 1.187632634921001, 'psi': 0.38129166729963954}-{'f1_val': 0.1417771333885667, 'auprc': 0.7159758516702701, 'loss_val': 1.2671470429906966, 'psi': 0.3714566207012481}
[S3] START round=2 head_norm_before_train=1.224535 (no previous merge yet)
[S3] round=2 local utility u=0.138831 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.858307036400039, 'loss_val': 1.2977688325348025, 'psi': 0.4272268539284798}-{'f1_val': 0.13984006561410703, 'auprc': 0.7805149080456789, 'loss_val': 1.3420536199644346, 'psi': 0.3961100025867358}
[S4] START round=2 head_norm_before_train=0.886120 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.890807 metrics={'f1_val': 0.4129606442836827, 'auprc': 0.7891945785390171, 'loss_val': 1.1808805740454054, 'psi': 0.5634542179858164}-{'f1_val': 0.14022662889518414, 'auprc': 0.7690306119078771, 'loss_val': 1.2655985760001458, 'psi': 0.39174822210026133}
[S5] START round=2 head_norm_before_train=1.178400 (no previous merge yet)
[S5] round=2 local utility u=0.025112 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7341477062905711, 'loss_val': 1.2710170223783912, 'psi': 0.3790162253733713}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289517543824326, 'loss_val': 1.3056522971349227, 'psi': 0.3769378446101159}
[S6] START round=2 head_norm_before_train=1.278947 (no previous merge yet)
[S6] round=2 local utility u=0.025191 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8688802597427561, 'loss_val': 1.2368720203565926, 'psi': 0.43240787312787166}-{'f1_val': 0.14142628205128205, 'auprc': 0.8691373750954225, 'loss_val': 1.2880245786438402, 'psi': 0.43251071926893825}
[S7] START round=2 head_norm_before_train=1.173870 (no previous merge yet)
[S7] round=2 local utility u=0.248660 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7869105220498284, 'loss_val': 1.3073245828367213, 'psi': 0.3999983024573864}-{'f1_val': 0.14205682272909165, 'auprc': 0.6333855189211561, 'loss_val': 1.3440693994729525, 'psi': 0.33858830120591743}
[S8] START round=2 head_norm_before_train=0.742224 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.422790 metrics={'f1_val': 0.35853132431938, 'auprc': 0.7660948208654712, 'loss_val': 1.1694153301966308, 'psi': 0.5215567229378165}-{'f1_val': 0.22786158658513667, 'auprc': 0.7683401861216373, 'loss_val': 1.2377134071550135, 'psi': 0.444053026399737}
[S9] START round=2 head_norm_before_train=1.156519 (no previous merge yet)
[S9] round=2 local utility u=0.261586 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8617869450476516, 'loss_val': 1.2915105377834295, 'psi': 0.4295535523030583}-{'f1_val': 0.141397957139996, 'auprc': 0.6997611192499603, 'loss_val': 1.3286054955550033, 'psi': 0.36474322198398174}
[S10] START round=2 head_norm_before_train=0.899471 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.050632 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6178072882698837, 'loss_val': 1.2329902968293158, 'psi': 0.33029589783298785}-{'f1_val': 0.13862163754172394, 'auprc': 0.5976360730684549, 'loss_val': 1.2737404517216793, 'psi': 0.3222274117524163}
[S11] START round=2 head_norm_before_train=0.877824 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.259135 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7391218891605043, 'loss_val': 1.3213276487862124, 'psi': 0.3798969656880681}-{'f1_val': 0.14041368337311058, 'auprc': 0.5690342822915115, 'loss_val': 1.3293338898871847, 'psi': 0.311861922940471}
[S13] START round=2 head_norm_before_train=1.236864 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.30130666302822096, 'auprc': 0.7115157584751015, 'loss_val': 1.177348449943735, 'psi': 0.4653903012069732}-{'f1_val': 0.41607788054795825, 'auprc': 0.5637559647564644, 'loss_val': 1.2872839971324532, 'psi': 0.4751491142313607}
[S14] START round=2 head_norm_before_train=0.873593 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14711398207959991, 'auprc': 0.5868632590205931, 'loss_val': 1.347720555899288, 'psi': 0.3230136928559972}-{'f1_val': 0.14035785288270378, 'auprc': 0.6267721255748064, 'loss_val': 1.354636169400713, 'psi': 0.3349235619595448}
[S15] START round=2 head_norm_before_train=1.230422 (no previous merge yet)
[S15] round=2 local utility u=0.039110 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770543745240776, 'loss_val': 1.2106073483494848, 'psi': 0.39466194062656607}-{'f1_val': 0.13973365136155833, 'auprc': 0.7760513154804879, 'loss_val': 1.2858180359220026, 'psi': 0.3942607170091302}
[S16] START round=2 head_norm_before_train=1.164464 (no previous merge yet)
[S16] round=2 local utility u=0.073057 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7787611936119485, 'loss_val': 1.2938319654494501, 'psi': 0.3958869475643013}-{'f1_val': 0.14063745019920318, 'auprc': 0.7404775177611695, 'loss_val': 1.3250943256816514, 'psi': 0.3805734772239897}
[S17] START round=2 head_norm_before_train=0.885060 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.027715 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5373384843526723, 'loss_val': 1.1845826405117783, 'psi': 0.2995047717314996}-{'f1_val': 0.14094896331738438, 'auprc': 0.5467910938275637, 'loss_val': 1.2683700735059686, 'psi': 0.30328581552145617}
[S3] not sending this round → trigger blocked (psi=0.427)
[S16] not sending this round → trigger blocked (psi=0.396)
[S5] not sending this round → trigger blocked (psi=0.379)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:59817
[S7] not sending this round → trigger blocked (psi=0.400)
[S9] not sending this round → trigger blocked (psi=0.430)
[S6] not sending this round → trigger blocked (psi=0.432)
[S2] not sending this round → trigger blocked (psi=0.381)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.522)
[S10] not sending this round → trigger blocked (psi=0.330)
[S11] not sending this round → trigger blocked (psi=0.380)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S4
[S6] cosine check vs S4: cos=0.0350
[S17] RECEIVED delta(kind=head bytes=1796) from S15
[S17] cosine check vs S15: cos=-0.0693
[S17] DROPPED delta from S15 (cos=-0.0693 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=-0.0034
[S6] DROPPED delta from S17 (cos=-0.0034 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.329883
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.040648e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.831175 delta_norm=0.804065
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.205775 (no previous merge yet)
[S2] round=3 local utility u=0.901953 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7490312736839396, 'loss_val': 1.0524884886908104, 'psi': 0.5490146901079784}-{'f1_val': 0.1417771333885667, 'auprc': 0.7405634681662487, 'loss_val': 1.187632634921001, 'psi': 0.38129166729963954}
[S3] START round=3 head_norm_before_train=1.247982 (no previous merge yet)
[S3] round=3 local utility u=0.045936 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8743770493565762, 'loss_val': 1.2541072697131619, 'psi': 0.4336548591110947}-{'f1_val': 0.13984006561410703, 'auprc': 0.858307036400039, 'loss_val': 1.2977688325348025, 'psi': 0.4272268539284798}
[S4] START round=3 head_norm_before_train=0.951922 cos_to_last_merge=0.9919 (last merge round=1)
[S4] round=3 local utility u=0.144679 metrics={'f1_val': 0.414477594885967, 'auprc': 0.7904360505337149, 'loss_val': 0.9043479670580253, 'psi': 0.5648609771450661}-{'f1_val': 0.4129606442836827, 'auprc': 0.7891945785390171, 'loss_val': 1.1808805740454054, 'psi': 0.5634542179858164}
[S5] START round=3 head_norm_before_train=1.201584 (no previous merge yet)
[S5] round=3 local utility u=0.041498 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7478182112792098, 'loss_val': 1.229031547468546, 'psi': 0.38448442736882676}-{'f1_val': 0.14226190476190476, 'auprc': 0.7341477062905711, 'loss_val': 1.2710170223783912, 'psi': 0.3790162253733713}
[S6] START round=3 head_norm_before_train=0.831175 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8381053258767094, 'loss_val': 1.2091359366124146, 'psi': 0.420097899581453}-{'f1_val': 0.14142628205128205, 'auprc': 0.8688802597427561, 'loss_val': 1.2368720203565926, 'psi': 0.43240787312787166}
[S7] START round=3 head_norm_before_train=1.193016 (no previous merge yet)
[S7] round=3 local utility u=0.024395 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7890726703551931, 'loss_val': 1.265021057370802, 'psi': 0.40086316177953224}-{'f1_val': 0.14205682272909165, 'auprc': 0.7869105220498284, 'loss_val': 1.3073245828367213, 'psi': 0.3999983024573864}
[S8] START round=3 head_norm_before_train=0.807769 cos_to_last_merge=0.9915 (last merge round=1)
[S8] round=3 local utility u=0.161954 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.776768196697641, 'loss_val': 0.9647350661635741, 'psi': 0.5345469147889211}-{'f1_val': 0.35853132431938, 'auprc': 0.7660948208654712, 'loss_val': 1.1694153301966308, 'psi': 0.5215567229378165}
[S9] START round=3 head_norm_before_train=1.175898 (no previous merge yet)
[S9] round=3 local utility u=0.049819 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8774682381402863, 'loss_val': 1.2389168982063468, 'psi': 0.43582606954011216}-{'f1_val': 0.141397957139996, 'auprc': 0.8617869450476516, 'loss_val': 1.2915105377834295, 'psi': 0.4295535523030583}
[S10] START round=3 head_norm_before_train=0.948758 cos_to_last_merge=0.9941 (last merge round=1)
[S10] round=3 local utility u=0.577637 metrics={'f1_val': 0.2955878733531737, 'auprc': 0.6470510741179565, 'loss_val': 1.1072447064866293, 'psi': 0.4361731536590868}-{'f1_val': 0.13862163754172394, 'auprc': 0.6178072882698837, 'loss_val': 1.2329902968293158, 'psi': 0.33029589783298785}
[S11] START round=3 head_norm_before_train=0.896435 cos_to_last_merge=0.9969 (last merge round=1)
[S11] round=3 local utility u=0.027586 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7441961701172878, 'loss_val': 1.2813792686122938, 'psi': 0.38192667807078146}-{'f1_val': 0.14041368337311058, 'auprc': 0.7391218891605043, 'loss_val': 1.3213276487862124, 'psi': 0.3798969656880681}
[S13] START round=3 head_norm_before_train=1.293958 (no previous merge yet)
[S13] round=3 local utility u=0.378539 metrics={'f1_val': 0.37593223485494665, 'auprc': 0.7485691519845792, 'loss_val': 0.979183437774617, 'psi': 0.5249870017067997}-{'f1_val': 0.30130666302822096, 'auprc': 0.7115157584751015, 'loss_val': 1.177348449943735, 'psi': 0.4653903012069732}
[S14] START round=3 head_norm_before_train=0.891013 cos_to_last_merge=0.9976 (last merge round=1)
[S14] round=3 local utility u=0.106118 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6634500352917787, 'loss_val': 1.3247084029807807, 'psi': 0.3495947258463337}-{'f1_val': 0.14711398207959991, 'auprc': 0.5868632590205931, 'loss_val': 1.347720555899288, 'psi': 0.3230136928559972}
[S15] START round=3 head_norm_before_train=1.283961 (no previous merge yet)
[S15] round=3 local utility u=0.922695 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7938295472185517, 'loss_val': 1.0753959546006824, 'psi': 0.5673573225917872}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770543745240776, 'loss_val': 1.2106073483494848, 'psi': 0.39466194062656607}
[S16] START round=3 head_norm_before_train=1.184523 (no previous merge yet)
[S16] round=3 local utility u=0.030259 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7869224549586782, 'loss_val': 1.2577970657196829, 'psi': 0.3991514521029932}-{'f1_val': 0.14063745019920318, 'auprc': 0.7787611936119485, 'loss_val': 1.2938319654494501, 'psi': 0.3958869475643013}
[S17] START round=3 head_norm_before_train=0.953315 cos_to_last_merge=0.9913 (last merge round=1)
[S17] round=3 local utility u=0.852555 metrics={'f1_val': 0.39025761034410505, 'auprc': 0.5476114563697354, 'loss_val': 1.006144375961451, 'psi': 0.4531991487543572}-{'f1_val': 0.14094896331738438, 'auprc': 0.5373384843526723, 'loss_val': 1.1845826405117783, 'psi': 0.2995047717314996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:59804
[S15] not sending this round → trigger blocked (psi=0.567)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[S4] not sending this round → trigger blocked (psi=0.565)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=-0.0475
[S2] DROPPED delta from S3 (cos=-0.0475 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=0.0581
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.0113
[S6] RECEIVED delta(kind=head bytes=1791) from S7
[S6] cosine check vs S7: cos=0.1680
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] cosine check vs S14: cos=0.0832
[S6] RECEIVED delta(kind=head bytes=1791) from S8
[S6] cosine check vs S8: cos=-0.0044
[S6] DROPPED delta from S8 (cos=-0.0044 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S13
[S9] cosine check vs S13: cos=0.0602
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=-0.0645
[S9] DROPPED delta from S5 (cos=-0.0645 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S16
[S4] cosine check vs S16: cos=0.0523
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=-0.0967
[S9] DROPPED delta from S11 (cos=-0.0967 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] cosine check vs S10: cos=-0.0242
[S4] DROPPED delta from S10 (cos=-0.0242 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.453)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.890756
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.714756e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.2021 head_norm=0.651241 delta_norm=0.571476
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4145 head_norm=1.030893
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.751027e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4142 head_norm=0.816171 delta_norm=0.775103
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.917751
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.359397e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.778385 delta_norm=0.735940
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.924949
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.238202e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.678046 delta_norm=0.623820
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.205286
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.783902e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.932633 delta_norm=0.878390
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.243875 (no previous merge yet)
[S2] round=4 local utility u=0.814629 metrics={'f1_val': 0.7016303682990106, 'auprc': 0.6474089182790723, 'loss_val': 0.8341235106852091, 'psi': 0.6799417882910352}-{'f1_val': 0.4156703010573377, 'auprc': 0.7490312736839396, 'loss_val': 1.0524884886908104, 'psi': 0.5490146901079784}
[S3] START round=4 head_norm_before_train=1.278440 (no previous merge yet)
[S3] round=4 local utility u=0.044652 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8919887266627573, 'loss_val': 1.2176387374801325, 'psi': 0.4406995300335672}-{'f1_val': 0.13984006561410703, 'auprc': 0.8743770493565762, 'loss_val': 1.2541072697131619, 'psi': 0.4336548591110947}
[S4] START round=4 head_norm_before_train=0.816171 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.854486 metrics={'f1_val': 0.6833162456881462, 'auprc': 0.7838556331553316, 'loss_val': 0.7886662615059347, 'psi': 0.7235320006750203}-{'f1_val': 0.414477594885967, 'auprc': 0.7904360505337149, 'loss_val': 0.9043479670580253, 'psi': 0.5648609771450661}
[S5] START round=4 head_norm_before_train=1.227409 (no previous merge yet)
[S5] round=4 local utility u=0.062560 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700122791853333, 'loss_val': 1.170492929707823, 'psi': 0.3933620545312762}-{'f1_val': 0.14226190476190476, 'auprc': 0.7478182112792098, 'loss_val': 1.229031547468546, 'psi': 0.38448442736882676}
[S6] START round=4 head_norm_before_train=0.651241 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.124776 metrics={'f1_val': 0.16387093217355533, 'auprc': 0.8505578120190824, 'loss_val': 1.1316098486115795, 'psi': 0.4385456841117662}-{'f1_val': 0.14142628205128205, 'auprc': 0.8381053258767094, 'loss_val': 1.2091359366124146, 'psi': 0.420097899581453}
[S7] START round=4 head_norm_before_train=1.220400 (no previous merge yet)
[S7] round=4 local utility u=0.019597 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946307093147447, 'loss_val': 1.242501771143492, 'psi': 0.4030863773633529}-{'f1_val': 0.14205682272909165, 'auprc': 0.7890726703551931, 'loss_val': 1.265021057370802, 'psi': 0.40086316177953224}
[S8] START round=4 head_norm_before_train=0.878948 cos_to_last_merge=0.9747 (last merge round=1)
[S8] round=4 local utility u=0.225141 metrics={'f1_val': 0.37319932875242556, 'auprc': 0.8671045951955734, 'loss_val': 0.7862623272098339, 'psi': 0.5707614353296847}-{'f1_val': 0.37306606018310795, 'auprc': 0.776768196697641, 'loss_val': 0.9647350661635741, 'psi': 0.5345469147889211}
[S9] START round=4 head_norm_before_train=0.932633 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8641388113546096, 'loss_val': 1.2407747956100637, 'psi': 0.43049429882584145}-{'f1_val': 0.141397957139996, 'auprc': 0.8774682381402863, 'loss_val': 1.2389168982063468, 'psi': 0.43582606954011216}
[S10] START round=4 head_norm_before_train=1.004553 cos_to_last_merge=0.9804 (last merge round=1)
[S10] round=4 local utility u=0.815460 metrics={'f1_val': 0.4113958060279741, 'auprc': 0.8648300319031813, 'loss_val': 0.8245084832475599, 'psi': 0.592769496378057}-{'f1_val': 0.2955878733531737, 'auprc': 0.6470510741179565, 'loss_val': 1.1072447064866293, 'psi': 0.4361731536590868}
[S11] START round=4 head_norm_before_train=0.678046 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.010514 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7486391583547427, 'loss_val': 1.2736793047046664, 'psi': 0.38370387336576345}-{'f1_val': 0.14041368337311058, 'auprc': 0.7441961701172878, 'loss_val': 1.2813792686122938, 'psi': 0.38192667807078146}
[S13] START round=4 head_norm_before_train=1.352787 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.37227437111529826, 'auprc': 0.5721760110925279, 'loss_val': 0.8861939104011408, 'psi': 0.4522350271061901}-{'f1_val': 0.37593223485494665, 'auprc': 0.7485691519845792, 'loss_val': 0.979183437774617, 'psi': 0.5249870017067997}
[S14] START round=4 head_norm_before_train=0.778385 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.005723 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6671377809626025, 'loss_val': 1.324326090006048, 'psi': 0.35106982411466325}-{'f1_val': 0.14035785288270378, 'auprc': 0.6634500352917787, 'loss_val': 1.3247084029807807, 'psi': 0.3495947258463337}
[S15] START round=4 head_norm_before_train=1.337396 (no previous merge yet)
[S15] round=4 local utility u=0.088737 metrics={'f1_val': 0.4172633847281815, 'auprc': 0.7678733579103422, 'loss_val': 0.8253788907864139, 'psi': 0.5575073740010458}-{'f1_val': 0.4163758395072774, 'auprc': 0.7938295472185517, 'loss_val': 1.0753959546006824, 'psi': 0.5673573225917872}
[S16] START round=4 head_norm_before_train=1.212888 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7679718589592395, 'loss_val': 1.2198188561225585, 'psi': 0.3915712137032177}-{'f1_val': 0.14063745019920318, 'auprc': 0.7869224549586782, 'loss_val': 1.2577970657196829, 'psi': 0.3991514521029932}
[S17] START round=4 head_norm_before_train=1.027841 cos_to_last_merge=0.9713 (last merge round=1)
[S17] round=4 local utility u=0.281316 metrics={'f1_val': 0.3550958182838735, 'auprc': 0.7659212724196647, 'loss_val': 0.8874718516142402, 'psi': 0.5194259999381899}-{'f1_val': 0.39025761034410505, 'auprc': 0.5476114563697354, 'loss_val': 1.006144375961451, 'psi': 0.4531991487543572}
[S5] not sending this round → trigger blocked (psi=0.393)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:59815
[S8] not sending this round → trigger blocked (psi=0.571)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.680)
[S3] not sending this round → trigger blocked (psi=0.441)
[S7] not sending this round → trigger blocked (psi=0.403)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.593)
[S11] not sending this round → trigger blocked (psi=0.384)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.351)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:59805
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] cosine check vs S6: cos=0.0274
[S5] RECEIVED delta(kind=head bytes=1790) from S4
[S5] cosine check vs S4: cos=-0.0048
[S5] DROPPED delta from S4 (cos=-0.0048 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0173
[S14] DROPPED delta from S15 (cos=-0.0173 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] cosine check vs S17: cos=-0.0175
[S5] DROPPED delta from S17 (cos=-0.0175 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.4173 head_norm=1.407038
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.802370e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.4173 head_norm=0.797665 delta_norm=0.780237
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.298778 (no previous merge yet)
[S2] round=5 local utility u=0.094984 metrics={'f1_val': 0.7013698608266565, 'auprc': 0.6473447951250848, 'loss_val': 0.6423992200812072, 'psi': 0.6797598345460278}-{'f1_val': 0.7016303682990106, 'auprc': 0.6474089182790723, 'loss_val': 0.8341235106852091, 'psi': 0.6799417882910352}
[S3] START round=5 head_norm_before_train=1.307546 (no previous merge yet)
[S3] round=5 local utility u=0.061571 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9074968661470513, 'loss_val': 1.1410211116844793, 'psi': 0.4469027858272847}-{'f1_val': 0.13984006561410703, 'auprc': 0.8919887266627573, 'loss_val': 1.2176387374801325, 'psi': 0.4406995300335672}
[S4] START round=5 head_norm_before_train=0.894212 cos_to_last_merge=0.9900 (last merge round=3)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.6637318483545155, 'auprc': 0.7493011532732066, 'loss_val': 0.5820204545323083, 'psi': 0.6979595703219919}-{'f1_val': 0.6833162456881462, 'auprc': 0.7838556331553316, 'loss_val': 0.7886662615059347, 'psi': 0.7235320006750203}
[S5] START round=5 head_norm_before_train=1.251108 (no previous merge yet)
[S5] round=5 local utility u=0.873047 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7710630519813385, 'loss_val': 1.0804832966447135, 'psi': 0.5590755542619787}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700122791853333, 'loss_val': 1.170492929707823, 'psi': 0.3933620545312762}
[S6] START round=5 head_norm_before_train=0.714369 cos_to_last_merge=0.9869 (last merge round=3)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.9951109251853395, 'loss_val': 0.8696247700353313, 'psi': 0.6483979916483841}-{'f1_val': 0.16387093217355533, 'auprc': 0.8505578120190824, 'loss_val': 1.1316098486115795, 'psi': 0.4385456841117662}
[S7] START round=5 head_norm_before_train=1.242178 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777907946076011, 'loss_val': 1.2123673493855736, 'psi': 0.3963504114804955}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946307093147447, 'loss_val': 1.242501771143492, 'psi': 0.4030863773633529}
[S8] START round=5 head_norm_before_train=0.963273 cos_to_last_merge=0.9507 (last merge round=1)
[S8] round=5 local utility u=0.080303 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.8816774857850531, 'loss_val': 0.6677692577511024, 'psi': 0.5764299844333438}-{'f1_val': 0.37319932875242556, 'auprc': 0.8671045951955734, 'loss_val': 0.7862623272098339, 'psi': 0.5707614353296847}
[S9] START round=5 head_norm_before_train=0.958139 cos_to_last_merge=0.9973 (last merge round=3)
[S9] round=5 local utility u=0.055921 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8648100634992965, 'loss_val': 1.1309474649521767, 'psi': 0.4307627996837162}-{'f1_val': 0.141397957139996, 'auprc': 0.8641388113546096, 'loss_val': 1.2407747956100637, 'psi': 0.43049429882584145}
[S10] START round=5 head_norm_before_train=1.077580 cos_to_last_merge=0.9593 (last merge round=1)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.865330472348169, 'loss_val': 0.5297160330664646, 'psi': 0.7670122094951282}-{'f1_val': 0.4113958060279741, 'auprc': 0.8648300319031813, 'loss_val': 0.8245084832475599, 'psi': 0.592769496378057}
[S11] START round=5 head_norm_before_train=0.703993 cos_to_last_merge=0.9948 (last merge round=3)
[S11] round=5 local utility u=0.026441 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7486309524964231, 'loss_val': 1.220771752655999, 'psi': 0.3837005910224356}-{'f1_val': 0.14041368337311058, 'auprc': 0.7486391583547427, 'loss_val': 1.2736793047046664, 'psi': 0.38370387336576345}
[S13] START round=5 head_norm_before_train=1.406113 (no previous merge yet)
[S13] round=5 local utility u=1.000000 metrics={'f1_val': 0.6618467087068444, 'auprc': 0.7775367295688439, 'loss_val': 0.7290478088072492, 'psi': 0.7081227170516442}-{'f1_val': 0.37227437111529826, 'auprc': 0.5721760110925279, 'loss_val': 0.8861939104011408, 'psi': 0.4522350271061901}
[S14] START round=5 head_norm_before_train=0.800089 cos_to_last_merge=0.9967 (last merge round=3)
[S14] round=5 local utility u=0.053452 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6918202841244664, 'loss_val': 1.2914697585430912, 'psi': 0.3609428253794088}-{'f1_val': 0.14035785288270378, 'auprc': 0.6671377809626025, 'loss_val': 1.324326090006048, 'psi': 0.35106982411466325}
[S15] START round=5 head_norm_before_train=0.797665 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.43743303554081, 'auprc': 0.6505731534748825, 'loss_val': 0.8370642855031228, 'psi': 0.522689082714439}-{'f1_val': 0.4172633847281815, 'auprc': 0.7678733579103422, 'loss_val': 0.8253788907864139, 'psi': 0.5575073740010458}
[S16] START round=5 head_norm_before_train=1.237993 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5695829407934659, 'loss_val': 1.148128382784255, 'psi': 0.3122156464369083}-{'f1_val': 0.14063745019920318, 'auprc': 0.7679718589592395, 'loss_val': 1.2198188561225585, 'psi': 0.3915712137032177}
[S17] START round=5 head_norm_before_train=1.120531 cos_to_last_merge=0.9448 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35173270762029096, 'auprc': 0.6560329675735171, 'loss_val': 0.9313870090701807, 'psi': 0.4734528116015814}-{'f1_val': 0.3550958182838735, 'auprc': 0.7659212724196647, 'loss_val': 0.8874718516142402, 'psi': 0.5194259999381899}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.0058
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=-0.0529
[S2] DROPPED delta from S3 (cos=-0.0529 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=-0.0430
[S9] DROPPED delta from S11 (cos=-0.0430 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.6981
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=-0.0840
[S4] DROPPED delta from S10 (cos=-0.0840 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.1101
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] cosine check vs S2: cos=0.3626
[S15] RECEIVED delta(kind=head bytes=1791) from S6
[S15] cosine check vs S6: cos=0.4025
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.5257
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.4183
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.574 → S5@127.0.0.1:59805
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.4374 head_norm=0.887377
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.598526e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.4369 head_norm=0.702197 delta_norm=0.459853
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.464 → S14@127.0.0.1:59814
[S7] ⇄ pheromone p=0.366 → S6@127.0.0.1:59807
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.995232
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.878925e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.864370 delta_norm=0.487893
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.405 → S14@127.0.0.1:59814
[S10] ⇄ pheromone p=0.737 → S4@127.0.0.1:59804
[S13] ⇄ pheromone p=0.591 → S9@127.0.0.1:59810
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.4173 head_norm=0.788450
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.882631e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.4173 head_norm=0.692310 delta_norm=0.488263
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.553 → S15@127.0.0.1:59815
[S3] ⇄ pheromone p=0.378 → S2@127.0.0.1:59802
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.738772
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.244682e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.660596 delta_norm=0.424468
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.382 → S9@127.0.0.1:59810
[S5] ⇄ pheromone p=0.531 → S9@127.0.0.1:59810
[S8] ⇄ pheromone p=0.448 → S6@127.0.0.1:59807
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.829057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.501055e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.797695 delta_norm=0.450106
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.353 → S11@127.0.0.1:59812
[S2] ⇄ pheromone p=0.608 → S6@127.0.0.1:59807
[S16] ⇄ pheromone p=0.396 → S4@127.0.0.1:59804
[S17] ⇄ pheromone p=0.485 → S5@127.0.0.1:59805
[S2] START round=6 head_norm_before_train=1.365862 (no previous merge yet)
[S2] round=6 local utility u=0.080499 metrics={'f1_val': 0.700852847654986, 'auprc': 0.6588820199377161, 'loss_val': 0.5129108931693018, 'psi': 0.6840645165680781}-{'f1_val': 0.7013698608266565, 'auprc': 0.6473447951250848, 'loss_val': 0.6423992200812072, 'psi': 0.6797598345460278}
[S3] START round=6 head_norm_before_train=1.335454 (no previous merge yet)
[S3] round=6 local utility u=0.960998 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9955942908860913, 'loss_val': 1.0229900050230487, 'psi': 0.636109072243709}-{'f1_val': 0.13984006561410703, 'auprc': 0.9074968661470513, 'loss_val': 1.1410211116844793, 'psi': 0.4469027858272847}
[S4] START round=6 head_norm_before_train=0.988966 cos_to_last_merge=0.9685 (last merge round=3)
[S4] round=6 local utility u=0.356159 metrics={'f1_val': 0.6626796785797361, 'auprc': 0.9435507927560602, 'loss_val': 0.44613883673948546, 'psi': 0.7750281242502658}-{'f1_val': 0.6637318483545155, 'auprc': 0.7493011532732066, 'loss_val': 0.5820204545323083, 'psi': 0.6979595703219919}
[S5] START round=6 head_norm_before_train=1.276909 (no previous merge yet)
[S5] round=6 local utility u=0.091537 metrics={'f1_val': 0.41827481165975944, 'auprc': 0.7777855295113374, 'loss_val': 0.920722950676933, 'psi': 0.5620790988003906}-{'f1_val': 0.4177505557824055, 'auprc': 0.7710630519813385, 'loss_val': 1.0804832966447135, 'psi': 0.5590755542619787}
[S6] START round=6 head_norm_before_train=0.692310 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.41572398475555894, 'auprc': 0.95953606497272, 'loss_val': 0.8502192827131558, 'psi': 0.6332488168424234}-{'f1_val': 0.4172560359570804, 'auprc': 0.9951109251853395, 'loss_val': 0.8696247700353313, 'psi': 0.6483979916483841}
[S7] START round=6 head_norm_before_train=1.260599 (no previous merge yet)
[S7] round=6 local utility u=0.013212 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.770267366892911, 'loss_val': 1.163373888273699, 'psi': 0.3933410403946194}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777907946076011, 'loss_val': 1.2123673493855736, 'psi': 0.3963504114804955}
[S8] START round=6 head_norm_before_train=1.051082 cos_to_last_merge=0.9226 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.923
[S8] round=6 local utility u=0.865658 metrics={'f1_val': 0.5699591102529817, 'auprc': 0.9944922132177563, 'loss_val': 0.45706169437438804, 'psi': 0.7397723514388916}-{'f1_val': 0.3729316501988709, 'auprc': 0.8816774857850531, 'loss_val': 0.6677692577511024, 'psi': 0.5764299844333438}
[S9] START round=6 head_norm_before_train=0.864370 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.047730 metrics={'f1_val': 0.14308877178759627, 'auprc': 0.866685712668373, 'loss_val': 1.051259923685004, 'psi': 0.43252754813990696}-{'f1_val': 0.141397957139996, 'auprc': 0.8648100634992965, 'loss_val': 1.1309474649521767, 'psi': 0.4307627996837162}
[S10] START round=6 head_norm_before_train=1.171894 cos_to_last_merge=0.9346 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=6 local utility u=0.189855 metrics={'f1_val': 0.7012767113003361, 'auprc': 0.9382838584998261, 'loss_val': 0.36772580179620157, 'psi': 0.7960795701801321}-{'f1_val': 0.7014667009264342, 'auprc': 0.865330472348169, 'loss_val': 0.5297160330664646, 'psi': 0.7670122094951282}
[S11] START round=6 head_norm_before_train=0.660596 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.035668 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7640008264245878, 'loss_val': 1.1955461683696826, 'psi': 0.3898485405937015}-{'f1_val': 0.14041368337311058, 'auprc': 0.7486309524964231, 'loss_val': 1.220771752655999, 'psi': 0.3837005910224356}
[S13] START round=6 head_norm_before_train=1.454771 (no previous merge yet)
[S13] round=6 local utility u=0.217244 metrics={'f1_val': 0.7114425853893016, 'auprc': 0.7895049255769261, 'loss_val': 0.6280389564257869, 'psi': 0.7426675214643514}-{'f1_val': 0.6618467087068444, 'auprc': 0.7775367295688439, 'loss_val': 0.7290478088072492, 'psi': 0.7081227170516442}
[S14] START round=6 head_norm_before_train=0.797695 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.252673 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.856079465251207, 'loss_val': 1.2789013206280486, 'psi': 0.4266464978301051}-{'f1_val': 0.14035785288270378, 'auprc': 0.6918202841244664, 'loss_val': 1.2914697585430912, 'psi': 0.3609428253794088}
[S15] START round=6 head_norm_before_train=0.702197 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.4364646522650316, 'auprc': 0.6539834706671234, 'loss_val': 0.8708821748328176, 'psi': 0.5234721796258683}-{'f1_val': 0.43743303554081, 'auprc': 0.6505731534748825, 'loss_val': 0.8370642855031228, 'psi': 0.522689082714439}
[S16] START round=6 head_norm_before_train=1.271054 (no previous merge yet)
[S16] round=6 local utility u=0.858892 metrics={'f1_val': 0.4175015313869336, 'auprc': 0.5457440351361156, 'loss_val': 1.0200113331938059, 'psi': 0.4687985328866064}-{'f1_val': 0.14063745019920318, 'auprc': 0.5695829407934659, 'loss_val': 1.148128382784255, 'psi': 0.3122156464369083}
[S17] START round=6 head_norm_before_train=1.193291 cos_to_last_merge=0.9204 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=6 local utility u=0.046911 metrics={'f1_val': 0.3521078170667997, 'auprc': 0.682636359482918, 'loss_val': 0.9196249911214238, 'psi': 0.48431923403324706}-{'f1_val': 0.35173270762029096, 'auprc': 0.6560329675735171, 'loss_val': 0.9313870090701807, 'psi': 0.4734528116015814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:59807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S4
[S5] cosine check vs S4: cos=0.0102
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=0.6467
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=-0.0847
[S4] DROPPED delta from S10 (cos=-0.0847 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.6500
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.3804
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.2845
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] cosine check vs S13: cos=0.8080
[S6] RECEIVED delta(kind=head bytes=1805) from S2
[S6] cosine check vs S2: cos=0.6717
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.4192
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.7238
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.3522
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=-0.0613
[S2] DROPPED delta from S3 (cos=-0.0613 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S17
[S5] cosine check vs S17: cos=-0.0102
[S5] DROPPED delta from S17 (cos=-0.0102 < 0.0)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.4157 head_norm=0.754207
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.982019e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.4159 head_norm=0.727377 delta_norm=0.298202
[S6] aggregate: ACCEPT kept=['S2', 'S8', 'S7'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.819260
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.218886e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.798708 delta_norm=0.321889
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6627 head_norm=1.086011
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.116716e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6652 head_norm=1.089648 delta_norm=0.511672
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4183 head_norm=1.311249
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.470006e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.4177 head_norm=0.855563 delta_norm=0.847001
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1431 head_norm=0.901059
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.024886e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.733907 delta_norm=0.302489
[S9] aggregate: ACCEPT kept=['S5', 'S11', 'S13'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.682279
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.215983e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.681851 delta_norm=0.321598
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.447687 (no previous merge yet)
[S2] round=7 local utility u=0.054946 metrics={'f1_val': 0.6995103141566394, 'auprc': 0.6628027454730493, 'loss_val': 0.40672682491502204, 'psi': 0.6848272866832035}-{'f1_val': 0.700852847654986, 'auprc': 0.6588820199377161, 'loss_val': 0.5129108931693018, 'psi': 0.6840645165680781}
[S3] START round=7 head_norm_before_train=1.360251 (no previous merge yet)
[S3] round=7 local utility u=0.094024 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.9972997472354922, 'loss_val': 0.8396839412478353, 'psi': 0.6367537137380817}-{'f1_val': 0.39645225981545407, 'auprc': 0.9955942908860913, 'loss_val': 1.0229900050230487, 'psi': 0.636109072243709}
[S4] START round=7 head_norm_before_train=1.089648 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.944895 metrics={'f1_val': 0.9566085908279297, 'auprc': 0.9760667664149986, 'loss_val': 0.4174701824905611, 'psi': 0.9643918610627572}-{'f1_val': 0.6626796785797361, 'auprc': 0.9435507927560602, 'loss_val': 0.44613883673948546, 'psi': 0.7750281242502658}
[S5] START round=7 head_norm_before_train=0.855563 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.006880 metrics={'f1_val': 0.4181537288170242, 'auprc': 0.7773905020411166, 'loss_val': 0.9050522141992885, 'psi': 0.5618484381066611}-{'f1_val': 0.41827481165975944, 'auprc': 0.7777855295113374, 'loss_val': 0.920722950676933, 'psi': 0.5620790988003906}
[S6] START round=7 head_norm_before_train=0.727377 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.41596572403532517, 'auprc': 0.7864985743633846, 'loss_val': 0.8059001408460583, 'psi': 0.5641788641665489}-{'f1_val': 0.41572398475555894, 'auprc': 0.95953606497272, 'loss_val': 0.8502192827131558, 'psi': 0.6332488168424234}
[S7] START round=7 head_norm_before_train=1.277387 (no previous merge yet)
[S7] round=7 local utility u=0.610891 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.6007627660673969, 'loss_val': 1.0844208455291253, 'psi': 0.49067357252672295}-{'f1_val': 0.14205682272909165, 'auprc': 0.770267366892911, 'loss_val': 1.163373888273699, 'psi': 0.3933410403946194}
[S8] START round=7 head_norm_before_train=1.132794 cos_to_last_merge=0.8954 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.895
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.933833003281968, 'auprc': 0.9971414395309588, 'loss_val': 0.26870662217912894, 'psi': 0.9591563777815644}-{'f1_val': 0.5699591102529817, 'auprc': 0.9944922132177563, 'loss_val': 0.45706169437438804, 'psi': 0.7397723514388916}
[S9] START round=7 head_norm_before_train=0.733907 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.3985257453681516, 'auprc': 0.980133588799869, 'loss_val': 0.8981873479431546, 'psi': 0.6311688827408386}-{'f1_val': 0.14308877178759627, 'auprc': 0.866685712668373, 'loss_val': 1.051259923685004, 'psi': 0.43252754813990696}
[S10] START round=7 head_norm_before_train=1.274461 cos_to_last_merge=0.9127 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=7 local utility u=0.139291 metrics={'f1_val': 0.6974757987619367, 'auprc': 0.9982086803782722, 'loss_val': 0.2461135347041148, 'psi': 0.817768951408471}-{'f1_val': 0.7012767113003361, 'auprc': 0.9382838584998261, 'loss_val': 0.36772580179620157, 'psi': 0.7960795701801321}
[S11] START round=7 head_norm_before_train=0.681851 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.868145 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.7641723835153166, 'loss_val': 1.1537121584754935, 'psi': 0.5593113876444538}-{'f1_val': 0.14041368337311058, 'auprc': 0.7640008264245878, 'loss_val': 1.1955461683696826, 'psi': 0.3898485405937015}
[S13] START round=7 head_norm_before_train=1.495443 (no previous merge yet)
[S13] round=7 local utility u=0.022757 metrics={'f1_val': 0.7118396729657227, 'auprc': 0.7848256134428708, 'loss_val': 0.5708697125041674, 'psi': 0.741034049156582}-{'f1_val': 0.7114425853893016, 'auprc': 0.7895049255769261, 'loss_val': 0.6280389564257869, 'psi': 0.7426675214643514}
[S14] START round=7 head_norm_before_train=0.798708 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7922061570743923, 'loss_val': 1.2512836912477294, 'psi': 0.4010971745593792}-{'f1_val': 0.14035785288270378, 'auprc': 0.856079465251207, 'loss_val': 1.2789013206280486, 'psi': 0.4266464978301051}
[S15] START round=7 head_norm_before_train=0.785398 cos_to_last_merge=0.9764 (last merge round=5)
[S15] round=7 local utility u=0.227454 metrics={'f1_val': 0.4221297089968683, 'auprc': 0.7764904298580773, 'loss_val': 0.6974845100418581, 'psi': 0.5638739973413519}-{'f1_val': 0.4364646522650316, 'auprc': 0.6539834706671234, 'loss_val': 0.8708821748328176, 'psi': 0.5234721796258683}
[S16] START round=7 head_norm_before_train=1.311053 (no previous merge yet)
[S16] round=7 local utility u=0.372395 metrics={'f1_val': 0.43081228060810794, 'auprc': 0.7282653146449781, 'loss_val': 0.9026499159489342, 'psi': 0.549793494222856}-{'f1_val': 0.4175015313869336, 'auprc': 0.5457440351361156, 'loss_val': 1.0200113331938059, 'psi': 0.4687985328866064}
[S17] START round=7 head_norm_before_train=1.242999 cos_to_last_merge=0.9031 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=7 local utility u=0.776759 metrics={'f1_val': 0.6009692362534002, 'auprc': 0.6811470933516939, 'loss_val': 0.8548080588429602, 'psi': 0.6330403790927177}-{'f1_val': 0.3521078170667997, 'auprc': 0.682636359482918, 'loss_val': 0.9196249911214238, 'psi': 0.48431923403324706}
[S8] not sending this round → trigger blocked (psi=0.959)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.685)
[S4] not sending this round → trigger blocked (psi=0.964)
[S13] not sending this round → trigger blocked (psi=0.741)
[S7] not sending this round → trigger blocked (psi=0.491)
[S3] not sending this round → trigger blocked (psi=0.637)
[S9] not sending this round → trigger blocked (psi=0.631)
[S16] not sending this round → trigger blocked (psi=0.550)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.818)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S11] not sending this round → trigger blocked (psi=0.559)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0103
[S14] DROPPED delta from S15 (cos=-0.0103 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.633)
[S2] START round=8 head_norm_before_train=1.520444 (no previous merge yet)
[S2] round=8 local utility u=0.102162 metrics={'f1_val': 0.7008737635735156, 'auprc': 0.7097193414329486, 'loss_val': 0.3513340374260446, 'psi': 0.7044119947172889}-{'f1_val': 0.6995103141566394, 'auprc': 0.6628027454730493, 'loss_val': 0.40672682491502204, 'psi': 0.6848272866832035}
[S3] START round=8 head_norm_before_train=1.397980 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.469849265548027, 'auprc': 0.8007729646209916, 'loss_val': 0.8587229002025247, 'psi': 0.6022187451772127}-{'f1_val': 0.39638969140647473, 'auprc': 0.9972997472354922, 'loss_val': 0.8396839412478353, 'psi': 0.6367537137380817}
[S4] START round=8 head_norm_before_train=1.163739 cos_to_last_merge=0.9945 (last merge round=6)
[S4] round=8 local utility u=0.016747 metrics={'f1_val': 0.954271341341346, 'auprc': 0.9636133971798206, 'loss_val': 0.3325922879971739, 'psi': 0.9580081636767359}-{'f1_val': 0.9566085908279297, 'auprc': 0.9760667664149986, 'loss_val': 0.4174701824905611, 'psi': 0.9643918610627572}
[S5] START round=8 head_norm_before_train=0.895606 cos_to_last_merge=0.9963 (last merge round=6)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.38931311664160995, 'auprc': 0.6614286315179196, 'loss_val': 0.807614216624301, 'psi': 0.4981593225921338}-{'f1_val': 0.4181537288170242, 'auprc': 0.7773905020411166, 'loss_val': 0.9050522141992885, 'psi': 0.5618484381066611}
[S6] START round=8 head_norm_before_train=0.792407 cos_to_last_merge=0.9781 (last merge round=6)
[S6] round=8 local utility u=0.682923 metrics={'f1_val': 0.6178649579276769, 'auprc': 0.7919020938276776, 'loss_val': 0.6676591546643921, 'psi': 0.6874798122876773}-{'f1_val': 0.41596572403532517, 'auprc': 0.7864985743633846, 'loss_val': 0.8059001408460583, 'psi': 0.5641788641665489}
[S7] START round=8 head_norm_before_train=1.296847 (no previous merge yet)
[S7] round=8 local utility u=0.334665 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.776431783243678, 'loss_val': 0.9413606639200339, 'psi': 0.5608675054565353}-{'f1_val': 0.4172807768329403, 'auprc': 0.6007627660673969, 'loss_val': 1.0844208455291253, 'psi': 0.49067357252672295}
[S8] START round=8 head_norm_before_train=1.207901 cos_to_last_merge=0.8730 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.873
[S8] round=8 local utility u=0.232954 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9971805353867694, 'loss_val': 0.1789412598769846, 'psi': 0.9967745074679835}-{'f1_val': 0.933833003281968, 'auprc': 0.9971414395309588, 'loss_val': 0.26870662217912894, 'psi': 0.9591563777815644}
[S9] START round=8 head_norm_before_train=0.780957 cos_to_last_merge=0.9915 (last merge round=6)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7017586747191817, 'auprc': 0.9983699887896826, 'loss_val': 0.6585959610379882, 'psi': 0.8204032003473821}-{'f1_val': 0.3985257453681516, 'auprc': 0.980133588799869, 'loss_val': 0.8981873479431546, 'psi': 0.6311688827408386}
[S10] START round=8 head_norm_before_train=1.358131 cos_to_last_merge=0.8974 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.6874427088498504, 'auprc': 0.9470610428399013, 'loss_val': 0.2463778830218993, 'psi': 0.7912900424458708}-{'f1_val': 0.6974757987619367, 'auprc': 0.9982086803782722, 'loss_val': 0.2461135347041148, 'psi': 0.817768951408471}
[S11] START round=8 head_norm_before_train=0.703072 cos_to_last_merge=0.9919 (last merge round=6)
[S11] round=8 local utility u=0.039550 metrics={'f1_val': 0.41491559158615293, 'auprc': 0.752667114650832, 'loss_val': 0.9931646044706159, 'psi': 0.5500162008120246}-{'f1_val': 0.42273739039721175, 'auprc': 0.7641723835153166, 'loss_val': 1.1537121584754935, 'psi': 0.5593113876444538}
[S13] START round=8 head_norm_before_train=1.526310 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.7517510990528565, 'loss_val': 0.5187038967948808, 'psi': 0.728596601045636}-{'f1_val': 0.7118396729657227, 'auprc': 0.7848256134428708, 'loss_val': 0.5708697125041674, 'psi': 0.741034049156582}
[S14] START round=8 head_norm_before_train=0.820345 cos_to_last_merge=0.9962 (last merge round=6)
[S14] round=8 local utility u=0.205832 metrics={'f1_val': 0.1444058089588873, 'auprc': 0.8868274288711734, 'loss_val': 1.1477703068190828, 'psi': 0.4413744569238018}-{'f1_val': 0.14035785288270378, 'auprc': 0.7922061570743923, 'loss_val': 1.2512836912477294, 'psi': 0.4010971745593792}
[S15] START round=8 head_norm_before_train=0.884203 cos_to_last_merge=0.9343 (last merge round=5)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=8 local utility u=0.817841 metrics={'f1_val': 0.6428783442647024, 'auprc': 0.8416155285504435, 'loss_val': 0.5816700398232574, 'psi': 0.7223732179789988}-{'f1_val': 0.4221297089968683, 'auprc': 0.7764904298580773, 'loss_val': 0.6974845100418581, 'psi': 0.5638739973413519}
[S16] START round=8 head_norm_before_train=1.354277 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3261906026362189, 'auprc': 0.746523348457728, 'loss_val': 0.8875561134109471, 'psi': 0.4943237009648226}-{'f1_val': 0.43081228060810794, 'auprc': 0.7282653146449781, 'loss_val': 0.9026499159489342, 'psi': 0.549793494222856}
[S17] START round=8 head_norm_before_train=1.275368 cos_to_last_merge=0.8897 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.890
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3724437894264838, 'auprc': 0.6720140946202873, 'loss_val': 0.7508410070422619, 'psi': 0.4922719115040052}-{'f1_val': 0.6009692362534002, 'auprc': 0.6811470933516939, 'loss_val': 0.8548080588429602, 'psi': 0.6330403790927177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.722)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:59815
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1791) from S8
[S6] cosine check vs S8: cos=0.5297
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.7785
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.4587
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=0.9072
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=0.6620
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.5379
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.5091
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.5075
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6429 head_norm=0.986034
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.864542e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6354 head_norm=0.795301 delta_norm=0.486454
[S15] aggregate: ROLLBACK (f1_val pre=0.643 post=0.635 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.3893 head_norm=0.941327
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.382719e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.3892 head_norm=0.956250 delta_norm=0.538272
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7018 head_norm=0.845629
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.296137e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7019 head_norm=0.723555 delta_norm=0.329614
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1444 head_norm=0.847470
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.823587e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.826675 delta_norm=0.182359
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4149 head_norm=0.741125
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.690532e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3970 head_norm=0.749231 delta_norm=0.269053
[S11] aggregate: ROLLBACK (f1_val pre=0.415 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.6179 head_norm=0.875225
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.794630e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.6189 head_norm=0.834026 delta_norm=0.279463
[S6] aggregate: ACCEPT kept=['S8', 'S2', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.587770 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6618688368800161, 'loss_val': 0.32087645545628013, 'psi': 0.6845138643416834}-{'f1_val': 0.7008737635735156, 'auprc': 0.7097193414329486, 'loss_val': 0.3513340374260446, 'psi': 0.7044119947172889}
[S3] START round=9 head_norm_before_train=1.435721 (no previous merge yet)
[S3] round=9 local utility u=1.000000 metrics={'f1_val': 0.6842405692382443, 'auprc': 0.9908995669197453, 'loss_val': 0.6377742514675199, 'psi': 0.8069041683108447}-{'f1_val': 0.469849265548027, 'auprc': 0.8007729646209916, 'loss_val': 0.8587229002025247, 'psi': 0.6022187451772127}
[S4] START round=9 head_norm_before_train=1.233778 cos_to_last_merge=0.9843 (last merge round=6)
[S4] round=9 local utility u=0.000157 metrics={'f1_val': 0.9462603041461932, 'auprc': 0.9689097381749271, 'loss_val': 0.30010183427967885, 'psi': 0.9553200777576867}-{'f1_val': 0.954271341341346, 'auprc': 0.9636133971798206, 'loss_val': 0.3325922879971739, 'psi': 0.9580081636767359}
[S5] START round=9 head_norm_before_train=0.956250 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.214193 metrics={'f1_val': 0.41730510810538973, 'auprc': 0.775691562204606, 'loss_val': 0.8899691962536438, 'psi': 0.5606596897450762}-{'f1_val': 0.38931311664160995, 'auprc': 0.6614286315179196, 'loss_val': 0.807614216624301, 'psi': 0.4981593225921338}
[S6] START round=9 head_norm_before_train=0.834026 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.037912 metrics={'f1_val': 0.6175001677166558, 'auprc': 0.8075685883607896, 'loss_val': 0.6366463462219027, 'psi': 0.6935275359743094}-{'f1_val': 0.6178649579276769, 'auprc': 0.7919020938276776, 'loss_val': 0.6676591546643921, 'psi': 0.6874798122876773}
[S7] START round=9 head_norm_before_train=1.323097 (no previous merge yet)
[S7] round=9 local utility u=0.084229 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.7939262896963093, 'loss_val': 0.8251334673332358, 'psi': 0.5678400454788306}-{'f1_val': 0.4171579869317734, 'auprc': 0.776431783243678, 'loss_val': 0.9413606639200339, 'psi': 0.5608675054565353}
[S8] START round=9 head_norm_before_train=1.276144 cos_to_last_merge=0.8571 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.857
[S8] round=9 local utility u=0.017449 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9990085293709434, 'loss_val': 0.14187742895249505, 'psi': 0.996740798681069}-{'f1_val': 0.996503822188793, 'auprc': 0.9971805353867694, 'loss_val': 0.1789412598769846, 'psi': 0.9967745074679835}
[S9] START round=9 head_norm_before_train=0.723555 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.057489 metrics={'f1_val': 0.7016130641860581, 'auprc': 0.996601468127806, 'loss_val': 0.5374389344302135, 'psi': 0.8196084257627573}-{'f1_val': 0.7017586747191817, 'auprc': 0.9983699887896826, 'loss_val': 0.6585959610379882, 'psi': 0.8204032003473821}
[S10] START round=9 head_norm_before_train=1.418332 cos_to_last_merge=0.8868 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.887
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.9879607531236368, 'auprc': 0.9976064929996454, 'loss_val': 0.15232242803772625, 'psi': 0.9918190490740402}-{'f1_val': 0.6874427088498504, 'auprc': 0.9470610428399013, 'loss_val': 0.2463778830218993, 'psi': 0.7912900424458708}
[S11] START round=9 head_norm_before_train=0.749231 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.6694280575695009, 'loss_val': 0.9250243084335066, 'psi': 0.5077264747092636}-{'f1_val': 0.41491559158615293, 'auprc': 0.752667114650832, 'loss_val': 0.9931646044706159, 'psi': 0.5500162008120246}
[S13] START round=9 head_norm_before_train=1.559982 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.7032348025021704, 'auprc': 0.7485941955594152, 'loss_val': 0.5080261027416877, 'psi': 0.7213785597250684}-{'f1_val': 0.7131602690408223, 'auprc': 0.7517510990528565, 'loss_val': 0.5187038967948808, 'psi': 0.728596601045636}
[S14] START round=9 head_norm_before_train=0.826675 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9936199044823962, 'loss_val': 0.9651145932347595, 'psi': 0.6353842831791535}-{'f1_val': 0.1444058089588873, 'auprc': 0.8868274288711734, 'loss_val': 1.1477703068190828, 'psi': 0.4413744569238018}
[S15] START round=9 head_norm_before_train=0.795301 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.010682 metrics={'f1_val': 0.6962316801751144, 'auprc': 0.7703126060569456, 'loss_val': 0.66651727214456, 'psi': 0.7258640505278469}-{'f1_val': 0.6428783442647024, 'auprc': 0.8416155285504435, 'loss_val': 0.5816700398232574, 'psi': 0.7223732179789988}
[S16] START round=9 head_norm_before_train=1.391785 (no previous merge yet)
[S16] round=9 local utility u=0.353401 metrics={'f1_val': 0.4371855848249935, 'auprc': 0.7434508981045878, 'loss_val': 0.8375063427621526, 'psi': 0.5596917101368312}-{'f1_val': 0.3261906026362189, 'auprc': 0.746523348457728, 'loss_val': 0.8875561134109471, 'psi': 0.4943237009648226}
[S17] START round=9 head_norm_before_train=1.306115 cos_to_last_merge=0.8808 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=9 local utility u=0.045880 metrics={'f1_val': 0.39272053566029075, 'auprc': 0.6609224223822296, 'loss_val': 0.7474672111939561, 'psi': 0.5000012903490663}-{'f1_val': 0.3724437894264838, 'auprc': 0.6720140946202873, 'loss_val': 0.7508410070422619, 'psi': 0.4922719115040052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S7] not sending this round → trigger blocked (psi=0.568)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[S6] not sending this round → trigger blocked (psi=0.694)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S14] not sending this round → trigger blocked (psi=0.635)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.955)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.1910
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.8354
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0899
[S4] DROPPED delta from S10 (cos=-0.0899 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=0.0516
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=-0.0786
[S2] DROPPED delta from S3 (cos=-0.0786 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=0.0334
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3966 head_norm=0.862998
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.959696e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.7011 head_norm=0.627552 delta_norm=0.595970
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7016 head_norm=0.798816
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.716114e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7017 head_norm=0.690629 delta_norm=0.571611
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9463 head_norm=1.293973
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.955083e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9461 head_norm=1.303546 delta_norm=0.395508
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4173 head_norm=0.984534
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.139737e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4173 head_norm=0.840422 delta_norm=0.813974
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.642715 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7005127895862524, 'auprc': 0.6635585762690291, 'loss_val': 0.34034922511166166, 'psi': 0.6857311042593631}-{'f1_val': 0.6996105493161282, 'auprc': 0.6618688368800161, 'loss_val': 0.32087645545628013, 'psi': 0.6845138643416834}
[S3] START round=10 head_norm_before_train=1.476449 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.4031868165139334, 'auprc': 0.6449795596301263, 'loss_val': 0.9280605169358727, 'psi': 0.49990391376041055}-{'f1_val': 0.6842405692382443, 'auprc': 0.9908995669197453, 'loss_val': 0.6377742514675199, 'psi': 0.8069041683108447}
[S4] START round=10 head_norm_before_train=1.303546 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9423689408495307, 'auprc': 0.9708545873632193, 'loss_val': 0.2869191462300897, 'psi': 0.9537631994550061}-{'f1_val': 0.9462603041461932, 'auprc': 0.9689097381749271, 'loss_val': 0.30010183427967885, 'psi': 0.9553200777576867}
[S5] START round=10 head_norm_before_train=0.840422 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.132385 metrics={'f1_val': 0.4047277498335593, 'auprc': 0.8644753648814749, 'loss_val': 0.8160867698903261, 'psi': 0.5886267958527256}-{'f1_val': 0.41730510810538973, 'auprc': 0.775691562204606, 'loss_val': 0.8899691962536438, 'psi': 0.5606596897450762}
[S6] START round=10 head_norm_before_train=0.905070 cos_to_last_merge=0.9914 (last merge round=8)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5374734090511271, 'auprc': 0.7807866147317536, 'loss_val': 0.6972322486834819, 'psi': 0.6347986913233776}-{'f1_val': 0.6175001677166558, 'auprc': 0.8075685883607896, 'loss_val': 0.6366463462219027, 'psi': 0.6935275359743094}
[S7] START round=10 head_norm_before_train=1.355087 (no previous merge yet)
[S7] round=10 local utility u=0.912527 metrics={'f1_val': 0.7142988289087885, 'auprc': 0.7943284986458852, 'loss_val': 0.784382825329245, 'psi': 0.7463106968036272}-{'f1_val': 0.41711588266717814, 'auprc': 0.7939262896963093, 'loss_val': 0.8251334673332358, 'psi': 0.5678400454788306}
[S8] START round=10 head_norm_before_train=1.340307 cos_to_last_merge=0.8457 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=10 local utility u=0.024923 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.998996214831019, 'loss_val': 0.0987397469621204, 'psi': 0.9974103308937823}-{'f1_val': 0.9952289782211529, 'auprc': 0.9990085293709434, 'loss_val': 0.14187742895249505, 'psi': 0.996740798681069}
[S9] START round=10 head_norm_before_train=0.690629 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.7016130641860581, 'auprc': 0.99657120068257, 'loss_val': 0.5937072395609425, 'psi': 0.8195963187846629}-{'f1_val': 0.7016130641860581, 'auprc': 0.996601468127806, 'loss_val': 0.5374389344302135, 'psi': 0.8196084257627573}
[S10] START round=10 head_norm_before_train=1.461030 cos_to_last_merge=0.8796 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=10 local utility u=0.036088 metrics={'f1_val': 0.9955975227648919, 'auprc': 0.9918274011749049, 'loss_val': 0.10862923897463674, 'psi': 0.994089474128897}-{'f1_val': 0.9879607531236368, 'auprc': 0.9976064929996454, 'loss_val': 0.15232242803772625, 'psi': 0.9918190490740402}
[S11] START round=10 head_norm_before_train=0.782212 cos_to_last_merge=0.9923 (last merge round=8)
[S11] round=10 local utility u=0.298728 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.8244885869020433, 'loss_val': 0.7927493556507946, 'psi': 0.5697506864422806}-{'f1_val': 0.39992541946910537, 'auprc': 0.6694280575695009, 'loss_val': 0.9250243084335066, 'psi': 0.5077264747092636}
[S13] START round=10 head_norm_before_train=1.588879 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6337873854803918, 'auprc': 0.6921909871587846, 'loss_val': 0.5214397750966894, 'psi': 0.6571488261517489}-{'f1_val': 0.7032348025021704, 'auprc': 0.7485941955594152, 'loss_val': 0.5080261027416877, 'psi': 0.7213785597250684}
[S14] START round=10 head_norm_before_train=0.627552 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.427328 metrics={'f1_val': 0.533311378514015, 'auprc': 0.9842460335151909, 'loss_val': 0.9028423200240124, 'psi': 0.7136852405144853}-{'f1_val': 0.39656053564365834, 'auprc': 0.9936199044823962, 'loss_val': 0.9651145932347595, 'psi': 0.6353842831791535}
[S15] START round=10 head_norm_before_train=0.867892 cos_to_last_merge=0.9896 (last merge round=8)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6985529835863493, 'auprc': 0.7021108459410426, 'loss_val': 0.6673979075049324, 'psi': 0.6999761285282267}-{'f1_val': 0.6962316801751144, 'auprc': 0.7703126060569456, 'loss_val': 0.66651727214456, 'psi': 0.7258640505278469}
[S16] START round=10 head_norm_before_train=1.427217 (no previous merge yet)
[S16] round=10 local utility u=0.368329 metrics={'f1_val': 0.5434733919532861, 'auprc': 0.7618302040853749, 'loss_val': 0.7937136348936867, 'psi': 0.6308161168061217}-{'f1_val': 0.4371855848249935, 'auprc': 0.7434508981045878, 'loss_val': 0.8375063427621526, 'psi': 0.5596917101368312}
[S17] START round=10 head_norm_before_train=1.329818 cos_to_last_merge=0.8725 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=10 local utility u=0.176142 metrics={'f1_val': 0.3985085461337329, 'auprc': 0.7415756699547194, 'loss_val': 0.6718710162659567, 'psi': 0.5357353956621275}-{'f1_val': 0.39272053566029075, 'auprc': 0.6609224223822296, 'loss_val': 0.7474672111939561, 'psi': 0.5000012903490663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:59812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.7307
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.4881
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0851
[S4] DROPPED delta from S10 (cos=-0.0851 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.6163
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.5703
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9420
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.6937
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.7930
[S13] ⇄ pheromone p=0.214 → S9@127.0.0.1:59810
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9424 head_norm=1.367314
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.457159e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.9358 head_norm=1.394959 delta_norm=0.245716
[S4] aggregate: ROLLBACK (f1_val pre=0.942 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.316 → S5@127.0.0.1:59805
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7016 head_norm=0.748865
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.291029e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7016 head_norm=0.652966 delta_norm=0.229103
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.376 → S14@127.0.0.1:59814
[S3] ⇄ pheromone p=0.372 → S2@127.0.0.1:59802
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.5375 head_norm=0.981615
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.777672e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.5635 head_norm=0.976346 delta_norm=0.377767
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.275 → S15@127.0.0.1:59815
[S2] ⇄ pheromone p=0.224 → S6@127.0.0.1:59807
[S15] ⇄ pheromone p=0.282 → S14@127.0.0.1:59814
[S10] ⇄ pheromone p=0.439 → S4@127.0.0.1:59804
[S14] ⇄ pheromone p=0.408 → S11@127.0.0.1:59812
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4047 head_norm=0.868388
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.301320e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6070 head_norm=1.061262 delta_norm=0.430132
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.243 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.422 → S6@127.0.0.1:59807
[S16] ⇄ pheromone p=0.368 → S4@127.0.0.1:59804
[S8] ⇄ pheromone p=0.358 → S6@127.0.0.1:59807
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.3999 head_norm=0.828369
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.849804e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.3999 head_norm=0.700225 delta_norm=0.284980
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.282 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=0.285 → S5@127.0.0.1:59805
[S2] START round=11 head_norm_before_train=1.683036 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6629364568106028, 'loss_val': 0.3454669813475968, 'psi': 0.6849409123139181}-{'f1_val': 0.7005127895862524, 'auprc': 0.6635585762690291, 'loss_val': 0.34034922511166166, 'psi': 0.6857311042593631}
[S3] START round=11 head_norm_before_train=1.515066 (no previous merge yet)
[S3] round=11 local utility u=0.840653 metrics={'f1_val': 0.5053455498352799, 'auprc': 0.9085762567551627, 'loss_val': 0.6504969156757409, 'psi': 0.6666378326032331}-{'f1_val': 0.4031868165139334, 'auprc': 0.6449795596301263, 'loss_val': 0.9280605169358727, 'psi': 0.49990391376041055}
[S4] START round=11 head_norm_before_train=1.394959 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.052505 metrics={'f1_val': 0.9501689278327031, 'auprc': 0.9827525941151691, 'loss_val': 0.26440229811167393, 'psi': 0.9632023943456895}-{'f1_val': 0.9423689408495307, 'auprc': 0.9708545873632193, 'loss_val': 0.2869191462300897, 'psi': 0.9537631994550061}
[S5] START round=11 head_norm_before_train=1.061262 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.750835 metrics={'f1_val': 0.6983993892480375, 'auprc': 0.7759445425607847, 'loss_val': 0.8108531983195234, 'psi': 0.7294174505731363}-{'f1_val': 0.4047277498335593, 'auprc': 0.8644753648814749, 'loss_val': 0.8160867698903261, 'psi': 0.5886267958527256}
[S6] START round=11 head_norm_before_train=0.976346 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.901980 metrics={'f1_val': 0.7068569842196915, 'auprc': 0.9627932068850019, 'loss_val': 0.4555938729131079, 'psi': 0.8092314732858157}-{'f1_val': 0.5374734090511271, 'auprc': 0.7807866147317536, 'loss_val': 0.6972322486834819, 'psi': 0.6347986913233776}
[S7] START round=11 head_norm_before_train=1.388924 (no previous merge yet)
[S7] round=11 local utility u=0.009478 metrics={'f1_val': 0.7144974922643522, 'auprc': 0.7930465663070901, 'loss_val': 0.7627733632158434, 'psi': 0.7459171218814473}-{'f1_val': 0.7142988289087885, 'auprc': 0.7943284986458852, 'loss_val': 0.784382825329245, 'psi': 0.7463106968036272}
[S8] START round=11 head_norm_before_train=1.394434 cos_to_last_merge=0.8367 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=11 local utility u=0.008831 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990730425872809, 'loss_val': 0.08130832467639429, 'psi': 0.9974410619962871}-{'f1_val': 0.9963530749356245, 'auprc': 0.998996214831019, 'loss_val': 0.0987397469621204, 'psi': 0.9974103308937823}
[S9] START round=11 head_norm_before_train=0.652966 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.031012 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9964018059496568, 'loss_val': 0.5296736490447801, 'psi': 0.8193784895901066}-{'f1_val': 0.7016130641860581, 'auprc': 0.99657120068257, 'loss_val': 0.5937072395609425, 'psi': 0.8195963187846629}
[S10] START round=11 head_norm_before_train=1.502366 cos_to_last_merge=0.8724 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=11 local utility u=0.012491 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9949239849931423, 'loss_val': 0.08795040785267656, 'psi': 0.9948294842227743}-{'f1_val': 0.9955975227648919, 'auprc': 0.9918274011749049, 'loss_val': 0.10862923897463674, 'psi': 0.994089474128897}
[S11] START round=11 head_norm_before_train=0.700225 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.261816 metrics={'f1_val': 0.4012825464680092, 'auprc': 0.9930154884692579, 'loss_val': 0.7828405200838913, 'psi': 0.6379757232685087}-{'f1_val': 0.39992541946910537, 'auprc': 0.8244885869020433, 'loss_val': 0.7927493556507946, 'psi': 0.5697506864422806}
[S13] START round=11 head_norm_before_train=1.624476 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6220433835193718, 'auprc': 0.6742902722518201, 'loss_val': 0.5546758662096241, 'psi': 0.6429421390123511}-{'f1_val': 0.6337873854803918, 'auprc': 0.6921909871587846, 'loss_val': 0.5214397750966894, 'psi': 0.6571488261517489}
[S14] START round=11 head_norm_before_train=0.675915 cos_to_last_merge=0.9911 (last merge round=9)
[S14] round=11 local utility u=0.599815 metrics={'f1_val': 0.7005565488083836, 'auprc': 0.9877126812910073, 'loss_val': 0.7170842284243674, 'psi': 0.8154190018014331}-{'f1_val': 0.533311378514015, 'auprc': 0.9842460335151909, 'loss_val': 0.9028423200240124, 'psi': 0.7136852405144853}
[S15] START round=11 head_norm_before_train=0.946674 cos_to_last_merge=0.9695 (last merge round=8)
[S15] round=11 local utility u=0.800488 metrics={'f1_val': 0.7764506155937834, 'auprc': 0.980294905216944, 'loss_val': 0.3683595369289822, 'psi': 0.8579883314430476}-{'f1_val': 0.6985529835863493, 'auprc': 0.7021108459410426, 'loss_val': 0.6673979075049324, 'psi': 0.6999761285282267}
[S16] START round=11 head_norm_before_train=1.463908 (no previous merge yet)
[S16] round=11 local utility u=0.039224 metrics={'f1_val': 0.5471242614964398, 'auprc': 0.766777893498313, 'loss_val': 0.7520137114212073, 'psi': 0.6349857142971891}-{'f1_val': 0.5434733919532861, 'auprc': 0.7618302040853749, 'loss_val': 0.7937136348936867, 'psi': 0.6308161168061217}
[S17] START round=11 head_norm_before_train=1.366925 cos_to_last_merge=0.8630 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.863
[S17] round=11 local utility u=0.354369 metrics={'f1_val': 0.465959000772966, 'auprc': 0.823112140628257, 'loss_val': 0.612445144256353, 'psi': 0.6088202567150824}-{'f1_val': 0.3985085461337329, 'auprc': 0.7415756699547194, 'loss_val': 0.6718710162659567, 'psi': 0.5357353956621275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:59814
[S16] not sending this round → trigger blocked (psi=0.635)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=-0.0843
[S2] DROPPED delta from S3 (cos=-0.0843 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=0.1887
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.6622
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.7387
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.7238
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.4295
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.8953
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.6224
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.7732
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0772
[S4] DROPPED delta from S10 (cos=-0.0772 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] cosine check vs S6: cos=0.5648
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.9545
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6984 head_norm=1.085421
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.354973e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4633 head_norm=0.997555 delta_norm=0.335497
[S5] aggregate: ROLLBACK (f1_val pre=0.698 post=0.463 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.7069 head_norm=1.025271
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.231183e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7069 head_norm=1.059433 delta_norm=0.223118
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7006 head_norm=0.741840
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.113946e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.7003 head_norm=0.674182 delta_norm=0.211395
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.4013 head_norm=0.747337
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.703768e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.4006 head_norm=0.724838 delta_norm=0.170377
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=0.721129
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.389514e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.658414 delta_norm=0.238951
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7765 head_norm=1.007913
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.742784e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.8698 head_norm=0.899219 delta_norm=0.474278
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.718352 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6999714129314755, 'auprc': 0.6715495325771341, 'loss_val': 0.38247983195084156, 'psi': 0.6886026607897389}-{'f1_val': 0.6996105493161282, 'auprc': 0.6629364568106028, 'loss_val': 0.3454669813475968, 'psi': 0.6849409123139181}
[S3] START round=12 head_norm_before_train=1.551115 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.40457390379595104, 'auprc': 0.6927155137277018, 'loss_val': 0.8236149823890272, 'psi': 0.5198305477686513}-{'f1_val': 0.5053455498352799, 'auprc': 0.9085762567551627, 'loss_val': 0.6504969156757409, 'psi': 0.6666378326032331}
[S4] START round=12 head_norm_before_train=1.461418 cos_to_last_merge=0.9960 (last merge round=10)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9486737432492646, 'auprc': 0.9680456743313943, 'loss_val': 0.25065884249982023, 'psi': 0.9564225156821164}-{'f1_val': 0.9501689278327031, 'auprc': 0.9827525941151691, 'loss_val': 0.26440229811167393, 'psi': 0.9632023943456895}
[S5] START round=12 head_norm_before_train=0.997555 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.188476 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8644618243918636, 'loss_val': 0.7139578033109365, 'psi': 0.7662748450632597}-{'f1_val': 0.6983993892480375, 'auprc': 0.7759445425607847, 'loss_val': 0.8108531983195234, 'psi': 0.7294174505731363}
[S6] START round=12 head_norm_before_train=1.059433 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7065197602978587, 'auprc': 0.9602779800867074, 'loss_val': 0.4591226587950253, 'psi': 0.8080230482133981}-{'f1_val': 0.7068569842196915, 'auprc': 0.9627932068850019, 'loss_val': 0.4555938729131079, 'psi': 0.8092314732858157}
[S7] START round=12 head_norm_before_train=1.416446 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7916179638344627, 'loss_val': 0.7494081644471444, 'psi': 0.5666732564003991}-{'f1_val': 0.7144974922643522, 'auprc': 0.7930465663070901, 'loss_val': 0.7627733632158434, 'psi': 0.7459171218814473}
[S8] START round=12 head_norm_before_train=1.444505 cos_to_last_merge=0.8296 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=12 local utility u=0.006396 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.998756779556039, 'loss_val': 0.06666863280160719, 'psi': 0.9972245738625074}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990730425872809, 'loss_val': 0.08130832467639429, 'psi': 0.9974410619962871}
[S9] START round=12 head_norm_before_train=0.658414 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.017233 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9965207438738789, 'loss_val': 0.4955648132369502, 'psi': 0.8194260647597954}-{'f1_val': 0.7013629453504064, 'auprc': 0.9964018059496568, 'loss_val': 0.5296736490447801, 'psi': 0.8193784895901066}
[S10] START round=12 head_norm_before_train=1.543754 cos_to_last_merge=0.8648 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.865
[S10] round=12 local utility u=0.011069 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9949380857692434, 'loss_val': 0.07084276371236896, 'psi': 0.9953339258131375}-{'f1_val': 0.9947664837091956, 'auprc': 0.9949239849931423, 'loss_val': 0.08795040785267656, 'psi': 0.9948294842227743}
[S11] START round=12 head_norm_before_train=0.724838 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.884121 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9633009832830217, 'loss_val': 0.7287072667326044, 'psi': 0.8064151885339481}-{'f1_val': 0.4012825464680092, 'auprc': 0.9930154884692579, 'loss_val': 0.7828405200838913, 'psi': 0.6379757232685087}
[S13] START round=12 head_norm_before_train=1.660062 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6220302314729604, 'auprc': 0.6716465382821607, 'loss_val': 0.5840641197166475, 'psi': 0.6418767541966406}-{'f1_val': 0.6220433835193718, 'auprc': 0.6742902722518201, 'loss_val': 0.5546758662096241, 'psi': 0.6429421390123511}
[S14] START round=12 head_norm_before_train=0.674182 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.070554 metrics={'f1_val': 0.7017122972566672, 'auprc': 0.9943746026830951, 'loss_val': 0.6028968102031642, 'psi': 0.8187772194272384}-{'f1_val': 0.7005565488083836, 'auprc': 0.9877126812910073, 'loss_val': 0.7170842284243674, 'psi': 0.8154190018014331}
[S15] START round=12 head_norm_before_train=0.899219 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6984632204769246, 'auprc': 0.7991469672394053, 'loss_val': 0.5761254139583392, 'psi': 0.7387367191819167}-{'f1_val': 0.7764506155937834, 'auprc': 0.980294905216944, 'loss_val': 0.3683595369289822, 'psi': 0.8579883314430476}
[S16] START round=12 head_norm_before_train=1.499720 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4340319603123952, 'auprc': 0.7718509380401993, 'loss_val': 0.8173940295208677, 'psi': 0.5691595514035168}-{'f1_val': 0.5471242614964398, 'auprc': 0.766777893498313, 'loss_val': 0.7520137114212073, 'psi': 0.6349857142971891}
[S17] START round=12 head_norm_before_train=1.414792 cos_to_last_merge=0.8551 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.855
[S17] round=12 local utility u=0.277754 metrics={'f1_val': 0.5802569434612284, 'auprc': 0.7916780923430653, 'loss_val': 0.6484222120432362, 'psi': 0.6648254030139631}-{'f1_val': 0.465959000772966, 'auprc': 0.823112140628257, 'loss_val': 0.612445144256353, 'psi': 0.6088202567150824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.7382
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.6371
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.7139
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0784
[S4] DROPPED delta from S10 (cos=-0.0784 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9266
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.7672
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.8631
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7065 head_norm=1.110726
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.764603e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6974 head_norm=1.221737 delta_norm=0.476460
[S6] aggregate: ROLLBACK (f1_val pre=0.707 post=0.697 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=0.728023
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.440611e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.681924 delta_norm=0.144061
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7018 head_norm=0.769367
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.453596e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6288 head_norm=0.741326 delta_norm=0.145360
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7008 head_norm=1.024250
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.903430e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.6198 head_norm=1.204556 delta_norm=0.390343
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7017 head_norm=0.741256
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.779158e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7018 head_norm=0.680075 delta_norm=0.277916
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.750263 (no previous merge yet)
[S2] round=13 local utility u=0.113232 metrics={'f1_val': 0.7003323196347389, 'auprc': 0.7481706926887257, 'loss_val': 0.3880453544803455, 'psi': 0.7194676688563336}-{'f1_val': 0.6999714129314755, 'auprc': 0.6715495325771341, 'loss_val': 0.38247983195084156, 'psi': 0.6886026607897389}
[S3] START round=13 head_norm_before_train=1.578582 (no previous merge yet)
[S3] round=13 local utility u=1.000000 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9926755523719527, 'loss_val': 0.40024311445348937, 'psi': 0.8127201482382175}-{'f1_val': 0.40457390379595104, 'auprc': 0.6927155137277018, 'loss_val': 0.8236149823890272, 'psi': 0.5198305477686513}
[S4] START round=13 head_norm_before_train=1.528621 cos_to_last_merge=0.9888 (last merge round=10)
[S4] round=13 local utility u=0.019934 metrics={'f1_val': 0.9492090519454308, 'auprc': 0.9806250368266849, 'loss_val': 0.2517406903879745, 'psi': 0.9617754458979325}-{'f1_val': 0.9486737432492646, 'auprc': 0.9680456743313943, 'loss_val': 0.25065884249982023, 'psi': 0.9564225156821164}
[S5] START round=13 head_norm_before_train=1.204556 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.681590468148219, 'auprc': 0.7682510113391547, 'loss_val': 0.7563694047805518, 'psi': 0.7162546854245933}-{'f1_val': 0.7008168588441903, 'auprc': 0.8644618243918636, 'loss_val': 0.7139578033109365, 'psi': 0.7662748450632597}
[S6] START round=13 head_norm_before_train=1.221737 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.027946 metrics={'f1_val': 0.7212081866215017, 'auprc': 0.9300975004517614, 'loss_val': 0.40082035036876773, 'psi': 0.8047639121536055}-{'f1_val': 0.7065197602978587, 'auprc': 0.9602779800867074, 'loss_val': 0.4591226587950253, 'psi': 0.8080230482133981}
[S7] START round=13 head_norm_before_train=1.439871 (no previous merge yet)
[S7] round=13 local utility u=0.010005 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7907380742621205, 'loss_val': 0.7267582683536068, 'psi': 0.5663213005714622}-{'f1_val': 0.41671011811102343, 'auprc': 0.7916179638344627, 'loss_val': 0.7494081644471444, 'psi': 0.5666732564003991}
[S8] START round=13 head_norm_before_train=1.485126 cos_to_last_merge=0.8233 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.823
[S8] round=13 local utility u=0.005338 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990272356258534, 'loss_val': 0.057703893119187874, 'psi': 0.9974227392117161}-{'f1_val': 0.9962031034001528, 'auprc': 0.998756779556039, 'loss_val': 0.06666863280160719, 'psi': 0.9972245738625074}
[S9] START round=13 head_norm_before_train=0.681924 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.015602 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9979240961911928, 'loss_val': 0.4685713003029174, 'psi': 0.8199874056867209}-{'f1_val': 0.7013629453504064, 'auprc': 0.9965207438738789, 'loss_val': 0.4955648132369502, 'psi': 0.8194260647597954}
[S10] START round=13 head_norm_before_train=1.587009 cos_to_last_merge=0.8576 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.858
[S10] round=13 local utility u=0.005461 metrics={'f1_val': 0.9954505628720012, 'auprc': 0.9948922099936646, 'loss_val': 0.05890017456058522, 'psi': 0.9952272217206666}-{'f1_val': 0.9955978191757338, 'auprc': 0.9949380857692434, 'loss_val': 0.07084276371236896, 'psi': 0.9953339258131375}
[S11] START round=13 head_norm_before_train=0.741326 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.028675 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9629201047418909, 'loss_val': 0.6712703751823823, 'psi': 0.8063685074642957}-{'f1_val': 0.7018246587012323, 'auprc': 0.9633009832830217, 'loss_val': 0.7287072667326044, 'psi': 0.8064151885339481}
[S13] START round=13 head_norm_before_train=1.693081 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5935018240418252, 'auprc': 0.6873310964015881, 'loss_val': 0.7433353445153977, 'psi': 0.6310335329857304}-{'f1_val': 0.6220302314729604, 'auprc': 0.6716465382821607, 'loss_val': 0.5840641197166475, 'psi': 0.6418767541966406}
[S14] START round=13 head_norm_before_train=0.680075 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.051611 metrics={'f1_val': 0.701751512821432, 'auprc': 0.9971423440591899, 'loss_val': 0.5082126667264711, 'psi': 0.8199078453165352}-{'f1_val': 0.7017122972566672, 'auprc': 0.9943746026830951, 'loss_val': 0.6028968102031642, 'psi': 0.8187772194272384}
[S15] START round=13 head_norm_before_train=0.956067 cos_to_last_merge=0.9951 (last merge round=11)
[S15] round=13 local utility u=0.028626 metrics={'f1_val': 0.6982879433133806, 'auprc': 0.7992239981833201, 'loss_val': 0.5180523744343395, 'psi': 0.7386623652613564}-{'f1_val': 0.6984632204769246, 'auprc': 0.7991469672394053, 'loss_val': 0.5761254139583392, 'psi': 0.7387367191819167}
[S16] START round=13 head_norm_before_train=1.535816 (no previous merge yet)
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.8250808944947182, 'auprc': 0.7981253687203276, 'loss_val': 0.7188214462104752, 'psi': 0.814298684184962}-{'f1_val': 0.4340319603123952, 'auprc': 0.7718509380401993, 'loss_val': 0.8173940295208677, 'psi': 0.5691595514035168}
[S17] START round=13 head_norm_before_train=1.468864 cos_to_last_merge=0.8483 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=13 local utility u=0.034831 metrics={'f1_val': 0.5818165945193219, 'auprc': 0.8105109082347522, 'loss_val': 0.6446166830350576, 'psi': 0.6732943200054939}-{'f1_val': 0.5802569434612284, 'auprc': 0.7916780923430653, 'loss_val': 0.6484222120432362, 'psi': 0.6648254030139631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:59812
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9404
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0883
[S2] DROPPED delta from S3 (cos=-0.0883 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.5090
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=0.2170
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.1166
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.6722
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9350
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.7441
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0795
[S4] DROPPED delta from S10 (cos=-0.0795 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.9387
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.5127
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.9065
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] cosine check vs S17: cos=0.9678
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.6816 head_norm=1.227056
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.521848e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.5889 head_norm=1.113374 delta_norm=0.352185
[S5] aggregate: ROLLBACK (f1_val pre=0.682 post=0.589 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7014 head_norm=0.751158
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.749831e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7014 head_norm=0.716859 delta_norm=0.274983
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7020 head_norm=0.784071
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.393510e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7021 head_norm=0.755597 delta_norm=0.139351
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7018 head_norm=0.752280
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.236866e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.7018 head_norm=0.710440 delta_norm=0.223687
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6983 head_norm=1.029787
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.765963e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6985 head_norm=1.049860 delta_norm=0.476596
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9492 head_norm=1.569927
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.749827e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9483 head_norm=1.546558 delta_norm=0.274983
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7212 head_norm=1.264215
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.930934e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.9580 head_norm=1.103417 delta_norm=0.293093
[S6] aggregate: ACCEPT kept=['S8', 'S7', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.776837 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7055550883795146, 'auprc': 0.6657600474700714, 'loss_val': 0.4364411077543156, 'psi': 0.6896370720157374}-{'f1_val': 0.7003323196347389, 'auprc': 0.7481706926887257, 'loss_val': 0.3880453544803455, 'psi': 0.7194676688563336}
[S3] START round=14 head_norm_before_train=1.602466 (no previous merge yet)
[S3] round=14 local utility u=0.047466 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9933909347081653, 'loss_val': 0.3529437166163474, 'psi': 0.8175549252951834}-{'f1_val': 0.6927498788157274, 'auprc': 0.9926755523719527, 'loss_val': 0.40024311445348937, 'psi': 0.8127201482382175}
[S4] START round=14 head_norm_before_train=1.546558 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9405805056838427, 'auprc': 0.9608888856031922, 'loss_val': 0.26308360851904333, 'psi': 0.9487038576515825}-{'f1_val': 0.9492090519454308, 'auprc': 0.9806250368266849, 'loss_val': 0.2517406903879745, 'psi': 0.9617754458979325}
[S5] START round=14 head_norm_before_train=1.113374 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.276618 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8638556224961073, 'loss_val': 0.6038188488281695, 'psi': 0.7658837421046012}-{'f1_val': 0.681590468148219, 'auprc': 0.7682510113391547, 'loss_val': 0.7563694047805518, 'psi': 0.7162546854245933}
[S6] START round=14 head_norm_before_train=1.103417 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6179034236032224, 'auprc': 0.7633285400150251, 'loss_val': 0.5943875155608044, 'psi': 0.6760734701679435}-{'f1_val': 0.7212081866215017, 'auprc': 0.9300975004517614, 'loss_val': 0.40082035036876773, 'psi': 0.8047639121536055}
[S7] START round=14 head_norm_before_train=1.458665 (no previous merge yet)
[S7] round=14 local utility u=0.905317 metrics={'f1_val': 0.7141358033381153, 'auprc': 0.7873115988313908, 'loss_val': 0.6903995839867479, 'psi': 0.7434061215354255}-{'f1_val': 0.41671011811102343, 'auprc': 0.7907380742621205, 'loss_val': 0.7267582683536068, 'psi': 0.5663213005714622}
[S8] START round=14 head_norm_before_train=1.527964 cos_to_last_merge=0.8182 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9937777583442691, 'auprc': 0.9968225680470426, 'loss_val': 0.055331432978290365, 'psi': 0.9949956822253785}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990272356258534, 'loss_val': 0.057703893119187874, 'psi': 0.9974227392117161}
[S9] START round=14 head_norm_before_train=0.716859 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.031220 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9983786604517664, 'loss_val': 0.40705083364876293, 'psi': 0.8201247653438122}-{'f1_val': 0.7013629453504064, 'auprc': 0.9979240961911928, 'loss_val': 0.4685713003029174, 'psi': 0.8199874056867209}
[S10] START round=14 head_norm_before_train=1.632595 cos_to_last_merge=0.8512 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=14 local utility u=0.001777 metrics={'f1_val': 0.9946326116076992, 'auprc': 0.9948987695546533, 'loss_val': 0.05045733003121815, 'psi': 0.9947390747864808}-{'f1_val': 0.9954505628720012, 'auprc': 0.9948922099936646, 'loss_val': 0.05890017456058522, 'psi': 0.9952272217206666}
[S11] START round=14 head_norm_before_train=0.755597 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.048767 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9629312220764575, 'loss_val': 0.5719265078166413, 'psi': 0.8061885765827379}-{'f1_val': 0.7020007759458987, 'auprc': 0.9629201047418909, 'loss_val': 0.6712703751823823, 'psi': 0.8063685074642957}
[S13] START round=14 head_norm_before_train=1.714194 (no previous merge yet)
[S13] round=14 local utility u=0.006513 metrics={'f1_val': 0.5947808266948168, 'auprc': 0.687706178799397, 'loss_val': 0.7391089869129486, 'psi': 0.6319509675366488}-{'f1_val': 0.5935018240418252, 'auprc': 0.6873310964015881, 'loss_val': 0.7433353445153977, 'psi': 0.6310335329857304}
[S14] START round=14 head_norm_before_train=0.710440 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.006999 metrics={'f1_val': 0.7021696919130598, 'auprc': 0.9956550064217886, 'loss_val': 0.4922611807356075, 'psi': 0.8195638177165514}-{'f1_val': 0.701751512821432, 'auprc': 0.9971423440591899, 'loss_val': 0.5082126667264711, 'psi': 0.8199078453165352}
[S15] START round=14 head_norm_before_train=1.049860 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.031682 metrics={'f1_val': 0.6974153433997211, 'auprc': 0.8171206952761972, 'loss_val': 0.5031430662474667, 'psi': 0.7452974841503115}-{'f1_val': 0.6982879433133806, 'auprc': 0.7992239981833201, 'loss_val': 0.5180523744343395, 'psi': 0.7386623652613564}
[S16] START round=14 head_norm_before_train=1.571701 (no previous merge yet)
[S16] round=14 local utility u=0.123610 metrics={'f1_val': 0.8411709919724168, 'auprc': 0.8267257533796161, 'loss_val': 0.6539426161426409, 'psi': 0.8353928965352966}-{'f1_val': 0.8250808944947182, 'auprc': 0.7981253687203276, 'loss_val': 0.7188214462104752, 'psi': 0.814298684184962}
[S17] START round=14 head_norm_before_train=1.526662 cos_to_last_merge=0.8431 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5792223992538822, 'auprc': 0.763751211732363, 'loss_val': 0.7876725081185881, 'psi': 0.6530339242452745}-{'f1_val': 0.5818165945193219, 'auprc': 0.8105109082347522, 'loss_val': 0.6446166830350576, 'psi': 0.6732943200054939}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=-0.0884
[S2] DROPPED delta from S3 (cos=-0.0884 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=0.9517
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.3908
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] cosine check vs S11: cos=0.9669
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.2653
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0655
[S4] DROPPED delta from S10 (cos=-0.0655 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9762
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.9476
[S14] RECEIVED delta(kind=head bytes=1792) from S15
[S14] cosine check vs S15: cos=0.6919
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.5783
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6179 head_norm=1.141513
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.189149e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6402 head_norm=1.164952 delta_norm=0.618915
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9406 head_norm=1.583511
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.747061e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9399 head_norm=1.587559 delta_norm=0.174706
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.798713
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.227887e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.777077 delta_norm=0.122789
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7022 head_norm=0.774537
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.696137e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7022 head_norm=0.785855 delta_norm=0.169614
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=0.790622
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.894878e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=0.731263 delta_norm=0.189488
[S9] aggregate: ACCEPT kept=['S5', 'S11', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.800587 (no previous merge yet)
[S2] round=15 local utility u=0.138237 metrics={'f1_val': 0.6996078256430083, 'auprc': 0.7632889245862342, 'loss_val': 0.41687070688984607, 'psi': 0.7250802652202987}-{'f1_val': 0.7055550883795146, 'auprc': 0.6657600474700714, 'loss_val': 0.4364411077543156, 'psi': 0.6896370720157374}
[S3] START round=15 head_norm_before_train=1.627413 (no previous merge yet)
[S3] round=15 local utility u=0.015139 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9935410843653856, 'loss_val': 0.32461825518738363, 'psi': 0.8177652713414072}-{'f1_val': 0.700330919019862, 'auprc': 0.9933909347081653, 'loss_val': 0.3529437166163474, 'psi': 0.8175549252951834}
[S4] START round=15 head_norm_before_train=1.587559 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.010359 metrics={'f1_val': 0.9392681433826247, 'auprc': 0.9735018566986431, 'loss_val': 0.2723307699266869, 'psi': 0.952961628709032}-{'f1_val': 0.9405805056838427, 'auprc': 0.9608888856031922, 'loss_val': 0.26308360851904333, 'psi': 0.9487038576515825}
[S5] START round=15 head_norm_before_train=1.138987 cos_to_last_merge=0.9981 (last merge round=13)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.4171435078150064, 'auprc': 0.7054601746257562, 'loss_val': 0.9432781411492542, 'psi': 0.5324701745393063}-{'f1_val': 0.7005691551769304, 'auprc': 0.8638556224961073, 'loss_val': 0.6038188488281695, 'psi': 0.7658837421046012}
[S6] START round=15 head_norm_before_train=1.164952 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6048695051352232, 'auprc': 0.7881895510470394, 'loss_val': 0.6176823823298616, 'psi': 0.6781975234999497}-{'f1_val': 0.6179034236032224, 'auprc': 0.7633285400150251, 'loss_val': 0.5943875155608044, 'psi': 0.6760734701679435}
[S7] START round=15 head_norm_before_train=1.475562 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6230218871269045, 'auprc': 0.7880641877189776, 'loss_val': 0.7048724489972291, 'psi': 0.6890388073637337}-{'f1_val': 0.7141358033381153, 'auprc': 0.7873115988313908, 'loss_val': 0.6903995839867479, 'psi': 0.7434061215354255}
[S8] START round=15 head_norm_before_train=1.563346 cos_to_last_merge=0.8129 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=15 local utility u=0.011957 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9983361111963042, 'loss_val': 0.051409402058730735, 'psi': 0.9971462894398964}-{'f1_val': 0.9937777583442691, 'auprc': 0.9968225680470426, 'loss_val': 0.055331432978290365, 'psi': 0.9949956822253785}
[S9] START round=15 head_norm_before_train=0.731263 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.002359 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9983044118986493, 'loss_val': 0.4021106030974687, 'psi': 0.8200950659225653}-{'f1_val': 0.7012888352718426, 'auprc': 0.9983786604517664, 'loss_val': 0.40705083364876293, 'psi': 0.8201247653438122}
[S10] START round=15 head_norm_before_train=1.675839 cos_to_last_merge=0.8458 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=15 local utility u=0.003550 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9946347117372523, 'loss_val': 0.04586321290945703, 'psi': 0.9949632902664161}-{'f1_val': 0.9946326116076992, 'auprc': 0.9948987695546533, 'loss_val': 0.05045733003121815, 'psi': 0.9947390747864808}
[S11] START round=15 head_norm_before_train=0.777077 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.074675 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981615052755637, 'loss_val': 0.5297191762212631, 'psi': 0.8204257920892175}-{'f1_val': 0.7016934795869249, 'auprc': 0.9629312220764575, 'loss_val': 0.5719265078166413, 'psi': 0.8061885765827379}
[S13] START round=15 head_norm_before_train=1.726467 (no previous merge yet)
[S13] round=15 local utility u=0.092438 metrics={'f1_val': 0.6214782100869118, 'auprc': 0.6684217267550179, 'loss_val': 0.6565630138981101, 'psi': 0.6402556167541542}-{'f1_val': 0.5947808266948168, 'auprc': 0.687706178799397, 'loss_val': 0.7391089869129486, 'psi': 0.6319509675366488}
[S14] START round=15 head_norm_before_train=0.785855 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.897084 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9970584451807759, 'loss_val': 0.473868884576589, 'psi': 0.9972817414683098}-{'f1_val': 0.7021696919130598, 'auprc': 0.9956550064217886, 'loss_val': 0.4922611807356075, 'psi': 0.8195638177165514}
[S15] START round=15 head_norm_before_train=1.114644 cos_to_last_merge=0.9932 (last merge round=13)
[S15] round=15 local utility u=0.547830 metrics={'f1_val': 0.7694397571714279, 'auprc': 0.9822962546943061, 'loss_val': 0.33515541975231866, 'psi': 0.8545823561805792}-{'f1_val': 0.6974153433997211, 'auprc': 0.8171206952761972, 'loss_val': 0.5031430662474667, 'psi': 0.7452974841503115}
[S16] START round=15 head_norm_before_train=1.610661 (no previous merge yet)
[S16] round=15 local utility u=0.264246 metrics={'f1_val': 0.8742414334031093, 'auprc': 0.891388188256236, 'loss_val': 0.5178602814866881, 'psi': 0.88110013534436}-{'f1_val': 0.8411709919724168, 'auprc': 0.8267257533796161, 'loss_val': 0.6539426161426409, 'psi': 0.8353928965352966}
[S17] START round=15 head_norm_before_train=1.587436 cos_to_last_merge=0.8401 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5627660098817933, 'auprc': 0.7627996942556416, 'loss_val': 0.8604280428521323, 'psi': 0.6427794836313326}-{'f1_val': 0.5792223992538822, 'auprc': 0.763751211732363, 'loss_val': 0.7876725081185881, 'psi': 0.6530339242452745}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.818)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:59807
[S15] not sending this round → trigger blocked (psi=0.855)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:59807
[S16] not sending this round → trigger blocked (psi=0.881)
[S11] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S13] not sending this round → trigger blocked (psi=0.640)
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] sending update (kind=head size=1809 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1809) from S2
[S6] cosine check vs S2: cos=0.0928
[S6] RECEIVED delta(kind=head bytes=1791) from S8
[S6] cosine check vs S8: cos=0.5940
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.4511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.090 → S9@127.0.0.1:59810
[S11] ⇄ pheromone p=0.231 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.148 → S4@127.0.0.1:59804
[S9] ⇄ pheromone p=0.135 → S14@127.0.0.1:59814
[S14] ⇄ pheromone p=0.377 → S11@127.0.0.1:59812
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.4171 head_norm=1.168964
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.577022e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.4342 head_norm=1.196564 delta_norm=0.757702
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.205 → S9@127.0.0.1:59810
[S3] ⇄ pheromone p=0.329 → S2@127.0.0.1:59802
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6049 head_norm=1.200278
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.498131e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.5759 head_norm=1.043434 delta_norm=0.649813
[S6] aggregate: ROLLBACK (f1_val pre=0.605 post=0.576 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.168 → S15@127.0.0.1:59815
[S7] ⇄ pheromone p=0.285 → S6@127.0.0.1:59807
[S15] ⇄ pheromone p=0.276 → S14@127.0.0.1:59814
[S8] ⇄ pheromone p=0.122 → S6@127.0.0.1:59807
[S4] ⇄ pheromone p=0.113 → S5@127.0.0.1:59805
[S2] ⇄ pheromone p=0.116 → S6@127.0.0.1:59807
[S17] ⇄ pheromone p=0.155 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.325 → S4@127.0.0.1:59804
[S2] START round=16 head_norm_before_train=1.819116 (no previous merge yet)
[S2] round=16 local utility u=0.052897 metrics={'f1_val': 0.7045071914428808, 'auprc': 0.7800069741504203, 'loss_val': 0.3906272362391006, 'psi': 0.7347071045258966}-{'f1_val': 0.6996078256430083, 'auprc': 0.7632889245862342, 'loss_val': 0.41687070688984607, 'psi': 0.7250802652202987}
[S3] START round=16 head_norm_before_train=1.653369 (no previous merge yet)
[S3] round=16 local utility u=0.005294 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9923609480925433, 'loss_val': 0.3104901166890851, 'psi': 0.8172932168322703}-{'f1_val': 0.7005813959920884, 'auprc': 0.9935410843653856, 'loss_val': 0.32461825518738363, 'psi': 0.8177652713414072}
[S4] START round=16 head_norm_before_train=1.626432 cos_to_last_merge=0.9983 (last merge round=14)
[S4] round=16 local utility u=0.074610 metrics={'f1_val': 0.955045092763934, 'auprc': 0.9776548319572785, 'loss_val': 0.23023063526567691, 'psi': 0.9640889884412719}-{'f1_val': 0.9392681433826247, 'auprc': 0.9735018566986431, 'loss_val': 0.2723307699266869, 'psi': 0.952961628709032}
[S5] START round=16 head_norm_before_train=1.196564 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=1.000000 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.8385322294782879, 'loss_val': 0.5551456096415622, 'psi': 0.7556061941807144}-{'f1_val': 0.4171435078150064, 'auprc': 0.7054601746257562, 'loss_val': 0.9432781411492542, 'psi': 0.5324701745393063}
[S6] START round=16 head_norm_before_train=1.043434 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.144131 metrics={'f1_val': 0.6261506282469494, 'auprc': 0.8081423735499448, 'loss_val': 0.5169648988133481, 'psi': 0.6989473263681476}-{'f1_val': 0.6048695051352232, 'auprc': 0.7881895510470394, 'loss_val': 0.6176823823298616, 'psi': 0.6781975234999497}
[S7] START round=16 head_norm_before_train=1.491421 (no previous merge yet)
[S7] round=16 local utility u=0.191609 metrics={'f1_val': 0.6717176546149493, 'auprc': 0.789420755680974, 'loss_val': 0.6178985259583745, 'psi': 0.7187988950413591}-{'f1_val': 0.6230218871269045, 'auprc': 0.7880641877189776, 'loss_val': 0.7048724489972291, 'psi': 0.6890388073637337}
[S8] START round=16 head_norm_before_train=1.585588 cos_to_last_merge=0.8105 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9950896741697648, 'auprc': 0.9981158311051674, 'loss_val': 0.06645135032939488, 'psi': 0.9963001369439258}-{'f1_val': 0.9963530749356245, 'auprc': 0.9983361111963042, 'loss_val': 0.051409402058730735, 'psi': 0.9971462894398964}
[S9] START round=16 head_norm_before_train=0.797161 cos_to_last_merge=0.9958 (last merge round=14)
[S9] round=16 local utility u=0.023148 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9980822572560921, 'loss_val': 0.35558302125349456, 'psi': 0.8200497186095244}-{'f1_val': 0.7012888352718426, 'auprc': 0.9983044118986493, 'loss_val': 0.4021106030974687, 'psi': 0.8200950659225653}
[S10] START round=16 head_norm_before_train=1.714264 cos_to_last_merge=0.8419 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.842
[S10] round=16 local utility u=0.002106 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948765264853074, 'loss_val': 0.04240981439481593, 'psi': 0.9950633140057479}-{'f1_val': 0.995182342619192, 'auprc': 0.9946347117372523, 'loss_val': 0.04586321290945703, 'psi': 0.9949632902664161}
[S11] START round=16 head_norm_before_train=0.821106 cos_to_last_merge=0.9974 (last merge round=14)
[S11] round=16 local utility u=0.051433 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9979551133735763, 'loss_val': 0.4258436950913685, 'psi': 0.8203041165029792}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981615052755637, 'loss_val': 0.5297191762212631, 'psi': 0.8204257920892175}
[S13] START round=16 head_norm_before_train=1.742359 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5980935119718382, 'auprc': 0.673678110398582, 'loss_val': 0.7682302456045904, 'psi': 0.6283273513425358}-{'f1_val': 0.6214782100869118, 'auprc': 0.6684217267550179, 'loss_val': 0.6565630138981101, 'psi': 0.6402556167541542}
[S14] START round=16 head_norm_before_train=0.845986 cos_to_last_merge=0.9954 (last merge round=14)
[S14] round=16 local utility u=0.038684 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9946454378517231, 'loss_val': 0.3905845311190407, 'psi': 0.9964488459706013}-{'f1_val': 0.9974306056599991, 'auprc': 0.9970584451807759, 'loss_val': 0.473868884576589, 'psi': 0.9972817414683098}
[S15] START round=16 head_norm_before_train=1.192449 cos_to_last_merge=0.9781 (last merge round=13)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006525651679645, 'auprc': 0.831515744288268, 'loss_val': 0.3994531076077817, 'psi': 0.7529978368160859}-{'f1_val': 0.7694397571714279, 'auprc': 0.9822962546943061, 'loss_val': 0.33515541975231866, 'psi': 0.8545823561805792}
[S16] START round=16 head_norm_before_train=1.650536 (no previous merge yet)
[S16] round=16 local utility u=0.236576 metrics={'f1_val': 0.916913423003582, 'auprc': 0.9159710450604457, 'loss_val': 0.37448925865256416, 'psi': 0.9165364718263275}-{'f1_val': 0.8742414334031093, 'auprc': 0.891388188256236, 'loss_val': 0.5178602814866881, 'psi': 0.88110013534436}
[S17] START round=16 head_norm_before_train=1.627201 cos_to_last_merge=0.8380 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=16 local utility u=0.336088 metrics={'f1_val': 0.5913833477217276, 'auprc': 0.9020451214381727, 'loss_val': 0.7776923891122036, 'psi': 0.7156480572083057}-{'f1_val': 0.5627660098817933, 'auprc': 0.7627996942556416, 'loss_val': 0.8604280428521323, 'psi': 0.6427794836313326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.964)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[S2] not sending this round → trigger blocked (psi=0.735)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:59812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.8742
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.5870
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=-0.0864
[S2] DROPPED delta from S3 (cos=-0.0864 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] cosine check vs S6: cos=0.8098
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] cosine check vs S14: cos=0.9481
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.3922
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.9240
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0558
[S4] DROPPED delta from S10 (cos=-0.0558 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.9766
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.4405
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9550 head_norm=1.661772
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.816817e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9528 head_norm=1.664626 delta_norm=0.181682
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=1.213868
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.849866e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=1.227317 delta_norm=0.784987
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=0.877176
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.447792e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7016 head_norm=0.881455 delta_norm=0.144779
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7014 head_norm=0.860423
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.918772e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7014 head_norm=0.799166 delta_norm=0.291877
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6262 head_norm=1.085181
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.179194e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7651 head_norm=1.158139 delta_norm=0.617919
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=0.909071
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.231176e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9977 head_norm=0.856497 delta_norm=0.223118
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7007 head_norm=1.279552
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.762018e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7032 head_norm=1.125125 delta_norm=0.376202
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.831921 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6889009512332229, 'auprc': 0.6641324899991946, 'loss_val': 0.5081102056587721, 'psi': 0.6789935667396116}-{'f1_val': 0.7045071914428808, 'auprc': 0.7800069741504203, 'loss_val': 0.3906272362391006, 'psi': 0.7347071045258966}
[S3] START round=17 head_norm_before_train=1.683168 (no previous merge yet)
[S3] round=17 local utility u=0.018333 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9950537019804624, 'loss_val': 0.2834040027385004, 'psi': 0.8185205218074714}-{'f1_val': 0.7005813959920884, 'auprc': 0.9923609480925433, 'loss_val': 0.3104901166890851, 'psi': 0.8172932168322703}
[S4] START round=17 head_norm_before_train=1.664626 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9376306650600547, 'auprc': 0.960007858010703, 'loss_val': 0.2557126799086808, 'psi': 0.946581542240314}-{'f1_val': 0.955045092763934, 'auprc': 0.9776548319572785, 'loss_val': 0.23023063526567691, 'psi': 0.9640889884412719}
[S5] START round=17 head_norm_before_train=1.227317 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6412643936791974, 'auprc': 0.768028380909753, 'loss_val': 0.7055633103802977, 'psi': 0.6919699885714197}-{'f1_val': 0.7003221706489986, 'auprc': 0.8385322294782879, 'loss_val': 0.5551456096415622, 'psi': 0.7556061941807144}
[S6] START round=17 head_norm_before_train=1.158139 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6209176761897397, 'auprc': 0.8015357213454274, 'loss_val': 0.5657124650836608, 'psi': 0.6931648942520148}-{'f1_val': 0.6261506282469494, 'auprc': 0.8081423735499448, 'loss_val': 0.5169648988133481, 'psi': 0.6989473263681476}
[S7] START round=17 head_norm_before_train=1.506189 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6292352494223912, 'auprc': 0.7884643018774657, 'loss_val': 0.6129653882120751, 'psi': 0.692926870404421}-{'f1_val': 0.6717176546149493, 'auprc': 0.789420755680974, 'loss_val': 0.6178985259583745, 'psi': 0.7187988950413591}
[S8] START round=17 head_norm_before_train=1.608140 cos_to_last_merge=0.8091 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.809
[S8] round=17 local utility u=0.001966 metrics={'f1_val': 0.9940369334152557, 'auprc': 0.9983089443340482, 'loss_val': 0.056782679082240044, 'psi': 0.9957457377827726}-{'f1_val': 0.9950896741697648, 'auprc': 0.9981158311051674, 'loss_val': 0.06645135032939488, 'psi': 0.9963001369439258}
[S9] START round=17 head_norm_before_train=0.799166 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9965120860914989, 'loss_val': 0.3782069453618675, 'psi': 0.8194216501436871}-{'f1_val': 0.7013613595118124, 'auprc': 0.9980822572560921, 'loss_val': 0.35558302125349456, 'psi': 0.8200497186095244}
[S10] START round=17 head_norm_before_train=1.748222 cos_to_last_merge=0.8387 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.839
[S10] round=17 local utility u=0.002542 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9948131710296727, 'loss_val': 0.03959600853920831, 'psi': 0.9952839599173093}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948765264853074, 'loss_val': 0.04240981439481593, 'psi': 0.9950633140057479}
[S11] START round=17 head_norm_before_train=0.881455 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.013405 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980841290682045, 'loss_val': 0.3998127663529004, 'psi': 0.8203948416062739}-{'f1_val': 0.7018701185892477, 'auprc': 0.9979551133735763, 'loss_val': 0.4258436950913685, 'psi': 0.8203041165029792}
[S13] START round=17 head_norm_before_train=1.760836 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5835523924711976, 'auprc': 0.6943246064287181, 'loss_val': 0.8113896436094712, 'psi': 0.6278612780542059}-{'f1_val': 0.5980935119718382, 'auprc': 0.673678110398582, 'loss_val': 0.7682302456045904, 'psi': 0.6283273513425358}
[S14] START round=17 head_norm_before_train=0.856497 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.022978 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9953670941788596, 'loss_val': 0.34287251422802034, 'psi': 0.9963453425661428}-{'f1_val': 0.9976511180498535, 'auprc': 0.9946454378517231, 'loss_val': 0.3905845311190407, 'psi': 0.9964488459706013}
[S15] START round=17 head_norm_before_train=1.125125 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.781526 metrics={'f1_val': 0.8615336757739129, 'auprc': 0.9896253915309013, 'loss_val': 0.2760176384165101, 'psi': 0.9127703620767083}-{'f1_val': 0.7006525651679645, 'auprc': 0.831515744288268, 'loss_val': 0.3994531076077817, 'psi': 0.7529978368160859}
[S16] START round=17 head_norm_before_train=1.687155 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8631360960478358, 'auprc': 0.9194239608741732, 'loss_val': 0.578554857618628, 'psi': 0.8856512419783708}-{'f1_val': 0.916913423003582, 'auprc': 0.9159710450604457, 'loss_val': 0.37448925865256416, 'psi': 0.9165364718263275}
[S17] START round=17 head_norm_before_train=1.664797 cos_to_last_merge=0.8372 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=17 local utility u=0.007954 metrics={'f1_val': 0.5960119191046993, 'auprc': 0.8908515757703088, 'loss_val': 0.7559761221961137, 'psi': 0.7139477817709432}-{'f1_val': 0.5913833477217276, 'auprc': 0.9020451214381727, 'loss_val': 0.7776923891122036, 'psi': 0.7156480572083057}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.5250
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.5867
[S17] not sending this round → trigger blocked (psi=0.714)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9970 head_norm=0.921418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.000229e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9962 head_norm=0.949882 delta_norm=0.500023
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6209 head_norm=1.212603
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.163212e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6145 head_norm=1.245409 delta_norm=0.716321
[S6] aggregate: ROLLBACK (f1_val pre=0.621 post=0.615 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.851250 (no previous merge yet)
[S2] round=18 local utility u=0.303922 metrics={'f1_val': 0.7014776350647682, 'auprc': 0.8263193397428401, 'loss_val': 0.46228632329870256, 'psi': 0.751414316935997}-{'f1_val': 0.6889009512332229, 'auprc': 0.6641324899991946, 'loss_val': 0.5081102056587721, 'psi': 0.6789935667396116}
[S3] START round=18 head_norm_before_train=1.712718 (no previous merge yet)
[S3] round=18 local utility u=0.011159 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9979147212225578, 'loss_val': 0.2692163703178602, 'psi': 0.819619610730203}-{'f1_val': 0.7008317350254774, 'auprc': 0.9950537019804624, 'loss_val': 0.2834040027385004, 'psi': 0.8185205218074714}
[S4] START round=18 head_norm_before_train=1.689728 cos_to_last_merge=0.9995 (last merge round=16)
[S4] round=18 local utility u=0.040684 metrics={'f1_val': 0.9397160298187, 'auprc': 0.9819239334409825, 'loss_val': 0.25260458717652345, 'psi': 0.9565991912676131}-{'f1_val': 0.9376306650600547, 'auprc': 0.960007858010703, 'loss_val': 0.2557126799086808, 'psi': 0.946581542240314}
[S5] START round=18 head_norm_before_train=1.253678 cos_to_last_merge=0.9990 (last merge round=16)
[S5] round=18 local utility u=0.147331 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6625327054337748, 'loss_val': 0.4487557866910891, 'psi': 0.6852058726338581}-{'f1_val': 0.6412643936791974, 'auprc': 0.768028380909753, 'loss_val': 0.7055633103802977, 'psi': 0.6919699885714197}
[S6] START round=18 head_norm_before_train=1.245409 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6022024673477238, 'auprc': 0.7816046956305246, 'loss_val': 0.6041515926243025, 'psi': 0.6739633586608441}-{'f1_val': 0.6209176761897397, 'auprc': 0.8015357213454274, 'loss_val': 0.5657124650836608, 'psi': 0.6931648942520148}
[S7] START round=18 head_norm_before_train=1.523057 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.4656706898109175, 'auprc': 0.7696499148037775, 'loss_val': 0.839767422277942, 'psi': 0.5872623798080616}-{'f1_val': 0.6292352494223912, 'auprc': 0.7884643018774657, 'loss_val': 0.6129653882120751, 'psi': 0.692926870404421}
[S8] START round=18 head_norm_before_train=1.630310 cos_to_last_merge=0.8074 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=18 local utility u=0.001364 metrics={'f1_val': 0.992174240363445, 'auprc': 0.998615980641917, 'loss_val': 0.04379979998229492, 'psi': 0.9947509364748338}-{'f1_val': 0.9940369334152557, 'auprc': 0.9983089443340482, 'loss_val': 0.056782679082240044, 'psi': 0.9957457377827726}
[S9] START round=18 head_norm_before_train=0.853558 cos_to_last_merge=0.9976 (last merge round=16)
[S9] round=18 local utility u=0.021414 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9978984060831416, 'loss_val': 0.3380362113285732, 'psi': 0.8198260562809521}-{'f1_val': 0.7013613595118124, 'auprc': 0.9965120860914989, 'loss_val': 0.3782069453618675, 'psi': 0.8194216501436871}
[S10] START round=18 head_norm_before_train=1.776546 cos_to_last_merge=0.8366 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.837
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9928529507273878, 'loss_val': 0.03772350276124116, 'psi': 0.9942505858624703}-{'f1_val': 0.9955978191757338, 'auprc': 0.9948131710296727, 'loss_val': 0.03959600853920831, 'psi': 0.9952839599173093}
[S11] START round=18 head_norm_before_train=0.926979 cos_to_last_merge=0.9987 (last merge round=16)
[S11] round=18 local utility u=0.023640 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9980818978951556, 'loss_val': 0.35213519246423425, 'psi': 0.8203548303116108}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980841290682045, 'loss_val': 0.3998127663529004, 'psi': 0.8203948416062739}
[S13] START round=18 head_norm_before_train=1.774782 (no previous merge yet)
[S13] round=18 local utility u=0.147410 metrics={'f1_val': 0.615112321391131, 'auprc': 0.6775004618353759, 'loss_val': 0.6554564444794438, 'psi': 0.6400675775688289}-{'f1_val': 0.5835523924711976, 'auprc': 0.6943246064287181, 'loss_val': 0.8113896436094712, 'psi': 0.6278612780542059}
[S14] START round=18 head_norm_before_train=0.949882 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9951633210066096, 'loss_val': 0.4151408927283284, 'psi': 0.996017667369094}-{'f1_val': 0.9969975081576651, 'auprc': 0.9953670941788596, 'loss_val': 0.34287251422802034, 'psi': 0.9963453425661428}
[S15] START round=18 head_norm_before_train=1.206477 cos_to_last_merge=0.9954 (last merge round=16)
[S15] round=18 local utility u=0.467081 metrics={'f1_val': 0.9946118406761928, 'auprc': 0.9910300063069059, 'loss_val': 0.14453850447294198, 'psi': 0.9931791069284781}-{'f1_val': 0.8615336757739129, 'auprc': 0.9896253915309013, 'loss_val': 0.2760176384165101, 'psi': 0.9127703620767083}
[S16] START round=18 head_norm_before_train=1.717481 (no previous merge yet)
[S16] round=18 local utility u=0.047531 metrics={'f1_val': 0.8662543518769206, 'auprc': 0.9368855535223413, 'loss_val': 0.5545866795230968, 'psi': 0.8945068325350889}-{'f1_val': 0.8631360960478358, 'auprc': 0.9194239608741732, 'loss_val': 0.578554857618628, 'psi': 0.8856512419783708}
[S17] START round=18 head_norm_before_train=1.700561 cos_to_last_merge=0.8367 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=18 local utility u=0.023684 metrics={'f1_val': 0.6014515738989521, 'auprc': 0.9278554742884249, 'loss_val': 0.8522586857339034, 'psi': 0.7320131340547411}-{'f1_val': 0.5960119191046993, 'auprc': 0.8908515757703088, 'loss_val': 0.7559761221961137, 'psi': 0.7139477817709432}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[S8] not sending this round → trigger blocked (psi=0.995)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S15] not sending this round → trigger blocked (psi=0.993)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.7465
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9829
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=-0.0812
[S2] DROPPED delta from S3 (cos=-0.0812 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.2664
[S6] RECEIVED delta(kind=head bytes=1808) from S2
[S6] cosine check vs S2: cos=0.1623
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.4564
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] cosine check vs S11: cos=0.8714
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.5767
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.8869
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9966 head_norm=1.004806
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.434986e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9970 head_norm=0.893832 delta_norm=0.343499
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6022 head_norm=1.293018
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.045630e+00
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.5861 head_norm=1.218611 delta_norm=1.045630
[S6] aggregate: ROLLBACK (f1_val pre=0.602 post=0.586 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9397 head_norm=1.725024
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.608340e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9388 head_norm=1.727529 delta_norm=0.160834
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7011 head_norm=0.907866
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.025744e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7011 head_norm=0.846952 delta_norm=0.202574
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.279558
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.257587e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=1.238630 delta_norm=0.225759
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.866766 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6854215665277434, 'auprc': 0.777454486273928, 'loss_val': 0.5485332797118431, 'psi': 0.7222347344262172}-{'f1_val': 0.7014776350647682, 'auprc': 0.8263193397428401, 'loss_val': 0.46228632329870256, 'psi': 0.751414316935997}
[S3] START round=19 head_norm_before_train=1.741005 (no previous merge yet)
[S3] round=19 local utility u=0.014381 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9985443558515346, 'loss_val': 0.24279559842078882, 'psi': 0.8199167833559002}-{'f1_val': 0.7007562037352997, 'auprc': 0.9979147212225578, 'loss_val': 0.2692163703178602, 'psi': 0.819619610730203}
[S4] START round=19 head_norm_before_train=1.727529 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.029905 metrics={'f1_val': 0.9464588739133877, 'auprc': 0.9813371608116701, 'loss_val': 0.23149055746406746, 'psi': 0.9604101886727006}-{'f1_val': 0.9397160298187, 'auprc': 0.9819239334409825, 'loss_val': 0.25260458717652345, 'psi': 0.9565991912676131}
[S5] START round=19 head_norm_before_train=1.238630 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.128726 metrics={'f1_val': 0.6929471444334004, 'auprc': 0.7876714069767276, 'loss_val': 0.5224756797047574, 'psi': 0.7308368494507314}-{'f1_val': 0.7003213174339138, 'auprc': 0.6625327054337748, 'loss_val': 0.4487557866910891, 'psi': 0.6852058726338581}
[S6] START round=19 head_norm_before_train=1.218611 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6116686330391361, 'auprc': 0.7326470840355804, 'loss_val': 0.6632154878398376, 'psi': 0.6600600134377138}-{'f1_val': 0.6022024673477238, 'auprc': 0.7816046956305246, 'loss_val': 0.6041515926243025, 'psi': 0.6739633586608441}
[S7] START round=19 head_norm_before_train=1.537842 (no previous merge yet)
[S7] round=19 local utility u=0.683159 metrics={'f1_val': 0.6255991665601841, 'auprc': 0.8196159482162777, 'loss_val': 0.5829186397275338, 'psi': 0.7032058792226216}-{'f1_val': 0.4656706898109175, 'auprc': 0.7696499148037775, 'loss_val': 0.839767422277942, 'psi': 0.5872623798080616}
[S8] START round=19 head_norm_before_train=1.650824 cos_to_last_merge=0.8044 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.804
[S8] round=19 local utility u=0.003916 metrics={'f1_val': 0.9936686458350827, 'auprc': 0.9984649080923875, 'loss_val': 0.04448071981019334, 'psi': 0.9955871507380047}-{'f1_val': 0.992174240363445, 'auprc': 0.998615980641917, 'loss_val': 0.04379979998229492, 'psi': 0.9947509364748338}
[S9] START round=19 head_norm_before_train=0.846952 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9982323635508272, 'loss_val': 0.3503115788893506, 'psi': 0.8199596392680264}-{'f1_val': 0.7011111564128257, 'auprc': 0.9978984060831416, 'loss_val': 0.3380362113285732, 'psi': 0.8198260562809521}
[S10] START round=19 head_norm_before_train=1.801721 cos_to_last_merge=0.8346 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=19 local utility u=0.000841 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9929811805986806, 'loss_val': 0.03642548154182252, 'psi': 0.9943018778109873}-{'f1_val': 0.995182342619192, 'auprc': 0.9928529507273878, 'loss_val': 0.03772350276124116, 'psi': 0.9942505858624703}
[S11] START round=19 head_norm_before_train=0.970311 cos_to_last_merge=0.9959 (last merge round=16)
[S11] round=19 local utility u=0.019299 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9978910880214521, 'loss_val': 0.3129641253972796, 'psi': 0.8202785063621295}-{'f1_val': 0.7018701185892477, 'auprc': 0.9980818978951556, 'loss_val': 0.35213519246423425, 'psi': 0.8203548303116108}
[S13] START round=19 head_norm_before_train=1.789208 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.601203661813577, 'auprc': 0.6827655458730595, 'loss_val': 0.7418751141990729, 'psi': 0.63382841543737}-{'f1_val': 0.615112321391131, 'auprc': 0.6775004618353759, 'loss_val': 0.6554564444794438, 'psi': 0.6400675775688289}
[S14] START round=19 head_norm_before_train=0.893832 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.044721 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9934622575200842, 'loss_val': 0.3245135670259665, 'psi': 0.9957291170315095}-{'f1_val': 0.9965872316107504, 'auprc': 0.9951633210066096, 'loss_val': 0.4151408927283284, 'psi': 0.996017667369094}
[S15] START round=19 head_norm_before_train=1.290302 cos_to_last_merge=0.9859 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7764123872164314, 'auprc': 0.9608174296059014, 'loss_val': 0.3227964859654996, 'psi': 0.8501744041722195}-{'f1_val': 0.9946118406761928, 'auprc': 0.9910300063069059, 'loss_val': 0.14453850447294198, 'psi': 0.9931791069284781}
[S16] START round=19 head_norm_before_train=1.744919 (no previous merge yet)
[S16] round=19 local utility u=0.486440 metrics={'f1_val': 0.9498397972465547, 'auprc': 0.9703802385518615, 'loss_val': 0.1837033216593802, 'psi': 0.9580559737686773}-{'f1_val': 0.8662543518769206, 'auprc': 0.9368855535223413, 'loss_val': 0.5545866795230968, 'psi': 0.8945068325350889}
[S17] START round=19 head_norm_before_train=1.726399 cos_to_last_merge=0.8361 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.594706133074738, 'auprc': 0.9345541687215514, 'loss_val': 0.8912855241518997, 'psi': 0.7306453473334633}-{'f1_val': 0.6014515738989521, 'auprc': 0.9278554742884249, 'loss_val': 0.8522586857339034, 'psi': 0.7320131340547411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=-0.0404
[S4] DROPPED delta from S10 (cos=-0.0404 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=-0.0770
[S2] DROPPED delta from S3 (cos=-0.0770 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.9915
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.5858
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.8737
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.6105
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.9498
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.2896
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.5533
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7011 head_norm=0.894440
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.022613e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.7011 head_norm=0.884428 delta_norm=0.202261
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.820 u=0.0000 p_local=0.0611 f1=0.701 auprc=0.998 bytes=19754
[S2] r=20 psi=0.722 u=0.0000 p_local=0.1014 f1=0.685 auprc=0.777 bytes=14417
[S13] r=20 psi=0.634 u=0.0000 p_local=0.0603 f1=0.601 auprc=0.683 bytes=10775
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6117 head_norm=1.258073
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.095509e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.5960 head_norm=1.111993 delta_norm=0.609551
[S6] aggregate: ROLLBACK (f1_val pre=0.612 post=0.596 tol_abs=0.005 tol_rel=0.0)
[S6] r=20 psi=0.660 u=0.0000 p_local=0.0834 f1=0.612 auprc=0.733 bytes=12565
[S8] r=20 psi=0.996 u=0.0039 p_local=0.0511 f1=0.994 auprc=0.998 bytes=21555
[S3] r=20 psi=0.820 u=0.0144 p_local=0.1425 f1=0.701 auprc=0.999 bytes=19792
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9465 head_norm=1.762580
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.153544e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9454 head_norm=1.762929 delta_norm=0.115354
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.960 u=0.0299 p_local=0.0662 f1=0.946 auprc=0.981 bytes=16166
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.012089
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.583681e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=0.972497 delta_norm=0.158368
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0193 p_local=0.1092 f1=0.702 auprc=0.998 bytes=23323
[S10] r=20 psi=0.994 u=0.0008 p_local=0.0612 f1=0.995 auprc=0.993 bytes=21574
[S14] r=20 psi=0.996 u=0.0447 p_local=0.1704 f1=0.997 auprc=0.993 bytes=19754
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.6929 head_norm=1.266677
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.238167e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7660 head_norm=1.353392 delta_norm=0.723817
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.731 u=0.1287 p_local=0.2356 f1=0.693 auprc=0.788 bytes=21575
[S7] r=20 psi=0.703 u=0.6832 p_local=0.2731 f1=0.626 auprc=0.820 bytes=17983
[S16] r=20 psi=0.958 u=0.4864 p_local=0.2621 f1=0.950 auprc=0.970 bytes=17966
[S15] r=20 psi=0.850 u=0.0000 p_local=0.2879 f1=0.776 auprc=0.961 bytes=14383
[S17] r=20 psi=0.731 u=0.0000 p_local=0.1028 f1=0.595 auprc=0.935 bytes=17980
[S2] START round=20 head_norm_before_train=1.882657 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6835207519878983, 'auprc': 0.7903709303847577, 'loss_val': 0.5982603243366554, 'psi': 0.7262608233466421}-{'f1_val': 0.6854215665277434, 'auprc': 0.777454486273928, 'loss_val': 0.5485332797118431, 'psi': 0.7222347344262172}
[S3] START round=20 head_norm_before_train=1.768683 (no previous merge yet)
[S3] round=20 local utility u=0.669789 metrics={'f1_val': 0.9208849717551173, 'auprc': 0.9977368913507605, 'loss_val': 0.22111521024157654, 'psi': 0.9516257395933746}-{'f1_val': 0.7008317350254774, 'auprc': 0.9985443558515346, 'loss_val': 0.24279559842078882, 'psi': 0.8199167833559002}
[S4] START round=20 head_norm_before_train=1.762929 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.006463 metrics={'f1_val': 0.9469723833159973, 'auprc': 0.9839958712269603, 'loss_val': 0.22962114268985773, 'psi': 0.9617817784803825}-{'f1_val': 0.9464588739133877, 'auprc': 0.9813371608116701, 'loss_val': 0.23149055746406746, 'psi': 0.9604101886727006}
[S5] START round=20 head_norm_before_train=1.353392 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7003273827502065, 'auprc': 0.7263565514670041, 'loss_val': 0.4884974979658266, 'psi': 0.7107390502369255}-{'f1_val': 0.6929471444334004, 'auprc': 0.7876714069767276, 'loss_val': 0.5224756797047574, 'psi': 0.7308368494507314}
[S6] START round=20 head_norm_before_train=1.111993 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.954809767148878, 'auprc': 0.9690447741825144, 'loss_val': 0.30335643410856905, 'psi': 0.9605037699623326}-{'f1_val': 0.6116686330391361, 'auprc': 0.7326470840355804, 'loss_val': 0.6632154878398376, 'psi': 0.6600600134377138}
[S7] START round=20 head_norm_before_train=1.550809 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5998661230264317, 'auprc': 0.8026697358382453, 'loss_val': 0.6254609719505078, 'psi': 0.6809875681511572}-{'f1_val': 0.6255991665601841, 'auprc': 0.8196159482162777, 'loss_val': 0.5829186397275338, 'psi': 0.7032058792226216}
[S8] START round=20 head_norm_before_train=1.673607 cos_to_last_merge=0.8015 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9857167178610293, 'auprc': 0.9986158549719737, 'loss_val': 0.04949665908808656, 'psi': 0.9908763727054071}-{'f1_val': 0.9936686458350827, 'auprc': 0.9984649080923875, 'loss_val': 0.04448071981019334, 'psi': 0.9955871507380047}
[S9] START round=20 head_norm_before_train=0.884428 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9980397543671624, 'loss_val': 0.35113815182840225, 'psi': 0.8198825955945604}-{'f1_val': 0.7011111564128257, 'auprc': 0.9982323635508272, 'loss_val': 0.3503115788893506, 'psi': 0.8199596392680264}
[S10] START round=20 head_norm_before_train=1.821414 cos_to_last_merge=0.8334 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.833
[S10] round=20 local utility u=0.004042 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949102837906636, 'loss_val': 0.034162547396831174, 'psi': 0.9950768169278903}-{'f1_val': 0.995182342619192, 'auprc': 0.9929811805986806, 'loss_val': 0.03642548154182252, 'psi': 0.9943018778109873}
[S11] START round=20 head_norm_before_train=0.972497 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9980946704080962, 'loss_val': 0.315569453954409, 'psi': 0.8203599393167871}-{'f1_val': 0.7018701185892477, 'auprc': 0.9978910880214521, 'loss_val': 0.3129641253972796, 'psi': 0.8202785063621295}
[S13] START round=20 head_norm_before_train=1.799083 (no previous merge yet)
[S13] round=20 local utility u=0.086333 metrics={'f1_val': 0.6087903843487095, 'auprc': 0.7105245926272081, 'loss_val': 0.6980074419324861, 'psi': 0.6494840676601089}-{'f1_val': 0.601203661813577, 'auprc': 0.6827655458730595, 'loss_val': 0.7418751141990729, 'psi': 0.63382841543737}
[S14] START round=20 head_norm_before_train=0.957777 cos_to_last_merge=0.9963 (last merge round=18)
[S14] round=20 local utility u=0.016630 metrics={'f1_val': 0.996177437545643, 'auprc': 0.993969430095781, 'loss_val': 0.2863972573259205, 'psi': 0.9952942345656982}-{'f1_val': 0.997240356705793, 'auprc': 0.9934622575200842, 'loss_val': 0.3245135670259665, 'psi': 0.9957291170315095}
[S15] START round=20 head_norm_before_train=1.360378 cos_to_last_merge=0.9772 (last merge round=16)
[S15] round=20 local utility u=0.378666 metrics={'f1_val': 0.8704312056424686, 'auprc': 0.9885238818187915, 'loss_val': 0.21269681498975668, 'psi': 0.9176682761129977}-{'f1_val': 0.7764123872164314, 'auprc': 0.9608174296059014, 'loss_val': 0.3227964859654996, 'psi': 0.8501744041722195}
[S16] START round=20 head_norm_before_train=1.770807 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8263471098195516, 'auprc': 0.8300846077668801, 'loss_val': 0.9730214588496148, 'psi': 0.827842108998483}-{'f1_val': 0.9498397972465547, 'auprc': 0.9703802385518615, 'loss_val': 0.1837033216593802, 'psi': 0.9580559737686773}
[S17] START round=20 head_norm_before_train=1.749739 cos_to_last_merge=0.8353 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5547073569385537, 'auprc': 0.759988291493245, 'loss_val': 1.1700304945799813, 'psi': 0.6368197307604302}-{'f1_val': 0.594706133074738, 'auprc': 0.9345541687215514, 'loss_val': 0.8912855241518997, 'psi': 0.7306453473334633}
[S10] not sending this round → trigger blocked (psi=0.995)
[S4] not sending this round → trigger blocked (psi=0.962)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:59814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:59815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.952)
[S14] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:59810
[S6] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.6747
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.8504
[S9] RECEIVED delta(kind=head bytes=1791) from S13
[S9] cosine check vs S13: cos=0.2586
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.248 → S2@127.0.0.1:59802
[S8] ⇄ pheromone p=0.041 → S6@127.0.0.1:59807
[S4] ⇄ pheromone p=0.054 → S5@127.0.0.1:59805
[S5] ⇄ pheromone p=0.188 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.218 → S6@127.0.0.1:59807
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9962 head_norm=1.020548
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.247357e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9133 head_norm=1.119183 delta_norm=0.524736
[S14] aggregate: ROLLBACK (f1_val pre=0.996 post=0.913 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.140 → S11@127.0.0.1:59812
[S2] ⇄ pheromone p=0.081 → S6@127.0.0.1:59807
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7011 head_norm=0.929900
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.024994e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.7011 head_norm=1.117503 delta_norm=0.902499
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.049 → S14@127.0.0.1:59814
[S11] ⇄ pheromone p=0.087 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.050 → S4@127.0.0.1:59804
[S6] ⇄ pheromone p=0.267 → S15@127.0.0.1:59815
[S13] ⇄ pheromone p=0.066 → S9@127.0.0.1:59810
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.8704 head_norm=1.419267
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.744308e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.8895 head_norm=1.235862 delta_norm=0.374431
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.306 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.082 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.210 → S4@127.0.0.1:59804
[S2] START round=21 head_norm_before_train=1.901745 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6626099753010068, 'auprc': 0.7787976929005771, 'loss_val': 0.7136366092299635, 'psi': 0.7090850623408349}-{'f1_val': 0.6835207519878983, 'auprc': 0.7903709303847577, 'loss_val': 0.5982603243366554, 'psi': 0.7262608233466421}
[S3] START round=21 head_norm_before_train=1.796139 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.8678896816048064, 'auprc': 0.9980741997052897, 'loss_val': 0.1931393579046614, 'psi': 0.9199634888449997}-{'f1_val': 0.9208849717551173, 'auprc': 0.9977368913507605, 'loss_val': 0.22111521024157654, 'psi': 0.9516257395933746}
[S4] START round=21 head_norm_before_train=1.793162 cos_to_last_merge=0.9993 (last merge round=19)
[S4] round=21 local utility u=0.001508 metrics={'f1_val': 0.9478838024122603, 'auprc': 0.9845072226303585, 'loss_val': 0.23360721720058877, 'psi': 0.9625331704994996}-{'f1_val': 0.9469723833159973, 'auprc': 0.9839958712269603, 'loss_val': 0.22962114268985773, 'psi': 0.9617817784803825}
[S5] START round=21 head_norm_before_train=1.374444 cos_to_last_merge=0.9991 (last merge round=19)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.6612368377437623, 'loss_val': 0.41013991267409977, 'psi': 0.6846870941923203}-{'f1_val': 0.7003273827502065, 'auprc': 0.7263565514670041, 'loss_val': 0.4884974979658266, 'psi': 0.7107390502369255}
[S6] START round=21 head_norm_before_train=1.149255 cos_to_last_merge=0.9986 (last merge round=19)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7868724200926891, 'auprc': 0.8430724245684941, 'loss_val': 0.5149887623122573, 'psi': 0.809352421883011}-{'f1_val': 0.954809767148878, 'auprc': 0.9690447741825144, 'loss_val': 0.30335643410856905, 'psi': 0.9605037699623326}
[S7] START round=21 head_norm_before_train=1.564201 (no previous merge yet)
[S7] round=21 local utility u=0.343652 metrics={'f1_val': 0.6687705445080372, 'auprc': 0.8382120496527146, 'loss_val': 0.45821034568476715, 'psi': 0.7365471465659081}-{'f1_val': 0.5998661230264317, 'auprc': 0.8026697358382453, 'loss_val': 0.6254609719505078, 'psi': 0.6809875681511572}
[S8] START round=21 head_norm_before_train=1.692940 cos_to_last_merge=0.7992 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=21 local utility u=0.030273 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986020722538818, 'loss_val': 0.03636150866331166, 'psi': 0.9956160311702507}-{'f1_val': 0.9857167178610293, 'auprc': 0.9986158549719737, 'loss_val': 0.04949665908808656, 'psi': 0.9908763727054071}
[S9] START round=21 head_norm_before_train=1.117503 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9977646971279751, 'loss_val': 0.3947205704286812, 'psi': 0.8197725726988856}-{'f1_val': 0.7011111564128257, 'auprc': 0.9980397543671624, 'loss_val': 0.35113815182840225, 'psi': 0.8198825955945604}
[S10] START round=21 head_norm_before_train=1.842146 cos_to_last_merge=0.8321 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=21 local utility u=0.000657 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949116042762551, 'loss_val': 0.032851687827134976, 'psi': 0.9950773451221269}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949102837906636, 'loss_val': 0.034162547396831174, 'psi': 0.9950768169278903}
[S11] START round=21 head_norm_before_train=1.011148 cos_to_last_merge=0.9994 (last merge round=19)
[S11] round=21 local utility u=0.024650 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9978724302661867, 'loss_val': 0.265602372615207, 'psi': 0.8202710432600233}-{'f1_val': 0.7018701185892477, 'auprc': 0.9980946704080962, 'loss_val': 0.315569453954409, 'psi': 0.8203599393167871}
[S13] START round=21 head_norm_before_train=1.806079 (no previous merge yet)
[S13] round=21 local utility u=0.072711 metrics={'f1_val': 0.6291733869961864, 'auprc': 0.7247675773542372, 'loss_val': 0.7176122764801953, 'psi': 0.6674110631394068}-{'f1_val': 0.6087903843487095, 'auprc': 0.7105245926272081, 'loss_val': 0.6980074419324861, 'psi': 0.6494840676601089}
[S14] START round=21 head_norm_before_train=1.119183 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9968080713232721, 'auprc': 0.9963779075580108, 'loss_val': 0.32941156593543236, 'psi': 0.9966360058171676}-{'f1_val': 0.996177437545643, 'auprc': 0.993969430095781, 'loss_val': 0.2863972573259205, 'psi': 0.9952942345656982}
[S15] START round=21 head_norm_before_train=1.235862 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7002153901428951, 'auprc': 0.9863042032733018, 'loss_val': 0.41579856503104184, 'psi': 0.8146509153950579}-{'f1_val': 0.8704312056424686, 'auprc': 0.9885238818187915, 'loss_val': 0.21269681498975668, 'psi': 0.9176682761129977}
[S16] START round=21 head_norm_before_train=1.787941 (no previous merge yet)
[S16] round=21 local utility u=1.000000 metrics={'f1_val': 0.9879290815146443, 'auprc': 0.986488423454813, 'loss_val': 0.09778339156698894, 'psi': 0.9873528182907119}-{'f1_val': 0.8263471098195516, 'auprc': 0.8300846077668801, 'loss_val': 0.9730214588496148, 'psi': 0.827842108998483}
[S17] START round=21 head_norm_before_train=1.767394 cos_to_last_merge=0.8348 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=21 local utility u=0.602994 metrics={'f1_val': 0.6012483544721425, 'auprc': 0.9850970031840325, 'loss_val': 0.918614403366801, 'psi': 0.7547878139568985}-{'f1_val': 0.5547073569385537, 'auprc': 0.759988291493245, 'loss_val': 1.1700304945799813, 'psi': 0.6368197307604302}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S13] not sending this round → trigger blocked (psi=0.667)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.6102
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.9061
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.5703
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.7686
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0374
[S4] DROPPED delta from S10 (cos=-0.0374 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.4233
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7011 head_norm=1.152493
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.138690e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7011 head_norm=0.979320 delta_norm=0.513869
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.7869 head_norm=1.181660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.180149e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.7803 head_norm=1.202148 delta_norm=0.318015
[S6] aggregate: ROLLBACK (f1_val pre=0.787 post=0.780 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.404302
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.606731e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7003 head_norm=1.325841 delta_norm=0.260673
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9479 head_norm=1.824584
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.222254e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9467 head_norm=1.810816 delta_norm=0.122225
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.920744 (no previous merge yet)
[S2] round=22 local utility u=0.129302 metrics={'f1_val': 0.7112456071681847, 'auprc': 0.7859024508573125, 'loss_val': 0.7681596804480533, 'psi': 0.7411083446438358}-{'f1_val': 0.6626099753010068, 'auprc': 0.7787976929005771, 'loss_val': 0.7136366092299635, 'psi': 0.7090850623408349}
[S3] START round=22 head_norm_before_train=1.825069 (no previous merge yet)
[S3] round=22 local utility u=0.422190 metrics={'f1_val': 0.9968311306697817, 'auprc': 0.9984256505581639, 'loss_val': 0.12346208182567278, 'psi': 0.9974689386251346}-{'f1_val': 0.8678896816048064, 'auprc': 0.9980741997052897, 'loss_val': 0.1931393579046614, 'psi': 0.9199634888449997}
[S4] START round=22 head_norm_before_train=1.810816 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9447097348036364, 'auprc': 0.9756199200604474, 'loss_val': 0.23451145076406255, 'psi': 0.9570738089063608}-{'f1_val': 0.9478838024122603, 'auprc': 0.9845072226303585, 'loss_val': 0.23360721720058877, 'psi': 0.9625331704994996}
[S5] START round=22 head_norm_before_train=1.325841 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.067720 metrics={'f1_val': 0.7006149735748756, 'auprc': 0.7104534666630375, 'loss_val': 0.42411536127871147, 'psi': 0.7045503708101404}-{'f1_val': 0.700320598491359, 'auprc': 0.6612368377437623, 'loss_val': 0.41013991267409977, 'psi': 0.6846870941923203}
[S6] START round=22 head_norm_before_train=1.202148 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.351175 metrics={'f1_val': 0.8233721937009869, 'auprc': 0.9606424148263204, 'loss_val': 0.3843472792316227, 'psi': 0.8782802821511203}-{'f1_val': 0.7868724200926891, 'auprc': 0.8430724245684941, 'loss_val': 0.5149887623122573, 'psi': 0.809352421883011}
[S7] START round=22 head_norm_before_train=1.578250 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5574931348872741, 'auprc': 0.7904283788284973, 'loss_val': 0.7498011518079728, 'psi': 0.6506672324637635}-{'f1_val': 0.6687705445080372, 'auprc': 0.8382120496527146, 'loss_val': 0.45821034568476715, 'psi': 0.7365471465659081}
[S8] START round=22 head_norm_before_train=1.706717 cos_to_last_merge=0.8003 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9986334473146617, 'loss_val': 0.037394266815904256, 'psi': 0.9949707605202565}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986020722538818, 'loss_val': 0.03636150866331166, 'psi': 0.9956160311702507}
[S9] START round=22 head_norm_before_train=0.979320 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.042835 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9980051647086972, 'loss_val': 0.30977210749934964, 'psi': 0.8198687597311743}-{'f1_val': 0.7011111564128257, 'auprc': 0.9977646971279751, 'loss_val': 0.3947205704286812, 'psi': 0.8197725726988856}
[S10] START round=22 head_norm_before_train=1.864716 cos_to_last_merge=0.8306 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.994653549689687, 'loss_val': 0.032111182764445294, 'psi': 0.9947213101013921}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949116042762551, 'loss_val': 0.032851687827134976, 'psi': 0.9950773451221269}
[S11] START round=22 head_norm_before_train=1.057364 cos_to_last_merge=0.9972 (last merge round=19)
[S11] round=22 local utility u=0.787457 metrics={'f1_val': 0.9583017359231194, 'auprc': 0.9978605552264546, 'loss_val': 0.2292432798620368, 'psi': 0.9741252636444535}-{'f1_val': 0.7018701185892477, 'auprc': 0.9978724302661867, 'loss_val': 0.265602372615207, 'psi': 0.8202710432600233}
[S13] START round=22 head_norm_before_train=1.817670 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5945687186230084, 'auprc': 0.7423472923546667, 'loss_val': 0.9996975432339179, 'psi': 0.6536801481156718}-{'f1_val': 0.6291733869961864, 'auprc': 0.7247675773542372, 'loss_val': 0.7176122764801953, 'psi': 0.6674110631394068}
[S14] START round=22 head_norm_before_train=1.166489 cos_to_last_merge=0.9979 (last merge round=20)
[S14] round=22 local utility u=0.037251 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9949311088707294, 'loss_val': 0.2492445325237194, 'psi': 0.9959247825147419}-{'f1_val': 0.9968080713232721, 'auprc': 0.9963779075580108, 'loss_val': 0.32941156593543236, 'psi': 0.9966360058171676}
[S15] START round=22 head_norm_before_train=1.288749 cos_to_last_merge=0.9988 (last merge round=20)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9954930770150554, 'auprc': 0.994201784986231, 'loss_val': 0.10768619002423344, 'psi': 0.9949765602035257}-{'f1_val': 0.7002153901428951, 'auprc': 0.9863042032733018, 'loss_val': 0.41579856503104184, 'psi': 0.8146509153950579}
[S16] START round=22 head_norm_before_train=1.805236 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8422385286206145, 'auprc': 0.8942730090857093, 'loss_val': 0.8329267472560655, 'psi': 0.8630523208066524}-{'f1_val': 0.9879290815146443, 'auprc': 0.986488423454813, 'loss_val': 0.09778339156698894, 'psi': 0.9873528182907119}
[S17] START round=22 head_norm_before_train=1.780102 cos_to_last_merge=0.8343 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=22 local utility u=0.049784 metrics={'f1_val': 0.61011808534381, 'auprc': 0.9918320375614595, 'loss_val': 0.8924695727203639, 'psi': 0.7628036662308698}-{'f1_val': 0.6012483544721425, 'auprc': 0.9850970031840325, 'loss_val': 0.918614403366801, 'psi': 0.7547878139568985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.2492
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=0.7196
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=0.8906
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=-0.0626
[S2] DROPPED delta from S3 (cos=-0.0626 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.8967
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.8820
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.8692
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.3694
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.5779
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.7011 head_norm=1.029507
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.751469e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.7011 head_norm=0.949543 delta_norm=0.375147
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9955 head_norm=1.351411
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.994075e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9955 head_norm=1.261861 delta_norm=0.299408
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9583 head_norm=1.105603
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.010032e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9579 head_norm=1.120770 delta_norm=0.301003
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7006 head_norm=1.361560
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.515323e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.6955 head_norm=1.407251 delta_norm=0.751532
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.696 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8234 head_norm=1.239987
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.012776e+00
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.8227 head_norm=1.274866 delta_norm=1.012776
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9966 head_norm=1.212889
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.903418e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9966 head_norm=1.102429 delta_norm=0.190342
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.940213 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7001031704591756, 'auprc': 0.7721300104305149, 'loss_val': 0.8061643188337092, 'psi': 0.7289139064477113}-{'f1_val': 0.7112456071681847, 'auprc': 0.7859024508573125, 'loss_val': 0.7681596804480533, 'psi': 0.7411083446438358}
[S3] START round=23 head_norm_before_train=1.849448 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9968641794672346, 'loss_val': 0.11952220210582612, 'psi': 0.9752434371696319}-{'f1_val': 0.9968311306697817, 'auprc': 0.9984256505581639, 'loss_val': 0.12346208182567278, 'psi': 0.9974689386251346}
[S4] START round=23 head_norm_before_train=1.834142 cos_to_last_merge=0.9997 (last merge round=21)
[S4] round=23 local utility u=0.001082 metrics={'f1_val': 0.9442873497518165, 'auprc': 0.9776155288151049, 'loss_val': 0.23580087656033155, 'psi': 0.9576186213771319}-{'f1_val': 0.9447097348036364, 'auprc': 0.9756199200604474, 'loss_val': 0.23451145076406255, 'psi': 0.9570738089063608}
[S5] START round=23 head_norm_before_train=1.407251 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6078847923123724, 'auprc': 0.7677094577356268, 'loss_val': 0.5878765968433146, 'psi': 0.6718146584816742}-{'f1_val': 0.7006149735748756, 'auprc': 0.7104534666630375, 'loss_val': 0.42411536127871147, 'psi': 0.7045503708101404}
[S6] START round=23 head_norm_before_train=1.274866 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.382974 metrics={'f1_val': 0.9429958732116986, 'auprc': 0.9622601582956037, 'loss_val': 0.3409951598105111, 'psi': 0.9507015872452607}-{'f1_val': 0.8233721937009869, 'auprc': 0.9606424148263204, 'loss_val': 0.3843472792316227, 'psi': 0.8782802821511203}
[S7] START round=23 head_norm_before_train=1.590505 (no previous merge yet)
[S7] round=23 local utility u=0.348821 metrics={'f1_val': 0.633801978433339, 'auprc': 0.8044582895320529, 'loss_val': 0.5521013552260392, 'psi': 0.7020645028728245}-{'f1_val': 0.5574931348872741, 'auprc': 0.7904283788284973, 'loss_val': 0.7498011518079728, 'psi': 0.6506672324637635}
[S8] START round=23 head_norm_before_train=1.716751 cos_to_last_merge=0.8009 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9219011762072054, 'auprc': 0.9985394632711448, 'loss_val': 0.14165561957909498, 'psi': 0.9525564910327811}-{'f1_val': 0.9925289693239863, 'auprc': 0.9986334473146617, 'loss_val': 0.037394266815904256, 'psi': 0.9949707605202565}
[S9] START round=23 head_norm_before_train=0.949543 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9975516295635676, 'loss_val': 0.3146534525072921, 'psi': 0.8196873456731225}-{'f1_val': 0.7011111564128257, 'auprc': 0.9980051647086972, 'loss_val': 0.30977210749934964, 'psi': 0.8198687597311743}
[S10] START round=23 head_norm_before_train=1.879749 cos_to_last_merge=0.8301 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.830
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9930233075923695, 'loss_val': 0.032294824044396125, 'psi': 0.9943187286084629}-{'f1_val': 0.9947664837091956, 'auprc': 0.994653549689687, 'loss_val': 0.032111182764445294, 'psi': 0.9947213101013921}
[S11] START round=23 head_norm_before_train=1.120770 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.003919 metrics={'f1_val': 0.9579225840573864, 'auprc': 0.99766793941888, 'loss_val': 0.2185535154303323, 'psi': 0.9738207262019838}-{'f1_val': 0.9583017359231194, 'auprc': 0.9978605552264546, 'loss_val': 0.2292432798620368, 'psi': 0.9741252636444535}
[S13] START round=23 head_norm_before_train=1.832042 (no previous merge yet)
[S13] round=23 local utility u=0.382968 metrics={'f1_val': 0.6532762366797789, 'auprc': 0.7854786899857598, 'loss_val': 0.7154017463730054, 'psi': 0.7061572180021712}-{'f1_val': 0.5945687186230084, 'auprc': 0.7423472923546667, 'loss_val': 0.9996975432339179, 'psi': 0.6536801481156718}
[S14] START round=23 head_norm_before_train=1.102429 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.994935495471232, 'loss_val': 0.25240276251189, 'psi': 0.9961727030830918}-{'f1_val': 0.9965872316107504, 'auprc': 0.9949311088707294, 'loss_val': 0.2492445325237194, 'psi': 0.9959247825147419}
[S15] START round=23 head_norm_before_train=1.261861 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7773515259022195, 'auprc': 0.9877365737943841, 'loss_val': 0.31043491165306425, 'psi': 0.8615055450590853}-{'f1_val': 0.9954930770150554, 'auprc': 0.994201784986231, 'loss_val': 0.10768619002423344, 'psi': 0.9949765602035257}
[S16] START round=23 head_norm_before_train=1.822995 (no previous merge yet)
[S16] round=23 local utility u=0.018376 metrics={'f1_val': 0.8484659748214789, 'auprc': 0.8858394020184692, 'loss_val': 0.8082381855793119, 'psi': 0.863415345700275}-{'f1_val': 0.8422385286206145, 'auprc': 0.8942730090857093, 'loss_val': 0.8329267472560655, 'psi': 0.8630523208066524}
[S17] START round=23 head_norm_before_train=1.799018 cos_to_last_merge=0.8340 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5843820099333896, 'auprc': 0.8206551402236091, 'loss_val': 1.105770227594448, 'psi': 0.6788912620494774}-{'f1_val': 0.61011808534381, 'auprc': 0.9918320375614595, 'loss_val': 0.8924695727203639, 'psi': 0.7628036662308698}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=0.3995
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.3156
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9936
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.8535
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.7438
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=0.4208
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6079 head_norm=1.443433
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.042916e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.6266 head_norm=1.394465 delta_norm=0.904292
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.7011 head_norm=0.993930
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.978202e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.7011 head_norm=1.009457 delta_norm=0.397820
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9443 head_norm=1.855007
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.045028e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9437 head_norm=1.843603 delta_norm=0.104503
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.9430 head_norm=1.318385
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.612602e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.9341 head_norm=1.186448 delta_norm=0.861260
[S6] aggregate: ROLLBACK (f1_val pre=0.943 post=0.934 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7774 head_norm=1.307834
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.699920e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7773 head_norm=1.226129 delta_norm=0.469992
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.959115 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6954267218256858, 'auprc': 0.751628432330951, 'loss_val': 0.8609691871933912, 'psi': 0.7179074060277919}-{'f1_val': 0.7001031704591756, 'auprc': 0.7721300104305149, 'loss_val': 0.8061643188337092, 'psi': 0.7289139064477113}
[S3] START round=24 head_norm_before_train=1.877143 (no previous merge yet)
[S3] round=24 local utility u=0.131127 metrics={'f1_val': 0.9968311306697817, 'auprc': 0.9984454834227918, 'loss_val': 0.07802032569804379, 'psi': 0.9974768717709858}-{'f1_val': 0.9608296089712303, 'auprc': 0.9968641794672346, 'loss_val': 0.11952220210582612, 'psi': 0.9752434371696319}
[S4] START round=24 head_norm_before_train=1.843603 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.024676 metrics={'f1_val': 0.9501421719563551, 'auprc': 0.9780612870147138, 'loss_val': 0.22291491822065634, 'psi': 0.9613098179796986}-{'f1_val': 0.9442873497518165, 'auprc': 0.9776155288151049, 'loss_val': 0.23580087656033155, 'psi': 0.9576186213771319}
[S5] START round=24 head_norm_before_train=1.394465 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.5548695700266458, 'auprc': 0.790802143697418, 'loss_val': 0.649146275808898, 'psi': 0.6492425994949547}-{'f1_val': 0.6078847923123724, 'auprc': 0.7677094577356268, 'loss_val': 0.5878765968433146, 'psi': 0.6718146584816742}
[S6] START round=24 head_norm_before_train=1.186448 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7414224334565503, 'auprc': 0.9120534807422557, 'loss_val': 0.5002884945846674, 'psi': 0.8096748523708325}-{'f1_val': 0.9429958732116986, 'auprc': 0.9622601582956037, 'loss_val': 0.3409951598105111, 'psi': 0.9507015872452607}
[S7] START round=24 head_norm_before_train=1.600225 (no previous merge yet)
[S7] round=24 local utility u=0.135495 metrics={'f1_val': 0.6564794287337372, 'auprc': 0.8224170560943522, 'loss_val': 0.4710526873668241, 'psi': 0.7228544796779832}-{'f1_val': 0.633801978433339, 'auprc': 0.8044582895320529, 'loss_val': 0.5521013552260392, 'psi': 0.7020645028728245}
[S8] START round=24 head_norm_before_train=1.727616 cos_to_last_merge=0.8003 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=24 local utility u=0.250305 metrics={'f1_val': 0.9933009232156067, 'auprc': 0.9904814268721813, 'loss_val': 0.04527077720181805, 'psi': 0.9921731246782366}-{'f1_val': 0.9219011762072054, 'auprc': 0.9985394632711448, 'loss_val': 0.14165561957909498, 'psi': 0.9525564910327811}
[S9] START round=24 head_norm_before_train=1.009457 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.004112 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.997647522169907, 'loss_val': 0.30821922171121136, 'psi': 0.8198758245750504}-{'f1_val': 0.7011111564128257, 'auprc': 0.9975516295635676, 'loss_val': 0.3146534525072921, 'psi': 0.8196873456731225}
[S10] START round=24 head_norm_before_train=1.897345 cos_to_last_merge=0.8292 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.829
[S10] round=24 local utility u=0.004826 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9949113937091356, 'loss_val': 0.030799821705795295, 'psi': 0.9953232489890944}-{'f1_val': 0.995182342619192, 'auprc': 0.9930233075923695, 'loss_val': 0.032294824044396125, 'psi': 0.9943187286084629}
[S11] START round=24 head_norm_before_train=1.166273 cos_to_last_merge=0.9990 (last merge round=22)
[S11] round=24 local utility u=0.134356 metrics={'f1_val': 0.9965478132675192, 'auprc': 0.9963351870336214, 'loss_val': 0.17759499792270167, 'psi': 0.9964627627739601}-{'f1_val': 0.9579225840573864, 'auprc': 0.99766793941888, 'loss_val': 0.2185535154303323, 'psi': 0.9738207262019838}
[S13] START round=24 head_norm_before_train=1.843693 (no previous merge yet)
[S13] round=24 local utility u=0.091044 metrics={'f1_val': 0.6931371198620011, 'auprc': 0.7965667244943074, 'loss_val': 0.8057437154118496, 'psi': 0.7345089617149236}-{'f1_val': 0.6532762366797789, 'auprc': 0.7854786899857598, 'loss_val': 0.7154017463730054, 'psi': 0.7061572180021712}
[S14] START round=24 head_norm_before_train=1.151231 cos_to_last_merge=0.9982 (last merge round=22)
[S14] round=24 local utility u=0.025086 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9940713248638119, 'loss_val': 0.1995066440946144, 'psi': 0.9958138299957906}-{'f1_val': 0.9969975081576651, 'auprc': 0.994935495471232, 'loss_val': 0.25240276251189, 'psi': 0.9961727030830918}
[S15] START round=24 head_norm_before_train=1.226129 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.75821797051625, 'auprc': 0.9835378356634527, 'loss_val': 0.4052589796926597, 'psi': 0.848345916575131}-{'f1_val': 0.7773515259022195, 'auprc': 0.9877365737943841, 'loss_val': 0.31043491165306425, 'psi': 0.8615055450590853}
[S16] START round=24 head_norm_before_train=1.838080 (no previous merge yet)
[S16] round=24 local utility u=0.648212 metrics={'f1_val': 0.9068152800703425, 'auprc': 0.9923121178404586, 'loss_val': 0.18132737730320528, 'psi': 0.941014015178389}-{'f1_val': 0.8484659748214789, 'auprc': 0.8858394020184692, 'loss_val': 0.8082381855793119, 'psi': 0.863415345700275}
[S17] START round=24 head_norm_before_train=1.816397 cos_to_last_merge=0.8335 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=24 local utility u=0.000205 metrics={'f1_val': 0.5896025729843144, 'auprc': 0.806998953919114, 'loss_val': 1.095715014014917, 'psi': 0.6765611253582342}-{'f1_val': 0.5843820099333896, 'auprc': 0.8206551402236091, 'loss_val': 1.105770227594448, 'psi': 0.6788912620494774}
[S13] not sending this round → trigger blocked (psi=0.735)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.941)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[S7] not sending this round → trigger blocked (psi=0.723)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S4] not sending this round → trigger blocked (psi=0.961)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9628
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=-0.0541
[S2] DROPPED delta from S3 (cos=-0.0541 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0305
[S4] DROPPED delta from S10 (cos=-0.0305 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.7668
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.4488
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.5036
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.5549 head_norm=1.421560
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.300512e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.5371 head_norm=1.414576 delta_norm=0.830051
[S5] aggregate: ROLLBACK (f1_val pre=0.555 post=0.537 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.216466
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.651390e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9968 head_norm=1.198221 delta_norm=0.165139
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.7414 head_norm=1.241310
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.106559e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.6743 head_norm=1.275205 delta_norm=0.810656
[S6] aggregate: ROLLBACK (f1_val pre=0.741 post=0.674 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.202589
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.910903e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.058032 delta_norm=0.391090
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.976136 (no previous merge yet)
[S2] round=25 local utility u=0.107454 metrics={'f1_val': 0.7069888730134444, 'auprc': 0.8007106792811396, 'loss_val': 0.8626815465886688, 'psi': 0.7444775955205225}-{'f1_val': 0.6954267218256858, 'auprc': 0.751628432330951, 'loss_val': 0.8609691871933912, 'psi': 0.7179074060277919}
[S3] START round=25 head_norm_before_train=1.907185 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9971178744142173, 'loss_val': 0.1132320318294572, 'psi': 0.9755163041063784}-{'f1_val': 0.9968311306697817, 'auprc': 0.9984454834227918, 'loss_val': 0.07802032569804379, 'psi': 0.9974768717709858}
[S4] START round=25 head_norm_before_train=1.867180 cos_to_last_merge=0.9997 (last merge round=23)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9426704015637105, 'auprc': 0.9601442240566108, 'loss_val': 0.2507294974579619, 'psi': 0.9496599305608706}-{'f1_val': 0.9501421719563551, 'auprc': 0.9780612870147138, 'loss_val': 0.22291491822065634, 'psi': 0.9613098179796986}
[S5] START round=25 head_norm_before_train=1.414576 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.4313158968359688, 'auprc': 0.8051196110244805, 'loss_val': 1.0700726038496444, 'psi': 0.5808373825113735}-{'f1_val': 0.5548695700266458, 'auprc': 0.790802143697418, 'loss_val': 0.649146275808898, 'psi': 0.6492425994949547}
[S6] START round=25 head_norm_before_train=1.275205 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6896148841617026, 'auprc': 0.95392401527874, 'loss_val': 0.5784485497360365, 'psi': 0.7953385366085175}-{'f1_val': 0.7414224334565503, 'auprc': 0.9120534807422557, 'loss_val': 0.5002884945846674, 'psi': 0.8096748523708325}
[S7] START round=25 head_norm_before_train=1.611830 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5626014631076393, 'auprc': 0.7912616759794444, 'loss_val': 0.7454659863441914, 'psi': 0.6540655482563613}-{'f1_val': 0.6564794287337372, 'auprc': 0.8224170560943522, 'loss_val': 0.4710526873668241, 'psi': 0.7228544796779832}
[S8] START round=25 head_norm_before_train=1.739475 cos_to_last_merge=0.7993 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=25 local utility u=0.000823 metrics={'f1_val': 0.9887021880404929, 'auprc': 0.9987698705437758, 'loss_val': 0.04089833152560059, 'psi': 0.992729261041806}-{'f1_val': 0.9933009232156067, 'auprc': 0.9904814268721813, 'loss_val': 0.04527077720181805, 'psi': 0.9921731246782366}
[S9] START round=25 head_norm_before_train=1.048116 cos_to_last_merge=0.9989 (last merge round=23)
[S9] round=25 local utility u=0.015011 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9976578152113016, 'loss_val': 0.27822714997704323, 'psi': 0.8198799417916081}-{'f1_val': 0.7013613595118124, 'auprc': 0.997647522169907, 'loss_val': 0.30821922171121136, 'psi': 0.8198758245750504}
[S10] START round=25 head_norm_before_train=1.915409 cos_to_last_merge=0.8281 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9947663626183323, 'auprc': 0.9884654599096743, 'loss_val': 0.032127200878218846, 'psi': 0.9922460015348691}-{'f1_val': 0.9955978191757338, 'auprc': 0.9949113937091356, 'loss_val': 0.030799821705795295, 'psi': 0.9953232489890944}
[S11] START round=25 head_norm_before_train=1.198221 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9816062672054282, 'auprc': 0.9955610436704102, 'loss_val': 0.16297128232791971, 'psi': 0.9871881777914211}-{'f1_val': 0.9965478132675192, 'auprc': 0.9963351870336214, 'loss_val': 0.17759499792270167, 'psi': 0.9964627627739601}
[S13] START round=25 head_norm_before_train=1.852386 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6621250698529442, 'auprc': 0.7919855342458038, 'loss_val': 0.7382955388319885, 'psi': 0.714069255610088}-{'f1_val': 0.6931371198620011, 'auprc': 0.7965667244943074, 'loss_val': 0.8057437154118496, 'psi': 0.7345089617149236}
[S14] START round=25 head_norm_before_train=1.058032 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9921815703448778, 'loss_val': 0.22027329524270864, 'psi': 0.9948249671044013}-{'f1_val': 0.9969755000837764, 'auprc': 0.9940713248638119, 'loss_val': 0.1995066440946144, 'psi': 0.9958138299957906}
[S15] START round=25 head_norm_before_train=1.287558 cos_to_last_merge=0.9953 (last merge round=23)
[S15] round=25 local utility u=0.036700 metrics={'f1_val': 0.7630601456049623, 'auprc': 0.984695695740673, 'loss_val': 0.3643855948511652, 'psi': 0.8517143656592465}-{'f1_val': 0.75821797051625, 'auprc': 0.9835378356634527, 'loss_val': 0.4052589796926597, 'psi': 0.848345916575131}
[S16] START round=25 head_norm_before_train=1.853586 (no previous merge yet)
[S16] round=25 local utility u=0.077757 metrics={'f1_val': 0.9393469801238483, 'auprc': 0.9919479419547573, 'loss_val': 0.21991153093248378, 'psi': 0.960387364856212}-{'f1_val': 0.9068152800703425, 'auprc': 0.9923121178404586, 'loss_val': 0.18132737730320528, 'psi': 0.941014015178389}
[S17] START round=25 head_norm_before_train=1.832809 cos_to_last_merge=0.8329 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=25 local utility u=0.258186 metrics={'f1_val': 0.6076654414308382, 'auprc': 0.9056620912107934, 'loss_val': 0.983710139814512, 'psi': 0.7268641013428203}-{'f1_val': 0.5896025729843144, 'auprc': 0.806998953919114, 'loss_val': 1.095715014014917, 'psi': 0.6765611253582342}
[S8] not sending this round → trigger blocked (psi=0.993)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:59814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S15
[S14] cosine check vs S15: cos=0.6496
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.9947
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.2824
[S17] not sending this round → trigger blocked (psi=0.727)
[S13] ⇄ pheromone p=0.091 → S9@127.0.0.1:59810
[S9] ⇄ pheromone p=0.024 → S14@127.0.0.1:59814
[S3] ⇄ pheromone p=0.145 → S2@127.0.0.1:59802
[S8] ⇄ pheromone p=0.056 → S6@127.0.0.1:59807
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6896 head_norm=1.313308
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.024306e+00
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6540 head_norm=1.336395 delta_norm=1.024306
[S6] aggregate: ROLLBACK (f1_val pre=0.690 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.172 → S15@127.0.0.1:59815
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9427 head_norm=1.890818
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.744722e-02
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9423 head_norm=1.877847 delta_norm=0.097447
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.022 → S5@127.0.0.1:59805
[S5] ⇄ pheromone p=0.069 → S9@127.0.0.1:59810
[S11] ⇄ pheromone p=0.133 → S9@127.0.0.1:59810
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9966 head_norm=1.108824
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.299599e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9966 head_norm=1.123618 delta_norm=0.529960
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.054 → S11@127.0.0.1:59812
[S7] ⇄ pheromone p=0.166 → S6@127.0.0.1:59807
[S10] ⇄ pheromone p=0.017 → S4@127.0.0.1:59804
[S15] ⇄ pheromone p=0.210 → S14@127.0.0.1:59814
[S16] ⇄ pheromone p=0.272 → S4@127.0.0.1:59804
[S2] ⇄ pheromone p=0.061 → S6@127.0.0.1:59807
[S17] ⇄ pheromone p=0.133 → S5@127.0.0.1:59805
[S2] START round=26 head_norm_before_train=1.986336 (no previous merge yet)
[S2] round=26 local utility u=0.073679 metrics={'f1_val': 0.6906176425381924, 'auprc': 0.82467138058919, 'loss_val': 0.6889783419877981, 'psi': 0.7442391377585914}-{'f1_val': 0.7069888730134444, 'auprc': 0.8007106792811396, 'loss_val': 0.8626815465886688, 'psi': 0.7444775955205225}
[S3] START round=26 head_norm_before_train=1.936935 (no previous merge yet)
[S3] round=26 local utility u=0.144245 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9986093070537698, 'loss_val': 0.04707339179726329, 'psi': 0.997898562760436}-{'f1_val': 0.9611152572344858, 'auprc': 0.9971178744142173, 'loss_val': 0.1132320318294572, 'psi': 0.9755163041063784}
[S4] START round=26 head_norm_before_train=1.877847 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.074559 metrics={'f1_val': 0.9542232288673649, 'auprc': 0.9783045463981193, 'loss_val': 0.22540984401634934, 'psi': 0.9638557558796667}-{'f1_val': 0.9426704015637105, 'auprc': 0.9601442240566108, 'loss_val': 0.2507294974579619, 'psi': 0.9496599305608706}
[S5] START round=26 head_norm_before_train=1.446920 cos_to_last_merge=0.9992 (last merge round=24)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.996105337627943, 'loss_val': 0.3022872705242055, 'psi': 0.8186349255115255}-{'f1_val': 0.4313158968359688, 'auprc': 0.8051196110244805, 'loss_val': 1.0700726038496444, 'psi': 0.5808373825113735}
[S6] START round=26 head_norm_before_train=1.336395 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.457378 metrics={'f1_val': 0.8220633918369546, 'auprc': 0.9547306301953926, 'loss_val': 0.46080348656697656, 'psi': 0.8751302871803299}-{'f1_val': 0.6896148841617026, 'auprc': 0.95392401527874, 'loss_val': 0.5784485497360365, 'psi': 0.7953385366085175}
[S7] START round=26 head_norm_before_train=1.620798 (no previous merge yet)
[S7] round=26 local utility u=0.464442 metrics={'f1_val': 0.6586678506607573, 'auprc': 0.8148849689060755, 'loss_val': 0.4638494281839665, 'psi': 0.7211546979588845}-{'f1_val': 0.5626014631076393, 'auprc': 0.7912616759794444, 'loss_val': 0.7454659863441914, 'psi': 0.6540655482563613}
[S8] START round=26 head_norm_before_train=1.750520 cos_to_last_merge=0.7976 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9986046725663029, 'loss_val': 0.039849897783687326, 'psi': 0.9925812869939128}-{'f1_val': 0.9887021880404929, 'auprc': 0.9987698705437758, 'loss_val': 0.04089833152560059, 'psi': 0.992729261041806}
[S9] START round=26 head_norm_before_train=1.085968 cos_to_last_merge=0.9962 (last merge round=23)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9845208710796128, 'loss_val': 0.2915921823642255, 'psi': 0.8145816495949507}-{'f1_val': 0.7013613595118124, 'auprc': 0.9976578152113016, 'loss_val': 0.27822714997704323, 'psi': 0.8198799417916081}
[S10] START round=26 head_norm_before_train=1.928746 cos_to_last_merge=0.8275 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=26 local utility u=0.000380 metrics={'f1_val': 0.9944916187597106, 'auprc': 0.989207408401303, 'loss_val': 0.03194432664976424, 'psi': 0.9923779346163476}-{'f1_val': 0.9947663626183323, 'auprc': 0.9884654599096743, 'loss_val': 0.032127200878218846, 'psi': 0.9922460015348691}
[S11] START round=26 head_norm_before_train=1.244346 cos_to_last_merge=0.9988 (last merge round=24)
[S11] round=26 local utility u=0.043940 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994659614952241, 'loss_val': 0.15955179418958618, 'psi': 0.995544050928882}-{'f1_val': 0.9816062672054282, 'auprc': 0.9955610436704102, 'loss_val': 0.16297128232791971, 'psi': 0.9871881777914211}
[S13] START round=26 head_norm_before_train=1.864343 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6104471308472836, 'auprc': 0.8155295526903144, 'loss_val': 0.9714460721244832, 'psi': 0.692480099584496}-{'f1_val': 0.6621250698529442, 'auprc': 0.7919855342458038, 'loss_val': 0.7382955388319885, 'psi': 0.714069255610088}
[S14] START round=26 head_norm_before_train=1.123618 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9936278941928905, 'loss_val': 0.2571984495241567, 'psi': 0.9957503334758113}-{'f1_val': 0.9965872316107504, 'auprc': 0.9921815703448778, 'loss_val': 0.22027329524270864, 'psi': 0.9948249671044013}
[S15] START round=26 head_norm_before_train=1.362813 cos_to_last_merge=0.9840 (last merge round=23)
[S15] round=26 local utility u=0.449727 metrics={'f1_val': 0.8835342216771932, 'auprc': 0.9920208736373807, 'loss_val': 0.20975069725268328, 'psi': 0.9269288824612683}-{'f1_val': 0.7630601456049623, 'auprc': 0.984695695740673, 'loss_val': 0.3643855948511652, 'psi': 0.8517143656592465}
[S16] START round=26 head_norm_before_train=1.869871 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8284652281091383, 'auprc': 0.8478928615478925, 'loss_val': 1.061451769206087, 'psi': 0.83623628148464}-{'f1_val': 0.9393469801238483, 'auprc': 0.9919479419547573, 'loss_val': 0.21991153093248378, 'psi': 0.960387364856212}
[S17] START round=26 head_norm_before_train=1.849343 cos_to_last_merge=0.8322 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=26 local utility u=0.166399 metrics={'f1_val': 0.6173986917173792, 'auprc': 0.98140610027213, 'loss_val': 0.9365429627208054, 'psi': 0.7630016551392795}-{'f1_val': 0.6076654414308382, 'auprc': 0.9056620912107934, 'loss_val': 0.983710139814512, 'psi': 0.7268641013428203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S15] not sending this round → trigger blocked (psi=0.927)
[S2] not sending this round → trigger blocked (psi=0.744)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:59802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.4059
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.2577
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.8679
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0267
[S4] DROPPED delta from S10 (cos=-0.0267 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] cosine check vs S3: cos=-0.0483
[S2] DROPPED delta from S3 (cos=-0.0483 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.4624
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] cosine check vs S11: cos=0.7981
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.8942
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.8835 head_norm=1.427154
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.607920e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.8878 head_norm=1.352832 delta_norm=0.360792
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.7013 head_norm=1.118331
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.194525e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.7013 head_norm=1.041565 delta_norm=0.419452
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.472436
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.517821e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.390499 delta_norm=0.251782
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8221 head_norm=1.372547
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.202808e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8214 head_norm=1.193030 delta_norm=0.920281
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.001912 (no previous merge yet)
[S2] round=27 local utility u=0.032308 metrics={'f1_val': 0.7132059915646993, 'auprc': 0.8237552317683796, 'loss_val': 0.7571435259542664, 'psi': 0.7574256876461715}-{'f1_val': 0.6906176425381924, 'auprc': 0.82467138058919, 'loss_val': 0.6889783419877981, 'psi': 0.7442391377585914}
[S3] START round=27 head_norm_before_train=1.963697 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9882998237075507, 'auprc': 0.9985608415696738, 'loss_val': 0.07623146987762043, 'psi': 0.9924042308523999}-{'f1_val': 0.9974247332315468, 'auprc': 0.9986093070537698, 'loss_val': 0.04707339179726329, 'psi': 0.997898562760436}
[S4] START round=27 head_norm_before_train=1.894335 cos_to_last_merge=0.9995 (last merge round=25)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9430949532998916, 'auprc': 0.9789455283961727, 'loss_val': 0.24814970892805419, 'psi': 0.957435183338404}-{'f1_val': 0.9542232288673649, 'auprc': 0.9783045463981193, 'loss_val': 0.22540984401634934, 'psi': 0.9638557558796667}
[S5] START round=27 head_norm_before_train=1.390499 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6006397336894711, 'auprc': 0.7137155182553194, 'loss_val': 0.5967313790679912, 'psi': 0.6458700475158103}-{'f1_val': 0.7003213174339138, 'auprc': 0.996105337627943, 'loss_val': 0.3022872705242055, 'psi': 0.8186349255115255}
[S6] START round=27 head_norm_before_train=1.193030 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6703917447820587, 'auprc': 0.7978269325371151, 'loss_val': 0.6339676292647528, 'psi': 0.7213658198840812}-{'f1_val': 0.8220633918369546, 'auprc': 0.9547306301953926, 'loss_val': 0.46080348656697656, 'psi': 0.8751302871803299}
[S7] START round=27 head_norm_before_train=1.629905 (no previous merge yet)
[S7] round=27 local utility u=0.157282 metrics={'f1_val': 0.68353283442901, 'auprc': 0.8438319186210606, 'loss_val': 0.3853170043687897, 'psi': 0.7476524681058303}-{'f1_val': 0.6586678506607573, 'auprc': 0.8148849689060755, 'loss_val': 0.4638494281839665, 'psi': 0.7211546979588845}
[S8] START round=27 head_norm_before_train=1.762192 cos_to_last_merge=0.7958 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.796
[S8] round=27 local utility u=0.014921 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9987450688454704, 'loss_val': 0.034209572030007844, 'psi': 0.9950154091325799}-{'f1_val': 0.9885656966123193, 'auprc': 0.9986046725663029, 'loss_val': 0.039849897783687326, 'psi': 0.9925812869939128}
[S9] START round=27 head_norm_before_train=1.041565 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.029814 metrics={'f1_val': 0.7011126798871403, 'auprc': 0.9971482457184773, 'loss_val': 0.26878936032362016, 'psi': 0.819526906219675}-{'f1_val': 0.7012888352718426, 'auprc': 0.9845208710796128, 'loss_val': 0.2915921823642255, 'psi': 0.8145816495949507}
[S10] START round=27 head_norm_before_train=1.940263 cos_to_last_merge=0.8269 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=27 local utility u=0.013225 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9949764261924514, 'loss_val': 0.02943908854026012, 'psi': 0.9953492619824208}-{'f1_val': 0.9944916187597106, 'auprc': 0.989207408401303, 'loss_val': 0.03194432664976424, 'psi': 0.9923779346163476}
[S11] START round=27 head_norm_before_train=1.287762 cos_to_last_merge=0.9962 (last merge round=24)
[S11] round=27 local utility u=0.031197 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9970589187572974, 'loss_val': 0.10683633567707487, 'psi': 0.9967517702110726}-{'f1_val': 0.9961336749133093, 'auprc': 0.994659614952241, 'loss_val': 0.15955179418958618, 'psi': 0.995544050928882}
[S13] START round=27 head_norm_before_train=1.871904 (no previous merge yet)
[S13] round=27 local utility u=0.164997 metrics={'f1_val': 0.6367374428177774, 'auprc': 0.8057945686281848, 'loss_val': 0.769989979169544, 'psi': 0.7043602931419404}-{'f1_val': 0.6104471308472836, 'auprc': 0.8155295526903144, 'loss_val': 0.9714460721244832, 'psi': 0.692480099584496}
[S14] START round=27 head_norm_before_train=1.169134 cos_to_last_merge=0.9980 (last merge round=25)
[S14] round=27 local utility u=0.032984 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9943780308279495, 'loss_val': 0.19379919649178465, 'psi': 0.9960822212296331}-{'f1_val': 0.9971652929977585, 'auprc': 0.9936278941928905, 'loss_val': 0.2571984495241567, 'psi': 0.9957503334758113}
[S15] START round=27 head_norm_before_train=1.352832 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.83545071041047, 'auprc': 0.9897888611342827, 'loss_val': 0.2641896151426249, 'psi': 0.8971859706999952}-{'f1_val': 0.8835342216771932, 'auprc': 0.9920208736373807, 'loss_val': 0.20975069725268328, 'psi': 0.9269288824612683}
[S16] START round=27 head_norm_before_train=1.881363 (no previous merge yet)
[S16] round=27 local utility u=0.608508 metrics={'f1_val': 0.8776824546243154, 'auprc': 0.9901211587565204, 'loss_val': 0.5664243741021744, 'psi': 0.9226579362771974}-{'f1_val': 0.8284652281091383, 'auprc': 0.8478928615478925, 'loss_val': 1.061451769206087, 'psi': 0.83623628148464}
[S17] START round=27 head_norm_before_train=1.861017 cos_to_last_merge=0.8317 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6226481915014322, 'auprc': 0.9093565391185511, 'loss_val': 1.0330675897372856, 'psi': 0.7373315305482797}-{'f1_val': 0.6173986917173792, 'auprc': 0.98140610027213, 'loss_val': 0.9365429627208054, 'psi': 0.7630016551392795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:59807
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.7888
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.4209
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.8545
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9951
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.0274
[S4] DROPPED delta from S10 (cos=-0.0274 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.9347
[S6] RECEIVED delta(kind=head bytes=1807) from S7
[S6] cosine check vs S7: cos=0.8248
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.4786
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.4625
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.6704 head_norm=1.237465
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.572813e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.6647 head_norm=1.167403 delta_norm=0.257281
[S6] aggregate: ROLLBACK (f1_val pre=0.670 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9431 head_norm=1.909322
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.413998e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9431 head_norm=1.898939 delta_norm=0.094140
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9972 head_norm=1.221590
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.790303e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9972 head_norm=1.083149 delta_norm=0.379030
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.7011 head_norm=1.068395
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.037170e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.7011 head_norm=1.091512 delta_norm=0.403717
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=1.327804
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.362180e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=1.253744 delta_norm=0.236218
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.017284 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7134808036578396, 'auprc': 0.8206473647612659, 'loss_val': 0.8069197590481341, 'psi': 0.7563474280992102}-{'f1_val': 0.7132059915646993, 'auprc': 0.8237552317683796, 'loss_val': 0.7571435259542664, 'psi': 0.7574256876461715}
[S3] START round=28 head_norm_before_train=1.986585 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.956645680064927, 'auprc': 0.9979697884948161, 'loss_val': 0.1605008054987843, 'psi': 0.9731753234368827}-{'f1_val': 0.9882998237075507, 'auprc': 0.9985608415696738, 'loss_val': 0.07623146987762043, 'psi': 0.9924042308523999}
[S4] START round=28 head_norm_before_train=1.898939 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.037438 metrics={'f1_val': 0.9533093681800882, 'auprc': 0.9762937198845046, 'loss_val': 0.226604103803383, 'psi': 0.9625031088618548}-{'f1_val': 0.9430949532998916, 'auprc': 0.9789455283961727, 'loss_val': 0.24814970892805419, 'psi': 0.957435183338404}
[S5] START round=28 head_norm_before_train=1.409109 cos_to_last_merge=0.9997 (last merge round=26)
[S5] round=28 local utility u=0.686453 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9016421866968942, 'loss_val': 0.3856903283945787, 'psi': 0.7808492337735731}-{'f1_val': 0.6006397336894711, 'auprc': 0.7137155182553194, 'loss_val': 0.5967313790679912, 'psi': 0.6458700475158103}
[S6] START round=28 head_norm_before_train=1.167403 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.836526 metrics={'f1_val': 0.8243749982953362, 'auprc': 0.9617726342036816, 'loss_val': 0.376653155393238, 'psi': 0.8793340526586744}-{'f1_val': 0.6703917447820587, 'auprc': 0.7978269325371151, 'loss_val': 0.6339676292647528, 'psi': 0.7213658198840812}
[S7] START round=28 head_norm_before_train=1.643224 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5792943681052162, 'auprc': 0.7952560945970245, 'loss_val': 0.7027458220865955, 'psi': 0.6656790587019394}-{'f1_val': 0.68353283442901, 'auprc': 0.8438319186210606, 'loss_val': 0.3853170043687897, 'psi': 0.7476524681058303}
[S8] START round=28 head_norm_before_train=1.770607 cos_to_last_merge=0.7946 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=28 local utility u=0.000324 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9988016530090951, 'loss_val': 0.03459333081755365, 'psi': 0.9951242701891319}-{'f1_val': 0.9925289693239863, 'auprc': 0.9987450688454704, 'loss_val': 0.034209572030007844, 'psi': 0.9950154091325799}
[S9] START round=28 head_norm_before_train=1.091512 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000840 metrics={'f1_val': 0.7011126798871403, 'auprc': 0.997026936467225, 'loss_val': 0.26674478257869527, 'psi': 0.8194783825191743}-{'f1_val': 0.7011126798871403, 'auprc': 0.9971482457184773, 'loss_val': 0.26878936032362016, 'psi': 0.819526906219675}
[S10] START round=28 head_norm_before_train=1.949594 cos_to_last_merge=0.8268 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=28 local utility u=0.000328 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9949864280577703, 'loss_val': 0.0288140114896555, 'psi': 0.9953532627285483}-{'f1_val': 0.9955978191757338, 'auprc': 0.9949764261924514, 'loss_val': 0.02943908854026012, 'psi': 0.9953492619824208}
[S11] START round=28 head_norm_before_train=1.253744 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9954907035321803, 'loss_val': 0.1279761161590439, 'psi': 0.9961244841210258}-{'f1_val': 0.9965470045135896, 'auprc': 0.9970589187572974, 'loss_val': 0.10683633567707487, 'psi': 0.9967517702110726}
[S13] START round=28 head_norm_before_train=1.878291 (no previous merge yet)
[S13] round=28 local utility u=0.042348 metrics={'f1_val': 0.6518339660265837, 'auprc': 0.8078019997103428, 'loss_val': 0.7818953271116809, 'psi': 0.7142211795000875}-{'f1_val': 0.6367374428177774, 'auprc': 0.8057945686281848, 'loss_val': 0.769989979169544, 'psi': 0.7043602931419404}
[S14] START round=28 head_norm_before_train=1.083149 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9915550191969162, 'loss_val': 0.1904413598031476, 'psi': 0.9948205125733656}-{'f1_val': 0.9972183481640888, 'auprc': 0.9943780308279495, 'loss_val': 0.19379919649178465, 'psi': 0.9960822212296331}
[S15] START round=28 head_norm_before_train=1.404396 cos_to_last_merge=0.9983 (last merge round=26)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7660798663826067, 'auprc': 0.9149318734859794, 'loss_val': 0.38869085521174745, 'psi': 0.8256206692239558}-{'f1_val': 0.83545071041047, 'auprc': 0.9897888611342827, 'loss_val': 0.2641896151426249, 'psi': 0.8971859706999952}
[S16] START round=28 head_norm_before_train=1.893186 (no previous merge yet)
[S16] round=28 local utility u=0.533509 metrics={'f1_val': 0.9754319416059902, 'auprc': 0.9914457366286257, 'loss_val': 0.0898768450854561, 'psi': 0.9818374596150443}-{'f1_val': 0.8776824546243154, 'auprc': 0.9901211587565204, 'loss_val': 0.5664243741021744, 'psi': 0.9226579362771974}
[S17] START round=28 head_norm_before_train=1.874622 cos_to_last_merge=0.8312 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5641851414974381, 'auprc': 0.8320824861347218, 'loss_val': 1.335510038202693, 'psi': 0.6713440793523516}-{'f1_val': 0.6226481915014322, 'auprc': 0.9093565391185511, 'loss_val': 1.0330675897372856, 'psi': 0.7373315305482797}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → trigger blocked (psi=0.982)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:59815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.819)
[S13] not sending this round → trigger blocked (psi=0.714)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:59810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.8673
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.4351
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=0.5938
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.7011 head_norm=1.118455
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.878752e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.7011 head_norm=1.079902 delta_norm=0.687875
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7661 head_norm=1.465531
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.658066e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7708 head_norm=1.295090 delta_norm=0.365807
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.424000
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.842156e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.495254 delta_norm=0.784216
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.034886 (no previous merge yet)
[S2] round=29 local utility u=0.053002 metrics={'f1_val': 0.703371980207212, 'auprc': 0.839340103807326, 'loss_val': 0.6963414377431429, 'psi': 0.7577592296472577}-{'f1_val': 0.7134808036578396, 'auprc': 0.8206473647612659, 'loss_val': 0.8069197590481341, 'psi': 0.7563474280992102}
[S3] START round=29 head_norm_before_train=2.007424 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8855030685660148, 'auprc': 0.9985512156953397, 'loss_val': 0.18114304642021242, 'psi': 0.9307223274177447}-{'f1_val': 0.956645680064927, 'auprc': 0.9979697884948161, 'loss_val': 0.1605008054987843, 'psi': 0.9731753234368827}
[S4] START round=29 head_norm_before_train=1.916711 cos_to_last_merge=0.9998 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9405335066202082, 'auprc': 0.9724664801265279, 'loss_val': 0.2449401294311316, 'psi': 0.9533066960227361}-{'f1_val': 0.9533093681800882, 'auprc': 0.9762937198845046, 'loss_val': 0.226604103803383, 'psi': 0.9625031088618548}
[S5] START round=29 head_norm_before_train=1.495254 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.147883 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9896952651306845, 'loss_val': 0.354087097212078, 'psi': 0.816070896512622}-{'f1_val': 0.700320598491359, 'auprc': 0.9016421866968942, 'loss_val': 0.3856903283945787, 'psi': 0.7808492337735731}
[S6] START round=29 head_norm_before_train=1.214234 cos_to_last_merge=0.9986 (last merge round=27)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7780368715582886, 'auprc': 0.9437399416277243, 'loss_val': 0.5035775755343587, 'psi': 0.8443180995860629}-{'f1_val': 0.8243749982953362, 'auprc': 0.9617726342036816, 'loss_val': 0.376653155393238, 'psi': 0.8793340526586744}
[S7] START round=29 head_norm_before_train=1.653347 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5798340340225953, 'auprc': 0.7937079302164317, 'loss_val': 0.7123073561499476, 'psi': 0.6653835925001299}-{'f1_val': 0.5792943681052162, 'auprc': 0.7952560945970245, 'loss_val': 0.7027458220865955, 'psi': 0.6656790587019394}
[S8] START round=29 head_norm_before_train=1.783123 cos_to_last_merge=0.7936 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9986000289319455, 'loss_val': 0.044599337555307636, 'psi': 0.9910826354821205}-{'f1_val': 0.9926726816424898, 'auprc': 0.9988016530090951, 'loss_val': 0.03459333081755365, 'psi': 0.9951242701891319}
[S9] START round=29 head_norm_before_train=1.079902 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.7011126798871403, 'auprc': 0.9979768336477872, 'loss_val': 0.35373735639022647, 'psi': 0.8198583413913991}-{'f1_val': 0.7011126798871403, 'auprc': 0.997026936467225, 'loss_val': 0.26674478257869527, 'psi': 0.8194783825191743}
[S10] START round=29 head_norm_before_train=1.962205 cos_to_last_merge=0.8263 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=29 local utility u=0.000241 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9950046401862294, 'loss_val': 0.02838688423163868, 'psi': 0.995360547579932}-{'f1_val': 0.9955978191757338, 'auprc': 0.9949864280577703, 'loss_val': 0.0288140114896555, 'psi': 0.9953532627285483}
[S11] START round=29 head_norm_before_train=1.288878 cos_to_last_merge=0.9995 (last merge round=27)
[S11] round=29 local utility u=0.011035 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9961742765512016, 'loss_val': 0.1065056339573504, 'psi': 0.9962528111017972}-{'f1_val': 0.9965470045135896, 'auprc': 0.9954907035321803, 'loss_val': 0.1279761161590439, 'psi': 0.9961244841210258}
[S13] START round=29 head_norm_before_train=1.883955 (no previous merge yet)
[S13] round=29 local utility u=0.326579 metrics={'f1_val': 0.7475998741969542, 'auprc': 0.8101746671694866, 'loss_val': 0.7104499424820522, 'psi': 0.7726297913859672}-{'f1_val': 0.6518339660265837, 'auprc': 0.8078019997103428, 'loss_val': 0.7818953271116809, 'psi': 0.7142211795000875}
[S14] START round=29 head_norm_before_train=1.137029 cos_to_last_merge=0.9982 (last merge round=27)
[S14] round=29 local utility u=0.021759 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9932631125703312, 'loss_val': 0.1505891781658246, 'psi': 0.9953579640203513}-{'f1_val': 0.9969975081576651, 'auprc': 0.9915550191969162, 'loss_val': 0.1904413598031476, 'psi': 0.9948205125733656}
[S15] START round=29 head_norm_before_train=1.295090 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.937940 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9914015125535156, 'loss_val': 0.12141257493533578, 'psi': 0.9941277779065061}-{'f1_val': 0.7660798663826067, 'auprc': 0.9149318734859794, 'loss_val': 0.38869085521174745, 'psi': 0.8256206692239558}
[S16] START round=29 head_norm_before_train=1.906537 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9249801409525571, 'auprc': 0.9901775629653841, 'loss_val': 0.38137573436694494, 'psi': 0.9510591097576879}-{'f1_val': 0.9754319416059902, 'auprc': 0.9914457366286257, 'loss_val': 0.0898768450854561, 'psi': 0.9818374596150443}
[S17] START round=29 head_norm_before_train=1.891770 cos_to_last_merge=0.8306 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=29 local utility u=0.739038 metrics={'f1_val': 0.6806556843185942, 'auprc': 0.9156473722295524, 'loss_val': 0.8069510326547907, 'psi': 0.7746523594829775}-{'f1_val': 0.5641851414974381, 'auprc': 0.8320824861347218, 'loss_val': 1.335510038202693, 'psi': 0.6713440793523516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[S5] not sending this round → trigger blocked (psi=0.816)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.4764
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=-0.0272
[S4] DROPPED delta from S10 (cos=-0.0272 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.3751
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9679
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.7228
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.6349
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.4168
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7780 head_norm=1.256074
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.119816e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.7721 head_norm=1.434667 delta_norm=0.911982
[S6] aggregate: ROLLBACK (f1_val pre=0.778 post=0.772 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.506454
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.365824e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7001 head_norm=1.440169 delta_norm=0.936582
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.7011 head_norm=1.107007
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.232087e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.7011 head_norm=1.063969 delta_norm=0.523209
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9963 head_norm=1.322579
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.722543e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9963 head_norm=1.245641 delta_norm=0.172254
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9968 head_norm=1.188852
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.813788e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9968 head_norm=1.183742 delta_norm=0.481379
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.049936 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7129623474077375, 'auprc': 0.8153975816774905, 'loss_val': 0.8764142686247913, 'psi': 0.7539364411156386}-{'f1_val': 0.703371980207212, 'auprc': 0.839340103807326, 'loss_val': 0.6963414377431429, 'psi': 0.7577592296472577}
[S3] START round=30 head_norm_before_train=2.027043 (no previous merge yet)
[S3] round=30 local utility u=0.345434 metrics={'f1_val': 0.9811550973763747, 'auprc': 0.9987010524509001, 'loss_val': 0.06463733105219793, 'psi': 0.9881734794061849}-{'f1_val': 0.8855030685660148, 'auprc': 0.9985512156953397, 'loss_val': 0.18114304642021242, 'psi': 0.9307223274177447}
[S4] START round=30 head_norm_before_train=1.937050 cos_to_last_merge=0.9994 (last merge round=27)
[S4] round=30 local utility u=0.012241 metrics={'f1_val': 0.9412851586165613, 'auprc': 0.9788767789356242, 'loss_val': 0.24419875901926594, 'psi': 0.9563218067441864}-{'f1_val': 0.9405335066202082, 'auprc': 0.9724664801265279, 'loss_val': 0.2449401294311316, 'psi': 0.9533066960227361}
[S5] START round=30 head_norm_before_train=1.440169 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.5508667984203953, 'auprc': 0.8453240483008542, 'loss_val': 0.6943548067857126, 'psi': 0.6686496983725789}-{'f1_val': 0.7003213174339138, 'auprc': 0.9896952651306845, 'loss_val': 0.354087097212078, 'psi': 0.816070896512622}
[S6] START round=30 head_norm_before_train=1.434667 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7779242853349595, 'auprc': 0.9349379005607515, 'loss_val': 0.5134498243498494, 'psi': 0.8407297314252764}-{'f1_val': 0.7780368715582886, 'auprc': 0.9437399416277243, 'loss_val': 0.5035775755343587, 'psi': 0.8443180995860629}
[S7] START round=30 head_norm_before_train=1.660046 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.570638653644935, 'auprc': 0.7905501253340701, 'loss_val': 0.7346513497171224, 'psi': 0.6586032423205891}-{'f1_val': 0.5798340340225953, 'auprc': 0.7937079302164317, 'loss_val': 0.7123073561499476, 'psi': 0.6653835925001299}
[S8] START round=30 head_norm_before_train=1.798727 cos_to_last_merge=0.7920 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.792
[S8] round=30 local utility u=0.024877 metrics={'f1_val': 0.9929762634442646, 'auprc': 0.9982239105902778, 'loss_val': 0.0351491427914552, 'psi': 0.9950753223026699}-{'f1_val': 0.9860710398489039, 'auprc': 0.9986000289319455, 'loss_val': 0.044599337555307636, 'psi': 0.9910826354821205}
[S9] START round=30 head_norm_before_train=1.063969 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.042760 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.998130953839516, 'loss_val': 0.26868976417866636, 'psi': 0.8199209854310762}-{'f1_val': 0.7011126798871403, 'auprc': 0.9979768336477872, 'loss_val': 0.35373735639022647, 'psi': 0.8198583413913991}
[S10] START round=30 head_norm_before_train=1.975676 cos_to_last_merge=0.8257 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9951233011766039, 'loss_val': 0.028230550462945796, 'psi': 0.9951548243049497}-{'f1_val': 0.9955978191757338, 'auprc': 0.9950046401862294, 'loss_val': 0.02838688423163868, 'psi': 0.995360547579932}
[S11] START round=30 head_norm_before_train=1.245641 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9957827951902384, 'loss_val': 0.11957523158157007, 'psi': 0.995993323024081}-{'f1_val': 0.996305167468861, 'auprc': 0.9961742765512016, 'loss_val': 0.1065056339573504, 'psi': 0.9962528111017972}
[S13] START round=30 head_norm_before_train=1.895537 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.7148427531105337, 'auprc': 0.8188397746971792, 'loss_val': 0.8949832560729505, 'psi': 0.7564415617451918}-{'f1_val': 0.7475998741969542, 'auprc': 0.8101746671694866, 'loss_val': 0.7104499424820522, 'psi': 0.7726297913859672}
[S14] START round=30 head_norm_before_train=1.183742 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9960253772197636, 'loss_val': 0.21159610402908943, 'psi': 0.9963492848336813}-{'f1_val': 0.996754531653698, 'auprc': 0.9932631125703312, 'loss_val': 0.1505891781658246, 'psi': 0.9953579640203513}
[S15] START round=30 head_norm_before_train=1.361092 cos_to_last_merge=0.9974 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8818844162892799, 'auprc': 0.9924622846729162, 'loss_val': 0.21974985790923032, 'psi': 0.9261155636427345}-{'f1_val': 0.9959452881418331, 'auprc': 0.9914015125535156, 'loss_val': 0.12141257493533578, 'psi': 0.9941277779065061}
[S16] START round=30 head_norm_before_train=1.914105 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8962830285240245, 'auprc': 0.9856312004925168, 'loss_val': 0.487192315213116, 'psi': 0.9320222973114215}-{'f1_val': 0.9249801409525571, 'auprc': 0.9901775629653841, 'loss_val': 0.38137573436694494, 'psi': 0.9510591097576879}
[S17] START round=30 head_norm_before_train=1.906081 cos_to_last_merge=0.8301 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5573868109783324, 'auprc': 0.7360342761721872, 'loss_val': 1.430336306987823, 'psi': 0.6288457970558743}-{'f1_val': 0.6806556843185942, 'auprc': 0.9156473722295524, 'loss_val': 0.8069510326547907, 'psi': 0.7746523594829775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:59814
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.5089
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.3581
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.6739
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0404
[S2] DROPPED delta from S3 (cos=-0.0404 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.104 → S9@127.0.0.1:59810
[S2] ⇄ pheromone p=0.038 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.052 → S9@127.0.0.1:59810
[S15] ⇄ pheromone p=0.256 → S14@127.0.0.1:59814
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.5509 head_norm=1.451743
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.709255e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.5655 head_norm=1.483550 delta_norm=0.870925
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.216 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.109 → S6@127.0.0.1:59807
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.7779 head_norm=1.477374
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.430785e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.7795 head_norm=1.360124 delta_norm=0.943078
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.201 → S15@127.0.0.1:59815
[S10] ⇄ pheromone p=0.007 → S4@127.0.0.1:59804
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9966 head_norm=1.225474
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.727215e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.063176 delta_norm=0.472721
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.024 → S11@127.0.0.1:59812
[S16] ⇄ pheromone p=0.220 → S4@127.0.0.1:59804
[S8] ⇄ pheromone p=0.025 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=0.129 → S2@127.0.0.1:59802
[S9] ⇄ pheromone p=0.020 → S14@127.0.0.1:59814
[S4] ⇄ pheromone p=0.021 → S5@127.0.0.1:59805
[S17] ⇄ pheromone p=0.175 → S5@127.0.0.1:59805
[S2] START round=31 head_norm_before_train=2.062515 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6941810641836113, 'auprc': 0.8088457816412665, 'loss_val': 0.7762895056322519, 'psi': 0.7400469511666734}-{'f1_val': 0.7129623474077375, 'auprc': 0.8153975816774905, 'loss_val': 0.8764142686247913, 'psi': 0.7539364411156386}
[S3] START round=31 head_norm_before_train=2.044967 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9399269866700216, 'auprc': 0.9984317750668255, 'loss_val': 0.14550797127719106, 'psi': 0.9633289020287432}-{'f1_val': 0.9811550973763747, 'auprc': 0.9987010524509001, 'loss_val': 0.06463733105219793, 'psi': 0.9881734794061849}
[S4] START round=31 head_norm_before_train=1.952256 cos_to_last_merge=0.9990 (last merge round=27)
[S4] round=31 local utility u=0.060229 metrics={'f1_val': 0.9562035052765928, 'auprc': 0.9836801441403452, 'loss_val': 0.22766046180697228, 'psi': 0.9671941608220938}-{'f1_val': 0.9412851586165613, 'auprc': 0.9788767789356242, 'loss_val': 0.24419875901926594, 'psi': 0.9563218067441864}
[S5] START round=31 head_norm_before_train=1.483550 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.549053 metrics={'f1_val': 0.6537338820398725, 'auprc': 0.9281076186778865, 'loss_val': 0.46180116769833723, 'psi': 0.7634833766950782}-{'f1_val': 0.5508667984203953, 'auprc': 0.8453240483008542, 'loss_val': 0.6943548067857126, 'psi': 0.6686496983725789}
[S6] START round=31 head_norm_before_train=1.360124 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.191718 metrics={'f1_val': 0.8213070120386128, 'auprc': 0.9549577515512442, 'loss_val': 0.45037006452074174, 'psi': 0.8747673078436653}-{'f1_val': 0.7779242853349595, 'auprc': 0.9349379005607515, 'loss_val': 0.5134498243498494, 'psi': 0.8407297314252764}
[S7] START round=31 head_norm_before_train=1.664930 (no previous merge yet)
[S7] round=31 local utility u=0.217692 metrics={'f1_val': 0.6157480726032362, 'auprc': 0.7951736924087769, 'loss_val': 0.5837952915656663, 'psi': 0.6875183205254525}-{'f1_val': 0.570638653644935, 'auprc': 0.7905501253340701, 'loss_val': 0.7346513497171224, 'psi': 0.6586032423205891}
[S8] START round=31 head_norm_before_train=1.815498 cos_to_last_merge=0.7901 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.790
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9904910816630761, 'auprc': 0.9988391571223889, 'loss_val': 0.03474580631647408, 'psi': 0.9938303118468013}-{'f1_val': 0.9929762634442646, 'auprc': 0.9982239105902778, 'loss_val': 0.0351491427914552, 'psi': 0.9950753223026699}
[S9] START round=31 head_norm_before_train=1.098103 cos_to_last_merge=0.9990 (last merge round=29)
[S9] round=31 local utility u=0.007190 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9968822309903441, 'loss_val': 0.2505631552177323, 'psi': 0.8194214962914074}-{'f1_val': 0.7011143398254496, 'auprc': 0.998130953839516, 'loss_val': 0.26868976417866636, 'psi': 0.8199209854310762}
[S10] START round=31 head_norm_before_train=1.985460 cos_to_last_merge=0.8254 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951335692279267, 'loss_val': 0.027711844958515933, 'psi': 0.994913317916688}-{'f1_val': 0.995175839723847, 'auprc': 0.9951233011766039, 'loss_val': 0.028230550462945796, 'psi': 0.9951548243049497}
[S11] START round=31 head_norm_before_train=1.281734 cos_to_last_merge=0.9995 (last merge round=29)
[S11] round=31 local utility u=0.009437 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964242413667659, 'loss_val': 0.10262459275894655, 'psi': 0.996249901494692}-{'f1_val': 0.9961336749133093, 'auprc': 0.9957827951902384, 'loss_val': 0.11957523158157007, 'psi': 0.995993323024081}
[S13] START round=31 head_norm_before_train=1.912421 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6648413163796411, 'auprc': 0.795658769659381, 'loss_val': 0.8139370033722402, 'psi': 0.717168297691537}-{'f1_val': 0.7148427531105337, 'auprc': 0.8188397746971792, 'loss_val': 0.8949832560729505, 'psi': 0.7564415617451918}
[S14] START round=31 head_norm_before_train=1.063176 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9928012038340492, 'loss_val': 0.2113233404378592, 'psi': 0.9953057815838855}-{'f1_val': 0.9965652232429598, 'auprc': 0.9960253772197636, 'loss_val': 0.21159610402908943, 'psi': 0.9963492848336813}
[S15] START round=31 head_norm_before_train=1.426855 cos_to_last_merge=0.9914 (last merge round=28)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9100378849831658, 'loss_val': 0.44241092301700746, 'psi': 0.7845653402950404}-{'f1_val': 0.8818844162892799, 'auprc': 0.9924622846729162, 'loss_val': 0.21974985790923032, 'psi': 0.9261155636427345}
[S16] START round=31 head_norm_before_train=1.924942 (no previous merge yet)
[S16] round=31 local utility u=0.098667 metrics={'f1_val': 0.9204061747209991, 'auprc': 0.985941540321151, 'loss_val': 0.4355290966877937, 'psi': 0.9466203209610599}-{'f1_val': 0.8962830285240245, 'auprc': 0.9856312004925168, 'loss_val': 0.487192315213116, 'psi': 0.9320222973114215}
[S17] START round=31 head_norm_before_train=1.924325 cos_to_last_merge=0.8295 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=31 local utility u=1.000000 metrics={'f1_val': 0.714026742565847, 'auprc': 0.9503679492894221, 'loss_val': 0.773828194129463, 'psi': 0.808563225255277}-{'f1_val': 0.5573868109783324, 'auprc': 0.7360342761721872, 'loss_val': 1.430336306987823, 'psi': 0.6288457970558743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:59807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.967)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1807) from S7
[S6] cosine check vs S7: cos=0.3413
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.4774
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.7989
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.8750
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9944
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.4605
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.7011 head_norm=1.133194
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.786052e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.7011 head_norm=1.069583 delta_norm=0.378605
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9562 head_norm=1.962545
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.038915e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9548 head_norm=1.945909 delta_norm=0.103892
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8213 head_norm=1.408555
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.893628e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8207 head_norm=1.262125 delta_norm=0.889363
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6537 head_norm=1.492541
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.104679e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6468 head_norm=1.469648 delta_norm=0.910468
[S5] aggregate: ROLLBACK (f1_val pre=0.654 post=0.647 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.7009 head_norm=1.481315
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.629512e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.7009 head_norm=1.399081 delta_norm=0.362951
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.075004 (no previous merge yet)
[S2] round=32 local utility u=0.020576 metrics={'f1_val': 0.7134371378982118, 'auprc': 0.8030617940913833, 'loss_val': 0.833321359793584, 'psi': 0.7492870003754805}-{'f1_val': 0.6941810641836113, 'auprc': 0.8088457816412665, 'loss_val': 0.7762895056322519, 'psi': 0.7400469511666734}
[S3] START round=32 head_norm_before_train=2.059895 (no previous merge yet)
[S3] round=32 local utility u=0.231732 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9986920288952512, 'loss_val': 0.027826117580447247, 'psi': 0.9979330891300351}-{'f1_val': 0.9399269866700216, 'auprc': 0.9984317750668255, 'loss_val': 0.14550797127719106, 'psi': 0.9633289020287432}
[S4] START round=32 head_norm_before_train=1.945909 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9490070577485562, 'auprc': 0.9723368178845193, 'loss_val': 0.23512839085949255, 'psi': 0.9583389618029414}-{'f1_val': 0.9562035052765928, 'auprc': 0.9836801441403452, 'loss_val': 0.22766046180697228, 'psi': 0.9671941608220938}
[S5] START round=32 head_norm_before_train=1.469648 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.619582614378098, 'auprc': 0.9227635683096167, 'loss_val': 0.480340302897577, 'psi': 0.7408549959507056}-{'f1_val': 0.6537338820398725, 'auprc': 0.9281076186778865, 'loss_val': 0.46180116769833723, 'psi': 0.7634833766950782}
[S6] START round=32 head_norm_before_train=1.262125 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8122323582830161, 'auprc': 0.955128562857684, 'loss_val': 0.4630889298865108, 'psi': 0.8693908401128833}-{'f1_val': 0.8213070120386128, 'auprc': 0.9549577515512442, 'loss_val': 0.45037006452074174, 'psi': 0.8747673078436653}
[S7] START round=32 head_norm_before_train=1.668479 (no previous merge yet)
[S7] round=32 local utility u=0.083694 metrics={'f1_val': 0.6350528720204579, 'auprc': 0.8031212007864038, 'loss_val': 0.5560795298963922, 'psi': 0.7022802035268363}-{'f1_val': 0.6157480726032362, 'auprc': 0.7951736924087769, 'loss_val': 0.5837952915656663, 'psi': 0.6875183205254525}
[S8] START round=32 head_norm_before_train=1.825710 cos_to_last_merge=0.7892 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.789
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.990351025081079, 'auprc': 0.9984934503131511, 'loss_val': 0.036560057229323456, 'psi': 0.9936079951739079}-{'f1_val': 0.9904910816630761, 'auprc': 0.9988391571223889, 'loss_val': 0.03474580631647408, 'psi': 0.9938303118468013}
[S9] START round=32 head_norm_before_train=1.069583 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9972309765264918, 'loss_val': 0.2642938629108658, 'psi': 0.8195609945058665}-{'f1_val': 0.7011143398254496, 'auprc': 0.9968822309903441, 'loss_val': 0.2505631552177323, 'psi': 0.8194214962914074}
[S10] START round=32 head_norm_before_train=1.998598 cos_to_last_merge=0.8248 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=32 local utility u=0.000175 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951185822895345, 'loss_val': 0.02731596767195467, 'psi': 0.9949073231413312}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951335692279267, 'loss_val': 0.027711844958515933, 'psi': 0.994913317916688}
[S11] START round=32 head_norm_before_train=1.318857 cos_to_last_merge=0.9981 (last merge round=29)
[S11] round=32 local utility u=0.014087 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972333812312724, 'loss_val': 0.0793583408770743, 'psi': 0.9968215552006627}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964242413667659, 'loss_val': 0.10262459275894655, 'psi': 0.996249901494692}
[S13] START round=32 head_norm_before_train=1.920864 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6340024855557621, 'auprc': 0.8205849545460097, 'loss_val': 0.950002002122422, 'psi': 0.7086354731518612}-{'f1_val': 0.6648413163796411, 'auprc': 0.795658769659381, 'loss_val': 0.8139370033722402, 'psi': 0.717168297691537}
[S14] START round=32 head_norm_before_train=1.109095 cos_to_last_merge=0.9983 (last merge round=30)
[S14] round=32 local utility u=0.024618 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.995395279292683, 'loss_val': 0.16608240457523843, 'psi': 0.9959646647811431}-{'f1_val': 0.9969755000837764, 'auprc': 0.9928012038340492, 'loss_val': 0.2113233404378592, 'psi': 0.9953057815838855}
[S15] START round=32 head_norm_before_train=1.399081 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.924705 metrics={'f1_val': 0.9232522896130573, 'auprc': 0.995590219355653, 'loss_val': 0.18367033401260327, 'psi': 0.9521874615100956}-{'f1_val': 0.7009169771696235, 'auprc': 0.9100378849831658, 'loss_val': 0.44241092301700746, 'psi': 0.7845653402950404}
[S16] START round=32 head_norm_before_train=1.934717 (no previous merge yet)
[S16] round=32 local utility u=0.056377 metrics={'f1_val': 0.9278991478922368, 'auprc': 0.9876400462014021, 'loss_val': 0.37282867227245603, 'psi': 0.951795507215903}-{'f1_val': 0.9204061747209991, 'auprc': 0.985941540321151, 'loss_val': 0.4355290966877937, 'psi': 0.9466203209610599}
[S17] START round=32 head_norm_before_train=1.936481 cos_to_last_merge=0.8290 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.619893433122994, 'auprc': 0.8026614862143997, 'loss_val': 1.263723587286034, 'psi': 0.6930006543595564}-{'f1_val': 0.714026742565847, 'auprc': 0.9503679492894221, 'loss_val': 0.773828194129463, 'psi': 0.808563225255277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.952)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[S7] not sending this round → trigger blocked (psi=0.702)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.2827
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.7501
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9598
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0245
[S4] DROPPED delta from S10 (cos=-0.0245 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=-0.0384
[S2] DROPPED delta from S3 (cos=-0.0384 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8122 head_norm=1.301601
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.061744e+00
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7954 head_norm=1.376436 delta_norm=1.061744
[S6] aggregate: ROLLBACK (f1_val pre=0.812 post=0.795 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9965 head_norm=1.356124
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.033808e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9965 head_norm=1.244459 delta_norm=0.203381
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9963 head_norm=1.158020
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.774511e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.215687 delta_norm=0.477451
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.085567 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7137215901682066, 'auprc': 0.819063435888638, 'loss_val': 0.8936067239367335, 'psi': 0.7558583284563791}-{'f1_val': 0.7134371378982118, 'auprc': 0.8030617940913833, 'loss_val': 0.833321359793584, 'psi': 0.7492870003754805}
[S3] START round=33 head_norm_before_train=2.073076 (no previous merge yet)
[S3] round=33 local utility u=0.001040 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9986774461261649, 'loss_val': 0.02570149637139772, 'psi': 0.9979272560224005}-{'f1_val': 0.9974271292865575, 'auprc': 0.9986920288952512, 'loss_val': 0.027826117580447247, 'psi': 0.9979330891300351}
[S4] START round=33 head_norm_before_train=1.953785 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9412200499712347, 'auprc': 0.9694794671790279, 'loss_val': 0.24924653400662217, 'psi': 0.952523816854352}-{'f1_val': 0.9490070577485562, 'auprc': 0.9723368178845193, 'loss_val': 0.23512839085949255, 'psi': 0.9583389618029414}
[S5] START round=33 head_norm_before_train=1.489971 cos_to_last_merge=0.9997 (last merge round=31)
[S5] round=33 local utility u=0.089256 metrics={'f1_val': 0.6303514892248118, 'auprc': 0.9375179010681607, 'loss_val': 0.4107054928004139, 'psi': 0.7532180539621514}-{'f1_val': 0.619582614378098, 'auprc': 0.9227635683096167, 'loss_val': 0.480340302897577, 'psi': 0.7408549959507056}
[S6] START round=33 head_norm_before_train=1.376436 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6757077256707705, 'auprc': 0.9383898173509564, 'loss_val': 0.66251666637679, 'psi': 0.7807805623428449}-{'f1_val': 0.8122323582830161, 'auprc': 0.955128562857684, 'loss_val': 0.4630889298865108, 'psi': 0.8693908401128833}
[S7] START round=33 head_norm_before_train=1.676674 (no previous merge yet)
[S7] round=33 local utility u=0.067923 metrics={'f1_val': 0.6483901821543986, 'auprc': 0.8087572315344561, 'loss_val': 0.5171657580849249, 'psi': 0.7125370019064217}-{'f1_val': 0.6350528720204579, 'auprc': 0.8031212007864038, 'loss_val': 0.5560795298963922, 'psi': 0.7022802035268363}
[S8] START round=33 head_norm_before_train=1.833946 cos_to_last_merge=0.7882 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.788
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9857167178610293, 'auprc': 0.998499944342562, 'loss_val': 0.047502667808841534, 'psi': 0.9908300084536423}-{'f1_val': 0.990351025081079, 'auprc': 0.9984934503131511, 'loss_val': 0.036560057229323456, 'psi': 0.9936079951739079}
[S9] START round=33 head_norm_before_train=1.103964 cos_to_last_merge=0.9992 (last merge round=31)
[S9] round=33 local utility u=0.761926 metrics={'f1_val': 0.9472091096037021, 'auprc': 0.9978328416230742, 'loss_val': 0.21881612540661835, 'psi': 0.9674586024114509}-{'f1_val': 0.7011143398254496, 'auprc': 0.9972309765264918, 'loss_val': 0.2642938629108658, 'psi': 0.8195609945058665}
[S10] START round=33 head_norm_before_train=2.013219 cos_to_last_merge=0.8241 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951045481912829, 'loss_val': 0.027368218556617217, 'psi': 0.9949017095020305}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951185822895345, 'loss_val': 0.02731596767195467, 'psi': 0.9949073231413312}
[S11] START round=33 head_norm_before_train=1.244459 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.99533110525491, 'loss_val': 0.10060771916824567, 'psi': 0.9958126470499495}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972333812312724, 'loss_val': 0.0793583408770743, 'psi': 0.9968215552006627}
[S13] START round=33 head_norm_before_train=1.926601 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6308824040076628, 'auprc': 0.7929609405224899, 'loss_val': 1.1078126026942774, 'psi': 0.6957138186135936}-{'f1_val': 0.6340024855557621, 'auprc': 0.8205849545460097, 'loss_val': 0.950002002122422, 'psi': 0.7086354731518612}
[S14] START round=33 head_norm_before_train=1.215687 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.991532271159892, 'auprc': 0.9959884712612312, 'loss_val': 0.21224032253966302, 'psi': 0.9933147512004277}-{'f1_val': 0.9963442551067831, 'auprc': 0.995395279292683, 'loss_val': 0.16608240457523843, 'psi': 0.9959646647811431}
[S15] START round=33 head_norm_before_train=1.438992 cos_to_last_merge=0.9993 (last merge round=31)
[S15] round=33 local utility u=0.272600 metrics={'f1_val': 0.995965101761962, 'auprc': 0.9974166632908321, 'loss_val': 0.08022745781591971, 'psi': 0.99654572637351}-{'f1_val': 0.9232522896130573, 'auprc': 0.995590219355653, 'loss_val': 0.18367033401260327, 'psi': 0.9521874615100956}
[S16] START round=33 head_norm_before_train=1.945221 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8786889827504833, 'auprc': 0.9258538099291596, 'loss_val': 0.6444472354378281, 'psi': 0.8975549136219538}-{'f1_val': 0.9278991478922368, 'auprc': 0.9876400462014021, 'loss_val': 0.37282867227245603, 'psi': 0.951795507215903}
[S17] START round=33 head_norm_before_train=1.947594 cos_to_last_merge=0.8285 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=33 local utility u=0.161867 metrics={'f1_val': 0.6302061598730737, 'auprc': 0.8244654289598112, 'loss_val': 1.0672786448670277, 'psi': 0.7079098675077687}-{'f1_val': 0.619893433122994, 'auprc': 0.8026614862143997, 'loss_val': 1.263723587286034, 'psi': 0.6930006543595564}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S15] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.998)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.3652
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.7541
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.6793
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] cosine check vs S17: cos=0.8890
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.6757 head_norm=1.409835
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.783569e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.6752 head_norm=1.279714 delta_norm=0.878357
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9915 head_norm=1.259539
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.244615e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9945 head_norm=1.123954 delta_norm=0.424461
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6304 head_norm=1.511936
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.635094e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.6300 head_norm=1.688097 delta_norm=0.463509
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9472 head_norm=1.140369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.576745e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.7011 head_norm=1.217455 delta_norm=0.557674
[S9] aggregate: ROLLBACK (f1_val pre=0.947 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] START round=34 head_norm_before_train=2.098880 (no previous merge yet)
[S2] round=34 local utility u=0.006353 metrics={'f1_val': 0.713683664816725, 'auprc': 0.8169199479040321, 'loss_val': 0.874243461219097, 'psi': 0.7549781780516478}-{'f1_val': 0.7137215901682066, 'auprc': 0.819063435888638, 'loss_val': 0.8936067239367335, 'psi': 0.7558583284563791}
[S3] START round=34 head_norm_before_train=2.086793 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9927472323429866, 'auprc': 0.9986931259283739, 'loss_val': 0.034321510843319386, 'psi': 0.9951255897771414}-{'f1_val': 0.9974271292865575, 'auprc': 0.9986774461261649, 'loss_val': 0.02570149637139772, 'psi': 0.9979272560224005}
[S4] START round=34 head_norm_before_train=1.966559 cos_to_last_merge=0.9998 (last merge round=31)
[S4] round=34 local utility u=0.040730 metrics={'f1_val': 0.9476249305058667, 'auprc': 0.9777161695082889, 'loss_val': 0.2309251230277613, 'psi': 0.9596614261068356}-{'f1_val': 0.9412200499712347, 'auprc': 0.9694794671790279, 'loss_val': 0.24924653400662217, 'psi': 0.952523816854352}
[S5] START round=34 head_norm_before_train=1.688097 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.215924 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9213110211602488, 'loss_val': 0.3500513786251486, 'psi': 0.7887167675589148}-{'f1_val': 0.6303514892248118, 'auprc': 0.9375179010681607, 'loss_val': 0.4107054928004139, 'psi': 0.7532180539621514}
[S6] START round=34 head_norm_before_train=1.279714 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.947717 metrics={'f1_val': 0.9233290557100022, 'auprc': 0.9468605728221847, 'loss_val': 0.2782221898260395, 'psi': 0.9327416625548752}-{'f1_val': 0.6757077256707705, 'auprc': 0.9383898173509564, 'loss_val': 0.66251666637679, 'psi': 0.7807805623428449}
[S7] START round=34 head_norm_before_train=1.682476 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6056083955756544, 'auprc': 0.8001906326717604, 'loss_val': 0.6414820157316097, 'psi': 0.6834412904140967}-{'f1_val': 0.6483901821543986, 'auprc': 0.8087572315344561, 'loss_val': 0.5171657580849249, 'psi': 0.7125370019064217}
[S8] START round=34 head_norm_before_train=1.841254 cos_to_last_merge=0.7888 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.789
[S8] round=34 local utility u=0.029073 metrics={'f1_val': 0.992959481021298, 'auprc': 0.9988314684316721, 'loss_val': 0.03380818084030444, 'psi': 0.9953082759854477}-{'f1_val': 0.9857167178610293, 'auprc': 0.998499944342562, 'loss_val': 0.047502667808841534, 'psi': 0.9908300084536423}
[S9] START round=34 head_norm_before_train=1.217455 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.139896 metrics={'f1_val': 0.9960795681750179, 'auprc': 0.9983963064642419, 'loss_val': 0.23393642002108067, 'psi': 0.9970062634907075}-{'f1_val': 0.9472091096037021, 'auprc': 0.9978328416230742, 'loss_val': 0.21881612540661835, 'psi': 0.9674586024114509}
[S10] START round=34 head_norm_before_train=2.027560 cos_to_last_merge=0.8232 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=34 local utility u=0.000089 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951473678062109, 'loss_val': 0.027318817096901798, 'psi': 0.9949188373480018}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951045481912829, 'loss_val': 0.027368218556617217, 'psi': 0.9949017095020305}
[S11] START round=34 head_norm_before_train=1.282323 cos_to_last_merge=0.9996 (last merge round=32)
[S11] round=34 local utility u=0.009333 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955735829659996, 'loss_val': 0.08266861095316583, 'psi': 0.9959096381343855}-{'f1_val': 0.9961336749133093, 'auprc': 0.99533110525491, 'loss_val': 0.10060771916824567, 'psi': 0.9958126470499495}
[S13] START round=34 head_norm_before_train=1.933828 (no previous merge yet)
[S13] round=34 local utility u=0.604661 metrics={'f1_val': 0.7477688777529673, 'auprc': 0.86154080347093, 'loss_val': 0.8055496170833061, 'psi': 0.7932776480401524}-{'f1_val': 0.6308824040076628, 'auprc': 0.7929609405224899, 'loss_val': 1.1078126026942774, 'psi': 0.6957138186135936}
[S14] START round=34 head_norm_before_train=1.123954 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.024633 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9896326417874817, 'loss_val': 0.1741038635231953, 'psi': 0.9937921906607686}-{'f1_val': 0.991532271159892, 'auprc': 0.9959884712612312, 'loss_val': 0.21224032253966302, 'psi': 0.9933147512004277}
[S15] START round=34 head_norm_before_train=1.477492 cos_to_last_merge=0.9975 (last merge round=31)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9594596147242426, 'auprc': 0.9939199540915842, 'loss_val': 0.1270881213070608, 'psi': 0.9732437504711793}-{'f1_val': 0.995965101761962, 'auprc': 0.9974166632908321, 'loss_val': 0.08022745781591971, 'psi': 0.99654572637351}
[S16] START round=34 head_norm_before_train=1.949675 (no previous merge yet)
[S16] round=34 local utility u=0.405698 metrics={'f1_val': 0.9345446364442043, 'auprc': 0.9877482861401901, 'loss_val': 0.3538683279254221, 'psi': 0.9558260963225986}-{'f1_val': 0.8786889827504833, 'auprc': 0.9258538099291596, 'loss_val': 0.6444472354378281, 'psi': 0.8975549136219538}
[S17] START round=34 head_norm_before_train=1.960376 cos_to_last_merge=0.8280 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=34 local utility u=0.096084 metrics={'f1_val': 0.629124528637246, 'auprc': 0.947520372500201, 'loss_val': 1.2377865761109976, 'psi': 0.7564828661824281}-{'f1_val': 0.6302061598730737, 'auprc': 0.8244654289598112, 'loss_val': 1.0672786448670277, 'psi': 0.7079098675077687}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:59812
[S5] not sending this round → trigger blocked (psi=0.789)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.3905
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=-0.0248
[S4] DROPPED delta from S10 (cos=-0.0248 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.4567
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9676
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.2332
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.6716
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9961
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.2477
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.7774
[S17] not sending this round → trigger blocked (psi=0.756)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7003 head_norm=1.704918
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.134298e+00
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7003 head_norm=1.456671 delta_norm=1.134298
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9961 head_norm=1.253109
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.486108e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9868 head_norm=1.122788 delta_norm=0.648611
[S9] aggregate: ROLLBACK (f1_val pre=0.996 post=0.987 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.9233 head_norm=1.323080
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.473899e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.9162 head_norm=1.239519 delta_norm=0.647390
[S6] aggregate: ROLLBACK (f1_val pre=0.923 post=0.916 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9476 head_norm=1.977447
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.701719e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9473 head_norm=1.965656 delta_norm=0.087017
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9961 head_norm=1.324322
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.755747e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9961 head_norm=1.238798 delta_norm=0.175575
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9595 head_norm=1.511279
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.810428e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9613 head_norm=1.336357 delta_norm=0.481043
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.112908 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6567369408530459, 'auprc': 0.8042986933599849, 'loss_val': 1.0784836170807233, 'psi': 0.7157616418558215}-{'f1_val': 0.713683664816725, 'auprc': 0.8169199479040321, 'loss_val': 0.874243461219097, 'psi': 0.7549781780516478}
[S3] START round=35 head_norm_before_train=2.100192 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9790807888147379, 'auprc': 0.9985593079026525, 'loss_val': 0.07549487069749759, 'psi': 0.9868721964499038}-{'f1_val': 0.9927472323429866, 'auprc': 0.9986931259283739, 'loss_val': 0.034321510843319386, 'psi': 0.9951255897771414}
[S4] START round=35 head_norm_before_train=1.965656 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9509396509987921, 'auprc': 0.9696001686836884, 'loss_val': 0.23777069926286473, 'psi': 0.9584038580727505}-{'f1_val': 0.9476249305058667, 'auprc': 0.9777161695082889, 'loss_val': 0.2309251230277613, 'psi': 0.9596614261068356}
[S5] START round=35 head_norm_before_train=1.456671 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6506750619886342, 'auprc': 0.6876532654962321, 'loss_val': 0.5162598258841002, 'psi': 0.6654663433916734}-{'f1_val': 0.700320598491359, 'auprc': 0.9213110211602488, 'loss_val': 0.3500513786251486, 'psi': 0.7887167675589148}
[S6] START round=35 head_norm_before_train=1.239519 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8221175733934278, 'auprc': 0.9187504797781182, 'loss_val': 0.4664109218065753, 'psi': 0.860770735947304}-{'f1_val': 0.9233290557100022, 'auprc': 0.9468605728221847, 'loss_val': 0.2782221898260395, 'psi': 0.9327416625548752}
[S7] START round=35 head_norm_before_train=1.685514 (no previous merge yet)
[S7] round=35 local utility u=0.157023 metrics={'f1_val': 0.6401320823488398, 'auprc': 0.8046390849628232, 'loss_val': 0.5479239914146693, 'psi': 0.7059348833944332}-{'f1_val': 0.6056083955756544, 'auprc': 0.8001906326717604, 'loss_val': 0.6414820157316097, 'psi': 0.6834412904140967}
[S8] START round=35 head_norm_before_train=1.854129 cos_to_last_merge=0.7880 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.788
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9756548632049336, 'auprc': 0.9985721609492595, 'loss_val': 0.05675644161471617, 'psi': 0.9848217823026639}-{'f1_val': 0.992959481021298, 'auprc': 0.9988314684316721, 'loss_val': 0.03380818084030444, 'psi': 0.9953082759854477}
[S9] START round=35 head_norm_before_train=1.122788 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.020545 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9987681055750385, 'loss_val': 0.19629207057851988, 'psi': 0.9973879243350381}-{'f1_val': 0.9960795681750179, 'auprc': 0.9983963064642419, 'loss_val': 0.23393642002108067, 'psi': 0.9970062634907075}
[S10] START round=35 head_norm_before_train=2.037062 cos_to_last_merge=0.8229 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=35 local utility u=0.000225 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951788365825338, 'loss_val': 0.026964186772402955, 'psi': 0.9949314248585308}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951473678062109, 'loss_val': 0.027318817096901798, 'psi': 0.9949188373480018}
[S11] START round=35 head_norm_before_train=1.238798 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9943925535204386, 'loss_val': 0.1161477688616037, 'psi': 0.995437226356161}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955735829659996, 'loss_val': 0.08266861095316583, 'psi': 0.9959096381343855}
[S13] START round=35 head_norm_before_train=1.934797 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6507734212625852, 'auprc': 0.8348898413570723, 'loss_val': 0.8736587190301651, 'psi': 0.72441998930038}-{'f1_val': 0.7477688777529673, 'auprc': 0.86154080347093, 'loss_val': 0.8055496170833061, 'psi': 0.7932776480401524}
[S14] START round=35 head_norm_before_train=1.173484 cos_to_last_merge=0.9982 (last merge round=33)
[S14] round=35 local utility u=0.028904 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9948318839137114, 'loss_val': 0.13043521396771476, 'psi': 0.9957261019603909}-{'f1_val': 0.9965652232429598, 'auprc': 0.9896326417874817, 'loss_val': 0.1741038635231953, 'psi': 0.9937921906607686}
[S15] START round=35 head_norm_before_train=1.336357 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8187183211031087, 'auprc': 0.9855377215848165, 'loss_val': 0.3305027227417687, 'psi': 0.8854460812957918}-{'f1_val': 0.9594596147242426, 'auprc': 0.9939199540915842, 'loss_val': 0.1270881213070608, 'psi': 0.9732437504711793}
[S16] START round=35 head_norm_before_train=1.957665 (no previous merge yet)
[S16] round=35 local utility u=0.104497 metrics={'f1_val': 0.940627472379678, 'auprc': 0.9944384753807, 'loss_val': 0.2014424595417398, 'psi': 0.9621518735800868}-{'f1_val': 0.9345446364442043, 'auprc': 0.9877482861401901, 'loss_val': 0.3538683279254221, 'psi': 0.9558260963225986}
[S17] START round=35 head_norm_before_train=1.971102 cos_to_last_merge=0.8274 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=35 local utility u=0.034000 metrics={'f1_val': 0.6368049977957057, 'auprc': 0.8743068226926349, 'loss_val': 0.9962280588740945, 'psi': 0.7318057277544774}-{'f1_val': 0.629124528637246, 'auprc': 0.947520372500201, 'loss_val': 1.2377865761109976, 'psi': 0.7564828661824281}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.962)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.5275
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.8575
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.6031
[S15] ⇄ pheromone p=0.213 → S14@127.0.0.1:59814
[S4] ⇄ pheromone p=0.018 → S5@127.0.0.1:59805
[S8] ⇄ pheromone p=0.013 → S6@127.0.0.1:59807
[S2] ⇄ pheromone p=0.016 → S6@127.0.0.1:59807
[S13] ⇄ pheromone p=0.131 → S9@127.0.0.1:59810
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8221 head_norm=1.289217
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.441123e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8210 head_norm=1.304435 delta_norm=0.744112
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.233 → S15@127.0.0.1:59815
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.6507 head_norm=1.472879
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.019071e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.6470 head_norm=1.549774 delta_norm=0.801907
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.162 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.002 → S4@127.0.0.1:59804
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9963 head_norm=1.225425
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.200387e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9963 head_norm=1.150400 delta_norm=0.320039
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.020 → S11@127.0.0.1:59812
[S3] ⇄ pheromone p=0.066 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.021 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.102 → S6@127.0.0.1:59807
[S9] ⇄ pheromone p=0.131 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.182 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.172 → S4@127.0.0.1:59804
[S2] START round=36 head_norm_before_train=2.124079 (no previous merge yet)
[S2] round=36 local utility u=0.202328 metrics={'f1_val': 0.6910773183006444, 'auprc': 0.8029078802780523, 'loss_val': 0.87569724918354, 'psi': 0.7358095430916076}-{'f1_val': 0.6567369408530459, 'auprc': 0.8042986933599849, 'loss_val': 1.0784836170807233, 'psi': 0.7157616418558215}
[S3] START round=36 head_norm_before_train=2.111609 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9562468780677509, 'auprc': 0.9990521077783778, 'loss_val': 0.14044889082121426, 'psi': 0.9733689699520016}-{'f1_val': 0.9790807888147379, 'auprc': 0.9985593079026525, 'loss_val': 0.07549487069749759, 'psi': 0.9868721964499038}
[S4] START round=36 head_norm_before_train=1.980546 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9430154675787714, 'auprc': 0.9691609990690709, 'loss_val': 0.252639895439169, 'psi': 0.9534736801748913}-{'f1_val': 0.9509396509987921, 'auprc': 0.9696001686836884, 'loss_val': 0.23777069926286473, 'psi': 0.9584038580727505}
[S5] START round=36 head_norm_before_train=1.549774 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.688126 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9790778469187968, 'loss_val': 0.31215451285919543, 'psi': 0.8118234978623342}-{'f1_val': 0.6506750619886342, 'auprc': 0.6876532654962321, 'loss_val': 0.5162598258841002, 'psi': 0.6654663433916734}
[S6] START round=36 head_norm_before_train=1.304435 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.783813389948498, 'auprc': 0.9231057416717603, 'loss_val': 0.5806815477828571, 'psi': 0.8395303306378029}-{'f1_val': 0.8221175733934278, 'auprc': 0.9187504797781182, 'loss_val': 0.4664109218065753, 'psi': 0.860770735947304}
[S7] START round=36 head_norm_before_train=1.687728 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.517951386814123, 'auprc': 0.7833046209797627, 'loss_val': 0.8860562094346014, 'psi': 0.6240926804803789}-{'f1_val': 0.6401320823488398, 'auprc': 0.8046390849628232, 'loss_val': 0.5479239914146693, 'psi': 0.7059348833944332}
[S8] START round=36 head_norm_before_train=1.867981 cos_to_last_merge=0.7863 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=36 local utility u=0.043099 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9985700439001299, 'loss_val': 0.039445361660278656, 'psi': 0.9917102633325208}-{'f1_val': 0.9756548632049336, 'auprc': 0.9985721609492595, 'loss_val': 0.05675644161471617, 'psi': 0.9848217823026639}
[S9] START round=36 head_norm_before_train=1.161904 cos_to_last_merge=0.9991 (last merge round=34)
[S9] round=36 local utility u=0.009636 metrics={'f1_val': 0.9963002897586258, 'auprc': 0.9983904818658711, 'loss_val': 0.17488284513622682, 'psi': 0.9971363666015239}-{'f1_val': 0.9964678035083712, 'auprc': 0.9987681055750385, 'loss_val': 0.19629207057851988, 'psi': 0.9973879243350381}
[S10] START round=36 head_norm_before_train=2.041490 cos_to_last_merge=0.8229 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=36 local utility u=0.000205 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952202893025064, 'loss_val': 0.02667832271573584, 'psi': 0.9949480059465199}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951788365825338, 'loss_val': 0.026964186772402955, 'psi': 0.9949314248585308}
[S11] START round=36 head_norm_before_train=1.279119 cos_to_last_merge=0.9994 (last merge round=34)
[S11] round=36 local utility u=0.021971 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962388544703199, 'loss_val': 0.08022520162835088, 'psi': 0.9964237444962817}-{'f1_val': 0.9961336749133093, 'auprc': 0.9943925535204386, 'loss_val': 0.1161477688616037, 'psi': 0.995437226356161}
[S13] START round=36 head_norm_before_train=1.937069 (no previous merge yet)
[S13] round=36 local utility u=0.239065 metrics={'f1_val': 0.7130179257838235, 'auprc': 0.8136284964404707, 'loss_val': 0.705211191052286, 'psi': 0.7532621540464823}-{'f1_val': 0.6507734212625852, 'auprc': 0.8348898413570723, 'loss_val': 0.8736587190301651, 'psi': 0.72441998930038}
[S14] START round=36 head_norm_before_train=1.150400 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9948667234291164, 'loss_val': 0.1494013407226764, 'psi': 0.9957532424357164}-{'f1_val': 0.9963222473248441, 'auprc': 0.9948318839137114, 'loss_val': 0.13043521396771476, 'psi': 0.9957261019603909}
[S15] START round=36 head_norm_before_train=1.382468 cos_to_last_merge=0.9986 (last merge round=34)
[S15] round=36 local utility u=0.519267 metrics={'f1_val': 0.953951035994204, 'auprc': 0.9926204862612364, 'loss_val': 0.12461393643392164, 'psi': 0.969418816101017}-{'f1_val': 0.8187183211031087, 'auprc': 0.9855377215848165, 'loss_val': 0.3305027227417687, 'psi': 0.8854460812957918}
[S16] START round=36 head_norm_before_train=1.967592 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9389580441559391, 'auprc': 0.9944040251522622, 'loss_val': 0.27855331447461823, 'psi': 0.9611364365544683}-{'f1_val': 0.940627472379678, 'auprc': 0.9944384753807, 'loss_val': 0.2014424595417398, 'psi': 0.9621518735800868}
[S17] START round=36 head_norm_before_train=1.979983 cos_to_last_merge=0.8270 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=36 local utility u=0.378726 metrics={'f1_val': 0.7525257117180648, 'auprc': 0.847473049566527, 'loss_val': 0.8525981104983699, 'psi': 0.7905046468574497}-{'f1_val': 0.6368049977957057, 'auprc': 0.8743068226926349, 'loss_val': 0.9962280588740945, 'psi': 0.7318057277544774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:59817
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:59803
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9547
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.6319
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=-0.0339
[S3] DROPPED delta from S2 (cos=-0.0339 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.9032
[S17] RECEIVED delta(kind=head bytes=1802) from S5
[S17] cosine check vs S5: cos=0.9244
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9963 head_norm=1.198022
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.989407e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9963 head_norm=1.245102 delta_norm=0.198941
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.7838 head_norm=1.354184
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.105757e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.7884 head_norm=1.363812 delta_norm=0.310576
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.7003 head_norm=1.563704
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.152830e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.7003 head_norm=1.251137 delta_norm=0.615283
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.7525 head_norm=1.992122
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.044914e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.7747 head_norm=1.744491 delta_norm=0.404491
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.133797 (no previous merge yet)
[S2] round=37 local utility u=0.060862 metrics={'f1_val': 0.7122939506015076, 'auprc': 0.8174102660018969, 'loss_val': 0.9247810445596543, 'psi': 0.7543404767616633}-{'f1_val': 0.6910773183006444, 'auprc': 0.8029078802780523, 'loss_val': 0.87569724918354, 'psi': 0.7358095430916076}
[S3] START round=37 head_norm_before_train=2.122745 (no previous merge yet)
[S3] round=37 local utility u=0.035537 metrics={'f1_val': 0.960590569831578, 'auprc': 0.9986407276522031, 'loss_val': 0.09420216012355581, 'psi': 0.975810632959828}-{'f1_val': 0.9562468780677509, 'auprc': 0.9990521077783778, 'loss_val': 0.14044889082121426, 'psi': 0.9733689699520016}
[S4] START round=37 head_norm_before_train=1.995790 cos_to_last_merge=0.9996 (last merge round=34)
[S4] round=37 local utility u=0.038939 metrics={'f1_val': 0.947300490515112, 'auprc': 0.9831849227143693, 'loss_val': 0.2425429387240406, 'psi': 0.961654263394815}-{'f1_val': 0.9430154675787714, 'auprc': 0.9691609990690709, 'loss_val': 0.252639895439169, 'psi': 0.9534736801748913}
[S5] START round=37 head_norm_before_train=1.251137 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6490575054390255, 'auprc': 0.9196332092407774, 'loss_val': 0.46988026805485666, 'psi': 0.7572877869597263}-{'f1_val': 0.700320598491359, 'auprc': 0.9790778469187968, 'loss_val': 0.31215451285919543, 'psi': 0.8118234978623342}
[S6] START round=37 head_norm_before_train=1.363812 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7614675138918431, 'auprc': 0.9294484542019472, 'loss_val': 0.5441250742353797, 'psi': 0.8286598900158848}-{'f1_val': 0.783813389948498, 'auprc': 0.9231057416717603, 'loss_val': 0.5806815477828571, 'psi': 0.8395303306378029}
[S7] START round=37 head_norm_before_train=1.691105 (no previous merge yet)
[S7] round=37 local utility u=1.000000 metrics={'f1_val': 0.8893520761653986, 'auprc': 0.9847899638954075, 'loss_val': 0.18615961346565452, 'psi': 0.9275272312574021}-{'f1_val': 0.517951386814123, 'auprc': 0.7833046209797627, 'loss_val': 0.8860562094346014, 'psi': 0.6240926804803789}
[S8] START round=37 head_norm_before_train=1.874570 cos_to_last_merge=0.7861 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=37 local utility u=0.023559 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9987958422428143, 'loss_val': 0.03013131892036858, 'psi': 0.9955133372754101}-{'f1_val': 0.9871370762874481, 'auprc': 0.9985700439001299, 'loss_val': 0.039445361660278656, 'psi': 0.9917102633325208}
[S9] START round=37 head_norm_before_train=1.201108 cos_to_last_merge=0.9969 (last merge round=34)
[S9] round=37 local utility u=0.014125 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.9983430791493424, 'loss_val': 0.1440008450280406, 'psi': 0.9968683342713383}-{'f1_val': 0.9963002897586258, 'auprc': 0.9983904818658711, 'loss_val': 0.17488284513622682, 'psi': 0.9971363666015239}
[S10] START round=37 head_norm_before_train=2.047953 cos_to_last_merge=0.8228 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=37 local utility u=0.000029 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952261256514634, 'loss_val': 0.026637501597846676, 'psi': 0.9949503404861026}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952202893025064, 'loss_val': 0.02667832271573584, 'psi': 0.9949480059465199}
[S11] START round=37 head_norm_before_train=1.320779 cos_to_last_merge=0.9977 (last merge round=34)
[S11] round=37 local utility u=0.002797 metrics={'f1_val': 0.9955841328264396, 'auprc': 0.9966140451187858, 'loss_val': 0.06997962277787075, 'psi': 0.9959960977433782}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962388544703199, 'loss_val': 0.08022520162835088, 'psi': 0.9964237444962817}
[S13] START round=37 head_norm_before_train=1.945478 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6063544151654515, 'auprc': 0.8044318955958499, 'loss_val': 1.2889090147957984, 'psi': 0.6855854073376109}-{'f1_val': 0.7130179257838235, 'auprc': 0.8136284964404707, 'loss_val': 0.705211191052286, 'psi': 0.7532621540464823}
[S14] START round=37 head_norm_before_train=1.245102 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.026559 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9947121207378697, 'loss_val': 0.0958204672330543, 'psi': 0.9956914013592177}-{'f1_val': 0.9963442551067831, 'auprc': 0.9948667234291164, 'loss_val': 0.1494013407226764, 'psi': 0.9957532424357164}
[S15] START round=37 head_norm_before_train=1.441897 cos_to_last_merge=0.9945 (last merge round=34)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7763829392248572, 'auprc': 0.989000424527206, 'loss_val': 0.3515634045705463, 'psi': 0.8614299333457968}-{'f1_val': 0.953951035994204, 'auprc': 0.9926204862612364, 'loss_val': 0.12461393643392164, 'psi': 0.969418816101017}
[S16] START round=37 head_norm_before_train=1.978191 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9339832207384726, 'auprc': 0.9944992987917626, 'loss_val': 0.3560161512986329, 'psi': 0.9581896519597886}-{'f1_val': 0.9389580441559391, 'auprc': 0.9944040251522622, 'loss_val': 0.27855331447461823, 'psi': 0.9611364365544683}
[S17] START round=37 head_norm_before_train=1.744491 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.328348 metrics={'f1_val': 0.7690748083648176, 'auprc': 0.985699342878806, 'loss_val': 0.709875343412309, 'psi': 0.8557246221704129}-{'f1_val': 0.7525257117180648, 'auprc': 0.847473049566527, 'loss_val': 0.8525981104983699, 'psi': 0.7905046468574497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:59816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:59814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9966
[S14] RECEIVED delta(kind=head bytes=1807) from S11
[S14] cosine check vs S11: cos=0.9884
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=-0.0338
[S3] DROPPED delta from S2 (cos=-0.0338 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.8701
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.6823
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.7764 head_norm=1.501451
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.650409e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.7773 head_norm=1.282045 delta_norm=0.565041
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.6491 head_norm=1.268466
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.198397e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.6213 head_norm=1.212496 delta_norm=0.319840
[S5] aggregate: ROLLBACK (f1_val pre=0.649 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9340 head_norm=1.988849
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.335157e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9342 head_norm=1.998588 delta_norm=0.083352
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9963 head_norm=1.292851
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.067358e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9963 head_norm=1.323050 delta_norm=0.106736
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.137817 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6973270501613537, 'auprc': 0.794918262683966, 'loss_val': 0.8461265197819612, 'psi': 0.7363635351703987}-{'f1_val': 0.7122939506015076, 'auprc': 0.8174102660018969, 'loss_val': 0.9247810445596543, 'psi': 0.7543404767616633}
[S3] START round=38 head_norm_before_train=2.134461 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9425235894983746, 'auprc': 0.9985451130333693, 'loss_val': 0.10565231304337981, 'psi': 0.9649321989123725}-{'f1_val': 0.960590569831578, 'auprc': 0.9986407276522031, 'loss_val': 0.09420216012355581, 'psi': 0.975810632959828}
[S4] START round=38 head_norm_before_train=2.011736 cos_to_last_merge=0.9992 (last merge round=34)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9418042666168458, 'auprc': 0.9749286758641021, 'loss_val': 0.2556603743926205, 'psi': 0.9550540303157484}-{'f1_val': 0.947300490515112, 'auprc': 0.9831849227143693, 'loss_val': 0.2425429387240406, 'psi': 0.961654263394815}
[S5] START round=38 head_norm_before_train=1.212496 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6448751509243811, 'auprc': 0.9224664465463551, 'loss_val': 0.504526955906382, 'psi': 0.7559116691731707}-{'f1_val': 0.6490575054390255, 'auprc': 0.9196332092407774, 'loss_val': 0.46988026805485666, 'psi': 0.7572877869597263}
[S6] START round=38 head_norm_before_train=1.398647 cos_to_last_merge=0.9995 (last merge round=36)
[S6] round=38 local utility u=0.830682 metrics={'f1_val': 0.9627922817217429, 'auprc': 0.9577525851312759, 'loss_val': 0.1756216633593666, 'psi': 0.9607764030855561}-{'f1_val': 0.7614675138918431, 'auprc': 0.9294484542019472, 'loss_val': 0.5441250742353797, 'psi': 0.8286598900158848}
[S7] START round=38 head_norm_before_train=1.694655 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5336495118220592, 'auprc': 0.7833671435211512, 'loss_val': 0.8453252546233206, 'psi': 0.633536564501696}-{'f1_val': 0.8893520761653986, 'auprc': 0.9847899638954075, 'loss_val': 0.18615961346565452, 'psi': 0.9275272312574021}
[S8] START round=38 head_norm_before_train=1.881485 cos_to_last_merge=0.7856 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9869147793946973, 'auprc': 0.9986847720600054, 'loss_val': 0.03987259331810473, 'psi': 0.9916227764608205}-{'f1_val': 0.9933250006304741, 'auprc': 0.9987958422428143, 'loss_val': 0.03013131892036858, 'psi': 0.9955133372754101}
[S9] START round=38 head_norm_before_train=1.239308 cos_to_last_merge=0.9938 (last merge round=34)
[S9] round=38 local utility u=0.019580 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9982859731585131, 'loss_val': 0.11214856584850418, 'psi': 0.9975934430476706}-{'f1_val': 0.9958851710193355, 'auprc': 0.9983430791493424, 'loss_val': 0.1440008450280406, 'psi': 0.9968683342713383}
[S10] START round=38 head_norm_before_train=2.058520 cos_to_last_merge=0.8223 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=38 local utility u=0.000101 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952258310489137, 'loss_val': 0.026434130855009265, 'psi': 0.9949502226450828}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952261256514634, 'loss_val': 0.026637501597846676, 'psi': 0.9949503404861026}
[S11] START round=38 head_norm_before_train=1.360972 cos_to_last_merge=0.9954 (last merge round=34)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9957377175463685, 'loss_val': 0.07548324540592352, 'psi': 0.995975291966533}-{'f1_val': 0.9955841328264396, 'auprc': 0.9966140451187858, 'loss_val': 0.06997962277787075, 'psi': 0.9959960977433782}
[S13] START round=38 head_norm_before_train=1.954393 (no previous merge yet)
[S13] round=38 local utility u=0.552181 metrics={'f1_val': 0.6862987651504876, 'auprc': 0.8103653548718722, 'loss_val': 0.682013261729804, 'psi': 0.7359254010390415}-{'f1_val': 0.6063544151654515, 'auprc': 0.8044318955958499, 'loss_val': 1.2889090147957984, 'psi': 0.6855854073376109}
[S14] START round=38 head_norm_before_train=1.323050 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.007273 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9927717999013997, 'loss_val': 0.07791547244905606, 'psi': 0.9951614389527788}-{'f1_val': 0.9963442551067831, 'auprc': 0.9947121207378697, 'loss_val': 0.0958204672330543, 'psi': 0.9956914013592177}
[S15] START round=38 head_norm_before_train=1.282045 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.804871 metrics={'f1_val': 0.995906643226353, 'auprc': 0.99603019615823, 'loss_val': 0.08005226341017407, 'psi': 0.9959560643991039}-{'f1_val': 0.7763829392248572, 'auprc': 0.989000424527206, 'loss_val': 0.3515634045705463, 'psi': 0.8614299333457968}
[S16] START round=38 head_norm_before_train=1.998588 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9231197347707554, 'auprc': 0.9935466310479332, 'loss_val': 0.42808385014716327, 'psi': 0.9512904932816265}-{'f1_val': 0.9339832207384726, 'auprc': 0.9944992987917626, 'loss_val': 0.3560161512986329, 'psi': 0.9581896519597886}
[S17] START round=38 head_norm_before_train=1.762724 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=38 local utility u=0.087855 metrics={'f1_val': 0.8309108490734036, 'auprc': 0.8801302571334104, 'loss_val': 0.5884746245610958, 'psi': 0.8505986122974063}-{'f1_val': 0.7690748083648176, 'auprc': 0.985699342878806, 'loss_val': 0.709875343412309, 'psi': 0.8557246221704129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] cosine check vs S15: cos=0.8862
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9119
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9610
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:59808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.7827
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.6449 head_norm=1.232278
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.762639e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.6224 head_norm=1.241524 delta_norm=0.176264
[S5] aggregate: ROLLBACK (f1_val pre=0.645 post=0.622 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.5336 head_norm=1.695433
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.299081e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.5520 head_norm=1.474479 delta_norm=0.529908
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.9628 head_norm=1.426636
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.325966e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.9628 head_norm=1.343143 delta_norm=0.332597
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9959 head_norm=1.339411
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.835524e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9959 head_norm=1.320032 delta_norm=0.283552
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.144756 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6665186900994771, 'auprc': 0.7966116517676505, 'loss_val': 1.017083594352351, 'psi': 0.7185558747667464}-{'f1_val': 0.6973270501613537, 'auprc': 0.794918262683966, 'loss_val': 0.8461265197819612, 'psi': 0.7363635351703987}
[S3] START round=39 head_norm_before_train=2.145945 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9495714582406926, 'auprc': 0.998032493012762, 'loss_val': 0.16556162434793953, 'psi': 0.9689558721495204}-{'f1_val': 0.9425235894983746, 'auprc': 0.9985451130333693, 'loss_val': 0.10565231304337981, 'psi': 0.9649321989123725}
[S4] START round=39 head_norm_before_train=2.020259 cos_to_last_merge=0.9989 (last merge round=34)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.93895600090374, 'auprc': 0.9525509463988361, 'loss_val': 0.2646587850087118, 'psi': 0.9443939791017784}-{'f1_val': 0.9418042666168458, 'auprc': 0.9749286758641021, 'loss_val': 0.2556603743926205, 'psi': 0.9550540303157484}
[S5] START round=39 head_norm_before_train=1.241524 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.168353 metrics={'f1_val': 0.6783814851662647, 'auprc': 0.9507002110473497, 'loss_val': 0.45355944864306924, 'psi': 0.7873089755186987}-{'f1_val': 0.6448751509243811, 'auprc': 0.9224664465463551, 'loss_val': 0.504526955906382, 'psi': 0.7559116691731707}
[S6] START round=39 head_norm_before_train=1.343143 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5969228040937412, 'auprc': 0.8820825808224391, 'loss_val': 0.8720072053044594, 'psi': 0.7109867147852205}-{'f1_val': 0.9627922817217429, 'auprc': 0.9577525851312759, 'loss_val': 0.1756216633593666, 'psi': 0.9607764030855561}
[S7] START round=39 head_norm_before_train=1.474479 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.710144 metrics={'f1_val': 0.6734278647734248, 'auprc': 0.8261851579622768, 'loss_val': 0.39216070646504636, 'psi': 0.7345307820489656}-{'f1_val': 0.5336495118220592, 'auprc': 0.7833671435211512, 'loss_val': 0.8453252546233206, 'psi': 0.633536564501696}
[S8] START round=39 head_norm_before_train=1.889122 cos_to_last_merge=0.7844 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.784
[S8] round=39 local utility u=0.020687 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9985131467799008, 'loss_val': 0.03166871665238802, 'psi': 0.994922640306352}-{'f1_val': 0.9869147793946973, 'auprc': 0.9986847720600054, 'loss_val': 0.03987259331810473, 'psi': 0.9916227764608205}
[S9] START round=39 head_norm_before_train=1.275301 cos_to_last_merge=0.9903 (last merge round=34)
[S9] round=39 local utility u=0.007337 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9981789258818432, 'loss_val': 0.09565131363081515, 'psi': 0.9974004274007668}-{'f1_val': 0.9971317563071089, 'auprc': 0.9982859731585131, 'loss_val': 0.11214856584850418, 'psi': 0.9975934430476706}
[S10] START round=39 head_norm_before_train=2.070385 cos_to_last_merge=0.8217 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=39 local utility u=0.000016 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952286013018967, 'loss_val': 0.02641139307375036, 'psi': 0.9949513307462761}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952258310489137, 'loss_val': 0.026434130855009265, 'psi': 0.9949502226450828}
[S11] START round=39 head_norm_before_train=1.397835 cos_to_last_merge=0.9932 (last merge round=34)
[S11] round=39 local utility u=0.008822 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9959580874834495, 'loss_val': 0.05850086201380701, 'psi': 0.9960634399413654}-{'f1_val': 0.9961336749133093, 'auprc': 0.9957377175463685, 'loss_val': 0.07548324540592352, 'psi': 0.995975291966533}
[S13] START round=39 head_norm_before_train=1.960863 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.7123971950878971, 'auprc': 0.8311155096783072, 'loss_val': 0.9770487378659358, 'psi': 0.7598845209240612}-{'f1_val': 0.6862987651504876, 'auprc': 0.8103653548718722, 'loss_val': 0.682013261729804, 'psi': 0.7359254010390415}
[S14] START round=39 head_norm_before_train=1.360792 cos_to_last_merge=0.9996 (last merge round=37)
[S14] round=39 local utility u=0.001894 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9928625062812919, 'loss_val': 0.07673156590082078, 'psi': 0.9954309739503964}-{'f1_val': 0.996754531653698, 'auprc': 0.9927717999013997, 'loss_val': 0.07791547244905606, 'psi': 0.9951614389527788}
[S15] START round=39 head_norm_before_train=1.320032 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.6946508047610638, 'loss_val': 0.5130053928558582, 'psi': 0.6983198751658751}-{'f1_val': 0.995906643226353, 'auprc': 0.99603019615823, 'loss_val': 0.08005226341017407, 'psi': 0.9959560643991039}
[S16] START round=39 head_norm_before_train=2.007276 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.914360029714228, 'auprc': 0.9921944943147003, 'loss_val': 0.48455706357228345, 'psi': 0.9454938155544169}-{'f1_val': 0.9231197347707554, 'auprc': 0.9935466310479332, 'loss_val': 0.42808385014716327, 'psi': 0.9512904932816265}
[S17] START round=39 head_norm_before_train=1.777237 cos_to_last_merge=0.9998 (last merge round=36)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6229384148091018, 'auprc': 0.8658454259981525, 'loss_val': 1.2293172976262376, 'psi': 0.720101219284722}-{'f1_val': 0.8309108490734036, 'auprc': 0.8801302571334104, 'loss_val': 0.5884746245610958, 'psi': 0.8505986122974063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9865
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:59814
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S11
[S14] cosine check vs S11: cos=0.9942
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:59817
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S5
[S17] cosine check vs S5: cos=0.6902
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:59815
[S4] r=40 psi=0.944 u=0.0000 p_local=0.0124 f1=0.939 auprc=0.953 bytes=28760
[S3] r=40 psi=0.969 u=0.0000 p_local=0.0316 f1=0.950 auprc=0.998 bytes=30574
[S7] r=40 psi=0.735 u=0.7101 p_local=0.3118 f1=0.673 auprc=0.826 bytes=34196
[S2] r=40 psi=0.719 u=0.0000 p_local=0.0349 f1=0.667 auprc=0.797 bytes=28822
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9729
[S9] r=40 psi=0.997 u=0.0073 p_local=0.0611 f1=0.997 auprc=0.998 bytes=37747
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0010 f1=0.995 auprc=0.995 bytes=41343
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9971 head_norm=1.390396
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.847940e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9971 head_norm=1.407598 delta_norm=0.078479
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.995 u=0.0019 p_local=0.0132 f1=0.997 auprc=0.993 bytes=35963
[S11] r=40 psi=0.996 u=0.0088 p_local=0.0129 f1=0.996 auprc=0.996 bytes=43120
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.7008 head_norm=1.360618
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.607823e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.7008 head_norm=1.366159 delta_norm=0.160782
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.698 u=0.0000 p_local=0.2694 f1=0.701 auprc=0.695 bytes=26995
[S6] r=40 psi=0.711 u=0.0000 p_local=0.2284 f1=0.597 auprc=0.882 bytes=26957
[S8] r=40 psi=0.995 u=0.0207 p_local=0.0168 f1=0.993 auprc=0.999 bytes=35942
[S16] r=40 psi=0.945 u=0.0000 p_local=0.0703 f1=0.914 auprc=0.992 bytes=28753
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.6784 head_norm=1.259888
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.082238e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.6675 head_norm=1.280333 delta_norm=0.108224
[S5] aggregate: ROLLBACK (f1_val pre=0.678 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S5] r=40 psi=0.787 u=0.1684 p_local=0.1704 f1=0.678 auprc=0.951 bytes=34180
[S13] r=40 psi=0.760 u=0.0000 p_local=0.1665 f1=0.712 auprc=0.831 bytes=23355
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6229 head_norm=1.793429
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.489625e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6245 head_norm=1.407374 delta_norm=0.648962
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.720 u=0.0000 p_local=0.1695 f1=0.623 auprc=0.866 bytes=37788
[S2] START round=40 head_norm_before_train=2.149745 (no previous merge yet)
[S2] round=40 local utility u=0.203561 metrics={'f1_val': 0.7136711767752654, 'auprc': 0.7990649684979088, 'loss_val': 0.9002356902441425, 'psi': 0.7478286934643228}-{'f1_val': 0.6665186900994771, 'auprc': 0.7966116517676505, 'loss_val': 1.017083594352351, 'psi': 0.7185558747667464}
[S3] START round=40 head_norm_before_train=2.156770 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.936056037043483, 'auprc': 0.9944023649681005, 'loss_val': 0.1414041322648364, 'psi': 0.9593945682133299}-{'f1_val': 0.9495714582406926, 'auprc': 0.998032493012762, 'loss_val': 0.16556162434793953, 'psi': 0.9689558721495204}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.025420 cos_to_last_merge=0.9986 (last merge round=34)
[S4] round=40 local utility u=0.090444 metrics={'f1_val': 0.9519168215979429, 'auprc': 0.9792296307623243, 'loss_val': 0.2415722488028168, 'psi': 0.9628419452636955}-{'f1_val': 0.93895600090374, 'auprc': 0.9525509463988361, 'loss_val': 0.2646587850087118, 'psi': 0.9443939791017784}
[S5] START round=40 head_norm_before_train=1.280333 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.126214 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9759047515295691, 'loss_val': 0.40689125957469113, 'psi': 0.810405432112155}-{'f1_val': 0.6783814851662647, 'auprc': 0.9507002110473497, 'loss_val': 0.45355944864306924, 'psi': 0.7873089755186987}
[S6] START round=40 head_norm_before_train=1.360431 cos_to_last_merge=0.9998 (last merge round=38)
[S6] round=40 local utility u=0.913489 metrics={'f1_val': 0.809077545687287, 'auprc': 0.9379351263611136, 'loss_val': 0.48551461075339997, 'psi': 0.8606205779568177}-{'f1_val': 0.5969228040937412, 'auprc': 0.8820825808224391, 'loss_val': 0.8720072053044594, 'psi': 0.7109867147852205}
[S7] START round=40 head_norm_before_train=1.476548 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6429934256472373, 'auprc': 0.800878341161227, 'loss_val': 0.5209837656131553, 'psi': 0.7061473918528332}-{'f1_val': 0.6734278647734248, 'auprc': 0.8261851579622768, 'loss_val': 0.39216070646504636, 'psi': 0.7345307820489656}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.898749 cos_to_last_merge=0.7831 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=40 local utility u=0.001228 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9986867897394516, 'loss_val': 0.03059606679902887, 'psi': 0.9950783248812745}-{'f1_val': 0.9925289693239863, 'auprc': 0.9985131467799008, 'loss_val': 0.03166871665238802, 'psi': 0.994922640306352}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=40 head_norm_before_train=1.309432 cos_to_last_merge=0.9867 (last merge round=34)
[S9] round=40 local utility u=0.006493 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9980149507099341, 'loss_val': 0.08217260833256275, 'psi': 0.9973348373320032}-{'f1_val': 0.9968814284133827, 'auprc': 0.9981789258818432, 'loss_val': 0.09565131363081515, 'psi': 0.9974004274007668}
[S10] START round=40 head_norm_before_train=2.076403 cos_to_last_merge=0.8215 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=40 local utility u=0.000066 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952334358839925, 'loss_val': 0.026293267171238484, 'psi': 0.9949532645791144}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952286013018967, 'loss_val': 0.02641139307375036, 'psi': 0.9949513307462761}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=40 head_norm_before_train=1.428908 cos_to_last_merge=0.9912 (last merge round=34)
[S11] round=40 local utility u=0.006904 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9958566811714001, 'loss_val': 0.04438955772661283, 'psi': 0.9960228774165456}-{'f1_val': 0.9961336749133093, 'auprc': 0.9959580874834495, 'loss_val': 0.05850086201380701, 'psi': 0.9960634399413654}
[S13] START round=40 head_norm_before_train=1.965600 (no previous merge yet)
[S13] round=40 local utility u=0.134977 metrics={'f1_val': 0.7334996916368881, 'auprc': 0.8430979851078291, 'loss_val': 0.8696565388258214, 'psi': 0.7773390090252645}-{'f1_val': 0.7123971950878971, 'auprc': 0.8311155096783072, 'loss_val': 0.9770487378659358, 'psi': 0.7598845209240612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=40 head_norm_before_train=1.407598 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.006781 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9928377203050099, 'loss_val': 0.06208770615851099, 'psi': 0.9953203881722699}-{'f1_val': 0.9971432857297993, 'auprc': 0.9928625062812919, 'loss_val': 0.07673156590082078, 'psi': 0.9954309739503964}
[S15] START round=40 head_norm_before_train=1.366159 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.8873068006748406, 'auprc': 0.9360330401640796, 'loss_val': 0.27110004654971026, 'psi': 0.9067972964705362}-{'f1_val': 0.7007659221024161, 'auprc': 0.6946508047610638, 'loss_val': 0.5130053928558582, 'psi': 0.6983198751658751}
[S16] START round=40 head_norm_before_train=2.013351 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8391733831944292, 'auprc': 0.8608450481761436, 'loss_val': 1.1180639568432813, 'psi': 0.847842049187115}-{'f1_val': 0.914360029714228, 'auprc': 0.9921944943147003, 'loss_val': 0.48455706357228345, 'psi': 0.9454938155544169}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.407374 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.8449730001999274, 'auprc': 0.9520405110788931, 'loss_val': 0.4723342383760707, 'psi': 0.8878000045515136}-{'f1_val': 0.6229384148091018, 'auprc': 0.8658454259981525, 'loss_val': 1.2293172976262376, 'psi': 0.720101219284722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:59803
[S15] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:59817
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:59816
[S3] RECEIVED delta(kind=head bytes=1805) from S2
[S3] cosine check vs S2: cos=-0.0331
[S3] DROPPED delta from S2 (cos=-0.0331 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1808) from S15
[S6] cosine check vs S15: cos=0.8638
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9976
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] ⇄ pheromone p=0.069 → S3@127.0.0.1:59803
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] ⇄ pheromone p=0.012 → S14@127.0.0.1:59814
[S15] ⇄ pheromone p=0.415 → S6@127.0.0.1:59807
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.9979
[S17] RECEIVED delta(kind=head bytes=1804) from S5
[S17] cosine check vs S5: cos=0.8543
[S4] ⇄ pheromone p=0.028 → S16@127.0.0.1:59816
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9970 head_norm=1.433028
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.133456e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9970 head_norm=1.444055 delta_norm=0.051335
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.012 → S15@127.0.0.1:59815
[S9] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S5] CommDone barrier timeout: have=0 need=1 — continuing
[S5] ⇄ pheromone p=0.162 → S17@127.0.0.1:59817
[S6] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:59808
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9928
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.8649
[S2]  timeout peer S3
[S14]  timeout peer S9
[S14]  timeout peer S15
[S15]  timeout peer S6
[S11]  timeout peer S14
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S7
[S6]  timeout peer S8
[S5]  timeout peer S4
[S5]  timeout peer S17
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S4]  timeout peer S10
[S4]  timeout peer S16
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.8091 head_norm=1.383256
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.643206e-01
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.8114 head_norm=1.347244 delta_norm=0.364321
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=2.156780 (no previous merge yet)
[S2] round=41 local utility u=0.107120 metrics={'f1_val': 0.699594258777693, 'auprc': 0.8494185917221653, 'loss_val': 0.7525944760151326, 'psi': 0.7595239919554819}-{'f1_val': 0.7136711767752654, 'auprc': 0.7990649684979088, 'loss_val': 0.9002356902441425, 'psi': 0.7478286934643228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=41 head_norm_before_train=2.167404 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8572290590605889, 'auprc': 0.9983806284106108, 'loss_val': 0.20422779349179326, 'psi': 0.9136896868005977}-{'f1_val': 0.936056037043483, 'auprc': 0.9944023649681005, 'loss_val': 0.1414041322648364, 'psi': 0.9593945682133299}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.034984 cos_to_last_merge=0.9983 (last merge round=34)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9455985768034298, 'auprc': 0.9775713093982766, 'loss_val': 0.24487601565923725, 'psi': 0.9583876698413685}-{'f1_val': 0.9519168215979429, 'auprc': 0.9792296307623243, 'loss_val': 0.2415722488028168, 'psi': 0.9628419452636955}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.304761 cos_to_last_merge=0.9992 (last merge round=39)
[S5] round=41 local utility u=0.016943 metrics={'f1_val': 0.6996771243250686, 'auprc': 0.9724943862089415, 'loss_val': 0.3604024224175516, 'psi': 0.8088040290786177}-{'f1_val': 0.7000725525005456, 'auprc': 0.9759047515295691, 'loss_val': 0.40689125957469113, 'psi': 0.810405432112155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.6997 head_norm=1.337477
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.068873e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.6841 head_norm=1.335736 delta_norm=0.106887
[S5] aggregate: ROLLBACK (f1_val pre=0.700 post=0.684 tol_abs=0.005 tol_rel=0.0)
[S6] START round=41 head_norm_before_train=1.347244 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7862260944185334, 'auprc': 0.9104408485095783, 'loss_val': 0.5223330049441226, 'psi': 0.8359119960549514}-{'f1_val': 0.809077545687287, 'auprc': 0.9379351263611136, 'loss_val': 0.48551461075339997, 'psi': 0.8606205779568177}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.483562 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6205688075127241, 'auprc': 0.7964123457894929, 'loss_val': 0.5580167110339729, 'psi': 0.6909062228234317}-{'f1_val': 0.6429934256472373, 'auprc': 0.800878341161227, 'loss_val': 0.5209837656131553, 'psi': 0.7061473918528332}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6206 head_norm=1.496764
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.798368e-01
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6275 head_norm=1.390170 delta_norm=0.379837
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] START round=41 head_norm_before_train=1.905541 cos_to_last_merge=0.7827 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9879856597199967, 'auprc': 0.9988368577582603, 'loss_val': 0.03672784043367974, 'psi': 0.9923261389353022}-{'f1_val': 0.9926726816424898, 'auprc': 0.9986867897394516, 'loss_val': 0.03059606679902887, 'psi': 0.9950783248812745}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.342529 cos_to_last_merge=0.9830 (last merge round=34)
[S9] round=41 local utility u=0.004504 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.997849564945658, 'loss_val': 0.07266865317006808, 'psi': 0.9972686830262928}-{'f1_val': 0.9968814284133827, 'auprc': 0.9980149507099341, 'loss_val': 0.08217260833256275, 'psi': 0.9973348373320032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=2.084467 cos_to_last_merge=0.8212 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=41 local utility u=0.000135 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952382737233518, 'loss_val': 0.026037391622615917, 'psi': 0.994955199714858}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952334358839925, 'loss_val': 0.026293267171238484, 'psi': 0.9949532645791144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=41 head_norm_before_train=1.456810 cos_to_last_merge=0.9894 (last merge round=34)
[S11] round=41 local utility u=0.001383 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955806090707054, 'loss_val': 0.0407960025852388, 'psi': 0.9959124485762678}-{'f1_val': 0.9961336749133093, 'auprc': 0.9958566811714001, 'loss_val': 0.04438955772661283, 'psi': 0.9960228774165456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=41 head_norm_before_train=1.973232 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6522018065367234, 'auprc': 0.8711544495999259, 'loss_val': 0.9662214808458427, 'psi': 0.7397828637620045}-{'f1_val': 0.7334996916368881, 'auprc': 0.8430979851078291, 'loss_val': 0.8696565388258214, 'psi': 0.7773390090252645}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.444055 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.002068 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9929810043328839, 'loss_val': 0.0608460355547111, 'psi': 0.9956241587219025}-{'f1_val': 0.9969755000837764, 'auprc': 0.9928377203050099, 'loss_val': 0.06208770615851099, 'psi': 0.9953203881722699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=41 head_norm_before_train=1.407904 cos_to_last_merge=0.9993 (last merge round=39)
[S15] round=41 local utility u=0.307983 metrics={'f1_val': 0.9403708607887716, 'auprc': 0.9892437639665519, 'loss_val': 0.13314979918095687, 'psi': 0.9599200220598837}-{'f1_val': 0.8873068006748406, 'auprc': 0.9360330401640796, 'loss_val': 0.27110004654971026, 'psi': 0.9067972964705362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=41 head_norm_before_train=2.017712 cos_to_last_merge=0.9999 (last merge round=37)
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.9918544720135772, 'auprc': 0.9939349814938501, 'loss_val': 0.04488709395045936, 'psi': 0.9926866758056865}-{'f1_val': 0.8391733831944292, 'auprc': 0.8608450481761436, 'loss_val': 1.1180639568432813, 'psi': 0.847842049187115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9919 head_norm=2.023764
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.805523e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9919 head_norm=2.028240 delta_norm=0.068055
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] START round=41 head_norm_before_train=1.434147 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.7915980324584373, 'auprc': 0.8550906705535326, 'loss_val': 0.6380755401082375, 'psi': 0.8169950876964754}-{'f1_val': 0.8449730001999274, 'auprc': 0.9520405110788931, 'loss_val': 0.4723342383760707, 'psi': 0.8878000045515136}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.7916 head_norm=1.493050
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.000766e-01
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.8040 head_norm=1.343778 delta_norm=0.400077
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.167033 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7068893179769652, 'auprc': 0.7957946517533339, 'loss_val': 0.8751847624118246, 'psi': 0.7424514514875127}-{'f1_val': 0.699594258777693, 'auprc': 0.8494185917221653, 'loss_val': 0.7525944760151326, 'psi': 0.7595239919554819}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.176832 (no previous merge yet)
[S3] round=42 local utility u=0.386763 metrics={'f1_val': 0.9651566880712075, 'auprc': 0.9991167789374767, 'loss_val': 0.0804751665667448, 'psi': 0.9787407244177151}-{'f1_val': 0.8572290590605889, 'auprc': 0.9983806284106108, 'loss_val': 0.20422779349179326, 'psi': 0.9136896868005977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=42 head_norm_before_train=2.048213 cos_to_last_merge=0.9978 (last merge round=34)
[S4] round=42 local utility u=0.033783 metrics={'f1_val': 0.9516148533982848, 'auprc': 0.9863857504977206, 'loss_val': 0.23985095433162124, 'psi': 0.965523212238059}-{'f1_val': 0.9455985768034298, 'auprc': 0.9775713093982766, 'loss_val': 0.24487601565923725, 'psi': 0.9583876698413685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=42 head_norm_before_train=1.335736 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6434735027903291, 'auprc': 0.9336037561588167, 'loss_val': 0.47978764553167175, 'psi': 0.7595256041377241}-{'f1_val': 0.6996771243250686, 'auprc': 0.9724943862089415, 'loss_val': 0.3604024224175516, 'psi': 0.8088040290786177}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.365076 cos_to_last_merge=0.9998 (last merge round=40)
[S6] round=42 local utility u=0.720725 metrics={'f1_val': 0.9621325241164048, 'auprc': 0.9245702493893435, 'loss_val': 0.17871075515720036, 'psi': 0.9471076142255803}-{'f1_val': 0.7862260944185334, 'auprc': 0.9104408485095783, 'loss_val': 0.5223330049441226, 'psi': 0.8359119960549514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=42 head_norm_before_train=1.390170 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5757824145620865, 'auprc': 0.7863006827285421, 'loss_val': 0.6987624402378263, 'psi': 0.6599897218286688}-{'f1_val': 0.6205688075127241, 'auprc': 0.7964123457894929, 'loss_val': 0.5580167110339729, 'psi': 0.6909062228234317}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.914187 cos_to_last_merge=0.7815 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.782
[S8] round=42 local utility u=0.014006 metrics={'f1_val': 0.9918662256905537, 'auprc': 0.9987101443620703, 'loss_val': 0.031618537550572944, 'psi': 0.9946037931591603}-{'f1_val': 0.9879856597199967, 'auprc': 0.9988368577582603, 'loss_val': 0.03672784043367974, 'psi': 0.9923261389353022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=42 head_norm_before_train=1.372022 cos_to_last_merge=0.9796 (last merge round=34)
[S9] round=42 local utility u=0.004425 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9978551616390698, 'loss_val': 0.06383629269279606, 'psi': 0.9972709217036575}-{'f1_val': 0.9968814284133827, 'auprc': 0.997849564945658, 'loss_val': 0.07266865317006808, 'psi': 0.9972686830262928}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=42 head_norm_before_train=2.088812 cos_to_last_merge=0.8211 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=42 local utility u=0.000084 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952403352482824, 'loss_val': 0.025875166239495453, 'psi': 0.9949560243248303}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952382737233518, 'loss_val': 0.026037391622615917, 'psi': 0.994955199714858}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=42 head_norm_before_train=1.481046 cos_to_last_merge=0.9878 (last merge round=34)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9945657424120393, 'loss_val': 0.03922155240936234, 'psi': 0.9955065019128013}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955806090707054, 'loss_val': 0.0407960025852388, 'psi': 0.9959124485762678}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.981989 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6439438361351013, 'auprc': 0.7443593408071772, 'loss_val': 1.0491271192647695, 'psi': 0.6841100380039318}-{'f1_val': 0.6522018065367234, 'auprc': 0.8711544495999259, 'loss_val': 0.9662214808458427, 'psi': 0.7397828637620045}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.465963 cos_to_last_merge=0.9999 (last merge round=40)
[S14] round=42 local utility u=0.003304 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9937543767059105, 'loss_val': 0.0540944908273117, 'psi': 0.9956870507326301}-{'f1_val': 0.9973862616479148, 'auprc': 0.9929810043328839, 'loss_val': 0.0608460355547111, 'psi': 0.9956241587219025}
[S14] not sending this round → trigger blocked (psi=0.996)
[S15] START round=42 head_norm_before_train=1.459204 cos_to_last_merge=0.9971 (last merge round=39)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7031613197293327, 'auprc': 0.7659232725163099, 'loss_val': 0.5031881187713974, 'psi': 0.7282661008441236}-{'f1_val': 0.9403708607887716, 'auprc': 0.9892437639665519, 'loss_val': 0.13314979918095687, 'psi': 0.9599200220598837}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.028240 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9913886302203437, 'auprc': 0.9922007990737085, 'loss_val': 0.045687836991159005, 'psi': 0.9917134977616897}-{'f1_val': 0.9918544720135772, 'auprc': 0.9939349814938501, 'loss_val': 0.04488709395045936, 'psi': 0.9926866758056865}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.343778 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.692649880358112, 'auprc': 0.8657532175951339, 'loss_val': 0.7822783797022402, 'psi': 0.7618912152529208}-{'f1_val': 0.7915980324584373, 'auprc': 0.8550906705535326, 'loss_val': 0.6380755401082375, 'psi': 0.8169950876964754}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.174216 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7171924183359504, 'auprc': 0.7892347597372079, 'loss_val': 0.9815362173781035, 'psi': 0.7460093548964534}-{'f1_val': 0.7068893179769652, 'auprc': 0.7957946517533339, 'loss_val': 0.8751847624118246, 'psi': 0.7424514514875127}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.185934 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8160850446761814, 'auprc': 0.9974666920423387, 'loss_val': 0.32091663711288215, 'psi': 0.8886377036226443}-{'f1_val': 0.9651566880712075, 'auprc': 0.9991167789374767, 'loss_val': 0.0804751665667448, 'psi': 0.9787407244177151}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.062916 cos_to_last_merge=0.9972 (last merge round=34)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9530323200660518, 'auprc': 0.9813079170205139, 'loss_val': 0.24097818360729725, 'psi': 0.9643425588478367}-{'f1_val': 0.9516148533982848, 'auprc': 0.9863857504977206, 'loss_val': 0.23985095433162124, 'psi': 0.965523212238059}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.365663 cos_to_last_merge=0.9991 (last merge round=41)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.5713833713776401, 'auprc': 0.8907279994781034, 'loss_val': 0.674414891593966, 'psi': 0.6991212226178254}-{'f1_val': 0.6434735027903291, 'auprc': 0.9336037561588167, 'loss_val': 0.47978764553167175, 'psi': 0.7595256041377241}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.379015 cos_to_last_merge=0.9994 (last merge round=40)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7413178232868076, 'auprc': 0.8954237720160351, 'loss_val': 0.6437006405669766, 'psi': 0.8029602027784986}-{'f1_val': 0.9621325241164048, 'auprc': 0.9245702493893435, 'loss_val': 0.17871075515720036, 'psi': 0.9471076142255803}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.406151 cos_to_last_merge=0.9999 (last merge round=41)
[S7] round=43 local utility u=0.395529 metrics={'f1_val': 0.6623087022519238, 'auprc': 0.8098188592676451, 'loss_val': 0.49741764616327766, 'psi': 0.7213127650582123}-{'f1_val': 0.5757824145620865, 'auprc': 0.7863006827285421, 'loss_val': 0.6987624402378263, 'psi': 0.6599897218286688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=43 head_norm_before_train=1.919216 cos_to_last_merge=0.7809 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9873357230435704, 'auprc': 0.9990069518492701, 'loss_val': 0.04016289092139743, 'psi': 0.9920042145658503}-{'f1_val': 0.9918662256905537, 'auprc': 0.9987101443620703, 'loss_val': 0.031618537550572944, 'psi': 0.9946037931591603}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.398914 cos_to_last_merge=0.9764 (last merge round=34)
[S9] round=43 local utility u=0.001774 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9969376818977557, 'loss_val': 0.05753658896297937, 'psi': 0.9969039298071318}-{'f1_val': 0.9968814284133827, 'auprc': 0.9978551616390698, 'loss_val': 0.06383629269279606, 'psi': 0.9972709217036575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=2.096481 cos_to_last_merge=0.8207 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=43 local utility u=0.001252 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9952083905295306, 'loss_val': 0.025732085078619214, 'psi': 0.9951888600461204}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952403352482824, 'loss_val': 0.025875166239495453, 'psi': 0.9949560243248303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=43 head_norm_before_train=1.502879 cos_to_last_merge=0.9864 (last merge round=34)
[S11] round=43 local utility u=0.000552 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9945987195690652, 'loss_val': 0.03821722325320915, 'psi': 0.9955196927756117}-{'f1_val': 0.9961336749133093, 'auprc': 0.9945657424120393, 'loss_val': 0.03922155240936234, 'psi': 0.9955065019128013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.989251 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6209757960895752, 'auprc': 0.6955585457109517, 'loss_val': 1.2665349805732153, 'psi': 0.6508088959381257}-{'f1_val': 0.6439438361351013, 'auprc': 0.7443593408071772, 'loss_val': 1.0491271192647695, 'psi': 0.6841100380039318}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.486086 cos_to_last_merge=0.9997 (last merge round=40)
[S14] round=43 local utility u=0.002046 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.995942568264355, 'loss_val': 0.05264809438684783, 'psi': 0.9961703757006484}-{'f1_val': 0.9969755000837764, 'auprc': 0.9937543767059105, 'loss_val': 0.0540944908273117, 'psi': 0.9956870507326301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=43 head_norm_before_train=1.499563 cos_to_last_merge=0.9948 (last merge round=39)
[S15] round=43 local utility u=0.439250 metrics={'f1_val': 0.7773426321231297, 'auprc': 0.8827593889954297, 'loss_val': 0.42028362197102237, 'psi': 0.8195093348720497}-{'f1_val': 0.7031613197293327, 'auprc': 0.7659232725163099, 'loss_val': 0.5031881187713974, 'psi': 0.7282661008441236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=43 head_norm_before_train=2.031348 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9677503616238248, 'auprc': 0.9934170468721961, 'loss_val': 0.11077016008674563, 'psi': 0.9780170357231733}-{'f1_val': 0.9913886302203437, 'auprc': 0.9922007990737085, 'loss_val': 0.045687836991159005, 'psi': 0.9917134977616897}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.412476 cos_to_last_merge=0.9985 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6225180920995327, 'auprc': 0.8717166278855826, 'loss_val': 1.0005465558970537, 'psi': 0.7221975064139526}-{'f1_val': 0.692649880358112, 'auprc': 0.8657532175951339, 'loss_val': 0.7822783797022402, 'psi': 0.7618912152529208}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.180746 (no previous merge yet)
[S2] round=44 local utility u=0.077662 metrics={'f1_val': 0.7125426425277684, 'auprc': 0.808810345739284, 'loss_val': 0.8570408188160065, 'psi': 0.7510497238123747}-{'f1_val': 0.7171924183359504, 'auprc': 0.7892347597372079, 'loss_val': 0.9815362173781035, 'psi': 0.7460093548964534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=44 head_norm_before_train=2.193585 (no previous merge yet)
[S3] round=44 local utility u=0.038621 metrics={'f1_val': 0.8172274325431073, 'auprc': 0.9985182154373546, 'loss_val': 0.25368265165819537, 'psi': 0.8897437457008062}-{'f1_val': 0.8160850446761814, 'auprc': 0.9974666920423387, 'loss_val': 0.32091663711288215, 'psi': 0.8886377036226443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=44 head_norm_before_train=2.073066 cos_to_last_merge=0.9967 (last merge round=34)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9505917826496091, 'auprc': 0.9809554751400855, 'loss_val': 0.23869345106698672, 'psi': 0.9627372596457997}-{'f1_val': 0.9530323200660518, 'auprc': 0.9813079170205139, 'loss_val': 0.24097818360729725, 'psi': 0.9643425588478367}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.395773 cos_to_last_merge=0.9971 (last merge round=41)
[S5] round=44 local utility u=0.595559 metrics={'f1_val': 0.6777200311864529, 'auprc': 0.9716115625290618, 'loss_val': 0.3639668739391815, 'psi': 0.7952766437234964}-{'f1_val': 0.5713833713776401, 'auprc': 0.8907279994781034, 'loss_val': 0.674414891593966, 'psi': 0.6991212226178254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=44 head_norm_before_train=1.391415 cos_to_last_merge=0.9988 (last merge round=40)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.5887330932674782, 'auprc': 0.7812890265763781, 'loss_val': 0.9278830973783998, 'psi': 0.6657554665910382}-{'f1_val': 0.7413178232868076, 'auprc': 0.8954237720160351, 'loss_val': 0.6437006405669766, 'psi': 0.8029602027784986}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.424538 cos_to_last_merge=0.9994 (last merge round=41)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6589852633757224, 'auprc': 0.8044747737927626, 'loss_val': 0.5099219470037155, 'psi': 0.7171810675425385}-{'f1_val': 0.6623087022519238, 'auprc': 0.8098188592676451, 'loss_val': 0.49741764616327766, 'psi': 0.7213127650582123}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.923277 cos_to_last_merge=0.7801 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.780
[S8] round=44 local utility u=0.007704 metrics={'f1_val': 0.9890474964285507, 'auprc': 0.9987882693976384, 'loss_val': 0.03436943445548758, 'psi': 0.9929438056161858}-{'f1_val': 0.9873357230435704, 'auprc': 0.9990069518492701, 'loss_val': 0.04016289092139743, 'psi': 0.9920042145658503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=44 head_norm_before_train=1.424000 cos_to_last_merge=0.9736 (last merge round=34)
[S9] round=44 local utility u=0.003963 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9980983046362133, 'loss_val': 0.05309237491244586, 'psi': 0.9973681789025148}-{'f1_val': 0.9968814284133827, 'auprc': 0.9969376818977557, 'loss_val': 0.05753658896297937, 'psi': 0.9969039298071318}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=44 head_norm_before_train=2.107029 cos_to_last_merge=0.8202 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.995222268479706, 'loss_val': 0.02527276631262201, 'psi': 0.9949487976173997}-{'f1_val': 0.995175839723847, 'auprc': 0.9952083905295306, 'loss_val': 0.025732085078619214, 'psi': 0.9951888600461204}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.522786 cos_to_last_merge=0.9851 (last merge round=34)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9742168315296109, 'auprc': 0.9961969446500314, 'loss_val': 0.09429368996086723, 'psi': 0.9830088767777792}-{'f1_val': 0.9961336749133093, 'auprc': 0.9945987195690652, 'loss_val': 0.03821722325320915, 'psi': 0.9955196927756117}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.993314 (no previous merge yet)
[S13] round=44 local utility u=0.702136 metrics={'f1_val': 0.729479871810319, 'auprc': 0.8196762039682095, 'loss_val': 0.8856406489772959, 'psi': 0.7655584046734752}-{'f1_val': 0.6209757960895752, 'auprc': 0.6955585457109517, 'loss_val': 1.2665349805732153, 'psi': 0.6508088959381257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=44 head_norm_before_train=1.504151 cos_to_last_merge=0.9995 (last merge round=40)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9934843477808759, 'loss_val': 0.05588788053404218, 'psi': 0.995433253611747}-{'f1_val': 0.9963222473248441, 'auprc': 0.995942568264355, 'loss_val': 0.05264809438684783, 'psi': 0.9961703757006484}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.536520 cos_to_last_merge=0.9923 (last merge round=39)
[S15] round=44 local utility u=0.752230 metrics={'f1_val': 0.9266266688136102, 'auprc': 0.99197160366452, 'loss_val': 0.139163586908955, 'psi': 0.9527646427539742}-{'f1_val': 0.7773426321231297, 'auprc': 0.8827593889954297, 'loss_val': 0.42028362197102237, 'psi': 0.8195093348720497}
[S15] not sending this round → trigger blocked (psi=0.953)
[S16] START round=44 head_norm_before_train=2.037374 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9293699156275386, 'auprc': 0.9873718181332147, 'loss_val': 0.4112431887381686, 'psi': 0.952570676629809}-{'f1_val': 0.9677503616238248, 'auprc': 0.9934170468721961, 'loss_val': 0.11077016008674563, 'psi': 0.9780170357231733}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.499832 cos_to_last_merge=0.9935 (last merge round=41)
[S17] round=44 local utility u=0.893692 metrics={'f1_val': 0.8304068850396134, 'auprc': 0.9076675840939934, 'loss_val': 0.5683482406016288, 'psi': 0.8613111646613654}-{'f1_val': 0.6225180920995327, 'auprc': 0.8717166278855826, 'loss_val': 1.0005465558970537, 'psi': 0.7221975064139526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=2.190786 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6456137743566199, 'auprc': 0.8012271804736085, 'loss_val': 1.3817261534759868, 'psi': 0.7078591368034154}-{'f1_val': 0.7125426425277684, 'auprc': 0.808810345739284, 'loss_val': 0.8570408188160065, 'psi': 0.7510497238123747}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.200281 (no previous merge yet)
[S3] round=45 local utility u=0.193325 metrics={'f1_val': 0.870120297635362, 'auprc': 0.9985942890185616, 'loss_val': 0.18461828448950918, 'psi': 0.9215098941886419}-{'f1_val': 0.8172274325431073, 'auprc': 0.9985182154373546, 'loss_val': 0.25368265165819537, 'psi': 0.8897437457008062}
[S3] not sending this round → trigger blocked (psi=0.922)
[S4] START round=45 head_norm_before_train=2.084589 cos_to_last_merge=0.9962 (last merge round=34)
[S4] round=45 local utility u=0.006957 metrics={'f1_val': 0.9531416755348768, 'auprc': 0.9834743215026868, 'loss_val': 0.24763537383571713, 'psi': 0.9652747339220009}-{'f1_val': 0.9505917826496091, 'auprc': 0.9809554751400855, 'loss_val': 0.23869345106698672, 'psi': 0.9627372596457997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=45 head_norm_before_train=1.420466 cos_to_last_merge=0.9947 (last merge round=41)
[S5] round=45 local utility u=0.148034 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9936440472669208, 'loss_val': 0.26960476575702186, 'psi': 0.8176504093671166}-{'f1_val': 0.6777200311864529, 'auprc': 0.9716115625290618, 'loss_val': 0.3639668739391815, 'psi': 0.7952766437234964}
[S5] not sending this round → trigger blocked (psi=0.818)
[S6] START round=45 head_norm_before_train=1.405191 cos_to_last_merge=0.9979 (last merge round=40)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9629112722426998, 'auprc': 0.936804883581689, 'loss_val': 0.1743872060586171, 'psi': 0.9524687167782955}-{'f1_val': 0.5887330932674782, 'auprc': 0.7812890265763781, 'loss_val': 0.9278830973783998, 'psi': 0.6657554665910382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=45 head_norm_before_train=1.438844 cos_to_last_merge=0.9992 (last merge round=41)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6180411826793503, 'auprc': 0.7953739663625565, 'loss_val': 0.5582118671186995, 'psi': 0.6889742961526328}-{'f1_val': 0.6589852633757224, 'auprc': 0.8044747737927626, 'loss_val': 0.5099219470037155, 'psi': 0.7171810675425385}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.930867 cos_to_last_merge=0.7793 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.779
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.983027569283401, 'auprc': 0.9987766592017572, 'loss_val': 0.051415632901072296, 'psi': 0.9893272052507435}-{'f1_val': 0.9890474964285507, 'auprc': 0.9987882693976384, 'loss_val': 0.03436943445548758, 'psi': 0.9929438056161858}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.447122 cos_to_last_merge=0.9710 (last merge round=34)
[S9] round=45 local utility u=0.000589 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9969129187622467, 'loss_val': 0.048357888809669104, 'psi': 0.9968940245529283}-{'f1_val': 0.9968814284133827, 'auprc': 0.9980983046362133, 'loss_val': 0.05309237491244586, 'psi': 0.9973681789025148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=45 head_norm_before_train=2.117913 cos_to_last_merge=0.8197 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951375509799145, 'loss_val': 0.025894671111576, 'psi': 0.9949149106174832}-{'f1_val': 0.9947664837091956, 'auprc': 0.995222268479706, 'loss_val': 0.02527276631262201, 'psi': 0.9949487976173997}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.539990 cos_to_last_merge=0.9841 (last merge round=34)
[S11] round=45 local utility u=0.096027 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9958783271569264, 'loss_val': 0.03278451549728038, 'psi': 0.9960315358107561}-{'f1_val': 0.9742168315296109, 'auprc': 0.9961969446500314, 'loss_val': 0.09429368996086723, 'psi': 0.9830088767777792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=45 head_norm_before_train=2.001925 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6968571860038811, 'auprc': 0.8158061294559608, 'loss_val': 0.8095102001520982, 'psi': 0.744436763384713}-{'f1_val': 0.729479871810319, 'auprc': 0.8196762039682095, 'loss_val': 0.8856406489772959, 'psi': 0.7655584046734752}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.518266 cos_to_last_merge=0.9992 (last merge round=40)
[S14] round=45 local utility u=0.003113 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9943744311323521, 'loss_val': 0.049869791721929374, 'psi': 0.9955431208478472}-{'f1_val': 0.9967325241656609, 'auprc': 0.9934843477808759, 'loss_val': 0.05588788053404218, 'psi': 0.995433253611747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=45 head_norm_before_train=1.571576 cos_to_last_merge=0.9897 (last merge round=39)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8234967465331702, 'auprc': 0.901682324702183, 'loss_val': 0.3704789979979456, 'psi': 0.8547709778007753}-{'f1_val': 0.9266266688136102, 'auprc': 0.99197160366452, 'loss_val': 0.139163586908955, 'psi': 0.9527646427539742}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.041749 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8437368183396372, 'auprc': 0.8504917660230121, 'loss_val': 1.135136342103332, 'psi': 0.8464387974129871}-{'f1_val': 0.9293699156275386, 'auprc': 0.9873718181332147, 'loss_val': 0.4112431887381686, 'psi': 0.952570676629809}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.578445 cos_to_last_merge=0.9883 (last merge round=41)
[S17] round=45 local utility u=0.249344 metrics={'f1_val': 0.8872465187559716, 'auprc': 0.9160674831573874, 'loss_val': 0.43589736188067923, 'psi': 0.8987749045165379}-{'f1_val': 0.8304068850396134, 'auprc': 0.9076675840939934, 'loss_val': 0.5683482406016288, 'psi': 0.8613111646613654}
[S17] not sending this round → trigger blocked (psi=0.899)
[S2] START round=46 head_norm_before_train=2.200823 (no previous merge yet)
[S2] round=46 local utility u=0.455333 metrics={'f1_val': 0.7129279485131552, 'auprc': 0.8213219186975953, 'loss_val': 0.9352284693113196, 'psi': 0.7562855365869312}-{'f1_val': 0.6456137743566199, 'auprc': 0.8012271804736085, 'loss_val': 1.3817261534759868, 'psi': 0.7078591368034154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=2.207688 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.7629127911500435, 'auprc': 0.9929286859979276, 'loss_val': 0.309194854514548, 'psi': 0.8549191490891972}-{'f1_val': 0.870120297635362, 'auprc': 0.9985942890185616, 'loss_val': 0.18461828448950918, 'psi': 0.9215098941886419}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.093797 cos_to_last_merge=0.9957 (last merge round=34)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9517510492794442, 'auprc': 0.9720308570821232, 'loss_val': 0.26873203351813146, 'psi': 0.9598629724005159}-{'f1_val': 0.9531416755348768, 'auprc': 0.9834743215026868, 'loss_val': 0.24763537383571713, 'psi': 0.9652747339220009}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.443409 cos_to_last_merge=0.9921 (last merge round=41)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.5824331044353102, 'auprc': 0.7844472553147286, 'loss_val': 0.6818434210060649, 'psi': 0.6632387647870774}-{'f1_val': 0.7003213174339138, 'auprc': 0.9936440472669208, 'loss_val': 0.26960476575702186, 'psi': 0.8176504093671166}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.418186 cos_to_last_merge=0.9972 (last merge round=40)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7814074020710523, 'auprc': 0.9313331401970024, 'loss_val': 0.5729188212255963, 'psi': 0.8413776973214324}-{'f1_val': 0.9629112722426998, 'auprc': 0.936804883581689, 'loss_val': 0.1743872060586171, 'psi': 0.9524687167782955}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.455811 cos_to_last_merge=0.9987 (last merge round=41)
[S7] round=46 local utility u=0.166399 metrics={'f1_val': 0.654216884241173, 'auprc': 0.8062160856229492, 'loss_val': 0.4749946109279505, 'psi': 0.7150165647938835}-{'f1_val': 0.6180411826793503, 'auprc': 0.7953739663625565, 'loss_val': 0.5582118671186995, 'psi': 0.6889742961526328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=46 head_norm_before_train=1.939499 cos_to_last_merge=0.7781 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=46 local utility u=0.020866 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9986364099967391, 'loss_val': 0.03819990894178302, 'psi': 0.9921647714464172}-{'f1_val': 0.983027569283401, 'auprc': 0.9987766592017572, 'loss_val': 0.051415632901072296, 'psi': 0.9893272052507435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=46 head_norm_before_train=1.468651 cos_to_last_merge=0.9686 (last merge round=34)
[S9] round=46 local utility u=0.003495 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.998308081239457, 'loss_val': 0.045553204917247535, 'psi': 0.9974520895438124}-{'f1_val': 0.9968814284133827, 'auprc': 0.9969129187622467, 'loss_val': 0.048357888809669104, 'psi': 0.9968940245529283}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=46 head_norm_before_train=2.121593 cos_to_last_merge=0.8195 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=46 local utility u=0.000265 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952381941039026, 'loss_val': 0.025666048041133108, 'psi': 0.9949551678670784}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951375509799145, 'loss_val': 0.025894671111576, 'psi': 0.9949149106174832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=46 head_norm_before_train=1.553089 cos_to_last_merge=0.9832 (last merge round=34)
[S11] round=46 local utility u=0.000105 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955014803475395, 'loss_val': 0.03144351735015861, 'psi': 0.9958807970870014}-{'f1_val': 0.9961336749133093, 'auprc': 0.9958783271569264, 'loss_val': 0.03278451549728038, 'psi': 0.9960315358107561}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=46 head_norm_before_train=2.008655 (no previous merge yet)
[S13] round=46 local utility u=0.083480 metrics={'f1_val': 0.7364317314838329, 'auprc': 0.8235695298411139, 'loss_val': 0.9032866744994502, 'psi': 0.7712868508267452}-{'f1_val': 0.6968571860038811, 'auprc': 0.8158061294559608, 'loss_val': 0.8095102001520982, 'psi': 0.744436763384713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=46 head_norm_before_train=1.529306 cos_to_last_merge=0.9989 (last merge round=40)
[S14] round=46 local utility u=0.004380 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9962763566937081, 'loss_val': 0.046816377329780626, 'psi': 0.9963038910723896}-{'f1_val': 0.9963222473248441, 'auprc': 0.9943744311323521, 'loss_val': 0.049869791721929374, 'psi': 0.9955431208478472}
[S14] not sending this round → trigger blocked (psi=0.996)
[S15] START round=46 head_norm_before_train=1.604974 cos_to_last_merge=0.9873 (last merge round=39)
[S15] round=46 local utility u=0.813593 metrics={'f1_val': 0.9935563565899633, 'auprc': 0.9968212427901695, 'loss_val': 0.04906762210965771, 'psi': 0.9948623110700459}-{'f1_val': 0.8234967465331702, 'auprc': 0.901682324702183, 'loss_val': 0.3704789979979456, 'psi': 0.8547709778007753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=46 head_norm_before_train=2.047475 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=46 local utility u=1.000000 metrics={'f1_val': 0.9492088469833924, 'auprc': 0.9864355448290432, 'loss_val': 0.15770737250959077, 'psi': 0.9640995261216527}-{'f1_val': 0.8437368183396372, 'auprc': 0.8504917660230121, 'loss_val': 1.135136342103332, 'psi': 0.8464387974129871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=46 head_norm_before_train=1.635983 cos_to_last_merge=0.9840 (last merge round=41)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7854112669606632, 'auprc': 0.8876197202271078, 'loss_val': 0.7683439870979174, 'psi': 0.8262946482672411}-{'f1_val': 0.8872465187559716, 'auprc': 0.9160674831573874, 'loss_val': 0.43589736188067923, 'psi': 0.8987749045165379}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.205240 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7160761172232425, 'auprc': 0.8074335483346635, 'loss_val': 0.9711097375873738, 'psi': 0.7526190896678109}-{'f1_val': 0.7129279485131552, 'auprc': 0.8213219186975953, 'loss_val': 0.9352284693113196, 'psi': 0.7562855365869312}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.213296 (no previous merge yet)
[S3] round=47 local utility u=0.655343 metrics={'f1_val': 0.9533191007137912, 'auprc': 0.9994739240065668, 'loss_val': 0.1605815166621683, 'psi': 0.9717810300309015}-{'f1_val': 0.7629127911500435, 'auprc': 0.9929286859979276, 'loss_val': 0.309194854514548, 'psi': 0.8549191490891972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=2.101912 cos_to_last_merge=0.9953 (last merge round=34)
[S4] round=47 local utility u=0.004690 metrics={'f1_val': 0.9461506211781141, 'auprc': 0.9783767747291723, 'loss_val': 0.24478797184617038, 'psi': 0.9590410825985374}-{'f1_val': 0.9517510492794442, 'auprc': 0.9720308570821232, 'loss_val': 0.26873203351813146, 'psi': 0.9598629724005159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=47 head_norm_before_train=1.461805 cos_to_last_merge=0.9897 (last merge round=41)
[S5] round=47 local utility u=0.873018 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9912750195278441, 'loss_val': 0.26361596219262745, 'psi': 0.816702366905953}-{'f1_val': 0.5824331044353102, 'auprc': 0.7844472553147286, 'loss_val': 0.6818434210060649, 'psi': 0.6632387647870774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.436230 cos_to_last_merge=0.9959 (last merge round=40)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.779772655643971, 'auprc': 0.9318912069568148, 'loss_val': 0.5796169725846086, 'psi': 0.8406200761691085}-{'f1_val': 0.7814074020710523, 'auprc': 0.9313331401970024, 'loss_val': 0.5729188212255963, 'psi': 0.8413776973214324}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.473112 cos_to_last_merge=0.9980 (last merge round=41)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6511538536592953, 'auprc': 0.8055339164877555, 'loss_val': 0.5306578069241225, 'psi': 0.7129058787906795}-{'f1_val': 0.654216884241173, 'auprc': 0.8062160856229492, 'loss_val': 0.4749946109279505, 'psi': 0.7150165647938835}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.941177 cos_to_last_merge=0.7774 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=47 local utility u=0.019879 metrics={'f1_val': 0.9928171484960187, 'auprc': 0.9990206074070068, 'loss_val': 0.029394406658011574, 'psi': 0.9952985320604139}-{'f1_val': 0.9878503457462027, 'auprc': 0.9986364099967391, 'loss_val': 0.03819990894178302, 'psi': 0.9921647714464172}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=47 head_norm_before_train=1.487080 cos_to_last_merge=0.9666 (last merge round=34)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9962072430363659, 'loss_val': 0.042918550727570205, 'psi': 0.9966117542625759}-{'f1_val': 0.9968814284133827, 'auprc': 0.998308081239457, 'loss_val': 0.045553204917247535, 'psi': 0.9974520895438124}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.129977 cos_to_last_merge=0.8191 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=47 local utility u=0.000103 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952370066231551, 'loss_val': 0.025456836298263456, 'psi': 0.9949546928747794}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952381941039026, 'loss_val': 0.025666048041133108, 'psi': 0.9949551678670784}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=47 head_norm_before_train=1.566415 cos_to_last_merge=0.9823 (last merge round=34)
[S11] round=47 local utility u=0.001734 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962686572354774, 'loss_val': 0.030277036970378417, 'psi': 0.9961876678421766}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955014803475395, 'loss_val': 0.03144351735015861, 'psi': 0.9958807970870014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=47 head_norm_before_train=2.017532 (no previous merge yet)
[S13] round=47 local utility u=0.020157 metrics={'f1_val': 0.7324238187865701, 'auprc': 0.8315165873006269, 'loss_val': 0.8627666553832093, 'psi': 0.7720609261921929}-{'f1_val': 0.7364317314838329, 'auprc': 0.8235695298411139, 'loss_val': 0.9032866744994502, 'psi': 0.7712868508267452}
[S13] not sending this round → trigger blocked (psi=0.772)
[S14] START round=47 head_norm_before_train=1.540356 cos_to_last_merge=0.9985 (last merge round=40)
[S14] round=47 local utility u=0.000544 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9951013861258923, 'loss_val': 0.04466496611332014, 'psi': 0.9960800689497534}-{'f1_val': 0.9963222473248441, 'auprc': 0.9962763566937081, 'loss_val': 0.046816377329780626, 'psi': 0.9963038910723896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=1.636222 cos_to_last_merge=0.9850 (last merge round=39)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9004132281345276, 'loss_val': 0.5459792623056632, 'psi': 0.7806248445152607}-{'f1_val': 0.9935563565899633, 'auprc': 0.9968212427901695, 'loss_val': 0.04906762210965771, 'psi': 0.9948623110700459}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.052935 cos_to_last_merge=0.9998 (last merge round=41)
[S16] round=47 local utility u=0.196532 metrics={'f1_val': 0.992564970562885, 'auprc': 0.9907646371744666, 'loss_val': 0.03776788734422483, 'psi': 0.9918448372075176}-{'f1_val': 0.9492088469833924, 'auprc': 0.9864355448290432, 'loss_val': 0.15770737250959077, 'psi': 0.9640995261216527}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=47 head_norm_before_train=1.673680 cos_to_last_merge=0.9810 (last merge round=41)
[S17] round=47 local utility u=0.528656 metrics={'f1_val': 0.8900132184371148, 'auprc': 0.9223116562146649, 'loss_val': 0.44271889727816605, 'psi': 0.9029325935481348}-{'f1_val': 0.7854112669606632, 'auprc': 0.8876197202271078, 'loss_val': 0.7683439870979174, 'psi': 0.8262946482672411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=48 head_norm_before_train=2.209339 (no previous merge yet)
[S2] round=48 local utility u=0.053397 metrics={'f1_val': 0.7141051027199552, 'auprc': 0.8201723768968079, 'loss_val': 0.8907059136063148, 'psi': 0.7565320123906962}-{'f1_val': 0.7160761172232425, 'auprc': 0.8074335483346635, 'loss_val': 0.9711097375873738, 'psi': 0.7526190896678109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=2.219593 (no previous merge yet)
[S3] round=48 local utility u=0.188429 metrics={'f1_val': 0.9933898129042117, 'auprc': 0.9990963598794546, 'loss_val': 0.02301486160637125, 'psi': 0.9956724316943089}-{'f1_val': 0.9533191007137912, 'auprc': 0.9994739240065668, 'loss_val': 0.1605815166621683, 'psi': 0.9717810300309015}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=48 head_norm_before_train=2.111755 cos_to_last_merge=0.9948 (last merge round=34)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9450600639516498, 'auprc': 0.9681330770938572, 'loss_val': 0.23495595374979228, 'psi': 0.9542892692085327}-{'f1_val': 0.9461506211781141, 'auprc': 0.9783767747291723, 'loss_val': 0.24478797184617038, 'psi': 0.9590410825985374}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.476650 cos_to_last_merge=0.9878 (last merge round=41)
[S5] round=48 local utility u=0.008908 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9913212673749204, 'loss_val': 0.24645601488718505, 'psi': 0.8167726527785293}-{'f1_val': 0.700320598491359, 'auprc': 0.9912750195278441, 'loss_val': 0.26361596219262745, 'psi': 0.816702366905953}
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] START round=48 head_norm_before_train=1.461487 cos_to_last_merge=0.9945 (last merge round=40)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7848534970955237, 'auprc': 0.9126236007641888, 'loss_val': 0.5971258262576511, 'psi': 0.8359615385629897}-{'f1_val': 0.779772655643971, 'auprc': 0.9318912069568148, 'loss_val': 0.5796169725846086, 'psi': 0.8406200761691085}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.486617 cos_to_last_merge=0.9973 (last merge round=41)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6444755656051973, 'auprc': 0.8053504157047806, 'loss_val': 0.5091858708377831, 'psi': 0.7088255056450306}-{'f1_val': 0.6511538536592953, 'auprc': 0.8055339164877555, 'loss_val': 0.5306578069241225, 'psi': 0.7129058787906795}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.947028 cos_to_last_merge=0.7770 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=48 local utility u=0.001919 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9987111946074085, 'loss_val': 0.027675994365994657, 'psi': 0.9954794782212479}-{'f1_val': 0.9928171484960187, 'auprc': 0.9990206074070068, 'loss_val': 0.029394406658011574, 'psi': 0.9952985320604139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=48 head_norm_before_train=1.502729 cos_to_last_merge=0.9649 (last merge round=34)
[S9] round=48 local utility u=0.002362 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9984159444822269, 'loss_val': 0.04233884815114998, 'psi': 0.9972470598979135}-{'f1_val': 0.9968814284133827, 'auprc': 0.9962072430363659, 'loss_val': 0.042918550727570205, 'psi': 0.9966117542625759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=48 head_norm_before_train=2.139572 cos_to_last_merge=0.8186 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9951875539374728, 'loss_val': 0.025441685918812542, 'psi': 0.9949349118005064}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952370066231551, 'loss_val': 0.025456836298263456, 'psi': 0.9949546928747794}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.578745 cos_to_last_merge=0.9815 (last merge round=34)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.8456494664578005, 'auprc': 0.9957495967454209, 'loss_val': 0.17198308658114622, 'psi': 0.9056895185728486}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962686572354774, 'loss_val': 0.030277036970378417, 'psi': 0.9961876678421766}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=2.020898 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.7403979879459945, 'auprc': 0.7964317395536844, 'loss_val': 0.9619322991684224, 'psi': 0.7628114885890704}-{'f1_val': 0.7324238187865701, 'auprc': 0.8315165873006269, 'loss_val': 0.8627666553832093, 'psi': 0.7720609261921929}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.550827 cos_to_last_merge=0.9982 (last merge round=40)
[S14] round=48 local utility u=0.004191 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9979653358982217, 'loss_val': 0.04241310433479159, 'psi': 0.9969794827541951}-{'f1_val': 0.9967325241656609, 'auprc': 0.9951013861258923, 'loss_val': 0.04466496611332014, 'psi': 0.9960800689497534}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=48 head_norm_before_train=1.662880 cos_to_last_merge=0.9830 (last merge round=39)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9544244217707627, 'auprc': 0.9928033452927597, 'loss_val': 0.09653319980498315, 'psi': 0.9697759911795615}-{'f1_val': 0.7007659221024161, 'auprc': 0.9004132281345276, 'loss_val': 0.5459792623056632, 'psi': 0.7806248445152607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=48 head_norm_before_train=2.057391 cos_to_last_merge=0.9998 (last merge round=41)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9901561602455946, 'auprc': 0.9881907312975454, 'loss_val': 0.05060928942731503, 'psi': 0.9893699886663749}-{'f1_val': 0.992564970562885, 'auprc': 0.9907646371744666, 'loss_val': 0.03776788734422483, 'psi': 0.9918448372075176}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.703715 cos_to_last_merge=0.9786 (last merge round=41)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6315938835640129, 'auprc': 0.8708571315095098, 'loss_val': 1.2406553069746142, 'psi': 0.7272991827422117}-{'f1_val': 0.8900132184371148, 'auprc': 0.9223116562146649, 'loss_val': 0.44271889727816605, 'psi': 0.9029325935481348}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.216526 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6932733835766061, 'auprc': 0.8292088280054293, 'loss_val': 0.8302080155229372, 'psi': 0.7476475613481354}-{'f1_val': 0.7141051027199552, 'auprc': 0.8201723768968079, 'loss_val': 0.8907059136063148, 'psi': 0.7565320123906962}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.226358 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9166223333037793, 'auprc': 0.984310289151215, 'loss_val': 0.15309505796376235, 'psi': 0.9436975156427536}-{'f1_val': 0.9933898129042117, 'auprc': 0.9990963598794546, 'loss_val': 0.02301486160637125, 'psi': 0.9956724316943089}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.116128 cos_to_last_merge=0.9944 (last merge round=34)
[S4] round=49 local utility u=0.031788 metrics={'f1_val': 0.9491099263822829, 'auprc': 0.97803475493873, 'loss_val': 0.22538405294141242, 'psi': 0.9606798578048616}-{'f1_val': 0.9450600639516498, 'auprc': 0.9681330770938572, 'loss_val': 0.23495595374979228, 'psi': 0.9542892692085327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=49 head_norm_before_train=1.489535 cos_to_last_merge=0.9861 (last merge round=41)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9837223695678086, 'loss_val': 0.2786749898005351, 'psi': 0.8137849247084149}-{'f1_val': 0.7004069097142683, 'auprc': 0.9913212673749204, 'loss_val': 0.24645601488718505, 'psi': 0.8167726527785293}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.482169 cos_to_last_merge=0.9936 (last merge round=40)
[S6] round=49 local utility u=0.322335 metrics={'f1_val': 0.8479086335426458, 'auprc': 0.9138312093116778, 'loss_val': 0.3344092482853751, 'psi': 0.8742776638502586}-{'f1_val': 0.7848534970955237, 'auprc': 0.9126236007641888, 'loss_val': 0.5971258262576511, 'psi': 0.8359615385629897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=49 head_norm_before_train=1.497053 cos_to_last_merge=0.9968 (last merge round=41)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6281684797256433, 'auprc': 0.8032064647041024, 'loss_val': 0.540121539281502, 'psi': 0.6981836737170269}-{'f1_val': 0.6444755656051973, 'auprc': 0.8053504157047806, 'loss_val': 0.5091858708377831, 'psi': 0.7088255056450306}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.955603 cos_to_last_merge=0.7767 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9880350905542497, 'auprc': 0.9990324248494361, 'loss_val': 0.03528391347485944, 'psi': 0.9924340242723242}-{'f1_val': 0.9933250006304741, 'auprc': 0.9987111946074085, 'loss_val': 0.027675994365994657, 'psi': 0.9954794782212479}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.518266 cos_to_last_merge=0.9632 (last merge round=34)
[S9] round=49 local utility u=0.002395 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9981386292822946, 'loss_val': 0.03919948836660931, 'psi': 0.9973843087609474}-{'f1_val': 0.9964678035083712, 'auprc': 0.9984159444822269, 'loss_val': 0.04233884815114998, 'psi': 0.9972470598979135}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=49 head_norm_before_train=2.141638 cos_to_last_merge=0.8184 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=49 local utility u=0.000454 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9954399451269615, 'loss_val': 0.02529144420661744, 'psi': 0.995035868276302}-{'f1_val': 0.9947664837091956, 'auprc': 0.9951875539374728, 'loss_val': 0.025441685918812542, 'psi': 0.9949349118005064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=49 head_norm_before_train=1.590416 cos_to_last_merge=0.9808 (last merge round=34)
[S11] round=49 local utility u=0.523971 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963182849586701, 'loss_val': 0.0286523490074167, 'psi': 0.9962075189314537}-{'f1_val': 0.8456494664578005, 'auprc': 0.9957495967454209, 'loss_val': 0.17198308658114622, 'psi': 0.9056895185728486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=49 head_norm_before_train=2.030234 (no previous merge yet)
[S13] round=49 local utility u=0.043665 metrics={'f1_val': 0.7378914692948675, 'auprc': 0.8137748536108405, 'loss_val': 0.9115933040391065, 'psi': 0.7682448230212566}-{'f1_val': 0.7403979879459945, 'auprc': 0.7964317395536844, 'loss_val': 0.9619322991684224, 'psi': 0.7628114885890704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=1.562040 cos_to_last_merge=0.9979 (last merge round=40)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961554288098928, 'auprc': 0.998094531366412, 'loss_val': 0.043693974350653496, 'psi': 0.9969310698325005}-{'f1_val': 0.9963222473248441, 'auprc': 0.9979653358982217, 'loss_val': 0.04241310433479159, 'psi': 0.9969794827541951}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.682208 cos_to_last_merge=0.9815 (last merge round=39)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8172538134396149, 'auprc': 0.9167477115189864, 'loss_val': 0.3957772246534874, 'psi': 0.8570513726713636}-{'f1_val': 0.9544244217707627, 'auprc': 0.9928033452927597, 'loss_val': 0.09653319980498315, 'psi': 0.9697759911795615}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.059957 cos_to_last_merge=0.9996 (last merge round=41)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8804740471958272, 'auprc': 0.9054254383162049, 'loss_val': 0.7116448206760017, 'psi': 0.8904546036439783}-{'f1_val': 0.9901561602455946, 'auprc': 0.9881907312975454, 'loss_val': 0.05060928942731503, 'psi': 0.9893699886663749}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.729263 cos_to_last_merge=0.9765 (last merge round=41)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.8761474918970411, 'auprc': 0.888269493821416, 'loss_val': 0.49674492359209305, 'psi': 0.8809962926667911}-{'f1_val': 0.6315938835640129, 'auprc': 0.8708571315095098, 'loss_val': 1.2406553069746142, 'psi': 0.7272991827422117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=50 head_norm_before_train=2.225731 (no previous merge yet)
[S2] round=50 local utility u=0.042680 metrics={'f1_val': 0.7126835603530202, 'auprc': 0.8255151862809502, 'loss_val': 0.8502274824300202, 'psi': 0.7578162107241921}-{'f1_val': 0.6932733835766061, 'auprc': 0.8292088280054293, 'loss_val': 0.8302080155229372, 'psi': 0.7476475613481354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=50 head_norm_before_train=2.233330 (no previous merge yet)
[S3] round=50 local utility u=0.006693 metrics={'f1_val': 0.9114318786804007, 'auprc': 0.9989121895730462, 'loss_val': 0.15237206966880115, 'psi': 0.9464240030374589}-{'f1_val': 0.9166223333037793, 'auprc': 0.984310289151215, 'loss_val': 0.15309505796376235, 'psi': 0.9436975156427536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=50 head_norm_before_train=2.124961 cos_to_last_merge=0.9939 (last merge round=34)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9535370754057217, 'auprc': 0.9759670456347558, 'loss_val': 0.25925846805405606, 'psi': 0.9625090634973353}-{'f1_val': 0.9491099263822829, 'auprc': 0.97803475493873, 'loss_val': 0.22538405294141242, 'psi': 0.9606798578048616}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.501280 cos_to_last_merge=0.9848 (last merge round=41)
[S5] round=50 local utility u=0.074322 metrics={'f1_val': 0.7121673464101586, 'auprc': 0.9931227009542198, 'loss_val': 0.2282771085663011, 'psi': 0.8245494882277831}-{'f1_val': 0.7004932948021524, 'auprc': 0.9837223695678086, 'loss_val': 0.2786749898005351, 'psi': 0.8137849247084149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=50 head_norm_before_train=1.502596 cos_to_last_merge=0.9927 (last merge round=40)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.46469461140752616, 'auprc': 0.6725099522026635, 'loss_val': 1.4435068550177916, 'psi': 0.5478207477255811}-{'f1_val': 0.8479086335426458, 'auprc': 0.9138312093116778, 'loss_val': 0.3344092482853751, 'psi': 0.8742776638502586}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.508435 cos_to_last_merge=0.9962 (last merge round=41)
[S7] round=50 local utility u=0.242752 metrics={'f1_val': 0.6716960692915294, 'auprc': 0.8296972300172536, 'loss_val': 0.39525528075188526, 'psi': 0.7348965335818191}-{'f1_val': 0.6281684797256433, 'auprc': 0.8032064647041024, 'loss_val': 0.540121539281502, 'psi': 0.6981836737170269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=50 head_norm_before_train=1.965973 cos_to_last_merge=0.7757 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.776
[S8] round=50 local utility u=0.018925 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9987485566576426, 'loss_val': 0.028322175418261052, 'psi': 0.9954944230413415}-{'f1_val': 0.9880350905542497, 'auprc': 0.9990324248494361, 'loss_val': 0.03528391347485944, 'psi': 0.9924340242723242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=50 head_norm_before_train=1.533877 cos_to_last_merge=0.9615 (last merge round=34)
[S9] round=50 local utility u=0.000748 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.998061531026847, 'loss_val': 0.037472237345188945, 'psi': 0.9973534694587683}-{'f1_val': 0.9968814284133827, 'auprc': 0.9981386292822946, 'loss_val': 0.03919948836660931, 'psi': 0.9973843087609474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=50 head_norm_before_train=2.142314 cos_to_last_merge=0.8183 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9952699479344671, 'loss_val': 0.02545728433097945, 'psi': 0.9949678693993043}-{'f1_val': 0.9947664837091956, 'auprc': 0.9954399451269615, 'loss_val': 0.02529144420661744, 'psi': 0.995035868276302}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=1.602145 cos_to_last_merge=0.9800 (last merge round=34)
[S11] round=50 local utility u=0.001161 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967526653076327, 'loss_val': 0.027634468530215433, 'psi': 0.9963812710710387}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963182849586701, 'loss_val': 0.0286523490074167, 'psi': 0.9962075189314537}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=50 head_norm_before_train=2.045203 (no previous merge yet)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.7057176142032744, 'auprc': 0.7880029582522635, 'loss_val': 0.9060917028054157, 'psi': 0.73863175182287}-{'f1_val': 0.7378914692948675, 'auprc': 0.8137748536108405, 'loss_val': 0.9115933040391065, 'psi': 0.7682448230212566}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.574026 cos_to_last_merge=0.9975 (last merge round=40)
[S14] round=50 local utility u=0.003661 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9980323821472121, 'loss_val': 0.038645234960825135, 'psi': 0.9971520868046608}-{'f1_val': 0.9961554288098928, 'auprc': 0.998094531366412, 'loss_val': 0.043693974350653496, 'psi': 0.9969310698325005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=50 head_norm_before_train=1.701835 cos_to_last_merge=0.9801 (last merge round=39)
[S15] round=50 local utility u=0.769839 metrics={'f1_val': 0.9775794000968784, 'auprc': 0.9968058344908053, 'loss_val': 0.05822767538151446, 'psi': 0.9852699738544491}-{'f1_val': 0.8172538134396149, 'auprc': 0.9167477115189864, 'loss_val': 0.3957772246534874, 'psi': 0.8570513726713636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=50 head_norm_before_train=2.062599 cos_to_last_merge=0.9995 (last merge round=41)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8521838857280789, 'auprc': 0.8796578253997289, 'loss_val': 1.0395819575954448, 'psi': 0.8631734615967389}-{'f1_val': 0.8804740471958272, 'auprc': 0.9054254383162049, 'loss_val': 0.7116448206760017, 'psi': 0.8904546036439783}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.755517 cos_to_last_merge=0.9748 (last merge round=41)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.7773581959006837, 'auprc': 0.7874033518411223, 'loss_val': 0.8208666181410746, 'psi': 0.7813762582768591}-{'f1_val': 0.8761474918970411, 'auprc': 0.888269493821416, 'loss_val': 0.49674492359209305, 'psi': 0.8809962926667911}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=2.232953 (no previous merge yet)
[S2] round=51 local utility u=0.049959 metrics={'f1_val': 0.7132554136649997, 'auprc': 0.8392490010517778, 'loss_val': 0.7949419543119745, 'psi': 0.7636528486197109}-{'f1_val': 0.7126835603530202, 'auprc': 0.8255151862809502, 'loss_val': 0.8502274824300202, 'psi': 0.7578162107241921}
[S2] not sending this round → trigger blocked (psi=0.764)
[S3] START round=51 head_norm_before_train=2.236938 (no previous merge yet)
[S3] round=51 local utility u=0.001092 metrics={'f1_val': 0.9106413665326161, 'auprc': 0.9988562312516128, 'loss_val': 0.1452775921737383, 'psi': 0.9459273124202148}-{'f1_val': 0.9114318786804007, 'auprc': 0.9989121895730462, 'loss_val': 0.15237206966880115, 'psi': 0.9464240030374589}
[S3] not sending this round → trigger blocked (psi=0.946)
[S4] START round=51 head_norm_before_train=2.133627 cos_to_last_merge=0.9933 (last merge round=34)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9418881361664966, 'auprc': 0.978348979364589, 'loss_val': 0.239717609688539, 'psi': 0.9564724734457335}-{'f1_val': 0.9535370754057217, 'auprc': 0.9759670456347558, 'loss_val': 0.25925846805405606, 'psi': 0.9625090634973353}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.516950 cos_to_last_merge=0.9829 (last merge round=41)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.5149987968604163, 'auprc': 0.8615124838548117, 'loss_val': 0.674111238680071, 'psi': 0.6536042716581745}-{'f1_val': 0.7121673464101586, 'auprc': 0.9931227009542198, 'loss_val': 0.2282771085663011, 'psi': 0.8245494882277831}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.517569 cos_to_last_merge=0.9913 (last merge round=40)
[S6] round=51 local utility u=1.000000 metrics={'f1_val': 0.8225747007403984, 'auprc': 0.915531064205664, 'loss_val': 0.529593567556444, 'psi': 0.8597572461265046}-{'f1_val': 0.46469461140752616, 'auprc': 0.6725099522026635, 'loss_val': 1.4435068550177916, 'psi': 0.5478207477255811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=51 head_norm_before_train=1.522203 cos_to_last_merge=0.9954 (last merge round=41)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5877195262685677, 'auprc': 0.7952242664100511, 'loss_val': 0.7385443440897945, 'psi': 0.6707214223251611}-{'f1_val': 0.6716960692915294, 'auprc': 0.8296972300172536, 'loss_val': 0.39525528075188526, 'psi': 0.7348965335818191}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.976093 cos_to_last_merge=0.7750 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.775
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9891123920615147, 'auprc': 0.9990374921466335, 'loss_val': 0.03486856810462462, 'psi': 0.9930824320955622}-{'f1_val': 0.9933250006304741, 'auprc': 0.9987485566576426, 'loss_val': 0.028322175418261052, 'psi': 0.9954944230413415}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.548946 cos_to_last_merge=0.9599 (last merge round=34)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9893342792544983, 'auprc': 0.9986845316573401, 'loss_val': 0.04837112156276518, 'psi': 0.993074380215635}-{'f1_val': 0.9968814284133827, 'auprc': 0.998061531026847, 'loss_val': 0.037472237345188945, 'psi': 0.9973534694587683}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=2.149798 cos_to_last_merge=0.8179 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=51 local utility u=0.000420 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9953238552054593, 'loss_val': 0.024779070843863826, 'psi': 0.9949894323077011}-{'f1_val': 0.9947664837091956, 'auprc': 0.9952699479344671, 'loss_val': 0.02545728433097945, 'psi': 0.9949678693993043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=51 head_norm_before_train=1.614347 cos_to_last_merge=0.9792 (last merge round=34)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9959421818666927, 'loss_val': 0.028408009925073037, 'psi': 0.9960570776946627}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967526653076327, 'loss_val': 0.027634468530215433, 'psi': 0.9963812710710387}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=2.050829 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.7399506395771647, 'auprc': 0.7288452853328864, 'loss_val': 1.0877164045951102, 'psi': 0.7355084978794533}-{'f1_val': 0.7057176142032744, 'auprc': 0.7880029582522635, 'loss_val': 0.9060917028054157, 'psi': 0.73863175182287}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.585610 cos_to_last_merge=0.9971 (last merge round=40)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9962440609093208, 'loss_val': 0.039352100090658045, 'psi': 0.9966829244139942}-{'f1_val': 0.9965652232429598, 'auprc': 0.9980323821472121, 'loss_val': 0.038645234960825135, 'psi': 0.9971520868046608}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.718782 cos_to_last_merge=0.9788 (last merge round=39)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8063650991263799, 'auprc': 0.8333468895267311, 'loss_val': 0.4723384358620779, 'psi': 0.8171578152865204}-{'f1_val': 0.9775794000968784, 'auprc': 0.9968058344908053, 'loss_val': 0.05822767538151446, 'psi': 0.9852699738544491}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.063459 cos_to_last_merge=0.9993 (last merge round=41)
[S16] round=51 local utility u=0.122985 metrics={'f1_val': 0.8625223820615308, 'auprc': 0.8937658851784871, 'loss_val': 0.8979662238214317, 'psi': 0.8750197833083133}-{'f1_val': 0.8521838857280789, 'auprc': 0.8796578253997289, 'loss_val': 1.0395819575954448, 'psi': 0.8631734615967389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=51 head_norm_before_train=1.782320 cos_to_last_merge=0.9729 (last merge round=41)
[S17] round=51 local utility u=0.138222 metrics={'f1_val': 0.7865267249998323, 'auprc': 0.8460650588159748, 'loss_val': 0.7754193521007673, 'psi': 0.8103420585262893}-{'f1_val': 0.7773581959006837, 'auprc': 0.7874033518411223, 'loss_val': 0.8208666181410746, 'psi': 0.7813762582768591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=52 head_norm_before_train=2.237313 (no previous merge yet)
[S2] round=52 local utility u=0.043732 metrics={'f1_val': 0.6982504348390105, 'auprc': 0.8808767795137147, 'loss_val': 0.742331821622934, 'psi': 0.7713009727088922}-{'f1_val': 0.7132554136649997, 'auprc': 0.8392490010517778, 'loss_val': 0.7949419543119745, 'psi': 0.7636528486197109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=52 head_norm_before_train=2.241066 (no previous merge yet)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.6957046988988298, 'auprc': 0.9666548560139422, 'loss_val': 0.4558940524020961, 'psi': 0.8040847617448748}-{'f1_val': 0.9106413665326161, 'auprc': 0.9988562312516128, 'loss_val': 0.1452775921737383, 'psi': 0.9459273124202148}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=2.142609 cos_to_last_merge=0.9929 (last merge round=34)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9455989893287424, 'auprc': 0.9702811291848354, 'loss_val': 0.2777994268595788, 'psi': 0.9554718452711797}-{'f1_val': 0.9418881361664966, 'auprc': 0.978348979364589, 'loss_val': 0.239717609688539, 'psi': 0.9564724734457335}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.527988 cos_to_last_merge=0.9814 (last merge round=41)
[S5] round=52 local utility u=0.432028 metrics={'f1_val': 0.6058229769282735, 'auprc': 0.9117762967209952, 'loss_val': 0.5057927278067179, 'psi': 0.7282043048453621}-{'f1_val': 0.5149987968604163, 'auprc': 0.8615124838548117, 'loss_val': 0.674111238680071, 'psi': 0.6536042716581745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=52 head_norm_before_train=1.528065 cos_to_last_merge=0.9905 (last merge round=40)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.8100554437279855, 'auprc': 0.912756407402209, 'loss_val': 0.49550047227818517, 'psi': 0.8511358291976749}-{'f1_val': 0.8225747007403984, 'auprc': 0.915531064205664, 'loss_val': 0.529593567556444, 'psi': 0.8597572461265046}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.531672 cos_to_last_merge=0.9949 (last merge round=41)
[S7] round=52 local utility u=0.278437 metrics={'f1_val': 0.6422486226638042, 'auprc': 0.8064357659474097, 'loss_val': 0.5424790922650524, 'psi': 0.7079234799772465}-{'f1_val': 0.5877195262685677, 'auprc': 0.7952242664100511, 'loss_val': 0.7385443440897945, 'psi': 0.6707214223251611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=52 head_norm_before_train=1.975521 cos_to_last_merge=0.7740 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=52 local utility u=0.012502 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9987247810197847, 'loss_val': 0.031616117701259105, 'psi': 0.9952262358868831}-{'f1_val': 0.9891123920615147, 'auprc': 0.9990374921466335, 'loss_val': 0.03486856810462462, 'psi': 0.9930824320955622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=52 head_norm_before_train=1.562738 cos_to_last_merge=0.9585 (last merge round=34)
[S9] round=52 local utility u=0.023302 metrics={'f1_val': 0.9964710073874787, 'auprc': 0.995261204944626, 'loss_val': 0.034317353364463045, 'psi': 0.9959870864103376}-{'f1_val': 0.9893342792544983, 'auprc': 0.9986845316573401, 'loss_val': 0.04837112156276518, 'psi': 0.993074380215635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=52 head_norm_before_train=2.158470 cos_to_last_merge=0.8175 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=52 local utility u=0.002531 metrics={'f1_val': 0.995175839723847, 'auprc': 0.996294640357685, 'loss_val': 0.02508610830092984, 'psi': 0.9956233599773822}-{'f1_val': 0.9947664837091956, 'auprc': 0.9953238552054593, 'loss_val': 0.024779070843863826, 'psi': 0.9949894323077011}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=52 head_norm_before_train=1.625554 cos_to_last_merge=0.9785 (last merge round=34)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961662911966733, 'loss_val': 0.052180565970496244, 'psi': 0.996146721426655}-{'f1_val': 0.9961336749133093, 'auprc': 0.9959421818666927, 'loss_val': 0.028408009925073037, 'psi': 0.9960570776946627}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=2.059984 (no previous merge yet)
[S13] round=52 local utility u=0.445886 metrics={'f1_val': 0.771512622617949, 'auprc': 0.8368674791126528, 'loss_val': 0.709382882137261, 'psi': 0.7976545652158304}-{'f1_val': 0.7399506395771647, 'auprc': 0.7288452853328864, 'loss_val': 1.0877164045951102, 'psi': 0.7355084978794533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=52 head_norm_before_train=1.596681 cos_to_last_merge=0.9967 (last merge round=40)
[S14] round=52 local utility u=0.001106 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9972338518307879, 'loss_val': 0.03865112969261471, 'psi': 0.9969330552317117}-{'f1_val': 0.9969755000837764, 'auprc': 0.9962440609093208, 'loss_val': 0.039352100090658045, 'psi': 0.9966829244139942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=52 head_norm_before_train=1.735610 cos_to_last_merge=0.9774 (last merge round=39)
[S15] round=52 local utility u=1.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9964928511688416, 'loss_val': 0.02671652506757694, 'psi': 0.9961643133526366}-{'f1_val': 0.8063650991263799, 'auprc': 0.8333468895267311, 'loss_val': 0.4723384358620779, 'psi': 0.8171578152865204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=52 head_norm_before_train=2.068144 cos_to_last_merge=0.9992 (last merge round=41)
[S16] round=52 local utility u=0.390628 metrics={'f1_val': 0.8942135074981159, 'auprc': 0.9823757275362586, 'loss_val': 0.5726860805632299, 'psi': 0.929478395513373}-{'f1_val': 0.8625223820615308, 'auprc': 0.8937658851784871, 'loss_val': 0.8979662238214317, 'psi': 0.8750197833083133}
[S16] not sending this round → trigger blocked (psi=0.929)
[S17] START round=52 head_norm_before_train=1.804379 cos_to_last_merge=0.9716 (last merge round=41)
[S17] round=52 local utility u=0.419318 metrics={'f1_val': 0.866562227159949, 'auprc': 0.8943771079333274, 'loss_val': 0.5619319593910485, 'psi': 0.8776881794693003}-{'f1_val': 0.7865267249998323, 'auprc': 0.8460650588159748, 'loss_val': 0.7754193521007673, 'psi': 0.8103420585262893}
[S17] not sending this round → trigger blocked (psi=0.878)
[S2] START round=53 head_norm_before_train=2.238911 (no previous merge yet)
[S2] round=53 local utility u=0.055238 metrics={'f1_val': 0.702733087421863, 'auprc': 0.8922342645144192, 'loss_val': 0.6928247016978009, 'psi': 0.7785335582588855}-{'f1_val': 0.6982504348390105, 'auprc': 0.8808767795137147, 'loss_val': 0.742331821622934, 'psi': 0.7713009727088922}
[S2] not sending this round → trigger blocked (psi=0.779)
[S3] START round=53 head_norm_before_train=2.245701 (no previous merge yet)
[S3] round=53 local utility u=1.000000 metrics={'f1_val': 0.9706401400987595, 'auprc': 0.9993119768069348, 'loss_val': 0.0838000135895833, 'psi': 0.9821088747820297}-{'f1_val': 0.6957046988988298, 'auprc': 0.9666548560139422, 'loss_val': 0.4558940524020961, 'psi': 0.8040847617448748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=53 head_norm_before_train=2.150101 cos_to_last_merge=0.9925 (last merge round=34)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.948041506012171, 'auprc': 0.9631776456904406, 'loss_val': 0.28827995277847873, 'psi': 0.9540959618834788}-{'f1_val': 0.9455989893287424, 'auprc': 0.9702811291848354, 'loss_val': 0.2777994268595788, 'psi': 0.9554718452711797}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.536294 cos_to_last_merge=0.9803 (last merge round=41)
[S5] round=53 local utility u=0.521156 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9906695598904034, 'loss_val': 0.2681819515266283, 'psi': 0.8165638008374528}-{'f1_val': 0.6058229769282735, 'auprc': 0.9117762967209952, 'loss_val': 0.5057927278067179, 'psi': 0.7282043048453621}
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] START round=53 head_norm_before_train=1.541386 cos_to_last_merge=0.9895 (last merge round=40)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.792773460460042, 'auprc': 0.8903189616229648, 'loss_val': 0.6294089756618033, 'psi': 0.8317916609252112}-{'f1_val': 0.8100554437279855, 'auprc': 0.912756407402209, 'loss_val': 0.49550047227818517, 'psi': 0.8511358291976749}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.541733 cos_to_last_merge=0.9943 (last merge round=41)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5900475038808152, 'auprc': 0.7951471654866294, 'loss_val': 0.7215051566245675, 'psi': 0.6720873685231409}-{'f1_val': 0.6422486226638042, 'auprc': 0.8064357659474097, 'loss_val': 0.5424790922650524, 'psi': 0.7079234799772465}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.975379 cos_to_last_merge=0.7745 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9890474964285507, 'auprc': 0.9988956862203944, 'loss_val': 0.03506040442204271, 'psi': 0.9929867723452881}-{'f1_val': 0.9928938724649488, 'auprc': 0.9987247810197847, 'loss_val': 0.031616117701259105, 'psi': 0.9952262358868831}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.572720 cos_to_last_merge=0.9574 (last merge round=34)
[S9] round=53 local utility u=0.004044 metrics={'f1_val': 0.9960536850584089, 'auprc': 0.9987421663876974, 'loss_val': 0.03416886112737978, 'psi': 0.9971290775901243}-{'f1_val': 0.9964710073874787, 'auprc': 0.995261204944626, 'loss_val': 0.034317353364463045, 'psi': 0.9959870864103376}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=53 head_norm_before_train=2.162961 cos_to_last_merge=0.8171 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963090317422747, 'loss_val': 0.02504157625855767, 'psi': 0.9953835029224272}-{'f1_val': 0.995175839723847, 'auprc': 0.996294640357685, 'loss_val': 0.02508610830092984, 'psi': 0.9956233599773822}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=1.635731 cos_to_last_merge=0.9778 (last merge round=34)
[S11] round=53 local utility u=0.011962 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996057857031428, 'loss_val': 0.027931053988292227, 'psi': 0.9961033477605568}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961662911966733, 'loss_val': 0.052180565970496244, 'psi': 0.996146721426655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=53 head_norm_before_train=2.070893 (no previous merge yet)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.5636263851603007, 'auprc': 0.6084455777468603, 'loss_val': 1.752330346687047, 'psi': 0.5815540621949246}-{'f1_val': 0.771512622617949, 'auprc': 0.8368674791126528, 'loss_val': 0.709382882137261, 'psi': 0.7976545652158304}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.607779 cos_to_last_merge=0.9964 (last merge round=40)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9963679996859035, 'loss_val': 0.03890963991376755, 'psi': 0.9965867143737579}-{'f1_val': 0.9967325241656609, 'auprc': 0.9972338518307879, 'loss_val': 0.03865112969261471, 'psi': 0.9969330552317117}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=1.752099 cos_to_last_merge=0.9761 (last merge round=39)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7755016187789763, 'auprc': 0.9165726967336025, 'loss_val': 0.4536607363318705, 'psi': 0.8319300499608268}-{'f1_val': 0.9959452881418331, 'auprc': 0.9964928511688416, 'loss_val': 0.02671652506757694, 'psi': 0.9961643133526366}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=2.074612 cos_to_last_merge=0.9991 (last merge round=41)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.845777840548152, 'auprc': 0.8571422356918246, 'loss_val': 1.1482369122716058, 'psi': 0.850323598605621}-{'f1_val': 0.8942135074981159, 'auprc': 0.9823757275362586, 'loss_val': 0.5726860805632299, 'psi': 0.929478395513373}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.824609 cos_to_last_merge=0.9703 (last merge round=41)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.7834961716271945, 'auprc': 0.8423270987685654, 'loss_val': 0.8263573884915496, 'psi': 0.8070285424837429}-{'f1_val': 0.866562227159949, 'auprc': 0.8943771079333274, 'loss_val': 0.5619319593910485, 'psi': 0.8776881794693003}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=2.242144 (no previous merge yet)
[S2] round=54 local utility u=0.142608 metrics={'f1_val': 0.7077421936982515, 'auprc': 0.958197410814541, 'loss_val': 0.6355517971796687, 'psi': 0.8079242805447673}-{'f1_val': 0.702733087421863, 'auprc': 0.8922342645144192, 'loss_val': 0.6928247016978009, 'psi': 0.7785335582588855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=54 head_norm_before_train=2.251025 (no previous merge yet)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9588275782550102, 'auprc': 0.9993691707932666, 'loss_val': 0.14243656499453183, 'psi': 0.9750442152703128}-{'f1_val': 0.9706401400987595, 'auprc': 0.9993119768069348, 'loss_val': 0.0838000135895833, 'psi': 0.9821088747820297}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=2.156799 cos_to_last_merge=0.9920 (last merge round=34)
[S4] round=54 local utility u=0.028438 metrics={'f1_val': 0.9518462398669499, 'auprc': 0.9705506797249686, 'loss_val': 0.2763513452955232, 'psi': 0.9593280158101574}-{'f1_val': 0.948041506012171, 'auprc': 0.9631776456904406, 'loss_val': 0.28827995277847873, 'psi': 0.9540959618834788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=54 head_norm_before_train=1.545267 cos_to_last_merge=0.9792 (last merge round=41)
[S5] round=54 local utility u=0.073114 metrics={'f1_val': 0.7190529617258047, 'auprc': 0.990923542149542, 'loss_val': 0.2340731620071463, 'psi': 0.8278011938952996}-{'f1_val': 0.7004932948021524, 'auprc': 0.9906695598904034, 'loss_val': 0.2681819515266283, 'psi': 0.8165638008374528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=54 head_norm_before_train=1.555113 cos_to_last_merge=0.9883 (last merge round=40)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.7740500689836689, 'auprc': 0.9227376941018799, 'loss_val': 0.6956472194163031, 'psi': 0.8335251190309534}-{'f1_val': 0.792773460460042, 'auprc': 0.8903189616229648, 'loss_val': 0.6294089756618033, 'psi': 0.8317916609252112}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.554866 cos_to_last_merge=0.9936 (last merge round=41)
[S7] round=54 local utility u=0.584495 metrics={'f1_val': 0.6842259550263227, 'auprc': 0.8538052458535377, 'loss_val': 0.2935595294700429, 'psi': 0.7520576713572087}-{'f1_val': 0.5900475038808152, 'auprc': 0.7951471654866294, 'loss_val': 0.7215051566245675, 'psi': 0.6720873685231409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=54 head_norm_before_train=1.984486 cos_to_last_merge=0.7735 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=54 local utility u=0.007787 metrics={'f1_val': 0.9909185418312014, 'auprc': 0.999060988560124, 'loss_val': 0.031208060701091406, 'psi': 0.9941755205227705}-{'f1_val': 0.9890474964285507, 'auprc': 0.9988956862203944, 'loss_val': 0.03506040442204271, 'psi': 0.9929867723452881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=54 head_norm_before_train=1.582695 cos_to_last_merge=0.9563 (last merge round=34)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9963217789890058, 'loss_val': 0.032620317845734687, 'psi': 0.9966575686436319}-{'f1_val': 0.9960536850584089, 'auprc': 0.9987421663876974, 'loss_val': 0.03416886112737978, 'psi': 0.9971290775901243}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.171484 cos_to_last_merge=0.8167 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9957090888457305, 'loss_val': 0.02433282386471263, 'psi': 0.9951435257638095}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963090317422747, 'loss_val': 0.02504157625855767, 'psi': 0.9953835029224272}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.645513 cos_to_last_merge=0.9771 (last merge round=34)
[S11] round=54 local utility u=0.001465 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963117011548717, 'loss_val': 0.025763536860531566, 'psi': 0.9962048854099342}-{'f1_val': 0.9961336749133093, 'auprc': 0.996057857031428, 'loss_val': 0.027931053988292227, 'psi': 0.9961033477605568}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=54 head_norm_before_train=2.075684 (no previous merge yet)
[S13] round=54 local utility u=0.695390 metrics={'f1_val': 0.6492204365556218, 'auprc': 0.7201877061009022, 'loss_val': 1.2103419061733727, 'psi': 0.6776073443737339}-{'f1_val': 0.5636263851603007, 'auprc': 0.6084455777468603, 'loss_val': 1.752330346687047, 'psi': 0.5815540621949246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=54 head_norm_before_train=1.616382 cos_to_last_merge=0.9960 (last merge round=40)
[S14] round=54 local utility u=0.005107 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9984089217861326, 'loss_val': 0.03481826237658294, 'psi': 0.9974030832138496}-{'f1_val': 0.9967325241656609, 'auprc': 0.9963679996859035, 'loss_val': 0.03890963991376755, 'psi': 0.9965867143737579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=54 head_norm_before_train=1.766152 cos_to_last_merge=0.9751 (last merge round=39)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.7699030129281674, 'auprc': 0.9109745531789815, 'loss_val': 0.4846126730121782, 'psi': 0.826331629028493}-{'f1_val': 0.7755016187789763, 'auprc': 0.9165726967336025, 'loss_val': 0.4536607363318705, 'psi': 0.8319300499608268}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=2.081288 cos_to_last_merge=0.9991 (last merge round=41)
[S16] round=54 local utility u=0.862460 metrics={'f1_val': 0.9383002292066555, 'auprc': 0.9887825813166304, 'loss_val': 0.3733716756525979, 'psi': 0.9584931700506454}-{'f1_val': 0.845777840548152, 'auprc': 0.8571422356918246, 'loss_val': 1.1482369122716058, 'psi': 0.850323598605621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=54 head_norm_before_train=1.843275 cos_to_last_merge=0.9687 (last merge round=41)
[S17] round=54 local utility u=0.243374 metrics={'f1_val': 0.81996541891804, 'auprc': 0.8719249272179521, 'loss_val': 0.6472182785636376, 'psi': 0.8407492222380049}-{'f1_val': 0.7834961716271945, 'auprc': 0.8423270987685654, 'loss_val': 0.8263573884915496, 'psi': 0.8070285424837429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=55 head_norm_before_train=2.245179 (no previous merge yet)
[S2] round=55 local utility u=0.011004 metrics={'f1_val': 0.7077767784935615, 'auprc': 0.959647482880255, 'loss_val': 0.6181005577775083, 'psi': 0.8085250602482389}-{'f1_val': 0.7077421936982515, 'auprc': 0.958197410814541, 'loss_val': 0.6355517971796687, 'psi': 0.8079242805447673}
[S2] not sending this round → trigger blocked (psi=0.809)
[S3] START round=55 head_norm_before_train=2.256167 (no previous merge yet)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9158727840311112, 'auprc': 0.9939502140699632, 'loss_val': 0.15398162642096275, 'psi': 0.947103756046652}-{'f1_val': 0.9588275782550102, 'auprc': 0.9993691707932666, 'loss_val': 0.14243656499453183, 'psi': 0.9750442152703128}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=2.162136 cos_to_last_merge=0.9915 (last merge round=34)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9403432611107155, 'auprc': 0.964873729669406, 'loss_val': 0.2249817588785535, 'psi': 0.9501554485341916}-{'f1_val': 0.9518462398669499, 'auprc': 0.9705506797249686, 'loss_val': 0.2763513452955232, 'psi': 0.9593280158101574}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.554952 cos_to_last_merge=0.9780 (last merge round=41)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.5517383374361824, 'auprc': 0.8691268980623735, 'loss_val': 0.5986029572679745, 'psi': 0.6786937616866588}-{'f1_val': 0.7190529617258047, 'auprc': 0.990923542149542, 'loss_val': 0.2340731620071463, 'psi': 0.8278011938952996}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.567410 cos_to_last_merge=0.9871 (last merge round=40)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7483824858787204, 'auprc': 0.8916799402335176, 'loss_val': 0.7451809658355082, 'psi': 0.8057014676206393}-{'f1_val': 0.7740500689836689, 'auprc': 0.9227376941018799, 'loss_val': 0.6956472194163031, 'psi': 0.8335251190309534}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.566206 cos_to_last_merge=0.9930 (last merge round=41)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.6288409415334929, 'auprc': 0.801313104809599, 'loss_val': 0.6131883585312087, 'psi': 0.6978298068439354}-{'f1_val': 0.6842259550263227, 'auprc': 0.8538052458535377, 'loss_val': 0.2935595294700429, 'psi': 0.7520576713572087}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.995225 cos_to_last_merge=0.7726 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.773
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.983027569283401, 'auprc': 0.9988444713748508, 'loss_val': 0.04746322404558482, 'psi': 0.989354330119981}-{'f1_val': 0.9909185418312014, 'auprc': 0.999060988560124, 'loss_val': 0.031208060701091406, 'psi': 0.9941755205227705}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=1.593343 cos_to_last_merge=0.9551 (last merge round=34)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9935516800558999, 'auprc': 0.9987683736228308, 'loss_val': 0.0369900947557877, 'psi': 0.9956383574826723}-{'f1_val': 0.9968814284133827, 'auprc': 0.9963217789890058, 'loss_val': 0.032620317845734687, 'psi': 0.9966575686436319}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.181427 cos_to_last_merge=0.8162 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=55 local utility u=0.001629 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9962816508088236, 'loss_val': 0.025249375760319777, 'psi': 0.9956181641578377}-{'f1_val': 0.9947664837091956, 'auprc': 0.9957090888457305, 'loss_val': 0.02433282386471263, 'psi': 0.9951435257638095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=55 head_norm_before_train=1.655970 cos_to_last_merge=0.9763 (last merge round=34)
[S11] round=55 local utility u=0.000057 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961705319202171, 'loss_val': 0.025226335543703526, 'psi': 0.9961484177160724}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963117011548717, 'loss_val': 0.025763536860531566, 'psi': 0.9962048854099342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=55 head_norm_before_train=2.075547 (no previous merge yet)
[S13] round=55 local utility u=0.311450 metrics={'f1_val': 0.746894473661577, 'auprc': 0.716899180919974, 'loss_val': 1.1636198334314585, 'psi': 0.7348963565649358}-{'f1_val': 0.6492204365556218, 'auprc': 0.7201877061009022, 'loss_val': 1.2103419061733727, 'psi': 0.6776073443737339}
[S13] not sending this round → trigger blocked (psi=0.735)
[S14] START round=55 head_norm_before_train=1.624052 cos_to_last_merge=0.9957 (last merge round=40)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9983787427234995, 'loss_val': 0.03312255337878356, 'psi': 0.9971448454843062}-{'f1_val': 0.9967325241656609, 'auprc': 0.9984089217861326, 'loss_val': 0.03481826237658294, 'psi': 0.9974030832138496}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.780615 cos_to_last_merge=0.9739 (last merge round=39)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.7007779413532578, 'auprc': 0.9080612918000168, 'loss_val': 0.5556464971411871, 'psi': 0.7836912815319614}-{'f1_val': 0.7699030129281674, 'auprc': 0.9109745531789815, 'loss_val': 0.4846126730121782, 'psi': 0.826331629028493}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=2.088700 cos_to_last_merge=0.9990 (last merge round=41)
[S16] round=55 local utility u=0.330960 metrics={'f1_val': 0.9911988893591563, 'auprc': 0.9936118960340088, 'loss_val': 0.04333194021958909, 'psi': 0.9921640920290973}-{'f1_val': 0.9383002292066555, 'auprc': 0.9887825813166304, 'loss_val': 0.3733716756525979, 'psi': 0.9584931700506454}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=55 head_norm_before_train=1.864509 cos_to_last_merge=0.9673 (last merge round=41)
[S17] round=55 local utility u=0.155883 metrics={'f1_val': 0.84496445599628, 'auprc': 0.9184853883009587, 'loss_val': 0.6251286310331415, 'psi': 0.8743728289181514}-{'f1_val': 0.81996541891804, 'auprc': 0.8719249272179521, 'loss_val': 0.6472182785636376, 'psi': 0.8407492222380049}
[S17] not sending this round → trigger blocked (psi=0.874)
[S2] START round=56 head_norm_before_train=2.249265 (no previous merge yet)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.707561900474271, 'auprc': 0.9345042320270699, 'loss_val': 0.6316038949873886, 'psi': 0.7983388330953907}-{'f1_val': 0.7077767784935615, 'auprc': 0.959647482880255, 'loss_val': 0.6181005577775083, 'psi': 0.8085250602482389}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.262255 (no previous merge yet)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9148408453624981, 'auprc': 0.9917721926167831, 'loss_val': 0.14869771225198916, 'psi': 0.945613384264212}-{'f1_val': 0.9158727840311112, 'auprc': 0.9939502140699632, 'loss_val': 0.15398162642096275, 'psi': 0.947103756046652}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=2.168359 cos_to_last_merge=0.9912 (last merge round=34)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9533958248130362, 'auprc': 0.9524104525185515, 'loss_val': 0.3076979680216671, 'psi': 0.9530016758952424}-{'f1_val': 0.9403432611107155, 'auprc': 0.964873729669406, 'loss_val': 0.2249817588785535, 'psi': 0.9501554485341916}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.567823 cos_to_last_merge=0.9765 (last merge round=41)
[S5] round=56 local utility u=1.000000 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.9964698775922757, 'loss_val': 0.11089310401744554, 'psi': 0.9963878762189176}-{'f1_val': 0.5517383374361824, 'auprc': 0.8691268980623735, 'loss_val': 0.5986029572679745, 'psi': 0.6786937616866588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=56 head_norm_before_train=1.577513 cos_to_last_merge=0.9861 (last merge round=40)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.602574986476035, 'auprc': 0.8755256562434621, 'loss_val': 0.9309041907581032, 'psi': 0.7117552543830059}-{'f1_val': 0.7483824858787204, 'auprc': 0.8916799402335176, 'loss_val': 0.7451809658355082, 'psi': 0.8057014676206393}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.579340 cos_to_last_merge=0.9922 (last merge round=41)
[S7] round=56 local utility u=0.262724 metrics={'f1_val': 0.6712365190726517, 'auprc': 0.8259996477937657, 'loss_val': 0.4161737183404598, 'psi': 0.7331417705610973}-{'f1_val': 0.6288409415334929, 'auprc': 0.801313104809599, 'loss_val': 0.6131883585312087, 'psi': 0.6978298068439354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=56 head_norm_before_train=2.002484 cos_to_last_merge=0.7717 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.772
[S8] round=56 local utility u=0.040808 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9989443116769913, 'loss_val': 0.027932208966259996, 'psi': 0.995572725049081}-{'f1_val': 0.983027569283401, 'auprc': 0.9988444713748508, 'loss_val': 0.04746322404558482, 'psi': 0.989354330119981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=56 head_norm_before_train=1.603801 cos_to_last_merge=0.9540 (last merge round=34)
[S9] round=56 local utility u=0.012962 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9987716967181532, 'loss_val': 0.03105488044203176, 'psi': 0.9976375357352909}-{'f1_val': 0.9935516800558999, 'auprc': 0.9987683736228308, 'loss_val': 0.0369900947557877, 'psi': 0.9956383574826723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=56 head_norm_before_train=2.191478 cos_to_last_merge=0.8157 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9964155884501257, 'loss_val': 0.024954396711533655, 'psi': 0.9954261256055676}-{'f1_val': 0.995175839723847, 'auprc': 0.9962816508088236, 'loss_val': 0.025249375760319777, 'psi': 0.9956181641578377}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.666462 cos_to_last_merge=0.9757 (last merge round=34)
[S11] round=56 local utility u=0.001004 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966869764458778, 'loss_val': 0.024767945595972053, 'psi': 0.9963549955263367}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961705319202171, 'loss_val': 0.025226335543703526, 'psi': 0.9961484177160724}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=56 head_norm_before_train=2.086583 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6366939965506043, 'auprc': 0.6765472255991327, 'loss_val': 1.3030426372632895, 'psi': 0.6526352881700157}-{'f1_val': 0.746894473661577, 'auprc': 0.716899180919974, 'loss_val': 1.1636198334314585, 'psi': 0.7348963565649358}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.633031 cos_to_last_merge=0.9953 (last merge round=40)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9967531000320307, 'loss_val': 0.033498099365359676, 'psi': 0.9968865400630781}-{'f1_val': 0.9963222473248441, 'auprc': 0.9983787427234995, 'loss_val': 0.03312255337878356, 'psi': 0.9971448454843062}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.793225 cos_to_last_merge=0.9729 (last merge round=39)
[S15] round=56 local utility u=1.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9953233126523646, 'loss_val': 0.025294793701654834, 'psi': 0.9956964979460458}-{'f1_val': 0.7007779413532578, 'auprc': 0.9080612918000168, 'loss_val': 0.5556464971411871, 'psi': 0.7836912815319614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=56 head_norm_before_train=2.095433 cos_to_last_merge=0.9990 (last merge round=41)
[S16] round=56 local utility u=0.002070 metrics={'f1_val': 0.9916566064151536, 'auprc': 0.9929460287214299, 'loss_val': 0.0399410893856258, 'psi': 0.9921723753376641}-{'f1_val': 0.9911988893591563, 'auprc': 0.9936118960340088, 'loss_val': 0.04333194021958909, 'psi': 0.9921640920290973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=56 head_norm_before_train=1.880830 cos_to_last_merge=0.9663 (last merge round=41)
[S17] round=56 local utility u=0.003566 metrics={'f1_val': 0.8473001517371835, 'auprc': 0.9169413994948504, 'loss_val': 0.6273796967372363, 'psi': 0.8751566508402503}-{'f1_val': 0.84496445599628, 'auprc': 0.9184853883009587, 'loss_val': 0.6251286310331415, 'psi': 0.8743728289181514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=57 head_norm_before_train=2.254854 (no previous merge yet)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.693214839701582, 'auprc': 0.8276734570022958, 'loss_val': 0.8456822036750535, 'psi': 0.7469982866218676}-{'f1_val': 0.707561900474271, 'auprc': 0.9345042320270699, 'loss_val': 0.6316038949873886, 'psi': 0.7983388330953907}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.269130 (no previous merge yet)
[S3] round=57 local utility u=0.207968 metrics={'f1_val': 0.968742959898605, 'auprc': 0.9989488443331087, 'loss_val': 0.0777037629223963, 'psi': 0.9808253136724066}-{'f1_val': 0.9148408453624981, 'auprc': 0.9917721926167831, 'loss_val': 0.14869771225198916, 'psi': 0.945613384264212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=57 head_norm_before_train=2.173630 cos_to_last_merge=0.9907 (last merge round=34)
[S4] round=57 local utility u=0.035609 metrics={'f1_val': 0.951353251488684, 'auprc': 0.9705214580830407, 'loss_val': 0.2785578061146746, 'psi': 0.9590205341264266}-{'f1_val': 0.9533958248130362, 'auprc': 0.9524104525185515, 'loss_val': 0.3076979680216671, 'psi': 0.9530016758952424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=57 head_norm_before_train=1.579362 cos_to_last_merge=0.9751 (last merge round=41)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.7004612177853267, 'auprc': 0.9907315299194467, 'loss_val': 0.31326186922119487, 'psi': 0.8165693426389746}-{'f1_val': 0.9963332086366786, 'auprc': 0.9964698775922757, 'loss_val': 0.11089310401744554, 'psi': 0.9963878762189176}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.586651 cos_to_last_merge=0.9852 (last merge round=40)
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.8719091089984147, 'auprc': 0.9301600476862724, 'loss_val': 0.33057797943181516, 'psi': 0.8952094844735579}-{'f1_val': 0.602574986476035, 'auprc': 0.8755256562434621, 'loss_val': 0.9309041907581032, 'psi': 0.7117552543830059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=57 head_norm_before_train=1.589858 cos_to_last_merge=0.9916 (last merge round=41)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5833842441227645, 'auprc': 0.7930404323747211, 'loss_val': 0.8001223997668655, 'psi': 0.6672467194235472}-{'f1_val': 0.6712365190726517, 'auprc': 0.8259996477937657, 'loss_val': 0.4161737183404598, 'psi': 0.7331417705610973}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=2.005773 cos_to_last_merge=0.7711 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.771
[S8] round=57 local utility u=0.003793 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9989041740702871, 'loss_val': 0.026824510891438988, 'psi': 0.9962166054180845}-{'f1_val': 0.9933250006304741, 'auprc': 0.9989443116769913, 'loss_val': 0.027932208966259996, 'psi': 0.995572725049081}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=57 head_norm_before_train=1.613628 cos_to_last_merge=0.9530 (last merge round=34)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9964710073874787, 'auprc': 0.9951242664326295, 'loss_val': 0.03033570455720771, 'psi': 0.995932311005539}-{'f1_val': 0.9968814284133827, 'auprc': 0.9987716967181532, 'loss_val': 0.03105488044203176, 'psi': 0.9976375357352909}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.194697 cos_to_last_merge=0.8154 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=57 local utility u=0.000401 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9965515606904373, 'loss_val': 0.02456072028622908, 'psi': 0.9954805145016923}-{'f1_val': 0.9947664837091956, 'auprc': 0.9964155884501257, 'loss_val': 0.024954396711533655, 'psi': 0.9954261256055676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=57 head_norm_before_train=1.674695 cos_to_last_merge=0.9751 (last merge round=34)
[S11] round=57 local utility u=0.000572 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969245835739425, 'loss_val': 0.024336391535621744, 'psi': 0.9964500383775626}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966869764458778, 'loss_val': 0.024767945595972053, 'psi': 0.9963549955263367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=57 head_norm_before_train=2.094064 (no previous merge yet)
[S13] round=57 local utility u=0.389518 metrics={'f1_val': 0.7220168776196246, 'auprc': 0.7299070367420646, 'loss_val': 1.1960231139042847, 'psi': 0.7251729412686005}-{'f1_val': 0.6366939965506043, 'auprc': 0.6765472255991327, 'loss_val': 1.3030426372632895, 'psi': 0.6526352881700157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=57 head_norm_before_train=1.640677 cos_to_last_merge=0.9950 (last merge round=40)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9443181070822435, 'auprc': 0.9856120498717893, 'loss_val': 0.1220488154322708, 'psi': 0.9608356841980619}-{'f1_val': 0.9969755000837764, 'auprc': 0.9967531000320307, 'loss_val': 0.033498099365359676, 'psi': 0.9968865400630781}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.805232 cos_to_last_merge=0.9721 (last merge round=39)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8189194654056999, 'auprc': 0.918060501723778, 'loss_val': 0.4170487856706033, 'psi': 0.8585758799329312}-{'f1_val': 0.9959452881418331, 'auprc': 0.9953233126523646, 'loss_val': 0.025294793701654834, 'psi': 0.9956964979460458}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.099346 cos_to_last_merge=0.9987 (last merge round=41)
[S16] round=57 local utility u=0.002255 metrics={'f1_val': 0.9918554892289619, 'auprc': 0.9941610919615634, 'loss_val': 0.040270397530277446, 'psi': 0.9927777303220026}-{'f1_val': 0.9916566064151536, 'auprc': 0.9929460287214299, 'loss_val': 0.0399410893856258, 'psi': 0.9921723753376641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=57 head_norm_before_train=1.896291 cos_to_last_merge=0.9651 (last merge round=41)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.8332528007683447, 'auprc': 0.9509550248028134, 'loss_val': 0.7319026218288991, 'psi': 0.8803336903821322}-{'f1_val': 0.8473001517371835, 'auprc': 0.9169413994948504, 'loss_val': 0.6273796967372363, 'psi': 0.8751566508402503}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=2.260310 (no previous merge yet)
[S2] round=58 local utility u=0.364598 metrics={'f1_val': 0.7089716680846376, 'auprc': 0.9585069078346564, 'loss_val': 0.6035267189983421, 'psi': 0.8087857639846452}-{'f1_val': 0.693214839701582, 'auprc': 0.8276734570022958, 'loss_val': 0.8456822036750535, 'psi': 0.7469982866218676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=58 head_norm_before_train=2.276405 (no previous merge yet)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9037702649494197, 'auprc': 0.9942227999263251, 'loss_val': 0.25200713818877285, 'psi': 0.9399512789401818}-{'f1_val': 0.968742959898605, 'auprc': 0.9989488443331087, 'loss_val': 0.0777037629223963, 'psi': 0.9808253136724066}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=2.177711 cos_to_last_merge=0.9903 (last merge round=34)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9491357761657945, 'auprc': 0.9467418442811099, 'loss_val': 0.31062700652748026, 'psi': 0.9481782034119206}-{'f1_val': 0.951353251488684, 'auprc': 0.9705214580830407, 'loss_val': 0.2785578061146746, 'psi': 0.9590205341264266}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.588953 cos_to_last_merge=0.9740 (last merge round=41)
[S5] round=58 local utility u=0.992093 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9916184274193716, 'loss_val': 0.1060897544937397, 'psi': 0.9943594386424763}-{'f1_val': 0.7004612177853267, 'auprc': 0.9907315299194467, 'loss_val': 0.31326186922119487, 'psi': 0.8165693426389746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=58 head_norm_before_train=1.593308 cos_to_last_merge=0.9845 (last merge round=40)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.8059692609009982, 'auprc': 0.9254246303821133, 'loss_val': 0.6178348016046159, 'psi': 0.8537514086934442}-{'f1_val': 0.8719091089984147, 'auprc': 0.9301600476862724, 'loss_val': 0.33057797943181516, 'psi': 0.8952094844735579}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.597745 cos_to_last_merge=0.9910 (last merge round=41)
[S7] round=58 local utility u=1.000000 metrics={'f1_val': 0.8205266537927938, 'auprc': 0.945542305496529, 'loss_val': 0.20119868816593509, 'psi': 0.8705329144742878}-{'f1_val': 0.5833842441227645, 'auprc': 0.7930404323747211, 'loss_val': 0.8001223997668655, 'psi': 0.6672467194235472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=58 head_norm_before_train=2.009224 cos_to_last_merge=0.7704 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.770
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9713804658352091, 'auprc': 0.9989959618120852, 'loss_val': 0.07484558150176045, 'psi': 0.9824266642259596}-{'f1_val': 0.9944248929832828, 'auprc': 0.9989041740702871, 'loss_val': 0.026824510891438988, 'psi': 0.9962166054180845}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.622915 cos_to_last_merge=0.9520 (last merge round=34)
[S9] round=58 local utility u=0.004087 metrics={'f1_val': 0.9960499618648996, 'auprc': 0.9987800231536162, 'loss_val': 0.030602100396612306, 'psi': 0.9971419863803863}-{'f1_val': 0.9964710073874787, 'auprc': 0.9951242664326295, 'loss_val': 0.03033570455720771, 'psi': 0.995932311005539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=58 head_norm_before_train=2.202312 cos_to_last_merge=0.8149 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=58 local utility u=0.000654 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9963889191735703, 'loss_val': 0.025220078498335418, 'psi': 0.9956610715037363}-{'f1_val': 0.9947664837091956, 'auprc': 0.9965515606904373, 'loss_val': 0.02456072028622908, 'psi': 0.9954805145016923}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=58 head_norm_before_train=1.683263 cos_to_last_merge=0.9745 (last merge round=34)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.8016844989673056, 'auprc': 0.9959658249449564, 'loss_val': 0.2677736459587486, 'psi': 0.879397029358366}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969245835739425, 'loss_val': 0.024336391535621744, 'psi': 0.9964500383775626}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=2.102371 (no previous merge yet)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6357489647823458, 'auprc': 0.6800276246906097, 'loss_val': 1.372204813232703, 'psi': 0.6534604287456514}-{'f1_val': 0.7220168776196246, 'auprc': 0.7299070367420646, 'loss_val': 1.1960231139042847, 'psi': 0.7251729412686005}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.648321 cos_to_last_merge=0.9947 (last merge round=40)
[S14] round=58 local utility u=0.220041 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9983550248231727, 'loss_val': 0.03235787410344411, 'psi': 0.9971490204507816}-{'f1_val': 0.9443181070822435, 'auprc': 0.9856120498717893, 'loss_val': 0.1220488154322708, 'psi': 0.9608356841980619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=58 head_norm_before_train=1.817893 cos_to_last_merge=0.9711 (last merge round=39)
[S15] round=58 local utility u=0.795644 metrics={'f1_val': 0.982839933458567, 'auprc': 0.9963339404938334, 'loss_val': 0.04410421028938542, 'psi': 0.9882375362726735}-{'f1_val': 0.8189194654056999, 'auprc': 0.918060501723778, 'loss_val': 0.4170487856706033, 'psi': 0.8585758799329312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=58 head_norm_before_train=2.104270 cos_to_last_merge=0.9986 (last merge round=41)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9407788508925871, 'auprc': 0.9817226763606293, 'loss_val': 0.3870366600478137, 'psi': 0.9571563810798039}-{'f1_val': 0.9918554892289619, 'auprc': 0.9941610919615634, 'loss_val': 0.040270397530277446, 'psi': 0.9927777303220026}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.912350 cos_to_last_merge=0.9640 (last merge round=41)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.7755268312480799, 'auprc': 0.7405217085479244, 'loss_val': 0.8767397624304369, 'psi': 0.7615247821680177}-{'f1_val': 0.8332528007683447, 'auprc': 0.9509550248028134, 'loss_val': 0.7319026218288991, 'psi': 0.8803336903821322}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.262950 (no previous merge yet)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.7128466929010742, 'auprc': 0.8609707281268086, 'loss_val': 0.7153489174308157, 'psi': 0.772096306991368}-{'f1_val': 0.7089716680846376, 'auprc': 0.9585069078346564, 'loss_val': 0.6035267189983421, 'psi': 0.8087857639846452}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.772 u=0.0000 p_local=0.0840 f1=0.713 auprc=0.861 bytes=45014
[S3] START round=59 head_norm_before_train=2.282380 (no previous merge yet)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.7821973618849583, 'auprc': 0.9765644534437886, 'loss_val': 0.3322739505823153, 'psi': 0.8599441985084904}-{'f1_val': 0.9037702649494197, 'auprc': 0.9942227999263251, 'loss_val': 0.25200713818877285, 'psi': 0.9399512789401818}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.860 u=0.0000 p_local=0.0956 f1=0.782 auprc=0.977 bytes=41365
[S4] START round=59 head_norm_before_train=2.181993 cos_to_last_merge=0.9899 (last merge round=34)
[S4] round=59 local utility u=0.012513 metrics={'f1_val': 0.9446207615666651, 'auprc': 0.9611414858965168, 'loss_val': 0.30171039220928797, 'psi': 0.9512290512986057}-{'f1_val': 0.9491357761657945, 'auprc': 0.9467418442811099, 'loss_val': 0.31062700652748026, 'psi': 0.9481782034119206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S4] r=60 psi=0.951 u=0.0125 p_local=0.0103 f1=0.945 auprc=0.961 bytes=43125
[S5] START round=59 head_norm_before_train=1.596942 cos_to_last_merge=0.9730 (last merge round=41)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.790180399748114, 'auprc': 0.9918891148046445, 'loss_val': 0.1953321870753887, 'psi': 0.8708638857707263}-{'f1_val': 0.9961867794578795, 'auprc': 0.9916184274193716, 'loss_val': 0.1060897544937397, 'psi': 0.9943594386424763}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.871 u=0.0000 p_local=0.3334 f1=0.790 auprc=0.992 bytes=50390
[S6] START round=59 head_norm_before_train=1.601434 cos_to_last_merge=0.9840 (last merge round=40)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.7355803026338741, 'auprc': 0.8911205829116045, 'loss_val': 0.7662101578734596, 'psi': 0.7977964147449663}-{'f1_val': 0.8059692609009982, 'auprc': 0.9254246303821133, 'loss_val': 0.6178348016046159, 'psi': 0.8537514086934442}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.798 u=0.0000 p_local=0.1858 f1=0.736 auprc=0.891 bytes=37753
[S7] START round=59 head_norm_before_train=1.604394 cos_to_last_merge=0.9906 (last merge round=41)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.5958004063032507, 'auprc': 0.7941653061744701, 'loss_val': 0.661385798745461, 'psi': 0.6751463662517385}-{'f1_val': 0.8205266537927938, 'auprc': 0.945542305496529, 'loss_val': 0.20119868816593509, 'psi': 0.8705329144742878}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.675 u=0.0000 p_local=0.2511 f1=0.596 auprc=0.794 bytes=46801
[S8] START round=59 head_norm_before_train=2.018146 cos_to_last_merge=0.7695 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.770
[S8] round=59 local utility u=0.049315 metrics={'f1_val': 0.9852111586232302, 'auprc': 0.9962225152999324, 'loss_val': 0.050878411768987664, 'psi': 0.9896157012939111}-{'f1_val': 0.9713804658352091, 'auprc': 0.9989959618120852, 'loss_val': 0.07484558150176045, 'psi': 0.9824266642259596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=60 psi=0.990 u=0.0493 p_local=0.0169 f1=0.985 auprc=0.996 bytes=52131
[S9] START round=59 head_norm_before_train=1.631870 cos_to_last_merge=0.9510 (last merge round=34)
[S9] round=59 local utility u=0.001913 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9987826262338839, 'loss_val': 0.029291813649987654, 'psi': 0.9973937325985762}-{'f1_val': 0.9960499618648996, 'auprc': 0.9987800231536162, 'loss_val': 0.030602100396612306, 'psi': 0.9971419863803863}
[S9] not sending this round → trigger blocked (psi=0.997)
[S9] r=60 psi=0.997 u=0.0019 p_local=0.0045 f1=0.996 auprc=0.999 bytes=53936
[S10] START round=59 head_norm_before_train=2.209319 cos_to_last_merge=0.8145 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963812809620871, 'loss_val': 0.024772233138976835, 'psi': 0.9954124026103521}-{'f1_val': 0.995175839723847, 'auprc': 0.9963889191735703, 'loss_val': 0.025220078498335418, 'psi': 0.9956610715037363}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0004 f1=0.995 auprc=0.996 bytes=53900
[S11] START round=59 head_norm_before_train=1.691822 cos_to_last_merge=0.9739 (last merge round=34)
[S11] round=59 local utility u=0.705173 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9959443737650275, 'loss_val': 0.024057574204313984, 'psi': 0.9960579544539966}-{'f1_val': 0.8016844989673056, 'auprc': 0.9959658249449564, 'loss_val': 0.2677736459587486, 'psi': 0.879397029358366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=60 psi=0.996 u=0.7052 p_local=0.1543 f1=0.996 auprc=0.996 bytes=61122
[S13] START round=59 head_norm_before_train=2.108346 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6185555746125515, 'auprc': 0.6358371662566924, 'loss_val': 1.5956543559373748, 'psi': 0.6254682112702079}-{'f1_val': 0.6357489647823458, 'auprc': 0.6800276246906097, 'loss_val': 1.372204813232703, 'psi': 0.6534604287456514}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.625 u=0.0000 p_local=0.1490 f1=0.619 auprc=0.636 bytes=35948
[S14] START round=59 head_norm_before_train=1.655834 cos_to_last_merge=0.9944 (last merge round=40)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9981251065794603, 'loss_val': 0.032395628057353576, 'psi': 0.9970433910266905}-{'f1_val': 0.996345017535854, 'auprc': 0.9983550248231727, 'loss_val': 0.03235787410344411, 'psi': 0.9971490204507816}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0360 f1=0.996 auprc=0.998 bytes=50355
[S15] START round=59 head_norm_before_train=1.830567 cos_to_last_merge=0.9701 (last merge round=39)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.8782932082016472, 'auprc': 0.9690255941647602, 'loss_val': 0.3223858316555617, 'psi': 0.9145861625868924}-{'f1_val': 0.982839933458567, 'auprc': 0.9963339404938334, 'loss_val': 0.04410421028938542, 'psi': 0.9882375362726735}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.915 u=0.0000 p_local=0.3333 f1=0.878 auprc=0.969 bytes=43197
[S16] START round=59 head_norm_before_train=2.107661 cos_to_last_merge=0.9985 (last merge round=41)
[S16] round=59 local utility u=0.046784 metrics={'f1_val': 0.9421936249346594, 'auprc': 0.9840075752001279, 'loss_val': 0.3088117741246174, 'psi': 0.9589192050408468}-{'f1_val': 0.9407788508925871, 'auprc': 0.9817226763606293, 'loss_val': 0.3870366600478137, 'psi': 0.9571563810798039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S16] r=60 psi=0.959 u=0.0468 p_local=0.1321 f1=0.942 auprc=0.984 bytes=41309
[S17] START round=59 head_norm_before_train=1.928702 cos_to_last_merge=0.9628 (last merge round=41)
[S17] round=59 local utility u=0.720751 metrics={'f1_val': 0.8767746932248927, 'auprc': 0.9190055045465845, 'loss_val': 0.578176365959408, 'psi': 0.8936670177535694}-{'f1_val': 0.7755268312480799, 'auprc': 0.7405217085479244, 'loss_val': 0.8767397624304369, 'psi': 0.7615247821680177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=60 psi=0.894 u=0.7208 p_local=0.2375 f1=0.877 auprc=0.919 bytes=52205
[S2] START round=60 head_norm_before_train=2.270289 (no previous merge yet)
[S2] round=60 local utility u=0.139778 metrics={'f1_val': 0.7094399494984791, 'auprc': 0.9413187050439492, 'loss_val': 0.6563965143712227, 'psi': 0.8021914517166671}-{'f1_val': 0.7128466929010742, 'auprc': 0.8609707281268086, 'loss_val': 0.7153489174308157, 'psi': 0.772096306991368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=60 head_norm_before_train=2.288039 (no previous merge yet)
[S3] round=60 local utility u=0.725112 metrics={'f1_val': 0.9695540814927345, 'auprc': 0.9991510556735794, 'loss_val': 0.07395034744751922, 'psi': 0.9813928711650725}-{'f1_val': 0.7821973618849583, 'auprc': 0.9765644534437886, 'loss_val': 0.3322739505823153, 'psi': 0.8599441985084904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=60 head_norm_before_train=2.182711 cos_to_last_merge=0.9898 (last merge round=34)
[S4] round=60 local utility u=0.023856 metrics={'f1_val': 0.9416659175731799, 'auprc': 0.9721775858984882, 'loss_val': 0.2693774276743844, 'psi': 0.9538705849033032}-{'f1_val': 0.9446207615666651, 'auprc': 0.9611414858965168, 'loss_val': 0.30171039220928797, 'psi': 0.9512290512986057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=60 head_norm_before_train=1.603065 cos_to_last_merge=0.9722 (last merge round=41)
[S5] round=60 local utility u=0.654195 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9915344025983373, 'loss_val': 0.12191656641720601, 'psi': 0.9943258287140626}-{'f1_val': 0.790180399748114, 'auprc': 0.9918891148046445, 'loss_val': 0.1953321870753887, 'psi': 0.8708638857707263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=60 head_norm_before_train=1.609989 cos_to_last_merge=0.9833 (last merge round=40)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.7228760660241441, 'auprc': 0.8794828707144381, 'loss_val': 0.8290115753679569, 'psi': 0.7855187879002616}-{'f1_val': 0.7355803026338741, 'auprc': 0.8911205829116045, 'loss_val': 0.7662101578734596, 'psi': 0.7977964147449663}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.609737 cos_to_last_merge=0.9902 (last merge round=41)
[S7] round=60 local utility u=0.486680 metrics={'f1_val': 0.6807158761764108, 'auprc': 0.836737335222576, 'loss_val': 0.32523490257784005, 'psi': 0.743124459794877}-{'f1_val': 0.5958004063032507, 'auprc': 0.7941653061744701, 'loss_val': 0.661385798745461, 'psi': 0.6751463662517385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=60 head_norm_before_train=2.026264 cos_to_last_merge=0.7694 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.769
[S8] round=60 local utility u=0.043007 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9986509276673061, 'loss_val': 0.027037289302787506, 'psi': 0.9960757874262384}-{'f1_val': 0.9852111586232302, 'auprc': 0.9962225152999324, 'loss_val': 0.050878411768987664, 'psi': 0.9896157012939111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=60 head_norm_before_train=1.641370 cos_to_last_merge=0.9500 (last merge round=34)
[S9] round=60 local utility u=0.001748 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9987830058215852, 'loss_val': 0.02827961139335407, 'psi': 0.9976420593766636}-{'f1_val': 0.9964678035083712, 'auprc': 0.9987826262338839, 'loss_val': 0.029291813649987654, 'psi': 0.9973937325985762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=60 head_norm_before_train=2.213212 cos_to_last_merge=0.8142 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963506104591126, 'loss_val': 0.024830753437472312, 'psi': 0.9954001344091623}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963812809620871, 'loss_val': 0.024772233138976835, 'psi': 0.9954124026103521}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.700240 cos_to_last_merge=0.9733 (last merge round=34)
[S11] round=60 local utility u=0.000678 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962350334326763, 'loss_val': 0.02357337891976365, 'psi': 0.9961742183210561}-{'f1_val': 0.9961336749133093, 'auprc': 0.9959443737650275, 'loss_val': 0.024057574204313984, 'psi': 0.9960579544539966}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=60 head_norm_before_train=2.114890 (no previous merge yet)
[S13] round=60 local utility u=0.521498 metrics={'f1_val': 0.6760789670264036, 'auprc': 0.7812324587169645, 'loss_val': 1.3339847692913722, 'psi': 0.7181403637026279}-{'f1_val': 0.6185555746125515, 'auprc': 0.6358371662566924, 'loss_val': 1.5956543559373748, 'psi': 0.6254682112702079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=60 head_norm_before_train=1.663260 cos_to_last_merge=0.9941 (last merge round=40)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9978371090562672, 'loss_val': 0.03339394648232658, 'psi': 0.9969281920174133}-{'f1_val': 0.9963222473248441, 'auprc': 0.9981251065794603, 'loss_val': 0.032395628057353576, 'psi': 0.9970433910266905}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.842239 cos_to_last_merge=0.9691 (last merge round=39)
[S15] round=60 local utility u=0.534820 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9910739630618369, 'loss_val': 0.0248032941725832, 'psi': 0.9939967581098347}-{'f1_val': 0.8782932082016472, 'auprc': 0.9690255941647602, 'loss_val': 0.3223858316555617, 'psi': 0.9145861625868924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=60 head_norm_before_train=2.113327 cos_to_last_merge=0.9985 (last merge round=41)
[S16] round=60 local utility u=0.290358 metrics={'f1_val': 0.9914689605933074, 'auprc': 0.9909105138164926, 'loss_val': 0.04445613605447817, 'psi': 0.9912455818825814}-{'f1_val': 0.9421936249346594, 'auprc': 0.9840075752001279, 'loss_val': 0.3088117741246174, 'psi': 0.9589192050408468}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=60 head_norm_before_train=1.945304 cos_to_last_merge=0.9618 (last merge round=41)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.8388467984202901, 'auprc': 0.9989657206523385, 'loss_val': 0.6780694326596389, 'psi': 0.9028943673131093}-{'f1_val': 0.8767746932248927, 'auprc': 0.9190055045465845, 'loss_val': 0.578176365959408, 'psi': 0.8936670177535694}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=2.280882 (no previous merge yet)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7065895413234018, 'auprc': 0.9278845689938362, 'loss_val': 0.6501957575132699, 'psi': 0.7951075523915756}-{'f1_val': 0.7094399494984791, 'auprc': 0.9413187050439492, 'loss_val': 0.6563965143712227, 'psi': 0.8021914517166671}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.294734 (no previous merge yet)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.8306656073672565, 'auprc': 0.9965175819083477, 'loss_val': 0.24767167871568724, 'psi': 0.897006397183693}-{'f1_val': 0.9695540814927345, 'auprc': 0.9991510556735794, 'loss_val': 0.07395034744751922, 'psi': 0.9813928711650725}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=2.187911 cos_to_last_merge=0.9896 (last merge round=34)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9446785343459043, 'auprc': 0.9708832589136716, 'loss_val': 0.2901186096418024, 'psi': 0.9551604241730112}-{'f1_val': 0.9416659175731799, 'auprc': 0.9721775858984882, 'loss_val': 0.2693774276743844, 'psi': 0.9538705849033032}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.610115 cos_to_last_merge=0.9714 (last merge round=41)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9914721162150126, 'loss_val': 0.26173616826850926, 'psi': 0.8168329923145661}-{'f1_val': 0.9961867794578795, 'auprc': 0.9915344025983373, 'loss_val': 0.12191656641720601, 'psi': 0.9943258287140626}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.618605 cos_to_last_merge=0.9825 (last merge round=40)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.7097321200278383, 'auprc': 0.8746358998266466, 'loss_val': 0.7991924863649387, 'psi': 0.7756936319473616}-{'f1_val': 0.7228760660241441, 'auprc': 0.8794828707144381, 'loss_val': 0.8290115753679569, 'psi': 0.7855187879002616}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.616767 cos_to_last_merge=0.9898 (last merge round=41)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6521879267797113, 'auprc': 0.8050162086301738, 'loss_val': 0.5169212880329526, 'psi': 0.7133192395198962}-{'f1_val': 0.6807158761764108, 'auprc': 0.836737335222576, 'loss_val': 0.32523490257784005, 'psi': 0.743124459794877}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=2.031627 cos_to_last_merge=0.7697 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.770
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.87204433010944, 'auprc': 0.9866462245196672, 'loss_val': 0.2968838458476827, 'psi': 0.9178850878735308}-{'f1_val': 0.9943590272655265, 'auprc': 0.9986509276673061, 'loss_val': 0.027037289302787506, 'psi': 0.9960757874262384}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=1.650530 cos_to_last_merge=0.9491 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9951630418465134, 'loss_val': 0.027461863238790362, 'psi': 0.9961940737866349}-{'f1_val': 0.9968814284133827, 'auprc': 0.9987830058215852, 'loss_val': 0.02827961139335407, 'psi': 0.9976420593766636}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.218968 cos_to_last_merge=0.8138 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963287181135563, 'loss_val': 0.025019720567445374, 'psi': 0.9953913774709399}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963506104591126, 'loss_val': 0.024830753437472312, 'psi': 0.9954001344091623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.708969 cos_to_last_merge=0.9727 (last merge round=34)
[S11] round=61 local utility u=0.003031 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971999990491336, 'loss_val': 0.02288545381344351, 'psi': 0.9968082023278072}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962350334326763, 'loss_val': 0.02357337891976365, 'psi': 0.9961742183210561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=61 head_norm_before_train=2.120487 (no previous merge yet)
[S13] round=61 local utility u=0.272091 metrics={'f1_val': 0.7508955159042792, 'auprc': 0.7528291697272094, 'loss_val': 1.1534922759611081, 'psi': 0.7516689774334513}-{'f1_val': 0.6760789670264036, 'auprc': 0.7812324587169645, 'loss_val': 1.3339847692913722, 'psi': 0.7181403637026279}
[S13] not sending this round → trigger blocked (psi=0.752)
[S14] START round=61 head_norm_before_train=1.670353 cos_to_last_merge=0.9938 (last merge round=40)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9964741202403523, 'loss_val': 0.03315397667686868, 'psi': 0.9963829964910473}-{'f1_val': 0.9963222473248441, 'auprc': 0.9978371090562672, 'loss_val': 0.03339394648232658, 'psi': 0.9969281920174133}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.853676 cos_to_last_merge=0.9682 (last merge round=39)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9618968881061554, 'auprc': 0.9922217834667127, 'loss_val': 0.08839796500609637, 'psi': 0.9740268462503783}-{'f1_val': 0.9959452881418331, 'auprc': 0.9910739630618369, 'loss_val': 0.0248032941725832, 'psi': 0.9939967581098347}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=2.119936 cos_to_last_merge=0.9984 (last merge round=41)
[S16] round=61 local utility u=0.008200 metrics={'f1_val': 0.9920536576647919, 'auprc': 0.9936510791063629, 'loss_val': 0.03978514708627882, 'psi': 0.9926926262414203}-{'f1_val': 0.9914689605933074, 'auprc': 0.9909105138164926, 'loss_val': 0.04445613605447817, 'psi': 0.9912455818825814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=61 head_norm_before_train=1.959473 cos_to_last_merge=0.9609 (last merge round=41)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.7770882912267094, 'auprc': 0.8214309103743811, 'loss_val': 0.9573105897065279, 'psi': 0.794825338885778}-{'f1_val': 0.8388467984202901, 'auprc': 0.9989657206523385, 'loss_val': 0.6780694326596389, 'psi': 0.9028943673131093}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.281142 (no previous merge yet)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.6946328203292667, 'auprc': 0.8344048922232776, 'loss_val': 0.785394944048605, 'psi': 0.750541649086871}-{'f1_val': 0.7065895413234018, 'auprc': 0.9278845689938362, 'loss_val': 0.6501957575132699, 'psi': 0.7951075523915756}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.300742 (no previous merge yet)
[S3] round=62 local utility u=0.059589 metrics={'f1_val': 0.8575984178859954, 'auprc': 0.9971531046214059, 'loss_val': 0.29199752989292466, 'psi': 0.9134202925801597}-{'f1_val': 0.8306656073672565, 'auprc': 0.9965175819083477, 'loss_val': 0.24767167871568724, 'psi': 0.897006397183693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=62 head_norm_before_train=2.195297 cos_to_last_merge=0.9893 (last merge round=34)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9504745834841899, 'auprc': 0.9524762585234168, 'loss_val': 0.3052874667166041, 'psi': 0.9512752534998807}-{'f1_val': 0.9446785343459043, 'auprc': 0.9708832589136716, 'loss_val': 0.2901186096418024, 'psi': 0.9551604241730112}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.618213 cos_to_last_merge=0.9705 (last merge round=41)
[S5] round=62 local utility u=0.958892 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9915043171979012, 'loss_val': 0.11872800368096471, 'psi': 0.9943137945538881}-{'f1_val': 0.7004069097142683, 'auprc': 0.9914721162150126, 'loss_val': 0.26173616826850926, 'psi': 0.8168329923145661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=62 head_norm_before_train=1.627081 cos_to_last_merge=0.9815 (last merge round=40)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.5773779537500494, 'auprc': 0.6870939292055115, 'loss_val': 1.368843553833371, 'psi': 0.6212643439322343}-{'f1_val': 0.7097321200278383, 'auprc': 0.8746358998266466, 'loss_val': 0.7991924863649387, 'psi': 0.7756936319473616}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.623159 cos_to_last_merge=0.9893 (last merge round=41)
[S7] round=62 local utility u=0.431330 metrics={'f1_val': 0.7100104320786844, 'auprc': 0.8845107855515665, 'loss_val': 0.23967924065250323, 'psi': 0.7798105734678373}-{'f1_val': 0.6521879267797113, 'auprc': 0.8050162086301738, 'loss_val': 0.5169212880329526, 'psi': 0.7133192395198962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=62 head_norm_before_train=2.037951 cos_to_last_merge=0.7691 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.769
[S8] round=62 local utility u=0.513978 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9987041967055277, 'loss_val': 0.030199180843452116, 'psi': 0.9952180021611803}-{'f1_val': 0.87204433010944, 'auprc': 0.9866462245196672, 'loss_val': 0.2968838458476827, 'psi': 0.9178850878735308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=62 head_norm_before_train=1.660134 cos_to_last_merge=0.9481 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=62 local utility u=0.005632 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.998784824652267, 'loss_val': 0.027063625662894383, 'psi': 0.9976427869089364}-{'f1_val': 0.9968814284133827, 'auprc': 0.9951630418465134, 'loss_val': 0.027461863238790362, 'psi': 0.9961940737866349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=62 head_norm_before_train=2.222998 cos_to_last_merge=0.8134 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=62 local utility u=0.000125 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963380280132839, 'loss_val': 0.024797432564853738, 'psi': 0.9953951014308309}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963287181135563, 'loss_val': 0.025019720567445374, 'psi': 0.9953913774709399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=62 head_norm_before_train=1.715414 cos_to_last_merge=0.9722 (last merge round=34)
[S11] round=62 local utility u=0.000349 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973239555661397, 'loss_val': 0.022559641264222288, 'psi': 0.9968577849346096}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971999990491336, 'loss_val': 0.02288545381344351, 'psi': 0.9968082023278072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=62 head_norm_before_train=2.127560 (no previous merge yet)
[S13] round=62 local utility u=0.218410 metrics={'f1_val': 0.7561765821058606, 'auprc': 0.8351347065570888, 'loss_val': 0.9952755684988647, 'psi': 0.7877598318863519}-{'f1_val': 0.7508955159042792, 'auprc': 0.7528291697272094, 'loss_val': 1.1534922759611081, 'psi': 0.7516689774334513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=62 head_norm_before_train=1.677537 cos_to_last_merge=0.9934 (last merge round=40)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9959124528917772, 'auprc': 0.9959115200754362, 'loss_val': 0.032694712432120104, 'psi': 0.9959120797652408}-{'f1_val': 0.9963222473248441, 'auprc': 0.9964741202403523, 'loss_val': 0.03315397667686868, 'psi': 0.9963829964910473}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.864769 cos_to_last_merge=0.9673 (last merge round=39)
[S15] round=62 local utility u=0.138447 metrics={'f1_val': 0.9959606213387688, 'auprc': 0.9955763421298398, 'loss_val': 0.025950486471071517, 'psi': 0.9958069096551971}-{'f1_val': 0.9618968881061554, 'auprc': 0.9922217834667127, 'loss_val': 0.08839796500609637, 'psi': 0.9740268462503783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=62 head_norm_before_train=2.123781 cos_to_last_merge=0.9982 (last merge round=41)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9918554892289619, 'auprc': 0.9932220671063743, 'loss_val': 0.03827160846234574, 'psi': 0.9924021203799269}-{'f1_val': 0.9920536576647919, 'auprc': 0.9936510791063629, 'loss_val': 0.03978514708627882, 'psi': 0.9926926262414203}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.971206 cos_to_last_merge=0.9599 (last merge round=41)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.7740188035329141, 'auprc': 0.7385143490521706, 'loss_val': 0.9774286448141889, 'psi': 0.7598170217406166}-{'f1_val': 0.7770882912267094, 'auprc': 0.8214309103743811, 'loss_val': 0.9573105897065279, 'psi': 0.794825338885778}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.279899 (no previous merge yet)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.6684314959415103, 'auprc': 0.8127826336065666, 'loss_val': 0.9829068752722162, 'psi': 0.7261719510075328}-{'f1_val': 0.6946328203292667, 'auprc': 0.8344048922232776, 'loss_val': 0.785394944048605, 'psi': 0.750541649086871}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.306120 (no previous merge yet)
[S3] round=63 local utility u=0.172746 metrics={'f1_val': 0.9039034257768671, 'auprc': 0.9982647022851887, 'loss_val': 0.22767001520948227, 'psi': 0.9416479363801957}-{'f1_val': 0.8575984178859954, 'auprc': 0.9971531046214059, 'loss_val': 0.29199752989292466, 'psi': 0.9134202925801597}
[S3] not sending this round → trigger blocked (psi=0.942)
[S4] START round=63 head_norm_before_train=2.195398 cos_to_last_merge=0.9888 (last merge round=34)
[S4] round=63 local utility u=0.039794 metrics={'f1_val': 0.9463007229212139, 'auprc': 0.9738519737502733, 'loss_val': 0.2647824964683399, 'psi': 0.9573212232528376}-{'f1_val': 0.9504745834841899, 'auprc': 0.9524762585234168, 'loss_val': 0.3052874667166041, 'psi': 0.9512752534998807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=63 head_norm_before_train=1.624839 cos_to_last_merge=0.9695 (last merge round=41)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.8706854757397279, 'auprc': 0.9913244961418528, 'loss_val': 0.1522970152884845, 'psi': 0.9189410839005778}-{'f1_val': 0.9961867794578795, 'auprc': 0.9915043171979012, 'loss_val': 0.11872800368096471, 'psi': 0.9943137945538881}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.637549 cos_to_last_merge=0.9802 (last merge round=40)
[S6] round=63 local utility u=1.000000 metrics={'f1_val': 0.8228604169437989, 'auprc': 0.9604232781491432, 'loss_val': 0.4855436961903438, 'psi': 0.8778855614259367}-{'f1_val': 0.5773779537500494, 'auprc': 0.6870939292055115, 'loss_val': 1.368843553833371, 'psi': 0.6212643439322343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=63 head_norm_before_train=1.631477 cos_to_last_merge=0.9887 (last merge round=41)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6205022227024031, 'auprc': 0.7974590668626697, 'loss_val': 0.5959418734165999, 'psi': 0.6912849603665097}-{'f1_val': 0.7100104320786844, 'auprc': 0.8845107855515665, 'loss_val': 0.23967924065250323, 'psi': 0.7798105734678373}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=2.042850 cos_to_last_merge=0.7685 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.769
[S8] round=63 local utility u=0.001941 metrics={'f1_val': 0.9934699479610548, 'auprc': 0.9986687209493614, 'loss_val': 0.029666474480500207, 'psi': 0.9955494571563774}-{'f1_val': 0.9928938724649488, 'auprc': 0.9987041967055277, 'loss_val': 0.030199180843452116, 'psi': 0.9952180021611803}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=63 head_norm_before_train=1.667763 cos_to_last_merge=0.9472 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9960536850584089, 'auprc': 0.9987804843380989, 'loss_val': 0.026688354371157227, 'psi': 0.9971444047702849}-{'f1_val': 0.9968814284133827, 'auprc': 0.998784824652267, 'loss_val': 0.027063625662894383, 'psi': 0.9976427869089364}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.228258 cos_to_last_merge=0.8130 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959081388939408, 'loss_val': 0.025057689259747874, 'psi': 0.9952231457830937}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963380280132839, 'loss_val': 0.024797432564853738, 'psi': 0.9953951014308309}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.722825 cos_to_last_merge=0.9717 (last merge round=34)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972255410431801, 'loss_val': 0.022514503179734073, 'psi': 0.9968184191254258}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973239555661397, 'loss_val': 0.022559641264222288, 'psi': 0.9968577849346096}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=2.129019 (no previous merge yet)
[S13] round=63 local utility u=0.007372 metrics={'f1_val': 0.7507329954974424, 'auprc': 0.8614719845500416, 'loss_val': 1.026882387680734, 'psi': 0.7950285911184821}-{'f1_val': 0.7561765821058606, 'auprc': 0.8351347065570888, 'loss_val': 0.9952755684988647, 'psi': 0.7877598318863519}
[S13] not sending this round → trigger blocked (psi=0.795)
[S14] START round=63 head_norm_before_train=1.683756 cos_to_last_merge=0.9931 (last merge round=40)
[S14] round=63 local utility u=0.002368 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.996399754517304, 'loss_val': 0.0318817146288314, 'psi': 0.996353250201828}-{'f1_val': 0.9959124528917772, 'auprc': 0.9959115200754362, 'loss_val': 0.032694712432120104, 'psi': 0.9959120797652408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=63 head_norm_before_train=1.876261 cos_to_last_merge=0.9664 (last merge round=39)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.9271480509191388, 'auprc': 0.9951302702166185, 'loss_val': 0.17540271515294117, 'psi': 0.9543409386381307}-{'f1_val': 0.9959606213387688, 'auprc': 0.9955763421298398, 'loss_val': 0.025950486471071517, 'psi': 0.9958069096551971}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=2.124988 cos_to_last_merge=0.9980 (last merge round=41)
[S16] round=63 local utility u=0.001077 metrics={'f1_val': 0.992074503211585, 'auprc': 0.9932946372018733, 'loss_val': 0.0376492185267252, 'psi': 0.9925625568077003}-{'f1_val': 0.9918554892289619, 'auprc': 0.9932220671063743, 'loss_val': 0.03827160846234574, 'psi': 0.9924021203799269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=63 head_norm_before_train=1.984634 cos_to_last_merge=0.9588 (last merge round=41)
[S17] round=63 local utility u=0.158348 metrics={'f1_val': 0.7719382666733072, 'auprc': 0.8737411038030174, 'loss_val': 1.0539288726431897, 'psi': 0.8126594015251913}-{'f1_val': 0.7740188035329141, 'auprc': 0.7385143490521706, 'loss_val': 0.9774286448141889, 'psi': 0.7598170217406166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=64 head_norm_before_train=2.280257 (no previous merge yet)
[S2] round=64 local utility u=0.463448 metrics={'f1_val': 0.7076746967497358, 'auprc': 0.9266699387349829, 'loss_val': 0.633131530903912, 'psi': 0.7952727935438346}-{'f1_val': 0.6684314959415103, 'auprc': 0.8127826336065666, 'loss_val': 0.9829068752722162, 'psi': 0.7261719510075328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=64 head_norm_before_train=2.312066 (no previous merge yet)
[S3] round=64 local utility u=0.129483 metrics={'f1_val': 0.932363253336682, 'auprc': 0.9989033325403595, 'loss_val': 0.14137867558172296, 'psi': 0.958979285018153}-{'f1_val': 0.9039034257768671, 'auprc': 0.9982647022851887, 'loss_val': 0.22767001520948227, 'psi': 0.9416479363801957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=64 head_norm_before_train=2.200079 cos_to_last_merge=0.9885 (last merge round=34)
[S4] round=64 local utility u=0.011633 metrics={'f1_val': 0.944958934949237, 'auprc': 0.978764337112902, 'loss_val': 0.24820372720867673, 'psi': 0.958481095814703}-{'f1_val': 0.9463007229212139, 'auprc': 0.9738519737502733, 'loss_val': 0.2647824964683399, 'psi': 0.9573212232528376}
[S4] not sending this round → trigger blocked (psi=0.958)
[S5] START round=64 head_norm_before_train=1.634954 cos_to_last_merge=0.9680 (last merge round=41)
[S5] round=64 local utility u=0.260439 metrics={'f1_val': 0.9529284433491216, 'auprc': 0.9907410082221328, 'loss_val': 0.1231271655485546, 'psi': 0.9680534692983261}-{'f1_val': 0.8706854757397279, 'auprc': 0.9913244961418528, 'loss_val': 0.1522970152884845, 'psi': 0.9189410839005778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=64 head_norm_before_train=1.645881 cos_to_last_merge=0.9793 (last merge round=40)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.5413336906841762, 'auprc': 0.6865372863167154, 'loss_val': 1.4042352567843044, 'psi': 0.5994151289371918}-{'f1_val': 0.8228604169437989, 'auprc': 0.9604232781491432, 'loss_val': 0.4855436961903438, 'psi': 0.8778855614259367}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.638326 cos_to_last_merge=0.9882 (last merge round=41)
[S7] round=64 local utility u=0.280233 metrics={'f1_val': 0.6743713851490838, 'auprc': 0.8178609470581077, 'loss_val': 0.4198974859973281, 'psi': 0.7317672099126933}-{'f1_val': 0.6205022227024031, 'auprc': 0.7974590668626697, 'loss_val': 0.5959418734165999, 'psi': 0.6912849603665097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=64 head_norm_before_train=2.046873 cos_to_last_merge=0.7678 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.768
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9710458394989838, 'auprc': 0.9990881763247779, 'loss_val': 0.07319019526709133, 'psi': 0.9822627742293015}-{'f1_val': 0.9934699479610548, 'auprc': 0.9986687209493614, 'loss_val': 0.029666474480500207, 'psi': 0.9955494571563774}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=1.675645 cos_to_last_merge=0.9463 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9949454012730496, 'loss_val': 0.025766027807484864, 'psi': 0.9961070175572494}-{'f1_val': 0.9960536850584089, 'auprc': 0.9987804843380989, 'loss_val': 0.026688354371157227, 'psi': 0.9971444047702849}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.233207 cos_to_last_merge=0.8126 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=64 local utility u=0.000085 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959078145311047, 'loss_val': 0.0248868023957148, 'psi': 0.9952230160379592}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959081388939408, 'loss_val': 0.025057689259747874, 'psi': 0.9952231457830937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=64 head_norm_before_train=1.730653 cos_to_last_merge=0.9712 (last merge round=34)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966639603486207, 'loss_val': 0.02288337545187675, 'psi': 0.9963457890874339}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972255410431801, 'loss_val': 0.022514503179734073, 'psi': 0.9968184191254258}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=2.131973 (no previous merge yet)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6221355893521509, 'auprc': 0.6823496316991581, 'loss_val': 1.492932989802972, 'psi': 0.6462212062909538}-{'f1_val': 0.7507329954974424, 'auprc': 0.8614719845500416, 'loss_val': 1.026882387680734, 'psi': 0.7950285911184821}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.689396 cos_to_last_merge=0.9929 (last merge round=40)
[S14] round=64 local utility u=0.001626 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9980078860986531, 'loss_val': 0.03345316871138501, 'psi': 0.9969965028343677}-{'f1_val': 0.9963222473248441, 'auprc': 0.996399754517304, 'loss_val': 0.0318817146288314, 'psi': 0.996353250201828}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=64 head_norm_before_train=1.887335 cos_to_last_merge=0.9656 (last merge round=39)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9056193611281108, 'auprc': 0.9866270532852137, 'loss_val': 0.2546372234737363, 'psi': 0.9380224379909521}-{'f1_val': 0.9271480509191388, 'auprc': 0.9951302702166185, 'loss_val': 0.17540271515294117, 'psi': 0.9543409386381307}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.126290 cos_to_last_merge=0.9978 (last merge round=41)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9920536576647919, 'auprc': 0.9937724361450802, 'loss_val': 0.03896332258541249, 'psi': 0.9927411690569072}-{'f1_val': 0.992074503211585, 'auprc': 0.9932946372018733, 'loss_val': 0.0376492185267252, 'psi': 0.9925625568077003}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.996652 cos_to_last_merge=0.9579 (last merge round=41)
[S17] round=64 local utility u=0.304398 metrics={'f1_val': 0.8167704107591656, 'auprc': 0.9216271074909528, 'loss_val': 0.857784024939249, 'psi': 0.8587130894518804}-{'f1_val': 0.7719382666733072, 'auprc': 0.8737411038030174, 'loss_val': 1.0539288726431897, 'psi': 0.8126594015251913}
[S17] not sending this round → trigger blocked (psi=0.859)
[S2] START round=65 head_norm_before_train=2.286965 (no previous merge yet)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7074226620003343, 'auprc': 0.9083072987891738, 'loss_val': 0.6370119317412809, 'psi': 0.7877765167158701}-{'f1_val': 0.7076746967497358, 'auprc': 0.9266699387349829, 'loss_val': 0.633131530903912, 'psi': 0.7952727935438346}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.318215 (no previous merge yet)
[S3] round=65 local utility u=0.099626 metrics={'f1_val': 0.9564913206769017, 'auprc': 0.9989207139352905, 'loss_val': 0.08694706866606551, 'psi': 0.9734630779802571}-{'f1_val': 0.932363253336682, 'auprc': 0.9989033325403595, 'loss_val': 0.14137867558172296, 'psi': 0.958979285018153}
[S3] not sending this round → trigger blocked (psi=0.973)
[S4] START round=65 head_norm_before_train=2.207968 cos_to_last_merge=0.9881 (last merge round=34)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9447436145667071, 'auprc': 0.9740901550022496, 'loss_val': 0.25972013692271423, 'psi': 0.9564822307409241}-{'f1_val': 0.944958934949237, 'auprc': 0.978764337112902, 'loss_val': 0.24820372720867673, 'psi': 0.958481095814703}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.643933 cos_to_last_merge=0.9666 (last merge round=41)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.709163778872368, 'auprc': 0.9085947508049916, 'loss_val': 0.45069200710042545, 'psi': 0.7889361676454175}-{'f1_val': 0.9529284433491216, 'auprc': 0.9907410082221328, 'loss_val': 0.1231271655485546, 'psi': 0.9680534692983261}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.659479 cos_to_last_merge=0.9783 (last merge round=40)
[S6] round=65 local utility u=0.636462 metrics={'f1_val': 0.6346444591711352, 'auprc': 0.8302626264106041, 'loss_val': 1.1223515534937982, 'psi': 0.7128917260669227}-{'f1_val': 0.5413336906841762, 'auprc': 0.6865372863167154, 'loss_val': 1.4042352567843044, 'psi': 0.5994151289371918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=65 head_norm_before_train=1.645296 cos_to_last_merge=0.9876 (last merge round=41)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5600871821522834, 'auprc': 0.7937594470834237, 'loss_val': 0.9105941627911668, 'psi': 0.6535560881247395}-{'f1_val': 0.6743713851490838, 'auprc': 0.8178609470581077, 'loss_val': 0.4198974859973281, 'psi': 0.7317672099126933}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=2.052708 cos_to_last_merge=0.7668 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.767
[S8] round=65 local utility u=0.092509 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9988831659892474, 'loss_val': 0.026110132731643174, 'psi': 0.9960361225583837}-{'f1_val': 0.9710458394989838, 'auprc': 0.9990881763247779, 'loss_val': 0.07319019526709133, 'psi': 0.9822627742293015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=65 head_norm_before_train=1.683265 cos_to_last_merge=0.9455 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9964710073874787, 'auprc': 0.9946680881884266, 'loss_val': 0.025274551335797646, 'psi': 0.9957498397078579}-{'f1_val': 0.9968814284133827, 'auprc': 0.9949454012730496, 'loss_val': 0.025766027807484864, 'psi': 0.9961070175572494}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.241693 cos_to_last_merge=0.8122 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=65 local utility u=0.000829 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.996354691687183, 'loss_val': 0.024569136485212587, 'psi': 0.9954017669003905}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959078145311047, 'loss_val': 0.0248868023957148, 'psi': 0.9952230160379592}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=65 head_norm_before_train=1.737913 cos_to_last_merge=0.9708 (last merge round=34)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966533078719049, 'loss_val': 0.026239234136446993, 'psi': 0.9963415280967476}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966639603486207, 'loss_val': 0.02288337545187675, 'psi': 0.9963457890874339}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=2.139811 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.5313451351555161, 'auprc': 0.6324570424934193, 'loss_val': 1.834892679308494, 'psi': 0.5717898980906774}-{'f1_val': 0.6221355893521509, 'auprc': 0.6823496316991581, 'loss_val': 1.492932989802972, 'psi': 0.6462212062909538}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.694447 cos_to_last_merge=0.9926 (last merge round=40)
[S14] round=65 local utility u=0.001626 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9983836873276553, 'loss_val': 0.03132954890609356, 'psi': 0.9971468233259685}-{'f1_val': 0.9963222473248441, 'auprc': 0.9980078860986531, 'loss_val': 0.03345316871138501, 'psi': 0.9969965028343677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=65 head_norm_before_train=1.897401 cos_to_last_merge=0.9649 (last merge round=39)
[S15] round=65 local utility u=0.337419 metrics={'f1_val': 0.978937826406371, 'auprc': 0.9965918028869293, 'loss_val': 0.04960439090502899, 'psi': 0.9859994169985942}-{'f1_val': 0.9056193611281108, 'auprc': 0.9866270532852137, 'loss_val': 0.2546372234737363, 'psi': 0.9380224379909521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=65 head_norm_before_train=2.128687 cos_to_last_merge=0.9975 (last merge round=41)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9255222607784264, 'auprc': 0.9740397187398266, 'loss_val': 0.4930701794822434, 'psi': 0.9449292439629865}-{'f1_val': 0.9920536576647919, 'auprc': 0.9937724361450802, 'loss_val': 0.03896332258541249, 'psi': 0.9927411690569072}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=2.007480 cos_to_last_merge=0.9569 (last merge round=41)
[S17] round=65 local utility u=0.103457 metrics={'f1_val': 0.8325349554758292, 'auprc': 0.9296762444596939, 'loss_val': 0.7696039247640274, 'psi': 0.8713914710693751}-{'f1_val': 0.8167704107591656, 'auprc': 0.9216271074909528, 'loss_val': 0.857784024939249, 'psi': 0.8587130894518804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=66 head_norm_before_train=2.290457 (no previous merge yet)
[S2] round=66 local utility u=0.069729 metrics={'f1_val': 0.7070893229111054, 'auprc': 0.9539289677956755, 'loss_val': 0.6324182460026283, 'psi': 0.8058251808649335}-{'f1_val': 0.7074226620003343, 'auprc': 0.9083072987891738, 'loss_val': 0.6370119317412809, 'psi': 0.7877765167158701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=66 head_norm_before_train=2.324589 (no previous merge yet)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.9588275782550102, 'auprc': 0.9996248742491466, 'loss_val': 0.1542258972438743, 'psi': 0.9751464966526648}-{'f1_val': 0.9564913206769017, 'auprc': 0.9989207139352905, 'loss_val': 0.08694706866606551, 'psi': 0.9734630779802571}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.216080 cos_to_last_merge=0.9878 (last merge round=34)
[S4] round=66 local utility u=0.032552 metrics={'f1_val': 0.9511757621252848, 'auprc': 0.9861504510245653, 'loss_val': 0.2693904197982423, 'psi': 0.9651656376849971}-{'f1_val': 0.9447436145667071, 'auprc': 0.9740901550022496, 'loss_val': 0.25972013692271423, 'psi': 0.9564822307409241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=66 head_norm_before_train=1.654969 cos_to_last_merge=0.9652 (last merge round=41)
[S5] round=66 local utility u=1.000000 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9961882872018165, 'loss_val': 0.05602366689425737, 'psi': 0.9961873825554542}-{'f1_val': 0.709163778872368, 'auprc': 0.9085947508049916, 'loss_val': 0.45069200710042545, 'psi': 0.7889361676454175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=66 head_norm_before_train=1.674127 cos_to_last_merge=0.9775 (last merge round=40)
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.862295934616533, 'auprc': 0.9304668691886218, 'loss_val': 0.4441259553150937, 'psi': 0.8895643084453686}-{'f1_val': 0.6346444591711352, 'auprc': 0.8302626264106041, 'loss_val': 1.1223515534937982, 'psi': 0.7128917260669227}
[S6] not sending this round → trigger blocked (psi=0.890)
[S7] START round=66 head_norm_before_train=1.650703 cos_to_last_merge=0.9872 (last merge round=41)
[S7] round=66 local utility u=0.716467 metrics={'f1_val': 0.6807317000456039, 'auprc': 0.8375385707930046, 'loss_val': 0.33286534062982004, 'psi': 0.7434544483445642}-{'f1_val': 0.5600871821522834, 'auprc': 0.7937594470834237, 'loss_val': 0.9105941627911668, 'psi': 0.6535560881247395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=66 head_norm_before_train=2.062744 cos_to_last_merge=0.7658 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.766
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9990133765646025, 'loss_val': 0.02996914756753253, 'psi': 0.9954282713768404}-{'f1_val': 0.9941380936044745, 'auprc': 0.9988831659892474, 'loss_val': 0.026110132731643174, 'psi': 0.9960361225583837}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=1.690253 cos_to_last_merge=0.9447 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=66 local utility u=0.003164 metrics={'f1_val': 0.9956348431256092, 'auprc': 0.9987212959679472, 'loss_val': 0.02608858124802602, 'psi': 0.9968694242625444}-{'f1_val': 0.9964710073874787, 'auprc': 0.9946680881884266, 'loss_val': 0.025274551335797646, 'psi': 0.9957498397078579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=66 head_norm_before_train=2.247698 cos_to_last_merge=0.8118 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959354057019043, 'loss_val': 0.024886799801696304, 'psi': 0.995234052506279}-{'f1_val': 0.9947664837091956, 'auprc': 0.996354691687183, 'loss_val': 0.024569136485212587, 'psi': 0.9954017669003905}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.744558 cos_to_last_merge=0.9706 (last merge round=34)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9966853557145107, 'loss_val': 0.037934003285378604, 'psi': 0.9966046952828627}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966533078719049, 'loss_val': 0.026239234136446993, 'psi': 0.9963415280967476}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=2.144705 (no previous merge yet)
[S13] round=66 local utility u=1.000000 metrics={'f1_val': 0.6725293748268282, 'auprc': 0.940049401734143, 'loss_val': 1.087126569828493, 'psi': 0.779537385589754}-{'f1_val': 0.5313451351555161, 'auprc': 0.6324570424934193, 'loss_val': 1.834892679308494, 'psi': 0.5717898980906774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=66 head_norm_before_train=1.698497 cos_to_last_merge=0.9923 (last merge round=40)
[S14] round=66 local utility u=0.000629 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9984080310980078, 'loss_val': 0.030144516870607097, 'psi': 0.9971565608341095}-{'f1_val': 0.9963222473248441, 'auprc': 0.9983836873276553, 'loss_val': 0.03132954890609356, 'psi': 0.9971468233259685}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=66 head_norm_before_train=1.907647 cos_to_last_merge=0.9641 (last merge round=39)
[S15] round=66 local utility u=0.053473 metrics={'f1_val': 0.995965101761962, 'auprc': 0.9894398710099797, 'loss_val': 0.02336569003107513, 'psi': 0.9933550094611691}-{'f1_val': 0.978937826406371, 'auprc': 0.9965918028869293, 'loss_val': 0.04960439090502899, 'psi': 0.9859994169985942}
[S15] not sending this round → trigger blocked (psi=0.993)
[S16] START round=66 head_norm_before_train=2.132967 cos_to_last_merge=0.9973 (last merge round=41)
[S16] round=66 local utility u=0.183460 metrics={'f1_val': 0.9426121717911639, 'auprc': 0.9855248668213754, 'loss_val': 0.26314566968526515, 'psi': 0.9597772498032484}-{'f1_val': 0.9255222607784264, 'auprc': 0.9740397187398266, 'loss_val': 0.4930701794822434, 'psi': 0.9449292439629865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=66 head_norm_before_train=2.018973 cos_to_last_merge=0.9557 (last merge round=41)
[S17] round=66 local utility u=0.266001 metrics={'f1_val': 0.8793987447414988, 'auprc': 0.9561364152658002, 'loss_val': 0.5981654423633941, 'psi': 0.9100938129512194}-{'f1_val': 0.8325349554758292, 'auprc': 0.9296762444596939, 'loss_val': 0.7696039247640274, 'psi': 0.8713914710693751}
[S17] not sending this round → trigger blocked (psi=0.910)
[S2] START round=67 head_norm_before_train=2.296837 (no previous merge yet)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7004019203609192, 'auprc': 0.8833938309609333, 'loss_val': 0.6918964184719624, 'psi': 0.7735986846009248}-{'f1_val': 0.7070893229111054, 'auprc': 0.9539289677956755, 'loss_val': 0.6324182460026283, 'psi': 0.8058251808649335}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.330668 (no previous merge yet)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9244426689969589, 'auprc': 0.994153013424276, 'loss_val': 0.2744085447275451, 'psi': 0.9523268067678857}-{'f1_val': 0.9588275782550102, 'auprc': 0.9996248742491466, 'loss_val': 0.1542258972438743, 'psi': 0.9751464966526648}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.222058 cos_to_last_merge=0.9874 (last merge round=34)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9567168836883967, 'auprc': 0.9668191700293363, 'loss_val': 0.29673243620008694, 'psi': 0.9607577982247725}-{'f1_val': 0.9511757621252848, 'auprc': 0.9861504510245653, 'loss_val': 0.2693904197982423, 'psi': 0.9651656376849971}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.663134 cos_to_last_merge=0.9643 (last merge round=41)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.8098740671197964, 'auprc': 0.9908629020670747, 'loss_val': 0.23009737293453758, 'psi': 0.8822696010987077}-{'f1_val': 0.9961867794578795, 'auprc': 0.9961882872018165, 'loss_val': 0.05602366689425737, 'psi': 0.9961873825554542}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.683873 cos_to_last_merge=0.9767 (last merge round=40)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7049204012697494, 'auprc': 0.9239807136718311, 'loss_val': 0.9322494167458711, 'psi': 0.7925445262305821}-{'f1_val': 0.862295934616533, 'auprc': 0.9304668691886218, 'loss_val': 0.4441259553150937, 'psi': 0.8895643084453686}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.654455 cos_to_last_merge=0.9869 (last merge round=41)
[S7] round=67 local utility u=0.859018 metrics={'f1_val': 0.8846777511576355, 'auprc': 0.9557583170951246, 'loss_val': 0.19316541956936167, 'psi': 0.913109977532631}-{'f1_val': 0.6807317000456039, 'auprc': 0.8375385707930046, 'loss_val': 0.33286534062982004, 'psi': 0.7434544483445642}
[S7] not sending this round → trigger blocked (psi=0.913)
[S8] START round=67 head_norm_before_train=2.068158 cos_to_last_merge=0.7649 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.765
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9894075910087391, 'auprc': 0.998991510589637, 'loss_val': 0.03428805470310725, 'psi': 0.9932411588410983}-{'f1_val': 0.9930382012516658, 'auprc': 0.9990133765646025, 'loss_val': 0.02996914756753253, 'psi': 0.9954282713768404}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.697694 cos_to_last_merge=0.9440 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=67 local utility u=0.000890 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9963341290251375, 'loss_val': 0.024625831219080917, 'psi': 0.9966625086580846}-{'f1_val': 0.9956348431256092, 'auprc': 0.9987212959679472, 'loss_val': 0.02608858124802602, 'psi': 0.9968694242625444}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=67 head_norm_before_train=2.253276 cos_to_last_merge=0.8114 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=67 local utility u=0.000894 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9964133466563976, 'loss_val': 0.024532433806612106, 'psi': 0.9954252288880764}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959354057019043, 'loss_val': 0.024886799801696304, 'psi': 0.995234052506279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=67 head_norm_before_train=1.751272 cos_to_last_merge=0.9702 (last merge round=34)
[S11] round=67 local utility u=0.005762 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961138674514064, 'loss_val': 0.022191253761497942, 'psi': 0.9961257519285481}-{'f1_val': 0.9965509216617638, 'auprc': 0.9966853557145107, 'loss_val': 0.037934003285378604, 'psi': 0.9966046952828627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=67 head_norm_before_train=2.144073 (no previous merge yet)
[S13] round=67 local utility u=0.209681 metrics={'f1_val': 0.7450470234821456, 'auprc': 0.8881852660845516, 'loss_val': 0.9472771648573064, 'psi': 0.802302320523108}-{'f1_val': 0.6725293748268282, 'auprc': 0.940049401734143, 'loss_val': 1.087126569828493, 'psi': 0.779537385589754}
[S13] not sending this round → trigger blocked (psi=0.802)
[S14] START round=67 head_norm_before_train=1.704014 cos_to_last_merge=0.9920 (last merge round=40)
[S14] round=67 local utility u=0.000332 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.998436226737283, 'loss_val': 0.02956593525466246, 'psi': 0.9971678390898197}-{'f1_val': 0.9963222473248441, 'auprc': 0.9984080310980078, 'loss_val': 0.030144516870607097, 'psi': 0.9971565608341095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=67 head_norm_before_train=1.917030 cos_to_last_merge=0.9633 (last merge round=39)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.8539754545263434, 'loss_val': 0.663824826946486, 'psi': 0.762049735071987}-{'f1_val': 0.995965101761962, 'auprc': 0.9894398710099797, 'loss_val': 0.02336569003107513, 'psi': 0.9933550094611691}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=2.138243 cos_to_last_merge=0.9973 (last merge round=41)
[S16] round=67 local utility u=0.081953 metrics={'f1_val': 0.9510261685499687, 'auprc': 0.9873336812081142, 'loss_val': 0.1551496479795386, 'psi': 0.9655491736132269}-{'f1_val': 0.9426121717911639, 'auprc': 0.9855248668213754, 'loss_val': 0.26314566968526515, 'psi': 0.9597772498032484}
[S16] not sending this round → trigger blocked (psi=0.966)
[S17] START round=67 head_norm_before_train=2.030276 cos_to_last_merge=0.9552 (last merge round=41)
[S17] round=67 local utility u=0.028747 metrics={'f1_val': 0.8817917839143434, 'auprc': 0.9706949134323455, 'loss_val': 0.5987049421317452, 'psi': 0.9173530357215443}-{'f1_val': 0.8793987447414988, 'auprc': 0.9561364152658002, 'loss_val': 0.5981654423633941, 'psi': 0.9100938129512194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=68 head_norm_before_train=2.303554 (no previous merge yet)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.6703668221486081, 'auprc': 0.8136835786574314, 'loss_val': 0.9260767144900394, 'psi': 0.7276935247521374}-{'f1_val': 0.7004019203609192, 'auprc': 0.8833938309609333, 'loss_val': 0.6918964184719624, 'psi': 0.7735986846009248}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.336072 (no previous merge yet)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.7270647086412548, 'auprc': 0.9406872841408959, 'loss_val': 0.44593511274539066, 'psi': 0.8125137388411112}-{'f1_val': 0.9244426689969589, 'auprc': 0.994153013424276, 'loss_val': 0.2744085447275451, 'psi': 0.9523268067678857}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=2.226321 cos_to_last_merge=0.9871 (last merge round=34)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9405765303359475, 'auprc': 0.974579716241522, 'loss_val': 0.27429707782218576, 'psi': 0.9541778046981773}-{'f1_val': 0.9567168836883967, 'auprc': 0.9668191700293363, 'loss_val': 0.29673243620008694, 'psi': 0.9607577982247725}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.668407 cos_to_last_merge=0.9640 (last merge round=41)
[S5] round=68 local utility u=0.643060 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9932400364606683, 'loss_val': 0.06898435802160603, 'psi': 0.995008082258995}-{'f1_val': 0.8098740671197964, 'auprc': 0.9908629020670747, 'loss_val': 0.23009737293453758, 'psi': 0.8822696010987077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=68 head_norm_before_train=1.692658 cos_to_last_merge=0.9757 (last merge round=40)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.707447813528578, 'auprc': 0.8712270443936051, 'loss_val': 0.8417829573591079, 'psi': 0.7729595058745888}-{'f1_val': 0.7049204012697494, 'auprc': 0.9239807136718311, 'loss_val': 0.9322494167458711, 'psi': 0.7925445262305821}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.658732 cos_to_last_merge=0.9867 (last merge round=41)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.6107902133971097, 'auprc': 0.7964291342622457, 'loss_val': 0.6580671166708566, 'psi': 0.6850457817431641}-{'f1_val': 0.8846777511576355, 'auprc': 0.9557583170951246, 'loss_val': 0.19316541956936167, 'psi': 0.913109977532631}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.073431 cos_to_last_merge=0.7644 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.764
[S8] round=68 local utility u=0.013537 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.998936360976209, 'loss_val': 0.028832588581617156, 'psi': 0.995397465141483}-{'f1_val': 0.9894075910087391, 'auprc': 0.998991510589637, 'loss_val': 0.03428805470310725, 'psi': 0.9932411588410983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=68 head_norm_before_train=1.705073 cos_to_last_merge=0.9432 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9959057101763299, 'loss_val': 0.024127279316764116, 'psi': 0.9964911411185615}-{'f1_val': 0.9968814284133827, 'auprc': 0.9963341290251375, 'loss_val': 0.024625831219080917, 'psi': 0.9966625086580846}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.261732 cos_to_last_merge=0.8110 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.995992999351407, 'loss_val': 0.02488191225064053, 'psi': 0.9952570899660802}-{'f1_val': 0.9947664837091956, 'auprc': 0.9964133466563976, 'loss_val': 0.024532433806612106, 'psi': 0.9954252288880764}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.756737 cos_to_last_merge=0.9698 (last merge round=34)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996139226069505, 'loss_val': 0.022395659966038622, 'psi': 0.9961358953757876}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961138674514064, 'loss_val': 0.022191253761497942, 'psi': 0.9961257519285481}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=2.144069 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.7514194333727329, 'auprc': 0.8628744630673683, 'loss_val': 1.1302227397115008, 'psi': 0.796001445250587}-{'f1_val': 0.7450470234821456, 'auprc': 0.8881852660845516, 'loss_val': 0.9472771648573064, 'psi': 0.802302320523108}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.708807 cos_to_last_merge=0.9916 (last merge round=40)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9967422623409953, 'loss_val': 0.032811825555165125, 'psi': 0.9967364194357946}-{'f1_val': 0.9963222473248441, 'auprc': 0.998436226737283, 'loss_val': 0.02956593525466246, 'psi': 0.9971678390898197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.925251 cos_to_last_merge=0.9626 (last merge round=39)
[S15] round=68 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976321527413772, 'loss_val': 0.021288170017795028, 'psi': 0.9971008621290632}-{'f1_val': 0.7007659221024161, 'auprc': 0.8539754545263434, 'loss_val': 0.663824826946486, 'psi': 0.762049735071987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=68 head_norm_before_train=2.141770 cos_to_last_merge=0.9973 (last merge round=41)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.9453178405647417, 'auprc': 0.984858685359837, 'loss_val': 0.18809149110922355, 'psi': 0.9611341784827798}-{'f1_val': 0.9510261685499687, 'auprc': 0.9873336812081142, 'loss_val': 0.1551496479795386, 'psi': 0.9655491736132269}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=2.042699 cos_to_last_merge=0.9547 (last merge round=41)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.828998598460512, 'auprc': 0.9688543441967252, 'loss_val': 0.8174021837464837, 'psi': 0.8849408967549973}-{'f1_val': 0.8817917839143434, 'auprc': 0.9706949134323455, 'loss_val': 0.5987049421317452, 'psi': 0.9173530357215443}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.309425 (no previous merge yet)
[S2] round=69 local utility u=0.335652 metrics={'f1_val': 0.701430658422139, 'auprc': 0.8932499336040318, 'loss_val': 0.6798551579049472, 'psi': 0.7781583684948962}-{'f1_val': 0.6703668221486081, 'auprc': 0.8136835786574314, 'loss_val': 0.9260767144900394, 'psi': 0.7276935247521374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=69 head_norm_before_train=2.340186 (no previous merge yet)
[S3] round=69 local utility u=1.000000 metrics={'f1_val': 0.9971122502560278, 'auprc': 0.9990905167810542, 'loss_val': 0.018474117009730805, 'psi': 0.9979035568660384}-{'f1_val': 0.7270647086412548, 'auprc': 0.9406872841408959, 'loss_val': 0.44593511274539066, 'psi': 0.8125137388411112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=69 head_norm_before_train=2.232014 cos_to_last_merge=0.9870 (last merge round=34)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9388977952352566, 'auprc': 0.956742131272882, 'loss_val': 0.2750265174354279, 'psi': 0.9460355296503067}-{'f1_val': 0.9405765303359475, 'auprc': 0.974579716241522, 'loss_val': 0.27429707782218576, 'psi': 0.9541778046981773}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.675380 cos_to_last_merge=0.9634 (last merge round=41)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9914980043722894, 'loss_val': 0.07240923223497657, 'psi': 0.9941351960201195}-{'f1_val': 0.9961867794578795, 'auprc': 0.9932400364606683, 'loss_val': 0.06898435802160603, 'psi': 0.995008082258995}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.701722 cos_to_last_merge=0.9748 (last merge round=40)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.6002470786780303, 'auprc': 0.8330648757017741, 'loss_val': 1.2034515153750285, 'psi': 0.6933741974875278}-{'f1_val': 0.707447813528578, 'auprc': 0.8712270443936051, 'loss_val': 0.8417829573591079, 'psi': 0.7729595058745888}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.661490 cos_to_last_merge=0.9865 (last merge round=41)
[S7] round=69 local utility u=0.078330 metrics={'f1_val': 0.6274058670222811, 'auprc': 0.7986789372860552, 'loss_val': 0.6078512629327795, 'psi': 0.6959150951277908}-{'f1_val': 0.6107902133971097, 'auprc': 0.7964291342622457, 'loss_val': 0.6580671166708566, 'psi': 0.6850457817431641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=69 head_norm_before_train=2.078982 cos_to_last_merge=0.7638 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.764
[S8] round=69 local utility u=0.004259 metrics={'f1_val': 0.9945717084929089, 'auprc': 0.9986166644987321, 'loss_val': 0.028556602879852747, 'psi': 0.9961896908952381}-{'f1_val': 0.9930382012516658, 'auprc': 0.998936360976209, 'loss_val': 0.028832588581617156, 'psi': 0.995397465141483}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=69 head_norm_before_train=1.711445 cos_to_last_merge=0.9425 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=69 local utility u=0.001671 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.99690205676856, 'loss_val': 0.02377501253944103, 'psi': 0.9968896797554536}-{'f1_val': 0.9968814284133827, 'auprc': 0.9959057101763299, 'loss_val': 0.024127279316764116, 'psi': 0.9964911411185615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=69 head_norm_before_train=2.269797 cos_to_last_merge=0.8106 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=69 local utility u=0.000686 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9963977972654875, 'loss_val': 0.024723566364023453, 'psi': 0.9954190091317123}-{'f1_val': 0.9947664837091956, 'auprc': 0.995992999351407, 'loss_val': 0.02488191225064053, 'psi': 0.9952570899660802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=69 head_norm_before_train=1.763182 cos_to_last_merge=0.9694 (last merge round=34)
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9920548383712203, 'auprc': 0.9968301758606075, 'loss_val': 0.028748620452197872, 'psi': 0.9939649733669751}-{'f1_val': 0.9961336749133093, 'auprc': 0.996139226069505, 'loss_val': 0.022395659966038622, 'psi': 0.9961358953757876}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=2.142612 (no previous merge yet)
[S13] round=69 local utility u=0.030734 metrics={'f1_val': 0.7458896190167427, 'auprc': 0.841126440097291, 'loss_val': 0.970332654131663, 'psi': 0.7839843474489621}-{'f1_val': 0.7514194333727329, 'auprc': 0.8628744630673683, 'loss_val': 1.1302227397115008, 'psi': 0.796001445250587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=69 head_norm_before_train=1.712935 cos_to_last_merge=0.9913 (last merge round=40)
[S14] round=69 local utility u=0.003451 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9984604356374133, 'loss_val': 0.028601856744372687, 'psi': 0.9971775226498717}-{'f1_val': 0.9967325241656609, 'auprc': 0.9967422623409953, 'loss_val': 0.032811825555165125, 'psi': 0.9967364194357946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=69 head_norm_before_train=1.933602 cos_to_last_merge=0.9620 (last merge round=39)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.8582456030166146, 'auprc': 0.9187123794642575, 'loss_val': 0.40116767555565147, 'psi': 0.8824323135956718}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976321527413772, 'loss_val': 0.021288170017795028, 'psi': 0.9971008621290632}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=2.144781 cos_to_last_merge=0.9972 (last merge round=41)
[S16] round=69 local utility u=0.135579 metrics={'f1_val': 0.9730580223705789, 'auprc': 0.9882548489914563, 'loss_val': 0.09356285103264958, 'psi': 0.9791367530189299}-{'f1_val': 0.9453178405647417, 'auprc': 0.984858685359837, 'loss_val': 0.18809149110922355, 'psi': 0.9611341784827798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=69 head_norm_before_train=2.055576 cos_to_last_merge=0.9540 (last merge round=41)
[S17] round=69 local utility u=0.035490 metrics={'f1_val': 0.8420077899630657, 'auprc': 0.9405983901922181, 'loss_val': 0.7397095736977807, 'psi': 0.8814440300547267}-{'f1_val': 0.828998598460512, 'auprc': 0.9688543441967252, 'loss_val': 0.8174021837464837, 'psi': 0.8849408967549973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=70 head_norm_before_train=2.313956 (no previous merge yet)
[S2] round=70 local utility u=0.069758 metrics={'f1_val': 0.7067732855026739, 'auprc': 0.9224691406822404, 'loss_val': 0.6600528515145854, 'psi': 0.7930516275745005}-{'f1_val': 0.701430658422139, 'auprc': 0.8932499336040318, 'loss_val': 0.6798551579049472, 'psi': 0.7781583684948962}
[S2] not sending this round → trigger blocked (psi=0.793)
[S3] START round=70 head_norm_before_train=2.344110 (no previous merge yet)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.960527581452528, 'auprc': 0.9990833575587463, 'loss_val': 0.11530817748087577, 'psi': 0.9759498918950154}-{'f1_val': 0.9971122502560278, 'auprc': 0.9990905167810542, 'loss_val': 0.018474117009730805, 'psi': 0.9979035568660384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.239747 cos_to_last_merge=0.9869 (last merge round=34)
[S4] round=70 local utility u=0.029283 metrics={'f1_val': 0.9453962630804288, 'auprc': 0.9739960554802614, 'loss_val': 0.30721365764666075, 'psi': 0.9568361800403618}-{'f1_val': 0.9388977952352566, 'auprc': 0.956742131272882, 'loss_val': 0.2750265174354279, 'psi': 0.9460355296503067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=70 head_norm_before_train=1.683606 cos_to_last_merge=0.9628 (last merge round=41)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.8545400204487877, 'auprc': 0.9907262683492873, 'loss_val': 0.14697160711640986, 'psi': 0.9090145196089876}-{'f1_val': 0.9958933237853395, 'auprc': 0.9914980043722894, 'loss_val': 0.07240923223497657, 'psi': 0.9941351960201195}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.708267 cos_to_last_merge=0.9742 (last merge round=40)
[S6] round=70 local utility u=0.732273 metrics={'f1_val': 0.7319711530043239, 'auprc': 0.9311535261035515, 'loss_val': 0.8235160965569975, 'psi': 0.811644102244015}-{'f1_val': 0.6002470786780303, 'auprc': 0.8330648757017741, 'loss_val': 1.2034515153750285, 'psi': 0.6933741974875278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=70 head_norm_before_train=1.667488 cos_to_last_merge=0.9860 (last merge round=41)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.5417031247775044, 'auprc': 0.7857868210805946, 'loss_val': 1.0030692427435028, 'psi': 0.6393366032987404}-{'f1_val': 0.6274058670222811, 'auprc': 0.7986789372860552, 'loss_val': 0.6078512629327795, 'psi': 0.6959150951277908}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.086505 cos_to_last_merge=0.7627 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.763
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9990284107000669, 'loss_val': 0.02987294269655703, 'psi': 0.9956063646583112}-{'f1_val': 0.9945717084929089, 'auprc': 0.9986166644987321, 'loss_val': 0.028556602879852747, 'psi': 0.9961896908952381}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=1.717921 cos_to_last_merge=0.9418 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=70 local utility u=0.001284 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9976381932744264, 'loss_val': 0.02341581192429898, 'psi': 0.9971841343578001}-{'f1_val': 0.9968814284133827, 'auprc': 0.99690205676856, 'loss_val': 0.02377501253944103, 'psi': 0.9968896797554536}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=70 head_norm_before_train=2.273201 cos_to_last_merge=0.8102 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.810
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.995991244719658, 'loss_val': 0.024993192205250366, 'psi': 0.9952563881133806}-{'f1_val': 0.9947664837091956, 'auprc': 0.9963977972654875, 'loss_val': 0.024723566364023453, 'psi': 0.9954190091317123}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=1.767373 cos_to_last_merge=0.9690 (last merge round=34)
[S11] round=70 local utility u=0.015606 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968742144307158, 'loss_val': 0.022140979007909792, 'psi': 0.9964298907202719}-{'f1_val': 0.9920548383712203, 'auprc': 0.9968301758606075, 'loss_val': 0.028748620452197872, 'psi': 0.9939649733669751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=70 head_norm_before_train=2.150518 (no previous merge yet)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6211469443863497, 'auprc': 0.6867323584991667, 'loss_val': 1.5345059928250733, 'psi': 0.6473811100314765}-{'f1_val': 0.7458896190167427, 'auprc': 0.841126440097291, 'loss_val': 0.970332654131663, 'psi': 0.7839843474489621}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.717824 cos_to_last_merge=0.9910 (last merge round=40)
[S14] round=70 local utility u=0.001980 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9984308007991196, 'loss_val': 0.028491675576695824, 'psi': 0.9975596266807705}-{'f1_val': 0.9963222473248441, 'auprc': 0.9984604356374133, 'loss_val': 0.028601856744372687, 'psi': 0.9971775226498717}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=70 head_norm_before_train=1.940291 cos_to_last_merge=0.9614 (last merge round=39)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.8281841662345807, 'auprc': 0.8973325720330889, 'loss_val': 0.4438530241426454, 'psi': 0.855843528553984}-{'f1_val': 0.8582456030166146, 'auprc': 0.9187123794642575, 'loss_val': 0.40116767555565147, 'psi': 0.8824323135956718}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=2.149389 cos_to_last_merge=0.9972 (last merge round=41)
[S16] round=70 local utility u=0.080122 metrics={'f1_val': 0.990744756067958, 'auprc': 0.9907460949223662, 'loss_val': 0.04691328679519995, 'psi': 0.9907452916097212}-{'f1_val': 0.9730580223705789, 'auprc': 0.9882548489914563, 'loss_val': 0.09356285103264958, 'psi': 0.9791367530189299}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=70 head_norm_before_train=2.064557 cos_to_last_merge=0.9535 (last merge round=41)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.8280400005305303, 'auprc': 0.8982293384297065, 'loss_val': 0.8323023810853512, 'psi': 0.8561157356902007}-{'f1_val': 0.8420077899630657, 'auprc': 0.9405983901922181, 'loss_val': 0.7397095736977807, 'psi': 0.8814440300547267}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=2.322225 (no previous merge yet)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7143134794776035, 'auprc': 0.8409235820896724, 'loss_val': 0.831822462130978, 'psi': 0.764957520522431}-{'f1_val': 0.7067732855026739, 'auprc': 0.9224691406822404, 'loss_val': 0.6600528515145854, 'psi': 0.7930516275745005}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.348330 (no previous merge yet)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9986324970129863, 'loss_val': 0.13013560498534255, 'psi': 0.9760504512848962}-{'f1_val': 0.960527581452528, 'auprc': 0.9990833575587463, 'loss_val': 0.11530817748087577, 'psi': 0.9759498918950154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.245315 cos_to_last_merge=0.9865 (last merge round=34)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9493885947447943, 'auprc': 0.9620954793749354, 'loss_val': 0.3186278399826825, 'psi': 0.9544713485968508}-{'f1_val': 0.9453962630804288, 'auprc': 0.9739960554802614, 'loss_val': 0.30721365764666075, 'psi': 0.9568361800403618}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.693052 cos_to_last_merge=0.9617 (last merge round=41)
[S5] round=71 local utility u=0.483221 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9962237923922408, 'loss_val': 0.04690216747635541, 'psi': 0.9962015846316239}-{'f1_val': 0.8545400204487877, 'auprc': 0.9907262683492873, 'loss_val': 0.14697160711640986, 'psi': 0.9090145196089876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=71 head_norm_before_train=1.715655 cos_to_last_merge=0.9738 (last merge round=40)
[S6] round=71 local utility u=0.876688 metrics={'f1_val': 0.9274832796415517, 'auprc': 0.9453516770197347, 'loss_val': 0.2858067968988041, 'psi': 0.9346306385928249}-{'f1_val': 0.7319711530043239, 'auprc': 0.9311535261035515, 'loss_val': 0.8235160965569975, 'psi': 0.811644102244015}
[S6] not sending this round → trigger blocked (psi=0.935)
[S7] START round=71 head_norm_before_train=1.675980 cos_to_last_merge=0.9853 (last merge round=41)
[S7] round=71 local utility u=1.000000 metrics={'f1_val': 0.9218831270189211, 'auprc': 0.9921940961137852, 'loss_val': 0.15924175349061218, 'psi': 0.9500075146568667}-{'f1_val': 0.5417031247775044, 'auprc': 0.7857868210805946, 'loss_val': 1.0030692427435028, 'psi': 0.6393366032987404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=71 head_norm_before_train=2.095218 cos_to_last_merge=0.7614 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.761
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9765153883598575, 'auprc': 0.9992649316211804, 'loss_val': 0.06249384661469856, 'psi': 0.9856152056643867}-{'f1_val': 0.9933250006304741, 'auprc': 0.9990284107000669, 'loss_val': 0.02987294269655703, 'psi': 0.9956063646583112}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=1.725184 cos_to_last_merge=0.9411 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9960128332471109, 'loss_val': 0.02281297365824506, 'psi': 0.996533990346874}-{'f1_val': 0.9968814284133827, 'auprc': 0.9976381932744264, 'loss_val': 0.02341581192429898, 'psi': 0.9971841343578001}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.279379 cos_to_last_merge=0.8098 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.810
[S10] round=71 local utility u=0.000054 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959892078496706, 'loss_val': 0.024879860607236286, 'psi': 0.9952555733653856}-{'f1_val': 0.9947664837091956, 'auprc': 0.995991244719658, 'loss_val': 0.024993192205250366, 'psi': 0.9952563881133806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=71 head_norm_before_train=1.772307 cos_to_last_merge=0.9686 (last merge round=34)
[S11] round=71 local utility u=0.000024 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968352367256877, 'loss_val': 0.021977034542208406, 'psi': 0.9964142996382607}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968742144307158, 'loss_val': 0.022140979007909792, 'psi': 0.9964298907202719}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=71 head_norm_before_train=2.157804 (no previous merge yet)
[S13] round=71 local utility u=1.000000 metrics={'f1_val': 0.7842402848180502, 'auprc': 0.8625412998866853, 'loss_val': 0.6520012424739854, 'psi': 0.8155606908455042}-{'f1_val': 0.6211469443863497, 'auprc': 0.6867323584991667, 'loss_val': 1.5345059928250733, 'psi': 0.6473811100314765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=71 head_norm_before_train=1.724002 cos_to_last_merge=0.9907 (last merge round=40)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9984342438629558, 'loss_val': 0.029392933811778914, 'psi': 0.9971670459400888}-{'f1_val': 0.9969788439352044, 'auprc': 0.9984308007991196, 'loss_val': 0.028491675576695824, 'psi': 0.9975596266807705}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.948592 cos_to_last_merge=0.9608 (last merge round=39)
[S15] round=71 local utility u=0.866740 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970276169547969, 'loss_val': 0.020832318206993373, 'psi': 0.9968590478144311}-{'f1_val': 0.8281841662345807, 'auprc': 0.8973325720330889, 'loss_val': 0.4438530241426454, 'psi': 0.855843528553984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=71 head_norm_before_train=2.154647 cos_to_last_merge=0.9971 (last merge round=41)
[S16] round=71 local utility u=0.006802 metrics={'f1_val': 0.991615725027552, 'auprc': 0.9923844699337411, 'loss_val': 0.043450302598920645, 'psi': 0.9919232229900277}-{'f1_val': 0.990744756067958, 'auprc': 0.9907460949223662, 'loss_val': 0.04691328679519995, 'psi': 0.9907452916097212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=71 head_norm_before_train=2.073505 cos_to_last_merge=0.9531 (last merge round=41)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8105853752074768, 'auprc': 0.8731080620783168, 'loss_val': 0.9292591749073842, 'psi': 0.8355944499558128}-{'f1_val': 0.8280400005305303, 'auprc': 0.8982293384297065, 'loss_val': 0.8323023810853512, 'psi': 0.8561157356902007}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.325901 (no previous merge yet)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7151682435031302, 'auprc': 0.8263409924219297, 'loss_val': 0.9157796666566851, 'psi': 0.75963734307065}-{'f1_val': 0.7143134794776035, 'auprc': 0.8409235820896724, 'loss_val': 0.831822462130978, 'psi': 0.764957520522431}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.352728 (no previous merge yet)
[S3] round=72 local utility u=0.150358 metrics={'f1_val': 0.9931654352835908, 'auprc': 0.9986693105320246, 'loss_val': 0.02254719135850114, 'psi': 0.9953669853829643}-{'f1_val': 0.960995754132836, 'auprc': 0.9986324970129863, 'loss_val': 0.13013560498534255, 'psi': 0.9760504512848962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=72 head_norm_before_train=2.248935 cos_to_last_merge=0.9861 (last merge round=34)
[S4] round=72 local utility u=0.032058 metrics={'f1_val': 0.9497294890073069, 'auprc': 0.9690116551873736, 'loss_val': 0.2773055521096028, 'psi': 0.9574423554793337}-{'f1_val': 0.9493885947447943, 'auprc': 0.9620954793749354, 'loss_val': 0.3186278399826825, 'psi': 0.9544713485968508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=72 head_norm_before_train=1.702041 cos_to_last_merge=0.9602 (last merge round=41)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9942691826385757, 'auprc': 0.989147744243347, 'loss_val': 0.09899235470359895, 'psi': 0.9922206072804842}-{'f1_val': 0.9961867794578795, 'auprc': 0.9962237923922408, 'loss_val': 0.04690216747635541, 'psi': 0.9962015846316239}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.724892 cos_to_last_merge=0.9733 (last merge round=40)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.6842893243909124, 'auprc': 0.8721526648257754, 'loss_val': 0.9112863298131489, 'psi': 0.7594346605648576}-{'f1_val': 0.9274832796415517, 'auprc': 0.9453516770197347, 'loss_val': 0.2858067968988041, 'psi': 0.9346306385928249}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.683301 cos_to_last_merge=0.9847 (last merge round=41)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5899127371316979, 'auprc': 0.7954368737025543, 'loss_val': 0.6790904750391867, 'psi': 0.6721223917600405}-{'f1_val': 0.9218831270189211, 'auprc': 0.9921940961137852, 'loss_val': 0.15924175349061218, 'psi': 0.9500075146568667}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.099787 cos_to_last_merge=0.7604 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.760
[S8] round=72 local utility u=0.067179 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9986241587509557, 'loss_val': 0.02707047006399883, 'psi': 0.9954446638786667}-{'f1_val': 0.9765153883598575, 'auprc': 0.9992649316211804, 'loss_val': 0.06249384661469856, 'psi': 0.9856152056643867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=72 head_norm_before_train=1.732662 cos_to_last_merge=0.9404 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9959188103253448, 'loss_val': 0.0227079274591201, 'psi': 0.9964963811781675}-{'f1_val': 0.9968814284133827, 'auprc': 0.9960128332471109, 'loss_val': 0.02281297365824506, 'psi': 0.996533990346874}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.282356 cos_to_last_merge=0.8094 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959846520815447, 'loss_val': 0.025034792796715184, 'psi': 0.9952537510581352}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959892078496706, 'loss_val': 0.024879860607236286, 'psi': 0.9952555733653856}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=1.778245 cos_to_last_merge=0.9682 (last merge round=34)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9856511098097379, 'auprc': 0.9969447774552874, 'loss_val': 0.061328997732443, 'psi': 0.9901685768679578}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968352367256877, 'loss_val': 0.021977034542208406, 'psi': 0.9964142996382607}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=2.157876 (no previous merge yet)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6710233348112333, 'auprc': 0.7242122928329847, 'loss_val': 1.4021039710416572, 'psi': 0.6922989180199339}-{'f1_val': 0.7842402848180502, 'auprc': 0.8625412998866853, 'loss_val': 0.6520012424739854, 'psi': 0.8155606908455042}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.730828 cos_to_last_merge=0.9904 (last merge round=40)
[S14] round=72 local utility u=0.000495 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9984673645455141, 'loss_val': 0.028501966961783417, 'psi': 0.997180294213112}-{'f1_val': 0.9963222473248441, 'auprc': 0.9984342438629558, 'loss_val': 0.029392933811778914, 'psi': 0.9971670459400888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=72 head_norm_before_train=1.956980 cos_to_last_merge=0.9602 (last merge round=39)
[S15] round=72 local utility u=0.000099 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971107904387769, 'loss_val': 0.02088306047733406, 'psi': 0.9968923172080231}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970276169547969, 'loss_val': 0.020832318206993373, 'psi': 0.9968590478144311}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=72 head_norm_before_train=2.157679 cos_to_last_merge=0.9969 (last merge round=41)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9911988893591563, 'auprc': 0.9931123738841645, 'loss_val': 0.043639376875041797, 'psi': 0.9919642831691596}-{'f1_val': 0.991615725027552, 'auprc': 0.9923844699337411, 'loss_val': 0.043450302598920645, 'psi': 0.9919232229900277}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.084462 cos_to_last_merge=0.9524 (last merge round=41)
[S17] round=72 local utility u=0.337128 metrics={'f1_val': 0.8684013605043044, 'auprc': 0.9018588227857871, 'loss_val': 0.6881508526669382, 'psi': 0.8817843454168974}-{'f1_val': 0.8105853752074768, 'auprc': 0.8731080620783168, 'loss_val': 0.9292591749073842, 'psi': 0.8355944499558128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=73 head_norm_before_train=2.328172 (no previous merge yet)
[S2] round=73 local utility u=0.079620 metrics={'f1_val': 0.7145691031978216, 'auprc': 0.8434585430561763, 'loss_val': 0.804298289796454, 'psi': 0.7661248791411635}-{'f1_val': 0.7151682435031302, 'auprc': 0.8263409924219297, 'loss_val': 0.9157796666566851, 'psi': 0.75963734307065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=73 head_norm_before_train=2.357485 (no previous merge yet)
[S3] round=73 local utility u=0.014549 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.9986587117567847, 'loss_val': 0.018456999540371836, 'psi': 0.9978666979946124}-{'f1_val': 0.9931654352835908, 'auprc': 0.9986693105320246, 'loss_val': 0.02254719135850114, 'psi': 0.9953669853829643}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=73 head_norm_before_train=2.251441 cos_to_last_merge=0.9856 (last merge round=34)
[S4] round=73 local utility u=0.023702 metrics={'f1_val': 0.946920892377538, 'auprc': 0.9787004839904279, 'loss_val': 0.24211676405969726, 'psi': 0.9596327290226939}-{'f1_val': 0.9497294890073069, 'auprc': 0.9690116551873736, 'loss_val': 0.2773055521096028, 'psi': 0.9574423554793337}
[S4] not sending this round → trigger blocked (psi=0.960)
[S5] START round=73 head_norm_before_train=1.713798 cos_to_last_merge=0.9585 (last merge round=41)
[S5] round=73 local utility u=0.039407 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9946687795458794, 'loss_val': 0.046485977979008795, 'psi': 0.9954035060895554}-{'f1_val': 0.9942691826385757, 'auprc': 0.989147744243347, 'loss_val': 0.09899235470359895, 'psi': 0.9922206072804842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=73 head_norm_before_train=1.733653 cos_to_last_merge=0.9726 (last merge round=40)
[S6] round=73 local utility u=0.263261 metrics={'f1_val': 0.7285729468904086, 'auprc': 0.9006162730545189, 'loss_val': 0.7358575868588787, 'psi': 0.7973902773560527}-{'f1_val': 0.6842893243909124, 'auprc': 0.8721526648257754, 'loss_val': 0.9112863298131489, 'psi': 0.7594346605648576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=73 head_norm_before_train=1.688934 cos_to_last_merge=0.9842 (last merge round=41)
[S7] round=73 local utility u=0.148257 metrics={'f1_val': 0.6151873782888626, 'auprc': 0.8006308449858276, 'loss_val': 0.5498065399757397, 'psi': 0.6893647649676486}-{'f1_val': 0.5899127371316979, 'auprc': 0.7954368737025543, 'loss_val': 0.6790904750391867, 'psi': 0.6721223917600405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S7] sending update (kind=head size=1810 to 1 peers)
[S8] START round=73 head_norm_before_train=2.108191 cos_to_last_merge=0.7605 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.760
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9710458394989838, 'auprc': 0.9990885827593952, 'loss_val': 0.07393783834625865, 'psi': 0.9822629368031484}-{'f1_val': 0.9933250006304741, 'auprc': 0.9986241587509557, 'loss_val': 0.02707047006399883, 'psi': 0.9954446638786667}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.740159 cos_to_last_merge=0.9398 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=73 local utility u=0.000951 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9964866783759653, 'loss_val': 0.02250908758045086, 'psi': 0.9967235283984157}-{'f1_val': 0.9968814284133827, 'auprc': 0.9959188103253448, 'loss_val': 0.0227079274591201, 'psi': 0.9964963811781675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=73 head_norm_before_train=2.289600 cos_to_last_merge=0.8091 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=73 local utility u=0.000882 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9964115786031478, 'loss_val': 0.024551847662973362, 'psi': 0.9954245216667765}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959846520815447, 'loss_val': 0.025034792796715184, 'psi': 0.9952537510581352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=73 head_norm_before_train=1.784141 cos_to_last_merge=0.9678 (last merge round=34)
[S11] round=73 local utility u=0.051002 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968140427915617, 'loss_val': 0.021828944606954774, 'psi': 0.9964058220646103}-{'f1_val': 0.9856511098097379, 'auprc': 0.9969447774552874, 'loss_val': 0.061328997732443, 'psi': 0.9901685768679578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=73 head_norm_before_train=2.158079 (no previous merge yet)
[S13] round=73 local utility u=0.638812 metrics={'f1_val': 0.7513132228079169, 'auprc': 0.8468560677538572, 'loss_val': 0.9741512446193001, 'psi': 0.789530360786293}-{'f1_val': 0.6710233348112333, 'auprc': 0.7242122928329847, 'loss_val': 1.4021039710416572, 'psi': 0.6922989180199339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=73 head_norm_before_train=1.736973 cos_to_last_merge=0.9901 (last merge round=40)
[S14] round=73 local utility u=0.000566 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9984986190208673, 'loss_val': 0.027464460102475424, 'psi': 0.9971927960032534}-{'f1_val': 0.9963222473248441, 'auprc': 0.9984673645455141, 'loss_val': 0.028501966961783417, 'psi': 0.997180294213112}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=73 head_norm_before_train=1.964312 cos_to_last_merge=0.9596 (last merge round=39)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.858055627698416, 'auprc': 0.9030907234428867, 'loss_val': 0.41413952400922616, 'psi': 0.8760696659962043}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971107904387769, 'loss_val': 0.02088306047733406, 'psi': 0.9968923172080231}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=2.160372 cos_to_last_merge=0.9965 (last merge round=41)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9911988893591563, 'auprc': 0.9934497280371929, 'loss_val': 0.045050040935884515, 'psi': 0.9920992248303709}-{'f1_val': 0.9911988893591563, 'auprc': 0.9931123738841645, 'loss_val': 0.043639376875041797, 'psi': 0.9919642831691596}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.092093 cos_to_last_merge=0.9521 (last merge round=41)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8131288342455387, 'auprc': 0.9203226283985888, 'loss_val': 0.9120579342166273, 'psi': 0.8560063519067587}-{'f1_val': 0.8684013605043044, 'auprc': 0.9018588227857871, 'loss_val': 0.6881508526669382, 'psi': 0.8817843454168974}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.332510 (no previous merge yet)
[S2] round=74 local utility u=0.239474 metrics={'f1_val': 0.7080710492403852, 'auprc': 0.9551417060460062, 'loss_val': 0.6214121433663199, 'psi': 0.8068993119626336}-{'f1_val': 0.7145691031978216, 'auprc': 0.8434585430561763, 'loss_val': 0.804298289796454, 'psi': 0.7661248791411635}
[S2] not sending this round → trigger blocked (psi=0.807)
[S3] START round=74 head_norm_before_train=2.362154 (no previous merge yet)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9487245089254558, 'auprc': 0.9982515766582012, 'loss_val': 0.18686416113907917, 'psi': 0.9685353360185539}-{'f1_val': 0.9973386888198309, 'auprc': 0.9986587117567847, 'loss_val': 0.018456999540371836, 'psi': 0.9978666979946124}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=2.257633 cos_to_last_merge=0.9854 (last merge round=34)
[S4] round=74 local utility u=0.009483 metrics={'f1_val': 0.9547648751504374, 'auprc': 0.9779601507800808, 'loss_val': 0.26799337183766225, 'psi': 0.9640429854022947}-{'f1_val': 0.946920892377538, 'auprc': 0.9787004839904279, 'loss_val': 0.24211676405969726, 'psi': 0.9596327290226939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=74 head_norm_before_train=1.727614 cos_to_last_merge=0.9568 (last merge round=41)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9824877371899384, 'auprc': 0.9884270862804043, 'loss_val': 0.1017312924196873, 'psi': 0.9848634768261249}-{'f1_val': 0.9958933237853395, 'auprc': 0.9946687795458794, 'loss_val': 0.046485977979008795, 'psi': 0.9954035060895554}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.742081 cos_to_last_merge=0.9720 (last merge round=40)
[S6] round=74 local utility u=0.001263 metrics={'f1_val': 0.7313326048438608, 'auprc': 0.8971447675181845, 'loss_val': 0.7394740686092245, 'psi': 0.7976574699135903}-{'f1_val': 0.7285729468904086, 'auprc': 0.9006162730545189, 'loss_val': 0.7358575868588787, 'psi': 0.7973902773560527}
[S6] not sending this round → trigger blocked (psi=0.798)
[S7] START round=74 head_norm_before_train=1.692259 cos_to_last_merge=0.9838 (last merge round=41)
[S7] round=74 local utility u=0.164936 metrics={'f1_val': 0.6515071597028489, 'auprc': 0.8078933014122636, 'loss_val': 0.4596399304025094, 'psi': 0.7140616163866147}-{'f1_val': 0.6151873782888626, 'auprc': 0.8006308449858276, 'loss_val': 0.5498065399757397, 'psi': 0.6893647649676486}
[S7] not sending this round → trigger blocked (psi=0.714)
[S8] START round=74 head_norm_before_train=2.114702 cos_to_last_merge=0.7610 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.761
[S8] round=74 local utility u=0.093323 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9982541281813461, 'loss_val': 0.02506228218570896, 'psi': 0.9959565870625081}-{'f1_val': 0.9710458394989838, 'auprc': 0.9990885827593952, 'loss_val': 0.07393783834625865, 'psi': 0.9822629368031484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=74 head_norm_before_train=1.747768 cos_to_last_merge=0.9392 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.994464321060467, 'loss_val': 0.022211921517275208, 'psi': 0.9958185295929097}-{'f1_val': 0.9968814284133827, 'auprc': 0.9964866783759653, 'loss_val': 0.02250908758045086, 'psi': 0.9967235283984157}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.298058 cos_to_last_merge=0.8087 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=74 local utility u=0.000425 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9959832039915708, 'loss_val': 0.024873230467593047, 'psi': 0.9954987854309365}-{'f1_val': 0.9947664837091956, 'auprc': 0.9964115786031478, 'loss_val': 0.024551847662973362, 'psi': 0.9954245216667765}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=74 head_norm_before_train=1.788227 cos_to_last_merge=0.9675 (last merge round=34)
[S11] round=74 local utility u=0.000200 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968993136858556, 'loss_val': 0.02168510736878575, 'psi': 0.9964399304223278}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968140427915617, 'loss_val': 0.021828944606954774, 'psi': 0.9964058220646103}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=74 head_norm_before_train=2.161041 (no previous merge yet)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6588064674671802, 'auprc': 0.9113599355582633, 'loss_val': 1.2831601006120164, 'psi': 0.7598278547036135}-{'f1_val': 0.7513132228079169, 'auprc': 0.8468560677538572, 'loss_val': 0.9741512446193001, 'psi': 0.789530360786293}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=1.742724 cos_to_last_merge=0.9898 (last merge round=40)
[S14] round=74 local utility u=0.000410 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9985013940301686, 'loss_val': 0.02665199389743823, 'psi': 0.9971939060069739}-{'f1_val': 0.9963222473248441, 'auprc': 0.9984986190208673, 'loss_val': 0.027464460102475424, 'psi': 0.9971927960032534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=74 head_norm_before_train=1.971761 cos_to_last_merge=0.9590 (last merge round=39)
[S15] round=74 local utility u=0.023589 metrics={'f1_val': 0.8631294824578406, 'auprc': 0.9067188397029896, 'loss_val': 0.4082890388392125, 'psi': 0.8805652253559002}-{'f1_val': 0.858055627698416, 'auprc': 0.9030907234428867, 'loss_val': 0.41413952400922616, 'psi': 0.8760696659962043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=74 head_norm_before_train=2.163486 cos_to_last_merge=0.9962 (last merge round=41)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9391495951478105, 'auprc': 0.9907354514707807, 'loss_val': 0.40125740919710484, 'psi': 0.9597839376769985}-{'f1_val': 0.9911988893591563, 'auprc': 0.9934497280371929, 'loss_val': 0.045050040935884515, 'psi': 0.9920992248303709}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.097889 cos_to_last_merge=0.9519 (last merge round=41)
[S17] round=74 local utility u=0.354947 metrics={'f1_val': 0.8753233819494781, 'auprc': 0.9440226765681807, 'loss_val': 0.6464317439787157, 'psi': 0.9028030997969592}-{'f1_val': 0.8131288342455387, 'auprc': 0.9203226283985888, 'loss_val': 0.9120579342166273, 'psi': 0.8560063519067587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=75 head_norm_before_train=2.339436 (no previous merge yet)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.6847737480438028, 'auprc': 0.8184121335533119, 'loss_val': 0.8423131559475364, 'psi': 0.7382291022476064}-{'f1_val': 0.7080710492403852, 'auprc': 0.9551417060460062, 'loss_val': 0.6214121433663199, 'psi': 0.8068993119626336}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.366426 (no previous merge yet)
[S3] round=75 local utility u=0.178810 metrics={'f1_val': 0.9848230450773208, 'auprc': 0.9990078564571517, 'loss_val': 0.04810468990634067, 'psi': 0.9904969696292532}-{'f1_val': 0.9487245089254558, 'auprc': 0.9982515766582012, 'loss_val': 0.18686416113907917, 'psi': 0.9685353360185539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=75 head_norm_before_train=2.258029 cos_to_last_merge=0.9852 (last merge round=34)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9476386963405417, 'auprc': 0.9657584029567052, 'loss_val': 0.24037059184315207, 'psi': 0.9548865789870071}-{'f1_val': 0.9547648751504374, 'auprc': 0.9779601507800808, 'loss_val': 0.26799337183766225, 'psi': 0.9640429854022947}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.736551 cos_to_last_merge=0.9555 (last merge round=41)
[S5] round=75 local utility u=0.078671 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9949805421614986, 'loss_val': 0.044482764664666614, 'psi': 0.995528211135803}-{'f1_val': 0.9824877371899384, 'auprc': 0.9884270862804043, 'loss_val': 0.1017312924196873, 'psi': 0.9848634768261249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=75 head_norm_before_train=1.752927 cos_to_last_merge=0.9715 (last merge round=40)
[S6] round=75 local utility u=0.281135 metrics={'f1_val': 0.7598833960852872, 'auprc': 0.9263990586701596, 'loss_val': 0.4362716168969711, 'psi': 0.8264896611192362}-{'f1_val': 0.7313326048438608, 'auprc': 0.8971447675181845, 'loss_val': 0.7394740686092245, 'psi': 0.7976574699135903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=75 head_norm_before_train=1.695640 cos_to_last_merge=0.9835 (last merge round=41)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.4650265996779367, 'auprc': 0.7822266837184224, 'loss_val': 1.4283623689357134, 'psi': 0.591906633294131}-{'f1_val': 0.6515071597028489, 'auprc': 0.8078933014122636, 'loss_val': 0.4596399304025094, 'psi': 0.7140616163866147}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.123178 cos_to_last_merge=0.7606 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.761
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9851402783466149, 'auprc': 0.9990498413528108, 'loss_val': 0.044417213290436935, 'psi': 0.9907041035490933}-{'f1_val': 0.9944248929832828, 'auprc': 0.9982541281813461, 'loss_val': 0.02506228218570896, 'psi': 0.9959565870625081}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=1.754641 cos_to_last_merge=0.9385 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9935516800558999, 'auprc': 0.99908144632656, 'loss_val': 0.027223069674085037, 'psi': 0.995763586564164}-{'f1_val': 0.996721335281205, 'auprc': 0.994464321060467, 'loss_val': 0.022211921517275208, 'psi': 0.9958185295929097}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.306406 cos_to_last_merge=0.8084 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.808
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9964257807701973, 'loss_val': 0.024619692527209126, 'psi': 0.9954302025335963}-{'f1_val': 0.995175839723847, 'auprc': 0.9959832039915708, 'loss_val': 0.024873230467593047, 'psi': 0.9954987854309365}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.793005 cos_to_last_merge=0.9672 (last merge round=34)
[S11] round=75 local utility u=0.000076 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969183847681589, 'loss_val': 0.02158991722988373, 'psi': 0.9964475588552492}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968993136858556, 'loss_val': 0.02168510736878575, 'psi': 0.9964399304223278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=75 head_norm_before_train=2.165825 (no previous merge yet)
[S13] round=75 local utility u=0.052269 metrics={'f1_val': 0.7222218558714498, 'auprc': 0.7874962359904566, 'loss_val': 1.1875226116932187, 'psi': 0.7483316079190525}-{'f1_val': 0.6588064674671802, 'auprc': 0.9113599355582633, 'loss_val': 1.2831601006120164, 'psi': 0.7598278547036135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=75 head_norm_before_train=1.748432 cos_to_last_merge=0.9896 (last merge round=40)
[S14] round=75 local utility u=0.000374 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9985902694735861, 'loss_val': 0.028632823564980477, 'psi': 0.997475622288831}-{'f1_val': 0.9963222473248441, 'auprc': 0.9985013940301686, 'loss_val': 0.02665199389743823, 'psi': 0.9971939060069739}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=75 head_norm_before_train=1.979218 cos_to_last_merge=0.9584 (last merge round=39)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.8341845791702411, 'auprc': 0.9175224149143334, 'loss_val': 0.43081222218055976, 'psi': 0.867519713467878}-{'f1_val': 0.8631294824578406, 'auprc': 0.9067188397029896, 'loss_val': 0.4082890388392125, 'psi': 0.8805652253559002}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.168209 cos_to_last_merge=0.9961 (last merge round=41)
[S16] round=75 local utility u=0.039721 metrics={'f1_val': 0.9422439129636944, 'auprc': 0.9858649589842148, 'loss_val': 0.3257692492931519, 'psi': 0.9596923313719026}-{'f1_val': 0.9391495951478105, 'auprc': 0.9907354514707807, 'loss_val': 0.40125740919710484, 'psi': 0.9597839376769985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=75 head_norm_before_train=2.106576 cos_to_last_merge=0.9514 (last merge round=41)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.8260369916852173, 'auprc': 0.9523563373701257, 'loss_val': 0.8608976918005108, 'psi': 0.8765647299591807}-{'f1_val': 0.8753233819494781, 'auprc': 0.9440226765681807, 'loss_val': 0.6464317439787157, 'psi': 0.9028030997969592}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.345051 (no previous merge yet)
[S2] round=76 local utility u=0.379333 metrics={'f1_val': 0.7069094897047318, 'auprc': 0.9549864371471473, 'loss_val': 0.6261853555137432, 'psi': 0.806140268681698}-{'f1_val': 0.6847737480438028, 'auprc': 0.8184121335533119, 'loss_val': 0.8423131559475364, 'psi': 0.7382291022476064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=76 head_norm_before_train=2.371628 (no previous merge yet)
[S3] round=76 local utility u=0.040263 metrics={'f1_val': 0.9941732255242114, 'auprc': 0.999004917413335, 'loss_val': 0.023669959280934436, 'psi': 0.9961059022798608}-{'f1_val': 0.9848230450773208, 'auprc': 0.9990078564571517, 'loss_val': 0.04810468990634067, 'psi': 0.9904969696292532}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=76 head_norm_before_train=2.259203 cos_to_last_merge=0.9850 (last merge round=34)
[S4] round=76 local utility u=0.005906 metrics={'f1_val': 0.9451474111517145, 'auprc': 0.9751553567970317, 'loss_val': 0.24180230562816124, 'psi': 0.9571505894098413}-{'f1_val': 0.9476386963405417, 'auprc': 0.9657584029567052, 'loss_val': 0.24037059184315207, 'psi': 0.9548865789870071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=76 head_norm_before_train=1.748749 cos_to_last_merge=0.9540 (last merge round=41)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.8798200853539466, 'auprc': 0.9895428027494015, 'loss_val': 0.20589507149967587, 'psi': 0.9237091723121286}-{'f1_val': 0.9958933237853395, 'auprc': 0.9949805421614986, 'loss_val': 0.044482764664666614, 'psi': 0.995528211135803}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.764503 cos_to_last_merge=0.9708 (last merge round=40)
[S6] round=76 local utility u=0.137306 metrics={'f1_val': 0.8017176002034114, 'auprc': 0.9386544542941851, 'loss_val': 0.44943042450263426, 'psi': 0.8564923418397209}-{'f1_val': 0.7598833960852872, 'auprc': 0.9263990586701596, 'loss_val': 0.4362716168969711, 'psi': 0.8264896611192362}
[S6] not sending this round → trigger blocked (psi=0.856)
[S7] START round=76 head_norm_before_train=1.698420 cos_to_last_merge=0.9832 (last merge round=41)
[S7] round=76 local utility u=1.000000 metrics={'f1_val': 0.8457608119226591, 'auprc': 0.981102038003788, 'loss_val': 0.1901213272026129, 'psi': 0.8998973023551107}-{'f1_val': 0.4650265996779367, 'auprc': 0.7822266837184224, 'loss_val': 1.4283623689357134, 'psi': 0.591906633294131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=76 head_norm_before_train=2.126176 cos_to_last_merge=0.7602 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.760
[S8] round=76 local utility u=0.028757 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.999141870643967, 'loss_val': 0.03237372451869001, 'psi': 0.9952603572430806}-{'f1_val': 0.9851402783466149, 'auprc': 0.9990498413528108, 'loss_val': 0.044417213290436935, 'psi': 0.9907041035490933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=76 head_norm_before_train=1.759716 cos_to_last_merge=0.9379 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=76 local utility u=0.010906 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9972923638204569, 'loss_val': 0.021523551243936585, 'psi': 0.9971959993124482}-{'f1_val': 0.9935516800558999, 'auprc': 0.99908144632656, 'loss_val': 0.027223069674085037, 'psi': 0.995763586564164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=76 head_norm_before_train=2.309856 cos_to_last_merge=0.8080 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.808
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959784569088004, 'loss_val': 0.02525667914482733, 'psi': 0.9952512729890375}-{'f1_val': 0.9947664837091956, 'auprc': 0.9964257807701973, 'loss_val': 0.024619692527209126, 'psi': 0.9954302025335963}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.798681 cos_to_last_merge=0.9668 (last merge round=34)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9012099518576976, 'auprc': 0.9967640868185704, 'loss_val': 0.12102686374722062, 'psi': 0.9394316058420467}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969183847681589, 'loss_val': 0.02158991722988373, 'psi': 0.9964475588552492}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=2.174673 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6243154407871477, 'auprc': 0.6767809655532613, 'loss_val': 1.51157591772579, 'psi': 0.6453016506935931}-{'f1_val': 0.7222218558714498, 'auprc': 0.7874962359904566, 'loss_val': 1.1875226116932187, 'psi': 0.7483316079190525}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=1.753242 cos_to_last_merge=0.9893 (last merge round=40)
[S14] round=76 local utility u=0.001604 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9987682617302426, 'loss_val': 0.024954028950081426, 'psi': 0.997446438637873}-{'f1_val': 0.9967325241656609, 'auprc': 0.9985902694735861, 'loss_val': 0.028632823564980477, 'psi': 0.997475622288831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=76 head_norm_before_train=1.982908 cos_to_last_merge=0.9579 (last merge round=39)
[S15] round=76 local utility u=0.660336 metrics={'f1_val': 0.9586107558304175, 'auprc': 0.9958331000523284, 'loss_val': 0.09162920366018112, 'psi': 0.9734996935191819}-{'f1_val': 0.8341845791702411, 'auprc': 0.9175224149143334, 'loss_val': 0.43081222218055976, 'psi': 0.867519713467878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=76 head_norm_before_train=2.171940 cos_to_last_merge=0.9960 (last merge round=41)
[S16] round=76 local utility u=0.311750 metrics={'f1_val': 0.9938795673424614, 'auprc': 0.9922395756098847, 'loss_val': 0.03120793723798195, 'psi': 0.9932235706494308}-{'f1_val': 0.9422439129636944, 'auprc': 0.9858649589842148, 'loss_val': 0.3257692492931519, 'psi': 0.9596923313719026}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=76 head_norm_before_train=2.115314 cos_to_last_merge=0.9508 (last merge round=41)
[S17] round=76 local utility u=0.200675 metrics={'f1_val': 0.8628358140558735, 'auprc': 0.9542180089657152, 'loss_val': 0.6859255125389222, 'psi': 0.8993886920198102}-{'f1_val': 0.8260369916852173, 'auprc': 0.9523563373701257, 'loss_val': 0.8608976918005108, 'psi': 0.8765647299591807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=77 head_norm_before_train=2.348175 (no previous merge yet)
[S2] round=77 local utility u=0.009398 metrics={'f1_val': 0.707121896274649, 'auprc': 0.957795410727079, 'loss_val': 0.6170905725928271, 'psi': 0.807391302055621}-{'f1_val': 0.7069094897047318, 'auprc': 0.9549864371471473, 'loss_val': 0.6261853555137432, 'psi': 0.806140268681698}
[S2] not sending this round → trigger blocked (psi=0.807)
[S3] START round=77 head_norm_before_train=2.376634 (no previous merge yet)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9829377018870677, 'auprc': 0.9986384402425097, 'loss_val': 0.04909886794008033, 'psi': 0.9892179972292445}-{'f1_val': 0.9941732255242114, 'auprc': 0.999004917413335, 'loss_val': 0.023669959280934436, 'psi': 0.9961059022798608}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.262700 cos_to_last_merge=0.9847 (last merge round=34)
[S4] round=77 local utility u=0.007313 metrics={'f1_val': 0.9517357244171467, 'auprc': 0.9752960599246004, 'loss_val': 0.2671274653041969, 'psi': 0.9611598586201282}-{'f1_val': 0.9451474111517145, 'auprc': 0.9751553567970317, 'loss_val': 0.24180230562816124, 'psi': 0.9571505894098413}
[S4] not sending this round → trigger blocked (psi=0.961)
[S5] START round=77 head_norm_before_train=1.763653 cos_to_last_merge=0.9525 (last merge round=41)
[S5] round=77 local utility u=0.446964 metrics={'f1_val': 0.9962614844848281, 'auprc': 0.9975984882355775, 'loss_val': 0.03478270069234046, 'psi': 0.9967962859851279}-{'f1_val': 0.8798200853539466, 'auprc': 0.9895428027494015, 'loss_val': 0.20589507149967587, 'psi': 0.9237091723121286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=77 head_norm_before_train=1.774769 cos_to_last_merge=0.9700 (last merge round=40)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.5482935398198375, 'auprc': 0.7985552968866326, 'loss_val': 1.413018290381716, 'psi': 0.6483982426465555}-{'f1_val': 0.8017176002034114, 'auprc': 0.9386544542941851, 'loss_val': 0.44943042450263426, 'psi': 0.8564923418397209}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.700968 cos_to_last_merge=0.9830 (last merge round=41)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.543542203322777, 'auprc': 0.7863895065011373, 'loss_val': 0.9994014270682854, 'psi': 0.6406811245941211}-{'f1_val': 0.8457608119226591, 'auprc': 0.981102038003788, 'loss_val': 0.1901213272026129, 'psi': 0.8998973023551107}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.128499 cos_to_last_merge=0.7585 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.758
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9840816708688683, 'auprc': 0.9989976098153386, 'loss_val': 0.047531214489589926, 'psi': 0.9900480464474564}-{'f1_val': 0.9926726816424898, 'auprc': 0.999141870643967, 'loss_val': 0.03237372451869001, 'psi': 0.9952603572430806}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=1.765083 cos_to_last_merge=0.9374 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9948851074278584, 'loss_val': 0.021841375808179058, 'psi': 0.9959868441398663}-{'f1_val': 0.9971317563071089, 'auprc': 0.9972923638204569, 'loss_val': 0.021523551243936585, 'psi': 0.9971959993124482}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.308962 cos_to_last_merge=0.8075 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.808
[S10] round=77 local utility u=0.000171 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959806353319731, 'loss_val': 0.0249208174126937, 'psi': 0.9952521443583067}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959784569088004, 'loss_val': 0.02525667914482733, 'psi': 0.9952512729890375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=77 head_norm_before_train=1.804159 cos_to_last_merge=0.9665 (last merge round=34)
[S11] round=77 local utility u=0.334494 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964937622795832, 'loss_val': 0.02077059186179453, 'psi': 0.9962777098598189}-{'f1_val': 0.9012099518576976, 'auprc': 0.9967640868185704, 'loss_val': 0.12102686374722062, 'psi': 0.9394316058420467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=77 head_norm_before_train=2.176817 (no previous merge yet)
[S13] round=77 local utility u=0.072831 metrics={'f1_val': 0.6196652351098725, 'auprc': 0.7026069341902076, 'loss_val': 1.4154899499044138, 'psi': 0.6528419147420066}-{'f1_val': 0.6243154407871477, 'auprc': 0.6767809655532613, 'loss_val': 1.51157591772579, 'psi': 0.6453016506935931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=77 head_norm_before_train=1.758597 cos_to_last_merge=0.9890 (last merge round=40)
[S14] round=77 local utility u=0.000032 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9987709678274052, 'loss_val': 0.02489795810394249, 'psi': 0.997447521076738}-{'f1_val': 0.9965652232429598, 'auprc': 0.9987682617302426, 'loss_val': 0.024954028950081426, 'psi': 0.997446438637873}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=77 head_norm_before_train=1.988979 cos_to_last_merge=0.9573 (last merge round=39)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9061832206275193, 'auprc': 0.9920634461006312, 'loss_val': 0.21460586139831364, 'psi': 0.940535310816764}-{'f1_val': 0.9586107558304175, 'auprc': 0.9958331000523284, 'loss_val': 0.09162920366018112, 'psi': 0.9734996935191819}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.175048 cos_to_last_merge=0.9960 (last merge round=41)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.993589291301944, 'auprc': 0.9887135862527038, 'loss_val': 0.03812825178817317, 'psi': 0.9916390092822479}-{'f1_val': 0.9938795673424614, 'auprc': 0.9922395756098847, 'loss_val': 0.03120793723798195, 'psi': 0.9932235706494308}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=2.121199 cos_to_last_merge=0.9505 (last merge round=41)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8250610231284515, 'auprc': 0.9090923070243775, 'loss_val': 0.8876245723593592, 'psi': 0.8586735366868219}-{'f1_val': 0.8628358140558735, 'auprc': 0.9542180089657152, 'loss_val': 0.6859255125389222, 'psi': 0.8993886920198102}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.351670 (no previous merge yet)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7068040410115242, 'auprc': 0.9514693499049632, 'loss_val': 0.6120117326221511, 'psi': 0.8046701645688998}-{'f1_val': 0.707121896274649, 'auprc': 0.957795410727079, 'loss_val': 0.6170905725928271, 'psi': 0.807391302055621}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.379790 (no previous merge yet)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9984918032824787, 'loss_val': 0.1288712940021541, 'psi': 0.9759941737926932}-{'f1_val': 0.9829377018870677, 'auprc': 0.9986384402425097, 'loss_val': 0.04909886794008033, 'psi': 0.9892179972292445}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.265443 cos_to_last_merge=0.9844 (last merge round=34)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9522666649040434, 'auprc': 0.9740992584810945, 'loss_val': 0.2739797877162704, 'psi': 0.9609997023348639}-{'f1_val': 0.9517357244171467, 'auprc': 0.9752960599246004, 'loss_val': 0.2671274653041969, 'psi': 0.9611598586201282}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.776630 cos_to_last_merge=0.9511 (last merge round=41)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9729736788726661, 'auprc': 0.9912019047769585, 'loss_val': 0.1121600461854056, 'psi': 0.980264969234383}-{'f1_val': 0.9962614844848281, 'auprc': 0.9975984882355775, 'loss_val': 0.03478270069234046, 'psi': 0.9967962859851279}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.787378 cos_to_last_merge=0.9693 (last merge round=40)
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.7225153960004209, 'auprc': 0.9037187867286527, 'loss_val': 0.7373418114665605, 'psi': 0.7949967522917136}-{'f1_val': 0.5482935398198375, 'auprc': 0.7985552968866326, 'loss_val': 1.413018290381716, 'psi': 0.6483982426465555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=78 head_norm_before_train=1.703322 cos_to_last_merge=0.9829 (last merge round=41)
[S7] round=78 local utility u=0.240555 metrics={'f1_val': 0.5801160764163389, 'auprc': 0.7943458593630132, 'loss_val': 0.7616037529821498, 'psi': 0.6658079895950086}-{'f1_val': 0.543542203322777, 'auprc': 0.7863895065011373, 'loss_val': 0.9994014270682854, 'psi': 0.6406811245941211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=78 head_norm_before_train=2.136427 cos_to_last_merge=0.7577 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.758
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.983506986749426, 'auprc': 0.9991340006488109, 'loss_val': 0.049311318007800614, 'psi': 0.9897577923091799}-{'f1_val': 0.9840816708688683, 'auprc': 0.9989976098153386, 'loss_val': 0.047531214489589926, 'psi': 0.9900480464474564}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.770945 cos_to_last_merge=0.9369 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9859668146905616, 'auprc': 0.9951774962241045, 'loss_val': 0.05735548993965498, 'psi': 0.9896510873039787}-{'f1_val': 0.996721335281205, 'auprc': 0.9948851074278584, 'loss_val': 0.021841375808179058, 'psi': 0.9959868441398663}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.314386 cos_to_last_merge=0.8072 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.807
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959878856295431, 'loss_val': 0.025099723485051052, 'psi': 0.9952550444773346}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959806353319731, 'loss_val': 0.0249208174126937, 'psi': 0.9952521443583067}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=1.809354 cos_to_last_merge=0.9662 (last merge round=34)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962746411092864, 'loss_val': 0.021453758325223653, 'psi': 0.9961900613917002}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964937622795832, 'loss_val': 0.02077059186179453, 'psi': 0.9962777098598189}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=2.180159 (no previous merge yet)
[S13] round=78 local utility u=0.577252 metrics={'f1_val': 0.7097308183035619, 'auprc': 0.8550432337395224, 'loss_val': 1.258687783030631, 'psi': 0.7678557844779461}-{'f1_val': 0.6196652351098725, 'auprc': 0.7026069341902076, 'loss_val': 1.4154899499044138, 'psi': 0.6528419147420066}
[S13] not sending this round → trigger blocked (psi=0.768)
[S14] START round=78 head_norm_before_train=1.763207 cos_to_last_merge=0.9887 (last merge round=40)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9975545343417789, 'auprc': 0.9983248611974601, 'loss_val': 0.03672883590776118, 'psi': 0.9978626650840514}-{'f1_val': 0.9965652232429598, 'auprc': 0.9987709678274052, 'loss_val': 0.02489795810394249, 'psi': 0.997447521076738}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.995770 cos_to_last_merge=0.9568 (last merge round=39)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.9022306484726497, 'auprc': 0.9923330707687054, 'loss_val': 0.26124799300077806, 'psi': 0.9382716173910719}-{'f1_val': 0.9061832206275193, 'auprc': 0.9920634461006312, 'loss_val': 0.21460586139831364, 'psi': 0.940535310816764}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.175951 cos_to_last_merge=0.9957 (last merge round=41)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9390561885440896, 'auprc': 0.9850960527931516, 'loss_val': 0.4177891091001917, 'psi': 0.9574721342437145}-{'f1_val': 0.993589291301944, 'auprc': 0.9887135862527038, 'loss_val': 0.03812825178817317, 'psi': 0.9916390092822479}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.128430 cos_to_last_merge=0.9500 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.950
[S17] round=78 local utility u=0.227696 metrics={'f1_val': 0.8696040436811368, 'auprc': 0.9110485975573341, 'loss_val': 0.7053591449878529, 'psi': 0.8861818652316158}-{'f1_val': 0.8250610231284515, 'auprc': 0.9090923070243775, 'loss_val': 0.8876245723593592, 'psi': 0.8586735366868219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=79 head_norm_before_train=2.353825 (no previous merge yet)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.7069060158223087, 'auprc': 0.9369118058124681, 'loss_val': 0.6179796426309931, 'psi': 0.7989083318183725}-{'f1_val': 0.7068040410115242, 'auprc': 0.9514693499049632, 'loss_val': 0.6120117326221511, 'psi': 0.8046701645688998}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.799 u=0.0000 p_local=0.0744 f1=0.707 auprc=0.937 bytes=55796
[S3] START round=79 head_norm_before_train=2.376660 (no previous merge yet)
[S3] round=79 local utility u=0.005973 metrics={'f1_val': 0.960995754132836, 'auprc': 0.998492561442395, 'loss_val': 0.11692739751879357, 'psi': 0.9759944770566596}-{'f1_val': 0.960995754132836, 'auprc': 0.9984918032824787, 'loss_val': 0.1288712940021541, 'psi': 0.9759941737926932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S3] r=80 psi=0.976 u=0.0060 p_local=0.0547 f1=0.961 auprc=0.998 bytes=53930
[S4] START round=79 head_norm_before_train=2.268209 cos_to_last_merge=0.9839 (last merge round=34)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9412413165351962, 'auprc': 0.9700640477779919, 'loss_val': 0.23398902676214917, 'psi': 0.9527704090323145}-{'f1_val': 0.9522666649040434, 'auprc': 0.9740992584810945, 'loss_val': 0.2739797877162704, 'psi': 0.9609997023348639}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.953 u=0.0000 p_local=0.0064 f1=0.941 auprc=0.970 bytes=55692
[S5] START round=79 head_norm_before_train=1.787816 cos_to_last_merge=0.9497 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=79 local utility u=0.116877 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9970040383643838, 'loss_val': 0.03333070286415479, 'psi': 0.9963376096169572}-{'f1_val': 0.9729736788726661, 'auprc': 0.9912019047769585, 'loss_val': 0.1121600461854056, 'psi': 0.980264969234383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=80 psi=0.996 u=0.1169 p_local=0.1392 f1=0.996 auprc=0.997 bytes=68420
[S6] START round=79 head_norm_before_train=1.793022 cos_to_last_merge=0.9688 (last merge round=40)
[S6] round=79 local utility u=0.115949 metrics={'f1_val': 0.7490287848766621, 'auprc': 0.9223289671082949, 'loss_val': 0.7203545237565179, 'psi': 0.8183488577693152}-{'f1_val': 0.7225153960004209, 'auprc': 0.9037187867286527, 'loss_val': 0.7373418114665605, 'psi': 0.7949967522917136}
[S6] not sending this round → trigger blocked (psi=0.818)
[S6] r=80 psi=0.818 u=0.1159 p_local=0.3076 f1=0.749 auprc=0.922 bytes=48564
[S7] START round=79 head_norm_before_train=1.705346 cos_to_last_merge=0.9827 (last merge round=41)
[S7] round=79 local utility u=1.000000 metrics={'f1_val': 0.9931097720553581, 'auprc': 0.9984038476989449, 'loss_val': 0.1151890511764362, 'psi': 0.9952274023127928}-{'f1_val': 0.5801160764163389, 'auprc': 0.7943458593630132, 'loss_val': 0.7616037529821498, 'psi': 0.6658079895950086}
[S7] not sending this round → trigger blocked (psi=0.995)
[S7] r=80 psi=0.995 u=1.0000 p_local=0.4226 f1=0.993 auprc=0.998 bytes=63039
[S8] START round=79 head_norm_before_train=2.145435 cos_to_last_merge=0.7571 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.757
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9692729249809178, 'auprc': 0.9989524250248345, 'loss_val': 0.0755488457100448, 'psi': 0.9811447249984844}-{'f1_val': 0.983506986749426, 'auprc': 0.9991340006488109, 'loss_val': 0.049311318007800614, 'psi': 0.9897577923091799}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.981 u=0.0000 p_local=0.0157 f1=0.969 auprc=0.999 bytes=64724
[S9] START round=79 head_norm_before_train=1.775063 cos_to_last_merge=0.9366 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=79 local utility u=0.050126 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9952285474546821, 'loss_val': 0.021784561895948393, 'psi': 0.9961242201505958}-{'f1_val': 0.9859668146905616, 'auprc': 0.9951774962241045, 'loss_val': 0.05735548993965498, 'psi': 0.9896510873039787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] r=80 psi=0.996 u=0.0501 p_local=0.0114 f1=0.997 auprc=0.995 bytes=66523
[S10] START round=79 head_norm_before_train=2.322315 cos_to_last_merge=0.8069 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.807
[S10] round=79 local utility u=0.000075 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959859760801911, 'loss_val': 0.02494486953972299, 'psi': 0.9952542806575938}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959878856295431, 'loss_val': 0.025099723485051052, 'psi': 0.9952550444773346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S10] r=80 psi=0.995 u=0.0001 p_local=0.0002 f1=0.995 auprc=0.996 bytes=68244
[S11] START round=79 head_norm_before_train=1.814961 cos_to_last_merge=0.9659 (last merge round=34)
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9966647712593563, 'loss_val': 0.021491195456638437, 'psi': 0.9962010112248909}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962746411092864, 'loss_val': 0.021453758325223653, 'psi': 0.9961900613917002}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.996 u=0.0000 p_local=0.0478 f1=0.996 auprc=0.997 bytes=73727
[S13] START round=79 head_norm_before_train=2.180638 (no previous merge yet)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.7012915615041134, 'auprc': 0.742468473966176, 'loss_val': 1.2863593992153064, 'psi': 0.7177623264889385}-{'f1_val': 0.7097308183035619, 'auprc': 0.8550432337395224, 'loss_val': 1.258687783030631, 'psi': 0.7678557844779461}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.718 u=0.0000 p_local=0.1928 f1=0.701 auprc=0.742 bytes=50331
[S14] START round=79 head_norm_before_train=1.766061 cos_to_last_merge=0.9885 (last merge round=40)
[S14] round=79 local utility u=0.002483 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9968154185613103, 'loss_val': 0.024916203918383888, 'psi': 0.9970269780828407}-{'f1_val': 0.9975545343417789, 'auprc': 0.9983248611974601, 'loss_val': 0.03672883590776118, 'psi': 0.9978626650840514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] r=80 psi=0.997 u=0.0025 p_local=0.0014 f1=0.997 auprc=0.997 bytes=64745
[S15] START round=79 head_norm_before_train=2.003157 cos_to_last_merge=0.9563 (last merge round=39)
[S15] round=79 local utility u=0.391192 metrics={'f1_val': 0.9917839237967915, 'auprc': 0.9964956033911286, 'loss_val': 0.028671883921127163, 'psi': 0.9936685956345264}-{'f1_val': 0.9022306484726497, 'auprc': 0.9923330707687054, 'loss_val': 0.26124799300077806, 'psi': 0.9382716173910719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] r=80 psi=0.994 u=0.3912 p_local=0.2032 f1=0.992 auprc=0.996 bytes=57593
[S16] START round=79 head_norm_before_train=2.179600 cos_to_last_merge=0.9956 (last merge round=41)
[S16] round=79 local utility u=0.027639 metrics={'f1_val': 0.9399562122453118, 'auprc': 0.9895081119846816, 'loss_val': 0.381147687463341, 'psi': 0.9597769721410597}-{'f1_val': 0.9390561885440896, 'auprc': 0.9850960527931516, 'loss_val': 0.4177891091001917, 'psi': 0.9574721342437145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] r=80 psi=0.960 u=0.0276 p_local=0.0515 f1=0.940 auprc=0.990 bytes=53875
[S17] START round=79 head_norm_before_train=2.138424 cos_to_last_merge=0.9494 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.830708624881091, 'auprc': 0.938842785222958, 'loss_val': 0.8319947471737588, 'psi': 0.8739622890178378}-{'f1_val': 0.8696040436811368, 'auprc': 0.9110485975573341, 'loss_val': 0.7053591449878529, 'psi': 0.8861818652316158}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.874 u=0.0000 p_local=0.1051 f1=0.831 auprc=0.939 bytes=66604
[S2] START round=80 head_norm_before_train=2.359440 (no previous merge yet)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.7070145125338567, 'auprc': 0.9195160806455946, 'loss_val': 0.6328810888526334, 'psi': 0.792015139778552}-{'f1_val': 0.7069060158223087, 'auprc': 0.9369118058124681, 'loss_val': 0.6179796426309931, 'psi': 0.7989083318183725}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=2.375119 (no previous merge yet)
[S3] round=80 local utility u=0.019364 metrics={'f1_val': 0.9628852465428241, 'auprc': 0.9989096217523163, 'loss_val': 0.09078729664541144, 'psi': 0.977294996626621}-{'f1_val': 0.960995754132836, 'auprc': 0.998492561442395, 'loss_val': 0.11692739751879357, 'psi': 0.9759944770566596}
[S3] not sending this round → trigger blocked (psi=0.977)
[S4] START round=80 head_norm_before_train=2.274982 cos_to_last_merge=0.9838 (last merge round=34)
[S4] round=80 local utility u=0.004920 metrics={'f1_val': 0.9422182522587765, 'auprc': 0.9805878461858989, 'loss_val': 0.2615826011535019, 'psi': 0.9575660898296254}-{'f1_val': 0.9412413165351962, 'auprc': 0.9700640477779919, 'loss_val': 0.23398902676214917, 'psi': 0.9527704090323145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=80 head_norm_before_train=1.798609 cos_to_last_merge=0.9482 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=80 local utility u=0.000054 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9966959421976465, 'loss_val': 0.032298629262137925, 'psi': 0.9962143711502622}-{'f1_val': 0.9958933237853395, 'auprc': 0.9970040383643838, 'loss_val': 0.03333070286415479, 'psi': 0.9963376096169572}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=80 head_norm_before_train=1.801782 cos_to_last_merge=0.9683 (last merge round=40)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6093163404323588, 'auprc': 0.8490800944552499, 'loss_val': 1.086923747114832, 'psi': 0.7052218420415153}-{'f1_val': 0.7490287848766621, 'auprc': 0.9223289671082949, 'loss_val': 0.7203545237565179, 'psi': 0.8183488577693152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.707594 cos_to_last_merge=0.9824 (last merge round=41)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.536017368649099, 'auprc': 0.7804034692985427, 'loss_val': 1.1190646905979778, 'psi': 0.6337718089088764}-{'f1_val': 0.9931097720553581, 'auprc': 0.9984038476989449, 'loss_val': 0.1151890511764362, 'psi': 0.9952274023127928}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=2.149232 cos_to_last_merge=0.7561 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.756
[S8] round=80 local utility u=0.100805 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9985874491473299, 'loss_val': 0.02508248532445048, 'psi': 0.9962225586165578}-{'f1_val': 0.9692729249809178, 'auprc': 0.9989524250248345, 'loss_val': 0.0755488457100448, 'psi': 0.9811447249984844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=80 head_norm_before_train=1.777620 cos_to_last_merge=0.9363 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=80 local utility u=0.005148 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9990672306807526, 'loss_val': 0.02148428785335677, 'psi': 0.9975075743773237}-{'f1_val': 0.996721335281205, 'auprc': 0.9952285474546821, 'loss_val': 0.021784561895948393, 'psi': 0.9961242201505958}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=80 head_norm_before_train=2.326766 cos_to_last_merge=0.8065 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.807
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959760204643698, 'loss_val': 0.02521017006929277, 'psi': 0.9952502984112652}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959859760801911, 'loss_val': 0.02494486953972299, 'psi': 0.9952542806575938}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.819772 cos_to_last_merge=0.9656 (last merge round=34)
[S11] round=80 local utility u=0.001781 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970442005810142, 'loss_val': 0.020518620684238584, 'psi': 0.9964978851803913}-{'f1_val': 0.9958918378685807, 'auprc': 0.9966647712593563, 'loss_val': 0.021491195456638437, 'psi': 0.9962010112248909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=80 head_norm_before_train=2.178767 (no previous merge yet)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.68618817662571, 'auprc': 0.7377571357154247, 'loss_val': 1.275458322528277, 'psi': 0.7068157602615959}-{'f1_val': 0.7012915615041134, 'auprc': 0.742468473966176, 'loss_val': 1.2863593992153064, 'psi': 0.7177623264889385}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.771216 cos_to_last_merge=0.9883 (last merge round=40)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9967111461306324, 'loss_val': 0.024787651331522737, 'psi': 0.9967391004784194}-{'f1_val': 0.9971680177638609, 'auprc': 0.9968154185613103, 'loss_val': 0.024916203918383888, 'psi': 0.9970269780828407}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.010218 cos_to_last_merge=0.9557 (last merge round=39)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.8870542122260086, 'auprc': 0.9372036344485107, 'loss_val': 0.37485484519526147, 'psi': 0.9071139811150094}-{'f1_val': 0.9917839237967915, 'auprc': 0.9964956033911286, 'loss_val': 0.028671883921127163, 'psi': 0.9936685956345264}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.185053 cos_to_last_merge=0.9955 (last merge round=41)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.8556451750370326, 'auprc': 0.8874963951800878, 'loss_val': 1.1357625250647478, 'psi': 0.8683856630942547}-{'f1_val': 0.9399562122453118, 'auprc': 0.9895081119846816, 'loss_val': 0.381147687463341, 'psi': 0.9597769721410597}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.147372 cos_to_last_merge=0.9488 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=80 local utility u=0.006236 metrics={'f1_val': 0.8321416594931773, 'auprc': 0.9389347074328173, 'loss_val': 0.8283961912785214, 'psi': 0.8748588786690332}-{'f1_val': 0.830708624881091, 'auprc': 0.938842785222958, 'loss_val': 0.8319947471737588, 'psi': 0.8739622890178378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=81 head_norm_before_train=2.367096 (no previous merge yet)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7053661338830043, 'auprc': 0.9038508412421794, 'loss_val': 0.6546146222349426, 'psi': 0.7847600168266744}-{'f1_val': 0.7070145125338567, 'auprc': 0.9195160806455946, 'loss_val': 0.6328810888526334, 'psi': 0.792015139778552}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.376853 (no previous merge yet)
[S3] round=81 local utility u=0.039907 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.9989980755612755, 'loss_val': 0.07379390709060171, 'psi': 0.9835858992949891}-{'f1_val': 0.9628852465428241, 'auprc': 0.9989096217523163, 'loss_val': 0.09078729664541144, 'psi': 0.977294996626621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=81 head_norm_before_train=2.282069 cos_to_last_merge=0.9835 (last merge round=34)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9448671420934186, 'auprc': 0.9764774690539486, 'loss_val': 0.2861873475184314, 'psi': 0.9575112728776305}-{'f1_val': 0.9422182522587765, 'auprc': 0.9805878461858989, 'loss_val': 0.2615826011535019, 'psi': 0.9575660898296254}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.806949 cos_to_last_merge=0.9470 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9891146062724383, 'loss_val': 0.05291927568083538, 'psi': 0.993094352112649}-{'f1_val': 0.9958933237853395, 'auprc': 0.9966959421976465, 'loss_val': 0.032298629262137925, 'psi': 0.9962143711502622}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.809322 cos_to_last_merge=0.9678 (last merge round=40)
[S6] round=81 local utility u=0.821038 metrics={'f1_val': 0.763872756337726, 'auprc': 0.9170594393442668, 'loss_val': 0.576124749017423, 'psi': 0.8251474295403423}-{'f1_val': 0.6093163404323588, 'auprc': 0.8490800944552499, 'loss_val': 1.086923747114832, 'psi': 0.7052218420415153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=81 head_norm_before_train=1.708873 cos_to_last_merge=0.9823 (last merge round=41)
[S7] round=81 local utility u=0.282304 metrics={'f1_val': 0.5809235511686354, 'auprc': 0.7932103422936273, 'loss_val': 0.8623136110785621, 'psi': 0.6658382676186321}-{'f1_val': 0.536017368649099, 'auprc': 0.7804034692985427, 'loss_val': 1.1190646905979778, 'psi': 0.6337718089088764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=81 head_norm_before_train=2.156418 cos_to_last_merge=0.7555 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.756
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9800147841809312, 'auprc': 0.9991422566699332, 'loss_val': 0.04767494121194853, 'psi': 0.987665773176532}-{'f1_val': 0.9946459649293765, 'auprc': 0.9985874491473299, 'loss_val': 0.02508248532445048, 'psi': 0.9962225586165578}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=1.781145 cos_to_last_merge=0.9359 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9956348431256092, 'auprc': 0.9991174037631831, 'loss_val': 0.022665763104599237, 'psi': 0.9970278673806388}-{'f1_val': 0.9964678035083712, 'auprc': 0.9990672306807526, 'loss_val': 0.02148428785335677, 'psi': 0.9975075743773237}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.331674 cos_to_last_merge=0.8062 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=81 local utility u=0.000078 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959848665599306, 'loss_val': 0.02508006792975889, 'psi': 0.9952538368494896}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959760204643698, 'loss_val': 0.02521017006929277, 'psi': 0.9952502984112652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=81 head_norm_before_train=1.823397 cos_to_last_merge=0.9652 (last merge round=34)
[S11] round=81 local utility u=0.001032 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9969441988080969, 'loss_val': 0.020657200014195836, 'psi': 0.9967082325202972}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970442005810142, 'loss_val': 0.020518620684238584, 'psi': 0.9964978851803913}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=81 head_norm_before_train=2.180140 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6436989521842253, 'auprc': 0.7217256353215237, 'loss_val': 1.3507106184652902, 'psi': 0.6749096254391447}-{'f1_val': 0.68618817662571, 'auprc': 0.7377571357154247, 'loss_val': 1.275458322528277, 'psi': 0.7068157602615959}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.775753 cos_to_last_merge=0.9880 (last merge round=40)
[S14] round=81 local utility u=0.004379 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986632822218722, 'loss_val': 0.023192577699865338, 'psi': 0.9976506129390147}-{'f1_val': 0.9967577367102773, 'auprc': 0.9967111461306324, 'loss_val': 0.024787651331522737, 'psi': 0.9967391004784194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=81 head_norm_before_train=2.017347 cos_to_last_merge=0.9552 (last merge round=39)
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.8334419688314324, 'auprc': 0.9172377772378937, 'loss_val': 0.4445253398759296, 'psi': 0.8669602921940169}-{'f1_val': 0.8870542122260086, 'auprc': 0.9372036344485107, 'loss_val': 0.37485484519526147, 'psi': 0.9071139811150094}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.188651 cos_to_last_merge=0.9955 (last merge round=41)
[S16] round=81 local utility u=0.812888 metrics={'f1_val': 0.9426121717911639, 'auprc': 0.9815144781862919, 'loss_val': 0.313842635242398, 'psi': 0.958173094349215}-{'f1_val': 0.8556451750370326, 'auprc': 0.8874963951800878, 'loss_val': 1.1357625250647478, 'psi': 0.8683856630942547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=81 head_norm_before_train=2.152481 cos_to_last_merge=0.9484 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=81 local utility u=0.228657 metrics={'f1_val': 0.8791111536731893, 'auprc': 0.9385818614543455, 'loss_val': 0.6518397423984239, 'psi': 0.9028994367856518}-{'f1_val': 0.8321416594931773, 'auprc': 0.9389347074328173, 'loss_val': 0.8283961912785214, 'psi': 0.8748588786690332}
[S17] not sending this round → trigger blocked (psi=0.903)
[S2] START round=82 head_norm_before_train=2.371850 (no previous merge yet)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.6922842913596143, 'auprc': 0.8196046554647678, 'loss_val': 0.7720168059852315, 'psi': 0.7432124370016757}-{'f1_val': 0.7053661338830043, 'auprc': 0.9038508412421794, 'loss_val': 0.6546146222349426, 'psi': 0.7847600168266744}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.380298 (no previous merge yet)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.965181981083605, 'auprc': 0.9989581427198564, 'loss_val': 0.0870352437223966, 'psi': 0.9786924457381054}-{'f1_val': 0.9733111151174647, 'auprc': 0.9989980755612755, 'loss_val': 0.07379390709060171, 'psi': 0.9835858992949891}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.288028 cos_to_last_merge=0.9831 (last merge round=34)
[S4] round=82 local utility u=0.003926 metrics={'f1_val': 0.9533415497501896, 'auprc': 0.9743008831190911, 'loss_val': 0.3226520990544906, 'psi': 0.9617252830977503}-{'f1_val': 0.9448671420934186, 'auprc': 0.9764774690539486, 'loss_val': 0.2861873475184314, 'psi': 0.9575112728776305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=82 head_norm_before_train=1.815599 cos_to_last_merge=0.9460 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=82 local utility u=0.018341 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9956886655600725, 'loss_val': 0.03683450345195332, 'psi': 0.9958114604952326}-{'f1_val': 0.9957475160061228, 'auprc': 0.9891146062724383, 'loss_val': 0.05291927568083538, 'psi': 0.993094352112649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=82 head_norm_before_train=1.816881 cos_to_last_merge=0.9672 (last merge round=40)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.7297904687954672, 'auprc': 0.9232175603426498, 'loss_val': 0.5336532613092083, 'psi': 0.8071613054143403}-{'f1_val': 0.763872756337726, 'auprc': 0.9170594393442668, 'loss_val': 0.576124749017423, 'psi': 0.8251474295403423}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.712606 cos_to_last_merge=0.9820 (last merge round=41)
[S7] round=82 local utility u=0.616212 metrics={'f1_val': 0.6889221959211582, 'auprc': 0.820140341898459, 'loss_val': 0.3586717623365099, 'psi': 0.7414094543120786}-{'f1_val': 0.5809235511686354, 'auprc': 0.7932103422936273, 'loss_val': 0.8623136110785621, 'psi': 0.6658382676186321}
[S7] not sending this round → trigger blocked (psi=0.741)
[S8] START round=82 head_norm_before_train=2.165280 cos_to_last_merge=0.7553 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=82 local utility u=0.007810 metrics={'f1_val': 0.9819779220033448, 'auprc': 0.9989997990892783, 'loss_val': 0.043406838009528825, 'psi': 0.9887866728377182}-{'f1_val': 0.9800147841809312, 'auprc': 0.9991422566699332, 'loss_val': 0.04767494121194853, 'psi': 0.987665773176532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=82 head_norm_before_train=1.786092 cos_to_last_merge=0.9354 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=82 local utility u=0.003054 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9991281663215412, 'loss_val': 0.02158766605275858, 'psi': 0.9975319486336391}-{'f1_val': 0.9956348431256092, 'auprc': 0.9991174037631831, 'loss_val': 0.022665763104599237, 'psi': 0.9970278673806388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=82 head_norm_before_train=2.338871 cos_to_last_merge=0.8059 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=82 local utility u=0.000161 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959948097767817, 'loss_val': 0.024788167136371858, 'psi': 0.99525781413623}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959848665599306, 'loss_val': 0.02508006792975889, 'psi': 0.9952538368494896}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=82 head_norm_before_train=1.826455 cos_to_last_merge=0.9650 (last merge round=34)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.996643901461864, 'loss_val': 0.056531112232766946, 'psi': 0.996588113581804}-{'f1_val': 0.9965509216617638, 'auprc': 0.9969441988080969, 'loss_val': 0.020657200014195836, 'psi': 0.9967082325202972}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.184819 (no previous merge yet)
[S13] round=82 local utility u=0.154368 metrics={'f1_val': 0.6779576938121791, 'auprc': 0.743046075570375, 'loss_val': 1.3114886552751932, 'psi': 0.7039930465154575}-{'f1_val': 0.6436989521842253, 'auprc': 0.7217256353215237, 'loss_val': 1.3507106184652902, 'psi': 0.6749096254391447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=82 head_norm_before_train=1.780497 cos_to_last_merge=0.9877 (last merge round=40)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9474731303623251, 'auprc': 0.9964990439640566, 'loss_val': 0.07589251319042033, 'psi': 0.9670834958030177}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986632822218722, 'loss_val': 0.023192577699865338, 'psi': 0.9976506129390147}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.024657 cos_to_last_merge=0.9547 (last merge round=39)
[S15] round=82 local utility u=0.540256 metrics={'f1_val': 0.9275659418941388, 'auprc': 0.9963388713900143, 'loss_val': 0.16606122423790684, 'psi': 0.9550751136924891}-{'f1_val': 0.8334419688314324, 'auprc': 0.9172377772378937, 'loss_val': 0.4445253398759296, 'psi': 0.8669602921940169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=82 head_norm_before_train=2.185134 cos_to_last_merge=0.9955 (last merge round=41)
[S16] round=82 local utility u=0.304752 metrics={'f1_val': 0.9927960538530322, 'auprc': 0.9933063222572072, 'loss_val': 0.040817767396887694, 'psi': 0.9930001612147021}-{'f1_val': 0.9426121717911639, 'auprc': 0.9815144781862919, 'loss_val': 0.313842635242398, 'psi': 0.958173094349215}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=82 head_norm_before_train=2.159061 cos_to_last_merge=0.9478 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=82 local utility u=0.019037 metrics={'f1_val': 0.8810735459929362, 'auprc': 0.9461197745240424, 'loss_val': 0.648153216407268, 'psi': 0.9070920374053787}-{'f1_val': 0.8791111536731893, 'auprc': 0.9385818614543455, 'loss_val': 0.6518397423984239, 'psi': 0.9028994367856518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=83 head_norm_before_train=2.374815 (no previous merge yet)
[S2] round=83 local utility u=0.321783 metrics={'f1_val': 0.7070161873882495, 'auprc': 0.9523628883207279, 'loss_val': 0.6151170189932496, 'psi': 0.8051548677612408}-{'f1_val': 0.6922842913596143, 'auprc': 0.8196046554647678, 'loss_val': 0.7720168059852315, 'psi': 0.7432124370016757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=83 head_norm_before_train=2.384721 (no previous merge yet)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.998950445269646, 'loss_val': 0.09480304874971944, 'psi': 0.9767571770064176}-{'f1_val': 0.965181981083605, 'auprc': 0.9989581427198564, 'loss_val': 0.0870352437223966, 'psi': 0.9786924457381054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.294940 cos_to_last_merge=0.9827 (last merge round=34)
[S4] round=83 local utility u=0.030860 metrics={'f1_val': 0.9539269542947624, 'auprc': 0.9808217706040959, 'loss_val': 0.2840081050040602, 'psi': 0.9646848808184958}-{'f1_val': 0.9533415497501896, 'auprc': 0.9743008831190911, 'loss_val': 0.3226520990544906, 'psi': 0.9617252830977503}
[S4] not sending this round → trigger blocked (psi=0.965)
[S5] START round=83 head_norm_before_train=1.821571 cos_to_last_merge=0.9455 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9885710028829844, 'loss_val': 0.04911920403518994, 'psi': 0.9928769107568675}-{'f1_val': 0.9958933237853395, 'auprc': 0.9956886655600725, 'loss_val': 0.03683450345195332, 'psi': 0.9958114604952326}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.823265 cos_to_last_merge=0.9668 (last merge round=40)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.6625134644094962, 'auprc': 0.865413855921678, 'loss_val': 0.9138000342294617, 'psi': 0.7436736210143688}-{'f1_val': 0.7297904687954672, 'auprc': 0.9232175603426498, 'loss_val': 0.5336532613092083, 'psi': 0.8071613054143403}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.716494 cos_to_last_merge=0.9817 (last merge round=41)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6835177668268785, 'auprc': 0.8181476778726393, 'loss_val': 0.3742627231054146, 'psi': 0.7373697312451828}-{'f1_val': 0.6889221959211582, 'auprc': 0.820140341898459, 'loss_val': 0.3586717623365099, 'psi': 0.7414094543120786}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.174007 cos_to_last_merge=0.7547 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=83 local utility u=0.041739 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9990781681964221, 'loss_val': 0.028247158369687175, 'psi': 0.9956262676568534}-{'f1_val': 0.9819779220033448, 'auprc': 0.9989997990892783, 'loss_val': 0.043406838009528825, 'psi': 0.9887866728377182}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=83 head_norm_before_train=1.791448 cos_to_last_merge=0.9350 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9974509588177483, 'loss_val': 0.02976885886785877, 'psi': 0.9955943770447895}-{'f1_val': 0.9964678035083712, 'auprc': 0.9991281663215412, 'loss_val': 0.02158766605275858, 'psi': 0.9975319486336391}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.346709 cos_to_last_merge=0.8056 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959832422517576, 'loss_val': 0.024938535191647695, 'psi': 0.9952531871262205}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959948097767817, 'loss_val': 0.024788167136371858, 'psi': 0.99525781413623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.829715 cos_to_last_merge=0.9648 (last merge round=34)
[S11] round=83 local utility u=0.017777 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969883408225816, 'loss_val': 0.019507367079073905, 'psi': 0.9964755412770182}-{'f1_val': 0.9965509216617638, 'auprc': 0.996643901461864, 'loss_val': 0.056531112232766946, 'psi': 0.996588113581804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=83 head_norm_before_train=2.201918 (no previous merge yet)
[S13] round=83 local utility u=0.359086 metrics={'f1_val': 0.731113705367104, 'auprc': 0.8158815191531789, 'loss_val': 1.130759569846216, 'psi': 0.7650208308815339}-{'f1_val': 0.6779576938121791, 'auprc': 0.743046075570375, 'loss_val': 1.3114886552751932, 'psi': 0.7039930465154575}
[S13] not sending this round → trigger blocked (psi=0.765)
[S14] START round=83 head_norm_before_train=1.782205 cos_to_last_merge=0.9874 (last merge round=40)
[S14] round=83 local utility u=0.176183 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9984681800660857, 'loss_val': 0.025142139659772144, 'psi': 0.9974419140526007}-{'f1_val': 0.9474731303623251, 'auprc': 0.9964990439640566, 'loss_val': 0.07589251319042033, 'psi': 0.9670834958030177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=83 head_norm_before_train=2.031995 cos_to_last_merge=0.9541 (last merge round=39)
[S15] round=83 local utility u=0.281933 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973248869774571, 'loss_val': 0.02023766923078576, 'psi': 0.9969779558234952}-{'f1_val': 0.9275659418941388, 'auprc': 0.9963388713900143, 'loss_val': 0.16606122423790684, 'psi': 0.9550751136924891}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=83 head_norm_before_train=2.187119 cos_to_last_merge=0.9954 (last merge round=41)
[S16] round=83 local utility u=0.000238 metrics={'f1_val': 0.9921166001939918, 'auprc': 0.9934043459633086, 'loss_val': 0.036559660461214415, 'psi': 0.9926316985017185}-{'f1_val': 0.9927960538530322, 'auprc': 0.9933063222572072, 'loss_val': 0.040817767396887694, 'psi': 0.9930001612147021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=83 head_norm_before_train=2.164862 cos_to_last_merge=0.9475 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8309881443728142, 'auprc': 0.9291775051119489, 'loss_val': 0.838995649074265, 'psi': 0.870263888668468}-{'f1_val': 0.8810735459929362, 'auprc': 0.9461197745240424, 'loss_val': 0.648153216407268, 'psi': 0.9070920374053787}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.378420 (no previous merge yet)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7163332288912437, 'auprc': 0.8477122551599481, 'loss_val': 0.7996757153333782, 'psi': 0.7688848393987255}-{'f1_val': 0.7070161873882495, 'auprc': 0.9523628883207279, 'loss_val': 0.6151170189932496, 'psi': 0.8051548677612408}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.389457 (no previous merge yet)
[S3] round=84 local utility u=0.051553 metrics={'f1_val': 0.975089227936066, 'auprc': 0.9989968547112569, 'loss_val': 0.0706025555224106, 'psi': 0.9846522786461425}-{'f1_val': 0.9619616648309319, 'auprc': 0.998950445269646, 'loss_val': 0.09480304874971944, 'psi': 0.9767571770064176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=84 head_norm_before_train=2.298495 cos_to_last_merge=0.9825 (last merge round=34)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9519097643570634, 'auprc': 0.976383204471919, 'loss_val': 0.2956137545571853, 'psi': 0.9616991404030056}-{'f1_val': 0.9539269542947624, 'auprc': 0.9808217706040959, 'loss_val': 0.2840081050040602, 'psi': 0.9646848808184958}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.826656 cos_to_last_merge=0.9449 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=84 local utility u=0.016562 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.99449978521386, 'loss_val': 0.03378085431673533, 'psi': 0.9952484236892176}-{'f1_val': 0.9957475160061228, 'auprc': 0.9885710028829844, 'loss_val': 0.04911920403518994, 'psi': 0.9928769107568675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=84 head_norm_before_train=1.832801 cos_to_last_merge=0.9662 (last merge round=40)
[S6] round=84 local utility u=0.641894 metrics={'f1_val': 0.7878136908350412, 'auprc': 0.9288109694656713, 'loss_val': 0.5720055722459172, 'psi': 0.8442126022872932}-{'f1_val': 0.6625134644094962, 'auprc': 0.865413855921678, 'loss_val': 0.9138000342294617, 'psi': 0.7436736210143688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=84 head_norm_before_train=1.724283 cos_to_last_merge=0.9810 (last merge round=41)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6028502337867858, 'auprc': 0.7961651731753966, 'loss_val': 0.6752696007498507, 'psi': 0.6801762095422301}-{'f1_val': 0.6835177668268785, 'auprc': 0.8181476778726393, 'loss_val': 0.3742627231054146, 'psi': 0.7373697312451828}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.178546 cos_to_last_merge=0.7533 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.753
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9881924251044498, 'auprc': 0.9988888122108949, 'loss_val': 0.04135202153480997, 'psi': 0.9924709799470278}-{'f1_val': 0.9933250006304741, 'auprc': 0.9990781681964221, 'loss_val': 0.028247158369687175, 'psi': 0.9956262676568534}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=1.796860 cos_to_last_merge=0.9345 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=84 local utility u=0.007855 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9948970122143107, 'loss_val': 0.020412297079927613, 'psi': 0.9959742996445816}-{'f1_val': 0.994356655862817, 'auprc': 0.9974509588177483, 'loss_val': 0.02976885886785877, 'psi': 0.9955943770447895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=84 head_norm_before_train=2.349701 cos_to_last_merge=0.8052 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.805
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959428872898699, 'loss_val': 0.025382892983930525, 'psi': 0.9952370451414654}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959832422517576, 'loss_val': 0.024938535191647695, 'psi': 0.9952531871262205}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=1.834224 cos_to_last_merge=0.9645 (last merge round=34)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965302079676533, 'loss_val': 0.020285167867095596, 'psi': 0.9962922881350469}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969883408225816, 'loss_val': 0.019507367079073905, 'psi': 0.9964755412770182}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.205101 (no previous merge yet)
[S13] round=84 local utility u=0.087398 metrics={'f1_val': 0.7340179102404953, 'auprc': 0.8755543426460238, 'loss_val': 1.1524078258744106, 'psi': 0.7906324832027067}-{'f1_val': 0.731113705367104, 'auprc': 0.8158815191531789, 'loss_val': 1.130759569846216, 'psi': 0.7650208308815339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=84 head_norm_before_train=1.786058 cos_to_last_merge=0.9871 (last merge round=40)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9957143947105587, 'auprc': 0.9980882902021152, 'loss_val': 0.026076876535071108, 'psi': 0.9966639529071812}-{'f1_val': 0.9967577367102773, 'auprc': 0.9984681800660857, 'loss_val': 0.025142139659772144, 'psi': 0.9974419140526007}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.039208 cos_to_last_merge=0.9536 (last merge round=39)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.7017632666582336, 'auprc': 0.8962845286644057, 'loss_val': 0.6944162248773926, 'psi': 0.7795717714607024}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973248869774571, 'loss_val': 0.02023766923078576, 'psi': 0.9969779558234952}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.190990 cos_to_last_merge=0.9955 (last merge round=41)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.991834654586879, 'auprc': 0.9933529840322167, 'loss_val': 0.03935636295476597, 'psi': 0.992441986365014}-{'f1_val': 0.9921166001939918, 'auprc': 0.9934043459633086, 'loss_val': 0.036559660461214415, 'psi': 0.9926316985017185}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=2.169765 cos_to_last_merge=0.9470 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=84 local utility u=0.234092 metrics={'f1_val': 0.880462936949688, 'auprc': 0.9275028726251472, 'loss_val': 0.662636999766477, 'psi': 0.8992789112198717}-{'f1_val': 0.8309881443728142, 'auprc': 0.9291775051119489, 'loss_val': 0.838995649074265, 'psi': 0.870263888668468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=85 head_norm_before_train=2.381615 (no previous merge yet)
[S2] round=85 local utility u=0.091765 metrics={'f1_val': 0.7022614735194993, 'auprc': 0.8884146715782657, 'loss_val': 0.6538223342547188, 'psi': 0.7767227527430058}-{'f1_val': 0.7163332288912437, 'auprc': 0.8477122551599481, 'loss_val': 0.7996757153333782, 'psi': 0.7688848393987255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=85 head_norm_before_train=2.393030 (no previous merge yet)
[S3] round=85 local utility u=0.027516 metrics={'f1_val': 0.9805451254074223, 'auprc': 0.9990000900418738, 'loss_val': 0.04831534178907176, 'psi': 0.9879271112612029}-{'f1_val': 0.975089227936066, 'auprc': 0.9989968547112569, 'loss_val': 0.0706025555224106, 'psi': 0.9846522786461425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=85 head_norm_before_train=2.301745 cos_to_last_merge=0.9823 (last merge round=34)
[S4] round=85 local utility u=0.017886 metrics={'f1_val': 0.9472516351919278, 'auprc': 0.9860926663989019, 'loss_val': 0.2610220786955773, 'psi': 0.9627880476747175}-{'f1_val': 0.9519097643570634, 'auprc': 0.976383204471919, 'loss_val': 0.2956137545571853, 'psi': 0.9616991404030056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=85 head_norm_before_train=1.834756 cos_to_last_merge=0.9440 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9891484272625866, 'loss_val': 0.04267753652373905, 'psi': 0.9931078805087084}-{'f1_val': 0.9957475160061228, 'auprc': 0.99449978521386, 'loss_val': 0.03378085431673533, 'psi': 0.9952484236892176}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.842923 cos_to_last_merge=0.9657 (last merge round=40)
[S6] round=85 local utility u=0.636191 metrics={'f1_val': 0.9267577818465013, 'auprc': 0.959736936817178, 'loss_val': 0.226066899581244, 'psi': 0.939949443834772}-{'f1_val': 0.7878136908350412, 'auprc': 0.9288109694656713, 'loss_val': 0.5720055722459172, 'psi': 0.8442126022872932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=85 head_norm_before_train=1.731155 cos_to_last_merge=0.9801 (last merge round=41)
[S7] round=85 local utility u=1.000000 metrics={'f1_val': 0.9591520304452541, 'auprc': 0.9937097041164887, 'loss_val': 0.18787870735674575, 'psi': 0.972975099913748}-{'f1_val': 0.6028502337867858, 'auprc': 0.7961651731753966, 'loss_val': 0.6752696007498507, 'psi': 0.6801762095422301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=85 head_norm_before_train=2.179204 cos_to_last_merge=0.7514 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.751
[S8] round=85 local utility u=0.004194 metrics={'f1_val': 0.9889098366469105, 'auprc': 0.9989466881727358, 'loss_val': 0.037441605728484824, 'psi': 0.9929245772572406}-{'f1_val': 0.9881924251044498, 'auprc': 0.9988888122108949, 'loss_val': 0.04135202153480997, 'psi': 0.9924709799470278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=85 head_norm_before_train=1.802198 cos_to_last_merge=0.9341 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.934
[S9] round=85 local utility u=0.002031 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9953428089065419, 'loss_val': 0.02032251488542319, 'psi': 0.9964161773468821}-{'f1_val': 0.9966924912647621, 'auprc': 0.9948970122143107, 'loss_val': 0.020412297079927613, 'psi': 0.9959742996445816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=85 head_norm_before_train=2.353843 cos_to_last_merge=0.8049 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.805
[S10] round=85 local utility u=0.000212 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959310056626719, 'loss_val': 0.024922799922485885, 'psi': 0.9952322924905861}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959428872898699, 'loss_val': 0.025382892983930525, 'psi': 0.9952370451414654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=85 head_norm_before_train=1.839434 cos_to_last_merge=0.9642 (last merge round=34)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967705354443146, 'loss_val': 0.02109086098332692, 'psi': 0.9963884191257114}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965302079676533, 'loss_val': 0.020285167867095596, 'psi': 0.9962922881350469}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.206813 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6551587425852314, 'auprc': 0.7554296147572188, 'loss_val': 1.1587702441322958, 'psi': 0.6952670914540264}-{'f1_val': 0.7340179102404953, 'auprc': 0.8755543426460238, 'loss_val': 1.1524078258744106, 'psi': 0.7906324832027067}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=1.790487 cos_to_last_merge=0.9869 (last merge round=40)
[S14] round=85 local utility u=0.000165 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9988286000097786, 'loss_val': 0.03161470432877308, 'psi': 0.9973247883988179}-{'f1_val': 0.9957143947105587, 'auprc': 0.9980882902021152, 'loss_val': 0.026076876535071108, 'psi': 0.9966639529071812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=85 head_norm_before_train=2.045644 cos_to_last_merge=0.9532 (last merge round=39)
[S15] round=85 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9894625100915995, 'loss_val': 0.02137977456198797, 'psi': 0.9938330050691522}-{'f1_val': 0.7017632666582336, 'auprc': 0.8962845286644057, 'loss_val': 0.6944162248773926, 'psi': 0.7795717714607024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=85 head_norm_before_train=2.189460 cos_to_last_merge=0.9951 (last merge round=41)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9909593746439745, 'auprc': 0.9925393549131696, 'loss_val': 0.04537308843951924, 'psi': 0.9915913667516525}-{'f1_val': 0.991834654586879, 'auprc': 0.9933529840322167, 'loss_val': 0.03935636295476597, 'psi': 0.992441986365014}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.170774 cos_to_last_merge=0.9467 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=85 local utility u=0.048999 metrics={'f1_val': 0.8862522361775913, 'auprc': 0.9400885282984142, 'loss_val': 0.6371325652958747, 'psi': 0.9077867530259205}-{'f1_val': 0.880462936949688, 'auprc': 0.9275028726251472, 'loss_val': 0.662636999766477, 'psi': 0.8992789112198717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=86 head_norm_before_train=2.384934 (no previous merge yet)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.6936895182403964, 'auprc': 0.8183338887208926, 'loss_val': 0.7662577729079932, 'psi': 0.7435472664325948}-{'f1_val': 0.7022614735194993, 'auprc': 0.8884146715782657, 'loss_val': 0.6538223342547188, 'psi': 0.7767227527430058}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.395169 (no previous merge yet)
[S3] round=86 local utility u=0.028271 metrics={'f1_val': 0.9885610761985486, 'auprc': 0.9989708902858384, 'loss_val': 0.03978087283444006, 'psi': 0.9927250018334646}-{'f1_val': 0.9805451254074223, 'auprc': 0.9990000900418738, 'loss_val': 0.04831534178907176, 'psi': 0.9879271112612029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=86 head_norm_before_train=2.304376 cos_to_last_merge=0.9821 (last merge round=34)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9539752863107379, 'auprc': 0.975016145355923, 'loss_val': 0.30487248542712, 'psi': 0.962391629928812}-{'f1_val': 0.9472516351919278, 'auprc': 0.9860926663989019, 'loss_val': 0.2610220786955773, 'psi': 0.9627880476747175}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.844415 cos_to_last_merge=0.9428 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=86 local utility u=0.004861 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9899394049624488, 'loss_val': 0.03532794061919808, 'psi': 0.9934242715886532}-{'f1_val': 0.9957475160061228, 'auprc': 0.9891484272625866, 'loss_val': 0.04267753652373905, 'psi': 0.9931078805087084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=86 head_norm_before_train=1.848158 cos_to_last_merge=0.9653 (last merge round=40)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.8005732641409483, 'auprc': 0.9400903202598535, 'loss_val': 0.32697731647415196, 'psi': 0.8563800865885104}-{'f1_val': 0.9267577818465013, 'auprc': 0.959736936817178, 'loss_val': 0.226066899581244, 'psi': 0.939949443834772}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.738962 cos_to_last_merge=0.9791 (last merge round=41)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.4696218587186673, 'auprc': 0.7826352483264609, 'loss_val': 1.3147510264498175, 'psi': 0.5948272145617848}-{'f1_val': 0.9591520304452541, 'auprc': 0.9937097041164887, 'loss_val': 0.18787870735674575, 'psi': 0.972975099913748}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.188200 cos_to_last_merge=0.7506 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.751
[S8] round=86 local utility u=0.007338 metrics={'f1_val': 0.9904910816630761, 'auprc': 0.9990669955844194, 'loss_val': 0.03261344257516088, 'psi': 0.9939214472316135}-{'f1_val': 0.9889098366469105, 'auprc': 0.9989466881727358, 'loss_val': 0.037441605728484824, 'psi': 0.9929245772572406}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=86 head_norm_before_train=1.805936 cos_to_last_merge=0.9336 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.934
[S9] round=86 local utility u=0.003585 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9990761138069294, 'loss_val': 0.020369104690495708, 'psi': 0.9975111276277944}-{'f1_val': 0.9971317563071089, 'auprc': 0.9953428089065419, 'loss_val': 0.02032251488542319, 'psi': 0.9964161773468821}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=86 head_norm_before_train=2.355168 cos_to_last_merge=0.8045 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959108388542898, 'loss_val': 0.025280262420953506, 'psi': 0.9952242257672332}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959310056626719, 'loss_val': 0.024922799922485885, 'psi': 0.9952322924905861}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.844999 cos_to_last_merge=0.9638 (last merge round=34)
[S11] round=86 local utility u=0.000357 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969826494934364, 'loss_val': 0.02101295057073165, 'psi': 0.9964732647453601}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967705354443146, 'loss_val': 0.02109086098332692, 'psi': 0.9963884191257114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=86 head_norm_before_train=2.211824 (no previous merge yet)
[S13] round=86 local utility u=0.064409 metrics={'f1_val': 0.693612925820881, 'auprc': 0.7582554025116491, 'loss_val': 1.2691541470883803, 'psi': 0.7194699164971883}-{'f1_val': 0.6551587425852314, 'auprc': 0.7554296147572188, 'loss_val': 1.1587702441322958, 'psi': 0.6952670914540264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=86 head_norm_before_train=1.796036 cos_to_last_merge=0.9867 (last merge round=40)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9972494975898569, 'loss_val': 0.04452186719501148, 'psi': 0.9969393135353393}-{'f1_val': 0.9963222473248441, 'auprc': 0.9988286000097786, 'loss_val': 0.03161470432877308, 'psi': 0.9973247883988179}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.050206 cos_to_last_merge=0.9528 (last merge round=39)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.7030796442303148, 'auprc': 0.7578176182877826, 'loss_val': 0.7647006229107618, 'psi': 0.724974833853302}-{'f1_val': 0.9967466683875206, 'auprc': 0.9894625100915995, 'loss_val': 0.02137977456198797, 'psi': 0.9938330050691522}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.191776 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.8964121671954927, 'auprc': 0.9868701054124127, 'loss_val': 0.4579326701917402, 'psi': 0.9325953424822606}-{'f1_val': 0.9909593746439745, 'auprc': 0.9925393549131696, 'loss_val': 0.04537308843951924, 'psi': 0.9915913667516525}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.175174 cos_to_last_merge=0.9461 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8789911062852441, 'auprc': 0.9347574635468517, 'loss_val': 0.6690484528907792, 'psi': 0.9012976491898872}-{'f1_val': 0.8862522361775913, 'auprc': 0.9400885282984142, 'loss_val': 0.6371325652958747, 'psi': 0.9077867530259205}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.391045 (no previous merge yet)
[S2] round=87 local utility u=0.213239 metrics={'f1_val': 0.7067560216549679, 'auprc': 0.894593079044139, 'loss_val': 0.6469569880215549, 'psi': 0.7818908446106363}-{'f1_val': 0.6936895182403964, 'auprc': 0.8183338887208926, 'loss_val': 0.7662577729079932, 'psi': 0.7435472664325948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=87 head_norm_before_train=2.398805 (no previous merge yet)
[S3] round=87 local utility u=0.013505 metrics={'f1_val': 0.9915008831088291, 'auprc': 0.9990096718184238, 'loss_val': 0.030526582996575877, 'psi': 0.9945043985926669}-{'f1_val': 0.9885610761985486, 'auprc': 0.9989708902858384, 'loss_val': 0.03978087283444006, 'psi': 0.9927250018334646}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=87 head_norm_before_train=2.305915 cos_to_last_merge=0.9818 (last merge round=34)
[S4] round=87 local utility u=0.032257 metrics={'f1_val': 0.9491885347662932, 'auprc': 0.9861966524077388, 'loss_val': 0.2451796763141709, 'psi': 0.9639917818228714}-{'f1_val': 0.9539752863107379, 'auprc': 0.975016145355923, 'loss_val': 0.30487248542712, 'psi': 0.962391629928812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=87 head_norm_before_train=1.856220 cos_to_last_merge=0.9414 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=87 local utility u=0.010123 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9945791615967072, 'loss_val': 0.029875417799750004, 'psi': 0.9953676589098865}-{'f1_val': 0.9957475160061228, 'auprc': 0.9899394049624488, 'loss_val': 0.03532794061919808, 'psi': 0.9934242715886532}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=87 head_norm_before_train=1.854100 cos_to_last_merge=0.9648 (last merge round=40)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.7130994842788424, 'auprc': 0.7249038521342703, 'loss_val': 1.0233159133543495, 'psi': 0.7178212314210135}-{'f1_val': 0.8005732641409483, 'auprc': 0.9400903202598535, 'loss_val': 0.32697731647415196, 'psi': 0.8563800865885104}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.744543 cos_to_last_merge=0.9782 (last merge round=41)
[S7] round=87 local utility u=1.000000 metrics={'f1_val': 0.9249222741717009, 'auprc': 0.9885949909660835, 'loss_val': 0.23513941779472453, 'psi': 0.950391360889454}-{'f1_val': 0.4696218587186673, 'auprc': 0.7826352483264609, 'loss_val': 1.3147510264498175, 'psi': 0.5948272145617848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=87 head_norm_before_train=2.194980 cos_to_last_merge=0.7507 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.751
[S8] round=87 local utility u=0.011131 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9990872260663703, 'loss_val': 0.02741628559982651, 'psi': 0.9956298908048327}-{'f1_val': 0.9904910816630761, 'auprc': 0.9990669955844194, 'loss_val': 0.03261344257516088, 'psi': 0.9939214472316135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=87 head_norm_before_train=1.810637 cos_to_last_merge=0.9330 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9981243906658612, 'loss_val': 0.020088882794286073, 'psi': 0.9971304383713672}-{'f1_val': 0.9964678035083712, 'auprc': 0.9990761138069294, 'loss_val': 0.020369104690495708, 'psi': 0.9975111276277944}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.360701 cos_to_last_merge=0.8042 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=87 local utility u=0.000067 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959057262319863, 'loss_val': 0.025130994078494853, 'psi': 0.9952221807183119}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959108388542898, 'loss_val': 0.025280262420953506, 'psi': 0.9952242257672332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=87 head_norm_before_train=1.849082 cos_to_last_merge=0.9635 (last merge round=34)
[S11] round=87 local utility u=0.001767 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.997461986171817, 'loss_val': 0.020366406559614313, 'psi': 0.9968100266141773}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969826494934364, 'loss_val': 0.02101295057073165, 'psi': 0.9964732647453601}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=87 head_norm_before_train=2.223910 (no previous merge yet)
[S13] round=87 local utility u=0.022488 metrics={'f1_val': 0.7035283818685912, 'auprc': 0.7634066705372816, 'loss_val': 1.2991246489196524, 'psi': 0.7274796973360673}-{'f1_val': 0.693612925820881, 'auprc': 0.7582554025116491, 'loss_val': 1.2691541470883803, 'psi': 0.7194699164971883}
[S13] not sending this round → trigger blocked (psi=0.727)
[S14] START round=87 head_norm_before_train=1.801758 cos_to_last_merge=0.9865 (last merge round=40)
[S14] round=87 local utility u=0.009548 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9968690558410764, 'loss_val': 0.024284577080789252, 'psi': 0.9967871368358271}-{'f1_val': 0.9967325241656609, 'auprc': 0.9972494975898569, 'loss_val': 0.04452186719501148, 'psi': 0.9969393135353393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=87 head_norm_before_train=2.053906 cos_to_last_merge=0.9525 (last merge round=39)
[S15] round=87 local utility u=1.000000 metrics={'f1_val': 0.9524241039420489, 'auprc': 0.9916717614711419, 'loss_val': 0.07830207880374603, 'psi': 0.968123166953686}-{'f1_val': 0.7030796442303148, 'auprc': 0.7578176182877826, 'loss_val': 0.7647006229107618, 'psi': 0.724974833853302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=87 head_norm_before_train=2.196139 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.8487439157235206, 'auprc': 0.8958868984028915, 'loss_val': 1.1216420293084157, 'psi': 0.8676011087952689}-{'f1_val': 0.8964121671954927, 'auprc': 0.9868701054124127, 'loss_val': 0.4579326701917402, 'psi': 0.9325953424822606}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.180588 cos_to_last_merge=0.9456 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8787734343136379, 'auprc': 0.9310992221074095, 'loss_val': 0.6745625176904895, 'psi': 0.8997037494311464}-{'f1_val': 0.8789911062852441, 'auprc': 0.9347574635468517, 'loss_val': 0.6690484528907792, 'psi': 0.9012976491898872}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.396888 (no previous merge yet)
[S2] round=88 local utility u=0.114256 metrics={'f1_val': 0.7067600988321601, 'auprc': 0.9592540261677082, 'loss_val': 0.6124515252887217, 'psi': 0.8077576697663793}-{'f1_val': 0.7067560216549679, 'auprc': 0.894593079044139, 'loss_val': 0.6469569880215549, 'psi': 0.7818908446106363}
[S2] not sending this round → trigger blocked (psi=0.808)
[S3] START round=88 head_norm_before_train=2.403409 (no previous merge yet)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9830974519409375, 'auprc': 0.959996786831462, 'loss_val': 0.1020778314052874, 'psi': 0.9738571858971472}-{'f1_val': 0.9915008831088291, 'auprc': 0.9990096718184238, 'loss_val': 0.030526582996575877, 'psi': 0.9945043985926669}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.307506 cos_to_last_merge=0.9817 (last merge round=34)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9424848870038446, 'auprc': 0.9774962795125233, 'loss_val': 0.27637548893606584, 'psi': 0.9564894440073161}-{'f1_val': 0.9491885347662932, 'auprc': 0.9861966524077388, 'loss_val': 0.2451796763141709, 'psi': 0.9639917818228714}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.862120 cos_to_last_merge=0.9401 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9921171045299205, 'loss_val': 0.03312745866561819, 'psi': 0.9942953514156418}-{'f1_val': 0.9958933237853395, 'auprc': 0.9945791615967072, 'loss_val': 0.029875417799750004, 'psi': 0.9953676589098865}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.863775 cos_to_last_merge=0.9642 (last merge round=40)
[S6] round=88 local utility u=0.484255 metrics={'f1_val': 0.7487654044477251, 'auprc': 0.903809098523972, 'loss_val': 0.8055171105258733, 'psi': 0.8107828820782239}-{'f1_val': 0.7130994842788424, 'auprc': 0.7249038521342703, 'loss_val': 1.0233159133543495, 'psi': 0.7178212314210135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=88 head_norm_before_train=1.749730 cos_to_last_merge=0.9775 (last merge round=41)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5340038308773412, 'auprc': 0.786513633525224, 'loss_val': 1.1772600377509561, 'psi': 0.6350077519364943}-{'f1_val': 0.9249222741717009, 'auprc': 0.9885949909660835, 'loss_val': 0.23513941779472453, 'psi': 0.950391360889454}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.199368 cos_to_last_merge=0.7497 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9874771136061262, 'auprc': 0.999084688798916, 'loss_val': 0.038673997619554645, 'psi': 0.9921201436832421}-{'f1_val': 0.9933250006304741, 'auprc': 0.9990872260663703, 'loss_val': 0.02741628559982651, 'psi': 0.9956298908048327}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=1.815421 cos_to_last_merge=0.9325 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9955625229369005, 'loss_val': 0.02001222096278735, 'psi': 0.9965040629590256}-{'f1_val': 0.9964678035083712, 'auprc': 0.9981243906658612, 'loss_val': 0.020088882794286073, 'psi': 0.9971304383713672}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.364794 cos_to_last_merge=0.8038 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9955302527036249, 'loss_val': 0.025518887611315808, 'psi': 0.9950719913069673}-{'f1_val': 0.9947664837091956, 'auprc': 0.9959057262319863, 'loss_val': 0.025130994078494853, 'psi': 0.9952221807183119}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.852750 cos_to_last_merge=0.9632 (last merge round=34)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972362796064215, 'loss_val': 0.02081108881346706, 'psi': 0.9965747167905542}-{'f1_val': 0.9963753869090841, 'auprc': 0.997461986171817, 'loss_val': 0.020366406559614313, 'psi': 0.9968100266141773}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=2.238653 (no previous merge yet)
[S13] round=88 local utility u=0.303048 metrics={'f1_val': 0.7403038552184447, 'auprc': 0.8534400108765772, 'loss_val': 1.183781384868887, 'psi': 0.7855583174816976}-{'f1_val': 0.7035283818685912, 'auprc': 0.7634066705372816, 'loss_val': 1.2991246489196524, 'psi': 0.7274796973360673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=88 head_norm_before_train=1.807028 cos_to_last_merge=0.9863 (last merge round=40)
[S14] round=88 local utility u=0.000319 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.996446705837359, 'loss_val': 0.024844841895536193, 'psi': 0.9968646537728232}-{'f1_val': 0.9967325241656609, 'auprc': 0.9968690558410764, 'loss_val': 0.024284577080789252, 'psi': 0.9967871368358271}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=88 head_norm_before_train=2.058029 cos_to_last_merge=0.9522 (last merge round=39)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.7670884244126484, 'auprc': 0.9109596607170438, 'loss_val': 0.5641224795415964, 'psi': 0.8246369189344065}-{'f1_val': 0.9524241039420489, 'auprc': 0.9916717614711419, 'loss_val': 0.07830207880374603, 'psi': 0.968123166953686}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=2.201487 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=88 local utility u=1.000000 metrics={'f1_val': 0.9922529868635119, 'auprc': 0.9905924343272807, 'loss_val': 0.03991336377504715, 'psi': 0.9915887658490194}-{'f1_val': 0.8487439157235206, 'auprc': 0.8958868984028915, 'loss_val': 1.1216420293084157, 'psi': 0.8676011087952689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=88 head_norm_before_train=2.185032 cos_to_last_merge=0.9453 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=88 local utility u=0.051696 metrics={'f1_val': 0.8851551647550271, 'auprc': 0.9445450407634302, 'loss_val': 0.6497991478918913, 'psi': 0.9089111151583884}-{'f1_val': 0.8787734343136379, 'auprc': 0.9310992221074095, 'loss_val': 0.6745625176904895, 'psi': 0.8997037494311464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=89 head_norm_before_train=2.397553 (no previous merge yet)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7055507736109456, 'auprc': 0.9426341788624832, 'loss_val': 0.5872402406707423, 'psi': 0.8003841357115606}-{'f1_val': 0.7067600988321601, 'auprc': 0.9592540261677082, 'loss_val': 0.6124515252887217, 'psi': 0.8077576697663793}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.406894 (no previous merge yet)
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9590461502243516, 'auprc': 0.99924769624263, 'loss_val': 0.16605947076833552, 'psi': 0.9751267686316629}-{'f1_val': 0.9830974519409375, 'auprc': 0.959996786831462, 'loss_val': 0.1020778314052874, 'psi': 0.9738571858971472}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=2.311663 cos_to_last_merge=0.9816 (last merge round=34)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9513892728517955, 'auprc': 0.9692593586406073, 'loss_val': 0.32177345891188613, 'psi': 0.9585373071673202}-{'f1_val': 0.9424848870038446, 'auprc': 0.9774962795125233, 'loss_val': 0.27637548893606584, 'psi': 0.9564894440073161}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.870203 cos_to_last_merge=0.9392 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=89 local utility u=0.005875 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9946295627348116, 'loss_val': 0.028914041134465808, 'psi': 0.9953003346975984}-{'f1_val': 0.9957475160061228, 'auprc': 0.9921171045299205, 'loss_val': 0.03312745866561819, 'psi': 0.9942953514156418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=89 head_norm_before_train=1.870357 cos_to_last_merge=0.9638 (last merge round=40)
[S6] round=89 local utility u=0.205044 metrics={'f1_val': 0.7816389067993583, 'auprc': 0.9153806860407615, 'loss_val': 0.6273840259572344, 'psi': 0.8351356184959196}-{'f1_val': 0.7487654044477251, 'auprc': 0.903809098523972, 'loss_val': 0.8055171105258733, 'psi': 0.8107828820782239}
[S6] not sending this round → trigger blocked (psi=0.835)
[S7] START round=89 head_norm_before_train=1.754704 cos_to_last_merge=0.9768 (last merge round=41)
[S7] round=89 local utility u=0.757107 metrics={'f1_val': 0.6379014873053963, 'auprc': 0.8492367800310721, 'loss_val': 0.4746009067906096, 'psi': 0.7224356043956666}-{'f1_val': 0.5340038308773412, 'auprc': 0.786513633525224, 'loss_val': 1.1772600377509561, 'psi': 0.6350077519364943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=89 head_norm_before_train=2.204979 cos_to_last_merge=0.7496 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9045237189534302, 'auprc': 0.9955264848356746, 'loss_val': 0.21001537883157534, 'psi': 0.940924825306328}-{'f1_val': 0.9874771136061262, 'auprc': 0.999084688798916, 'loss_val': 0.038673997619554645, 'psi': 0.9921201436832421}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=1.819251 cos_to_last_merge=0.9320 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=89 local utility u=0.003305 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9991082099538096, 'loss_val': 0.02005565033163018, 'psi': 0.9975239660865465}-{'f1_val': 0.9971317563071089, 'auprc': 0.9955625229369005, 'loss_val': 0.02001222096278735, 'psi': 0.9965040629590256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=89 head_norm_before_train=2.368904 cos_to_last_merge=0.8035 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=89 local utility u=0.000669 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.995899677225522, 'loss_val': 0.02529001494509762, 'psi': 0.9952197611157261}-{'f1_val': 0.9947664837091956, 'auprc': 0.9955302527036249, 'loss_val': 0.025518887611315808, 'psi': 0.9950719913069673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=89 head_norm_before_train=1.857107 cos_to_last_merge=0.9628 (last merge round=34)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968130930985162, 'loss_val': 0.020503424434662118, 'psi': 0.996405442187392}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972362796064215, 'loss_val': 0.02081108881346706, 'psi': 0.9965747167905542}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.241503 (no previous merge yet)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6593960340877175, 'auprc': 0.7382233689632072, 'loss_val': 1.3943066459414317, 'psi': 0.6909269680379133}-{'f1_val': 0.7403038552184447, 'auprc': 0.8534400108765772, 'loss_val': 1.183781384868887, 'psi': 0.7855583174816976}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=1.811270 cos_to_last_merge=0.9860 (last merge round=40)
[S14] round=89 local utility u=0.001182 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9985338495394611, 'loss_val': 0.023816936922402405, 'psi': 0.9972068882106908}-{'f1_val': 0.9971432857297993, 'auprc': 0.996446705837359, 'loss_val': 0.024844841895536193, 'psi': 0.9968646537728232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=89 head_norm_before_train=2.064192 cos_to_last_merge=0.9518 (last merge round=39)
[S15] round=89 local utility u=0.755534 metrics={'f1_val': 0.9172183402996413, 'auprc': 0.9936483091103413, 'loss_val': 0.20189988862822295, 'psi': 0.9477903278239213}-{'f1_val': 0.7670884244126484, 'auprc': 0.9109596607170438, 'loss_val': 0.5641224795415964, 'psi': 0.8246369189344065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=89 head_norm_before_train=2.205117 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9908072753417092, 'auprc': 0.9926455550688323, 'loss_val': 0.053684658295901314, 'psi': 0.9915425872325584}-{'f1_val': 0.9922529868635119, 'auprc': 0.9905924343272807, 'loss_val': 0.03991336377504715, 'psi': 0.9915887658490194}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.193306 cos_to_last_merge=0.9449 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.8579786661552391, 'auprc': 0.9585069952632437, 'loss_val': 0.6969362332583019, 'psi': 0.8981899977984409}-{'f1_val': 0.8851551647550271, 'auprc': 0.9445450407634302, 'loss_val': 0.6497991478918913, 'psi': 0.9089111151583884}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.395284 (no previous merge yet)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7053661338830043, 'auprc': 0.8603735660865283, 'loss_val': 0.6222479175204433, 'psi': 0.7673691067644139}-{'f1_val': 0.7055507736109456, 'auprc': 0.9426341788624832, 'loss_val': 0.5872402406707423, 'psi': 0.8003841357115606}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.410855 (no previous merge yet)
[S3] round=90 local utility u=0.029883 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9994064528757888, 'loss_val': 0.11894254411659087, 'psi': 0.9764076323899877}-{'f1_val': 0.9590461502243516, 'auprc': 0.99924769624263, 'loss_val': 0.16605947076833552, 'psi': 0.9751267686316629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=90 head_norm_before_train=2.313340 cos_to_last_merge=0.9810 (last merge round=34)
[S4] round=90 local utility u=0.026868 metrics={'f1_val': 0.9435239348044528, 'auprc': 0.9756128790342465, 'loss_val': 0.23990601603648726, 'psi': 0.9563595124963703}-{'f1_val': 0.9513892728517955, 'auprc': 0.9692593586406073, 'loss_val': 0.32177345891188613, 'psi': 0.9585373071673202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=90 head_norm_before_train=1.878761 cos_to_last_merge=0.9384 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=90 local utility u=0.004082 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9966834271218306, 'loss_val': 0.027787064997985528, 'psi': 0.9962093651199359}-{'f1_val': 0.9957475160061228, 'auprc': 0.9946295627348116, 'loss_val': 0.028914041134465808, 'psi': 0.9953003346975984}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=90 head_norm_before_train=1.878770 cos_to_last_merge=0.9635 (last merge round=40)
[S6] round=90 local utility u=0.225374 metrics={'f1_val': 0.8088416164960857, 'auprc': 0.9480208869278021, 'loss_val': 0.437773511649328, 'psi': 0.8645133246687722}-{'f1_val': 0.7816389067993583, 'auprc': 0.9153806860407615, 'loss_val': 0.6273840259572344, 'psi': 0.8351356184959196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=90 head_norm_before_train=1.758313 cos_to_last_merge=0.9763 (last merge round=41)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5488927129620627, 'auprc': 0.7948169746653673, 'loss_val': 0.9917051287814102, 'psi': 0.6472624176433845}-{'f1_val': 0.6379014873053963, 'auprc': 0.8492367800310721, 'loss_val': 0.4746009067906096, 'psi': 0.7224356043956666}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.211555 cos_to_last_merge=0.7493 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.749
[S8] round=90 local utility u=0.367841 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9995956486567911, 'loss_val': 0.025948607350252065, 'psi': 0.9964931952526861}-{'f1_val': 0.9045237189534302, 'auprc': 0.9955264848356746, 'loss_val': 0.21001537883157534, 'psi': 0.940924825306328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=90 head_norm_before_train=1.822984 cos_to_last_merge=0.9316 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9956348431256092, 'auprc': 0.9991145703017781, 'loss_val': 0.020955154907951627, 'psi': 0.9970267339960768}-{'f1_val': 0.9964678035083712, 'auprc': 0.9991082099538096, 'loss_val': 0.02005565033163018, 'psi': 0.9975239660865465}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.375810 cos_to_last_merge=0.8032 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=90 local utility u=0.000062 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9958529163920513, 'loss_val': 0.02502509757557831, 'psi': 0.995201056782338}-{'f1_val': 0.9947664837091956, 'auprc': 0.995899677225522, 'loss_val': 0.02529001494509762, 'psi': 0.9952197611157261}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=90 head_norm_before_train=1.861438 cos_to_last_merge=0.9626 (last merge round=34)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9970126884894446, 'loss_val': 0.045458346848465656, 'psi': 0.9967356283928361}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968130930985162, 'loss_val': 0.020503424434662118, 'psi': 0.996405442187392}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=2.251676 (no previous merge yet)
[S13] round=90 local utility u=0.536583 metrics={'f1_val': 0.7158725506407484, 'auprc': 0.9293328108581568, 'loss_val': 1.2333289497675097, 'psi': 0.8012566547277118}-{'f1_val': 0.6593960340877175, 'auprc': 0.7382233689632072, 'loss_val': 1.3943066459414317, 'psi': 0.6909269680379133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=90 head_norm_before_train=1.815642 cos_to_last_merge=0.9858 (last merge round=40)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9959124528917772, 'auprc': 0.9985336316132765, 'loss_val': 0.025005175307096544, 'psi': 0.9969609243803769}-{'f1_val': 0.9963222473248441, 'auprc': 0.9985338495394611, 'loss_val': 0.023816936922402405, 'psi': 0.9972068882106908}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.070293 cos_to_last_merge=0.9514 (last merge round=39)
[S15] round=90 local utility u=0.332244 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9962941312614363, 'loss_val': 0.022520171597725666, 'psi': 0.9965656535370868}-{'f1_val': 0.9172183402996413, 'auprc': 0.9936483091103413, 'loss_val': 0.20189988862822295, 'psi': 0.9477903278239213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=90 head_norm_before_train=2.210000 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=90 local utility u=0.008874 metrics={'f1_val': 0.9921093080809944, 'auprc': 0.9917933227047653, 'loss_val': 0.04119201664229269, 'psi': 0.9919829139305028}-{'f1_val': 0.9908072753417092, 'auprc': 0.9926455550688323, 'loss_val': 0.053684658295901314, 'psi': 0.9915425872325584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=90 head_norm_before_train=2.202962 cos_to_last_merge=0.9445 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8422194827875191, 'auprc': 0.9671130645216943, 'loss_val': 0.8015295559283606, 'psi': 0.8921769154811892}-{'f1_val': 0.8579786661552391, 'auprc': 0.9585069952632437, 'loss_val': 0.6969362332583019, 'psi': 0.8981899977984409}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.400887 (no previous merge yet)
[S2] round=91 local utility u=0.092911 metrics={'f1_val': 0.7071656371042251, 'auprc': 0.914680686452984, 'loss_val': 0.6101443087590575, 'psi': 0.7901716568437287}-{'f1_val': 0.7053661338830043, 'auprc': 0.8603735660865283, 'loss_val': 0.6222479175204433, 'psi': 0.7673691067644139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=91 head_norm_before_train=2.415455 (no previous merge yet)
[S3] round=91 local utility u=0.153572 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.999396332258599, 'loss_val': 0.029881022962727637, 'psi': 0.9982148104753742}-{'f1_val': 0.9610750853994537, 'auprc': 0.9994064528757888, 'loss_val': 0.11894254411659087, 'psi': 0.9764076323899877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] sending update (kind=head size=1789 to 1 peers)
[S4] START round=91 head_norm_before_train=2.318067 cos_to_last_merge=0.9808 (last merge round=34)
[S4] round=91 local utility u=0.009609 metrics={'f1_val': 0.9532118655279456, 'auprc': 0.9791336785352815, 'loss_val': 0.2893781103965076, 'psi': 0.96358059073088}-{'f1_val': 0.9435239348044528, 'auprc': 0.9756128790342465, 'loss_val': 0.23990601603648726, 'psi': 0.9563595124963703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=91 head_norm_before_train=1.886532 cos_to_last_merge=0.9374 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9955474794871383, 'loss_val': 0.033568783898438696, 'psi': 0.995754986066059}-{'f1_val': 0.9958933237853395, 'auprc': 0.9966834271218306, 'loss_val': 0.027787064997985528, 'psi': 0.9962093651199359}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=1.885377 cos_to_last_merge=0.9631 (last merge round=40)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.7964428211770617, 'auprc': 0.9393412390424304, 'loss_val': 0.396063286699664, 'psi': 0.8536021883232092}-{'f1_val': 0.8088416164960857, 'auprc': 0.9480208869278021, 'loss_val': 0.437773511649328, 'psi': 0.8645133246687722}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.761502 cos_to_last_merge=0.9758 (last merge round=41)
[S7] round=91 local utility u=1.000000 metrics={'f1_val': 0.858203615000813, 'auprc': 0.9545512974749356, 'loss_val': 0.3302318057818664, 'psi': 0.8967426879904621}-{'f1_val': 0.5488927129620627, 'auprc': 0.7948169746653673, 'loss_val': 0.9917051287814102, 'psi': 0.6472624176433845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=91 head_norm_before_train=2.214576 cos_to_last_merge=0.7485 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=91 local utility u=0.003535 metrics={'f1_val': 0.995381897925576, 'auprc': 0.9992971285727758, 'loss_val': 0.02372497019465929, 'psi': 0.9969479901844559}-{'f1_val': 0.9944248929832828, 'auprc': 0.9995956486567911, 'loss_val': 0.025948607350252065, 'psi': 0.9964931952526861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=91 head_norm_before_train=1.826467 cos_to_last_merge=0.9312 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9955136440705818, 'loss_val': 0.020165722586585322, 'psi': 0.9962382587969557}-{'f1_val': 0.9956348431256092, 'auprc': 0.9991145703017781, 'loss_val': 0.020955154907951627, 'psi': 0.9970267339960768}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.378190 cos_to_last_merge=0.8029 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9954157165782208, 'loss_val': 0.025617230194788378, 'psi': 0.9950261768568056}-{'f1_val': 0.9947664837091956, 'auprc': 0.9958529163920513, 'loss_val': 0.02502509757557831, 'psi': 0.995201056782338}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=1.866060 cos_to_last_merge=0.9623 (last merge round=34)
[S11] round=91 local utility u=0.010772 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964411655108538, 'loss_val': 0.019696432075199104, 'psi': 0.9962566711523271}-{'f1_val': 0.9965509216617638, 'auprc': 0.9970126884894446, 'loss_val': 0.045458346848465656, 'psi': 0.9967356283928361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=91 head_norm_before_train=2.258353 (no previous merge yet)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6515010706061146, 'auprc': 0.7803808094188187, 'loss_val': 1.3635901447373011, 'psi': 0.7030529661311963}-{'f1_val': 0.7158725506407484, 'auprc': 0.9293328108581568, 'loss_val': 1.2333289497675097, 'psi': 0.8012566547277118}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.818664 cos_to_last_merge=0.9854 (last merge round=40)
[S14] round=91 local utility u=0.000521 metrics={'f1_val': 0.9959124528917772, 'auprc': 0.9985590202019906, 'loss_val': 0.02403850401456744, 'psi': 0.9969710798158625}-{'f1_val': 0.9959124528917772, 'auprc': 0.9985336316132765, 'loss_val': 0.025005175307096544, 'psi': 0.9969609243803769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=91 head_norm_before_train=2.076301 cos_to_last_merge=0.9509 (last merge round=39)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.7925071336300271, 'auprc': 0.877748086175322, 'loss_val': 0.5625818312490729, 'psi': 0.8266035146481451}-{'f1_val': 0.9967466683875206, 'auprc': 0.9962941312614363, 'loss_val': 0.022520171597725666, 'psi': 0.9965656535370868}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.216012 cos_to_last_merge=0.9950 (last merge round=41)
[S16] round=91 local utility u=0.004695 metrics={'f1_val': 0.9923082627868098, 'auprc': 0.9931503824405361, 'loss_val': 0.0370661778161924, 'psi': 0.9926451106483003}-{'f1_val': 0.9921093080809944, 'auprc': 0.9917933227047653, 'loss_val': 0.04119201664229269, 'psi': 0.9919829139305028}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=91 head_norm_before_train=2.211487 cos_to_last_merge=0.9441 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.8102243130447742, 'auprc': 0.8864609486624345, 'loss_val': 1.0308729278784805, 'psi': 0.8407189672918383}-{'f1_val': 0.8422194827875191, 'auprc': 0.9671130645216943, 'loss_val': 0.8015295559283606, 'psi': 0.8921769154811892}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.408281 (no previous merge yet)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.7011717585013144, 'auprc': 0.8397910079512846, 'loss_val': 0.6490771043073447, 'psi': 0.7566194582813025}-{'f1_val': 0.7071656371042251, 'auprc': 0.914680686452984, 'loss_val': 0.6101443087590575, 'psi': 0.7901716568437287}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.419618 (no previous merge yet)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9925197588014063, 'auprc': 0.9981229064330173, 'loss_val': 0.07721054064745636, 'psi': 0.9947610178540507}-{'f1_val': 0.9974271292865575, 'auprc': 0.999396332258599, 'loss_val': 0.029881022962727637, 'psi': 0.9982148104753742}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.322737 cos_to_last_merge=0.9804 (last merge round=34)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9529980061548852, 'auprc': 0.9652709082497506, 'loss_val': 0.3160049447265925, 'psi': 0.9579071669928314}-{'f1_val': 0.9532118655279456, 'auprc': 0.9791336785352815, 'loss_val': 0.2893781103965076, 'psi': 0.96358059073088}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.893946 cos_to_last_merge=0.9366 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=92 local utility u=0.003199 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9961590382387928, 'loss_val': 0.028131483671158832, 'psi': 0.9959121248991909}-{'f1_val': 0.9958933237853395, 'auprc': 0.9955474794871383, 'loss_val': 0.033568783898438696, 'psi': 0.995754986066059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=92 head_norm_before_train=1.895433 cos_to_last_merge=0.9627 (last merge round=40)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7646638053240554, 'auprc': 0.9078217382247102, 'loss_val': 0.7369998578479892, 'psi': 0.8219269784843173}-{'f1_val': 0.7964428211770617, 'auprc': 0.9393412390424304, 'loss_val': 0.396063286699664, 'psi': 0.8536021883232092}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.765226 cos_to_last_merge=0.9751 (last merge round=41)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.5656142773802445, 'auprc': 0.8682499168824288, 'loss_val': 0.7960690770390583, 'psi': 0.6866685331811182}-{'f1_val': 0.858203615000813, 'auprc': 0.9545512974749356, 'loss_val': 0.3302318057818664, 'psi': 0.8967426879904621}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.220363 cos_to_last_merge=0.7478 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.8507249964165284, 'auprc': 0.9931686236660651, 'loss_val': 0.3424430043891046, 'psi': 0.9077024473163431}-{'f1_val': 0.995381897925576, 'auprc': 0.9992971285727758, 'loss_val': 0.02372497019465929, 'psi': 0.9969479901844559}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=1.830667 cos_to_last_merge=0.9307 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=92 local utility u=0.004742 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9974874069593869, 'loss_val': 0.019065216100477744, 'psi': 0.9972740165680202}-{'f1_val': 0.996721335281205, 'auprc': 0.9955136440705818, 'loss_val': 0.020165722586585322, 'psi': 0.9962382587969557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=92 head_norm_before_train=2.383723 cos_to_last_merge=0.8026 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=92 local utility u=0.000940 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9958593403459911, 'loss_val': 0.025068086759326303, 'psi': 0.9952036263639138}-{'f1_val': 0.9947664837091956, 'auprc': 0.9954157165782208, 'loss_val': 0.025617230194788378, 'psi': 0.9950261768568056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=92 head_norm_before_train=1.871309 cos_to_last_merge=0.9620 (last merge round=34)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9915802832682629, 'auprc': 0.997438404047491, 'loss_val': 0.03207225362945161, 'psi': 0.9939235315799541}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964411655108538, 'loss_val': 0.019696432075199104, 'psi': 0.9962566711523271}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.262484 (no previous merge yet)
[S13] round=92 local utility u=0.578843 metrics={'f1_val': 0.7353220458731151, 'auprc': 0.9349818680573375, 'loss_val': 1.1726332437527456, 'psi': 0.8151859747468041}-{'f1_val': 0.6515010706061146, 'auprc': 0.7803808094188187, 'loss_val': 1.3635901447373011, 'psi': 0.7030529661311963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=92 head_norm_before_train=1.821808 cos_to_last_merge=0.9851 (last merge round=40)
[S14] round=92 local utility u=0.000284 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9970993656602383, 'loss_val': 0.02300726885279599, 'psi': 0.9967788802098713}-{'f1_val': 0.9959124528917772, 'auprc': 0.9985590202019906, 'loss_val': 0.02403850401456744, 'psi': 0.9969710798158625}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=92 head_norm_before_train=2.082047 cos_to_last_merge=0.9505 (last merge round=39)
[S15] round=92 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9932502340901295, 'loss_val': 0.02159263960053045, 'psi': 0.9953480946685641}-{'f1_val': 0.7925071336300271, 'auprc': 0.877748086175322, 'loss_val': 0.5625818312490729, 'psi': 0.8266035146481451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=92 head_norm_before_train=2.222322 cos_to_last_merge=0.9951 (last merge round=41)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.947849507319937, 'auprc': 0.98547486034019, 'loss_val': 0.24377751214991222, 'psi': 0.9628996485280383}-{'f1_val': 0.9923082627868098, 'auprc': 0.9931503824405361, 'loss_val': 0.0370661778161924, 'psi': 0.9926451106483003}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.214169 cos_to_last_merge=0.9439 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=92 local utility u=0.009638 metrics={'f1_val': 0.8252603249055706, 'auprc': 0.805359454178773, 'loss_val': 0.8585080006592909, 'psi': 0.8172999766148514}-{'f1_val': 0.8102243130447742, 'auprc': 0.8864609486624345, 'loss_val': 1.0308729278784805, 'psi': 0.8407189672918383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=93 head_norm_before_train=2.414431 (no previous merge yet)
[S2] round=93 local utility u=0.091709 metrics={'f1_val': 0.705429217601064, 'auprc': 0.889533850012529, 'loss_val': 0.6404330631510495, 'psi': 0.7790710705656501}-{'f1_val': 0.7011717585013144, 'auprc': 0.8397910079512846, 'loss_val': 0.6490771043073447, 'psi': 0.7566194582813025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=93 head_norm_before_train=2.423362 (no previous merge yet)
[S3] round=93 local utility u=0.036579 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9993889301945375, 'loss_val': 0.037295164581669794, 'psi': 0.9982118496497495}-{'f1_val': 0.9925197588014063, 'auprc': 0.9981229064330173, 'loss_val': 0.07721054064745636, 'psi': 0.9947610178540507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=93 head_norm_before_train=2.328166 cos_to_last_merge=0.9803 (last merge round=34)
[S4] round=93 local utility u=0.037700 metrics={'f1_val': 0.950313120356544, 'auprc': 0.9793053043954418, 'loss_val': 0.2665990643066469, 'psi': 0.9619099939721032}-{'f1_val': 0.9529980061548852, 'auprc': 0.9652709082497506, 'loss_val': 0.3160049447265925, 'psi': 0.9579071669928314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=93 head_norm_before_train=1.902234 cos_to_last_merge=0.9358 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=93 local utility u=0.004093 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9978378287715827, 'loss_val': 0.02585635107660911, 'psi': 0.9966711257798367}-{'f1_val': 0.9957475160061228, 'auprc': 0.9961590382387928, 'loss_val': 0.028131483671158832, 'psi': 0.9959121248991909}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=93 head_norm_before_train=1.902674 cos_to_last_merge=0.9624 (last merge round=40)
[S6] round=93 local utility u=0.314250 metrics={'f1_val': 0.805816847966631, 'auprc': 0.9438551478261946, 'loss_val': 0.463517815871039, 'psi': 0.8610321679104564}-{'f1_val': 0.7646638053240554, 'auprc': 0.9078217382247102, 'loss_val': 0.7369998578479892, 'psi': 0.8219269784843173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=93 head_norm_before_train=1.770364 cos_to_last_merge=0.9742 (last merge round=41)
[S7] round=93 local utility u=1.000000 metrics={'f1_val': 0.8334304464808862, 'auprc': 0.9534920348991124, 'loss_val': 0.5024713705905124, 'psi': 0.8814550818481767}-{'f1_val': 0.5656142773802445, 'auprc': 0.8682499168824288, 'loss_val': 0.7960690770390583, 'psi': 0.6866685331811182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=93 head_norm_before_train=2.226718 cos_to_last_merge=0.7477 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=93 local utility u=0.520799 metrics={'f1_val': 0.9752362448303465, 'auprc': 0.9964834260374882, 'loss_val': 0.05785747319530479, 'psi': 0.9837351173132032}-{'f1_val': 0.8507249964165284, 'auprc': 0.9931686236660651, 'loss_val': 0.3424430043891046, 'psi': 0.9077024473163431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=93 head_norm_before_train=1.835828 cos_to_last_merge=0.9302 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=93 local utility u=0.001143 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9990771807168563, 'loss_val': 0.018893531049515924, 'psi': 0.9976443612654456}-{'f1_val': 0.9971317563071089, 'auprc': 0.9974874069593869, 'loss_val': 0.019065216100477744, 'psi': 0.9972740165680202}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=93 head_norm_before_train=2.385406 cos_to_last_merge=0.8022 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9954091530358149, 'loss_val': 0.025686986188883855, 'psi': 0.9950235514398433}-{'f1_val': 0.9947664837091956, 'auprc': 0.9958593403459911, 'loss_val': 0.025068086759326303, 'psi': 0.9952036263639138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.875411 cos_to_last_merge=0.9617 (last merge round=34)
[S11] round=93 local utility u=0.016962 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9965937119295876, 'loss_val': 0.021483647776620936, 'psi': 0.9961725874929834}-{'f1_val': 0.9915802832682629, 'auprc': 0.997438404047491, 'loss_val': 0.03207225362945161, 'psi': 0.9939235315799541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=93 head_norm_before_train=2.267779 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6428980265133771, 'auprc': 0.7573212943491755, 'loss_val': 1.47321385439487, 'psi': 0.6886673336476965}-{'f1_val': 0.7353220458731151, 'auprc': 0.9349818680573375, 'loss_val': 1.1726332437527456, 'psi': 0.8151859747468041}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.825534 cos_to_last_merge=0.9848 (last merge round=40)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9834234310399234, 'auprc': 0.9966090605621134, 'loss_val': 0.048495633909536574, 'psi': 0.9886976828487994}-{'f1_val': 0.9965652232429598, 'auprc': 0.9970993656602383, 'loss_val': 0.02300726885279599, 'psi': 0.9967788802098713}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.087431 cos_to_last_merge=0.9502 (last merge round=39)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9815036917622131, 'auprc': 0.9969600860192323, 'loss_val': 0.0407380856249972, 'psi': 0.9876862494650208}-{'f1_val': 0.9967466683875206, 'auprc': 0.9932502340901295, 'loss_val': 0.02159263960053045, 'psi': 0.9953480946685641}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.228184 cos_to_last_merge=0.9951 (last merge round=41)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.8610086412066673, 'auprc': 0.8258502829399701, 'loss_val': 1.1778339267308986, 'psi': 0.8469452978999885}-{'f1_val': 0.947849507319937, 'auprc': 0.98547486034019, 'loss_val': 0.24377751214991222, 'psi': 0.9628996485280383}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.216756 cos_to_last_merge=0.9435 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8060522732224298, 'auprc': 0.7915475701507082, 'loss_val': 0.9294081590398012, 'psi': 0.8002503919937412}-{'f1_val': 0.8252603249055706, 'auprc': 0.805359454178773, 'loss_val': 0.8585080006592909, 'psi': 0.8172999766148514}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.420945 (no previous merge yet)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.705600307211419, 'auprc': 0.8790078905082767, 'loss_val': 0.6256684934178075, 'psi': 0.774963340530162}-{'f1_val': 0.705429217601064, 'auprc': 0.889533850012529, 'loss_val': 0.6404330631510495, 'psi': 0.7790710705656501}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.427035 (no previous merge yet)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.9578234843698292, 'auprc': 0.999673574065746, 'loss_val': 0.19427082075955518, 'psi': 0.9745635202481959}-{'f1_val': 0.9974271292865575, 'auprc': 0.9993889301945375, 'loss_val': 0.037295164581669794, 'psi': 0.9982118496497495}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=2.335126 cos_to_last_merge=0.9801 (last merge round=34)
[S4] round=94 local utility u=0.021490 metrics={'f1_val': 0.9504326461822314, 'auprc': 0.9849734699640472, 'loss_val': 0.2413399066846382, 'psi': 0.9642489756949577}-{'f1_val': 0.950313120356544, 'auprc': 0.9793053043954418, 'loss_val': 0.2665990643066469, 'psi': 0.9619099939721032}
[S4] not sending this round → trigger blocked (psi=0.964)
[S5] START round=94 head_norm_before_train=1.909564 cos_to_last_merge=0.9349 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.994131317739534, 'loss_val': 0.02770649121959486, 'psi': 0.9951010366994872}-{'f1_val': 0.9958933237853395, 'auprc': 0.9978378287715827, 'loss_val': 0.02585635107660911, 'psi': 0.9966711257798367}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=1.911198 cos_to_last_merge=0.9620 (last merge round=40)
[S6] round=94 local utility u=0.190162 metrics={'f1_val': 0.825475532306251, 'auprc': 0.9596882270666398, 'loss_val': 0.2486451821655164, 'psi': 0.8791606102104066}-{'f1_val': 0.805816847966631, 'auprc': 0.9438551478261946, 'loss_val': 0.463517815871039, 'psi': 0.8610321679104564}
[S6] not sending this round → trigger blocked (psi=0.879)
[S7] START round=94 head_norm_before_train=1.777615 cos_to_last_merge=0.9731 (last merge round=41)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5360629397119038, 'auprc': 0.7962377715117734, 'loss_val': 1.1883473645677476, 'psi': 0.6401328724318517}-{'f1_val': 0.8334304464808862, 'auprc': 0.9534920348991124, 'loss_val': 0.5024713705905124, 'psi': 0.8814550818481767}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.228678 cos_to_last_merge=0.7482 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=94 local utility u=0.003827 metrics={'f1_val': 0.9747804469165087, 'auprc': 0.9991306764159537, 'loss_val': 0.05541044190549073, 'psi': 0.9845205387162868}-{'f1_val': 0.9752362448303465, 'auprc': 0.9964834260374882, 'loss_val': 0.05785747319530479, 'psi': 0.9837351173132032}
[S8] not sending this round → trigger blocked (psi=0.985)
[S9] START round=94 head_norm_before_train=1.841408 cos_to_last_merge=0.9297 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=94 local utility u=0.001153 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.999089011194092, 'loss_val': 0.019088844851471283, 'psi': 0.9978956342011748}-{'f1_val': 0.9966891482978385, 'auprc': 0.9990771807168563, 'loss_val': 0.018893531049515924, 'psi': 0.9976443612654456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=94 head_norm_before_train=2.391832 cos_to_last_merge=0.8020 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=94 local utility u=0.000857 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9958355832026962, 'loss_val': 0.02525174000595095, 'psi': 0.9951941235065958}-{'f1_val': 0.9947664837091956, 'auprc': 0.9954091530358149, 'loss_val': 0.025686986188883855, 'psi': 0.9950235514398433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=94 head_norm_before_train=1.879197 cos_to_last_merge=0.9614 (last merge round=34)
[S11] round=94 local utility u=0.003924 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973928968513455, 'loss_val': 0.01996459620172112, 'psi': 0.9968853614486919}-{'f1_val': 0.9958918378685807, 'auprc': 0.9965937119295876, 'loss_val': 0.021483647776620936, 'psi': 0.9961725874929834}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=94 head_norm_before_train=2.273737 (no previous merge yet)
[S13] round=94 local utility u=0.204994 metrics={'f1_val': 0.673457625452861, 'auprc': 0.7922317929853558, 'loss_val': 1.351314480545667, 'psi': 0.720967292465859}-{'f1_val': 0.6428980265133771, 'auprc': 0.7573212943491755, 'loss_val': 1.47321385439487, 'psi': 0.6886673336476965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=94 head_norm_before_train=1.828971 cos_to_last_merge=0.9847 (last merge round=40)
[S14] round=94 local utility u=0.053275 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9967040181892224, 'loss_val': 0.024549297412227507, 'psi': 0.9969675787135686}-{'f1_val': 0.9834234310399234, 'auprc': 0.9966090605621134, 'loss_val': 0.048495633909536574, 'psi': 0.9886976828487994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=94 head_norm_before_train=2.092738 cos_to_last_merge=0.9498 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8440177916115655, 'auprc': 0.9223246793071633, 'loss_val': 0.43182349107041423, 'psi': 0.8753405466898045}-{'f1_val': 0.9815036917622131, 'auprc': 0.9969600860192323, 'loss_val': 0.0407380856249972, 'psi': 0.9876862494650208}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.233327 cos_to_last_merge=0.9952 (last merge round=41)
[S16] round=94 local utility u=1.000000 metrics={'f1_val': 0.9571150841605778, 'auprc': 0.981002444168467, 'loss_val': 0.13156218341625023, 'psi': 0.9666700281637335}-{'f1_val': 0.8610086412066673, 'auprc': 0.8258502829399701, 'loss_val': 1.1778339267308986, 'psi': 0.8469452978999885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=94 head_norm_before_train=2.219198 cos_to_last_merge=0.9433 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=94 local utility u=0.434219 metrics={'f1_val': 0.8689750441214773, 'auprc': 0.8978589989082598, 'loss_val': 0.757440720555513, 'psi': 0.8805286260361902}-{'f1_val': 0.8060522732224298, 'auprc': 0.7915475701507082, 'loss_val': 0.9294081590398012, 'psi': 0.8002503919937412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=95 head_norm_before_train=2.426085 (no previous merge yet)
[S2] round=95 local utility u=0.010859 metrics={'f1_val': 0.7049761372118581, 'auprc': 0.8906982179299547, 'loss_val': 0.6352755859138389, 'psi': 0.7792649694990967}-{'f1_val': 0.705600307211419, 'auprc': 0.8790078905082767, 'loss_val': 0.6256684934178075, 'psi': 0.774963340530162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=95 head_norm_before_train=2.429739 (no previous merge yet)
[S3] round=95 local utility u=0.081526 metrics={'f1_val': 0.9720174605632569, 'auprc': 0.9907874579095884, 'loss_val': 0.08972401829430932, 'psi': 0.9795254595017895}-{'f1_val': 0.9578234843698292, 'auprc': 0.999673574065746, 'loss_val': 0.19427082075955518, 'psi': 0.9745635202481959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=95 head_norm_before_train=2.339883 cos_to_last_merge=0.9797 (last merge round=34)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9515387364837099, 'auprc': 0.9788206700648341, 'loss_val': 0.24470578432590084, 'psi': 0.9624515099161596}-{'f1_val': 0.9504326461822314, 'auprc': 0.9849734699640472, 'loss_val': 0.2413399066846382, 'psi': 0.9642489756949577}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.912851 cos_to_last_merge=0.9345 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9929979278648369, 'loss_val': 0.02851815555634646, 'psi': 0.9946476807496085}-{'f1_val': 0.9957475160061228, 'auprc': 0.994131317739534, 'loss_val': 0.02770649121959486, 'psi': 0.9951010366994872}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.921010 cos_to_last_merge=0.9616 (last merge round=40)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6968861068609341, 'auprc': 0.8824088355634028, 'loss_val': 1.0012240409534967, 'psi': 0.7710951983419216}-{'f1_val': 0.825475532306251, 'auprc': 0.9596882270666398, 'loss_val': 0.2486451821655164, 'psi': 0.8791606102104066}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.784885 cos_to_last_merge=0.9720 (last merge round=41)
[S7] round=95 local utility u=0.969629 metrics={'f1_val': 0.6857642311336796, 'auprc': 0.9435644676979097, 'loss_val': 0.5892779300313797, 'psi': 0.7888843257593716}-{'f1_val': 0.5360629397119038, 'auprc': 0.7962377715117734, 'loss_val': 1.1883473645677476, 'psi': 0.6401328724318517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=95 head_norm_before_train=2.235734 cos_to_last_merge=0.7480 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9723869591509645, 'auprc': 0.9989232520499216, 'loss_val': 0.06642748118609514, 'psi': 0.9830014763105474}-{'f1_val': 0.9747804469165087, 'auprc': 0.9991306764159537, 'loss_val': 0.05541044190549073, 'psi': 0.9845205387162868}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=1.847073 cos_to_last_merge=0.9293 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9991055006696002, 'loss_val': 0.022826760151982747, 'psi': 0.9964063900374616}-{'f1_val': 0.9971000495392299, 'auprc': 0.999089011194092, 'loss_val': 0.019088844851471283, 'psi': 0.9978956342011748}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.398438 cos_to_last_merge=0.8017 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=95 local utility u=0.000001 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9958502787773394, 'loss_val': 0.02529342445164468, 'psi': 0.9952000017364531}-{'f1_val': 0.9947664837091956, 'auprc': 0.9958355832026962, 'loss_val': 0.02525174000595095, 'psi': 0.9951941235065958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=95 head_norm_before_train=1.882943 cos_to_last_merge=0.9612 (last merge round=34)
[S11] round=95 local utility u=0.000403 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975391694788845, 'loss_val': 0.019598350915357592, 'psi': 0.9969438704997076}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973928968513455, 'loss_val': 0.01996459620172112, 'psi': 0.9968853614486919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=95 head_norm_before_train=2.269753 (no previous merge yet)
[S13] round=95 local utility u=0.340935 metrics={'f1_val': 0.6907245740093136, 'auprc': 0.9466193605057465, 'loss_val': 1.2362089067062092, 'psi': 0.7930824886078869}-{'f1_val': 0.673457625452861, 'auprc': 0.7922317929853558, 'loss_val': 1.351314480545667, 'psi': 0.720967292465859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=95 head_norm_before_train=1.834395 cos_to_last_merge=0.9845 (last merge round=40)
[S14] round=95 local utility u=0.002210 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9990928452627754, 'loss_val': 0.022502235199701404, 'psi': 0.99744369116918}-{'f1_val': 0.9971432857297993, 'auprc': 0.9967040181892224, 'loss_val': 0.024549297412227507, 'psi': 0.9969675787135686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=95 head_norm_before_train=2.098091 cos_to_last_merge=0.9494 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=95 local utility u=0.773208 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.995396452914025, 'loss_val': 0.020996831150494787, 'psi': 0.9962065821981223}-{'f1_val': 0.8440177916115655, 'auprc': 0.9223246793071633, 'loss_val': 0.43182349107041423, 'psi': 0.8753405466898045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=95 head_norm_before_train=2.231069 cos_to_last_merge=0.9948 (last merge round=41)
[S16] round=95 local utility u=0.159818 metrics={'f1_val': 0.9911433959003894, 'auprc': 0.9893642217247678, 'loss_val': 0.04118133544781792, 'psi': 0.9904317262301408}-{'f1_val': 0.9571150841605778, 'auprc': 0.981002444168467, 'loss_val': 0.13156218341625023, 'psi': 0.9666700281637335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=95 head_norm_before_train=2.226626 cos_to_last_merge=0.9430 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=95 local utility u=0.085452 metrics={'f1_val': 0.874971544549491, 'auprc': 0.9297217951604633, 'loss_val': 0.7181040485043272, 'psi': 0.8968716447938799}-{'f1_val': 0.8689750441214773, 'auprc': 0.8978589989082598, 'loss_val': 0.757440720555513, 'psi': 0.8805286260361902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=96 head_norm_before_train=2.432226 (no previous merge yet)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7062248234019866, 'auprc': 0.8878401731943253, 'loss_val': 0.6366284487430574, 'psi': 0.778870963318922}-{'f1_val': 0.7049761372118581, 'auprc': 0.8906982179299547, 'loss_val': 0.6352755859138389, 'psi': 0.7792649694990967}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.433004 (no previous merge yet)
[S3] round=96 local utility u=0.124914 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9993900011088899, 'loss_val': 0.017987828224063175, 'psi': 0.9981949419111904}-{'f1_val': 0.9720174605632569, 'auprc': 0.9907874579095884, 'loss_val': 0.08972401829430932, 'psi': 0.9795254595017895}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=96 head_norm_before_train=2.347148 cos_to_last_merge=0.9794 (last merge round=34)
[S4] round=96 local utility u=0.016722 metrics={'f1_val': 0.9521635387445264, 'auprc': 0.9870197477301471, 'loss_val': 0.23960855867506864, 'psi': 0.9661060223387747}-{'f1_val': 0.9515387364837099, 'auprc': 0.9788206700648341, 'loss_val': 0.24470578432590084, 'psi': 0.9624515099161596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=96 head_norm_before_train=1.916199 cos_to_last_merge=0.9337 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=96 local utility u=0.001882 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9938979997311096, 'loss_val': 0.02745510953715596, 'psi': 0.9950077094961176}-{'f1_val': 0.9957475160061228, 'auprc': 0.9929979278648369, 'loss_val': 0.02851815555634646, 'psi': 0.9946476807496085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=96 head_norm_before_train=1.931292 cos_to_last_merge=0.9612 (last merge round=40)
[S6] round=96 local utility u=0.429746 metrics={'f1_val': 0.7814215776793865, 'auprc': 0.9200085474028957, 'loss_val': 0.7617430591017809, 'psi': 0.8368563655687902}-{'f1_val': 0.6968861068609341, 'auprc': 0.8824088355634028, 'loss_val': 1.0012240409534967, 'psi': 0.7710951983419216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=96 head_norm_before_train=1.791834 cos_to_last_merge=0.9710 (last merge round=41)
[S7] round=96 local utility u=0.280342 metrics={'f1_val': 0.7934887209963841, 'auprc': 0.917159956373699, 'loss_val': 0.5957265372498083, 'psi': 0.84295721514731}-{'f1_val': 0.6857642311336796, 'auprc': 0.9435644676979097, 'loss_val': 0.5892779300313797, 'psi': 0.7888843257593716}
[S7] not sending this round → trigger blocked (psi=0.843)
[S8] START round=96 head_norm_before_train=2.241442 cos_to_last_merge=0.7474 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.747
[S8] round=96 local utility u=0.088998 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9987408379028379, 'loss_val': 0.02231834966187611, 'psi': 0.9963719204535118}-{'f1_val': 0.9723869591509645, 'auprc': 0.9989232520499216, 'loss_val': 0.06642748118609514, 'psi': 0.9830014763105474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=96 head_norm_before_train=1.852469 cos_to_last_merge=0.9288 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=96 local utility u=0.006774 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974043596523586, 'loss_val': 0.019151339556070037, 'psi': 0.9972234913682292}-{'f1_val': 0.9946069829493691, 'auprc': 0.9991055006696002, 'loss_val': 0.022826760151982747, 'psi': 0.9964063900374616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=96 head_norm_before_train=2.400706 cos_to_last_merge=0.8014 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9954001325546165, 'loss_val': 0.02574725184891437, 'psi': 0.9950199432473639}-{'f1_val': 0.9947664837091956, 'auprc': 0.9958502787773394, 'loss_val': 0.02529342445164468, 'psi': 0.9952000017364531}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.886858 cos_to_last_merge=0.9610 (last merge round=34)
[S11] round=96 local utility u=0.000015 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975422953044663, 'loss_val': 0.019576853826258643, 'psi': 0.9969451208299402}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975391694788845, 'loss_val': 0.019598350915357592, 'psi': 0.9969438704997076}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=96 head_norm_before_train=2.270046 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.7010593720509655, 'auprc': 0.7883829398053548, 'loss_val': 1.3660641166552727, 'psi': 0.7359887991527212}-{'f1_val': 0.6907245740093136, 'auprc': 0.9466193605057465, 'loss_val': 1.2362089067062092, 'psi': 0.7930824886078869}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.840282 cos_to_last_merge=0.9843 (last merge round=40)
[S14] round=96 local utility u=0.000545 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9986300724025741, 'loss_val': 0.022486006765118232, 'psi': 0.9975047479532484}-{'f1_val': 0.9963442551067831, 'auprc': 0.9990928452627754, 'loss_val': 0.022502235199701404, 'psi': 0.99744369116918}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=96 head_norm_before_train=2.103535 cos_to_last_merge=0.9490 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9797251318809317, 'auprc': 0.9958593733309105, 'loss_val': 0.05821293096644387, 'psi': 0.9861788284609232}-{'f1_val': 0.9967466683875206, 'auprc': 0.995396452914025, 'loss_val': 0.020996831150494787, 'psi': 0.9962065821981223}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.231683 cos_to_last_merge=0.9946 (last merge round=41)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9809538684288805, 'auprc': 0.986694668351682, 'loss_val': 0.07512446168006807, 'psi': 0.983250188398001}-{'f1_val': 0.9911433959003894, 'auprc': 0.9893642217247678, 'loss_val': 0.04118133544781792, 'psi': 0.9904317262301408}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.235055 cos_to_last_merge=0.9426 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.866373952175259, 'auprc': 0.8905486911457446, 'loss_val': 0.7928520876193673, 'psi': 0.8760438477634532}-{'f1_val': 0.874971544549491, 'auprc': 0.9297217951604633, 'loss_val': 0.7181040485043272, 'psi': 0.8968716447938799}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.439221 (no previous merge yet)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7061161092742446, 'auprc': 0.8698757296763974, 'loss_val': 0.6147637778142799, 'psi': 0.7716199574351057}-{'f1_val': 0.7062248234019866, 'auprc': 0.8878401731943253, 'loss_val': 0.6366284487430574, 'psi': 0.778870963318922}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.436610 (no previous merge yet)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9895898344477236, 'auprc': 0.9993170782806174, 'loss_val': 0.05304400427265856, 'psi': 0.9934807319808812}-{'f1_val': 0.9973982357793907, 'auprc': 0.9993900011088899, 'loss_val': 0.017987828224063175, 'psi': 0.9981949419111904}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.348496 cos_to_last_merge=0.9792 (last merge round=34)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9443671001222871, 'auprc': 0.9818355445684194, 'loss_val': 0.2588783155449977, 'psi': 0.9593544779007399}-{'f1_val': 0.9521635387445264, 'auprc': 0.9870197477301471, 'loss_val': 0.23960855867506864, 'psi': 0.9661060223387747}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.920358 cos_to_last_merge=0.9327 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9884631703751892, 'loss_val': 0.03763605014247719, 'psi': 0.9928337777537494}-{'f1_val': 0.9957475160061228, 'auprc': 0.9938979997311096, 'loss_val': 0.02745510953715596, 'psi': 0.9950077094961176}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.939908 cos_to_last_merge=0.9608 (last merge round=40)
[S6] round=97 local utility u=1.000000 metrics={'f1_val': 0.9871593021109071, 'auprc': 0.9886748561885781, 'loss_val': 0.07521676082166533, 'psi': 0.9877655237419756}-{'f1_val': 0.7814215776793865, 'auprc': 0.9200085474028957, 'loss_val': 0.7617430591017809, 'psi': 0.8368563655687902}
[S6] not sending this round → trigger blocked (psi=0.988)
[S7] START round=97 head_norm_before_train=1.799056 cos_to_last_merge=0.9697 (last merge round=41)
[S7] round=97 local utility u=0.369153 metrics={'f1_val': 0.8741302712053751, 'auprc': 0.9535539893604027, 'loss_val': 0.4504512165238662, 'psi': 0.9058997584673861}-{'f1_val': 0.7934887209963841, 'auprc': 0.917159956373699, 'loss_val': 0.5957265372498083, 'psi': 0.84295721514731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=97 head_norm_before_train=2.248143 cos_to_last_merge=0.7465 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.747
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9489765482119962, 'auprc': 0.9990525507895626, 'loss_val': 0.13109227119576097, 'psi': 0.9690069492430227}-{'f1_val': 0.994792642153961, 'auprc': 0.9987408379028379, 'loss_val': 0.02231834966187611, 'psi': 0.9963719204535118}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=1.856515 cos_to_last_merge=0.9282 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9953598154047077, 'loss_val': 0.019148135483938105, 'psi': 0.9964056736691688}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974043596523586, 'loss_val': 0.019151339556070037, 'psi': 0.9972234913682292}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.406755 cos_to_last_merge=0.8011 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=97 local utility u=0.001044 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9958352254516973, 'loss_val': 0.024965008079221362, 'psi': 0.9951939804061962}-{'f1_val': 0.9947664837091956, 'auprc': 0.9954001325546165, 'loss_val': 0.02574725184891437, 'psi': 0.9950199432473639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=97 head_norm_before_train=1.889902 cos_to_last_merge=0.9607 (last merge round=34)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9960326446602815, 'loss_val': 0.020844977639149765, 'psi': 0.9960932628120982}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975422953044663, 'loss_val': 0.019576853826258643, 'psi': 0.9969451208299402}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.271599 (no previous merge yet)
[S13] round=97 local utility u=0.324126 metrics={'f1_val': 0.7400451989872008, 'auprc': 0.8557387125548086, 'loss_val': 1.1537944826510966, 'psi': 0.786322604414244}-{'f1_val': 0.7010593720509655, 'auprc': 0.7883829398053548, 'loss_val': 1.3660641166552727, 'psi': 0.7359887991527212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=97 head_norm_before_train=1.843983 cos_to_last_merge=0.9840 (last merge round=40)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9658888230631739, 'auprc': 0.9949348009637369, 'loss_val': 0.05700739869044, 'psi': 0.9775072142233991}-{'f1_val': 0.996754531653698, 'auprc': 0.9986300724025741, 'loss_val': 0.022486006765118232, 'psi': 0.9975047479532484}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.108789 cos_to_last_merge=0.9486 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.7976623047332945, 'auprc': 0.8763927519709286, 'loss_val': 0.5682499708028025, 'psi': 0.8291544836283481}-{'f1_val': 0.9797251318809317, 'auprc': 0.9958593733309105, 'loss_val': 0.05821293096644387, 'psi': 0.9861788284609232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.235066 cos_to_last_merge=0.9945 (last merge round=41)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9437024488124537, 'auprc': 0.982968332270463, 'loss_val': 0.35751191576516006, 'psi': 0.9594088021956574}-{'f1_val': 0.9809538684288805, 'auprc': 0.986694668351682, 'loss_val': 0.07512446168006807, 'psi': 0.983250188398001}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.239591 cos_to_last_merge=0.9424 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8521609310553526, 'auprc': 0.8620042648897654, 'loss_val': 0.8208271380631915, 'psi': 0.8560982645891178}-{'f1_val': 0.866373952175259, 'auprc': 0.8905486911457446, 'loss_val': 0.7928520876193673, 'psi': 0.8760438477634532}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.439891 (no previous merge yet)
[S2] round=98 local utility u=0.001178 metrics={'f1_val': 0.7059028299004644, 'auprc': 0.8697953828581971, 'loss_val': 0.6108875347824627, 'psi': 0.7714598510835575}-{'f1_val': 0.7061161092742446, 'auprc': 0.8698757296763974, 'loss_val': 0.6147637778142799, 'psi': 0.7716199574351057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=98 head_norm_before_train=2.438870 (no previous merge yet)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9991454472160946, 'loss_val': 0.20087505740153055, 'psi': 0.976155944269176}-{'f1_val': 0.9895898344477236, 'auprc': 0.9993170782806174, 'loss_val': 0.05304400427265856, 'psi': 0.9934807319808812}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.353650 cos_to_last_merge=0.9789 (last merge round=34)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9485399053265363, 'auprc': 0.960488071773018, 'loss_val': 0.3162401023971893, 'psi': 0.9533191719051289}-{'f1_val': 0.9443671001222871, 'auprc': 0.9818355445684194, 'loss_val': 0.2588783155449977, 'psi': 0.9593544779007399}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.923283 cos_to_last_merge=0.9320 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=98 local utility u=0.015762 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9951844133622809, 'loss_val': 0.026275896087066816, 'psi': 0.9955222749485861}-{'f1_val': 0.9957475160061228, 'auprc': 0.9884631703751892, 'loss_val': 0.03763605014247719, 'psi': 0.9928337777537494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=98 head_norm_before_train=1.947533 cos_to_last_merge=0.9604 (last merge round=40)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.860913642018858, 'auprc': 0.9609421623390988, 'loss_val': 0.4340209470648086, 'psi': 0.9009250501469543}-{'f1_val': 0.9871593021109071, 'auprc': 0.9886748561885781, 'loss_val': 0.07521676082166533, 'psi': 0.9877655237419756}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.807637 cos_to_last_merge=0.9681 (last merge round=41)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.5927383157379704, 'auprc': 0.8461547570061994, 'loss_val': 0.9526479192024533, 'psi': 0.694104892245262}-{'f1_val': 0.8741302712053751, 'auprc': 0.9535539893604027, 'loss_val': 0.4504512165238662, 'psi': 0.9058997584673861}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.252243 cos_to_last_merge=0.7457 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.746
[S8] round=98 local utility u=0.187003 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9987595644380978, 'loss_val': 0.02850175294013335, 'psi': 0.996119242134555}-{'f1_val': 0.9489765482119962, 'auprc': 0.9990525507895626, 'loss_val': 0.13109227119576097, 'psi': 0.9690069492430227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=98 head_norm_before_train=1.861257 cos_to_last_merge=0.9278 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=98 local utility u=0.002648 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9979428698450654, 'loss_val': 0.019119712127925615, 'psi': 0.9971906369167293}-{'f1_val': 0.9971029125121428, 'auprc': 0.9953598154047077, 'loss_val': 0.019148135483938105, 'psi': 0.9964056736691688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=98 head_norm_before_train=2.413898 cos_to_last_merge=0.8009 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=98 local utility u=0.001092 metrics={'f1_val': 0.995175839723847, 'auprc': 0.9958222117507766, 'loss_val': 0.025198016110980933, 'psi': 0.9954343885346189}-{'f1_val': 0.9947664837091956, 'auprc': 0.9958352254516973, 'loss_val': 0.024965008079221362, 'psi': 0.9951939804061962}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=98 head_norm_before_train=1.892504 cos_to_last_merge=0.9607 (last merge round=34)
[S11] round=98 local utility u=0.001054 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9968285843183468, 'loss_val': 0.023628727530729126, 'psi': 0.9966619867243971}-{'f1_val': 0.9961336749133093, 'auprc': 0.9960326446602815, 'loss_val': 0.020844977639149765, 'psi': 0.9960932628120982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=98 head_norm_before_train=2.280585 (no previous merge yet)
[S13] round=98 local utility u=0.015981 metrics={'f1_val': 0.7289981144784249, 'auprc': 0.9280922771821518, 'loss_val': 1.272609796329362, 'psi': 0.8086357795599157}-{'f1_val': 0.7400451989872008, 'auprc': 0.8557387125548086, 'loss_val': 1.1537944826510966, 'psi': 0.786322604414244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=98 head_norm_before_train=1.847156 cos_to_last_merge=0.9838 (last merge round=40)
[S14] round=98 local utility u=0.099619 metrics={'f1_val': 0.9942505641904226, 'auprc': 0.996405194172673, 'loss_val': 0.032350500257519704, 'psi': 0.9951124161833228}-{'f1_val': 0.9658888230631739, 'auprc': 0.9949348009637369, 'loss_val': 0.05700739869044, 'psi': 0.9775072142233991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=98 head_norm_before_train=2.113443 cos_to_last_merge=0.9483 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=98 local utility u=0.920453 metrics={'f1_val': 0.9627849853920603, 'auprc': 0.9965872450995608, 'loss_val': 0.07866449500675458, 'psi': 0.9763058892750605}-{'f1_val': 0.7976623047332945, 'auprc': 0.8763927519709286, 'loss_val': 0.5682499708028025, 'psi': 0.8291544836283481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=98 head_norm_before_train=2.236795 cos_to_last_merge=0.9942 (last merge round=41)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.8419690615438, 'auprc': 0.8284168587889227, 'loss_val': 1.3558375432318885, 'psi': 0.8365481804418491}-{'f1_val': 0.9437024488124537, 'auprc': 0.982968332270463, 'loss_val': 0.35751191576516006, 'psi': 0.9594088021956574}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.244294 cos_to_last_merge=0.9421 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8172606363517049, 'auprc': 0.8708006457982702, 'loss_val': 0.9830844920712758, 'psi': 0.838676640130331}-{'f1_val': 0.8521609310553526, 'auprc': 0.8620042648897654, 'loss_val': 0.8208271380631915, 'psi': 0.8560982645891178}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.443691 (no previous merge yet)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7046996954190846, 'auprc': 0.8589702108061776, 'loss_val': 0.611318765848378, 'psi': 0.7664079015739218}-{'f1_val': 0.7059028299004644, 'auprc': 0.8697953828581971, 'loss_val': 0.6108875347824627, 'psi': 0.7714598510835575}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.766 u=0.0000 p_local=0.0174 f1=0.705 auprc=0.859 bytes=68374
[S3] START round=99 head_norm_before_train=2.442199 (no previous merge yet)
[S3] round=99 local utility u=0.146886 metrics={'f1_val': 0.988785957764895, 'auprc': 0.9986319085751008, 'loss_val': 0.07330130712091079, 'psi': 0.9927243380889773}-{'f1_val': 0.9608296089712303, 'auprc': 0.9991454472160946, 'loss_val': 0.20087505740153055, 'psi': 0.976155944269176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S3] r=100 psi=0.993 u=0.1469 p_local=0.0587 f1=0.989 auprc=0.999 bytes=70089
[S4] START round=99 head_norm_before_train=2.356511 cos_to_last_merge=0.9786 (last merge round=34)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9514111198944485, 'auprc': 0.958794482152678, 'loss_val': 0.3341382781768682, 'psi': 0.9543644647977403}-{'f1_val': 0.9485399053265363, 'auprc': 0.960488071773018, 'loss_val': 0.3162401023971893, 'psi': 0.9533191719051289}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.954 u=0.0000 p_local=0.0070 f1=0.951 auprc=0.959 bytes=70063
[S5] START round=99 head_norm_before_train=1.927575 cos_to_last_merge=0.9315 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9789534126682601, 'auprc': 0.9884097369609546, 'loss_val': 0.056693243385083185, 'psi': 0.9827359423853379}-{'f1_val': 0.9957475160061228, 'auprc': 0.9951844133622809, 'loss_val': 0.026275896087066816, 'psi': 0.9955222749485861}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.983 u=0.0000 p_local=0.0053 f1=0.979 auprc=0.988 bytes=81021
[S6] START round=99 head_norm_before_train=1.953434 cos_to_last_merge=0.9601 (last merge round=40)
[S6] round=99 local utility u=0.271194 metrics={'f1_val': 0.9047597437420476, 'auprc': 0.9661333774188237, 'loss_val': 0.17028283243189046, 'psi': 0.9293091972127581}-{'f1_val': 0.860913642018858, 'auprc': 0.9609421623390988, 'loss_val': 0.4340209470648086, 'psi': 0.9009250501469543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S6] r=100 psi=0.929 u=0.2712 p_local=0.2906 f1=0.905 auprc=0.966 bytes=62946
[S7] START round=99 head_norm_before_train=1.814760 cos_to_last_merge=0.9669 (last merge round=41)
[S7] round=99 local utility u=0.989975 metrics={'f1_val': 0.8141908927085133, 'auprc': 0.905561310430818, 'loss_val': 0.47963374796465114, 'psi': 0.8507390597974351}-{'f1_val': 0.5927383157379704, 'auprc': 0.8461547570061994, 'loss_val': 0.9526479192024533, 'psi': 0.694104892245262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=100 psi=0.851 u=0.9900 p_local=0.4868 f1=0.814 auprc=0.906 bytes=79276
[S8] START round=99 head_norm_before_train=2.254629 cos_to_last_merge=0.7449 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.745
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9540302917833396, 'auprc': 0.9991393551730181, 'loss_val': 0.13619273704520768, 'psi': 0.9720739171392111}-{'f1_val': 0.9943590272655265, 'auprc': 0.9987595644380978, 'loss_val': 0.02850175294013335, 'psi': 0.996119242134555}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.972 u=0.0000 p_local=0.0776 f1=0.954 auprc=0.999 bytes=80897
[S9] START round=99 head_norm_before_train=1.866175 cos_to_last_merge=0.9274 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=99 local utility u=0.003098 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9990908627866584, 'loss_val': 0.018833778939291005, 'psi': 0.9978963748382014}-{'f1_val': 0.9966891482978385, 'auprc': 0.9979428698450654, 'loss_val': 0.019119712127925615, 'psi': 0.9971906369167293}
[S9] not sending this round → trigger blocked (psi=0.998)
[S9] r=100 psi=0.998 u=0.0031 p_local=0.0024 f1=0.997 auprc=0.999 bytes=80922
[S10] START round=99 head_norm_before_train=2.420971 cos_to_last_merge=0.8007 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9959366147055537, 'loss_val': 0.024887867060708717, 'psi': 0.9952345361077388}-{'f1_val': 0.995175839723847, 'auprc': 0.9958222117507766, 'loss_val': 0.025198016110980933, 'psi': 0.9954343885346189}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0004 f1=0.995 auprc=0.996 bytes=82610
[S11] START round=99 head_norm_before_train=1.895723 cos_to_last_merge=0.9606 (last merge round=34)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9969931854228056, 'loss_val': 0.030899813580921077, 'psi': 0.9967278271661806}-{'f1_val': 0.9965509216617638, 'auprc': 0.9968285843183468, 'loss_val': 0.023628727530729126, 'psi': 0.9966619867243971}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0024 f1=0.997 auprc=0.997 bytes=86319
[S13] START round=99 head_norm_before_train=2.284736 (no previous merge yet)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6891703583980615, 'auprc': 0.8180235210095003, 'loss_val': 1.2026338096034992, 'psi': 0.740711623442637}-{'f1_val': 0.7289981144784249, 'auprc': 0.9280922771821518, 'loss_val': 1.272609796329362, 'psi': 0.8086357795599157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.741 u=0.0000 p_local=0.1359 f1=0.689 auprc=0.818 bytes=68311
[S14] START round=99 head_norm_before_train=1.850683 cos_to_last_merge=0.9836 (last merge round=40)
[S14] round=99 local utility u=0.016786 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9990533468401663, 'loss_val': 0.021747735578957778, 'psi': 0.9976740577282853}-{'f1_val': 0.9942505641904226, 'auprc': 0.996405194172673, 'loss_val': 0.032350500257519704, 'psi': 0.9951124161833228}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=100 psi=0.998 u=0.0168 p_local=0.0242 f1=0.997 auprc=0.999 bytes=80953
[S15] START round=99 head_norm_before_train=2.118641 cos_to_last_merge=0.9479 (last merge round=39)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9627519808495014, 'auprc': 0.9963466388613959, 'loss_val': 0.08357823188262087, 'psi': 0.9761898440542592}-{'f1_val': 0.9627849853920603, 'auprc': 0.9965872450995608, 'loss_val': 0.07866449500675458, 'psi': 0.9763058892750605}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.976 u=0.0000 p_local=0.3066 f1=0.963 auprc=0.996 bytes=71961
[S16] START round=99 head_norm_before_train=2.239407 cos_to_last_merge=0.9940 (last merge round=41)
[S16] round=99 local utility u=1.000000 metrics={'f1_val': 0.9933000740342921, 'auprc': 0.9880011657061745, 'loss_val': 0.04012300575404716, 'psi': 0.9911805107030451}-{'f1_val': 0.8419690615438, 'auprc': 0.8284168587889227, 'loss_val': 1.3558375432318885, 'psi': 0.8365481804418491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=100 psi=0.991 u=1.0000 p_local=0.3011 f1=0.993 auprc=0.988 bytes=66435
[S17] START round=99 head_norm_before_train=2.249142 cos_to_last_merge=0.9419 (last merge round=41)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=99 local utility u=0.343279 metrics={'f1_val': 0.8703030411250312, 'auprc': 0.9149966406007085, 'loss_val': 0.7473689048398137, 'psi': 0.8881804809153022}-{'f1_val': 0.8172606363517049, 'auprc': 0.8708006457982702, 'loss_val': 0.9830844920712758, 'psi': 0.838676640130331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=100 psi=0.888 u=0.3433 p_local=0.1096 f1=0.870 auprc=0.915 bytes=82774
[runner] rounds complete.
[runner] all agents stopped.
