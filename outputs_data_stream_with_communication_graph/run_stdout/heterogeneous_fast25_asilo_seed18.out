[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:41903
[S3] → join 127.0.0.1:41902
[S4] → join 127.0.0.1:41902
[S5] → join 127.0.0.1:41902
[S6] → join 127.0.0.1:41902
[S7] → join 127.0.0.1:41902
[S8] → join 127.0.0.1:41902
[S9] → join 127.0.0.1:41902
[S10] → join 127.0.0.1:41902
[S11] → join 127.0.0.1:41902
[S13] → join 127.0.0.1:41902
[S14] → join 127.0.0.1:41902
[S15] → join 127.0.0.1:41902
[S16] → join 127.0.0.1:41902
[S17] → join 127.0.0.1:41902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.163040 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.177436 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.110734 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.204979 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.153637 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.172699 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.168242 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.154385 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.166175 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.174830 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.126426 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.156663 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.168254 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.141133 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.170461 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S10
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S7
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S5
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S7
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S13
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S14
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S10
[S6] + discovered S17
[S7] + discovered S5
[S6] + discovered S15
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S9
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S15
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S14
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S6
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S10
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S7
[S10] + discovered S6
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S4
[S9] + discovered S15
[S10] + discovered S9
[S9] + discovered S14
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S2
[S11] + discovered S6
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S8
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S13
[S11] + discovered S15
[S13] + discovered S11
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S8
[S11] + discovered S14
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S10
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S11
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S7
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S5
[S15] + discovered S17
[S16] + discovered S9
[S15] + discovered S16
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S3
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:41913
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:41912
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:41904
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:41902
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:41903
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:41909
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:41915
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S2] START round=1 head_norm_before_train=1.163857 (no previous merge yet)
[S2] round=1 local utility u=0.026805 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7735853110191073, 'loss_val': 1.3140099553623665, 'psi': 0.394500404440783}-{'f1_val': 0.1417771333885667, 'auprc': 0.7657223409749361, 'loss_val': 1.3440318787827785, 'psi': 0.3913552164231145}
[S3] START round=1 head_norm_before_train=1.193174 (no previous merge yet)
[S3] round=1 local utility u=0.063350 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7180557900789536, 'loss_val': 1.2703207592087298, 'psi': 0.3711263554000457}-{'f1_val': 0.13984006561410703, 'auprc': 0.6917799413718079, 'loss_val': 1.3181939704317152, 'psi': 0.3606160159171874}
[S4] START round=1 head_norm_before_train=1.113643 (no previous merge yet)
[S4] round=1 local utility u=0.319675 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6774449101481058, 'loss_val': 1.3054379946579129, 'psi': 0.35511394139635283}-{'f1_val': 0.14022662889518414, 'auprc': 0.4754345763020058, 'loss_val': 1.3387567943811995, 'psi': 0.2743098078579128}
[S5] START round=1 head_norm_before_train=1.222232 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7283756018340763, 'loss_val': 1.2698535046244492, 'psi': 0.3767073835907734}-{'f1_val': 0.393616424676508, 'auprc': 0.7297076862479288, 'loss_val': 1.3385479009181243, 'psi': 0.5280529293050763}
[S6] START round=1 head_norm_before_train=1.151958 (no previous merge yet)
[S6] round=1 local utility u=0.418708 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6461467269687307, 'loss_val': 1.328234009341729, 'psi': 0.3433144600182615}-{'f1_val': 0.14142628205128205, 'auprc': 0.37677930587368824, 'loss_val': 1.357547659103528, 'psi': 0.23556749158024454}
[S7] START round=1 head_norm_before_train=1.181684 (no previous merge yet)
[S7] round=1 local utility u=0.029873 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7929781146079836, 'loss_val': 1.2995404114023295, 'psi': 0.40242533948064846}-{'f1_val': 0.14205682272909165, 'auprc': 0.7916875738348101, 'loss_val': 1.3554148416899323, 'psi': 0.40190912317137906}
[S8] START round=1 head_norm_before_train=1.168868 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.5543479514962137, 'loss_val': 1.3186179402822635, 'psi': 0.30571277003425984}-{'f1_val': 0.34107647598502455, 'auprc': 0.557127158910053, 'loss_val': 1.3518212125479423, 'psi': 0.427496749155036}
[S9] START round=1 head_norm_before_train=1.172959 (no previous merge yet)
[S9] round=1 local utility u=0.044192 metrics={'f1_val': 0.141397957139996, 'auprc': 0.80326523698554, 'loss_val': 1.2519455323681132, 'psi': 0.4061448690782136}-{'f1_val': 0.141397957139996, 'auprc': 0.7966896185622413, 'loss_val': 1.32060269762393, 'psi': 0.40351462170889413}
[S10] START round=1 head_norm_before_train=1.167733 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.578559014114108, 'loss_val': 1.319551566984073, 'psi': 0.3145965881706776}-{'f1_val': 0.37772071527611417, 'auprc': 0.4654850203966867, 'loss_val': 1.3586934271845559, 'psi': 0.4128264373243432}
[S11] START round=1 head_norm_before_train=1.185435 (no previous merge yet)
[S11] round=1 local utility u=0.114096 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.739923852590176, 'loss_val': 1.3007652817977569, 'psi': 0.38021775105993677}-{'f1_val': 0.14041368337311058, 'auprc': 0.6728516968561111, 'loss_val': 1.3277418130069105, 'psi': 0.3533888887663108}
[S13] START round=1 head_norm_before_train=1.129699 (no previous merge yet)
[S13] round=1 local utility u=0.129596 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6400734434463903, 'loss_val': 1.3339775849650637, 'psi': 0.340260834924788}-{'f1_val': 0.1403857625770531, 'auprc': 0.5626561560360575, 'loss_val': 1.3609180780638042, 'psi': 0.30929391996065486}
[S14] START round=1 head_norm_before_train=1.152747 (no previous merge yet)
[S14] round=1 local utility u=0.438518 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.43201931222936474, 'loss_val': 1.3495120707260464, 'psi': 0.25702243662136814}-{'f1_val': 0.09155565590426733, 'auprc': 0.24387431123011205, 'loss_val': 1.3693003012543639, 'psi': 0.15248311803460524}
[S15] START round=1 head_norm_before_train=1.176070 (no previous merge yet)
[S15] round=1 local utility u=0.265920 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7453707081420214, 'loss_val': 1.3207090959964267, 'psi': 0.3819884740737436}-{'f1_val': 0.13973365136155833, 'auprc': 0.5771106659506454, 'loss_val': 1.3477693302720741, 'psi': 0.3146844571971932}
[S16] START round=1 head_norm_before_train=1.143635 (no previous merge yet)
[S16] round=1 local utility u=0.412631 metrics={'f1_val': 0.15447485507996273, 'auprc': 0.776264184984044, 'loss_val': 1.3374103675790059, 'psi': 0.40319058704159527}-{'f1_val': 0.10386473429951691, 'auprc': 0.6117561381823079, 'loss_val': 1.365487762124161, 'psi': 0.3070212958526333}
[S17] START round=1 head_norm_before_train=1.180657 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5103233800750384, 'loss_val': 1.308966443706122, 'psi': 0.288698730020446}-{'f1_val': 0.14094896331738438, 'auprc': 0.5607013910892423, 'loss_val': 1.3386300647527989, 'psi': 0.30884993442612757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S15] → sending delta(kind=head bytes=1783) to S2@127.0.0.1:41902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:41908
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S3@127.0.0.1:41903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:41905
[S2] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1786 to 1 peers)
[S15] sending update (kind=head size=1783 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S3
[S16] cosine check vs S3: cos=0.0281
[S7] RECEIVED delta(kind=head bytes=1795) from S4
[S7] cosine check vs S4: cos=-0.0660
[S7] DROPPED delta from S4 (cos=-0.0660 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1790) from S2
[S7] cosine check vs S2: cos=-0.0098
[S7] DROPPED delta from S2 (cos=-0.0098 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1787) from S11
[S2] cosine check vs S11: cos=0.0774
[S11] RECEIVED delta(kind=head bytes=1791) from S9
[S11] cosine check vs S9: cos=-0.0550
[S11] DROPPED delta from S9 (cos=-0.0550 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S6
[S11] cosine check vs S6: cos=-0.0240
[S11] DROPPED delta from S6 (cos=-0.0240 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1783) from S15
[S2] cosine check vs S15: cos=0.0688
[S5] RECEIVED delta(kind=head bytes=1786) from S13
[S5] cosine check vs S13: cos=-0.0825
[S5] DROPPED delta from S13 (cos=-0.0825 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1786) from S7
[S3] cosine check vs S7: cos=-0.0500
[S3] DROPPED delta from S7 (cos=-0.0500 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1787) from S16
[S7] cosine check vs S16: cos=0.0010
[S3] RECEIVED delta(kind=head bytes=1786) from S14
[S3] cosine check vs S14: cos=-0.0633
[S3] DROPPED delta from S14 (cos=-0.0633 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.209227
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.358470e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.3982 head_norm=0.836679 delta_norm=0.835847
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1545 head_norm=1.155471
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.283061e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1670 head_norm=0.851877 delta_norm=0.828306
[S16] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.173364
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.746812e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.746950 delta_norm=0.674681
[S2] aggregate: ACCEPT kept=['S11', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.746950 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7698755805904414, 'loss_val': 1.318461320812938, 'psi': 0.3930165122693166}-{'f1_val': 0.1417771333885667, 'auprc': 0.7735853110191073, 'loss_val': 1.3140099553623665, 'psi': 0.394500404440783}
[S3] START round=2 head_norm_before_train=1.220024 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6861169993233106, 'loss_val': 1.1896863064722256, 'psi': 0.3583508390977884}-{'f1_val': 0.13984006561410703, 'auprc': 0.7180557900789536, 'loss_val': 1.2703207592087298, 'psi': 0.3711263554000457}
[S4] START round=2 head_norm_before_train=1.126227 (no previous merge yet)
[S4] round=2 local utility u=0.186450 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7867358393267707, 'loss_val': 1.2604113265718562, 'psi': 0.3988303130678188}-{'f1_val': 0.14022662889518414, 'auprc': 0.6774449101481058, 'loss_val': 1.3054379946579129, 'psi': 0.35511394139635283}
[S5] START round=2 head_norm_before_train=1.263129 (no previous merge yet)
[S5] round=2 local utility u=0.050236 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289594901774984, 'loss_val': 1.171132744179676, 'psi': 0.37694093892814223}-{'f1_val': 0.14226190476190476, 'auprc': 0.7283756018340763, 'loss_val': 1.2698535046244492, 'psi': 0.3767073835907734}
[S6] START round=2 head_norm_before_train=1.156581 (no previous merge yet)
[S6] round=2 local utility u=0.121119 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7158235335797484, 'loss_val': 1.2950260569263428, 'psi': 0.3711851826626686}-{'f1_val': 0.14142628205128205, 'auprc': 0.6461467269687307, 'loss_val': 1.328234009341729, 'psi': 0.3433144600182615}
[S7] START round=2 head_norm_before_train=0.836679 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7769565615367185, 'loss_val': 1.27428285576357, 'psi': 0.3960167182521424}-{'f1_val': 0.14205682272909165, 'auprc': 0.7929781146079836, 'loss_val': 1.2995404114023295, 'psi': 0.40242533948064846}
[S8] START round=2 head_norm_before_train=1.179630 (no previous merge yet)
[S8] round=2 local utility u=0.316545 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7528401624810697, 'loss_val': 1.281005505640901, 'psi': 0.3851096544282022}-{'f1_val': 0.13995598239295717, 'auprc': 0.5543479514962137, 'loss_val': 1.3186179402822635, 'psi': 0.30571277003425984}
[S9] START round=2 head_norm_before_train=1.210252 (no previous merge yet)
[S9] round=2 local utility u=0.033737 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8029225612179289, 'loss_val': 1.1834437597416942, 'psi': 0.4060077987711692}-{'f1_val': 0.141397957139996, 'auprc': 0.80326523698554, 'loss_val': 1.2519455323681132, 'psi': 0.4061448690782136}
[S10] START round=2 head_norm_before_train=1.179603 (no previous merge yet)
[S10] round=2 local utility u=0.113936 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6425402703286115, 'loss_val': 1.2836242661743855, 'psi': 0.34018909065647895}-{'f1_val': 0.13862163754172394, 'auprc': 0.578559014114108, 'loss_val': 1.319551566984073, 'psi': 0.3145965881706776}
[S11] START round=2 head_norm_before_train=1.202678 (no previous merge yet)
[S11] round=2 local utility u=0.031826 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.748986017700829, 'loss_val': 1.2643002887374457, 'psi': 0.3838426171041979}-{'f1_val': 0.14041368337311058, 'auprc': 0.739923852590176, 'loss_val': 1.3007652817977569, 'psi': 0.38021775105993677}
[S13] START round=2 head_norm_before_train=1.139241 (no previous merge yet)
[S13] round=2 local utility u=0.156305 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7343508264967722, 'loss_val': 1.3042005014435847, 'psi': 0.37797178814494076}-{'f1_val': 0.1403857625770531, 'auprc': 0.6400734434463903, 'loss_val': 1.3339775849650637, 'psi': 0.340260834924788}
[S14] START round=2 head_norm_before_train=1.158541 (no previous merge yet)
[S14] round=2 local utility u=0.248383 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5902044490122681, 'loss_val': 1.3273020896544478, 'psi': 0.32029649133452953}-{'f1_val': 0.14035785288270378, 'auprc': 0.43201931222936474, 'loss_val': 1.3495120707260464, 'psi': 0.25702243662136814}
[S15] START round=2 head_norm_before_train=1.192013 (no previous merge yet)
[S15] round=2 local utility u=0.049902 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7693471534452075, 'loss_val': 1.2928335940488072, 'psi': 0.39157905219501804}-{'f1_val': 0.13973365136155833, 'auprc': 0.7453707081420214, 'loss_val': 1.3207090959964267, 'psi': 0.3819884740737436}
[S16] START round=2 head_norm_before_train=0.851877 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7967020600540002, 'loss_val': 1.3302195648904789, 'psi': 0.4030632941411221}-{'f1_val': 0.15447485507996273, 'auprc': 0.776264184984044, 'loss_val': 1.3374103675790059, 'psi': 0.40319058704159527}
[S17] START round=2 head_norm_before_train=1.200038 (no previous merge yet)
[S17] round=2 local utility u=0.019785 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.510589355409197, 'loss_val': 1.2701951149580273, 'psi': 0.2888051201541094}-{'f1_val': 0.14094896331738438, 'auprc': 0.5103233800750384, 'loss_val': 1.308966443706122, 'psi': 0.288698730020446}
[S13] not sending this round → trigger blocked (psi=0.378)
[S9] not sending this round → trigger blocked (psi=0.406)
[S14] not sending this round → trigger blocked (psi=0.320)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.392)
[S6] not sending this round → trigger blocked (psi=0.371)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:41902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.399)
[S11] not sending this round → trigger blocked (psi=0.384)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:41917
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S10
[S17] cosine check vs S10: cos=-0.1224
[S17] DROPPED delta from S10 (cos=-0.1224 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S5
[S2] cosine check vs S5: cos=-0.0115
[S2] DROPPED delta from S5 (cos=-0.0115 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S8
[S2] cosine check vs S8: cos=0.0370
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:41902
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S17
[S2] cosine check vs S17: cos=0.0604
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.762695
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.491038e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.588826 delta_norm=0.549104
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.588826 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.027058 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7848187839845586, 'loss_val': 1.3091744630708282, 'psi': 0.3989937936269635}-{'f1_val': 0.1417771333885667, 'auprc': 0.7698755805904414, 'loss_val': 1.318461320812938, 'psi': 0.3930165122693166}
[S3] START round=3 head_norm_before_train=1.265757 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.4225626028819525, 'auprc': 0.7952545575483368, 'loss_val': 0.9789693651564968, 'psi': 0.5716393847485063}-{'f1_val': 0.13984006561410703, 'auprc': 0.6861169993233106, 'loss_val': 1.1896863064722256, 'psi': 0.3583508390977884}
[S4] START round=3 head_norm_before_train=1.147437 (no previous merge yet)
[S4] round=3 local utility u=0.017500 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7760724360170544, 'loss_val': 1.193422013879227, 'psi': 0.3945649517439323}-{'f1_val': 0.14022662889518414, 'auprc': 0.7867358393267707, 'loss_val': 1.2604113265718562, 'psi': 0.3988303130678188}
[S5] START round=3 head_norm_before_train=1.313527 (no previous merge yet)
[S5] round=3 local utility u=0.967880 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7673721005250601, 'loss_val': 1.0035417066831003, 'psi': 0.5575991736794673}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289594901774984, 'loss_val': 1.171132744179676, 'psi': 0.37694093892814223}
[S6] START round=3 head_norm_before_train=1.171659 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6564426469412948, 'loss_val': 1.259463710173772, 'psi': 0.34743282800728714}-{'f1_val': 0.14142628205128205, 'auprc': 0.7158235335797484, 'loss_val': 1.2950260569263428, 'psi': 0.3711851826626686}
[S7] START round=3 head_norm_before_train=0.877141 cos_to_last_merge=0.9930 (last merge round=1)
[S7] round=3 local utility u=0.019472 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775311674820251, 'loss_val': 1.2370632717277465, 'psi': 0.39624656063026503}-{'f1_val': 0.14205682272909165, 'auprc': 0.7769565615367185, 'loss_val': 1.27428285576357, 'psi': 0.3960167182521424}
[S8] START round=3 head_norm_before_train=1.197960 (no previous merge yet)
[S8] round=3 local utility u=0.043218 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7654863726090563, 'loss_val': 1.2325071794207787, 'psi': 0.39016813847939685}-{'f1_val': 0.13995598239295717, 'auprc': 0.7528401624810697, 'loss_val': 1.281005505640901, 'psi': 0.3851096544282022}
[S9] START round=3 head_norm_before_train=1.251760 (no previous merge yet)
[S9] round=3 local utility u=0.263229 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9275561993292201, 'loss_val': 1.0308875863991012, 'psi': 0.45586125401568567}-{'f1_val': 0.141397957139996, 'auprc': 0.8029225612179289, 'loss_val': 1.1834437597416942, 'psi': 0.4060077987711692}
[S10] START round=3 head_norm_before_train=1.196007 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5988038410361437, 'loss_val': 1.239770969475997, 'psi': 0.32269451893949186}-{'f1_val': 0.13862163754172394, 'auprc': 0.6425402703286115, 'loss_val': 1.2836242661743855, 'psi': 0.34018909065647895}
[S11] START round=3 head_norm_before_train=1.231307 (no previous merge yet)
[S11] round=3 local utility u=0.003335 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7383401984903188, 'loss_val': 1.2256932273818408, 'psi': 0.3795842894199939}-{'f1_val': 0.14041368337311058, 'auprc': 0.748986017700829, 'loss_val': 1.2643002887374457, 'psi': 0.3838426171041979}
[S13] START round=3 head_norm_before_train=1.157308 (no previous merge yet)
[S13] round=3 local utility u=0.009617 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7287356090996576, 'loss_val': 1.2681212104259993, 'psi': 0.3757257011860949}-{'f1_val': 0.1403857625770531, 'auprc': 0.7343508264967722, 'loss_val': 1.3042005014435847, 'psi': 0.37797178814494076}
[S14] START round=3 head_norm_before_train=1.175341 (no previous merge yet)
[S14] round=3 local utility u=0.083979 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6381632068773585, 'loss_val': 1.3032208092490052, 'psi': 0.33947999448056565}-{'f1_val': 0.14035785288270378, 'auprc': 0.5902044490122681, 'loss_val': 1.3273020896544478, 'psi': 0.32029649133452953}
[S15] START round=3 head_norm_before_train=1.214078 (no previous merge yet)
[S15] round=3 local utility u=0.021633 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7731448911919856, 'loss_val': 1.260961429680959, 'psi': 0.39309814729372927}-{'f1_val': 0.13973365136155833, 'auprc': 0.7693471534452075, 'loss_val': 1.2928335940488072, 'psi': 0.39157905219501804}
[S16] START round=3 head_norm_before_train=0.870028 cos_to_last_merge=0.9970 (last merge round=1)
[S16] round=3 local utility u=0.020831 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7972442546535343, 'loss_val': 1.2901844170290944, 'psi': 0.4032801719809357}-{'f1_val': 0.14063745019920318, 'auprc': 0.7967020600540002, 'loss_val': 1.3302195648904789, 'psi': 0.4030632941411221}
[S17] START round=3 head_norm_before_train=1.227487 (no previous merge yet)
[S17] round=3 local utility u=0.051447 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5230164897256879, 'loss_val': 1.2045828923911854, 'psi': 0.2937759738807058}-{'f1_val': 0.14094896331738438, 'auprc': 0.510589355409197, 'loss_val': 1.2701951149580273, 'psi': 0.2888051201541094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:41917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S5] not sending this round → trigger blocked (psi=0.558)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.1139
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=-0.0998
[S16] DROPPED delta from S9 (cos=-0.0998 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=-0.0112
[S15] DROPPED delta from S16 (cos=-0.0112 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] cosine check vs S13: cos=0.0547
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=0.0214
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] cosine check vs S3: cos=0.0013
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.5343
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.0360
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=-0.0144
[S11] DROPPED delta from S14 (cos=-0.0144 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] cosine check vs S7: cos=0.0105
[S17] not sending this round → trigger blocked (psi=0.294)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.898336
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.329612e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.816539 delta_norm=0.732961
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.176627
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.433105e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.750889 delta_norm=0.743310
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.182286
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.471419e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.865421 delta_norm=0.847142
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.200142
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.250917e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.855348 delta_norm=0.825092
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.609845
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.501644e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.679810 delta_norm=0.650164
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.265207
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.584902e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.800532 delta_norm=0.658490
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.679810 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7415973299245191, 'loss_val': 1.2942444505159754, 'psi': 0.3817052120029477}-{'f1_val': 0.1417771333885667, 'auprc': 0.7848187839845586, 'loss_val': 1.3091744630708282, 'psi': 0.3989937936269635}
[S3] START round=4 head_norm_before_train=1.326089 (no previous merge yet)
[S3] round=4 local utility u=0.383153 metrics={'f1_val': 0.4052227667257645, 'auprc': 0.9971930703321803, 'loss_val': 0.7144403766531097, 'psi': 0.6420108881683309}-{'f1_val': 0.4225626028819525, 'auprc': 0.7952545575483368, 'loss_val': 0.9789693651564968, 'psi': 0.5716393847485063}
[S4] START round=4 head_norm_before_train=0.750889 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7684162605342428, 'loss_val': 1.17300148154125, 'psi': 0.39150248155080764}-{'f1_val': 0.14022662889518414, 'auprc': 0.7760724360170544, 'loss_val': 1.193422013879227, 'psi': 0.3945649517439323}
[S5] START round=4 head_norm_before_train=1.368633 (no previous merge yet)
[S5] round=4 local utility u=0.177743 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.8223059681971319, 'loss_val': 0.8123577363730093, 'psi': 0.5795226986587}-{'f1_val': 0.4177505557824055, 'auprc': 0.7673721005250601, 'loss_val': 1.0035417066831003, 'psi': 0.5575991736794673}
[S6] START round=4 head_norm_before_train=1.191873 (no previous merge yet)
[S6] round=4 local utility u=0.046313 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6739278505141273, 'loss_val': 1.2192923251902636, 'psi': 0.35442690943642013}-{'f1_val': 0.14142628205128205, 'auprc': 0.6564426469412948, 'loss_val': 1.259463710173772, 'psi': 0.34743282800728714}
[S7] START round=4 head_norm_before_train=0.920999 cos_to_last_merge=0.9805 (last merge round=1)
[S7] round=4 local utility u=0.023991 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778070478059982, 'loss_val': 1.1899093354546233, 'psi': 0.3963569127598543}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775311674820251, 'loss_val': 1.2370632717277465, 'psi': 0.39624656063026503}
[S8] START round=4 head_norm_before_train=1.222618 (no previous merge yet)
[S8] round=4 local utility u=0.036503 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7679893371643891, 'loss_val': 1.1670109941786702, 'psi': 0.39116932430153}-{'f1_val': 0.13995598239295717, 'auprc': 0.7654863726090563, 'loss_val': 1.2325071794207787, 'psi': 0.39016813847939685}
[S9] START round=4 head_norm_before_train=1.288509 (no previous merge yet)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7007592215828227, 'auprc': 0.9996766834395456, 'loss_val': 0.6904508330888198, 'psi': 0.8203262063255119}-{'f1_val': 0.141397957139996, 'auprc': 0.9275561993292201, 'loss_val': 1.0308875863991012, 'psi': 0.45586125401568567}
[S10] START round=4 head_norm_before_train=1.220176 (no previous merge yet)
[S10] round=4 local utility u=0.011463 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.59181272943074, 'loss_val': 1.1958707176567622, 'psi': 0.3198980742973304}-{'f1_val': 0.13862163754172394, 'auprc': 0.5988038410361437, 'loss_val': 1.239770969475997, 'psi': 0.32269451893949186}
[S11] START round=4 head_norm_before_train=1.265277 (no previous merge yet)
[S11] round=4 local utility u=0.049290 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7537868591302394, 'loss_val': 1.1734534315917355, 'psi': 0.3857629536759621}-{'f1_val': 0.14041368337311058, 'auprc': 0.7383401984903188, 'loss_val': 1.2256932273818408, 'psi': 0.3795842894199939}
[S13] START round=4 head_norm_before_train=0.865421 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5956918766190666, 'loss_val': 1.2765245909587752, 'psi': 0.3225082081938585}-{'f1_val': 0.1403857625770531, 'auprc': 0.7287356090996576, 'loss_val': 1.2681212104259993, 'psi': 0.3757257011860949}
[S14] START round=4 head_norm_before_train=0.855348 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.067708 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6866614293668949, 'loss_val': 1.313298936654589, 'psi': 0.3588792834763802}-{'f1_val': 0.14035785288270378, 'auprc': 0.6381632068773585, 'loss_val': 1.3032208092490052, 'psi': 0.33947999448056565}
[S15] START round=4 head_norm_before_train=1.239115 (no previous merge yet)
[S15] round=4 local utility u=0.024643 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765465678358312, 'loss_val': 1.2218803546258659, 'psi': 0.3944588179512675}-{'f1_val': 0.13973365136155833, 'auprc': 0.7731448911919856, 'loss_val': 1.260961429680959, 'psi': 0.39309814729372927}
[S16] START round=4 head_norm_before_train=0.816539 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7834847745405993, 'loss_val': 1.2688527551854263, 'psi': 0.39777637993576165}-{'f1_val': 0.14063745019920318, 'auprc': 0.7972442546535343, 'loss_val': 1.2901844170290944, 'psi': 0.4032801719809357}
[S17] START round=4 head_norm_before_train=0.800532 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.039717 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5363199452157331, 'loss_val': 1.1650586096586608, 'psi': 0.2990973560767239}-{'f1_val': 0.14094896331738438, 'auprc': 0.5230164897256879, 'loss_val': 1.2045828923911854, 'psi': 0.2937759738807058}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.394)
[S11] not sending this round → trigger blocked (psi=0.386)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:41917
[S14] not sending this round → trigger blocked (psi=0.359)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S7] not sending this round → trigger blocked (psi=0.396)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.642)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.1353
[S16] DROPPED delta from S5 (cos=-0.1353 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S6
[S17] cosine check vs S6: cos=-0.0244
[S17] DROPPED delta from S6 (cos=-0.0244 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.0374
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.1320
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=-0.0204
[S14] DROPPED delta from S17 (cos=-0.0204 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.4052 head_norm=1.409914
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.774555e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.4476 head_norm=1.001043 delta_norm=0.877456
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=1.247467
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.663605e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.899378 delta_norm=0.866361
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.695245 cos_to_last_merge=0.9930 (last merge round=3)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.617534567927663, 'loss_val': 1.2230639432703554, 'psi': 0.3320801072042053}-{'f1_val': 0.1417771333885667, 'auprc': 0.7415973299245191, 'loss_val': 1.2942444505159754, 'psi': 0.3817052120029477}
[S3] START round=5 head_norm_before_train=1.001043 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.029972 metrics={'f1_val': 0.412719360756824, 'auprc': 0.9982120601628924, 'loss_val': 0.7025326504125098, 'psi': 0.6469164405192513}-{'f1_val': 0.4052227667257645, 'auprc': 0.9971930703321803, 'loss_val': 0.7144403766531097, 'psi': 0.6420108881683309}
[S4] START round=5 head_norm_before_train=0.785689 cos_to_last_merge=0.9964 (last merge round=3)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.5492773939292812, 'auprc': 0.7615444681083388, 'loss_val': 1.0425501557965342, 'psi': 0.6341842236009043}-{'f1_val': 0.14022662889518414, 'auprc': 0.7684162605342428, 'loss_val': 1.17300148154125, 'psi': 0.39150248155080764}
[S5] START round=5 head_norm_before_train=1.424058 (no previous merge yet)
[S5] round=5 local utility u=0.091972 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.8547841192088553, 'loss_val': 0.7260857345762748, 'psi': 0.5925376702433596}-{'f1_val': 0.4176671856330787, 'auprc': 0.8223059681971319, 'loss_val': 0.8123577363730093, 'psi': 0.5795226986587}
[S6] START round=5 head_norm_before_train=1.218291 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6328443975257803, 'loss_val': 1.160915795342045, 'psi': 0.3379935282410813}-{'f1_val': 0.14142628205128205, 'auprc': 0.6739278505141273, 'loss_val': 1.2192923251902636, 'psi': 0.35442690943642013}
[S7] START round=5 head_norm_before_train=0.939079 cos_to_last_merge=0.9759 (last merge round=1)
[S7] round=5 local utility u=1.000000 metrics={'f1_val': 0.6813581274055237, 'auprc': 0.7670736124670166, 'loss_val': 1.1161691695805576, 'psi': 0.7156443214301209}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778070478059982, 'loss_val': 1.1899093354546233, 'psi': 0.3963569127598543}
[S8] START round=5 head_norm_before_train=0.899378 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7145884013058279, 'auprc': 0.7767958734819598, 'loss_val': 1.1400610449223376, 'psi': 0.7394713901762806}-{'f1_val': 0.13995598239295717, 'auprc': 0.7679893371643891, 'loss_val': 1.1670109941786702, 'psi': 0.39116932430153}
[S9] START round=5 head_norm_before_train=1.353432 (no previous merge yet)
[S9] round=5 local utility u=0.148616 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9994940206298708, 'loss_val': 0.39735917369227525, 'psi': 0.8207220067731116}-{'f1_val': 0.7007592215828227, 'auprc': 0.9996766834395456, 'loss_val': 0.6904508330888198, 'psi': 0.8203262063255119}
[S10] START round=5 head_norm_before_train=1.250100 (no previous merge yet)
[S10] round=5 local utility u=0.052107 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6029468455394349, 'loss_val': 1.125058074769155, 'psi': 0.3243517207408083}-{'f1_val': 0.13862163754172394, 'auprc': 0.59181272943074, 'loss_val': 1.1958707176567622, 'psi': 0.3198980742973304}
[S11] START round=5 head_norm_before_train=1.290530 (no previous merge yet)
[S11] round=5 local utility u=0.054792 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7605265375203495, 'loss_val': 1.084087802919073, 'psi': 0.3884588250320062}-{'f1_val': 0.14041368337311058, 'auprc': 0.7537868591302394, 'loss_val': 1.1734534315917355, 'psi': 0.3857629536759621}
[S13] START round=5 head_norm_before_train=0.887509 cos_to_last_merge=0.9974 (last merge round=3)
[S13] round=5 local utility u=0.004594 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.584432557600574, 'loss_val': 1.2335584096426946, 'psi': 0.31800448058646147}-{'f1_val': 0.1403857625770531, 'auprc': 0.5956918766190666, 'loss_val': 1.2765245909587752, 'psi': 0.3225082081938585}
[S14] START round=5 head_norm_before_train=0.876802 cos_to_last_merge=0.9974 (last merge round=3)
[S14] round=5 local utility u=0.816307 metrics={'f1_val': 0.4090031377037534, 'auprc': 0.6836132792440915, 'loss_val': 1.2834114019117664, 'psi': 0.5188471943198887}-{'f1_val': 0.14035785288270378, 'auprc': 0.6866614293668949, 'loss_val': 1.313298936654589, 'psi': 0.3588792834763802}
[S15] START round=5 head_norm_before_train=1.268075 (no previous merge yet)
[S15] round=5 local utility u=0.367201 metrics={'f1_val': 0.250978158053143, 'auprc': 0.7770333408367941, 'loss_val': 1.1564058181565386, 'psi': 0.46140023116660345}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765465678358312, 'loss_val': 1.2218803546258659, 'psi': 0.3944588179512675}
[S16] START round=5 head_norm_before_train=0.843636 cos_to_last_merge=0.9963 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6091000838434524, 'loss_val': 1.1952526946765014, 'psi': 0.3280225036569029}-{'f1_val': 0.14063745019920318, 'auprc': 0.7834847745405993, 'loss_val': 1.2688527551854263, 'psi': 0.39777637993576165}
[S17] START round=5 head_norm_before_train=0.844782 cos_to_last_merge=0.9964 (last merge round=3)
[S17] round=5 local utility u=0.837710 metrics={'f1_val': 0.39040226883540147, 'auprc': 0.5465221942967429, 'loss_val': 1.0169644669458688, 'psi': 0.45285023901993804}-{'f1_val': 0.14094896331738438, 'auprc': 0.5363199452157331, 'loss_val': 1.1650586096586608, 'psi': 0.2990973560767239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S10] not sending this round → trigger blocked (psi=0.324)
[S5] not sending this round → trigger blocked (psi=0.593)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:41916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.739)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:41912
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] cosine check vs S11: cos=0.7894
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=-0.1175
[S16] DROPPED delta from S9 (cos=-0.1175 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] cosine check vs S13: cos=0.6709
[S4] RECEIVED delta(kind=head bytes=1794) from S7
[S4] cosine check vs S7: cos=0.5696
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=0.6804
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.3475
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=0.5515
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=0.0196
[S17] not sending this round → trigger blocked (psi=0.453)
[S8] ⇄ pheromone p=0.571 → S3@127.0.0.1:41903
[S10] ⇄ pheromone p=0.352 → S8@127.0.0.1:41909
[S5] ⇄ pheromone p=0.504 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.382 → S17@127.0.0.1:41917
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.725013
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.433971e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.749971 delta_norm=0.343397
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.333 → S17@127.0.0.1:41917
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.4090 head_norm=0.907386
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.126650e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.2858 head_norm=0.765112 delta_norm=0.412665
[S14] aggregate: ROLLBACK (f1_val pre=0.409 post=0.286 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.574 → S11@127.0.0.1:41912
[S9] ⇄ pheromone p=0.558 → S16@127.0.0.1:41916
[S3] ⇄ pheromone p=0.528 → S17@127.0.0.1:41917
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.5493 head_norm=0.829475
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.238568e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4938 head_norm=0.800530 delta_norm=0.423857
[S4] aggregate: ROLLBACK (f1_val pre=0.549 post=0.494 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.575 → S14@127.0.0.1:41914
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.913845
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.781912e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.019739 delta_norm=0.478191
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.356 → S2@127.0.0.1:41902
[S7] ⇄ pheromone p=0.536 → S4@127.0.0.1:41904
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.314875
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.914166e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.806091 delta_norm=0.791417
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.360 → S16@127.0.0.1:41916
[S15] ⇄ pheromone p=0.435 → S13@127.0.0.1:41913
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.878895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.113412e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=1.039939 delta_norm=0.411341
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.364 → S15@127.0.0.1:41915
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3904 head_norm=0.894289
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.750453e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3921 head_norm=0.819676 delta_norm=0.575045
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.510 → S14@127.0.0.1:41914
[S2] START round=6 head_norm_before_train=0.749971 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.012684 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6157055024200004, 'loss_val': 1.1922088814168625, 'psi': 0.3313484810011402}-{'f1_val': 0.1417771333885667, 'auprc': 0.617534567927663, 'loss_val': 1.2230639432703554, 'psi': 0.3320801072042053}
[S3] START round=6 head_norm_before_train=1.097880 cos_to_last_merge=0.9897 (last merge round=4)
[S3] round=6 local utility u=0.961812 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9669114764200706, 'loss_val': 0.41322703117477705, 'psi': 0.8072183128092081}-{'f1_val': 0.412719360756824, 'auprc': 0.9982120601628924, 'loss_val': 0.7025326504125098, 'psi': 0.6469164405192513}
[S4] START round=6 head_norm_before_train=0.800530 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.437796 metrics={'f1_val': 0.6837817930425476, 'auprc': 0.7599083069383074, 'loss_val': 0.9690769313031151, 'psi': 0.7142323986008515}-{'f1_val': 0.5492773939292812, 'auprc': 0.7615444681083388, 'loss_val': 1.0425501557965342, 'psi': 0.6341842236009043}
[S5] START round=6 head_norm_before_train=1.479323 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.7009907355533597, 'auprc': 0.9803201382601009, 'loss_val': 0.5973464770244434, 'psi': 0.8127224966360562}-{'f1_val': 0.41770670426636225, 'auprc': 0.8547841192088553, 'loss_val': 0.7260857345762748, 'psi': 0.5925376702433596}
[S6] START round=6 head_norm_before_train=1.243012 (no previous merge yet)
[S6] round=6 local utility u=0.026202 metrics={'f1_val': 0.14474873857780865, 'auprc': 0.614221577891085, 'loss_val': 1.0725779773844122, 'psi': 0.3325378743031192}-{'f1_val': 0.14142628205128205, 'auprc': 0.6328443975257803, 'loss_val': 1.160915795342045, 'psi': 0.3379935282410813}
[S7] START round=6 head_norm_before_train=0.976206 cos_to_last_merge=0.9658 (last merge round=1)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.4891881503394878, 'auprc': 0.7947555371091789, 'loss_val': 0.8589823859820471, 'psi': 0.6114151050473643}-{'f1_val': 0.6813581274055237, 'auprc': 0.7670736124670166, 'loss_val': 1.1161691695805576, 'psi': 0.7156443214301209}
[S8] START round=6 head_norm_before_train=0.926933 cos_to_last_merge=0.9980 (last merge round=4)
[S8] round=6 local utility u=0.076881 metrics={'f1_val': 0.7153847848112418, 'auprc': 0.7767414008521278, 'loss_val': 0.9909131370244705, 'psi': 0.7399274312275962}-{'f1_val': 0.7145884013058279, 'auprc': 0.7767958734819598, 'loss_val': 1.1400610449223376, 'psi': 0.7394713901762806}
[S9] START round=6 head_norm_before_train=1.435481 (no previous merge yet)
[S9] round=6 local utility u=0.055004 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9983540911124946, 'loss_val': 0.28348801839561566, 'psi': 0.8202216928232009}-{'f1_val': 0.7015406642019387, 'auprc': 0.9994940206298708, 'loss_val': 0.39735917369227525, 'psi': 0.8207220067731116}
[S10] START round=6 head_norm_before_train=1.275968 (no previous merge yet)
[S10] round=6 local utility u=0.635371 metrics={'f1_val': 0.32925119507939843, 'auprc': 0.6096892402317707, 'loss_val': 1.0183202491211958, 'psi': 0.44142641314034736}-{'f1_val': 0.13862163754172394, 'auprc': 0.6029468455394349, 'loss_val': 1.125058074769155, 'psi': 0.3243517207408083}
[S11] START round=6 head_norm_before_train=0.806091 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.708107 metrics={'f1_val': 0.3641306171954809, 'auprc': 0.766496468523536, 'loss_val': 1.0280851982104573, 'psi': 0.5250769577267029}-{'f1_val': 0.14041368337311058, 'auprc': 0.7605265375203495, 'loss_val': 1.084087802919073, 'psi': 0.3884588250320062}
[S13] START round=6 head_norm_before_train=1.019739 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.038671 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6047306667783461, 'loss_val': 1.217111262927059, 'psi': 0.3261237242575703}-{'f1_val': 0.1403857625770531, 'auprc': 0.584432557600574, 'loss_val': 1.2335584096426946, 'psi': 0.31800448058646147}
[S14] START round=6 head_norm_before_train=0.765112 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.196724 metrics={'f1_val': 0.39539882785617403, 'auprc': 0.8415259855306307, 'loss_val': 1.2820750546851438, 'psi': 0.5738496909259567}-{'f1_val': 0.4090031377037534, 'auprc': 0.6836132792440915, 'loss_val': 1.2834114019117664, 'psi': 0.5188471943198887}
[S15] START round=6 head_norm_before_train=1.304590 (no previous merge yet)
[S15] round=6 local utility u=0.554644 metrics={'f1_val': 0.416839147538149, 'auprc': 0.7770378584775024, 'loss_val': 1.0422965449947699, 'psi': 0.5609186319138904}-{'f1_val': 0.250978158053143, 'auprc': 0.7770333408367941, 'loss_val': 1.1564058181565386, 'psi': 0.46140023116660345}
[S16] START round=6 head_norm_before_train=1.039939 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.846985 metrics={'f1_val': 0.41428462841297564, 'auprc': 0.6036144184536765, 'loss_val': 1.1267083916670788, 'psi': 0.490016544429256}-{'f1_val': 0.14063745019920318, 'auprc': 0.6091000838434524, 'loss_val': 1.1952526946765014, 'psi': 0.3280225036569029}
[S17] START round=6 head_norm_before_train=0.819676 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.39133359314215593, 'auprc': 0.5384749977429273, 'loss_val': 1.0304846805454522, 'psi': 0.4501901549824645}-{'f1_val': 0.39040226883540147, 'auprc': 0.5465221942967429, 'loss_val': 1.0169644669458688, 'psi': 0.45285023901993804}
[S11] not sending this round → trigger blocked (psi=0.525)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.326)
[S3] not sending this round → trigger blocked (psi=0.807)
[S14] not sending this round → trigger blocked (psi=0.574)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S15] not sending this round → trigger blocked (psi=0.561)
[S4] not sending this round → trigger blocked (psi=0.714)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S10
[S8] cosine check vs S10: cos=0.6780
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.1504
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.3883
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.1305
[S16] DROPPED delta from S5 (cos=-0.1305 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=-0.0520
[S17] DROPPED delta from S6 (cos=-0.0520 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S16
[S15] cosine check vs S16: cos=-0.0793
[S15] DROPPED delta from S16 (cos=-0.0793 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.7008 head_norm=1.202992
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.079488e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.7008 head_norm=0.906191 delta_norm=0.607949
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7154 head_norm=0.966631
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.808034e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.7147 head_norm=1.041767 delta_norm=0.480803
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3913 head_norm=0.861782
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.341397e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3917 head_norm=0.621007 delta_norm=0.534140
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.774108 cos_to_last_merge=0.9941 (last merge round=5)
[S2] round=7 local utility u=1.000000 metrics={'f1_val': 0.41575185999233655, 'auprc': 0.7768927014879141, 'loss_val': 1.093192741892139, 'psi': 0.5602081965905676}-{'f1_val': 0.1417771333885667, 'auprc': 0.6157055024200004, 'loss_val': 1.1922088814168625, 'psi': 0.3313484810011402}
[S3] START round=7 head_norm_before_train=0.906191 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.026448 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9980771042270171, 'loss_val': 0.4538273628664597, 'psi': 0.8196845639319866}-{'f1_val': 0.7007562037352997, 'auprc': 0.9669114764200706, 'loss_val': 0.41322703117477705, 'psi': 0.8072183128092081}
[S4] START round=7 head_norm_before_train=0.840784 cos_to_last_merge=0.9942 (last merge round=5)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.37456709949010636, 'auprc': 0.7585131514795125, 'loss_val': 0.8508013423627295, 'psi': 0.5281455202858688}-{'f1_val': 0.6837817930425476, 'auprc': 0.7599083069383074, 'loss_val': 0.9690769313031151, 'psi': 0.7142323986008515}
[S5] START round=7 head_norm_before_train=1.527176 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.8653111619914478, 'loss_val': 0.4967763652866083, 'psi': 0.7667631221552533}-{'f1_val': 0.7009907355533597, 'auprc': 0.9803201382601009, 'loss_val': 0.5973464770244434, 'psi': 0.8127224966360562}
[S6] START round=7 head_norm_before_train=1.276860 (no previous merge yet)
[S6] round=7 local utility u=1.000000 metrics={'f1_val': 0.38784274535930297, 'auprc': 0.7705903183616117, 'loss_val': 0.882255688282625, 'psi': 0.5409417745602265}-{'f1_val': 0.14474873857780865, 'auprc': 0.614221577891085, 'loss_val': 1.0725779773844122, 'psi': 0.3325378743031192}
[S7] START round=7 head_norm_before_train=1.035424 cos_to_last_merge=0.9485 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=7 local utility u=0.764750 metrics={'f1_val': 0.714165268727642, 'auprc': 0.7923706555251463, 'loss_val': 0.6721911333226568, 'psi': 0.7454474234466437}-{'f1_val': 0.4891881503394878, 'auprc': 0.7947555371091789, 'loss_val': 0.8589823859820471, 'psi': 0.6114151050473643}
[S8] START round=7 head_norm_before_train=1.041767 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.7766696577688832, 'loss_val': 0.9273890738164782, 'psi': 0.5343468920852853}-{'f1_val': 0.7153847848112418, 'auprc': 0.7767414008521278, 'loss_val': 0.9909131370244705, 'psi': 0.7399274312275962}
[S9] START round=7 head_norm_before_train=1.509438 (no previous merge yet)
[S9] round=7 local utility u=0.033352 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982022179781764, 'loss_val': 0.21632823547481847, 'psi': 0.8201609435694737}-{'f1_val': 0.7014667606303384, 'auprc': 0.9983540911124946, 'loss_val': 0.28348801839561566, 'psi': 0.8202216928232009}
[S10] START round=7 head_norm_before_train=1.303274 (no previous merge yet)
[S10] round=7 local utility u=0.451286 metrics={'f1_val': 0.4375689892415177, 'auprc': 0.6409920045277119, 'loss_val': 0.8595633546266247, 'psi': 0.5189381953559954}-{'f1_val': 0.32925119507939843, 'auprc': 0.6096892402317707, 'loss_val': 1.0183202491211958, 'psi': 0.44142641314034736}
[S11] START round=7 head_norm_before_train=0.846238 cos_to_last_merge=0.9968 (last merge round=5)
[S11] round=7 local utility u=0.358334 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.8985261860681254, 'loss_val': 0.9024424812334455, 'psi': 0.5973824207594458}-{'f1_val': 0.3641306171954809, 'auprc': 0.766496468523536, 'loss_val': 1.0280851982104573, 'psi': 0.5250769577267029}
[S13] START round=7 head_norm_before_train=1.030990 cos_to_last_merge=0.9985 (last merge round=5)
[S13] round=7 local utility u=0.998324 metrics={'f1_val': 0.405714477436557, 'auprc': 0.7218627672116404, 'loss_val': 1.1638318794793503, 'psi': 0.5321737933465904}-{'f1_val': 0.1403857625770531, 'auprc': 0.6047306667783461, 'loss_val': 1.217111262927059, 'psi': 0.3261237242575703}
[S14] START round=7 head_norm_before_train=0.786838 cos_to_last_merge=0.9963 (last merge round=5)
[S14] round=7 local utility u=0.093953 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.8803244620838278, 'loss_val': 1.2167478000729905, 'psi': 0.5899873622640437}-{'f1_val': 0.39539882785617403, 'auprc': 0.8415259855306307, 'loss_val': 1.2820750546851438, 'psi': 0.5738496909259567}
[S15] START round=7 head_norm_before_train=1.333498 (no previous merge yet)
[S15] round=7 local utility u=0.106453 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7970950017393217, 'loss_val': 0.8902317164779733, 'psi': 0.5690085054552598}-{'f1_val': 0.416839147538149, 'auprc': 0.7770378584775024, 'loss_val': 1.0422965449947699, 'psi': 0.5609186319138904}
[S16] START round=7 head_norm_before_train=1.065468 cos_to_last_merge=0.9970 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.5447951688759223, 'loss_val': 1.02919224957136, 'psi': 0.4682130964195423}-{'f1_val': 0.41428462841297564, 'auprc': 0.6036144184536765, 'loss_val': 1.1267083916670788, 'psi': 0.490016544429256}
[S17] START round=7 head_norm_before_train=0.621007 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35515126763417165, 'auprc': 0.6095832815026777, 'loss_val': 1.051676465017549, 'psi': 0.45692407318157413}-{'f1_val': 0.39133359314215593, 'auprc': 0.5384749977429273, 'loss_val': 1.0304846805454522, 'psi': 0.4501901549824645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S6] not sending this round → trigger blocked (psi=0.541)
[S10] not sending this round → trigger blocked (psi=0.519)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:41902
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S2] not sending this round → trigger blocked (psi=0.560)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:41917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1789) from S13
[S2] cosine check vs S13: cos=0.7037
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] cosine check vs S7: cos=0.8113
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] cosine check vs S11: cos=0.7950
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=-0.1071
[S16] DROPPED delta from S9 (cos=-0.1071 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S3
[S17] cosine check vs S3: cos=0.4923
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9118
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.5345
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4158 head_norm=0.806692
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.741707e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1673 head_norm=0.857556 delta_norm=0.374171
[S2] aggregate: ROLLBACK (f1_val pre=0.416 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3746 head_norm=0.890957
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.213501e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.3768 head_norm=0.947570 delta_norm=0.321350
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3966 head_norm=0.895959
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.157141e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.752760 delta_norm=0.415714
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4057 head_norm=1.048838
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.960207e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.1668 head_norm=1.179246 delta_norm=0.296021
[S13] aggregate: ROLLBACK (f1_val pre=0.406 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=1.094584
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.322712e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4172 head_norm=0.943411 delta_norm=0.332271
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3552 head_norm=0.672236
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.426592e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3630 head_norm=0.724779 delta_norm=0.442659
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.857556 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.2723561768955296, 'auprc': 0.7766231127613433, 'loss_val': 1.0203249067041975, 'psi': 0.4740629512418551}-{'f1_val': 0.41575185999233655, 'auprc': 0.7768927014879141, 'loss_val': 1.093192741892139, 'psi': 0.5602081965905676}
[S3] START round=8 head_norm_before_train=0.995290 cos_to_last_merge=0.9858 (last merge round=6)
[S3] round=8 local utility u=0.046573 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9984198661310064, 'loss_val': 0.3621638331923289, 'psi': 0.8198669874676889}-{'f1_val': 0.7007562037352997, 'auprc': 0.9980771042270171, 'loss_val': 0.4538273628664597, 'psi': 0.8196845639319866}
[S4] START round=8 head_norm_before_train=0.947570 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.302729 metrics={'f1_val': 0.3743579146509102, 'auprc': 0.956446276581659, 'loss_val': 0.8378881260922796, 'psi': 0.6071932594232097}-{'f1_val': 0.37456709949010636, 'auprc': 0.7585131514795125, 'loss_val': 0.8508013423627295, 'psi': 0.5281455202858688}
[S5] START round=8 head_norm_before_train=1.576518 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.8437213301655415, 'loss_val': 0.44533787859529483, 'psi': 0.7581510030610312}-{'f1_val': 0.7010644289311239, 'auprc': 0.8653111619914478, 'loss_val': 0.4967763652866083, 'psi': 0.7667631221552533}
[S6] START round=8 head_norm_before_train=1.303104 (no previous merge yet)
[S6] round=8 local utility u=0.736622 metrics={'f1_val': 0.6127364662667706, 'auprc': 0.7745956203719548, 'loss_val': 0.7703899773194773, 'psi': 0.6774801279088443}-{'f1_val': 0.38784274535930297, 'auprc': 0.7705903183616117, 'loss_val': 0.882255688282625, 'psi': 0.5409417745602265}
[S7] START round=8 head_norm_before_train=1.099321 cos_to_last_merge=0.9272 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=8 local utility u=0.263027 metrics={'f1_val': 0.699222780368751, 'auprc': 0.9484956847885633, 'loss_val': 0.5248575524544852, 'psi': 0.7989319421366758}-{'f1_val': 0.714165268727642, 'auprc': 0.7923706555251463, 'loss_val': 0.6721911333226568, 'psi': 0.7454474234466437}
[S8] START round=8 head_norm_before_train=1.072392 cos_to_last_merge=0.9971 (last merge round=6)
[S8] round=8 local utility u=0.054067 metrics={'f1_val': 0.37326602477360504, 'auprc': 0.7661640843220165, 'loss_val': 0.7905444005142804, 'psi': 0.5304252485929697}-{'f1_val': 0.3727983816295533, 'auprc': 0.7766696577688832, 'loss_val': 0.9273890738164782, 'psi': 0.5343468920852853}
[S9] START round=8 head_norm_before_train=1.572831 (no previous merge yet)
[S9] round=8 local utility u=0.860378 metrics={'f1_val': 0.9835316649822613, 'auprc': 0.9980765782713755, 'loss_val': 0.18758446631682776, 'psi': 0.989349630297907}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982022179781764, 'loss_val': 0.21632823547481847, 'psi': 0.8201609435694737}
[S10] START round=8 head_norm_before_train=1.340511 (no previous merge yet)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.6814276487998782, 'auprc': 0.7930523278319509, 'loss_val': 0.7551445721792882, 'psi': 0.7260775204127072}-{'f1_val': 0.4375689892415177, 'auprc': 0.6409920045277119, 'loss_val': 0.8595633546266247, 'psi': 0.5189381953559954}
[S11] START round=8 head_norm_before_train=0.752760 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.128401 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.9760822291708573, 'loss_val': 0.878104421622923, 'psi': 0.6283845044385566}-{'f1_val': 0.3966199105536595, 'auprc': 0.8985261860681254, 'loss_val': 0.9024424812334455, 'psi': 0.5973824207594458}
[S13] START round=8 head_norm_before_train=1.179246 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4161574336314925, 'auprc': 0.636781572382808, 'loss_val': 1.034456481947736, 'psi': 0.5044070891320187}-{'f1_val': 0.405714477436557, 'auprc': 0.7218627672116404, 'loss_val': 1.1638318794793503, 'psi': 0.5321737933465904}
[S14] START round=8 head_norm_before_train=0.822307 cos_to_last_merge=0.9846 (last merge round=5)
[S14] round=8 local utility u=0.270232 metrics={'f1_val': 0.41102184566688293, 'auprc': 0.9925156724480328, 'loss_val': 1.1004122828167917, 'psi': 0.643619376379343}-{'f1_val': 0.3964292957175209, 'auprc': 0.8803244620838278, 'loss_val': 1.2167478000729905, 'psi': 0.5899873622640437}
[S15] START round=8 head_norm_before_train=1.362512 (no previous merge yet)
[S15] round=8 local utility u=0.360744 metrics={'f1_val': 0.42021016680689977, 'auprc': 0.9810686296714158, 'loss_val': 0.7402196801305309, 'psi': 0.6445535519527061}-{'f1_val': 0.4169508412658852, 'auprc': 0.7970950017393217, 'loss_val': 0.8902317164779733, 'psi': 0.5690085054552598}
[S16] START round=8 head_norm_before_train=0.943411 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.296767 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.7230132034027664, 'loss_val': 0.9691438745477926, 'psi': 0.5393835149794406}-{'f1_val': 0.4171583814486223, 'auprc': 0.5447951688759223, 'loss_val': 1.02919224957136, 'psi': 0.4682130964195423}
[S17] START round=8 head_norm_before_train=0.724779 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.162534 metrics={'f1_val': 0.35258071314995765, 'auprc': 0.7056183453913563, 'loss_val': 0.9992910939238077, 'psi': 0.4937957660465171}-{'f1_val': 0.35515126763417165, 'auprc': 0.6095832815026777, 'loss_val': 1.051676465017549, 'psi': 0.45692407318157413}
[S9] not sending this round → trigger blocked (psi=0.989)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:41915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.799)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S15] not sending this round → trigger blocked (psi=0.645)
[S14] not sending this round → trigger blocked (psi=0.644)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.628)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.4903
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=-0.0899
[S15] DROPPED delta from S16 (cos=-0.0899 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.0457
[S17] DROPPED delta from S6 (cos=-0.0457 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.4805
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.8957
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=-0.0232
[S14] DROPPED delta from S17 (cos=-0.0232 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7008 head_norm=1.096080
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.623513e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7008 head_norm=0.949242 delta_norm=0.562351
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.4110 head_norm=0.861049
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.701330e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3965 head_norm=0.799048 delta_norm=0.470133
[S14] aggregate: ROLLBACK (f1_val pre=0.411 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3733 head_norm=1.110498
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.137071e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3879 head_norm=1.213611 delta_norm=0.313707
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.888021 cos_to_last_merge=0.9948 (last merge round=7)
[S2] round=9 local utility u=1.000000 metrics={'f1_val': 0.6999784153340454, 'auprc': 0.6745664190108921, 'loss_val': 0.8585806068271155, 'psi': 0.6898136168047841}-{'f1_val': 0.2723561768955296, 'auprc': 0.7766231127613433, 'loss_val': 1.0203249067041975, 'psi': 0.4740629512418551}
[S3] START round=9 head_norm_before_train=0.949242 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9993403899685418, 'loss_val': 0.4278021920886877, 'psi': 0.8202351970027031}-{'f1_val': 0.7008317350254774, 'auprc': 0.9984198661310064, 'loss_val': 0.3621638331923289, 'psi': 0.8198669874676889}
[S4] START round=9 head_norm_before_train=0.988736 cos_to_last_merge=0.9945 (last merge round=7)
[S4] round=9 local utility u=0.013057 metrics={'f1_val': 0.37329943206976823, 'auprc': 0.9491152554989446, 'loss_val': 0.7834308032353673, 'psi': 0.6036257614414388}-{'f1_val': 0.3743579146509102, 'auprc': 0.956446276581659, 'loss_val': 0.8378881260922796, 'psi': 0.6071932594232097}
[S5] START round=9 head_norm_before_train=1.617662 (no previous merge yet)
[S5] round=9 local utility u=0.268524 metrics={'f1_val': 0.7011053602517017, 'auprc': 0.9892083877549268, 'loss_val': 0.3447593792214581, 'psi': 0.8163465712529917}-{'f1_val': 0.7011041183246911, 'auprc': 0.8437213301655415, 'loss_val': 0.44533787859529483, 'psi': 0.7581510030610312}
[S6] START round=9 head_norm_before_train=1.338718 (no previous merge yet)
[S6] round=9 local utility u=0.346744 metrics={'f1_val': 0.6768242569498903, 'auprc': 0.8243043854009582, 'loss_val': 0.6105555673201201, 'psi': 0.7358163083303175}-{'f1_val': 0.6127364662667706, 'auprc': 0.7745956203719548, 'loss_val': 0.7703899773194773, 'psi': 0.6774801279088443}
[S7] START round=9 head_norm_before_train=1.161002 cos_to_last_merge=0.9067 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.43095347994980093, 'auprc': 0.7649851420043974, 'loss_val': 0.9116819358773883, 'psi': 0.5645661447716395}-{'f1_val': 0.699222780368751, 'auprc': 0.9484956847885633, 'loss_val': 0.5248575524544852, 'psi': 0.7989319421366758}
[S8] START round=9 head_norm_before_train=1.213611 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.364362 metrics={'f1_val': 0.37306554171580314, 'auprc': 0.9910673048853096, 'loss_val': 0.7353264572407464, 'psi': 0.6202662469836058}-{'f1_val': 0.37326602477360504, 'auprc': 0.7661640843220165, 'loss_val': 0.7905444005142804, 'psi': 0.5304252485929697}
[S9] START round=9 head_norm_before_train=1.622237 (no previous merge yet)
[S9] round=9 local utility u=0.026841 metrics={'f1_val': 0.9826668589742594, 'auprc': 0.9988415986259961, 'loss_val': 0.1310087678130634, 'psi': 0.9891367548349541}-{'f1_val': 0.9835316649822613, 'auprc': 0.9980765782713755, 'loss_val': 0.18758446631682776, 'psi': 0.989349630297907}
[S10] START round=9 head_norm_before_train=1.381782 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.43821334028035436, 'auprc': 0.62911980241895, 'loss_val': 0.7468738282980287, 'psi': 0.5145759251357926}-{'f1_val': 0.6814276487998782, 'auprc': 0.7930523278319509, 'loss_val': 0.7551445721792882, 'psi': 0.7260775204127072}
[S11] START round=9 head_norm_before_train=0.800502 cos_to_last_merge=0.9930 (last merge round=7)
[S11] round=9 local utility u=0.439327 metrics={'f1_val': 0.5395757967492794, 'auprc': 0.943315719810272, 'loss_val': 0.7590904183558935, 'psi': 0.7010717659736765}-{'f1_val': 0.39658602128368947, 'auprc': 0.9760822291708573, 'loss_val': 0.878104421622923, 'psi': 0.6283845044385566}
[S13] START round=9 head_norm_before_train=1.199497 cos_to_last_merge=0.9981 (last merge round=7)
[S13] round=9 local utility u=0.110766 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.7671933918956947, 'loss_val': 0.9373566505779595, 'psi': 0.5298915335638917}-{'f1_val': 0.4161574336314925, 'auprc': 0.636781572382808, 'loss_val': 1.034456481947736, 'psi': 0.5044070891320187}
[S14] START round=9 head_norm_before_train=0.799048 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.916182 metrics={'f1_val': 0.7003671847086623, 'auprc': 0.9978776847416233, 'loss_val': 1.0202064962975579, 'psi': 0.8193713847218467}-{'f1_val': 0.41102184566688293, 'auprc': 0.9925156724480328, 'loss_val': 1.1004122828167917, 'psi': 0.643619376379343}
[S15] START round=9 head_norm_before_train=1.397927 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.5647859311697311, 'auprc': 0.6716007879530488, 'loss_val': 0.7018986364167072, 'psi': 0.6075118738830582}-{'f1_val': 0.42021016680689977, 'auprc': 0.9810686296714158, 'loss_val': 0.7402196801305309, 'psi': 0.6445535519527061}
[S16] START round=9 head_norm_before_train=0.973057 cos_to_last_merge=0.9960 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3321423591593603, 'auprc': 0.7390023520391703, 'loss_val': 0.9597797084862263, 'psi': 0.4948863563112843}-{'f1_val': 0.41696372269722326, 'auprc': 0.7230132034027664, 'loss_val': 0.9691438745477926, 'psi': 0.5393835149794406}
[S17] START round=9 head_norm_before_train=0.768743 cos_to_last_merge=0.9875 (last merge round=7)
[S17] round=9 local utility u=0.003387 metrics={'f1_val': 0.35216234429098303, 'auprc': 0.6846145954656626, 'loss_val': 0.9269958035490019, 'psi': 0.4851432447608549}-{'f1_val': 0.35258071314995765, 'auprc': 0.7056183453913563, 'loss_val': 0.9992910939238077, 'psi': 0.4937957660465171}
[S6] not sending this round → trigger blocked (psi=0.736)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.620)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.604)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.6792
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.8280
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=-0.1100
[S16] DROPPED delta from S9 (cos=-0.1100 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.7567
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.1095
[S16] DROPPED delta from S5 (cos=-0.1095 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.2769
[S17] not sending this round → trigger blocked (psi=0.485)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5396 head_norm=0.860670
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.393493e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.5571 head_norm=0.775897 delta_norm=0.339349
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7000 head_norm=0.930541
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.465559e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4012 head_norm=1.032170 delta_norm=0.346556
[S2] aggregate: ROLLBACK (f1_val pre=0.700 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3321 head_norm=1.014655
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.348754e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3251 head_norm=0.879203 delta_norm=0.334875
[S16] aggregate: ROLLBACK (f1_val pre=0.332 post=0.325 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3522 head_norm=0.826128
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.297788e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3520 head_norm=0.702518 delta_norm=0.529779
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.032170 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.4015556040645226, 'auprc': 0.7674310170595219, 'loss_val': 0.790738718668343, 'psi': 0.5479057692625223}-{'f1_val': 0.6999784153340454, 'auprc': 0.6745664190108921, 'loss_val': 0.8585806068271155, 'psi': 0.6898136168047841}
[S3] START round=10 head_norm_before_train=1.033921 cos_to_last_merge=0.9860 (last merge round=8)
[S3] round=10 local utility u=0.042910 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.999105974352483, 'loss_val': 0.3412791067147106, 'psi': 0.8201414307562797}-{'f1_val': 0.7008317350254774, 'auprc': 0.9993403899685418, 'loss_val': 0.4278021920886877, 'psi': 0.8202351970027031}
[S4] START round=10 head_norm_before_train=1.039641 cos_to_last_merge=0.9819 (last merge round=7)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.3733925203319622, 'auprc': 0.7496184168472644, 'loss_val': 0.7707264587543319, 'psi': 0.523882878938083}-{'f1_val': 0.37329943206976823, 'auprc': 0.9491152554989446, 'loss_val': 0.7834308032353673, 'psi': 0.6036257614414388}
[S5] START round=10 head_norm_before_train=1.652616 (no previous merge yet)
[S5] round=10 local utility u=0.021561 metrics={'f1_val': 0.7008577120890963, 'auprc': 0.9896859007692301, 'loss_val': 0.301584129401028, 'psi': 0.8163889875611499}-{'f1_val': 0.7011053602517017, 'auprc': 0.9892083877549268, 'loss_val': 0.3447593792214581, 'psi': 0.8163465712529917}
[S6] START round=10 head_norm_before_train=1.375044 (no previous merge yet)
[S6] round=10 local utility u=0.097212 metrics={'f1_val': 0.7108897039194687, 'auprc': 0.7973881693747473, 'loss_val': 0.5397748244687628, 'psi': 0.7454890901015802}-{'f1_val': 0.6768242569498903, 'auprc': 0.8243043854009582, 'loss_val': 0.6105555673201201, 'psi': 0.7358163083303175}
[S7] START round=10 head_norm_before_train=1.215302 cos_to_last_merge=0.8886 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.889
[S7] round=10 local utility u=0.815289 metrics={'f1_val': 0.6328956145370848, 'auprc': 0.7984372315149111, 'loss_val': 0.5931132213690372, 'psi': 0.6991122613282152}-{'f1_val': 0.43095347994980093, 'auprc': 0.7649851420043974, 'loss_val': 0.9116819358773883, 'psi': 0.5645661447716395}
[S8] START round=10 head_norm_before_train=1.244152 cos_to_last_merge=0.9978 (last merge round=8)
[S8] round=10 local utility u=0.037313 metrics={'f1_val': 0.37273099922839503, 'auprc': 0.9919936333006756, 'loss_val': 0.661471926065695, 'psi': 0.6204360528573073}-{'f1_val': 0.37306554171580314, 'auprc': 0.9910673048853096, 'loss_val': 0.7353264572407464, 'psi': 0.6202662469836058}
[S9] START round=10 head_norm_before_train=1.662917 (no previous merge yet)
[S9] round=10 local utility u=0.026595 metrics={'f1_val': 0.986572608707039, 'auprc': 0.9995962029895363, 'loss_val': 0.10351781192111213, 'psi': 0.991782046420038}-{'f1_val': 0.9826668589742594, 'auprc': 0.9988415986259961, 'loss_val': 0.1310087678130634, 'psi': 0.9891367548349541}
[S10] START round=10 head_norm_before_train=1.426143 (no previous merge yet)
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.7020467373232882, 'auprc': 0.7737910578924185, 'loss_val': 0.6029515636451256, 'psi': 0.7307444655509403}-{'f1_val': 0.43821334028035436, 'auprc': 0.62911980241895, 'loss_val': 0.7468738282980287, 'psi': 0.5145759251357926}
[S11] START round=10 head_norm_before_train=0.775897 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.053830 metrics={'f1_val': 0.557742271124714, 'auprc': 0.9406195482876001, 'loss_val': 0.7523404844700291, 'psi': 0.7108931819898684}-{'f1_val': 0.5395757967492794, 'auprc': 0.943315719810272, 'loss_val': 0.7590904183558935, 'psi': 0.7010717659736765}
[S13] START round=10 head_norm_before_train=1.226802 cos_to_last_merge=0.9934 (last merge round=7)
[S13] round=10 local utility u=0.029757 metrics={'f1_val': 0.37448140482108117, 'auprc': 0.7456646654521643, 'loss_val': 0.8300027620054715, 'psi': 0.5229547090735144}-{'f1_val': 0.37169029467602305, 'auprc': 0.7671933918956947, 'loss_val': 0.9373566505779595, 'psi': 0.5298915335638917}
[S14] START round=10 head_norm_before_train=0.832823 cos_to_last_merge=0.9960 (last merge round=8)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.584967170047562, 'auprc': 0.9977289244002537, 'loss_val': 0.8064488329249179, 'psi': 0.7500718717886388}-{'f1_val': 0.7003671847086623, 'auprc': 0.9978776847416233, 'loss_val': 1.0202064962975579, 'psi': 0.8193713847218467}
[S15] START round=10 head_norm_before_train=1.438613 (no previous merge yet)
[S15] round=10 local utility u=0.798821 metrics={'f1_val': 0.6832255901665327, 'auprc': 0.9287674052713204, 'loss_val': 0.5863936697809798, 'psi': 0.7814423162084478}-{'f1_val': 0.5647859311697311, 'auprc': 0.6716007879530488, 'loss_val': 0.7018986364167072, 'psi': 0.6075118738830582}
[S16] START round=10 head_norm_before_train=0.879203 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.313210 metrics={'f1_val': 0.43655935897653964, 'auprc': 0.7330132334526973, 'loss_val': 0.9418944019987354, 'psi': 0.5551409087670027}-{'f1_val': 0.3321423591593603, 'auprc': 0.7390023520391703, 'loss_val': 0.9597797084862263, 'psi': 0.4948863563112843}
[S17] START round=10 head_norm_before_train=0.702518 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.006401 metrics={'f1_val': 0.35243828617822603, 'auprc': 0.7036875212840937, 'loss_val': 0.9730675422166708, 'psi': 0.4929379802205731}-{'f1_val': 0.35216234429098303, 'auprc': 0.6846145954656626, 'loss_val': 0.9269958035490019, 'psi': 0.4851432447608549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[S13] not sending this round → trigger blocked (psi=0.523)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.711)
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.8498
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] cosine check vs S16: cos=-0.0928
[S15] DROPPED delta from S16 (cos=-0.0928 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.0625
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] cosine check vs S3: cos=0.4092
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9386
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9486
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.6580
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=-0.0038
[S14] DROPPED delta from S17 (cos=-0.0038 < 0.0)
[S5] ⇄ pheromone p=0.294 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=0.311 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=0.395 → S11@127.0.0.1:41912
[S2] ⇄ pheromone p=0.373 → S17@127.0.0.1:41917
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3745 head_norm=1.261593
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.629599e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3751 head_norm=1.349391 delta_norm=0.262960
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.246 → S2@127.0.0.1:41902
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.3734 head_norm=1.090485
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.313725e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3732 head_norm=1.128814 delta_norm=0.331372
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.265 → S14@127.0.0.1:41914
[S11] ⇄ pheromone p=0.310 → S16@127.0.0.1:41916
[S7] ⇄ pheromone p=0.451 → S4@127.0.0.1:41904
[S10] ⇄ pheromone p=0.541 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=0.405 → S13@127.0.0.1:41913
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3727 head_norm=1.282046
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.385183e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3750 head_norm=1.356949 delta_norm=0.238518
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.266 → S3@127.0.0.1:41903
[S6] ⇄ pheromone p=0.399 → S17@127.0.0.1:41917
[S16] ⇄ pheromone p=0.289 → S15@127.0.0.1:41915
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7008 head_norm=1.121715
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.023017e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7008 head_norm=1.094823 delta_norm=0.502302
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.269 → S17@127.0.0.1:41917
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3524 head_norm=0.750975
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.810810e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3517 head_norm=0.661025 delta_norm=0.481081
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.190 → S14@127.0.0.1:41914
[S2] START round=11 head_norm_before_train=1.065507 cos_to_last_merge=0.9958 (last merge round=9)
[S2] round=11 local utility u=0.066719 metrics={'f1_val': 0.40162034367431665, 'auprc': 0.7757432467273462, 'loss_val': 0.6826258623599711, 'psi': 0.5512695048955285}-{'f1_val': 0.4015556040645226, 'auprc': 0.7674310170595219, 'loss_val': 0.790738718668343, 'psi': 0.5479057692625223}
[S3] START round=11 head_norm_before_train=1.094823 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988049211412902, 'loss_val': 0.41020222090907194, 'psi': 0.819930544255717}-{'f1_val': 0.7008317350254774, 'auprc': 0.999105974352483, 'loss_val': 0.3412791067147106, 'psi': 0.8201414307562797}
[S4] START round=11 head_norm_before_train=1.128814 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.147726 metrics={'f1_val': 0.37479244499500536, 'auprc': 0.8530495964445447, 'loss_val': 0.7939677655011685, 'psi': 0.5660953055748211}-{'f1_val': 0.3733925203319622, 'auprc': 0.7496184168472644, 'loss_val': 0.7707264587543319, 'psi': 0.523882878938083}
[S5] START round=11 head_norm_before_train=1.685663 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.6562690348027667, 'auprc': 0.8539017768502752, 'loss_val': 0.4121806758182521, 'psi': 0.7353221316217702}-{'f1_val': 0.7008577120890963, 'auprc': 0.9896859007692301, 'loss_val': 0.301584129401028, 'psi': 0.8163889875611499}
[S6] START round=11 head_norm_before_train=1.412024 (no previous merge yet)
[S6] round=11 local utility u=0.294208 metrics={'f1_val': 0.7090667836064852, 'auprc': 0.9655969023084645, 'loss_val': 0.4450465878260126, 'psi': 0.8116788310872769}-{'f1_val': 0.7108897039194687, 'auprc': 0.7973881693747473, 'loss_val': 0.5397748244687628, 'psi': 0.7454890901015802}
[S7] START round=11 head_norm_before_train=1.256543 cos_to_last_merge=0.8751 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=11 local utility u=0.086175 metrics={'f1_val': 0.6467314826710748, 'auprc': 0.8069937821762116, 'loss_val': 0.5294470854472093, 'psi': 0.7108364024731295}-{'f1_val': 0.6328956145370848, 'auprc': 0.7984372315149111, 'loss_val': 0.5931132213690372, 'psi': 0.6991122613282152}
[S8] START round=11 head_norm_before_train=1.356949 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.868972 metrics={'f1_val': 0.6481348490321563, 'auprc': 0.9907545899926621, 'loss_val': 0.5722339956377027, 'psi': 0.7851827454163587}-{'f1_val': 0.37273099922839503, 'auprc': 0.9919936333006756, 'loss_val': 0.661471926065695, 'psi': 0.6204360528573073}
[S9] START round=11 head_norm_before_train=1.704593 (no previous merge yet)
[S9] round=11 local utility u=0.029555 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9995880091590275, 'loss_val': 0.06988104195741379, 'psi': 0.9943285049752772}-{'f1_val': 0.986572608707039, 'auprc': 0.9995962029895363, 'loss_val': 0.10351781192111213, 'psi': 0.991782046420038}
[S10] START round=11 head_norm_before_train=1.467229 (no previous merge yet)
[S10] round=11 local utility u=0.092452 metrics={'f1_val': 0.7015067223794076, 'auprc': 0.7944851658748034, 'loss_val': 0.4768902481804035, 'psi': 0.738698099777566}-{'f1_val': 0.7020467373232882, 'auprc': 0.7737910578924185, 'loss_val': 0.6029515636451256, 'psi': 0.7307444655509403}
[S11] START round=11 head_norm_before_train=0.829796 cos_to_last_merge=0.9927 (last merge round=9)
[S11] round=11 local utility u=0.479830 metrics={'f1_val': 0.6943781541956171, 'auprc': 0.9381982254953757, 'loss_val': 0.6052323848904968, 'psi': 0.7919061827155205}-{'f1_val': 0.557742271124714, 'auprc': 0.9406195482876001, 'loss_val': 0.7523404844700291, 'psi': 0.7108931819898684}
[S13] START round=11 head_norm_before_train=1.349391 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.199042 metrics={'f1_val': 0.4808944576049326, 'auprc': 0.6523153086282079, 'loss_val': 0.7903489022098583, 'psi': 0.5494627980142427}-{'f1_val': 0.37448140482108117, 'auprc': 0.7456646654521643, 'loss_val': 0.8300027620054715, 'psi': 0.5229547090735144}
[S14] START round=11 head_norm_before_train=0.882552 cos_to_last_merge=0.9839 (last merge round=8)
[S14] round=11 local utility u=0.436168 metrics={'f1_val': 0.7006359803930868, 'auprc': 0.9969209981180788, 'loss_val': 0.6257019754960957, 'psi': 0.8191499874830837}-{'f1_val': 0.584967170047562, 'auprc': 0.9977289244002537, 'loss_val': 0.8064488329249179, 'psi': 0.7500718717886388}
[S15] START round=11 head_norm_before_train=1.479322 (no previous merge yet)
[S15] round=11 local utility u=0.111701 metrics={'f1_val': 0.6920862555261497, 'auprc': 0.9421447832854349, 'loss_val': 0.45628711814256717, 'psi': 0.7921096666298638}-{'f1_val': 0.6832255901665327, 'auprc': 0.9287674052713204, 'loss_val': 0.5863936697809798, 'psi': 0.7814423162084478}
[S16] START round=11 head_norm_before_train=0.919690 cos_to_last_merge=0.9961 (last merge round=9)
[S16] round=11 local utility u=0.307333 metrics={'f1_val': 0.5347891229264135, 'auprc': 0.7599552513515062, 'loss_val': 0.9974321152069742, 'psi': 0.6248555742964506}-{'f1_val': 0.43655935897653964, 'auprc': 0.7330132334526973, 'loss_val': 0.9418944019987354, 'psi': 0.5551409087670027}
[S17] START round=11 head_norm_before_train=0.661025 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3523417439997866, 'auprc': 0.6258229032671528, 'loss_val': 0.9961022731197953, 'psi': 0.4617342077067331}-{'f1_val': 0.35243828617822603, 'auprc': 0.7036875212840937, 'loss_val': 0.9730675422166708, 'psi': 0.4929379802205731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:41902
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.8213
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=-0.1078
[S16] DROPPED delta from S9 (cos=-0.1078 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=-0.0942
[S15] DROPPED delta from S16 (cos=-0.0942 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=0.8933
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.9778
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.5035
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.4837
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.7475
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=0.9491
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9784
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.8389
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.8442
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7007 head_norm=1.151223
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.731434e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7007 head_norm=1.221355 delta_norm=0.373143
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.4016 head_norm=1.107490
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.158075e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.4021 head_norm=1.209695 delta_norm=0.315807
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5348 head_norm=0.962264
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.794893e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5240 head_norm=0.886520 delta_norm=0.279489
[S16] aggregate: ROLLBACK (f1_val pre=0.535 post=0.524 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.3748 head_norm=1.169583
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.044383e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.3748 head_norm=1.212755 delta_norm=0.204438
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7006 head_norm=0.942003
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.898987e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.987738 delta_norm=0.389899
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6944 head_norm=0.895608
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.617357e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7017 head_norm=0.881043 delta_norm=0.261736
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4809 head_norm=1.378281
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.684334e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5152 head_norm=1.441478 delta_norm=0.168433
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.6481 head_norm=1.391609
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.599729e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.6553 head_norm=1.438909 delta_norm=0.159973
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3523 head_norm=0.705785
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.775553e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3531 head_norm=0.768010 delta_norm=0.377555
[S17] aggregate: ACCEPT kept=['S6', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.209695 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.959807 metrics={'f1_val': 0.700583647419796, 'auprc': 0.7944276483690877, 'loss_val': 0.6128441657633977, 'psi': 0.7381212477995127}-{'f1_val': 0.40162034367431665, 'auprc': 0.7757432467273462, 'loss_val': 0.6826258623599711, 'psi': 0.5512695048955285}
[S3] START round=12 head_norm_before_train=1.221355 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9987980533842518, 'loss_val': 0.4172469462309723, 'psi': 0.8199277971529015}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988049211412902, 'loss_val': 0.41020222090907194, 'psi': 0.819930544255717}
[S4] START round=12 head_norm_before_train=1.212755 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.017520 metrics={'f1_val': 0.37900995088951495, 'auprc': 0.8521545433398262, 'loss_val': 0.7815469318804836, 'psi': 0.5682677878696395}-{'f1_val': 0.37479244499500536, 'auprc': 0.8530495964445447, 'loss_val': 0.7939677655011685, 'psi': 0.5660953055748211}
[S5] START round=12 head_norm_before_train=1.716119 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.6372057776392247, 'auprc': 0.8542149344761928, 'loss_val': 0.38335607631457497, 'psi': 0.724009440374012}-{'f1_val': 0.6562690348027667, 'auprc': 0.8539017768502752, 'loss_val': 0.4121806758182521, 'psi': 0.7353221316217702}
[S6] START round=12 head_norm_before_train=1.453243 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6304831099239254, 'auprc': 0.789959665168136, 'loss_val': 0.5155007967565115, 'psi': 0.6942737320216097}-{'f1_val': 0.7090667836064852, 'auprc': 0.9655969023084645, 'loss_val': 0.4450465878260126, 'psi': 0.8116788310872769}
[S7] START round=12 head_norm_before_train=1.287330 cos_to_last_merge=0.8670 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.867
[S7] round=12 local utility u=0.190016 metrics={'f1_val': 0.6780611029818973, 'auprc': 0.8339573870778041, 'loss_val': 0.4182831357817067, 'psi': 0.74041961662026}-{'f1_val': 0.6467314826710748, 'auprc': 0.8069937821762116, 'loss_val': 0.5294470854472093, 'psi': 0.7108364024731295}
[S8] START round=12 head_norm_before_train=1.438909 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.44913599614044386, 'auprc': 0.9902395452498222, 'loss_val': 0.5876597551084715, 'psi': 0.6655774157841952}-{'f1_val': 0.6481348490321563, 'auprc': 0.9907545899926621, 'loss_val': 0.5722339956377027, 'psi': 0.7851827454163587}
[S9] START round=12 head_norm_before_train=1.744826 (no previous merge yet)
[S9] round=12 local utility u=0.001849 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9995857460925085, 'loss_val': 0.056872817762766724, 'psi': 0.9933971698198272}-{'f1_val': 0.9908221688527771, 'auprc': 0.9995880091590275, 'loss_val': 0.06988104195741379, 'psi': 0.9943285049752772}
[S10] START round=12 head_norm_before_train=1.501842 (no previous merge yet)
[S10] round=12 local utility u=0.330218 metrics={'f1_val': 0.6950396933748755, 'auprc': 0.996711693047265, 'loss_val': 0.3843320816326482, 'psi': 0.8157084932438313}-{'f1_val': 0.7015067223794076, 'auprc': 0.7944851658748034, 'loss_val': 0.4768902481804035, 'psi': 0.738698099777566}
[S11] START round=12 head_norm_before_train=0.881043 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.041130 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9391879980524469, 'loss_val': 0.5694433944916087, 'psi': 0.7966521685595216}-{'f1_val': 0.6943781541956171, 'auprc': 0.9381982254953757, 'loss_val': 0.6052323848904968, 'psi': 0.7919061827155205}
[S13] START round=12 head_norm_before_train=1.441478 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.403116 metrics={'f1_val': 0.5784903442768019, 'auprc': 0.6939717650905076, 'loss_val': 0.6946620764295864, 'psi': 0.6246829126022841}-{'f1_val': 0.4808944576049326, 'auprc': 0.6523153086282079, 'loss_val': 0.7903489022098583, 'psi': 0.5494627980142427}
[S14] START round=12 head_norm_before_train=0.987738 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.705795 metrics={'f1_val': 0.9294291223207262, 'auprc': 0.9970702140941571, 'loss_val': 0.5873190308829439, 'psi': 0.9564855590300985}-{'f1_val': 0.7006359803930868, 'auprc': 0.9969209981180788, 'loss_val': 0.6257019754960957, 'psi': 0.8191499874830837}
[S15] START round=12 head_norm_before_train=1.520788 (no previous merge yet)
[S15] round=12 local utility u=0.111048 metrics={'f1_val': 0.6964485294290571, 'auprc': 0.9767182133804378, 'loss_val': 0.36408515907935124, 'psi': 0.8085564030096094}-{'f1_val': 0.6920862555261497, 'auprc': 0.9421447832854349, 'loss_val': 0.45628711814256717, 'psi': 0.7921096666298638}
[S16] START round=12 head_norm_before_train=0.886520 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4363486745711888, 'auprc': 0.7224596189179432, 'loss_val': 0.9333015779475983, 'psi': 0.5507930523098905}-{'f1_val': 0.5347891229264135, 'auprc': 0.7599552513515062, 'loss_val': 0.9974321152069742, 'psi': 0.6248555742964506}
[S17] START round=12 head_norm_before_train=0.768010 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3535287990831843, 'auprc': 0.5817681817674604, 'loss_val': 1.028805497397878, 'psi': 0.44482455215689476}-{'f1_val': 0.3523417439997866, 'auprc': 0.6258229032671528, 'loss_val': 0.9961022731197953, 'psi': 0.4617342077067331}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:41917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9892
[S17] RECEIVED delta(kind=head bytes=1795) from S2
[S17] cosine check vs S2: cos=0.5999
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.9039
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.8590
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9743
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.8763
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=-0.0969
[S16] DROPPED delta from S9 (cos=-0.0969 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1806) from S13
[S2] cosine check vs S13: cos=0.9510
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.9873
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.4491 head_norm=1.469386
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.229480e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.5965 head_norm=1.494381 delta_norm=0.122948
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9294 head_norm=1.035423
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.732700e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7020 head_norm=1.118236 delta_norm=0.273270
[S14] aggregate: ROLLBACK (f1_val pre=0.929 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7016 head_norm=0.936347
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.660572e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7016 head_norm=0.950598 delta_norm=0.266057
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5785 head_norm=1.467953
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.206088e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5860 head_norm=1.510445 delta_norm=0.120609
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7006 head_norm=1.242947
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.395459e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.4022 head_norm=1.338850 delta_norm=0.239546
[S2] aggregate: ROLLBACK (f1_val pre=0.701 post=0.402 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.3790 head_norm=1.256246
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.492872e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.3998 head_norm=1.279413 delta_norm=0.149287
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4363 head_norm=0.927326
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.317854e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4349 head_norm=0.902561 delta_norm=0.231785
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3535 head_norm=0.802008
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.980299e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3521 head_norm=0.919801 delta_norm=0.498030
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.338850 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.075776 metrics={'f1_val': 0.700951064350674, 'auprc': 0.8193198229400578, 'loss_val': 0.5381741165951296, 'psi': 0.7482985677864276}-{'f1_val': 0.700583647419796, 'auprc': 0.7944276483690877, 'loss_val': 0.6128441657633977, 'psi': 0.7381212477995127}
[S3] START round=13 head_norm_before_train=1.278368 cos_to_last_merge=0.9892 (last merge round=11)
[S3] round=13 local utility u=0.054696 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983763298221047, 'loss_val': 0.30613989271020997, 'psi': 0.8197141334289653}-{'f1_val': 0.7006809596653347, 'auprc': 0.9987980533842518, 'loss_val': 0.4172469462309723, 'psi': 0.8199277971529015}
[S4] START round=13 head_norm_before_train=1.279413 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.087794 metrics={'f1_val': 0.4041370852440232, 'auprc': 0.8493116234526512, 'loss_val': 0.7481922500252135, 'psi': 0.5822069005274744}-{'f1_val': 0.37900995088951495, 'auprc': 0.8521545433398262, 'loss_val': 0.7815469318804836, 'psi': 0.5682677878696395}
[S5] START round=13 head_norm_before_train=1.735924 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.548061270767322, 'auprc': 0.8539823759544911, 'loss_val': 0.5166890777153726, 'psi': 0.6704297128421897}-{'f1_val': 0.6372057776392247, 'auprc': 0.8542149344761928, 'loss_val': 0.38335607631457497, 'psi': 0.724009440374012}
[S6] START round=13 head_norm_before_train=1.490559 (no previous merge yet)
[S6] round=13 local utility u=0.616255 metrics={'f1_val': 0.7076970401104172, 'auprc': 0.9732996865706721, 'loss_val': 0.2962952452046645, 'psi': 0.8139380986945193}-{'f1_val': 0.6304831099239254, 'auprc': 0.789959665168136, 'loss_val': 0.5155007967565115, 'psi': 0.6942737320216097}
[S7] START round=13 head_norm_before_train=1.319171 cos_to_last_merge=0.8598 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=13 local utility u=0.136949 metrics={'f1_val': 0.6919478643465368, 'auprc': 0.8701257637717127, 'loss_val': 0.3362113755548387, 'psi': 0.7632190241166071}-{'f1_val': 0.6780611029818973, 'auprc': 0.8339573870778041, 'loss_val': 0.4182831357817067, 'psi': 0.74041961662026}
[S8] START round=13 head_norm_before_train=1.494381 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.652328 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.9922720853045168, 'loss_val': 0.5263571437655229, 'psi': 0.7901159917506506}-{'f1_val': 0.44913599614044386, 'auprc': 0.9902395452498222, 'loss_val': 0.5876597551084715, 'psi': 0.6655774157841952}
[S9] START round=13 head_norm_before_train=1.786790 (no previous merge yet)
[S9] round=13 local utility u=0.034064 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995747435565732, 'loss_val': 0.03570063449469957, 'psi': 0.998091644929915}-{'f1_val': 0.9892714523047061, 'auprc': 0.9995857460925085, 'loss_val': 0.056872817762766724, 'psi': 0.9933971698198272}
[S10] START round=13 head_norm_before_train=1.528884 (no previous merge yet)
[S10] round=13 local utility u=0.027007 metrics={'f1_val': 0.6971912796323873, 'auprc': 0.9966280999744365, 'loss_val': 0.3429766282105805, 'psi': 0.8169660077692069}-{'f1_val': 0.6950396933748755, 'auprc': 0.996711693047265, 'loss_val': 0.3843320816326482, 'psi': 0.8157084932438313}
[S11] START round=13 head_norm_before_train=0.950598 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.028759 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9437435876904668, 'loss_val': 0.5274344417174813, 'psi': 0.7986586250551788}-{'f1_val': 0.7016282822309048, 'auprc': 0.9391879980524469, 'loss_val': 0.5694433944916087, 'psi': 0.7966521685595216}
[S13] START round=13 head_norm_before_train=1.510445 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.203757 metrics={'f1_val': 0.6144701007936719, 'auprc': 0.7316010490439249, 'loss_val': 0.6159143523284725, 'psi': 0.6613224800937731}-{'f1_val': 0.5784903442768019, 'auprc': 0.6939717650905076, 'loss_val': 0.6946620764295864, 'psi': 0.6246829126022841}
[S14] START round=13 head_norm_before_train=1.118236 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.224879 metrics={'f1_val': 0.9967920722591915, 'auprc': 0.9955328699815722, 'loss_val': 0.5371258206141846, 'psi': 0.9962883913481437}-{'f1_val': 0.9294291223207262, 'auprc': 0.9970702140941571, 'loss_val': 0.5873190308829439, 'psi': 0.9564855590300985}
[S15] START round=13 head_norm_before_train=1.561120 (no previous merge yet)
[S15] round=13 local utility u=0.036624 metrics={'f1_val': 0.6980919167946789, 'auprc': 0.9832778941407124, 'loss_val': 0.3203763794760708, 'psi': 0.8121663077330923}-{'f1_val': 0.6964485294290571, 'auprc': 0.9767182133804378, 'loss_val': 0.36408515907935124, 'psi': 0.8085564030096094}
[S16] START round=13 head_norm_before_train=0.902561 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.409361 metrics={'f1_val': 0.5450709977783816, 'auprc': 0.7718468054195649, 'loss_val': 0.9150746403281104, 'psi': 0.6357813208348548}-{'f1_val': 0.4363486745711888, 'auprc': 0.7224596189179432, 'loss_val': 0.9333015779475983, 'psi': 0.5507930523098905}
[S17] START round=13 head_norm_before_train=0.919801 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.113891 metrics={'f1_val': 0.35228328818124377, 'auprc': 0.661190463876196, 'loss_val': 1.0318164449351432, 'psi': 0.4758461584592247}-{'f1_val': 0.3535287990831843, 'auprc': 0.5817681817674604, 'loss_val': 1.028805497397878, 'psi': 0.44482455215689476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:41915
[S13] not sending this round → trigger blocked (psi=0.661)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[S7] not sending this round → trigger blocked (psi=0.763)
[S15] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → trigger blocked (psi=0.817)
[S2] not sending this round → trigger blocked (psi=0.748)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.799)
[S4] not sending this round → trigger blocked (psi=0.582)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=-0.0785
[S15] DROPPED delta from S16 (cos=-0.0785 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.0928
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.3882
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.8575
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=-0.0300
[S14] DROPPED delta from S17 (cos=-0.0300 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.356586
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.918393e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.386234 delta_norm=0.391839
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3523 head_norm=0.947554
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.603819e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3535 head_norm=0.808202 delta_norm=0.560382
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.370209 cos_to_last_merge=0.9979 (last merge round=12)
[S2] round=14 local utility u=0.030110 metrics={'f1_val': 0.7007729058908991, 'auprc': 0.8027031904380839, 'loss_val': 0.42703518828430603, 'psi': 0.741545019709773}-{'f1_val': 0.700951064350674, 'auprc': 0.8193198229400578, 'loss_val': 0.5381741165951296, 'psi': 0.7482985677864276}
[S3] START round=14 head_norm_before_train=1.386234 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9985001442252799, 'loss_val': 0.33435477089795335, 'psi': 0.8197636591902353}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983763298221047, 'loss_val': 0.30613989271020997, 'psi': 0.8197141334289653}
[S4] START round=14 head_norm_before_train=1.322998 cos_to_last_merge=0.9972 (last merge round=12)
[S4] round=14 local utility u=0.019098 metrics={'f1_val': 0.40224890564406734, 'auprc': 0.8491383149282897, 'loss_val': 0.6981477781897327, 'psi': 0.5810046693577563}-{'f1_val': 0.4041370852440232, 'auprc': 0.8493116234526512, 'loss_val': 0.7481922500252135, 'psi': 0.5822069005274744}
[S5] START round=14 head_norm_before_train=1.755677 (no previous merge yet)
[S5] round=14 local utility u=0.789490 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9848716530217165, 'loss_val': 0.24669942636945877, 'psi': 0.8144176679269244}-{'f1_val': 0.548061270767322, 'auprc': 0.8539823759544911, 'loss_val': 0.5166890777153726, 'psi': 0.6704297128421897}
[S6] START round=14 head_norm_before_train=1.519659 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6265973355222612, 'auprc': 0.8047434304381734, 'loss_val': 0.47333763455578753, 'psi': 0.697855773488626}-{'f1_val': 0.7076970401104172, 'auprc': 0.9732996865706721, 'loss_val': 0.2962952452046645, 'psi': 0.8139380986945193}
[S7] START round=14 head_norm_before_train=1.342712 cos_to_last_merge=0.8547 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=14 local utility u=0.768635 metrics={'f1_val': 0.8644456917451795, 'auprc': 0.9981301511926128, 'loss_val': 0.2179408299775299, 'psi': 0.9179194755241529}-{'f1_val': 0.6919478643465368, 'auprc': 0.8701257637717127, 'loss_val': 0.3362113755548387, 'psi': 0.7632190241166071}
[S8] START round=14 head_norm_before_train=1.519881 cos_to_last_merge=0.9990 (last merge round=12)
[S8] round=14 local utility u=0.028977 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9938319136415599, 'loss_val': 0.4713918143585219, 'psi': 0.7905708180708686}-{'f1_val': 0.6553452627147397, 'auprc': 0.9922720853045168, 'loss_val': 0.5263571437655229, 'psi': 0.7901159917506506}
[S9] START round=14 head_norm_before_train=1.819198 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9995806282875399, 'loss_val': 0.036092534973334194, 'psi': 0.9954429364039348}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995747435565732, 'loss_val': 0.03570063449469957, 'psi': 0.998091644929915}
[S10] START round=14 head_norm_before_train=1.557496 (no previous merge yet)
[S10] round=14 local utility u=0.047903 metrics={'f1_val': 0.7091892734133797, 'auprc': 0.9943299480294093, 'loss_val': 0.3122639627212125, 'psi': 0.8232455432597916}-{'f1_val': 0.6971912796323873, 'auprc': 0.9966280999744365, 'loss_val': 0.3429766282105805, 'psi': 0.8169660077692069}
[S11] START round=14 head_norm_before_train=0.997585 cos_to_last_merge=0.9952 (last merge round=12)
[S11] round=14 local utility u=0.103285 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9752705326981314, 'loss_val': 0.41399474278402265, 'psi': 0.8111243008314075}-{'f1_val': 0.7019353166316534, 'auprc': 0.9437435876904668, 'loss_val': 0.5274344417174813, 'psi': 0.7986586250551788}
[S13] START round=14 head_norm_before_train=1.529895 cos_to_last_merge=0.9995 (last merge round=12)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6224895475856589, 'auprc': 0.639196116233482, 'loss_val': 0.6514025730027456, 'psi': 0.6291721750447882}-{'f1_val': 0.6144701007936719, 'auprc': 0.7316010490439249, 'loss_val': 0.6159143523284725, 'psi': 0.6613224800937731}
[S14] START round=14 head_norm_before_train=1.160079 cos_to_last_merge=0.9968 (last merge round=12)
[S14] round=14 local utility u=0.076784 metrics={'f1_val': 0.9968194121056999, 'auprc': 0.9969442492159167, 'loss_val': 0.38795626447580306, 'psi': 0.9968693469497867}-{'f1_val': 0.9967920722591915, 'auprc': 0.9955328699815722, 'loss_val': 0.5371258206141846, 'psi': 0.9962883913481437}
[S15] START round=14 head_norm_before_train=1.599122 (no previous merge yet)
[S15] round=14 local utility u=0.033254 metrics={'f1_val': 0.6952035429508411, 'auprc': 0.9856269766491471, 'loss_val': 0.2435851737014679, 'psi': 0.8113729164301635}-{'f1_val': 0.6980919167946789, 'auprc': 0.9832778941407124, 'loss_val': 0.3203763794760708, 'psi': 0.8121663077330923}
[S16] START round=14 head_norm_before_train=0.945812 cos_to_last_merge=0.9973 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.43727725464159783, 'auprc': 0.7669797485831945, 'loss_val': 0.8432566370780123, 'psi': 0.5691582522182366}-{'f1_val': 0.5450709977783816, 'auprc': 0.7718468054195649, 'loss_val': 0.9150746403281104, 'psi': 0.6357813208348548}
[S17] START round=14 head_norm_before_train=0.808202 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.35348113499621747, 'auprc': 0.48390711323913044, 'loss_val': 1.0450889806240473, 'psi': 0.40565152629338264}-{'f1_val': 0.35228328818124377, 'auprc': 0.661190463876196, 'loss_val': 1.0318164449351432, 'psi': 0.4758461584592247}
[S8] not sending this round → trigger blocked (psi=0.791)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9692
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0756
[S16] DROPPED delta from S5 (cos=-0.0756 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.9077
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] cosine check vs S15: cos=0.9894
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] cosine check vs S2: cos=0.5721
[S14] RECEIVED delta(kind=head bytes=1793) from S4
[S14] cosine check vs S4: cos=0.9438
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.8812
[S8] RECEIVED delta(kind=head bytes=1794) from S10
[S8] cosine check vs S10: cos=0.9817
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6225 head_norm=1.548130
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.239439e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6229 head_norm=1.588536 delta_norm=0.123944
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.6551 head_norm=1.544744
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.519960e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.6551 head_norm=1.561150 delta_norm=0.151996
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9968 head_norm=1.206295
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.307137e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9416 head_norm=1.270281 delta_norm=0.230714
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.942 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.4022 head_norm=1.370598
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.698242e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.4027 head_norm=1.356944 delta_norm=0.169824
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=1.055210
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.851439e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.096814 delta_norm=0.285144
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4373 head_norm=1.001498
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.224261e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4371 head_norm=1.004370 delta_norm=0.222426
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3535 head_norm=0.836575
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.788405e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3521 head_norm=1.005222 delta_norm=0.578840
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.411097 cos_to_last_merge=0.9920 (last merge round=12)
[S2] round=15 local utility u=0.007378 metrics={'f1_val': 0.700231730425987, 'auprc': 0.7880024059795742, 'loss_val': 0.36492916799985936, 'psi': 0.7353400006474219}-{'f1_val': 0.7007729058908991, 'auprc': 0.8027031904380839, 'loss_val': 0.42703518828430603, 'psi': 0.741545019709773}
[S3] START round=15 head_norm_before_train=1.435694 cos_to_last_merge=0.9956 (last merge round=13)
[S3] round=15 local utility u=0.039194 metrics={'f1_val': 0.701952049433578, 'auprc': 0.9987149279749683, 'loss_val': 0.2646876974537063, 'psi': 0.8206572008501342}-{'f1_val': 0.7006060025002057, 'auprc': 0.9985001442252799, 'loss_val': 0.33435477089795335, 'psi': 0.8197636591902353}
[S4] START round=15 head_norm_before_train=1.356944 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.900165 metrics={'f1_val': 0.6973467465769776, 'auprc': 0.8499544763813146, 'loss_val': 0.6708543058481958, 'psi': 0.7583898384987124}-{'f1_val': 0.40224890564406734, 'auprc': 0.8491383149282897, 'loss_val': 0.6981477781897327, 'psi': 0.5810046693577563}
[S5] START round=15 head_norm_before_train=1.770975 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.6746706148003192, 'auprc': 0.9527784047710159, 'loss_val': 0.2668901340509055, 'psi': 0.7859137307885979}-{'f1_val': 0.7007816778637295, 'auprc': 0.9848716530217165, 'loss_val': 0.24669942636945877, 'psi': 0.8144176679269244}
[S6] START round=15 head_norm_before_train=1.540996 (no previous merge yet)
[S6] round=15 local utility u=0.540283 metrics={'f1_val': 0.7075756121585401, 'auprc': 0.9525684122059912, 'loss_val': 0.3221154419653027, 'psi': 0.8055727321775206}-{'f1_val': 0.6265973355222612, 'auprc': 0.8047434304381734, 'loss_val': 0.47333763455578753, 'psi': 0.697855773488626}
[S7] START round=15 head_norm_before_train=1.364455 cos_to_last_merge=0.8508 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4137454713067542, 'auprc': 0.7751864112805444, 'loss_val': 1.2379718670753281, 'psi': 0.5583218472962703}-{'f1_val': 0.8644456917451795, 'auprc': 0.9981301511926128, 'loss_val': 0.2179408299775299, 'psi': 0.9179194755241529}
[S8] START round=15 head_norm_before_train=1.561150 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.6417214431832323, 'auprc': 0.9906146899892868, 'loss_val': 0.49589889950272736, 'psi': 0.7812787419056542}-{'f1_val': 0.6550634210237409, 'auprc': 0.9938319136415599, 'loss_val': 0.4713918143585219, 'psi': 0.7905708180708686}
[S9] START round=15 head_norm_before_train=1.850064 (no previous merge yet)
[S9] round=15 local utility u=0.016899 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9995600208564681, 'loss_val': 0.027242201927587414, 'psi': 0.9979355595979416}-{'f1_val': 0.992684475148198, 'auprc': 0.9995806282875399, 'loss_val': 0.036092534973334194, 'psi': 0.9954429364039348}
[S10] START round=15 head_norm_before_train=1.591965 (no previous merge yet)
[S10] round=15 local utility u=0.019312 metrics={'f1_val': 0.706604218982845, 'auprc': 0.9963155009005036, 'loss_val': 0.26408545172708725, 'psi': 0.8224887317499084}-{'f1_val': 0.7091892734133797, 'auprc': 0.9943299480294093, 'loss_val': 0.3122639627212125, 'psi': 0.8232455432597916}
[S11] START round=15 head_norm_before_train=1.096814 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9562813159306185, 'loss_val': 0.4120116296127624, 'psi': 0.8034894957107903}-{'f1_val': 0.7016934795869249, 'auprc': 0.9752705326981314, 'loss_val': 0.41399474278402265, 'psi': 0.8111243008314075}
[S13] START round=15 head_norm_before_train=1.588536 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.234252 metrics={'f1_val': 0.6582134410320998, 'auprc': 0.7038822527618318, 'loss_val': 0.5913012855053889, 'psi': 0.6764809657239925}-{'f1_val': 0.6224895475856589, 'auprc': 0.639196116233482, 'loss_val': 0.6514025730027456, 'psi': 0.6291721750447882}
[S14] START round=15 head_norm_before_train=1.270281 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.951453007752298, 'auprc': 0.9970459812635741, 'loss_val': 0.3107633634625406, 'psi': 0.9696901971568084}-{'f1_val': 0.9968194121056999, 'auprc': 0.9969442492159167, 'loss_val': 0.38795626447580306, 'psi': 0.9968693469497867}
[S15] START round=15 head_norm_before_train=1.637349 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7048515676201697, 'auprc': 0.8084545106375678, 'loss_val': 0.45318384809352497, 'psi': 0.7462927448271289}-{'f1_val': 0.6952035429508411, 'auprc': 0.9856269766491471, 'loss_val': 0.2435851737014679, 'psi': 0.8113729164301635}
[S16] START round=15 head_norm_before_train=1.004370 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8280191457959416, 'auprc': 0.828966872529412, 'loss_val': 0.7882048089606853, 'psi': 0.8283982364893298}-{'f1_val': 0.43727725464159783, 'auprc': 0.7669797485831945, 'loss_val': 0.8432566370780123, 'psi': 0.5691582522182366}
[S17] START round=15 head_norm_before_train=1.005222 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.364112 metrics={'f1_val': 0.35198830839550554, 'auprc': 0.7264737295208805, 'loss_val': 1.0356074561393804, 'psi': 0.5017824768456556}-{'f1_val': 0.35348113499621747, 'auprc': 0.48390711323913044, 'loss_val': 1.0450889806240473, 'psi': 0.40565152629338264}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:41902
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S10] not sending this round → trigger blocked (psi=0.822)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S4] not sending this round → trigger blocked (psi=0.758)
[S2] not sending this round → trigger blocked (psi=0.735)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.9429
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.3511
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=-0.0736
[S15] DROPPED delta from S16 (cos=-0.0736 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=-0.0903
[S16] DROPPED delta from S9 (cos=-0.0903 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.1851
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0217
[S14] DROPPED delta from S17 (cos=-0.0217 < 0.0)
[S11] ⇄ pheromone p=0.165 → S16@127.0.0.1:41916
[S4] ⇄ pheromone p=0.295 → S14@127.0.0.1:41914
[S8] ⇄ pheromone p=0.247 → S3@127.0.0.1:41903
[S7] ⇄ pheromone p=0.315 → S4@127.0.0.1:41904
[S5] ⇄ pheromone p=0.223 → S16@127.0.0.1:41916
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7002 head_norm=1.450945
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.705101e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.6999 head_norm=1.508976 delta_norm=0.270510
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.242 → S17@127.0.0.1:41917
[S14] ⇄ pheromone p=0.278 → S11@127.0.0.1:41912
[S10] ⇄ pheromone p=0.234 → S8@127.0.0.1:41909
[S9] ⇄ pheromone p=0.112 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.342 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=0.211 → S2@127.0.0.1:41902
[S16] ⇄ pheromone p=0.372 → S15@127.0.0.1:41915
[S3] ⇄ pheromone p=0.103 → S17@127.0.0.1:41917
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3520 head_norm=1.028063
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.919224e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3535 head_norm=0.879969 delta_norm=0.591922
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.150 → S14@127.0.0.1:41914
[S15] ⇄ pheromone p=0.163 → S13@127.0.0.1:41913
[S2] START round=16 head_norm_before_train=1.508976 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000687 metrics={'f1_val': 0.7004096207052289, 'auprc': 0.7893863668989832, 'loss_val': 0.3687745260933113, 'psi': 0.7360003191827307}-{'f1_val': 0.700231730425987, 'auprc': 0.7880024059795742, 'loss_val': 0.36492916799985936, 'psi': 0.7353400006474219}
[S3] START round=16 head_norm_before_train=1.496223 cos_to_last_merge=0.9855 (last merge round=13)
[S3] round=16 local utility u=0.821672 metrics={'f1_val': 0.9648019994991639, 'auprc': 0.9985724990780911, 'loss_val': 0.19801582870245274, 'psi': 0.9783101993307348}-{'f1_val': 0.701952049433578, 'auprc': 0.9987149279749683, 'loss_val': 0.2646876974537063, 'psi': 0.8206572008501342}
[S4] START round=16 head_norm_before_train=1.397731 cos_to_last_merge=0.9983 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6189798888953174, 'auprc': 0.8508208134857977, 'loss_val': 0.6118788555739255, 'psi': 0.7117162587315096}-{'f1_val': 0.6973467465769776, 'auprc': 0.8499544763813146, 'loss_val': 0.6708543058481958, 'psi': 0.7583898384987124}
[S5] START round=16 head_norm_before_train=1.790022 (no previous merge yet)
[S5] round=16 local utility u=0.014677 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9201107903853473, 'loss_val': 0.29543520159294356, 'psi': 0.7884368496659768}-{'f1_val': 0.6746706148003192, 'auprc': 0.9527784047710159, 'loss_val': 0.2668901340509055, 'psi': 0.7859137307885979}
[S6] START round=16 head_norm_before_train=1.560102 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6327883703377791, 'auprc': 0.7892261398000799, 'loss_val': 0.5648356568585002, 'psi': 0.6953634781226994}-{'f1_val': 0.7075756121585401, 'auprc': 0.9525684122059912, 'loss_val': 0.3221154419653027, 'psi': 0.8055727321775206}
[S7] START round=16 head_norm_before_train=1.378971 cos_to_last_merge=0.8487 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.849
[S7] round=16 local utility u=1.000000 metrics={'f1_val': 0.734845198720244, 'auprc': 0.9949748407367169, 'loss_val': 0.2208368972672426, 'psi': 0.8388970555268331}-{'f1_val': 0.4137454713067542, 'auprc': 0.7751864112805444, 'loss_val': 1.2379718670753281, 'psi': 0.5583218472962703}
[S8] START round=16 head_norm_before_train=1.586284 cos_to_last_merge=0.9995 (last merge round=14)
[S8] round=16 local utility u=0.098088 metrics={'f1_val': 0.6547822169836268, 'auprc': 0.9942072374189156, 'loss_val': 0.38886433586212604, 'psi': 0.7905522251577424}-{'f1_val': 0.6417214431832323, 'auprc': 0.9906146899892868, 'loss_val': 0.49589889950272736, 'psi': 0.7812787419056542}
[S9] START round=16 head_norm_before_train=1.877799 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9995704521080301, 'loss_val': 0.031152611220800704, 'psi': 0.9961918084416203}-{'f1_val': 0.9968525854255906, 'auprc': 0.9995600208564681, 'loss_val': 0.027242201927587414, 'psi': 0.9979355595979416}
[S10] START round=16 head_norm_before_train=1.628439 (no previous merge yet)
[S10] round=16 local utility u=0.273354 metrics={'f1_val': 0.7880988412679815, 'auprc': 0.996302764138499, 'loss_val': 0.20630730057682503, 'psi': 0.8713804104161885}-{'f1_val': 0.706604218982845, 'auprc': 0.9963155009005036, 'loss_val': 0.26408545172708725, 'psi': 0.8224887317499084}
[S11] START round=16 head_norm_before_train=1.139589 cos_to_last_merge=0.9975 (last merge round=14)
[S11] round=16 local utility u=0.045905 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9663217127722181, 'loss_val': 0.3517746255087715, 'psi': 0.807650756262436}-{'f1_val': 0.7016282822309048, 'auprc': 0.9562813159306185, 'loss_val': 0.4120116296127624, 'psi': 0.8034894957107903}
[S13] START round=16 head_norm_before_train=1.610940 cos_to_last_merge=0.9996 (last merge round=14)
[S13] round=16 local utility u=0.105295 metrics={'f1_val': 0.6667865342651128, 'auprc': 0.7333982844403915, 'loss_val': 0.5206988249560003, 'psi': 0.6934312343352242}-{'f1_val': 0.6582134410320998, 'auprc': 0.7038822527618318, 'loss_val': 0.5913012855053889, 'psi': 0.6764809657239925}
[S14] START round=16 head_norm_before_train=1.309147 cos_to_last_merge=0.9985 (last merge round=14)
[S14] round=16 local utility u=0.179927 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9970136504899398, 'loss_val': 0.22668060818496977, 'psi': 0.9972640905003536}-{'f1_val': 0.951453007752298, 'auprc': 0.9970459812635741, 'loss_val': 0.3107633634625406, 'psi': 0.9696901971568084}
[S15] START round=16 head_norm_before_train=1.671472 (no previous merge yet)
[S15] round=16 local utility u=0.644755 metrics={'f1_val': 0.785886691537404, 'auprc': 0.9862463650310733, 'loss_val': 0.18325928199059263, 'psi': 0.8660305609348717}-{'f1_val': 0.7048515676201697, 'auprc': 0.8084545106375678, 'loss_val': 0.45318384809352497, 'psi': 0.7462927448271289}
[S16] START round=16 head_norm_before_train=1.054722 cos_to_last_merge=0.9978 (last merge round=14)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.460242776350307, 'auprc': 0.8290434198113861, 'loss_val': 0.7791024593192929, 'psi': 0.6077630337347386}-{'f1_val': 0.8280191457959416, 'auprc': 0.828966872529412, 'loss_val': 0.7882048089606853, 'psi': 0.8283982364893298}
[S17] START round=16 head_norm_before_train=0.879969 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.353367910639275, 'auprc': 0.52084583226835, 'loss_val': 1.0571243367520762, 'psi': 0.420359079290905}-{'f1_val': 0.35198830839550554, 'auprc': 0.7264737295208805, 'loss_val': 1.0356074561393804, 'psi': 0.5017824768456556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[S3] not sending this round → trigger blocked (psi=0.978)
[S13] not sending this round → trigger blocked (psi=0.693)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0777
[S16] DROPPED delta from S5 (cos=-0.0777 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.9132
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9744
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.8970
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.9905
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] cosine check vs S2: cos=0.5701
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9194
[S8] RECEIVED delta(kind=head bytes=1805) from S10
[S8] cosine check vs S10: cos=0.9837
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9648 head_norm=1.542412
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.598849e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9986 head_norm=1.537031 delta_norm=0.359885
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6190 head_norm=1.438538
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.618171e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.7716 head_norm=1.403460 delta_norm=0.161817
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6668 head_norm=1.633530
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.189645e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6670 head_norm=1.660930 delta_norm=0.118964
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.4602 head_norm=1.105932
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.410976e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.4680 head_norm=1.118462 delta_norm=0.241098
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.6548 head_norm=1.613979
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.498045e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.6548 head_norm=1.631820 delta_norm=0.149805
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=1.181136
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.668766e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=1.239380 delta_norm=0.266877
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3534 head_norm=0.903700
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.322293e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.4182 head_norm=1.091971 delta_norm=0.632229
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.538687 cos_to_last_merge=0.9988 (last merge round=15)
[S2] round=17 local utility u=0.012261 metrics={'f1_val': 0.7009372979275044, 'auprc': 0.7894462876524933, 'loss_val': 0.3475978577022131, 'psi': 0.7363408938174999}-{'f1_val': 0.7004096207052289, 'auprc': 0.7893863668989832, 'loss_val': 0.3687745260933113, 'psi': 0.7360003191827307}
[S3] START round=17 head_norm_before_train=1.537031 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9377165037117245, 'auprc': 0.9977828121957697, 'loss_val': 0.22559273244382244, 'psi': 0.9617430271053427}-{'f1_val': 0.9648019994991639, 'auprc': 0.9985724990780911, 'loss_val': 0.19801582870245274, 'psi': 0.9783101993307348}
[S4] START round=17 head_norm_before_train=1.403460 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.149850 metrics={'f1_val': 0.6232161270009156, 'auprc': 0.9281840644594263, 'loss_val': 0.5696865172585407, 'psi': 0.7452033019843198}-{'f1_val': 0.6189798888953174, 'auprc': 0.8508208134857977, 'loss_val': 0.6118788555739255, 'psi': 0.7117162587315096}
[S5] START round=17 head_norm_before_train=1.806482 (no previous merge yet)
[S5] round=17 local utility u=0.153561 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9875741364694622, 'loss_val': 0.19122159820756168, 'psi': 0.8154740191523533}-{'f1_val': 0.7006542225197299, 'auprc': 0.9201107903853473, 'loss_val': 0.29543520159294356, 'psi': 0.7884368496659768}
[S6] START round=17 head_norm_before_train=1.581725 (no previous merge yet)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9597196169961317, 'auprc': 0.958413965600967, 'loss_val': 0.25159168306645924, 'psi': 0.9591973564380659}-{'f1_val': 0.6327883703377791, 'auprc': 0.7892261398000799, 'loss_val': 0.5648356568585002, 'psi': 0.6953634781226994}
[S7] START round=17 head_norm_before_train=1.386498 cos_to_last_merge=0.8475 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.848
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.4114582836335383, 'auprc': 0.7753689428696213, 'loss_val': 1.2387581647932902, 'psi': 0.5570225473279715}-{'f1_val': 0.734845198720244, 'auprc': 0.9949748407367169, 'loss_val': 0.2208368972672426, 'psi': 0.8388970555268331}
[S8] START round=17 head_norm_before_train=1.631820 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9943586593197843, 'loss_val': 0.2818460261289687, 'psi': 0.9956371292893187}-{'f1_val': 0.6547822169836268, 'auprc': 0.9942072374189156, 'loss_val': 0.38886433586212604, 'psi': 0.7905522251577424}
[S9] START round=17 head_norm_before_train=1.900118 (no previous merge yet)
[S9] round=17 local utility u=0.012288 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999005513383326, 'loss_val': 0.023863122822686964, 'psi': 0.9978639528606161}-{'f1_val': 0.9939393793306803, 'auprc': 0.9995704521080301, 'loss_val': 0.031152611220800704, 'psi': 0.9961918084416203}
[S10] START round=17 head_norm_before_train=1.663018 (no previous merge yet)
[S10] round=17 local utility u=0.629339 metrics={'f1_val': 0.9914086278631246, 'auprc': 0.9968506612794182, 'loss_val': 0.16913092869914656, 'psi': 0.9935854412296421}-{'f1_val': 0.7880988412679815, 'auprc': 0.996302764138499, 'loss_val': 0.20630730057682503, 'psi': 0.8713804104161885}
[S11] START round=17 head_norm_before_train=1.239380 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.028007 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9921413621310102, 'loss_val': 0.37321988361310476, 'psi': 0.8179786160059528}-{'f1_val': 0.7018701185892477, 'auprc': 0.9663217127722181, 'loss_val': 0.3517746255087715, 'psi': 0.807650756262436}
[S13] START round=17 head_norm_before_train=1.660930 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.151244 metrics={'f1_val': 0.7094961316314848, 'auprc': 0.7238848547118886, 'loss_val': 0.44592848638234706, 'psi': 0.7152516208636464}-{'f1_val': 0.6667865342651128, 'auprc': 0.7333982844403915, 'loss_val': 0.5206988249560003, 'psi': 0.6934312343352242}
[S14] START round=17 head_norm_before_train=1.348884 cos_to_last_merge=0.9953 (last merge round=14)
[S14] round=17 local utility u=0.025586 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970021752004312, 'loss_val': 0.17432925995907564, 'psi': 0.9971450841036483}-{'f1_val': 0.9974310505072961, 'auprc': 0.9970136504899398, 'loss_val': 0.22668060818496977, 'psi': 0.9972640905003536}
[S15] START round=17 head_norm_before_train=1.696248 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6968648933284182, 'auprc': 0.8504149905919062, 'loss_val': 0.39195174121084597, 'psi': 0.7582849322338134}-{'f1_val': 0.785886691537404, 'auprc': 0.9862463650310733, 'loss_val': 0.18325928199059263, 'psi': 0.8660305609348717}
[S16] START round=17 head_norm_before_train=1.118462 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=1.000000 metrics={'f1_val': 0.8262978921222774, 'auprc': 0.8421307604623974, 'loss_val': 0.7939492101915118, 'psi': 0.8326310394583254}-{'f1_val': 0.460242776350307, 'auprc': 0.8290434198113861, 'loss_val': 0.7791024593192929, 'psi': 0.6077630337347386}
[S17] START round=17 head_norm_before_train=1.091971 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.301396 metrics={'f1_val': 0.3522371298123252, 'auprc': 0.7161510912136358, 'loss_val': 1.0334640327832538, 'psi': 0.4978027143728494}-{'f1_val': 0.353367910639275, 'auprc': 0.52084583226835, 'loss_val': 1.0571243367520762, 'psi': 0.420359079290905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.736)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:41902
[S10] not sending this round → trigger blocked (psi=0.994)
[S5] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S8] not sending this round → trigger blocked (psi=0.996)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=-0.0947
[S16] DROPPED delta from S9 (cos=-0.0947 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.3356
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.9498
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=0.9703
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=-0.0697
[S15] DROPPED delta from S16 (cos=-0.0697 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0189
[S14] DROPPED delta from S17 (cos=-0.0189 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9972 head_norm=1.387527
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.255991e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9972 head_norm=1.396151 delta_norm=0.225599
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7009 head_norm=1.570252
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.056664e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7009 head_norm=1.613813 delta_norm=0.205666
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3522 head_norm=1.111850
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.062983e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3526 head_norm=1.116682 delta_norm=0.806298
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.613813 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7020661798846572, 'auprc': 0.7923408830703154, 'loss_val': 0.36329071519212375, 'psi': 0.7381760611589205}-{'f1_val': 0.7009372979275044, 'auprc': 0.7894462876524933, 'loss_val': 0.3475978577022131, 'psi': 0.7363408938174999}
[S3] START round=18 head_norm_before_train=1.582941 cos_to_last_merge=0.9985 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.8584403832936873, 'auprc': 0.8698603670057862, 'loss_val': 0.3096469092127483, 'psi': 0.8630083767785268}-{'f1_val': 0.9377165037117245, 'auprc': 0.9977828121957697, 'loss_val': 0.22559273244382244, 'psi': 0.9617430271053427}
[S4] START round=18 head_norm_before_train=1.440499 cos_to_last_merge=0.9991 (last merge round=16)
[S4] round=18 local utility u=0.036202 metrics={'f1_val': 0.6217420991452002, 'auprc': 0.9425998442470573, 'loss_val': 0.5316851954911178, 'psi': 0.750085197185943}-{'f1_val': 0.6232161270009156, 'auprc': 0.9281840644594263, 'loss_val': 0.5696865172585407, 'psi': 0.7452033019843198}
[S5] START round=18 head_norm_before_train=1.819362 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9867448574416494, 'loss_val': 0.20004019840406362, 'psi': 0.8151423075412281}-{'f1_val': 0.7007406076076139, 'auprc': 0.9875741364694622, 'loss_val': 0.19122159820756168, 'psi': 0.8154740191523533}
[S6] START round=18 head_norm_before_train=1.599369 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.667666526641385, 'auprc': 0.8457633872349144, 'loss_val': 0.3663942425784821, 'psi': 0.7389052708787969}-{'f1_val': 0.9597196169961317, 'auprc': 0.958413965600967, 'loss_val': 0.25159168306645924, 'psi': 0.9591973564380659}
[S7] START round=18 head_norm_before_train=1.390325 cos_to_last_merge=0.8469 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=18 local utility u=1.000000 metrics={'f1_val': 0.6906390792435413, 'auprc': 0.8496441161109682, 'loss_val': 0.33693207002991576, 'psi': 0.7542410939905121}-{'f1_val': 0.4114582836335383, 'auprc': 0.7753689428696213, 'loss_val': 1.2387581647932902, 'psi': 0.5570225473279715}
[S8] START round=18 head_norm_before_train=1.665535 cos_to_last_merge=0.9995 (last merge round=16)
[S8] round=18 local utility u=0.057633 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9962614290369272, 'loss_val': 0.1731891612853855, 'psi': 0.9964882198787681}-{'f1_val': 0.9964894426023416, 'auprc': 0.9943586593197843, 'loss_val': 0.2818460261289687, 'psi': 0.9956371292893187}
[S9] START round=18 head_norm_before_train=1.923156 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9995713171001129, 'loss_val': 0.0308563147656079, 'psi': 0.9949356983534762}-{'f1_val': 0.9971029125121428, 'auprc': 0.999005513383326, 'loss_val': 0.023863122822686964, 'psi': 0.9978639528606161}
[S10] START round=18 head_norm_before_train=1.697518 (no previous merge yet)
[S10] round=18 local utility u=0.023616 metrics={'f1_val': 0.993593908338861, 'auprc': 0.9964717658990686, 'loss_val': 0.1338748635210732, 'psi': 0.9947450513629441}-{'f1_val': 0.9914086278631246, 'auprc': 0.9968506612794182, 'loss_val': 0.16913092869914656, 'psi': 0.9935854412296421}
[S11] START round=18 head_norm_before_train=1.270373 cos_to_last_merge=0.9988 (last merge round=16)
[S11] round=18 local utility u=0.037995 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9976065442668894, 'loss_val': 0.3136262253759299, 'psi': 0.8201646888603045}-{'f1_val': 0.7018701185892477, 'auprc': 0.9921413621310102, 'loss_val': 0.37321988361310476, 'psi': 0.8179786160059528}
[S13] START round=18 head_norm_before_train=1.681574 cos_to_last_merge=0.9996 (last merge round=16)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6520054164811352, 'auprc': 0.7026443799128879, 'loss_val': 0.5021533440251126, 'psi': 0.6722610018538362}-{'f1_val': 0.7094961316314848, 'auprc': 0.7238848547118886, 'loss_val': 0.44592848638234706, 'psi': 0.7152516208636464}
[S14] START round=18 head_norm_before_train=1.396151 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9247113816824098, 'auprc': 0.9990265799874873, 'loss_val': 0.23610892479599674, 'psi': 0.9544374610044408}-{'f1_val': 0.997240356705793, 'auprc': 0.9970021752004312, 'loss_val': 0.17432925995907564, 'psi': 0.9971450841036483}
[S15] START round=18 head_norm_before_train=1.721775 (no previous merge yet)
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9940710491672934, 'auprc': 0.989987661388839, 'loss_val': 0.09871350017471578, 'psi': 0.9924376940559116}-{'f1_val': 0.6968648933284182, 'auprc': 0.8504149905919062, 'loss_val': 0.39195174121084597, 'psi': 0.7582849322338134}
[S16] START round=18 head_norm_before_train=1.168455 cos_to_last_merge=0.9985 (last merge round=16)
[S16] round=18 local utility u=0.096972 metrics={'f1_val': 0.7941120698945667, 'auprc': 0.9060198407367418, 'loss_val': 0.5985567040848822, 'psi': 0.8388751782314368}-{'f1_val': 0.8262978921222774, 'auprc': 0.8421307604623974, 'loss_val': 0.7939492101915118, 'psi': 0.8326310394583254}
[S17] START round=18 head_norm_before_train=1.116682 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3534379704007371, 'auprc': 0.4245089499952668, 'loss_val': 1.0739313865181985, 'psi': 0.381866362238549}-{'f1_val': 0.3522371298123252, 'auprc': 0.7161510912136358, 'loss_val': 1.0334640327832538, 'psi': 0.4978027143728494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:41915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9922
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9869
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.9832
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.9236
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=-0.0736
[S15] DROPPED delta from S16 (cos=-0.0736 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.9454
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9810
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.8584 head_norm=1.631851
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.770231e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.8697 head_norm=1.641832 delta_norm=0.277023
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6520 head_norm=1.703283
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.097272e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6529 head_norm=1.720068 delta_norm=0.109727
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9247 head_norm=1.429473
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.355971e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9248 head_norm=1.448266 delta_norm=0.135597
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.6217 head_norm=1.479300
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.462078e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.7328 head_norm=1.430446 delta_norm=0.146208
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7941 head_norm=1.222554
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.505107e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.7953 head_norm=1.239913 delta_norm=0.250511
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9966 head_norm=1.697579
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.398031e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9966 head_norm=1.708692 delta_norm=0.139803
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.640766 cos_to_last_merge=0.9993 (last merge round=17)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.701248638813597, 'auprc': 0.7906483181790269, 'loss_val': 0.35338528567407684, 'psi': 0.737008510559769}-{'f1_val': 0.7020661798846572, 'auprc': 0.7923408830703154, 'loss_val': 0.36329071519212375, 'psi': 0.7381760611589205}
[S3] START round=19 head_norm_before_train=1.641832 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.6818480766888388, 'auprc': 0.8131438176115757, 'loss_val': 0.5633881715025153, 'psi': 0.7343663730579335}-{'f1_val': 0.8584403832936873, 'auprc': 0.8698603670057862, 'loss_val': 0.3096469092127483, 'psi': 0.8630083767785268}
[S4] START round=19 head_norm_before_train=1.430446 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.6200417059266665, 'auprc': 0.942100316718006, 'loss_val': 0.5418112629117992, 'psi': 0.7488651502432023}-{'f1_val': 0.6217420991452002, 'auprc': 0.9425998442470573, 'loss_val': 0.5316851954911178, 'psi': 0.750085197185943}
[S5] START round=19 head_norm_before_train=1.833275 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6599247590627275, 'auprc': 0.8616746714481244, 'loss_val': 0.41921237471589423, 'psi': 0.7406247240168862}-{'f1_val': 0.7007406076076139, 'auprc': 0.9867448574416494, 'loss_val': 0.20004019840406362, 'psi': 0.8151423075412281}
[S6] START round=19 head_norm_before_train=1.619718 (no previous merge yet)
[S6] round=19 local utility u=0.350027 metrics={'f1_val': 0.8196089044345585, 'auprc': 0.8049904268557115, 'loss_val': 0.45567617923898596, 'psi': 0.8137615134030197}-{'f1_val': 0.667666526641385, 'auprc': 0.8457633872349144, 'loss_val': 0.3663942425784821, 'psi': 0.7389052708787969}
[S7] START round=19 head_norm_before_train=1.395269 cos_to_last_merge=0.8462 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6063011421085805, 'auprc': 0.7839964210513763, 'loss_val': 0.6518775309729958, 'psi': 0.6773792536856988}-{'f1_val': 0.6906390792435413, 'auprc': 0.8496441161109682, 'loss_val': 0.33693207002991576, 'psi': 0.7542410939905121}
[S8] START round=19 head_norm_before_train=1.708692 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.009099 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9961075073964194, 'loss_val': 0.15453153432804678, 'psi': 0.9964269275472275}-{'f1_val': 0.9966394137733288, 'auprc': 0.9962614290369272, 'loss_val': 0.1731891612853855, 'psi': 0.9964882198787681}
[S9] START round=19 head_norm_before_train=1.944807 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.999576459944935, 'loss_val': 0.03640272843130221, 'psi': 0.9939201819087999}-{'f1_val': 0.9918452858557183, 'auprc': 0.9995713171001129, 'loss_val': 0.0308563147656079, 'psi': 0.9949356983534762}
[S10] START round=19 head_norm_before_train=1.731062 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9940946476266632, 'auprc': 0.991824477614353, 'loss_val': 0.13506744349792563, 'psi': 0.9931865796217392}-{'f1_val': 0.993593908338861, 'auprc': 0.9964717658990686, 'loss_val': 0.1338748635210732, 'psi': 0.9947450513629441}
[S11] START round=19 head_norm_before_train=1.306003 cos_to_last_merge=0.9952 (last merge round=16)
[S11] round=19 local utility u=0.021884 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9977489610074668, 'loss_val': 0.2702851901169931, 'psi': 0.8202216555565354}-{'f1_val': 0.7018701185892477, 'auprc': 0.9976065442668894, 'loss_val': 0.3136262253759299, 'psi': 0.8201646888603045}
[S13] START round=19 head_norm_before_train=1.720068 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6516420366586677, 'auprc': 0.6914982539842544, 'loss_val': 0.5030517781398016, 'psi': 0.6675845235889024}-{'f1_val': 0.6520054164811352, 'auprc': 0.7026443799128879, 'loss_val': 0.5021533440251126, 'psi': 0.6722610018538362}
[S14] START round=19 head_norm_before_train=1.448266 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.245192 metrics={'f1_val': 0.9963896402394217, 'auprc': 0.9970428544226214, 'loss_val': 0.16984424389197358, 'psi': 0.9966509259127015}-{'f1_val': 0.9247113816824098, 'auprc': 0.9990265799874873, 'loss_val': 0.23610892479599674, 'psi': 0.9544374610044408}
[S15] START round=19 head_norm_before_train=1.743610 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6984176069516687, 'auprc': 0.8020376981605899, 'loss_val': 0.44806722371757646, 'psi': 0.7398656434352371}-{'f1_val': 0.9940710491672934, 'auprc': 0.989987661388839, 'loss_val': 0.09871350017471578, 'psi': 0.9924376940559116}
[S16] START round=19 head_norm_before_train=1.239913 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.704870 metrics={'f1_val': 0.9345489675515, 'auprc': 0.9962191634846039, 'loss_val': 0.30203560174117167, 'psi': 0.9592170459247416}-{'f1_val': 0.7941120698945667, 'auprc': 0.9060198407367418, 'loss_val': 0.5985567040848822, 'psi': 0.8388751782314368}
[S17] START round=19 head_norm_before_train=1.132749 cos_to_last_merge=0.9955 (last merge round=17)
[S17] round=19 local utility u=0.266848 metrics={'f1_val': 0.36833253267546806, 'auprc': 0.521860634780896, 'loss_val': 0.9216584317661747, 'psi': 0.42974377351763926}-{'f1_val': 0.3534379704007371, 'auprc': 0.4245089499952668, 'loss_val': 1.0739313865181985, 'psi': 0.381866362238549}
[S11] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.959)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:41917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.8441
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9099
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=-0.0202
[S14] DROPPED delta from S17 (cos=-0.0202 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.347072
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.072939e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=1.382059 delta_norm=0.307294
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0219 p_local=0.0865 f1=0.702 auprc=0.998 bytes=17963
[S8] r=20 psi=0.996 u=0.0091 p_local=0.2501 f1=0.997 auprc=0.996 bytes=16187
[S13] r=20 psi=0.668 u=0.0000 p_local=0.1166 f1=0.652 auprc=0.691 bytes=16170
[S15] r=20 psi=0.740 u=0.0000 p_local=0.2928 f1=0.698 auprc=0.802 bytes=17981
[S9] r=20 psi=0.994 u=0.0000 p_local=0.0475 f1=0.990 auprc=1.000 bytes=16184
[S10] r=20 psi=0.993 u=0.0000 p_local=0.2081 f1=0.994 auprc=0.992 bytes=17983
[S7] r=20 psi=0.677 u=0.0000 p_local=0.3913 f1=0.606 auprc=0.784 bytes=17962
[S4] r=20 psi=0.749 u=0.0000 p_local=0.1459 f1=0.620 auprc=0.942 bytes=16177
[S3] r=20 psi=0.734 u=0.0000 p_local=0.1263 f1=0.682 auprc=0.813 bytes=12585
[S2] r=20 psi=0.737 u=0.0000 p_local=0.1007 f1=0.701 auprc=0.791 bytes=14385
[S5] r=20 psi=0.741 u=0.0000 p_local=0.1124 f1=0.660 auprc=0.862 bytes=10792
[S14] r=20 psi=0.997 u=0.2452 p_local=0.1848 f1=0.996 auprc=0.997 bytes=17974
[S6] r=20 psi=0.814 u=0.3500 p_local=0.3380 f1=0.820 auprc=0.805 bytes=17981
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3683 head_norm=1.156086
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.525181e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3559 head_norm=1.341877 delta_norm=0.452518
[S17] aggregate: ROLLBACK (f1_val pre=0.368 post=0.356 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.430 u=0.2668 p_local=0.1532 f1=0.368 auprc=0.522 bytes=14388
[S16] r=20 psi=0.959 u=0.7049 p_local=0.4370 f1=0.935 auprc=0.996 bytes=17966
[S2] START round=20 head_norm_before_train=1.667113 cos_to_last_merge=0.9977 (last merge round=17)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7007644397646647, 'auprc': 0.6616458775399848, 'loss_val': 0.33605445946841084, 'psi': 0.6851170148747927}-{'f1_val': 0.701248638813597, 'auprc': 0.7906483181790269, 'loss_val': 0.35338528567407684, 'psi': 0.737008510559769}
[S3] START round=20 head_norm_before_train=1.680782 cos_to_last_merge=0.9989 (last merge round=18)
[S3] round=20 local utility u=1.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9963970118703255, 'loss_val': 0.15129947949235523, 'psi': 0.9752816117798774}-{'f1_val': 0.6818480766888388, 'auprc': 0.8131438176115757, 'loss_val': 0.5633881715025153, 'psi': 0.7343663730579335}
[S4] START round=20 head_norm_before_train=1.462237 cos_to_last_merge=0.9993 (last merge round=18)
[S4] round=20 local utility u=0.044944 metrics={'f1_val': 0.6248807743210688, 'auprc': 0.9485223526705596, 'loss_val': 0.5002244368002486, 'psi': 0.7543374056608652}-{'f1_val': 0.6200417059266665, 'auprc': 0.942100316718006, 'loss_val': 0.5418112629117992, 'psi': 0.7488651502432023}
[S5] START round=20 head_norm_before_train=1.841430 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.4327009217559229, 'auprc': 0.8515317305114554, 'loss_val': 1.1380429769725249, 'psi': 0.6002332452581359}-{'f1_val': 0.6599247590627275, 'auprc': 0.8616746714481244, 'loss_val': 0.41921237471589423, 'psi': 0.7406247240168862}
[S6] START round=20 head_norm_before_train=1.635322 (no previous merge yet)
[S6] round=20 local utility u=0.306110 metrics={'f1_val': 0.82358411716587, 'auprc': 0.9594598190761667, 'loss_val': 0.3307150969663227, 'psi': 0.8779343979299887}-{'f1_val': 0.8196089044345585, 'auprc': 0.8049904268557115, 'loss_val': 0.45567617923898596, 'psi': 0.8137615134030197}
[S7] START round=20 head_norm_before_train=1.404790 cos_to_last_merge=0.8448 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.4913413331111586, 'auprc': 0.7791928574193878, 'loss_val': 0.9399316943903591, 'psi': 0.6064819428344503}-{'f1_val': 0.6063011421085805, 'auprc': 0.7839964210513763, 'loss_val': 0.6518775309729958, 'psi': 0.6773792536856988}
[S8] START round=20 head_norm_before_train=1.739699 cos_to_last_merge=0.9996 (last merge round=18)
[S8] round=20 local utility u=0.027550 metrics={'f1_val': 0.9969262142314774, 'auprc': 0.996184206892367, 'loss_val': 0.10137961621115336, 'psi': 0.9966294112958333}-{'f1_val': 0.9966398743144329, 'auprc': 0.9961075073964194, 'loss_val': 0.15453153432804678, 'psi': 0.9964269275472275}
[S9] START round=20 head_norm_before_train=1.964294 (no previous merge yet)
[S9] round=20 local utility u=0.023591 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9966896335914932, 'loss_val': 0.020778958849879223, 'psi': 0.9967874046919516}-{'f1_val': 0.9901493298847097, 'auprc': 0.999576459944935, 'loss_val': 0.03640272843130221, 'psi': 0.9939201819087999}
[S10] START round=20 head_norm_before_train=1.753953 (no previous merge yet)
[S10] round=20 local utility u=0.019543 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9968094363766258, 'loss_val': 0.10408814165081211, 'psi': 0.9944957205684454}-{'f1_val': 0.9940946476266632, 'auprc': 0.991824477614353, 'loss_val': 0.13506744349792563, 'psi': 0.9931865796217392}
[S11] START round=20 head_norm_before_train=1.382059 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.252612 metrics={'f1_val': 0.7893156071349249, 'auprc': 0.997659137895013, 'loss_val': 0.28946410380501664, 'psi': 0.8726530194389601}-{'f1_val': 0.7018701185892477, 'auprc': 0.9977489610074668, 'loss_val': 0.2702851901169931, 'psi': 0.8202216555565354}
[S13] START round=20 head_norm_before_train=1.736021 cos_to_last_merge=0.9998 (last merge round=18)
[S13] round=20 local utility u=0.009481 metrics={'f1_val': 0.6610800609320079, 'auprc': 0.6755962043041844, 'loss_val': 0.49301212984890447, 'psi': 0.6668865182808785}-{'f1_val': 0.6516420366586677, 'auprc': 0.6914982539842544, 'loss_val': 0.5030517781398016, 'psi': 0.6675845235889024}
[S14] START round=20 head_norm_before_train=1.481361 cos_to_last_merge=0.9994 (last merge round=18)
[S14] round=20 local utility u=0.027890 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9972939968922311, 'loss_val': 0.11860207027836571, 'psi': 0.9971297724306178}-{'f1_val': 0.9963896402394217, 'auprc': 0.9970428544226214, 'loss_val': 0.16984424389197358, 'psi': 0.9966509259127015}
[S15] START round=20 head_norm_before_train=1.759703 (no previous merge yet)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9833961141595653, 'auprc': 0.996643665107861, 'loss_val': 0.11758039717227059, 'psi': 0.9886951345388835}-{'f1_val': 0.6984176069516687, 'auprc': 0.8020376981605899, 'loss_val': 0.44806722371757646, 'psi': 0.7398656434352371}
[S16] START round=20 head_norm_before_train=1.287911 cos_to_last_merge=0.9988 (last merge round=18)
[S16] round=20 local utility u=0.216826 metrics={'f1_val': 0.9882473845602013, 'auprc': 0.993198642469908, 'loss_val': 0.18151352923877342, 'psi': 0.990227887724084}-{'f1_val': 0.9345489675515, 'auprc': 0.9962191634846039, 'loss_val': 0.30203560174117167, 'psi': 0.9592170459247416}
[S17] START round=20 head_norm_before_train=1.341877 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.38163500468446765, 'auprc': 0.4421953691155942, 'loss_val': 0.8766304835067666, 'psi': 0.4058591504569182}-{'f1_val': 0.36833253267546806, 'auprc': 0.521860634780896, 'loss_val': 0.9216584317661747, 'psi': 0.42974377351763926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S6] not sending this round → trigger blocked (psi=0.878)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.9244
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=-0.1034
[S16] DROPPED delta from S9 (cos=-0.1034 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=-0.0692
[S15] DROPPED delta from S16 (cos=-0.0692 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9791
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9951
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.0842
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.9861
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9907
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9683
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7008 head_norm=1.687855
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.783705e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7004 head_norm=1.709476 delta_norm=0.178370
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.081 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.313 → S4@127.0.0.1:41904
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9970 head_norm=1.526198
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.267152e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9970 head_norm=1.505904 delta_norm=0.126715
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.153 → S11@127.0.0.1:41912
[S6] ⇄ pheromone p=0.332 → S17@127.0.0.1:41917
[S5] ⇄ pheromone p=0.090 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=0.043 → S16@127.0.0.1:41916
[S15] ⇄ pheromone p=0.434 → S13@127.0.0.1:41913
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9969 head_norm=1.772696
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.211876e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9969 head_norm=1.770700 delta_norm=0.121188
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.206 → S3@127.0.0.1:41903
[S11] ⇄ pheromone p=0.120 → S16@127.0.0.1:41916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9612 head_norm=1.712555
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.213152e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9937 head_norm=1.728776 delta_norm=0.221315
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.301 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.126 → S14@127.0.0.1:41914
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6611 head_norm=1.749112
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.793217e-02
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6611 head_norm=1.758850 delta_norm=0.087932
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.095 → S2@127.0.0.1:41902
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9882 head_norm=1.344682
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.706063e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9887 head_norm=1.353631 delta_norm=0.270606
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.393 → S15@127.0.0.1:41915
[S10] ⇄ pheromone p=0.170 → S8@127.0.0.1:41909
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3816 head_norm=1.352624
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.045486e+00
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3801 head_norm=1.134979 delta_norm=1.045486
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.123 → S14@127.0.0.1:41914
[S2] START round=21 head_norm_before_train=1.709476 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.119761 metrics={'f1_val': 0.7130443305402467, 'auprc': 0.7889466019644558, 'loss_val': 0.5521145556892066, 'psi': 0.7434052391099304}-{'f1_val': 0.7007644397646647, 'auprc': 0.6616458775399848, 'loss_val': 0.33605445946841084, 'psi': 0.6851170148747927}
[S3] START round=21 head_norm_before_train=1.728776 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.115020 metrics={'f1_val': 0.997785879834771, 'auprc': 0.9979541832105941, 'loss_val': 0.14541781777496915, 'psi': 0.9978532011851002}-{'f1_val': 0.9612046783862453, 'auprc': 0.9963970118703255, 'loss_val': 0.15129947949235523, 'psi': 0.9752816117798774}
[S4] START round=21 head_norm_before_train=1.496103 cos_to_last_merge=0.9973 (last merge round=18)
[S4] round=21 local utility u=0.749576 metrics={'f1_val': 0.8679259638871933, 'auprc': 0.9478768952039691, 'loss_val': 0.45740746782243136, 'psi': 0.8999063364139037}-{'f1_val': 0.6248807743210688, 'auprc': 0.9485223526705596, 'loss_val': 0.5002244368002486, 'psi': 0.7543374056608652}
[S5] START round=21 head_norm_before_train=1.849970 (no previous merge yet)
[S5] round=21 local utility u=0.683562 metrics={'f1_val': 0.5735197178782001, 'auprc': 0.8529663791607632, 'loss_val': 0.6201349644425983, 'psi': 0.6852983823912253}-{'f1_val': 0.4327009217559229, 'auprc': 0.8515317305114554, 'loss_val': 1.1380429769725249, 'psi': 0.6002332452581359}
[S6] START round=21 head_norm_before_train=1.652335 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8224322740831848, 'auprc': 0.9563875735267986, 'loss_val': 0.35896979740098434, 'psi': 0.8760143938606303}-{'f1_val': 0.82358411716587, 'auprc': 0.9594598190761667, 'loss_val': 0.3307150969663227, 'psi': 0.8779343979299887}
[S7] START round=21 head_norm_before_train=1.416239 cos_to_last_merge=0.8436 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=21 local utility u=0.837807 metrics={'f1_val': 0.6676045023097337, 'auprc': 0.8198126969133791, 'loss_val': 0.44375677007397757, 'psi': 0.7284877801511919}-{'f1_val': 0.4913413331111586, 'auprc': 0.7791928574193878, 'loss_val': 0.9399316943903591, 'psi': 0.6064819428344503}
[S8] START round=21 head_norm_before_train=1.770700 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.005803 metrics={'f1_val': 0.996776381273096, 'auprc': 0.996646843414448, 'loss_val': 0.09026327078826409, 'psi': 0.9967245661296369}-{'f1_val': 0.9969262142314774, 'auprc': 0.996184206892367, 'loss_val': 0.10137961621115336, 'psi': 0.9966294112958333}
[S9] START round=21 head_norm_before_train=1.983297 (no previous merge yet)
[S9] round=21 local utility u=0.000674 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9995649571373098, 'loss_val': 0.020599876084801745, 'psi': 0.9971918691287858}-{'f1_val': 0.9968525854255906, 'auprc': 0.9966896335914932, 'loss_val': 0.020778958849879223, 'psi': 0.9967874046919516}
[S10] START round=21 head_norm_before_train=1.776986 (no previous merge yet)
[S10] round=21 local utility u=0.003669 metrics={'f1_val': 0.9934145738686673, 'auprc': 0.9936473899983007, 'loss_val': 0.09003232711767838, 'psi': 0.9935077003205206}-{'f1_val': 0.9929532433629917, 'auprc': 0.9968094363766258, 'loss_val': 0.10408814165081211, 'psi': 0.9944957205684454}
[S11] START round=21 head_norm_before_train=1.415246 cos_to_last_merge=0.9988 (last merge round=19)
[S11] round=21 local utility u=0.536852 metrics={'f1_val': 0.9579542338102968, 'auprc': 0.9974793288094519, 'loss_val': 0.2270530604341668, 'psi': 0.9737642718099588}-{'f1_val': 0.7893156071349249, 'auprc': 0.997659137895013, 'loss_val': 0.28946410380501664, 'psi': 0.8726530194389601}
[S13] START round=21 head_norm_before_train=1.758850 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6496672674850164, 'auprc': 0.6682957392730567, 'loss_val': 0.5158441714101002, 'psi': 0.6571186562002325}-{'f1_val': 0.6610800609320079, 'auprc': 0.6755962043041844, 'loss_val': 0.49301212984890447, 'psi': 0.6668865182808785}
[S14] START round=21 head_norm_before_train=1.505904 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.004045 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9986429837292506, 'loss_val': 0.11848080583819852, 'psi': 0.998061456389174}-{'f1_val': 0.9970202894562089, 'auprc': 0.9972939968922311, 'loss_val': 0.11860207027836571, 'psi': 0.9971297724306178}
[S15] START round=21 head_norm_before_train=1.772901 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6988157833113708, 'auprc': 0.9244922494836554, 'loss_val': 0.4079204455666273, 'psi': 0.7890863697802847}-{'f1_val': 0.9833961141595653, 'auprc': 0.996643665107861, 'loss_val': 0.11758039717227059, 'psi': 0.9886951345388835}
[S16] START round=21 head_norm_before_train=1.353631 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8699255997094338, 'auprc': 0.9917439063934439, 'loss_val': 0.49431697092876087, 'psi': 0.918652922383038}-{'f1_val': 0.9882473845602013, 'auprc': 0.993198642469908, 'loss_val': 0.18151352923877342, 'psi': 0.990227887724084}
[S17] START round=21 head_norm_before_train=1.134979 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.434912 metrics={'f1_val': 0.38925842337148936, 'auprc': 0.7044409093315152, 'loss_val': 0.8392837509077109, 'psi': 0.5153314177554997}-{'f1_val': 0.38163500468446765, 'auprc': 0.4421953691155942, 'loss_val': 0.8766304835067666, 'psi': 0.4058591504569182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S9] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S8] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → trigger blocked (psi=0.974)
[S3] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9807
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0859
[S16] DROPPED delta from S5 (cos=-0.0859 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9549
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.1899
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=0.0110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.9933
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9580 head_norm=1.453276
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.296277e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9594 head_norm=1.481939 delta_norm=0.229628
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.8679 head_norm=1.520354
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.517381e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9424 head_norm=1.467447 delta_norm=0.151738
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.544582
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.878543e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.189133 delta_norm=0.487854
[S14] aggregate: ACCEPT kept=['S17', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3893 head_norm=1.151181
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.423952e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3879 head_norm=1.124978 delta_norm=0.942395
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.726891 cos_to_last_merge=0.9996 (last merge round=20)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.696364482941425, 'auprc': 0.6582874216678971, 'loss_val': 0.3591285759944869, 'psi': 0.6811336584320138}-{'f1_val': 0.7130443305402467, 'auprc': 0.7889466019644558, 'loss_val': 0.5521145556892066, 'psi': 0.7434052391099304}
[S3] START round=22 head_norm_before_train=1.763777 cos_to_last_merge=0.9993 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.971305034200331, 'auprc': 0.9971493779406884, 'loss_val': 0.1323305156846559, 'psi': 0.981642771696474}-{'f1_val': 0.997785879834771, 'auprc': 0.9979541832105941, 'loss_val': 0.14541781777496915, 'psi': 0.9978532011851002}
[S4] START round=22 head_norm_before_train=1.467447 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.270929 metrics={'f1_val': 0.943824158159848, 'auprc': 0.9448376229850779, 'loss_val': 0.3618211992291865, 'psi': 0.94422954408994}-{'f1_val': 0.8679259638871933, 'auprc': 0.9478768952039691, 'loss_val': 0.45740746782243136, 'psi': 0.8999063364139037}
[S5] START round=22 head_norm_before_train=1.856551 (no previous merge yet)
[S5] round=22 local utility u=0.743820 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9761417111699127, 'loss_val': 0.2655934514225041, 'psi': 0.8109256911862028}-{'f1_val': 0.5735197178782001, 'auprc': 0.8529663791607632, 'loss_val': 0.6201349644425983, 'psi': 0.6852983823912253}
[S6] START round=22 head_norm_before_train=1.670730 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7863045182974545, 'auprc': 0.9095324743778153, 'loss_val': 0.5315126387207032, 'psi': 0.8355957007295989}-{'f1_val': 0.8224322740831848, 'auprc': 0.9563875735267986, 'loss_val': 0.35896979740098434, 'psi': 0.8760143938606303}
[S7] START round=22 head_norm_before_train=1.428766 cos_to_last_merge=0.8413 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.841
[S7] round=22 local utility u=0.015203 metrics={'f1_val': 0.6678339931261206, 'auprc': 0.8221522280605029, 'loss_val': 0.4217457941756363, 'psi': 0.7295612870998736}-{'f1_val': 0.6676045023097337, 'auprc': 0.8198126969133791, 'loss_val': 0.44375677007397757, 'psi': 0.7284877801511919}
[S8] START round=22 head_norm_before_train=1.801458 cos_to_last_merge=0.9997 (last merge round=20)
[S8] round=22 local utility u=0.007545 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9967350132102855, 'loss_val': 0.07371893993455457, 'psi': 0.9965880299225158}-{'f1_val': 0.996776381273096, 'auprc': 0.996646843414448, 'loss_val': 0.09026327078826409, 'psi': 0.9967245661296369}
[S9] START round=22 head_norm_before_train=2.003118 (no previous merge yet)
[S9] round=22 local utility u=0.004200 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9995631548104724, 'loss_val': 0.01965108004724291, 'psi': 0.9979368131795433}-{'f1_val': 0.9956098104564366, 'auprc': 0.9995649571373098, 'loss_val': 0.020599876084801745, 'psi': 0.9971918691287858}
[S10] START round=22 head_norm_before_train=1.801909 (no previous merge yet)
[S10] round=22 local utility u=0.004549 metrics={'f1_val': 0.9940718139004033, 'auprc': 0.9926216989106533, 'loss_val': 0.08180045649387305, 'psi': 0.9934917679045033}-{'f1_val': 0.9934145738686673, 'auprc': 0.9936473899983007, 'loss_val': 0.09003232711767838, 'psi': 0.9935077003205206}
[S11] START round=22 head_norm_before_train=1.481939 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.002965 metrics={'f1_val': 0.9574818886243408, 'auprc': 0.9977229782645481, 'loss_val': 0.21901970895954348, 'psi': 0.9735783244804237}-{'f1_val': 0.9579542338102968, 'auprc': 0.9974793288094519, 'loss_val': 0.2270530604341668, 'psi': 0.9737642718099588}
[S13] START round=22 head_norm_before_train=1.771530 cos_to_last_merge=0.9999 (last merge round=20)
[S13] round=22 local utility u=0.125590 metrics={'f1_val': 0.6802984273092096, 'auprc': 0.6704193181855417, 'loss_val': 0.4548218402325705, 'psi': 0.6763467836597424}-{'f1_val': 0.6496672674850164, 'auprc': 0.6682957392730567, 'loss_val': 0.5158441714101002, 'psi': 0.6571186562002325}
[S14] START round=22 head_norm_before_train=1.189133 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9971893422213808, 'auprc': 0.9985541227930594, 'loss_val': 0.19831608634770734, 'psi': 0.9977352544500522}-{'f1_val': 0.9976737714957896, 'auprc': 0.9986429837292506, 'loss_val': 0.11848080583819852, 'psi': 0.998061456389174}
[S15] START round=22 head_norm_before_train=1.783897 (no previous merge yet)
[S15] round=22 local utility u=0.376865 metrics={'f1_val': 0.7694771666156716, 'auprc': 0.9857142722888242, 'loss_val': 0.2618253825499839, 'psi': 0.8559720088849326}-{'f1_val': 0.6988157833113708, 'auprc': 0.9244922494836554, 'loss_val': 0.4079204455666273, 'psi': 0.7890863697802847}
[S16] START round=22 head_norm_before_train=1.402706 cos_to_last_merge=0.9989 (last merge round=20)
[S16] round=22 local utility u=0.534820 metrics={'f1_val': 0.9893381564180589, 'auprc': 0.9898165202452149, 'loss_val': 0.1353709926578082, 'psi': 0.9895295019489213}-{'f1_val': 0.8699255997094338, 'auprc': 0.9917439063934439, 'loss_val': 0.49431697092876087, 'psi': 0.918652922383038}
[S17] START round=22 head_norm_before_train=1.124978 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.024497 metrics={'f1_val': 0.38309741805572545, 'auprc': 0.7328052299394109, 'loss_val': 0.8384167356305429, 'psi': 0.5229805428091996}-{'f1_val': 0.38925842337148936, 'auprc': 0.7044409093315152, 'loss_val': 0.8392837509077109, 'psi': 0.5153314177554997}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:41909
[S4] not sending this round → trigger blocked (psi=0.944)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=-0.1062
[S16] DROPPED delta from S9 (cos=-0.1062 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9884
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=-0.0635
[S15] DROPPED delta from S16 (cos=-0.0635 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.9461
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0899
[S16] DROPPED delta from S5 (cos=-0.0899 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9967
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9933
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9916
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9792
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=0.1439
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9713 head_norm=1.799176
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.855169e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9951 head_norm=1.804943 delta_norm=0.185517
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6964 head_norm=1.742286
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.361682e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.6922 head_norm=1.759694 delta_norm=0.136168
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9438 head_norm=1.492919
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.912343e-02
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9442 head_norm=1.461930 delta_norm=0.099123
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9893 head_norm=1.454895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.461930e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9898 head_norm=1.466861 delta_norm=0.246193
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9972 head_norm=1.231140
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.775074e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9977 head_norm=0.898395 delta_norm=0.777507
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9965 head_norm=1.829601
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.054912e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.825377 delta_norm=0.105491
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6803 head_norm=1.787337
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.264899e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6824 head_norm=1.789790 delta_norm=0.072649
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.759694 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6836452036414299, 'auprc': 0.6530034867114819, 'loss_val': 0.38014173158287323, 'psi': 0.6713885168694507}-{'f1_val': 0.696364482941425, 'auprc': 0.6582874216678971, 'loss_val': 0.3591285759944869, 'psi': 0.6811336584320138}
[S3] START round=23 head_norm_before_train=1.804943 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9772134388999127, 'auprc': 0.9968657058515287, 'loss_val': 0.17629370468468053, 'psi': 0.9850743456805591}-{'f1_val': 0.971305034200331, 'auprc': 0.9971493779406884, 'loss_val': 0.1323305156846559, 'psi': 0.981642771696474}
[S4] START round=23 head_norm_before_train=1.461930 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.024025 metrics={'f1_val': 0.94490910870516, 'auprc': 0.9520332703626582, 'loss_val': 0.34186702258739393, 'psi': 0.9477587733681593}-{'f1_val': 0.943824158159848, 'auprc': 0.9448376229850779, 'loss_val': 0.3618211992291865, 'psi': 0.94422954408994}
[S5] START round=23 head_norm_before_train=1.866406 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6162929308428979, 'auprc': 0.8824758307072874, 'loss_val': 0.3941089872080584, 'psi': 0.7227660907886537}-{'f1_val': 0.7007816778637295, 'auprc': 0.9761417111699127, 'loss_val': 0.2655934514225041, 'psi': 0.8109256911862028}
[S6] START round=23 head_norm_before_train=1.688362 (no previous merge yet)
[S6] round=23 local utility u=0.701756 metrics={'f1_val': 0.94653941733759, 'auprc': 0.9639760958410941, 'loss_val': 0.25274031918255596, 'psi': 0.9535140887389917}-{'f1_val': 0.7863045182974545, 'auprc': 0.9095324743778153, 'loss_val': 0.5315126387207032, 'psi': 0.8355957007295989}
[S7] START round=23 head_norm_before_train=1.437123 cos_to_last_merge=0.8397 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.655858183629577, 'auprc': 0.8059360107950716, 'loss_val': 0.47354631838379524, 'psi': 0.7158893144957749}-{'f1_val': 0.6678339931261206, 'auprc': 0.8221522280605029, 'loss_val': 0.4217457941756363, 'psi': 0.7295612870998736}
[S8] START round=23 head_norm_before_train=1.825377 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.002179 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9966821524646844, 'loss_val': 0.07092125129432657, 'psi': 0.9967386897497315}-{'f1_val': 0.9964900410640029, 'auprc': 0.9967350132102855, 'loss_val': 0.07371893993455457, 'psi': 0.9965880299225158}
[S9] START round=23 head_norm_before_train=2.020888 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9995729486624845, 'loss_val': 0.023452546019641463, 'psi': 0.9963430033153333}-{'f1_val': 0.9968525854255906, 'auprc': 0.9995631548104724, 'loss_val': 0.01965108004724291, 'psi': 0.9979368131795433}
[S10] START round=23 head_norm_before_train=1.827244 (no previous merge yet)
[S10] round=23 local utility u=0.008470 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9968343593386929, 'loss_val': 0.07341296214129077, 'psi': 0.9947683539363718}-{'f1_val': 0.9940718139004033, 'auprc': 0.9926216989106533, 'loss_val': 0.08180045649387305, 'psi': 0.9934917679045033}
[S11] START round=23 head_norm_before_train=1.519166 cos_to_last_merge=0.9985 (last merge round=21)
[S11] round=23 local utility u=0.123965 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963643932100144, 'loss_val': 0.19892382103645617, 'psi': 0.9962259622319913}-{'f1_val': 0.9574818886243408, 'auprc': 0.9977229782645481, 'loss_val': 0.21901970895954348, 'psi': 0.9735783244804237}
[S13] START round=23 head_norm_before_train=1.789790 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6539308309336237, 'auprc': 0.6751790933490017, 'loss_val': 0.4921106179728945, 'psi': 0.6624301358997748}-{'f1_val': 0.6802984273092096, 'auprc': 0.6704193181855417, 'loss_val': 0.4548218402325705, 'psi': 0.6763467836597424}
[S14] START round=23 head_norm_before_train=0.898395 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9986983972664124, 'loss_val': 0.41050793327914875, 'psi': 0.9976915325802904}-{'f1_val': 0.9971893422213808, 'auprc': 0.9985541227930594, 'loss_val': 0.19831608634770734, 'psi': 0.9977352544500522}
[S15] START round=23 head_norm_before_train=1.795181 (no previous merge yet)
[S15] round=23 local utility u=0.065695 metrics={'f1_val': 0.7900506432531378, 'auprc': 0.9831055799773373, 'loss_val': 0.2460504719027166, 'psi': 0.8672726179428176}-{'f1_val': 0.7694771666156716, 'auprc': 0.9857142722888242, 'loss_val': 0.2618253825499839, 'psi': 0.8559720088849326}
[S16] START round=23 head_norm_before_train=1.466861 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9871573054907263, 'auprc': 0.9939852029004558, 'loss_val': 0.14621009041698044, 'psi': 0.9898884644546181}-{'f1_val': 0.9893381564180589, 'auprc': 0.9898165202452149, 'loss_val': 0.1353709926578082, 'psi': 0.9895295019489213}
[S17] START round=23 head_norm_before_train=1.143484 cos_to_last_merge=0.9968 (last merge round=21)
[S17] round=23 local utility u=0.177998 metrics={'f1_val': 0.3948554009619023, 'auprc': 0.7974911300890068, 'loss_val': 0.7470269207815716, 'psi': 0.5559096926127441}-{'f1_val': 0.38309741805572545, 'auprc': 0.7328052299394109, 'loss_val': 0.8384167356305429, 'psi': 0.5229805428091996}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S8] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.867)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.3782
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.6791
[S17] not sending this round → trigger blocked (psi=0.556)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9970 head_norm=0.943557
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.472141e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.119351 delta_norm=0.547214
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3949 head_norm=1.168622
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.316092e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3918 head_norm=1.202145 delta_norm=0.831609
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.775244 cos_to_last_merge=0.9997 (last merge round=22)
[S2] round=24 local utility u=0.069348 metrics={'f1_val': 0.6997909758261585, 'auprc': 0.6633772261619746, 'loss_val': 0.3694409267874534, 'psi': 0.6852254759604849}-{'f1_val': 0.6836452036414299, 'auprc': 0.6530034867114819, 'loss_val': 0.38014173158287323, 'psi': 0.6713885168694507}
[S3] START round=24 head_norm_before_train=1.842199 cos_to_last_merge=0.9993 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.8543240550460613, 'auprc': 0.9958331312088798, 'loss_val': 0.3435736177861319, 'psi': 0.9109276855111887}-{'f1_val': 0.9772134388999127, 'auprc': 0.9968657058515287, 'loss_val': 0.17629370468468053, 'psi': 0.9850743456805591}
[S4] START round=24 head_norm_before_train=1.488113 cos_to_last_merge=0.9993 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9085792058738322, 'auprc': 0.9212331991357987, 'loss_val': 0.42078436504584976, 'psi': 0.9136408031786187}-{'f1_val': 0.94490910870516, 'auprc': 0.9520332703626582, 'loss_val': 0.34186702258739393, 'psi': 0.9477587733681593}
[S5] START round=24 head_norm_before_train=1.875402 (no previous merge yet)
[S5] round=24 local utility u=0.022872 metrics={'f1_val': 0.662114313971206, 'auprc': 0.8526130615383445, 'loss_val': 0.5337048046033245, 'psi': 0.7383138129980614}-{'f1_val': 0.6162929308428979, 'auprc': 0.8824758307072874, 'loss_val': 0.3941089872080584, 'psi': 0.7227660907886537}
[S6] START round=24 head_norm_before_train=1.705220 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7850959887711776, 'auprc': 0.9366280234477584, 'loss_val': 0.4455651321977079, 'psi': 0.8457088026418099}-{'f1_val': 0.94653941733759, 'auprc': 0.9639760958410941, 'loss_val': 0.25274031918255596, 'psi': 0.9535140887389917}
[S7] START round=24 head_norm_before_train=1.445639 cos_to_last_merge=0.8385 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.839
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6121622667046911, 'auprc': 0.7954314036365897, 'loss_val': 0.5851415117444297, 'psi': 0.6854699214774506}-{'f1_val': 0.655858183629577, 'auprc': 0.8059360107950716, 'loss_val': 0.47354631838379524, 'psi': 0.7158893144957749}
[S8] START round=24 head_norm_before_train=1.851399 cos_to_last_merge=0.9998 (last merge round=22)
[S8] round=24 local utility u=0.004254 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9966360453888657, 'loss_val': 0.06055428489080737, 'psi': 0.9965480837169514}-{'f1_val': 0.996776381273096, 'auprc': 0.9966821524646844, 'loss_val': 0.07092125129432657, 'psi': 0.9967386897497315}
[S9] START round=24 head_norm_before_train=2.030470 (no previous merge yet)
[S9] round=24 local utility u=0.007587 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972154109494287, 'loss_val': 0.018686017092621597, 'psi': 0.9971479118870572}-{'f1_val': 0.9941897064172326, 'auprc': 0.9995729486624845, 'loss_val': 0.023452546019641463, 'psi': 0.9963430033153333}
[S10] START round=24 head_norm_before_train=1.848962 (no previous merge yet)
[S10] round=24 local utility u=0.004742 metrics={'f1_val': 0.994048225356002, 'auprc': 0.9968025598428585, 'loss_val': 0.06777616257255158, 'psi': 0.9951499591507447}-{'f1_val': 0.993391017001491, 'auprc': 0.9968343593386929, 'loss_val': 0.07341296214129077, 'psi': 0.9947683539363718}
[S11] START round=24 head_norm_before_train=1.560974 cos_to_last_merge=0.9946 (last merge round=21)
[S11] round=24 local utility u=0.041631 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974709881658452, 'loss_val': 0.12146090614366266, 'psi': 0.9969165979744918}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963643932100144, 'loss_val': 0.19892382103645617, 'psi': 0.9962259622319913}
[S13] START round=24 head_norm_before_train=1.801392 cos_to_last_merge=0.9999 (last merge round=22)
[S13] round=24 local utility u=0.114115 metrics={'f1_val': 0.6891582446475301, 'auprc': 0.6650323273345521, 'loss_val': 0.44480436316912936, 'psi': 0.6795078777223389}-{'f1_val': 0.6539308309336237, 'auprc': 0.6751790933490017, 'loss_val': 0.4921106179728945, 'psi': 0.6624301358997748}
[S14] START round=24 head_norm_before_train=1.119351 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.112491 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.997637246739737, 'loss_val': 0.17974367095893196, 'psi': 0.997007237662345}-{'f1_val': 0.9970202894562089, 'auprc': 0.9986983972664124, 'loss_val': 0.41050793327914875, 'psi': 0.9976915325802904}
[S15] START round=24 head_norm_before_train=1.811827 (no previous merge yet)
[S15] round=24 local utility u=0.589907 metrics={'f1_val': 0.9640753288906282, 'auprc': 0.9872286730039139, 'loss_val': 0.12275417189629753, 'psi': 0.9733366665359425}-{'f1_val': 0.7900506432531378, 'auprc': 0.9831055799773373, 'loss_val': 0.2460504719027166, 'psi': 0.8672726179428176}
[S16] START round=24 head_norm_before_train=1.511700 cos_to_last_merge=0.9991 (last merge round=22)
[S16] round=24 local utility u=0.022324 metrics={'f1_val': 0.9921680856569107, 'auprc': 0.9882865968029132, 'loss_val': 0.11453171418386944, 'psi': 0.9906154901153117}-{'f1_val': 0.9871573054907263, 'auprc': 0.9939852029004558, 'loss_val': 0.14621009041698044, 'psi': 0.9898884644546181}
[S17] START round=24 head_norm_before_train=1.202145 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.244093 metrics={'f1_val': 0.49376151345067043, 'auprc': 0.7525333994361294, 'loss_val': 0.7174050466221488, 'psi': 0.597270267844854}-{'f1_val': 0.3948554009619023, 'auprc': 0.7974911300890068, 'loss_val': 0.7470269207815716, 'psi': 0.5559096926127441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.9193
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9953
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.4879
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.9978
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.9804
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9847
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0941
[S16] DROPPED delta from S5 (cos=-0.0941 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=-0.0568
[S15] DROPPED delta from S16 (cos=-0.0568 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=-0.1061
[S16] DROPPED delta from S9 (cos=-0.1061 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] cosine check vs S13: cos=0.9921
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.2111
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.8543 head_norm=1.875922
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.637566e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.8764 head_norm=1.868139 delta_norm=0.163757
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.602028
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.464928e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.365782 delta_norm=0.346493
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9965 head_norm=1.874682
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.115974e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.871287 delta_norm=0.091160
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9922 head_norm=1.554556
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.581109e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9922 head_norm=1.570532 delta_norm=0.158111
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9966 head_norm=1.185050
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.560987e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9966 head_norm=0.936685 delta_norm=0.756099
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6892 head_norm=1.811167
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.078788e-02
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6894 head_norm=1.817561 delta_norm=0.060788
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.6998 head_norm=1.792173
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.136890e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.6996 head_norm=1.798104 delta_norm=0.113689
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.4938 head_norm=1.222205
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.013256e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6220 head_norm=1.307942 delta_norm=0.801326
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.798104 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.699430133224783, 'auprc': 0.6568634748688849, 'loss_val': 0.3553097932589826, 'psi': 0.6824034698824237}-{'f1_val': 0.6997909758261585, 'auprc': 0.6633772261619746, 'loss_val': 0.3694409267874534, 'psi': 0.6852254759604849}
[S3] START round=25 head_norm_before_train=1.868139 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.549511 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9971898502212262, 'loss_val': 0.10189693616596862, 'psi': 0.9967978991288531}-{'f1_val': 0.8543240550460613, 'auprc': 0.9958331312088798, 'loss_val': 0.3435736177861319, 'psi': 0.9109276855111887}
[S4] START round=25 head_norm_before_train=1.518221 cos_to_last_merge=0.9971 (last merge round=22)
[S4] round=25 local utility u=0.208270 metrics={'f1_val': 0.9393091253316115, 'auprc': 0.9588366212001027, 'loss_val': 0.3014346725446681, 'psi': 0.9471201236790079}-{'f1_val': 0.9085792058738322, 'auprc': 0.9212331991357987, 'loss_val': 0.42078436504584976, 'psi': 0.9136408031786187}
[S5] START round=25 head_norm_before_train=1.878260 (no previous merge yet)
[S5] round=25 local utility u=0.320600 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.9498363002089485, 'loss_val': 0.4159285956962928, 'psi': 0.8003785862396666}-{'f1_val': 0.662114313971206, 'auprc': 0.8526130615383445, 'loss_val': 0.5337048046033245, 'psi': 0.7383138129980614}
[S6] START round=25 head_norm_before_train=1.721973 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6909313881902676, 'auprc': 0.9435578583279991, 'loss_val': 0.6776396212631317, 'psi': 0.7919819762453602}-{'f1_val': 0.7850959887711776, 'auprc': 0.9366280234477584, 'loss_val': 0.4455651321977079, 'psi': 0.8457088026418099}
[S7] START round=25 head_norm_before_train=1.465153 cos_to_last_merge=0.8358 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.836
[S7] round=25 local utility u=0.119479 metrics={'f1_val': 0.6394315125368112, 'auprc': 0.8035623971830699, 'loss_val': 0.5341920141408907, 'psi': 0.7050838663953147}-{'f1_val': 0.6121622667046911, 'auprc': 0.7954314036365897, 'loss_val': 0.5851415117444297, 'psi': 0.6854699214774506}
[S8] START round=25 head_norm_before_train=1.871287 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000729 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9968273740240405, 'loss_val': 0.059673312666766835, 'psi': 0.996624974248018}-{'f1_val': 0.9964894426023416, 'auprc': 0.9966360453888657, 'loss_val': 0.06055428489080737, 'psi': 0.9965480837169514}
[S9] START round=25 head_norm_before_train=2.043678 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9991980631378925, 'loss_val': 0.045704988455904746, 'psi': 0.9923911653133648}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972154109494287, 'loss_val': 0.018686017092621597, 'psi': 0.9971479118870572}
[S10] START round=25 head_norm_before_train=1.872329 (no previous merge yet)
[S10] round=25 local utility u=0.000044 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941381477945872, 'loss_val': 0.0665328193304423, 'psi': 0.9947679625294596}-{'f1_val': 0.994048225356002, 'auprc': 0.9968025598428585, 'loss_val': 0.06777616257255158, 'psi': 0.9951499591507447}
[S11] START round=25 head_norm_before_train=1.365782 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9978353488216883, 'loss_val': 0.19202399081012467, 'psi': 0.9969593716741258}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974709881658452, 'loss_val': 0.12146090614366266, 'psi': 0.9969165979744918}
[S13] START round=25 head_norm_before_train=1.817561 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6163259520053324, 'auprc': 0.6774922252574793, 'loss_val': 0.6361562960486429, 'psi': 0.640792461306191}-{'f1_val': 0.6891582446475301, 'auprc': 0.6650323273345521, 'loss_val': 0.44480436316912936, 'psi': 0.6795078777223389}
[S14] START round=25 head_norm_before_train=0.936685 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9972338633037168, 'auprc': 0.9975250008357125, 'loss_val': 0.34309542500796636, 'psi': 0.9973503183165151}-{'f1_val': 0.9965872316107504, 'auprc': 0.997637246739737, 'loss_val': 0.17974367095893196, 'psi': 0.997007237662345}
[S15] START round=25 head_norm_before_train=1.825957 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6990050990390766, 'auprc': 0.9842840835401028, 'loss_val': 0.36984094430180764, 'psi': 0.8131166928394871}-{'f1_val': 0.9640753288906282, 'auprc': 0.9872286730039139, 'loss_val': 0.12275417189629753, 'psi': 0.9733366665359425}
[S16] START round=25 head_norm_before_train=1.570532 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.920667231523701, 'auprc': 0.9936422813296423, 'loss_val': 0.3245973145518984, 'psi': 0.9498572514460775}-{'f1_val': 0.9921680856569107, 'auprc': 0.9882865968029132, 'loss_val': 0.11453171418386944, 'psi': 0.9906154901153117}
[S17] START round=25 head_norm_before_train=1.307942 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.459843 metrics={'f1_val': 0.618909393508657, 'auprc': 0.7960650670844707, 'loss_val': 0.6792018729165609, 'psi': 0.6897716629389825}-{'f1_val': 0.49376151345067043, 'auprc': 0.7525333994361294, 'loss_val': 0.7174050466221488, 'psi': 0.597270267844854}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.800)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S8] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9840
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] cosine check vs S3: cos=0.1213
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.6135
[S17] not sending this round → trigger blocked (psi=0.690)
[S2] ⇄ pheromone p=0.047 → S17@127.0.0.1:41917
[S11] ⇄ pheromone p=0.106 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=0.016 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.198 → S17@127.0.0.1:41917
[S8] ⇄ pheromone p=0.070 → S3@127.0.0.1:41903
[S10] ⇄ pheromone p=0.058 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=0.284 → S13@127.0.0.1:41913
[S13] ⇄ pheromone p=0.062 → S2@127.0.0.1:41902
[S5] ⇄ pheromone p=0.229 → S16@127.0.0.1:41916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9972 head_norm=0.985594
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.137782e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9972 head_norm=1.147313 delta_norm=0.613778
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.069 → S11@127.0.0.1:41912
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9393 head_norm=1.553933
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.404445e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9397 head_norm=1.510753 delta_norm=0.140445
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.175 → S14@127.0.0.1:41914
[S7] ⇄ pheromone p=0.197 → S4@127.0.0.1:41904
[S3] ⇄ pheromone p=0.218 → S17@127.0.0.1:41917
[S16] ⇄ pheromone p=0.187 → S15@127.0.0.1:41915
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6189 head_norm=1.328123
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.090493e+00
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.4857 head_norm=1.222731 delta_norm=1.090493
[S17] aggregate: ROLLBACK (f1_val pre=0.619 post=0.486 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.232 → S14@127.0.0.1:41914
[S2] START round=26 head_norm_before_train=1.812670 cos_to_last_merge=0.9997 (last merge round=24)
[S2] round=26 local utility u=0.192964 metrics={'f1_val': 0.7090461232862513, 'auprc': 0.7906863876137203, 'loss_val': 0.42854686021067667, 'psi': 0.7417022290172389}-{'f1_val': 0.699430133224783, 'auprc': 0.6568634748688849, 'loss_val': 0.3553097932589826, 'psi': 0.6824034698824237}
[S3] START round=26 head_norm_before_train=1.898573 cos_to_last_merge=0.9996 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9330209969289994, 'auprc': 0.9965116238195938, 'loss_val': 0.16772270639019993, 'psi': 0.9584172476852371}-{'f1_val': 0.9965365984006044, 'auprc': 0.9971898502212262, 'loss_val': 0.10189693616596862, 'psi': 0.9967978991288531}
[S4] START round=26 head_norm_before_train=1.510753 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.002627 metrics={'f1_val': 0.9405152024796448, 'auprc': 0.9533892369259805, 'loss_val': 0.28707418315230726, 'psi': 0.9456648162581791}-{'f1_val': 0.9393091253316115, 'auprc': 0.9588366212001027, 'loss_val': 0.3014346725446681, 'psi': 0.9471201236790079}
[S5] START round=26 head_norm_before_train=1.885410 (no previous merge yet)
[S5] round=26 local utility u=0.126235 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.9834761293706473, 'loss_val': 0.2643773970915586, 'psi': 0.8138345179043461}-{'f1_val': 0.7007401102601454, 'auprc': 0.9498363002089485, 'loss_val': 0.4159285956962928, 'psi': 0.8003785862396666}
[S6] START round=26 head_norm_before_train=1.733019 (no previous merge yet)
[S6] round=26 local utility u=0.638428 metrics={'f1_val': 0.8333253398446285, 'auprc': 0.9607193639309789, 'loss_val': 0.3066315846362534, 'psi': 0.8842829494791686}-{'f1_val': 0.6909313881902676, 'auprc': 0.9435578583279991, 'loss_val': 0.6776396212631317, 'psi': 0.7919819762453602}
[S7] START round=26 head_norm_before_train=1.479694 cos_to_last_merge=0.8340 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.834
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4627068318720911, 'auprc': 0.7795487992635043, 'loss_val': 1.085479822154603, 'psi': 0.5894436188286564}-{'f1_val': 0.6394315125368112, 'auprc': 0.8035623971830699, 'loss_val': 0.5341920141408907, 'psi': 0.7050838663953147}
[S8] START round=26 head_norm_before_train=1.894577 cos_to_last_merge=0.9999 (last merge round=24)
[S8] round=26 local utility u=0.003827 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9971436827206512, 'loss_val': 0.05296782848835574, 'psi': 0.9967514977266623}-{'f1_val': 0.9964900410640029, 'auprc': 0.9968273740240405, 'loss_val': 0.059673312666766835, 'psi': 0.996624974248018}
[S9] START round=26 head_norm_before_train=2.058446 (no previous merge yet)
[S9] round=26 local utility u=0.013662 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9995866040544497, 'loss_val': 0.03482485008193798, 'psi': 0.994074435804537}-{'f1_val': 0.9878532334303461, 'auprc': 0.9991980631378925, 'loss_val': 0.045704988455904746, 'psi': 0.9923911653133648}
[S10] START round=26 head_norm_before_train=1.896973 (no previous merge yet)
[S10] round=26 local utility u=0.008440 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9963538286407354, 'loss_val': 0.05290401364178754, 'psi': 0.9953147400687059}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941381477945872, 'loss_val': 0.0665328193304423, 'psi': 0.9947679625294596}
[S11] START round=26 head_norm_before_train=1.402114 cos_to_last_merge=0.9991 (last merge round=24)
[S11] round=26 local utility u=0.025669 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977363637115271, 'loss_val': 0.14141904294094643, 'psi': 0.9970227481927646}-{'f1_val': 0.9963753869090841, 'auprc': 0.9978353488216883, 'loss_val': 0.19202399081012467, 'psi': 0.9969593716741258}
[S13] START round=26 head_norm_before_train=1.826810 cos_to_last_merge=0.9999 (last merge round=24)
[S13] round=26 local utility u=0.223903 metrics={'f1_val': 0.6689537148997058, 'auprc': 0.6655612299088421, 'loss_val': 0.46832356306931505, 'psi': 0.6675967209033603}-{'f1_val': 0.6163259520053324, 'auprc': 0.6774922252574793, 'loss_val': 0.6361562960486429, 'psi': 0.640792461306191}
[S14] START round=26 head_norm_before_train=1.147313 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.095851 metrics={'f1_val': 0.996603304611786, 'auprc': 0.9985995235973163, 'loss_val': 0.15083449483325037, 'psi': 0.9974017922059981}-{'f1_val': 0.9972338633037168, 'auprc': 0.9975250008357125, 'loss_val': 0.34309542500796636, 'psi': 0.9973503183165151}
[S15] START round=26 head_norm_before_train=1.836499 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7036357613241094, 'auprc': 0.966149870050988, 'loss_val': 0.40014262477758106, 'psi': 0.8086414048148609}-{'f1_val': 0.6990050990390766, 'auprc': 0.9842840835401028, 'loss_val': 0.36984094430180764, 'psi': 0.8131166928394871}
[S16] START round=26 head_norm_before_train=1.606266 cos_to_last_merge=0.9996 (last merge round=24)
[S16] round=26 local utility u=0.118647 metrics={'f1_val': 0.9386891733671948, 'auprc': 0.9957213570843824, 'loss_val': 0.20167137289832665, 'psi': 0.9615020468540698}-{'f1_val': 0.920667231523701, 'auprc': 0.9936422813296423, 'loss_val': 0.3245973145518984, 'psi': 0.9498572514460775}
[S17] START round=26 head_norm_before_train=1.222731 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.171754 metrics={'f1_val': 0.6644176226379819, 'auprc': 0.8239545971490683, 'loss_val': 0.6924118509358346, 'psi': 0.7282324124424164}-{'f1_val': 0.618909393508657, 'auprc': 0.7960650670844707, 'loss_val': 0.6792018729165609, 'psi': 0.6897716629389825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.9354
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0974
[S16] DROPPED delta from S5 (cos=-0.0974 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.9756
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=-0.1065
[S16] DROPPED delta from S9 (cos=-0.1065 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=-0.0520
[S15] DROPPED delta from S16 (cos=-0.0520 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9936
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.9461
[S17] RECEIVED delta(kind=head bytes=1806) from S2
[S17] cosine check vs S2: cos=0.5111
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9895
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.2986
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9963
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.2277
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9330 head_norm=1.922735
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.391858e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9366 head_norm=1.914181 delta_norm=0.139186
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9387 head_norm=1.640223
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.974877e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9391 head_norm=1.529992 delta_norm=0.197488
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9966 head_norm=1.205496
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.001469e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9977 head_norm=1.063214 delta_norm=0.300147
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9965 head_norm=1.438550
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.456146e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9965 head_norm=1.304222 delta_norm=0.245615
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7090 head_norm=1.829551
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.041264e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7073 head_norm=1.830711 delta_norm=0.104126
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9965 head_norm=1.915727
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.291237e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9965 head_norm=1.917624 delta_norm=0.082912
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6644 head_norm=1.242538
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.154869e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.7393 head_norm=1.132754 delta_norm=0.615487
[S17] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.830711 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6997909758261585, 'auprc': 0.6583301901011868, 'loss_val': 0.3438731173152161, 'psi': 0.6832066615361698}-{'f1_val': 0.7090461232862513, 'auprc': 0.7906863876137203, 'loss_val': 0.42854686021067667, 'psi': 0.7417022290172389}
[S3] START round=27 head_norm_before_train=1.914181 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.233602 metrics={'f1_val': 0.9977836939400636, 'auprc': 0.997804209918342, 'loss_val': 0.09297208060442064, 'psi': 0.997791900331375}-{'f1_val': 0.9330209969289994, 'auprc': 0.9965116238195938, 'loss_val': 0.16772270639019993, 'psi': 0.9584172476852371}
[S4] START round=27 head_norm_before_train=1.542764 cos_to_last_merge=0.9994 (last merge round=25)
[S4] round=27 local utility u=0.021604 metrics={'f1_val': 0.9409509425476951, 'auprc': 0.9636884431047793, 'loss_val': 0.2773791416403158, 'psi': 0.9500459427705288}-{'f1_val': 0.9405152024796448, 'auprc': 0.9533892369259805, 'loss_val': 0.28707418315230726, 'psi': 0.9456648162581791}
[S5] START round=27 head_norm_before_train=1.892686 (no previous merge yet)
[S5] round=27 local utility u=0.001911 metrics={'f1_val': 0.7664960674709972, 'auprc': 0.8960658001567523, 'loss_val': 0.39285986445094456, 'psi': 0.8183239605452992}-{'f1_val': 0.7007401102601454, 'auprc': 0.9834761293706473, 'loss_val': 0.2643773970915586, 'psi': 0.8138345179043461}
[S6] START round=27 head_norm_before_train=1.743547 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7605989610158292, 'auprc': 0.9420090777555103, 'loss_val': 0.6030244390763708, 'psi': 0.8331630077117017}-{'f1_val': 0.8333253398446285, 'auprc': 0.9607193639309789, 'loss_val': 0.3066315846362534, 'psi': 0.8842829494791686}
[S7] START round=27 head_norm_before_train=1.492069 cos_to_last_merge=0.8325 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.833
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6716554782901808, 'auprc': 0.8286742338969124, 'loss_val': 0.3707700094629064, 'psi': 0.7344629805328735}-{'f1_val': 0.4627068318720911, 'auprc': 0.7795487992635043, 'loss_val': 1.085479822154603, 'psi': 0.5894436188286564}
[S8] START round=27 head_norm_before_train=1.917624 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9940868374199181, 'auprc': 0.9908597154825501, 'loss_val': 0.06322564038528226, 'psi': 0.9927959886449709}-{'f1_val': 0.9964900410640029, 'auprc': 0.9971436827206512, 'loss_val': 0.05296782848835574, 'psi': 0.9967514977266623}
[S9] START round=27 head_norm_before_train=2.071446 (no previous merge yet)
[S9] round=27 local utility u=0.024415 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966967497749656, 'loss_val': 0.01754472531594875, 'psi': 0.996940447417272}-{'f1_val': 0.990399656971262, 'auprc': 0.9995866040544497, 'loss_val': 0.03482485008193798, 'psi': 0.994074435804537}
[S10] START round=27 head_norm_before_train=1.923096 (no previous merge yet)
[S10] round=27 local utility u=0.000408 metrics={'f1_val': 0.9944867328096639, 'auprc': 0.9952985990932737, 'loss_val': 0.048109786772723394, 'psi': 0.9948114793231078}-{'f1_val': 0.9946220143540194, 'auprc': 0.9963538286407354, 'loss_val': 0.05290401364178754, 'psi': 0.9953147400687059}
[S11] START round=27 head_norm_before_train=1.304222 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9958270125794024, 'auprc': 0.9978587303750194, 'loss_val': 0.19465917795512372, 'psi': 0.9966396996976492}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977363637115271, 'loss_val': 0.14141904294094643, 'psi': 0.9970227481927646}
[S13] START round=27 head_norm_before_train=1.837779 cos_to_last_merge=0.9997 (last merge round=24)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6340965032335084, 'auprc': 0.6730280298128138, 'loss_val': 0.5403055436543046, 'psi': 0.6496691138652306}-{'f1_val': 0.6689537148997058, 'auprc': 0.6655612299088421, 'loss_val': 0.46832356306931505, 'psi': 0.6675967209033603}
[S14] START round=27 head_norm_before_train=1.063214 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9968927214363228, 'loss_val': 0.18447717370677477, 'psi': 0.9968235531459908}-{'f1_val': 0.996603304611786, 'auprc': 0.9985995235973163, 'loss_val': 0.15083449483325037, 'psi': 0.9974017922059981}
[S15] START round=27 head_norm_before_train=1.849616 (no previous merge yet)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9882783665404316, 'auprc': 0.9921894495209256, 'loss_val': 0.07523017921744009, 'psi': 0.9898427997326291}-{'f1_val': 0.7036357613241094, 'auprc': 0.966149870050988, 'loss_val': 0.40014262477758106, 'psi': 0.8086414048148609}
[S16] START round=27 head_norm_before_train=1.529992 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.207906 metrics={'f1_val': 0.9912377353200558, 'auprc': 0.9967796413812282, 'loss_val': 0.1043251465309944, 'psi': 0.9934544977445248}-{'f1_val': 0.9386891733671948, 'auprc': 0.9957213570843824, 'loss_val': 0.20167137289832665, 'psi': 0.9615020468540698}
[S17] START round=27 head_norm_before_train=1.132754 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.4366777009477149, 'auprc': 0.7298959045773259, 'loss_val': 0.7122444672356119, 'psi': 0.5539649823995594}-{'f1_val': 0.6644176226379819, 'auprc': 0.8239545971490683, 'loss_val': 0.6924118509358346, 'psi': 0.7282324124424164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S3] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.4718
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0943
[S16] DROPPED delta from S5 (cos=-0.0943 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:41913
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.8973
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9877
[S15] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=0.9977
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=-0.0057
[S15] DROPPED delta from S16 (cos=-0.0057 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=-0.1049
[S16] DROPPED delta from S9 (cos=-0.1049 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S10
[S8] cosine check vs S10: cos=0.9982
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9941 head_norm=1.933947
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.789449e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9941 head_norm=1.940343 delta_norm=0.057894
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6341 head_norm=1.851085
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.377906e-02
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6339 head_norm=1.855762 delta_norm=0.063779
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9410 head_norm=1.575794
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.258573e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9410 head_norm=1.534644 delta_norm=0.125857
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9968 head_norm=1.116565
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.782900e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.312181 delta_norm=0.378290
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4367 head_norm=1.158701
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.607109e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4488 head_norm=1.340541 delta_norm=0.860711
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.845774 cos_to_last_merge=0.9998 (last merge round=26)
[S2] round=28 local utility u=0.071659 metrics={'f1_val': 0.7012985964239116, 'auprc': 0.7160059647351791, 'loss_val': 0.38262748724091483, 'psi': 0.7071815437484186}-{'f1_val': 0.6997909758261585, 'auprc': 0.6583301901011868, 'loss_val': 0.3438731173152161, 'psi': 0.6832066615361698}
[S3] START round=28 head_norm_before_train=1.932138 cos_to_last_merge=0.9998 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9954787135961665, 'auprc': 0.997564798730814, 'loss_val': 0.08908626521349179, 'psi': 0.9963131476500255}-{'f1_val': 0.9977836939400636, 'auprc': 0.997804209918342, 'loss_val': 0.09297208060442064, 'psi': 0.997791900331375}
[S4] START round=28 head_norm_before_train=1.534644 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9396456287176214, 'auprc': 0.9664063521424622, 'loss_val': 0.28922362835885645, 'psi': 0.9503499180875576}-{'f1_val': 0.9409509425476951, 'auprc': 0.9636884431047793, 'loss_val': 0.2773791416403158, 'psi': 0.9500459427705288}
[S5] START round=28 head_norm_before_train=1.904042 (no previous merge yet)
[S5] round=28 local utility u=0.981973 metrics={'f1_val': 0.996288981767675, 'auprc': 0.9920494768309478, 'loss_val': 0.09562273800110907, 'psi': 0.9945931797929841}-{'f1_val': 0.7664960674709972, 'auprc': 0.8960658001567523, 'loss_val': 0.39285986445094456, 'psi': 0.8183239605452992}
[S6] START round=28 head_norm_before_train=1.754359 (no previous merge yet)
[S6] round=28 local utility u=0.287777 metrics={'f1_val': 0.8223626981833329, 'auprc': 0.954617207718245, 'loss_val': 0.4358763771473892, 'psi': 0.8752645019972978}-{'f1_val': 0.7605989610158292, 'auprc': 0.9420090777555103, 'loss_val': 0.6030244390763708, 'psi': 0.8331630077117017}
[S7] START round=28 head_norm_before_train=1.502936 cos_to_last_merge=0.8310 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6657867147468526, 'auprc': 0.8164729285374177, 'loss_val': 0.40727955859163484, 'psi': 0.7260612002630786}-{'f1_val': 0.6716554782901808, 'auprc': 0.8286742338969124, 'loss_val': 0.3707700094629064, 'psi': 0.7344629805328735}
[S8] START round=28 head_norm_before_train=1.940343 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.023251 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9970455530438184, 'loss_val': 0.05141853129179158, 'psi': 0.9968840499813849}-{'f1_val': 0.9940868374199181, 'auprc': 0.9908597154825501, 'loss_val': 0.06322564038528226, 'psi': 0.9927959886449709}
[S9] START round=28 head_norm_before_train=2.084012 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9995769762453457, 'loss_val': 0.01931059586979187, 'psi': 0.9973442535469698}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966967497749656, 'loss_val': 0.01754472531594875, 'psi': 0.996940447417272}
[S10] START round=28 head_norm_before_train=1.948439 (no previous merge yet)
[S10] round=28 local utility u=0.002274 metrics={'f1_val': 0.9942674420396322, 'auprc': 0.9961349718474158, 'loss_val': 0.044755806814842085, 'psi': 0.9950144539627457}-{'f1_val': 0.9944867328096639, 'auprc': 0.9952985990932737, 'loss_val': 0.048109786772723394, 'psi': 0.9948114793231078}
[S11] START round=28 head_norm_before_train=1.344638 cos_to_last_merge=0.9990 (last merge round=26)
[S11] round=28 local utility u=0.028051 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975804135800741, 'loss_val': 0.1420429924911116, 'psi': 0.9969603681401834}-{'f1_val': 0.9958270125794024, 'auprc': 0.9978587303750194, 'loss_val': 0.19465917795512372, 'psi': 0.9966396996976492}
[S13] START round=28 head_norm_before_train=1.855762 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6119151446549232, 'auprc': 0.6761716243475493, 'loss_val': 0.6957814720617493, 'psi': 0.6376177365319737}-{'f1_val': 0.6340965032335084, 'auprc': 0.6730280298128138, 'loss_val': 0.5403055436543046, 'psi': 0.6496691138652306}
[S14] START round=28 head_norm_before_train=1.312181 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.039429 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969712552781675, 'loss_val': 0.10471411942121735, 'psi': 0.9967408410777172}-{'f1_val': 0.9967774409524363, 'auprc': 0.9968927214363228, 'loss_val': 0.18447717370677477, 'psi': 0.9968235531459908}
[S15] START round=28 head_norm_before_train=1.862612 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.702048082159032, 'auprc': 0.9074541444993552, 'loss_val': 0.48884551850284963, 'psi': 0.7842105070951613}-{'f1_val': 0.9882783665404316, 'auprc': 0.9921894495209256, 'loss_val': 0.07523017921744009, 'psi': 0.9898427997326291}
[S16] START round=28 head_norm_before_train=1.564132 cos_to_last_merge=0.9996 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9696802692339497, 'auprc': 0.987569517876495, 'loss_val': 0.1347739259042484, 'psi': 0.9768359686909678}-{'f1_val': 0.9912377353200558, 'auprc': 0.9967796413812282, 'loss_val': 0.1043251465309944, 'psi': 0.9934544977445248}
[S17] START round=28 head_norm_before_train=1.340541 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.7315411633085072, 'auprc': 0.8759770460621916, 'loss_val': 0.6151497107747149, 'psi': 0.789315516409981}-{'f1_val': 0.4366777009477149, 'auprc': 0.7298959045773259, 'loss_val': 0.7122444672356119, 'psi': 0.5539649823995594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] cosine check vs S2: cos=0.3339
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:41909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.2833
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9990
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:41916
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9694
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0979
[S16] DROPPED delta from S5 (cos=-0.0979 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.9734
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.1677
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9955 head_norm=1.951827
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.299269e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9971 head_norm=1.949509 delta_norm=0.129927
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9966 head_norm=1.364656
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.792375e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9966 head_norm=1.041486 delta_norm=0.879237
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9965 head_norm=1.393299
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.711724e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9965 head_norm=1.368388 delta_norm=0.171172
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9968 head_norm=1.955838
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.406558e-02
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9968 head_norm=1.963439 delta_norm=0.044066
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9697 head_norm=1.599219
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.005606e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9669 head_norm=1.486327 delta_norm=0.200561
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.7315 head_norm=1.361329
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.360078e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.7986 head_norm=1.142645 delta_norm=0.736008
[S17] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.860935 cos_to_last_merge=0.9991 (last merge round=26)
[S2] round=29 local utility u=0.068396 metrics={'f1_val': 0.7044090630992403, 'auprc': 0.7679824571137434, 'loss_val': 0.42042705872609687, 'psi': 0.7298384207050415}-{'f1_val': 0.7012985964239116, 'auprc': 0.7160059647351791, 'loss_val': 0.38262748724091483, 'psi': 0.7071815437484186}
[S3] START round=29 head_norm_before_train=1.949509 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9413718341791123, 'auprc': 0.9978486613088736, 'loss_val': 0.1794007377432051, 'psi': 0.9639625650310168}-{'f1_val': 0.9954787135961665, 'auprc': 0.997564798730814, 'loss_val': 0.08908626521349179, 'psi': 0.9963131476500255}
[S4] START round=29 head_norm_before_train=1.562703 cos_to_last_merge=0.9995 (last merge round=27)
[S4] round=29 local utility u=0.025121 metrics={'f1_val': 0.9414461341795272, 'auprc': 0.9748416864725099, 'loss_val': 0.2750909144323995, 'psi': 0.9548043550967202}-{'f1_val': 0.9396456287176214, 'auprc': 0.9664063521424622, 'loss_val': 0.28922362835885645, 'psi': 0.9503499180875576}
[S5] START round=29 head_norm_before_train=1.913401 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7705686086646026, 'auprc': 0.9894817463251459, 'loss_val': 0.2012464256640574, 'psi': 0.85813386372882}-{'f1_val': 0.996288981767675, 'auprc': 0.9920494768309478, 'loss_val': 0.09562273800110907, 'psi': 0.9945931797929841}
[S6] START round=29 head_norm_before_train=1.768163 (no previous merge yet)
[S6] round=29 local utility u=0.304481 metrics={'f1_val': 0.8987119830836485, 'auprc': 0.9545908269983158, 'loss_val': 0.2849318610739782, 'psi': 0.9210635206495155}-{'f1_val': 0.8223626981833329, 'auprc': 0.954617207718245, 'loss_val': 0.4358763771473892, 'psi': 0.8752645019972978}
[S7] START round=29 head_norm_before_train=1.511740 cos_to_last_merge=0.8293 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6016941508235285, 'auprc': 0.7919471511908059, 'loss_val': 0.6890464286005022, 'psi': 0.6777953509704395}-{'f1_val': 0.6657867147468526, 'auprc': 0.8164729285374177, 'loss_val': 0.40727955859163484, 'psi': 0.7260612002630786}
[S8] START round=29 head_norm_before_train=1.963439 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9963402451333164, 'auprc': 0.9960256844096836, 'loss_val': 0.049601810832753675, 'psi': 0.9962144208438634}-{'f1_val': 0.996776381273096, 'auprc': 0.9970455530438184, 'loss_val': 0.05141853129179158, 'psi': 0.9968840499813849}
[S9] START round=29 head_norm_before_train=2.092551 (no previous merge yet)
[S9] round=29 local utility u=0.000667 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9995745500503825, 'loss_val': 0.01799487154127975, 'psi': 0.9973459025459464}-{'f1_val': 0.9958557717480525, 'auprc': 0.9995769762453457, 'loss_val': 0.01931059586979187, 'psi': 0.9973442535469698}
[S10] START round=29 head_norm_before_train=1.971995 (no previous merge yet)
[S10] round=29 local utility u=0.000587 metrics={'f1_val': 0.9941340830097825, 'auprc': 0.9965875500894585, 'loss_val': 0.044139994887098855, 'psi': 0.9951154698416529}-{'f1_val': 0.9942674420396322, 'auprc': 0.9961349718474158, 'loss_val': 0.044755806814842085, 'psi': 0.9950144539627457}
[S11] START round=29 head_norm_before_train=1.368388 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9978914337701765, 'loss_val': 0.1568550261505973, 'psi': 0.9971267580677841}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975804135800741, 'loss_val': 0.1420429924911116, 'psi': 0.9969603681401834}
[S13] START round=29 head_norm_before_train=1.869808 cos_to_last_merge=0.9999 (last merge round=27)
[S13] round=29 local utility u=0.136832 metrics={'f1_val': 0.6343400907493577, 'auprc': 0.6728790687569504, 'loss_val': 0.5467897762043773, 'psi': 0.6497556819523947}-{'f1_val': 0.6119151446549232, 'auprc': 0.6761716243475493, 'loss_val': 0.6957814720617493, 'psi': 0.6376177365319737}
[S14] START round=29 head_norm_before_train=1.041486 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9965996961970629, 'auprc': 0.9987716122522716, 'loss_val': 0.2933885013327761, 'psi': 0.9974684626191463}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969712552781675, 'loss_val': 0.10471411942121735, 'psi': 0.9967408410777172}
[S15] START round=29 head_norm_before_train=1.875080 (no previous merge yet)
[S15] round=29 local utility u=0.919007 metrics={'f1_val': 0.9065039423713254, 'auprc': 0.9899057021449189, 'loss_val': 0.12492088329408498, 'psi': 0.9398646462807628}-{'f1_val': 0.702048082159032, 'auprc': 0.9074541444993552, 'loss_val': 0.48884551850284963, 'psi': 0.7842105070951613}
[S16] START round=29 head_norm_before_train=1.486327 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.098762 metrics={'f1_val': 0.9920875221017437, 'auprc': 0.9961260289580444, 'loss_val': 0.09736300708343536, 'psi': 0.9937029248442639}-{'f1_val': 0.9696802692339497, 'auprc': 0.987569517876495, 'loss_val': 0.1347739259042484, 'psi': 0.9768359686909678}
[S17] START round=29 head_norm_before_train=1.142645 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5125294155169132, 'auprc': 0.6835711976854885, 'loss_val': 0.7855362850178077, 'psi': 0.5809461283843433}-{'f1_val': 0.7315411633085072, 'auprc': 0.8759770460621916, 'loss_val': 0.6151497107747149, 'psi': 0.789315516409981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1790) from S4
[S14] cosine check vs S4: cos=0.6677
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.9937
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=0.0342
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=-0.1047
[S16] DROPPED delta from S9 (cos=-0.1047 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.6018
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.6489
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.9984
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9993
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9966 head_norm=1.084240
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.928366e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9966 head_norm=1.226516 delta_norm=0.592837
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9963 head_norm=1.979941
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.679948e-02
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9963 head_norm=1.986494 delta_norm=0.036799
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9065 head_norm=1.885184
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.190761e+00
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9272 head_norm=1.231267 delta_norm=1.190761
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6343 head_norm=1.879389
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.271157e-02
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6343 head_norm=1.881551 delta_norm=0.052712
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7044 head_norm=1.875722
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.055954e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7020 head_norm=1.874585 delta_norm=0.105595
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5125 head_norm=1.168850
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.745990e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5226 head_norm=1.216029 delta_norm=0.374599
[S17] aggregate: ACCEPT kept=['S6', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.874585 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.70856593985258, 'auprc': 0.6614617073441358, 'loss_val': 0.41656058307708677, 'psi': 0.6897242468492023}-{'f1_val': 0.7044090630992403, 'auprc': 0.7679824571137434, 'loss_val': 0.42042705872609687, 'psi': 0.7298384207050415}
[S3] START round=30 head_norm_before_train=1.973376 cos_to_last_merge=0.9997 (last merge round=28)
[S3] round=30 local utility u=0.136882 metrics={'f1_val': 0.9721635215590747, 'auprc': 0.9973116776288118, 'loss_val': 0.08877662501633864, 'psi': 0.9822227839869695}-{'f1_val': 0.9413718341791123, 'auprc': 0.9978486613088736, 'loss_val': 0.1794007377432051, 'psi': 0.9639625650310168}
[S4] START round=30 head_norm_before_train=1.592488 cos_to_last_merge=0.9981 (last merge round=27)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9406323046030916, 'auprc': 0.9674588091798237, 'loss_val': 0.28058105804595457, 'psi': 0.9513629064337845}-{'f1_val': 0.9414461341795272, 'auprc': 0.9748416864725099, 'loss_val': 0.2750909144323995, 'psi': 0.9548043550967202}
[S5] START round=30 head_norm_before_train=1.922305 (no previous merge yet)
[S5] round=30 local utility u=0.471454 metrics={'f1_val': 0.9237254025462076, 'auprc': 0.9846454148386194, 'loss_val': 0.16277118648990033, 'psi': 0.9480934074631724}-{'f1_val': 0.7705686086646026, 'auprc': 0.9894817463251459, 'loss_val': 0.2012464256640574, 'psi': 0.85813386372882}
[S6] START round=30 head_norm_before_train=1.782706 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8224832314241602, 'auprc': 0.9433021002471227, 'loss_val': 0.4375420839166554, 'psi': 0.8708107789533452}-{'f1_val': 0.8987119830836485, 'auprc': 0.9545908269983158, 'loss_val': 0.2849318610739782, 'psi': 0.9210635206495155}
[S7] START round=30 head_norm_before_train=1.522321 cos_to_last_merge=0.8275 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=30 local utility u=0.088002 metrics={'f1_val': 0.6163572765032149, 'auprc': 0.7979628025869941, 'loss_val': 0.6190690154491694, 'psi': 0.6889994869367266}-{'f1_val': 0.6016941508235285, 'auprc': 0.7919471511908059, 'loss_val': 0.6890464286005022, 'psi': 0.6777953509704395}
[S8] START round=30 head_norm_before_train=1.986494 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.003673 metrics={'f1_val': 0.996776381273096, 'auprc': 0.997126611579883, 'loss_val': 0.04817556011622284, 'psi': 0.9969164733958109}-{'f1_val': 0.9963402451333164, 'auprc': 0.9960256844096836, 'loss_val': 0.049601810832753675, 'psi': 0.9962144208438634}
[S9] START round=30 head_norm_before_train=2.103505 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9995749030386183, 'loss_val': 0.019722665991329203, 'psi': 0.9973434242642788}-{'f1_val': 0.9958601375429889, 'auprc': 0.9995745500503825, 'loss_val': 0.01799487154127975, 'psi': 0.9973459025459464}
[S10] START round=30 head_norm_before_train=1.993706 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9927602898432648, 'loss_val': 0.05604804098143596, 'psi': 0.994297988275544}-{'f1_val': 0.9941340830097825, 'auprc': 0.9965875500894585, 'loss_val': 0.044139994887098855, 'psi': 0.9951154698416529}
[S11] START round=30 head_norm_before_train=1.416193 cos_to_last_merge=0.9988 (last merge round=28)
[S11] round=30 local utility u=0.008338 metrics={'f1_val': 0.9931903943854588, 'auprc': 0.9978050308164743, 'loss_val': 0.11936030757024907, 'psi': 0.9950362489578649}-{'f1_val': 0.9966169742661891, 'auprc': 0.9978914337701765, 'loss_val': 0.1568550261505973, 'psi': 0.9971267580677841}
[S13] START round=30 head_norm_before_train=1.881551 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6153558839568056, 'auprc': 0.6831278399055418, 'loss_val': 0.6131416362082708, 'psi': 0.6424646663363001}-{'f1_val': 0.6343400907493577, 'auprc': 0.6728790687569504, 'loss_val': 0.5467897762043773, 'psi': 0.6497556819523947}
[S14] START round=30 head_norm_before_train=1.226516 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.065150 metrics={'f1_val': 0.9921980411779892, 'auprc': 0.9968892256462218, 'loss_val': 0.13103197771409816, 'psi': 0.9940745149652822}-{'f1_val': 0.9965996961970629, 'auprc': 0.9987716122522716, 'loss_val': 0.2933885013327761, 'psi': 0.9974684626191463}
[S15] START round=30 head_norm_before_train=1.231267 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.780837520287836, 'auprc': 0.9880310434435808, 'loss_val': 0.32074463830089633, 'psi': 0.863714929550134}-{'f1_val': 0.9065039423713254, 'auprc': 0.9899057021449189, 'loss_val': 0.12492088329408498, 'psi': 0.9398646462807628}
[S16] START round=30 head_norm_before_train=1.521164 cos_to_last_merge=0.9996 (last merge round=28)
[S16] round=30 local utility u=0.007164 metrics={'f1_val': 0.9916485959167856, 'auprc': 0.9973791575478659, 'loss_val': 0.08416162886097828, 'psi': 0.9939408205692177}-{'f1_val': 0.9920875221017437, 'auprc': 0.9961260289580444, 'loss_val': 0.09736300708343536, 'psi': 0.9937029248442639}
[S17] START round=30 head_norm_before_train=1.216029 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.917117 metrics={'f1_val': 0.6821233796039088, 'auprc': 0.9081263807148714, 'loss_val': 0.6425322048608537, 'psi': 0.7725245800482938}-{'f1_val': 0.5125294155169132, 'auprc': 0.6835711976854885, 'loss_val': 0.7855362850178077, 'psi': 0.5809461283843433}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:41912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.2877
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9924
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=0.9593
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9865
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.6269
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0965
[S16] DROPPED delta from S5 (cos=-0.0965 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.9827
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.2044
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9406 head_norm=1.615792
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.359651e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9409 head_norm=1.567891 delta_norm=0.135965
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.064 → S14@127.0.0.1:41914
[S6] ⇄ pheromone p=0.203 → S17@127.0.0.1:41917
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9722 head_norm=2.005688
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.233150e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9739 head_norm=1.998544 delta_norm=0.123315
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.123 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=0.020 → S8@127.0.0.1:41909
[S9] ⇄ pheromone p=0.009 → S16@127.0.0.1:41916
[S2] ⇄ pheromone p=0.051 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=0.061 → S2@127.0.0.1:41902
[S7] ⇄ pheromone p=0.184 → S4@127.0.0.1:41904
[S5] ⇄ pheromone p=0.306 → S16@127.0.0.1:41916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9922 head_norm=1.278677
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.952281e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9953 head_norm=0.978314 delta_norm=0.795228
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.048 → S11@127.0.0.1:41912
[S8] ⇄ pheromone p=0.027 → S3@127.0.0.1:41903
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9932 head_norm=1.463236
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.159100e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9932 head_norm=1.356989 delta_norm=0.215910
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.042 → S16@127.0.0.1:41916
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7808 head_norm=1.256659
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.224378e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8056 head_norm=1.270388 delta_norm=0.622438
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.342 → S13@127.0.0.1:41913
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9916 head_norm=1.556739
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.478577e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9916 head_norm=1.503458 delta_norm=0.147858
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.110 → S15@127.0.0.1:41915
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6821 head_norm=1.242560
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.016442e+00
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6790 head_norm=1.322957 delta_norm=1.016442
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.402 → S14@127.0.0.1:41914
[S2] START round=31 head_norm_before_train=1.887301 cos_to_last_merge=0.9999 (last merge round=29)
[S2] round=31 local utility u=0.164412 metrics={'f1_val': 0.706378238088704, 'auprc': 0.7765346279582876, 'loss_val': 0.4198294734924992, 'psi': 0.7344407940365375}-{'f1_val': 0.70856593985258, 'auprc': 0.6614617073441358, 'loss_val': 0.41656058307708677, 'psi': 0.6897242468492023}
[S3] START round=31 head_norm_before_train=1.998544 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.011395 metrics={'f1_val': 0.9776482385587265, 'auprc': 0.9991768768482484, 'loss_val': 0.10449018364052622, 'psi': 0.9862596938745353}-{'f1_val': 0.9721635215590747, 'auprc': 0.9973116776288118, 'loss_val': 0.08877662501633864, 'psi': 0.9822227839869695}
[S4] START round=31 head_norm_before_train=1.567891 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.012712 metrics={'f1_val': 0.9428283704881526, 'auprc': 0.9706601260693486, 'loss_val': 0.2779375743516964, 'psi': 0.953961072720631}-{'f1_val': 0.9406323046030916, 'auprc': 0.9674588091798237, 'loss_val': 0.28058105804595457, 'psi': 0.9513629064337845}
[S5] START round=31 head_norm_before_train=1.930722 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7404021742547562, 'auprc': 0.9609500074485884, 'loss_val': 0.2975084054469542, 'psi': 0.828621307532289}-{'f1_val': 0.9237254025462076, 'auprc': 0.9846454148386194, 'loss_val': 0.16277118648990033, 'psi': 0.9480934074631724}
[S6] START round=31 head_norm_before_train=1.794797 (no previous merge yet)
[S6] round=31 local utility u=0.582204 metrics={'f1_val': 0.9601980260542667, 'auprc': 0.9648186044301668, 'loss_val': 0.1639720463386529, 'psi': 0.9620462574046268}-{'f1_val': 0.8224832314241602, 'auprc': 0.9433021002471227, 'loss_val': 0.4375420839166554, 'psi': 0.8708107789533452}
[S7] START round=31 head_norm_before_train=1.530606 cos_to_last_merge=0.8262 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.826
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.49038463285221057, 'auprc': 0.7802663911339252, 'loss_val': 1.053692313107816, 'psi': 0.6063373361648965}-{'f1_val': 0.6163572765032149, 'auprc': 0.7979628025869941, 'loss_val': 0.6190690154491694, 'psi': 0.6889994869367266}
[S8] START round=31 head_norm_before_train=1.998995 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=31 local utility u=0.001646 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9971988904628133, 'loss_val': 0.04510090282994816, 'psi': 0.9969453849489829}-{'f1_val': 0.996776381273096, 'auprc': 0.997126611579883, 'loss_val': 0.04817556011622284, 'psi': 0.9969164733958109}
[S9] START round=31 head_norm_before_train=2.114877 (no previous merge yet)
[S9] round=31 local utility u=0.002837 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9981274572164385, 'loss_val': 0.01718833156632307, 'psi': 0.9975127303938611}-{'f1_val': 0.9958557717480525, 'auprc': 0.9995749030386183, 'loss_val': 0.019722665991329203, 'psi': 0.9973434242642788}
[S10] START round=31 head_norm_before_train=2.013551 (no previous merge yet)
[S10] round=31 local utility u=0.007524 metrics={'f1_val': 0.9948413794931923, 'auprc': 0.9942912369492317, 'loss_val': 0.0427014795396296, 'psi': 0.9946213224756081}-{'f1_val': 0.9953231205637304, 'auprc': 0.9927602898432648, 'loss_val': 0.05604804098143596, 'psi': 0.994297988275544}
[S11] START round=31 head_norm_before_train=1.356989 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9354907096202607, 'auprc': 0.9977925045340594, 'loss_val': 0.2727741811529246, 'psi': 0.9604114275857802}-{'f1_val': 0.9931903943854588, 'auprc': 0.9978050308164743, 'loss_val': 0.11936030757024907, 'psi': 0.9950362489578649}
[S13] START round=31 head_norm_before_train=1.889771 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.150653 metrics={'f1_val': 0.6526159779253682, 'auprc': 0.66954000805198, 'loss_val': 0.4946334061044534, 'psi': 0.6593855899760129}-{'f1_val': 0.6153558839568056, 'auprc': 0.6831278399055418, 'loss_val': 0.6131416362082708, 'psi': 0.6424646663363001}
[S14] START round=31 head_norm_before_train=0.978314 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.995601117868101, 'loss_val': 0.25490882788560953, 'psi': 0.9964526208209659}-{'f1_val': 0.9921980411779892, 'auprc': 0.9968892256462218, 'loss_val': 0.13103197771409816, 'psi': 0.9940745149652822}
[S15] START round=31 head_norm_before_train=1.270388 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.350495 metrics={'f1_val': 0.903196983438714, 'auprc': 0.9925187918281464, 'loss_val': 0.3673741450166511, 'psi': 0.938925706794487}-{'f1_val': 0.780837520287836, 'auprc': 0.9880310434435808, 'loss_val': 0.32074463830089633, 'psi': 0.863714929550134}
[S16] START round=31 head_norm_before_train=1.503458 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8454164813814888, 'auprc': 0.9922660646367872, 'loss_val': 0.6955430708745847, 'psi': 0.9041563146836082}-{'f1_val': 0.9916485959167856, 'auprc': 0.9973791575478659, 'loss_val': 0.08416162886097828, 'psi': 0.9939408205692177}
[S17] START round=31 head_norm_before_train=1.322957 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5844597817978324, 'auprc': 0.6948622219683359, 'loss_val': 0.8504657801447387, 'psi': 0.6286207578660339}-{'f1_val': 0.6821233796039088, 'auprc': 0.9081263807148714, 'loss_val': 0.6425322048608537, 'psi': 0.7725245800482938}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.9965
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] cosine check vs S15: cos=0.4661
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.3511
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.6246
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] cosine check vs S10: cos=0.9992
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9961
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=-0.1045
[S16] DROPPED delta from S9 (cos=-0.1045 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.8829
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] cosine check vs S2: cos=0.3672
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9968 head_norm=2.012648
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.097049e-02
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9968 head_norm=2.017703 delta_norm=0.040970
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.7064 head_norm=1.898676
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.407187e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.7051 head_norm=1.896119 delta_norm=0.084072
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9776 head_norm=2.029579
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.540241e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9789 head_norm=2.019326 delta_norm=0.085402
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9970 head_norm=1.029704
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.212234e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9970 head_norm=1.186911 delta_norm=0.621223
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6526 head_norm=1.897287
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.657070e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6514 head_norm=1.380913 delta_norm=0.865707
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5845 head_norm=1.344570
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.463567e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6256 head_norm=1.206074 delta_norm=0.346357
[S17] aggregate: ACCEPT kept=['S6', 'S3', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.896119 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7075257612608239, 'auprc': 0.7612338209037877, 'loss_val': 0.413179716417634, 'psi': 0.7290089851180095}-{'f1_val': 0.706378238088704, 'auprc': 0.7765346279582876, 'loss_val': 0.4198294734924992, 'psi': 0.7344407940365375}
[S3] START round=32 head_norm_before_train=2.019326 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9731159950073008, 'auprc': 0.9985633235868003, 'loss_val': 0.0965290811069234, 'psi': 0.9832949264391007}-{'f1_val': 0.9776482385587265, 'auprc': 0.9991768768482484, 'loss_val': 0.10449018364052622, 'psi': 0.9862596938745353}
[S4] START round=32 head_norm_before_train=1.590303 cos_to_last_merge=0.9997 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9437099358239924, 'auprc': 0.9647449731172862, 'loss_val': 0.27487020348338487, 'psi': 0.95212395074131}-{'f1_val': 0.9428283704881526, 'auprc': 0.9706601260693486, 'loss_val': 0.2779375743516964, 'psi': 0.953961072720631}
[S5] START round=32 head_norm_before_train=1.942750 (no previous merge yet)
[S5] round=32 local utility u=0.941428 metrics={'f1_val': 0.9966571988793669, 'auprc': 0.9928893047152153, 'loss_val': 0.04799971960570398, 'psi': 0.9951500412137063}-{'f1_val': 0.7404021742547562, 'auprc': 0.9609500074485884, 'loss_val': 0.2975084054469542, 'psi': 0.828621307532289}
[S6] START round=32 head_norm_before_train=1.802473 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6618419233560423, 'auprc': 0.9306599864983529, 'loss_val': 0.8410633151546469, 'psi': 0.7693691486129666}-{'f1_val': 0.9601980260542667, 'auprc': 0.9648186044301668, 'loss_val': 0.1639720463386529, 'psi': 0.9620462574046268}
[S7] START round=32 head_norm_before_train=1.537734 cos_to_last_merge=0.8252 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=32 local utility u=0.308485 metrics={'f1_val': 0.5563885319669292, 'auprc': 0.7822230560935517, 'loss_val': 0.8386153085946365, 'psi': 0.6467223416175782}-{'f1_val': 0.49038463285221057, 'auprc': 0.7802663911339252, 'loss_val': 1.053692313107816, 'psi': 0.6063373361648965}
[S8] START round=32 head_norm_before_train=2.017703 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9970290761933986, 'loss_val': 0.04606319907842512, 'psi': 0.9968774592412171}-{'f1_val': 0.996776381273096, 'auprc': 0.9971988904628133, 'loss_val': 0.04510090282994816, 'psi': 0.9969453849489829}
[S9] START round=32 head_norm_before_train=2.126153 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985881592851383, 'loss_val': 0.017181620906144567, 'psi': 0.9974315708023902}-{'f1_val': 0.9971029125121428, 'auprc': 0.9981274572164385, 'loss_val': 0.01718833156632307, 'psi': 0.9975127303938611}
[S10] START round=32 head_norm_before_train=2.023575 (no previous merge yet)
[S10] round=32 local utility u=0.001544 metrics={'f1_val': 0.9941835069003575, 'auprc': 0.9956231386608206, 'loss_val': 0.03966108989514426, 'psi': 0.9947593596045428}-{'f1_val': 0.9948413794931923, 'auprc': 0.9942912369492317, 'loss_val': 0.0427014795396296, 'psi': 0.9946213224756081}
[S11] START round=32 head_norm_before_train=1.401632 cos_to_last_merge=0.9989 (last merge round=30)
[S11] round=32 local utility u=0.264622 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9972212458910761, 'loss_val': 0.10670288807564368, 'psi': 0.996671598837747}-{'f1_val': 0.9354907096202607, 'auprc': 0.9977925045340594, 'loss_val': 0.2727741811529246, 'psi': 0.9604114275857802}
[S13] START round=32 head_norm_before_train=1.380913 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.591976820564016, 'auprc': 0.681346228310119, 'loss_val': 0.7259608518161782, 'psi': 0.6277245836624572}-{'f1_val': 0.6526159779253682, 'auprc': 0.66954000805198, 'loss_val': 0.4946334061044534, 'psi': 0.6593855899760129}
[S14] START round=32 head_norm_before_train=1.186911 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.075029 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9961718339998016, 'loss_val': 0.1064453200400187, 'psi': 0.9966691615284673}-{'f1_val': 0.9970202894562089, 'auprc': 0.995601117868101, 'loss_val': 0.25490882788560953, 'psi': 0.9964526208209659}
[S15] START round=32 head_norm_before_train=1.308831 cos_to_last_merge=0.9970 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7716976408396152, 'auprc': 0.9886729558982376, 'loss_val': 0.34085720735772734, 'psi': 0.8584877668630642}-{'f1_val': 0.903196983438714, 'auprc': 0.9925187918281464, 'loss_val': 0.3673741450166511, 'psi': 0.938925706794487}
[S16] START round=32 head_norm_before_train=1.537702 cos_to_last_merge=0.9996 (last merge round=30)
[S16] round=32 local utility u=0.752840 metrics={'f1_val': 0.9907994898050875, 'auprc': 0.9981037962151568, 'loss_val': 0.07967406896149433, 'psi': 0.9937212123691151}-{'f1_val': 0.8454164813814888, 'auprc': 0.9922660646367872, 'loss_val': 0.6955430708745847, 'psi': 0.9041563146836082}
[S17] START round=32 head_norm_before_train=1.206074 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.199429 metrics={'f1_val': 0.604272835869841, 'auprc': 0.7548938714578632, 'loss_val': 0.7505801766728601, 'psi': 0.6645212501050499}-{'f1_val': 0.5844597817978324, 'auprc': 0.6948622219683359, 'loss_val': 0.8504657801447387, 'psi': 0.6286207578660339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.8648
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.9819
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0969
[S16] DROPPED delta from S5 (cos=-0.0969 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.9708
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] cosine check vs S10: cos=0.9995
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.3012
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9437 head_norm=1.613343
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.101717e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9444 head_norm=1.575427 delta_norm=0.110172
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9968 head_norm=2.030152
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.194915e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9968 head_norm=2.031326 delta_norm=0.031949
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9970 head_norm=1.248942
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.329565e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9966 head_norm=1.000131 delta_norm=0.732957
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9908 head_norm=1.569481
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.566927e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9912 head_norm=1.498335 delta_norm=0.156693
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9963 head_norm=1.440782
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.883679e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.335055 delta_norm=0.188368
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.7717 head_norm=1.371998
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.940506e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.7782 head_norm=1.420404 delta_norm=0.394051
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.907455 cos_to_last_merge=0.9999 (last merge round=31)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.707126632467362, 'auprc': 0.7439339912688494, 'loss_val': 0.3619138190460947, 'psi': 0.721849575987957}-{'f1_val': 0.7075257612608239, 'auprc': 0.7612338209037877, 'loss_val': 0.413179716417634, 'psi': 0.7290089851180095}
[S3] START round=33 head_norm_before_train=2.045540 cos_to_last_merge=0.9997 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9169332730255593, 'auprc': 0.9962040103169356, 'loss_val': 0.18732261320064036, 'psi': 0.9486415679421097}-{'f1_val': 0.9731159950073008, 'auprc': 0.9985633235868003, 'loss_val': 0.0965290811069234, 'psi': 0.9832949264391007}
[S4] START round=33 head_norm_before_train=1.575427 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9412842582420422, 'auprc': 0.9487183035865304, 'loss_val': 0.2887902579640452, 'psi': 0.9442578763798375}-{'f1_val': 0.9437099358239924, 'auprc': 0.9647449731172862, 'loss_val': 0.27487020348338487, 'psi': 0.95212395074131}
[S5] START round=33 head_norm_before_train=1.953663 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9924307010124596, 'loss_val': 0.060585957075781245, 'psi': 0.9949934614920584}-{'f1_val': 0.9966571988793669, 'auprc': 0.9928893047152153, 'loss_val': 0.04799971960570398, 'psi': 0.9951500412137063}
[S6] START round=33 head_norm_before_train=1.808737 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6542624868556884, 'auprc': 0.9408174388835219, 'loss_val': 0.8512819604676749, 'psi': 0.7688844676668218}-{'f1_val': 0.6618419233560423, 'auprc': 0.9306599864983529, 'loss_val': 0.8410633151546469, 'psi': 0.7693691486129666}
[S7] START round=33 head_norm_before_train=1.544455 cos_to_last_merge=0.8242 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=33 local utility u=0.445472 metrics={'f1_val': 0.6348095437199834, 'auprc': 0.8036530799558007, 'loss_val': 0.4824883059586343, 'psi': 0.7023469582143104}-{'f1_val': 0.5563885319669292, 'auprc': 0.7822230560935517, 'loss_val': 0.8386153085946365, 'psi': 0.6467223416175782}
[S8] START round=33 head_norm_before_train=2.031326 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.001877 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9971839527602688, 'loss_val': 0.042773649339896, 'psi': 0.9969394098679651}-{'f1_val': 0.996776381273096, 'auprc': 0.9970290761933986, 'loss_val': 0.04606319907842512, 'psi': 0.9968774592412171}
[S9] START round=33 head_norm_before_train=2.131843 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9996075690953974, 'loss_val': 0.035845129538180816, 'psi': 0.9936601324552834}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985881592851383, 'loss_val': 0.017181620906144567, 'psi': 0.9974315708023902}
[S10] START round=33 head_norm_before_train=2.033001 (no previous merge yet)
[S10] round=33 local utility u=0.000581 metrics={'f1_val': 0.993924439075923, 'auprc': 0.9965930325663542, 'loss_val': 0.039854282965535205, 'psi': 0.9949918764720955}-{'f1_val': 0.9941835069003575, 'auprc': 0.9956231386608206, 'loss_val': 0.03966108989514426, 'psi': 0.9947593596045428}
[S11] START round=33 head_norm_before_train=1.335055 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9319652516564843, 'auprc': 0.9976638955620187, 'loss_val': 0.2637160929481174, 'psi': 0.958244709218698}-{'f1_val': 0.996305167468861, 'auprc': 0.9972212458910761, 'loss_val': 0.10670288807564368, 'psi': 0.996671598837747}
[S13] START round=33 head_norm_before_train=1.401188 cos_to_last_merge=0.9994 (last merge round=31)
[S13] round=33 local utility u=0.004671 metrics={'f1_val': 0.5925861242921944, 'auprc': 0.6833523487741815, 'loss_val': 0.7262940046645545, 'psi': 0.6288926140849892}-{'f1_val': 0.591976820564016, 'auprc': 0.681346228310119, 'loss_val': 0.7259608518161782, 'psi': 0.6277245836624572}
[S14] START round=33 head_norm_before_train=1.000131 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963318960121709, 'auprc': 0.9938165287586636, 'loss_val': 0.24097235618844298, 'psi': 0.995325749110768}-{'f1_val': 0.9970007132142444, 'auprc': 0.9961718339998016, 'loss_val': 0.1064453200400187, 'psi': 0.9966691615284673}
[S15] START round=33 head_norm_before_train=1.420404 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.532414 metrics={'f1_val': 0.9376813548380063, 'auprc': 0.9902757375541021, 'loss_val': 0.27674057447803097, 'psi': 0.9587191079244446}-{'f1_val': 0.7716976408396152, 'auprc': 0.9886729558982376, 'loss_val': 0.34085720735772734, 'psi': 0.8584877668630642}
[S16] START round=33 head_norm_before_train=1.498335 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9078668627751098, 'auprc': 0.9908516350298269, 'loss_val': 0.223438591581709, 'psi': 0.9410607716769965}-{'f1_val': 0.9907994898050875, 'auprc': 0.9981037962151568, 'loss_val': 0.07967406896149433, 'psi': 0.9937212123691151}
[S17] START round=33 head_norm_before_train=1.230902 cos_to_last_merge=0.9990 (last merge round=31)
[S17] round=33 local utility u=0.060266 metrics={'f1_val': 0.6323539811414993, 'auprc': 0.7322975817109707, 'loss_val': 0.7307453152155428, 'psi': 0.6723314213692879}-{'f1_val': 0.604272835869841, 'auprc': 0.7548938714578632, 'loss_val': 0.7505801766728601, 'psi': 0.6645212501050499}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:41909
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.9956
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.9163
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.6973
[S8] RECEIVED delta(kind=head bytes=1795) from S10
[S8] cosine check vs S10: cos=0.9996
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9952
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.7755
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9413 head_norm=1.600469
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.009632e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9413 head_norm=1.577348 delta_norm=0.080096
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9963 head_norm=1.050210
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.994434e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.088930 delta_norm=0.399443
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7071 head_norm=1.920527
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.172069e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7059 head_norm=1.643668 delta_norm=0.417207
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9169 head_norm=2.072864
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.799405e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9203 head_norm=2.057150 delta_norm=0.097994
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5926 head_norm=1.436311
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.657653e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5920 head_norm=1.339070 delta_norm=0.565765
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9968 head_norm=2.046015
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.771562e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9968 head_norm=2.045416 delta_norm=0.027716
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.643668 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7082105420149912, 'auprc': 0.6922334385350652, 'loss_val': 0.39434663663237923, 'psi': 0.7018197006230208}-{'f1_val': 0.707126632467362, 'auprc': 0.7439339912688494, 'loss_val': 0.3619138190460947, 'psi': 0.721849575987957}
[S3] START round=34 head_norm_before_train=2.057150 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.236937 metrics={'f1_val': 0.9804820437061291, 'auprc': 0.9981092563601472, 'loss_val': 0.10045760500900199, 'psi': 0.9875329287677364}-{'f1_val': 0.9169332730255593, 'auprc': 0.9962040103169356, 'loss_val': 0.18732261320064036, 'psi': 0.9486415679421097}
[S4] START round=34 head_norm_before_train=1.577348 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.023029 metrics={'f1_val': 0.9429651251769698, 'auprc': 0.9591832572238806, 'loss_val': 0.2842126746244107, 'psi': 0.9494523779957341}-{'f1_val': 0.9412842582420422, 'auprc': 0.9487183035865304, 'loss_val': 0.2887902579640452, 'psi': 0.9442578763798375}
[S5] START round=34 head_norm_before_train=1.961789 (no previous merge yet)
[S5] round=34 local utility u=0.002063 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.992871873338326, 'loss_val': 0.057783722712358314, 'psi': 0.9951699304224051}-{'f1_val': 0.9967019684784577, 'auprc': 0.9924307010124596, 'loss_val': 0.060585957075781245, 'psi': 0.9949934614920584}
[S6] START round=34 head_norm_before_train=1.812688 (no previous merge yet)
[S6] round=34 local utility u=0.762511 metrics={'f1_val': 0.8236469047148601, 'auprc': 0.948447782613546, 'loss_val': 0.36545733978269956, 'psi': 0.8735672558743345}-{'f1_val': 0.6542624868556884, 'auprc': 0.9408174388835219, 'loss_val': 0.8512819604676749, 'psi': 0.7688844676668218}
[S7] START round=34 head_norm_before_train=1.558007 cos_to_last_merge=0.8222 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=34 local utility u=0.055108 metrics={'f1_val': 0.6425027105836043, 'auprc': 0.8079910510441296, 'loss_val': 0.4314461605826473, 'psi': 0.7086980467678143}-{'f1_val': 0.6348095437199834, 'auprc': 0.8036530799558007, 'loss_val': 0.4824883059586343, 'psi': 0.7023469582143104}
[S8] START round=34 head_norm_before_train=2.045416 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963402451333164, 'auprc': 0.9948321746798185, 'loss_val': 0.04265578898352138, 'psi': 0.9957370169519173}-{'f1_val': 0.996776381273096, 'auprc': 0.9971839527602688, 'loss_val': 0.042773649339896, 'psi': 0.9969394098679651}
[S9] START round=34 head_norm_before_train=2.137274 (no previous merge yet)
[S9] round=34 local utility u=0.031962 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995996842456698, 'loss_val': 0.016344301601473953, 'psi': 0.9981016212055536}-{'f1_val': 0.9896951746952075, 'auprc': 0.9996075690953974, 'loss_val': 0.035845129538180816, 'psi': 0.9936601324552834}
[S10] START round=34 head_norm_before_train=2.045193 (no previous merge yet)
[S10] round=34 local utility u=0.000072 metrics={'f1_val': 0.9950444545353663, 'auprc': 0.9941510739186217, 'loss_val': 0.03910436194659658, 'psi': 0.9946871022886685}-{'f1_val': 0.993924439075923, 'auprc': 0.9965930325663542, 'loss_val': 0.039854282965535205, 'psi': 0.9949918764720955}
[S11] START round=34 head_norm_before_train=1.367049 cos_to_last_merge=0.9995 (last merge round=32)
[S11] round=34 local utility u=0.267169 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9972933533906642, 'loss_val': 0.11430645398775575, 'psi': 0.9967004418375822}-{'f1_val': 0.9319652516564843, 'auprc': 0.9976638955620187, 'loss_val': 0.2637160929481174, 'psi': 0.958244709218698}
[S13] START round=34 head_norm_before_train=1.339070 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.006350 metrics={'f1_val': 0.593515897187208, 'auprc': 0.6827644855583878, 'loss_val': 0.7174082138774085, 'psi': 0.62921533253568}-{'f1_val': 0.5925861242921944, 'auprc': 0.6833523487741815, 'loss_val': 0.7262940046645545, 'psi': 0.6288926140849892}
[S14] START round=34 head_norm_before_train=1.088930 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9967093280247181, 'loss_val': 0.3317291622055377, 'psi': 0.9966432829683813}-{'f1_val': 0.9963318960121709, 'auprc': 0.9938165287586636, 'loss_val': 0.24097235618844298, 'psi': 0.995325749110768}
[S15] START round=34 head_norm_before_train=1.470852 cos_to_last_merge=0.9954 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7736523036564676, 'auprc': 0.9872240730675879, 'loss_val': 0.3007520576598261, 'psi': 0.8590810114209158}-{'f1_val': 0.9376813548380063, 'auprc': 0.9902757375541021, 'loss_val': 0.27674057447803097, 'psi': 0.9587191079244446}
[S16] START round=34 head_norm_before_train=1.531644 cos_to_last_merge=0.9996 (last merge round=32)
[S16] round=34 local utility u=0.328745 metrics={'f1_val': 0.9914882651030885, 'auprc': 0.9927774905681767, 'loss_val': 0.07345421578553657, 'psi': 0.9920039552891238}-{'f1_val': 0.9078668627751098, 'auprc': 0.9908516350298269, 'loss_val': 0.223438591581709, 'psi': 0.9410607716769965}
[S17] START round=34 head_norm_before_train=1.260041 cos_to_last_merge=0.9964 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5616841712297362, 'auprc': 0.7445885109960113, 'loss_val': 0.7543235891666594, 'psi': 0.6348459071362462}-{'f1_val': 0.6323539811414993, 'auprc': 0.7322975817109707, 'loss_val': 0.7307453152155428, 'psi': 0.6723314213692879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S13] not sending this round → trigger blocked (psi=0.629)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S7] not sending this round → trigger blocked (psi=0.709)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S10] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.3287
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.9825
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=-0.1031
[S16] DROPPED delta from S9 (cos=-0.1031 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.5028
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.9194
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.7261
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.1006
[S16] DROPPED delta from S5 (cos=-0.1006 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9966 head_norm=1.127228
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.135216e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9966 head_norm=1.120248 delta_norm=0.813522
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.5617 head_norm=1.283968
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.437051e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.5715 head_norm=1.295201 delta_norm=0.343705
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.7737 head_norm=1.528785
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.114246e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.7764 head_norm=1.516754 delta_norm=0.311425
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9915 head_norm=1.567761
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.624505e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9915 head_norm=1.476244 delta_norm=0.162450
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.659035 cos_to_last_merge=0.9999 (last merge round=33)
[S2] round=35 local utility u=0.246446 metrics={'f1_val': 0.7083887867263761, 'auprc': 0.8505139467710509, 'loss_val': 0.3773657437791306, 'psi': 0.765238850744246}-{'f1_val': 0.7082105420149912, 'auprc': 0.6922334385350652, 'loss_val': 0.39434663663237923, 'psi': 0.7018197006230208}
[S3] START round=35 head_norm_before_train=2.087321 cos_to_last_merge=0.9997 (last merge round=33)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8829382775714083, 'auprc': 0.9845159382442065, 'loss_val': 0.24160195638439114, 'psi': 0.9235693418405275}-{'f1_val': 0.9804820437061291, 'auprc': 0.9981092563601472, 'loss_val': 0.10045760500900199, 'psi': 0.9875329287677364}
[S4] START round=35 head_norm_before_train=1.600907 cos_to_last_merge=0.9996 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9398121318663881, 'auprc': 0.926907773372553, 'loss_val': 0.304349359202035, 'psi': 0.9346503884688541}-{'f1_val': 0.9429651251769698, 'auprc': 0.9591832572238806, 'loss_val': 0.2842126746244107, 'psi': 0.9494523779957341}
[S5] START round=35 head_norm_before_train=1.975166 (no previous merge yet)
[S5] round=35 local utility u=0.022079 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9986204659965192, 'loss_val': 0.03307656242024491, 'psi': 0.9976899215652463}-{'f1_val': 0.9967019684784577, 'auprc': 0.992871873338326, 'loss_val': 0.057783722712358314, 'psi': 0.9951699304224051}
[S6] START round=35 head_norm_before_train=1.816889 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.730665250736143, 'auprc': 0.9316033623562747, 'loss_val': 0.7234856332364706, 'psi': 0.8110404953841956}-{'f1_val': 0.8236469047148601, 'auprc': 0.948447782613546, 'loss_val': 0.36545733978269956, 'psi': 0.8735672558743345}
[S7] START round=35 head_norm_before_train=1.571359 cos_to_last_merge=0.8202 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6457820304300222, 'auprc': 0.8044326898099854, 'loss_val': 0.5096680128618654, 'psi': 0.7092422941820076}-{'f1_val': 0.6425027105836043, 'auprc': 0.8079910510441296, 'loss_val': 0.4314461605826473, 'psi': 0.7086980467678143}
[S8] START round=35 head_norm_before_train=2.059077 cos_to_last_merge=0.9999 (last merge round=33)
[S8] round=35 local utility u=0.007861 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9970844100282653, 'loss_val': 0.03630771068358346, 'psi': 0.9968995927751638}-{'f1_val': 0.9963402451333164, 'auprc': 0.9948321746798185, 'loss_val': 0.04265578898352138, 'psi': 0.9957370169519173}
[S9] START round=35 head_norm_before_train=2.146255 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.999739563868453, 'loss_val': 0.045553582166756736, 'psi': 0.9924575693536576}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995996842456698, 'loss_val': 0.016344301601473953, 'psi': 0.9981016212055536}
[S10] START round=35 head_norm_before_train=2.058145 (no previous merge yet)
[S10] round=35 local utility u=0.001263 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9963417746505698, 'loss_val': 0.03789067759278504, 'psi': 0.9950373507669161}-{'f1_val': 0.9950444545353663, 'auprc': 0.9941510739186217, 'loss_val': 0.03910436194659658, 'psi': 0.9946871022886685}
[S11] START round=35 head_norm_before_train=1.397675 cos_to_last_merge=0.9983 (last merge round=32)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9963760705462275, 'auprc': 0.9965259109552139, 'loss_val': 0.11866752676153718, 'psi': 0.9964360067098221}-{'f1_val': 0.996305167468861, 'auprc': 0.9972933533906642, 'loss_val': 0.11430645398775575, 'psi': 0.9967004418375822}
[S13] START round=35 head_norm_before_train=1.370247 cos_to_last_merge=0.9986 (last merge round=33)
[S13] round=35 local utility u=0.045247 metrics={'f1_val': 0.6076179306320645, 'auprc': 0.6793257674888041, 'loss_val': 0.7012108854345634, 'psi': 0.6363010653747603}-{'f1_val': 0.593515897187208, 'auprc': 0.6827644855583878, 'loss_val': 0.7174082138774085, 'psi': 0.62921533253568}
[S14] START round=35 head_norm_before_train=1.120248 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.104009 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9954328139532809, 'loss_val': 0.12108802886169581, 'psi': 0.996253304406811}-{'f1_val': 0.9965992529308234, 'auprc': 0.9967093280247181, 'loss_val': 0.3317291622055377, 'psi': 0.9966432829683813}
[S15] START round=35 head_norm_before_train=1.516754 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7007588821358649, 'auprc': 0.9864473049830238, 'loss_val': 0.3654443503196206, 'psi': 0.8150342512747284}-{'f1_val': 0.7736523036564676, 'auprc': 0.9872240730675879, 'loss_val': 0.3007520576598261, 'psi': 0.8590810114209158}
[S16] START round=35 head_norm_before_train=1.476244 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9675041143112797, 'auprc': 0.990743442930901, 'loss_val': 0.14556735432171525, 'psi': 0.9767998457591283}-{'f1_val': 0.9914882651030885, 'auprc': 0.9927774905681767, 'loss_val': 0.07345421578553657, 'psi': 0.9920039552891238}
[S17] START round=35 head_norm_before_train=1.295201 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5807620189121354, 'auprc': 0.69929308952275, 'loss_val': 0.835150823364885, 'psi': 0.6281744471563813}-{'f1_val': 0.5616841712297362, 'auprc': 0.7445885109960113, 'loss_val': 0.7543235891666594, 'psi': 0.6348459071362462}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:41912
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.9570
[S8] RECEIVED delta(kind=head bytes=1798) from S10
[S8] cosine check vs S10: cos=0.9994
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.8270
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0961
[S16] DROPPED delta from S5 (cos=-0.0961 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.3230
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.9960
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.008 → S16@127.0.0.1:41916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.8829 head_norm=2.114179
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.622221e-02
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.8843 head_norm=2.090971 delta_norm=0.096222
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.079 → S8@127.0.0.1:41909
[S7] ⇄ pheromone p=0.158 → S4@127.0.0.1:41904
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9964 head_norm=1.426764
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.282593e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9964 head_norm=1.285994 delta_norm=0.228259
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.084 → S16@127.0.0.1:41916
[S4] ⇄ pheromone p=0.026 → S7@127.0.0.1:41908
[S14] ⇄ pheromone p=0.044 → S11@127.0.0.1:41912
[S10] ⇄ pheromone p=0.008 → S8@127.0.0.1:41909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9968 head_norm=2.071976
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.668294e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9968 head_norm=2.071624 delta_norm=0.036683
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.011 → S10@127.0.0.1:41911
[S13] ⇄ pheromone p=0.043 → S2@127.0.0.1:41902
[S15] ⇄ pheromone p=0.209 → S13@127.0.0.1:41913
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.7084 head_norm=1.677094
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.714395e-01
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.7084 head_norm=1.471506 delta_norm=0.471440
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.080 → S13@127.0.0.1:41913
[S16] ⇄ pheromone p=0.166 → S15@127.0.0.1:41915
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.5808 head_norm=1.320769
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.840223e-01
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.5828 head_norm=1.223537 delta_norm=0.884022
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.160 → S6@127.0.0.1:41907
[S2] START round=36 head_norm_before_train=1.471506 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.275921 metrics={'f1_val': 0.7722443777401922, 'auprc': 0.9017483128829359, 'loss_val': 0.3623604150482191, 'psi': 0.8240459517972897}-{'f1_val': 0.7083887867263761, 'auprc': 0.8505139467710509, 'loss_val': 0.3773657437791306, 'psi': 0.765238850744246}
[S3] START round=36 head_norm_before_train=2.090971 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8667042633215122, 'auprc': 0.984389271113459, 'loss_val': 0.2679714200290281, 'psi': 0.913778266438291}-{'f1_val': 0.8829382775714083, 'auprc': 0.9845159382442065, 'loss_val': 0.24160195638439114, 'psi': 0.9235693418405275}
[S4] START round=36 head_norm_before_train=1.619999 cos_to_last_merge=0.9987 (last merge round=33)
[S4] round=36 local utility u=0.047641 metrics={'f1_val': 0.9411472368548693, 'auprc': 0.9494124675577691, 'loss_val': 0.2845910742361513, 'psi': 0.9444533291360293}-{'f1_val': 0.9398121318663881, 'auprc': 0.926907773372553, 'loss_val': 0.304349359202035, 'psi': 0.9346503884688541}
[S5] START round=36 head_norm_before_train=1.992391 (no previous merge yet)
[S5] round=36 local utility u=0.003833 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.999459823017488, 'loss_val': 0.027927958560040933, 'psi': 0.9980256643736338}-{'f1_val': 0.9970695586110643, 'auprc': 0.9986204659965192, 'loss_val': 0.03307656242024491, 'psi': 0.9976899215652463}
[S6] START round=36 head_norm_before_train=1.827661 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7228607334581609, 'auprc': 0.93006425172375, 'loss_val': 0.756417781894016, 'psi': 0.8057421407643965}-{'f1_val': 0.730665250736143, 'auprc': 0.9316033623562747, 'loss_val': 0.7234856332364706, 'psi': 0.8110404953841956}
[S7] START round=36 head_norm_before_train=1.585002 cos_to_last_merge=0.8189 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=36 local utility u=0.222166 metrics={'f1_val': 0.6807413871560597, 'auprc': 0.825606630280519, 'loss_val': 0.33861479530111516, 'psi': 0.7386874844058434}-{'f1_val': 0.6457820304300222, 'auprc': 0.8044326898099854, 'loss_val': 0.5096680128618654, 'psi': 0.7092422941820076}
[S8] START round=36 head_norm_before_train=2.071624 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.997050530023445, 'loss_val': 0.0380002321025892, 'psi': 0.9968860407732356}-{'f1_val': 0.996776381273096, 'auprc': 0.9970844100282653, 'loss_val': 0.03630771068358346, 'psi': 0.9968995927751638}
[S9] START round=36 head_norm_before_train=2.153840 (no previous merge yet)
[S9] round=36 local utility u=0.042930 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995970239897831, 'loss_val': 0.016266214897976486, 'psi': 0.9981005571031989}-{'f1_val': 0.9876029063437939, 'auprc': 0.999739563868453, 'loss_val': 0.045553582166756736, 'psi': 0.9924575693536576}
[S10] START round=36 head_norm_before_train=2.071922 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.995702774193066, 'auprc': 0.9927770495499336, 'loss_val': 0.04245043973791291, 'psi': 0.994532484335813}-{'f1_val': 0.9941677348444804, 'auprc': 0.9963417746505698, 'loss_val': 0.03789067759278504, 'psi': 0.9950373507669161}
[S11] START round=36 head_norm_before_train=1.285994 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965264770330347, 'loss_val': 0.15396068535670054, 'psi': 0.9962907957611995}-{'f1_val': 0.9963760705462275, 'auprc': 0.9965259109552139, 'loss_val': 0.11866752676153718, 'psi': 0.9964360067098221}
[S13] START round=36 head_norm_before_train=1.400902 cos_to_last_merge=0.9954 (last merge round=33)
[S13] round=36 local utility u=0.005671 metrics={'f1_val': 0.6092393074850111, 'auprc': 0.6779004267066733, 'loss_val': 0.6953210801059924, 'psi': 0.6367037551736761}-{'f1_val': 0.6076179306320645, 'auprc': 0.6793257674888041, 'loss_val': 0.7012108854345634, 'psi': 0.6363010653747603}
[S14] START round=36 head_norm_before_train=1.173078 cos_to_last_merge=0.9988 (last merge round=34)
[S14] round=36 local utility u=0.019725 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9987011181567301, 'loss_val': 0.09016840480687813, 'psi': 0.9974331666057787}-{'f1_val': 0.9968002980424979, 'auprc': 0.9954328139532809, 'loss_val': 0.12108802886169581, 'psi': 0.996253304406811}
[S15] START round=36 head_norm_before_train=1.568399 cos_to_last_merge=0.9971 (last merge round=34)
[S15] round=36 local utility u=0.284966 metrics={'f1_val': 0.7798637274504018, 'auprc': 0.9870452437935014, 'loss_val': 0.2719356033628343, 'psi': 0.8627363339876417}-{'f1_val': 0.7007588821358649, 'auprc': 0.9864473049830238, 'loss_val': 0.3654443503196206, 'psi': 0.8150342512747284}
[S16] START round=36 head_norm_before_train=1.511285 cos_to_last_merge=0.9996 (last merge round=34)
[S16] round=36 local utility u=0.110361 metrics={'f1_val': 0.9907080132250206, 'auprc': 0.9982859659729023, 'loss_val': 0.08669535524866415, 'psi': 0.9937391943241732}-{'f1_val': 0.9675041143112797, 'auprc': 0.990743442930901, 'loss_val': 0.14556735432171525, 'psi': 0.9767998457591283}
[S17] START round=36 head_norm_before_train=1.223537 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.483539 metrics={'f1_val': 0.604327029328664, 'auprc': 0.9436780855681848, 'loss_val': 0.742618447020519, 'psi': 0.7400674518244723}-{'f1_val': 0.5807620189121354, 'auprc': 0.69929308952275, 'loss_val': 0.835150823364885, 'psi': 0.6281744471563813}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:41908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9925
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.8826
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.9502
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] cosine check vs S14: cos=0.4975
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.9925
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9486
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:41905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.4206
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=-0.1001
[S5] DROPPED delta from S16 (cos=-0.1001 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.7229 head_norm=1.835866
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.668092e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.7438 head_norm=1.311104 delta_norm=0.866809
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9411 head_norm=1.639981
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.012224e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9411 head_norm=1.615840 delta_norm=0.101222
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6807 head_norm=1.597759
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.012224e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6829 head_norm=1.615840 delta_norm=0.101222
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7799 head_norm=1.628400
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.827394e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7808 head_norm=1.484542 delta_norm=0.382739
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6092 head_norm=1.431439
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.375469e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6094 head_norm=1.446887 delta_norm=0.237547
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6043 head_norm=1.253115
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.204864e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6022 head_norm=1.070974 delta_norm=0.620486
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9907 head_norm=1.548212
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.538443e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9907 head_norm=1.568403 delta_norm=0.253844
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.500269 cos_to_last_merge=0.9996 (last merge round=35)
[S2] round=37 local utility u=0.048343 metrics={'f1_val': 0.7843064166642484, 'auprc': 0.9100657326725555, 'loss_val': 0.3629993874740415, 'psi': 0.8346101430675712}-{'f1_val': 0.7722443777401922, 'auprc': 0.9017483128829359, 'loss_val': 0.3623604150482191, 'psi': 0.8240459517972897}
[S3] START round=37 head_norm_before_train=2.115694 cos_to_last_merge=0.9998 (last merge round=35)
[S3] round=37 local utility u=0.495152 metrics={'f1_val': 0.9910766670913642, 'auprc': 0.9984369712117751, 'loss_val': 0.06604525731933189, 'psi': 0.9940207887395286}-{'f1_val': 0.8667042633215122, 'auprc': 0.984389271113459, 'loss_val': 0.2679714200290281, 'psi': 0.913778266438291}
[S4] START round=37 head_norm_before_train=1.615840 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9408697739284884, 'auprc': 0.9398792438283547, 'loss_val': 0.2925186634747463, 'psi': 0.9404735618884349}-{'f1_val': 0.9411472368548693, 'auprc': 0.9494124675577691, 'loss_val': 0.2845910742361513, 'psi': 0.9444533291360293}
[S5] START round=37 head_norm_before_train=2.000407 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952354524101295, 'loss_val': 0.041333515318793854, 'psi': 0.9961153620511264}-{'f1_val': 0.9970695586110643, 'auprc': 0.999459823017488, 'loss_val': 0.027927958560040933, 'psi': 0.9980256643736338}
[S6] START round=37 head_norm_before_train=1.311104 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6548552353591492, 'auprc': 0.8942884925161951, 'loss_val': 0.7033834192586135, 'psi': 0.7506285382219676}-{'f1_val': 0.7228607334581609, 'auprc': 0.93006425172375, 'loss_val': 0.756417781894016, 'psi': 0.8057421407643965}
[S7] START round=37 head_norm_before_train=1.615840 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6397967704181533, 'auprc': 0.8037126257753711, 'loss_val': 0.4858320575048145, 'psi': 0.7053631125610405}-{'f1_val': 0.6807413871560597, 'auprc': 0.825606630280519, 'loss_val': 0.33861479530111516, 'psi': 0.7386874844058434}
[S8] START round=37 head_norm_before_train=2.081011 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=37 local utility u=0.000448 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9967678188113459, 'loss_val': 0.03625615028381787, 'psi': 0.996772956288396}-{'f1_val': 0.996776381273096, 'auprc': 0.997050530023445, 'loss_val': 0.0380002321025892, 'psi': 0.9968860407732356}
[S9] START round=37 head_norm_before_train=2.161206 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9996047151885348, 'loss_val': 0.01978879094800439, 'psi': 0.9964558795931041}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995970239897831, 'loss_val': 0.016266214897976486, 'psi': 0.9981005571031989}
[S10] START round=37 head_norm_before_train=2.085811 (no previous merge yet)
[S10] round=37 local utility u=0.005895 metrics={'f1_val': 0.9946059470817044, 'auprc': 0.9964566175295048, 'loss_val': 0.035118604192481716, 'psi': 0.9953462152608245}-{'f1_val': 0.995702774193066, 'auprc': 0.9927770495499336, 'loss_val': 0.04245043973791291, 'psi': 0.994532484335813}
[S11] START round=37 head_norm_before_train=1.314733 cos_to_last_merge=0.9996 (last merge round=35)
[S11] round=37 local utility u=0.025102 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979609590714783, 'loss_val': 0.11053954643566041, 'psi': 0.997112586336745}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965264770330347, 'loss_val': 0.15396068535670054, 'psi': 0.9962907957611995}
[S13] START round=37 head_norm_before_train=1.446887 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.021227 metrics={'f1_val': 0.6141220166633589, 'auprc': 0.6756012619310147, 'loss_val': 0.6752666546015537, 'psi': 0.6387137147704212}-{'f1_val': 0.6092393074850111, 'auprc': 0.6779004267066733, 'loss_val': 0.6953210801059924, 'psi': 0.6367037551736761}
[S14] START round=37 head_norm_before_train=1.222162 cos_to_last_merge=0.9963 (last merge round=34)
[S14] round=37 local utility u=0.006381 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9985949410214162, 'loss_val': 0.07721993045566942, 'psi': 0.9974039843742208}-{'f1_val': 0.9965878655718112, 'auprc': 0.9987011181567301, 'loss_val': 0.09016840480687813, 'psi': 0.9974331666057787}
[S15] START round=37 head_norm_before_train=1.484542 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.701836 metrics={'f1_val': 0.9831467222042628, 'auprc': 0.9895931187939014, 'loss_val': 0.09560597002722965, 'psi': 0.9857252808401182}-{'f1_val': 0.7798637274504018, 'auprc': 0.9870452437935014, 'loss_val': 0.2719356033628343, 'psi': 0.8627363339876417}
[S16] START round=37 head_norm_before_train=1.568403 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9894381141848063, 'auprc': 0.9981502395626715, 'loss_val': 0.0794377728454342, 'psi': 0.9929229643359524}-{'f1_val': 0.9907080132250206, 'auprc': 0.9982859659729023, 'loss_val': 0.08669535524866415, 'psi': 0.9937391943241732}
[S17] START round=37 head_norm_before_train=1.070974 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.578820479068876, 'auprc': 0.7809305879396222, 'loss_val': 0.940439679346894, 'psi': 0.6596645226171745}-{'f1_val': 0.604327029328664, 'auprc': 0.9436780855681848, 'loss_val': 0.742618447020519, 'psi': 0.7400674518244723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] cosine check vs S2: cos=0.9860
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9968
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.9216
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9968
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9994
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S15] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:41914
[S16] RECEIVED delta(kind=head bytes=1807) from S15
[S16] cosine check vs S15: cos=0.9220
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S11
[S14] cosine check vs S11: cos=0.9805
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.8471
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9968 head_norm=2.092764
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.340656e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9968 head_norm=2.104052 delta_norm=0.043407
[S8] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9911 head_norm=2.137765
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.735217e-02
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9911 head_norm=2.113580 delta_norm=0.087352
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6141 head_norm=1.477762
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.290215e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6149 head_norm=1.499755 delta_norm=0.129022
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9831 head_norm=1.547459
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.013872e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9844 head_norm=1.482691 delta_norm=0.301387
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.5788 head_norm=1.102099
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.350176e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.5222 head_norm=1.134645 delta_norm=0.335018
[S17] aggregate: ROLLBACK (f1_val pre=0.579 post=0.522 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9894 head_norm=1.602901
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.123502e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9899 head_norm=1.544150 delta_norm=0.312350
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9966 head_norm=1.258845
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.370898e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.299201 delta_norm=0.137090
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.532332 cos_to_last_merge=0.9985 (last merge round=35)
[S2] round=38 local utility u=0.062694 metrics={'f1_val': 0.8286922163487666, 'auprc': 0.862613500687338, 'loss_val': 0.36156929581551733, 'psi': 0.8422607300841951}-{'f1_val': 0.7843064166642484, 'auprc': 0.9100657326725555, 'loss_val': 0.3629993874740415, 'psi': 0.8346101430675712}
[S3] START round=38 head_norm_before_train=2.113580 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.012326 metrics={'f1_val': 0.9943378498395343, 'auprc': 0.9989264400305284, 'loss_val': 0.06242804037355242, 'psi': 0.996173285915932}-{'f1_val': 0.9910766670913642, 'auprc': 0.9984369712117751, 'loss_val': 0.06604525731933189, 'psi': 0.9940207887395286}
[S4] START round=38 head_norm_before_train=1.636066 cos_to_last_merge=0.9998 (last merge round=36)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9404676801071312, 'auprc': 0.9347320095213305, 'loss_val': 0.2971012429514758, 'psi': 0.9381734118728109}-{'f1_val': 0.9408697739284884, 'auprc': 0.9398792438283547, 'loss_val': 0.2925186634747463, 'psi': 0.9404735618884349}
[S5] START round=38 head_norm_before_train=2.004917 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.992145769878336, 'loss_val': 0.04238968046780758, 'psi': 0.994879489038409}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952354524101295, 'loss_val': 0.041333515318793854, 'psi': 0.9961153620511264}
[S6] START round=38 head_norm_before_train=1.335008 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=38 local utility u=0.688573 metrics={'f1_val': 0.8218677125088243, 'auprc': 0.9442618368764587, 'loss_val': 0.4782323370699626, 'psi': 0.8708253622558781}-{'f1_val': 0.6548552353591492, 'auprc': 0.8942884925161951, 'loss_val': 0.7033834192586135, 'psi': 0.7506285382219676}
[S7] START round=38 head_norm_before_train=1.628562 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.61611708019475, 'auprc': 0.7953198303063748, 'loss_val': 0.69226255527034, 'psi': 0.6877981802393999}-{'f1_val': 0.6397967704181533, 'auprc': 0.8037126257753711, 'loss_val': 0.4858320575048145, 'psi': 0.7053631125610405}
[S8] START round=38 head_norm_before_train=2.104052 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.001475 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9972144130860805, 'loss_val': 0.03464501273889627, 'psi': 0.9969515939982898}-{'f1_val': 0.996776381273096, 'auprc': 0.9967678188113459, 'loss_val': 0.03625615028381787, 'psi': 0.996772956288396}
[S9] START round=38 head_norm_before_train=2.171528 (no previous merge yet)
[S9] round=38 local utility u=0.010006 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995990901158451, 'loss_val': 0.016237708674641086, 'psi': 0.9981013835536238}-{'f1_val': 0.994356655862817, 'auprc': 0.9996047151885348, 'loss_val': 0.01978879094800439, 'psi': 0.9964558795931041}
[S10] START round=38 head_norm_before_train=2.099284 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9927506390943126, 'loss_val': 0.03897929157548194, 'psi': 0.9942941279759632}-{'f1_val': 0.9946059470817044, 'auprc': 0.9964566175295048, 'loss_val': 0.035118604192481716, 'psi': 0.9953462152608245}
[S11] START round=38 head_norm_before_train=1.352311 cos_to_last_merge=0.9981 (last merge round=35)
[S11] round=38 local utility u=0.010656 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978195164000424, 'loss_val': 0.08880234660646229, 'psi': 0.9970560092681707}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979609590714783, 'loss_val': 0.11053954643566041, 'psi': 0.997112586336745}
[S13] START round=38 head_norm_before_train=1.499755 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6087135467828929, 'auprc': 0.6748092708118715, 'loss_val': 0.7487917153933463, 'psi': 0.6351518363944844}-{'f1_val': 0.6141220166633589, 'auprc': 0.6756012619310147, 'loss_val': 0.6752666546015537, 'psi': 0.6387137147704212}
[S14] START round=38 head_norm_before_train=1.299201 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.010217 metrics={'f1_val': 0.9968305862100909, 'auprc': 0.998948874841499, 'loss_val': 0.059170190187435925, 'psi': 0.9976779016626541}-{'f1_val': 0.9966100132760906, 'auprc': 0.9985949410214162, 'loss_val': 0.07721993045566942, 'psi': 0.9974039843742208}
[S15] START round=38 head_norm_before_train=1.482691 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9008169943392392, 'auprc': 0.9904397818787749, 'loss_val': 0.1413810552361164, 'psi': 0.9366661093550535}-{'f1_val': 0.9831467222042628, 'auprc': 0.9895931187939014, 'loss_val': 0.09560597002722965, 'psi': 0.9857252808401182}
[S16] START round=38 head_norm_before_train=1.544150 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9760556874273796, 'auprc': 0.992996733880763, 'loss_val': 0.13182542269384714, 'psi': 0.982832106008733}-{'f1_val': 0.9894381141848063, 'auprc': 0.9981502395626715, 'loss_val': 0.0794377728454342, 'psi': 0.9929229643359524}
[S17] START round=38 head_norm_before_train=1.134645 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.290736 metrics={'f1_val': 0.6058222848174498, 'auprc': 0.8850826982026794, 'loss_val': 0.8334356195933954, 'psi': 0.7175264501715417}-{'f1_val': 0.578820479068876, 'auprc': 0.7809305879396222, 'loss_val': 0.940439679346894, 'psi': 0.6596645226171745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.5478
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9924
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.9950
[S17] RECEIVED delta(kind=head bytes=1800) from S14
[S17] cosine check vs S14: cos=0.9364
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=0.9993
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9993
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S17
[S6] cosine check vs S17: cos=0.5478
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6087 head_norm=1.524211
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.900736e-02
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6090 head_norm=1.539372 delta_norm=0.079007
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8219 head_norm=1.372835
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.099623e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8206 head_norm=1.116546 delta_norm=0.609962
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9943 head_norm=2.135942
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.080296e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9948 head_norm=2.124735 delta_norm=0.040803
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9968 head_norm=1.332876
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.936109e-02
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9968 head_norm=1.360698 delta_norm=0.089361
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9968 head_norm=2.114256
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.080297e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9968 head_norm=2.124735 delta_norm=0.040803
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6058 head_norm=1.163092
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.497462e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6056 head_norm=1.107013 delta_norm=0.249746
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.558397 cos_to_last_merge=0.9972 (last merge round=35)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8269912673165528, 'auprc': 0.8647592592840448, 'loss_val': 0.36099387896133356, 'psi': 0.8420984641035496}-{'f1_val': 0.8286922163487666, 'auprc': 0.862613500687338, 'loss_val': 0.36156929581551733, 'psi': 0.8422607300841951}
[S3] START round=39 head_norm_before_train=2.124735 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9124109845812152, 'auprc': 0.9977105412323004, 'loss_val': 0.16928325778356024, 'psi': 0.9465308072416492}-{'f1_val': 0.9943378498395343, 'auprc': 0.9989264400305284, 'loss_val': 0.06242804037355242, 'psi': 0.996173285915932}
[S4] START round=39 head_norm_before_train=1.659005 cos_to_last_merge=0.9990 (last merge round=36)
[S4] round=39 local utility u=0.091789 metrics={'f1_val': 0.9452500102595128, 'auprc': 0.9788018699324612, 'loss_val': 0.27442764798440855, 'psi': 0.9586707541286922}-{'f1_val': 0.9404676801071312, 'auprc': 0.9347320095213305, 'loss_val': 0.2971012429514758, 'psi': 0.9381734118728109}
[S5] START round=39 head_norm_before_train=2.004407 (no previous merge yet)
[S5] round=39 local utility u=0.014681 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9989824860235632, 'loss_val': 0.0335375154068682, 'psi': 0.9976141754964999}-{'f1_val': 0.9967019684784577, 'auprc': 0.992145769878336, 'loss_val': 0.04238968046780758, 'psi': 0.994879489038409}
[S6] START round=39 head_norm_before_train=1.116546 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7265208890228003, 'auprc': 0.890496990608113, 'loss_val': 0.6384932150694981, 'psi': 0.7921113296569254}-{'f1_val': 0.8218677125088243, 'auprc': 0.9442618368764587, 'loss_val': 0.4782323370699626, 'psi': 0.8708253622558781}
[S7] START round=39 head_norm_before_train=1.638855 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.9858620745498392, 'auprc': 0.9830264799620303, 'loss_val': 0.1550264056096672, 'psi': 0.9847278367147156}-{'f1_val': 0.61611708019475, 'auprc': 0.7953198303063748, 'loss_val': 0.69226255527034, 'psi': 0.6877981802393999}
[S8] START round=39 head_norm_before_train=2.124735 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000170 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9973335669896237, 'loss_val': 0.03466335247123216, 'psi': 0.9969992555597071}-{'f1_val': 0.996776381273096, 'auprc': 0.9972144130860805, 'loss_val': 0.03464501273889627, 'psi': 0.9969515939982898}
[S9] START round=39 head_norm_before_train=2.176944 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9997038007739827, 'loss_val': 0.01796524415063832, 'psi': 0.9973775513281044}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995990901158451, 'loss_val': 0.016237708674641086, 'psi': 0.9981013835536238}
[S10] START round=39 head_norm_before_train=2.112226 (no previous merge yet)
[S10] round=39 local utility u=0.005875 metrics={'f1_val': 0.9946059470817044, 'auprc': 0.9963648445195661, 'loss_val': 0.033769370546385666, 'psi': 0.995309506056849}-{'f1_val': 0.9953231205637304, 'auprc': 0.9927506390943126, 'loss_val': 0.03897929157548194, 'psi': 0.9942941279759632}
[S11] START round=39 head_norm_before_train=1.393703 cos_to_last_merge=0.9958 (last merge round=35)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9912817849077695, 'auprc': 0.997670546515399, 'loss_val': 0.08819818952985055, 'psi': 0.9938372895508213}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978195164000424, 'loss_val': 0.08880234660646229, 'psi': 0.9970560092681707}
[S13] START round=39 head_norm_before_train=1.539372 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6027587630026678, 'auprc': 0.6760326377927411, 'loss_val': 0.7773770686929737, 'psi': 0.6320683129186971}-{'f1_val': 0.6087135467828929, 'auprc': 0.6748092708118715, 'loss_val': 0.7487917153933463, 'psi': 0.6351518363944844}
[S14] START round=39 head_norm_before_train=1.360698 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.003811 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9990378756079197, 'loss_val': 0.05049134468453588, 'psi': 0.9975811582088223}-{'f1_val': 0.9968305862100909, 'auprc': 0.998948874841499, 'loss_val': 0.059170190187435925, 'psi': 0.9976779016626541}
[S15] START round=39 head_norm_before_train=1.533926 cos_to_last_merge=0.9996 (last merge round=37)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7745595954409668, 'auprc': 0.9898216910313669, 'loss_val': 0.3133217569112148, 'psi': 0.8606644336771268}-{'f1_val': 0.9008169943392392, 'auprc': 0.9904397818787749, 'loss_val': 0.1413810552361164, 'psi': 0.9366661093550535}
[S16] START round=39 head_norm_before_train=1.576879 cos_to_last_merge=0.9997 (last merge round=37)
[S16] round=39 local utility u=0.076858 metrics={'f1_val': 0.9916799325754928, 'auprc': 0.9926003953093252, 'loss_val': 0.07066527499839227, 'psi': 0.9920481176690257}-{'f1_val': 0.9760556874273796, 'auprc': 0.992996733880763, 'loss_val': 0.13182542269384714, 'psi': 0.982832106008733}
[S17] START round=39 head_norm_before_train=1.107013 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6412221193356447, 'auprc': 0.6763307338201524, 'loss_val': 0.8822255777957395, 'psi': 0.6552655651294477}-{'f1_val': 0.6058222848174498, 'auprc': 0.8850826982026794, 'loss_val': 0.8334356195933954, 'psi': 0.7175264501715417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:41905
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:41917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9978
[S17] RECEIVED delta(kind=head bytes=1794) from S14
[S17] cosine check vs S14: cos=0.8679
[S8] RECEIVED delta(kind=head bytes=1795) from S10
[S8] cosine check vs S10: cos=0.9980
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=-0.0827
[S5] DROPPED delta from S16 (cos=-0.0827 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9978
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0094 f1=0.996 auprc=1.000 bytes=34169
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9124 head_norm=2.151254
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.268545e-02
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9124 head_norm=2.141503 delta_norm=0.022685
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.947 u=0.0000 p_local=0.0977 f1=0.912 auprc=0.998 bytes=26980
[S2] r=40 psi=0.842 u=0.0000 p_local=0.0771 f1=0.827 auprc=0.865 bytes=32401
[S5] r=40 psi=0.998 u=0.0147 p_local=0.0858 f1=0.997 auprc=0.999 bytes=32371
[S13] r=40 psi=0.632 u=0.0000 p_local=0.0209 f1=0.603 auprc=0.676 bytes=34161
[S11] r=40 psi=0.994 u=0.0000 p_local=0.0392 f1=0.991 auprc=0.998 bytes=35924
[S6] r=40 psi=0.792 u=0.0000 p_local=0.2069 f1=0.727 auprc=0.890 bytes=30588
[S16] r=40 psi=0.992 u=0.0769 p_local=0.0945 f1=0.992 auprc=0.993 bytes=37738
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9968 head_norm=2.131949
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.746645e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9968 head_norm=2.125518 delta_norm=0.067466
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.997 u=0.0002 p_local=0.0047 f1=0.997 auprc=0.997 bytes=37769
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.9859 head_norm=1.646819
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.775443e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.9876 head_norm=1.662046 delta_norm=0.057754
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.985 u=1.0000 p_local=0.2874 f1=0.986 auprc=0.983 bytes=34159
[S14] r=40 psi=0.998 u=0.0038 p_local=0.0234 f1=0.997 auprc=0.999 bytes=37746
[S10] r=40 psi=0.995 u=0.0059 p_local=0.0051 f1=0.995 auprc=0.996 bytes=41383
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9453 head_norm=1.679123
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.775443e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9453 head_norm=1.662046 delta_norm=0.057754
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.959 u=0.0918 p_local=0.0337 f1=0.945 auprc=0.979 bytes=35961
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6412 head_norm=1.143241
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.461376e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6603 head_norm=1.223485 delta_norm=0.346138
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.655 u=0.0000 p_local=0.1615 f1=0.641 auprc=0.676 bytes=32359
[S15] r=40 psi=0.861 u=0.0000 p_local=0.2046 f1=0.775 auprc=0.990 bytes=34176
[S2] START round=40 head_norm_before_train=1.585463 cos_to_last_merge=0.9958 (last merge round=35)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.82989920631897, 'auprc': 0.8525463976641189, 'loss_val': 0.3489192527606549, 'psi': 0.8389580828570296}-{'f1_val': 0.8269912673165528, 'auprc': 0.8647592592840448, 'loss_val': 0.36099387896133356, 'psi': 0.8420984641035496}
[S3] START round=40 head_norm_before_train=2.141503 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.173588 metrics={'f1_val': 0.9606168202871485, 'auprc': 0.9982796102620004, 'loss_val': 0.11304857086710902, 'psi': 0.9756819362770892}-{'f1_val': 0.9124109845812152, 'auprc': 0.9977105412323004, 'loss_val': 0.16928325778356024, 'psi': 0.9465308072416492}
[S4] START round=40 head_norm_before_train=1.662046 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9391230622209594, 'auprc': 0.940814887635797, 'loss_val': 0.30009779100374684, 'psi': 0.9397997923868944}-{'f1_val': 0.9452500102595128, 'auprc': 0.9788018699324612, 'loss_val': 0.27442764798440855, 'psi': 0.9586707541286922}
[S5] START round=40 head_norm_before_train=2.011393 (no previous merge yet)
[S5] round=40 local utility u=0.002273 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998373007270379, 'loss_val': 0.027163577269478267, 'psi': 0.9973703839952262}-{'f1_val': 0.9967019684784577, 'auprc': 0.9989824860235632, 'loss_val': 0.0335375154068682, 'psi': 0.9976141754964999}
[S6] START round=40 head_norm_before_train=1.162579 cos_to_last_merge=0.9984 (last merge round=38)
[S6] round=40 local utility u=0.371932 metrics={'f1_val': 0.800011746732914, 'auprc': 0.9444282750016888, 'loss_val': 0.4973689186745832, 'psi': 0.8577783580404239}-{'f1_val': 0.7265208890228003, 'auprc': 0.890496990608113, 'loss_val': 0.6384932150694981, 'psi': 0.7921113296569254}
[S7] START round=40 head_norm_before_train=1.662046 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6176721968458343, 'auprc': 0.7974390509831812, 'loss_val': 0.5860362311757074, 'psi': 0.6895789385007731}-{'f1_val': 0.9858620745498392, 'auprc': 0.9830264799620303, 'loss_val': 0.1550264056096672, 'psi': 0.9847278367147156}
[S8] START round=40 head_norm_before_train=2.125518 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9971306478410504, 'loss_val': 0.03714581533106542, 'psi': 0.9969180879002778}-{'f1_val': 0.996776381273096, 'auprc': 0.9973335669896237, 'loss_val': 0.03466335247123216, 'psi': 0.9969992555597071}
[S9] START round=40 head_norm_before_train=2.184297 (no previous merge yet)
[S9] round=40 local utility u=0.000225 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968959188261541, 'loss_val': 0.016748988187471312, 'psi': 0.9970201150377473}-{'f1_val': 0.9958267183641853, 'auprc': 0.9997038007739827, 'loss_val': 0.01796524415063832, 'psi': 0.9973775513281044}
[S10] START round=40 head_norm_before_train=2.121214 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9941582665687158, 'loss_val': 0.03380388561019329, 'psi': 0.994436515239898}-{'f1_val': 0.9946059470817044, 'auprc': 0.9963648445195661, 'loss_val': 0.033769370546385666, 'psi': 0.995309506056849}
[S11] START round=40 head_norm_before_train=1.433070 cos_to_last_merge=0.9931 (last merge round=35)
[S11] round=40 local utility u=0.027404 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976372449117711, 'loss_val': 0.06488096952910855, 'psi': 0.9969831006728622}-{'f1_val': 0.9912817849077695, 'auprc': 0.997670546515399, 'loss_val': 0.08819818952985055, 'psi': 0.9938372895508213}
[S13] START round=40 head_norm_before_train=1.560192 cos_to_last_merge=0.9997 (last merge round=38)
[S13] round=40 local utility u=0.031486 metrics={'f1_val': 0.6140286675848585, 'auprc': 0.6656215441395659, 'loss_val': 0.7507920636819703, 'psi': 0.6346658182067415}-{'f1_val': 0.6027587630026678, 'auprc': 0.6760326377927411, 'loss_val': 0.7773770686929737, 'psi': 0.6320683129186971}
[S14] START round=40 head_norm_before_train=1.387967 cos_to_last_merge=0.9999 (last merge round=38)
[S14] round=40 local utility u=0.000479 metrics={'f1_val': 0.9965803821790421, 'auprc': 0.9986417434681867, 'loss_val': 0.04816745158045648, 'psi': 0.9974049266946998}-{'f1_val': 0.9966100132760906, 'auprc': 0.9990378756079197, 'loss_val': 0.05049134468453588, 'psi': 0.9975811582088223}
[S15] START round=40 head_norm_before_train=1.572935 cos_to_last_merge=0.9988 (last merge round=37)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7115239372255693, 'auprc': 0.9870338882371589, 'loss_val': 0.403951076110635, 'psi': 0.8217279176302051}-{'f1_val': 0.7745595954409668, 'auprc': 0.9898216910313669, 'loss_val': 0.3133217569112148, 'psi': 0.8606644336771268}
[S16] START round=40 head_norm_before_train=1.610385 cos_to_last_merge=0.9987 (last merge round=37)
[S16] round=40 local utility u=0.011043 metrics={'f1_val': 0.9919472332293797, 'auprc': 0.9951103639086655, 'loss_val': 0.05771261292677254, 'psi': 0.9932124855010941}-{'f1_val': 0.9916799325754928, 'auprc': 0.9926003953093252, 'loss_val': 0.07066527499839227, 'psi': 0.9920481176690257}
[S17] START round=40 head_norm_before_train=1.223485 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6042548524766074, 'auprc': 0.6613270217091081, 'loss_val': 0.9235386113921187, 'psi': 0.6270837201696077}-{'f1_val': 0.6412221193356447, 'auprc': 0.6763307338201524, 'loss_val': 0.8822255777957395, 'psi': 0.6552655651294477}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:41905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:41915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.7995
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.9941
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] cosine check vs S3: cos=0.9989
[S5] RECEIVED delta(kind=head bytes=1794) from S16
[S5] cosine check vs S16: cos=-0.0856
[S5] DROPPED delta from S16 (cos=-0.0856 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] cosine check vs S13: cos=0.9510
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9631
[S2] ⇄ pheromone p=0.062 → S13@127.0.0.1:41913
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9968 head_norm=2.132389
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.130248e-02
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9968 head_norm=2.144893 delta_norm=0.051302
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.004 → S3@127.0.0.1:41903
[S3] ⇄ pheromone p=0.113 → S8@127.0.0.1:41909
[S7] ⇄ pheromone p=0.230 → S4@127.0.0.1:41904
[S4] ⇄ pheromone p=0.027 → S7@127.0.0.1:41908
[S6] ⇄ pheromone p=0.240 → S17@127.0.0.1:41917
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9966 head_norm=1.411709
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.301859e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9966 head_norm=1.437353 delta_norm=0.083019
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.019 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=0.023 → S15@127.0.0.1:41915
[S10] ⇄ pheromone p=0.004 → S8@127.0.0.1:41909
[S11] ⇄ pheromone p=0.037 → S14@127.0.0.1:41914
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.7115 head_norm=1.601764
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.495448e-01
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.7115 head_norm=1.573423 delta_norm=0.249545
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.164 → S16@127.0.0.1:41916
[S16] ⇄ pheromone p=0.078 → S5@127.0.0.1:41905
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6043 head_norm=1.252154
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.225363e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6025 head_norm=1.216095 delta_norm=0.122536
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.129 → S6@127.0.0.1:41907
[S2] START round=41 head_norm_before_train=1.612385 cos_to_last_merge=0.9941 (last merge round=35)
[S2] round=41 local utility u=0.016481 metrics={'f1_val': 0.8287309319908521, 'auprc': 0.8685531221148505, 'loss_val': 0.3569668481765469, 'psi': 0.8446598080404515}-{'f1_val': 0.82989920631897, 'auprc': 0.8525463976641189, 'loss_val': 0.3489192527606549, 'psi': 0.8389580828570296}
[S3] START round=41 head_norm_before_train=2.158545 cos_to_last_merge=0.9999 (last merge round=39)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8317580967895314, 'auprc': 0.9704215668817832, 'loss_val': 0.3490080918324436, 'psi': 0.8872234848264321}-{'f1_val': 0.9606168202871485, 'auprc': 0.9982796102620004, 'loss_val': 0.11304857086710902, 'psi': 0.9756819362770892}
[S4] START round=41 head_norm_before_train=1.675773 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.7931214674908402, 'auprc': 0.9001978298250184, 'loss_val': 0.47962000608264604, 'psi': 0.8359520124245114}-{'f1_val': 0.9391230622209594, 'auprc': 0.940814887635797, 'loss_val': 0.30009779100374684, 'psi': 0.9397997923868944}
[S5] START round=41 head_norm_before_train=2.028167 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.994968909146599, 'loss_val': 0.03150682166534587, 'psi': 0.9960087447457142}-{'f1_val': 0.9967019684784577, 'auprc': 0.998373007270379, 'loss_val': 0.027163577269478267, 'psi': 0.9973703839952262}
[S6] START round=41 head_norm_before_train=1.224001 cos_to_last_merge=0.9935 (last merge round=38)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6799746381888675, 'auprc': 0.9370102795727074, 'loss_val': 0.6866512084974377, 'psi': 0.7827888947424035}-{'f1_val': 0.800011746732914, 'auprc': 0.9444282750016888, 'loss_val': 0.4973689186745832, 'psi': 0.8577783580404239}
[S7] START round=41 head_norm_before_train=1.661603 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=0.063701 metrics={'f1_val': 0.629025002695791, 'auprc': 0.8012814232433343, 'loss_val': 0.5382790197919226, 'psi': 0.6979275709148083}-{'f1_val': 0.6176721968458343, 'auprc': 0.7974390509831812, 'loss_val': 0.5860362311757074, 'psi': 0.6895789385007731}
[S8] START round=41 head_norm_before_train=2.144893 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.001724 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9973595572946474, 'loss_val': 0.03438441092970815, 'psi': 0.9970096516817166}-{'f1_val': 0.996776381273096, 'auprc': 0.9971306478410504, 'loss_val': 0.03714581533106542, 'psi': 0.9969180879002778}
[S9] START round=41 head_norm_before_train=2.192063 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9997126723992761, 'loss_val': 0.030251821477178174, 'psi': 0.9946315570966008}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968959188261541, 'loss_val': 0.016748988187471312, 'psi': 0.9970201150377473}
[S10] START round=41 head_norm_before_train=2.128805 (no previous merge yet)
[S10] round=41 local utility u=0.000308 metrics={'f1_val': 0.9941835069003575, 'auprc': 0.995070195499492, 'loss_val': 0.03329311973108908, 'psi': 0.9945381823400112}-{'f1_val': 0.9946220143540194, 'auprc': 0.9941582665687158, 'loss_val': 0.03380388561019329, 'psi': 0.994436515239898}
[S11] START round=41 head_norm_before_train=1.467253 cos_to_last_merge=0.9905 (last merge round=35)
[S11] round=41 local utility u=0.004033 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978160385551854, 'loss_val': 0.05735038661550864, 'psi': 0.9970546181302279}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976372449117711, 'loss_val': 0.06488096952910855, 'psi': 0.9969831006728622}
[S13] START round=41 head_norm_before_train=1.584366 cos_to_last_merge=0.9992 (last merge round=38)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5526788846422953, 'auprc': 0.6907998977944363, 'loss_val': 0.9572833992027651, 'psi': 0.6079272899031517}-{'f1_val': 0.6140286675848585, 'auprc': 0.6656215441395659, 'loss_val': 0.7507920636819703, 'psi': 0.6346658182067415}
[S14] START round=41 head_norm_before_train=1.437353 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.004272 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9985770604897628, 'loss_val': 0.04193937658364813, 'psi': 0.997630088616526}-{'f1_val': 0.9965803821790421, 'auprc': 0.9986417434681867, 'loss_val': 0.04816745158045648, 'psi': 0.9974049266946998}
[S15] START round=41 head_norm_before_train=1.573423 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.376458 metrics={'f1_val': 0.8140968907199128, 'auprc': 0.9903260235226015, 'loss_val': 0.27634917443692325, 'psi': 0.8845885438409882}-{'f1_val': 0.7115239372255693, 'auprc': 0.9870338882371589, 'loss_val': 0.403951076110635, 'psi': 0.8217279176302051}
[S16] START round=41 head_norm_before_train=1.642422 cos_to_last_merge=0.9975 (last merge round=37)
[S16] round=41 local utility u=0.004625 metrics={'f1_val': 0.993224997006937, 'auprc': 0.9930617852584555, 'loss_val': 0.049982896387951704, 'psi': 0.9931597123075444}-{'f1_val': 0.9919472332293797, 'auprc': 0.9951103639086655, 'loss_val': 0.05771261292677254, 'psi': 0.9932124855010941}
[S17] START round=41 head_norm_before_train=1.216095 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5923922463936747, 'auprc': 0.6628956495709597, 'loss_val': 0.9494081120002348, 'psi': 0.6205936076645887}-{'f1_val': 0.6042548524766074, 'auprc': 0.6613270217091081, 'loss_val': 0.9235386113921187, 'psi': 0.6270837201696077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:41905
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.9937
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9973
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9980
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.8226
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9995
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=-0.0879
[S5] DROPPED delta from S16 (cos=-0.0879 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.9259
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.8318 head_norm=2.175174
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.723598e-02
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.8329 head_norm=2.164076 delta_norm=0.037236
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9970 head_norm=1.459234
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.736462e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9970 head_norm=1.477502 delta_norm=0.057365
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.5527 head_norm=1.602756
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.280773e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.5658 head_norm=1.617921 delta_norm=0.092808
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.7931 head_norm=1.686521
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.705663e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.8033 head_norm=1.676199 delta_norm=0.027057
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9968 head_norm=2.153565
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.887989e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9968 head_norm=2.142933 delta_norm=0.068880
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.5924 head_norm=1.254069
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.799172e-01
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.5943 head_norm=1.331417 delta_norm=0.279917
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9932 head_norm=1.667225
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.872425e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9932 head_norm=1.557937 delta_norm=0.487242
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.638211 cos_to_last_merge=0.9924 (last merge round=35)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8122852102298851, 'auprc': 0.8496125484652173, 'loss_val': 0.4137367790411139, 'psi': 0.8272161455240179}-{'f1_val': 0.8287309319908521, 'auprc': 0.8685531221148505, 'loss_val': 0.3569668481765469, 'psi': 0.8446598080404515}
[S3] START round=42 head_norm_before_train=2.164076 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.143961 metrics={'f1_val': 0.8552221943825893, 'auprc': 0.9979511578635115, 'loss_val': 0.28445968577998276, 'psi': 0.9123137797749581}-{'f1_val': 0.8317580967895314, 'auprc': 0.9704215668817832, 'loss_val': 0.3490080918324436, 'psi': 0.8872234848264321}
[S4] START round=42 head_norm_before_train=1.676199 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.508691 metrics={'f1_val': 0.9317850229326771, 'auprc': 0.9157555346833564, 'loss_val': 0.34089214383470834, 'psi': 0.9253732276329487}-{'f1_val': 0.7931214674908402, 'auprc': 0.9001978298250184, 'loss_val': 0.47962000608264604, 'psi': 0.8359520124245114}
[S5] START round=42 head_norm_before_train=2.048706 (no previous merge yet)
[S5] round=42 local utility u=0.006340 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.996205880230564, 'loss_val': 0.024293346309632934, 'psi': 0.9966791940690396}-{'f1_val': 0.9967019684784577, 'auprc': 0.994968909146599, 'loss_val': 0.03150682166534587, 'psi': 0.9960087447457142}
[S6] START round=42 head_norm_before_train=1.299552 cos_to_last_merge=0.9859 (last merge round=38)
[S6] round=42 local utility u=0.551555 metrics={'f1_val': 0.8189800845896265, 'auprc': 0.9454069825350384, 'loss_val': 0.442763902517365, 'psi': 0.8695508437677912}-{'f1_val': 0.6799746381888675, 'auprc': 0.9370102795727074, 'loss_val': 0.6866512084974377, 'psi': 0.7827888947424035}
[S7] START round=42 head_norm_before_train=1.666252 cos_to_last_merge=0.9999 (last merge round=39)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5698374303359264, 'auprc': 0.7854355675624772, 'loss_val': 0.7946800840337532, 'psi': 0.6560766852265467}-{'f1_val': 0.629025002695791, 'auprc': 0.8012814232433343, 'loss_val': 0.5382790197919226, 'psi': 0.6979275709148083}
[S8] START round=42 head_norm_before_train=2.142933 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9971321100918644, 'loss_val': 0.03547594945824701, 'psi': 0.9969186728006034}-{'f1_val': 0.996776381273096, 'auprc': 0.9973595572946474, 'loss_val': 0.03438441092970815, 'psi': 0.9970096516817166}
[S9] START round=42 head_norm_before_train=2.201069 (no previous merge yet)
[S9] round=42 local utility u=0.024525 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996212960931192, 'loss_val': 0.016079353712476582, 'psi': 0.9981102659445333}-{'f1_val': 0.9912441468948172, 'auprc': 0.9997126723992761, 'loss_val': 0.030251821477178174, 'psi': 0.9946315570966008}
[S10] START round=42 head_norm_before_train=2.134472 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9965145611191858, 'loss_val': 0.03473632650274562, 'psi': 0.9945902496802173}-{'f1_val': 0.9941835069003575, 'auprc': 0.995070195499492, 'loss_val': 0.03329311973108908, 'psi': 0.9945381823400112}
[S11] START round=42 head_norm_before_train=1.497746 cos_to_last_merge=0.9879 (last merge round=35)
[S11] round=42 local utility u=0.002771 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978143176538213, 'loss_val': 0.05180302273840773, 'psi': 0.9970539297696823}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978160385551854, 'loss_val': 0.05735038661550864, 'psi': 0.9970546181302279}
[S13] START round=42 head_norm_before_train=1.617921 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.422732 metrics={'f1_val': 0.6311181017313878, 'auprc': 0.6700015056962688, 'loss_val': 0.5200601506166747, 'psi': 0.6466714633173403}-{'f1_val': 0.5526788846422953, 'auprc': 0.6907998977944363, 'loss_val': 0.9572833992027651, 'psi': 0.6079272899031517}
[S14] START round=42 head_norm_before_train=1.477502 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9987111952170633, 'loss_val': 0.04558225957643908, 'psi': 0.997462783325135}-{'f1_val': 0.9969987740343681, 'auprc': 0.9985770604897628, 'loss_val': 0.04193937658364813, 'psi': 0.997630088616526}
[S15] START round=42 head_norm_before_train=1.596718 cos_to_last_merge=0.9999 (last merge round=40)
[S15] round=42 local utility u=0.493468 metrics={'f1_val': 0.9455109683264891, 'auprc': 0.9945509290460719, 'loss_val': 0.09057294669251682, 'psi': 0.9651269526143221}-{'f1_val': 0.8140968907199128, 'auprc': 0.9903260235226015, 'loss_val': 0.27634917443692325, 'psi': 0.8845885438409882}
[S16] START round=42 head_norm_before_train=1.557937 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.903252999967197, 'auprc': 0.9928984131399106, 'loss_val': 0.23576325926848085, 'psi': 0.9391111652362825}-{'f1_val': 0.993224997006937, 'auprc': 0.9930617852584555, 'loss_val': 0.049982896387951704, 'psi': 0.9931597123075444}
[S17] START round=42 head_norm_before_train=1.331417 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.061645 metrics={'f1_val': 0.5975008613275103, 'auprc': 0.6840011603983774, 'loss_val': 0.9200872788189407, 'psi': 0.6321009809558571}-{'f1_val': 0.5923922463936747, 'auprc': 0.6628956495709597, 'loss_val': 0.9494081120002348, 'psi': 0.6205936076645887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.0589
[S16] DROPPED delta from S5 (cos=-0.0589 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:41914
[S11] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1789) from S11
[S14] cosine check vs S11: cos=0.9986
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=0.9986
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.9465
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:41907
[S6] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.7162
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.7162
[S13] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] cosine check vs S13: cos=0.9821
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9993
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9968 head_norm=2.151722
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.972785e-02
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9968 head_norm=2.165640 delta_norm=0.059728
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.5698 head_norm=1.673858
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.131788e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.5740 head_norm=1.680705 delta_norm=0.031318
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9966 head_norm=1.494974
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.267067e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9966 head_norm=1.509506 delta_norm=0.042671
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9455 head_norm=1.617023
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.535169e-01
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9477 head_norm=1.615297 delta_norm=0.153517
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9033 head_norm=1.588319
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.624538e-01
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9270 head_norm=1.581100 delta_norm=0.262454
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.8190 head_norm=1.365233
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.141857e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.8113 head_norm=1.264410 delta_norm=0.514186
[S6] aggregate: ROLLBACK (f1_val pre=0.819 post=0.811 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.5975 head_norm=1.364689
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.141857e-01
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.5977 head_norm=1.264410 delta_norm=0.514186
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.660906 cos_to_last_merge=0.9908 (last merge round=35)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7893983816271393, 'auprc': 0.8503339353481586, 'loss_val': 0.48767640449636246, 'psi': 0.813772603115547}-{'f1_val': 0.8122852102298851, 'auprc': 0.8496125484652173, 'loss_val': 0.4137367790411139, 'psi': 0.8272161455240179}
[S3] START round=43 head_norm_before_train=2.181105 cos_to_last_merge=0.9999 (last merge round=41)
[S3] round=43 local utility u=0.354283 metrics={'f1_val': 0.9454152639407793, 'auprc': 0.9984435635055711, 'loss_val': 0.11852960840590089, 'psi': 0.966626583766696}-{'f1_val': 0.8552221943825893, 'auprc': 0.9979511578635115, 'loss_val': 0.28445968577998276, 'psi': 0.9123137797749581}
[S4] START round=43 head_norm_before_train=1.688105 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=43 local utility u=0.147068 metrics={'f1_val': 0.9546700496942578, 'auprc': 0.9496496170738189, 'loss_val': 0.28574824201022964, 'psi': 0.9526618766460823}-{'f1_val': 0.9317850229326771, 'auprc': 0.9157555346833564, 'loss_val': 0.34089214383470834, 'psi': 0.9253732276329487}
[S5] START round=43 head_norm_before_train=2.062711 (no previous merge yet)
[S5] round=43 local utility u=0.005790 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9995729189566671, 'loss_val': 0.023262759331665654, 'psi': 0.9980709027493054}-{'f1_val': 0.9969947366280233, 'auprc': 0.996205880230564, 'loss_val': 0.024293346309632934, 'psi': 0.9966791940690396}
[S6] START round=43 head_norm_before_train=1.264410 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6089782827355361, 'auprc': 0.8915147216752224, 'loss_val': 0.7310760702560707, 'psi': 0.7219928583114106}-{'f1_val': 0.8189800845896265, 'auprc': 0.9454069825350384, 'loss_val': 0.442763902517365, 'psi': 0.8695508437677912}
[S7] START round=43 head_norm_before_train=1.680705 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.115133 metrics={'f1_val': 0.589835859866093, 'auprc': 0.7905938542115947, 'loss_val': 0.6998785520404418, 'psi': 0.6701390576042937}-{'f1_val': 0.5698374303359264, 'auprc': 0.7854355675624772, 'loss_val': 0.7946800840337532, 'psi': 0.6560766852265467}
[S8] START round=43 head_norm_before_train=2.165640 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000969 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9966387305317355, 'loss_val': 0.032057118877768506, 'psi': 0.9967213209765518}-{'f1_val': 0.996776381273096, 'auprc': 0.9971321100918644, 'loss_val': 0.03547594945824701, 'psi': 0.9969186728006034}
[S9] START round=43 head_norm_before_train=2.204181 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985955979833012, 'loss_val': 0.016175843141156585, 'psi': 0.9976999867006062}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996212960931192, 'loss_val': 0.016079353712476582, 'psi': 0.9981102659445333}
[S10] START round=43 head_norm_before_train=2.139961 (no previous merge yet)
[S10] round=43 local utility u=0.006637 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962554232861944, 'loss_val': 0.03277907631092088, 'psi': 0.995696041652716}-{'f1_val': 0.9933073753875716, 'auprc': 0.9965145611191858, 'loss_val': 0.03473632650274562, 'psi': 0.9945902496802173}
[S11] START round=43 head_norm_before_train=1.525094 cos_to_last_merge=0.9855 (last merge round=35)
[S11] round=43 local utility u=0.002203 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978146882022676, 'loss_val': 0.04739824009997744, 'psi': 0.9970540779890608}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978143176538213, 'loss_val': 0.05180302273840773, 'psi': 0.9970539297696823}
[S13] START round=43 head_norm_before_train=1.628109 cos_to_last_merge=0.9999 (last merge round=41)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5320952509508837, 'auprc': 0.6856333141216261, 'loss_val': 0.8469933026531208, 'psi': 0.5935104762191807}-{'f1_val': 0.6311181017313878, 'auprc': 0.6700015056962688, 'loss_val': 0.5200601506166747, 'psi': 0.6466714633173403}
[S14] START round=43 head_norm_before_train=1.509506 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963375338307721, 'auprc': 0.997316798864569, 'loss_val': 0.04002517220549457, 'psi': 0.9967292398442908}-{'f1_val': 0.9966305087305161, 'auprc': 0.9987111952170633, 'loss_val': 0.04558225957643908, 'psi': 0.997462783325135}
[S15] START round=43 head_norm_before_train=1.615297 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8001324887184073, 'auprc': 0.9914288197291068, 'loss_val': 0.300914756868108, 'psi': 0.876651021122687}-{'f1_val': 0.9455109683264891, 'auprc': 0.9945509290460719, 'loss_val': 0.09057294669251682, 'psi': 0.9651269526143221}
[S16] START round=43 head_norm_before_train=1.581100 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.332351 metrics={'f1_val': 0.99165941092701, 'auprc': 0.9979274490376403, 'loss_val': 0.11658675986070516, 'psi': 0.9941666261712621}-{'f1_val': 0.903252999967197, 'auprc': 0.9928984131399106, 'loss_val': 0.23576325926848085, 'psi': 0.9391111652362825}
[S17] START round=43 head_norm_before_train=1.264410 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.056705 metrics={'f1_val': 0.6074316511940827, 'auprc': 0.7003758708870507, 'loss_val': 0.9153859849513002, 'psi': 0.6446093390712699}-{'f1_val': 0.5975008613275103, 'auprc': 0.6840011603983774, 'loss_val': 0.9200872788189407, 'psi': 0.6321009809558571}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:41905
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9993
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.0419
[S16] DROPPED delta from S5 (cos=-0.0419 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9993
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] cosine check vs S4: cos=0.9989
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9992
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9977
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=-0.0419
[S5] DROPPED delta from S16 (cos=-0.0419 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9989
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.9975
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.6090 head_norm=1.312110
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.605027e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.6084 head_norm=1.307703 delta_norm=0.046050
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.5898 head_norm=1.685269
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.910522e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.5915 head_norm=1.686147 delta_norm=0.039105
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9454 head_norm=2.200081
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.189809e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9460 head_norm=2.187364 delta_norm=0.041898
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9968 head_norm=2.175379
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.263675e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9968 head_norm=2.173096 delta_norm=0.022637
[S8] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9547 head_norm=1.687931
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.910523e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9551 head_norm=1.686147 delta_norm=0.039105
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=43 metric=0.9963 head_norm=1.523530
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.323177e-02
[S14] stored merged vector for next round verification (round=43)
[S14] DEBUG after merge:  round=43 metric=0.9963 head_norm=1.535995 delta_norm=0.033232
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.682227 cos_to_last_merge=0.9892 (last merge round=35)
[S2] round=44 local utility u=0.240500 metrics={'f1_val': 0.8292588952313225, 'auprc': 0.882781570819485, 'loss_val': 0.34318149604052467, 'psi': 0.8506679654665875}-{'f1_val': 0.7893983816271393, 'auprc': 0.8503339353481586, 'loss_val': 0.48767640449636246, 'psi': 0.813772603115547}
[S3] START round=44 head_norm_before_train=2.187364 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8828319017783111, 'auprc': 0.9739122679965301, 'loss_val': 0.2564227160319702, 'psi': 0.9192640482655986}-{'f1_val': 0.9454152639407793, 'auprc': 0.9984435635055711, 'loss_val': 0.11852960840590089, 'psi': 0.966626583766696}
[S4] START round=44 head_norm_before_train=1.686147 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9393814531107284, 'auprc': 0.9498147303811391, 'loss_val': 0.3011108477008308, 'psi': 0.9435547640188927}-{'f1_val': 0.9546700496942578, 'auprc': 0.9496496170738189, 'loss_val': 0.28574824201022964, 'psi': 0.9526618766460823}
[S5] START round=44 head_norm_before_train=2.064816 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9989265546394099, 'loss_val': 0.025258537531683712, 'psi': 0.9975918029428386}-{'f1_val': 0.9970695586110643, 'auprc': 0.9995729189566671, 'loss_val': 0.023262759331665654, 'psi': 0.9980709027493054}
[S6] START round=44 head_norm_before_train=1.307703 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.976515 metrics={'f1_val': 0.8617914061528931, 'auprc': 0.9472349918411446, 'loss_val': 0.46208545972330983, 'psi': 0.8959688404281937}-{'f1_val': 0.6089782827355361, 'auprc': 0.8915147216752224, 'loss_val': 0.7310760702560707, 'psi': 0.7219928583114106}
[S7] START round=44 head_norm_before_train=1.686147 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5705849598029997, 'auprc': 0.7853538529981265, 'loss_val': 0.8989327610032665, 'psi': 0.6564925170810505}-{'f1_val': 0.589835859866093, 'auprc': 0.7905938542115947, 'loss_val': 0.6998785520404418, 'psi': 0.6701390576042937}
[S8] START round=44 head_norm_before_train=2.173096 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.001667 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9979885914019189, 'loss_val': 0.032773135135553126, 'psi': 0.9972612653246251}-{'f1_val': 0.996776381273096, 'auprc': 0.9966387305317355, 'loss_val': 0.032057118877768506, 'psi': 0.9967213209765518}
[S9] START round=44 head_norm_before_train=2.211462 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9999493028214345, 'loss_val': 0.03551052812010349, 'psi': 0.9940693190593997}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985955979833012, 'loss_val': 0.016175843141156585, 'psi': 0.9976999867006062}
[S10] START round=44 head_norm_before_train=2.147455 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.8296565512861404, 'auprc': 0.9924214531525931, 'loss_val': 0.46077035562807417, 'psi': 0.8947625120327215}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962554232861944, 'loss_val': 0.03277907631092088, 'psi': 0.995696041652716}
[S11] START round=44 head_norm_before_train=1.549074 cos_to_last_merge=0.9834 (last merge round=35)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964924064124162, 'loss_val': 0.047104375381841715, 'psi': 0.996277167512952}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978146882022676, 'loss_val': 0.04739824009997744, 'psi': 0.9970540779890608}
[S13] START round=44 head_norm_before_train=1.635200 cos_to_last_merge=0.9998 (last merge round=41)
[S13] round=44 local utility u=0.123230 metrics={'f1_val': 0.565672480596382, 'auprc': 0.6854692979623677, 'loss_val': 0.8015051531541932, 'psi': 0.6135912075427763}-{'f1_val': 0.5320952509508837, 'auprc': 0.6856333141216261, 'loss_val': 0.8469933026531208, 'psi': 0.5935104762191807}
[S14] START round=44 head_norm_before_train=1.535995 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=44 local utility u=0.004598 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9986519702477694, 'loss_val': 0.03615431869837044, 'psi': 0.9973952578623051}-{'f1_val': 0.9963375338307721, 'auprc': 0.997316798864569, 'loss_val': 0.04002517220549457, 'psi': 0.9967292398442908}
[S15] START round=44 head_norm_before_train=1.630932 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7710879098205785, 'auprc': 0.9905522626502371, 'loss_val': 0.3556796865070185, 'psi': 0.858873650952442}-{'f1_val': 0.8001324887184073, 'auprc': 0.9914288197291068, 'loss_val': 0.300914756868108, 'psi': 0.876651021122687}
[S16] START round=44 head_norm_before_train=1.621469 cos_to_last_merge=0.9991 (last merge round=42)
[S16] round=44 local utility u=0.014921 metrics={'f1_val': 0.9914398362767233, 'auprc': 0.9977079817679395, 'loss_val': 0.0847687589762891, 'psi': 0.9939470944732098}-{'f1_val': 0.99165941092701, 'auprc': 0.9979274490376403, 'loss_val': 0.11658675986070516, 'psi': 0.9941666261712621}
[S17] START round=44 head_norm_before_train=1.304906 cos_to_last_merge=0.9989 (last merge round=42)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5293730580643985, 'auprc': 0.5186058728776166, 'loss_val': 1.2397267095865117, 'psi': 0.5250661839896857}-{'f1_val': 0.6074316511940827, 'auprc': 0.7003758708870507, 'loss_val': 0.9153859849513002, 'psi': 0.6446093390712699}
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:41917
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:41905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9953
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=0.9945
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=-0.0474
[S5] DROPPED delta from S16 (cos=-0.0474 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.9952
[S17] RECEIVED delta(kind=head bytes=1793) from S14
[S17] cosine check vs S14: cos=0.8054
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9994
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.5657 head_norm=1.642869
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.594148e-02
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.5810 head_norm=1.670545 delta_norm=0.085941
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.7711 head_norm=1.647029
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.603430e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.7711 head_norm=1.642699 delta_norm=0.086034
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] CommDone barrier timeout: have=2 need=3 — continuing
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.5294 head_norm=1.336861
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.246322e-01
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.5244 head_norm=1.338507 delta_norm=0.224632
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.702115 cos_to_last_merge=0.9877 (last merge round=35)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7131801826583436, 'auprc': 0.9938095296562812, 'loss_val': 0.40838390501256605, 'psi': 0.8254319214575186}-{'f1_val': 0.8292588952313225, 'auprc': 0.882781570819485, 'loss_val': 0.34318149604052467, 'psi': 0.8506679654665875}
[S3] START round=45 head_norm_before_train=2.206711 cos_to_last_merge=0.9999 (last merge round=43)
[S3] round=45 local utility u=0.406662 metrics={'f1_val': 0.9756033311247574, 'auprc': 0.9986757235758861, 'loss_val': 0.07401844699154948, 'psi': 0.9848322881052088}-{'f1_val': 0.8828319017783111, 'auprc': 0.9739122679965301, 'loss_val': 0.2564227160319702, 'psi': 0.9192640482655986}
[S4] START round=45 head_norm_before_train=1.684649 cos_to_last_merge=0.9997 (last merge round=43)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9245925444307603, 'auprc': 0.953885660436244, 'loss_val': 0.35086817598869197, 'psi': 0.9363097908329538}-{'f1_val': 0.9393814531107284, 'auprc': 0.9498147303811391, 'loss_val': 0.3011108477008308, 'psi': 0.9435547640188927}
[S5] START round=45 head_norm_before_train=2.075834 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9974641181187904, 'loss_val': 0.025523189266067448, 'psi': 0.9970068283345908}-{'f1_val': 0.9967019684784577, 'auprc': 0.9989265546394099, 'loss_val': 0.025258537531683712, 'psi': 0.9975918029428386}
[S6] START round=45 head_norm_before_train=1.362792 cos_to_last_merge=0.9988 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7094418678191631, 'auprc': 0.9246567647748314, 'loss_val': 0.6307578487810975, 'psi': 0.7955278266014304}-{'f1_val': 0.8617914061528931, 'auprc': 0.9472349918411446, 'loss_val': 0.46208545972330983, 'psi': 0.8959688404281937}
[S7] START round=45 head_norm_before_train=1.691008 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=0.251928 metrics={'f1_val': 0.6156706870848059, 'auprc': 0.7952335607267939, 'loss_val': 0.6952293990712387, 'psi': 0.6874958365416011}-{'f1_val': 0.5705849598029997, 'auprc': 0.7853538529981265, 'loss_val': 0.8989327610032665, 'psi': 0.6564925170810505}
[S8] START round=45 head_norm_before_train=2.178848 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9952764343236492, 'auprc': 0.9952557421361996, 'loss_val': 0.038406438617968025, 'psi': 0.9952681574486694}-{'f1_val': 0.996776381273096, 'auprc': 0.9979885914019189, 'loss_val': 0.032773135135553126, 'psi': 0.9972612653246251}
[S9] START round=45 head_norm_before_train=2.219899 (no previous merge yet)
[S9] round=45 local utility u=0.030038 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996139023446796, 'loss_val': 0.01615074231802087, 'psi': 0.9981073084451575}-{'f1_val': 0.9901493298847097, 'auprc': 0.9999493028214345, 'loss_val': 0.03551052812010349, 'psi': 0.9940693190593997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=45 head_norm_before_train=2.155833 (no previous merge yet)
[S10] round=45 local utility u=0.719757 metrics={'f1_val': 0.9961605415649639, 'auprc': 0.9965617713456617, 'loss_val': 0.0327005468195101, 'psi': 0.996321033477243}-{'f1_val': 0.8296565512861404, 'auprc': 0.9924214531525931, 'loss_val': 0.46077035562807417, 'psi': 0.8947625120327215}
[S11] START round=45 head_norm_before_train=1.571553 cos_to_last_merge=0.9814 (last merge round=35)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961426347003207, 'loss_val': 0.052627998416823925, 'psi': 0.9961372588281139}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964924064124162, 'loss_val': 0.047104375381841715, 'psi': 0.996277167512952}
[S13] START round=45 head_norm_before_train=1.670545 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5262639761314993, 'auprc': 0.690005237762873, 'loss_val': 0.898014335935722, 'psi': 0.5917604807840489}-{'f1_val': 0.565672480596382, 'auprc': 0.6854692979623677, 'loss_val': 0.8015051531541932, 'psi': 0.6135912075427763}
[S14] START round=45 head_norm_before_train=1.550260 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=45 local utility u=0.000032 metrics={'f1_val': 0.997237639618808, 'auprc': 0.9985624007199128, 'loss_val': 0.0399025630021665, 'psi': 0.99776754405925}-{'f1_val': 0.9965574496053289, 'auprc': 0.9986519702477694, 'loss_val': 0.03615431869837044, 'psi': 0.9973952578623051}
[S15] START round=45 head_norm_before_train=1.642699 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.163471 metrics={'f1_val': 0.8132395521159881, 'auprc': 0.9915109234239882, 'loss_val': 0.28452284999125144, 'psi': 0.8845481006391882}-{'f1_val': 0.7710879098205785, 'auprc': 0.9905522626502371, 'loss_val': 0.3556796865070185, 'psi': 0.858873650952442}
[S16] START round=45 head_norm_before_train=1.668677 cos_to_last_merge=0.9964 (last merge round=42)
[S16] round=45 local utility u=0.005296 metrics={'f1_val': 0.9918497014019625, 'auprc': 0.9953337316853853, 'loss_val': 0.06951329187873644, 'psi': 0.9932433135153316}-{'f1_val': 0.9914398362767233, 'auprc': 0.9977079817679395, 'loss_val': 0.0847687589762891, 'psi': 0.9939470944732098}
[S17] START round=45 head_norm_before_train=1.338507 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.6773427637156887, 'auprc': 0.8754224328053789, 'loss_val': 0.7959381583342342, 'psi': 0.7565746313515648}-{'f1_val': 0.5293730580643985, 'auprc': 0.5186058728776166, 'loss_val': 1.2397267095865117, 'psi': 0.5250661839896857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] ⇄ pheromone p=0.291 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.060 → S13@127.0.0.1:41913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.013 → S14@127.0.0.1:41914
[S4] ⇄ pheromone p=0.080 → S7@127.0.0.1:41908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.024 → S16@127.0.0.1:41916
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9978
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.9756 head_norm=2.222164
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.184265e-02
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.9756 head_norm=2.200002 delta_norm=0.051843
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.178 → S8@127.0.0.1:41909
[S10] ⇄ pheromone p=0.146 → S8@127.0.0.1:41909
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9953 head_norm=2.184971
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.173823e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9953 head_norm=2.187750 delta_norm=0.021738
[S8] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.002 → S3@127.0.0.1:41903
[S13] ⇄ pheromone p=0.071 → S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.9282
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9992
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[S7] ⇄ pheromone p=0.146 → S4@127.0.0.1:41904
[S15] ⇄ pheromone p=0.168 → S16@127.0.0.1:41916
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9990
[S17]  timeout peer S2
[S17]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S17
[S14] ⇄ pheromone p=0.007 → S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9738
[S17] ⇄ pheromone p=0.256 → S6@127.0.0.1:41907
[S2]  timeout peer S13
[S10]  timeout peer S8
[S13]  timeout peer S15
[S16]  timeout peer S9
[S16]  timeout peer S11
[S15]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:41915
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9282
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.9918 head_norm=1.713711
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.206297e-01
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.9918 head_norm=1.654767 delta_norm=0.320630
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.072 → S15@127.0.0.1:41915
[S2] START round=46 head_norm_before_train=1.718118 cos_to_last_merge=0.9865 (last merge round=35)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8180317411070113, 'auprc': 0.7665917058441317, 'loss_val': 0.4307514057608732, 'psi': 0.7974557270018594}-{'f1_val': 0.7131801826583436, 'auprc': 0.9938095296562812, 'loss_val': 0.40838390501256605, 'psi': 0.8254319214575186}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.200002 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8614796131187885, 'auprc': 0.988283084370525, 'loss_val': 0.2652932857447674, 'psi': 0.9122010016194831}-{'f1_val': 0.9756033311247574, 'auprc': 0.9986757235758861, 'loss_val': 0.07401844699154948, 'psi': 0.9848322881052088}
[S4] START round=46 head_norm_before_train=1.689098 cos_to_last_merge=0.9993 (last merge round=43)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.6269962959341338, 'auprc': 0.9230760019992417, 'loss_val': 0.6931160557364767, 'psi': 0.7454281783601769}-{'f1_val': 0.9245925444307603, 'auprc': 0.953885660436244, 'loss_val': 0.35086817598869197, 'psi': 0.9363097908329538}
[S5] START round=46 head_norm_before_train=2.087688 (no previous merge yet)
[S5] round=46 local utility u=0.006746 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9996250016931554, 'loss_val': 0.020718505336593983, 'psi': 0.9980917358439008}-{'f1_val': 0.9967019684784577, 'auprc': 0.9974641181187904, 'loss_val': 0.025523189266067448, 'psi': 0.9970068283345908}
[S6] START round=46 head_norm_before_train=1.406386 cos_to_last_merge=0.9966 (last merge round=43)
[S6] round=46 local utility u=0.616472 metrics={'f1_val': 0.8655415750455357, 'auprc': 0.9521809519579794, 'loss_val': 0.4169853021963253, 'psi': 0.9001973258105131}-{'f1_val': 0.7094418678191631, 'auprc': 0.9246567647748314, 'loss_val': 0.6307578487810975, 'psi': 0.7955278266014304}
[S7] START round=46 head_norm_before_train=1.694059 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=46 local utility u=0.201177 metrics={'f1_val': 0.6421398743667854, 'auprc': 0.8057149268704361, 'loss_val': 0.48313467127405824, 'psi': 0.7075698953682457}-{'f1_val': 0.6156706870848059, 'auprc': 0.7952335607267939, 'loss_val': 0.6952293990712387, 'psi': 0.6874958365416011}
[S8] START round=46 head_norm_before_train=2.187750 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.013985 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.998663376733891, 'loss_val': 0.0322792893780911, 'psi': 0.9977931267712605}-{'f1_val': 0.9952764343236492, 'auprc': 0.9952557421361996, 'loss_val': 0.038406438617968025, 'psi': 0.9952681574486694}
[S9] START round=46 head_norm_before_train=2.226789 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.999940044944155, 'loss_val': 0.01927126745142739, 'psi': 0.9967225266732288}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996139023446796, 'loss_val': 0.01615074231802087, 'psi': 0.9981073084451575}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.165205 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9830844199769249, 'auprc': 0.9925899817016925, 'loss_val': 0.07743886909807354, 'psi': 0.986886644666832}-{'f1_val': 0.9961605415649639, 'auprc': 0.9965617713456617, 'loss_val': 0.0327005468195101, 'psi': 0.996321033477243}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.592540 cos_to_last_merge=0.9795 (last merge round=35)
[S11] round=46 local utility u=0.004383 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9969024084087796, 'loss_val': 0.044689386367404535, 'psi': 0.9962960660846603}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961426347003207, 'loss_val': 0.052627998416823925, 'psi': 0.9961372588281139}
[S13] START round=46 head_norm_before_train=1.676707 cos_to_last_merge=0.9999 (last merge round=44)
[S13] round=46 local utility u=0.168930 metrics={'f1_val': 0.5569567948723928, 'auprc': 0.68246709655823, 'loss_val': 0.7216963767178038, 'psi': 0.6071609155467277}-{'f1_val': 0.5262639761314993, 'auprc': 0.690005237762873, 'loss_val': 0.898014335935722, 'psi': 0.5917604807840489}
[S14] START round=46 head_norm_before_train=1.561730 cos_to_last_merge=0.9999 (last merge round=43)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9475476964483059, 'auprc': 0.9985201644952262, 'loss_val': 0.07611217662277021, 'psi': 0.9679366836670741}-{'f1_val': 0.997237639618808, 'auprc': 0.9985624007199128, 'loss_val': 0.0399025630021665, 'psi': 0.99776754405925}
[S15] START round=46 head_norm_before_train=1.656897 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.773633912211776, 'auprc': 0.9873788104054687, 'loss_val': 0.34681736616615394, 'psi': 0.8591318714892531}-{'f1_val': 0.8132395521159881, 'auprc': 0.9915109234239882, 'loss_val': 0.28452284999125144, 'psi': 0.8845481006391882}
[S16] START round=46 head_norm_before_train=1.654767 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9913789670623046, 'auprc': 0.9877352954200677, 'loss_val': 0.11969759832890432, 'psi': 0.9899214984054098}-{'f1_val': 0.9918497014019625, 'auprc': 0.9953337316853853, 'loss_val': 0.06951329187873644, 'psi': 0.9932433135153316}
[S17] START round=46 head_norm_before_train=1.359967 cos_to_last_merge=0.9996 (last merge round=44)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5987667397047134, 'auprc': 0.7848615980977793, 'loss_val': 0.8875313128489485, 'psi': 0.6732046830619398}-{'f1_val': 0.6773427637156887, 'auprc': 0.8754224328053789, 'loss_val': 0.7959381583342342, 'psi': 0.7565746313515648}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S6] sending update (kind=head size=1804 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.7736 head_norm=1.669525
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.204504e-01
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.7746 head_norm=1.661135 delta_norm=0.320450
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.6270 head_norm=1.695591
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.910667e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.6276 head_norm=1.694374 delta_norm=0.039107
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9985
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9976
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9997
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.9676
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9959 head_norm=1.612067
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.848508e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9959 head_norm=1.586357 delta_norm=0.048485
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.8655 head_norm=1.449682
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.836979e-01
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.8655 head_norm=1.393484 delta_norm=0.183698
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9995
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.5988 head_norm=1.381406
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.832530e-01
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.5959 head_norm=1.404047 delta_norm=0.183253
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.733209 cos_to_last_merge=0.9854 (last merge round=35)
[S2] round=47 local utility u=0.013381 metrics={'f1_val': 0.8061230278740926, 'auprc': 0.8089341967907708, 'loss_val': 0.4595645156009029, 'psi': 0.8072474954407639}-{'f1_val': 0.8180317411070113, 'auprc': 0.7665917058441317, 'loss_val': 0.4307514057608732, 'psi': 0.7974557270018594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.8061 head_norm=1.746330
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.112660e-02
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.8048 head_norm=1.713351 delta_norm=0.071127
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=47 head_norm_before_train=2.215214 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=47 local utility u=0.413356 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999321277363712, 'loss_val': 0.06926815664487106, 'psi': 0.976373562185157}-{'f1_val': 0.8614796131187885, 'auprc': 0.988283084370525, 'loss_val': 0.2652932857447674, 'psi': 0.9122010016194831}
[S4] START round=47 head_norm_before_train=1.694374 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=1.000000 metrics={'f1_val': 0.9390738581594918, 'auprc': 0.9342537949874444, 'loss_val': 0.2954996109788419, 'psi': 0.937145832890673}-{'f1_val': 0.6269962959341338, 'auprc': 0.9230760019992417, 'loss_val': 0.6931160557364767, 'psi': 0.7454281783601769}
[S5] START round=47 head_norm_before_train=2.098646 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994281108281857, 'loss_val': 0.02179677515424043, 'psi': 0.9977924254183489}-{'f1_val': 0.9970695586110643, 'auprc': 0.9996250016931554, 'loss_val': 0.020718505336593983, 'psi': 0.9980917358439008}
[S6] START round=47 head_norm_before_train=1.393484 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6405990025192683, 'auprc': 0.8577947594409797, 'loss_val': 0.7294945658369497, 'psi': 0.7274773052879528}-{'f1_val': 0.8655415750455357, 'auprc': 0.9521809519579794, 'loss_val': 0.4169853021963253, 'psi': 0.9001973258105131}
[S7] START round=47 head_norm_before_train=1.696178 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=47 local utility u=0.936944 metrics={'f1_val': 0.8486656553094214, 'auprc': 0.925150395863449, 'loss_val': 0.20670833475043007, 'psi': 0.8792595515310324}-{'f1_val': 0.6421398743667854, 'auprc': 0.8057149268704361, 'loss_val': 0.48313467127405824, 'psi': 0.7075698953682457}
[S8] START round=47 head_norm_before_train=2.192517 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9985034961962724, 'loss_val': 0.03356886717021852, 'psi': 0.9974672272423666}-{'f1_val': 0.9972129601295068, 'auprc': 0.998663376733891, 'loss_val': 0.0322792893780911, 'psi': 0.9977931267712605}
[S9] START round=47 head_norm_before_train=2.227793 (no previous merge yet)
[S9] round=47 local utility u=0.008975 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999227565815851, 'loss_val': 0.016421730216354933, 'psi': 0.9982308501399197}-{'f1_val': 0.9945775144926113, 'auprc': 0.999940044944155, 'loss_val': 0.01927126745142739, 'psi': 0.9967225266732288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=47 head_norm_before_train=2.173965 (no previous merge yet)
[S10] round=47 local utility u=0.050787 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9923912203086247, 'loss_val': 0.04870164013133624, 'psi': 0.9941503604616881}-{'f1_val': 0.9830844199769249, 'auprc': 0.9925899817016925, 'loss_val': 0.07743886909807354, 'psi': 0.986886644666832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=47 head_norm_before_train=1.586357 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.004198 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977375510602986, 'loss_val': 0.04025007739686317, 'psi': 0.9967752253721051}-{'f1_val': 0.9958918378685807, 'auprc': 0.9969024084087796, 'loss_val': 0.044689386367404535, 'psi': 0.9962960660846603}
[S13] START round=47 head_norm_before_train=1.682735 cos_to_last_merge=0.9998 (last merge round=44)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5284445824090951, 'auprc': 0.6931612323651322, 'loss_val': 0.9104956517774514, 'psi': 0.5943312423915099}-{'f1_val': 0.5569567948723928, 'auprc': 0.68246709655823, 'loss_val': 0.7216963767178038, 'psi': 0.6071609155467277}
[S14] START round=47 head_norm_before_train=1.573660 cos_to_last_merge=0.9998 (last merge round=43)
[S14] round=47 local utility u=0.170229 metrics={'f1_val': 0.9970145443852145, 'auprc': 0.998850750715824, 'loss_val': 0.0334463587995548, 'psi': 0.9977490269174583}-{'f1_val': 0.9475476964483059, 'auprc': 0.9985201644952262, 'loss_val': 0.07611217662277021, 'psi': 0.9679366836670741}
[S15] START round=47 head_norm_before_train=1.661135 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.834324 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9952061179829161, 'loss_val': 0.03526136234392215, 'psi': 0.9956237584013572}-{'f1_val': 0.773633912211776, 'auprc': 0.9873788104054687, 'loss_val': 0.34681736616615394, 'psi': 0.8591318714892531}
[S16] START round=47 head_norm_before_train=1.694449 cos_to_last_merge=0.9992 (last merge round=45)
[S16] round=47 local utility u=0.020835 metrics={'f1_val': 0.9918497014019625, 'auprc': 0.9890325077946904, 'loss_val': 0.08474344654381846, 'psi': 0.9907228239590536}-{'f1_val': 0.9913789670623046, 'auprc': 0.9877352954200677, 'loss_val': 0.11969759832890432, 'psi': 0.9899214984054098}
[S17] START round=47 head_norm_before_train=1.404047 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5974965713733923, 'auprc': 0.6860446232868387, 'loss_val': 0.9816742952274771, 'psi': 0.6329157921387709}-{'f1_val': 0.5987667397047134, 'auprc': 0.7848615980977793, 'loss_val': 0.8875313128489485, 'psi': 0.6732046830619398}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:41912
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → trigger blocked (psi=0.879)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=0.9992
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9991
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9662
[S7] RECEIVED delta(kind=head bytes=1806) from S4
[S7] cosine check vs S4: cos=0.9997
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9970 head_norm=1.586807
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.804196e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9970 head_norm=1.598765 delta_norm=0.048042
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=47 metric=0.9391 head_norm=1.705004
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.242657e-02
[S4] stored merged vector for next round verification (round=47)
[S4] DEBUG after merge:  round=47 metric=0.9391 head_norm=1.700449 delta_norm=0.022427
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=47 metric=0.9611 head_norm=2.231681
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.166023e-02
[S3] stored merged vector for next round verification (round=47)
[S3] DEBUG after merge:  round=47 metric=0.9611 head_norm=2.211582 delta_norm=0.051660
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.9972
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.9968 head_norm=2.196852
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.089179e-02
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.9968 head_norm=2.213750 delta_norm=0.050892
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.713351 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.214443 metrics={'f1_val': 0.8292388496344199, 'auprc': 0.877758801476119, 'loss_val': 0.37584793478920525, 'psi': 0.8486468303710994}-{'f1_val': 0.8061230278740926, 'auprc': 0.8089341967907708, 'loss_val': 0.4595645156009029, 'psi': 0.8072474954407639}
[S2] not sending this round → trigger blocked (psi=0.849)
[S3] START round=48 head_norm_before_train=2.211582 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=48 local utility u=0.036975 metrics={'f1_val': 0.9732695901078819, 'auprc': 0.9986051443389343, 'loss_val': 0.06633749120203028, 'psi': 0.9834038118003029}-{'f1_val': 0.9610750853994537, 'auprc': 0.999321277363712, 'loss_val': 0.06926815664487106, 'psi': 0.976373562185157}
[S4] START round=48 head_norm_before_train=1.700449 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=48 local utility u=0.065497 metrics={'f1_val': 0.9461739909569962, 'auprc': 0.9583426699998652, 'loss_val': 0.2793722052655913, 'psi': 0.9510414625741437}-{'f1_val': 0.9390738581594918, 'auprc': 0.9342537949874444, 'loss_val': 0.2954996109788419, 'psi': 0.937145832890673}
[S5] START round=48 head_norm_before_train=2.105532 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9957566453872071, 'loss_val': 0.021770198965602595, 'psi': 0.9964995001316969}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994281108281857, 'loss_val': 0.02179677515424043, 'psi': 0.9977924254183489}
[S6] START round=48 head_norm_before_train=1.427538 cos_to_last_merge=0.9997 (last merge round=46)
[S6] round=48 local utility u=0.875336 metrics={'f1_val': 0.8269401145150129, 'auprc': 0.9638194440707073, 'loss_val': 0.41494282977840685, 'psi': 0.8816918463372907}-{'f1_val': 0.6405990025192683, 'auprc': 0.8577947594409797, 'loss_val': 0.7294945658369497, 'psi': 0.7274773052879528}
[S7] START round=48 head_norm_before_train=1.697495 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5190623641548098, 'auprc': 0.7818020927733625, 'loss_val': 1.0491910680882655, 'psi': 0.6241582556022309}-{'f1_val': 0.8486656553094214, 'auprc': 0.925150395863449, 'loss_val': 0.20670833475043007, 'psi': 0.8792595515310324}
[S8] START round=48 head_norm_before_train=2.213750 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.000561 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9987774301821446, 'loss_val': 0.03326950418822895, 'psi': 0.9975768008367154}-{'f1_val': 0.996776381273096, 'auprc': 0.9985034961962724, 'loss_val': 0.03356886717021852, 'psi': 0.9974672272423666}
[S9] START round=48 head_norm_before_train=2.232438 (no previous merge yet)
[S9] round=48 local utility u=0.000291 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999412406590579, 'loss_val': 0.015895838403263005, 'psi': 0.9982382437709089}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999227565815851, 'loss_val': 0.016421730216354933, 'psi': 0.9982308501399197}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=48 head_norm_before_train=2.181395 (no previous merge yet)
[S10] round=48 local utility u=0.010572 metrics={'f1_val': 0.994337411336045, 'auprc': 0.9965471995768124, 'loss_val': 0.03411137749479981, 'psi': 0.995221326632352}-{'f1_val': 0.9953231205637304, 'auprc': 0.9923912203086247, 'loss_val': 0.04870164013133624, 'psi': 0.9941503604616881}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=48 head_norm_before_train=1.604178 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=48 local utility u=0.003128 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978671704310125, 'loss_val': 0.036863024105095905, 'psi': 0.9970750708805587}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977375510602986, 'loss_val': 0.04025007739686317, 'psi': 0.9967752253721051}
[S13] START round=48 head_norm_before_train=1.688884 cos_to_last_merge=0.9996 (last merge round=44)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5249269349745905, 'auprc': 0.6973467279963115, 'loss_val': 0.9962522342517269, 'psi': 0.593894852183279}-{'f1_val': 0.5284445824090951, 'auprc': 0.6931612323651322, 'loss_val': 0.9104956517774514, 'psi': 0.5943312423915099}
[S14] START round=48 head_norm_before_train=1.598765 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.001836 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9985813374201011, 'loss_val': 0.028867984778127014, 'psi': 0.9976314202392762}-{'f1_val': 0.9970145443852145, 'auprc': 0.998850750715824, 'loss_val': 0.0334463587995548, 'psi': 0.9977490269174583}
[S15] START round=48 head_norm_before_train=1.674565 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.775462139414081, 'auprc': 0.9912694428504819, 'loss_val': 0.3412123993364597, 'psi': 0.8617850607886415}-{'f1_val': 0.9959021853469847, 'auprc': 0.9952061179829161, 'loss_val': 0.03526136234392215, 'psi': 0.9956237584013572}
[S16] START round=48 head_norm_before_train=1.733892 cos_to_last_merge=0.9973 (last merge round=45)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9382047997544287, 'auprc': 0.9917834664795854, 'loss_val': 0.21073594750227354, 'psi': 0.9596362664444914}-{'f1_val': 0.9918497014019625, 'auprc': 0.9890325077946904, 'loss_val': 0.08474344654381846, 'psi': 0.9907228239590536}
[S17] START round=48 head_norm_before_train=1.427725 cos_to_last_merge=0.9998 (last merge round=46)
[S17] round=48 local utility u=0.743928 metrics={'f1_val': 0.7181899169110224, 'auprc': 0.8727549974601092, 'loss_val': 0.7781094724512647, 'psi': 0.7800159491306571}-{'f1_val': 0.5974965713733923, 'auprc': 0.6860446232868387, 'loss_val': 0.9816742952274771, 'psi': 0.6329157921387709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S3] not sending this round → trigger blocked (psi=0.983)
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:41907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.5191 head_norm=1.701653
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.324457e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.5229 head_norm=1.703170 delta_norm=0.023245
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.7755 head_norm=1.685662
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.012737e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.7755 head_norm=1.708508 delta_norm=0.070127
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.9971
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9998
[S17] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=48 metric=0.9965 head_norm=1.620521
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.057381e-02
[S11] stored merged vector for next round verification (round=48)
[S11] DEBUG after merge:  round=48 metric=0.9965 head_norm=1.603239 delta_norm=0.040574
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] cosine check vs S17: cos=0.9971
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.7182 head_norm=1.448019
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.595979e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.7182 head_norm=1.454990 delta_norm=0.055960
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=48 metric=0.5249 head_norm=1.696921
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.202792e-01
[S13] stored merged vector for next round verification (round=48)
[S13] DEBUG after merge:  round=48 metric=0.5243 head_norm=1.671327 delta_norm=0.220279
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.726068 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7159051097315288, 'auprc': 0.8561919133784384, 'loss_val': 0.5199804343821689, 'psi': 0.7720198311902926}-{'f1_val': 0.8292388496344199, 'auprc': 0.877758801476119, 'loss_val': 0.37584793478920525, 'psi': 0.8486468303710994}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.228019 cos_to_last_merge=0.9999 (last merge round=47)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8670446608967854, 'auprc': 0.9743746869010612, 'loss_val': 0.25882108459776604, 'psi': 0.9099766712984958}-{'f1_val': 0.9732695901078819, 'auprc': 0.9986051443389343, 'loss_val': 0.06633749120203028, 'psi': 0.9834038118003029}
[S4] START round=49 head_norm_before_train=1.710735 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9388560801965247, 'auprc': 0.9564526090001104, 'loss_val': 0.2952745083582836, 'psi': 0.9458946917179589}-{'f1_val': 0.9461739909569962, 'auprc': 0.9583426699998652, 'loss_val': 0.2793722052655913, 'psi': 0.9510414625741437}
[S5] START round=49 head_norm_before_train=2.119912 (no previous merge yet)
[S5] round=49 local utility u=0.008716 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999787833467806, 'loss_val': 0.01745451827677716, 'psi': 0.9982332485053509}-{'f1_val': 0.9969947366280233, 'auprc': 0.9957566453872071, 'loss_val': 0.021770198965602595, 'psi': 0.9964995001316969}
[S6] START round=49 head_norm_before_train=1.464068 cos_to_last_merge=0.9987 (last merge round=46)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6899286544541157, 'auprc': 0.9520079590909128, 'loss_val': 0.7625993679154055, 'psi': 0.7947603763088346}-{'f1_val': 0.8269401145150129, 'auprc': 0.9638194440707073, 'loss_val': 0.41494282977840685, 'psi': 0.8816918463372907}
[S7] START round=49 head_norm_before_train=1.703170 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.470229 metrics={'f1_val': 0.6110401059109398, 'auprc': 0.793824089808128, 'loss_val': 0.6966658657347004, 'psi': 0.6841536994698152}-{'f1_val': 0.5190623641548098, 'auprc': 0.7818020927733625, 'loss_val': 1.0491910680882655, 'psi': 0.6241582556022309}
[S8] START round=49 head_norm_before_train=2.218220 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9989729000765377, 'loss_val': 0.039434447705275814, 'psi': 0.9978268245472244}-{'f1_val': 0.996776381273096, 'auprc': 0.9987774301821446, 'loss_val': 0.03326950418822895, 'psi': 0.9975768008367154}
[S9] START round=49 head_norm_before_train=2.241052 (no previous merge yet)
[S9] round=49 local utility u=0.000238 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999430525983503, 'loss_val': 0.015425790269280634, 'psi': 0.9982389685466257}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999412406590579, 'loss_val': 0.015895838403263005, 'psi': 0.9982382437709089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=49 head_norm_before_train=2.187988 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9923534033594847, 'loss_val': 0.03553949879127752, 'psi': 0.9941352336820322}-{'f1_val': 0.994337411336045, 'auprc': 0.9965471995768124, 'loss_val': 0.03411137749479981, 'psi': 0.995221326632352}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.603239 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978402452403935, 'loss_val': 0.036864775963405205, 'psi': 0.9970643008043112}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978671704310125, 'loss_val': 0.036863024105095905, 'psi': 0.9970750708805587}
[S13] START round=49 head_norm_before_train=1.671327 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=49 local utility u=0.128892 metrics={'f1_val': 0.5310010489038284, 'auprc': 0.686177650665127, 'loss_val': 0.7414054139450414, 'psi': 0.5930716896083479}-{'f1_val': 0.5249269349745905, 'auprc': 0.6973467279963115, 'loss_val': 0.9962522342517269, 'psi': 0.593894852183279}
[S14] START round=49 head_norm_before_train=1.609339 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.000234 metrics={'f1_val': 0.996823784693367, 'auprc': 0.9990352781267529, 'loss_val': 0.028715775127682894, 'psi': 0.9977083820667214}-{'f1_val': 0.9969981421187261, 'auprc': 0.9985813374201011, 'loss_val': 0.028867984778127014, 'psi': 0.9976314202392762}
[S15] START round=49 head_norm_before_train=1.708508 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9876690342342891, 'loss_val': 0.5275677045088534, 'psi': 0.8155271669551654}-{'f1_val': 0.775462139414081, 'auprc': 0.9912694428504819, 'loss_val': 0.3412123993364597, 'psi': 0.8617850607886415}
[S16] START round=49 head_norm_before_train=1.771701 cos_to_last_merge=0.9948 (last merge round=45)
[S16] round=49 local utility u=0.098643 metrics={'f1_val': 0.9564552538832802, 'auprc': 0.9919080779890193, 'loss_val': 0.12332620363504239, 'psi': 0.9706363835255759}-{'f1_val': 0.9382047997544287, 'auprc': 0.9917834664795854, 'loss_val': 0.21073594750227354, 'psi': 0.9596362664444914}
[S17] START round=49 head_norm_before_train=1.454990 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6119261914678901, 'auprc': 0.7508460205953494, 'loss_val': 0.9770517469852693, 'psi': 0.6674941231188738}-{'f1_val': 0.7181899169110224, 'auprc': 0.8727549974601092, 'loss_val': 0.7781094724512647, 'psi': 0.7800159491306571}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.6899 head_norm=1.494699
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.203476e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.6921 head_norm=1.469780 delta_norm=0.072035
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=49 metric=0.8670 head_norm=2.244458
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.867174e-02
[S3] stored merged vector for next round verification (round=49)
[S3] DEBUG after merge:  round=49 metric=0.8683 head_norm=2.231194 delta_norm=0.028672
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9999
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9968 head_norm=1.619630
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.964920e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9968 head_norm=1.619956 delta_norm=0.019649
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9960
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:41904
[S7] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S13
[S2] cosine check vs S13: cos=0.9883
[S4] RECEIVED delta(kind=head bytes=1794) from S7
[S4] cosine check vs S7: cos=0.9999
[S2] START round=50 head_norm_before_train=1.736228 cos_to_last_merge=0.9999 (last merge round=47)
[S2] round=50 local utility u=0.628932 metrics={'f1_val': 0.8282132633269687, 'auprc': 0.9923630598462518, 'loss_val': 0.344478025917359, 'psi': 0.8938731819346819}-{'f1_val': 0.7159051097315288, 'auprc': 0.8561919133784384, 'loss_val': 0.5199804343821689, 'psi': 0.7720198311902926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=50 metric=0.8282 head_norm=1.746119
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.376411e-01
[S2] stored merged vector for next round verification (round=50)
[S2] DEBUG after merge:  round=50 metric=0.8282 head_norm=1.707090 delta_norm=0.137641
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=50 head_norm_before_train=2.231194 cos_to_last_merge=1.0000 (last merge round=49)
[S3] round=50 local utility u=0.255815 metrics={'f1_val': 0.9212218105421939, 'auprc': 0.9984034900629675, 'loss_val': 0.14434071217624045, 'psi': 0.9520944823505033}-{'f1_val': 0.8670446608967854, 'auprc': 0.9743746869010612, 'loss_val': 0.25882108459776604, 'psi': 0.9099766712984958}
[S4] START round=50 head_norm_before_train=1.719238 cos_to_last_merge=0.9999 (last merge round=47)
[S4] round=50 local utility u=0.024181 metrics={'f1_val': 0.9412165301413545, 'auprc': 0.9638312302178013, 'loss_val': 0.2832102365678987, 'psi': 0.9502624101719332}-{'f1_val': 0.9388560801965247, 'auprc': 0.9564526090001104, 'loss_val': 0.2952745083582836, 'psi': 0.9458946917179589}
[S5] START round=50 head_norm_before_train=2.128385 (no previous merge yet)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9958004943454115, 'loss_val': 0.021294029678498, 'psi': 0.9965170397149786}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999787833467806, 'loss_val': 0.01745451827677716, 'psi': 0.9982332485053509}
[S6] START round=50 head_norm_before_train=1.469780 cos_to_last_merge=1.0000 (last merge round=49)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.6427155592006606, 'auprc': 0.8681849931241146, 'loss_val': 0.6894983124092935, 'psi': 0.7329033327700423}-{'f1_val': 0.6899286544541157, 'auprc': 0.9520079590909128, 'loss_val': 0.7625993679154055, 'psi': 0.7947603763088346}
[S7] START round=50 head_norm_before_train=1.710875 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=50 local utility u=0.051061 metrics={'f1_val': 0.6067988588935662, 'auprc': 0.7965636503777421, 'loss_val': 0.5773149779906264, 'psi': 0.6827047754872366}-{'f1_val': 0.6110401059109398, 'auprc': 0.793824089808128, 'loss_val': 0.6966658657347004, 'psi': 0.6841536994698152}
[S8] START round=50 head_norm_before_train=2.221607 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9987444265918226, 'loss_val': 0.039207291273498424, 'psi': 0.9977354351533384}-{'f1_val': 0.997062774194349, 'auprc': 0.9989729000765377, 'loss_val': 0.039434447705275814, 'psi': 0.9978268245472244}
[S9] START round=50 head_norm_before_train=2.247984 (no previous merge yet)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978467182401639, 'loss_val': 0.01640815274985454, 'psi': 0.9974004348033513}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999430525983503, 'loss_val': 0.015425790269280634, 'psi': 0.9982389685466257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.192436 (no previous merge yet)
[S10] round=50 local utility u=0.007993 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9968129531084792, 'loss_val': 0.028726338872707934, 'psi': 0.9954983898558034}-{'f1_val': 0.9953231205637304, 'auprc': 0.9923534033594847, 'loss_val': 0.03553949879127752, 'psi': 0.9941352336820322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=50 head_norm_before_train=1.620092 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=50 local utility u=0.000776 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978176778136889, 'loss_val': 0.03524479501845282, 'psi': 0.9970552738336294}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978402452403935, 'loss_val': 0.036864775963405205, 'psi': 0.9970643008043112}
[S13] START round=50 head_norm_before_train=1.678473 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.5472348641718613, 'auprc': 0.6952069478184505, 'loss_val': 1.0770034045187278, 'psi': 0.606423697630497}-{'f1_val': 0.5310010489038284, 'auprc': 0.686177650665127, 'loss_val': 0.7414054139450414, 'psi': 0.5930716896083479}
[S14] START round=50 head_norm_before_train=1.619956 cos_to_last_merge=1.0000 (last merge round=49)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9985936266333088, 'loss_val': 0.028808279022571198, 'psi': 0.9975039152247853}-{'f1_val': 0.996823784693367, 'auprc': 0.9990352781267529, 'loss_val': 0.028715775127682894, 'psi': 0.9977083820667214}
[S15] START round=50 head_norm_before_train=1.720223 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=50 local utility u=0.687042 metrics={'f1_val': 0.8736675251153849, 'auprc': 0.992573115466211, 'loss_val': 0.20560565501839428, 'psi': 0.9212297612557153}-{'f1_val': 0.7007659221024161, 'auprc': 0.9876690342342891, 'loss_val': 0.5275677045088534, 'psi': 0.8155271669551654}
[S16] START round=50 head_norm_before_train=1.803461 cos_to_last_merge=0.9923 (last merge round=45)
[S16] round=50 local utility u=0.142743 metrics={'f1_val': 0.9925001208475209, 'auprc': 0.9919305980356228, 'loss_val': 0.054176621776650884, 'psi': 0.9922723117227616}-{'f1_val': 0.9564552538832802, 'auprc': 0.9919080779890193, 'loss_val': 0.12332620363504239, 'psi': 0.9706363835255759}
[S17] START round=50 head_norm_before_train=1.473390 cos_to_last_merge=0.9999 (last merge round=48)
[S17] round=50 local utility u=0.306604 metrics={'f1_val': 0.6440979004582997, 'auprc': 0.8622826521226649, 'loss_val': 0.8911839602843368, 'psi': 0.7313718011240458}-{'f1_val': 0.6119261914678901, 'auprc': 0.7508460205953494, 'loss_val': 0.9770517469852693, 'psi': 0.6674941231188738}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.683)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:41913
[S15] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] ⇄ pheromone p=0.020 → S11@127.0.0.1:41912
[S16] not sending this round → trigger blocked (psi=0.992)
[S4] sending update (kind=head size=1790 to 1 peers)
[S13] ⇄ pheromone p=0.058 → S2@127.0.0.1:41902
[S6] ⇄ pheromone p=0.258 → S17@127.0.0.1:41917
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] cosine check vs S15: cos=0.9861
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1790) from S4
[S7] cosine check vs S4: cos=0.9997
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=50 metric=0.9412 head_norm=1.727725
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.981233e-02
[S4] stored merged vector for next round verification (round=50)
[S4] DEBUG after merge:  round=50 metric=0.9412 head_norm=1.719207 delta_norm=0.019812
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.142 → S7@127.0.0.1:41908
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=50 metric=0.9965 head_norm=1.637038
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.689526e-02
[S11] stored merged vector for next round verification (round=50)
[S11] DEBUG after merge:  round=50 metric=0.9965 head_norm=1.628270 delta_norm=0.016895
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.006 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.157 → S8@127.0.0.1:41909
[S17] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=50 metric=0.8737 head_norm=1.729877
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.843512e-02
[S15] stored merged vector for next round verification (round=50)
[S15] DEBUG after merge:  round=50 metric=0.8756 head_norm=1.764838 delta_norm=0.088435
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.278 → S13@127.0.0.1:41913
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.9988
[S16] ⇄ pheromone p=0.070 → S15@127.0.0.1:41915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=50 metric=0.9971 head_norm=2.226780
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.430523e-02
[S8] stored merged vector for next round verification (round=50)
[S8] DEBUG after merge:  round=50 metric=0.9971 head_norm=2.235318 delta_norm=0.024305
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.002 → S3@127.0.0.1:41903
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=50 metric=0.6068 head_norm=1.719064
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.054823e-02
[S7] stored merged vector for next round verification (round=50)
[S7] DEBUG after merge:  round=50 metric=0.6089 head_norm=1.723278 delta_norm=0.020548
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.246 → S4@127.0.0.1:41904
[S17] ⇄ pheromone p=0.240 → S6@127.0.0.1:41907
[S2] START round=51 head_norm_before_train=1.707090 cos_to_last_merge=1.0000 (last merge round=50)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.8270907178858022, 'auprc': 0.9449455805683744, 'loss_val': 0.3843790825574713, 'psi': 0.8742326629588311}-{'f1_val': 0.8282132633269687, 'auprc': 0.9923630598462518, 'loss_val': 0.344478025917359, 'psi': 0.8938731819346819}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=2.244087 cos_to_last_merge=1.0000 (last merge round=49)
[S3] round=51 local utility u=0.092749 metrics={'f1_val': 0.9472304952152506, 'auprc': 0.9977256013302456, 'loss_val': 0.1128608298531529, 'psi': 0.9674285376612486}-{'f1_val': 0.9212218105421939, 'auprc': 0.9984034900629675, 'loss_val': 0.14434071217624045, 'psi': 0.9520944823505033}
[S4] START round=51 head_norm_before_train=1.719207 cos_to_last_merge=1.0000 (last merge round=50)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9396141804464766, 'auprc': 0.9589677516481828, 'loss_val': 0.2919572509061309, 'psi': 0.9473556089271591}-{'f1_val': 0.9412165301413545, 'auprc': 0.9638312302178013, 'loss_val': 0.2832102365678987, 'psi': 0.9502624101719332}
[S5] START round=51 head_norm_before_train=2.137516 (no previous merge yet)
[S5] round=51 local utility u=0.004074 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9999235637155296, 'loss_val': 0.02992306518202876, 'psi': 0.9986070370875465}-{'f1_val': 0.9969947366280233, 'auprc': 0.9958004943454115, 'loss_val': 0.021294029678498, 'psi': 0.9965170397149786}
[S6] START round=51 head_norm_before_train=1.497185 cos_to_last_merge=0.9998 (last merge round=49)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.597747279218824, 'auprc': 0.8916722234339305, 'loss_val': 0.853294067582037, 'psi': 0.7153172569048666}-{'f1_val': 0.6427155592006606, 'auprc': 0.8681849931241146, 'loss_val': 0.6894983124092935, 'psi': 0.7329033327700423}
[S7] START round=51 head_norm_before_train=1.723278 cos_to_last_merge=1.0000 (last merge round=50)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5667345794545443, 'auprc': 0.7855417183052453, 'loss_val': 0.8958685837923882, 'psi': 0.6542574349948247}-{'f1_val': 0.6067988588935662, 'auprc': 0.7965636503777421, 'loss_val': 0.5773149779906264, 'psi': 0.6827047754872366}
[S8] START round=51 head_norm_before_train=2.235318 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=51 local utility u=0.004108 metrics={'f1_val': 0.9972126069340396, 'auprc': 0.99934248390694, 'loss_val': 0.033685295359735995, 'psi': 0.9980645577231998}-{'f1_val': 0.997062774194349, 'auprc': 0.9987444265918226, 'loss_val': 0.039207291273498424, 'psi': 0.9977354351533384}
[S9] START round=51 head_norm_before_train=2.256692 (no previous merge yet)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9999515964026168, 'loss_val': 0.02057649971573133, 'psi': 0.9965946320787369}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978467182401639, 'loss_val': 0.01640815274985454, 'psi': 0.9974004348033513}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=2.195982 (no previous merge yet)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9922776127334201, 'loss_val': 0.03451317225054389, 'psi': 0.9941049174316062}-{'f1_val': 0.9946220143540194, 'auprc': 0.9968129531084792, 'loss_val': 0.028726338872707934, 'psi': 0.9954983898558034}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.628270 cos_to_last_merge=1.0000 (last merge round=50)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975652014202043, 'loss_val': 0.0346938548662254, 'psi': 0.9969542832762355}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978176778136889, 'loss_val': 0.03524479501845282, 'psi': 0.9970552738336294}
[S13] START round=51 head_norm_before_train=1.688110 cos_to_last_merge=0.9999 (last merge round=48)
[S13] round=51 local utility u=0.026552 metrics={'f1_val': 0.5414477294729728, 'auprc': 0.7014066547757392, 'loss_val': 1.0077762267263504, 'psi': 0.6054312995940794}-{'f1_val': 0.5472348641718613, 'auprc': 0.6952069478184505, 'loss_val': 1.0770034045187278, 'psi': 0.606423697630497}
[S14] START round=51 head_norm_before_train=1.628550 cos_to_last_merge=1.0000 (last merge round=49)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9468912788095072, 'auprc': 0.9985336366312021, 'loss_val': 0.07361015377121989, 'psi': 0.9675482219381852}-{'f1_val': 0.9967774409524363, 'auprc': 0.9985936266333088, 'loss_val': 0.028808279022571198, 'psi': 0.9975039152247853}
[S15] START round=51 head_norm_before_train=1.764838 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=51 local utility u=0.454003 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9937683804128414, 'loss_val': 0.03383588472262357, 'psi': 0.9949728297747715}-{'f1_val': 0.8736675251153849, 'auprc': 0.992573115466211, 'loss_val': 0.20560565501839428, 'psi': 0.9212297612557153}
[S16] START round=51 head_norm_before_train=1.831009 cos_to_last_merge=0.9901 (last merge round=45)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.9916366243823549, 'auprc': 0.9929941898706349, 'loss_val': 0.053229886418688234, 'psi': 0.992179650577667}-{'f1_val': 0.9925001208475209, 'auprc': 0.9919305980356228, 'loss_val': 0.054176621776650884, 'psi': 0.9922723117227616}
[S17] START round=51 head_norm_before_train=1.491698 cos_to_last_merge=0.9995 (last merge round=48)
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.5908797116594274, 'auprc': 0.8214278424617647, 'loss_val': 0.9921097312855905, 'psi': 0.6830989639803624}-{'f1_val': 0.6440979004582997, 'auprc': 0.8622826521226649, 'loss_val': 0.8911839602843368, 'psi': 0.7313718011240458}
[S15] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.967)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=51 metric=0.9469 head_norm=1.637102
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.234103e-02
[S14] stored merged vector for next round verification (round=51)
[S14] DEBUG after merge:  round=51 metric=0.9469 head_norm=1.637024 delta_norm=0.012341
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=51 metric=0.5977 head_norm=1.523588
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.342412e-02
[S6] stored merged vector for next round verification (round=51)
[S6] DEBUG after merge:  round=51 metric=0.5974 head_norm=1.506781 delta_norm=0.053424
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9966
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=51 metric=0.5414 head_norm=1.694546
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.454614e-01
[S13] stored merged vector for next round verification (round=51)
[S13] DEBUG after merge:  round=51 metric=0.5414 head_norm=1.706113 delta_norm=0.145461
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9998
[S2] START round=52 head_norm_before_train=1.719313 cos_to_last_merge=1.0000 (last merge round=50)
[S2] round=52 local utility u=0.011854 metrics={'f1_val': 0.8278767009909521, 'auprc': 0.9479739658854553, 'loss_val': 0.37447158871124525, 'psi': 0.8759156069487535}-{'f1_val': 0.8270907178858022, 'auprc': 0.9449455805683744, 'loss_val': 0.3843790825574713, 'psi': 0.8742326629588311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=52 metric=0.8279 head_norm=1.731335
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.709099e-02
[S2] stored merged vector for next round verification (round=52)
[S2] DEBUG after merge:  round=52 metric=0.8279 head_norm=1.711304 delta_norm=0.077091
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=52 head_norm_before_train=2.257651 cos_to_last_merge=0.9999 (last merge round=49)
[S3] round=52 local utility u=0.142335 metrics={'f1_val': 0.9843741729366471, 'auprc': 0.9982012558443936, 'loss_val': 0.052479648571342574, 'psi': 0.9899050060997457}-{'f1_val': 0.9472304952152506, 'auprc': 0.9977256013302456, 'loss_val': 0.1128608298531529, 'psi': 0.9674285376612486}
[S4] START round=52 head_norm_before_train=1.729827 cos_to_last_merge=1.0000 (last merge round=50)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.7914908511024563, 'auprc': 0.9258377420112688, 'loss_val': 0.46331567658867867, 'psi': 0.8452296074659813}-{'f1_val': 0.9396141804464766, 'auprc': 0.9589677516481828, 'loss_val': 0.2919572509061309, 'psi': 0.9473556089271591}
[S5] START round=52 head_norm_before_train=2.142808 (no previous merge yet)
[S5] round=52 local utility u=0.000735 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9981094906421606, 'loss_val': 0.020809364859333275, 'psi': 0.9976611923132422}-{'f1_val': 0.9977293526688911, 'auprc': 0.9999235637155296, 'loss_val': 0.02992306518202876, 'psi': 0.9986070370875465}
[S6] START round=52 head_norm_before_train=1.506781 cos_to_last_merge=1.0000 (last merge round=51)
[S6] round=52 local utility u=0.164407 metrics={'f1_val': 0.6235085375415123, 'auprc': 0.9504870861096344, 'loss_val': 0.8554928520366101, 'psi': 0.7542999569687612}-{'f1_val': 0.597747279218824, 'auprc': 0.8916722234339305, 'loss_val': 0.853294067582037, 'psi': 0.7153172569048666}
[S7] START round=52 head_norm_before_train=1.735196 cos_to_last_merge=0.9999 (last merge round=50)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5163838197903785, 'auprc': 0.7791856099900772, 'loss_val': 1.2562254897873304, 'psi': 0.621504535870258}-{'f1_val': 0.5667345794545443, 'auprc': 0.7855417183052453, 'loss_val': 0.8958685837923882, 'psi': 0.6542574349948247}
[S8] START round=52 head_norm_before_train=2.240725 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9992191813164264, 'loss_val': 0.03544663442783241, 'psi': 0.9977535012904282}-{'f1_val': 0.9972126069340396, 'auprc': 0.99934248390694, 'loss_val': 0.033685295359735995, 'psi': 0.9980645577231998}
[S9] START round=52 head_norm_before_train=2.258538 (no previous merge yet)
[S9] round=52 local utility u=0.010369 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.99992811333126, 'loss_val': 0.016245505796244973, 'psi': 0.9982329928397897}-{'f1_val': 0.994356655862817, 'auprc': 0.9999515964026168, 'loss_val': 0.02057649971573133, 'psi': 0.9965946320787369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=52 head_norm_before_train=2.201912 (no previous merge yet)
[S10] round=52 local utility u=0.006497 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9960746763412023, 'loss_val': 0.028958134523648323, 'psi': 0.9952285035421308}-{'f1_val': 0.9953231205637304, 'auprc': 0.9922776127334201, 'loss_val': 0.03451317225054389, 'psi': 0.9941049174316062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=52 head_norm_before_train=1.644638 cos_to_last_merge=1.0000 (last merge round=50)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978445494996151, 'loss_val': 0.034206926732325234, 'psi': 0.9968180247478317}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975652014202043, 'loss_val': 0.0346938548662254, 'psi': 0.9969542832762355}
[S13] START round=52 head_norm_before_train=1.706113 cos_to_last_merge=1.0000 (last merge round=51)
[S13] round=52 local utility u=0.207377 metrics={'f1_val': 0.5754098688230241, 'auprc': 0.6670317505053438, 'loss_val': 0.6936710391082694, 'psi': 0.612058621495952}-{'f1_val': 0.5414477294729728, 'auprc': 0.7014066547757392, 'loss_val': 1.0077762267263504, 'psi': 0.6054312995940794}
[S14] START round=52 head_norm_before_train=1.637024 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=52 local utility u=0.173081 metrics={'f1_val': 0.9978201519282794, 'auprc': 0.9985695688801557, 'loss_val': 0.03312941101362986, 'psi': 0.9981199187090299}-{'f1_val': 0.9468912788095072, 'auprc': 0.9985336366312021, 'loss_val': 0.07361015377121989, 'psi': 0.9675482219381852}
[S15] START round=52 head_norm_before_train=1.775000 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.869380464581357, 'auprc': 0.9886024811043972, 'loss_val': 0.1798719381141532, 'psi': 0.917069271190573}-{'f1_val': 0.9957757960160583, 'auprc': 0.9937683804128414, 'loss_val': 0.03383588472262357, 'psi': 0.9949728297747715}
[S16] START round=52 head_norm_before_train=1.853315 cos_to_last_merge=0.9882 (last merge round=45)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9921073729940235, 'auprc': 0.991304589058108, 'loss_val': 0.0599445539701461, 'psi': 0.9917862594196574}-{'f1_val': 0.9916366243823549, 'auprc': 0.9929941898706349, 'loss_val': 0.053229886418688234, 'psi': 0.992179650577667}
[S17] START round=52 head_norm_before_train=1.509965 cos_to_last_merge=0.9989 (last merge round=48)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5893098493491844, 'auprc': 0.7079642622898021, 'loss_val': 1.0448591909140434, 'psi': 0.6367716145254315}-{'f1_val': 0.5908797116594274, 'auprc': 0.8214278424617647, 'loss_val': 0.9921097312855905, 'psi': 0.6830989639803624}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:41912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.612)
[S5] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.9978
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9996
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=52 metric=0.9844 head_norm=2.272364
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.273175e-02
[S3] stored merged vector for next round verification (round=52)
[S3] DEBUG after merge:  round=52 metric=0.9844 head_norm=2.256363 delta_norm=0.032732
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=52 metric=0.9968 head_norm=2.245372
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.281977e-02
[S8] stored merged vector for next round verification (round=52)
[S8] DEBUG after merge:  round=52 metric=0.9968 head_norm=2.258670 delta_norm=0.032820
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=52 metric=0.5893 head_norm=1.525646
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.026710e-02
[S17] stored merged vector for next round verification (round=52)
[S17] DEBUG after merge:  round=52 metric=0.5886 head_norm=1.526871 delta_norm=0.050267
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.711304 cos_to_last_merge=1.0000 (last merge round=52)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.939420387812311, 'loss_val': 0.3789217544319433, 'psi': 0.8724880536670907}-{'f1_val': 0.8278767009909521, 'auprc': 0.9479739658854553, 'loss_val': 0.37447158871124525, 'psi': 0.8759156069487535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.256363 cos_to_last_merge=1.0000 (last merge round=52)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9458403842739811, 'auprc': 0.9939469801376792, 'loss_val': 0.13874722004960266, 'psi': 0.9650830226194603}-{'f1_val': 0.9843741729366471, 'auprc': 0.9982012558443936, 'loss_val': 0.052479648571342574, 'psi': 0.9899050060997457}
[S4] START round=53 head_norm_before_train=1.739989 cos_to_last_merge=0.9998 (last merge round=50)
[S4] round=53 local utility u=0.572849 metrics={'f1_val': 0.9400176552609407, 'auprc': 0.9582077392275408, 'loss_val': 0.30588836907258493, 'psi': 0.9472936888475807}-{'f1_val': 0.7914908511024563, 'auprc': 0.9258377420112688, 'loss_val': 0.46331567658867867, 'psi': 0.8452296074659813}
[S5] START round=53 head_norm_before_train=2.149964 (no previous merge yet)
[S5] round=53 local utility u=0.000866 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9985203579854992, 'loss_val': 0.0185537421793503, 'psi': 0.9976498783608383}-{'f1_val': 0.99736232676063, 'auprc': 0.9981094906421606, 'loss_val': 0.020809364859333275, 'psi': 0.9976611923132422}
[S6] START round=53 head_norm_before_train=1.529748 cos_to_last_merge=0.9999 (last merge round=51)
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.8666239382149947, 'auprc': 0.9687004107623399, 'loss_val': 0.2977973054170069, 'psi': 0.9074545272339327}-{'f1_val': 0.6235085375415123, 'auprc': 0.9504870861096344, 'loss_val': 0.8554928520366101, 'psi': 0.7542999569687612}
[S7] START round=53 head_norm_before_train=1.744359 cos_to_last_merge=0.9999 (last merge round=50)
[S7] round=53 local utility u=0.439285 metrics={'f1_val': 0.5789061452254127, 'auprc': 0.7933345605332878, 'loss_val': 0.7952359566068762, 'psi': 0.6646775113485628}-{'f1_val': 0.5163838197903785, 'auprc': 0.7791856099900772, 'loss_val': 1.2562254897873304, 'psi': 0.621504535870258}
[S8] START round=53 head_norm_before_train=2.258670 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=53 local utility u=0.000778 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9991413816141202, 'loss_val': 0.03365674085432921, 'psi': 0.9977223814095058}-{'f1_val': 0.996776381273096, 'auprc': 0.9992191813164264, 'loss_val': 0.03544663442783241, 'psi': 0.9977535012904282}
[S9] START round=53 head_norm_before_train=2.259974 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9930657726927478, 'auprc': 0.9999561287358031, 'loss_val': 0.023989694145597977, 'psi': 0.9958219151099699}-{'f1_val': 0.9971029125121428, 'auprc': 0.99992811333126, 'loss_val': 0.016245505796244973, 'psi': 0.9982329928397897}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.209014 (no previous merge yet)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9950966365636325, 'loss_val': 0.028876577640805322, 'psi': 0.9949689890836897}-{'f1_val': 0.9946643883427498, 'auprc': 0.9960746763412023, 'loss_val': 0.028958134523648323, 'psi': 0.9952285035421308}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=1.658175 cos_to_last_merge=0.9999 (last merge round=50)
[S11] round=53 local utility u=0.000434 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978699676280218, 'loss_val': 0.03341502771949262, 'psi': 0.9968281919991944}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978445494996151, 'loss_val': 0.034206926732325234, 'psi': 0.9968180247478317}
[S13] START round=53 head_norm_before_train=1.709813 cos_to_last_merge=1.0000 (last merge round=51)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.5629738770749481, 'auprc': 0.6971607058773632, 'loss_val': 1.0338243727521852, 'psi': 0.6166486085959142}-{'f1_val': 0.5754098688230241, 'auprc': 0.6670317505053438, 'loss_val': 0.6936710391082694, 'psi': 0.612058621495952}
[S14] START round=53 head_norm_before_train=1.646682 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=53 local utility u=0.002931 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9989681242919453, 'loss_val': 0.02612882333300478, 'psi': 0.9980458800211558}-{'f1_val': 0.9978201519282794, 'auprc': 0.9985695688801557, 'loss_val': 0.03312941101362986, 'psi': 0.9981199187090299}
[S15] START round=53 head_norm_before_train=1.783670 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7005927904599714, 'auprc': 0.9875213013941818, 'loss_val': 0.516298693523203, 'psi': 0.8153641948336556}-{'f1_val': 0.869380464581357, 'auprc': 0.9886024811043972, 'loss_val': 0.1798719381141532, 'psi': 0.917069271190573}
[S16] START round=53 head_norm_before_train=1.873383 cos_to_last_merge=0.9864 (last merge round=45)
[S16] round=53 local utility u=0.015183 metrics={'f1_val': 0.9931939889468008, 'auprc': 0.9930720254713721, 'loss_val': 0.04140026399205242, 'psi': 0.9931452035566293}-{'f1_val': 0.9921073729940235, 'auprc': 0.991304589058108, 'loss_val': 0.0599445539701461, 'psi': 0.9917862594196574}
[S17] START round=53 head_norm_before_train=1.526871 cos_to_last_merge=1.0000 (last merge round=52)
[S17] round=53 local utility u=0.724114 metrics={'f1_val': 0.68489397833973, 'auprc': 0.8980513215532074, 'loss_val': 0.7403979892563011, 'psi': 0.770156915625121}-{'f1_val': 0.5893098493491844, 'auprc': 0.7079642622898021, 'loss_val': 1.0448591909140434, 'psi': 0.6367716145254315}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[S6] not sending this round → trigger blocked (psi=0.907)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:41907
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9993
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] cosine check vs S11: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9993
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=53 metric=0.5789 head_norm=1.749511
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.154432e-02
[S7] stored merged vector for next round verification (round=53)
[S7] DEBUG after merge:  round=53 metric=0.5836 head_norm=1.748559 delta_norm=0.031544
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=53 metric=0.9400 head_norm=1.748176
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.154431e-02
[S4] stored merged vector for next round verification (round=53)
[S4] DEBUG after merge:  round=53 metric=0.9400 head_norm=1.748559 delta_norm=0.031544
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9950
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=0.9987
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=53 metric=0.9961 head_norm=1.671707
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.901835e-02
[S11] stored merged vector for next round verification (round=53)
[S11] DEBUG after merge:  round=53 metric=0.9961 head_norm=1.659133 delta_norm=0.019018
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.726962 cos_to_last_merge=1.0000 (last merge round=52)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.7511809431707352, 'auprc': 0.9871330253173916, 'loss_val': 0.4262423848227918, 'psi': 0.8455617760293977}-{'f1_val': 0.8278664975702772, 'auprc': 0.939420387812311, 'loss_val': 0.3789217544319433, 'psi': 0.8724880536670907}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=2.270810 cos_to_last_merge=1.0000 (last merge round=52)
[S3] round=54 local utility u=0.043925 metrics={'f1_val': 0.9559596535689642, 'auprc': 0.9965709824109841, 'loss_val': 0.11948579236727579, 'psi': 0.9722041851057721}-{'f1_val': 0.9458403842739811, 'auprc': 0.9939469801376792, 'loss_val': 0.13874722004960266, 'psi': 0.9650830226194603}
[S4] START round=54 head_norm_before_train=1.748559 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.8010490586707674, 'auprc': 0.9372854933344883, 'loss_val': 0.45438393840053304, 'psi': 0.8555436325362558}-{'f1_val': 0.9400176552609407, 'auprc': 0.9582077392275408, 'loss_val': 0.30588836907258493, 'psi': 0.9472936888475807}
[S5] START round=54 head_norm_before_train=2.159686 (no previous merge yet)
[S5] round=54 local utility u=0.002403 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9997748562246567, 'loss_val': 0.017510981277595403, 'psi': 0.9981516776565013}-{'f1_val': 0.9970695586110643, 'auprc': 0.9985203579854992, 'loss_val': 0.0185537421793503, 'psi': 0.9976498783608383}
[S6] START round=54 head_norm_before_train=1.552537 cos_to_last_merge=0.9996 (last merge round=51)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6160605282145544, 'auprc': 0.9523027564121646, 'loss_val': 0.8987854644776386, 'psi': 0.7505574194935984}-{'f1_val': 0.8666239382149947, 'auprc': 0.9687004107623399, 'loss_val': 0.2977973054170069, 'psi': 0.9074545272339327}
[S7] START round=54 head_norm_before_train=1.748559 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5571794476491325, 'auprc': 0.787475494521233, 'loss_val': 0.9351882614550906, 'psi': 0.6492978663979727}-{'f1_val': 0.5789061452254127, 'auprc': 0.7933345605332878, 'loss_val': 0.7952359566068762, 'psi': 0.6646775113485628}
[S8] START round=54 head_norm_before_train=2.264804 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=54 local utility u=0.003738 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9985746120170886, 'loss_val': 0.027099605164768486, 'psi': 0.9977576208845396}-{'f1_val': 0.996776381273096, 'auprc': 0.9991413816141202, 'loss_val': 0.03365674085432921, 'psi': 0.9977223814095058}
[S9] START round=54 head_norm_before_train=2.260721 (no previous merge yet)
[S9] round=54 local utility u=0.015911 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999927210710165, 'loss_val': 0.01630420118942857, 'psi': 0.9982326317913517}-{'f1_val': 0.9930657726927478, 'auprc': 0.9999561287358031, 'loss_val': 0.023989694145597977, 'psi': 0.9958219151099699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=54 head_norm_before_train=2.216714 (no previous merge yet)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9926444973525038, 'loss_val': 0.029355935218168903, 'psi': 0.9942516712792397}-{'f1_val': 0.9948838907637279, 'auprc': 0.9950966365636325, 'loss_val': 0.028876577640805322, 'psi': 0.9949689890836897}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.659133 cos_to_last_merge=1.0000 (last merge round=53)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977484351279864, 'loss_val': 0.03362383829685618, 'psi': 0.9967795789991801}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978699676280218, 'loss_val': 0.03341502771949262, 'psi': 0.9968281919991944}
[S13] START round=54 head_norm_before_train=1.714343 cos_to_last_merge=1.0000 (last merge round=51)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5511004058072031, 'auprc': 0.6593174003985188, 'loss_val': 1.1077839130527898, 'psi': 0.5943872036437294}-{'f1_val': 0.5629738770749481, 'auprc': 0.6971607058773632, 'loss_val': 1.0338243727521852, 'psi': 0.6166486085959142}
[S14] START round=54 head_norm_before_train=1.654533 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.996748294078148, 'auprc': 0.9986679392881146, 'loss_val': 0.028813496859699653, 'psi': 0.9975161521621347}-{'f1_val': 0.9974310505072961, 'auprc': 0.9989681242919453, 'loss_val': 0.02612882333300478, 'psi': 0.9980458800211558}
[S15] START round=54 head_norm_before_train=1.793337 cos_to_last_merge=0.9999 (last merge round=50)
[S15] round=54 local utility u=1.000000 metrics={'f1_val': 0.9883989668692739, 'auprc': 0.9974804923303581, 'loss_val': 0.06472806431870806, 'psi': 0.9920315770537076}-{'f1_val': 0.7005927904599714, 'auprc': 0.9875213013941818, 'loss_val': 0.516298693523203, 'psi': 0.8153641948336556}
[S16] START round=54 head_norm_before_train=1.890375 cos_to_last_merge=0.9848 (last merge round=45)
[S16] round=54 local utility u=0.000551 metrics={'f1_val': 0.992997014845498, 'auprc': 0.9931977308359482, 'loss_val': 0.03949259731680768, 'psi': 0.993077301241678}-{'f1_val': 0.9931939889468008, 'auprc': 0.9930720254713721, 'loss_val': 0.04140026399205242, 'psi': 0.9931452035566293}
[S17] START round=54 head_norm_before_train=1.538615 cos_to_last_merge=0.9999 (last merge round=52)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.5901039932167652, 'auprc': 0.7533132249859655, 'loss_val': 1.0751817898163534, 'psi': 0.6553876859244454}-{'f1_val': 0.68489397833973, 'auprc': 0.8980513215532074, 'loss_val': 0.7403979892563011, 'psi': 0.770156915625121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.993)
[S8] not sending this round → trigger blocked (psi=0.998)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=54 metric=0.6161 head_norm=1.576985
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.174425e-02
[S6] stored merged vector for next round verification (round=54)
[S6] DEBUG after merge:  round=54 metric=0.6160 head_norm=1.557059 delta_norm=0.051744
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=54 metric=0.9967 head_norm=1.663217
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.765466e-02
[S14] stored merged vector for next round verification (round=54)
[S14] DEBUG after merge:  round=54 metric=0.9967 head_norm=1.667374 delta_norm=0.017655
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9920
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9998
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=54 metric=0.9884 head_norm=1.803062
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.036622e-01
[S15] stored merged vector for next round verification (round=54)
[S15] DEBUG after merge:  round=54 metric=0.9884 head_norm=1.844324 delta_norm=0.103662
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=54 metric=0.9560 head_norm=2.285516
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.136855e-02
[S3] stored merged vector for next round verification (round=54)
[S3] DEBUG after merge:  round=54 metric=0.9565 head_norm=2.275083 delta_norm=0.021369
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=54 metric=0.5511 head_norm=1.721542
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.183793e-01
[S13] stored merged vector for next round verification (round=54)
[S13] DEBUG after merge:  round=54 metric=0.5493 head_norm=1.758794 delta_norm=0.118379
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=54 metric=0.9972 head_norm=2.273013
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.126792e-02
[S8] stored merged vector for next round verification (round=54)
[S8] DEBUG after merge:  round=54 metric=0.9972 head_norm=2.279174 delta_norm=0.021268
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=1.744178 cos_to_last_merge=0.9998 (last merge round=52)
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.8303138196714477, 'auprc': 0.7552601582762294, 'loss_val': 0.40717175637911596, 'psi': 0.8002923551133604}-{'f1_val': 0.7511809431707352, 'auprc': 0.9871330253173916, 'loss_val': 0.4262423848227918, 'psi': 0.8455617760293977}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=2.275083 cos_to_last_merge=1.0000 (last merge round=54)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.8635488734272063, 'auprc': 0.9810891706086315, 'loss_val': 0.25132971078253213, 'psi': 0.9105649922997764}-{'f1_val': 0.9559596535689642, 'auprc': 0.9965709824109841, 'loss_val': 0.11948579236727579, 'psi': 0.9722041851057721}
[S4] START round=55 head_norm_before_train=1.758024 cos_to_last_merge=1.0000 (last merge round=53)
[S4] round=55 local utility u=0.276094 metrics={'f1_val': 0.8738621706177931, 'auprc': 0.9563338979925449, 'loss_val': 0.39622048333728926, 'psi': 0.9068508615676938}-{'f1_val': 0.8010490586707674, 'auprc': 0.9372854933344883, 'loss_val': 0.45438393840053304, 'psi': 0.8555436325362558}
[S5] START round=55 head_norm_before_train=2.175138 (no previous merge yet)
[S5] round=55 local utility u=0.001149 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999804148255879, 'loss_val': 0.015829223871400278, 'psi': 0.9982339010968737}-{'f1_val': 0.9970695586110643, 'auprc': 0.9997748562246567, 'loss_val': 0.017510981277595403, 'psi': 0.9981516776565013}
[S6] START round=55 head_norm_before_train=1.557059 cos_to_last_merge=1.0000 (last merge round=54)
[S6] round=55 local utility u=0.487202 metrics={'f1_val': 0.7373752018278708, 'auprc': 0.9520806014329745, 'loss_val': 0.6516025632530251, 'psi': 0.8232573616699123}-{'f1_val': 0.6160605282145544, 'auprc': 0.9523027564121646, 'loss_val': 0.8987854644776386, 'psi': 0.7505574194935984}
[S7] START round=55 head_norm_before_train=1.757269 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=55 local utility u=0.358714 metrics={'f1_val': 0.6167158792807396, 'auprc': 0.8002855014223179, 'loss_val': 0.6134083255402347, 'psi': 0.6901437281373709}-{'f1_val': 0.5571794476491325, 'auprc': 0.787475494521233, 'loss_val': 0.9351882614550906, 'psi': 0.6492978663979727}
[S8] START round=55 head_norm_before_train=2.279174 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9979095834016116, 'loss_val': 0.025177271080752288, 'psi': 0.9972296621245023}-{'f1_val': 0.9972129601295068, 'auprc': 0.9985746120170886, 'loss_val': 0.027099605164768486, 'psi': 0.9977576208845396}
[S9] START round=55 head_norm_before_train=2.267488 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999086857660353, 'loss_val': 0.016898337608417684, 'psi': 0.9977260917446578}-{'f1_val': 0.9971029125121428, 'auprc': 0.999927210710165, 'loss_val': 0.01630420118942857, 'psi': 0.9982326317913517}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.224504 (no previous merge yet)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9924448059181173, 'loss_val': 0.029074826996346188, 'psi': 0.9941717947054851}-{'f1_val': 0.9953231205637304, 'auprc': 0.9926444973525038, 'loss_val': 0.029355935218168903, 'psi': 0.9942516712792397}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=1.672576 cos_to_last_merge=1.0000 (last merge round=53)
[S11] round=55 local utility u=0.000458 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977345987029385, 'loss_val': 0.032666211046628486, 'psi': 0.996774044429161}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977484351279864, 'loss_val': 0.03362383829685618, 'psi': 0.9967795789991801}
[S13] START round=55 head_norm_before_train=1.758794 cos_to_last_merge=1.0000 (last merge round=54)
[S13] round=55 local utility u=0.383733 metrics={'f1_val': 0.5915895627781903, 'auprc': 0.6979934268138793, 'loss_val': 0.699281111853765, 'psi': 0.6341511083924659}-{'f1_val': 0.5511004058072031, 'auprc': 0.6593174003985188, 'loss_val': 1.1077839130527898, 'psi': 0.5943872036437294}
[S14] START round=55 head_norm_before_train=1.667374 cos_to_last_merge=1.0000 (last merge round=54)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9917435225187102, 'auprc': 0.9976625810967317, 'loss_val': 0.0414271279386539, 'psi': 0.9941111459499188}-{'f1_val': 0.996748294078148, 'auprc': 0.9986679392881146, 'loss_val': 0.028813496859699653, 'psi': 0.9975161521621347}
[S15] START round=55 head_norm_before_train=1.844324 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.764921385685233, 'auprc': 0.9858615798758477, 'loss_val': 0.4727033474597295, 'psi': 0.8532974633614789}-{'f1_val': 0.9883989668692739, 'auprc': 0.9974804923303581, 'loss_val': 0.06472806431870806, 'psi': 0.9920315770537076}
[S16] START round=55 head_norm_before_train=1.906742 cos_to_last_merge=0.9832 (last merge round=45)
[S16] round=55 local utility u=0.001755 metrics={'f1_val': 0.9932170045631159, 'auprc': 0.9934381848570422, 'loss_val': 0.03802337240411341, 'psi': 0.9933054766806865}-{'f1_val': 0.992997014845498, 'auprc': 0.9931977308359482, 'loss_val': 0.03949259731680768, 'psi': 0.993077301241678}
[S17] START round=55 head_norm_before_train=1.550770 cos_to_last_merge=0.9998 (last merge round=52)
[S17] round=55 local utility u=1.000000 metrics={'f1_val': 0.7772312196492469, 'auprc': 0.9587194958779571, 'loss_val': 0.619567440427457, 'psi': 0.849826530140731}-{'f1_val': 0.5901039932167652, 'auprc': 0.7533132249859655, 'loss_val': 1.0751817898163534, 'psi': 0.6553876859244454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:41908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] ⇄ pheromone p=0.025 → S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] ⇄ pheromone p=0.081 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=0.288 → S13@127.0.0.1:41913
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9811
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.9985
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1794) from S4
[S7] cosine check vs S4: cos=0.9998
[S13] ⇄ pheromone p=0.119 → S2@127.0.0.1:41902
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=55 metric=0.8739 head_norm=1.766583
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.695101e-02
[S4] stored merged vector for next round verification (round=55)
[S4] DEBUG after merge:  round=55 metric=0.8691 head_norm=1.764763 delta_norm=0.016951
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.175 → S7@127.0.0.1:41908
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=55 metric=0.6167 head_norm=1.763104
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.695100e-02
[S7] stored merged vector for next round verification (round=55)
[S7] DEBUG after merge:  round=55 metric=0.6167 head_norm=1.764763 delta_norm=0.016951
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.208 → S4@127.0.0.1:41904
[S11] ⇄ pheromone p=0.002 → S14@127.0.0.1:41914
[S6] ⇄ pheromone p=0.327 → S17@127.0.0.1:41917
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9977
[S8] ⇄ pheromone p=0.002 → S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S17
[S6] cosine check vs S17: cos=0.9985
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=55 metric=0.7772 head_norm=1.561537
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.331319e-02
[S17] stored merged vector for next round verification (round=55)
[S17] DEBUG after merge:  round=55 metric=0.7776 head_norm=1.568914 delta_norm=0.043313
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.371 → S6@127.0.0.1:41907
[S16] ⇄ pheromone p=0.025 → S15@127.0.0.1:41915
[S2] START round=56 head_norm_before_train=1.758921 cos_to_last_merge=0.9997 (last merge round=52)
[S2] round=56 local utility u=0.163331 metrics={'f1_val': 0.7915825907957615, 'auprc': 0.9465578178615188, 'loss_val': 0.42201602080638245, 'psi': 0.8535726816220645}-{'f1_val': 0.8303138196714477, 'auprc': 0.7552601582762294, 'loss_val': 0.40717175637911596, 'psi': 0.8002923551133604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=56 metric=0.7916 head_norm=1.770688
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.747515e-01
[S2] stored merged vector for next round verification (round=56)
[S2] DEBUG after merge:  round=56 metric=0.7898 head_norm=1.758784 delta_norm=0.174751
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=56 head_norm_before_train=2.288649 cos_to_last_merge=1.0000 (last merge round=54)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.8423561547996111, 'auprc': 0.9876391092752221, 'loss_val': 0.31832701475216224, 'psi': 0.9004693365898555}-{'f1_val': 0.8635488734272063, 'auprc': 0.9810891706086315, 'loss_val': 0.25132971078253213, 'psi': 0.9105649922997764}
[S4] START round=56 head_norm_before_train=1.764763 cos_to_last_merge=1.0000 (last merge round=55)
[S4] round=56 local utility u=0.251724 metrics={'f1_val': 0.9397535293681145, 'auprc': 0.9611027414449903, 'loss_val': 0.30242709103806237, 'psi': 0.9482932141988649}-{'f1_val': 0.8738621706177931, 'auprc': 0.9563338979925449, 'loss_val': 0.39622048333728926, 'psi': 0.9068508615676938}
[S5] START round=56 head_norm_before_train=2.185374 (no previous merge yet)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9997557360239365, 'loss_val': 0.016984698489156298, 'psi': 0.9981440295762132}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999804148255879, 'loss_val': 0.015829223871400278, 'psi': 0.9982339010968737}
[S6] START round=56 head_norm_before_train=1.577447 cos_to_last_merge=0.9999 (last merge round=54)
[S6] round=56 local utility u=0.258412 metrics={'f1_val': 0.8045272330414688, 'auprc': 0.9395557312238455, 'loss_val': 0.5001160387648286, 'psi': 0.8585386323144195}-{'f1_val': 0.7373752018278708, 'auprc': 0.9520806014329745, 'loss_val': 0.6516025632530251, 'psi': 0.8232573616699123}
[S7] START round=56 head_norm_before_train=1.764763 cos_to_last_merge=1.0000 (last merge round=55)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.603105917195519, 'auprc': 0.7950374091283784, 'loss_val': 0.6311179826404829, 'psi': 0.6798785139686627}-{'f1_val': 0.6167158792807396, 'auprc': 0.8002855014223179, 'loss_val': 0.6134083255402347, 'psi': 0.6901437281373709}
[S8] START round=56 head_norm_before_train=2.286187 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9989707158871212, 'loss_val': 0.030756598334796496, 'psi': 0.9978259508714578}-{'f1_val': 0.996776381273096, 'auprc': 0.9979095834016116, 'loss_val': 0.025177271080752288, 'psi': 0.9972296621245023}
[S9] START round=56 head_norm_before_train=2.275002 (no previous merge yet)
[S9] round=56 local utility u=0.000208 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9998771877231124, 'loss_val': 0.0162142609238146, 'psi': 0.9976961437746357}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999086857660353, 'loss_val': 0.016898337608417684, 'psi': 0.9977260917446578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=56 head_norm_before_train=2.232366 (no previous merge yet)
[S10] round=56 local utility u=0.003302 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9959741238284735, 'loss_val': 0.028852219727014464, 'psi': 0.9951628581438011}-{'f1_val': 0.9953231205637304, 'auprc': 0.9924448059181173, 'loss_val': 0.029074826996346188, 'psi': 0.9941717947054851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=56 head_norm_before_train=1.683940 cos_to_last_merge=0.9999 (last merge round=53)
[S11] round=56 local utility u=0.001082 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977813297960083, 'loss_val': 0.030643026018368904, 'psi': 0.9967927368663889}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977345987029385, 'loss_val': 0.032666211046628486, 'psi': 0.996774044429161}
[S13] START round=56 head_norm_before_train=1.764194 cos_to_last_merge=1.0000 (last merge round=54)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.5337341253091303, 'auprc': 0.6891711462453525, 'loss_val': 0.8718140828276735, 'psi': 0.5959089336836192}-{'f1_val': 0.5915895627781903, 'auprc': 0.6979934268138793, 'loss_val': 0.699281111853765, 'psi': 0.6341511083924659}
[S14] START round=56 head_norm_before_train=1.675100 cos_to_last_merge=1.0000 (last merge round=54)
[S14] round=56 local utility u=0.024185 metrics={'f1_val': 0.997014101118975, 'auprc': 0.9989741293221088, 'loss_val': 0.028614774514692506, 'psi': 0.9977981124002285}-{'f1_val': 0.9917435225187102, 'auprc': 0.9976625810967317, 'loss_val': 0.0414271279386539, 'psi': 0.9941111459499188}
[S15] START round=56 head_norm_before_train=1.854143 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=56 local utility u=0.682086 metrics={'f1_val': 0.927123474415145, 'auprc': 0.9932696281393943, 'loss_val': 0.10396845409449144, 'psi': 0.9535819359048447}-{'f1_val': 0.764921385685233, 'auprc': 0.9858615798758477, 'loss_val': 0.4727033474597295, 'psi': 0.8532974633614789}
[S16] START round=56 head_norm_before_train=1.922310 cos_to_last_merge=0.9818 (last merge round=45)
[S16] round=56 local utility u=0.000907 metrics={'f1_val': 0.9932170045631159, 'auprc': 0.9936638687483261, 'loss_val': 0.03688605479190058, 'psi': 0.9933957502372001}-{'f1_val': 0.9932170045631159, 'auprc': 0.9934381848570422, 'loss_val': 0.03802337240411341, 'psi': 0.9933054766806865}
[S17] START round=56 head_norm_before_train=1.568914 cos_to_last_merge=1.0000 (last merge round=55)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.5987478432037447, 'auprc': 0.8263451482778513, 'loss_val': 1.0150606782686302, 'psi': 0.6897867652333873}-{'f1_val': 0.7772312196492469, 'auprc': 0.9587194958779571, 'loss_val': 0.619567440427457, 'psi': 0.849826530140731}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.948)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.859)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:41913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=56 metric=0.8045 head_norm=1.596348
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.257042e-02
[S6] stored merged vector for next round verification (round=56)
[S6] DEBUG after merge:  round=56 metric=0.8039 head_norm=1.578163 delta_norm=0.052570
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1806) from S15
[S13] cosine check vs S15: cos=0.9938
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=56 metric=0.9271 head_norm=1.862528
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.244793e-02
[S15] stored merged vector for next round verification (round=56)
[S15] DEBUG after merge:  round=56 metric=0.9282 head_norm=1.891268 delta_norm=0.072448
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=56 metric=0.9970 head_norm=1.681783
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.339736e-02
[S14] stored merged vector for next round verification (round=56)
[S14] DEBUG after merge:  round=56 metric=0.9970 head_norm=1.682809 delta_norm=0.013397
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=1.758784 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.6450729274569501, 'auprc': 0.8010838745312856, 'loss_val': 1.2172682117402507, 'psi': 0.7074773062866844}-{'f1_val': 0.7915825907957615, 'auprc': 0.9465578178615188, 'loss_val': 0.42201602080638245, 'psi': 0.8535726816220645}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.299410 cos_to_last_merge=0.9999 (last merge round=54)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.7695970308057795, 'auprc': 0.9796463807266421, 'loss_val': 0.465016008228825, 'psi': 0.8536167707741245}-{'f1_val': 0.8423561547996111, 'auprc': 0.9876391092752221, 'loss_val': 0.31832701475216224, 'psi': 0.9004693365898555}
[S4] START round=57 head_norm_before_train=1.774392 cos_to_last_merge=1.0000 (last merge round=55)
[S4] round=57 local utility u=0.007167 metrics={'f1_val': 0.9406657361229986, 'auprc': 0.9629531033016284, 'loss_val': 0.2991173728888658, 'psi': 0.9495806829944506}-{'f1_val': 0.9397535293681145, 'auprc': 0.9611027414449903, 'loss_val': 0.30242709103806237, 'psi': 0.9482932141988649}
[S5] START round=57 head_norm_before_train=2.190009 (no previous merge yet)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9982693689489166, 'loss_val': 0.020694511667519983, 'psi': 0.9975494827462053}-{'f1_val': 0.9970695586110643, 'auprc': 0.9997557360239365, 'loss_val': 0.016984698489156298, 'psi': 0.9981440295762132}
[S6] START round=57 head_norm_before_train=1.578163 cos_to_last_merge=1.0000 (last merge round=56)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.5844811643176148, 'auprc': 0.6962691918603341, 'loss_val': 1.113690942296313, 'psi': 0.6291963753347025}-{'f1_val': 0.8045272330414688, 'auprc': 0.9395557312238455, 'loss_val': 0.5001160387648286, 'psi': 0.8585386323144195}
[S7] START round=57 head_norm_before_train=1.771305 cos_to_last_merge=1.0000 (last merge round=55)
[S7] round=57 local utility u=0.248542 metrics={'f1_val': 0.6487740490934254, 'auprc': 0.8076697349452684, 'loss_val': 0.44593941999062703, 'psi': 0.7123323234341625}-{'f1_val': 0.603105917195519, 'auprc': 0.7950374091283784, 'loss_val': 0.6311179826404829, 'psi': 0.6798785139686627}
[S8] START round=57 head_norm_before_train=2.291301 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=57 local utility u=0.001371 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9991764261350485, 'loss_val': 0.028631726203960914, 'psi': 0.9979082349706287}-{'f1_val': 0.997062774194349, 'auprc': 0.9989707158871212, 'loss_val': 0.030756598334796496, 'psi': 0.9978259508714578}
[S9] START round=57 head_norm_before_train=2.280260 (no previous merge yet)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999527938665884, 'loss_val': 0.020583192877879825, 'psi': 0.9967453073162569}-{'f1_val': 0.9962421144756511, 'auprc': 0.9998771877231124, 'loss_val': 0.0162142609238146, 'psi': 0.9976961437746357}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.240157 (no previous merge yet)
[S10] round=57 local utility u=0.000270 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9962094644170514, 'loss_val': 0.029018273896688436, 'psi': 0.9952569943792322}-{'f1_val': 0.9946220143540194, 'auprc': 0.9959741238284735, 'loss_val': 0.028852219727014464, 'psi': 0.9951628581438011}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=57 head_norm_before_train=1.696376 cos_to_last_merge=0.9999 (last merge round=53)
[S11] round=57 local utility u=0.000613 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978130327981861, 'loss_val': 0.02951180569309727, 'psi': 0.9968054180672601}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977813297960083, 'loss_val': 0.030643026018368904, 'psi': 0.9967927368663889}
[S13] START round=57 head_norm_before_train=1.769699 cos_to_last_merge=0.9999 (last merge round=54)
[S13] round=57 local utility u=0.051604 metrics={'f1_val': 0.5426462753039014, 'auprc': 0.7177619004143301, 'loss_val': 0.9078503683086662, 'psi': 0.6126925253480728}-{'f1_val': 0.5337341253091303, 'auprc': 0.6891711462453525, 'loss_val': 0.8718140828276735, 'psi': 0.5959089336836192}
[S14] START round=57 head_norm_before_train=1.682809 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=57 local utility u=0.001176 metrics={'f1_val': 0.9972617020302783, 'auprc': 0.9985748361826563, 'loss_val': 0.02655141000161893, 'psi': 0.9977869556912294}-{'f1_val': 0.997014101118975, 'auprc': 0.9989741293221088, 'loss_val': 0.028614774514692506, 'psi': 0.9977981124002285}
[S15] START round=57 head_norm_before_train=1.891268 cos_to_last_merge=1.0000 (last merge round=56)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8212797366570158, 'auprc': 0.988463052159209, 'loss_val': 0.2471976032993801, 'psi': 0.8881530628578931}-{'f1_val': 0.927123474415145, 'auprc': 0.9932696281393943, 'loss_val': 0.10396845409449144, 'psi': 0.9535819359048447}
[S16] START round=57 head_norm_before_train=1.936969 cos_to_last_merge=0.9804 (last merge round=45)
[S16] round=57 local utility u=0.000693 metrics={'f1_val': 0.9931659135106551, 'auprc': 0.994738476607036, 'loss_val': 0.03841728676177372, 'psi': 0.9937949387492074}-{'f1_val': 0.9932170045631159, 'auprc': 0.9936638687483261, 'loss_val': 0.03688605479190058, 'psi': 0.9933957502372001}
[S17] START round=57 head_norm_before_train=1.579455 cos_to_last_merge=1.0000 (last merge round=55)
[S17] round=57 local utility u=0.854471 metrics={'f1_val': 0.7489631737671913, 'auprc': 0.9766965437690834, 'loss_val': 0.6584647154902639, 'psi': 0.8400565217679482}-{'f1_val': 0.5987478432037447, 'auprc': 0.8263451482778513, 'loss_val': 1.0150606782686302, 'psi': 0.6897867652333873}
[S5]  timeout peer S16
[S17]  timeout peer S14
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S14] not sending this round → trigger blocked (psi=0.998)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:41902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:41915
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:41911
[S2] RECEIVED delta(kind=head bytes=1804) from S13
[S2] cosine check vs S13: cos=0.9949
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9998
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=57 metric=0.9961 head_norm=1.709017
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.489988e-02
[S11] stored merged vector for next round verification (round=57)
[S11] DEBUG after merge:  round=57 metric=0.9961 head_norm=1.695272 delta_norm=0.024900
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=57 metric=0.6488 head_norm=1.780441
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.858876e-02
[S7] stored merged vector for next round verification (round=57)
[S7] DEBUG after merge:  round=57 metric=0.6444 head_norm=1.782565 delta_norm=0.018589
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=57 metric=0.5426 head_norm=1.774468
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.111718e-01
[S13] stored merged vector for next round verification (round=57)
[S13] DEBUG after merge:  round=57 metric=0.5439 head_norm=1.815630 delta_norm=0.111172
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1801) from S8
[S10] cosine check vs S8: cos=0.9922
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] cosine check vs S16: cos=0.9988
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.9996
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=57 metric=0.9407 head_norm=1.784880
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.858875e-02
[S4] stored merged vector for next round verification (round=57)
[S4] DEBUG after merge:  round=57 metric=0.9407 head_norm=1.782565 delta_norm=0.018589
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] CommDone barrier timeout: have=0 need=1 — continuing
[S2] START round=58 head_norm_before_train=1.770136 cos_to_last_merge=1.0000 (last merge round=56)
[S2] round=58 local utility u=1.000000 metrics={'f1_val': 0.7872593882353804, 'auprc': 0.9932178965916931, 'loss_val': 0.3861626402426431, 'psi': 0.8696427915779055}-{'f1_val': 0.6450729274569501, 'auprc': 0.8010838745312856, 'loss_val': 1.2172682117402507, 'psi': 0.7074773062866844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=58 metric=0.7873 head_norm=1.781244
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.354225e-02
[S2] stored merged vector for next round verification (round=58)
[S2] DEBUG after merge:  round=58 metric=0.7863 head_norm=1.775396 delta_norm=0.093542
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=58 head_norm_before_train=2.309411 cos_to_last_merge=0.9998 (last merge round=54)
[S3] round=58 local utility u=0.267206 metrics={'f1_val': 0.8419753786253036, 'auprc': 0.9665035952154555, 'loss_val': 0.3254448991175467, 'psi': 0.8917866652613643}-{'f1_val': 0.7695970308057795, 'auprc': 0.9796463807266421, 'loss_val': 0.465016008228825, 'psi': 0.8536167707741245}
[S4] START round=58 head_norm_before_train=1.782565 cos_to_last_merge=1.0000 (last merge round=57)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9391764574126334, 'auprc': 0.9596753495382317, 'loss_val': 0.3066127774716375, 'psi': 0.9473760142628728}-{'f1_val': 0.9406657361229986, 'auprc': 0.9629531033016284, 'loss_val': 0.2991173728888658, 'psi': 0.9495806829944506}
[S5] START round=58 head_norm_before_train=2.191945 (no previous merge yet)
[S5] round=58 local utility u=0.002520 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9994167341899536, 'loss_val': 0.019096997624578692, 'psi': 0.9980084288426201}-{'f1_val': 0.9970695586110643, 'auprc': 0.9982693689489166, 'loss_val': 0.020694511667519983, 'psi': 0.9975494827462053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=58 head_norm_before_train=1.595194 cos_to_last_merge=0.9999 (last merge round=56)
[S6] round=58 local utility u=1.000000 metrics={'f1_val': 0.8310849166015077, 'auprc': 0.9325134264609557, 'loss_val': 0.4109158852407472, 'psi': 0.871656320545287}-{'f1_val': 0.5844811643176148, 'auprc': 0.6962691918603341, 'loss_val': 1.113690942296313, 'psi': 0.6291963753347025}
[S7] START round=58 head_norm_before_train=1.782565 cos_to_last_merge=1.0000 (last merge round=57)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5122546753285135, 'auprc': 0.7820781088912924, 'loss_val': 0.9402555544186824, 'psi': 0.6201840487536251}-{'f1_val': 0.6487740490934254, 'auprc': 0.8076697349452684, 'loss_val': 0.44593941999062703, 'psi': 0.7123323234341625}
[S8] START round=58 head_norm_before_train=2.297158 cos_to_last_merge=0.9999 (last merge round=54)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9972615493500947, 'loss_val': 0.039455804396109205, 'psi': 0.9969704485038955}-{'f1_val': 0.997062774194349, 'auprc': 0.9991764261350485, 'loss_val': 0.028631726203960914, 'psi': 0.9979082349706287}
[S9] START round=58 head_norm_before_train=2.287341 (no previous merge yet)
[S9] round=58 local utility u=0.008085 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999039512493891, 'loss_val': 0.016588110880248738, 'psi': 0.9979578875880906}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999527938665884, 'loss_val': 0.020583192877879825, 'psi': 0.9967453073162569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=58 head_norm_before_train=2.242910 (no previous merge yet)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9968681813734147, 'loss_val': 0.029823086231653043, 'psi': 0.9951258909618145}-{'f1_val': 0.9946220143540194, 'auprc': 0.9962094644170514, 'loss_val': 0.029018273896688436, 'psi': 0.9952569943792322}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=58 metric=0.9940 head_norm=2.243579
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.467544e-01
[S10] stored merged vector for next round verification (round=58)
[S10] DEBUG after merge:  round=58 metric=0.9940 head_norm=2.265779 delta_norm=0.146754
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] START round=58 head_norm_before_train=1.695272 cos_to_last_merge=1.0000 (last merge round=57)
[S11] round=58 local utility u=0.000053 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978133499247517, 'loss_val': 0.029405904466204044, 'psi': 0.9968055449178863}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978130327981861, 'loss_val': 0.02951180569309727, 'psi': 0.9968054180672601}
[S13] START round=58 head_norm_before_train=1.815630 cos_to_last_merge=1.0000 (last merge round=57)
[S13] round=58 local utility u=0.298542 metrics={'f1_val': 0.6163475208266808, 'auprc': 0.7191349695861118, 'loss_val': 0.7570931794341361, 'psi': 0.6574625003304532}-{'f1_val': 0.5426462753039014, 'auprc': 0.7177619004143301, 'loss_val': 0.9078503683086662, 'psi': 0.6126925253480728}
[S14] START round=58 head_norm_before_train=1.690863 cos_to_last_merge=1.0000 (last merge round=56)
[S14] round=58 local utility u=0.001207 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986683906245938, 'loss_val': 0.023977983177474793, 'psi': 0.9977802774519515}-{'f1_val': 0.9972617020302783, 'auprc': 0.9985748361826563, 'loss_val': 0.02655141000161893, 'psi': 0.9977869556912294}
[S15] START round=58 head_norm_before_train=1.897468 cos_to_last_merge=1.0000 (last merge round=56)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7115239372255693, 'auprc': 0.9713848846114276, 'loss_val': 0.47444083241178714, 'psi': 0.8154683161799126}-{'f1_val': 0.8212797366570158, 'auprc': 0.988463052159209, 'loss_val': 0.2471976032993801, 'psi': 0.8881530628578931}
[S16] START round=58 head_norm_before_train=1.949808 cos_to_last_merge=0.9792 (last merge round=45)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9923131759183407, 'auprc': 0.9902704612672966, 'loss_val': 0.0490839727744299, 'psi': 0.991496090057923}-{'f1_val': 0.9931659135106551, 'auprc': 0.994738476607036, 'loss_val': 0.03841728676177372, 'psi': 0.9937949387492074}
[S17] START round=58 head_norm_before_train=1.591557 cos_to_last_merge=0.9999 (last merge round=55)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.5810832662797523, 'auprc': 0.671236840825246, 'loss_val': 1.197079117968129, 'psi': 0.6171446960979498}-{'f1_val': 0.7489631737671913, 'auprc': 0.9766965437690834, 'loss_val': 0.6584647154902639, 'psi': 0.8400565217679482}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=58 metric=0.7115 head_norm=1.904300
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.371655e-02
[S15] stored merged vector for next round verification (round=58)
[S15] DEBUG after merge:  round=58 metric=0.7127 head_norm=1.926440 delta_norm=0.053717
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=58 metric=0.9972 head_norm=1.698975
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.531061e-02
[S14] stored merged vector for next round verification (round=58)
[S14] DEBUG after merge:  round=58 metric=0.9972 head_norm=1.703671 delta_norm=0.015311
[S14] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=58 metric=0.9961 head_norm=1.707994
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.226592e-02
[S11] stored merged vector for next round verification (round=58)
[S11] DEBUG after merge:  round=58 metric=0.9961 head_norm=1.703446 delta_norm=0.012266
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.9993
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=58 metric=0.9968 head_norm=2.300847
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.211773e-02
[S8] stored merged vector for next round verification (round=58)
[S8] DEBUG after merge:  round=58 metric=0.9968 head_norm=2.310599 delta_norm=0.032118
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=58 metric=0.8311 head_norm=1.608498
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.821087e-02
[S6] stored merged vector for next round verification (round=58)
[S6] DEBUG after merge:  round=58 metric=0.8311 head_norm=1.599801 delta_norm=0.028211
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S5
[S16]  timeout peer S15
[S8]  timeout peer S10
[S13]  timeout peer S2
[S15]  timeout peer S13
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.775396 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.7204874990226597, 'auprc': 0.8519820105307604, 'loss_val': 0.5041873417214504, 'psi': 0.7730853036259}-{'f1_val': 0.7872593882353804, 'auprc': 0.9932178965916931, 'loss_val': 0.3861626402426431, 'psi': 0.8696427915779055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.773 u=0.0000 p_local=0.2006 f1=0.720 auprc=0.852 bytes=45008
[S3] START round=59 head_norm_before_train=2.320754 cos_to_last_merge=0.9997 (last merge round=54)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.6834551744035076, 'auprc': 0.9157449745787904, 'loss_val': 0.7051341032670406, 'psi': 0.7763710944736206}-{'f1_val': 0.8419753786253036, 'auprc': 0.9665035952154555, 'loss_val': 0.3254448991175467, 'psi': 0.8917866652613643}
[S4] START round=59 head_norm_before_train=1.793259 cos_to_last_merge=1.0000 (last merge round=57)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9393128841754413, 'auprc': 0.9534409700865194, 'loss_val': 0.30867473216957575, 'psi': 0.9449641185398725}-{'f1_val': 0.9391764574126334, 'auprc': 0.9596753495382317, 'loss_val': 0.3066127774716375, 'psi': 0.9473760142628728}
[S5] START round=59 head_norm_before_train=2.195172 (no previous merge yet)
[S5] round=59 local utility u=0.001062 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999079049833588, 'loss_val': 0.01844571822242808, 'psi': 0.9982048971599822}-{'f1_val': 0.9970695586110643, 'auprc': 0.9994167341899536, 'loss_val': 0.019096997624578692, 'psi': 0.9980084288426201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=60 psi=0.998 u=0.0011 p_local=0.0024 f1=0.997 auprc=1.000 bytes=50326
[S6] START round=59 head_norm_before_train=1.599801 cos_to_last_merge=1.0000 (last merge round=58)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6114040582821884, 'auprc': 0.8772759427569924, 'loss_val': 0.7794640597827597, 'psi': 0.71775281207211}-{'f1_val': 0.8310849166015077, 'auprc': 0.9325134264609557, 'loss_val': 0.4109158852407472, 'psi': 0.871656320545287}
[S7] START round=59 head_norm_before_train=1.786298 cos_to_last_merge=1.0000 (last merge round=57)
[S7] round=59 local utility u=0.300990 metrics={'f1_val': 0.5837907453685187, 'auprc': 0.789943524346427, 'loss_val': 0.7910890376811338, 'psi': 0.666251856959682}-{'f1_val': 0.5122546753285135, 'auprc': 0.7820781088912924, 'loss_val': 0.9402555544186824, 'psi': 0.6201840487536251}
[S8] START round=59 head_norm_before_train=2.310599 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=59 local utility u=0.003419 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9977565514879612, 'loss_val': 0.034103155775153667, 'psi': 0.997168449359042}-{'f1_val': 0.996776381273096, 'auprc': 0.9972615493500947, 'loss_val': 0.039455804396109205, 'psi': 0.9969704485038955}
[S9] START round=59 head_norm_before_train=2.288078 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9999079578109028, 'loss_val': 0.01710881421042142, 'psi': 0.9977084518097519}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999039512493891, 'loss_val': 0.016588110880248738, 'psi': 0.9979578875880906}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.998 u=0.0000 p_local=0.0034 f1=0.996 auprc=1.000 bytes=50322
[S10] START round=59 head_norm_before_train=2.265779 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9962387773819343, 'loss_val': 0.030237702156014096, 'psi': 0.9948741293652223}-{'f1_val': 0.9939643640207476, 'auprc': 0.9968681813734147, 'loss_val': 0.029823086231653043, 'psi': 0.9951258909618145}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0082 f1=0.994 auprc=0.996 bytes=53966
[S11] START round=59 head_norm_before_train=1.703446 cos_to_last_merge=1.0000 (last merge round=58)
[S11] round=59 local utility u=0.000251 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978071100060969, 'loss_val': 0.028884479768394148, 'psi': 0.9968030489504244}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978133499247517, 'loss_val': 0.029405904466204044, 'psi': 0.9968055449178863}
[S13] START round=59 head_norm_before_train=1.824906 cos_to_last_merge=0.9999 (last merge round=57)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.5336516649643761, 'auprc': 0.7258069211356981, 'loss_val': 1.0253743488713116, 'psi': 0.6105137674329049}-{'f1_val': 0.6163475208266808, 'auprc': 0.7191349695861118, 'loss_val': 0.7570931794341361, 'psi': 0.6574625003304532}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.611 u=0.0000 p_local=0.1031 f1=0.534 auprc=0.726 bytes=50379
[S14] START round=59 head_norm_before_train=1.703671 cos_to_last_merge=1.0000 (last merge round=58)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9968836068908258, 'loss_val': 0.02376292695570482, 'psi': 0.9970663639584443}-{'f1_val': 0.9971882020035234, 'auprc': 0.9986683906245938, 'loss_val': 0.023977983177474793, 'psi': 0.9977802774519515}
[S15] START round=59 head_norm_before_train=1.926440 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=59 local utility u=1.000000 metrics={'f1_val': 0.9949932333886315, 'auprc': 0.9971177382742835, 'loss_val': 0.02878050165907915, 'psi': 0.9958430353428923}-{'f1_val': 0.7115239372255693, 'auprc': 0.9713848846114276, 'loss_val': 0.47444083241178714, 'psi': 0.8154683161799126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S15] r=60 psi=0.996 u=1.0000 p_local=0.3879 f1=0.995 auprc=0.997 bytes=48593
[S16] START round=59 head_norm_before_train=1.959193 cos_to_last_merge=0.9783 (last merge round=45)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9260834124917684, 'auprc': 0.9874229512119994, 'loss_val': 0.18411980065662273, 'psi': 0.9506192279798608}-{'f1_val': 0.9923131759183407, 'auprc': 0.9902704612672966, 'loss_val': 0.0490839727744299, 'psi': 0.991496090057923}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.951 u=0.0000 p_local=0.0106 f1=0.926 auprc=0.987 bytes=55740
[S17] START round=59 head_norm_before_train=1.602487 cos_to_last_merge=0.9998 (last merge round=55)
[S17] round=59 local utility u=1.000000 metrics={'f1_val': 0.8216829977620194, 'auprc': 0.9868295529640554, 'loss_val': 0.5385782758422931, 'psi': 0.8877416198428338}-{'f1_val': 0.5810832662797523, 'auprc': 0.671236840825246, 'loss_val': 1.197079117968129, 'psi': 0.6171446960979498}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:41907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] r=60 psi=0.718 u=0.0000 p_local=0.3203 f1=0.611 auprc=0.877 bytes=45002
[S4] r=60 psi=0.945 u=0.0000 p_local=0.0984 f1=0.939 auprc=0.953 bytes=48553
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=1.0000
[S7] r=60 psi=0.666 u=0.3010 p_local=0.1774 f1=0.584 auprc=0.790 bytes=50362
[S8] r=60 psi=0.997 u=0.0034 p_local=0.0015 f1=0.997 auprc=0.998 bytes=53954
[S11] r=60 psi=0.997 u=0.0003 p_local=0.0011 f1=0.996 auprc=0.998 bytes=57498
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=59 metric=0.8217 head_norm=1.614124
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.506818e-02
[S17] stored merged vector for next round verification (round=59)
[S17] DEBUG after merge:  round=59 metric=0.8214 head_norm=1.610932 delta_norm=0.035068
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] r=60 psi=0.888 u=1.0000 p_local=0.4615 f1=0.822 auprc=0.987 bytes=48571
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=59 metric=0.6835 head_norm=2.331510
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.381695e-02
[S3] stored merged vector for next round verification (round=59)
[S3] DEBUG after merge:  round=59 metric=0.6850 head_norm=2.323647 delta_norm=0.023817
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=60 psi=0.776 u=0.0000 p_local=0.0757 f1=0.683 auprc=0.916 bytes=43172
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=59 metric=0.9972 head_norm=1.712373
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.052491e-03
[S14] stored merged vector for next round verification (round=59)
[S14] DEBUG after merge:  round=59 metric=0.9972 head_norm=1.714349 delta_norm=0.005052
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0129 f1=0.997 auprc=0.997 bytes=53917
[S2] START round=60 head_norm_before_train=1.788878 cos_to_last_merge=1.0000 (last merge round=58)
[S2] round=60 local utility u=0.253280 metrics={'f1_val': 0.7145844051357673, 'auprc': 0.9917735028740235, 'loss_val': 0.38158232269718767, 'psi': 0.8254600442310698}-{'f1_val': 0.7204874990226597, 'auprc': 0.8519820105307604, 'loss_val': 0.5041873417214504, 'psi': 0.7730853036259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=60 head_norm_before_train=2.323647 cos_to_last_merge=1.0000 (last merge round=59)
[S3] round=60 local utility u=0.433363 metrics={'f1_val': 0.7663146205644704, 'auprc': 0.9752751095113219, 'loss_val': 0.5141545404961513, 'psi': 0.8498988161432111}-{'f1_val': 0.6834551744035076, 'auprc': 0.9157449745787904, 'loss_val': 0.7051341032670406, 'psi': 0.7763710944736206}
[S4] START round=60 head_norm_before_train=1.804783 cos_to_last_merge=0.9999 (last merge round=57)
[S4] round=60 local utility u=0.020169 metrics={'f1_val': 0.9403245131311283, 'auprc': 0.9633504679982463, 'loss_val': 0.3041346837771457, 'psi': 0.9495348950779755}-{'f1_val': 0.9393128841754413, 'auprc': 0.9534409700865194, 'loss_val': 0.30867473216957575, 'psi': 0.9449641185398725}
[S5] START round=60 head_norm_before_train=2.202508 (no previous merge yet)
[S5] round=60 local utility u=0.000950 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9992474285772042, 'loss_val': 0.016320475481438324, 'psi': 0.9981163674872597}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999079049833588, 'loss_val': 0.01844571822242808, 'psi': 0.9982048971599822}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=60 head_norm_before_train=1.614933 cos_to_last_merge=0.9999 (last merge round=58)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.5992070778151588, 'auprc': 0.9063098934353276, 'loss_val': 0.8500057456573344, 'psi': 0.7220482040632263}-{'f1_val': 0.6114040582821884, 'auprc': 0.8772759427569924, 'loss_val': 0.7794640597827597, 'psi': 0.71775281207211}
[S7] START round=60 head_norm_before_train=1.789469 cos_to_last_merge=1.0000 (last merge round=57)
[S7] round=60 local utility u=0.069457 metrics={'f1_val': 0.5844824175312259, 'auprc': 0.7936380608918158, 'loss_val': 0.667407716050754, 'psi': 0.6681446748754618}-{'f1_val': 0.5837907453685187, 'auprc': 0.789943524346427, 'loss_val': 0.7910890376811338, 'psi': 0.666251856959682}
[S8] START round=60 head_norm_before_train=2.316003 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=60 local utility u=0.005201 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9987381189923685, 'loss_val': 0.026644954599232575, 'psi': 0.997561076360805}-{'f1_val': 0.996776381273096, 'auprc': 0.9977565514879612, 'loss_val': 0.034103155775153667, 'psi': 0.997168449359042}
[S9] START round=60 head_norm_before_train=2.286723 (no previous merge yet)
[S9] round=60 local utility u=0.001688 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.999933310908258, 'loss_val': 0.016297835574117556, 'psi': 0.9979675315429499}-{'f1_val': 0.9962421144756511, 'auprc': 0.9999079578109028, 'loss_val': 0.01710881421042142, 'psi': 0.9977084518097519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=60 head_norm_before_train=2.265481 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9941737780502098, 'loss_val': 0.02878488405767288, 'psi': 0.9944681442257337}-{'f1_val': 0.9939643640207476, 'auprc': 0.9962387773819343, 'loss_val': 0.030237702156014096, 'psi': 0.9948741293652223}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.716338 cos_to_last_merge=1.0000 (last merge round=58)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9159809269479152, 'auprc': 0.9977458041518072, 'loss_val': 0.24324014973739025, 'psi': 0.948686877829472}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978071100060969, 'loss_val': 0.028884479768394148, 'psi': 0.9968030489504244}
[S13] START round=60 head_norm_before_train=1.830634 cos_to_last_merge=0.9999 (last merge round=57)
[S13] round=60 local utility u=0.124630 metrics={'f1_val': 0.5824518670329689, 'auprc': 0.703021623522003, 'loss_val': 1.0005600517147042, 'psi': 0.6306797696285826}-{'f1_val': 0.5336516649643761, 'auprc': 0.7258069211356981, 'loss_val': 1.0253743488713116, 'psi': 0.6105137674329049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=60 head_norm_before_train=1.714349 cos_to_last_merge=1.0000 (last merge round=59)
[S14] round=60 local utility u=0.001454 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9985375481684104, 'loss_val': 0.023611235032057584, 'psi': 0.9975073670494367}-{'f1_val': 0.9971882020035234, 'auprc': 0.9968836068908258, 'loss_val': 0.02376292695570482, 'psi': 0.9970663639584443}
[S15] START round=60 head_norm_before_train=1.933717 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.839214959637052, 'auprc': 0.9909951803867426, 'loss_val': 0.25063452544375037, 'psi': 0.8999270479369281}-{'f1_val': 0.9949932333886315, 'auprc': 0.9971177382742835, 'loss_val': 0.02878050165907915, 'psi': 0.9958430353428923}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.968263 cos_to_last_merge=0.9774 (last merge round=45)
[S16] round=60 local utility u=0.284481 metrics={'f1_val': 0.9931939889468008, 'auprc': 0.9932302466567349, 'loss_val': 0.0352433444391298, 'psi': 0.9932084920307744}-{'f1_val': 0.9260834124917684, 'auprc': 0.9874229512119994, 'loss_val': 0.18411980065662273, 'psi': 0.9506192279798608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=60 head_norm_before_train=1.610932 cos_to_last_merge=1.0000 (last merge round=59)
[S17] round=60 local utility u=0.003219 metrics={'f1_val': 0.822271014560014, 'auprc': 0.9886202956025398, 'loss_val': 0.5410400243145651, 'psi': 0.8888107269770242}-{'f1_val': 0.8216829977620194, 'auprc': 0.9868295529640554, 'loss_val': 0.5385782758422931, 'psi': 0.8877416198428338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:41908
[S7] not sending this round → trigger blocked (psi=0.668)
[S17] not sending this round → trigger blocked (psi=0.889)
[S17] ⇄ pheromone p=0.370 → S6@127.0.0.1:41907
[S7] ⇄ pheromone p=0.156 → S4@127.0.0.1:41904
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=60 metric=0.5992 head_norm=1.629854
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.588927e-02
[S6] stored merged vector for next round verification (round=60)
[S6] DEBUG after merge:  round=60 metric=0.5999 head_norm=1.621611 delta_norm=0.035889
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.256 → S17@127.0.0.1:41917
[S11] ⇄ pheromone p=0.001 → S14@127.0.0.1:41914
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=60 metric=0.9403 head_norm=1.811078
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.891936e-02
[S4] stored merged vector for next round verification (round=60)
[S4] DEBUG after merge:  round=60 metric=0.9403 head_norm=1.800207 delta_norm=0.018919
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.083 → S7@127.0.0.1:41908
[S3] ⇄ pheromone p=0.147 → S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.9999
[S14] ⇄ pheromone p=0.011 → S11@127.0.0.1:41912
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=60 metric=0.9968 head_norm=2.322514
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.956264e-02
[S8] stored merged vector for next round verification (round=60)
[S8] DEBUG after merge:  round=60 metric=0.9968 head_norm=2.327836 delta_norm=0.019563
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.002 → S3@127.0.0.1:41903
[S2] START round=61 head_norm_before_train=1.801662 cos_to_last_merge=0.9999 (last merge round=58)
[S2] round=61 local utility u=0.247321 metrics={'f1_val': 0.8276742393524328, 'auprc': 0.9376366526542964, 'loss_val': 0.40306834406765973, 'psi': 0.8716592046731783}-{'f1_val': 0.7145844051357673, 'auprc': 0.9917735028740235, 'loss_val': 0.38158232269718767, 'psi': 0.8254600442310698}
[S2] not sending this round → trigger blocked (psi=0.872)
[S3] START round=61 head_norm_before_train=2.333310 cos_to_last_merge=1.0000 (last merge round=59)
[S3] round=61 local utility u=0.053306 metrics={'f1_val': 0.7779389893077442, 'auprc': 0.9789283183893005, 'loss_val': 0.4882478806554868, 'psi': 0.8583347209403667}-{'f1_val': 0.7663146205644704, 'auprc': 0.9752751095113219, 'loss_val': 0.5141545404961513, 'psi': 0.8498988161432111}
[S4] START round=61 head_norm_before_train=1.800207 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9397253403653629, 'auprc': 0.9625895650883972, 'loss_val': 0.30656047219700694, 'psi': 0.9488710302545766}-{'f1_val': 0.9403245131311283, 'auprc': 0.9633504679982463, 'loss_val': 0.3041346837771457, 'psi': 0.9495348950779755}
[S5] START round=61 head_norm_before_train=2.211997 (no previous merge yet)
[S5] round=61 local utility u=0.001159 metrics={'f1_val': 0.99736232676063, 'auprc': 0.999791548566737, 'loss_val': 0.015634131529293396, 'psi': 0.9983340154830729}-{'f1_val': 0.99736232676063, 'auprc': 0.9992474285772042, 'loss_val': 0.016320475481438324, 'psi': 0.9981163674872597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=61 head_norm_before_train=1.621611 cos_to_last_merge=1.0000 (last merge round=60)
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.8639460677914449, 'auprc': 0.9464979207320049, 'loss_val': 0.38688622833943637, 'psi': 0.896966808967669}-{'f1_val': 0.5992070778151588, 'auprc': 0.9063098934353276, 'loss_val': 0.8500057456573344, 'psi': 0.7220482040632263}
[S7] START round=61 head_norm_before_train=1.794420 cos_to_last_merge=1.0000 (last merge round=57)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5530864560335899, 'auprc': 0.7892928439285343, 'loss_val': 1.037971130308099, 'psi': 0.6475690111915676}-{'f1_val': 0.5844824175312259, 'auprc': 0.7936380608918158, 'loss_val': 0.667407716050754, 'psi': 0.6681446748754618}
[S8] START round=61 head_norm_before_train=2.327836 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9987402884129224, 'loss_val': 0.0288729464363441, 'psi': 0.9975619441290267}-{'f1_val': 0.996776381273096, 'auprc': 0.9987381189923685, 'loss_val': 0.026644954599232575, 'psi': 0.997561076360805}
[S9] START round=61 head_norm_before_train=2.289412 (no previous merge yet)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9937350633245463, 'auprc': 0.9999617321407837, 'loss_val': 0.023487760634203884, 'psi': 0.9962257308510412}-{'f1_val': 0.9966570119660778, 'auprc': 0.999933310908258, 'loss_val': 0.016297835574117556, 'psi': 0.9979675315429499}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.268830 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=61 local utility u=0.001206 metrics={'f1_val': 0.9944027235839877, 'auprc': 0.9956605293572456, 'loss_val': 0.02926219473061451, 'psi': 0.9949058458932909}-{'f1_val': 0.9946643883427498, 'auprc': 0.9941737780502098, 'loss_val': 0.02878488405767288, 'psi': 0.9944681442257337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=61 head_norm_before_train=1.727139 cos_to_last_merge=0.9999 (last merge round=58)
[S11] round=61 local utility u=0.345894 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976726470600829, 'loss_val': 0.03069888267990048, 'psi': 0.9966041615451815}-{'f1_val': 0.9159809269479152, 'auprc': 0.9977458041518072, 'loss_val': 0.24324014973739025, 'psi': 0.948686877829472}
[S13] START round=61 head_norm_before_train=1.836552 cos_to_last_merge=0.9999 (last merge round=57)
[S13] round=61 local utility u=0.261018 metrics={'f1_val': 0.6054208610488369, 'auprc': 0.7170735362692373, 'loss_val': 0.6584935758658453, 'psi': 0.650081931136997}-{'f1_val': 0.5824518670329689, 'auprc': 0.703021623522003, 'loss_val': 1.0005600517147042, 'psi': 0.6306797696285826}
[S13] not sending this round → trigger blocked (psi=0.650)
[S14] START round=61 head_norm_before_train=1.721553 cos_to_last_merge=1.0000 (last merge round=59)
[S14] round=61 local utility u=0.002654 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9990416801547459, 'loss_val': 0.02203704151683022, 'psi': 0.9979311450219908}-{'f1_val': 0.9968205796367875, 'auprc': 0.9985375481684104, 'loss_val': 0.023611235032057584, 'psi': 0.9975073670494367}
[S15] START round=61 head_norm_before_train=1.940165 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7746118545899764, 'auprc': 0.9894372763673488, 'loss_val': 0.3717986220117289, 'psi': 0.8605420233009253}-{'f1_val': 0.839214959637052, 'auprc': 0.9909951803867426, 'loss_val': 0.25063452544375037, 'psi': 0.8999270479369281}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.977664 cos_to_last_merge=0.9765 (last merge round=45)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9203759989421001, 'auprc': 0.9920422508061645, 'loss_val': 0.284005867833726, 'psi': 0.9490424996877258}-{'f1_val': 0.9931939889468008, 'auprc': 0.9932302466567349, 'loss_val': 0.0352433444391298, 'psi': 0.9932084920307744}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.621227 cos_to_last_merge=1.0000 (last merge round=59)
[S17] round=61 local utility u=0.182776 metrics={'f1_val': 0.8654212434314111, 'auprc': 0.9829021897922129, 'loss_val': 0.417236073531778, 'psi': 0.9124136219757318}-{'f1_val': 0.822271014560014, 'auprc': 0.9886202956025398, 'loss_val': 0.5410400243145651, 'psi': 0.8888107269770242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S3] not sending this round → trigger blocked (psi=0.858)
[S14] not sending this round → trigger blocked (psi=0.998)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=61 metric=0.7779 head_norm=2.342613
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.535126e-02
[S3] stored merged vector for next round verification (round=61)
[S3] DEBUG after merge:  round=61 metric=0.7779 head_norm=2.332448 delta_norm=0.025351
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=61 metric=0.9959 head_norm=1.735513
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.253465e-02
[S11] stored merged vector for next round verification (round=61)
[S11] DEBUG after merge:  round=61 metric=0.9959 head_norm=1.728502 delta_norm=0.012535
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1797) from S17
[S6] cosine check vs S17: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=61 metric=0.5531 head_norm=1.800546
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.015226e-02
[S7] stored merged vector for next round verification (round=61)
[S7] DEBUG after merge:  round=61 metric=0.5538 head_norm=1.805707 delta_norm=0.020152
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=61 metric=0.8654 head_norm=1.631059
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.244423e-02
[S17] stored merged vector for next round verification (round=61)
[S17] DEBUG after merge:  round=61 metric=0.8651 head_norm=1.633668 delta_norm=0.012444
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.815203 cos_to_last_merge=0.9997 (last merge round=58)
[S2] round=62 local utility u=0.034443 metrics={'f1_val': 0.8219053332611048, 'auprc': 0.9805323703345714, 'loss_val': 0.4282564075857986, 'psi': 0.8853561480904915}-{'f1_val': 0.8276742393524328, 'auprc': 0.9376366526542964, 'loss_val': 0.40306834406765973, 'psi': 0.8716592046731783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=62 head_norm_before_train=2.332448 cos_to_last_merge=1.0000 (last merge round=61)
[S3] round=62 local utility u=0.881873 metrics={'f1_val': 0.9866896277620247, 'auprc': 0.9989659853611106, 'loss_val': 0.03711926615227607, 'psi': 0.9916001708016591}-{'f1_val': 0.7779389893077442, 'auprc': 0.9789283183893005, 'loss_val': 0.4882478806554868, 'psi': 0.8583347209403667}
[S4] START round=62 head_norm_before_train=1.805788 cos_to_last_merge=1.0000 (last merge round=60)
[S4] round=62 local utility u=0.007009 metrics={'f1_val': 0.9410237743400767, 'auprc': 0.9640022930802231, 'loss_val': 0.3045714923301847, 'psi': 0.9502151818361353}-{'f1_val': 0.9397253403653629, 'auprc': 0.9625895650883972, 'loss_val': 0.30656047219700694, 'psi': 0.9488710302545766}
[S5] START round=62 head_norm_before_train=2.221881 (no previous merge yet)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9999699656061163, 'loss_val': 0.025396874140275597, 'psi': 0.9984499369540418}-{'f1_val': 0.99736232676063, 'auprc': 0.999791548566737, 'loss_val': 0.015634131529293396, 'psi': 0.9983340154830729}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=1.636367 cos_to_last_merge=1.0000 (last merge round=60)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.5838265830428018, 'auprc': 0.6833392017723909, 'loss_val': 1.1686971450675852, 'psi': 0.6236316305346374}-{'f1_val': 0.8639460677914449, 'auprc': 0.9464979207320049, 'loss_val': 0.38688622833943637, 'psi': 0.896966808967669}
[S7] START round=62 head_norm_before_train=1.805707 cos_to_last_merge=1.0000 (last merge round=61)
[S7] round=62 local utility u=0.180639 metrics={'f1_val': 0.5670800299123262, 'auprc': 0.7944063384235208, 'loss_val': 0.7759944005767545, 'psi': 0.6580105533168041}-{'f1_val': 0.5530864560335899, 'auprc': 0.7892928439285343, 'loss_val': 1.037971130308099, 'psi': 0.6475690111915676}
[S8] START round=62 head_norm_before_train=2.333001 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9988831663216889, 'loss_val': 0.03761759752242939, 'psi': 0.9976190952925332}-{'f1_val': 0.996776381273096, 'auprc': 0.9987402884129224, 'loss_val': 0.0288729464363441, 'psi': 0.9975619441290267}
[S9] START round=62 head_norm_before_train=2.294328 (no previous merge yet)
[S9] round=62 local utility u=0.012851 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99995480392563, 'loss_val': 0.015317789671752622, 'psi': 0.9979782286585869}-{'f1_val': 0.9937350633245463, 'auprc': 0.9999617321407837, 'loss_val': 0.023487760634203884, 'psi': 0.9962257308510412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=62 head_norm_before_train=2.273875 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=62 local utility u=0.000833 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9955330307744029, 'loss_val': 0.028529241981245092, 'psi': 0.9949864209221728}-{'f1_val': 0.9944027235839877, 'auprc': 0.9956605293572456, 'loss_val': 0.02926219473061451, 'psi': 0.9949058458932909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=62 head_norm_before_train=1.728502 cos_to_last_merge=1.0000 (last merge round=61)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9882559860400854, 'auprc': 0.996485906467405, 'loss_val': 0.05018709316638128, 'psi': 0.9915479542110132}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976726470600829, 'loss_val': 0.03069888267990048, 'psi': 0.9966041615451815}
[S13] START round=62 head_norm_before_train=1.842382 cos_to_last_merge=0.9998 (last merge round=57)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5451787325368581, 'auprc': 0.7300887083910993, 'loss_val': 1.124815831824826, 'psi': 0.6191427228785547}-{'f1_val': 0.6054208610488369, 'auprc': 0.7170735362692373, 'loss_val': 0.6584935758658453, 'psi': 0.650081931136997}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.726875 cos_to_last_merge=1.0000 (last merge round=59)
[S14] round=62 local utility u=0.000912 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.9988900225829951, 'loss_val': 0.02106700301375394, 'psi': 0.9980013511108698}-{'f1_val': 0.9971907882668205, 'auprc': 0.9990416801547459, 'loss_val': 0.02203704151683022, 'psi': 0.9979311450219908}
[S15] START round=62 head_norm_before_train=1.946800 cos_to_last_merge=0.9999 (last merge round=58)
[S15] round=62 local utility u=0.841973 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9912238285680289, 'loss_val': 0.02602040259639226, 'psi': 0.9945375324597239}-{'f1_val': 0.7746118545899764, 'auprc': 0.9894372763673488, 'loss_val': 0.3717986220117289, 'psi': 0.8605420233009253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=62 head_norm_before_train=1.986242 cos_to_last_merge=0.9758 (last merge round=45)
[S16] round=62 local utility u=0.331859 metrics={'f1_val': 0.9913460801466416, 'auprc': 0.9959502288201683, 'loss_val': 0.0578319006124118, 'psi': 0.9931877396160522}-{'f1_val': 0.9203759989421001, 'auprc': 0.9920422508061645, 'loss_val': 0.284005867833726, 'psi': 0.9490424996877258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=62 head_norm_before_train=1.633668 cos_to_last_merge=1.0000 (last merge round=61)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.5296129984757727, 'auprc': 0.7050923183912312, 'loss_val': 1.311264034562771, 'psi': 0.5998047264419561}-{'f1_val': 0.8654212434314111, 'auprc': 0.9829021897922129, 'loss_val': 0.417236073531778, 'psi': 0.9124136219757318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=62 metric=0.5838 head_norm=1.650827
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.022324e-02
[S6] stored merged vector for next round verification (round=62)
[S6] DEBUG after merge:  round=62 metric=0.5836 head_norm=1.640848 delta_norm=0.020223
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] cosine check vs S14: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=62 metric=0.9974 head_norm=1.732017
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.241294e-02
[S14] stored merged vector for next round verification (round=62)
[S14] DEBUG after merge:  round=62 metric=0.9974 head_norm=1.733721 delta_norm=0.012413
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=62 metric=0.9410 head_norm=1.813230
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.403692e-02
[S4] stored merged vector for next round verification (round=62)
[S4] DEBUG after merge:  round=62 metric=0.9409 head_norm=1.810873 delta_norm=0.014037
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=1.829828 cos_to_last_merge=0.9995 (last merge round=58)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.8186738978227259, 'auprc': 0.9843750306676495, 'loss_val': 0.43118753621764727, 'psi': 0.8849543509606954}-{'f1_val': 0.8219053332611048, 'auprc': 0.9805323703345714, 'loss_val': 0.4282564075857986, 'psi': 0.8853561480904915}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.340780 cos_to_last_merge=1.0000 (last merge round=61)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9994365363969084, 'loss_val': 0.12491233743243652, 'psi': 0.9761171989801388}-{'f1_val': 0.9866896277620247, 'auprc': 0.9989659853611106, 'loss_val': 0.03711926615227607, 'psi': 0.9916001708016591}
[S4] START round=63 head_norm_before_train=1.810873 cos_to_last_merge=1.0000 (last merge round=62)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9244115230401898, 'auprc': 0.9320553687166298, 'loss_val': 0.38108747076597926, 'psi': 0.9274690613107659}-{'f1_val': 0.9410237743400767, 'auprc': 0.9640022930802231, 'loss_val': 0.3045714923301847, 'psi': 0.9502151818361353}
[S5] START round=63 head_norm_before_train=2.233511 (no previous merge yet)
[S5] round=63 local utility u=0.002767 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9993816097096583, 'loss_val': 0.01589552179645501, 'psi': 0.9979943790505019}-{'f1_val': 0.9974365845193254, 'auprc': 0.9999699656061163, 'loss_val': 0.025396874140275597, 'psi': 0.9984499369540418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=63 head_norm_before_train=1.640848 cos_to_last_merge=1.0000 (last merge round=62)
[S6] round=63 local utility u=0.403006 metrics={'f1_val': 0.6002917811436024, 'auprc': 0.8497431122873965, 'loss_val': 0.9606873090171786, 'psi': 0.70007231360112}-{'f1_val': 0.5838265830428018, 'auprc': 0.6833392017723909, 'loss_val': 1.1686971450675852, 'psi': 0.6236316305346374}
[S7] START round=63 head_norm_before_train=1.808622 cos_to_last_merge=1.0000 (last merge round=61)
[S7] round=63 local utility u=0.142669 metrics={'f1_val': 0.5914694136840487, 'auprc': 0.7994188160492133, 'loss_val': 0.6520292097558115, 'psi': 0.6746491746301145}-{'f1_val': 0.5670800299123262, 'auprc': 0.7944063384235208, 'loss_val': 0.7759944005767545, 'psi': 0.6580105533168041}
[S8] START round=63 head_norm_before_train=2.335848 cos_to_last_merge=0.9999 (last merge round=60)
[S8] round=63 local utility u=0.001439 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9961071964907816, 'loss_val': 0.026411316441912507, 'psi': 0.9965087073601703}-{'f1_val': 0.996776381273096, 'auprc': 0.9988831663216889, 'loss_val': 0.03761759752242939, 'psi': 0.9976190952925332}
[S9] START round=63 head_norm_before_train=2.302456 (no previous merge yet)
[S9] round=63 local utility u=0.000973 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999952286744879, 'loss_val': 0.016018128744808673, 'psi': 0.9982426622052373}-{'f1_val': 0.9966605118138915, 'auprc': 0.99995480392563, 'loss_val': 0.015317789671752622, 'psi': 0.9979782286585869}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=63 head_norm_before_train=2.279845 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9938495056300684, 'loss_val': 0.02788584834386033, 'psi': 0.9946018830976863}-{'f1_val': 0.9946220143540194, 'auprc': 0.9955330307744029, 'loss_val': 0.028529241981245092, 'psi': 0.9949864209221728}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.737497 cos_to_last_merge=1.0000 (last merge round=61)
[S11] round=63 local utility u=0.030826 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962799883018688, 'loss_val': 0.03518310993709686, 'psi': 0.9961922002687331}-{'f1_val': 0.9882559860400854, 'auprc': 0.996485906467405, 'loss_val': 0.05018709316638128, 'psi': 0.9915479542110132}
[S13] START round=63 head_norm_before_train=1.847543 cos_to_last_merge=0.9997 (last merge round=57)
[S13] round=63 local utility u=0.066467 metrics={'f1_val': 0.5671748074206489, 'auprc': 0.7388804090791163, 'loss_val': 1.1502337653349082, 'psi': 0.6358570480840359}-{'f1_val': 0.5451787325368581, 'auprc': 0.7300887083910993, 'loss_val': 1.124815831824826, 'psi': 0.6191427228785547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=63 head_norm_before_train=1.733721 cos_to_last_merge=1.0000 (last merge round=62)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9967503466647865, 'auprc': 0.998531638921337, 'loss_val': 0.03333863196850025, 'psi': 0.9974628635674068}-{'f1_val': 0.9974089034627865, 'auprc': 0.9988900225829951, 'loss_val': 0.02106700301375394, 'psi': 0.9980013511108698}
[S15] START round=63 head_norm_before_train=1.952896 cos_to_last_merge=0.9999 (last merge round=58)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.7021146389164286, 'auprc': 0.9864809121553814, 'loss_val': 0.5052680802960751, 'psi': 0.8158611482120097}-{'f1_val': 0.9967466683875206, 'auprc': 0.9912238285680289, 'loss_val': 0.02602040259639226, 'psi': 0.9945375324597239}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.995579 cos_to_last_merge=0.9750 (last merge round=45)
[S16] round=63 local utility u=0.005428 metrics={'f1_val': 0.9919968967460852, 'auprc': 0.9918745310013797, 'loss_val': 0.03865386204494274, 'psi': 0.9919479504482029}-{'f1_val': 0.9913460801466416, 'auprc': 0.9959502288201683, 'loss_val': 0.0578319006124118, 'psi': 0.9931877396160522}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=63 head_norm_before_train=1.643080 cos_to_last_merge=1.0000 (last merge round=61)
[S17] round=63 local utility u=0.145507 metrics={'f1_val': 0.559826982853284, 'auprc': 0.7195694000591699, 'loss_val': 1.2449646122755593, 'psi': 0.6237239497356384}-{'f1_val': 0.5296129984757727, 'auprc': 0.7050923183912312, 'loss_val': 1.311264034562771, 'psi': 0.5998047264419561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.675)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=63 metric=0.5915 head_norm=1.813136
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.622096e-02
[S7] stored merged vector for next round verification (round=63)
[S7] DEBUG after merge:  round=63 metric=0.5914 head_norm=1.813110 delta_norm=0.016221
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9998
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=63 metric=0.5598 head_norm=1.652527
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.513656e-02
[S17] stored merged vector for next round verification (round=63)
[S17] DEBUG after merge:  round=63 metric=0.5584 head_norm=1.653736 delta_norm=0.015137
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=63 metric=0.9961 head_norm=1.745565
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.392508e-02
[S11] stored merged vector for next round verification (round=63)
[S11] DEBUG after merge:  round=63 metric=0.9961 head_norm=1.738748 delta_norm=0.013925
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=63 metric=0.6003 head_norm=1.655083
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.513656e-02
[S6] stored merged vector for next round verification (round=63)
[S6] DEBUG after merge:  round=63 metric=0.5998 head_norm=1.653736 delta_norm=0.015137
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9968 head_norm=2.340458
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.126369e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9968 head_norm=2.340522 delta_norm=0.021264
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.844292 cos_to_last_merge=0.9993 (last merge round=58)
[S2] round=64 local utility u=0.010649 metrics={'f1_val': 0.8276448775662563, 'auprc': 0.9669499890751198, 'loss_val': 0.4114399466130505, 'psi': 0.8833669221698017}-{'f1_val': 0.8186738978227259, 'auprc': 0.9843750306676495, 'loss_val': 0.43118753621764727, 'psi': 0.8849543509606954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=64 head_norm_before_train=2.348048 cos_to_last_merge=1.0000 (last merge round=61)
[S3] round=64 local utility u=0.146295 metrics={'f1_val': 0.993374929634006, 'auprc': 0.9989055982949827, 'loss_val': 0.027552710844455222, 'psi': 0.9955871970983967}-{'f1_val': 0.9605709740356257, 'auprc': 0.9994365363969084, 'loss_val': 0.12491233743243652, 'psi': 0.9761171989801388}
[S4] START round=64 head_norm_before_train=1.820301 cos_to_last_merge=1.0000 (last merge round=62)
[S4] round=64 local utility u=0.085034 metrics={'f1_val': 0.9390343031674775, 'auprc': 0.9419632009956329, 'loss_val': 0.3284804989996697, 'psi': 0.9402058622987397}-{'f1_val': 0.9244115230401898, 'auprc': 0.9320553687166298, 'loss_val': 0.38108747076597926, 'psi': 0.9274690613107659}
[S5] START round=64 head_norm_before_train=2.240713 (no previous merge yet)
[S5] round=64 local utility u=0.002018 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9999729948523512, 'loss_val': 0.015390249210658449, 'psi': 0.9984065939973186}-{'f1_val': 0.9970695586110643, 'auprc': 0.9993816097096583, 'loss_val': 0.01589552179645501, 'psi': 0.9979943790505019}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=64 head_norm_before_train=1.653736 cos_to_last_merge=1.0000 (last merge round=63)
[S6] round=64 local utility u=1.000000 metrics={'f1_val': 0.843195732983264, 'auprc': 0.9388203868287817, 'loss_val': 0.37345954300197504, 'psi': 0.8814455945214711}-{'f1_val': 0.6002917811436024, 'auprc': 0.8497431122873965, 'loss_val': 0.9606873090171786, 'psi': 0.70007231360112}
[S7] START round=64 head_norm_before_train=1.813110 cos_to_last_merge=1.0000 (last merge round=63)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.4999268496523701, 'auprc': 0.779137442082777, 'loss_val': 1.1043692274320482, 'psi': 0.6116110866245329}-{'f1_val': 0.5914694136840487, 'auprc': 0.7994188160492133, 'loss_val': 0.6520292097558115, 'psi': 0.6746491746301145}
[S8] START round=64 head_norm_before_train=2.340522 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9974405937436136, 'loss_val': 0.03373869999653059, 'psi': 0.9970420662613031}-{'f1_val': 0.996776381273096, 'auprc': 0.9961071964907816, 'loss_val': 0.026411316441912507, 'psi': 0.9965087073601703}
[S9] START round=64 head_norm_before_train=2.308491 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9933160988394184, 'auprc': 0.9999605779772184, 'loss_val': 0.024348613641624814, 'psi': 0.9959738904945383}-{'f1_val': 0.9971029125121428, 'auprc': 0.999952286744879, 'loss_val': 0.016018128744808673, 'psi': 0.9982426622052373}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.286421 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=64 local utility u=0.001196 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9949905830337843, 'loss_val': 0.027599278600203836, 'psi': 0.9949265676717505}-{'f1_val': 0.9951034680760983, 'auprc': 0.9938495056300684, 'loss_val': 0.02788584834386033, 'psi': 0.9946018830976863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=64 head_norm_before_train=1.738748 cos_to_last_merge=1.0000 (last merge round=63)
[S11] round=64 local utility u=0.002006 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9974577645275529, 'loss_val': 0.03325294885082001, 'psi': 0.9965182085321695}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962799883018688, 'loss_val': 0.03518310993709686, 'psi': 0.9961922002687331}
[S13] START round=64 head_norm_before_train=1.853991 cos_to_last_merge=0.9996 (last merge round=57)
[S13] round=64 local utility u=0.368697 metrics={'f1_val': 0.615990480791413, 'auprc': 0.7654494080831373, 'loss_val': 0.7854401187628208, 'psi': 0.6757740517081028}-{'f1_val': 0.5671748074206489, 'auprc': 0.7388804090791163, 'loss_val': 1.1502337653349082, 'psi': 0.6358570480840359}
[S13] not sending this round → trigger blocked (psi=0.676)
[S14] START round=64 head_norm_before_train=1.737536 cos_to_last_merge=1.0000 (last merge round=62)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.994934808751637, 'auprc': 0.9989628449490332, 'loss_val': 0.03321961890485721, 'psi': 0.9965460232305954}-{'f1_val': 0.9967503466647865, 'auprc': 0.998531638921337, 'loss_val': 0.03333863196850025, 'psi': 0.9974628635674068}
[S15] START round=64 head_norm_before_train=1.958978 cos_to_last_merge=0.9999 (last merge round=58)
[S15] round=64 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9967994209569109, 'loss_val': 0.027568721777177424, 'psi': 0.9965192148920489}-{'f1_val': 0.7021146389164286, 'auprc': 0.9864809121553814, 'loss_val': 0.5052680802960751, 'psi': 0.8158611482120097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=64 head_norm_before_train=2.004656 cos_to_last_merge=0.9742 (last merge round=45)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9917461459186849, 'auprc': 0.9854295734704341, 'loss_val': 0.05863801578019684, 'psi': 0.9892195169393847}-{'f1_val': 0.9919968967460852, 'auprc': 0.9918745310013797, 'loss_val': 0.03865386204494274, 'psi': 0.9919479504482029}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.653736 cos_to_last_merge=1.0000 (last merge round=63)
[S17] round=64 local utility u=0.856207 metrics={'f1_val': 0.6528527873306608, 'auprc': 0.954816298127396, 'loss_val': 0.7964458366996459, 'psi': 0.7736381916493549}-{'f1_val': 0.559826982853284, 'auprc': 0.7195694000591699, 'loss_val': 1.2449646122755593, 'psi': 0.6237239497356384}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.774)
[S6] not sending this round → trigger blocked (psi=0.881)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=64 metric=0.9949 head_norm=1.742915
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.072222e-02
[S14] stored merged vector for next round verification (round=64)
[S14] DEBUG after merge:  round=64 metric=0.9954 head_norm=1.744208 delta_norm=0.010722
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=0.9998
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=64 metric=0.9934 head_norm=2.355079
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.582353e-02
[S3] stored merged vector for next round verification (round=64)
[S3] DEBUG after merge:  round=64 metric=0.9934 head_norm=2.347638 delta_norm=0.025824
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=1.855327 cos_to_last_merge=0.9991 (last merge round=58)
[S2] round=65 local utility u=0.034622 metrics={'f1_val': 0.8268884456314025, 'auprc': 0.99143237643264, 'loss_val': 0.41110425969513764, 'psi': 0.8927060179518975}-{'f1_val': 0.8276448775662563, 'auprc': 0.9669499890751198, 'loss_val': 0.4114399466130505, 'psi': 0.8833669221698017}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=65 head_norm_before_train=2.347638 cos_to_last_merge=1.0000 (last merge round=64)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9364609872084471, 'auprc': 0.9952880335642402, 'loss_val': 0.15499297575692328, 'psi': 0.9599918057507644}-{'f1_val': 0.993374929634006, 'auprc': 0.9989055982949827, 'loss_val': 0.027552710844455222, 'psi': 0.9955871970983967}
[S4] START round=65 head_norm_before_train=1.829779 cos_to_last_merge=0.9999 (last merge round=62)
[S4] round=65 local utility u=0.079332 metrics={'f1_val': 0.942726401465404, 'auprc': 0.9769903793124334, 'loss_val': 0.29705013570551153, 'psi': 0.9564319926042157}-{'f1_val': 0.9390343031674775, 'auprc': 0.9419632009956329, 'loss_val': 0.3284804989996697, 'psi': 0.9402058622987397}
[S5] START round=65 head_norm_before_train=2.241581 (no previous merge yet)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9972491319074236, 'loss_val': 0.015265007870137723, 'psi': 0.9973170488193475}-{'f1_val': 0.99736232676063, 'auprc': 0.9999729948523512, 'loss_val': 0.015390249210658449, 'psi': 0.9984065939973186}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.667319 cos_to_last_merge=1.0000 (last merge round=63)
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.6066003137441754, 'auprc': 0.8620597966830915, 'loss_val': 0.9018511760605037, 'psi': 0.7087841069197419}-{'f1_val': 0.843195732983264, 'auprc': 0.9388203868287817, 'loss_val': 0.37345954300197504, 'psi': 0.8814455945214711}
[S7] START round=65 head_norm_before_train=1.821023 cos_to_last_merge=0.9999 (last merge round=63)
[S7] round=65 local utility u=0.061619 metrics={'f1_val': 0.536092220223488, 'auprc': 0.7790314649190947, 'loss_val': 1.1978045706600753, 'psi': 0.6332679181017307}-{'f1_val': 0.4999268496523701, 'auprc': 0.779137442082777, 'loss_val': 1.1043692274320482, 'psi': 0.6116110866245329}
[S8] START round=65 head_norm_before_train=2.345392 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.003512 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9975984940775805, 'loss_val': 0.029808305708229437, 'psi': 0.9973671737087363}-{'f1_val': 0.996776381273096, 'auprc': 0.9974405937436136, 'loss_val': 0.03373869999653059, 'psi': 0.9970420662613031}
[S9] START round=65 head_norm_before_train=2.312896 (no previous merge yet)
[S9] round=65 local utility u=0.013848 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9999337662130872, 'loss_val': 0.016618561292694494, 'psi': 0.9979677136648816}-{'f1_val': 0.9933160988394184, 'auprc': 0.9999605779772184, 'loss_val': 0.024348613641624814, 'psi': 0.9959738904945383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=65 head_norm_before_train=2.288411 cos_to_last_merge=0.9998 (last merge round=58)
[S10] round=65 local utility u=0.001068 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.995643076623244, 'loss_val': 0.02742130814190677, 'psi': 0.9951875651075344}-{'f1_val': 0.9948838907637279, 'auprc': 0.9949905830337843, 'loss_val': 0.027599278600203836, 'psi': 0.9949265676717505}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=65 head_norm_before_train=1.747932 cos_to_last_merge=1.0000 (last merge round=63)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9781663110885405, 'auprc': 0.9964870709290153, 'loss_val': 0.09068351976985722, 'psi': 0.9854946150247303}-{'f1_val': 0.9958918378685807, 'auprc': 0.9974577645275529, 'loss_val': 0.03325294885082001, 'psi': 0.9965182085321695}
[S13] START round=65 head_norm_before_train=1.857227 cos_to_last_merge=0.9995 (last merge round=57)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.5426732524403517, 'auprc': 0.7382617140308941, 'loss_val': 1.10879714471827, 'psi': 0.6209086370765686}-{'f1_val': 0.615990480791413, 'auprc': 0.7654494080831373, 'loss_val': 0.7854401187628208, 'psi': 0.6757740517081028}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.744208 cos_to_last_merge=1.0000 (last merge round=64)
[S14] round=65 local utility u=0.011575 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9984812025473433, 'loss_val': 0.02215960290848639, 'psi': 0.9977069539790296}-{'f1_val': 0.994934808751637, 'auprc': 0.9989628449490332, 'loss_val': 0.03321961890485721, 'psi': 0.9965460232305954}
[S15] START round=65 head_norm_before_train=1.966185 cos_to_last_merge=0.9998 (last merge round=58)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9955969637809678, 'loss_val': 0.028502973135658555, 'psi': 0.995805958397487}-{'f1_val': 0.9963324108488076, 'auprc': 0.9967994209569109, 'loss_val': 0.027568721777177424, 'psi': 0.9965192148920489}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.011174 cos_to_last_merge=0.9735 (last merge round=45)
[S16] round=65 local utility u=0.020790 metrics={'f1_val': 0.9925156894843106, 'auprc': 0.9908633400576938, 'loss_val': 0.037977373062673604, 'psi': 0.9918547497136638}-{'f1_val': 0.9917461459186849, 'auprc': 0.9854295734704341, 'loss_val': 0.05863801578019684, 'psi': 0.9892195169393847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=65 head_norm_before_train=1.662419 cos_to_last_merge=1.0000 (last merge round=63)
[S17] round=65 local utility u=1.000000 metrics={'f1_val': 0.9107912715935967, 'auprc': 0.9877331434915135, 'loss_val': 0.41378692863342775, 'psi': 0.9415680203527634}-{'f1_val': 0.6528527873306608, 'auprc': 0.954816298127396, 'loss_val': 0.7964458366996459, 'psi': 0.7736381916493549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:41907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[S4] not sending this round → trigger blocked (psi=0.956)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] ⇄ pheromone p=0.057 → S7@127.0.0.1:41908
[S17] sending update (kind=head size=1799 to 1 peers)
[S11] ⇄ pheromone p=0.033 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.166 → S8@127.0.0.1:41909
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9996
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.9999
[S17] ⇄ pheromone p=0.492 → S6@127.0.0.1:41907
[S14] ⇄ pheromone p=0.006 → S11@127.0.0.1:41912
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=65 metric=0.9972 head_norm=2.351262
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.565259e-02
[S8] stored merged vector for next round verification (round=65)
[S8] DEBUG after merge:  round=65 metric=0.9972 head_norm=2.353031 delta_norm=0.025653
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.002 → S3@127.0.0.1:41903
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=65 metric=0.5361 head_norm=1.826974
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.280257e-02
[S7] stored merged vector for next round verification (round=65)
[S7] DEBUG after merge:  round=65 metric=0.5358 head_norm=1.828235 delta_norm=0.022803
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.100 → S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=65 metric=0.6066 head_norm=1.678724
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.933552e-02
[S6] stored merged vector for next round verification (round=65)
[S6] DEBUG after merge:  round=65 metric=0.6069 head_norm=1.674615 delta_norm=0.019336
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.377 → S17@127.0.0.1:41917
[S2] START round=66 head_norm_before_train=1.868158 cos_to_last_merge=0.9988 (last merge round=58)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.7798510009383266, 'auprc': 0.9933529983779585, 'loss_val': 0.4377914301782411, 'psi': 0.8652517999141793}-{'f1_val': 0.8268884456314025, 'auprc': 0.99143237643264, 'loss_val': 0.41110425969513764, 'psi': 0.8927060179518975}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.356328 cos_to_last_merge=1.0000 (last merge round=64)
[S3] round=66 local utility u=0.257182 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9993951187541488, 'loss_val': 0.016279533081462228, 'psi': 0.9979675304575318}-{'f1_val': 0.9364609872084471, 'auprc': 0.9952880335642402, 'loss_val': 0.15499297575692328, 'psi': 0.9599918057507644}
[S4] START round=66 head_norm_before_train=1.831702 cos_to_last_merge=0.9999 (last merge round=62)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.8643546011638179, 'auprc': 0.9389243111082749, 'loss_val': 0.4266772884603098, 'psi': 0.8941824851416007}-{'f1_val': 0.942726401465404, 'auprc': 0.9769903793124334, 'loss_val': 0.29705013570551153, 'psi': 0.9564319926042157}
[S5] START round=66 head_norm_before_train=2.247297 (no previous merge yet)
[S5] round=66 local utility u=0.001237 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9978766447726266, 'loss_val': 0.014674169928796294, 'psi': 0.9975680539654287}-{'f1_val': 0.99736232676063, 'auprc': 0.9972491319074236, 'loss_val': 0.015265007870137723, 'psi': 0.9973170488193475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=66 head_norm_before_train=1.674615 cos_to_last_merge=1.0000 (last merge round=65)
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.895302173653427, 'auprc': 0.9553940490994598, 'loss_val': 0.28633192650989364, 'psi': 0.9193389238318401}-{'f1_val': 0.6066003137441754, 'auprc': 0.8620597966830915, 'loss_val': 0.9018511760605037, 'psi': 0.7087841069197419}
[S7] START round=66 head_norm_before_train=1.828235 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=66 local utility u=0.012024 metrics={'f1_val': 0.5198493418969418, 'auprc': 0.7787565108131964, 'loss_val': 1.07547430694403, 'psi': 0.6234122094634437}-{'f1_val': 0.536092220223488, 'auprc': 0.7790314649190947, 'loss_val': 1.1978045706600753, 'psi': 0.6332679181017307}
[S8] START round=66 head_norm_before_train=2.353031 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=66 local utility u=0.000114 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9979716569478543, 'loss_val': 0.029798011566562782, 'psi': 0.9974263272957511}-{'f1_val': 0.9972129601295068, 'auprc': 0.9975984940775805, 'loss_val': 0.029808305708229437, 'psi': 0.9973671737087363}
[S9] START round=66 head_norm_before_train=2.320553 (no previous merge yet)
[S9] round=66 local utility u=0.000057 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999905961076616, 'loss_val': 0.01644244840784764, 'psi': 0.9979586915189813}-{'f1_val': 0.9966570119660778, 'auprc': 0.9999337662130872, 'loss_val': 0.016618561292694494, 'psi': 0.9979677136648816}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=66 head_norm_before_train=2.290858 cos_to_last_merge=0.9997 (last merge round=58)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9942388143354506, 'loss_val': 0.027413263623347724, 'psi': 0.9948893980724185}-{'f1_val': 0.9948838907637279, 'auprc': 0.995643076623244, 'loss_val': 0.02742130814190677, 'psi': 0.9951875651075344}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.757446 cos_to_last_merge=1.0000 (last merge round=63)
[S11] round=66 local utility u=0.087946 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978980357330869, 'loss_val': 0.026828096567463527, 'psi': 0.9968394192412203}-{'f1_val': 0.9781663110885405, 'auprc': 0.9964870709290153, 'loss_val': 0.09068351976985722, 'psi': 0.9854946150247303}
[S13] START round=66 head_norm_before_train=1.861566 cos_to_last_merge=0.9992 (last merge round=57)
[S13] round=66 local utility u=0.115181 metrics={'f1_val': 0.578384106499379, 'auprc': 0.7541128250052813, 'loss_val': 1.1402545098773724, 'psi': 0.6486755939017399}-{'f1_val': 0.5426732524403517, 'auprc': 0.7382617140308941, 'loss_val': 1.10879714471827, 'psi': 0.6209086370765686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=66 head_norm_before_train=1.750875 cos_to_last_merge=1.0000 (last merge round=64)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9986079110954116, 'loss_val': 0.022596481297683463, 'psi': 0.9976240906126312}-{'f1_val': 0.9971907882668205, 'auprc': 0.9984812025473433, 'loss_val': 0.02215960290848639, 'psi': 0.9977069539790296}
[S15] START round=66 head_norm_before_train=1.972933 cos_to_last_merge=0.9998 (last merge round=58)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9519589642606703, 'auprc': 0.9885573608559032, 'loss_val': 0.08265001533787945, 'psi': 0.9665983228987634}-{'f1_val': 0.9959452881418331, 'auprc': 0.9955969637809678, 'loss_val': 0.028502973135658555, 'psi': 0.995805958397487}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=2.017313 cos_to_last_merge=0.9729 (last merge round=45)
[S16] round=66 local utility u=0.000796 metrics={'f1_val': 0.9920765915392878, 'auprc': 0.9922132921761073, 'loss_val': 0.037801102636730276, 'psi': 0.9921312717940156}-{'f1_val': 0.9925156894843106, 'auprc': 0.9908633400576938, 'loss_val': 0.037977373062673604, 'psi': 0.9918547497136638}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=66 head_norm_before_train=1.670719 cos_to_last_merge=0.9999 (last merge round=63)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6966449706671441, 'auprc': 0.9343719882038923, 'loss_val': 0.7182265906130273, 'psi': 0.7917357776818434}-{'f1_val': 0.9107912715935967, 'auprc': 0.9877331434915135, 'loss_val': 0.41378692863342775, 'psi': 0.9415680203527634}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S7] not sending this round → trigger blocked (psi=0.623)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:41909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S3] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=66 metric=0.8644 head_norm=1.832038
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.647740e-02
[S4] stored merged vector for next round verification (round=66)
[S4] DEBUG after merge:  round=66 metric=0.8611 head_norm=1.829316 delta_norm=0.026477
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] cosine check vs S3: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=66 metric=0.9970 head_norm=2.364822
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.017532e-02
[S3] stored merged vector for next round verification (round=66)
[S3] DEBUG after merge:  round=66 metric=0.9970 head_norm=2.357965 delta_norm=0.020175
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=66 metric=0.9961 head_norm=1.766134
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.135455e-02
[S11] stored merged vector for next round verification (round=66)
[S11] DEBUG after merge:  round=66 metric=0.9961 head_norm=1.758484 delta_norm=0.011355
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=67 head_norm_before_train=1.881091 cos_to_last_merge=0.9985 (last merge round=58)
[S2] round=67 local utility u=0.145898 metrics={'f1_val': 0.8270806092238246, 'auprc': 0.9927808625582839, 'loss_val': 0.4276560044831974, 'psi': 0.8933607105576084}-{'f1_val': 0.7798510009383266, 'auprc': 0.9933529983779585, 'loss_val': 0.4377914301782411, 'psi': 0.8652517999141793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=67 head_norm_before_train=2.357965 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.6466843058961924, 'auprc': 0.9396727372794387, 'loss_val': 0.8778941376934964, 'psi': 0.763879678449491}-{'f1_val': 0.9970158049264538, 'auprc': 0.9993951187541488, 'loss_val': 0.016279533081462228, 'psi': 0.9979675304575318}
[S4] START round=67 head_norm_before_train=1.829316 cos_to_last_merge=1.0000 (last merge round=66)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.7505235613136132, 'auprc': 0.9224045003855522, 'loss_val': 0.5309964407692246, 'psi': 0.8192759369423888}-{'f1_val': 0.8643546011638179, 'auprc': 0.9389243111082749, 'loss_val': 0.4266772884603098, 'psi': 0.8941824851416007}
[S5] START round=67 head_norm_before_train=2.254146 (no previous merge yet)
[S5] round=67 local utility u=0.003666 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9999813972950734, 'loss_val': 0.015857824139090065, 'psi': 0.9986301705193641}-{'f1_val': 0.99736232676063, 'auprc': 0.9978766447726266, 'loss_val': 0.014674169928796294, 'psi': 0.9975680539654287}
[S5] not sending this round → trigger blocked (psi=0.999)
[S6] START round=67 head_norm_before_train=1.688049 cos_to_last_merge=1.0000 (last merge round=65)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.778817415229509, 'auprc': 0.929261817666289, 'loss_val': 0.6120561708908481, 'psi': 0.8389951762042209}-{'f1_val': 0.895302173653427, 'auprc': 0.9553940490994598, 'loss_val': 0.28633192650989364, 'psi': 0.9193389238318401}
[S7] START round=67 head_norm_before_train=1.831386 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=67 local utility u=0.140585 metrics={'f1_val': 0.5435250585954957, 'auprc': 0.7829710065833991, 'loss_val': 0.9490023631177537, 'psi': 0.639303437790657}-{'f1_val': 0.5198493418969418, 'auprc': 0.7787565108131964, 'loss_val': 1.07547430694403, 'psi': 0.6234122094634437}
[S8] START round=67 head_norm_before_train=2.357660 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9984830532009246, 'loss_val': 0.040453290474250246, 'psi': 0.9976308857969791}-{'f1_val': 0.997062774194349, 'auprc': 0.9979716569478543, 'loss_val': 0.029798011566562782, 'psi': 0.9974263272957511}
[S9] START round=67 head_norm_before_train=2.326426 (no previous merge yet)
[S9] round=67 local utility u=0.000217 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999507087570224, 'loss_val': 0.016143219749566434, 'psi': 0.9979765905911439}-{'f1_val': 0.9966605118138915, 'auprc': 0.999905961076616, 'loss_val': 0.01644244840784764, 'psi': 0.9979586915189813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=67 head_norm_before_train=2.295141 cos_to_last_merge=0.9996 (last merge round=58)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9946320050853124, 'loss_val': 0.02729233858367216, 'psi': 0.9949148828797839}-{'f1_val': 0.9953231205637304, 'auprc': 0.9942388143354506, 'loss_val': 0.027413263623347724, 'psi': 0.9948893980724185}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=1.758484 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=67 local utility u=0.000006 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977602078230404, 'loss_val': 0.0264032242103023, 'psi': 0.9967842880772018}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978980357330869, 'loss_val': 0.026828096567463527, 'psi': 0.9968394192412203}
[S13] START round=67 head_norm_before_train=1.865731 cos_to_last_merge=0.9990 (last merge round=57)
[S13] round=67 local utility u=0.263038 metrics={'f1_val': 0.6236317045823523, 'auprc': 0.7625737661051064, 'loss_val': 0.9110476135536648, 'psi': 0.6792085291914539}-{'f1_val': 0.578384106499379, 'auprc': 0.7541128250052813, 'loss_val': 1.1402545098773724, 'psi': 0.6486755939017399}
[S13] not sending this round → trigger blocked (psi=0.679)
[S14] START round=67 head_norm_before_train=1.758253 cos_to_last_merge=1.0000 (last merge round=64)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9308147189180822, 'auprc': 0.9971852944004109, 'loss_val': 0.1378903456111587, 'psi': 0.9573629491110136}-{'f1_val': 0.9969682102907778, 'auprc': 0.9986079110954116, 'loss_val': 0.022596481297683463, 'psi': 0.9976240906126312}
[S15] START round=67 head_norm_before_train=1.979179 cos_to_last_merge=0.9997 (last merge round=58)
[S15] round=67 local utility u=0.177022 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974405424766881, 'loss_val': 0.02398103962522375, 'psi': 0.9970242180231876}-{'f1_val': 0.9519589642606703, 'auprc': 0.9885573608559032, 'loss_val': 0.08265001533787945, 'psi': 0.9665983228987634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=67 head_norm_before_train=2.023998 cos_to_last_merge=0.9722 (last merge round=45)
[S16] round=67 local utility u=0.000224 metrics={'f1_val': 0.9918526547914823, 'auprc': 0.9925749980186463, 'loss_val': 0.037095222545778114, 'psi': 0.992141592082348}-{'f1_val': 0.9920765915392878, 'auprc': 0.9922132921761073, 'loss_val': 0.037801102636730276, 'psi': 0.9921312717940156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=67 head_norm_before_train=1.680907 cos_to_last_merge=0.9999 (last merge round=63)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.4621573574150535, 'auprc': 0.6074270683417535, 'loss_val': 1.492443964230215, 'psi': 0.5202652417857335}-{'f1_val': 0.6966449706671441, 'auprc': 0.9343719882038923, 'loss_val': 0.7182265906130273, 'psi': 0.7917357776818434}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=67 metric=0.4622 head_norm=1.691714
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.154025e-02
[S17] stored merged vector for next round verification (round=67)
[S17] DEBUG after merge:  round=67 metric=0.4605 head_norm=1.689745 delta_norm=0.021540
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=67 metric=0.9308 head_norm=1.763577
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.084372e-02
[S14] stored merged vector for next round verification (round=67)
[S14] DEBUG after merge:  round=67 metric=0.9308 head_norm=1.764822 delta_norm=0.010844
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=67 metric=0.9971 head_norm=2.361649
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.847684e-02
[S8] stored merged vector for next round verification (round=67)
[S8] DEBUG after merge:  round=67 metric=0.9971 head_norm=2.363164 delta_norm=0.018477
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=1.892395 cos_to_last_merge=0.9982 (last merge round=58)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.8276742393524328, 'auprc': 0.9691520038376076, 'loss_val': 0.42195771994883813, 'psi': 0.8842653451465028}-{'f1_val': 0.8270806092238246, 'auprc': 0.9927808625582839, 'loss_val': 0.4276560044831974, 'psi': 0.8933607105576084}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.364123 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=68 local utility u=1.000000 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9986734675655136, 'loss_val': 0.08544328756346725, 'psi': 0.9759139808734216}-{'f1_val': 0.6466843058961924, 'auprc': 0.9396727372794387, 'loss_val': 0.8778941376934964, 'psi': 0.763879678449491}
[S4] START round=68 head_norm_before_train=1.832863 cos_to_last_merge=1.0000 (last merge round=66)
[S4] round=68 local utility u=0.771301 metrics={'f1_val': 0.9427660614265553, 'auprc': 0.9744265182450882, 'loss_val': 0.2979157894346, 'psi': 0.9554302441539684}-{'f1_val': 0.7505235613136132, 'auprc': 0.9224045003855522, 'loss_val': 0.5309964407692246, 'psi': 0.8192759369423888}
[S5] START round=68 head_norm_before_train=2.258638 (no previous merge yet)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9999802892569216, 'loss_val': 0.019166279136671866, 'psi': 0.998454066414364}-{'f1_val': 0.9977293526688911, 'auprc': 0.9999813972950734, 'loss_val': 0.015857824139090065, 'psi': 0.9986301705193641}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.703429 cos_to_last_merge=0.9999 (last merge round=65)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7391076658956672, 'auprc': 0.8992692548375454, 'loss_val': 0.7023938764203349, 'psi': 0.8031723014724185}-{'f1_val': 0.778817415229509, 'auprc': 0.929261817666289, 'loss_val': 0.6120561708908481, 'psi': 0.8389951762042209}
[S7] START round=68 head_norm_before_train=1.835186 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=68 local utility u=0.085288 metrics={'f1_val': 0.557455995114206, 'auprc': 0.7870972818380144, 'loss_val': 0.8743915025835391, 'psi': 0.6493125098037293}-{'f1_val': 0.5435250585954957, 'auprc': 0.7829710065833991, 'loss_val': 0.9490023631177537, 'psi': 0.639303437790657}
[S8] START round=68 head_norm_before_train=2.363164 cos_to_last_merge=1.0000 (last merge round=67)
[S8] round=68 local utility u=0.008213 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9976379685878605, 'loss_val': 0.022393010298382095, 'psi': 0.9973829635128483}-{'f1_val': 0.997062774194349, 'auprc': 0.9984830532009246, 'loss_val': 0.040453290474250246, 'psi': 0.9976308857969791}
[S9] START round=68 head_norm_before_train=2.329102 (no previous merge yet)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9999719716046295, 'loss_val': 0.02140822520363982, 'psi': 0.996602782159542}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999507087570224, 'loss_val': 0.016143219749566434, 'psi': 0.9979765905911439}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.300429 cos_to_last_merge=0.9996 (last merge round=58)
[S10] round=68 local utility u=0.001428 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9959762951682278, 'loss_val': 0.02715101205485298, 'psi': 0.9953208525255279}-{'f1_val': 0.9951034680760983, 'auprc': 0.9946320050853124, 'loss_val': 0.02729233858367216, 'psi': 0.9949148828797839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=68 head_norm_before_train=1.766953 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.831566259288687, 'auprc': 0.9975792913916668, 'loss_val': 0.6871234731607415, 'psi': 0.8979714721298789}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977602078230404, 'loss_val': 0.0264032242103023, 'psi': 0.9967842880772018}
[S13] START round=68 head_norm_before_train=1.871413 cos_to_last_merge=0.9987 (last merge round=57)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.629232564887061, 'auprc': 0.7504358031338806, 'loss_val': 0.9788597055854914, 'psi': 0.6777138601857888}-{'f1_val': 0.6236317045823523, 'auprc': 0.7625737661051064, 'loss_val': 0.9110476135536648, 'psi': 0.6792085291914539}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.764822 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=68 local utility u=0.258383 metrics={'f1_val': 0.9976724637413676, 'auprc': 0.998582616843823, 'loss_val': 0.02646237070724625, 'psi': 0.9980365249823497}-{'f1_val': 0.9308147189180822, 'auprc': 0.9971852944004109, 'loss_val': 0.1378903456111587, 'psi': 0.9573629491110136}
[S15] START round=68 head_norm_before_train=1.984640 cos_to_last_merge=0.9997 (last merge round=58)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.7006752939685119, 'auprc': 0.8242788946641395, 'loss_val': 0.6374174111999914, 'psi': 0.750116734246763}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974405424766881, 'loss_val': 0.02398103962522375, 'psi': 0.9970242180231876}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.031661 cos_to_last_merge=0.9716 (last merge round=45)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.992076010978661, 'auprc': 0.990460742031122, 'loss_val': 0.04882376489395996, 'psi': 0.9914299033996454}-{'f1_val': 0.9918526547914823, 'auprc': 0.9925749980186463, 'loss_val': 0.037095222545778114, 'psi': 0.992141592082348}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=1.689745 cos_to_last_merge=1.0000 (last merge round=67)
[S17] round=68 local utility u=1.000000 metrics={'f1_val': 0.8987231482389901, 'auprc': 0.9856910004662527, 'loss_val': 0.37079052246593536, 'psi': 0.9335102891298952}-{'f1_val': 0.4621573574150535, 'auprc': 0.6074270683417535, 'loss_val': 1.492443964230215, 'psi': 0.5202652417857335}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[S7] not sending this round → trigger blocked (psi=0.649)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:41912
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=0.9999
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=68 metric=0.9428 head_norm=1.836282
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.651930e-02
[S4] stored merged vector for next round verification (round=68)
[S4] DEBUG after merge:  round=68 metric=0.9428 head_norm=1.835659 delta_norm=0.016519
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=68 metric=0.9972 head_norm=2.368544
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.380708e-02
[S8] stored merged vector for next round verification (round=68)
[S8] DEBUG after merge:  round=68 metric=0.9972 head_norm=2.369713 delta_norm=0.013807
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=1.901677 cos_to_last_merge=0.9980 (last merge round=58)
[S2] round=69 local utility u=0.018431 metrics={'f1_val': 0.8223251550630377, 'auprc': 0.9932631273983015, 'loss_val': 0.42533471529811634, 'psi': 0.8907003439971433}-{'f1_val': 0.8276742393524328, 'auprc': 0.9691520038376076, 'loss_val': 0.42195771994883813, 'psi': 0.8842653451465028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=69 head_norm_before_train=2.370961 cos_to_last_merge=1.0000 (last merge round=66)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9472429635684626, 'auprc': 0.9961784002380242, 'loss_val': 0.12586889617085356, 'psi': 0.9668171382362872}-{'f1_val': 0.9607409897453603, 'auprc': 0.9986734675655136, 'loss_val': 0.08544328756346725, 'psi': 0.9759139808734216}
[S4] START round=69 head_norm_before_train=1.835659 cos_to_last_merge=1.0000 (last merge round=68)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9403139626025744, 'auprc': 0.9748383939802991, 'loss_val': 0.3013135537935125, 'psi': 0.9541237351536642}-{'f1_val': 0.9427660614265553, 'auprc': 0.9744265182450882, 'loss_val': 0.2979157894346, 'psi': 0.9554302441539684}
[S5] START round=69 head_norm_before_train=2.259498 (no previous merge yet)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9962144145252742, 'loss_val': 0.02441862253656852, 'psi': 0.9965069468971843}-{'f1_val': 0.9974365845193254, 'auprc': 0.9999802892569216, 'loss_val': 0.019166279136671866, 'psi': 0.998454066414364}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.717419 cos_to_last_merge=0.9998 (last merge round=65)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.6268284140706022, 'auprc': 0.8676899224405525, 'loss_val': 0.8898347011551818, 'psi': 0.7231730174185824}-{'f1_val': 0.7391076658956672, 'auprc': 0.8992692548375454, 'loss_val': 0.7023938764203349, 'psi': 0.8031723014724185}
[S7] START round=69 head_norm_before_train=1.840818 cos_to_last_merge=0.9999 (last merge round=65)
[S7] round=69 local utility u=0.205477 metrics={'f1_val': 0.585470275476198, 'auprc': 0.7990724574758785, 'loss_val': 0.6674482593890282, 'psi': 0.6709111482760702}-{'f1_val': 0.557455995114206, 'auprc': 0.7870972818380144, 'loss_val': 0.8743915025835391, 'psi': 0.6493125098037293}
[S8] START round=69 head_norm_before_train=2.369713 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9983640156405738, 'loss_val': 0.03707116961853455, 'psi': 0.9974114350200871}-{'f1_val': 0.9972129601295068, 'auprc': 0.9976379685878605, 'loss_val': 0.022393010298382095, 'psi': 0.9973829635128483}
[S9] START round=69 head_norm_before_train=2.325985 (no previous merge yet)
[S9] round=69 local utility u=0.004926 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9971868046715704, 'loss_val': 0.017216651918837204, 'psi': 0.9968902166274854}-{'f1_val': 0.994356655862817, 'auprc': 0.9999719716046295, 'loss_val': 0.02140822520363982, 'psi': 0.996602782159542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=69 head_norm_before_train=2.306263 cos_to_last_merge=0.9995 (last merge round=58)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961583560294697, 'loss_val': 0.027114352030218083, 'psi': 0.9952619754174377}-{'f1_val': 0.9948838907637279, 'auprc': 0.9959762951682278, 'loss_val': 0.02715101205485298, 'psi': 0.9953208525255279}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.775204 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=69 local utility u=0.824806 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978860216864975, 'loss_val': 0.02686604497418547, 'psi': 0.9969375091559156}-{'f1_val': 0.831566259288687, 'auprc': 0.9975792913916668, 'loss_val': 0.6871234731607415, 'psi': 0.8979714721298789}
[S13] START round=69 head_norm_before_train=1.878394 cos_to_last_merge=0.9985 (last merge round=57)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.5724503854596122, 'auprc': 0.7413268690777218, 'loss_val': 1.3972758128236462, 'psi': 0.640000978906856}-{'f1_val': 0.629232564887061, 'auprc': 0.7504358031338806, 'loss_val': 0.9788597055854914, 'psi': 0.6777138601857888}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=1.768418 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9890186554483399, 'auprc': 0.9990274200102693, 'loss_val': 0.03851667228485745, 'psi': 0.9930221612731117}-{'f1_val': 0.9976724637413676, 'auprc': 0.998582616843823, 'loss_val': 0.02646237070724625, 'psi': 0.9980365249823497}
[S15] START round=69 head_norm_before_train=1.989904 cos_to_last_merge=0.9996 (last merge round=58)
[S15] round=69 local utility u=1.000000 metrics={'f1_val': 0.9780551467721815, 'auprc': 0.9945912948855368, 'loss_val': 0.05146393508352478, 'psi': 0.9846696060175236}-{'f1_val': 0.7006752939685119, 'auprc': 0.8242788946641395, 'loss_val': 0.6374174111999914, 'psi': 0.750116734246763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=69 head_norm_before_train=2.039299 cos_to_last_merge=0.9709 (last merge round=45)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.946329317690278, 'auprc': 0.9895095087761485, 'loss_val': 0.14428381397238335, 'psi': 0.9636013941246262}-{'f1_val': 0.992076010978661, 'auprc': 0.990460742031122, 'loss_val': 0.04882376489395996, 'psi': 0.9914299033996454}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.698882 cos_to_last_merge=1.0000 (last merge round=67)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7906558785425652, 'auprc': 0.9904586497592772, 'loss_val': 0.5885629289835658, 'psi': 0.87057698702925}-{'f1_val': 0.8987231482389901, 'auprc': 0.9856910004662527, 'loss_val': 0.37079052246593536, 'psi': 0.9335102891298952}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=69 metric=0.9472 head_norm=2.378012
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.670812e-02
[S3] stored merged vector for next round verification (round=69)
[S3] DEBUG after merge:  round=69 metric=0.9472 head_norm=2.373224 delta_norm=0.016708
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=69 metric=0.6268 head_norm=1.731547
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.222042e-02
[S6] stored merged vector for next round verification (round=69)
[S6] DEBUG after merge:  round=69 metric=0.6264 head_norm=1.714989 delta_norm=0.032220
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=69 metric=0.9963 head_norm=1.781840
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.304014e-02
[S11] stored merged vector for next round verification (round=69)
[S11] DEBUG after merge:  round=69 metric=0.9963 head_norm=1.775094 delta_norm=0.013040
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=69 metric=0.5855 head_norm=1.846994
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.523046e-02
[S7] stored merged vector for next round verification (round=69)
[S7] DEBUG after merge:  round=69 metric=0.5853 head_norm=1.841473 delta_norm=0.025230
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.909968 cos_to_last_merge=0.9978 (last merge round=58)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.712169560749811, 'auprc': 0.9932901621081667, 'loss_val': 0.4945193669531684, 'psi': 0.8246178012931533}-{'f1_val': 0.8223251550630377, 'auprc': 0.9932631273983015, 'loss_val': 0.42533471529811634, 'psi': 0.8907003439971433}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.373224 cos_to_last_merge=1.0000 (last merge round=69)
[S3] round=70 local utility u=0.128522 metrics={'f1_val': 0.9761264418090619, 'auprc': 0.9982219265742183, 'loss_val': 0.04825666536862544, 'psi': 0.9849646357151245}-{'f1_val': 0.9472429635684626, 'auprc': 0.9961784002380242, 'loss_val': 0.12586889617085356, 'psi': 0.9668171382362872}
[S4] START round=70 head_norm_before_train=1.838645 cos_to_last_merge=1.0000 (last merge round=68)
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9391044454155608, 'auprc': 0.9598779610323832, 'loss_val': 0.3174341294653471, 'psi': 0.9474138516622898}-{'f1_val': 0.9403139626025744, 'auprc': 0.9748383939802991, 'loss_val': 0.3013135537935125, 'psi': 0.9541237351536642}
[S5] START round=70 head_norm_before_train=2.260895 (no previous merge yet)
[S5] round=70 local utility u=0.010501 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9999379213001977, 'loss_val': 0.018994347401516683, 'psi': 0.9984371192316743}-{'f1_val': 0.9967019684784577, 'auprc': 0.9962144145252742, 'loss_val': 0.02441862253656852, 'psi': 0.9965069468971843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=70 head_norm_before_train=1.714989 cos_to_last_merge=1.0000 (last merge round=69)
[S6] round=70 local utility u=0.403253 metrics={'f1_val': 0.7125333983692471, 'auprc': 0.9031229066950164, 'loss_val': 0.7038585580707698, 'psi': 0.7887692016995549}-{'f1_val': 0.6268284140706022, 'auprc': 0.8676899224405525, 'loss_val': 0.8898347011551818, 'psi': 0.7231730174185824}
[S7] START round=70 head_norm_before_train=1.841473 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=70 local utility u=1.000000 metrics={'f1_val': 0.9043979050815688, 'auprc': 0.9885855424713897, 'loss_val': 0.24916381895729808, 'psi': 0.9380729600374971}-{'f1_val': 0.585470275476198, 'auprc': 0.7990724574758785, 'loss_val': 0.6674482593890282, 'psi': 0.6709111482760702}
[S8] START round=70 head_norm_before_train=2.375583 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=70 local utility u=0.005109 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9978518101805657, 'loss_val': 0.025316826408362893, 'psi': 0.9972065528360838}-{'f1_val': 0.996776381273096, 'auprc': 0.9983640156405738, 'loss_val': 0.03707116961853455, 'psi': 0.9974114350200871}
[S9] START round=70 head_norm_before_train=2.331388 (no previous merge yet)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9999564270810211, 'loss_val': 0.026584614754521996, 'psi': 0.9947290589692988}-{'f1_val': 0.9966924912647621, 'auprc': 0.9971868046715704, 'loss_val': 0.017216651918837204, 'psi': 0.9968902166274854}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.312209 cos_to_last_merge=0.9995 (last merge round=58)
[S10] round=70 local utility u=0.000622 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9956824411011379, 'loss_val': 0.027077198997435728, 'psi': 0.9953350572861142}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961583560294697, 'loss_val': 0.027114352030218083, 'psi': 0.9952619754174377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=70 head_norm_before_train=1.775094 cos_to_last_merge=1.0000 (last merge round=69)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.995892772286759, 'auprc': 0.997831474270488, 'loss_val': 0.02576069605002415, 'psi': 0.9966682530802505}-{'f1_val': 0.996305167468861, 'auprc': 0.9978860216864975, 'loss_val': 0.02686604497418547, 'psi': 0.9969375091559156}
[S13] START round=70 head_norm_before_train=1.884915 cos_to_last_merge=0.9983 (last merge round=57)
[S13] round=70 local utility u=0.305307 metrics={'f1_val': 0.6180679800295019, 'auprc': 0.7357072092226884, 'loss_val': 1.0435081811289313, 'psi': 0.6651236717067766}-{'f1_val': 0.5724503854596122, 'auprc': 0.7413268690777218, 'loss_val': 1.3972758128236462, 'psi': 0.640000978906856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=70 head_norm_before_train=1.772397 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=70 local utility u=0.015964 metrics={'f1_val': 0.9936811042174911, 'auprc': 0.9987866258189255, 'loss_val': 0.033841835582082466, 'psi': 0.9957233128580649}-{'f1_val': 0.9890186554483399, 'auprc': 0.9990274200102693, 'loss_val': 0.03851667228485745, 'psi': 0.9930221612731117}
[S15] START round=70 head_norm_before_train=1.994435 cos_to_last_merge=0.9996 (last merge round=58)
[S15] round=70 local utility u=0.064665 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9931777171698599, 'loss_val': 0.02523442244754196, 'psi': 0.9948382597530439}-{'f1_val': 0.9780551467721815, 'auprc': 0.9945912948855368, 'loss_val': 0.05146393508352478, 'psi': 0.9846696060175236}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=70 head_norm_before_train=2.043415 cos_to_last_merge=0.9705 (last merge round=45)
[S16] round=70 local utility u=0.193611 metrics={'f1_val': 0.9917337388513483, 'auprc': 0.9922898115547224, 'loss_val': 0.03782853842428985, 'psi': 0.9919561679326979}-{'f1_val': 0.946329317690278, 'auprc': 0.9895095087761485, 'loss_val': 0.14428381397238335, 'psi': 0.9636013941246262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=70 head_norm_before_train=1.706553 cos_to_last_merge=1.0000 (last merge round=67)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.4464917160281001, 'auprc': 0.6865437272733923, 'loss_val': 1.583507849497847, 'psi': 0.542512520526217}-{'f1_val': 0.7906558785425652, 'auprc': 0.9904586497592772, 'loss_val': 0.5885629289835658, 'psi': 0.87057698702925}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S7] not sending this round → trigger blocked (psi=0.938)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:41912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] ⇄ pheromone p=0.150 → S14@127.0.0.1:41914
[S17] ⇄ pheromone p=0.289 → S6@127.0.0.1:41907
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] ⇄ pheromone p=0.292 → S4@127.0.0.1:41904
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=70 metric=0.9391 head_norm=1.843644
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.051810e-02
[S4] stored merged vector for next round verification (round=70)
[S4] DEBUG after merge:  round=70 metric=0.9391 head_norm=1.845205 delta_norm=0.020518
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.118 → S7@127.0.0.1:41908
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=70 metric=0.9761 head_norm=2.381421
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.672500e-02
[S3] stored merged vector for next round verification (round=70)
[S3] DEBUG after merge:  round=70 metric=0.9761 head_norm=2.381030 delta_norm=0.016725
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.229 → S8@127.0.0.1:41909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=70 metric=0.9968 head_norm=2.380757
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.672501e-02
[S8] stored merged vector for next round verification (round=70)
[S8] DEBUG after merge:  round=70 metric=0.9968 head_norm=2.381030 delta_norm=0.016725
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.003 → S3@127.0.0.1:41903
[S6] ⇄ pheromone p=0.286 → S17@127.0.0.1:41917
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=70 metric=0.9937 head_norm=1.778640
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.357166e-02
[S14] stored merged vector for next round verification (round=70)
[S14] DEBUG after merge:  round=70 metric=0.9937 head_norm=1.780189 delta_norm=0.013572
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.038 → S11@127.0.0.1:41912
[S2] START round=71 head_norm_before_train=1.918877 cos_to_last_merge=0.9975 (last merge round=58)
[S2] round=71 local utility u=0.305485 metrics={'f1_val': 0.831558093098586, 'auprc': 0.9299432081232617, 'loss_val': 0.4098399128069356, 'psi': 0.8709121391084562}-{'f1_val': 0.712169560749811, 'auprc': 0.9932901621081667, 'loss_val': 0.4945193669531684, 'psi': 0.8246178012931533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=71 head_norm_before_train=2.381030 cos_to_last_merge=1.0000 (last merge round=70)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9991228519536883, 'loss_val': 0.09413543831461785, 'psi': 0.9762702914447414}-{'f1_val': 0.9761264418090619, 'auprc': 0.9982219265742183, 'loss_val': 0.04825666536862544, 'psi': 0.9849646357151245}
[S4] START round=71 head_norm_before_train=1.845205 cos_to_last_merge=1.0000 (last merge round=70)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9396425240498886, 'auprc': 0.9541397854531037, 'loss_val': 0.3171073151236088, 'psi': 0.9454414286111745}-{'f1_val': 0.9391044454155608, 'auprc': 0.9598779610323832, 'loss_val': 0.3174341294653471, 'psi': 0.9474138516622898}
[S5] START round=71 head_norm_before_train=2.260759 (no previous merge yet)
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.999911069906961, 'loss_val': 0.020932874706064725, 'psi': 0.9984263786743797}-{'f1_val': 0.9974365845193254, 'auprc': 0.9999379213001977, 'loss_val': 0.018994347401516683, 'psi': 0.9984371192316743}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.727838 cos_to_last_merge=1.0000 (last merge round=69)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.5945757127725653, 'auprc': 0.8661792083348279, 'loss_val': 1.080547678844835, 'psi': 0.7032171109974703}-{'f1_val': 0.7125333983692471, 'auprc': 0.9031229066950164, 'loss_val': 0.7038585580707698, 'psi': 0.7887692016995549}
[S7] START round=71 head_norm_before_train=1.848235 cos_to_last_merge=1.0000 (last merge round=69)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5043684416148598, 'auprc': 0.7712821607070012, 'loss_val': 1.2803878316745931, 'psi': 0.6111339292517164}-{'f1_val': 0.9043979050815688, 'auprc': 0.9885855424713897, 'loss_val': 0.24916381895729808, 'psi': 0.9380729600374971}
[S8] START round=71 head_norm_before_train=2.381030 cos_to_last_merge=1.0000 (last merge round=70)
[S8] round=71 local utility u=0.000560 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9982188733166031, 'loss_val': 0.02701654658048919, 'psi': 0.9975252138432505}-{'f1_val': 0.996776381273096, 'auprc': 0.9978518101805657, 'loss_val': 0.025316826408362893, 'psi': 0.9972065528360838}
[S9] START round=71 head_norm_before_train=2.338253 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9999540810115323, 'loss_val': 0.02770420073124335, 'psi': 0.9947281205415033}-{'f1_val': 0.9912441468948172, 'auprc': 0.9999564270810211, 'loss_val': 0.026584614754521996, 'psi': 0.9947290589692988}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.314540 cos_to_last_merge=0.9993 (last merge round=58)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9945971823002195, 'loss_val': 0.02705817988733747, 'psi': 0.9949009537657467}-{'f1_val': 0.9951034680760983, 'auprc': 0.9956824411011379, 'loss_val': 0.027077198997435728, 'psi': 0.9953350572861142}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.781268 cos_to_last_merge=1.0000 (last merge round=69)
[S11] round=71 local utility u=0.000701 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978642699313292, 'loss_val': 0.02590184618565852, 'psi': 0.9968259129205173}-{'f1_val': 0.995892772286759, 'auprc': 0.997831474270488, 'loss_val': 0.02576069605002415, 'psi': 0.9966682530802505}
[S13] START round=71 head_norm_before_train=1.887858 cos_to_last_merge=0.9981 (last merge round=57)
[S13] round=71 local utility u=0.084503 metrics={'f1_val': 0.6306555974316023, 'auprc': 0.7193953544624134, 'loss_val': 0.901092018768308, 'psi': 0.6661515002439267}-{'f1_val': 0.6180679800295019, 'auprc': 0.7357072092226884, 'loss_val': 1.0435081811289313, 'psi': 0.6651236717067766}
[S13] not sending this round → trigger blocked (psi=0.666)
[S14] START round=71 head_norm_before_train=1.780189 cos_to_last_merge=1.0000 (last merge round=70)
[S14] round=71 local utility u=0.016458 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9983416216719815, 'loss_val': 0.021969847663502514, 'psi': 0.9977832452294895}-{'f1_val': 0.9936811042174911, 'auprc': 0.9987866258189255, 'loss_val': 0.033841835582082466, 'psi': 0.9957233128580649}
[S15] START round=71 head_norm_before_train=2.000435 cos_to_last_merge=0.9995 (last merge round=58)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.9871250750969747, 'auprc': 0.9944048566517036, 'loss_val': 0.042197356133350995, 'psi': 0.9900369877188662}-{'f1_val': 0.9959452881418331, 'auprc': 0.9931777171698599, 'loss_val': 0.02523442244754196, 'psi': 0.9948382597530439}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=2.048525 cos_to_last_merge=0.9700 (last merge round=45)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9906878608128473, 'auprc': 0.9871598975356379, 'loss_val': 0.040260522857199964, 'psi': 0.9892766755019635}-{'f1_val': 0.9917337388513483, 'auprc': 0.9922898115547224, 'loss_val': 0.03782853842428985, 'psi': 0.9919561679326979}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.712966 cos_to_last_merge=0.9999 (last merge round=67)
[S17] round=71 local utility u=0.942305 metrics={'f1_val': 0.6172017391287385, 'auprc': 0.8367257404691025, 'loss_val': 1.1737049722372026, 'psi': 0.705011339664884}-{'f1_val': 0.4464917160281001, 'auprc': 0.6865437272733923, 'loss_val': 1.583507849497847, 'psi': 0.542512520526217}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.998)
[S11] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.9994
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=71 metric=0.6172 head_norm=1.718789
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.463284e-02
[S17] stored merged vector for next round verification (round=71)
[S17] DEBUG after merge:  round=71 metric=0.6172 head_norm=1.723143 delta_norm=0.024633
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=71 metric=0.9961 head_norm=1.786029
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.337900e-02
[S11] stored merged vector for next round verification (round=71)
[S11] DEBUG after merge:  round=71 metric=0.9961 head_norm=1.782288 delta_norm=0.013379
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=1.927149 cos_to_last_merge=0.9972 (last merge round=58)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7673627437667788, 'auprc': 0.9928433950826092, 'loss_val': 0.45776067941954407, 'psi': 0.857555004293111}-{'f1_val': 0.831558093098586, 'auprc': 0.9299432081232617, 'loss_val': 0.4098399128069356, 'psi': 0.8709121391084562}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.385392 cos_to_last_merge=1.0000 (last merge round=70)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9991495059379661, 'loss_val': 0.1505118801519711, 'psi': 0.9760023867965619}-{'f1_val': 0.9610352511054436, 'auprc': 0.9991228519536883, 'loss_val': 0.09413543831461785, 'psi': 0.9762702914447414}
[S4] START round=72 head_norm_before_train=1.849402 cos_to_last_merge=1.0000 (last merge round=70)
[S4] round=72 local utility u=0.049700 metrics={'f1_val': 0.9448277023531721, 'auprc': 0.9723657917364433, 'loss_val': 0.303495908566461, 'psi': 0.9558429381064806}-{'f1_val': 0.9396425240498886, 'auprc': 0.9541397854531037, 'loss_val': 0.3171073151236088, 'psi': 0.9454414286111745}
[S5] START round=72 head_norm_before_train=2.261234 (no previous merge yet)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9963505504661329, 'loss_val': 0.015940606996001784, 'psi': 0.9967370621632672}-{'f1_val': 0.9974365845193254, 'auprc': 0.999911069906961, 'loss_val': 0.020932874706064725, 'psi': 0.9984263786743797}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.741200 cos_to_last_merge=0.9999 (last merge round=69)
[S6] round=72 local utility u=0.787798 metrics={'f1_val': 0.7502512066582567, 'auprc': 0.9231824186255998, 'loss_val': 0.610014959435817, 'psi': 0.819423691445194}-{'f1_val': 0.5945757127725653, 'auprc': 0.8661792083348279, 'loss_val': 1.080547678844835, 'psi': 0.7032171109974703}
[S7] START round=72 head_norm_before_train=1.853229 cos_to_last_merge=0.9999 (last merge round=69)
[S7] round=72 local utility u=0.313393 metrics={'f1_val': 0.5513664103587966, 'auprc': 0.7851633363680625, 'loss_val': 0.9772339098131951, 'psi': 0.644885180762503}-{'f1_val': 0.5043684416148598, 'auprc': 0.7712821607070012, 'loss_val': 1.2803878316745931, 'psi': 0.6111339292517164}
[S8] START round=72 head_norm_before_train=2.385860 cos_to_last_merge=1.0000 (last merge round=70)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9982438969271535, 'loss_val': 0.0272482707237285, 'psi': 0.9975352232874708}-{'f1_val': 0.997062774194349, 'auprc': 0.9982188733166031, 'loss_val': 0.02701654658048919, 'psi': 0.9975252138432505}
[S9] START round=72 head_norm_before_train=2.342038 (no previous merge yet)
[S9] round=72 local utility u=0.022992 metrics={'f1_val': 0.996910691670878, 'auprc': 0.9999032707172524, 'loss_val': 0.015567928698772077, 'psi': 0.9981077232894278}-{'f1_val': 0.9912441468948172, 'auprc': 0.9999540810115323, 'loss_val': 0.02770420073124335, 'psi': 0.9947281205415033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=72 head_norm_before_train=2.316008 cos_to_last_merge=0.9992 (last merge round=58)
[S10] round=72 local utility u=0.000686 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9945668022444868, 'loss_val': 0.026913353769643548, 'psi': 0.995020593236033}-{'f1_val': 0.9951034680760983, 'auprc': 0.9945971823002195, 'loss_val': 0.02705817988733747, 'psi': 0.9949009537657467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=72 head_norm_before_train=1.782288 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997828188159884, 'loss_val': 0.02639912565905046, 'psi': 0.9968114802119392}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978642699313292, 'loss_val': 0.02590184618565852, 'psi': 0.9968259129205173}
[S13] START round=72 head_norm_before_train=1.890898 cos_to_last_merge=0.9979 (last merge round=57)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.5974348456196172, 'auprc': 0.760755445322489, 'loss_val': 1.0449477500638107, 'psi': 0.662763085500766}-{'f1_val': 0.6306555974316023, 'auprc': 0.7193953544624134, 'loss_val': 0.901092018768308, 'psi': 0.6661515002439267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.786303 cos_to_last_merge=1.0000 (last merge round=70)
[S14] round=72 local utility u=0.000897 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9989237202314836, 'loss_val': 0.020601015002054916, 'psi': 0.9978839610526857}-{'f1_val': 0.9974109942678281, 'auprc': 0.9983416216719815, 'loss_val': 0.021969847663502514, 'psi': 0.9977832452294895}
[S15] START round=72 head_norm_before_train=2.006257 cos_to_last_merge=0.9994 (last merge round=58)
[S15] round=72 local utility u=0.042192 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970821466913221, 'loss_val': 0.023575683229935494, 'psi': 0.9968808597090412}-{'f1_val': 0.9871250750969747, 'auprc': 0.9944048566517036, 'loss_val': 0.042197356133350995, 'psi': 0.9900369877188662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=72 head_norm_before_train=2.055140 cos_to_last_merge=0.9694 (last merge round=45)
[S16] round=72 local utility u=0.017909 metrics={'f1_val': 0.9930717466151068, 'auprc': 0.9928435915318556, 'loss_val': 0.03579596699427535, 'psi': 0.9929804845818063}-{'f1_val': 0.9906878608128473, 'auprc': 0.9871598975356379, 'loss_val': 0.040260522857199964, 'psi': 0.9892766755019635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=72 head_norm_before_train=1.723143 cos_to_last_merge=1.0000 (last merge round=71)
[S17] round=72 local utility u=0.396889 metrics={'f1_val': 0.6713463337237696, 'auprc': 0.9211491806581071, 'loss_val': 0.9580642907687922, 'psi': 0.7712674724975046}-{'f1_val': 0.6172017391287385, 'auprc': 0.8367257404691025, 'loss_val': 1.1737049722372026, 'psi': 0.705011339664884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[S17] not sending this round → trigger blocked (psi=0.771)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9997
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9997
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=72 metric=0.7503 head_norm=1.755768
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.952250e-02
[S6] stored merged vector for next round verification (round=72)
[S6] DEBUG after merge:  round=72 metric=0.7505 head_norm=1.736927 delta_norm=0.039523
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=72 metric=0.9448 head_norm=1.854114
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.103624e-02
[S4] stored merged vector for next round verification (round=72)
[S4] DEBUG after merge:  round=72 metric=0.9448 head_norm=1.856432 delta_norm=0.021036
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=72 metric=0.9972 head_norm=1.792518
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.117018e-02
[S14] stored merged vector for next round verification (round=72)
[S14] DEBUG after merge:  round=72 metric=0.9972 head_norm=1.789242 delta_norm=0.011170
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=72 metric=0.5514 head_norm=1.858985
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.103625e-02
[S7] stored merged vector for next round verification (round=72)
[S7] DEBUG after merge:  round=72 metric=0.5498 head_norm=1.856432 delta_norm=0.021036
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=1.935602 cos_to_last_merge=0.9970 (last merge round=58)
[S2] round=73 local utility u=0.195449 metrics={'f1_val': 0.8270806092238246, 'auprc': 0.992737251540087, 'loss_val': 0.4248510056776261, 'psi': 0.8933432661503296}-{'f1_val': 0.7673627437667788, 'auprc': 0.9928433950826092, 'loss_val': 0.45776067941954407, 'psi': 0.857555004293111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=73 head_norm_before_train=2.391356 cos_to_last_merge=0.9999 (last merge round=70)
[S3] round=73 local utility u=0.170528 metrics={'f1_val': 0.9952873006695607, 'auprc': 0.9994670464837863, 'loss_val': 0.018705574760667712, 'psi': 0.9969591989952509}-{'f1_val': 0.9605709740356257, 'auprc': 0.9991495059379661, 'loss_val': 0.1505118801519711, 'psi': 0.9760023867965619}
[S4] START round=73 head_norm_before_train=1.856432 cos_to_last_merge=1.0000 (last merge round=72)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9378679420788617, 'auprc': 0.936431557732646, 'loss_val': 0.3449626048608107, 'psi': 0.9372933883403753}-{'f1_val': 0.9448277023531721, 'auprc': 0.9723657917364433, 'loss_val': 0.303495908566461, 'psi': 0.9558429381064806}
[S5] START round=73 head_norm_before_train=2.264499 (no previous merge yet)
[S5] round=73 local utility u=0.006405 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9995090716578903, 'loss_val': 0.014811696480668733, 'psi': 0.9982210247195341}-{'f1_val': 0.9969947366280233, 'auprc': 0.9963505504661329, 'loss_val': 0.015940606996001784, 'psi': 0.9967370621632672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=73 head_norm_before_train=1.736927 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6365741340890573, 'auprc': 0.8913700925503495, 'loss_val': 0.8436249415684935, 'psi': 0.7384925174735741}-{'f1_val': 0.7502512066582567, 'auprc': 0.9231824186255998, 'loss_val': 0.610014959435817, 'psi': 0.819423691445194}
[S7] START round=73 head_norm_before_train=1.856432 cos_to_last_merge=1.0000 (last merge round=72)
[S7] round=73 local utility u=0.167525 metrics={'f1_val': 0.5834343292601638, 'auprc': 0.7917904177907114, 'loss_val': 0.8544731213665043, 'psi': 0.6667767646723828}-{'f1_val': 0.5513664103587966, 'auprc': 0.7851633363680625, 'loss_val': 0.9772339098131951, 'psi': 0.644885180762503}
[S8] START round=73 head_norm_before_train=2.390955 cos_to_last_merge=0.9999 (last merge round=70)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9983762306493599, 'loss_val': 0.0348725833672885, 'psi': 0.9974163210236016}-{'f1_val': 0.997062774194349, 'auprc': 0.9982438969271535, 'loss_val': 0.0272482707237285, 'psi': 0.9975352232874708}
[S9] START round=73 head_norm_before_train=2.345616 (no previous merge yet)
[S9] round=73 local utility u=0.000115 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999470464348799, 'loss_val': 0.016432823861899745, 'psi': 0.9982216664955721}-{'f1_val': 0.996910691670878, 'auprc': 0.9999032707172524, 'loss_val': 0.015567928698772077, 'psi': 0.9981077232894278}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=73 head_norm_before_train=2.314303 cos_to_last_merge=0.9989 (last merge round=58)
[S10] round=73 local utility u=0.000474 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961817625414766, 'loss_val': 0.026858596741307115, 'psi': 0.9952713380222404}-{'f1_val': 0.9953231205637304, 'auprc': 0.9945668022444868, 'loss_val': 0.026913353769643548, 'psi': 0.995020593236033}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=73 head_norm_before_train=1.787164 cos_to_last_merge=1.0000 (last merge round=71)
[S11] round=73 local utility u=0.000172 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978932646397932, 'loss_val': 0.02625113459306865, 'psi': 0.9968375108039029}-{'f1_val': 0.9961336749133093, 'auprc': 0.997828188159884, 'loss_val': 0.02639912565905046, 'psi': 0.9968114802119392}
[S13] START round=73 head_norm_before_train=1.895282 cos_to_last_merge=0.9978 (last merge round=57)
[S13] round=73 local utility u=0.090798 metrics={'f1_val': 0.6085678453562737, 'auprc': 0.7647404179915135, 'loss_val': 0.9421037487786786, 'psi': 0.6710368744103696}-{'f1_val': 0.5974348456196172, 'auprc': 0.760755445322489, 'loss_val': 1.0449477500638107, 'psi': 0.662763085500766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=73 head_norm_before_train=1.789242 cos_to_last_merge=1.0000 (last merge round=72)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9990350194388979, 'loss_val': 0.023097849683006585, 'psi': 0.9978148160807424}-{'f1_val': 0.9971907882668205, 'auprc': 0.9989237202314836, 'loss_val': 0.020601015002054916, 'psi': 0.9978839610526857}
[S15] START round=73 head_norm_before_train=2.012939 cos_to_last_merge=0.9993 (last merge round=58)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.8266624548556617, 'auprc': 0.9921979637076823, 'loss_val': 0.3221028132557111, 'psi': 0.89287665839647}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970821466913221, 'loss_val': 0.023575683229935494, 'psi': 0.9968808597090412}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=2.062477 cos_to_last_merge=0.9687 (last merge round=45)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9874749746264675, 'auprc': 0.9896551583535731, 'loss_val': 0.06392319575191331, 'psi': 0.9883470481173098}-{'f1_val': 0.9930717466151068, 'auprc': 0.9928435915318556, 'loss_val': 0.03579596699427535, 'psi': 0.9929804845818063}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.728973 cos_to_last_merge=1.0000 (last merge round=71)
[S17] round=73 local utility u=0.738021 metrics={'f1_val': 0.8212777602983823, 'auprc': 0.9844564238571905, 'loss_val': 0.5715332451904179, 'psi': 0.8865492257219056}-{'f1_val': 0.6713463337237696, 'auprc': 0.9211491806581071, 'loss_val': 0.9580642907687922, 'psi': 0.7712674724975046}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:41909
[S7] not sending this round → trigger blocked (psi=0.667)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:41914
[S11] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9995
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1792) from S11
[S14] cosine check vs S11: cos=1.0000
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=73 metric=0.8213 head_norm=1.737477
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.890825e-02
[S17] stored merged vector for next round verification (round=73)
[S17] DEBUG after merge:  round=73 metric=0.8205 head_norm=1.746407 delta_norm=0.028908
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=73 metric=0.9961 head_norm=1.792049
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.847076e-03
[S11] stored merged vector for next round verification (round=73)
[S11] DEBUG after merge:  round=73 metric=0.9961 head_norm=1.792266 delta_norm=0.007847
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=74 head_norm_before_train=1.942202 cos_to_last_merge=0.9968 (last merge round=58)
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.8323405219876172, 'auprc': 0.7823620478080728, 'loss_val': 0.40030409517245746, 'psi': 0.8123491323157994}-{'f1_val': 0.8270806092238246, 'auprc': 0.992737251540087, 'loss_val': 0.4248510056776261, 'psi': 0.8933432661503296}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.397496 cos_to_last_merge=0.9999 (last merge round=70)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999487079536303, 'loss_val': 0.12239995870448274, 'psi': 0.9764398830541935}-{'f1_val': 0.9952873006695607, 'auprc': 0.9994670464837863, 'loss_val': 0.018705574760667712, 'psi': 0.9969591989952509}
[S4] START round=74 head_norm_before_train=1.863191 cos_to_last_merge=1.0000 (last merge round=72)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.6533542414095896, 'auprc': 0.9254384787615098, 'loss_val': 0.6270395262420309, 'psi': 0.7621879363503576}-{'f1_val': 0.9378679420788617, 'auprc': 0.936431557732646, 'loss_val': 0.3449626048608107, 'psi': 0.9372933883403753}
[S5] START round=74 head_norm_before_train=2.269849 (no previous merge yet)
[S5] round=74 local utility u=0.000457 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9996408021099442, 'loss_val': 0.01429191638407169, 'psi': 0.9982737169003557}-{'f1_val': 0.99736232676063, 'auprc': 0.9995090716578903, 'loss_val': 0.014811696480668733, 'psi': 0.9982210247195341}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=74 head_norm_before_train=1.748127 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=74 local utility u=0.055896 metrics={'f1_val': 0.6656937538585908, 'auprc': 0.8577130749355966, 'loss_val': 0.805579985320422, 'psi': 0.742501482289393}-{'f1_val': 0.6365741340890573, 'auprc': 0.8913700925503495, 'loss_val': 0.8436249415684935, 'psi': 0.7384925174735741}
[S7] START round=74 head_norm_before_train=1.863415 cos_to_last_merge=1.0000 (last merge round=72)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5605388186972399, 'auprc': 0.787999300581003, 'loss_val': 0.9864284321458532, 'psi': 0.6515230114507451}-{'f1_val': 0.5834343292601638, 'auprc': 0.7917904177907114, 'loss_val': 0.8544731213665043, 'psi': 0.6667767646723828}
[S8] START round=74 head_norm_before_train=2.396897 cos_to_last_merge=0.9996 (last merge round=70)
[S8] round=74 local utility u=0.006095 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9970715412792485, 'loss_val': 0.021387076573355708, 'psi': 0.9971563925894035}-{'f1_val': 0.996776381273096, 'auprc': 0.9983762306493599, 'loss_val': 0.0348725833672885, 'psi': 0.9974163210236016}
[S9] START round=74 head_norm_before_train=2.346889 (no previous merge yet)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9999648696762804, 'loss_val': 0.031022050745138884, 'psi': 0.9944607471547833}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999470464348799, 'loss_val': 0.016432823861899745, 'psi': 0.9982216664955721}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.315542 cos_to_last_merge=0.9987 (last merge round=58)
[S10] round=74 local utility u=0.000270 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9964958997513125, 'loss_val': 0.0270067670698229, 'psi': 0.9953715685129367}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961817625414766, 'loss_val': 0.026858596741307115, 'psi': 0.9952713380222404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=74 head_norm_before_train=1.792266 cos_to_last_merge=1.0000 (last merge round=73)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978837833153499, 'loss_val': 0.02621700939010226, 'psi': 0.9966886160472883}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978932646397932, 'loss_val': 0.02625113459306865, 'psi': 0.9968375108039029}
[S13] START round=74 head_norm_before_train=1.899824 cos_to_last_merge=0.9976 (last merge round=57)
[S13] round=74 local utility u=0.313479 metrics={'f1_val': 0.6566001235538715, 'auprc': 0.7746927925023626, 'loss_val': 0.6331964018573079, 'psi': 0.7038371911332679}-{'f1_val': 0.6085678453562737, 'auprc': 0.7647404179915135, 'loss_val': 0.9421037487786786, 'psi': 0.6710368744103696}
[S13] not sending this round → trigger blocked (psi=0.704)
[S14] START round=74 head_norm_before_train=1.794933 cos_to_last_merge=1.0000 (last merge round=72)
[S14] round=74 local utility u=0.001926 metrics={'f1_val': 0.997411628228889, 'auprc': 0.9990311168428385, 'loss_val': 0.021696038051508226, 'psi': 0.9980594236744689}-{'f1_val': 0.9970013471753054, 'auprc': 0.9990350194388979, 'loss_val': 0.023097849683006585, 'psi': 0.9978148160807424}
[S15] START round=74 head_norm_before_train=2.019761 cos_to_last_merge=0.9992 (last merge round=58)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.704638367896279, 'auprc': 0.908205083017067, 'loss_val': 0.6637150367344299, 'psi': 0.7860650539445941}-{'f1_val': 0.8266624548556617, 'auprc': 0.9921979637076823, 'loss_val': 0.3221028132557111, 'psi': 0.89287665839647}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.067705 cos_to_last_merge=0.9683 (last merge round=45)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9826910510516653, 'auprc': 0.9877323775482467, 'loss_val': 0.07115980596605787, 'psi': 0.9847075816502979}-{'f1_val': 0.9874749746264675, 'auprc': 0.9896551583535731, 'loss_val': 0.06392319575191331, 'psi': 0.9883470481173098}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.746407 cos_to_last_merge=1.0000 (last merge round=73)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.7985209262105802, 'auprc': 0.9664012650611435, 'loss_val': 0.6174635764957999, 'psi': 0.8656730617508056}-{'f1_val': 0.8212777602983823, 'auprc': 0.9844564238571905, 'loss_val': 0.5715332451904179, 'psi': 0.8865492257219056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S6
[S17] cosine check vs S6: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9992
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=74 metric=0.9974 head_norm=1.802159
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.816471e-03
[S14] stored merged vector for next round verification (round=74)
[S14] DEBUG after merge:  round=74 metric=0.9974 head_norm=1.797094 delta_norm=0.007816
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=74 metric=0.6657 head_norm=1.762160
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.352908e-02
[S6] stored merged vector for next round verification (round=74)
[S6] DEBUG after merge:  round=74 metric=0.6665 head_norm=1.749703 delta_norm=0.023529
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=74 metric=0.9972 head_norm=2.404376
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.622881e-02
[S8] stored merged vector for next round verification (round=74)
[S8] DEBUG after merge:  round=74 metric=0.9972 head_norm=2.400494 delta_norm=0.046229
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=1.948280 cos_to_last_merge=0.9966 (last merge round=58)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7121704874046533, 'auprc': 0.993390318583512, 'loss_val': 0.48348134067525994, 'psi': 0.8246584198761968}-{'f1_val': 0.8323405219876172, 'auprc': 0.7823620478080728, 'loss_val': 0.40030409517245746, 'psi': 0.8123491323157994}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.403889 cos_to_last_merge=0.9999 (last merge round=70)
[S3] round=75 local utility u=0.162610 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9994762220859366, 'loss_val': 0.014915753348772263, 'psi': 0.9982123074294269}-{'f1_val': 0.9610750853994537, 'auprc': 0.999487079536303, 'loss_val': 0.12239995870448274, 'psi': 0.9764398830541935}
[S4] START round=75 head_norm_before_train=1.869549 cos_to_last_merge=1.0000 (last merge round=72)
[S4] round=75 local utility u=1.000000 metrics={'f1_val': 0.9380422503064644, 'auprc': 0.9503531479970778, 'loss_val': 0.3367212514676596, 'psi': 0.9429666093827097}-{'f1_val': 0.6533542414095896, 'auprc': 0.9254384787615098, 'loss_val': 0.6270395262420309, 'psi': 0.7621879363503576}
[S5] START round=75 head_norm_before_train=2.283279 (no previous merge yet)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.997731766516735, 'auprc': 0.9997730902697707, 'loss_val': 0.04506316426651573, 'psi': 0.9985482960179493}-{'f1_val': 0.99736232676063, 'auprc': 0.9996408021099442, 'loss_val': 0.01429191638407169, 'psi': 0.9982737169003557}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.749703 cos_to_last_merge=1.0000 (last merge round=74)
[S6] round=75 local utility u=0.543830 metrics={'f1_val': 0.763525878658033, 'auprc': 0.9207942087514424, 'loss_val': 0.49415675959289324, 'psi': 0.8264332106953968}-{'f1_val': 0.6656937538585908, 'auprc': 0.8577130749355966, 'loss_val': 0.805579985320422, 'psi': 0.742501482289393}
[S7] START round=75 head_norm_before_train=1.870388 cos_to_last_merge=0.9999 (last merge round=72)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.5490320360290524, 'auprc': 0.7722072482224869, 'loss_val': 1.1844533597416487, 'psi': 0.6383021209064261}-{'f1_val': 0.5605388186972399, 'auprc': 0.787999300581003, 'loss_val': 0.9864284321458532, 'psi': 0.6515230114507451}
[S8] START round=75 head_norm_before_train=2.400494 cos_to_last_merge=1.0000 (last merge round=74)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9979905255054676, 'loss_val': 0.12881742928001277, 'psi': 0.9972620389660447}-{'f1_val': 0.9972129601295068, 'auprc': 0.9970715412792485, 'loss_val': 0.021387076573355708, 'psi': 0.9971563925894035}
[S9] START round=75 head_norm_before_train=2.350625 (no previous merge yet)
[S9] round=75 local utility u=0.026383 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999544645459081, 'loss_val': 0.016093546249231958, 'psi': 0.998243533325649}-{'f1_val': 0.9907913321404518, 'auprc': 0.9999648696762804, 'loss_val': 0.031022050745138884, 'psi': 0.9944607471547833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] START round=75 head_norm_before_train=2.319085 cos_to_last_merge=0.9985 (last merge round=58)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9959610266924952, 'loss_val': 0.02681320645716241, 'psi': 0.9951830436826479}-{'f1_val': 0.9946220143540194, 'auprc': 0.9964958997513125, 'loss_val': 0.0270067670698229, 'psi': 0.9953715685129367}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.798267 cos_to_last_merge=1.0000 (last merge round=73)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964620507945998, 'loss_val': 0.02592348562132392, 'psi': 0.9962650252658255}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978837833153499, 'loss_val': 0.02621700939010226, 'psi': 0.9966886160472883}
[S13] START round=75 head_norm_before_train=1.904317 cos_to_last_merge=0.9974 (last merge round=57)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6227219364205075, 'auprc': 0.7848754834689438, 'loss_val': 0.9686390969563526, 'psi': 0.687583355239882}-{'f1_val': 0.6566001235538715, 'auprc': 0.7746927925023626, 'loss_val': 0.6331964018573079, 'psi': 0.7038371911332679}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=1.797094 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=75 local utility u=0.001615 metrics={'f1_val': 0.997411628228889, 'auprc': 0.9990469320649012, 'loss_val': 0.018513079665113744, 'psi': 0.9980657497632939}-{'f1_val': 0.997411628228889, 'auprc': 0.9990311168428385, 'loss_val': 0.021696038051508226, 'psi': 0.9980594236744689}
[S15] START round=75 head_norm_before_train=2.025615 cos_to_last_merge=0.9992 (last merge round=58)
[S15] round=75 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9962980972603925, 'loss_val': 0.02320907453517681, 'psi': 0.9963091016767096}-{'f1_val': 0.704638367896279, 'auprc': 0.908205083017067, 'loss_val': 0.6637150367344299, 'psi': 0.7860650539445941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=75 head_norm_before_train=2.071924 cos_to_last_merge=0.9678 (last merge round=45)
[S16] round=75 local utility u=0.050438 metrics={'f1_val': 0.9917337388513483, 'auprc': 0.9921778137585282, 'loss_val': 0.03787705376898663, 'psi': 0.9919113688142203}-{'f1_val': 0.9826910510516653, 'auprc': 0.9877323775482467, 'loss_val': 0.07115980596605787, 'psi': 0.9847075816502979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=75 head_norm_before_train=1.756257 cos_to_last_merge=1.0000 (last merge round=73)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.3762017789743891, 'auprc': 0.5917223421633664, 'loss_val': 1.9726167999392752, 'psi': 0.46241000424998}-{'f1_val': 0.7985209262105802, 'auprc': 0.9664012650611435, 'loss_val': 0.6174635764957999, 'psi': 0.8656730617508056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.826)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=75 metric=0.9961 head_norm=1.805317
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.007016e-03
[S11] stored merged vector for next round verification (round=75)
[S11] DEBUG after merge:  round=75 metric=0.9961 head_norm=1.803729 delta_norm=0.006007
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.049 → S14@127.0.0.1:41914
[S7] ⇄ pheromone p=0.149 → S4@127.0.0.1:41904
[S14] ⇄ pheromone p=0.015 → S11@127.0.0.1:41912
[S8] ⇄ pheromone p=0.002 → S3@127.0.0.1:41903
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] ⇄ pheromone p=0.292 → S17@127.0.0.1:41917
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=75 metric=0.3762 head_norm=1.764451
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.170239e-02
[S17] stored merged vector for next round verification (round=75)
[S17] DEBUG after merge:  round=75 metric=0.3756 head_norm=1.763267 delta_norm=0.011702
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.307 → S6@127.0.0.1:41907
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9997
[S4] ⇄ pheromone p=0.244 → S7@127.0.0.1:41908
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=75 metric=0.9974 head_norm=2.411426
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.885930e-02
[S3] stored merged vector for next round verification (round=75)
[S3] DEBUG after merge:  round=75 metric=0.9974 head_norm=2.407408 delta_norm=0.048859
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.129 → S8@127.0.0.1:41909
[S2] START round=76 head_norm_before_train=1.952907 cos_to_last_merge=0.9965 (last merge round=58)
[S2] round=76 local utility u=0.269078 metrics={'f1_val': 0.7944707696036337, 'auprc': 0.9922424749015815, 'loss_val': 0.43568425764539376, 'psi': 0.8735794517228128}-{'f1_val': 0.7121704874046533, 'auprc': 0.993390318583512, 'loss_val': 0.48348134067525994, 'psi': 0.8246584198761968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=76 head_norm_before_train=2.407408 cos_to_last_merge=1.0000 (last merge round=75)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9991097727440724, 'loss_val': 0.13200204005859253, 'psi': 0.9762650597608951}-{'f1_val': 0.9973696976584205, 'auprc': 0.9994762220859366, 'loss_val': 0.014915753348772263, 'psi': 0.9982123074294269}
[S4] START round=76 head_norm_before_train=1.872165 cos_to_last_merge=0.9999 (last merge round=72)
[S4] round=76 local utility u=0.083430 metrics={'f1_val': 0.9496005983623823, 'auprc': 0.9701709044678037, 'loss_val': 0.2986644101739763, 'psi': 0.9578287208045508}-{'f1_val': 0.9380422503064644, 'auprc': 0.9503531479970778, 'loss_val': 0.3367212514676596, 'psi': 0.9429666093827097}
[S5] START round=76 head_norm_before_train=2.286215 (no previous merge yet)
[S5] round=76 local utility u=0.010037 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9981759131449282, 'loss_val': 0.017981511843231365, 'psi': 0.9976877613143493}-{'f1_val': 0.997731766516735, 'auprc': 0.9997730902697707, 'loss_val': 0.04506316426651573, 'psi': 0.9985482960179493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=76 head_norm_before_train=1.762445 cos_to_last_merge=1.0000 (last merge round=74)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.5834952510253564, 'auprc': 0.8532436105377772, 'loss_val': 1.1408223178770407, 'psi': 0.6913945948303246}-{'f1_val': 0.763525878658033, 'auprc': 0.9207942087514424, 'loss_val': 0.49415675959289324, 'psi': 0.8264332106953968}
[S7] START round=76 head_norm_before_train=1.879472 cos_to_last_merge=0.9998 (last merge round=72)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.5125154651370536, 'auprc': 0.7200874097422687, 'loss_val': 1.5855485952218618, 'psi': 0.5955442429791395}-{'f1_val': 0.5490320360290524, 'auprc': 0.7722072482224869, 'loss_val': 1.1844533597416487, 'psi': 0.6383021209064261}
[S8] START round=76 head_norm_before_train=2.407606 cos_to_last_merge=1.0000 (last merge round=74)
[S8] round=76 local utility u=0.051063 metrics={'f1_val': 0.9974993535273301, 'auprc': 0.9976683713253376, 'loss_val': 0.0300634624103297, 'psi': 0.997566960646533}-{'f1_val': 0.996776381273096, 'auprc': 0.9979905255054676, 'loss_val': 0.12881742928001277, 'psi': 0.9972620389660447}
[S9] START round=76 head_norm_before_train=2.352057 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999659291909825, 'loss_val': 0.018083273729271092, 'psi': 0.9974824026949043}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999544645459081, 'loss_val': 0.016093546249231958, 'psi': 0.998243533325649}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.323926 cos_to_last_merge=0.9984 (last merge round=58)
[S10] round=76 local utility u=0.000112 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.99559058909207, 'loss_val': 0.026794349439122088, 'psi': 0.9951665700950647}-{'f1_val': 0.9946643883427498, 'auprc': 0.9959610266924952, 'loss_val': 0.02681320645716241, 'psi': 0.9951830436826479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=76 head_norm_before_train=1.803729 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=76 local utility u=0.000652 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976229075889137, 'loss_val': 0.026651455536517682, 'psi': 0.9965842657567139}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964620507945998, 'loss_val': 0.02592348562132392, 'psi': 0.9962650252658255}
[S13] START round=76 head_norm_before_train=1.907855 cos_to_last_merge=0.9972 (last merge round=57)
[S13] round=76 local utility u=0.173967 metrics={'f1_val': 0.6952458504469118, 'auprc': 0.7939323175872329, 'loss_val': 1.0830199871678343, 'psi': 0.7347204373030403}-{'f1_val': 0.6227219364205075, 'auprc': 0.7848754834689438, 'loss_val': 0.9686390969563526, 'psi': 0.687583355239882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=76 head_norm_before_train=1.803600 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9908924136155718, 'auprc': 0.9990428634856191, 'loss_val': 0.031974362558189064, 'psi': 0.9941525935635906}-{'f1_val': 0.997411628228889, 'auprc': 0.9990469320649012, 'loss_val': 0.018513079665113744, 'psi': 0.9980657497632939}
[S15] START round=76 head_norm_before_train=2.030653 cos_to_last_merge=0.9991 (last merge round=58)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9529713836814611, 'auprc': 0.996145744493689, 'loss_val': 0.06897255922200529, 'psi': 0.9702411280063523}-{'f1_val': 0.9963164379542544, 'auprc': 0.9962980972603925, 'loss_val': 0.02320907453517681, 'psi': 0.9963091016767096}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.077861 cos_to_last_merge=0.9672 (last merge round=45)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9911077136416808, 'auprc': 0.9919935683249977, 'loss_val': 0.038959695641751356, 'psi': 0.9914620555150075}-{'f1_val': 0.9917337388513483, 'auprc': 0.9921778137585282, 'loss_val': 0.03787705376898663, 'psi': 0.9919113688142203}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=1.763267 cos_to_last_merge=1.0000 (last merge round=75)
[S17] round=76 local utility u=1.000000 metrics={'f1_val': 0.8806653579130395, 'auprc': 0.9608635623407771, 'loss_val': 0.43097398530914743, 'psi': 0.9127446396841346}-{'f1_val': 0.3762017789743891, 'auprc': 0.5917223421633664, 'loss_val': 1.9726167999392752, 'psi': 0.46241000424998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.958)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=76 metric=0.5125 head_norm=1.885854
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.026789e-02
[S7] stored merged vector for next round verification (round=76)
[S7] DEBUG after merge:  round=76 metric=0.5121 head_norm=1.878778 delta_norm=0.030268
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1793) from S11
[S14] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=76 metric=0.9975 head_norm=2.412889
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.473868e-02
[S8] stored merged vector for next round verification (round=76)
[S8] DEBUG after merge:  round=76 metric=0.9975 head_norm=2.411907 delta_norm=0.034739
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=1.958293 cos_to_last_merge=0.9963 (last merge round=58)
[S2] round=77 local utility u=0.101412 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.9881915149844547, 'loss_val': 0.42108130197914473, 'psi': 0.8919965045359481}-{'f1_val': 0.7944707696036337, 'auprc': 0.9922424749015815, 'loss_val': 0.43568425764539376, 'psi': 0.8735794517228128}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=77 head_norm_before_train=2.414819 cos_to_last_merge=1.0000 (last merge round=75)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9451098986385719, 'auprc': 0.9879245055237433, 'loss_val': 0.1833669576588246, 'psi': 0.9622357413926405}-{'f1_val': 0.9610352511054436, 'auprc': 0.9991097727440724, 'loss_val': 0.13200204005859253, 'psi': 0.9762650597608951}
[S4] START round=77 head_norm_before_train=1.873369 cos_to_last_merge=0.9998 (last merge round=72)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9384790346729206, 'auprc': 0.9471320114253943, 'loss_val': 0.33964738046630233, 'psi': 0.94194022537391}-{'f1_val': 0.9496005983623823, 'auprc': 0.9701709044678037, 'loss_val': 0.2986644101739763, 'psi': 0.9578287208045508}
[S5] START round=77 head_norm_before_train=2.281863 (no previous merge yet)
[S5] round=77 local utility u=0.004463 metrics={'f1_val': 0.99736232676063, 'auprc': 0.999982216492107, 'loss_val': 0.0144748216621547, 'psi': 0.9984102826532208}-{'f1_val': 0.99736232676063, 'auprc': 0.9981759131449282, 'loss_val': 0.017981511843231365, 'psi': 0.9976877613143493}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=77 head_norm_before_train=1.773343 cos_to_last_merge=0.9999 (last merge round=74)
[S6] round=77 local utility u=0.857825 metrics={'f1_val': 0.7628352368814967, 'auprc': 0.9130134859030861, 'loss_val': 0.680522065885243, 'psi': 0.8229065364901325}-{'f1_val': 0.5834952510253564, 'auprc': 0.8532436105377772, 'loss_val': 1.1408223178770407, 'psi': 0.6913945948303246}
[S7] START round=77 head_norm_before_train=1.878778 cos_to_last_merge=1.0000 (last merge round=76)
[S7] round=77 local utility u=1.000000 metrics={'f1_val': 0.9269856226097812, 'auprc': 0.979572606777403, 'loss_val': 0.2922600181592996, 'psi': 0.9480204162768299}-{'f1_val': 0.5125154651370536, 'auprc': 0.7200874097422687, 'loss_val': 1.5855485952218618, 'psi': 0.5955442429791395}
[S8] START round=77 head_norm_before_train=2.411907 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9977858000947503, 'auprc': 0.9951274391324132, 'loss_val': 0.030901585679769757, 'psi': 0.9967224557098154}-{'f1_val': 0.9974993535273301, 'auprc': 0.9976683713253376, 'loss_val': 0.0300634624103297, 'psi': 0.997566960646533}
[S9] START round=77 head_norm_before_train=2.352042 (no previous merge yet)
[S9] round=77 local utility u=0.000543 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999673555038927, 'loss_val': 0.017001903057099137, 'psi': 0.9974829732200683}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999659291909825, 'loss_val': 0.018083273729271092, 'psi': 0.9974824026949043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=77 head_norm_before_train=2.329309 cos_to_last_merge=0.9984 (last merge round=58)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9958892913400745, 'loss_val': 0.026811759913953674, 'psi': 0.9951543495416797}-{'f1_val': 0.9948838907637279, 'auprc': 0.99559058909207, 'loss_val': 0.026794349439122088, 'psi': 0.9951665700950647}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=1.811426 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9942098865562964, 'auprc': 0.9965735077531584, 'loss_val': 0.035297391058550946, 'psi': 0.9951553350350412}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976229075889137, 'loss_val': 0.026651455536517682, 'psi': 0.9965842657567139}
[S13] START round=77 head_norm_before_train=1.911036 cos_to_last_merge=0.9970 (last merge round=57)
[S13] round=77 local utility u=0.148570 metrics={'f1_val': 0.7175090865475859, 'auprc': 0.7839917160347318, 'loss_val': 0.889637152873945, 'psi': 0.7441021383424443}-{'f1_val': 0.6952458504469118, 'auprc': 0.7939323175872329, 'loss_val': 1.0830199871678343, 'psi': 0.7347204373030403}
[S13] not sending this round → trigger blocked (psi=0.744)
[S14] START round=77 head_norm_before_train=1.807839 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.937810628583913, 'auprc': 0.9986081517575225, 'loss_val': 0.0794335628351389, 'psi': 0.9621296378533568}-{'f1_val': 0.9908924136155718, 'auprc': 0.9990428634856191, 'loss_val': 0.031974362558189064, 'psi': 0.9941525935635906}
[S15] START round=77 head_norm_before_train=2.035906 cos_to_last_merge=0.9990 (last merge round=58)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.7680111138990597, 'auprc': 0.9905802407228124, 'loss_val': 0.4293943247441627, 'psi': 0.8570387646285609}-{'f1_val': 0.9529713836814611, 'auprc': 0.996145744493689, 'loss_val': 0.06897255922200529, 'psi': 0.9702411280063523}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.084592 cos_to_last_merge=0.9666 (last merge round=45)
[S16] round=77 local utility u=0.002932 metrics={'f1_val': 0.9921691110173594, 'auprc': 0.9911568223765812, 'loss_val': 0.03695287992483122, 'psi': 0.9917641955610481}-{'f1_val': 0.9911077136416808, 'auprc': 0.9919935683249977, 'loss_val': 0.038959695641751356, 'psi': 0.9914620555150075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=77 head_norm_before_train=1.770006 cos_to_last_merge=1.0000 (last merge round=75)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6504382164355658, 'auprc': 0.8468751904906148, 'loss_val': 1.0910439282709719, 'psi': 0.7290130060575853}-{'f1_val': 0.8806653579130395, 'auprc': 0.9608635623407771, 'loss_val': 0.43097398530914743, 'psi': 0.9127446396841346}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=77 metric=0.9378 head_norm=1.813569
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.305502e-03
[S14] stored merged vector for next round verification (round=77)
[S14] DEBUG after merge:  round=77 metric=0.9378 head_norm=1.812474 delta_norm=0.009306
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=77 metric=0.9451 head_norm=2.420783
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.716788e-02
[S3] stored merged vector for next round verification (round=77)
[S3] DEBUG after merge:  round=77 metric=0.9451 head_norm=2.416778 delta_norm=0.017168
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9996
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=77 metric=0.7628 head_norm=1.782634
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.290704e-02
[S6] stored merged vector for next round verification (round=77)
[S6] DEBUG after merge:  round=77 metric=0.7638 head_norm=1.776284 delta_norm=0.012907
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=1.964009 cos_to_last_merge=0.9961 (last merge round=58)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7624137723489968, 'auprc': 0.9926399840330471, 'loss_val': 0.4468179577123773, 'psi': 0.8545042570226169}-{'f1_val': 0.8278664975702772, 'auprc': 0.9881915149844547, 'loss_val': 0.42108130197914473, 'psi': 0.8919965045359481}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.416778 cos_to_last_merge=1.0000 (last merge round=77)
[S3] round=78 local utility u=0.101882 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9993061432610604, 'loss_val': 0.10800950826469773, 'psi': 0.976214649165905}-{'f1_val': 0.9451098986385719, 'auprc': 0.9879245055237433, 'loss_val': 0.1833669576588246, 'psi': 0.9622357413926405}
[S4] START round=78 head_norm_before_train=1.874550 cos_to_last_merge=0.9997 (last merge round=72)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9298895992209512, 'auprc': 0.9462039290520349, 'loss_val': 0.39342489868152797, 'psi': 0.9364153311533846}-{'f1_val': 0.9384790346729206, 'auprc': 0.9471320114253943, 'loss_val': 0.33964738046630233, 'psi': 0.94194022537391}
[S5] START round=78 head_norm_before_train=2.284373 (no previous merge yet)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9973682702223946, 'auprc': 0.9998002677324656, 'loss_val': 0.04491012587555095, 'psi': 0.998341069226423}-{'f1_val': 0.99736232676063, 'auprc': 0.999982216492107, 'loss_val': 0.0144748216621547, 'psi': 0.9984102826532208}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.776284 cos_to_last_merge=1.0000 (last merge round=77)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.7394874405122532, 'auprc': 0.9258580020959356, 'loss_val': 0.7107732156706149, 'psi': 0.8140356651457261}-{'f1_val': 0.7628352368814967, 'auprc': 0.9130134859030861, 'loss_val': 0.680522065885243, 'psi': 0.8229065364901325}
[S7] START round=78 head_norm_before_train=1.883889 cos_to_last_merge=1.0000 (last merge round=76)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.8688677177710514, 'auprc': 0.9781453592660684, 'loss_val': 0.35751551645647195, 'psi': 0.9125787743690581}-{'f1_val': 0.9269856226097812, 'auprc': 0.979572606777403, 'loss_val': 0.2922600181592996, 'psi': 0.9480204162768299}
[S8] START round=78 head_norm_before_train=2.418430 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=78 local utility u=0.006510 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9968870581184776, 'loss_val': 0.01882170693231561, 'psi': 0.9969924877640004}-{'f1_val': 0.9977858000947503, 'auprc': 0.9951274391324132, 'loss_val': 0.030901585679769757, 'psi': 0.9967224557098154}
[S9] START round=78 head_norm_before_train=2.354192 (no previous merge yet)
[S9] round=78 local utility u=0.004494 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999664215591522, 'loss_val': 0.015478745976601394, 'psi': 0.998229416545281}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999673555038927, 'loss_val': 0.017001903057099137, 'psi': 0.9974829732200683}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=78 head_norm_before_train=2.334955 cos_to_last_merge=0.9983 (last merge round=58)
[S10] round=78 local utility u=0.000220 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9959999440726025, 'loss_val': 0.026704485757589925, 'psi': 0.9951986106346908}-{'f1_val': 0.9946643883427498, 'auprc': 0.9958892913400745, 'loss_val': 0.026811759913953674, 'psi': 0.9951543495416797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=78 head_norm_before_train=1.817736 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=78 local utility u=0.010169 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972263752378573, 'loss_val': 0.027009919774786405, 'psi': 0.9964256528162914}-{'f1_val': 0.9942098865562964, 'auprc': 0.9965735077531584, 'loss_val': 0.035297391058550946, 'psi': 0.9951553350350412}
[S13] START round=78 head_norm_before_train=1.913322 cos_to_last_merge=0.9968 (last merge round=57)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6257636786388066, 'auprc': 0.8013635283298283, 'loss_val': 0.9911710087431749, 'psi': 0.6960036185152152}-{'f1_val': 0.7175090865475859, 'auprc': 0.7839917160347318, 'loss_val': 0.889637152873945, 'psi': 0.7441021383424443}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.812474 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=78 local utility u=0.059277 metrics={'f1_val': 0.9547278834699489, 'auprc': 0.9985866549546326, 'loss_val': 0.06231766016630347, 'psi': 0.9722713920638224}-{'f1_val': 0.937810628583913, 'auprc': 0.9986081517575225, 'loss_val': 0.0794335628351389, 'psi': 0.9621296378533568}
[S15] START round=78 head_norm_before_train=2.041300 cos_to_last_merge=0.9989 (last merge round=58)
[S15] round=78 local utility u=0.895941 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.996675106255973, 'loss_val': 0.028209454913839024, 'psi': 0.9967180435349016}-{'f1_val': 0.7680111138990597, 'auprc': 0.9905802407228124, 'loss_val': 0.4293943247441627, 'psi': 0.8570387646285609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=78 head_norm_before_train=2.091466 cos_to_last_merge=0.9660 (last merge round=45)
[S16] round=78 local utility u=0.000466 metrics={'f1_val': 0.993346381326592, 'auprc': 0.9880080777830826, 'loss_val': 0.033638064899847886, 'psi': 0.9912110599091882}-{'f1_val': 0.9921691110173594, 'auprc': 0.9911568223765812, 'loss_val': 0.03695287992483122, 'psi': 0.9917641955610481}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=78 head_norm_before_train=1.775432 cos_to_last_merge=1.0000 (last merge round=75)
[S17] round=78 local utility u=1.000000 metrics={'f1_val': 0.8839002105531004, 'auprc': 0.9996679324060629, 'loss_val': 0.4001818205351437, 'psi': 0.9302072992942854}-{'f1_val': 0.6504382164355658, 'auprc': 0.8468751904906148, 'loss_val': 1.0910439282709719, 'psi': 0.7290130060575853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=78 metric=0.9299 head_norm=1.874766
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.863105e-02
[S4] stored merged vector for next round verification (round=78)
[S4] DEBUG after merge:  round=78 metric=0.9299 head_norm=1.879115 delta_norm=0.028631
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=1.0000
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=78 metric=0.9959 head_norm=1.824973
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.674713e-03
[S11] stored merged vector for next round verification (round=78)
[S11] DEBUG after merge:  round=78 metric=0.9959 head_norm=1.821465 delta_norm=0.009675
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=78 metric=0.9971 head_norm=2.425679
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.092767e-02
[S8] stored merged vector for next round verification (round=78)
[S8] DEBUG after merge:  round=78 metric=0.9971 head_norm=2.423977 delta_norm=0.010928
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=78 metric=0.9547 head_norm=1.818003
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.674705e-03
[S14] stored merged vector for next round verification (round=78)
[S14] DEBUG after merge:  round=78 metric=0.9552 head_norm=1.821465 delta_norm=0.009675
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=78 metric=0.8839 head_norm=1.780110
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.436437e-02
[S17] stored merged vector for next round verification (round=78)
[S17] DEBUG after merge:  round=78 metric=0.8839 head_norm=1.781315 delta_norm=0.014364
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=78 metric=0.9608 head_norm=2.422323
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.092767e-02
[S3] stored merged vector for next round verification (round=78)
[S3] DEBUG after merge:  round=78 metric=0.9608 head_norm=2.423977 delta_norm=0.010928
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=1.970958 cos_to_last_merge=0.9959 (last merge round=58)
[S2] round=79 local utility u=0.153538 metrics={'f1_val': 0.8125292629534465, 'auprc': 0.9925018318875982, 'loss_val': 0.44002052402676384, 'psi': 0.8845182905271072}-{'f1_val': 0.7624137723489968, 'auprc': 0.9926399840330471, 'loss_val': 0.4468179577123773, 'psi': 0.8545042570226169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S2] r=80 psi=0.885 u=0.1535 p_local=0.0986 f1=0.813 auprc=0.993 bytes=61197
[S3] START round=79 head_norm_before_train=2.423977 cos_to_last_merge=1.0000 (last merge round=78)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.8099814156086378, 'auprc': 0.8955408794057471, 'loss_val': 0.48660319034937893, 'psi': 0.8442052011274815}-{'f1_val': 0.9608203197691346, 'auprc': 0.9993061432610604, 'loss_val': 0.10800950826469773, 'psi': 0.976214649165905}
[S4] START round=79 head_norm_before_train=1.879115 cos_to_last_merge=1.0000 (last merge round=78)
[S4] round=79 local utility u=0.124452 metrics={'f1_val': 0.9426664626407409, 'auprc': 0.9754145453648082, 'loss_val': 0.3088141748098535, 'psi': 0.9557656957303678}-{'f1_val': 0.9298895992209512, 'auprc': 0.9462039290520349, 'loss_val': 0.39342489868152797, 'psi': 0.9364153311533846}
[S5] START round=79 head_norm_before_train=2.291201 (no previous merge yet)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9932873235769094, 'auprc': 0.9932999177259483, 'loss_val': 0.02929716238987341, 'psi': 0.993292361236525}-{'f1_val': 0.9973682702223946, 'auprc': 0.9998002677324656, 'loss_val': 0.04491012587555095, 'psi': 0.998341069226423}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.993 u=0.0000 p_local=0.0024 f1=0.993 auprc=0.993 bytes=61100
[S6] START round=79 head_norm_before_train=1.787233 cos_to_last_merge=1.0000 (last merge round=77)
[S6] round=79 local utility u=0.111904 metrics={'f1_val': 0.754988009054969, 'auprc': 0.9181312444363605, 'loss_val': 0.5567874740402606, 'psi': 0.8202453032075256}-{'f1_val': 0.7394874405122532, 'auprc': 0.9258580020959356, 'loss_val': 0.7107732156706149, 'psi': 0.8140356651457261}
[S7] START round=79 head_norm_before_train=1.887696 cos_to_last_merge=0.9999 (last merge round=76)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.5028739546702753, 'auprc': 0.7343561899828075, 'loss_val': 1.6507311106175198, 'psi': 0.5954668487952882}-{'f1_val': 0.8688677177710514, 'auprc': 0.9781453592660684, 'loss_val': 0.35751551645647195, 'psi': 0.9125787743690581}
[S8] START round=79 head_norm_before_train=2.423977 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9984144194779562, 'loss_val': 0.037303215655666126, 'psi': 0.9976034323077918}-{'f1_val': 0.997062774194349, 'auprc': 0.9968870581184776, 'loss_val': 0.01882170693231561, 'psi': 0.9969924877640004}
[S9] START round=79 head_norm_before_train=2.357176 (no previous merge yet)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999668251878051, 'loss_val': 0.015794472065708394, 'psi': 0.9982295779967422}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999664215591522, 'loss_val': 0.015478745976601394, 'psi': 0.998229416545281}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.998 u=0.0000 p_local=0.0043 f1=0.997 auprc=1.000 bytes=64674
[S10] START round=79 head_norm_before_train=2.337318 cos_to_last_merge=0.9981 (last merge round=58)
[S10] round=79 local utility u=0.000629 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9964264438626866, 'loss_val': 0.02672665452707184, 'psi': 0.9953692105507246}-{'f1_val': 0.9946643883427498, 'auprc': 0.9959999440726025, 'loss_val': 0.026704485757589925, 'psi': 0.9951986106346908}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] r=80 psi=0.995 u=0.0006 p_local=0.0004 f1=0.995 auprc=0.996 bytes=70123
[S11] START round=79 head_norm_before_train=1.821465 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=79 local utility u=0.000624 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964155322462882, 'loss_val': 0.024781188469151425, 'psi': 0.9962464178465009}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972263752378573, 'loss_val': 0.027009919774786405, 'psi': 0.9964256528162914}
[S13] START round=79 head_norm_before_train=1.917341 cos_to_last_merge=0.9966 (last merge round=57)
[S13] round=79 local utility u=0.133111 metrics={'f1_val': 0.643027852677662, 'auprc': 0.8048830960226442, 'loss_val': 0.8390934837051269, 'psi': 0.7077699500156549}-{'f1_val': 0.6257636786388066, 'auprc': 0.8013635283298283, 'loss_val': 0.9911710087431749, 'psi': 0.6960036185152152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=80 psi=0.708 u=0.1331 p_local=0.1101 f1=0.643 auprc=0.805 bytes=62974
[S14] START round=79 head_norm_before_train=1.821465 cos_to_last_merge=1.0000 (last merge round=78)
[S14] round=79 local utility u=0.107547 metrics={'f1_val': 0.9864606475879821, 'auprc': 0.9986049718610346, 'loss_val': 0.0376744057743093, 'psi': 0.9913183772972031}-{'f1_val': 0.9547278834699489, 'auprc': 0.9985866549546326, 'loss_val': 0.06231766016630347, 'psi': 0.9722713920638224}
[S15] START round=79 head_norm_before_train=2.047365 cos_to_last_merge=0.9988 (last merge round=58)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.9691524007464095, 'auprc': 0.9959966773954045, 'loss_val': 0.055903506024928155, 'psi': 0.9798901114060076}-{'f1_val': 0.9967466683875206, 'auprc': 0.996675106255973, 'loss_val': 0.028209454913839024, 'psi': 0.9967180435349016}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.980 u=0.0000 p_local=0.2680 f1=0.969 auprc=0.996 bytes=61207
[S16] START round=79 head_norm_before_train=2.095401 cos_to_last_merge=0.9655 (last merge round=45)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.993395946697719, 'auprc': 0.988112140890126, 'loss_val': 0.03533939691124052, 'psi': 0.9912824243746818}-{'f1_val': 0.993346381326592, 'auprc': 0.9880080777830826, 'loss_val': 0.033638064899847886, 'psi': 0.9912110599091882}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.991 u=0.0000 p_local=0.0132 f1=0.993 auprc=0.988 bytes=70149
[S17] START round=79 head_norm_before_train=1.781315 cos_to_last_merge=1.0000 (last merge round=78)
[S17] round=79 local utility u=0.029916 metrics={'f1_val': 0.9007175597910899, 'auprc': 0.9815198477605387, 'loss_val': 0.3868093344895039, 'psi': 0.9330384749788694}-{'f1_val': 0.8839002105531004, 'auprc': 0.9996679324060629, 'loss_val': 0.4001818205351437, 'psi': 0.9302072992942854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[S11] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.991)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.933)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.998 u=0.0000 p_local=0.0070 f1=0.997 auprc=0.998 bytes=68325
[S17] r=80 psi=0.933 u=0.0299 p_local=0.3942 f1=0.901 auprc=0.982 bytes=62975
[S7] r=80 psi=0.595 u=0.0000 p_local=0.1891 f1=0.503 auprc=0.734 bytes=61168
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] r=80 psi=0.991 u=0.1075 p_local=0.0370 f1=0.986 auprc=0.999 bytes=68309
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] r=80 psi=0.996 u=0.0006 p_local=0.0220 f1=0.996 auprc=0.996 bytes=71882
[S3] r=80 psi=0.844 u=0.0000 p_local=0.0693 f1=0.810 auprc=0.896 bytes=59340
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9996
[S4] r=80 psi=0.956 u=0.1245 p_local=0.1332 f1=0.943 auprc=0.975 bytes=61167
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=79 metric=0.7550 head_norm=1.795303
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.935100e-02
[S6] stored merged vector for next round verification (round=79)
[S6] DEBUG after merge:  round=79 metric=0.7560 head_norm=1.787618 delta_norm=0.019351
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] r=80 psi=0.820 u=0.1119 p_local=0.2519 f1=0.755 auprc=0.918 bytes=59421
[S2] START round=80 head_norm_before_train=1.977775 cos_to_last_merge=0.9957 (last merge round=58)
[S2] round=80 local utility u=0.043989 metrics={'f1_val': 0.8270806092238246, 'auprc': 0.9924894001802409, 'loss_val': 0.43931378699168877, 'psi': 0.8932441256063911}-{'f1_val': 0.8125292629534465, 'auprc': 0.9925018318875982, 'loss_val': 0.44002052402676384, 'psi': 0.8845182905271072}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=80 head_norm_before_train=2.429299 cos_to_last_merge=1.0000 (last merge round=78)
[S3] round=80 local utility u=0.888906 metrics={'f1_val': 0.9827096101772357, 'auprc': 0.9988140437305706, 'loss_val': 0.05497993522360559, 'psi': 0.9891513835985697}-{'f1_val': 0.8099814156086378, 'auprc': 0.8955408794057471, 'loss_val': 0.48660319034937893, 'psi': 0.8442052011274815}
[S4] START round=80 head_norm_before_train=1.873100 cos_to_last_merge=0.9999 (last merge round=78)
[S4] round=80 local utility u=0.008880 metrics={'f1_val': 0.9447293898907274, 'auprc': 0.9756687427796271, 'loss_val': 0.30419364945710187, 'psi': 0.9571051310462872}-{'f1_val': 0.9426664626407409, 'auprc': 0.9754145453648082, 'loss_val': 0.3088141748098535, 'psi': 0.9557656957303678}
[S5] START round=80 head_norm_before_train=2.294372 (no previous merge yet)
[S5] round=80 local utility u=0.029904 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9998874760438103, 'loss_val': 0.013702512181638262, 'psi': 0.9983723864739021}-{'f1_val': 0.9932873235769094, 'auprc': 0.9932999177259483, 'loss_val': 0.02929716238987341, 'psi': 0.993292361236525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=80 head_norm_before_train=1.787618 cos_to_last_merge=1.0000 (last merge round=79)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6069441597370572, 'auprc': 0.8454515469819309, 'loss_val': 0.9998653844513924, 'psi': 0.7023471146350067}-{'f1_val': 0.754988009054969, 'auprc': 0.9181312444363605, 'loss_val': 0.5567874740402606, 'psi': 0.8202453032075256}
[S7] START round=80 head_norm_before_train=1.889833 cos_to_last_merge=0.9999 (last merge round=76)
[S7] round=80 local utility u=1.000000 metrics={'f1_val': 0.8565180303112669, 'auprc': 0.958196185275159, 'loss_val': 0.43678335006275537, 'psi': 0.8971892922968238}-{'f1_val': 0.5028739546702753, 'auprc': 0.7343561899828075, 'loss_val': 1.6507311106175198, 'psi': 0.5954668487952882}
[S8] START round=80 head_norm_before_train=2.431135 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=80 local utility u=0.008860 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9987602474543975, 'loss_val': 0.01890216061516012, 'psi': 0.9975699277456167}-{'f1_val': 0.997062774194349, 'auprc': 0.9984144194779562, 'loss_val': 0.037303215655666126, 'psi': 0.9976034323077918}
[S9] START round=80 head_norm_before_train=2.358273 (no previous merge yet)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999672298448113, 'loss_val': 0.017698307291053338, 'psi': 0.9974829229564358}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999668251878051, 'loss_val': 0.015794472065708394, 'psi': 0.9982295779967422}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.338788 cos_to_last_merge=0.9979 (last merge round=58)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9960945724286234, 'loss_val': 0.02661720298339609, 'psi': 0.9952364619770993}-{'f1_val': 0.9946643883427498, 'auprc': 0.9964264438626866, 'loss_val': 0.02672665452707184, 'psi': 0.9953692105507246}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.828718 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=80 local utility u=0.000687 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964519498071881, 'loss_val': 0.023516900613642047, 'psi': 0.9962609848708608}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964155322462882, 'loss_val': 0.024781188469151425, 'psi': 0.9962464178465009}
[S13] START round=80 head_norm_before_train=1.920469 cos_to_last_merge=0.9964 (last merge round=57)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6558518649974516, 'auprc': 0.7965150029422983, 'loss_val': 1.1073046460285676, 'psi': 0.7121171201753903}-{'f1_val': 0.643027852677662, 'auprc': 0.8048830960226442, 'loss_val': 0.8390934837051269, 'psi': 0.7077699500156549}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.826707 cos_to_last_merge=1.0000 (last merge round=78)
[S14] round=80 local utility u=0.043846 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9986239754459137, 'loss_val': 0.018075612702279684, 'psi': 0.998129524444233}-{'f1_val': 0.9864606475879821, 'auprc': 0.9986049718610346, 'loss_val': 0.0376744057743093, 'psi': 0.9913183772972031}
[S15] START round=80 head_norm_before_train=2.053610 cos_to_last_merge=0.9987 (last merge round=58)
[S15] round=80 local utility u=0.015166 metrics={'f1_val': 0.9731769682069284, 'auprc': 0.9964215054769664, 'loss_val': 0.05099405522968368, 'psi': 0.9824747831149436}-{'f1_val': 0.9691524007464095, 'auprc': 0.9959966773954045, 'loss_val': 0.055903506024928155, 'psi': 0.9798901114060076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=80 head_norm_before_train=2.099273 cos_to_last_merge=0.9651 (last merge round=45)
[S16] round=80 local utility u=0.001821 metrics={'f1_val': 0.993395946697719, 'auprc': 0.9891230335579901, 'loss_val': 0.034729754337241854, 'psi': 0.9916867814418275}-{'f1_val': 0.993395946697719, 'auprc': 0.988112140890126, 'loss_val': 0.03533939691124052, 'psi': 0.9912824243746818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=80 head_norm_before_train=1.787444 cos_to_last_merge=1.0000 (last merge round=78)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.6469806929241587, 'auprc': 0.888350892167555, 'loss_val': 1.0520212185324997, 'psi': 0.7435287726215172}-{'f1_val': 0.9007175597910899, 'auprc': 0.9815198477605387, 'loss_val': 0.3868093344895039, 'psi': 0.9330384749788694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.957)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=80 metric=0.6470 head_norm=1.795875
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.647297e-02
[S17] stored merged vector for next round verification (round=80)
[S17] DEBUG after merge:  round=80 metric=0.6464 head_norm=1.795514 delta_norm=0.016473
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.315 → S6@127.0.0.1:41907
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S4] ⇄ pheromone p=0.108 → S7@127.0.0.1:41908
[S6] ⇄ pheromone p=0.201 → S17@127.0.0.1:41917
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=80 metric=0.9968 head_norm=2.438185
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.511267e-02
[S8] stored merged vector for next round verification (round=80)
[S8] DEBUG after merge:  round=80 metric=0.9968 head_norm=2.435211 delta_norm=0.015113
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.007 → S3@127.0.0.1:41903
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=80 metric=0.9978 head_norm=1.830271
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.369415e-03
[S14] stored merged vector for next round verification (round=80)
[S14] DEBUG after merge:  round=80 metric=0.9978 head_norm=1.833205 delta_norm=0.008369
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.038 → S11@127.0.0.1:41912
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=80 metric=0.8565 head_norm=1.892254
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.857537e-02
[S7] stored merged vector for next round verification (round=80)
[S7] DEBUG after merge:  round=80 metric=0.8529 head_norm=1.882485 delta_norm=0.028575
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.351 → S4@127.0.0.1:41904
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=80 metric=0.9827 head_norm=2.432328
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.511269e-02
[S3] stored merged vector for next round verification (round=80)
[S3] DEBUG after merge:  round=80 metric=0.9833 head_norm=2.435211 delta_norm=0.015113
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.233 → S8@127.0.0.1:41909
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=80 metric=0.9961 head_norm=1.836172
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.369413e-03
[S11] stored merged vector for next round verification (round=80)
[S11] DEBUG after merge:  round=80 metric=0.9961 head_norm=1.833205 delta_norm=0.008369
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.018 → S14@127.0.0.1:41914
[S2] START round=81 head_norm_before_train=1.983105 cos_to_last_merge=0.9954 (last merge round=58)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.8276742393524328, 'auprc': 0.9863684701968274, 'loss_val': 0.43467879299726775, 'psi': 0.8911519316901906}-{'f1_val': 0.8270806092238246, 'auprc': 0.9924894001802409, 'loss_val': 0.43931378699168877, 'psi': 0.8932441256063911}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.435211 cos_to_last_merge=1.0000 (last merge round=80)
[S3] round=81 local utility u=0.030830 metrics={'f1_val': 0.9895898344477236, 'auprc': 0.9992576444867189, 'loss_val': 0.0359311706622394, 'psi': 0.9934569584633218}-{'f1_val': 0.9827096101772357, 'auprc': 0.9988140437305706, 'loss_val': 0.05497993522360559, 'psi': 0.9891513835985697}
[S4] START round=81 head_norm_before_train=1.874064 cos_to_last_merge=0.9999 (last merge round=78)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.7734654522378669, 'auprc': 0.9141799274341529, 'loss_val': 0.5210333684394828, 'psi': 0.8297512423163813}-{'f1_val': 0.9447293898907274, 'auprc': 0.9756687427796271, 'loss_val': 0.30419364945710187, 'psi': 0.9571051310462872}
[S5] START round=81 head_norm_before_train=2.297297 (no previous merge yet)
[S5] round=81 local utility u=0.001224 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9999834553579472, 'loss_val': 0.01374454241264057, 'psi': 0.9986309937445136}-{'f1_val': 0.99736232676063, 'auprc': 0.9998874760438103, 'loss_val': 0.013702512181638262, 'psi': 0.9983723864739021}
[S5] not sending this round → trigger blocked (psi=0.999)
[S6] START round=81 head_norm_before_train=1.799536 cos_to_last_merge=1.0000 (last merge round=79)
[S6] round=81 local utility u=0.162161 metrics={'f1_val': 0.644813285532577, 'auprc': 0.83731136234198, 'loss_val': 0.8783371986342173, 'psi': 0.7218125162563382}-{'f1_val': 0.6069441597370572, 'auprc': 0.8454515469819309, 'loss_val': 0.9998653844513924, 'psi': 0.7023471146350067}
[S7] START round=81 head_norm_before_train=1.882485 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.8350841829251059, 'auprc': 0.94753318238041, 'loss_val': 0.4871075204751745, 'psi': 0.8800637827072275}-{'f1_val': 0.8565180303112669, 'auprc': 0.958196185275159, 'loss_val': 0.43678335006275537, 'psi': 0.8971892922968238}
[S8] START round=81 head_norm_before_train=2.435211 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9988920157356157, 'loss_val': 0.019383182931339147, 'psi': 0.9976226350581039}-{'f1_val': 0.996776381273096, 'auprc': 0.9987602474543975, 'loss_val': 0.01890216061516012, 'psi': 0.9975699277456167}
[S9] START round=81 head_norm_before_train=2.363495 (no previous merge yet)
[S9] round=81 local utility u=0.004562 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999577641066436, 'loss_val': 0.016202680317659687, 'psi': 0.9982448531499432}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999672298448113, 'loss_val': 0.017698307291053338, 'psi': 0.9974829229564358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=81 head_norm_before_train=2.342267 cos_to_last_merge=0.9977 (last merge round=58)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9950343672249576, 'loss_val': 0.02655111576193405, 'psi': 0.9949440813482198}-{'f1_val': 0.9946643883427498, 'auprc': 0.9960945724286234, 'loss_val': 0.02661720298339609, 'psi': 0.9952364619770993}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.833205 cos_to_last_merge=1.0000 (last merge round=80)
[S11] round=81 local utility u=0.003072 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975871390827377, 'loss_val': 0.023259404440473128, 'psi': 0.9969630583412488}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964519498071881, 'loss_val': 0.023516900613642047, 'psi': 0.9962609848708608}
[S13] START round=81 head_norm_before_train=1.923562 cos_to_last_merge=0.9962 (last merge round=57)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6201498014756344, 'auprc': 0.7933660495940857, 'loss_val': 1.070270888069018, 'psi': 0.6894363007230149}-{'f1_val': 0.6558518649974516, 'auprc': 0.7965150029422983, 'loss_val': 1.1073046460285676, 'psi': 0.7121171201753903}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.833205 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=81 local utility u=0.000377 metrics={'f1_val': 0.9978223933154866, 'auprc': 0.9990448739010438, 'loss_val': 0.018719897047636134, 'psi': 0.9983113855497094}-{'f1_val': 0.9977998904431125, 'auprc': 0.9986239754459137, 'loss_val': 0.018075612702279684, 'psi': 0.998129524444233}
[S15] START round=81 head_norm_before_train=2.059942 cos_to_last_merge=0.9985 (last merge round=58)
[S15] round=81 local utility u=0.085213 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972237753423665, 'loss_val': 0.024393027840542213, 'psi': 0.996937511169459}-{'f1_val': 0.9731769682069284, 'auprc': 0.9964215054769664, 'loss_val': 0.05099405522968368, 'psi': 0.9824747831149436}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=81 head_norm_before_train=2.104789 cos_to_last_merge=0.9647 (last merge round=45)
[S16] round=81 local utility u=0.001325 metrics={'f1_val': 0.9936162002120097, 'auprc': 0.9890652012582621, 'loss_val': 0.03322695850614886, 'psi': 0.9917958006305108}-{'f1_val': 0.993395946697719, 'auprc': 0.9891230335579901, 'loss_val': 0.034729754337241854, 'psi': 0.9916867814418275}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=81 head_norm_before_train=1.795514 cos_to_last_merge=1.0000 (last merge round=80)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.5260810269184315, 'auprc': 0.8550929804936829, 'loss_val': 1.59126007264809, 'psi': 0.6576858083485321}-{'f1_val': 0.6469806929241587, 'auprc': 0.888350892167555, 'loss_val': 1.0520212185324997, 'psi': 0.7435287726215172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.993)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=81 metric=0.7735 head_norm=1.878839
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.957685e-02
[S4] stored merged vector for next round verification (round=81)
[S4] DEBUG after merge:  round=81 metric=0.7715 head_norm=1.885326 delta_norm=0.029577
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.9999
[S2] START round=82 head_norm_before_train=1.989848 cos_to_last_merge=0.9952 (last merge round=58)
[S2] round=82 local utility u=0.007412 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.9889433836390151, 'loss_val': 0.42873238827691895, 'psi': 0.8922972519977723}-{'f1_val': 0.8276742393524328, 'auprc': 0.9863684701968274, 'loss_val': 0.43467879299726775, 'psi': 0.8911519316901906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=82 head_norm_before_train=2.439802 cos_to_last_merge=1.0000 (last merge round=80)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9353108894608357, 'auprc': 0.9964418042247779, 'loss_val': 0.1695911962106656, 'psi': 0.9597632553664126}-{'f1_val': 0.9895898344477236, 'auprc': 0.9992576444867189, 'loss_val': 0.0359311706622394, 'psi': 0.9934569584633218}
[S4] START round=82 head_norm_before_train=1.885326 cos_to_last_merge=1.0000 (last merge round=81)
[S4] round=82 local utility u=0.632564 metrics={'f1_val': 0.9378478324036712, 'auprc': 0.9489546339777025, 'loss_val': 0.34652280457284945, 'psi': 0.9422905530332837}-{'f1_val': 0.7734654522378669, 'auprc': 0.9141799274341529, 'loss_val': 0.5210333684394828, 'psi': 0.8297512423163813}
[S5] START round=82 head_norm_before_train=2.299614 (no previous merge yet)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9986071688654887, 'loss_val': 0.01479688478211575, 'psi': 0.9978602636025735}-{'f1_val': 0.9977293526688911, 'auprc': 0.9999834553579472, 'loss_val': 0.01374454241264057, 'psi': 0.9986309937445136}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.810311 cos_to_last_merge=0.9999 (last merge round=79)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.5985234018978335, 'auprc': 0.9255152476666164, 'loss_val': 1.104885424605233, 'psi': 0.7293201402053466}-{'f1_val': 0.644813285532577, 'auprc': 0.83731136234198, 'loss_val': 0.8783371986342173, 'psi': 0.7218125162563382}
[S7] START round=82 head_norm_before_train=1.887086 cos_to_last_merge=1.0000 (last merge round=80)
[S7] round=82 local utility u=0.080731 metrics={'f1_val': 0.86035544191589, 'auprc': 0.952001785264024, 'loss_val': 0.49067891220151927, 'psi': 0.8970139792551435}-{'f1_val': 0.8350841829251059, 'auprc': 0.94753318238041, 'loss_val': 0.4871075204751745, 'psi': 0.8800637827072275}
[S8] START round=82 head_norm_before_train=2.440474 cos_to_last_merge=1.0000 (last merge round=80)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.995954631055922, 'auprc': 0.998869178575303, 'loss_val': 0.024141083752543542, 'psi': 0.9971204500636743}-{'f1_val': 0.996776381273096, 'auprc': 0.9988920157356157, 'loss_val': 0.019383182931339147, 'psi': 0.9976226350581039}
[S9] START round=82 head_norm_before_train=2.371939 (no previous merge yet)
[S9] round=82 local utility u=0.000248 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999644272598283, 'loss_val': 0.015537202368951388, 'psi': 0.9982286188255514}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999577641066436, 'loss_val': 0.016202680317659687, 'psi': 0.9982448531499432}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=82 head_norm_before_train=2.346750 cos_to_last_merge=0.9976 (last merge round=58)
[S10] round=82 local utility u=0.000163 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9951496449321017, 'loss_val': 0.026570920718563918, 'psi': 0.9949901924310774}-{'f1_val': 0.9948838907637279, 'auprc': 0.9950343672249576, 'loss_val': 0.02655111576193405, 'psi': 0.9949440813482198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=82 head_norm_before_train=1.840275 cos_to_last_merge=1.0000 (last merge round=80)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9930161638237394, 'auprc': 0.996558762821376, 'loss_val': 0.032671925743596585, 'psi': 0.9944332034227941}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975871390827377, 'loss_val': 0.023259404440473128, 'psi': 0.9969630583412488}
[S13] START round=82 head_norm_before_train=1.929292 cos_to_last_merge=0.9958 (last merge round=57)
[S13] round=82 local utility u=0.141214 metrics={'f1_val': 0.655991581126423, 'auprc': 0.7906761759649594, 'loss_val': 0.9948236114917045, 'psi': 0.7098654190618375}-{'f1_val': 0.6201498014756344, 'auprc': 0.7933660495940857, 'loss_val': 1.070270888069018, 'psi': 0.6894363007230149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=82 head_norm_before_train=1.837473 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9971893422213808, 'auprc': 0.9986280446603892, 'loss_val': 0.02850973208121861, 'psi': 0.9977648231969841}-{'f1_val': 0.9978223933154866, 'auprc': 0.9990448739010438, 'loss_val': 0.018719897047636134, 'psi': 0.9983113855497094}
[S15] START round=82 head_norm_before_train=2.066059 cos_to_last_merge=0.9984 (last merge round=58)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.7216485589190276, 'auprc': 0.9900936437704453, 'loss_val': 0.49863799116210583, 'psi': 0.8290265928595947}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972237753423665, 'loss_val': 0.024393027840542213, 'psi': 0.996937511169459}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.111026 cos_to_last_merge=0.9642 (last merge round=45)
[S16] round=82 local utility u=0.000424 metrics={'f1_val': 0.9937621241130705, 'auprc': 0.9886376704798248, 'loss_val': 0.03197130957808123, 'psi': 0.9917123426597723}-{'f1_val': 0.9936162002120097, 'auprc': 0.9890652012582621, 'loss_val': 0.03322695850614886, 'psi': 0.9917958006305108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=82 head_norm_before_train=1.804796 cos_to_last_merge=1.0000 (last merge round=80)
[S17] round=82 local utility u=0.962465 metrics={'f1_val': 0.6993779342138581, 'auprc': 0.9467990477441195, 'loss_val': 0.9812294408819453, 'psi': 0.7983463796259627}-{'f1_val': 0.5260810269184315, 'auprc': 0.8550929804936829, 'loss_val': 1.59126007264809, 'psi': 0.6576858083485321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:41907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:41908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1805) from S7
[S4] cosine check vs S7: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1805) from S4
[S7] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=82 metric=0.9378 head_norm=1.892622
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.963526e-02
[S4] stored merged vector for next round verification (round=82)
[S4] DEBUG after merge:  round=82 metric=0.9383 head_norm=1.896825 delta_norm=0.019635
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=82 metric=0.6994 head_norm=1.813265
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.424929e-02
[S17] stored merged vector for next round verification (round=82)
[S17] DEBUG after merge:  round=82 metric=0.6985 head_norm=1.811733 delta_norm=0.014249
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=82 metric=0.8604 head_norm=1.901223
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.963526e-02
[S7] stored merged vector for next round verification (round=82)
[S7] DEBUG after merge:  round=82 metric=0.8624 head_norm=1.896825 delta_norm=0.019635
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=1.996278 cos_to_last_merge=0.9949 (last merge round=58)
[S2] round=83 local utility u=0.003376 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.990415417426347, 'loss_val': 0.42639709856839053, 'psi': 0.8928860655127051}-{'f1_val': 0.8278664975702772, 'auprc': 0.9889433836390151, 'loss_val': 0.42873238827691895, 'psi': 0.8922972519977723}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=83 head_norm_before_train=2.446856 cos_to_last_merge=1.0000 (last merge round=80)
[S3] round=83 local utility u=0.225828 metrics={'f1_val': 0.9873865051679755, 'auprc': 0.9985872560575806, 'loss_val': 0.03682480908913607, 'psi': 0.9918668055238176}-{'f1_val': 0.9353108894608357, 'auprc': 0.9964418042247779, 'loss_val': 0.1695911962106656, 'psi': 0.9597632553664126}
[S4] START round=83 head_norm_before_train=1.896825 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=83 local utility u=0.036309 metrics={'f1_val': 0.9388550128728114, 'auprc': 0.963735067749987, 'loss_val': 0.32428823173008137, 'psi': 0.9488070348236816}-{'f1_val': 0.9378478324036712, 'auprc': 0.9489546339777025, 'loss_val': 0.34652280457284945, 'psi': 0.9422905530332837}
[S5] START round=83 head_norm_before_train=2.302157 (no previous merge yet)
[S5] round=83 local utility u=0.003295 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.999981798843856, 'loss_val': 0.01453214075418295, 'psi': 0.9986303311388771}-{'f1_val': 0.99736232676063, 'auprc': 0.9986071688654887, 'loss_val': 0.01479688478211575, 'psi': 0.9978602636025735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=83 head_norm_before_train=1.822260 cos_to_last_merge=0.9999 (last merge round=79)
[S6] round=83 local utility u=1.000000 metrics={'f1_val': 0.8405320635642962, 'auprc': 0.9293444185403456, 'loss_val': 0.5078979949291935, 'psi': 0.8760570055547159}-{'f1_val': 0.5985234018978335, 'auprc': 0.9255152476666164, 'loss_val': 1.104885424605233, 'psi': 0.7293201402053466}
[S7] START round=83 head_norm_before_train=1.896825 cos_to_last_merge=1.0000 (last merge round=82)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.7154899679785958, 'auprc': 0.8329157002786488, 'loss_val': 0.896936736279314, 'psi': 0.7624602608986171}-{'f1_val': 0.86035544191589, 'auprc': 0.952001785264024, 'loss_val': 0.49067891220151927, 'psi': 0.8970139792551435}
[S8] START round=83 head_norm_before_train=2.445814 cos_to_last_merge=0.9999 (last merge round=80)
[S8] round=83 local utility u=0.000977 metrics={'f1_val': 0.995954631055922, 'auprc': 0.9983146640249763, 'loss_val': 0.020523793498931416, 'psi': 0.9968986442435437}-{'f1_val': 0.995954631055922, 'auprc': 0.998869178575303, 'loss_val': 0.024141083752543542, 'psi': 0.9971204500636743}
[S9] START round=83 head_norm_before_train=2.370023 (no previous merge yet)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999668251878051, 'loss_val': 0.01564801102908912, 'psi': 0.9982295779967422}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999644272598283, 'loss_val': 0.015537202368951388, 'psi': 0.9982286188255514}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.351775 cos_to_last_merge=0.9975 (last merge round=58)
[S10] round=83 local utility u=0.000523 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9959198322820773, 'loss_val': 0.026518530789425218, 'psi': 0.9951665659184807}-{'f1_val': 0.9948838907637279, 'auprc': 0.9951496449321017, 'loss_val': 0.026570920718563918, 'psi': 0.9949901924310774}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=83 head_norm_before_train=1.846888 cos_to_last_merge=1.0000 (last merge round=80)
[S11] round=83 local utility u=0.013741 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964577074129732, 'loss_val': 0.02359187447634295, 'psi': 0.9962632879131749}-{'f1_val': 0.9930161638237394, 'auprc': 0.996558762821376, 'loss_val': 0.032671925743596585, 'psi': 0.9944332034227941}
[S13] START round=83 head_norm_before_train=1.936506 cos_to_last_merge=0.9955 (last merge round=57)
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6149461761616014, 'auprc': 0.7669733530378823, 'loss_val': 1.125719439618418, 'psi': 0.6757570469121138}-{'f1_val': 0.655991581126423, 'auprc': 0.7906761759649594, 'loss_val': 0.9948236114917045, 'psi': 0.7098654190618375}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=1.842082 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=83 local utility u=0.003127 metrics={'f1_val': 0.9972114391202196, 'auprc': 0.9988507510485483, 'loss_val': 0.02305589344432663, 'psi': 0.9978671638915511}-{'f1_val': 0.9971893422213808, 'auprc': 0.9986280446603892, 'loss_val': 0.02850973208121861, 'psi': 0.9977648231969841}
[S15] START round=83 head_norm_before_train=2.072039 cos_to_last_merge=0.9983 (last merge round=58)
[S15] round=83 local utility u=0.888521 metrics={'f1_val': 0.9457829465404324, 'auprc': 0.9929105647895375, 'loss_val': 0.0748524064212781, 'psi': 0.9646339938400744}-{'f1_val': 0.7216485589190276, 'auprc': 0.9900936437704453, 'loss_val': 0.49863799116210583, 'psi': 0.8290265928595947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=83 head_norm_before_train=2.117605 cos_to_last_merge=0.9637 (last merge round=45)
[S16] round=83 local utility u=0.001496 metrics={'f1_val': 0.9937621241130705, 'auprc': 0.989407021734497, 'loss_val': 0.03128823052591078, 'psi': 0.992020083161641}-{'f1_val': 0.9937621241130705, 'auprc': 0.9886376704798248, 'loss_val': 0.03197130957808123, 'psi': 0.9917123426597723}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=83 head_norm_before_train=1.811733 cos_to_last_merge=1.0000 (last merge round=82)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.6026493208749413, 'auprc': 0.9223330396099331, 'loss_val': 1.310536425671923, 'psi': 0.730522808368938}-{'f1_val': 0.6993779342138581, 'auprc': 0.9467990477441195, 'loss_val': 0.9812294408819453, 'psi': 0.7983463796259627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S4] not sending this round → trigger blocked (psi=0.949)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:41909
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] cosine check vs S3: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=1.0000
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9998
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=83 metric=0.8405 head_norm=1.834453
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.375293e-02
[S6] stored merged vector for next round verification (round=83)
[S6] DEBUG after merge:  round=83 metric=0.8411 head_norm=1.823735 delta_norm=0.023753
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=83 metric=0.9960 head_norm=2.452496
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.190668e-02
[S8] stored merged vector for next round verification (round=83)
[S8] DEBUG after merge:  round=83 metric=0.9963 head_norm=2.452873 delta_norm=0.021907
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=83 metric=0.9961 head_norm=1.851778
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.908675e-03
[S11] stored merged vector for next round verification (round=83)
[S11] DEBUG after merge:  round=83 metric=0.9961 head_norm=1.849084 delta_norm=0.008909
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=83 metric=0.9972 head_norm=1.846430
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.908677e-03
[S14] stored merged vector for next round verification (round=83)
[S14] DEBUG after merge:  round=83 metric=0.9972 head_norm=1.849084 delta_norm=0.008909
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=83 metric=0.9874 head_norm=2.453446
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.190668e-02
[S3] stored merged vector for next round verification (round=83)
[S3] DEBUG after merge:  round=83 metric=0.9876 head_norm=2.452873 delta_norm=0.021907
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=2.003136 cos_to_last_merge=0.9946 (last merge round=58)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7944774400715043, 'auprc': 0.9927267165728386, 'loss_val': 0.4247578148090919, 'psi': 0.8737771506720381}-{'f1_val': 0.8278664975702772, 'auprc': 0.990415417426347, 'loss_val': 0.42639709856839053, 'psi': 0.8928860655127051}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.452873 cos_to_last_merge=1.0000 (last merge round=83)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.9551029051225225, 'auprc': 0.9975923702513673, 'loss_val': 0.0913438422500563, 'psi': 0.9720986911740603}-{'f1_val': 0.9873865051679755, 'auprc': 0.9985872560575806, 'loss_val': 0.03682480908913607, 'psi': 0.9918668055238176}
[S4] START round=84 head_norm_before_train=1.904914 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=84 local utility u=0.024836 metrics={'f1_val': 0.9416059903300061, 'auprc': 0.9719385847573234, 'loss_val': 0.31573239399729325, 'psi': 0.953739028100933}-{'f1_val': 0.9388550128728114, 'auprc': 0.963735067749987, 'loss_val': 0.32428823173008137, 'psi': 0.9488070348236816}
[S5] START round=84 head_norm_before_train=2.309170 (no previous merge yet)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9982622373776037, 'loss_val': 0.016103318639561357, 'psi': 0.9977222910074195}-{'f1_val': 0.9977293526688911, 'auprc': 0.999981798843856, 'loss_val': 0.01453214075418295, 'psi': 0.9986303311388771}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=1.823735 cos_to_last_merge=1.0000 (last merge round=83)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.8088971467159164, 'auprc': 0.929499573933819, 'loss_val': 0.4273218687153443, 'psi': 0.8571381176030775}-{'f1_val': 0.8405320635642962, 'auprc': 0.9293444185403456, 'loss_val': 0.5078979949291935, 'psi': 0.8760570055547159}
[S7] START round=84 head_norm_before_train=1.913362 cos_to_last_merge=0.9999 (last merge round=82)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5483084016618044, 'auprc': 0.6896910098522644, 'loss_val': 1.5048038400218617, 'psi': 0.6048614449379884}-{'f1_val': 0.7154899679785958, 'auprc': 0.8329157002786488, 'loss_val': 0.896936736279314, 'psi': 0.7624602608986171}
[S8] START round=84 head_norm_before_train=2.452873 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=84 local utility u=0.002321 metrics={'f1_val': 0.997062774194349, 'auprc': 0.9969145370064699, 'loss_val': 0.018331149661658615, 'psi': 0.9970034793191973}-{'f1_val': 0.995954631055922, 'auprc': 0.9983146640249763, 'loss_val': 0.020523793498931416, 'psi': 0.9968986442435437}
[S9] START round=84 head_norm_before_train=2.373269 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9954057827158509, 'auprc': 0.9999719972267197, 'loss_val': 0.019090543723551182, 'psi': 0.9972322685201984}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999668251878051, 'loss_val': 0.01564801102908912, 'psi': 0.9982295779967422}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.354736 cos_to_last_merge=0.9974 (last merge round=58)
[S10] round=84 local utility u=0.000493 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9962370962320112, 'loss_val': 0.026484873222389706, 'psi': 0.9952934714984543}-{'f1_val': 0.9946643883427498, 'auprc': 0.9959198322820773, 'loss_val': 0.026518530789425218, 'psi': 0.9951665659184807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=84 head_norm_before_train=1.849084 cos_to_last_merge=1.0000 (last merge round=83)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9961244465764076, 'loss_val': 0.02448277455089073, 'psi': 0.9959848813517115}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964577074129732, 'loss_val': 0.02359187447634295, 'psi': 0.9962632879131749}
[S13] START round=84 head_norm_before_train=1.941496 cos_to_last_merge=0.9951 (last merge round=57)
[S13] round=84 local utility u=0.135283 metrics={'f1_val': 0.6669105134014367, 'auprc': 0.7686003977419329, 'loss_val': 1.1718203723314662, 'psi': 0.7075864671376352}-{'f1_val': 0.6149461761616014, 'auprc': 0.7669733530378823, 'loss_val': 1.125719439618418, 'psi': 0.6757570469121138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=84 head_norm_before_train=1.849084 cos_to_last_merge=1.0000 (last merge round=83)
[S14] round=84 local utility u=0.005120 metrics={'f1_val': 0.9978223933154866, 'auprc': 0.9989926436646135, 'loss_val': 0.01690782914554611, 'psi': 0.9982904934551373}-{'f1_val': 0.9972114391202196, 'auprc': 0.9988507510485483, 'loss_val': 0.02305589344432663, 'psi': 0.9978671638915511}
[S15] START round=84 head_norm_before_train=2.078190 cos_to_last_merge=0.9982 (last merge round=58)
[S15] round=84 local utility u=0.185997 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970450818152967, 'loss_val': 0.021044367319390828, 'psi': 0.996866033758631}-{'f1_val': 0.9457829465404324, 'auprc': 0.9929105647895375, 'loss_val': 0.0748524064212781, 'psi': 0.9646339938400744}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=84 head_norm_before_train=2.124160 cos_to_last_merge=0.9631 (last merge round=45)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9930759014009373, 'auprc': 0.9865710057986569, 'loss_val': 0.03413929121642666, 'psi': 0.9904739431600251}-{'f1_val': 0.9937621241130705, 'auprc': 0.989407021734497, 'loss_val': 0.03128823052591078, 'psi': 0.992020083161641}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.819594 cos_to_last_merge=1.0000 (last merge round=82)
[S17] round=84 local utility u=0.952193 metrics={'f1_val': 0.7854898883549676, 'auprc': 0.9800246935837164, 'loss_val': 0.6762692809548533, 'psi': 0.8633038104464671}-{'f1_val': 0.6026493208749413, 'auprc': 0.9223330396099331, 'loss_val': 1.310536425671923, 'psi': 0.730522808368938}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:41907
[S14] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S4
[S7] cosine check vs S4: cos=0.9994
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=0.9999
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=84 metric=0.7855 head_norm=1.828441
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.016239e-02
[S17] stored merged vector for next round verification (round=84)
[S17] DEBUG after merge:  round=84 metric=0.7839 head_norm=1.831338 delta_norm=0.020162
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=2.009427 cos_to_last_merge=0.9944 (last merge round=58)
[S2] round=85 local utility u=0.087252 metrics={'f1_val': 0.8231351917894616, 'auprc': 0.9926370421982453, 'loss_val': 0.4219304266956437, 'psi': 0.890935931952975}-{'f1_val': 0.7944774400715043, 'auprc': 0.9927267165728386, 'loss_val': 0.4247578148090919, 'psi': 0.8737771506720381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=85 head_norm_before_train=2.459385 cos_to_last_merge=1.0000 (last merge round=83)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9590113171339985, 'auprc': 0.9949716160305033, 'loss_val': 0.13793684898768077, 'psi': 0.9733954366926004}-{'f1_val': 0.9551029051225225, 'auprc': 0.9975923702513673, 'loss_val': 0.0913438422500563, 'psi': 0.9720986911740603}
[S4] START round=85 head_norm_before_train=1.910601 cos_to_last_merge=1.0000 (last merge round=82)
[S4] round=85 local utility u=0.015125 metrics={'f1_val': 0.947144487198486, 'auprc': 0.9693285069061403, 'loss_val': 0.310883738610114, 'psi': 0.9560180950815477}-{'f1_val': 0.9416059903300061, 'auprc': 0.9719385847573234, 'loss_val': 0.31573239399729325, 'psi': 0.953739028100933}
[S5] START round=85 head_norm_before_train=2.318647 (no previous merge yet)
[S5] round=85 local utility u=0.002645 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9995927483189233, 'loss_val': 0.014804985624895633, 'psi': 0.9982544953839474}-{'f1_val': 0.99736232676063, 'auprc': 0.9982622373776037, 'loss_val': 0.016103318639561357, 'psi': 0.9977222910074195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=85 head_norm_before_train=1.835956 cos_to_last_merge=1.0000 (last merge round=83)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.630674483800659, 'auprc': 0.8351404002764757, 'loss_val': 0.8624660814451885, 'psi': 0.7124608503909857}-{'f1_val': 0.8088971467159164, 'auprc': 0.929499573933819, 'loss_val': 0.4273218687153443, 'psi': 0.8571381176030775}
[S7] START round=85 head_norm_before_train=1.934893 cos_to_last_merge=0.9995 (last merge round=82)
[S7] round=85 local utility u=1.000000 metrics={'f1_val': 0.7375487608717022, 'auprc': 0.8718793728569745, 'loss_val': 0.7746550301414606, 'psi': 0.791281005665811}-{'f1_val': 0.5483084016618044, 'auprc': 0.6896910098522644, 'loss_val': 1.5048038400218617, 'psi': 0.6048614449379884}
[S8] START round=85 head_norm_before_train=2.458765 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9933886401181823, 'auprc': 0.9982107088184582, 'loss_val': 0.04846605316993276, 'psi': 0.9953174675982926}-{'f1_val': 0.997062774194349, 'auprc': 0.9969145370064699, 'loss_val': 0.018331149661658615, 'psi': 0.9970034793191973}
[S9] START round=85 head_norm_before_train=2.375443 (no previous merge yet)
[S9] round=85 local utility u=0.005369 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999634627551819, 'loss_val': 0.015856281773742528, 'psi': 0.9979816921904077}-{'f1_val': 0.9954057827158509, 'auprc': 0.9999719972267197, 'loss_val': 0.019090543723551182, 'psi': 0.9972322685201984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=85 head_norm_before_train=2.355561 cos_to_last_merge=0.9971 (last merge round=58)
[S10] round=85 local utility u=0.000663 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9967237707388042, 'loss_val': 0.026619480686565576, 'psi': 0.9954881413011716}-{'f1_val': 0.9946643883427498, 'auprc': 0.9962370962320112, 'loss_val': 0.026484873222389706, 'psi': 0.9952934714984543}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=85 head_norm_before_train=1.854993 cos_to_last_merge=1.0000 (last merge round=83)
[S11] round=85 local utility u=0.001998 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972352166586678, 'loss_val': 0.023819579656101167, 'psi': 0.9964291893846156}-{'f1_val': 0.9958918378685807, 'auprc': 0.9961244465764076, 'loss_val': 0.02448277455089073, 'psi': 0.9959848813517115}
[S13] START round=85 head_norm_before_train=1.946143 cos_to_last_merge=0.9946 (last merge round=57)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.5917794394097033, 'auprc': 0.73140359824274, 'loss_val': 1.343153156635581, 'psi': 0.647629102942918}-{'f1_val': 0.6669105134014367, 'auprc': 0.7686003977419329, 'loss_val': 1.1718203723314662, 'psi': 0.7075864671376352}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=1.852711 cos_to_last_merge=1.0000 (last merge round=83)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9936988499732641, 'auprc': 0.9988314614967796, 'loss_val': 0.02777366004837239, 'psi': 0.9957518945826703}-{'f1_val': 0.9978223933154866, 'auprc': 0.9989926436646135, 'loss_val': 0.01690782914554611, 'psi': 0.9982904934551373}
[S15] START round=85 head_norm_before_train=2.083867 cos_to_last_merge=0.9981 (last merge round=58)
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.988822978931694, 'auprc': 0.9925232024074333, 'loss_val': 0.040925822079599335, 'psi': 0.9903030683219898}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970450818152967, 'loss_val': 0.021044367319390828, 'psi': 0.996866033758631}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.127448 cos_to_last_merge=0.9628 (last merge round=45)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9925903253673836, 'auprc': 0.9831324900895164, 'loss_val': 0.039201982003202795, 'psi': 0.9888071912562366}-{'f1_val': 0.9930759014009373, 'auprc': 0.9865710057986569, 'loss_val': 0.03413929121642666, 'psi': 0.9904739431600251}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.831338 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=85 local utility u=0.344729 metrics={'f1_val': 0.8706607714123874, 'auprc': 0.9869623654529588, 'loss_val': 0.5186494417169264, 'psi': 0.917181409028616}-{'f1_val': 0.7854898883549676, 'auprc': 0.9800246935837164, 'loss_val': 0.6762692809548533, 'psi': 0.8633038104464671}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.956)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S17] not sending this round → trigger blocked (psi=0.917)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] ⇄ pheromone p=0.423 → S6@127.0.0.1:41907
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] ⇄ pheromone p=0.112 → S7@127.0.0.1:41908
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=85 metric=0.6307 head_norm=1.849241
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.014566e-02
[S6] stored merged vector for next round verification (round=85)
[S6] DEBUG after merge:  round=85 metric=0.6321 head_norm=1.838760 delta_norm=0.020146
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.207 → S17@127.0.0.1:41917
[S14] ⇄ pheromone p=0.014 → S11@127.0.0.1:41912
[S8] ⇄ pheromone p=0.003 → S3@127.0.0.1:41903
[S3] ⇄ pheromone p=0.108 → S8@127.0.0.1:41909
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=1.0000
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9991
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=85 metric=0.7375 head_norm=1.943266
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.210619e-02
[S7] stored merged vector for next round verification (round=85)
[S7] DEBUG after merge:  round=85 metric=0.7293 head_norm=1.926543 delta_norm=0.042106
[S7] aggregate: ROLLBACK (f1_val pre=0.738 post=0.729 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.323 → S4@127.0.0.1:41904
[S11] ⇄ pheromone p=0.008 → S14@127.0.0.1:41914
[S2] START round=86 head_norm_before_train=2.015647 cos_to_last_merge=0.9941 (last merge round=58)
[S2] round=86 local utility u=0.000371 metrics={'f1_val': 0.8270806092238246, 'auprc': 0.9926301957039608, 'loss_val': 0.4448395779890475, 'psi': 0.8933004438158791}-{'f1_val': 0.8231351917894616, 'auprc': 0.9926370421982453, 'loss_val': 0.4219304266956437, 'psi': 0.890935931952975}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=86 head_norm_before_train=2.466495 cos_to_last_merge=1.0000 (last merge round=83)
[S3] round=86 local utility u=0.106250 metrics={'f1_val': 0.9788109426052385, 'auprc': 0.998395591367044, 'loss_val': 0.05450635214075868, 'psi': 0.9866448021099608}-{'f1_val': 0.9590113171339985, 'auprc': 0.9949716160305033, 'loss_val': 0.13793684898768077, 'psi': 0.9733954366926004}
[S4] START round=86 head_norm_before_train=1.915138 cos_to_last_merge=0.9999 (last merge round=82)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9394708240766684, 'auprc': 0.9554777284088718, 'loss_val': 0.33096793197717994, 'psi': 0.9458735858095497}-{'f1_val': 0.947144487198486, 'auprc': 0.9693285069061403, 'loss_val': 0.310883738610114, 'psi': 0.9560180950815477}
[S5] START round=86 head_norm_before_train=2.329639 (no previous merge yet)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.998095816501524, 'auprc': 0.9998776489894352, 'loss_val': 0.023227851283570494, 'psi': 0.9988085494966885}-{'f1_val': 0.99736232676063, 'auprc': 0.9995927483189233, 'loss_val': 0.014804985624895633, 'psi': 0.9982544953839474}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.838760 cos_to_last_merge=1.0000 (last merge round=85)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.6292004387946508, 'auprc': 0.8254475522164434, 'loss_val': 0.996458767013009, 'psi': 0.7076992841633678}-{'f1_val': 0.630674483800659, 'auprc': 0.8351404002764757, 'loss_val': 0.8624660814451885, 'psi': 0.7124608503909857}
[S7] START round=86 head_norm_before_train=1.926543 cos_to_last_merge=1.0000 (last merge round=85)
[S7] round=86 local utility u=0.510151 metrics={'f1_val': 0.8528388451944785, 'auprc': 0.9303502100186751, 'loss_val': 0.621505514829435, 'psi': 0.8838433911241572}-{'f1_val': 0.7375487608717022, 'auprc': 0.8718793728569745, 'loss_val': 0.7746550301414606, 'psi': 0.791281005665811}
[S8] START round=86 head_norm_before_train=2.464322 cos_to_last_merge=0.9999 (last merge round=83)
[S8] round=86 local utility u=0.020676 metrics={'f1_val': 0.9953657279690348, 'auprc': 0.9980502967861857, 'loss_val': 0.018495920171563943, 'psi': 0.9964395554958951}-{'f1_val': 0.9933886401181823, 'auprc': 0.9982107088184582, 'loss_val': 0.04846605316993276, 'psi': 0.9953174675982926}
[S9] START round=86 head_norm_before_train=2.382445 (no previous merge yet)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999604094814598, 'loss_val': 0.016189769560185505, 'psi': 0.9979804708809188}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999634627551819, 'loss_val': 0.015856281773742528, 'psi': 0.9979816921904077}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.358661 cos_to_last_merge=0.9969 (last merge round=58)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9963314976949028, 'loss_val': 0.026593248176493695, 'psi': 0.995331232083611}-{'f1_val': 0.9946643883427498, 'auprc': 0.9967237707388042, 'loss_val': 0.026619480686565576, 'psi': 0.9954881413011716}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.862187 cos_to_last_merge=1.0000 (last merge round=83)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9954312449678927, 'auprc': 0.9966925122006864, 'loss_val': 0.02316055128204026, 'psi': 0.9959357518610101}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972352166586678, 'loss_val': 0.023819579656101167, 'psi': 0.9964291893846156}
[S13] START round=86 head_norm_before_train=1.949645 cos_to_last_merge=0.9942 (last merge round=57)
[S13] round=86 local utility u=0.530412 metrics={'f1_val': 0.668442712479701, 'auprc': 0.7658293048458239, 'loss_val': 0.8455858963349296, 'psi': 0.7073973494261502}-{'f1_val': 0.5917794394097033, 'auprc': 0.73140359824274, 'loss_val': 1.343153156635581, 'psi': 0.647629102942918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=86 head_norm_before_train=1.856177 cos_to_last_merge=1.0000 (last merge round=83)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9304996057323351, 'auprc': 0.9988493058617813, 'loss_val': 0.15179544835072376, 'psi': 0.9578394857841136}-{'f1_val': 0.9936988499732641, 'auprc': 0.9988314614967796, 'loss_val': 0.02777366004837239, 'psi': 0.9957518945826703}
[S15] START round=86 head_norm_before_train=2.088972 cos_to_last_merge=0.9979 (last merge round=58)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.907867695839158, 'auprc': 0.9924668320286492, 'loss_val': 0.14433987502022322, 'psi': 0.9417073503149544}-{'f1_val': 0.988822978931694, 'auprc': 0.9925232024074333, 'loss_val': 0.040925822079599335, 'psi': 0.9903030683219898}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.130687 cos_to_last_merge=0.9624 (last merge round=45)
[S16] round=86 local utility u=0.001007 metrics={'f1_val': 0.9924433951039854, 'auprc': 0.9828389577705845, 'loss_val': 0.03542674493295427, 'psi': 0.988601620170625}-{'f1_val': 0.9925903253673836, 'auprc': 0.9831324900895164, 'loss_val': 0.039201982003202795, 'psi': 0.9888071912562366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=86 head_norm_before_train=1.839709 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.7563854090611516, 'auprc': 0.9617484465793373, 'loss_val': 0.7873867560608129, 'psi': 0.8385306240684259}-{'f1_val': 0.8706607714123874, 'auprc': 0.9869623654529588, 'loss_val': 0.5186494417169264, 'psi': 0.917181409028616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:41909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.884)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=86 metric=0.9305 head_norm=1.861367
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.463357e-03
[S14] stored merged vector for next round verification (round=86)
[S14] DEBUG after merge:  round=86 metric=0.9305 head_norm=1.861753 delta_norm=0.009463
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=86 metric=0.9395 head_norm=1.920744
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.142350e-02
[S4] stored merged vector for next round verification (round=86)
[S4] DEBUG after merge:  round=86 metric=0.9395 head_norm=1.931594 delta_norm=0.041424
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=86 metric=0.9954 head_norm=2.470686
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.545853e-02
[S8] stored merged vector for next round verification (round=86)
[S8] DEBUG after merge:  round=86 metric=0.9957 head_norm=2.469818 delta_norm=0.025459
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=86 metric=0.9788 head_norm=2.469212
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.545854e-02
[S3] stored merged vector for next round verification (round=86)
[S3] DEBUG after merge:  round=86 metric=0.9788 head_norm=2.469818 delta_norm=0.025459
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.018289 cos_to_last_merge=0.9941 (last merge round=58)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.8299973886615442, 'auprc': 0.9317863656263123, 'loss_val': 0.43886124508206464, 'psi': 0.8707129794474515}-{'f1_val': 0.8270806092238246, 'auprc': 0.9926301957039608, 'loss_val': 0.4448395779890475, 'psi': 0.8933004438158791}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.469818 cos_to_last_merge=1.0000 (last merge round=86)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9597287040135783, 'auprc': 0.9950661167248018, 'loss_val': 0.14129292025969312, 'psi': 0.9738636690980678}-{'f1_val': 0.9788109426052385, 'auprc': 0.998395591367044, 'loss_val': 0.05450635214075868, 'psi': 0.9866448021099608}
[S4] START round=87 head_norm_before_train=1.931594 cos_to_last_merge=1.0000 (last merge round=86)
[S4] round=87 local utility u=0.004345 metrics={'f1_val': 0.9402146856555421, 'auprc': 0.9566517924878168, 'loss_val': 0.3302626661338217, 'psi': 0.946789528388452}-{'f1_val': 0.9394708240766684, 'auprc': 0.9554777284088718, 'loss_val': 0.33096793197717994, 'psi': 0.9458735858095497}
[S5] START round=87 head_norm_before_train=2.333972 (no previous merge yet)
[S5] round=87 local utility u=0.003467 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9998447292870305, 'loss_val': 0.013996958825714619, 'psi': 0.9985755033161469}-{'f1_val': 0.998095816501524, 'auprc': 0.9998776489894352, 'loss_val': 0.023227851283570494, 'psi': 0.9988085494966885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=87 head_norm_before_train=1.850128 cos_to_last_merge=1.0000 (last merge round=85)
[S6] round=87 local utility u=0.559527 metrics={'f1_val': 0.7450293189556753, 'auprc': 0.8974178730302913, 'loss_val': 0.7882881275000588, 'psi': 0.8059847405855216}-{'f1_val': 0.6292004387946508, 'auprc': 0.8254475522164434, 'loss_val': 0.996458767013009, 'psi': 0.7076992841633678}
[S7] START round=87 head_norm_before_train=1.936384 cos_to_last_merge=1.0000 (last merge round=85)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.5352780665357558, 'auprc': 0.6302850719760056, 'loss_val': 1.761068872106808, 'psi': 0.5732808687118558}-{'f1_val': 0.8528388451944785, 'auprc': 0.9303502100186751, 'loss_val': 0.621505514829435, 'psi': 0.8838433911241572}
[S8] START round=87 head_norm_before_train=2.469818 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=87 local utility u=0.005389 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9975502179177165, 'loss_val': 0.017301573432106542, 'psi': 0.9973478632447906}-{'f1_val': 0.9953657279690348, 'auprc': 0.9980502967861857, 'loss_val': 0.018495920171563943, 'psi': 0.9964395554958951}
[S9] START round=87 head_norm_before_train=2.391153 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999676065548224, 'loss_val': 0.016735621555372317, 'psi': 0.9974830736404402}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999604094814598, 'loss_val': 0.016189769560185505, 'psi': 0.9979804708809188}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.362946 cos_to_last_merge=0.9968 (last merge round=58)
[S10] round=87 local utility u=0.000228 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9964432168099999, 'loss_val': 0.026472666693634773, 'psi': 0.9953759197296499}-{'f1_val': 0.9946643883427498, 'auprc': 0.9963314976949028, 'loss_val': 0.026593248176493695, 'psi': 0.995331232083611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=87 head_norm_before_train=1.869318 cos_to_last_merge=1.0000 (last merge round=83)
[S11] round=87 local utility u=0.004413 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978328186662289, 'loss_val': 0.021970404440804562, 'psi': 0.9968133324144771}-{'f1_val': 0.9954312449678927, 'auprc': 0.9966925122006864, 'loss_val': 0.02316055128204026, 'psi': 0.9959357518610101}
[S13] START round=87 head_norm_before_train=1.954663 cos_to_last_merge=0.9937 (last merge round=57)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6393622310240683, 'auprc': 0.76175013790811, 'loss_val': 1.0988959290802385, 'psi': 0.688317393777685}-{'f1_val': 0.668442712479701, 'auprc': 0.7658293048458239, 'loss_val': 0.8455858963349296, 'psi': 0.7073973494261502}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=1.861753 cos_to_last_merge=1.0000 (last merge round=86)
[S14] round=87 local utility u=0.148430 metrics={'f1_val': 0.963135845812849, 'auprc': 0.9988906567776508, 'loss_val': 0.050876413199170474, 'psi': 0.9774377701987698}-{'f1_val': 0.9304996057323351, 'auprc': 0.9988493058617813, 'loss_val': 0.15179544835072376, 'psi': 0.9578394857841136}
[S15] START round=87 head_norm_before_train=2.093783 cos_to_last_merge=0.9978 (last merge round=58)
[S15] round=87 local utility u=0.182231 metrics={'f1_val': 0.9557948396628284, 'auprc': 0.9945698252017899, 'loss_val': 0.0737495306039173, 'psi': 0.9713048338784129}-{'f1_val': 0.907867695839158, 'auprc': 0.9924668320286492, 'loss_val': 0.14433987502022322, 'psi': 0.9417073503149544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=87 head_norm_before_train=2.135677 cos_to_last_merge=0.9620 (last merge round=45)
[S16] round=87 local utility u=0.011639 metrics={'f1_val': 0.9932913840280244, 'auprc': 0.9881527575062605, 'loss_val': 0.03317882930566282, 'psi': 0.9912359334193188}-{'f1_val': 0.9924433951039854, 'auprc': 0.9828389577705845, 'loss_val': 0.03542674493295427, 'psi': 0.988601620170625}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=87 head_norm_before_train=1.848498 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7055829850214892, 'auprc': 0.9493996136639172, 'loss_val': 0.9560310624159251, 'psi': 0.8031096364784605}-{'f1_val': 0.7563854090611516, 'auprc': 0.9617484465793373, 'loss_val': 0.7873867560608129, 'psi': 0.8385306240684259}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:41908
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=87 metric=0.9631 head_norm=1.866272
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.202837e-02
[S14] stored merged vector for next round verification (round=87)
[S14] DEBUG after merge:  round=87 metric=0.9631 head_norm=1.871472 delta_norm=0.012028
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=87 metric=0.9961 head_norm=1.876735
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.202837e-02
[S11] stored merged vector for next round verification (round=87)
[S11] DEBUG after merge:  round=87 metric=0.9961 head_norm=1.871472 delta_norm=0.012028
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.022073 cos_to_last_merge=0.9940 (last merge round=58)
[S2] round=88 local utility u=0.079538 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.9903302026242029, 'loss_val': 0.4426310157432657, 'psi': 0.8928519795918475}-{'f1_val': 0.8299973886615442, 'auprc': 0.9317863656263123, 'loss_val': 0.43886124508206464, 'psi': 0.8707129794474515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=88 head_norm_before_train=2.474747 cos_to_last_merge=1.0000 (last merge round=86)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9597706934396131, 'auprc': 0.9938663260041777, 'loss_val': 0.15338691678575023, 'psi': 0.973408946465439}-{'f1_val': 0.9597287040135783, 'auprc': 0.9950661167248018, 'loss_val': 0.14129292025969312, 'psi': 0.9738636690980678}
[S4] START round=88 head_norm_before_train=1.937575 cos_to_last_merge=1.0000 (last merge round=86)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9391778837556721, 'auprc': 0.9534984404315938, 'loss_val': 0.34873987718289523, 'psi': 0.9449061064260408}-{'f1_val': 0.9402146856555421, 'auprc': 0.9566517924878168, 'loss_val': 0.3302626661338217, 'psi': 0.946789528388452}
[S5] START round=88 head_norm_before_train=2.338507 (no previous merge yet)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9990537422594208, 'loss_val': 0.012001414986645247, 'psi': 0.9980388929601464}-{'f1_val': 0.9977293526688911, 'auprc': 0.9998447292870305, 'loss_val': 0.013996958825714619, 'psi': 0.9985755033161469}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.860331 cos_to_last_merge=0.9999 (last merge round=85)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.6604856019371466, 'auprc': 0.7882668706825717, 'loss_val': 0.9973905171172932, 'psi': 0.7115981094353167}-{'f1_val': 0.7450293189556753, 'auprc': 0.8974178730302913, 'loss_val': 0.7882881275000588, 'psi': 0.8059847405855216}
[S7] START round=88 head_norm_before_train=1.951550 cos_to_last_merge=0.9998 (last merge round=85)
[S7] round=88 local utility u=1.000000 metrics={'f1_val': 0.7320387385437248, 'auprc': 0.8836665784203928, 'loss_val': 0.8622678146210584, 'psi': 0.792689874494392}-{'f1_val': 0.5352780665357558, 'auprc': 0.6302850719760056, 'loss_val': 1.761068872106808, 'psi': 0.5732808687118558}
[S8] START round=88 head_norm_before_train=2.476627 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9981628417169168, 'loss_val': 0.02000980006168867, 'psi': 0.9962245197698485}-{'f1_val': 0.9972129601295068, 'auprc': 0.9975502179177165, 'loss_val': 0.017301573432106542, 'psi': 0.9973478632447906}
[S9] START round=88 head_norm_before_train=2.396485 (no previous merge yet)
[S9] round=88 local utility u=0.002914 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999653121097634, 'loss_val': 0.015904143653813006, 'psi': 0.9979824319322402}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999676065548224, 'loss_val': 0.016735621555372317, 'psi': 0.9974830736404402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=88 head_norm_before_train=2.364638 cos_to_last_merge=0.9965 (last merge round=58)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9959947553519205, 'loss_val': 0.026237081155979527, 'psi': 0.995196535146418}-{'f1_val': 0.9946643883427498, 'auprc': 0.9964432168099999, 'loss_val': 0.026472666693634773, 'psi': 0.9953759197296499}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.871472 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9975827713546717, 'loss_val': 0.022888117491660368, 'psi': 0.9965682112630171}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978328186662289, 'loss_val': 0.021970404440804562, 'psi': 0.9968133324144771}
[S13] START round=88 head_norm_before_train=1.958988 cos_to_last_merge=0.9932 (last merge round=57)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.5977124709408248, 'auprc': 0.7335926965247161, 'loss_val': 1.2816437112866874, 'psi': 0.6520645611743814}-{'f1_val': 0.6393622310240683, 'auprc': 0.76175013790811, 'loss_val': 1.0988959290802385, 'psi': 0.688317393777685}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.871472 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=88 local utility u=0.119611 metrics={'f1_val': 0.9978409269094968, 'auprc': 0.9987673053944395, 'loss_val': 0.019514018404268217, 'psi': 0.9982114783034739}-{'f1_val': 0.963135845812849, 'auprc': 0.9988906567776508, 'loss_val': 0.050876413199170474, 'psi': 0.9774377701987698}
[S15] START round=88 head_norm_before_train=2.099432 cos_to_last_merge=0.9977 (last merge round=58)
[S15] round=88 local utility u=0.047651 metrics={'f1_val': 0.9682616989930181, 'auprc': 0.996064792636557, 'loss_val': 0.05773337608717589, 'psi': 0.9793829364504336}-{'f1_val': 0.9557948396628284, 'auprc': 0.9945698252017899, 'loss_val': 0.0737495306039173, 'psi': 0.9713048338784129}
[S15] not sending this round → trigger blocked (psi=0.979)
[S16] START round=88 head_norm_before_train=2.140220 cos_to_last_merge=0.9617 (last merge round=45)
[S16] round=88 local utility u=0.003366 metrics={'f1_val': 0.9932913840280244, 'auprc': 0.9900928363993093, 'loss_val': 0.032267968830258786, 'psi': 0.9920119649765384}-{'f1_val': 0.9932913840280244, 'auprc': 0.9881527575062605, 'loss_val': 0.03317882930566282, 'psi': 0.9912359334193188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=88 head_norm_before_train=1.857610 cos_to_last_merge=0.9999 (last merge round=84)
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.6777316299718146, 'auprc': 0.930536683052949, 'loss_val': 1.0646491598322791, 'psi': 0.7788536512042683}-{'f1_val': 0.7055829850214892, 'auprc': 0.9493996136639172, 'loss_val': 0.9560310624159251, 'psi': 0.8031096364784605}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=88 metric=0.6777 head_norm=1.864635
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.967902e-02
[S17] stored merged vector for next round verification (round=88)
[S17] DEBUG after merge:  round=88 metric=0.6770 head_norm=1.862380 delta_norm=0.019679
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9996
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=88 metric=0.7320 head_norm=1.963337
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.888082e-02
[S7] stored merged vector for next round verification (round=88)
[S7] DEBUG after merge:  round=88 metric=0.7294 head_norm=1.950285 delta_norm=0.028881
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=2.026736 cos_to_last_merge=0.9938 (last merge round=58)
[S2] round=89 local utility u=0.006294 metrics={'f1_val': 0.8278664975702772, 'auprc': 0.9895454634885585, 'loss_val': 0.427689002078308, 'psi': 0.8925380839375898}-{'f1_val': 0.8278664975702772, 'auprc': 0.9903302026242029, 'loss_val': 0.4426310157432657, 'psi': 0.8928519795918475}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=89 head_norm_before_train=2.481006 cos_to_last_merge=1.0000 (last merge round=86)
[S3] round=89 local utility u=0.178065 metrics={'f1_val': 0.9945845505796368, 'auprc': 0.998616411232471, 'loss_val': 0.020391154910230982, 'psi': 0.9961972948407705}-{'f1_val': 0.9597706934396131, 'auprc': 0.9938663260041777, 'loss_val': 0.15338691678575023, 'psi': 0.973408946465439}
[S4] START round=89 head_norm_before_train=1.944248 cos_to_last_merge=1.0000 (last merge round=86)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.8538686538684532, 'auprc': 0.9346135890028265, 'loss_val': 0.4539969442984752, 'psi': 0.8861666279222025}-{'f1_val': 0.9391778837556721, 'auprc': 0.9534984404315938, 'loss_val': 0.34873987718289523, 'psi': 0.9449061064260408}
[S5] START round=89 head_norm_before_train=2.345281 (no previous merge yet)
[S5] round=89 local utility u=0.001466 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9998214916876744, 'loss_val': 0.011372431558474744, 'psi': 0.9983459927314478}-{'f1_val': 0.99736232676063, 'auprc': 0.9990537422594208, 'loss_val': 0.012001414986645247, 'psi': 0.9980388929601464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=89 head_norm_before_train=1.869776 cos_to_last_merge=0.9999 (last merge round=85)
[S6] round=89 local utility u=0.194381 metrics={'f1_val': 0.6761405189594245, 'auprc': 0.8480026765101978, 'loss_val': 0.8817647350954876, 'psi': 0.7448853819797339}-{'f1_val': 0.6604856019371466, 'auprc': 0.7882668706825717, 'loss_val': 0.9973905171172932, 'psi': 0.7115981094353167}
[S7] START round=89 head_norm_before_train=1.950285 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.6472676498267869, 'auprc': 0.8663364431189085, 'loss_val': 0.9557816186622289, 'psi': 0.7348951671436355}-{'f1_val': 0.7320387385437248, 'auprc': 0.8836665784203928, 'loss_val': 0.8622678146210584, 'psi': 0.792689874494392}
[S8] START round=89 head_norm_before_train=2.482983 cos_to_last_merge=0.9999 (last merge round=86)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9948515737160428, 'auprc': 0.9981735308057588, 'loss_val': 0.023768010756047894, 'psi': 0.9961803565519292}-{'f1_val': 0.9949323051384696, 'auprc': 0.9981628417169168, 'loss_val': 0.02000980006168867, 'psi': 0.9962245197698485}
[S9] START round=89 head_norm_before_train=2.396728 (no previous merge yet)
[S9] round=89 local utility u=0.001361 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999704095934372, 'loss_val': 0.01566283884470599, 'psi': 0.998231011758995}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999653121097634, 'loss_val': 0.015904143653813006, 'psi': 0.9979824319322402}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=89 head_norm_before_train=2.365906 cos_to_last_merge=0.9962 (last merge round=58)
[S10] round=89 local utility u=0.000517 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.995890796023491, 'loss_val': 0.026208959768872588, 'psi': 0.9952866528676332}-{'f1_val': 0.9946643883427498, 'auprc': 0.9959947553519205, 'loss_val': 0.026237081155979527, 'psi': 0.995196535146418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=89 head_norm_before_train=1.878071 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=89 local utility u=0.000822 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975038861795318, 'loss_val': 0.022457500885929182, 'psi': 0.9966817594197983}-{'f1_val': 0.9958918378685807, 'auprc': 0.9975827713546717, 'loss_val': 0.022888117491660368, 'psi': 0.9965682112630171}
[S13] START round=89 head_norm_before_train=1.962508 cos_to_last_merge=0.9929 (last merge round=57)
[S13] round=89 local utility u=0.306083 metrics={'f1_val': 0.6375114703147318, 'auprc': 0.7660435784630859, 'loss_val': 1.0056252929936884, 'psi': 0.6889243135740735}-{'f1_val': 0.5977124709408248, 'auprc': 0.7335926965247161, 'loss_val': 1.2816437112866874, 'psi': 0.6520645611743814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] sending update (kind=head size=1809 to 1 peers)
[S14] START round=89 head_norm_before_train=1.876591 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.990992859845413, 'auprc': 0.9985394780905275, 'loss_val': 0.03778085332724535, 'psi': 0.9940115071434588}-{'f1_val': 0.9978409269094968, 'auprc': 0.9987673053944395, 'loss_val': 0.019514018404268217, 'psi': 0.9982114783034739}
[S15] START round=89 head_norm_before_train=2.105410 cos_to_last_merge=0.9975 (last merge round=58)
[S15] round=89 local utility u=0.106106 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976920657254482, 'loss_val': 0.021313647039259052, 'psi': 0.9971248273226916}-{'f1_val': 0.9682616989930181, 'auprc': 0.996064792636557, 'loss_val': 0.05773337608717589, 'psi': 0.9793829364504336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=89 head_norm_before_train=2.143564 cos_to_last_merge=0.9614 (last merge round=45)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9932913840280244, 'auprc': 0.9896081960891343, 'loss_val': 0.0320593559897541, 'psi': 0.9918181088524685}-{'f1_val': 0.9932913840280244, 'auprc': 0.9900928363993093, 'loss_val': 0.032267968830258786, 'psi': 0.9920119649765384}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=1.862380 cos_to_last_merge=1.0000 (last merge round=88)
[S17] round=89 local utility u=0.106737 metrics={'f1_val': 0.7056838869663826, 'auprc': 0.9256201890568143, 'loss_val': 1.0041384583351542, 'psi': 0.7936584078025553}-{'f1_val': 0.6777316299718146, 'auprc': 0.930536683052949, 'loss_val': 1.0646491598322791, 'psi': 0.7788536512042683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=89 metric=0.8539 head_norm=1.947682
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.898779e-02
[S4] stored merged vector for next round verification (round=89)
[S4] DEBUG after merge:  round=89 metric=0.8513 head_norm=1.955310 delta_norm=0.028988
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.9999
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=89 metric=0.7057 head_norm=1.868885
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.493657e-02
[S17] stored merged vector for next round verification (round=89)
[S17] DEBUG after merge:  round=89 metric=0.7049 head_norm=1.872203 delta_norm=0.014937
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=89 metric=0.6761 head_norm=1.875634
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.493657e-02
[S6] stored merged vector for next round verification (round=89)
[S6] DEBUG after merge:  round=89 metric=0.6761 head_norm=1.872203 delta_norm=0.014937
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=2.030183 cos_to_last_merge=0.9936 (last merge round=58)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.712169695813764, 'auprc': 0.9920064584759118, 'loss_val': 0.5349051286829236, 'psi': 0.8241044008786231}-{'f1_val': 0.8278664975702772, 'auprc': 0.9895454634885585, 'loss_val': 0.427689002078308, 'psi': 0.8925380839375898}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.485646 cos_to_last_merge=0.9999 (last merge round=86)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.956273782778326, 'auprc': 0.9928525166833092, 'loss_val': 0.17827464510859178, 'psi': 0.9709052763403192}-{'f1_val': 0.9945845505796368, 'auprc': 0.998616411232471, 'loss_val': 0.020391154910230982, 'psi': 0.9961972948407705}
[S4] START round=90 head_norm_before_train=1.955310 cos_to_last_merge=1.0000 (last merge round=89)
[S4] round=90 local utility u=0.325499 metrics={'f1_val': 0.9397049734876157, 'auprc': 0.9423263484280513, 'loss_val': 0.34115549482128943, 'psi': 0.9407535234637899}-{'f1_val': 0.8538686538684532, 'auprc': 0.9346135890028265, 'loss_val': 0.4539969442984752, 'psi': 0.8861666279222025}
[S5] START round=90 head_norm_before_train=2.351738 (no previous merge yet)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.998127724930041, 'loss_val': 0.01222106528461037, 'psi': 0.9974479319488304}-{'f1_val': 0.99736232676063, 'auprc': 0.9998214916876744, 'loss_val': 0.011372431558474744, 'psi': 0.9983459927314478}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.872203 cos_to_last_merge=1.0000 (last merge round=89)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.5285188492066056, 'auprc': 0.8152259325813155, 'loss_val': 1.1752700587371814, 'psi': 0.6432016825564896}-{'f1_val': 0.6761405189594245, 'auprc': 0.8480026765101978, 'loss_val': 0.8817647350954876, 'psi': 0.7448853819797339}
[S7] START round=90 head_norm_before_train=1.965206 cos_to_last_merge=0.9999 (last merge round=88)
[S7] round=90 local utility u=1.000000 metrics={'f1_val': 0.8992933017204564, 'auprc': 0.9784745965221462, 'loss_val': 0.22483368854825225, 'psi': 0.9309658196411323}-{'f1_val': 0.6472676498267869, 'auprc': 0.8663364431189085, 'loss_val': 0.9557816186622289, 'psi': 0.7348951671436355}
[S8] START round=90 head_norm_before_train=2.486265 cos_to_last_merge=0.9999 (last merge round=86)
[S8] round=90 local utility u=0.001004 metrics={'f1_val': 0.9952186980597226, 'auprc': 0.9980635778856206, 'loss_val': 0.023633855306013304, 'psi': 0.9963566499900818}-{'f1_val': 0.9948515737160428, 'auprc': 0.9981735308057588, 'loss_val': 0.023768010756047894, 'psi': 0.9961803565519292}
[S9] START round=90 head_norm_before_train=2.398839 (no previous merge yet)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9999704095934372, 'loss_val': 0.01616175934859163, 'psi': 0.9977334325227656}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999704095934372, 'loss_val': 0.01566283884470599, 'psi': 0.998231011758995}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.369215 cos_to_last_merge=0.9960 (last merge round=58)
[S10] round=90 local utility u=0.000894 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969878769453995, 'loss_val': 0.026395674980111177, 'psi': 0.9955937837838096}-{'f1_val': 0.9948838907637279, 'auprc': 0.995890796023491, 'loss_val': 0.026208959768872588, 'psi': 0.9952866528676332}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=90 head_norm_before_train=1.884094 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965673714124357, 'loss_val': 0.021656142712802064, 'psi': 0.9963071535129598}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975038861795318, 'loss_val': 0.022457500885929182, 'psi': 0.9966817594197983}
[S13] START round=90 head_norm_before_train=1.966008 cos_to_last_merge=0.9926 (last merge round=57)
[S13] round=90 local utility u=0.265238 metrics={'f1_val': 0.7052796887891597, 'auprc': 0.7876659382045004, 'loss_val': 0.946625195862366, 'psi': 0.7382341885552959}-{'f1_val': 0.6375114703147318, 'auprc': 0.7660435784630859, 'loss_val': 1.0056252929936884, 'psi': 0.6889243135740735}
[S13] not sending this round → trigger blocked (psi=0.738)
[S14] START round=90 head_norm_before_train=1.879537 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.976745108899802, 'auprc': 0.9969017715151062, 'loss_val': 0.10586689750956521, 'psi': 0.9848077739459237}-{'f1_val': 0.990992859845413, 'auprc': 0.9985394780905275, 'loss_val': 0.03778085332724535, 'psi': 0.9940115071434588}
[S15] START round=90 head_norm_before_train=2.111221 cos_to_last_merge=0.9974 (last merge round=58)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9907475929281976, 'loss_val': 0.026864947130224078, 'psi': 0.9941243453574728}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976920657254482, 'loss_val': 0.021313647039259052, 'psi': 0.9971248273226916}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.146619 cos_to_last_merge=0.9610 (last merge round=45)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9933636672418392, 'auprc': 0.9888897765194635, 'loss_val': 0.03180879359128601, 'psi': 0.991574110952889}-{'f1_val': 0.9932913840280244, 'auprc': 0.9896081960891343, 'loss_val': 0.0320593559897541, 'psi': 0.9918181088524685}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=1.872203 cos_to_last_merge=1.0000 (last merge round=89)
[S17] round=90 local utility u=0.146647 metrics={'f1_val': 0.7401613080613203, 'auprc': 0.9219815836768115, 'loss_val': 0.906793360458231, 'psi': 0.8128894183075168}-{'f1_val': 0.7056838869663826, 'auprc': 0.9256201890568143, 'loss_val': 1.0041384583351542, 'psi': 0.7936584078025553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:41908
[S17] not sending this round → trigger blocked (psi=0.813)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[S6] ⇄ pheromone p=0.156 → S17@127.0.0.1:41917
[S4] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S17] ⇄ pheromone p=0.185 → S6@127.0.0.1:41907
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=90 metric=0.9767 head_norm=1.879129
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.178699e-03
[S14] stored merged vector for next round verification (round=90)
[S14] DEBUG after merge:  round=90 metric=0.9767 head_norm=1.881591 delta_norm=0.009179
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.035 → S11@127.0.0.1:41912
[S11] ⇄ pheromone p=0.003 → S14@127.0.0.1:41914
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] ⇄ pheromone p=0.073 → S8@127.0.0.1:41909
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1806) from S4
[S7] cosine check vs S4: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.9997
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=90 metric=0.8993 head_norm=1.978136
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.527752e-02
[S7] stored merged vector for next round verification (round=90)
[S7] DEBUG after merge:  round=90 metric=0.9027 head_norm=1.967768 delta_norm=0.025278
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.476 → S4@127.0.0.1:41904
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=90 metric=0.9952 head_norm=2.491568
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.585801e-02
[S8] stored merged vector for next round verification (round=90)
[S8] DEBUG after merge:  round=90 metric=0.9952 head_norm=2.488475 delta_norm=0.025858
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.003 → S3@127.0.0.1:41903
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=90 metric=0.9397 head_norm=1.957672
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.527752e-02
[S4] stored merged vector for next round verification (round=90)
[S4] DEBUG after merge:  round=90 metric=0.9397 head_norm=1.967768 delta_norm=0.025278
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.102 → S7@127.0.0.1:41908
[S2] START round=91 head_norm_before_train=2.034589 cos_to_last_merge=0.9934 (last merge round=58)
[S2] round=91 local utility u=0.384474 metrics={'f1_val': 0.8276545040920673, 'auprc': 0.9870465165436308, 'loss_val': 0.44398524667582195, 'psi': 0.8914113090726927}-{'f1_val': 0.712169695813764, 'auprc': 0.9920064584759118, 'loss_val': 0.5349051286829236, 'psi': 0.8241044008786231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=91 head_norm_before_train=2.487420 cos_to_last_merge=0.9999 (last merge round=86)
[S3] round=91 local utility u=0.057018 metrics={'f1_val': 0.9589241657999712, 'auprc': 0.9974179419570346, 'loss_val': 0.0938377810891867, 'psi': 0.9743216762627966}-{'f1_val': 0.956273782778326, 'auprc': 0.9928525166833092, 'loss_val': 0.17827464510859178, 'psi': 0.9709052763403192}
[S4] START round=91 head_norm_before_train=1.967768 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=91 local utility u=0.038982 metrics={'f1_val': 0.9421742876221773, 'auprc': 0.9591471606355768, 'loss_val': 0.32847073012713635, 'psi': 0.948963436827537}-{'f1_val': 0.9397049734876157, 'auprc': 0.9423263484280513, 'loss_val': 0.34115549482128943, 'psi': 0.9407535234637899}
[S5] START round=91 head_norm_before_train=2.358088 (no previous merge yet)
[S5] round=91 local utility u=0.004412 metrics={'f1_val': 0.99736232676063, 'auprc': 0.999981384447247, 'loss_val': 0.011163050974745297, 'psi': 0.9984099498352769}-{'f1_val': 0.9969947366280233, 'auprc': 0.998127724930041, 'loss_val': 0.01222106528461037, 'psi': 0.9974479319488304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=91 head_norm_before_train=1.878947 cos_to_last_merge=1.0000 (last merge round=89)
[S6] round=91 local utility u=0.972250 metrics={'f1_val': 0.7293504346723436, 'auprc': 0.9093148127017776, 'loss_val': 0.7180271535297477, 'psi': 0.8013361858841173}-{'f1_val': 0.5285188492066056, 'auprc': 0.8152259325813155, 'loss_val': 1.1752700587371814, 'psi': 0.6432016825564896}
[S7] START round=91 head_norm_before_train=1.967768 cos_to_last_merge=1.0000 (last merge round=90)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.8516815259605287, 'auprc': 0.9105372070832722, 'loss_val': 0.7233256837640862, 'psi': 0.8752237984096262}-{'f1_val': 0.8992933017204564, 'auprc': 0.9784745965221462, 'loss_val': 0.22483368854825225, 'psi': 0.9309658196411323}
[S8] START round=91 head_norm_before_train=2.488475 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=91 local utility u=0.004130 metrics={'f1_val': 0.995954631055922, 'auprc': 0.9978494956211648, 'loss_val': 0.019146729118083485, 'psi': 0.9967125768820191}-{'f1_val': 0.9952186980597226, 'auprc': 0.9980635778856206, 'loss_val': 0.023633855306013304, 'psi': 0.9963566499900818}
[S9] START round=91 head_norm_before_train=2.403912 (no previous merge yet)
[S9] round=91 local utility u=0.002892 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999704095934372, 'loss_val': 0.01535326832695594, 'psi': 0.998231011758995}-{'f1_val': 0.9962421144756511, 'auprc': 0.9999704095934372, 'loss_val': 0.01616175934859163, 'psi': 0.9977334325227656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=91 head_norm_before_train=2.373639 cos_to_last_merge=0.9959 (last merge round=58)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9969948404012203, 'loss_val': 0.026622489910966315, 'psi': 0.9955711447728999}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969878769453995, 'loss_val': 0.026395674980111177, 'psi': 0.9955937837838096}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=1.890622 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=91 local utility u=0.001312 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975134613309307, 'loss_val': 0.02186963841865068, 'psi': 0.9966855894803579}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965673714124357, 'loss_val': 0.021656142712802064, 'psi': 0.9963071535129598}
[S13] START round=91 head_norm_before_train=1.973012 cos_to_last_merge=0.9923 (last merge round=57)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6204250699934635, 'auprc': 0.7240293896178707, 'loss_val': 1.2878948731875433, 'psi': 0.6618667978432263}-{'f1_val': 0.7052796887891597, 'auprc': 0.7876659382045004, 'loss_val': 0.946625195862366, 'psi': 0.7382341885552959}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.881591 cos_to_last_merge=1.0000 (last merge round=90)
[S14] round=91 local utility u=0.108666 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.998923870426041, 'loss_val': 0.018732244849336135, 'psi': 0.9980297302327723}-{'f1_val': 0.976745108899802, 'auprc': 0.9969017715151062, 'loss_val': 0.10586689750956521, 'psi': 0.9848077739459237}
[S15] START round=91 head_norm_before_train=2.116471 cos_to_last_merge=0.9972 (last merge round=58)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9026184145866213, 'auprc': 0.9960926263507752, 'loss_val': 0.20349144649485218, 'psi': 0.9400080992922828}-{'f1_val': 0.9963755136436562, 'auprc': 0.9907475929281976, 'loss_val': 0.026864947130224078, 'psi': 0.9941243453574728}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.150519 cos_to_last_merge=0.9606 (last merge round=45)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9928609279362696, 'auprc': 0.9840843788400041, 'loss_val': 0.04553049459034815, 'psi': 0.9893503082977634}-{'f1_val': 0.9933636672418392, 'auprc': 0.9888897765194635, 'loss_val': 0.03180879359128601, 'psi': 0.991574110952889}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=1.879233 cos_to_last_merge=1.0000 (last merge round=89)
[S17] round=91 local utility u=0.336055 metrics={'f1_val': 0.803798236976919, 'auprc': 0.9393467740070732, 'loss_val': 0.6685997035444502, 'psi': 0.8580176517889806}-{'f1_val': 0.7401613080613203, 'auprc': 0.9219815836768115, 'loss_val': 0.906793360458231, 'psi': 0.8128894183075168}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S4] not sending this round → trigger blocked (psi=0.949)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:41912
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] cosine check vs S11: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=91 metric=0.9589 head_norm=2.491743
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.084371e-02
[S3] stored merged vector for next round verification (round=91)
[S3] DEBUG after merge:  round=91 metric=0.9589 head_norm=2.491465 delta_norm=0.030844
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=91 metric=0.8038 head_norm=1.884876
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.348386e-02
[S17] stored merged vector for next round verification (round=91)
[S17] DEBUG after merge:  round=91 metric=0.8038 head_norm=1.884894 delta_norm=0.013484
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=91 metric=0.9974 head_norm=1.882208
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.246885e-02
[S14] stored merged vector for next round verification (round=91)
[S14] DEBUG after merge:  round=91 metric=0.9974 head_norm=1.889872 delta_norm=0.012469
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=91 metric=0.9961 head_norm=1.897586
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.246885e-02
[S11] stored merged vector for next round verification (round=91)
[S11] DEBUG after merge:  round=91 metric=0.9961 head_norm=1.889872 delta_norm=0.012469
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=91 metric=0.7294 head_norm=1.885008
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.348387e-02
[S6] stored merged vector for next round verification (round=91)
[S6] DEBUG after merge:  round=91 metric=0.7298 head_norm=1.884894 delta_norm=0.013484
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=2.038067 cos_to_last_merge=0.9933 (last merge round=58)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8276545040920673, 'auprc': 0.9827009309765613, 'loss_val': 0.44319439698937285, 'psi': 0.8896730748458649}-{'f1_val': 0.8276545040920673, 'auprc': 0.9870465165436308, 'loss_val': 0.44398524667582195, 'psi': 0.8914113090726927}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.491465 cos_to_last_merge=1.0000 (last merge round=91)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.960527581452528, 'auprc': 0.9966469692072916, 'loss_val': 0.13298390024409598, 'psi': 0.9749753365544335}-{'f1_val': 0.9589241657999712, 'auprc': 0.9974179419570346, 'loss_val': 0.0938377810891867, 'psi': 0.9743216762627966}
[S4] START round=92 head_norm_before_train=1.971249 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.94142335191947, 'auprc': 0.9532713631148991, 'loss_val': 0.33178065876393265, 'psi': 0.9461625563976417}-{'f1_val': 0.9421742876221773, 'auprc': 0.9591471606355768, 'loss_val': 0.32847073012713635, 'psi': 0.948963436827537}
[S5] START round=92 head_norm_before_train=2.366638 (no previous merge yet)
[S5] round=92 local utility u=0.000439 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9999805652502135, 'loss_val': 0.012485507083516319, 'psi': 0.9986298377014201}-{'f1_val': 0.99736232676063, 'auprc': 0.999981384447247, 'loss_val': 0.011163050974745297, 'psi': 0.9984099498352769}
[S5] not sending this round → trigger blocked (psi=0.999)
[S6] START round=92 head_norm_before_train=1.884894 cos_to_last_merge=1.0000 (last merge round=91)
[S6] round=92 local utility u=0.703803 metrics={'f1_val': 0.8615412166898379, 'auprc': 0.9696582020290683, 'loss_val': 0.28459684479230823, 'psi': 0.9047880108255301}-{'f1_val': 0.7293504346723436, 'auprc': 0.9093148127017776, 'loss_val': 0.7180271535297477, 'psi': 0.8013361858841173}
[S7] START round=92 head_norm_before_train=1.981098 cos_to_last_merge=0.9999 (last merge round=90)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.8036868474662691, 'auprc': 0.8927346963535967, 'loss_val': 0.6086859050267424, 'psi': 0.8393059870212001}-{'f1_val': 0.8516815259605287, 'auprc': 0.9105372070832722, 'loss_val': 0.7233256837640862, 'psi': 0.8752237984096262}
[S8] START round=92 head_norm_before_train=2.495173 cos_to_last_merge=1.0000 (last merge round=90)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9947714541180194, 'auprc': 0.998213028943329, 'loss_val': 0.02837943850522269, 'psi': 0.9961480840481431}-{'f1_val': 0.995954631055922, 'auprc': 0.9978494956211648, 'loss_val': 0.019146729118083485, 'psi': 0.9967125768820191}
[S9] START round=92 head_norm_before_train=2.404821 (no previous merge yet)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999966278209088, 'loss_val': 0.01570618979461901, 'psi': 0.9979828183719701}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999704095934372, 'loss_val': 0.01535326832695594, 'psi': 0.998231011758995}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.378671 cos_to_last_merge=0.9958 (last merge round=58)
[S10] round=92 local utility u=0.000370 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970649442028904, 'loss_val': 0.02634706303159313, 'psi': 0.9956246106868061}-{'f1_val': 0.9946220143540194, 'auprc': 0.9969948404012203, 'loss_val': 0.026622489910966315, 'psi': 0.9955711447728999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=92 head_norm_before_train=1.889872 cos_to_last_merge=1.0000 (last merge round=91)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996174739468528, 'loss_val': 0.023262604625806566, 'psi': 0.9961501007353968}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975134613309307, 'loss_val': 0.02186963841865068, 'psi': 0.9966855894803579}
[S13] START round=92 head_norm_before_train=1.978926 cos_to_last_merge=0.9919 (last merge round=57)
[S13] round=92 local utility u=0.651680 metrics={'f1_val': 0.7308046209394803, 'auprc': 0.7971756950928301, 'loss_val': 0.8662508452772214, 'psi': 0.7573530506008203}-{'f1_val': 0.6204250699934635, 'auprc': 0.7240293896178707, 'loss_val': 1.2878948731875433, 'psi': 0.6618667978432263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=92 head_norm_before_train=1.889872 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9981971601658712, 'loss_val': 0.01947119101329416, 'psi': 0.9977254606270454}-{'f1_val': 0.9974336367705932, 'auprc': 0.998923870426041, 'loss_val': 0.018732244849336135, 'psi': 0.9980297302327723}
[S15] START round=92 head_norm_before_train=2.121734 cos_to_last_merge=0.9971 (last merge round=58)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.897401060907727, 'auprc': 0.9962593330650455, 'loss_val': 0.27260516863726086, 'psi': 0.9369443697706543}-{'f1_val': 0.9026184145866213, 'auprc': 0.9960926263507752, 'loss_val': 0.20349144649485218, 'psi': 0.9400080992922828}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=2.152066 cos_to_last_merge=0.9603 (last merge round=45)
[S16] round=92 local utility u=0.019092 metrics={'f1_val': 0.9942025818077131, 'auprc': 0.9889894591716877, 'loss_val': 0.030112457755474806, 'psi': 0.9921173327533029}-{'f1_val': 0.9928609279362696, 'auprc': 0.9840843788400041, 'loss_val': 0.04553049459034815, 'psi': 0.9893503082977634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=92 head_norm_before_train=1.884894 cos_to_last_merge=1.0000 (last merge round=91)
[S17] round=92 local utility u=0.341759 metrics={'f1_val': 0.8737511142542789, 'auprc': 0.9643589413495987, 'loss_val': 0.4798346394262784, 'psi': 0.9099942450924068}-{'f1_val': 0.803798236976919, 'auprc': 0.9393467740070732, 'loss_val': 0.6685997035444502, 'psi': 0.8580176517889806}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.905)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.910)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=92 metric=0.9948 head_norm=2.500239
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.450513e-02
[S8] stored merged vector for next round verification (round=92)
[S8] DEBUG after merge:  round=92 metric=0.9948 head_norm=2.495874 delta_norm=0.024505
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=2.042578 cos_to_last_merge=0.9931 (last merge round=58)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.8268593669243363, 'auprc': 0.9876004248280554, 'loss_val': 0.4574034109825064, 'psi': 0.891155790085824}-{'f1_val': 0.8276545040920673, 'auprc': 0.9827009309765613, 'loss_val': 0.44319439698937285, 'psi': 0.8896730748458649}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.497403 cos_to_last_merge=1.0000 (last merge round=91)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9510136136925824, 'auprc': 0.9929991600336825, 'loss_val': 0.15966086007372438, 'psi': 0.9678078322290224}-{'f1_val': 0.960527581452528, 'auprc': 0.9966469692072916, 'loss_val': 0.13298390024409598, 'psi': 0.9749753365544335}
[S4] START round=93 head_norm_before_train=1.973081 cos_to_last_merge=1.0000 (last merge round=90)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9380500672554528, 'auprc': 0.9484360008595634, 'loss_val': 0.3570090117967046, 'psi': 0.9422044406970971}-{'f1_val': 0.94142335191947, 'auprc': 0.9532713631148991, 'loss_val': 0.33178065876393265, 'psi': 0.9461625563976417}
[S5] START round=93 head_norm_before_train=2.371863 (no previous merge yet)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9982183265677291, 'loss_val': 0.013883480331768035, 'psi': 0.9977047266834697}-{'f1_val': 0.9977293526688911, 'auprc': 0.9999805652502135, 'loss_val': 0.012485507083516319, 'psi': 0.9986298377014201}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.893076 cos_to_last_merge=1.0000 (last merge round=91)
[S6] round=93 local utility u=0.064915 metrics={'f1_val': 0.8685535623278636, 'auprc': 0.9770148832164434, 'loss_val': 0.2189113071199917, 'psi': 0.9119380906832955}-{'f1_val': 0.8615412166898379, 'auprc': 0.9696582020290683, 'loss_val': 0.28459684479230823, 'psi': 0.9047880108255301}
[S7] START round=93 head_norm_before_train=1.996011 cos_to_last_merge=0.9998 (last merge round=90)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.7169729671797428, 'auprc': 0.8596130501963852, 'loss_val': 0.971618830586403, 'psi': 0.7740290003863998}-{'f1_val': 0.8036868474662691, 'auprc': 0.8927346963535967, 'loss_val': 0.6086859050267424, 'psi': 0.8393059870212001}
[S8] START round=93 head_norm_before_train=2.495874 cos_to_last_merge=1.0000 (last merge round=92)
[S8] round=93 local utility u=0.010890 metrics={'f1_val': 0.9970452011553516, 'auprc': 0.9982694307972341, 'loss_val': 0.020410311685001358, 'psi': 0.9975348930121046}-{'f1_val': 0.9947714541180194, 'auprc': 0.998213028943329, 'loss_val': 0.02837943850522269, 'psi': 0.9961480840481431}
[S9] START round=93 head_norm_before_train=2.404696 (no previous merge yet)
[S9] round=93 local utility u=0.001367 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999966278209088, 'loss_val': 0.015625791832094452, 'psi': 0.9982482587909209}-{'f1_val': 0.9966605118138915, 'auprc': 0.999966278209088, 'loss_val': 0.01570618979461901, 'psi': 0.9979828183719701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=93 head_norm_before_train=2.380794 cos_to_last_merge=0.9955 (last merge round=58)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9954576267739675, 'loss_val': 0.02618044956333463, 'psi': 0.9951133851678238}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970649442028904, 'loss_val': 0.02634706303159313, 'psi': 0.9956246106868061}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.895312 cos_to_last_merge=1.0000 (last merge round=91)
[S11] round=93 local utility u=0.000018 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963005269038013, 'loss_val': 0.023603609361797954, 'psi': 0.9962004157095061}-{'f1_val': 0.9961336749133093, 'auprc': 0.996174739468528, 'loss_val': 0.023262604625806566, 'psi': 0.9961501007353968}
[S13] START round=93 head_norm_before_train=1.983523 cos_to_last_merge=0.9915 (last merge round=57)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6176974167826168, 'auprc': 0.7043567439803491, 'loss_val': 1.3129396975496386, 'psi': 0.6523611476617097}-{'f1_val': 0.7308046209394803, 'auprc': 0.7971756950928301, 'loss_val': 0.8662508452772214, 'psi': 0.7573530506008203}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.893574 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=93 local utility u=0.000443 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.998193003966126, 'loss_val': 0.018572394814873574, 'psi': 0.9977237981471473}-{'f1_val': 0.9974109942678281, 'auprc': 0.9981971601658712, 'loss_val': 0.01947119101329416, 'psi': 0.9977254606270454}
[S15] START round=93 head_norm_before_train=2.127101 cos_to_last_merge=0.9970 (last merge round=58)
[S15] round=93 local utility u=0.165560 metrics={'f1_val': 0.9252478916834812, 'auprc': 0.9975559227500322, 'loss_val': 0.11245586303101222, 'psi': 0.9541711041101015}-{'f1_val': 0.897401060907727, 'auprc': 0.9962593330650455, 'loss_val': 0.27260516863726086, 'psi': 0.9369443697706543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=93 head_norm_before_train=2.155422 cos_to_last_merge=0.9600 (last merge round=45)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9933979452926707, 'auprc': 0.9901079458888314, 'loss_val': 0.03123354454999537, 'psi': 0.9920819455311349}-{'f1_val': 0.9942025818077131, 'auprc': 0.9889894591716877, 'loss_val': 0.030112457755474806, 'psi': 0.9921173327533029}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=1.891854 cos_to_last_merge=1.0000 (last merge round=91)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8352819640503009, 'auprc': 0.9575284734611151, 'loss_val': 0.5689176520606501, 'psi': 0.8841805678146266}-{'f1_val': 0.8737511142542789, 'auprc': 0.9643589413495987, 'loss_val': 0.4798346394262784, 'psi': 0.9099942450924068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1806) from S6
[S17] cosine check vs S6: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=1.0000
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=93 metric=0.9974 head_norm=1.898972
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.229540e-03
[S14] stored merged vector for next round verification (round=93)
[S14] DEBUG after merge:  round=93 metric=0.9974 head_norm=1.899201 delta_norm=0.007230
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=93 metric=0.9961 head_norm=1.899457
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.229546e-03
[S11] stored merged vector for next round verification (round=93)
[S11] DEBUG after merge:  round=93 metric=0.9961 head_norm=1.899201 delta_norm=0.007230
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=2.047333 cos_to_last_merge=0.9930 (last merge round=58)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.8276448775662563, 'auprc': 0.9586230225078842, 'loss_val': 0.45416013125825416, 'psi': 0.8800361355429074}-{'f1_val': 0.8268593669243363, 'auprc': 0.9876004248280554, 'loss_val': 0.4574034109825064, 'psi': 0.891155790085824}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.500432 cos_to_last_merge=1.0000 (last merge round=91)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.7029062675738486, 'auprc': 0.945665462843007, 'loss_val': 0.6235797477544959, 'psi': 0.800009945681512}-{'f1_val': 0.9510136136925824, 'auprc': 0.9929991600336825, 'loss_val': 0.15966086007372438, 'psi': 0.9678078322290224}
[S4] START round=94 head_norm_before_train=1.974494 cos_to_last_merge=0.9999 (last merge round=90)
[S4] round=94 local utility u=0.010942 metrics={'f1_val': 0.9397217028637388, 'auprc': 0.949914995120439, 'loss_val': 0.349592165161032, 'psi': 0.9437990197664188}-{'f1_val': 0.9380500672554528, 'auprc': 0.9484360008595634, 'loss_val': 0.3570090117967046, 'psi': 0.9422044406970971}
[S5] START round=94 head_norm_before_train=2.374498 (no previous merge yet)
[S5] round=94 local utility u=0.001505 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9983866756260531, 'loss_val': 0.011379173186208737, 'psi': 0.9977720663067993}-{'f1_val': 0.99736232676063, 'auprc': 0.9982183265677291, 'loss_val': 0.013883480331768035, 'psi': 0.9977047266834697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=94 head_norm_before_train=1.903295 cos_to_last_merge=1.0000 (last merge round=91)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.8273883473734873, 'auprc': 0.9267825237431652, 'loss_val': 0.3523406472213039, 'psi': 0.8671460179213585}-{'f1_val': 0.8685535623278636, 'auprc': 0.9770148832164434, 'loss_val': 0.2189113071199917, 'psi': 0.9119380906832955}
[S7] START round=94 head_norm_before_train=2.009439 cos_to_last_merge=0.9996 (last merge round=90)
[S7] round=94 local utility u=0.350835 metrics={'f1_val': 0.7741739655827609, 'auprc': 0.9058325601501416, 'loss_val': 0.7518128295102243, 'psi': 0.8268374034097131}-{'f1_val': 0.7169729671797428, 'auprc': 0.8596130501963852, 'loss_val': 0.971618830586403, 'psi': 0.7740290003863998}
[S8] START round=94 head_norm_before_train=2.501565 cos_to_last_merge=1.0000 (last merge round=92)
[S8] round=94 local utility u=0.003136 metrics={'f1_val': 0.9974993535273301, 'auprc': 0.9979138909266598, 'loss_val': 0.015795770439799583, 'psi': 0.997665168487062}-{'f1_val': 0.9970452011553516, 'auprc': 0.9982694307972341, 'loss_val': 0.020410311685001358, 'psi': 0.9975348930121046}
[S9] START round=94 head_norm_before_train=2.411015 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.994988868793922, 'auprc': 0.9999732625753991, 'loss_val': 0.02006460433203873, 'psi': 0.9969826263065129}-{'f1_val': 0.9971029125121428, 'auprc': 0.999966278209088, 'loss_val': 0.015625791832094452, 'psi': 0.9982482587909209}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.382199 cos_to_last_merge=0.9952 (last merge round=58)
[S10] round=94 local utility u=0.001453 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968839389685238, 'loss_val': 0.026236344559422316, 'psi': 0.9955522085930594}-{'f1_val': 0.9948838907637279, 'auprc': 0.9954576267739675, 'loss_val': 0.02618044956333463, 'psi': 0.9951133851678238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=94 head_norm_before_train=1.899201 cos_to_last_merge=1.0000 (last merge round=93)
[S11] round=94 local utility u=0.000416 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963682728113428, 'loss_val': 0.022974461664592997, 'psi': 0.9962275140725227}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963005269038013, 'loss_val': 0.023603609361797954, 'psi': 0.9962004157095061}
[S13] START round=94 head_norm_before_train=1.987238 cos_to_last_merge=0.9913 (last merge round=57)
[S13] round=94 local utility u=0.482312 metrics={'f1_val': 0.6929604029699507, 'auprc': 0.8159333025788342, 'loss_val': 1.1346231229828159, 'psi': 0.7421495628135041}-{'f1_val': 0.6176974167826168, 'auprc': 0.7043567439803491, 'loss_val': 1.3129396975496386, 'psi': 0.6523611476617097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=94 head_norm_before_train=1.899201 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9981529081124383, 'loss_val': 0.019145893479588644, 'psi': 0.9977077598056723}-{'f1_val': 0.9974109942678281, 'auprc': 0.998193003966126, 'loss_val': 0.018572394814873574, 'psi': 0.9977237981471473}
[S15] START round=94 head_norm_before_train=2.132297 cos_to_last_merge=0.9968 (last merge round=58)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8934756177323443, 'auprc': 0.9957043453202277, 'loss_val': 0.2829006418501402, 'psi': 0.9343671087674976}-{'f1_val': 0.9252478916834812, 'auprc': 0.9975559227500322, 'loss_val': 0.11245586303101222, 'psi': 0.9541711041101015}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.160067 cos_to_last_merge=0.9596 (last merge round=45)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9931776155203599, 'auprc': 0.9900457557530548, 'loss_val': 0.03204951111009657, 'psi': 0.9919248716134378}-{'f1_val': 0.9933979452926707, 'auprc': 0.9901079458888314, 'loss_val': 0.03123354454999537, 'psi': 0.9920819455311349}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=1.898909 cos_to_last_merge=1.0000 (last merge round=91)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8288798118338776, 'auprc': 0.9610166938458801, 'loss_val': 0.63400528137071, 'psi': 0.8817345646386786}-{'f1_val': 0.8352819640503009, 'auprc': 0.9575284734611151, 'loss_val': 0.5689176520606501, 'psi': 0.8841805678146266}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:41908
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[S11] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.998)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=94 metric=0.8289 head_norm=1.906423
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.345890e-02
[S17] stored merged vector for next round verification (round=94)
[S17] DEBUG after merge:  round=94 metric=0.8286 head_norm=1.904812 delta_norm=0.013459
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=94 metric=0.7029 head_norm=2.505819
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.574846e-03
[S3] stored merged vector for next round verification (round=94)
[S3] DEBUG after merge:  round=94 metric=0.7040 head_norm=2.503675 delta_norm=0.009575
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S4
[S7] cosine check vs S4: cos=0.9991
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9991
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=94 metric=0.9397 head_norm=1.979097
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.717350e-02
[S4] stored merged vector for next round verification (round=94)
[S4] DEBUG after merge:  round=94 metric=0.9397 head_norm=2.001059 delta_norm=0.047174
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=94 metric=0.7742 head_norm=2.023882
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.717351e-02
[S7] stored merged vector for next round verification (round=94)
[S7] DEBUG after merge:  round=94 metric=0.7684 head_norm=2.001059 delta_norm=0.047174
[S7] aggregate: ROLLBACK (f1_val pre=0.774 post=0.768 tol_abs=0.005 tol_rel=0.0)
[S2] START round=95 head_norm_before_train=2.052983 cos_to_last_merge=0.9928 (last merge round=58)
[S2] round=95 local utility u=0.046753 metrics={'f1_val': 0.8270806092238246, 'auprc': 0.9926498154538161, 'loss_val': 0.45934804976335625, 'psi': 0.8933082917158213}-{'f1_val': 0.8276448775662563, 'auprc': 0.9586230225078842, 'loss_val': 0.45416013125825416, 'psi': 0.8800361355429074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=95 head_norm_before_train=2.503675 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=95 local utility u=1.000000 metrics={'f1_val': 0.9967161732642108, 'auprc': 0.9991860660984301, 'loss_val': 0.02084164331400003, 'psi': 0.9977041303978986}-{'f1_val': 0.7029062675738486, 'auprc': 0.945665462843007, 'loss_val': 0.6235797477544959, 'psi': 0.800009945681512}
[S4] START round=95 head_norm_before_train=2.001059 cos_to_last_merge=1.0000 (last merge round=94)
[S4] round=95 local utility u=0.031720 metrics={'f1_val': 0.9420245674831883, 'auprc': 0.9627471624206143, 'loss_val': 0.33846504999140814, 'psi': 0.9503136054581587}-{'f1_val': 0.9397217028637388, 'auprc': 0.949914995120439, 'loss_val': 0.349592165161032, 'psi': 0.9437990197664188}
[S5] START round=95 head_norm_before_train=2.384961 (no previous merge yet)
[S5] round=95 local utility u=0.001815 metrics={'f1_val': 0.99736232676063, 'auprc': 0.9996134132767033, 'loss_val': 0.01142885598120571, 'psi': 0.9982627613670594}-{'f1_val': 0.99736232676063, 'auprc': 0.9983866756260531, 'loss_val': 0.011379173186208737, 'psi': 0.9977720663067993}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=95 head_norm_before_train=1.912437 cos_to_last_merge=0.9999 (last merge round=91)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6026586640686171, 'auprc': 0.8084345794675651, 'loss_val': 1.0356895042415921, 'psi': 0.6849690302281963}-{'f1_val': 0.8273883473734873, 'auprc': 0.9267825237431652, 'loss_val': 0.3523406472213039, 'psi': 0.8671460179213585}
[S7] START round=95 head_norm_before_train=2.001059 cos_to_last_merge=1.0000 (last merge round=94)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6747653292063895, 'auprc': 0.7548363095186101, 'loss_val': 1.2603428660332843, 'psi': 0.7067937213312778}-{'f1_val': 0.7741739655827609, 'auprc': 0.9058325601501416, 'loss_val': 0.7518128295102243, 'psi': 0.8268374034097131}
[S8] START round=95 head_norm_before_train=2.508149 cos_to_last_merge=1.0000 (last merge round=92)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9974993535273301, 'auprc': 0.9978599811010118, 'loss_val': 0.01569345330139607, 'psi': 0.9976436045568028}-{'f1_val': 0.9974993535273301, 'auprc': 0.9979138909266598, 'loss_val': 0.015795770439799583, 'psi': 0.997665168487062}
[S9] START round=95 head_norm_before_train=2.417274 (no previous merge yet)
[S9] round=95 local utility u=0.006787 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999630708173647, 'loss_val': 0.01648889135342621, 'psi': 0.9979815354152808}-{'f1_val': 0.994988868793922, 'auprc': 0.9999732625753991, 'loss_val': 0.02006460433203873, 'psi': 0.9969826263065129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=95 head_norm_before_train=2.385675 cos_to_last_merge=0.9950 (last merge round=58)
[S10] round=95 local utility u=0.001227 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9978719416914443, 'loss_val': 0.02649152549684856, 'psi': 0.9959219852889895}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968839389685238, 'loss_val': 0.026236344559422316, 'psi': 0.9955522085930594}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=95 head_norm_before_train=1.904797 cos_to_last_merge=1.0000 (last merge round=93)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962880448753332, 'loss_val': 0.025770420990453277, 'psi': 0.9961954228981189}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963682728113428, 'loss_val': 0.022974461664592997, 'psi': 0.9962275140725227}
[S13] START round=95 head_norm_before_train=1.990808 cos_to_last_merge=0.9910 (last merge round=57)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6443890436363818, 'auprc': 0.8081251336293079, 'loss_val': 1.2683669724992759, 'psi': 0.7098834796335523}-{'f1_val': 0.6929604029699507, 'auprc': 0.8159333025788342, 'loss_val': 1.1346231229828159, 'psi': 0.7421495628135041}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=1.902625 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=95 local utility u=0.000035 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9983908858653251, 'loss_val': 0.01846930454375815, 'psi': 0.9976708273062224}-{'f1_val': 0.9974109942678281, 'auprc': 0.9981529081124383, 'loss_val': 0.019145893479588644, 'psi': 0.9977077598056723}
[S15] START round=95 head_norm_before_train=2.137111 cos_to_last_merge=0.9967 (last merge round=58)
[S15] round=95 local utility u=0.430386 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.991078044166172, 'loss_val': 0.025648823443153078, 'psi': 0.9942565258526626}-{'f1_val': 0.8934756177323443, 'auprc': 0.9957043453202277, 'loss_val': 0.2829006418501402, 'psi': 0.9343671087674976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=95 head_norm_before_train=2.165294 cos_to_last_merge=0.9592 (last merge round=45)
[S16] round=95 local utility u=0.004322 metrics={'f1_val': 0.9944174378325453, 'auprc': 0.9899794209338681, 'loss_val': 0.030645147660710324, 'psi': 0.9926422310730745}-{'f1_val': 0.9931776155203599, 'auprc': 0.9900457557530548, 'loss_val': 0.03204951111009657, 'psi': 0.9919248716134378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=95 head_norm_before_train=1.904812 cos_to_last_merge=1.0000 (last merge round=94)
[S17] round=95 local utility u=0.316099 metrics={'f1_val': 0.8938449555225438, 'auprc': 0.9790580499648485, 'loss_val': 0.44572232519526006, 'psi': 0.9279301932994657}-{'f1_val': 0.8288798118338776, 'auprc': 0.9610166938458801, 'loss_val': 0.63400528137071, 'psi': 0.8817345646386786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:41912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.950)
[S4] ⇄ pheromone p=0.045 → S7@127.0.0.1:41908
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] ⇄ pheromone p=0.003 → S3@127.0.0.1:41903
[S7] ⇄ pheromone p=0.212 → S4@127.0.0.1:41904
[S14] sending update (kind=head size=1791 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] ⇄ pheromone p=0.211 → S17@127.0.0.1:41917
[S11] ⇄ pheromone p=0.001 → S14@127.0.0.1:41914
[S6] RECEIVED delta(kind=head bytes=1797) from S17
[S6] cosine check vs S17: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1791) from S14
[S11] cosine check vs S14: cos=1.0000
[S14] ⇄ pheromone p=0.020 → S11@127.0.0.1:41912
[S17] ⇄ pheromone p=0.186 → S6@127.0.0.1:41907
[S3] ⇄ pheromone p=0.228 → S8@127.0.0.1:41909
[S2] START round=96 head_norm_before_train=2.059522 cos_to_last_merge=0.9926 (last merge round=58)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.8302102349695333, 'auprc': 0.9695448782265691, 'loss_val': 0.4433585645799687, 'psi': 0.8859440922723476}-{'f1_val': 0.8270806092238246, 'auprc': 0.9926498154538161, 'loss_val': 0.45934804976335625, 'psi': 0.8933082917158213}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.511510 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.7070314081585989, 'auprc': 0.902334585692794, 'loss_val': 0.6795717451950535, 'psi': 0.7851526791722769}-{'f1_val': 0.9967161732642108, 'auprc': 0.9991860660984301, 'loss_val': 0.02084164331400003, 'psi': 0.9977041303978986}
[S4] START round=96 head_norm_before_train=2.004294 cos_to_last_merge=1.0000 (last merge round=94)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9414704602221309, 'auprc': 0.958310316991155, 'loss_val': 0.3417901736389628, 'psi': 0.9482064029297405}-{'f1_val': 0.9420245674831883, 'auprc': 0.9627471624206143, 'loss_val': 0.33846504999140814, 'psi': 0.9503136054581587}
[S5] START round=96 head_norm_before_train=2.394293 (no previous merge yet)
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9934636979067897, 'loss_val': 0.01763802969963537, 'psi': 0.9955823211395298}-{'f1_val': 0.99736232676063, 'auprc': 0.9996134132767033, 'loss_val': 0.01142885598120571, 'psi': 0.9982627613670594}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.923925 cos_to_last_merge=0.9998 (last merge round=91)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.5971618408082394, 'auprc': 0.8111759945129688, 'loss_val': 1.0410176887516946, 'psi': 0.6827675022901312}-{'f1_val': 0.6026586640686171, 'auprc': 0.8084345794675651, 'loss_val': 1.0356895042415921, 'psi': 0.6849690302281963}
[S7] START round=96 head_norm_before_train=2.020139 cos_to_last_merge=0.9999 (last merge round=94)
[S7] round=96 local utility u=0.809254 metrics={'f1_val': 0.8048447836676634, 'auprc': 0.8739238153285495, 'loss_val': 0.7795733126398007, 'psi': 0.8324763963320179}-{'f1_val': 0.6747653292063895, 'auprc': 0.7548363095186101, 'loss_val': 1.2603428660332843, 'psi': 0.7067937213312778}
[S8] START round=96 head_norm_before_train=2.514908 cos_to_last_merge=1.0000 (last merge round=92)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9959385679342783, 'auprc': 0.9981086937122792, 'loss_val': 0.021428585647679983, 'psi': 0.9968066182454787}-{'f1_val': 0.9974993535273301, 'auprc': 0.9978599811010118, 'loss_val': 0.01569345330139607, 'psi': 0.9976436045568028}
[S9] START round=96 head_norm_before_train=2.424869 (no previous merge yet)
[S9] round=96 local utility u=0.001513 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.999966854758648, 'loss_val': 0.015940171419626212, 'psi': 0.9982295898250793}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999630708173647, 'loss_val': 0.01648889135342621, 'psi': 0.9979815354152808}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=96 head_norm_before_train=2.390161 cos_to_last_merge=0.9950 (last merge round=58)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9971111908887978, 'loss_val': 0.026129376308003972, 'psi': 0.9956431093611691}-{'f1_val': 0.9946220143540194, 'auprc': 0.9978719416914443, 'loss_val': 0.02649152549684856, 'psi': 0.9959219852889895}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.910077 cos_to_last_merge=1.0000 (last merge round=93)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962421218113201, 'loss_val': 0.030998968196980725, 'psi': 0.9961770536725136}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962880448753332, 'loss_val': 0.025770420990453277, 'psi': 0.9961954228981189}
[S13] START round=96 head_norm_before_train=1.997311 cos_to_last_merge=0.9906 (last merge round=57)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6342173272827669, 'auprc': 0.773313644035943, 'loss_val': 1.1938542268879568, 'psi': 0.6898558539840374}-{'f1_val': 0.6443890436363818, 'auprc': 0.8081251336293079, 'loss_val': 1.2683669724992759, 'psi': 0.7098834796335523}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.907545 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=96 local utility u=0.000939 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9988940856423187, 'loss_val': 0.01810047176569969, 'psi': 0.9978721072170198}-{'f1_val': 0.9971907882668205, 'auprc': 0.9983908858653251, 'loss_val': 0.01846930454375815, 'psi': 0.9976708273062224}
[S15] START round=96 head_norm_before_train=2.141699 cos_to_last_merge=0.9966 (last merge round=58)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9955452312143894, 'auprc': 0.9932667697905119, 'loss_val': 0.032788749091914114, 'psi': 0.9946338466448383}-{'f1_val': 0.9963755136436562, 'auprc': 0.991078044166172, 'loss_val': 0.025648823443153078, 'psi': 0.9942565258526626}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.168411 cos_to_last_merge=0.9588 (last merge round=45)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9937127250269816, 'auprc': 0.9886850670337229, 'loss_val': 0.03420120540054195, 'psi': 0.9917016618296781}-{'f1_val': 0.9944174378325453, 'auprc': 0.9899794209338681, 'loss_val': 0.030645147660710324, 'psi': 0.9926422310730745}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=1.912638 cos_to_last_merge=1.0000 (last merge round=94)
[S17] round=96 local utility u=0.022697 metrics={'f1_val': 0.8970785739283696, 'auprc': 0.9838874916007899, 'loss_val': 0.43421910706481587, 'psi': 0.9318021409973378}-{'f1_val': 0.8938449555225438, 'auprc': 0.9790580499648485, 'loss_val': 0.44572232519526006, 'psi': 0.9279301932994657}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S17] not sending this round → trigger blocked (psi=0.932)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=96 metric=0.5972 head_norm=1.933025
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.324145e-02
[S6] stored merged vector for next round verification (round=96)
[S6] DEBUG after merge:  round=96 metric=0.5968 head_norm=1.922718 delta_norm=0.023241
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=96 metric=0.9959 head_norm=2.520713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.591768e-02
[S8] stored merged vector for next round verification (round=96)
[S8] DEBUG after merge:  round=96 metric=0.9959 head_norm=2.516066 delta_norm=0.015918
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=96 metric=0.9961 head_norm=1.915446
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.686146e-03
[S11] stored merged vector for next round verification (round=96)
[S11] DEBUG after merge:  round=96 metric=0.9961 head_norm=1.911475 delta_norm=0.009686
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9996
[S2] START round=97 head_norm_before_train=2.066346 cos_to_last_merge=0.9923 (last merge round=58)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7525004489395557, 'auprc': 0.9931939336970383, 'loss_val': 0.42538733397212514, 'psi': 0.8487778428425488}-{'f1_val': 0.8302102349695333, 'auprc': 0.9695448782265691, 'loss_val': 0.4433585645799687, 'psi': 0.8859440922723476}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.517737 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=97 local utility u=1.000000 metrics={'f1_val': 0.9724672806876119, 'auprc': 0.9985491144444791, 'loss_val': 0.06839350783553967, 'psi': 0.9829000141903588}-{'f1_val': 0.7070314081585989, 'auprc': 0.902334585692794, 'loss_val': 0.6795717451950535, 'psi': 0.7851526791722769}
[S4] START round=97 head_norm_before_train=2.006249 cos_to_last_merge=0.9999 (last merge round=94)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9410340612838491, 'auprc': 0.9571741571472592, 'loss_val': 0.3446873932691207, 'psi': 0.9474900996292132}-{'f1_val': 0.9414704602221309, 'auprc': 0.958310316991155, 'loss_val': 0.3417901736389628, 'psi': 0.9482064029297405}
[S5] START round=97 head_norm_before_train=2.400194 (no previous merge yet)
[S5] round=97 local utility u=0.011245 metrics={'f1_val': 0.998095816501524, 'auprc': 0.9998545883044678, 'loss_val': 0.020927532362583427, 'psi': 0.9987993252227015}-{'f1_val': 0.9969947366280233, 'auprc': 0.9934636979067897, 'loss_val': 0.01763802969963537, 'psi': 0.9955823211395298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=97 head_norm_before_train=1.922718 cos_to_last_merge=1.0000 (last merge round=96)
[S6] round=97 local utility u=0.515673 metrics={'f1_val': 0.7007292757351982, 'auprc': 0.9032560017256279, 'loss_val': 0.9073169675281264, 'psi': 0.7817399661313701}-{'f1_val': 0.5971618408082394, 'auprc': 0.8111759945129688, 'loss_val': 1.0410176887516946, 'psi': 0.6827675022901312}
[S7] START round=97 head_norm_before_train=2.035190 cos_to_last_merge=0.9997 (last merge round=94)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.7301321737601942, 'auprc': 0.7760582494713884, 'loss_val': 1.2423956749510678, 'psi': 0.7485026040446718}-{'f1_val': 0.8048447836676634, 'auprc': 0.8739238153285495, 'loss_val': 0.7795733126398007, 'psi': 0.8324763963320179}
[S8] START round=97 head_norm_before_train=2.516066 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9947714541180194, 'auprc': 0.9979188829427343, 'loss_val': 0.03575004493837374, 'psi': 0.9960304256479053}-{'f1_val': 0.9959385679342783, 'auprc': 0.9981086937122792, 'loss_val': 0.021428585647679983, 'psi': 0.9968066182454787}
[S9] START round=97 head_norm_before_train=2.421602 (no previous merge yet)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9962380931774885, 'auprc': 0.9999724801825363, 'loss_val': 0.018193491759795746, 'psi': 0.9977318479795075}-{'f1_val': 0.9970714132027002, 'auprc': 0.999966854758648, 'loss_val': 0.015940171419626212, 'psi': 0.9982295898250793}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.395193 cos_to_last_merge=0.9949 (last merge round=58)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9963227590847918, 'loss_val': 0.026100518469880495, 'psi': 0.9954594380921535}-{'f1_val': 0.9946643883427498, 'auprc': 0.9971111908887978, 'loss_val': 0.026129376308003972, 'psi': 0.9956431093611691}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=1.911475 cos_to_last_merge=1.0000 (last merge round=96)
[S11] round=97 local utility u=0.002906 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961914294149157, 'loss_val': 0.025035230254768483, 'psi': 0.9961567767139519}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962421218113201, 'loss_val': 0.030998968196980725, 'psi': 0.9961770536725136}
[S13] START round=97 head_norm_before_train=2.002812 cos_to_last_merge=0.9902 (last merge round=57)
[S13] round=97 local utility u=0.750838 metrics={'f1_val': 0.768141346515423, 'auprc': 0.8096711914380609, 'loss_val': 0.6047943188340603, 'psi': 0.7847532844844782}-{'f1_val': 0.6342173272827669, 'auprc': 0.773313644035943, 'loss_val': 1.1938542268879568, 'psi': 0.6898558539840374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=97 head_norm_before_train=1.910859 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9972617020302783, 'auprc': 0.9987307310486165, 'loss_val': 0.027632059748478776, 'psi': 0.9978493136376135}-{'f1_val': 0.9971907882668205, 'auprc': 0.9988940856423187, 'loss_val': 0.01810047176569969, 'psi': 0.9978721072170198}
[S15] START round=97 head_norm_before_train=2.146761 cos_to_last_merge=0.9964 (last merge round=58)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9112051838134877, 'auprc': 0.9959907381762555, 'loss_val': 0.153663071145362, 'psi': 0.9451194055585949}-{'f1_val': 0.9955452312143894, 'auprc': 0.9932667697905119, 'loss_val': 0.032788749091914114, 'psi': 0.9946338466448383}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.171269 cos_to_last_merge=0.9585 (last merge round=45)
[S16] round=97 local utility u=0.006886 metrics={'f1_val': 0.9941972330021132, 'auprc': 0.9905591868653112, 'loss_val': 0.028958039375497676, 'psi': 0.9927420145473924}-{'f1_val': 0.9937127250269816, 'auprc': 0.9886850670337229, 'loss_val': 0.03420120540054195, 'psi': 0.9917016618296781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=97 head_norm_before_train=1.920285 cos_to_last_merge=1.0000 (last merge round=94)
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.7826815056525588, 'auprc': 0.9360674972128006, 'loss_val': 0.837913856027846, 'psi': 0.8440359022766555}-{'f1_val': 0.8970785739283696, 'auprc': 0.9838874916007899, 'loss_val': 0.43421910706481587, 'psi': 0.9318021409973378}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=97 metric=0.9410 head_norm=2.008503
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.283137e-02
[S4] stored merged vector for next round verification (round=97)
[S4] DEBUG after merge:  round=97 metric=0.9410 head_norm=2.021624 delta_norm=0.032831
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9999
[S2] START round=98 head_norm_before_train=2.071754 cos_to_last_merge=0.9921 (last merge round=58)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7433275309466303, 'auprc': 0.9923363982545895, 'loss_val': 0.42733772630390743, 'psi': 0.842931077869814}-{'f1_val': 0.7525004489395557, 'auprc': 0.9931939336970383, 'loss_val': 0.42538733397212514, 'psi': 0.8487778428425488}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.523954 cos_to_last_merge=1.0000 (last merge round=94)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.8101987250826911, 'auprc': 0.9330065076874783, 'loss_val': 0.45452512508943677, 'psi': 0.8593218381246059}-{'f1_val': 0.9724672806876119, 'auprc': 0.9985491144444791, 'loss_val': 0.06839350783553967, 'psi': 0.9829000141903588}
[S4] START round=98 head_norm_before_train=2.021624 cos_to_last_merge=1.0000 (last merge round=97)
[S4] round=98 local utility u=0.053618 metrics={'f1_val': 0.9517346773001609, 'auprc': 0.9657280975544523, 'loss_val': 0.32731603321685504, 'psi': 0.9573320454018776}-{'f1_val': 0.9410340612838491, 'auprc': 0.9571741571472592, 'loss_val': 0.3446873932691207, 'psi': 0.9474900996292132}
[S5] START round=98 head_norm_before_train=2.405533 (no previous merge yet)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9957736808174495, 'loss_val': 0.012800980541128664, 'psi': 0.9965063143037938}-{'f1_val': 0.998095816501524, 'auprc': 0.9998545883044678, 'loss_val': 0.020927532362583427, 'psi': 0.9987993252227015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=1.930051 cos_to_last_merge=1.0000 (last merge round=96)
[S6] round=98 local utility u=0.519780 metrics={'f1_val': 0.7950906131082316, 'auprc': 0.9495958434633927, 'loss_val': 0.5729437292270091, 'psi': 0.856892705250296}-{'f1_val': 0.7007292757351982, 'auprc': 0.9032560017256279, 'loss_val': 0.9073169675281264, 'psi': 0.7817399661313701}
[S7] START round=98 head_norm_before_train=2.048017 cos_to_last_merge=0.9995 (last merge round=94)
[S7] round=98 local utility u=0.251652 metrics={'f1_val': 0.7805320598866764, 'auprc': 0.7992018421430858, 'loss_val': 1.1109226872257223, 'psi': 0.7879999727892402}-{'f1_val': 0.7301321737601942, 'auprc': 0.7760582494713884, 'loss_val': 1.2423956749510678, 'psi': 0.7485026040446718}
[S8] START round=98 head_norm_before_train=2.521514 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=98 local utility u=0.001173 metrics={'f1_val': 0.9944850079086928, 'auprc': 0.9977824809916132, 'loss_val': 0.03127527331219092, 'psi': 0.9958039971418609}-{'f1_val': 0.9947714541180194, 'auprc': 0.9979188829427343, 'loss_val': 0.03575004493837374, 'psi': 0.9960304256479053}
[S9] START round=98 head_norm_before_train=2.423572 (no previous merge yet)
[S9] round=98 local utility u=0.003915 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999633109273828, 'loss_val': 0.01552582481986043, 'psi': 0.9982470718782388}-{'f1_val': 0.9962380931774885, 'auprc': 0.9999724801825363, 'loss_val': 0.018193491759795746, 'psi': 0.9977318479795075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=98 head_norm_before_train=2.400479 cos_to_last_merge=0.9949 (last merge round=58)
[S10] round=98 local utility u=0.000294 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9965238096204669, 'loss_val': 0.026116089846413552, 'psi': 0.9955398583064236}-{'f1_val': 0.9948838907637279, 'auprc': 0.9963227590847918, 'loss_val': 0.026100518469880495, 'psi': 0.9954594380921535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=98 head_norm_before_train=1.917599 cos_to_last_merge=1.0000 (last merge round=96)
[S11] round=98 local utility u=0.003284 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975267004846032, 'loss_val': 0.022472056226073574, 'psi': 0.9966908851418269}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961914294149157, 'loss_val': 0.025035230254768483, 'psi': 0.9961567767139519}
[S13] START round=98 head_norm_before_train=2.006435 cos_to_last_merge=0.9900 (last merge round=57)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6102276813584673, 'auprc': 0.8030331458094644, 'loss_val': 1.3635023561932444, 'psi': 0.6873498671388661}-{'f1_val': 0.768141346515423, 'auprc': 0.8096711914380609, 'loss_val': 0.6047943188340603, 'psi': 0.7847532844844782}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=1.912739 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9828008311927527, 'auprc': 0.9987702904697258, 'loss_val': 0.04632119765038205, 'psi': 0.989188614903542}-{'f1_val': 0.9972617020302783, 'auprc': 0.9987307310486165, 'loss_val': 0.027632059748478776, 'psi': 0.9978493136376135}
[S15] START round=98 head_norm_before_train=2.152065 cos_to_last_merge=0.9963 (last merge round=58)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.900471005325273, 'auprc': 0.9957923649419641, 'loss_val': 0.25132287786378815, 'psi': 0.9385995491719494}-{'f1_val': 0.9112051838134877, 'auprc': 0.9959907381762555, 'loss_val': 0.153663071145362, 'psi': 0.9451194055585949}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.174666 cos_to_last_merge=0.9582 (last merge round=45)
[S16] round=98 local utility u=0.000054 metrics={'f1_val': 0.9935437223046116, 'auprc': 0.9922600535503916, 'loss_val': 0.03003253867146305, 'psi': 0.9930302548029236}-{'f1_val': 0.9941972330021132, 'auprc': 0.9905591868653112, 'loss_val': 0.028958039375497676, 'psi': 0.9927420145473924}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=98 head_norm_before_train=1.926572 cos_to_last_merge=1.0000 (last merge round=94)
[S17] round=98 local utility u=0.395763 metrics={'f1_val': 0.8489674155192115, 'auprc': 0.9713865220509238, 'loss_val': 0.5500607313160154, 'psi': 0.8979350581318964}-{'f1_val': 0.7826815056525588, 'auprc': 0.9360674972128006, 'loss_val': 0.837913856027846, 'psi': 0.8440359022766555}
[S6] not sending this round → trigger blocked (psi=0.857)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=98 metric=0.9828 head_norm=1.917295
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.565809e-03
[S14] stored merged vector for next round verification (round=98)
[S14] DEBUG after merge:  round=98 metric=0.9832 head_norm=1.917427 delta_norm=0.008566
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9996
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9996
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=98 metric=0.9517 head_norm=2.024912
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.272675e-02
[S4] stored merged vector for next round verification (round=98)
[S4] DEBUG after merge:  round=98 metric=0.9517 head_norm=2.041486 delta_norm=0.032727
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=98 metric=0.9945 head_norm=2.526109
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.531157e-02
[S8] stored merged vector for next round verification (round=98)
[S8] DEBUG after merge:  round=98 metric=0.9945 head_norm=2.524985 delta_norm=0.015312
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=98 metric=0.8490 head_norm=1.931954
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.809505e-02
[S17] stored merged vector for next round verification (round=98)
[S17] DEBUG after merge:  round=98 metric=0.8487 head_norm=1.930918 delta_norm=0.018095
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=98 metric=0.7805 head_norm=2.058448
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.272676e-02
[S7] stored merged vector for next round verification (round=98)
[S7] DEBUG after merge:  round=98 metric=0.7804 head_norm=2.041486 delta_norm=0.032727
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=2.076705 cos_to_last_merge=0.9919 (last merge round=58)
[S2] round=99 local utility u=0.017573 metrics={'f1_val': 0.7502651399561451, 'auprc': 0.9926552644082415, 'loss_val': 0.4347733986664442, 'psi': 0.8472211897369837}-{'f1_val': 0.7433275309466303, 'auprc': 0.9923363982545895, 'loss_val': 0.42733772630390743, 'psi': 0.842931077869814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S2] r=100 psi=0.847 u=0.0176 p_local=0.0238 f1=0.750 auprc=0.993 bytes=71993
[S3] START round=99 head_norm_before_train=2.529289 cos_to_last_merge=0.9999 (last merge round=94)
[S3] round=99 local utility u=0.762657 metrics={'f1_val': 0.9690389971161167, 'auprc': 0.9974071168054476, 'loss_val': 0.07545519605870847, 'psi': 0.9803862449918491}-{'f1_val': 0.8101987250826911, 'auprc': 0.9330065076874783, 'loss_val': 0.45452512508943677, 'psi': 0.8593218381246059}
[S4] START round=99 head_norm_before_train=2.041486 cos_to_last_merge=1.0000 (last merge round=98)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9403006028207862, 'auprc': 0.9494572245235513, 'loss_val': 0.3515757066137091, 'psi': 0.9439632515018922}-{'f1_val': 0.9517346773001609, 'auprc': 0.9657280975544523, 'loss_val': 0.32731603321685504, 'psi': 0.9573320454018776}
[S5] START round=99 head_norm_before_train=2.412207 (no previous merge yet)
[S5] round=99 local utility u=0.009075 metrics={'f1_val': 0.9977293526688911, 'auprc': 0.9999809869994409, 'loss_val': 0.011681519339542734, 'psi': 0.9986300064011111}-{'f1_val': 0.9969947366280233, 'auprc': 0.9957736808174495, 'loss_val': 0.012800980541128664, 'psi': 0.9965063143037938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S5] r=100 psi=0.999 u=0.0091 p_local=0.0039 f1=0.998 auprc=1.000 bytes=77260
[S6] START round=99 head_norm_before_train=1.938188 cos_to_last_merge=1.0000 (last merge round=96)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.6893222526667977, 'auprc': 0.9345171470831265, 'loss_val': 0.9114831066713569, 'psi': 0.7874002104333292}-{'f1_val': 0.7950906131082316, 'auprc': 0.9495958434633927, 'loss_val': 0.5729437292270091, 'psi': 0.856892705250296}
[S7] START round=99 head_norm_before_train=2.041486 cos_to_last_merge=1.0000 (last merge round=98)
[S7] round=99 local utility u=0.213315 metrics={'f1_val': 0.7936644846441945, 'auprc': 0.8478112817847049, 'loss_val': 0.9089146598211028, 'psi': 0.8153232035003987}-{'f1_val': 0.7805320598866764, 'auprc': 0.7992018421430858, 'loss_val': 1.1109226872257223, 'psi': 0.7879999727892402}
[S8] START round=99 head_norm_before_train=2.524985 cos_to_last_merge=1.0000 (last merge round=98)
[S8] round=99 local utility u=0.006057 metrics={'f1_val': 0.9944850079086928, 'auprc': 0.9982512067914795, 'loss_val': 0.0205669596361324, 'psi': 0.9959914874618074}-{'f1_val': 0.9944850079086928, 'auprc': 0.9977824809916132, 'loss_val': 0.03127527331219092, 'psi': 0.9958039971418609}
[S9] START round=99 head_norm_before_train=2.429655 (no previous merge yet)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999658854904844, 'loss_val': 0.01586660477053891, 'psi': 0.9982481017034794}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999633109273828, 'loss_val': 0.01552582481986043, 'psi': 0.9982470718782388}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.998 u=0.0000 p_local=0.0017 f1=0.997 auprc=1.000 bytes=77226
[S10] START round=99 head_norm_before_train=2.403517 cos_to_last_merge=0.9947 (last merge round=58)
[S10] round=99 local utility u=0.000017 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9965314049225804, 'loss_val': 0.026104489175878456, 'psi': 0.9955428964272689}-{'f1_val': 0.9948838907637279, 'auprc': 0.9965238096204669, 'loss_val': 0.026116089846413552, 'psi': 0.9955398583064236}
[S10] not sending this round → trigger blocked (psi=0.996)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0003 f1=0.995 auprc=0.997 bytes=82699
[S11] START round=99 head_norm_before_train=1.923001 cos_to_last_merge=1.0000 (last merge round=96)
[S11] round=99 local utility u=0.000972 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977940535076918, 'loss_val': 0.021329247560414183, 'psi': 0.9967978263510623}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975267004846032, 'loss_val': 0.022472056226073574, 'psi': 0.9966908851418269}
[S13] START round=99 head_norm_before_train=2.009264 cos_to_last_merge=0.9898 (last merge round=57)
[S13] round=99 local utility u=0.097451 metrics={'f1_val': 0.6309566079553042, 'auprc': 0.7809359290504798, 'loss_val': 1.2266832207001641, 'psi': 0.6909483363933744}-{'f1_val': 0.6102276813584673, 'auprc': 0.8030331458094644, 'loss_val': 1.3635023561932444, 'psi': 0.6873498671388661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=100 psi=0.691 u=0.0975 p_local=0.1969 f1=0.631 auprc=0.781 bytes=77396
[S14] START round=99 head_norm_before_train=1.917427 cos_to_last_merge=1.0000 (last merge round=98)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9307028274855835, 'auprc': 0.9983789268432336, 'loss_val': 0.16022456811252073, 'psi': 0.9577732672286435}-{'f1_val': 0.9828008311927527, 'auprc': 0.9987702904697258, 'loss_val': 0.04632119765038205, 'psi': 0.989188614903542}
[S15] START round=99 head_norm_before_train=2.157300 cos_to_last_merge=0.9961 (last merge round=58)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.8958280027795023, 'auprc': 0.9957191592205713, 'loss_val': 0.2746308721819034, 'psi': 0.9357844653559299}-{'f1_val': 0.900471005325273, 'auprc': 0.9957923649419641, 'loss_val': 0.25132287786378815, 'psi': 0.9385995491719494}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.936 u=0.0000 p_local=0.0593 f1=0.896 auprc=0.996 bytes=72022
[S16] START round=99 head_norm_before_train=2.179066 cos_to_last_merge=0.9579 (last merge round=45)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9935437223046116, 'auprc': 0.9923735691822472, 'loss_val': 0.03056026631358018, 'psi': 0.9930756610556658}-{'f1_val': 0.9935437223046116, 'auprc': 0.9922600535503916, 'loss_val': 0.03003253867146305, 'psi': 0.9930302548029236}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.993 u=0.0000 p_local=0.0024 f1=0.994 auprc=0.992 bytes=82780
[S17] START round=99 head_norm_before_train=1.930918 cos_to_last_merge=1.0000 (last merge round=98)
[S17] round=99 local utility u=0.245792 metrics={'f1_val': 0.901617120408297, 'auprc': 0.9869125081805528, 'loss_val': 0.4209523478218189, 'psi': 0.9357352755171993}-{'f1_val': 0.8489674155192115, 'auprc': 0.9713865220509238, 'loss_val': 0.5500607313160154, 'psi': 0.8979350581318964}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S17] not sending this round → trigger blocked (psi=0.936)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → trigger blocked (psi=0.815)
[S7] r=100 psi=0.815 u=0.2133 p_local=0.2526 f1=0.794 auprc=0.848 bytes=75591
[S8] r=100 psi=0.996 u=0.0061 p_local=0.0028 f1=0.994 auprc=0.998 bytes=79108
[S14] r=100 psi=0.958 u=0.0000 p_local=0.0085 f1=0.931 auprc=0.998 bytes=79094
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] r=100 psi=0.944 u=0.0000 p_local=0.0269 f1=0.940 auprc=0.949 bytes=71992
[S17] r=100 psi=0.936 u=0.2458 p_local=0.1912 f1=0.902 auprc=0.987 bytes=73775
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=99 metric=0.6893 head_norm=1.949043
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.541145e-02
[S6] stored merged vector for next round verification (round=99)
[S6] DEBUG after merge:  round=99 metric=0.6893 head_norm=1.940351 delta_norm=0.025411
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] r=100 psi=0.787 u=0.0000 p_local=0.2357 f1=0.689 auprc=0.935 bytes=72029
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=0.9999
[S11] r=100 psi=0.997 u=0.0010 p_local=0.0016 f1=0.996 auprc=0.998 bytes=88057
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=99 metric=0.9690 head_norm=2.534618
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.903127e-02
[S3] stored merged vector for next round verification (round=99)
[S3] DEBUG after merge:  round=99 metric=0.9690 head_norm=2.530296 delta_norm=0.019031
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=100 psi=0.980 u=0.7627 p_local=0.3741 f1=0.969 auprc=0.997 bytes=73711
[runner] rounds complete.
[runner] all agents stopped.
