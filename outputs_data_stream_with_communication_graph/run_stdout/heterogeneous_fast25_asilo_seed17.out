[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:50303
[S3] → join 127.0.0.1:50302
[S4] → join 127.0.0.1:50302
[S5] → join 127.0.0.1:50302
[S6] → join 127.0.0.1:50302
[S7] → join 127.0.0.1:50302
[S8] → join 127.0.0.1:50302
[S9] → join 127.0.0.1:50302
[S10] → join 127.0.0.1:50302
[S11] → join 127.0.0.1:50302
[S13] → join 127.0.0.1:50302
[S14] → join 127.0.0.1:50302
[S15] → join 127.0.0.1:50302
[S16] → join 127.0.0.1:50302
[S17] → join 127.0.0.1:50302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.164730 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.172372 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.140069 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.248955 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.170924 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.192895 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.140121 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.119841 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.176307 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.212647 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.148943 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.172682 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.177628 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.148140 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.168458 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S11
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S4
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S7
[S5] + discovered S3
[S4] + discovered S11
[S5] + discovered S4
[S5] + discovered S2
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S15
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S13
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S7
[S6] + discovered S14
[S7] + discovered S2
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S9
[S8] + discovered S2
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S16
[S8] + discovered S5
[S8] + discovered S6
[S7] + discovered S13
[S8] + discovered S4
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S10
[S8] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S16
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S15
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S11
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S8
[S9] + discovered S14
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S4
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S11
[S11] + discovered S13
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S8
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S14
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S10
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S3
[S15] + discovered S4
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S11
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S8
[S16] + discovered S10
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S2
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S5
[S16] + discovered S17
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:50311
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:50307
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:50304
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:50313
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:50305
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:50314
[S2] START round=1 head_norm_before_train=1.161447 (no previous merge yet)
[S2] round=1 local utility u=0.190780 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5138761967755482, 'loss_val': 1.330487194912347, 'psi': 0.2906167587433593}-{'f1_val': 0.1417771333885667, 'auprc': 0.3981316608420724, 'loss_val': 1.3648143559828303, 'psi': 0.24431894436996898}
[S3] START round=1 head_norm_before_train=1.182040 (no previous merge yet)
[S3] round=1 local utility u=0.462131 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.792974161843135, 'loss_val': 1.2950615683435347, 'psi': 0.4010937041057182}-{'f1_val': 0.13984006561410703, 'auprc': 0.5011038856391434, 'loss_val': 1.3437118143830826, 'psi': 0.2843455936241216}
[S4] START round=1 head_norm_before_train=1.146270 (no previous merge yet)
[S4] round=1 local utility u=0.849602 metrics={'f1_val': 0.4143997657321641, 'auprc': 0.7608787323529811, 'loss_val': 1.319368962559354, 'psi': 0.5529913523804909}-{'f1_val': 0.14090945936924823, 'auprc': 0.7526340874770299, 'loss_val': 1.3528963953056619, 'psi': 0.38559931061236086}
[S5] START round=1 head_norm_before_train=1.248659 (no previous merge yet)
[S5] round=1 local utility u=0.480973 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7320610844105777, 'loss_val': 1.2903872921647588, 'psi': 0.37818157662137397}-{'f1_val': 0.14226190476190476, 'auprc': 0.42483220264179344, 'loss_val': 1.3306463413245813, 'psi': 0.25529002391386024}
[S6] START round=1 head_norm_before_train=1.169083 (no previous merge yet)
[S6] round=1 local utility u=0.082095 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.841837135205018, 'loss_val': 1.314896796740736, 'psi': 0.4215906233127764}-{'f1_val': 0.14142628205128205, 'auprc': 0.7962169216348742, 'loss_val': 1.3422265492171646, 'psi': 0.4033425378847189}
[S7] START round=1 head_norm_before_train=1.198614 (no previous merge yet)
[S7] round=1 local utility u=0.271575 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875379606030171, 'loss_val': 1.2808044803545668, 'psi': 0.4002492778786618}-{'f1_val': 0.14205682272909165, 'auprc': 0.6255451218421406, 'loss_val': 1.3379761665136936, 'psi': 0.33545214237431126}
[S8] START round=1 head_norm_before_train=1.151999 (no previous merge yet)
[S8] round=1 local utility u=0.272077 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6630784192918256, 'loss_val': 1.3012048058994015, 'psi': 0.3492049571525046}-{'f1_val': 0.13995598239295717, 'auprc': 0.4923578840138172, 'loss_val': 1.3331981631030954, 'psi': 0.2809167430413012}
[S9] START round=1 head_norm_before_train=1.116832 (no previous merge yet)
[S9] round=1 local utility u=0.485467 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9868948150246198, 'loss_val': 1.277305886827641, 'psi': 0.47959670029384555}-{'f1_val': 0.141397957139996, 'auprc': 0.6865058073721811, 'loss_val': 1.3470724863491712, 'psi': 0.3594410972328701}
[S10] START round=1 head_norm_before_train=1.186980 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7693299112787321, 'loss_val': 1.3188317465162331, 'psi': 0.39090494703652723}-{'f1_val': 0.39485879514309763, 'auprc': 0.7657505566700928, 'loss_val': 1.356574330599633, 'psi': 0.5432154997538957}
[S11] START round=1 head_norm_before_train=1.214082 (no previous merge yet)
[S11] round=1 local utility u=0.270015 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7711067131267892, 'loss_val': 1.3433128491125919, 'psi': 0.39269089527458206}-{'f1_val': 0.14041368337311058, 'auprc': 0.6007836130848974, 'loss_val': 1.3723725932260467, 'psi': 0.3245616552578253}
[S13] START round=1 head_norm_before_train=1.153698 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5766211936575837, 'loss_val': 1.313685315902724, 'psi': 0.31487993500926537}-{'f1_val': 0.1403857625770531, 'auprc': 0.6063923342839861, 'loss_val': 1.3433706071418514, 'psi': 0.3267883912598263}
[S14] START round=1 head_norm_before_train=1.177354 (no previous merge yet)
[S14] round=1 local utility u=0.230998 metrics={'f1_val': 0.1038107752956636, 'auprc': 0.6334329591843779, 'loss_val': 1.3462874984812025, 'psi': 0.31565964885114933}-{'f1_val': 0.1038107752956636, 'auprc': 0.4871063128223786, 'loss_val': 1.3693037398464778, 'psi': 0.2571289903063496}
[S15] START round=1 head_norm_before_train=1.182127 (no previous merge yet)
[S15] round=1 local utility u=0.894166 metrics={'f1_val': 0.38471133285816106, 'auprc': 0.7669247620711187, 'loss_val': 1.3323871275191068, 'psi': 0.5375967045433441}-{'f1_val': 0.09269662921348315, 'auprc': 0.7634815070562153, 'loss_val': 1.3583015789021282, 'psi': 0.36101058035057604}
[S16] START round=1 head_norm_before_train=1.156498 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8114355407865494, 'loss_val': 1.320960351333622, 'psi': 0.40895668643414174}-{'f1_val': 0.1536118363794604, 'auprc': 0.8012568363429715, 'loss_val': 1.3549042996410854, 'psi': 0.4126698363648649}
[S17] START round=1 head_norm_before_train=1.173651 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.20613476296897024, 'auprc': 0.6473386988974412, 'loss_val': 1.338901504677261, 'psi': 0.3826163373403586}-{'f1_val': 0.3273124786240981, 'auprc': 0.5926270504656632, 'loss_val': 1.3671483614431303, 'psi': 0.4334383073607242}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:50302
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S15] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S16@127.0.0.1:50316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:50307
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1784 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S6
[S2] cosine check vs S6: cos=-0.0285
[S2] DROPPED delta from S6 (cos=-0.0285 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1784) from S15
[S2] cosine check vs S15: cos=-0.0183
[S2] DROPPED delta from S15 (cos=-0.0183 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S4
[S8] cosine check vs S4: cos=0.0840
[S2] RECEIVED delta(kind=head bytes=1788) from S14
[S2] cosine check vs S14: cos=-0.0291
[S2] DROPPED delta from S14 (cos=-0.0291 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S8
[S11] cosine check vs S8: cos=-0.0580
[S11] DROPPED delta from S8 (cos=-0.0580 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1784) from S5
[S16] cosine check vs S5: cos=0.0148
[S13] RECEIVED delta(kind=head bytes=1792) from S9
[S13] cosine check vs S9: cos=0.0022
[S6] RECEIVED delta(kind=head bytes=1789) from S7
[S6] cosine check vs S7: cos=-0.0662
[S6] DROPPED delta from S7 (cos=-0.0662 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S2
[S3] cosine check vs S2: cos=-0.0912
[S3] DROPPED delta from S2 (cos=-0.0912 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1788) from S11
[S2] cosine check vs S11: cos=0.0368
[S5] RECEIVED delta(kind=head bytes=1791) from S3
[S5] cosine check vs S3: cos=0.0229
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.167002
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.175986e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.819382 delta_norm=0.817599
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.270968
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.684815e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.888561 delta_norm=0.868482
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.172062
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.315595e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.862701 delta_norm=0.831560
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.171494
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.903887e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.859859 delta_norm=0.790389
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.174025
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.586944e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.871488 delta_norm=0.858694
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.862701 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.087593 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5700668812201615, 'loss_val': 1.3238724169915488, 'psi': 0.31309303252120463}-{'f1_val': 0.1417771333885667, 'auprc': 0.5138761967755482, 'loss_val': 1.330487194912347, 'psi': 0.2906167587433593}
[S3] START round=2 head_norm_before_train=1.213359 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6770887043301574, 'loss_val': 1.2266684203682843, 'psi': 0.3547395211005272}-{'f1_val': 0.13984006561410703, 'auprc': 0.792974161843135, 'loss_val': 1.2950615683435347, 'psi': 0.4010937041057182}
[S4] START round=2 head_norm_before_train=1.164364 (no previous merge yet)
[S4] round=2 local utility u=0.022301 metrics={'f1_val': 0.41509365263807463, 'auprc': 0.7605836780592024, 'loss_val': 1.2780450599301052, 'psi': 0.5532896628065257}-{'f1_val': 0.4143997657321641, 'auprc': 0.7608787323529811, 'loss_val': 1.319368962559354, 'psi': 0.5529913523804909}
[S5] START round=2 head_norm_before_train=0.888561 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287393280075924, 'loss_val': 1.2804901838455405, 'psi': 0.37685287406017987}-{'f1_val': 0.14226190476190476, 'auprc': 0.7320610844105777, 'loss_val': 1.2903872921647588, 'psi': 0.37818157662137397}
[S6] START round=2 head_norm_before_train=1.177698 (no previous merge yet)
[S6] round=2 local utility u=0.010683 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8399525185622368, 'loss_val': 1.2878769600853348, 'psi': 0.420836776655664}-{'f1_val': 0.14142628205128205, 'auprc': 0.841837135205018, 'loss_val': 1.314896796740736, 'psi': 0.4215906233127764}
[S7] START round=2 head_norm_before_train=1.228639 (no previous merge yet)
[S7] round=2 local utility u=0.027232 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7885141872108983, 'loss_val': 1.229269301919916, 'psi': 0.4006397685218143}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875379606030171, 'loss_val': 1.2808044803545668, 'psi': 0.4002492778786618}
[S8] START round=2 head_norm_before_train=0.859859 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.089799 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7206094868738242, 'loss_val': 1.2942009246680277, 'psi': 0.37221738418530403}-{'f1_val': 0.13995598239295717, 'auprc': 0.6630784192918256, 'loss_val': 1.3012048058994015, 'psi': 0.3492049571525046}
[S9] START round=2 head_norm_before_train=1.147962 (no previous merge yet)
[S9] round=2 local utility u=0.072892 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9999203532948395, 'loss_val': 1.17059781039237, 'psi': 0.48480691560193345}-{'f1_val': 0.141397957139996, 'auprc': 0.9868948150246198, 'loss_val': 1.277305886827641, 'psi': 0.47959670029384555}
[S10] START round=2 head_norm_before_train=1.206334 (no previous merge yet)
[S10] round=2 local utility u=0.022924 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7709498449963523, 'loss_val': 1.2778441428660199, 'psi': 0.3915529205235753}-{'f1_val': 0.13862163754172394, 'auprc': 0.7693299112787321, 'loss_val': 1.3188317465162331, 'psi': 0.39090494703652723}
[S11] START round=2 head_norm_before_train=1.223830 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7599953450339823, 'loss_val': 1.3114508911308271, 'psi': 0.3882463480374593}-{'f1_val': 0.14041368337311058, 'auprc': 0.7711067131267892, 'loss_val': 1.3433128491125919, 'psi': 0.39269089527458206}
[S13] START round=2 head_norm_before_train=0.819382 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.213811 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7221538418204057, 'loss_val': 1.322660777267127, 'psi': 0.37309299427439413}-{'f1_val': 0.1403857625770531, 'auprc': 0.5766211936575837, 'loss_val': 1.313685315902724, 'psi': 0.31487993500926537}
[S14] START round=2 head_norm_before_train=1.188544 (no previous merge yet)
[S14] round=2 local utility u=1.000000 metrics={'f1_val': 0.39639674314244955, 'auprc': 0.7352384159810813, 'loss_val': 1.3197801727303256, 'psi': 0.5319334122779023}-{'f1_val': 0.1038107752956636, 'auprc': 0.6334329591843779, 'loss_val': 1.3462874984812025, 'psi': 0.31565964885114933}
[S15] START round=2 head_norm_before_train=1.193172 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7699650438493534, 'loss_val': 1.299058358317637, 'psi': 0.39182620835667636}-{'f1_val': 0.38471133285816106, 'auprc': 0.7669247620711187, 'loss_val': 1.3323871275191068, 'psi': 0.5375967045433441}
[S16] START round=2 head_norm_before_train=0.871488 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.028552 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8249526892617428, 'loss_val': 1.3044082184621222, 'psi': 0.4143635458242191}-{'f1_val': 0.14063745019920318, 'auprc': 0.8114355407865494, 'loss_val': 1.320960351333622, 'psi': 0.40895668643414174}
[S17] START round=2 head_norm_before_train=1.187008 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6671729739152437, 'loss_val': 1.3067465267279779, 'psi': 0.3514385675565281}-{'f1_val': 0.20613476296897024, 'auprc': 0.6473386988974412, 'loss_val': 1.338901504677261, 'psi': 0.3826163373403586}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[S7] not sending this round → trigger blocked (psi=0.401)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.372)
[S14] not sending this round → trigger blocked (psi=0.532)
[S2] not sending this round → trigger blocked (psi=0.313)
[S6] not sending this round → trigger blocked (psi=0.421)
[S9] not sending this round → trigger blocked (psi=0.485)
[S4] not sending this round → trigger blocked (psi=0.553)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:50314
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.0437
[S5] DROPPED delta from S10 (cos=-0.0437 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=-0.0244
[S14] DROPPED delta from S16 (cos=-0.0244 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S13
[S3] cosine check vs S13: cos=0.0024
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.266114
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.568681e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.758522 delta_norm=0.756868
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.879057 cos_to_last_merge=0.9967 (last merge round=1)
[S2] round=3 local utility u=0.212102 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6981541652061347, 'loss_val': 1.2839310935704709, 'psi': 0.36432794611559394}-{'f1_val': 0.1417771333885667, 'auprc': 0.5700668812201615, 'loss_val': 1.3238724169915488, 'psi': 0.31309303252120463}
[S3] START round=3 head_norm_before_train=0.758522 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.140685 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7565472882019295, 'loss_val': 1.1836751446635618, 'psi': 0.38652295464923603}-{'f1_val': 0.13984006561410703, 'auprc': 0.6770887043301574, 'loss_val': 1.2266684203682843, 'psi': 0.3547395211005272}
[S4] START round=3 head_norm_before_train=1.192918 (no previous merge yet)
[S4] round=3 local utility u=0.762565 metrics={'f1_val': 0.6590037095224106, 'auprc': 0.7603736706769907, 'loss_val': 1.2157445289810553, 'psi': 0.6995516939842427}-{'f1_val': 0.41509365263807463, 'auprc': 0.7605836780592024, 'loss_val': 1.2780450599301052, 'psi': 0.5532896628065257}
[S5] START round=3 head_norm_before_train=0.922177 cos_to_last_merge=0.9940 (last merge round=1)
[S5] round=3 local utility u=0.037327 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7368631380181347, 'loss_val': 1.230207519510447, 'psi': 0.3801023980643968}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287393280075924, 'loss_val': 1.2804901838455405, 'psi': 0.37685287406017987}
[S6] START round=3 head_norm_before_train=1.194779 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8104684453448132, 'loss_val': 1.2571463873868418, 'psi': 0.4090431473686945}-{'f1_val': 0.14142628205128205, 'auprc': 0.8399525185622368, 'loss_val': 1.2878769600853348, 'psi': 0.420836776655664}
[S7] START round=3 head_norm_before_train=1.262123 (no previous merge yet)
[S7] round=3 local utility u=0.606285 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.6083934107993779, 'loss_val': 1.1264631754004306, 'psi': 0.49360407552995744}-{'f1_val': 0.14205682272909165, 'auprc': 0.7885141872108983, 'loss_val': 1.229269301919916, 'psi': 0.4006397685218143}
[S8] START round=3 head_norm_before_train=0.885666 cos_to_last_merge=0.9970 (last merge round=1)
[S8] round=3 local utility u=0.070058 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7540815831445203, 'loss_val': 1.2545017376809107, 'psi': 0.38560622269358247}-{'f1_val': 0.13995598239295717, 'auprc': 0.7206094868738242, 'loss_val': 1.2942009246680277, 'psi': 0.37221738418530403}
[S9] START round=3 head_norm_before_train=1.204492 (no previous merge yet)
[S9] round=3 local utility u=0.113968 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9999715493792032, 'loss_val': 0.9428160714620398, 'psi': 0.4848273940356789}-{'f1_val': 0.141397957139996, 'auprc': 0.9999203532948395, 'loss_val': 1.17059781039237, 'psi': 0.48480691560193345}
[S10] START round=3 head_norm_before_train=1.232653 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7157280950272019, 'loss_val': 1.2377597344992393, 'psi': 0.36946422053591516}-{'f1_val': 0.13862163754172394, 'auprc': 0.7709498449963523, 'loss_val': 1.2778441428660199, 'psi': 0.3915529205235753}
[S11] START round=3 head_norm_before_train=1.240042 (no previous merge yet)
[S11] round=3 local utility u=0.020166 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7608409460664831, 'loss_val': 1.2736547650665102, 'psi': 0.3885845884504596}-{'f1_val': 0.14041368337311058, 'auprc': 0.7599953450339823, 'loss_val': 1.3114508911308271, 'psi': 0.3882463480374593}
[S13] START round=3 head_norm_before_train=0.832686 cos_to_last_merge=0.9975 (last merge round=1)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6438563193501463, 'loss_val': 1.2961653722025321, 'psi': 0.3417739852862904}-{'f1_val': 0.1403857625770531, 'auprc': 0.7221538418204057, 'loss_val': 1.322660777267127, 'psi': 0.37309299427439413}
[S14] START round=3 head_norm_before_train=1.209249 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7530063941407446, 'loss_val': 1.285891648779635, 'psi': 0.3854172693859201}-{'f1_val': 0.39639674314244955, 'auprc': 0.7352384159810813, 'loss_val': 1.3197801727303256, 'psi': 0.5319334122779023}
[S15] START round=3 head_norm_before_train=1.211354 (no previous merge yet)
[S15] round=3 local utility u=0.021306 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7714481653540992, 'loss_val': 1.2608965723496455, 'psi': 0.3924194569585747}-{'f1_val': 0.13973365136155833, 'auprc': 0.7699650438493534, 'loss_val': 1.299058358317637, 'psi': 0.39182620835667636}
[S16] START round=3 head_norm_before_train=0.893739 cos_to_last_merge=0.9971 (last merge round=1)
[S16] round=3 local utility u=0.051859 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8446113446340722, 'loss_val': 1.2596652419175232, 'psi': 0.4222270079731508}-{'f1_val': 0.14063745019920318, 'auprc': 0.8249526892617428, 'loss_val': 1.3044082184621222, 'psi': 0.4143635458242191}
[S17] START round=3 head_norm_before_train=1.208091 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6072244658444991, 'loss_val': 1.258294826786391, 'psi': 0.3274591643282303}-{'f1_val': 0.14094896331738438, 'auprc': 0.6671729739152437, 'loss_val': 1.3067465267279779, 'psi': 0.3514385675565281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:50311
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S16] not sending this round → trigger blocked (psi=0.422)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.5663
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=0.3833
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.7238
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=-0.0594
[S8] DROPPED delta from S7 (cos=-0.0594 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1789) from S11
[S10] cosine check vs S11: cos=-0.0191
[S10] DROPPED delta from S11 (cos=-0.0191 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S8
[S16] cosine check vs S8: cos=0.0549
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.0597
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=-0.1250
[S7] DROPPED delta from S15 (cos=-0.1250 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.0042
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.218436
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.118300e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.752234 delta_norm=0.711830
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=0.812730
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.462467e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.731810 delta_norm=0.346247
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.949772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.538084e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.656569 delta_norm=0.653808
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.914989
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.249806e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.998040 delta_norm=0.424981
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.926450
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.329273e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.668700 delta_norm=0.632927
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.902791 cos_to_last_merge=0.9885 (last merge round=1)
[S2] round=4 local utility u=0.066041 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7272944494245596, 'loss_val': 1.2392698133466158, 'psi': 0.3759840598029639}-{'f1_val': 0.1417771333885667, 'auprc': 0.6981541652061347, 'loss_val': 1.2839310935704709, 'psi': 0.36432794611559394}
[S3] START round=4 head_norm_before_train=0.731810 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.977794 metrics={'f1_val': 0.4210464679509158, 'auprc': 0.7961469127894493, 'loss_val': 1.0341252402670729, 'psi': 0.5710866458863293}-{'f1_val': 0.13984006561410703, 'auprc': 0.7565472882019295, 'loss_val': 1.1836751446635618, 'psi': 0.38652295464923603}
[S4] START round=4 head_norm_before_train=1.231333 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.4281869212888601, 'auprc': 0.7765173341959511, 'loss_val': 1.1017997756950941, 'psi': 0.5675190864516966}-{'f1_val': 0.6590037095224106, 'auprc': 0.7603736706769907, 'loss_val': 1.2157445289810553, 'psi': 0.6995516939842427}
[S5] START round=4 head_norm_before_train=0.656569 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.304573 metrics={'f1_val': 0.2137197024520624, 'auprc': 0.7723931922621291, 'loss_val': 1.156398731828198, 'psi': 0.4371890983760891}-{'f1_val': 0.14226190476190476, 'auprc': 0.7368631380181347, 'loss_val': 1.230207519510447, 'psi': 0.3801023980643968}
[S6] START round=4 head_norm_before_train=0.752234 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7458174820851472, 'loss_val': 1.2682621052621161, 'psi': 0.3831827620648281}-{'f1_val': 0.14142628205128205, 'auprc': 0.8104684453448132, 'loss_val': 1.2571463873868418, 'psi': 0.4090431473686945}
[S7] START round=4 head_norm_before_train=1.289598 (no previous merge yet)
[S7] round=4 local utility u=0.329711 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7483631559098023, 'loss_val': 0.8874311704781651, 'psi': 0.5496400545229849}-{'f1_val': 0.4170778520170104, 'auprc': 0.6083934107993779, 'loss_val': 1.1264631754004306, 'psi': 0.49360407552995744}
[S8] START round=4 head_norm_before_train=0.998040 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.037830 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.767973207016175, 'loss_val': 1.220516623421731, 'psi': 0.39116287224224433}-{'f1_val': 0.13995598239295717, 'auprc': 0.7540815831445203, 'loss_val': 1.2545017376809107, 'psi': 0.38560622269358247}
[S9] START round=4 head_norm_before_train=1.265499 (no previous merge yet)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9999965408733689, 'loss_val': 0.549393441665327, 'psi': 0.8210122056406217}-{'f1_val': 0.141397957139996, 'auprc': 0.9999715493792032, 'loss_val': 0.9428160714620398, 'psi': 0.4848273940356789}
[S10] START round=4 head_norm_before_train=1.260682 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6243629659947385, 'loss_val': 1.1795681465374135, 'psi': 0.3329181689229298}-{'f1_val': 0.13862163754172394, 'auprc': 0.7157280950272019, 'loss_val': 1.2377597344992393, 'psi': 0.36946422053591516}
[S11] START round=4 head_norm_before_train=1.260433 (no previous merge yet)
[S11] round=4 local utility u=0.021593 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7595891604143007, 'loss_val': 1.2267136541637507, 'psi': 0.3880838741895866}-{'f1_val': 0.14041368337311058, 'auprc': 0.7608409460664831, 'loss_val': 1.2736547650665102, 'psi': 0.3885845884504596}
[S13] START round=4 head_norm_before_train=0.852301 cos_to_last_merge=0.9904 (last merge round=1)
[S13] round=4 local utility u=0.014227 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6429354668156874, 'loss_val': 1.2649498106656638, 'psi': 0.3414056442725068}-{'f1_val': 0.1403857625770531, 'auprc': 0.6438563193501463, 'loss_val': 1.2961653722025321, 'psi': 0.3417739852862904}
[S14] START round=4 head_norm_before_train=1.239827 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6989591817030787, 'loss_val': 1.24683031736508, 'psi': 0.3637983844108537}-{'f1_val': 0.14035785288270378, 'auprc': 0.7530063941407446, 'loss_val': 1.285891648779635, 'psi': 0.3854172693859201}
[S15] START round=4 head_norm_before_train=1.239187 (no previous merge yet)
[S15] round=4 local utility u=0.025597 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7750743535135458, 'loss_val': 1.2205803179869092, 'psi': 0.39386993222235334}-{'f1_val': 0.13973365136155833, 'auprc': 0.7714481653540992, 'loss_val': 1.2608965723496455, 'psi': 0.3924194569585747}
[S16] START round=4 head_norm_before_train=0.668700 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7527053795742691, 'loss_val': 1.2407128315213325, 'psi': 0.3854646219492296}-{'f1_val': 0.14063745019920318, 'auprc': 0.8446113446340722, 'loss_val': 1.2596652419175232, 'psi': 0.4222270079731508}
[S17] START round=4 head_norm_before_train=1.236389 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5737537033921681, 'loss_val': 1.2064421858975531, 'psi': 0.3140708593472979}-{'f1_val': 0.14094896331738438, 'auprc': 0.6072244658444991, 'loss_val': 1.258294826786391, 'psi': 0.3274591643282303}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.571)
[S8] not sending this round → trigger blocked (psi=0.391)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.550)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.394)
[S9] not sending this round → trigger blocked (psi=0.821)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.437)
[S11] not sending this round → trigger blocked (psi=0.388)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.376)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.1410
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.701276
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.215085e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.598936 delta_norm=0.521509
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.935179 cos_to_last_merge=0.9773 (last merge round=1)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6108494729784572, 'loss_val': 1.2075268310198826, 'psi': 0.3294060692245229}-{'f1_val': 0.1417771333885667, 'auprc': 0.7272944494245596, 'loss_val': 1.2392698133466158, 'psi': 0.3759840598029639}
[S3] START round=5 head_norm_before_train=0.790004 cos_to_last_merge=0.9874 (last merge round=3)
[S3] round=5 local utility u=0.312151 metrics={'f1_val': 0.40310226040402647, 'auprc': 0.9776667817884168, 'loss_val': 0.8467170732727234, 'psi': 0.6329280689577826}-{'f1_val': 0.4210464679509158, 'auprc': 0.7961469127894493, 'loss_val': 1.0341252402670729, 'psi': 0.5710866458863293}
[S4] START round=5 head_norm_before_train=1.275852 (no previous merge yet)
[S4] round=5 local utility u=0.803049 metrics={'f1_val': 0.6608945580806707, 'auprc': 0.7826475012979597, 'loss_val': 0.9103387219262734, 'psi': 0.7095957353675864}-{'f1_val': 0.4281869212888601, 'auprc': 0.7765173341959511, 'loss_val': 1.1017997756950941, 'psi': 0.5675190864516966}
[S5] START round=5 head_norm_before_train=0.700538 cos_to_last_merge=0.9904 (last merge round=3)
[S5] round=5 local utility u=0.701221 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7771511159640928, 'loss_val': 0.9919155742148777, 'psi': 0.5614607577654844}-{'f1_val': 0.2137197024520624, 'auprc': 0.7723931922621291, 'loss_val': 1.156398731828198, 'psi': 0.4371890983760891}
[S6] START round=5 head_norm_before_train=0.783958 cos_to_last_merge=0.9968 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6526185152625993, 'loss_val': 1.2235106713529493, 'psi': 0.34590317533580894}-{'f1_val': 0.14142628205128205, 'auprc': 0.7458174820851472, 'loss_val': 1.2682621052621161, 'psi': 0.3831827620648281}
[S7] START round=5 head_norm_before_train=1.339172 (no previous merge yet)
[S7] round=5 local utility u=0.104238 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7907890016926814, 'loss_val': 0.8042787417453121, 'psi': 0.5664150803361366}-{'f1_val': 0.4171579869317734, 'auprc': 0.7483631559098023, 'loss_val': 0.8874311704781651, 'psi': 0.5496400545229849}
[S8] START round=5 head_norm_before_train=1.022070 cos_to_last_merge=0.9981 (last merge round=3)
[S8] round=5 local utility u=0.884958 metrics={'f1_val': 0.4156929677121941, 'auprc': 0.7761628522572939, 'loss_val': 1.1295916947117155, 'psi': 0.559880921530234}-{'f1_val': 0.13995598239295717, 'auprc': 0.767973207016175, 'loss_val': 1.220516623421731, 'psi': 0.39116287224224433}
[S9] START round=5 head_norm_before_train=1.349775 (no previous merge yet)
[S9] round=5 local utility u=0.095484 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9992285894230885, 'loss_val': 0.3552301007214287, 'psi': 0.8206158342903986}-{'f1_val': 0.7016893154854569, 'auprc': 0.9999965408733689, 'loss_val': 0.549393441665327, 'psi': 0.8210122056406217}
[S10] START round=5 head_norm_before_train=1.292200 (no previous merge yet)
[S10] round=5 local utility u=0.934314 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.6545342017798266, 'loss_val': 1.0699795381921948, 'psi': 0.5118392994785746}-{'f1_val': 0.13862163754172394, 'auprc': 0.6243629659947385, 'loss_val': 1.1795681465374135, 'psi': 0.3329181689229298}
[S11] START round=5 head_norm_before_train=1.288988 (no previous merge yet)
[S11] round=5 local utility u=0.029855 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7633023113725896, 'loss_val': 1.1781435816371415, 'psi': 0.3895691345729022}-{'f1_val': 0.14041368337311058, 'auprc': 0.7595891604143007, 'loss_val': 1.2267136541637507, 'psi': 0.3880838741895866}
[S13] START round=5 head_norm_before_train=0.877270 cos_to_last_merge=0.9803 (last merge round=1)
[S13] round=5 local utility u=0.148110 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.727897923403303, 'loss_val': 1.2236168889933432, 'psi': 0.37539062690755304}-{'f1_val': 0.1403857625770531, 'auprc': 0.6429354668156874, 'loss_val': 1.2649498106656638, 'psi': 0.3414056442725068}
[S14] START round=5 head_norm_before_train=1.275909 (no previous merge yet)
[S14] round=5 local utility u=0.086691 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7338084426949132, 'loss_val': 1.1779967207241986, 'psi': 0.3777380888075875}-{'f1_val': 0.14035785288270378, 'auprc': 0.6989591817030787, 'loss_val': 1.24683031736508, 'psi': 0.3637983844108537}
[S15] START round=5 head_norm_before_train=1.268195 (no previous merge yet)
[S15] round=5 local utility u=0.453582 metrics={'f1_val': 0.2790507839574963, 'auprc': 0.777710752144183, 'loss_val': 1.1572281854224826, 'psi': 0.47851477123217095}-{'f1_val': 0.13973365136155833, 'auprc': 0.7750743535135458, 'loss_val': 1.2205803179869092, 'psi': 0.39386993222235334}
[S16] START round=5 head_norm_before_train=0.598936 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6561455897634058, 'loss_val': 1.2043620438724116, 'psi': 0.34684070602488426}-{'f1_val': 0.14063745019920318, 'auprc': 0.7527053795742691, 'loss_val': 1.2407128315213325, 'psi': 0.3854646219492296}
[S17] START round=5 head_norm_before_train=1.269925 (no previous merge yet)
[S17] round=5 local utility u=0.088377 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6038267893251161, 'loss_val': 1.1199081714321497, 'psi': 0.3261000937204771}-{'f1_val': 0.14094896331738438, 'auprc': 0.5737537033921681, 'loss_val': 1.2064421858975531, 'psi': 0.3140708593472979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.375)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] cosine check vs S11: cos=-0.0123
[S10] DROPPED delta from S11 (cos=-0.0123 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.9257
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=-0.0370
[S13] DROPPED delta from S14 (cos=-0.0370 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S8
[S16] cosine check vs S8: cos=0.3814
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0683
[S8] DROPPED delta from S7 (cos=-0.0683 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.5388
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=-0.1420
[S7] DROPPED delta from S15 (cos=-0.1420 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.4316
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.0293
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.5392
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1790 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1790) from S17
[S14] cosine check vs S17: cos=0.0314
[S2] ⇄ pheromone p=0.390 → S5@127.0.0.1:50305
[S13] ⇄ pheromone p=0.381 → S16@127.0.0.1:50316
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.822500
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.110064e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.749246 delta_norm=0.411006
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.335 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.498 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.517 → S7@127.0.0.1:50308
[S5] ⇄ pheromone p=0.561 → S3@127.0.0.1:50303
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.4031 head_norm=0.885486
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.539037e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4010 head_norm=0.785529 delta_norm=0.353904
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.602 → S6@127.0.0.1:50307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4168 head_norm=1.398453
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.485934e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.3743 head_norm=0.976749 delta_norm=0.948593
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.504 → S8@127.0.0.1:50309
[S9] ⇄ pheromone p=0.569 → S3@127.0.0.1:50303
[S4] ⇄ pheromone p=0.658 → S8@127.0.0.1:50309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.4157 head_norm=1.052909
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.659232e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.4155 head_norm=1.168010 delta_norm=0.265923
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.551 → S16@127.0.0.1:50316
[S11] ⇄ pheromone p=0.362 → S10@127.0.0.1:50311
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.313203
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.061491e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1538 head_norm=0.935036 delta_norm=0.906149
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.466 → S13@127.0.0.1:50313
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.633734
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.003157e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.710495 delta_norm=0.500316
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.337 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.345 → S14@127.0.0.1:50314
[S2] START round=6 head_norm_before_train=0.965340 cos_to_last_merge=0.9671 (last merge round=1)
[S2] round=6 local utility u=0.261433 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7666525017230671, 'loss_val': 1.1520703454610322, 'psi': 0.3917272807223669}-{'f1_val': 0.1417771333885667, 'auprc': 0.6108494729784572, 'loss_val': 1.2075268310198826, 'psi': 0.3294060692245229}
[S3] START round=6 head_norm_before_train=0.785529 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.066872 metrics={'f1_val': 0.41204575182834025, 'auprc': 0.9893648886092057, 'loss_val': 0.8017286404828379, 'psi': 0.6429734065406865}-{'f1_val': 0.40310226040402647, 'auprc': 0.9776667817884168, 'loss_val': 0.8467170732727234, 'psi': 0.6329280689577826}
[S4] START round=6 head_norm_before_train=1.327142 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.5208556425708641, 'auprc': 0.782290765739889, 'loss_val': 0.7321880947012037, 'psi': 0.6254296918384741}-{'f1_val': 0.6608945580806707, 'auprc': 0.7826475012979597, 'loss_val': 0.9103387219262734, 'psi': 0.7095957353675864}
[S5] START round=6 head_norm_before_train=0.767805 cos_to_last_merge=0.9634 (last merge round=3)
[S5] round=6 local utility u=0.441147 metrics={'f1_val': 0.6067657587522641, 'auprc': 0.6437010824518177, 'loss_val': 0.8438621926757348, 'psi': 0.6215398882320855}-{'f1_val': 0.4176671856330787, 'auprc': 0.7771511159640928, 'loss_val': 0.9919155742148777, 'psi': 0.5614607577654844}
[S6] START round=6 head_norm_before_train=0.749246 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6434018273004062, 'loss_val': 1.2131947313846034, 'psi': 0.3422165001509317}-{'f1_val': 0.14142628205128205, 'auprc': 0.6526185152625993, 'loss_val': 1.2235106713529493, 'psi': 0.34590317533580894}
[S7] START round=6 head_norm_before_train=0.976749 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.370271 metrics={'f1_val': 0.5407522132660898, 'auprc': 0.7908274339587734, 'loss_val': 0.8073710106993789, 'psi': 0.6407823015431633}-{'f1_val': 0.41683246609844005, 'auprc': 0.7907890016926814, 'loss_val': 0.8042787417453121, 'psi': 0.5664150803361366}
[S8] START round=6 head_norm_before_train=1.168010 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7769418257470099, 'loss_val': 0.9917089267995299, 'psi': 0.5344961506121099}-{'f1_val': 0.4156929677121941, 'auprc': 0.7761628522572939, 'loss_val': 1.1295916947117155, 'psi': 0.559880921530234}
[S9] START round=6 head_norm_before_train=1.445619 (no previous merge yet)
[S9] round=6 local utility u=0.044394 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981307714486775, 'loss_val': 0.2627055190492493, 'psi': 0.820132364957674}-{'f1_val': 0.7015406642019387, 'auprc': 0.9992285894230885, 'loss_val': 0.3552301007214287, 'psi': 0.8206158342903986}
[S10] START round=6 head_norm_before_train=1.323656 (no previous merge yet)
[S10] round=6 local utility u=0.968722 metrics={'f1_val': 0.7022526020973978, 'auprc': 0.6701718383472756, 'loss_val': 0.8927075948441368, 'psi': 0.6894202965973489}-{'f1_val': 0.41670936461107344, 'auprc': 0.6545342017798266, 'loss_val': 1.0699795381921948, 'psi': 0.5118392994785746}
[S11] START round=6 head_norm_before_train=1.318182 (no previous merge yet)
[S11] round=6 local utility u=0.872777 metrics={'f1_val': 0.4154457801152016, 'auprc': 0.7671911690589842, 'loss_val': 1.0944496520967564, 'psi': 0.5561439356927147}-{'f1_val': 0.14041368337311058, 'auprc': 0.7633023113725896, 'loss_val': 1.1781435816371415, 'psi': 0.3895691345729022}
[S13] START round=6 head_norm_before_train=0.906254 cos_to_last_merge=0.9690 (last merge round=1)
[S13] round=6 local utility u=0.030661 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7322837776749729, 'loss_val': 1.1754514968464076, 'psi': 0.377144968616221}-{'f1_val': 0.1403857625770531, 'auprc': 0.727897923403303, 'loss_val': 1.2236168889933432, 'psi': 0.37539062690755304}
[S14] START round=6 head_norm_before_train=0.935036 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.051158 metrics={'f1_val': 0.15394679459223726, 'auprc': 0.7317979528621046, 'loss_val': 1.1511826689160798, 'psi': 0.3850872579001842}-{'f1_val': 0.14035785288270378, 'auprc': 0.7338084426949132, 'loss_val': 1.1779967207241986, 'psi': 0.3777380888075875}
[S15] START round=6 head_norm_before_train=1.301173 (no previous merge yet)
[S15] round=6 local utility u=0.455951 metrics={'f1_val': 0.4111323770139903, 'auprc': 0.7770561956441054, 'loss_val': 1.0358515163609037, 'psi': 0.5575019044660363}-{'f1_val': 0.2790507839574963, 'auprc': 0.777710752144183, 'loss_val': 1.1572281854224826, 'psi': 0.47851477123217095}
[S16] START round=6 head_norm_before_train=0.710495 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.688368 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.5395770103113833, 'loss_val': 1.1245335486546824, 'psi': 0.4648746900337398}-{'f1_val': 0.14063745019920318, 'auprc': 0.6561455897634058, 'loss_val': 1.2043620438724116, 'psi': 0.34684070602488426}
[S17] START round=6 head_norm_before_train=1.290850 (no previous merge yet)
[S17] round=6 local utility u=0.870285 metrics={'f1_val': 0.3851665599068561, 'auprc': 0.6545198952365517, 'loss_val': 0.9967228031316859, 'psi': 0.49290789403873436}-{'f1_val': 0.14094896331738438, 'auprc': 0.6038267893251161, 'loss_val': 1.1199081714321497, 'psi': 0.3261000937204771}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:50304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.556)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.641)
[S5] not sending this round → trigger blocked (psi=0.622)
[S3] not sending this round → trigger blocked (psi=0.643)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:50316
[S15] not sending this round → trigger blocked (psi=0.558)
[S10] not sending this round → trigger blocked (psi=0.689)
[S14] not sending this round → trigger blocked (psi=0.385)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] cosine check vs S13: cos=0.3744
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.5576
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.7780
[S17] not sending this round → trigger blocked (psi=0.493)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.5209 head_norm=1.374555
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.617987e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.5819 head_norm=1.003285 delta_norm=0.461799
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.6068 head_norm=0.834930
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.337902e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.5188 head_norm=0.804948 delta_norm=0.433790
[S5] aggregate: ROLLBACK (f1_val pre=0.607 post=0.519 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4151 head_norm=0.741806
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.757047e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4151 head_norm=0.697099 delta_norm=0.475705
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.987482 cos_to_last_merge=0.9596 (last merge round=1)
[S2] round=7 local utility u=0.818031 metrics={'f1_val': 0.40050703020241585, 'auprc': 0.7712114474778947, 'loss_val': 1.0820643346686518, 'psi': 0.5487887971126074}-{'f1_val': 0.1417771333885667, 'auprc': 0.7666525017230671, 'loss_val': 1.1520703454610322, 'psi': 0.3917272807223669}
[S3] START round=7 head_norm_before_train=0.884564 cos_to_last_merge=0.9849 (last merge round=5)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9921085834009392, 'loss_val': 0.4486554824129131, 'psi': 0.8172520091595765}-{'f1_val': 0.41204575182834025, 'auprc': 0.9893648886092057, 'loss_val': 0.8017286404828379, 'psi': 0.6429734065406865}
[S4] START round=7 head_norm_before_train=1.003285 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.41052040856276495, 'auprc': 0.6629350795764075, 'loss_val': 0.7167463801019739, 'psi': 0.511486276968222}-{'f1_val': 0.5208556425708641, 'auprc': 0.782290765739889, 'loss_val': 0.7321880947012037, 'psi': 0.6254296918384741}
[S5] START round=7 head_norm_before_train=0.804948 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.5630582104861288, 'auprc': 0.6779665912435574, 'loss_val': 0.8136048106428291, 'psi': 0.6090215627891002}-{'f1_val': 0.6067657587522641, 'auprc': 0.6437010824518177, 'loss_val': 0.8438621926757348, 'psi': 0.6215398882320855}
[S6] START round=7 head_norm_before_train=0.781305 cos_to_last_merge=0.9965 (last merge round=5)
[S6] round=7 local utility u=0.051834 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.651212816258343, 'loss_val': 1.1329591235121834, 'psi': 0.3453408957341064}-{'f1_val': 0.14142628205128205, 'auprc': 0.6434018273004062, 'loss_val': 1.2131947313846034, 'psi': 0.3422165001509317}
[S7] START round=7 head_norm_before_train=1.027945 cos_to_last_merge=0.9885 (last merge round=5)
[S7] round=7 local utility u=0.456884 metrics={'f1_val': 0.6683004514456993, 'auprc': 0.7904770692106943, 'loss_val': 0.6578417520318278, 'psi': 0.7171710985516973}-{'f1_val': 0.5407522132660898, 'auprc': 0.7908274339587734, 'loss_val': 0.8073710106993789, 'psi': 0.6407823015431633}
[S8] START round=7 head_norm_before_train=1.197707 cos_to_last_merge=0.9984 (last merge round=5)
[S8] round=7 local utility u=0.084072 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.7771075605350173, 'loss_val': 0.8252953245108215, 'psi': 0.5346858334819332}-{'f1_val': 0.3728657005221765, 'auprc': 0.7769418257470099, 'loss_val': 0.9917089267995299, 'psi': 0.5344961506121099}
[S9] START round=7 head_norm_before_train=1.525393 (no previous merge yet)
[S9] round=7 local utility u=0.027344 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981061806663492, 'loss_val': 0.20644260048760268, 'psi': 0.8199724207305508}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981307714486775, 'loss_val': 0.2627055190492493, 'psi': 0.820132364957674}
[S10] START round=7 head_norm_before_train=1.349979 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.3887209937328455, 'auprc': 0.9927518466720814, 'loss_val': 0.7253066985084251, 'psi': 0.6303333349085398}-{'f1_val': 0.7022526020973978, 'auprc': 0.6701718383472756, 'loss_val': 0.8927075948441368, 'psi': 0.6894202965973489}
[S11] START round=7 head_norm_before_train=1.342576 (no previous merge yet)
[S11] round=7 local utility u=0.052645 metrics={'f1_val': 0.39946330660582974, 'auprc': 0.7811570560647879, 'loss_val': 0.9351633079856239, 'psi': 0.552140806389413}-{'f1_val': 0.4154457801152016, 'auprc': 0.7671911690589842, 'loss_val': 1.0944496520967564, 'psi': 0.5561439356927147}
[S13] START round=7 head_norm_before_train=0.934990 cos_to_last_merge=0.9578 (last merge round=1)
[S13] round=7 local utility u=0.875845 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.7358537523449789, 'loss_val': 1.0909836860072397, 'psi': 0.5442241668885307}-{'f1_val': 0.1403857625770531, 'auprc': 0.7322837776749729, 'loss_val': 1.1754514968464076, 'psi': 0.377144968616221}
[S14] START round=7 head_norm_before_train=0.971553 cos_to_last_merge=0.9976 (last merge round=5)
[S14] round=7 local utility u=0.837398 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.7544936956701612, 'loss_val': 0.9999589231862672, 'psi': 0.5397140209152191}-{'f1_val': 0.15394679459223726, 'auprc': 0.7317979528621046, 'loss_val': 1.1511826689160798, 'psi': 0.3850872579001842}
[S15] START round=7 head_norm_before_train=1.339091 (no previous merge yet)
[S15] round=7 local utility u=0.129959 metrics={'f1_val': 0.41680775938714587, 'auprc': 0.7950267614287363, 'loss_val': 0.8638968465328528, 'psi': 0.568095360203782}-{'f1_val': 0.4111323770139903, 'auprc': 0.7770561956441054, 'loss_val': 1.0358515163609037, 'psi': 0.5575019044660363}
[S16] START round=7 head_norm_before_train=0.697099 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000115 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.5044372275370399, 'loss_val': 1.03091183293243, 'psi': 0.4520216400290237}-{'f1_val': 0.4150731431819776, 'auprc': 0.5395770103113833, 'loss_val': 1.1245335486546824, 'psi': 0.4648746900337398}
[S17] START round=7 head_norm_before_train=1.321016 (no previous merge yet)
[S17] round=7 local utility u=0.371333 metrics={'f1_val': 0.39129266205198276, 'auprc': 0.8600141359681606, 'loss_val': 0.9072968214626357, 'psi': 0.578781251618454}-{'f1_val': 0.3851665599068561, 'auprc': 0.6545198952365517, 'loss_val': 0.9967228031316859, 'psi': 0.49290789403873436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:50308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S2] not sending this round → trigger blocked (psi=0.549)
[S16] not sending this round → trigger blocked (psi=0.452)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.544)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.0140
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0312
[S8] DROPPED delta from S7 (cos=-0.0312 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.0986
[S7] DROPPED delta from S15 (cos=-0.0986 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S6
[S7] cosine check vs S6: cos=-0.0679
[S7] DROPPED delta from S6 (cos=-0.0679 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0101
[S10] DROPPED delta from S11 (cos=-0.0101 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.6517
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.4476
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.7861
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=0.6618
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4165 head_norm=0.970295
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.973468e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4179 head_norm=0.707191 delta_norm=0.697347
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=1.015554
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.118007e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3965 head_norm=1.083301 delta_norm=0.511801
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.816391
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.076567e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.855892 delta_norm=0.307657
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.7007 head_norm=0.993939
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.019889e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7008 head_norm=1.179055 delta_norm=0.601989
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4171 head_norm=0.735122
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.579391e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4170 head_norm=0.846345 delta_norm=0.557939
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.019524 cos_to_last_merge=0.9501 (last merge round=1)
[S2] round=8 local utility u=0.100839 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7755677671617077, 'loss_val': 0.9907785617361896, 'psi': 0.5602636552810096}-{'f1_val': 0.40050703020241585, 'auprc': 0.7712114474778947, 'loss_val': 1.0820643346686518, 'psi': 0.5487887971126074}
[S3] START round=8 head_norm_before_train=1.179055 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.032648 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9988048416696236, 'loss_val': 0.40299912845547636, 'psi': 0.8198855381679728}-{'f1_val': 0.7006809596653347, 'auprc': 0.9921085834009392, 'loss_val': 0.4486554824129131, 'psi': 0.8172520091595765}
[S4] START round=8 head_norm_before_train=1.052307 cos_to_last_merge=0.9975 (last merge round=6)
[S4] round=8 local utility u=0.839837 metrics={'f1_val': 0.670599855833351, 'auprc': 0.6624278624892996, 'loss_val': 0.5960268164595478, 'psi': 0.6673310584957305}-{'f1_val': 0.41052040856276495, 'auprc': 0.6629350795764075, 'loss_val': 0.7167463801019739, 'psi': 0.511486276968222}
[S5] START round=8 head_norm_before_train=0.857545 cos_to_last_merge=0.9899 (last merge round=6)
[S5] round=8 local utility u=0.157905 metrics={'f1_val': 0.527123646490111, 'auprc': 0.8116011235437433, 'loss_val': 0.6830907664967869, 'psi': 0.640914637311564}-{'f1_val': 0.5630582104861288, 'auprc': 0.6779665912435574, 'loss_val': 0.8136048106428291, 'psi': 0.6090215627891002}
[S6] START round=8 head_norm_before_train=0.855892 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.875719 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.6540333599017852, 'loss_val': 1.0401470770143773, 'psi': 0.5114854950592485}-{'f1_val': 0.14142628205128205, 'auprc': 0.651212816258343, 'loss_val': 1.1329591235121834, 'psi': 0.3453408957341064}
[S7] START round=8 head_norm_before_train=1.096614 cos_to_last_merge=0.9694 (last merge round=5)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6694200013313871, 'auprc': 0.7908704341619139, 'loss_val': 0.6845650932744599, 'psi': 0.7180001744635979}-{'f1_val': 0.6683004514456993, 'auprc': 0.7904770692106943, 'loss_val': 0.6578417520318278, 'psi': 0.7171710985516973}
[S8] START round=8 head_norm_before_train=1.230768 cos_to_last_merge=0.9934 (last merge round=5)
[S8] round=8 local utility u=0.065460 metrics={'f1_val': 0.3731326739016295, 'auprc': 0.7923725870453995, 'loss_val': 0.7405383643312349, 'psi': 0.5408286391591375}-{'f1_val': 0.37307134877987713, 'auprc': 0.7771075605350173, 'loss_val': 0.8252953245108215, 'psi': 0.5346858334819332}
[S9] START round=8 head_norm_before_train=1.586571 (no previous merge yet)
[S9] round=8 local utility u=0.670339 metrics={'f1_val': 0.9165118941921513, 'auprc': 0.9981020743069737, 'loss_val': 0.157524964618617, 'psi': 0.9491479662380803}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981061806663492, 'loss_val': 0.20644260048760268, 'psi': 0.8199724207305508}
[S10] START round=8 head_norm_before_train=1.382220 (no previous merge yet)
[S10] round=8 local utility u=0.968841 metrics={'f1_val': 0.6944337974849766, 'auprc': 0.9861171870438251, 'loss_val': 0.6019984482330658, 'psi': 0.8111071533085159}-{'f1_val': 0.3887209937328455, 'auprc': 0.9927518466720814, 'loss_val': 0.7253066985084251, 'psi': 0.6303333349085398}
[S11] START round=8 head_norm_before_train=1.373113 (no previous merge yet)
[S11] round=8 local utility u=0.283089 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9234357853498497, 'loss_val': 0.7781537829989933, 'psi': 0.6072854467854396}-{'f1_val': 0.39946330660582974, 'auprc': 0.7811570560647879, 'loss_val': 0.9351633079856239, 'psi': 0.552140806389413}
[S13] START round=8 head_norm_before_train=0.707191 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.080606 metrics={'f1_val': 0.41668613780145436, 'auprc': 0.769304350020626, 'loss_val': 1.0314146410909737, 'psi': 0.5577334226891231}-{'f1_val': 0.4164711099175653, 'auprc': 0.7358537523449789, 'loss_val': 1.0909836860072397, 'psi': 0.5442241668885307}
[S14] START round=8 head_norm_before_train=1.083301 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.371040 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9609462960557139, 'loss_val': 0.8770390344428862, 'psi': 0.6222753441918003}-{'f1_val': 0.39652757107859105, 'auprc': 0.7544936956701612, 'loss_val': 0.9999589231862672, 'psi': 0.5397140209152191}
[S15] START round=8 head_norm_before_train=1.379694 (no previous merge yet)
[S15] round=8 local utility u=0.112964 metrics={'f1_val': 0.4174856868469403, 'auprc': 0.8176975620440867, 'loss_val': 0.7100482726384979, 'psi': 0.5775704369257989}-{'f1_val': 0.41680775938714587, 'auprc': 0.7950267614287363, 'loss_val': 0.8638968465328528, 'psi': 0.568095360203782}
[S16] START round=8 head_norm_before_train=0.846345 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3817910341325493, 'auprc': 0.5303102952143636, 'loss_val': 0.9908161687510016, 'psi': 0.44119873856527503}-{'f1_val': 0.4170779150236796, 'auprc': 0.5044372275370399, 'loss_val': 1.03091183293243, 'psi': 0.4520216400290237}
[S17] START round=8 head_norm_before_train=1.356323 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.354269370389827, 'auprc': 0.8529931414863224, 'loss_val': 0.891738783641744, 'psi': 0.5537588788284251}-{'f1_val': 0.39129266205198276, 'auprc': 0.8600141359681606, 'loss_val': 0.9072968214626357, 'psi': 0.578781251618454}
[S6] not sending this round → trigger blocked (psi=0.511)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S9] not sending this round → trigger blocked (psi=0.949)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.541)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:50316
[S11] not sending this round → trigger blocked (psi=0.607)
[S15] not sending this round → trigger blocked (psi=0.578)
[S14] not sending this round → trigger blocked (psi=0.622)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=0.2771
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.2011
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.5507
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.8130
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.9582
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3731 head_norm=1.268618
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.892527e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3731 head_norm=1.176207 delta_norm=0.189253
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7006 head_norm=1.252471
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.980103e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7006 head_norm=0.847626 delta_norm=0.698010
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.6694 head_norm=1.150283
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.217536e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4804 head_norm=1.135080 delta_norm=0.621754
[S7] aggregate: ROLLBACK (f1_val pre=0.669 post=0.480 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.5271 head_norm=0.917983
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.099968e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.6289 head_norm=0.942105 delta_norm=0.309997
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3818 head_norm=0.883393
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.929430e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3857 head_norm=0.652402 delta_norm=0.492943
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.060485 cos_to_last_merge=0.9397 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=9 local utility u=0.698249 metrics={'f1_val': 0.6249886548411054, 'auprc': 0.7728683683146396, 'loss_val': 0.835748553119142, 'psi': 0.6841405402305192}-{'f1_val': 0.4167275806938775, 'auprc': 0.7755677671617077, 'loss_val': 0.9907785617361896, 'psi': 0.5602636552810096}
[S3] START round=9 head_norm_before_train=0.847626 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9991863899188363, 'loss_val': 0.4557186508585863, 'psi': 0.8201282782087143}-{'f1_val': 0.7006060025002057, 'auprc': 0.9988048416696236, 'loss_val': 0.40299912845547636, 'psi': 0.8198855381679728}
[S4] START round=9 head_norm_before_train=1.108677 cos_to_last_merge=0.9908 (last merge round=6)
[S4] round=9 local utility u=0.053372 metrics={'f1_val': 0.670578461415036, 'auprc': 0.6625372066402078, 'loss_val': 0.4894832803991467, 'psi': 0.6673619595051047}-{'f1_val': 0.670599855833351, 'auprc': 0.6624278624892996, 'loss_val': 0.5960268164595478, 'psi': 0.6673310584957305}
[S5] START round=9 head_norm_before_train=0.942105 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.603334 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8527425028771906, 'loss_val': 0.6420066195635199, 'psi': 0.7615871164573904}-{'f1_val': 0.527123646490111, 'auprc': 0.8116011235437433, 'loss_val': 0.6830907664967869, 'psi': 0.640914637311564}
[S6] START round=9 head_norm_before_train=0.885554 cos_to_last_merge=0.9963 (last merge round=7)
[S6] round=9 local utility u=0.270083 metrics={'f1_val': 0.4171352566691459, 'auprc': 0.7729295577928512, 'loss_val': 0.8607594023705502, 'psi': 0.5594529771186281}-{'f1_val': 0.4164535851642239, 'auprc': 0.6540333599017852, 'loss_val': 1.0401470770143773, 'psi': 0.5114854950592485}
[S7] START round=9 head_norm_before_train=1.135080 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.047492 metrics={'f1_val': 0.6776235915496771, 'auprc': 0.7928402195710159, 'loss_val': 0.6447117596701732, 'psi': 0.7237102427582127}-{'f1_val': 0.6694200013313871, 'auprc': 0.7908704341619139, 'loss_val': 0.6845650932744599, 'psi': 0.7180001744635979}
[S8] START round=9 head_norm_before_train=1.176207 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.334289 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.991382695484619, 'loss_val': 0.6681874872937568, 'psi': 0.6203524103128518}-{'f1_val': 0.3731326739016295, 'auprc': 0.7923725870453995, 'loss_val': 0.7405383643312349, 'psi': 0.5408286391591375}
[S9] START round=9 head_norm_before_train=1.636808 (no previous merge yet)
[S9] round=9 local utility u=0.233152 metrics={'f1_val': 0.9869679892487694, 'auprc': 0.998474898777825, 'loss_val': 0.11507700802007396, 'psi': 0.9915707530603917}-{'f1_val': 0.9165118941921513, 'auprc': 0.9981020743069737, 'loss_val': 0.157524964618617, 'psi': 0.9491479662380803}
[S10] START round=9 head_norm_before_train=1.423663 (no previous merge yet)
[S10] round=9 local utility u=0.087619 metrics={'f1_val': 0.7013704343360756, 'auprc': 0.9982778025524135, 'loss_val': 0.5048614151734061, 'psi': 0.8201333816226108}-{'f1_val': 0.6944337974849766, 'auprc': 0.9861171870438251, 'loss_val': 0.6019984482330658, 'psi': 0.8111071533085159}
[S11] START round=9 head_norm_before_train=1.409877 (no previous merge yet)
[S11] round=9 local utility u=0.164597 metrics={'f1_val': 0.3928061491359341, 'auprc': 0.9987543187685377, 'loss_val': 0.6526403560523855, 'psi': 0.6351854169889755}-{'f1_val': 0.39651855440916606, 'auprc': 0.9234357853498497, 'loss_val': 0.7781537829989933, 'psi': 0.6072854467854396}
[S13] START round=9 head_norm_before_train=0.746229 cos_to_last_merge=0.9952 (last merge round=7)
[S13] round=9 local utility u=0.087689 metrics={'f1_val': 0.4300228755581055, 'auprc': 0.7647283887067711, 'loss_val': 0.9223291301050307, 'psi': 0.5639050808175717}-{'f1_val': 0.41668613780145436, 'auprc': 0.769304350020626, 'loss_val': 1.0314146410909737, 'psi': 0.5577334226891231}
[S14] START round=9 head_norm_before_train=1.120384 cos_to_last_merge=0.9964 (last merge round=7)
[S14] round=9 local utility u=0.940900 metrics={'f1_val': 0.6525384401318961, 'auprc': 0.9963791473720633, 'loss_val': 0.6377994409534055, 'psi': 0.790074723027963}-{'f1_val': 0.39649470961585787, 'auprc': 0.9609462960557139, 'loss_val': 0.8770390344428862, 'psi': 0.6222753441918003}
[S15] START round=9 head_norm_before_train=1.420168 (no previous merge yet)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7015342720956422, 'auprc': 0.9891837868864263, 'loss_val': 0.6477812088334474, 'psi': 0.8165940780119558}-{'f1_val': 0.4174856868469403, 'auprc': 0.8176975620440867, 'loss_val': 0.7100482726384979, 'psi': 0.5775704369257989}
[S16] START round=9 head_norm_before_train=0.652402 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.343178 metrics={'f1_val': 0.38627885399725376, 'auprc': 0.7385591003559375, 'loss_val': 0.9561330581319727, 'psi': 0.5271909525407272}-{'f1_val': 0.3817910341325493, 'auprc': 0.5303102952143636, 'loss_val': 0.9908161687510016, 'psi': 0.44119873856527503}
[S17] START round=9 head_norm_before_train=1.393009 (no previous merge yet)
[S17] round=9 local utility u=0.437327 metrics={'f1_val': 0.5227741133568374, 'auprc': 0.8179290703480057, 'loss_val': 0.9229211838757434, 'psi': 0.6408360961533048}-{'f1_val': 0.354269370389827, 'auprc': 0.8529931414863224, 'loss_val': 0.891738783641744, 'psi': 0.5537588788284251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[S4] not sending this round → trigger blocked (psi=0.667)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:50308
[S13] not sending this round → trigger blocked (psi=0.564)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S5] not sending this round → trigger blocked (psi=0.762)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[S10] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → trigger blocked (psi=0.684)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:50308
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.6901
[S7] RECEIVED delta(kind=head bytes=1790) from S6
[S7] cosine check vs S6: cos=-0.0960
[S7] DROPPED delta from S6 (cos=-0.0960 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=-0.0052
[S10] DROPPED delta from S11 (cos=-0.0052 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.6385
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.6214
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.0174
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.6438
[S7] RECEIVED delta(kind=head bytes=1806) from S15
[S7] cosine check vs S15: cos=-0.0321
[S7] DROPPED delta from S15 (cos=-0.0321 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S17
[S14] cosine check vs S17: cos=0.8849
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4300 head_norm=0.795993
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.586787e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.7135 head_norm=0.887618 delta_norm=0.458679
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7008 head_norm=0.935965
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.183734e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7020 head_norm=1.211581 delta_norm=0.618373
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6706 head_norm=1.170072
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.486383e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6717 head_norm=0.851027 delta_norm=0.448638
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3863 head_norm=0.694245
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.677802e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3853 head_norm=0.869352 delta_norm=0.467780
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3730 head_norm=1.211283
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.384843e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7143 head_norm=0.853187 delta_norm=0.838484
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.6525 head_norm=1.167433
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.367984e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.5329 head_norm=1.261529 delta_norm=0.336798
[S14] aggregate: ROLLBACK (f1_val pre=0.653 post=0.533 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.107854 cos_to_last_merge=0.9282 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=10 local utility u=0.378836 metrics={'f1_val': 0.7142682616041024, 'auprc': 0.7908763532780096, 'loss_val': 0.6677777915237567, 'psi': 0.7449114982736653}-{'f1_val': 0.6249886548411054, 'auprc': 0.7728683683146396, 'loss_val': 0.835748553119142, 'psi': 0.6841405402305192}
[S3] START round=10 head_norm_before_train=1.211581 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.046826 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9985420954112494, 'loss_val': 0.359233503340952, 'psi': 0.8197804396646231}-{'f1_val': 0.7007562037352997, 'auprc': 0.9991863899188363, 'loss_val': 0.4557186508585863, 'psi': 0.8201282782087143}
[S4] START round=10 head_norm_before_train=0.851027 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.001167 metrics={'f1_val': 0.6792134416327307, 'auprc': 0.6593874976953034, 'loss_val': 0.5295091297732738, 'psi': 0.6712830640577597}-{'f1_val': 0.670578461415036, 'auprc': 0.6625372066402078, 'loss_val': 0.4894832803991467, 'psi': 0.6673619595051047}
[S5] START round=10 head_norm_before_train=0.995114 cos_to_last_merge=0.9947 (last merge round=8)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6673726901193092, 'auprc': 0.846842644912129, 'loss_val': 0.5307453185044861, 'psi': 0.7391606720364372}-{'f1_val': 0.7008168588441903, 'auprc': 0.8527425028771906, 'loss_val': 0.6420066195635199, 'psi': 0.7615871164573904}
[S6] START round=10 head_norm_before_train=0.931076 cos_to_last_merge=0.9844 (last merge round=7)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.6998084282211825, 'auprc': 0.9605426330188951, 'loss_val': 0.6396167304958282, 'psi': 0.8041021101402676}-{'f1_val': 0.4171352566691459, 'auprc': 0.7729295577928512, 'loss_val': 0.8607594023705502, 'psi': 0.5594529771186281}
[S7] START round=10 head_norm_before_train=1.181000 cos_to_last_merge=0.9961 (last merge round=8)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.39114802024099243, 'auprc': 0.6805888549132925, 'loss_val': 1.0354264919716039, 'psi': 0.5069243541099124}-{'f1_val': 0.6776235915496771, 'auprc': 0.7928402195710159, 'loss_val': 0.6447117596701732, 'psi': 0.7237102427582127}
[S8] START round=10 head_norm_before_train=0.853187 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.993405021431216, 'loss_val': 0.6907386560598723, 'psi': 0.8256171698406816}-{'f1_val': 0.3729988868650071, 'auprc': 0.991382695484619, 'loss_val': 0.6681874872937568, 'psi': 0.6203524103128518}
[S9] START round=10 head_norm_before_train=1.680655 (no previous merge yet)
[S9] round=10 local utility u=0.031399 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9981702387474445, 'loss_val': 0.10051907098257794, 'psi': 0.9963643925641124}-{'f1_val': 0.9869679892487694, 'auprc': 0.998474898777825, 'loss_val': 0.11507700802007396, 'psi': 0.9915707530603917}
[S10] START round=10 head_norm_before_train=1.459701 (no previous merge yet)
[S10] round=10 local utility u=0.039904 metrics={'f1_val': 0.7000680725537874, 'auprc': 0.9983100618686462, 'loss_val': 0.41733686620632804, 'psi': 0.819364868279731}-{'f1_val': 0.7013704343360756, 'auprc': 0.9982778025524135, 'loss_val': 0.5048614151734061, 'psi': 0.8201333816226108}
[S11] START round=10 head_norm_before_train=1.454769 (no previous merge yet)
[S11] round=10 local utility u=0.471670 metrics={'f1_val': 0.5333403191088832, 'auprc': 0.998672081075656, 'loss_val': 0.5522580289265461, 'psi': 0.7194730238955924}-{'f1_val': 0.3928061491359341, 'auprc': 0.9987543187685377, 'loss_val': 0.6526403560523855, 'psi': 0.6351854169889755}
[S13] START round=10 head_norm_before_train=0.887618 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.866496 metrics={'f1_val': 0.7117076967360673, 'auprc': 0.7586981958758986, 'loss_val': 0.8613561369613433, 'psi': 0.7305038963919999}-{'f1_val': 0.4300228755581055, 'auprc': 0.7647283887067711, 'loss_val': 0.9223291301050307, 'psi': 0.5639050808175717}
[S14] START round=10 head_norm_before_train=1.261529 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.215198 metrics={'f1_val': 0.701819167019819, 'auprc': 0.9965895547211503, 'loss_val': 0.5037182034120921, 'psi': 0.8197273221003515}-{'f1_val': 0.6525384401318961, 'auprc': 0.9963791473720633, 'loss_val': 0.6377994409534055, 'psi': 0.790074723027963}
[S15] START round=10 head_norm_before_train=1.455707 (no previous merge yet)
[S15] round=10 local utility u=0.076218 metrics={'f1_val': 0.7144475863254298, 'auprc': 0.9859087583552512, 'loss_val': 0.5630004444376145, 'psi': 0.8230320551373583}-{'f1_val': 0.7015342720956422, 'auprc': 0.9891837868864263, 'loss_val': 0.6477812088334474, 'psi': 0.8165940780119558}
[S16] START round=10 head_norm_before_train=0.869352 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.190362 metrics={'f1_val': 0.4376208336056561, 'auprc': 0.7440635177806043, 'loss_val': 0.8999739231672116, 'psi': 0.5601979072756353}-{'f1_val': 0.38627885399725376, 'auprc': 0.7385591003559375, 'loss_val': 0.9561330581319727, 'psi': 0.5271909525407272}
[S17] START round=10 head_norm_before_train=1.430692 (no previous merge yet)
[S17] round=10 local utility u=0.027831 metrics={'f1_val': 0.5251495900057757, 'auprc': 0.8189385153809298, 'loss_val': 0.8845395530465155, 'psi': 0.6426651601558373}-{'f1_val': 0.5227741133568374, 'auprc': 0.8179290703480057, 'loss_val': 0.9229211838757434, 'psi': 0.6408360961533048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:50307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.804)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:50309
[S15] not sending this round → trigger blocked (psi=0.823)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:50305
[S16] not sending this round → trigger blocked (psi=0.560)
[S14] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.719)
[S9] not sending this round → trigger blocked (psi=0.996)
[S8] not sending this round → trigger blocked (psi=0.826)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.8386
[S5] RECEIVED delta(kind=head bytes=1792) from S2
[S5] cosine check vs S2: cos=0.8952
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=0.2406
[S6] RECEIVED delta(kind=head bytes=1789) from S3
[S6] cosine check vs S3: cos=0.6777
[S8] RECEIVED delta(kind=head bytes=1790) from S4
[S8] cosine check vs S4: cos=0.6888
[S17] not sending this round → trigger blocked (psi=0.643)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6998 head_norm=0.979534
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.738049e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.6972 head_norm=1.036335 delta_norm=0.473805
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.471 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.404 → S7@127.0.0.1:50308
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7138 head_norm=0.896280
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.569819e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=0.831384 delta_norm=0.356982
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.451 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.484 → S13@127.0.0.1:50313
[S11] ⇄ pheromone p=0.352 → S10@127.0.0.1:50311
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.3911 head_norm=1.225197
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.079138e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.3843 head_norm=1.305334 delta_norm=0.407914
[S7] aggregate: ROLLBACK (f1_val pre=0.391 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.250 → S8@127.0.0.1:50309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.6674 head_norm=1.068226
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.600820e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7009 head_norm=1.087400 delta_norm=0.260082
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.337 → S3@127.0.0.1:50303
[S9] ⇄ pheromone p=0.322 → S3@127.0.0.1:50303
[S2] ⇄ pheromone p=0.433 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.395 → S7@127.0.0.1:50308
[S4] ⇄ pheromone p=0.332 → S8@127.0.0.1:50309
[S13] ⇄ pheromone p=0.415 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=0.319 → S6@127.0.0.1:50307
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4376 head_norm=0.911355
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.657988e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4371 head_norm=0.723175 delta_norm=0.565799
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.260 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.298 → S14@127.0.0.1:50314
[S2] START round=11 head_norm_before_train=1.165786 cos_to_last_merge=0.9143 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=11 local utility u=0.054181 metrics={'f1_val': 0.7019098938706484, 'auprc': 0.7944274421262149, 'loss_val': 0.4959187409169245, 'psi': 0.738916913172875}-{'f1_val': 0.7142682616041024, 'auprc': 0.7908763532780096, 'loss_val': 0.6677777915237567, 'psi': 0.7449114982736653}
[S3] START round=11 head_norm_before_train=1.279639 cos_to_last_merge=0.9951 (last merge round=9)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6458631040260909, 'auprc': 0.8395208435982804, 'loss_val': 0.46274855206775994, 'psi': 0.7233261998549667}-{'f1_val': 0.7006060025002057, 'auprc': 0.9985420954112494, 'loss_val': 0.359233503340952, 'psi': 0.8197804396646231}
[S4] START round=11 head_norm_before_train=0.913209 cos_to_last_merge=0.9961 (last merge round=9)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6689734243070242, 'auprc': 0.6613153129528153, 'loss_val': 0.5010325531727142, 'psi': 0.6659101797653406}-{'f1_val': 0.6792134416327307, 'auprc': 0.6593874976953034, 'loss_val': 0.5295091297732738, 'psi': 0.6712830640577597}
[S5] START round=11 head_norm_before_train=1.087400 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4179075419145208, 'auprc': 0.7578139580299073, 'loss_val': 0.8079655005862288, 'psi': 0.5538701083606754}-{'f1_val': 0.6673726901193092, 'auprc': 0.846842644912129, 'loss_val': 0.5307453185044861, 'psi': 0.7391606720364372}
[S6] START round=11 head_norm_before_train=1.036335 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.41572065481343023, 'auprc': 0.7772513996354722, 'loss_val': 0.8176415728178652, 'psi': 0.560332952742247}-{'f1_val': 0.6998084282211825, 'auprc': 0.9605426330188951, 'loss_val': 0.6396167304958282, 'psi': 0.8041021101402676}
[S7] START round=11 head_norm_before_train=1.305334 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.723724 metrics={'f1_val': 0.5564197335375676, 'auprc': 0.777403662658033, 'loss_val': 0.8700526964341446, 'psi': 0.6448133051857537}-{'f1_val': 0.39114802024099243, 'auprc': 0.6805888549132925, 'loss_val': 1.0354264919716039, 'psi': 0.5069243541099124}
[S8] START round=11 head_norm_before_train=0.831384 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.9935046757493712, 'loss_val': 0.6000422797536493, 'psi': 0.6211208675085934}-{'f1_val': 0.7137586021136586, 'auprc': 0.993405021431216, 'loss_val': 0.6907386560598723, 'psi': 0.8256171698406816}
[S9] START round=11 head_norm_before_train=1.722623 (no previous merge yet)
[S9] round=11 local utility u=0.029055 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9990829152288441, 'loss_val': 0.05033195865576884, 'psi': 0.9972479042950817}-{'f1_val': 0.9951604951085576, 'auprc': 0.9981702387474445, 'loss_val': 0.10051907098257794, 'psi': 0.9963643925641124}
[S10] START round=11 head_norm_before_train=1.496488 (no previous merge yet)
[S10] round=11 local utility u=0.011046 metrics={'f1_val': 0.6914606795308347, 'auprc': 0.9982927538363155, 'loss_val': 0.34354832331403024, 'psi': 0.814193509253027}-{'f1_val': 0.7000680725537874, 'auprc': 0.9983100618686462, 'loss_val': 0.41733686620632804, 'psi': 0.819364868279731}
[S11] START round=11 head_norm_before_train=1.495257 (no previous merge yet)
[S11] round=11 local utility u=0.555248 metrics={'f1_val': 0.7021324793760719, 'auprc': 0.999535618311697, 'loss_val': 0.4571052871978541, 'psi': 0.821093734950322}-{'f1_val': 0.5333403191088832, 'auprc': 0.998672081075656, 'loss_val': 0.5522580289265461, 'psi': 0.7194730238955924}
[S13] START round=11 head_norm_before_train=0.925015 cos_to_last_merge=0.9950 (last merge round=9)
[S13] round=11 local utility u=0.014016 metrics={'f1_val': 0.7115091406168195, 'auprc': 0.7255761592642451, 'loss_val': 0.7327667256318395, 'psi': 0.7171359480757897}-{'f1_val': 0.7117076967360673, 'auprc': 0.7586981958758986, 'loss_val': 0.8613561369613433, 'psi': 0.7305038963919999}
[S14] START round=11 head_norm_before_train=1.302817 cos_to_last_merge=0.9976 (last merge round=9)
[S14] round=11 local utility u=0.069504 metrics={'f1_val': 0.7020620161542324, 'auprc': 0.9957260476326651, 'loss_val': 0.3635762790883195, 'psi': 0.8195276287456055}-{'f1_val': 0.701819167019819, 'auprc': 0.9965895547211503, 'loss_val': 0.5037182034120921, 'psi': 0.8197273221003515}
[S15] START round=11 head_norm_before_train=1.493361 (no previous merge yet)
[S15] round=11 local utility u=0.029840 metrics={'f1_val': 0.7015466262409084, 'auprc': 0.9952621272595976, 'loss_val': 0.4539746366342238, 'psi': 0.8190328266483841}-{'f1_val': 0.7144475863254298, 'auprc': 0.9859087583552512, 'loss_val': 0.5630004444376145, 'psi': 0.8230320551373583}
[S16] START round=11 head_norm_before_train=0.723175 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.277899 metrics={'f1_val': 0.517239846720828, 'auprc': 0.7723337037197908, 'loss_val': 0.9067005731997693, 'psi': 0.6192773895204131}-{'f1_val': 0.4376208336056561, 'auprc': 0.7440635177806043, 'loss_val': 0.8999739231672116, 'psi': 0.5601979072756353}
[S17] START round=11 head_norm_before_train=1.462463 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3435927042057533, 'auprc': 0.8280892610207593, 'loss_val': 0.9200048241123662, 'psi': 0.5373913269317557}-{'f1_val': 0.5251495900057757, 'auprc': 0.8189385153809298, 'loss_val': 0.8845395530465155, 'psi': 0.6426651601558373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:50311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S13] not sending this round → trigger blocked (psi=0.717)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:50313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.739)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:50304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.814)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S15
[S7] cosine check vs S15: cos=0.0020
[S13] RECEIVED delta(kind=head bytes=1794) from S14
[S13] cosine check vs S14: cos=0.8436
[S10] RECEIVED delta(kind=head bytes=1806) from S11
[S10] cosine check vs S11: cos=-0.0036
[S10] DROPPED delta from S11 (cos=-0.0036 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=0.9133
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.7476
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.3640
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7115 head_norm=0.970536
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.732524e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7119 head_norm=1.116823 delta_norm=0.373252
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3729 head_norm=0.891576
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.541286e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7379 head_norm=0.928036 delta_norm=0.654129
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.6459 head_norm=1.341930
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.847893e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.6161 head_norm=1.521194 delta_norm=0.384789
[S3] aggregate: ROLLBACK (f1_val pre=0.646 post=0.616 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6690 head_norm=0.985116
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.274395e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6693 head_norm=0.818535 delta_norm=0.327440
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.5564 head_norm=1.335426
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.013906e+00
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.1523 head_norm=1.015898 delta_norm=1.013906
[S7] aggregate: ROLLBACK (f1_val pre=0.556 post=0.152 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.229721 cos_to_last_merge=0.8988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=12 local utility u=0.040421 metrics={'f1_val': 0.7051215259450543, 'auprc': 0.7956627227127051, 'loss_val': 0.43805199616097457, 'psi': 0.7413380046521146}-{'f1_val': 0.7019098938706484, 'auprc': 0.7944274421262149, 'loss_val': 0.4959187409169245, 'psi': 0.738916913172875}
[S3] START round=12 head_norm_before_train=1.521194 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=1.000000 metrics={'f1_val': 0.9982270248289424, 'auprc': 0.9997245864346882, 'loss_val': 0.2290268931397496, 'psi': 0.9988260494712408}-{'f1_val': 0.6458631040260909, 'auprc': 0.8395208435982804, 'loss_val': 0.46274855206775994, 'psi': 0.7233261998549667}
[S4] START round=12 head_norm_before_train=0.818535 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6693429196198661, 'auprc': 0.6565148836575484, 'loss_val': 0.5376653804901879, 'psi': 0.664211705234939}-{'f1_val': 0.6689734243070242, 'auprc': 0.6613153129528153, 'loss_val': 0.5010325531727142, 'psi': 0.6659101797653406}
[S5] START round=12 head_norm_before_train=1.144559 cos_to_last_merge=0.9968 (last merge round=10)
[S5] round=12 local utility u=1.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8646504366675436, 'loss_val': 0.41452995260507847, 'psi': 0.7662252102646221}-{'f1_val': 0.4179075419145208, 'auprc': 0.7578139580299073, 'loss_val': 0.8079655005862288, 'psi': 0.5538701083606754}
[S6] START round=12 head_norm_before_train=1.072190 cos_to_last_merge=0.9965 (last merge round=10)
[S6] round=12 local utility u=1.000000 metrics={'f1_val': 0.7099929224303602, 'auprc': 0.9642666006133355, 'loss_val': 0.5009529386308391, 'psi': 0.8117023937035504}-{'f1_val': 0.41572065481343023, 'auprc': 0.7772513996354722, 'loss_val': 0.8176415728178652, 'psi': 0.560332952742247}
[S7] START round=12 head_norm_before_train=1.015898 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.4427301733524409, 'auprc': 0.6661794273769558, 'loss_val': 1.2027365674505768, 'psi': 0.5321098749622468}-{'f1_val': 0.5564197335375676, 'auprc': 0.777403662658033, 'loss_val': 0.8700526964341446, 'psi': 0.6448133051857537}
[S8] START round=12 head_norm_before_train=0.928036 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.9873589895232592, 'auprc': 0.9960922385971738, 'loss_val': 0.5971660014012039, 'psi': 0.990852289152825}-{'f1_val': 0.3728649953480749, 'auprc': 0.9935046757493712, 'loss_val': 0.6000422797536493, 'psi': 0.6211208675085934}
[S9] START round=12 head_norm_before_train=1.767317 (no previous merge yet)
[S9] round=12 local utility u=0.000791 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9994897697213286, 'loss_val': 0.03996311839689838, 'psi': 0.9964099014062217}-{'f1_val': 0.9960245636725735, 'auprc': 0.9990829152288441, 'loss_val': 0.05033195865576884, 'psi': 0.9972479042950817}
[S10] START round=12 head_norm_before_train=1.538597 (no previous merge yet)
[S10] round=12 local utility u=0.022219 metrics={'f1_val': 0.6888947466168216, 'auprc': 0.9972007243625827, 'loss_val': 0.28043802714143135, 'psi': 0.812217137715126}-{'f1_val': 0.6914606795308347, 'auprc': 0.9982927538363155, 'loss_val': 0.34354832331403024, 'psi': 0.814193509253027}
[S11] START round=12 head_norm_before_train=1.530064 (no previous merge yet)
[S11] round=12 local utility u=0.768022 metrics={'f1_val': 0.9472291028221891, 'auprc': 0.9989743299163591, 'loss_val': 0.38995624755127245, 'psi': 0.9679271936598571}-{'f1_val': 0.7021324793760719, 'auprc': 0.999535618311697, 'loss_val': 0.4571052871978541, 'psi': 0.821093734950322}
[S13] START round=12 head_norm_before_train=1.116823 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6308527288280121, 'auprc': 0.760952771401855, 'loss_val': 0.759772024889963, 'psi': 0.6828927458575493}-{'f1_val': 0.7115091406168195, 'auprc': 0.7255761592642451, 'loss_val': 0.7327667256318395, 'psi': 0.7171359480757897}
[S14] START round=12 head_norm_before_train=1.353250 cos_to_last_merge=0.9916 (last merge round=9)
[S14] round=12 local utility u=0.936242 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9957251677976101, 'loss_val': 0.26475872298674663, 'psi': 0.9968941398548268}-{'f1_val': 0.7020620161542324, 'auprc': 0.9957260476326651, 'loss_val': 0.3635762790883195, 'psi': 0.8195276287456055}
[S15] START round=12 head_norm_before_train=1.528641 (no previous merge yet)
[S15] round=12 local utility u=0.001661 metrics={'f1_val': 0.6988623887349907, 'auprc': 0.9930214737417797, 'loss_val': 0.4278258326250777, 'psi': 0.8165260227377062}-{'f1_val': 0.7015466262409084, 'auprc': 0.9952621272595976, 'loss_val': 0.4539746366342238, 'psi': 0.8190328266483841}
[S16] START round=12 head_norm_before_train=0.764184 cos_to_last_merge=0.9936 (last merge round=10)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4331198308307587, 'auprc': 0.7535286167742898, 'loss_val': 0.836211209195243, 'psi': 0.5612833452081711}-{'f1_val': 0.517239846720828, 'auprc': 0.7723337037197908, 'loss_val': 0.9067005731997693, 'psi': 0.6192773895204131}
[S17] START round=12 head_norm_before_train=1.485173 (no previous merge yet)
[S17] round=12 local utility u=0.047764 metrics={'f1_val': 0.3842508212578712, 'auprc': 0.7765066247246503, 'loss_val': 0.9136770451721338, 'psi': 0.5411531426445828}-{'f1_val': 0.3435927042057533, 'auprc': 0.8280892610207593, 'loss_val': 0.9200048241123662, 'psi': 0.5373913269317557}
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:50307
[S11] not sending this round → trigger blocked (psi=0.968)
[S15] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.4046
[S7] RECEIVED delta(kind=head bytes=1792) from S6
[S7] cosine check vs S6: cos=-0.2084
[S7] DROPPED delta from S6 (cos=-0.2084 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.9380
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.8595
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.1867
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.6617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.9287
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4427 head_norm=1.041101
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.899673e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4111 head_norm=1.196721 delta_norm=0.589967
[S7] aggregate: ROLLBACK (f1_val pre=0.443 post=0.411 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9977 head_norm=1.406694
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.801284e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9977 head_norm=1.432538 delta_norm=0.280128
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=1.184418
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.243367e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.218830 delta_norm=0.224337
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7100 head_norm=1.115431
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.185636e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7034 head_norm=1.296932 delta_norm=0.418564
[S6] aggregate: ROLLBACK (f1_val pre=0.710 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.9982 head_norm=1.571709
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.913676e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.9982 head_norm=1.068655 delta_norm=0.891368
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4331 head_norm=0.812364
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.913251e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4268 head_norm=0.748875 delta_norm=0.491325
[S16] aggregate: ROLLBACK (f1_val pre=0.433 post=0.427 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.291858 cos_to_last_merge=0.8843 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.7266571331746096, 'loss_val': 0.33412511177224025, 'psi': 0.711653590604227}-{'f1_val': 0.7051215259450543, 'auprc': 0.7956627227127051, 'loss_val': 0.43805199616097457, 'psi': 0.7413380046521146}
[S3] START round=13 head_norm_before_train=1.068655 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6391411068860848, 'auprc': 0.8495336905054243, 'loss_val': 0.4715919244201066, 'psi': 0.7232981403338206}-{'f1_val': 0.9982270248289424, 'auprc': 0.9997245864346882, 'loss_val': 0.2290268931397496, 'psi': 0.9988260494712408}
[S4] START round=13 head_norm_before_train=0.881675 cos_to_last_merge=0.9954 (last merge round=11)
[S4] round=13 local utility u=0.239041 metrics={'f1_val': 0.6705540863655298, 'auprc': 0.7997811427530398, 'loss_val': 0.49664893210651895, 'psi': 0.7222449089205338}-{'f1_val': 0.6693429196198661, 'auprc': 0.6565148836575484, 'loss_val': 0.5376653804901879, 'psi': 0.664211705234939}
[S5] START round=13 head_norm_before_train=1.218830 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.130586 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9376941364548308, 'loss_val': 0.3724899180865704, 'psi': 0.7954426901795368}-{'f1_val': 0.7006083926626743, 'auprc': 0.8646504366675436, 'loss_val': 0.41452995260507847, 'psi': 0.7662252102646221}
[S6] START round=13 head_norm_before_train=1.296932 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.5839922368609607, 'auprc': 0.7309184745536758, 'loss_val': 0.7530856999177042, 'psi': 0.6427627319380467}-{'f1_val': 0.7099929224303602, 'auprc': 0.9642666006133355, 'loss_val': 0.5009529386308391, 'psi': 0.8117023937035504}
[S7] START round=13 head_norm_before_train=1.196721 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=1.000000 metrics={'f1_val': 0.6772850182462649, 'auprc': 0.8440446777859678, 'loss_val': 0.63728144251022, 'psi': 0.7439888820621461}-{'f1_val': 0.4427301733524409, 'auprc': 0.6661794273769558, 'loss_val': 1.2027365674505768, 'psi': 0.5321098749622468}
[S8] START round=13 head_norm_before_train=0.971851 cos_to_last_merge=0.9940 (last merge round=11)
[S8] round=13 local utility u=0.098866 metrics={'f1_val': 0.9952904955831205, 'auprc': 0.9961403808829131, 'loss_val': 0.4471677891154898, 'psi': 0.9956304497030375}-{'f1_val': 0.9873589895232592, 'auprc': 0.9960922385971738, 'loss_val': 0.5971660014012039, 'psi': 0.990852289152825}
[S9] START round=13 head_norm_before_train=1.805960 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9993807059304121, 'loss_val': 0.055044819453467175, 'psi': 0.992039085062042}-{'f1_val': 0.994356655862817, 'auprc': 0.9994897697213286, 'loss_val': 0.03996311839689838, 'psi': 0.9964099014062217}
[S10] START round=13 head_norm_before_train=1.573695 (no previous merge yet)
[S10] round=13 local utility u=0.013494 metrics={'f1_val': 0.6890692334955134, 'auprc': 0.9924944467405983, 'loss_val': 0.24037712016023213, 'psi': 0.8104393187935474}-{'f1_val': 0.6888947466168216, 'auprc': 0.9972007243625827, 'loss_val': 0.28043802714143135, 'psi': 0.812217137715126}
[S11] START round=13 head_norm_before_train=1.569241 (no previous merge yet)
[S11] round=13 local utility u=0.086320 metrics={'f1_val': 0.956191288501426, 'auprc': 0.9980047137719681, 'loss_val': 0.26818116483964255, 'psi': 0.9729166586096429}-{'f1_val': 0.9472291028221891, 'auprc': 0.9989743299163591, 'loss_val': 0.38995624755127245, 'psi': 0.9679271936598571}
[S13] START round=13 head_norm_before_train=1.143415 cos_to_last_merge=0.9978 (last merge round=11)
[S13] round=13 local utility u=0.092288 metrics={'f1_val': 0.6816155387426601, 'auprc': 0.6911558619510862, 'loss_val': 0.6703827112665411, 'psi': 0.6854316680260306}-{'f1_val': 0.6308527288280121, 'auprc': 0.760952771401855, 'loss_val': 0.759772024889963, 'psi': 0.6828927458575493}
[S14] START round=13 head_norm_before_train=1.432538 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.012099 metrics={'f1_val': 0.9975084813078557, 'auprc': 0.9968970541955581, 'loss_val': 0.24308583152506288, 'psi': 0.9972639104629366}-{'f1_val': 0.997673454559638, 'auprc': 0.9957251677976101, 'loss_val': 0.26475872298674663, 'psi': 0.9968941398548268}
[S15] START round=13 head_norm_before_train=1.562860 (no previous merge yet)
[S15] round=13 local utility u=0.047033 metrics={'f1_val': 0.7010627075051665, 'auprc': 0.9915166011847724, 'loss_val': 0.3424469669450722, 'psi': 0.8172442649770089}-{'f1_val': 0.6988623887349907, 'auprc': 0.9930214737417797, 'loss_val': 0.4278258326250777, 'psi': 0.8165260227377062}
[S16] START round=13 head_norm_before_train=0.748875 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.379374 metrics={'f1_val': 0.5333511080236519, 'auprc': 0.7935453450080707, 'loss_val': 0.7989013997351093, 'psi': 0.6374288028174195}-{'f1_val': 0.4331198308307587, 'auprc': 0.7535286167742898, 'loss_val': 0.836211209195243, 'psi': 0.5612833452081711}
[S17] START round=13 head_norm_before_train=1.510790 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3478537610370691, 'auprc': 0.7513663434251433, 'loss_val': 0.9285428920173295, 'psi': 0.5092587939922988}-{'f1_val': 0.3842508212578712, 'auprc': 0.7765066247246503, 'loss_val': 0.9136770451721338, 'psi': 0.5411531426445828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:50313
[S5] not sending this round → trigger blocked (psi=0.795)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:50309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:50304
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S10] not sending this round → trigger blocked (psi=0.810)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.4172
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.7948
[S10] RECEIVED delta(kind=head bytes=1805) from S11
[S10] cosine check vs S11: cos=-0.0010
[S10] DROPPED delta from S11 (cos=-0.0010 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.5412
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.3162
[S4] RECEIVED delta(kind=head bytes=1789) from S16
[S4] cosine check vs S16: cos=0.8081
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] cosine check vs S14: cos=0.9221
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9953 head_norm=1.027631
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.203111e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9880 head_norm=0.901432 delta_norm=0.220311
[S8] aggregate: ROLLBACK (f1_val pre=0.995 post=0.988 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6706 head_norm=0.945949
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.789713e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6705 head_norm=0.827683 delta_norm=0.278971
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6816 head_norm=1.174448
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.003412e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6872 head_norm=1.299302 delta_norm=0.300341
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6773 head_norm=1.226820
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.410229e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.3479 head_norm=1.152780 delta_norm=0.841023
[S7] aggregate: ROLLBACK (f1_val pre=0.677 post=0.348 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5334 head_norm=0.794322
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.549460e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5239 head_norm=0.834969 delta_norm=0.554946
[S16] aggregate: ROLLBACK (f1_val pre=0.533 post=0.524 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.344844 cos_to_last_merge=0.8723 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.872
[S2] round=14 local utility u=0.026033 metrics={'f1_val': 0.7018280867012174, 'auprc': 0.737607419537774, 'loss_val': 0.3159702883187288, 'psi': 0.71613981983584}-{'f1_val': 0.7016512288906386, 'auprc': 0.7266571331746096, 'loss_val': 0.33412511177224025, 'psi': 0.711653590604227}
[S3] START round=14 head_norm_before_train=1.138091 cos_to_last_merge=0.9934 (last merge round=12)
[S3] round=14 local utility u=1.000000 metrics={'f1_val': 0.9986383585344689, 'auprc': 0.9996765394710634, 'loss_val': 0.216980045983373, 'psi': 0.9990536309091067}-{'f1_val': 0.6391411068860848, 'auprc': 0.8495336905054243, 'loss_val': 0.4715919244201066, 'psi': 0.7232981403338206}
[S4] START round=14 head_norm_before_train=0.827683 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6700874322833569, 'auprc': 0.6898076127058235, 'loss_val': 0.5147079707388538, 'psi': 0.6779755044523434}-{'f1_val': 0.6705540863655298, 'auprc': 0.7997811427530398, 'loss_val': 0.49664893210651895, 'psi': 0.7222449089205338}
[S5] START round=14 head_norm_before_train=1.278296 cos_to_last_merge=0.9973 (last merge round=12)
[S5] round=14 local utility u=0.087285 metrics={'f1_val': 0.700320598491359, 'auprc': 0.97953650277148, 'loss_val': 0.3217194940342764, 'psi': 0.8120069602034075}-{'f1_val': 0.7006083926626743, 'auprc': 0.9376941364548308, 'loss_val': 0.3724899180865704, 'psi': 0.7954426901795368}
[S6] START round=14 head_norm_before_train=1.325616 cos_to_last_merge=0.9985 (last merge round=12)
[S6] round=14 local utility u=0.866998 metrics={'f1_val': 0.7061766937221938, 'auprc': 0.9581949616037981, 'loss_val': 0.43402585155378015, 'psi': 0.8069840008748356}-{'f1_val': 0.5839922368609607, 'auprc': 0.7309184745536758, 'loss_val': 0.7530856999177042, 'psi': 0.6427627319380467}
[S7] START round=14 head_norm_before_train=1.152780 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6290854890966924, 'auprc': 0.7997618170869369, 'loss_val': 0.8911062167059486, 'psi': 0.6973560202927902}-{'f1_val': 0.6772850182462649, 'auprc': 0.8440446777859678, 'loss_val': 0.63728144251022, 'psi': 0.7439888820621461}
[S8] START round=14 head_norm_before_train=0.901432 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.8985030734499779, 'auprc': 0.9945034826754596, 'loss_val': 0.4195411335506401, 'psi': 0.9369032371401707}-{'f1_val': 0.9952904955831205, 'auprc': 0.9961403808829131, 'loss_val': 0.4471677891154898, 'psi': 0.9956304497030375}
[S9] START round=14 head_norm_before_train=1.843182 (no previous merge yet)
[S9] round=14 local utility u=0.037000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9953856150129943, 'loss_val': 0.028809402537880925, 'psi': 0.9964159935124834}-{'f1_val': 0.9871446711497952, 'auprc': 0.9993807059304121, 'loss_val': 0.055044819453467175, 'psi': 0.992039085062042}
[S10] START round=14 head_norm_before_train=1.601470 (no previous merge yet)
[S10] round=14 local utility u=0.041883 metrics={'f1_val': 0.7646710482127828, 'auprc': 0.9215069072497186, 'loss_val': 0.39725882787397443, 'psi': 0.8274053918275571}-{'f1_val': 0.6890692334955134, 'auprc': 0.9924944467405983, 'loss_val': 0.24037712016023213, 'psi': 0.8104393187935474}
[S11] START round=14 head_norm_before_train=1.618485 (no previous merge yet)
[S11] round=14 local utility u=0.046247 metrics={'f1_val': 0.958333804236671, 'auprc': 0.9984616515020144, 'loss_val': 0.1899136253776461, 'psi': 0.9743849431428084}-{'f1_val': 0.956191288501426, 'auprc': 0.9980047137719681, 'loss_val': 0.26818116483964255, 'psi': 0.9729166586096429}
[S13] START round=14 head_norm_before_train=1.299302 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6125963512706005, 'auprc': 0.6751437064908627, 'loss_val': 0.7124026212176543, 'psi': 0.6376152933587054}-{'f1_val': 0.6816155387426601, 'auprc': 0.6911558619510862, 'loss_val': 0.6703827112665411, 'psi': 0.6854316680260306}
[S14] START round=14 head_norm_before_train=1.475619 cos_to_last_merge=0.9988 (last merge round=12)
[S14] round=14 local utility u=0.031144 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.9971191031015201, 'loss_val': 0.17233842152446857, 'psi': 0.9964400954629884}-{'f1_val': 0.9975084813078557, 'auprc': 0.9968970541955581, 'loss_val': 0.24308583152506288, 'psi': 0.9972639104629366}
[S15] START round=14 head_norm_before_train=1.602297 (no previous merge yet)
[S15] round=14 local utility u=0.049482 metrics={'f1_val': 0.701588966402071, 'auprc': 0.9946137134639903, 'loss_val': 0.25593261650871485, 'psi': 0.8187988652268388}-{'f1_val': 0.7010627075051665, 'auprc': 0.9915166011847724, 'loss_val': 0.3424469669450722, 'psi': 0.8172442649770089}
[S16] START round=14 head_norm_before_train=0.834969 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.075075 metrics={'f1_val': 0.5536009305367499, 'auprc': 0.8078932040116171, 'loss_val': 0.8132932956554826, 'psi': 0.6553178399266968}-{'f1_val': 0.5333511080236519, 'auprc': 0.7935453450080707, 'loss_val': 0.7989013997351093, 'psi': 0.6374288028174195}
[S17] START round=14 head_norm_before_train=1.533718 (no previous merge yet)
[S17] round=14 local utility u=0.239828 metrics={'f1_val': 0.38313092273771154, 'auprc': 0.8188896456399526, 'loss_val': 0.8631206888165857, 'psi': 0.557434411898608}-{'f1_val': 0.3478537610370691, 'auprc': 0.7513663434251433, 'loss_val': 0.9285428920173295, 'psi': 0.5092587939922988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:50305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.655)
[S15] not sending this round → trigger blocked (psi=0.819)
[S14] not sending this round → trigger blocked (psi=0.996)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.974)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S2
[S5] cosine check vs S2: cos=0.9533
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=-0.1800
[S7] DROPPED delta from S6 (cos=-0.1800 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.6163
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.5417
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.8510
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.7585
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.9641
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6291 head_norm=1.172282
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.987428e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6147 head_norm=1.233181 delta_norm=0.698743
[S7] aggregate: ROLLBACK (f1_val pre=0.629 post=0.615 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9960 head_norm=1.522869
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.064844e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9956 head_norm=1.524144 delta_norm=0.206484
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7062 head_norm=1.357681
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.579232e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7058 head_norm=1.239910 delta_norm=0.357923
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7003 head_norm=1.347193
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.102095e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7003 head_norm=1.352764 delta_norm=0.210210
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.9986 head_norm=1.219702
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.351358e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.9982 head_norm=1.194748 delta_norm=0.235136
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.390462 cos_to_last_merge=0.8628 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.863
[S2] round=15 local utility u=0.021829 metrics={'f1_val': 0.7018212919611415, 'auprc': 0.7577101140271022, 'loss_val': 0.33257947071681626, 'psi': 0.7241768207875259}-{'f1_val': 0.7018280867012174, 'auprc': 0.737607419537774, 'loss_val': 0.3159702883187288, 'psi': 0.71613981983584}
[S3] START round=15 head_norm_before_train=1.194748 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7865396437331055, 'auprc': 0.8390994769872978, 'loss_val': 0.44546242977456196, 'psi': 0.8075635770347824}-{'f1_val': 0.9986383585344689, 'auprc': 0.9996765394710634, 'loss_val': 0.216980045983373, 'psi': 0.9990536309091067}
[S4] START round=15 head_norm_before_train=0.884301 cos_to_last_merge=0.9973 (last merge round=13)
[S4] round=15 local utility u=0.204839 metrics={'f1_val': 0.6680606960324974, 'auprc': 0.82325646833565, 'loss_val': 0.49321595517507855, 'psi': 0.7301390049537585}-{'f1_val': 0.6700874322833569, 'auprc': 0.6898076127058235, 'loss_val': 0.5147079707388538, 'psi': 0.6779755044523434}
[S5] START round=15 head_norm_before_train=1.352764 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.017603 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989655972219746, 'loss_val': 0.31687643976389646, 'psi': 0.8160551793482467}-{'f1_val': 0.700320598491359, 'auprc': 0.97953650277148, 'loss_val': 0.3217194940342764, 'psi': 0.8120069602034075}
[S6] START round=15 head_norm_before_train=1.239910 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.031016 metrics={'f1_val': 0.701973914998577, 'auprc': 0.9795675577900402, 'loss_val': 0.4108950337751545, 'psi': 0.8130113721151624}-{'f1_val': 0.7061766937221938, 'auprc': 0.9581949616037981, 'loss_val': 0.43402585155378015, 'psi': 0.8069840008748356}
[S7] START round=15 head_norm_before_train=1.233181 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5205281259388208, 'auprc': 0.760665435921399, 'loss_val': 0.9581459022716932, 'psi': 0.6165830499318521}-{'f1_val': 0.6290854890966924, 'auprc': 0.7997618170869369, 'loss_val': 0.8911062167059486, 'psi': 0.6973560202927902}
[S8] START round=15 head_norm_before_train=0.959149 cos_to_last_merge=0.9954 (last merge round=13)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.8146606535187253, 'auprc': 0.9965252888473464, 'loss_val': 0.34882344196138215, 'psi': 0.8874065076501737}-{'f1_val': 0.8985030734499779, 'auprc': 0.9945034826754596, 'loss_val': 0.4195411335506401, 'psi': 0.9369032371401707}
[S9] START round=15 head_norm_before_train=1.871798 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9995961923532206, 'loss_val': 0.03397329945209789, 'psi': 0.9949456484547192}-{'f1_val': 0.9971029125121428, 'auprc': 0.9953856150129943, 'loss_val': 0.028809402537880925, 'psi': 0.9964159935124834}
[S10] START round=15 head_norm_before_train=1.625949 (no previous merge yet)
[S10] round=15 local utility u=0.923392 metrics={'f1_val': 0.9935344890371376, 'auprc': 0.9976413508653359, 'loss_val': 0.15205922035242614, 'psi': 0.9951772337684169}-{'f1_val': 0.7646710482127828, 'auprc': 0.9215069072497186, 'loss_val': 0.39725882787397443, 'psi': 0.8274053918275571}
[S11] START round=15 head_norm_before_train=1.664691 (no previous merge yet)
[S11] round=15 local utility u=0.030023 metrics={'f1_val': 0.9604504810009227, 'auprc': 0.9981554664627083, 'loss_val': 0.14164915635176356, 'psi': 0.9755324751856369}-{'f1_val': 0.958333804236671, 'auprc': 0.9984616515020144, 'loss_val': 0.1899136253776461, 'psi': 0.9743849431428084}
[S13] START round=15 head_norm_before_train=1.326269 cos_to_last_merge=0.9985 (last merge round=13)
[S13] round=15 local utility u=0.303733 metrics={'f1_val': 0.6987048354166765, 'auprc': 0.6699862327934405, 'loss_val': 0.6061154449135234, 'psi': 0.687217394367382}-{'f1_val': 0.6125963512706005, 'auprc': 0.6751437064908627, 'loss_val': 0.7124026212176543, 'psi': 0.6376152933587054}
[S14] START round=15 head_norm_before_train=1.524144 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.011347 metrics={'f1_val': 0.9983274240503504, 'auprc': 0.9971580926967227, 'loss_val': 0.163800418451885, 'psi': 0.9978596915088993}-{'f1_val': 0.9959874237039671, 'auprc': 0.9971191031015201, 'loss_val': 0.17233842152446857, 'psi': 0.9964400954629884}
[S15] START round=15 head_norm_before_train=1.644801 (no previous merge yet)
[S15] round=15 local utility u=0.016165 metrics={'f1_val': 0.7020338448704696, 'auprc': 0.9925738246890558, 'loss_val': 0.22015227793269504, 'psi': 0.8182498367979041}-{'f1_val': 0.701588966402071, 'auprc': 0.9946137134639903, 'loss_val': 0.25593261650871485, 'psi': 0.8187988652268388}
[S16] START round=15 head_norm_before_train=0.872156 cos_to_last_merge=0.9963 (last merge round=13)
[S16] round=15 local utility u=0.052529 metrics={'f1_val': 0.5279855083955649, 'auprc': 0.8519110918828413, 'loss_val': 0.6865974255333666, 'psi': 0.6575557417904755}-{'f1_val': 0.5536009305367499, 'auprc': 0.8078932040116171, 'loss_val': 0.8132932956554826, 'psi': 0.6553178399266968}
[S17] START round=15 head_norm_before_train=1.553118 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.38067398184575796, 'auprc': 0.8129228710724322, 'loss_val': 0.8699631084734993, 'psi': 0.5535735375364277}-{'f1_val': 0.38313092273771154, 'auprc': 0.8188896456399526, 'loss_val': 0.8631206888165857, 'psi': 0.557434411898608}
[S6] not sending this round → trigger blocked (psi=0.813)
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.724)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:50311
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S11
[S10] cosine check vs S11: cos=0.0026
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=0.8362
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.9534
[S8] RECEIVED delta(kind=head bytes=1791) from S4
[S8] cosine check vs S4: cos=0.7894
[S7] RECEIVED delta(kind=head bytes=1806) from S15
[S7] cosine check vs S15: cos=0.4017
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.7279
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.114 → S3@127.0.0.1:50303
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.5205 head_norm=1.270172
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.267578e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.7058 head_norm=1.242372 delta_norm=0.826758
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.269 → S8@127.0.0.1:50309
[S2] ⇄ pheromone p=0.159 → S5@127.0.0.1:50305
[S6] ⇄ pheromone p=0.402 → S7@127.0.0.1:50308
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9935 head_norm=1.646859
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.185506e+00
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.8176 head_norm=1.188617 delta_norm=1.185506
[S10] aggregate: ROLLBACK (f1_val pre=0.994 post=0.818 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.326 → S7@127.0.0.1:50308
[S5] ⇄ pheromone p=0.247 → S3@127.0.0.1:50303
[S3] ⇄ pheromone p=0.367 → S6@127.0.0.1:50307
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.8147 head_norm=1.018883
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.199278e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7142 head_norm=0.926334 delta_norm=0.319928
[S8] aggregate: ROLLBACK (f1_val pre=0.815 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.263 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.269 → S13@127.0.0.1:50313
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5280 head_norm=0.912826
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.893605e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5146 head_norm=1.090643 delta_norm=0.389360
[S16] aggregate: ROLLBACK (f1_val pre=0.528 post=0.515 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.179 → S4@127.0.0.1:50304
[S11] ⇄ pheromone p=0.264 → S10@127.0.0.1:50311
[S15] ⇄ pheromone p=0.152 → S7@127.0.0.1:50308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6681 head_norm=0.939560
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.418820e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6681 head_norm=0.860888 delta_norm=0.341882
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.180 → S8@127.0.0.1:50309
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6987 head_norm=1.359763
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.451292e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6955 head_norm=1.445310 delta_norm=0.245129
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.210 → S16@127.0.0.1:50316
[S17] ⇄ pheromone p=0.141 → S14@127.0.0.1:50314
[S2] START round=16 head_norm_before_train=1.426834 cos_to_last_merge=0.8558 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.856
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013039002817787, 'auprc': 0.689486129114379, 'loss_val': 0.32346708119586276, 'psi': 0.6965767918148188}-{'f1_val': 0.7018212919611415, 'auprc': 0.7577101140271022, 'loss_val': 0.33257947071681626, 'psi': 0.7241768207875259}
[S3] START round=16 head_norm_before_train=1.257990 cos_to_last_merge=0.9973 (last merge round=14)
[S3] round=16 local utility u=0.970808 metrics={'f1_val': 0.9860741485668865, 'auprc': 0.9995222912464279, 'loss_val': 0.18232104090421866, 'psi': 0.9914534056387031}-{'f1_val': 0.7865396437331055, 'auprc': 0.8390994769872978, 'loss_val': 0.44546242977456196, 'psi': 0.8075635770347824}
[S4] START round=16 head_norm_before_train=0.860888 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.155273 metrics={'f1_val': 0.6677862587171377, 'auprc': 0.9398465142249848, 'loss_val': 0.5307928770811858, 'psi': 0.7766103609202766}-{'f1_val': 0.6680606960324974, 'auprc': 0.82325646833565, 'loss_val': 0.49321595517507855, 'psi': 0.7301390049537585}
[S5] START round=16 head_norm_before_train=1.404479 cos_to_last_merge=0.9983 (last merge round=14)
[S5] round=16 local utility u=0.015532 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9909988221397679, 'loss_val': 0.28984012083311983, 'psi': 0.8165923193162554}-{'f1_val': 0.7003213174339138, 'auprc': 0.989655972219746, 'loss_val': 0.31687643976389646, 'psi': 0.8160551793482467}
[S6] START round=16 head_norm_before_train=1.274107 cos_to_last_merge=0.9981 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.641588774969853, 'auprc': 0.7977769306015414, 'loss_val': 0.5312771029754105, 'psi': 0.7040640372225284}-{'f1_val': 0.701973914998577, 'auprc': 0.9795675577900402, 'loss_val': 0.4108950337751545, 'psi': 0.8130113721151624}
[S7] START round=16 head_norm_before_train=1.242372 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=1.000000 metrics={'f1_val': 0.6989882595248549, 'auprc': 0.9620976769043197, 'loss_val': 0.6305430768476282, 'psi': 0.8042320264766408}-{'f1_val': 0.5205281259388208, 'auprc': 0.760665435921399, 'loss_val': 0.9581459022716932, 'psi': 0.6165830499318521}
[S8] START round=16 head_norm_before_train=0.926334 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.561839 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9945080706397732, 'loss_val': 0.3109690284892032, 'psi': 0.995787152844569}-{'f1_val': 0.8146606535187253, 'auprc': 0.9965252888473464, 'loss_val': 0.34882344196138215, 'psi': 0.8874065076501737}
[S9] START round=16 head_norm_before_train=1.894908 (no previous merge yet)
[S9] round=16 local utility u=0.014335 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995493536161082, 'loss_val': 0.024541622102575048, 'psi': 0.9964591619717185}-{'f1_val': 0.9918452858557183, 'auprc': 0.9995961923532206, 'loss_val': 0.03397329945209789, 'psi': 0.9949456484547192}
[S10] START round=16 head_norm_before_train=1.188617 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9956867236463709, 'auprc': 0.9977197797894014, 'loss_val': 0.3335307810930421, 'psi': 0.9964999461035831}-{'f1_val': 0.9935344890371376, 'auprc': 0.9976413508653359, 'loss_val': 0.15205922035242614, 'psi': 0.9951772337684169}
[S11] START round=16 head_norm_before_train=1.710065 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.9578817011518701, 'auprc': 0.9986124063245503, 'loss_val': 0.17429910068809412, 'psi': 0.9741739832209422}-{'f1_val': 0.9604504810009227, 'auprc': 0.9981554664627083, 'loss_val': 0.14164915635176356, 'psi': 0.9755324751856369}
[S13] START round=16 head_norm_before_train=1.445310 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5776726977193467, 'auprc': 0.6541078583815504, 'loss_val': 0.7615263287145735, 'psi': 0.6082467619842282}-{'f1_val': 0.6987048354166765, 'auprc': 0.6699862327934405, 'loss_val': 0.6061154449135234, 'psi': 0.687217394367382}
[S14] START round=16 head_norm_before_train=1.564948 cos_to_last_merge=0.9992 (last merge round=14)
[S14] round=16 local utility u=0.017038 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971285442158615, 'loss_val': 0.12311356689646923, 'psi': 0.9971956317098205}-{'f1_val': 0.9983274240503504, 'auprc': 0.9971580926967227, 'loss_val': 0.163800418451885, 'psi': 0.9978596915088993}
[S15] START round=16 head_norm_before_train=1.685436 (no previous merge yet)
[S15] round=16 local utility u=0.400586 metrics={'f1_val': 0.8285771524602519, 'auprc': 0.9905077573624357, 'loss_val': 0.17204271633555684, 'psi': 0.8933493944211254}-{'f1_val': 0.7020338448704696, 'auprc': 0.9925738246890558, 'loss_val': 0.22015227793269504, 'psi': 0.8182498367979041}
[S16] START round=16 head_norm_before_train=1.090643 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8689117460477268, 'auprc': 0.9042035047604536, 'loss_val': 0.6689187009405747, 'psi': 0.8830284495328176}-{'f1_val': 0.5279855083955649, 'auprc': 0.8519110918828413, 'loss_val': 0.6865974255333666, 'psi': 0.6575557417904755}
[S17] START round=16 head_norm_before_train=1.578048 (no previous merge yet)
[S17] round=16 local utility u=0.151786 metrics={'f1_val': 0.3984631994860325, 'auprc': 0.8153121153621957, 'loss_val': 0.6802941836498705, 'psi': 0.5652027658364978}-{'f1_val': 0.38067398184575796, 'auprc': 0.8129228710724322, 'loss_val': 0.8699631084734993, 'psi': 0.5535735375364277}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:50316
[S16] not sending this round → trigger blocked (psi=0.883)
[S4] not sending this round → trigger blocked (psi=0.777)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:50303
[S15] not sending this round → trigger blocked (psi=0.893)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:50309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=0.4349
[S8] RECEIVED delta(kind=head bytes=1806) from S7
[S8] cosine check vs S7: cos=0.3983
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.9345
[S3] RECEIVED delta(kind=head bytes=1806) from S5
[S3] cosine check vs S5: cos=0.5948
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.8014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9781
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6416 head_norm=1.313261
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.383863e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7073 head_norm=1.295726 delta_norm=0.238386
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9972 head_norm=1.608431
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.682982e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9972 head_norm=1.597559 delta_norm=0.168298
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8689 head_norm=1.123145
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.626511e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8683 head_norm=0.892277 delta_norm=0.562651
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9966 head_norm=0.981843
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.270944e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9961 head_norm=0.942104 delta_norm=0.627094
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9861 head_norm=1.321670
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.201626e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9754 head_norm=1.278536 delta_norm=0.220163
[S3] aggregate: ROLLBACK (f1_val pre=0.986 post=0.975 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.455656 cos_to_last_merge=0.8505 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.850
[S2] round=17 local utility u=0.051224 metrics={'f1_val': 0.7143221997461963, 'auprc': 0.7968625053927632, 'loss_val': 0.6212570921124017, 'psi': 0.7473383220048231}-{'f1_val': 0.7013039002817787, 'auprc': 0.689486129114379, 'loss_val': 0.32346708119586276, 'psi': 0.6965767918148188}
[S3] START round=17 head_norm_before_train=1.278536 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.4717185458776336, 'auprc': 0.6875192664517673, 'loss_val': 0.8439601346763266, 'psi': 0.558038834107287}-{'f1_val': 0.9860741485668865, 'auprc': 0.9995222912464279, 'loss_val': 0.18232104090421866, 'psi': 0.9914534056387031}
[S4] START round=17 head_norm_before_train=0.907178 cos_to_last_merge=0.9974 (last merge round=15)
[S4] round=17 local utility u=0.003541 metrics={'f1_val': 0.6679266052586208, 'auprc': 0.929437283346433, 'loss_val': 0.49332544660542216, 'psi': 0.7725308764937457}-{'f1_val': 0.6677862587171377, 'auprc': 0.9398465142249848, 'loss_val': 0.5307928770811858, 'psi': 0.7766103609202766}
[S5] START round=17 head_norm_before_train=1.452025 cos_to_last_merge=0.9956 (last merge round=14)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.962913366096684, 'loss_val': 0.2999245265783547, 'psi': 0.8053577055334891}-{'f1_val': 0.7003213174339138, 'auprc': 0.9909988221397679, 'loss_val': 0.28984012083311983, 'psi': 0.8165923193162554}
[S6] START round=17 head_norm_before_train=1.295726 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.229571 metrics={'f1_val': 0.7055152742906186, 'auprc': 0.8120573662260864, 'loss_val': 0.49853539593592133, 'psi': 0.7481321110648057}-{'f1_val': 0.641588774969853, 'auprc': 0.7977769306015414, 'loss_val': 0.5312771029754105, 'psi': 0.7040640372225284}
[S7] START round=17 head_norm_before_train=1.263961 cos_to_last_merge=0.9964 (last merge round=15)
[S7] round=17 local utility u=0.134794 metrics={'f1_val': 0.7001397550937472, 'auprc': 0.993014576997403, 'loss_val': 0.46061415767340474, 'psi': 0.8172896838552095}-{'f1_val': 0.6989882595248549, 'auprc': 0.9620976769043197, 'loss_val': 0.6305430768476282, 'psi': 0.8042320264766408}
[S8] START round=17 head_norm_before_train=0.942104 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9954637732876968, 'auprc': 0.9980162280308953, 'loss_val': 0.3756309947798517, 'psi': 0.9964847551849763}-{'f1_val': 0.9966398743144329, 'auprc': 0.9945080706397732, 'loss_val': 0.3109690284892032, 'psi': 0.995787152844569}
[S9] START round=17 head_norm_before_train=1.917308 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9959395464191885, 'loss_val': 0.04101669005070708, 'psi': 0.9921929233847999}-{'f1_val': 0.9971029125121428, 'auprc': 0.995493536161082, 'loss_val': 0.024541622102575048, 'psi': 0.9964591619717185}
[S10] START round=17 head_norm_before_train=1.210881 cos_to_last_merge=0.9989 (last merge round=15)
[S10] round=17 local utility u=0.031893 metrics={'f1_val': 0.994795012871456, 'auprc': 0.9975893621071562, 'loss_val': 0.2640033239985473, 'psi': 0.9959127525657361}-{'f1_val': 0.9956867236463709, 'auprc': 0.9977197797894014, 'loss_val': 0.3335307810930421, 'psi': 0.9964999461035831}
[S11] START round=17 head_norm_before_train=1.745549 (no previous merge yet)
[S11] round=17 local utility u=0.152390 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981176860846702, 'loss_val': 0.10251031302974739, 'psi': 0.9974235722806448}-{'f1_val': 0.9578817011518701, 'auprc': 0.9986124063245503, 'loss_val': 0.17429910068809412, 'psi': 0.9741739832209422}
[S13] START round=17 head_norm_before_train=1.472575 cos_to_last_merge=0.9991 (last merge round=15)
[S13] round=17 local utility u=0.005885 metrics={'f1_val': 0.5712357119652276, 'auprc': 0.6704521365142575, 'loss_val': 0.7601665023770846, 'psi': 0.6109222817848395}-{'f1_val': 0.5776726977193467, 'auprc': 0.6541078583815504, 'loss_val': 0.7615263287145735, 'psi': 0.6082467619842282}
[S14] START round=17 head_norm_before_train=1.597559 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9958293100259006, 'loss_val': 0.1298796495324691, 'psi': 0.9964297721056872}-{'f1_val': 0.997240356705793, 'auprc': 0.9971285442158615, 'loss_val': 0.12311356689646923, 'psi': 0.9971956317098205}
[S15] START round=17 head_norm_before_train=1.718942 (no previous merge yet)
[S15] round=17 local utility u=0.564378 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9988180788634481, 'loss_val': 0.07893390914552814, 'psi': 0.9977451889963671}-{'f1_val': 0.8285771524602519, 'auprc': 0.9905077573624357, 'loss_val': 0.17204271633555684, 'psi': 0.8933493944211254}
[S16] START round=17 head_norm_before_train=0.892277 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8181962524449481, 'auprc': 0.88873938496554, 'loss_val': 0.5966175057874225, 'psi': 0.8464135054531848}-{'f1_val': 0.8689117460477268, 'auprc': 0.9042035047604536, 'loss_val': 0.6689187009405747, 'psi': 0.8830284495328176}
[S17] START round=17 head_norm_before_train=1.604365 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.39194084996966394, 'auprc': 0.817120559315924, 'loss_val': 0.8010145158401134, 'psi': 0.562012733708168}-{'f1_val': 0.3984631994860325, 'auprc': 0.8153121153621957, 'loss_val': 0.6802941836498705, 'psi': 0.5652027658364978}
[S7] not sending this round → trigger blocked (psi=0.817)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:50311
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.6875
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.8407
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.6199
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] cosine check vs S11: cos=0.6833
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9635
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.3602
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.1830
[S7] DROPPED delta from S6 (cos=-0.1830 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=1.481839
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.000920e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.467952 delta_norm=0.200092
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.7001 head_norm=1.292574
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.928409e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.7000 head_norm=1.151746 delta_norm=0.292841
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9955 head_norm=0.985137
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.243001e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9964 head_norm=0.875654 delta_norm=0.424300
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9948 head_norm=1.240134
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.470392e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9966 head_norm=1.385659 delta_norm=0.647039
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8182 head_norm=0.943931
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.456609e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8256 head_norm=1.126956 delta_norm=0.545661
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.481213 cos_to_last_merge=0.8462 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.846
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6183351837552916, 'auprc': 0.6818737294898545, 'loss_val': 0.5259639935464636, 'psi': 0.6437506020491168}-{'f1_val': 0.7143221997461963, 'auprc': 0.7968625053927632, 'loss_val': 0.6212570921124017, 'psi': 0.7473383220048231}
[S3] START round=18 head_norm_before_train=1.333448 cos_to_last_merge=0.9981 (last merge round=16)
[S3] round=18 local utility u=1.000000 metrics={'f1_val': 0.9983835929041498, 'auprc': 0.9996970318808501, 'loss_val': 0.1350470305995639, 'psi': 0.9989089684948299}-{'f1_val': 0.4717185458776336, 'auprc': 0.6875192664517673, 'loss_val': 0.8439601346763266, 'psi': 0.558038834107287}
[S4] START round=18 head_norm_before_train=0.960784 cos_to_last_merge=0.9904 (last merge round=15)
[S4] round=18 local utility u=0.898647 metrics={'f1_val': 0.957922529976148, 'auprc': 0.9412221481790332, 'loss_val': 0.4713616704532931, 'psi': 0.951242377257302}-{'f1_val': 0.6679266052586208, 'auprc': 0.929437283346433, 'loss_val': 0.49332544660542216, 'psi': 0.7725308764937457}
[S5] START round=18 head_norm_before_train=1.467952 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9450598191208357, 'loss_val': 0.32536847094946614, 'psi': 0.7982162867431497}-{'f1_val': 0.700320598491359, 'auprc': 0.962913366096684, 'loss_val': 0.2999245265783547, 'psi': 0.8053577055334891}
[S6] START round=18 head_norm_before_train=1.329184 cos_to_last_merge=0.9988 (last merge round=16)
[S6] round=18 local utility u=0.796505 metrics={'f1_val': 0.9089906760606751, 'auprc': 0.9226522343538267, 'loss_val': 0.45816262753800535, 'psi': 0.9144552993779358}-{'f1_val': 0.7055152742906186, 'auprc': 0.8120573662260864, 'loss_val': 0.49853539593592133, 'psi': 0.7481321110648057}
[S7] START round=18 head_norm_before_train=1.151746 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6417132768155089, 'auprc': 0.6839449443303613, 'loss_val': 0.7358435985581009, 'psi': 0.6586059438214499}-{'f1_val': 0.7001397550937472, 'auprc': 0.993014576997403, 'loss_val': 0.46061415767340474, 'psi': 0.8172896838552095}
[S8] START round=18 head_norm_before_train=0.875654 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7562342792305581, 'auprc': 0.9947508756536274, 'loss_val': 0.3819874182222025, 'psi': 0.8516409177997858}-{'f1_val': 0.9954637732876968, 'auprc': 0.9980162280308953, 'loss_val': 0.3756309947798517, 'psi': 0.9964847551849763}
[S9] START round=18 head_norm_before_train=1.938348 (no previous merge yet)
[S9] round=18 local utility u=0.033308 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969069597346761, 'loss_val': 0.02174967804117659, 'psi': 0.9970245314011561}-{'f1_val': 0.9896951746952075, 'auprc': 0.9959395464191885, 'loss_val': 0.04101669005070708, 'psi': 0.9921929233847999}
[S10] START round=18 head_norm_before_train=1.385659 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9920098468269958, 'auprc': 0.9976224076743322, 'loss_val': 0.375202282417274, 'psi': 0.9942548711659304}-{'f1_val': 0.994795012871456, 'auprc': 0.9975893621071562, 'loss_val': 0.2640033239985473, 'psi': 0.9959127525657361}
[S11] START round=18 head_norm_before_train=1.771860 (no previous merge yet)
[S11] round=18 local utility u=0.007480 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9985260723122357, 'loss_val': 0.08877520840126235, 'psi': 0.997586926771671}-{'f1_val': 0.996960829744628, 'auprc': 0.9981176860846702, 'loss_val': 0.10251031302974739, 'psi': 0.9974235722806448}
[S13] START round=18 head_norm_before_train=1.498181 cos_to_last_merge=0.9973 (last merge round=15)
[S13] round=18 local utility u=0.152455 metrics={'f1_val': 0.6106401156959822, 'auprc': 0.6558262777263424, 'loss_val': 0.6478055706027643, 'psi': 0.6287145805081262}-{'f1_val': 0.5712357119652276, 'auprc': 0.6704521365142575, 'loss_val': 0.7601665023770846, 'psi': 0.6109222817848395}
[S14] START round=18 head_norm_before_train=1.637673 cos_to_last_merge=0.9993 (last merge round=16)
[S14] round=18 local utility u=0.021531 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988894511096331, 'loss_val': 0.09700257408682703, 'psi': 0.9977542853384522}-{'f1_val': 0.9968300801588782, 'auprc': 0.9958293100259006, 'loss_val': 0.1298796495324691, 'psi': 0.9964297721056872}
[S15] START round=18 head_norm_before_train=1.752223 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7644740280326758, 'auprc': 0.9937468540056491, 'loss_val': 0.24181969979499654, 'psi': 0.8561831584218651}-{'f1_val': 0.9970299290849798, 'auprc': 0.9988180788634481, 'loss_val': 0.07893390914552814, 'psi': 0.9977451889963671}
[S16] START round=18 head_norm_before_train=1.126956 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.404303 metrics={'f1_val': 0.9195207565330608, 'auprc': 0.9289696953873697, 'loss_val': 0.5166489374040119, 'psi': 0.9233003320747843}-{'f1_val': 0.8181962524449481, 'auprc': 0.88873938496554, 'loss_val': 0.5966175057874225, 'psi': 0.8464135054531848}
[S17] START round=18 head_norm_before_train=1.628078 (no previous merge yet)
[S17] round=18 local utility u=0.904430 metrics={'f1_val': 0.6554675261283375, 'auprc': 0.8351656137354873, 'loss_val': 0.6274495695307382, 'psi': 0.7273467611711975}-{'f1_val': 0.39194084996966394, 'auprc': 0.817120559315924, 'loss_val': 0.8010145158401134, 'psi': 0.562012733708168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.629)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → trigger blocked (psi=0.914)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.7586
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9684
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=0.8166
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9575
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.9833
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.9090 head_norm=1.365162
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.007423e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.9073 head_norm=1.360072 delta_norm=0.200742
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9579 head_norm=1.015407
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.860369e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6171 head_norm=1.024118 delta_norm=0.386037
[S4] aggregate: ROLLBACK (f1_val pre=0.958 post=0.617 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6106 head_norm=1.521751
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.161240e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6072 head_norm=1.588613 delta_norm=0.216124
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9970 head_norm=1.680796
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.530111e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9970 head_norm=1.659291 delta_norm=0.153011
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9984 head_norm=1.384383
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.745351e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9991 head_norm=1.594320 delta_norm=0.574535
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.500113 cos_to_last_merge=0.8428 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.843
[S2] round=19 local utility u=0.529780 metrics={'f1_val': 0.700523314715465, 'auprc': 0.8280448173722099, 'loss_val': 0.39804558801982265, 'psi': 0.751531915778163}-{'f1_val': 0.6183351837552916, 'auprc': 0.6818737294898545, 'loss_val': 0.5259639935464636, 'psi': 0.6437506020491168}
[S3] START round=19 head_norm_before_train=1.594320 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.016701 metrics={'f1_val': 0.9988243326731401, 'auprc': 0.9998473202346724, 'loss_val': 0.10473981070897224, 'psi': 0.999233527697753}-{'f1_val': 0.9983835929041498, 'auprc': 0.9996970318808501, 'loss_val': 0.1350470305995639, 'psi': 0.9989089684948299}
[S4] START round=19 head_norm_before_train=1.024118 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9567144637625128, 'auprc': 0.9276243167450652, 'loss_val': 0.49401612175574194, 'psi': 0.9450784049555339}-{'f1_val': 0.957922529976148, 'auprc': 0.9412221481790332, 'loss_val': 0.4713616704532931, 'psi': 0.951242377257302}
[S5] START round=19 head_norm_before_train=1.493454 cos_to_last_merge=0.9996 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6638988683682009, 'auprc': 0.9342870792755393, 'loss_val': 0.35674757626311643, 'psi': 0.7720541527311362}-{'f1_val': 0.700320598491359, 'auprc': 0.9450598191208357, 'loss_val': 0.32536847094946614, 'psi': 0.7982162867431497}
[S6] START round=19 head_norm_before_train=1.360072 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6339629100302251, 'auprc': 0.783267901517637, 'loss_val': 0.5907503609387539, 'psi': 0.6936849066251899}-{'f1_val': 0.9089906760606751, 'auprc': 0.9226522343538267, 'loss_val': 0.45816262753800535, 'psi': 0.9144552993779358}
[S7] START round=19 head_norm_before_train=1.180032 cos_to_last_merge=0.9979 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.46090573547886926, 'auprc': 0.6416444307396573, 'loss_val': 1.0470679116323807, 'psi': 0.5332012135831845}-{'f1_val': 0.6417132768155089, 'auprc': 0.6839449443303613, 'loss_val': 0.7358435985581009, 'psi': 0.6586059438214499}
[S8] START round=19 head_norm_before_train=0.923560 cos_to_last_merge=0.9974 (last merge round=17)
[S8] round=19 local utility u=0.769072 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.998477521649277, 'loss_val': 0.2780876199997073, 'psi': 0.9954380137505383}-{'f1_val': 0.7562342792305581, 'auprc': 0.9947508756536274, 'loss_val': 0.3819874182222025, 'psi': 0.8516409177997858}
[S9] START round=19 head_norm_before_train=1.956368 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9994977304699613, 'loss_val': 0.030531707840322133, 'psi': 0.9954097772769033}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969069597346761, 'loss_val': 0.02174967804117659, 'psi': 0.9970245314011561}
[S10] START round=19 head_norm_before_train=1.407981 cos_to_last_merge=0.9984 (last merge round=17)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9561156206714229, 'auprc': 0.9942339979479551, 'loss_val': 0.29767247468411895, 'psi': 0.9713629715820358}-{'f1_val': 0.9920098468269958, 'auprc': 0.9976224076743322, 'loss_val': 0.375202282417274, 'psi': 0.9942548711659304}
[S11] START round=19 head_norm_before_train=1.799140 (no previous merge yet)
[S11] round=19 local utility u=0.005346 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.9986012019071913, 'loss_val': 0.07843225380713309, 'psi': 0.9976292581072008}-{'f1_val': 0.996960829744628, 'auprc': 0.9985260723122357, 'loss_val': 0.08877520840126235, 'psi': 0.997586926771671}
[S13] START round=19 head_norm_before_train=1.588613 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5919897131555171, 'auprc': 0.6767208374777984, 'loss_val': 0.7630365177722157, 'psi': 0.6258821628844295}-{'f1_val': 0.6106401156959822, 'auprc': 0.6558262777263424, 'loss_val': 0.6478055706027643, 'psi': 0.6287145805081262}
[S14] START round=19 head_norm_before_train=1.659291 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971864120402669, 'loss_val': 0.09744709947333949, 'psi': 0.9973195265171422}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988894511096331, 'loss_val': 0.09700257408682703, 'psi': 0.9977542853384522}
[S15] START round=19 head_norm_before_train=1.782626 (no previous merge yet)
[S15] round=19 local utility u=0.727708 metrics={'f1_val': 0.9844674534648232, 'auprc': 0.9913884613887242, 'loss_val': 0.09928852286334008, 'psi': 0.9872358566343836}-{'f1_val': 0.7644740280326758, 'auprc': 0.9937468540056491, 'loss_val': 0.24181969979499654, 'psi': 0.8561831584218651}
[S16] START round=19 head_norm_before_train=1.168175 cos_to_last_merge=0.9976 (last merge round=17)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8909338553421464, 'auprc': 0.9300868206225019, 'loss_val': 0.4958221842058874, 'psi': 0.9065950414542887}-{'f1_val': 0.9195207565330608, 'auprc': 0.9289696953873697, 'loss_val': 0.5166489374040119, 'psi': 0.9233003320747843}
[S17] START round=19 head_norm_before_train=1.651740 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6241602069450469, 'auprc': 0.8236858210147339, 'loss_val': 0.8015565758034875, 'psi': 0.7039704525729218}-{'f1_val': 0.6554675261283375, 'auprc': 0.8351656137354873, 'loss_val': 0.6274495695307382, 'psi': 0.7273467611711975}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.999)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.8091
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9824
[S10] RECEIVED delta(kind=head bytes=1806) from S11
[S10] cosine check vs S11: cos=0.9144
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.6035
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.6639 head_norm=1.523188
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.425432e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.6708 head_norm=1.513161 delta_norm=0.142543
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.772 u=0.0000 p_local=0.1027 f1=0.664 auprc=0.934 bytes=12582
[S9] r=20 psi=0.995 u=0.0000 p_local=0.0535 f1=0.993 auprc=0.999 bytes=16187
[S3] r=20 psi=0.999 u=0.0167 p_local=0.4130 f1=0.999 auprc=1.000 bytes=16166
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9561 head_norm=1.435931
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.885011e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9578 head_norm=1.597333 delta_norm=0.388501
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.971 u=0.0000 p_local=0.1375 f1=0.956 auprc=0.994 bytes=12595
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4609 head_norm=1.221368
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.471800e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4473 head_norm=1.446516 delta_norm=0.547180
[S7] aggregate: ROLLBACK (f1_val pre=0.461 post=0.447 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.533 u=0.0000 p_local=0.2299 f1=0.461 auprc=0.642 bytes=14386
[S4] r=20 psi=0.945 u=0.0000 p_local=0.2340 f1=0.957 auprc=0.928 bytes=14352
[S6] r=20 psi=0.694 u=0.0000 p_local=0.3213 f1=0.634 auprc=0.783 bytes=10768
[S13] r=20 psi=0.626 u=0.0000 p_local=0.1110 f1=0.592 auprc=0.677 bytes=14373
[S14] r=20 psi=0.997 u=0.0000 p_local=0.1153 f1=0.997 auprc=0.997 bytes=14367
[S15] r=20 psi=0.987 u=0.7277 p_local=0.3211 f1=0.984 auprc=0.991 bytes=18000
[S8] r=20 psi=0.995 u=0.7691 p_local=0.3190 f1=0.993 auprc=0.998 bytes=14365
[S11] r=20 psi=0.998 u=0.0053 p_local=0.1299 f1=0.997 auprc=0.999 bytes=17988
[S2] r=20 psi=0.752 u=0.5298 p_local=0.1777 f1=0.701 auprc=0.828 bytes=16187
[S17] r=20 psi=0.704 u=0.0000 p_local=0.2180 f1=0.624 auprc=0.824 bytes=12562
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8909 head_norm=1.218797
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.996459e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9013 head_norm=0.980846 delta_norm=0.499646
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.907 u=0.0000 p_local=0.2404 f1=0.891 auprc=0.930 bytes=12579
[S2] START round=20 head_norm_before_train=1.516525 cos_to_last_merge=0.8402 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.4513068617704065, 'auprc': 0.6644516544422313, 'loss_val': 0.9576297102861442, 'psi': 0.5365647788391364}-{'f1_val': 0.700523314715465, 'auprc': 0.8280448173722099, 'loss_val': 0.39804558801982265, 'psi': 0.751531915778163}
[S3] START round=20 head_norm_before_train=1.631947 cos_to_last_merge=0.9993 (last merge round=18)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.6663352933408724, 'auprc': 0.9021779122198318, 'loss_val': 0.6449377408498196, 'psi': 0.7606723408924562}-{'f1_val': 0.9988243326731401, 'auprc': 0.9998473202346724, 'loss_val': 0.10473981070897224, 'psi': 0.999233527697753}
[S4] START round=20 head_norm_before_train=1.070439 cos_to_last_merge=0.9977 (last merge round=18)
[S4] round=20 local utility u=0.027043 metrics={'f1_val': 0.9561995721888754, 'auprc': 0.9369557177656898, 'loss_val': 0.4648349653089172, 'psi': 0.9485020304196011}-{'f1_val': 0.9567144637625128, 'auprc': 0.9276243167450652, 'loss_val': 0.49401612175574194, 'psi': 0.9450784049555339}
[S5] START round=20 head_norm_before_train=1.513161 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.222025 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9881950753181683, 'loss_val': 0.29295613261295883, 'psi': 0.8154708205876156}-{'f1_val': 0.6638988683682009, 'auprc': 0.9342870792755393, 'loss_val': 0.35674757626311643, 'psi': 0.7720541527311362}
[S6] START round=20 head_norm_before_train=1.385726 cos_to_last_merge=0.9993 (last merge round=18)
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.8797367234508147, 'auprc': 0.9570469509595265, 'loss_val': 0.42131276176314597, 'psi': 0.9106608144542994}-{'f1_val': 0.6339629100302251, 'auprc': 0.783267901517637, 'loss_val': 0.5907503609387539, 'psi': 0.6936849066251899}
[S7] START round=20 head_norm_before_train=1.446516 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6490081623474143, 'auprc': 0.8119833483019115, 'loss_val': 0.6659812125827002, 'psi': 0.7141982367292132}-{'f1_val': 0.46090573547886926, 'auprc': 0.6416444307396573, 'loss_val': 1.0470679116323807, 'psi': 0.5332012135831845}
[S8] START round=20 head_norm_before_train=0.968475 cos_to_last_merge=0.9922 (last merge round=17)
[S8] round=20 local utility u=0.028339 metrics={'f1_val': 0.995381897925576, 'auprc': 0.9977557110934093, 'loss_val': 0.23106493260162317, 'psi': 0.9963314231927093}-{'f1_val': 0.9934116751513793, 'auprc': 0.998477521649277, 'loss_val': 0.2780876199997073, 'psi': 0.9954380137505383}
[S9] START round=20 head_norm_before_train=1.974564 (no previous merge yet)
[S9] round=20 local utility u=0.013281 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9995963810197008, 'loss_val': 0.021818408393606367, 'psi': 0.9972044386817422}-{'f1_val': 0.992684475148198, 'auprc': 0.9994977304699613, 'loss_val': 0.030531707840322133, 'psi': 0.9954097772769033}
[S10] START round=20 head_norm_before_train=1.597333 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.070849 metrics={'f1_val': 0.9840079955372133, 'auprc': 0.997866593573626, 'loss_val': 0.33422627194481347, 'psi': 0.9895514347517784}-{'f1_val': 0.9561156206714229, 'auprc': 0.9942339979479551, 'loss_val': 0.29767247468411895, 'psi': 0.9713629715820358}
[S11] START round=20 head_norm_before_train=1.828365 (no previous merge yet)
[S11] round=20 local utility u=0.005474 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9988396713505612, 'loss_val': 0.0642652224471472, 'psi': 0.9973312483532922}-{'f1_val': 0.9969812955738739, 'auprc': 0.9986012019071913, 'loss_val': 0.07843225380713309, 'psi': 0.9976292581072008}
[S13] START round=20 head_norm_before_train=1.613228 cos_to_last_merge=0.9996 (last merge round=18)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5528262061323037, 'auprc': 0.6775209042193174, 'loss_val': 0.8246994024179468, 'psi': 0.6027040853671092}-{'f1_val': 0.5919897131555171, 'auprc': 0.6767208374777984, 'loss_val': 0.7630365177722157, 'psi': 0.6258821628844295}
[S14] START round=20 head_norm_before_train=1.698423 cos_to_last_merge=0.9994 (last merge round=18)
[S14] round=20 local utility u=0.010785 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989042490289769, 'loss_val': 0.07856523385289611, 'psi': 0.9977602045061897}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971864120402669, 'loss_val': 0.09744709947333949, 'psi': 0.9973195265171422}
[S15] START round=20 head_norm_before_train=1.814356 (no previous merge yet)
[S15] round=20 local utility u=0.068618 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9983352080788072, 'loss_val': 0.058267671771643055, 'psi': 0.9975520406825107}-{'f1_val': 0.9844674534648232, 'auprc': 0.9913884613887242, 'loss_val': 0.09928852286334008, 'psi': 0.9872358566343836}
[S16] START round=20 head_norm_before_train=0.980846 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.124232 metrics={'f1_val': 0.9149146672984959, 'auprc': 0.9473278128318761, 'loss_val': 0.442965121070998, 'psi': 0.927879925511848}-{'f1_val': 0.8909338553421464, 'auprc': 0.9300868206225019, 'loss_val': 0.4958221842058874, 'psi': 0.9065950414542887}
[S17] START round=20 head_norm_before_train=1.672816 (no previous merge yet)
[S17] round=20 local utility u=0.065146 metrics={'f1_val': 0.6417553614182802, 'auprc': 0.8272542957187463, 'loss_val': 0.7875410563335478, 'psi': 0.7159549351384666}-{'f1_val': 0.6241602069450469, 'auprc': 0.8236858210147339, 'loss_val': 0.8015565758034875, 'psi': 0.7039704525729218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S8] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:50304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S10] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.9818
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.9589
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=0.0997
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.7933
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.9641
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=-0.1567
[S7] DROPPED delta from S6 (cos=-0.1567 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.4858
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.3446
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.9873
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.6663 head_norm=1.662136
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.538519e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.6597 head_norm=1.467509 delta_norm=0.353852
[S3] aggregate: ROLLBACK (f1_val pre=0.666 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.330 → S6@127.0.0.1:50307
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9954 head_norm=1.004333
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.018574e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9962 head_norm=0.948722 delta_norm=0.301857
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.261 → S16@127.0.0.1:50316
[S2] ⇄ pheromone p=0.142 → S5@127.0.0.1:50305
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5528 head_norm=1.637354
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.676906e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5313 head_norm=1.678067 delta_norm=0.167691
[S13] aggregate: ROLLBACK (f1_val pre=0.553 post=0.531 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.089 → S16@127.0.0.1:50316
[S11] ⇄ pheromone p=0.105 → S10@127.0.0.1:50311
[S6] ⇄ pheromone p=0.457 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.124 → S7@127.0.0.1:50308
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6490 head_norm=1.477035
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.039001e+00
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6687 head_norm=1.147888 delta_norm=1.039001
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.384 → S8@127.0.0.1:50309
[S9] ⇄ pheromone p=0.045 → S3@127.0.0.1:50303
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9970 head_norm=1.734108
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.377365e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9970 head_norm=1.710286 delta_norm=0.137736
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.094 → S13@127.0.0.1:50313
[S16] ⇄ pheromone p=0.217 → S4@127.0.0.1:50304
[S5] ⇄ pheromone p=0.127 → S3@127.0.0.1:50303
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9562 head_norm=1.126225
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.516514e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9520 head_norm=1.071456 delta_norm=0.151651
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.193 → S8@127.0.0.1:50309
[S15] ⇄ pheromone p=0.271 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=0.187 → S14@127.0.0.1:50314
[S2] START round=21 head_norm_before_train=1.529799 cos_to_last_merge=0.8378 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=21 local utility u=1.000000 metrics={'f1_val': 0.721015523472422, 'auprc': 0.7958406754486023, 'loss_val': 0.6077313491417645, 'psi': 0.7509455842628942}-{'f1_val': 0.4513068617704065, 'auprc': 0.6644516544422313, 'loss_val': 0.9576297102861442, 'psi': 0.5365647788391364}
[S3] START round=21 head_norm_before_train=1.467509 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.227791 metrics={'f1_val': 0.7105355492465982, 'auprc': 0.9298894115004146, 'loss_val': 0.5376925744240614, 'psi': 0.7982770941481248}-{'f1_val': 0.6663352933408724, 'auprc': 0.9021779122198318, 'loss_val': 0.6449377408498196, 'psi': 0.7606723408924562}
[S4] START round=21 head_norm_before_train=1.071456 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.015620 metrics={'f1_val': 0.956812988286874, 'auprc': 0.9343877147433015, 'loss_val': 0.42957145439454525, 'psi': 0.9478428788694451}-{'f1_val': 0.9561995721888754, 'auprc': 0.9369557177656898, 'loss_val': 0.4648349653089172, 'psi': 0.9485020304196011}
[S5] START round=21 head_norm_before_train=1.542421 cos_to_last_merge=0.9996 (last merge round=19)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.43671700517611844, 'auprc': 0.8554823454324183, 'loss_val': 0.8971885668920414, 'psi': 0.6042231412786384}-{'f1_val': 0.7003213174339138, 'auprc': 0.9881950753181683, 'loss_val': 0.29295613261295883, 'psi': 0.8154708205876156}
[S6] START round=21 head_norm_before_train=1.408231 cos_to_last_merge=0.9979 (last merge round=18)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8227244231004506, 'auprc': 0.9537444910514701, 'loss_val': 0.41255212241542627, 'psi': 0.8751324502808584}-{'f1_val': 0.8797367234508147, 'auprc': 0.9570469509595265, 'loss_val': 0.42131276176314597, 'psi': 0.9106608144542994}
[S7] START round=21 head_norm_before_train=1.147888 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.432059 metrics={'f1_val': 0.6974834074120082, 'auprc': 0.9541229441463024, 'loss_val': 0.5191336796594004, 'psi': 0.8001392221057259}-{'f1_val': 0.6490081623474143, 'auprc': 0.8119833483019115, 'loss_val': 0.6659812125827002, 'psi': 0.7141982367292132}
[S8] START round=21 head_norm_before_train=0.948722 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9945369636171975, 'auprc': 0.9967699979358017, 'loss_val': 0.3136521623219796, 'psi': 0.9954301773446392}-{'f1_val': 0.995381897925576, 'auprc': 0.9977557110934093, 'loss_val': 0.23106493260162317, 'psi': 0.9963314231927093}
[S9] START round=21 head_norm_before_train=1.991006 (no previous merge yet)
[S9] round=21 local utility u=0.000431 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974636131032065, 'loss_val': 0.020862877346545634, 'psi': 0.9969817523296175}-{'f1_val': 0.9956098104564366, 'auprc': 0.9995963810197008, 'loss_val': 0.021818408393606367, 'psi': 0.9972044386817422}
[S10] START round=21 head_norm_before_train=1.616388 cos_to_last_merge=0.9992 (last merge round=19)
[S10] round=21 local utility u=0.065246 metrics={'f1_val': 0.9931562797758523, 'auprc': 0.9977884046666377, 'loss_val': 0.2583895807889494, 'psi': 0.9950091297321665}-{'f1_val': 0.9840079955372133, 'auprc': 0.997866593573626, 'loss_val': 0.33422627194481347, 'psi': 0.9895514347517784}
[S11] START round=21 head_norm_before_train=1.857401 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9485457214152527, 'auprc': 0.9990842212115225, 'loss_val': 0.18862488500792865, 'psi': 0.9687611213337606}-{'f1_val': 0.9963256330217796, 'auprc': 0.9988396713505612, 'loss_val': 0.0642652224471472, 'psi': 0.9973312483532922}
[S13] START round=21 head_norm_before_train=1.678067 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.247418 metrics={'f1_val': 0.6127354948172206, 'auprc': 0.6732288968259776, 'loss_val': 0.6764432529658316, 'psi': 0.6369328556207234}-{'f1_val': 0.5528262061323037, 'auprc': 0.6775209042193174, 'loss_val': 0.8246994024179468, 'psi': 0.6027040853671092}
[S14] START round=21 head_norm_before_train=1.710286 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9991669199882881, 'loss_val': 0.08641466579557923, 'psi': 0.9982574388252274}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989042490289769, 'loss_val': 0.07856523385289611, 'psi': 0.9977602045061897}
[S15] START round=21 head_norm_before_train=1.844477 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8752409798669488, 'auprc': 0.9902885561476432, 'loss_val': 0.1360541674572196, 'psi': 0.9212600103792266}-{'f1_val': 0.9970299290849798, 'auprc': 0.9983352080788072, 'loss_val': 0.058267671771643055, 'psi': 0.9975520406825107}
[S16] START round=21 head_norm_before_train=1.036172 cos_to_last_merge=0.9979 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8232602575499662, 'auprc': 0.862511891293812, 'loss_val': 0.6644730660530918, 'psi': 0.8389609110475045}-{'f1_val': 0.9149146672984959, 'auprc': 0.9473278128318761, 'loss_val': 0.442965121070998, 'psi': 0.927879925511848}
[S17] START round=21 head_norm_before_train=1.697341 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6359998453543632, 'auprc': 0.8188085244687047, 'loss_val': 0.8530083439482025, 'psi': 0.7091233170000998}-{'f1_val': 0.6417553614182802, 'auprc': 0.8272542957187463, 'loss_val': 0.7875410563335478, 'psi': 0.7159549351384666}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → trigger blocked (psi=0.800)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S4] not sending this round → trigger blocked (psi=0.948)
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.6794
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9431
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.9896
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.4367 head_norm=1.567964
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.130453e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.4367 head_norm=1.549661 delta_norm=0.113045
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8227 head_norm=1.436193
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.483526e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.8231 head_norm=1.442665 delta_norm=0.248353
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8233 head_norm=1.088101
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.241383e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8220 head_norm=1.282776 delta_norm=0.624138
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.539463 cos_to_last_merge=0.8362 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7171044652856778, 'auprc': 0.7823657744975216, 'loss_val': 0.7817941270300762, 'psi': 0.7432089889704154}-{'f1_val': 0.721015523472422, 'auprc': 0.7958406754486023, 'loss_val': 0.6077313491417645, 'psi': 0.7509455842628942}
[S3] START round=22 head_norm_before_train=1.491063 cos_to_last_merge=0.9997 (last merge round=20)
[S3] round=22 local utility u=1.000000 metrics={'f1_val': 0.9738110326783967, 'auprc': 0.9986595598535778, 'loss_val': 0.14112937411050258, 'psi': 0.9837504435484692}-{'f1_val': 0.7105355492465982, 'auprc': 0.9298894115004146, 'loss_val': 0.5376925744240614, 'psi': 0.7982770941481248}
[S4] START round=22 head_norm_before_train=1.116245 cos_to_last_merge=0.9986 (last merge round=20)
[S4] round=22 local utility u=0.031152 metrics={'f1_val': 0.9540855651565137, 'auprc': 0.9532564548017446, 'loss_val': 0.4075087705911957, 'psi': 0.9537539210146061}-{'f1_val': 0.956812988286874, 'auprc': 0.9343877147433015, 'loss_val': 0.42957145439454525, 'psi': 0.9478428788694451}
[S5] START round=22 head_norm_before_train=1.549661 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9812615445714612, 'loss_val': 0.2658505603978654, 'psi': 0.8126974082889327}-{'f1_val': 0.43671700517611844, 'auprc': 0.8554823454324183, 'loss_val': 0.8971885668920414, 'psi': 0.6042231412786384}
[S6] START round=22 head_norm_before_train=1.442665 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.419494 metrics={'f1_val': 0.9492445537922317, 'auprc': 0.9596402797153236, 'loss_val': 0.3503723464110794, 'psi': 0.9534028441614685}-{'f1_val': 0.8227244231004506, 'auprc': 0.9537444910514701, 'loss_val': 0.41255212241542627, 'psi': 0.8751324502808584}
[S7] START round=22 head_norm_before_train=1.190835 cos_to_last_merge=0.9960 (last merge round=20)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.626332622339476, 'auprc': 0.6884783304686566, 'loss_val': 0.6700831770543375, 'psi': 0.6511909055911482}-{'f1_val': 0.6974834074120082, 'auprc': 0.9541229441463024, 'loss_val': 0.5191336796594004, 'psi': 0.8001392221057259}
[S8] START round=22 head_norm_before_train=0.982780 cos_to_last_merge=0.9989 (last merge round=20)
[S8] round=22 local utility u=0.030053 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9984102720365594, 'loss_val': 0.25171581275275046, 'psi': 0.9954111139054513}-{'f1_val': 0.9945369636171975, 'auprc': 0.9967699979358017, 'loss_val': 0.3136521623219796, 'psi': 0.9954301773446392}
[S9] START round=22 head_norm_before_train=2.003544 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9990611421771292, 'loss_val': 0.04505216989241948, 'psi': 0.9919112595607288}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974636131032065, 'loss_val': 0.020862877346545634, 'psi': 0.9969817523296175}
[S10] START round=22 head_norm_before_train=1.639559 cos_to_last_merge=0.9972 (last merge round=19)
[S10] round=22 local utility u=0.030006 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9977917313095288, 'loss_val': 0.202326094418605, 'psi': 0.9954043914220929}-{'f1_val': 0.9931562797758523, 'auprc': 0.9977884046666377, 'loss_val': 0.2583895807889494, 'psi': 0.9950091297321665}
[S11] START round=22 head_norm_before_train=1.885228 (no previous merge yet)
[S11] round=22 local utility u=0.211789 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9988265071745801, 'loss_val': 0.052426257006358626, 'psi': 0.9974733517371068}-{'f1_val': 0.9485457214152527, 'auprc': 0.9990842212115225, 'loss_val': 0.18862488500792865, 'psi': 0.9687611213337606}
[S13] START round=22 head_norm_before_train=1.698871 cos_to_last_merge=0.9997 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.568500611571422, 'auprc': 0.6713267922934218, 'loss_val': 0.7487917782295869, 'psi': 0.6096310838602219}-{'f1_val': 0.6127354948172206, 'auprc': 0.6732288968259776, 'loss_val': 0.6764432529658316, 'psi': 0.6369328556207234}
[S14] START round=22 head_norm_before_train=1.740779 cos_to_last_merge=0.9997 (last merge round=20)
[S14] round=22 local utility u=0.008696 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9993789740783117, 'loss_val': 0.06821776338291304, 'psi': 0.9981981861920215}-{'f1_val': 0.9976511180498535, 'auprc': 0.9991669199882881, 'loss_val': 0.08641466579557923, 'psi': 0.9982574388252274}
[S15] START round=22 head_norm_before_train=1.871952 (no previous merge yet)
[S15] round=22 local utility u=0.109868 metrics={'f1_val': 0.9044635070627046, 'auprc': 0.9956468006341622, 'loss_val': 0.10772864270053918, 'psi': 0.9409368244912877}-{'f1_val': 0.8752409798669488, 'auprc': 0.9902885561476432, 'loss_val': 0.1360541674572196, 'psi': 0.9212600103792266}
[S16] START round=22 head_norm_before_train=1.282776 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.499702 metrics={'f1_val': 0.8762872648463185, 'auprc': 0.9860571064513615, 'loss_val': 0.35386685156181336, 'psi': 0.9201952014883357}-{'f1_val': 0.8232602575499662, 'auprc': 0.862511891293812, 'loss_val': 0.6644730660530918, 'psi': 0.8389609110475045}
[S17] START round=22 head_norm_before_train=1.718101 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6199697389422413, 'auprc': 0.8053146200416539, 'loss_val': 1.0476371597835754, 'psi': 0.6941076913820063}-{'f1_val': 0.6359998453543632, 'auprc': 0.8188085244687047, 'loss_val': 0.8530083439482025, 'psi': 0.7091233170000998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:50311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.984)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=0.9882
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.8146
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.4977
[S7] RECEIVED delta(kind=head bytes=1807) from S15
[S7] cosine check vs S15: cos=0.5709
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.5794
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.0362
[S4] RECEIVED delta(kind=head bytes=1791) from S16
[S4] cosine check vs S16: cos=0.8595
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.7526
[S10] RECEIVED delta(kind=head bytes=1804) from S11
[S10] cosine check vs S11: cos=0.9605
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9738 head_norm=1.527464
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.769604e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9733 head_norm=1.341271 delta_norm=0.776960
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6263 head_norm=1.231298
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.819572e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6336 head_norm=1.041980 delta_norm=0.381957
[S7] aggregate: ACCEPT kept=['S15', 'S6', 'S10'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5685 head_norm=1.717213
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.370455e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5681 head_norm=1.739524 delta_norm=0.137046
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8763 head_norm=1.315326
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.514371e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8532 head_norm=1.040339 delta_norm=0.551437
[S16] aggregate: ROLLBACK (f1_val pre=0.876 post=0.853 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9938 head_norm=1.666945
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.774622e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9938 head_norm=1.768708 delta_norm=0.277462
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9934 head_norm=1.021123
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.394542e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9937 head_norm=1.040832 delta_norm=0.339454
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9541 head_norm=1.163799
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.365773e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9441 head_norm=1.195396 delta_norm=0.336577
[S4] aggregate: ROLLBACK (f1_val pre=0.954 post=0.944 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.547016 cos_to_last_merge=0.8348 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.835
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.672219431414978, 'auprc': 0.7514095883096161, 'loss_val': 0.5056538513671534, 'psi': 0.7038954941728333}-{'f1_val': 0.7171044652856778, 'auprc': 0.7823657744975216, 'loss_val': 0.7817941270300762, 'psi': 0.7432089889704154}
[S3] START round=23 head_norm_before_train=1.341271 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9777049492998364, 'auprc': 0.9967064693117773, 'loss_val': 0.27497649076810854, 'psi': 0.9853055573046128}-{'f1_val': 0.9738110326783967, 'auprc': 0.9986595598535778, 'loss_val': 0.14112937411050258, 'psi': 0.9837504435484692}
[S4] START round=23 head_norm_before_train=1.195396 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9562654546316057, 'auprc': 0.9382875239252749, 'loss_val': 0.3956882245813245, 'psi': 0.9490742823490734}-{'f1_val': 0.9540855651565137, 'auprc': 0.9532564548017446, 'loss_val': 0.4075087705911957, 'psi': 0.9537539210146061}
[S5] START round=23 head_norm_before_train=1.572325 cos_to_last_merge=0.9998 (last merge round=21)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6816794408282134, 'auprc': 0.9394882724636774, 'loss_val': 0.3474677343943702, 'psi': 0.784802973482399}-{'f1_val': 0.7003213174339138, 'auprc': 0.9812615445714612, 'loss_val': 0.2658505603978654, 'psi': 0.8126974082889327}
[S6] START round=23 head_norm_before_train=1.472290 cos_to_last_merge=0.9991 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8014076346161488, 'auprc': 0.9343593341497156, 'loss_val': 0.46319947651340443, 'psi': 0.8545883144295756}-{'f1_val': 0.9492445537922317, 'auprc': 0.9596402797153236, 'loss_val': 0.3503723464110794, 'psi': 0.9534028441614685}
[S7] START round=23 head_norm_before_train=1.041980 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5415118393361222, 'auprc': 0.7830338658546564, 'loss_val': 0.8927293220285807, 'psi': 0.6381206499435359}-{'f1_val': 0.626332622339476, 'auprc': 0.6884783304686566, 'loss_val': 0.6700831770543375, 'psi': 0.6511909055911482}
[S8] START round=23 head_norm_before_train=1.040832 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.001392 metrics={'f1_val': 0.9958331535970073, 'auprc': 0.9955096310088072, 'loss_val': 0.25475792210886206, 'psi': 0.9957037445617272}-{'f1_val': 0.9934116751513793, 'auprc': 0.9984102720365594, 'loss_val': 0.25171581275275046, 'psi': 0.9954111139054513}
[S9] START round=23 head_norm_before_train=2.016094 (no previous merge yet)
[S9] round=23 local utility u=0.039721 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.999594957552041, 'loss_val': 0.019504069422508454, 'psi': 0.9973540655466097}-{'f1_val': 0.9871446711497952, 'auprc': 0.9990611421771292, 'loss_val': 0.04505216989241948, 'psi': 0.9919112595607288}
[S10] START round=23 head_norm_before_train=1.768708 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9950444545353663, 'auprc': 0.9979590548466821, 'loss_val': 0.21926971189494698, 'psi': 0.9962102946598926}-{'f1_val': 0.9938128314971357, 'auprc': 0.9977917313095288, 'loss_val': 0.202326094418605, 'psi': 0.9954043914220929}
[S11] START round=23 head_norm_before_train=1.905760 (no previous merge yet)
[S11] round=23 local utility u=0.001599 metrics={'f1_val': 0.9968129605654896, 'auprc': 0.9990949309662178, 'loss_val': 0.05148404439710579, 'psi': 0.9977257487257809}-{'f1_val': 0.9965712481121245, 'auprc': 0.9988265071745801, 'loss_val': 0.052426257006358626, 'psi': 0.9974733517371068}
[S13] START round=23 head_norm_before_train=1.739524 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.113692 metrics={'f1_val': 0.6013639343237946, 'auprc': 0.6828863844309317, 'loss_val': 0.7532659542536068, 'psi': 0.6339729143666495}-{'f1_val': 0.568500611571422, 'auprc': 0.6713267922934218, 'loss_val': 0.7487917782295869, 'psi': 0.6096310838602219}
[S14] START round=23 head_norm_before_train=1.772183 cos_to_last_merge=0.9989 (last merge round=20)
[S14] round=23 local utility u=0.003003 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988795754471261, 'loss_val': 0.05823238974891623, 'psi': 0.9977503350734496}-{'f1_val': 0.9974109942678281, 'auprc': 0.9993789740783117, 'loss_val': 0.06821776338291304, 'psi': 0.9981981861920215}
[S15] START round=23 head_norm_before_train=1.897741 (no previous merge yet)
[S15] round=23 local utility u=0.093780 metrics={'f1_val': 0.9291799682431986, 'auprc': 0.9983211441089969, 'loss_val': 0.07649022161330737, 'psi': 0.9568364385895178}-{'f1_val': 0.9044635070627046, 'auprc': 0.9956468006341622, 'loss_val': 0.10772864270053918, 'psi': 0.9409368244912877}
[S16] START round=23 head_norm_before_train=1.040339 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8560799616894246, 'auprc': 0.990675305840619, 'loss_val': 0.547536975217204, 'psi': 0.9099180993499023}-{'f1_val': 0.8762872648463185, 'auprc': 0.9860571064513615, 'loss_val': 0.35386685156181336, 'psi': 0.9201952014883357}
[S17] START round=23 head_norm_before_train=1.737674 (no previous merge yet)
[S17] round=23 local utility u=0.143127 metrics={'f1_val': 0.6401242085323813, 'auprc': 0.8186624184760325, 'loss_val': 0.9223526787029876, 'psi': 0.7115394925098417}-{'f1_val': 0.6199697389422413, 'auprc': 0.8053146200416539, 'loss_val': 1.0476371597835754, 'psi': 0.6941076913820063}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → trigger blocked (psi=0.957)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:50316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=0.7447
[S3] RECEIVED delta(kind=head bytes=1792) from S9
[S3] cosine check vs S9: cos=0.6091
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9886
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9777 head_norm=1.374268
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.078557e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9701 head_norm=1.533498 delta_norm=0.807856
[S3] aggregate: ROLLBACK (f1_val pre=0.978 post=0.970 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9970 head_norm=1.802166
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.365775e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.773001 delta_norm=0.136578
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8561 head_norm=1.074140
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.983527e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8469 head_norm=1.328345 delta_norm=0.598353
[S16] aggregate: ROLLBACK (f1_val pre=0.856 post=0.847 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.551417 cos_to_last_merge=0.8335 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=24 local utility u=0.266199 metrics={'f1_val': 0.6993830860490222, 'auprc': 0.8309741121777725, 'loss_val': 0.37493042400749, 'psi': 0.7520194965005222}-{'f1_val': 0.672219431414978, 'auprc': 0.7514095883096161, 'loss_val': 0.5056538513671534, 'psi': 0.7038954941728333}
[S3] START round=24 head_norm_before_train=1.533498 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.8438555162778041, 'auprc': 0.9798808400020547, 'loss_val': 0.3198641406608633, 'psi': 0.8982656457675043}-{'f1_val': 0.9777049492998364, 'auprc': 0.9967064693117773, 'loss_val': 0.27497649076810854, 'psi': 0.9853055573046128}
[S4] START round=24 head_norm_before_train=1.236024 cos_to_last_merge=0.9987 (last merge round=22)
[S4] round=24 local utility u=0.015782 metrics={'f1_val': 0.9489523417551681, 'auprc': 0.9582379868193706, 'loss_val': 0.38009737754609807, 'psi': 0.952666599780849}-{'f1_val': 0.9562654546316057, 'auprc': 0.9382875239252749, 'loss_val': 0.3956882245813245, 'psi': 0.9490742823490734}
[S5] START round=24 head_norm_before_train=1.597774 cos_to_last_merge=0.9989 (last merge round=21)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6643495014770903, 'auprc': 0.8791460328675275, 'loss_val': 0.3984308740686013, 'psi': 0.7502681140332652}-{'f1_val': 0.6816794408282134, 'auprc': 0.9394882724636774, 'loss_val': 0.3474677343943702, 'psi': 0.784802973482399}
[S6] START round=24 head_norm_before_train=1.503816 cos_to_last_merge=0.9966 (last merge round=21)
[S6] round=24 local utility u=0.172452 metrics={'f1_val': 0.8420969379171216, 'auprc': 0.9421581587542917, 'loss_val': 0.3858269052553062, 'psi': 0.8821214262519896}-{'f1_val': 0.8014076346161488, 'auprc': 0.9343593341497156, 'loss_val': 0.46319947651340443, 'psi': 0.8545883144295756}
[S7] START round=24 head_norm_before_train=1.085798 cos_to_last_merge=0.9965 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.39206521534464506, 'auprc': 0.7794572179906254, 'loss_val': 1.1672593130507654, 'psi': 0.5470220164030373}-{'f1_val': 0.5415118393361222, 'auprc': 0.7830338658546564, 'loss_val': 0.8927293220285807, 'psi': 0.6381206499435359}
[S8] START round=24 head_norm_before_train=1.071630 cos_to_last_merge=0.9991 (last merge round=22)
[S8] round=24 local utility u=0.015303 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.998219237679952, 'loss_val': 0.21290248950642682, 'psi': 0.9948498173505245}-{'f1_val': 0.9958331535970073, 'auprc': 0.9955096310088072, 'loss_val': 0.25475792210886206, 'psi': 0.9957037445617272}
[S9] START round=24 head_norm_before_train=2.029749 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9996073271690535, 'loss_val': 0.024679260745937626, 'psi': 0.9959558860582667}-{'f1_val': 0.9958601375429889, 'auprc': 0.999594957552041, 'loss_val': 0.019504069422508454, 'psi': 0.9973540655466097}
[S10] START round=24 head_norm_before_train=1.795545 cos_to_last_merge=0.9994 (last merge round=22)
[S10] round=24 local utility u=0.025886 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9978593964408627, 'loss_val': 0.1714056332032799, 'psi': 0.9965910950233914}-{'f1_val': 0.9950444545353663, 'auprc': 0.9979590548466821, 'loss_val': 0.21926971189494698, 'psi': 0.9962102946598926}
[S11] START round=24 head_norm_before_train=1.926385 (no previous merge yet)
[S11] round=24 local utility u=0.004248 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989520791229619, 'loss_val': 0.0386073519189199, 'psi': 0.997273316495632}-{'f1_val': 0.9968129605654896, 'auprc': 0.9990949309662178, 'loss_val': 0.05148404439710579, 'psi': 0.9977257487257809}
[S13] START round=24 head_norm_before_train=1.758203 cos_to_last_merge=0.9998 (last merge round=22)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5552180089346124, 'auprc': 0.6841787509928526, 'loss_val': 0.7896758454658432, 'psi': 0.6068023057579084}-{'f1_val': 0.6013639343237946, 'auprc': 0.6828863844309317, 'loss_val': 0.7532659542536068, 'psi': 0.6339729143666495}
[S14] START round=24 head_norm_before_train=1.773001 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9967583909151598, 'loss_val': 0.0663005182504761, 'psi': 0.9971483180670992}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988795754471261, 'loss_val': 0.05823238974891623, 'psi': 0.9977503350734496}
[S15] START round=24 head_norm_before_train=1.921346 (no previous merge yet)
[S15] round=24 local utility u=0.135154 metrics={'f1_val': 0.9805254407189989, 'auprc': 0.9902524166374287, 'loss_val': 0.09004921540010817, 'psi': 0.9844162310863709}-{'f1_val': 0.9291799682431986, 'auprc': 0.9983211441089969, 'loss_val': 0.07649022161330737, 'psi': 0.9568364385895178}
[S16] START round=24 head_norm_before_train=1.328345 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.382392 metrics={'f1_val': 0.9421761783324486, 'auprc': 0.9886035358399994, 'loss_val': 0.2931140897545888, 'psi': 0.9607471213354689}-{'f1_val': 0.8560799616894246, 'auprc': 0.990675305840619, 'loss_val': 0.547536975217204, 'psi': 0.9099180993499023}
[S17] START round=24 head_norm_before_train=1.754015 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6344935209274863, 'auprc': 0.8196473985890487, 'loss_val': 0.9922966743888156, 'psi': 0.7085550719921112}-{'f1_val': 0.6401242085323813, 'auprc': 0.8186624184760325, 'loss_val': 0.9223526787029876, 'psi': 0.7115394925098417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:50311
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8850
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9907
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.2672
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=0.5050
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.7122
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.7454
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9220
[S10] RECEIVED delta(kind=head bytes=1805) from S11
[S10] cosine check vs S11: cos=0.9810
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.3921 head_norm=1.131701
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.722529e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.3939 head_norm=1.046584 delta_norm=0.272253
[S7] aggregate: ACCEPT kept=['S6', 'S15', 'S10'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.6643 head_norm=1.620861
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.125197e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.6688 head_norm=1.586674 delta_norm=0.112520
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9957 head_norm=1.824615
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.942291e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9957 head_norm=1.877947 delta_norm=0.194229
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9422 head_norm=1.364448
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.834235e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9585 head_norm=1.143079 delta_norm=0.483424
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9926 head_norm=1.104055
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.986587e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9930 head_norm=1.158184 delta_norm=0.298659
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9490 head_norm=1.281497
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.643463e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9428 head_norm=1.296957 delta_norm=0.264346
[S4] aggregate: ROLLBACK (f1_val pre=0.949 post=0.943 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.559872 cos_to_last_merge=0.8326 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.5245938950282261, 'auprc': 0.783209404252011, 'loss_val': 0.5332938149621513, 'psi': 0.62804009871774}-{'f1_val': 0.6993830860490222, 'auprc': 0.8309741121777725, 'loss_val': 0.37493042400749, 'psi': 0.7520194965005222}
[S3] START round=25 head_norm_before_train=1.582549 cos_to_last_merge=0.9989 (last merge round=23)
[S3] round=25 local utility u=0.353582 metrics={'f1_val': 0.9348596083874166, 'auprc': 0.9828606159047764, 'loss_val': 0.16766349365451713, 'psi': 0.9540600113943605}-{'f1_val': 0.8438555162778041, 'auprc': 0.9798808400020547, 'loss_val': 0.3198641406608633, 'psi': 0.8982656457675043}
[S4] START round=25 head_norm_before_train=1.296957 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000953 metrics={'f1_val': 0.9525167928472781, 'auprc': 0.9521707479796357, 'loss_val': 0.3813755664457757, 'psi': 0.9523783749002213}-{'f1_val': 0.9489523417551681, 'auprc': 0.9582379868193706, 'loss_val': 0.38009737754609807, 'psi': 0.952666599780849}
[S5] START round=25 head_norm_before_train=1.586674 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.371845 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9954728004622477, 'loss_val': 0.22103971461953006, 'psi': 0.8185306132910574}-{'f1_val': 0.6643495014770903, 'auprc': 0.8791460328675275, 'loss_val': 0.3984308740686013, 'psi': 0.7502681140332652}
[S6] START round=25 head_norm_before_train=1.537779 cos_to_last_merge=0.9931 (last merge round=21)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.550042403848989, 'auprc': 0.7759356456537008, 'loss_val': 0.771124674893841, 'psi': 0.6403997005708737}-{'f1_val': 0.8420969379171216, 'auprc': 0.9421581587542917, 'loss_val': 0.3858269052553062, 'psi': 0.8821214262519896}
[S7] START round=25 head_norm_before_train=1.046584 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.263723 metrics={'f1_val': 0.4465409862979976, 'auprc': 0.7836753848467165, 'loss_val': 0.9793225838206576, 'psi': 0.5813947457174852}-{'f1_val': 0.39206521534464506, 'auprc': 0.7794572179906254, 'loss_val': 1.1672593130507654, 'psi': 0.5470220164030373}
[S8] START round=25 head_norm_before_train=1.158184 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9894442539233279, 'auprc': 0.995178708456678, 'loss_val': 0.2594707265348133, 'psi': 0.9917380357366679}-{'f1_val': 0.9926035371309061, 'auprc': 0.998219237679952, 'loss_val': 0.21290248950642682, 'psi': 0.9948498173505245}
[S9] START round=25 head_norm_before_train=2.043141 (no previous merge yet)
[S9] round=25 local utility u=0.009527 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966827464245378, 'loss_val': 0.018339304420773462, 'psi': 0.9969348460771008}-{'f1_val': 0.9935215919844088, 'auprc': 0.9996073271690535, 'loss_val': 0.024679260745937626, 'psi': 0.9959558860582667}
[S10] START round=25 head_norm_before_train=1.877947 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9970169441005807, 'loss_val': 0.17541573841406818, 'psi': 0.9962541140872786}-{'f1_val': 0.9957455607450773, 'auprc': 0.9978593964408627, 'loss_val': 0.1714056332032799, 'psi': 0.9965910950233914}
[S11] START round=25 head_norm_before_train=1.949256 (no previous merge yet)
[S11] round=25 local utility u=0.002513 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9988487144022716, 'loss_val': 0.03577414222793915, 'psi': 0.9974822346281834}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989520791229619, 'loss_val': 0.0386073519189199, 'psi': 0.997273316495632}
[S13] START round=25 head_norm_before_train=1.774848 cos_to_last_merge=0.9993 (last merge round=22)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.549579855550879, 'auprc': 0.6835632404484094, 'loss_val': 0.8298206474176176, 'psi': 0.6031732095098912}-{'f1_val': 0.5552180089346124, 'auprc': 0.6841787509928526, 'loss_val': 0.7896758454658432, 'psi': 0.6068023057579084}
[S14] START round=25 head_norm_before_train=1.799946 cos_to_last_merge=0.9998 (last merge round=23)
[S14] round=25 local utility u=0.008204 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9994267673750119, 'loss_val': 0.057898616895074057, 'psi': 0.9982156686510402}-{'f1_val': 0.9974082695017256, 'auprc': 0.9967583909151598, 'loss_val': 0.0663005182504761, 'psi': 0.9971483180670992}
[S15] START round=25 head_norm_before_train=1.942471 (no previous merge yet)
[S15] round=25 local utility u=0.091328 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9982553238454418, 'loss_val': 0.030429308525446286, 'psi': 0.9975200869891645}-{'f1_val': 0.9805254407189989, 'auprc': 0.9902524166374287, 'loss_val': 0.09004921540010817, 'psi': 0.9844162310863709}
[S16] START round=25 head_norm_before_train=1.143079 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.002345 metrics={'f1_val': 0.939274878103361, 'auprc': 0.9928116237803923, 'loss_val': 0.28363998127922824, 'psi': 0.9606895763741735}-{'f1_val': 0.9421761783324486, 'auprc': 0.9886035358399994, 'loss_val': 0.2931140897545888, 'psi': 0.9607471213354689}
[S17] START round=25 head_norm_before_train=1.774828 (no previous merge yet)
[S17] round=25 local utility u=0.148918 metrics={'f1_val': 0.6451896368218519, 'auprc': 0.8340124898803346, 'loss_val': 0.8017324298298079, 'psi': 0.7207187780452451}-{'f1_val': 0.6344935209274863, 'auprc': 0.8196473985890487, 'loss_val': 0.9922966743888156, 'psi': 0.7085550719921112}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[S15] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:50307
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.961)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=0.9898
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=0.9567
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=0.9283
[S3] RECEIVED delta(kind=head bytes=1807) from S5
[S3] cosine check vs S5: cos=0.4705
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] cosine check vs S7: cos=0.2805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9932
[S2] ⇄ pheromone p=0.171 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.053 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.152 → S7@127.0.0.1:50308
[S11] ⇄ pheromone p=0.057 → S10@127.0.0.1:50311
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5496 head_norm=1.791954
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.304951e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5547 head_norm=1.803914 delta_norm=0.130495
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.064 → S16@127.0.0.1:50316
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.5500 head_norm=1.570562
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.361895e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.5455 head_norm=1.578615 delta_norm=0.236190
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.220 → S7@127.0.0.1:50308
[S4] ⇄ pheromone p=0.070 → S8@127.0.0.1:50309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9894 head_norm=1.193129
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.816778e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9929 head_norm=0.907875 delta_norm=0.681678
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.091 → S16@127.0.0.1:50316
[S5] ⇄ pheromone p=0.218 → S3@127.0.0.1:50303
[S7] ⇄ pheromone p=0.214 → S8@127.0.0.1:50309
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9349 head_norm=1.621405
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.445646e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9306 head_norm=1.489212 delta_norm=0.244565
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.300 → S6@127.0.0.1:50307
[S9] ⇄ pheromone p=0.022 → S3@127.0.0.1:50303
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.825150
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.067266e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9974 head_norm=1.806940 delta_norm=0.106727
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S13@127.0.0.1:50313
[S16] ⇄ pheromone p=0.184 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.110 → S14@127.0.0.1:50314
[S2] START round=26 head_norm_before_train=1.571618 cos_to_last_merge=0.8311 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=26 local utility u=0.460296 metrics={'f1_val': 0.721466731965142, 'auprc': 0.770293342326274, 'loss_val': 0.7551914759858919, 'psi': 0.7409973761095948}-{'f1_val': 0.5245938950282261, 'auprc': 0.783209404252011, 'loss_val': 0.5332938149621513, 'psi': 0.62804009871774}
[S3] START round=26 head_norm_before_train=1.489212 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8193718427801233, 'auprc': 0.9636941516670893, 'loss_val': 0.3465570512475292, 'psi': 0.8771007663349097}-{'f1_val': 0.9348596083874166, 'auprc': 0.9828606159047764, 'loss_val': 0.16766349365451713, 'psi': 0.9540600113943605}
[S4] START round=26 head_norm_before_train=1.335634 cos_to_last_merge=0.9986 (last merge round=24)
[S4] round=26 local utility u=0.030361 metrics={'f1_val': 0.952741187352977, 'auprc': 0.9574923275774896, 'loss_val': 0.3379653747312494, 'psi': 0.954641643442782}-{'f1_val': 0.9525167928472781, 'auprc': 0.9521707479796357, 'loss_val': 0.3813755664457757, 'psi': 0.9523783749002213}
[S5] START round=26 head_norm_before_train=1.601944 cos_to_last_merge=0.9998 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9703145371459901, 'loss_val': 0.2782833653550415, 'psi': 0.8083181739532115}-{'f1_val': 0.7005691551769304, 'auprc': 0.9954728004622477, 'loss_val': 0.22103971461953006, 'psi': 0.8185306132910574}
[S6] START round=26 head_norm_before_train=1.578615 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9858867943106657, 'auprc': 0.9938174979548622, 'loss_val': 0.1637827301043693, 'psi': 0.9890590757683443}-{'f1_val': 0.550042403848989, 'auprc': 0.7759356456537008, 'loss_val': 0.771124674893841, 'psi': 0.6403997005708737}
[S7] START round=26 head_norm_before_train=1.074377 cos_to_last_merge=0.9987 (last merge round=24)
[S7] round=26 local utility u=0.115756 metrics={'f1_val': 0.4777090114971484, 'auprc': 0.7856222653745375, 'loss_val': 0.940659887660327, 'psi': 0.600874313048104}-{'f1_val': 0.4465409862979976, 'auprc': 0.7836753848467165, 'loss_val': 0.9793225838206576, 'psi': 0.5813947457174852}
[S8] START round=26 head_norm_before_train=0.907875 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9969439557766947, 'loss_val': 0.34488045828278535, 'psi': 0.9956531676030544}-{'f1_val': 0.9894442539233279, 'auprc': 0.995178708456678, 'loss_val': 0.2594707265348133, 'psi': 0.9917380357366679}
[S9] START round=26 head_norm_before_train=2.055535 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9996093954306915, 'loss_val': 0.02588235393466746, 'psi': 0.9954544432611954}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966827464245378, 'loss_val': 0.018339304420773462, 'psi': 0.9969348460771008}
[S10] START round=26 head_norm_before_train=1.903370 cos_to_last_merge=0.9995 (last merge round=24)
[S10] round=26 local utility u=0.030119 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9970971988919138, 'loss_val': 0.11541862755787628, 'psi': 0.9962862160038118}-{'f1_val': 0.9957455607450773, 'auprc': 0.9970169441005807, 'loss_val': 0.17541573841406818, 'psi': 0.9962541140872786}
[S11] START round=26 head_norm_before_train=1.970370 (no previous merge yet)
[S11] round=26 local utility u=0.001007 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9987888048094411, 'loss_val': 0.03358084377433908, 'psi': 0.9974582707910512}-{'f1_val': 0.9965712481121245, 'auprc': 0.9988487144022716, 'loss_val': 0.03577414222793915, 'psi': 0.9974822346281834}
[S13] START round=26 head_norm_before_train=1.803914 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.052290 metrics={'f1_val': 0.5632043717643513, 'auprc': 0.6870213563375549, 'loss_val': 0.8173611211307639, 'psi': 0.6127311655936327}-{'f1_val': 0.549579855550879, 'auprc': 0.6835632404484094, 'loss_val': 0.8298206474176176, 'psi': 0.6031732095098912}
[S14] START round=26 head_norm_before_train=1.806940 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000271 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.999515638541645, 'loss_val': 0.05762250365550722, 'psi': 0.9982512171176934}-{'f1_val': 0.9974082695017256, 'auprc': 0.9994267673750119, 'loss_val': 0.057898616895074057, 'psi': 0.9982156686510402}
[S15] START round=26 head_norm_before_train=1.962932 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9978217205135402, 'loss_val': 0.057239497034884845, 'psi': 0.9800650074130814}-{'f1_val': 0.9970299290849798, 'auprc': 0.9982553238454418, 'loss_val': 0.030429308525446286, 'psi': 0.9975200869891645}
[S16] START round=26 head_norm_before_train=1.188715 cos_to_last_merge=0.9987 (last merge round=24)
[S16] round=26 local utility u=0.003022 metrics={'f1_val': 0.9386116919485143, 'auprc': 0.9888254740229553, 'loss_val': 0.26165850968069404, 'psi': 0.9586972047782907}-{'f1_val': 0.939274878103361, 'auprc': 0.9928116237803923, 'loss_val': 0.28363998127922824, 'psi': 0.9606895763741735}
[S17] START round=26 head_norm_before_train=1.794901 (no previous merge yet)
[S17] round=26 local utility u=0.117113 metrics={'f1_val': 0.6477694994307052, 'auprc': 0.8491433645857929, 'loss_val': 0.6283782017170841, 'psi': 0.7283190454927402}-{'f1_val': 0.6451896368218519, 'auprc': 0.8340124898803346, 'loss_val': 0.8017324298298079, 'psi': 0.7207187780452451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.601)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.7285
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9877
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.7437
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.7851
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.4177
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.9761
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.9944
[S17] not sending this round → trigger blocked (psi=0.728)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9948 head_norm=0.948871
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.722847e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9949 head_norm=1.083818 delta_norm=0.472285
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4777 head_norm=1.103509
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.264447e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4725 head_norm=1.159764 delta_norm=0.426445
[S7] aggregate: ROLLBACK (f1_val pre=0.478 post=0.472 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.621711
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.706623e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.599693 delta_norm=0.087066
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9957 head_norm=1.937347
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.563660e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9957 head_norm=1.957757 delta_norm=0.156366
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9527 head_norm=1.376616
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.594691e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9527 head_norm=1.296829 delta_norm=0.159469
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9386 head_norm=1.232607
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.723199e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9363 head_norm=1.445540 delta_norm=0.572320
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.582165 cos_to_last_merge=0.8299 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.72222787273357, 'auprc': 0.7776681110683286, 'loss_val': 0.7922903674155871, 'psi': 0.7444039680674734}-{'f1_val': 0.721466731965142, 'auprc': 0.770293342326274, 'loss_val': 0.7551914759858919, 'psi': 0.7409973761095948}
[S3] START round=27 head_norm_before_train=1.540805 cos_to_last_merge=0.9990 (last merge round=25)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7234935717946548, 'auprc': 0.9264464891767334, 'loss_val': 0.5371497489464195, 'psi': 0.8046747387474862}-{'f1_val': 0.8193718427801233, 'auprc': 0.9636941516670893, 'loss_val': 0.3465570512475292, 'psi': 0.8771007663349097}
[S4] START round=27 head_norm_before_train=1.296829 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9513838738097666, 'auprc': 0.9550391299813454, 'loss_val': 0.34154497477798323, 'psi': 0.9528459762783982}-{'f1_val': 0.952741187352977, 'auprc': 0.9574923275774896, 'loss_val': 0.3379653747312494, 'psi': 0.954641643442782}
[S5] START round=27 head_norm_before_train=1.599693 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6672120212880438, 'auprc': 0.9413981163969402, 'loss_val': 0.3501441963089769, 'psi': 0.7768864593316024}-{'f1_val': 0.700320598491359, 'auprc': 0.9703145371459901, 'loss_val': 0.2782833653550415, 'psi': 0.8083181739532115}
[S6] START round=27 head_norm_before_train=1.597952 cos_to_last_merge=0.9998 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.9850836817677792, 'auprc': 0.9920662406297388, 'loss_val': 0.17191007217954277, 'psi': 0.987876705312563}-{'f1_val': 0.9858867943106657, 'auprc': 0.9938174979548622, 'loss_val': 0.1637827301043693, 'psi': 0.9890590757683443}
[S7] START round=27 head_norm_before_train=1.159764 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.299220 metrics={'f1_val': 0.5519334495974301, 'auprc': 0.8003975826348837, 'loss_val': 0.8318917941281339, 'psi': 0.6513191028124115}-{'f1_val': 0.4777090114971484, 'auprc': 0.7856222653745375, 'loss_val': 0.940659887660327, 'psi': 0.600874313048104}
[S8] START round=27 head_norm_before_train=1.083818 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.029424 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9926609779912312, 'loss_val': 0.27058207634425574, 'psi': 0.9936798075558084}-{'f1_val': 0.994792642153961, 'auprc': 0.9969439557766947, 'loss_val': 0.34488045828278535, 'psi': 0.9956531676030544}
[S9] START round=27 head_norm_before_train=2.061964 (no previous merge yet)
[S9] round=27 local utility u=0.005101 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9996091303856359, 'loss_val': 0.023208784214223878, 'psi': 0.9962072797526627}-{'f1_val': 0.992684475148198, 'auprc': 0.9996093954306915, 'loss_val': 0.02588235393466746, 'psi': 0.9954544432611954}
[S10] START round=27 head_norm_before_train=1.957757 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9968285252259502, 'loss_val': 0.11591025163614142, 'psi': 0.9962958606966921}-{'f1_val': 0.9957455607450773, 'auprc': 0.9970971988919138, 'loss_val': 0.11541862755787628, 'psi': 0.9962862160038118}
[S11] START round=27 head_norm_before_train=1.990280 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9965718709689133, 'auprc': 0.9990247828828996, 'loss_val': 0.035716298205071155, 'psi': 0.9975530357345078}-{'f1_val': 0.9965712481121245, 'auprc': 0.9987888048094411, 'loss_val': 0.03358084377433908, 'psi': 0.9974582707910512}
[S13] START round=27 head_norm_before_train=1.820701 cos_to_last_merge=0.9999 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5491557381516158, 'auprc': 0.67659731006579, 'loss_val': 0.8315236740138074, 'psi': 0.6001323669172854}-{'f1_val': 0.5632043717643513, 'auprc': 0.6870213563375549, 'loss_val': 0.8173611211307639, 'psi': 0.6127311655936327}
[S14] START round=27 head_norm_before_train=1.833328 cos_to_last_merge=0.9998 (last merge round=25)
[S14] round=27 local utility u=0.000257 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9972951026718581, 'loss_val': 0.05044767515144376, 'psi': 0.9973630027697786}-{'f1_val': 0.9974082695017256, 'auprc': 0.999515638541645, 'loss_val': 0.05762250365550722, 'psi': 0.9982512171176934}
[S15] START round=27 head_norm_before_train=1.981775 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8313815774422667, 'auprc': 0.9948700961696924, 'loss_val': 0.2072936314654908, 'psi': 0.896776984933237}-{'f1_val': 0.9682271986794423, 'auprc': 0.9978217205135402, 'loss_val': 0.057239497034884845, 'psi': 0.9800650074130814}
[S16] START round=27 head_norm_before_train=1.445540 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.211702 metrics={'f1_val': 0.9909428537822442, 'auprc': 0.9895737353274506, 'loss_val': 0.1544860388237578, 'psi': 0.9903952064003267}-{'f1_val': 0.9386116919485143, 'auprc': 0.9888254740229553, 'loss_val': 0.26165850968069404, 'psi': 0.9586972047782907}
[S17] START round=27 head_norm_before_train=1.811011 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6370021605171767, 'auprc': 0.8242375436748388, 'loss_val': 0.9563676838165104, 'psi': 0.7118963137802417}-{'f1_val': 0.6477694994307052, 'auprc': 0.8491433645857929, 'loss_val': 0.6283782017170841, 'psi': 0.7283190454927402}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S16] not sending this round → trigger blocked (psi=0.990)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.8834
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.8671
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.9931
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.3994
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5492 head_norm=1.835674
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.088813e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5510 head_norm=1.844253 delta_norm=0.108881
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.7235 head_norm=1.590654
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.991142e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.7175 head_norm=1.776770 delta_norm=0.499114
[S3] aggregate: ROLLBACK (f1_val pre=0.723 post=0.717 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9909 head_norm=1.480230
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.767856e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9914 head_norm=1.261066 delta_norm=0.376786
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9944 head_norm=1.128463
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.369015e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9944 head_norm=0.971477 delta_norm=0.636901
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.591343 cos_to_last_merge=0.8288 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=28 local utility u=0.648367 metrics={'f1_val': 0.8361533504393528, 'auprc': 0.856542596487835, 'loss_val': 0.41573330716883705, 'psi': 0.8443090488587457}-{'f1_val': 0.72222787273357, 'auprc': 0.7776681110683286, 'loss_val': 0.7922903674155871, 'psi': 0.7444039680674734}
[S3] START round=28 head_norm_before_train=1.776770 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.751556 metrics={'f1_val': 0.9027541648544617, 'auprc': 0.9689860135243293, 'loss_val': 0.23721993369204286, 'psi': 0.9292469043224088}-{'f1_val': 0.7234935717946548, 'auprc': 0.9264464891767334, 'loss_val': 0.5371497489464195, 'psi': 0.8046747387474862}
[S4] START round=28 head_norm_before_train=1.338167 cos_to_last_merge=0.9991 (last merge round=26)
[S4] round=28 local utility u=0.015456 metrics={'f1_val': 0.9544529271175901, 'auprc': 0.9491141398883723, 'loss_val': 0.31127240081470525, 'psi': 0.9523174122259029}-{'f1_val': 0.9513838738097666, 'auprc': 0.9550391299813454, 'loss_val': 0.34154497477798323, 'psi': 0.9528459762783982}
[S5] START round=28 head_norm_before_train=1.617178 cos_to_last_merge=0.9998 (last merge round=26)
[S5] round=28 local utility u=0.003943 metrics={'f1_val': 0.6995492496660676, 'auprc': 0.8794884692696749, 'loss_val': 0.3505534731374843, 'psi': 0.7715249375075106}-{'f1_val': 0.6672120212880438, 'auprc': 0.9413981163969402, 'loss_val': 0.3501441963089769, 'psi': 0.7768864593316024}
[S6] START round=28 head_norm_before_train=1.613930 cos_to_last_merge=0.9994 (last merge round=25)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.5977087786725374, 'auprc': 0.8054543979698814, 'loss_val': 0.6432108295579207, 'psi': 0.680807026391475}-{'f1_val': 0.9850836817677792, 'auprc': 0.9920662406297388, 'loss_val': 0.17191007217954277, 'psi': 0.987876705312563}
[S7] START round=28 head_norm_before_train=1.193898 cos_to_last_merge=0.9978 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5335627801614219, 'auprc': 0.7921556610198833, 'loss_val': 0.8505195019534506, 'psi': 0.6369999325048065}-{'f1_val': 0.5519334495974301, 'auprc': 0.8003975826348837, 'loss_val': 0.8318917941281339, 'psi': 0.6513191028124115}
[S8] START round=28 head_norm_before_train=0.971477 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9927977503972633, 'loss_val': 0.37580452324158525, 'psi': 0.9937345165182212}-{'f1_val': 0.9943590272655265, 'auprc': 0.9926609779912312, 'loss_val': 0.27058207634425574, 'psi': 0.9936798075558084}
[S9] START round=28 head_norm_before_train=2.069269 (no previous merge yet)
[S9] round=28 local utility u=0.007030 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9995993481714363, 'loss_val': 0.01914251347791626, 'psi': 0.9972056255424364}-{'f1_val': 0.9939393793306803, 'auprc': 0.9996091303856359, 'loss_val': 0.023208784214223878, 'psi': 0.9962072797526627}
[S10] START round=28 head_norm_before_train=1.986806 cos_to_last_merge=0.9995 (last merge round=26)
[S10] round=28 local utility u=0.010770 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9962297037347698, 'loss_val': 0.0914032732263478, 'psi': 0.9959392179409543}-{'f1_val': 0.9959407510105199, 'auprc': 0.9968285252259502, 'loss_val': 0.11591025163614142, 'psi': 0.9962958606966921}
[S11] START round=28 head_norm_before_train=2.009108 (no previous merge yet)
[S11] round=28 local utility u=0.001375 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9974676072679198, 'loss_val': 0.028168874896527547, 'psi': 0.9969175959042262}-{'f1_val': 0.9965718709689133, 'auprc': 0.9990247828828996, 'loss_val': 0.035716298205071155, 'psi': 0.9975530357345078}
[S13] START round=28 head_norm_before_train=1.844253 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.085749 metrics={'f1_val': 0.5807272549257343, 'auprc': 0.6822830810398465, 'loss_val': 0.8665127288374169, 'psi': 0.6213495853713792}-{'f1_val': 0.5491557381516158, 'auprc': 0.67659731006579, 'loss_val': 0.8315236740138074, 'psi': 0.6001323669172854}
[S14] START round=28 head_norm_before_train=1.859179 cos_to_last_merge=0.9993 (last merge round=25)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9591989392924253, 'auprc': 0.9962544529198587, 'loss_val': 0.08233983297496456, 'psi': 0.9740211447433986}-{'f1_val': 0.9974082695017256, 'auprc': 0.9972951026718581, 'loss_val': 0.05044767515144376, 'psi': 0.9973630027697786}
[S15] START round=28 head_norm_before_train=2.000250 (no previous merge yet)
[S15] round=28 local utility u=0.267107 metrics={'f1_val': 0.9038947250119622, 'auprc': 0.9958890587975768, 'loss_val': 0.11121445308938786, 'psi': 0.9406924585262081}-{'f1_val': 0.8313815774422667, 'auprc': 0.9948700961696924, 'loss_val': 0.2072936314654908, 'psi': 0.896776984933237}
[S16] START round=28 head_norm_before_train=1.261066 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8433328013487849, 'auprc': 0.99711390721263, 'loss_val': 0.5999187160454679, 'psi': 0.904845243694323}-{'f1_val': 0.9909428537822442, 'auprc': 0.9895737353274506, 'loss_val': 0.1544860388237578, 'psi': 0.9903952064003267}
[S17] START round=28 head_norm_before_train=1.826759 (no previous merge yet)
[S17] round=28 local utility u=0.109507 metrics={'f1_val': 0.6511806364515783, 'auprc': 0.8437333954530242, 'loss_val': 0.8809129543162411, 'psi': 0.7282017400521567}-{'f1_val': 0.6370021605171767, 'auprc': 0.8242375436748388, 'loss_val': 0.9563676838165104, 'psi': 0.7118963137802417}
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:50311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.3322
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=0.9908
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.1767
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9957
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.8683
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.9623
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.8047
[S8] RECEIVED delta(kind=head bytes=1806) from S4
[S8] cosine check vs S4: cos=0.6950
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9933
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9592 head_norm=1.883211
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.095439e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9573 head_norm=1.859446 delta_norm=0.109544
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.5977 head_norm=1.626885
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.520001e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.5977 head_norm=1.700942 delta_norm=0.252000
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9944 head_norm=1.012863
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.955811e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9944 head_norm=1.101954 delta_norm=0.495581
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5336 head_norm=1.257608
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.153931e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5582 head_norm=1.229167 delta_norm=0.515393
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8433 head_norm=1.299391
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.859901e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8407 head_norm=1.526443 delta_norm=0.485990
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9028 head_norm=1.807390
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.965970e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.8955 head_norm=1.404974 delta_norm=0.996597
[S3] aggregate: ROLLBACK (f1_val pre=0.903 post=0.896 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9957 head_norm=2.017891
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.373393e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9957 head_norm=2.016938 delta_norm=0.137339
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.6995 head_norm=1.633295
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.663368e-02
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7004 head_norm=1.616536 delta_norm=0.076634
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.603268 cos_to_last_merge=0.8272 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.834900882877165, 'auprc': 0.8232920640924417, 'loss_val': 0.5898050344068926, 'psi': 0.8302573553632757}-{'f1_val': 0.8361533504393528, 'auprc': 0.856542596487835, 'loss_val': 0.41573330716883705, 'psi': 0.8443090488587457}
[S3] START round=29 head_norm_before_train=1.404974 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.284003 metrics={'f1_val': 0.9755706746290642, 'auprc': 0.9960795802900275, 'loss_val': 0.1873939979839273, 'psi': 0.9837742368934494}-{'f1_val': 0.9027541648544617, 'auprc': 0.9689860135243293, 'loss_val': 0.23721993369204286, 'psi': 0.9292469043224088}
[S4] START round=29 head_norm_before_train=1.376196 cos_to_last_merge=0.9970 (last merge round=26)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9484191514007393, 'auprc': 0.9551072407513844, 'loss_val': 0.3125394189561219, 'psi': 0.9510943871409974}-{'f1_val': 0.9544529271175901, 'auprc': 0.9491141398883723, 'loss_val': 0.31127240081470525, 'psi': 0.9523174122259029}
[S5] START round=29 head_norm_before_train=1.616536 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8555195740403899, 'loss_val': 0.8500906369023509, 'psi': 0.6042675679193792}-{'f1_val': 0.6995492496660676, 'auprc': 0.8794884692696749, 'loss_val': 0.3505534731374843, 'psi': 0.7715249375075106}
[S6] START round=29 head_norm_before_train=1.700942 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.384661 metrics={'f1_val': 0.6564149967942242, 'auprc': 0.9220586163830856, 'loss_val': 0.5759394568702909, 'psi': 0.7626724446297688}-{'f1_val': 0.5977087786725374, 'auprc': 0.8054543979698814, 'loss_val': 0.6432108295579207, 'psi': 0.680807026391475}
[S7] START round=29 head_norm_before_train=1.229167 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.184173 metrics={'f1_val': 0.578669173791921, 'auprc': 0.7972602985262013, 'loss_val': 0.7681251435590459, 'psi': 0.6661056236856331}-{'f1_val': 0.5335627801614219, 'auprc': 0.7921556610198833, 'loss_val': 0.8505195019534506, 'psi': 0.6369999325048065}
[S8] START round=29 head_norm_before_train=1.101954 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.069003 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9857808511164237, 'loss_val': 0.2123456727469521, 'psi': 0.9904875427152674}-{'f1_val': 0.9943590272655265, 'auprc': 0.9927977503972633, 'loss_val': 0.37580452324158525, 'psi': 0.9937345165182212}
[S9] START round=29 head_norm_before_train=2.077811 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9995984494836879, 'loss_val': 0.02243509228059883, 'psi': 0.9963354398171491}-{'f1_val': 0.9956098104564366, 'auprc': 0.9995993481714363, 'loss_val': 0.01914251347791626, 'psi': 0.9972056255424364}
[S10] START round=29 head_norm_before_train=2.016938 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9960572715342488, 'loss_val': 0.09095325967266855, 'psi': 0.9958702450607458}-{'f1_val': 0.9957455607450773, 'auprc': 0.9962297037347698, 'loss_val': 0.0914032732263478, 'psi': 0.9959392179409543}
[S11] START round=29 head_norm_before_train=2.025320 (no previous merge yet)
[S11] round=29 local utility u=0.001046 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9975504603576565, 'loss_val': 0.026325446409951738, 'psi': 0.996950737140121}-{'f1_val': 0.9965509216617638, 'auprc': 0.9974676072679198, 'loss_val': 0.028168874896527547, 'psi': 0.9969175959042262}
[S13] START round=29 head_norm_before_train=1.855805 cos_to_last_merge=0.9999 (last merge round=27)
[S13] round=29 local utility u=0.111814 metrics={'f1_val': 0.6000316480898218, 'auprc': 0.6941948486406985, 'loss_val': 0.7944457831679402, 'psi': 0.6376969283101724}-{'f1_val': 0.5807272549257343, 'auprc': 0.6822830810398465, 'loss_val': 0.8665127288374169, 'psi': 0.6213495853713792}
[S14] START round=29 head_norm_before_train=1.859446 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.137496 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9997811258396825, 'loss_val': 0.04617558821082116, 'psi': 0.9982566643593489}-{'f1_val': 0.9591989392924253, 'auprc': 0.9962544529198587, 'loss_val': 0.08233983297496456, 'psi': 0.9740211447433986}
[S15] START round=29 head_norm_before_train=2.017528 (no previous merge yet)
[S15] round=29 local utility u=0.282847 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.9975902623025714, 'loss_val': 0.044672055967371664, 'psi': 0.990777689650283}-{'f1_val': 0.9038947250119622, 'auprc': 0.9958890587975768, 'loss_val': 0.11121445308938786, 'psi': 0.9406924585262081}
[S16] START round=29 head_norm_before_train=1.526443 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.548961 metrics={'f1_val': 0.9594157993218955, 'auprc': 0.9926428932933472, 'loss_val': 0.18508219605111684, 'psi': 0.9727066369104762}-{'f1_val': 0.8433328013487849, 'auprc': 0.99711390721263, 'loss_val': 0.5999187160454679, 'psi': 0.904845243694323}
[S17] START round=29 head_norm_before_train=1.841900 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6310329145014277, 'auprc': 0.8171794149611246, 'loss_val': 1.0446337691705614, 'psi': 0.7054915146853065}-{'f1_val': 0.6511806364515783, 'auprc': 0.8437333954530242, 'loss_val': 0.8809129543162411, 'psi': 0.7282017400521567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.4958
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.8118
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.2715
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S11
[S10] cosine check vs S11: cos=0.9952
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9950
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.4842
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.9740
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:50304
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] cosine check vs S3: cos=0.8778
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=0.8994
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9484 head_norm=1.404009
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.402230e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9449 head_norm=1.442792 delta_norm=0.340223
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9936 head_norm=1.160346
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.168569e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9936 head_norm=1.058796 delta_norm=0.616857
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.6564 head_norm=1.711569
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.109157e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6987 head_norm=1.529184 delta_norm=0.410916
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5787 head_norm=1.287136
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.738550e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5772 head_norm=1.123248 delta_norm=0.573855
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6000 head_norm=1.866007
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.368259e-02
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6008 head_norm=1.870349 delta_norm=0.093683
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9957 head_norm=2.050090
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.004694e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9953 head_norm=2.043429 delta_norm=0.100469
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9594 head_norm=1.556778
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.223310e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9628 head_norm=1.470649 delta_norm=0.122331
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.621583 cos_to_last_merge=0.8252 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7266293764960499, 'auprc': 0.7709201103365233, 'loss_val': 0.7352795189850942, 'psi': 0.7443456700322393}-{'f1_val': 0.834900882877165, 'auprc': 0.8232920640924417, 'loss_val': 0.5898050344068926, 'psi': 0.8302573553632757}
[S3] START round=30 head_norm_before_train=1.443967 cos_to_last_merge=0.9990 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9341106693382683, 'auprc': 0.9812609333937785, 'loss_val': 0.1849652392906255, 'psi': 0.9529707749604723}-{'f1_val': 0.9755706746290642, 'auprc': 0.9960795802900275, 'loss_val': 0.1873939979839273, 'psi': 0.9837742368934494}
[S4] START round=30 head_norm_before_train=1.442792 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.004130 metrics={'f1_val': 0.9534522504757541, 'auprc': 0.9515451402732743, 'loss_val': 0.32379160362043674, 'psi': 0.9526894063947622}-{'f1_val': 0.9484191514007393, 'auprc': 0.9551072407513844, 'loss_val': 0.3125394189561219, 'psi': 0.9510943871409974}
[S5] START round=30 head_norm_before_train=1.632512 cos_to_last_merge=0.9999 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.4249969512498927, 'auprc': 0.8442350403225145, 'loss_val': 1.222216509198398, 'psi': 0.5926921868789414}-{'f1_val': 0.43676623050537206, 'auprc': 0.8555195740403899, 'loss_val': 0.8500906369023509, 'psi': 0.6042675679193792}
[S6] START round=30 head_norm_before_train=1.529184 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.642748 metrics={'f1_val': 0.8291264117220555, 'auprc': 0.9519887317348532, 'loss_val': 0.4165019847605814, 'psi': 0.8782713397271746}-{'f1_val': 0.6564149967942242, 'auprc': 0.9220586163830856, 'loss_val': 0.5759394568702909, 'psi': 0.7626724446297688}
[S7] START round=30 head_norm_before_train=1.123248 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5632256594757482, 'auprc': 0.792470070599381, 'loss_val': 0.8435400853781172, 'psi': 0.6549234239252013}-{'f1_val': 0.578669173791921, 'auprc': 0.7972602985262013, 'loss_val': 0.7681251435590459, 'psi': 0.6661056236856331}
[S8] START round=30 head_norm_before_train=1.058796 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9987293856510608, 'loss_val': 0.2727557117294797, 'psi': 0.9937170452410189}-{'f1_val': 0.9936253371144965, 'auprc': 0.9857808511164237, 'loss_val': 0.2123456727469521, 'psi': 0.9904875427152674}
[S9] START round=30 head_norm_before_train=2.087422 (no previous merge yet)
[S9] round=30 local utility u=0.000103 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.999593917083158, 'loss_val': 0.022215143085210626, 'psi': 0.9963336268569372}-{'f1_val': 0.9941601000394567, 'auprc': 0.9995984494836879, 'loss_val': 0.02243509228059883, 'psi': 0.9963354398171491}
[S10] START round=30 head_norm_before_train=2.043429 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9959140953145954, 'loss_val': 0.09061268811460259, 'psi': 0.9958129745728845}-{'f1_val': 0.9957455607450773, 'auprc': 0.9960572715342488, 'loss_val': 0.09095325967266855, 'psi': 0.9958702450607458}
[S11] START round=30 head_norm_before_train=2.041698 (no previous merge yet)
[S11] round=30 local utility u=0.001663 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990217268806799, 'loss_val': 0.025033314952921385, 'psi': 0.9973011755987192}-{'f1_val': 0.9965509216617638, 'auprc': 0.9975504603576565, 'loss_val': 0.026325446409951738, 'psi': 0.996950737140121}
[S13] START round=30 head_norm_before_train=1.870349 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5751915992951755, 'auprc': 0.6941604743616299, 'loss_val': 0.8735858622405668, 'psi': 0.6227791493217573}-{'f1_val': 0.6000316480898218, 'auprc': 0.6941948486406985, 'loss_val': 0.7944457831679402, 'psi': 0.6376969283101724}
[S14] START round=30 head_norm_before_train=1.879357 cos_to_last_merge=0.9999 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9993564628840116, 'loss_val': 0.046196163534526505, 'psi': 0.9978108896578879}-{'f1_val': 0.997240356705793, 'auprc': 0.9997811258396825, 'loss_val': 0.04617558821082116, 'psi': 0.9982566643593489}
[S15] START round=30 head_norm_before_train=2.032413 (no previous merge yet)
[S15] round=30 local utility u=0.032397 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9919402227198681, 'loss_val': 0.02599301160599455, 'psi': 0.9948240901204596}-{'f1_val': 0.9862359745487574, 'auprc': 0.9975902623025714, 'loss_val': 0.044672055967371664, 'psi': 0.990777689650283}
[S16] START round=30 head_norm_before_train=1.470649 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.115443 metrics={'f1_val': 0.9914321359471406, 'auprc': 0.9916574226125796, 'loss_val': 0.14333682950856153, 'psi': 0.9915222506133162}-{'f1_val': 0.9594157993218955, 'auprc': 0.9926428932933472, 'loss_val': 0.18508219605111684, 'psi': 0.9727066369104762}
[S17] START round=30 head_norm_before_train=1.859488 (no previous merge yet)
[S17] round=30 local utility u=0.106393 metrics={'f1_val': 0.6447305770803435, 'auprc': 0.8350928181540549, 'loss_val': 0.9677735872189264, 'psi': 0.7208754735098282}-{'f1_val': 0.6310329145014277, 'auprc': 0.8171794149611246, 'loss_val': 1.0446337691705614, 'psi': 0.7054915146853065}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.4824
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:50309
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.6147
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S9] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.9967
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] cosine check vs S9: cos=0.7199
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.6682
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.9809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9904 head_norm=1.113997
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.865595e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9893 head_norm=1.159852 delta_norm=0.586559
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.044 → S16@127.0.0.1:50316
[S2] ⇄ pheromone p=0.177 → S5@127.0.0.1:50305
[S5] ⇄ pheromone p=0.072 → S3@127.0.0.1:50303
[S6] ⇄ pheromone p=0.344 → S7@127.0.0.1:50308
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.5632 head_norm=1.165441
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.770817e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5742 head_norm=1.143219 delta_norm=0.277082
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.140 → S8@127.0.0.1:50309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9341 head_norm=1.504729
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.289439e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9279 head_norm=1.675336 delta_norm=0.728944
[S3] aggregate: ROLLBACK (f1_val pre=0.934 post=0.928 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.240 → S6@127.0.0.1:50307
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9957 head_norm=2.077635
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.491758e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9953 head_norm=2.065361 delta_norm=0.084918
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.021 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.136 → S7@127.0.0.1:50308
[S9] ⇄ pheromone p=0.009 → S3@127.0.0.1:50303
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9535 head_norm=1.462063
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.460962e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9528 head_norm=1.473861 delta_norm=0.146096
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.028 → S8@127.0.0.1:50309
[S13] ⇄ pheromone p=0.054 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.033 → S13@127.0.0.1:50313
[S11] ⇄ pheromone p=0.020 → S10@127.0.0.1:50311
[S16] ⇄ pheromone p=0.193 → S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9959
[S17] ⇄ pheromone p=0.081 → S14@127.0.0.1:50314
[S2] START round=31 head_norm_before_train=1.644755 cos_to_last_merge=0.8223 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=31 local utility u=0.044443 metrics={'f1_val': 0.7435609601558162, 'auprc': 0.7716104547108135, 'loss_val': 0.7500534413268409, 'psi': 0.7547807579778152}-{'f1_val': 0.7266293764960499, 'auprc': 0.7709201103365233, 'loss_val': 0.7352795189850942, 'psi': 0.7443456700322393}
[S3] START round=31 head_norm_before_train=1.675336 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.251174 metrics={'f1_val': 0.9899147070736061, 'auprc': 0.9997661986238378, 'loss_val': 0.07295807535754854, 'psi': 0.9938553036936988}-{'f1_val': 0.9341106693382683, 'auprc': 0.9812609333937785, 'loss_val': 0.1849652392906255, 'psi': 0.9529707749604723}
[S4] START round=31 head_norm_before_train=1.473861 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9515431745086793, 'auprc': 0.9477002169086988, 'loss_val': 0.34397830732333595, 'psi': 0.9500059914686871}-{'f1_val': 0.9534522504757541, 'auprc': 0.9515451402732743, 'loss_val': 0.32379160362043674, 'psi': 0.9526894063947622}
[S5] START round=31 head_norm_before_train=1.649623 cos_to_last_merge=0.9995 (last merge round=28)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.6786860464840079, 'auprc': 0.8597391627260563, 'loss_val': 0.3871744376934139, 'psi': 0.7511072929808273}-{'f1_val': 0.4249969512498927, 'auprc': 0.8442350403225145, 'loss_val': 1.222216509198398, 'psi': 0.5926921868789414}
[S6] START round=31 head_norm_before_train=1.542003 cos_to_last_merge=0.9997 (last merge round=29)
[S6] round=31 local utility u=0.437686 metrics={'f1_val': 0.9570849139859002, 'auprc': 0.9498548453464383, 'loss_val': 0.3024788568138295, 'psi': 0.9541928865301155}-{'f1_val': 0.8291264117220555, 'auprc': 0.9519887317348532, 'loss_val': 0.4165019847605814, 'psi': 0.8782713397271746}
[S7] START round=31 head_norm_before_train=1.143219 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4191481437282486, 'auprc': 0.7798403156929983, 'loss_val': 1.1096248406822071, 'psi': 0.5634250125141484}-{'f1_val': 0.5632256594757482, 'auprc': 0.792470070599381, 'loss_val': 0.8435400853781172, 'psi': 0.6549234239252013}
[S8] START round=31 head_norm_before_train=1.159852 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.021146 metrics={'f1_val': 0.994792642153961, 'auprc': 0.981559282163553, 'loss_val': 0.20545690161933536, 'psi': 0.9894992981577979}-{'f1_val': 0.9903754849676576, 'auprc': 0.9987293856510608, 'loss_val': 0.2727557117294797, 'psi': 0.9937170452410189}
[S9] START round=31 head_norm_before_train=2.100478 (no previous merge yet)
[S9] round=31 local utility u=0.008835 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9993884099695625, 'loss_val': 0.018931300187849533, 'psi': 0.9977516710761598}-{'f1_val': 0.9941601000394567, 'auprc': 0.999593917083158, 'loss_val': 0.022215143085210626, 'psi': 0.9963336268569372}
[S10] START round=31 head_norm_before_train=2.065361 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.009030 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9970501120159656, 'loss_val': 0.07596004293860589, 'psi': 0.9962673812534326}-{'f1_val': 0.9957455607450773, 'auprc': 0.9959140953145954, 'loss_val': 0.09061268811460259, 'psi': 0.9958129745728845}
[S11] START round=31 head_norm_before_train=2.056522 (no previous merge yet)
[S11] round=31 local utility u=0.000628 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989465555602184, 'loss_val': 0.023552162606081985, 'psi': 0.9972711070705346}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990217268806799, 'loss_val': 0.025033314952921385, 'psi': 0.9973011755987192}
[S13] START round=31 head_norm_before_train=1.882936 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.075593 metrics={'f1_val': 0.5929405777579349, 'auprc': 0.6945687727789411, 'loss_val': 0.8301178878288029, 'psi': 0.6335918557663374}-{'f1_val': 0.5751915992951755, 'auprc': 0.6941604743616299, 'loss_val': 0.8735858622405668, 'psi': 0.6227791493217573}
[S14] START round=31 head_norm_before_train=1.899924 cos_to_last_merge=0.9997 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9966267961852202, 'loss_val': 0.04921539980570557, 'psi': 0.9967034374663069}-{'f1_val': 0.9967805075071389, 'auprc': 0.9993564628840116, 'loss_val': 0.046196163534526505, 'psi': 0.9978108896578879}
[S15] START round=31 head_norm_before_train=2.046105 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9032550745335991, 'auprc': 0.9980289289540285, 'loss_val': 0.16042199066223062, 'psi': 0.9411646163017708}-{'f1_val': 0.9967466683875206, 'auprc': 0.9919402227198681, 'loss_val': 0.02599301160599455, 'psi': 0.9948240901204596}
[S16] START round=31 head_norm_before_train=1.499863 cos_to_last_merge=0.9997 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8445528446367561, 'auprc': 0.9940829438792314, 'loss_val': 0.6521898739435089, 'psi': 0.9043648843337462}-{'f1_val': 0.9914321359471406, 'auprc': 0.9916574226125796, 'loss_val': 0.14333682950856153, 'psi': 0.9915222506133162}
[S17] START round=31 head_norm_before_train=1.880138 (no previous merge yet)
[S17] round=31 local utility u=0.054260 metrics={'f1_val': 0.6532914295111618, 'auprc': 0.8386776743212437, 'loss_val': 0.9213726402181629, 'psi': 0.7274459274351945}-{'f1_val': 0.6447305770803435, 'auprc': 0.8350928181540549, 'loss_val': 0.9677735872189264, 'psi': 0.7208754735098282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.9543
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.8832
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9973
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.3200
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.5044
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.9754
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.4311
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.9466
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9920
[S17] not sending this round → trigger blocked (psi=0.727)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.4191 head_norm=1.183198
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.599285e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.4135 head_norm=1.140283 delta_norm=0.659929
[S7] aggregate: ROLLBACK (f1_val pre=0.419 post=0.413 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9968 head_norm=1.917962
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.567261e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9968 head_norm=1.896733 delta_norm=0.095673
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9571 head_norm=1.565660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.982437e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9568 head_norm=1.633842 delta_norm=0.198244
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9957 head_norm=2.100198
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.876341e-02
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9953 head_norm=2.083415 delta_norm=0.078763
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9899 head_norm=1.722263
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.909972e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9903 head_norm=1.555511 delta_norm=0.290997
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6787 head_norm=1.662312
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.051654e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6824 head_norm=1.663192 delta_norm=0.105165
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8446 head_norm=1.527142
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.469289e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8448 head_norm=1.485493 delta_norm=0.084693
[S16] aggregate: ACCEPT kept=['S13', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.670704 cos_to_last_merge=0.8187 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.72262822644836, 'auprc': 0.7600410730530498, 'loss_val': 0.7705734356952292, 'psi': 0.737593365090236}-{'f1_val': 0.7435609601558162, 'auprc': 0.7716104547108135, 'loss_val': 0.7500534413268409, 'psi': 0.7547807579778152}
[S3] START round=32 head_norm_before_train=1.555511 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9744483422990404, 'auprc': 0.9976950930715822, 'loss_val': 0.1062556788751469, 'psi': 0.9837470426080571}-{'f1_val': 0.9899147070736061, 'auprc': 0.9997661986238378, 'loss_val': 0.07295807535754854, 'psi': 0.9938553036936988}
[S4] START round=32 head_norm_before_train=1.493165 cos_to_last_merge=0.9997 (last merge round=30)
[S4] round=32 local utility u=0.009311 metrics={'f1_val': 0.9476328308892682, 'auprc': 0.9525107438441631, 'loss_val': 0.3163255897224807, 'psi': 0.9495839960712262}-{'f1_val': 0.9515431745086793, 'auprc': 0.9477002169086988, 'loss_val': 0.34397830732333595, 'psi': 0.9500059914686871}
[S5] START round=32 head_norm_before_train=1.663192 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.196063 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9317116431876614, 'loss_val': 0.34077666038349713, 'psi': 0.7928774477354128}-{'f1_val': 0.6786860464840079, 'auprc': 0.8597391627260563, 'loss_val': 0.3871744376934139, 'psi': 0.7511072929808273}
[S6] START round=32 head_norm_before_train=1.633842 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.46263065245054685, 'auprc': 0.7678336549133092, 'loss_val': 0.8290810921365833, 'psi': 0.5847118534356518}-{'f1_val': 0.9570849139859002, 'auprc': 0.9498548453464383, 'loss_val': 0.3024788568138295, 'psi': 0.9541928865301155}
[S7] START round=32 head_norm_before_train=1.140283 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.584407 metrics={'f1_val': 0.5601420265585477, 'auprc': 0.7897922727864031, 'loss_val': 0.8166300195721207, 'psi': 0.6520021250496899}-{'f1_val': 0.4191481437282486, 'auprc': 0.7798403156929983, 'loss_val': 1.1096248406822071, 'psi': 0.5634250125141484}
[S8] START round=32 head_norm_before_train=1.213601 cos_to_last_merge=0.9976 (last merge round=30)
[S8] round=32 local utility u=0.038042 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9950454828716964, 'loss_val': 0.15194125675997214, 'psi': 0.9931047738463844}-{'f1_val': 0.994792642153961, 'auprc': 0.981559282163553, 'loss_val': 0.20545690161933536, 'psi': 0.9894992981577979}
[S9] START round=32 head_norm_before_train=2.107327 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964470389605503, 'loss_val': 0.01905736426642984, 'psi': 0.996575122672555}-{'f1_val': 0.9966605118138915, 'auprc': 0.9993884099695625, 'loss_val': 0.018931300187849533, 'psi': 0.9977516710761598}
[S10] START round=32 head_norm_before_train=2.083415 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000475 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961772112982255, 'loss_val': 0.06904519704856489, 'psi': 0.995583587930915}-{'f1_val': 0.9957455607450773, 'auprc': 0.9970501120159656, 'loss_val': 0.07596004293860589, 'psi': 0.9962673812534326}
[S11] START round=32 head_norm_before_train=2.069496 (no previous merge yet)
[S11] round=32 local utility u=0.000220 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988320968447194, 'loss_val': 0.022768335815099666, 'psi': 0.997225323584335}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989465555602184, 'loss_val': 0.023552162606081985, 'psi': 0.9972711070705346}
[S13] START round=32 head_norm_before_train=1.895272 cos_to_last_merge=0.9997 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5667759757636125, 'auprc': 0.6931467407314961, 'loss_val': 0.942186617718103, 'psi': 0.6173242817507659}-{'f1_val': 0.5929405777579349, 'auprc': 0.6945687727789411, 'loss_val': 0.8301178878288029, 'psi': 0.6335918557663374}
[S14] START round=32 head_norm_before_train=1.896733 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.006334 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9991067593912087, 'loss_val': 0.04546441513394818, 'psi': 0.9978431316850302}-{'f1_val': 0.996754531653698, 'auprc': 0.9966267961852202, 'loss_val': 0.04921539980570557, 'psi': 0.9967034374663069}
[S15] START round=32 head_norm_before_train=2.059340 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9026838669130122, 'auprc': 0.9982442754196258, 'loss_val': 0.17887925843527985, 'psi': 0.9409080303156576}-{'f1_val': 0.9032550745335991, 'auprc': 0.9980289289540285, 'loss_val': 0.16042199066223062, 'psi': 0.9411646163017708}
[S16] START round=32 head_norm_before_train=1.485493 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.121243 metrics={'f1_val': 0.8625274464029242, 'auprc': 0.988751236116971, 'loss_val': 0.5015561915695254, 'psi': 0.9130169622885429}-{'f1_val': 0.8445528446367561, 'auprc': 0.9940829438792314, 'loss_val': 0.6521898739435089, 'psi': 0.9043648843337462}
[S17] START round=32 head_norm_before_train=1.898940 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6166549595842604, 'auprc': 0.8117741396470677, 'loss_val': 1.2198481494289468, 'psi': 0.6947026316093834}-{'f1_val': 0.6532914295111618, 'auprc': 0.8386776743212437, 'loss_val': 0.9213726402181629, 'psi': 0.7274459274351945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:50311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:50304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S3@127.0.0.1:50303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S5] sending update (kind=head size=1810 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.6985
[S3] RECEIVED delta(kind=head bytes=1810) from S5
[S3] cosine check vs S5: cos=0.5515
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9955
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.9891
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=0.9976
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.8759
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.8995
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.4779
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5668 head_norm=1.906744
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.081611e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5685 head_norm=1.906633 delta_norm=0.090816
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9744 head_norm=1.596006
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.758664e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9734 head_norm=1.441611 delta_norm=0.775866
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9952 head_norm=2.117428
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.432732e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9952 head_norm=2.098219 delta_norm=0.074327
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5601 head_norm=1.182209
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.720166e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5720 head_norm=1.531192 delta_norm=0.772017
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9918 head_norm=1.265711
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.532110e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9918 head_norm=1.134969 delta_norm=0.253211
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.8625 head_norm=1.512306
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.660661e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.8660 head_norm=1.345564 delta_norm=0.366066
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9476 head_norm=1.522131
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.123530e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9462 head_norm=1.513061 delta_norm=0.112353
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.697541 cos_to_last_merge=0.8148 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.5751209655043774, 'auprc': 0.7711728712428376, 'loss_val': 0.9161438777305744, 'psi': 0.6535417277997615}-{'f1_val': 0.72262822644836, 'auprc': 0.7600410730530498, 'loss_val': 0.7705734356952292, 'psi': 0.737593365090236}
[S3] START round=33 head_norm_before_train=1.441611 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.941825721779006, 'auprc': 0.9972449844630582, 'loss_val': 0.19685045312459926, 'psi': 0.9639934268526269}-{'f1_val': 0.9744483422990404, 'auprc': 0.9976950930715822, 'loss_val': 0.1062556788751469, 'psi': 0.9837470426080571}
[S4] START round=33 head_norm_before_train=1.513061 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9454472833705274, 'auprc': 0.9400000270467808, 'loss_val': 0.31931024254312784, 'psi': 0.9432683808410287}-{'f1_val': 0.9476328308892682, 'auprc': 0.9525107438441631, 'loss_val': 0.3163255897224807, 'psi': 0.9495839960712262}
[S5] START round=33 head_norm_before_train=1.677256 cos_to_last_merge=0.9999 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8559153277243816, 'loss_val': 1.1085928877643034, 'psi': 0.6044258693929758}-{'f1_val': 0.7003213174339138, 'auprc': 0.9317116431876614, 'loss_val': 0.34077666038349713, 'psi': 0.7928774477354128}
[S6] START round=33 head_norm_before_train=1.650325 cos_to_last_merge=0.9997 (last merge round=31)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.820348335173825, 'auprc': 0.9092707984214321, 'loss_val': 0.447147115735984, 'psi': 0.8559173204728678}-{'f1_val': 0.46263065245054685, 'auprc': 0.7678336549133092, 'loss_val': 0.8290810921365833, 'psi': 0.5847118534356518}
[S7] START round=33 head_norm_before_train=1.531192 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.571264 metrics={'f1_val': 0.6757165494714709, 'auprc': 0.8354916364826661, 'loss_val': 0.5046464959583066, 'psi': 0.739626584275949}-{'f1_val': 0.5601420265585477, 'auprc': 0.7897922727864031, 'loss_val': 0.8166300195721207, 'psi': 0.6520021250496899}
[S8] START round=33 head_norm_before_train=1.134969 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9089568266646411, 'auprc': 0.9884754738406593, 'loss_val': 0.251865138759738, 'psi': 0.9407642855350483}-{'f1_val': 0.9918109678295097, 'auprc': 0.9950454828716964, 'loss_val': 0.15194125675997214, 'psi': 0.9931047738463844}
[S9] START round=33 head_norm_before_train=2.116223 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9995917881425989, 'loss_val': 0.02264516919821447, 'psi': 0.9960820202508646}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964470389605503, 'loss_val': 0.01905736426642984, 'psi': 0.996575122672555}
[S10] START round=33 head_norm_before_train=2.098219 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.003530 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9964214593129478, 'loss_val': 0.06271727997894738, 'psi': 0.9956812871368039}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961772112982255, 'loss_val': 0.06904519704856489, 'psi': 0.995583587930915}
[S11] START round=33 head_norm_before_train=2.081488 (no previous merge yet)
[S11] round=33 local utility u=0.001679 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989148988473818, 'loss_val': 0.02216121713652729, 'psi': 0.9975087084062275}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988320968447194, 'loss_val': 0.022768335815099666, 'psi': 0.997225323584335}
[S13] START round=33 head_norm_before_train=1.906633 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.176870 metrics={'f1_val': 0.603413094061266, 'auprc': 0.699005356366699, 'loss_val': 0.8258457942869113, 'psi': 0.6416499989834392}-{'f1_val': 0.5667759757636125, 'auprc': 0.6931467407314961, 'loss_val': 0.942186617718103, 'psi': 0.6173242817507659}
[S14] START round=33 head_norm_before_train=1.910843 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=33 local utility u=0.005704 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.999602445438009, 'loss_val': 0.03946158861505974, 'psi': 0.9984332838647771}-{'f1_val': 0.9970007132142444, 'auprc': 0.9991067593912087, 'loss_val': 0.04546441513394818, 'psi': 0.9978431316850302}
[S15] START round=33 head_norm_before_train=2.072207 (no previous merge yet)
[S15] round=33 local utility u=0.358810 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9967630056199719, 'loss_val': 0.021192025746361323, 'psi': 0.9967532032805011}-{'f1_val': 0.9026838669130122, 'auprc': 0.9982442754196258, 'loss_val': 0.17887925843527985, 'psi': 0.9409080303156576}
[S16] START round=33 head_norm_before_train=1.345564 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.132283 metrics={'f1_val': 0.8853872072176485, 'auprc': 0.9930123204916466, 'loss_val': 0.3869320059282997, 'psi': 0.9284372525272477}-{'f1_val': 0.8625274464029242, 'auprc': 0.988751236116971, 'loss_val': 0.5015561915695254, 'psi': 0.9130169622885429}
[S17] START round=33 head_norm_before_train=1.913099 (no previous merge yet)
[S17] round=33 local utility u=0.065445 metrics={'f1_val': 0.6061327698290545, 'auprc': 0.8396099809212831, 'loss_val': 1.1093317815553492, 'psi': 0.699523654265946}-{'f1_val': 0.6166549595842604, 'auprc': 0.8117741396470677, 'loss_val': 1.2198481494289468, 'psi': 0.6947026316093834}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] cosine check vs S6: cos=0.3786
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.5087
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=0.9981
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.9557
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.1045
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.9985
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9970
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.8577
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.9806
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9454 head_norm=1.539627
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.655920e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9454 head_norm=1.449798 delta_norm=0.165592
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6757 head_norm=1.562979
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.948855e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6735 head_norm=1.308294 delta_norm=0.394885
[S7] aggregate: ACCEPT kept=['S6', 'S10', 'S15'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9090 head_norm=1.178249
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.995422e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9307 head_norm=1.194248 delta_norm=0.699542
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9952 head_norm=2.128890
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.826531e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9952 head_norm=2.109715 delta_norm=0.068265
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.6034 head_norm=1.918008
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.227245e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.6018 head_norm=1.922532 delta_norm=0.052272
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8854 head_norm=1.374123
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.113183e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8747 head_norm=1.588093 delta_norm=0.511318
[S16] aggregate: ROLLBACK (f1_val pre=0.885 post=0.875 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9977 head_norm=1.928463
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.440064e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9977 head_norm=1.925198 delta_norm=0.074401
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.716306 cos_to_last_merge=0.8115 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=34 local utility u=0.717001 metrics={'f1_val': 0.7080289903876797, 'auprc': 0.8617510372106776, 'loss_val': 0.5513253844405563, 'psi': 0.7695178091168788}-{'f1_val': 0.5751209655043774, 'auprc': 0.7711728712428376, 'loss_val': 0.9161438777305744, 'psi': 0.6535417277997615}
[S3] START round=34 head_norm_before_train=1.490579 cos_to_last_merge=0.9984 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8404228146101285, 'auprc': 0.9690141269970071, 'loss_val': 0.31591851890484185, 'psi': 0.8918593395648798}-{'f1_val': 0.941825721779006, 'auprc': 0.9972449844630582, 'loss_val': 0.19685045312459926, 'psi': 0.9639934268526269}
[S4] START round=34 head_norm_before_train=1.449798 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.032154 metrics={'f1_val': 0.9521606192857863, 'auprc': 0.9415752784545468, 'loss_val': 0.30000801458160603, 'psi': 0.9479264829532905}-{'f1_val': 0.9454472833705274, 'auprc': 0.9400000270467808, 'loss_val': 0.31931024254312784, 'psi': 0.9432683808410287}
[S5] START round=34 head_norm_before_train=1.692875 cos_to_last_merge=0.9994 (last merge round=31)
[S5] round=34 local utility u=0.235218 metrics={'f1_val': 0.4437927227564323, 'auprc': 0.8628912153648989, 'loss_val': 0.7012438890617856, 'psi': 0.6114321197998189}-{'f1_val': 0.43676623050537206, 'auprc': 0.8559153277243816, 'loss_val': 1.1085928877643034, 'psi': 0.6044258693929758}
[S6] START round=34 head_norm_before_train=1.663698 cos_to_last_merge=0.9991 (last merge round=31)
[S6] round=34 local utility u=0.006102 metrics={'f1_val': 0.820198906704992, 'auprc': 0.9134446382611837, 'loss_val': 0.44656724119846464, 'psi': 0.8574971993274687}-{'f1_val': 0.820348335173825, 'auprc': 0.9092707984214321, 'loss_val': 0.447147115735984, 'psi': 0.8559173204728678}
[S7] START round=34 head_norm_before_train=1.308294 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6510882525369945, 'auprc': 0.8126025679984861, 'loss_val': 0.5957501897889818, 'psi': 0.7156939787215911}-{'f1_val': 0.6757165494714709, 'auprc': 0.8354916364826661, 'loss_val': 0.5046464959583066, 'psi': 0.739626584275949}
[S8] START round=34 head_norm_before_train=1.194248 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.233848 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9959875154924348, 'loss_val': 0.29948151168005444, 'psi': 0.9930466358424148}-{'f1_val': 0.9089568266646411, 'auprc': 0.9884754738406593, 'loss_val': 0.251865138759738, 'psi': 0.9407642855350483}
[S9] START round=34 head_norm_before_train=2.124382 (no previous merge yet)
[S9] round=34 local utility u=0.002399 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9999445001211968, 'loss_val': 0.021591310920416613, 'psi': 0.9964916238988184}-{'f1_val': 0.9937421749897083, 'auprc': 0.9995917881425989, 'loss_val': 0.02264516919821447, 'psi': 0.9960820202508646}
[S10] START round=34 head_norm_before_train=2.109715 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.003447 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9971476587972126, 'loss_val': 0.0566833329921132, 'psi': 0.9958399754379308}-{'f1_val': 0.9951878390193748, 'auprc': 0.9964214593129478, 'loss_val': 0.06271727997894738, 'psi': 0.9956812871368039}
[S11] START round=34 head_norm_before_train=2.092593 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989251255867804, 'loss_val': 0.03311506971207722, 'psi': 0.9975127991019869}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989148988473818, 'loss_val': 0.02216121713652729, 'psi': 0.9975087084062275}
[S13] START round=34 head_norm_before_train=1.922532 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5995736670589216, 'auprc': 0.7006971381465219, 'loss_val': 0.8126784777247158, 'psi': 0.6400230554939617}-{'f1_val': 0.603413094061266, 'auprc': 0.699005356366699, 'loss_val': 0.8258457942869113, 'psi': 0.6416499989834392}
[S14] START round=34 head_norm_before_train=1.925198 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988850019596501, 'loss_val': 0.04255069017436202, 'psi': 0.9977525056784591}-{'f1_val': 0.9976538428159559, 'auprc': 0.999602445438009, 'loss_val': 0.03946158861505974, 'psi': 0.9984332838647771}
[S15] START round=34 head_norm_before_train=2.084291 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.989635249632218, 'auprc': 0.998254550305842, 'loss_val': 0.03640409675488085, 'psi': 0.9930829699016677}-{'f1_val': 0.9967466683875206, 'auprc': 0.9967630056199719, 'loss_val': 0.021192025746361323, 'psi': 0.9967532032805011}
[S16] START round=34 head_norm_before_train=1.588093 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8423009916650502, 'auprc': 0.9839389253572757, 'loss_val': 0.7263339225173414, 'psi': 0.8989561651419404}-{'f1_val': 0.8853872072176485, 'auprc': 0.9930123204916466, 'loss_val': 0.3869320059282997, 'psi': 0.9284372525272477}
[S17] START round=34 head_norm_before_train=1.924805 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5987938128334613, 'auprc': 0.8054792579866646, 'loss_val': 1.2962825057923832, 'psi': 0.6814679908947427}-{'f1_val': 0.6061327698290545, 'auprc': 0.8396099809212831, 'loss_val': 1.1093317815553492, 'psi': 0.699523654265946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:50303
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:50305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:50303
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.6206
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.4938
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] cosine check vs S2: cos=0.9917
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.5188
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.8621
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1790) from S9
[S3] cosine check vs S9: cos=0.6004
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.8767
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.4438 head_norm=1.701771
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.114718e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.5443 head_norm=1.712467 delta_norm=0.111472
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9911 head_norm=1.226570
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.992801e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9907 head_norm=1.217748 delta_norm=0.599280
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6511 head_norm=1.339233
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.900310e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6348 head_norm=1.376341 delta_norm=0.290031
[S7] aggregate: ROLLBACK (f1_val pre=0.651 post=0.635 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.8404 head_norm=1.537502
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.509209e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.8247 head_norm=1.474549 delta_norm=0.250921
[S3] aggregate: ROLLBACK (f1_val pre=0.840 post=0.825 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.8423 head_norm=1.613700
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.167315e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.8455 head_norm=1.241187 delta_norm=0.716732
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.730292 cos_to_last_merge=0.8092 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=35 local utility u=0.340302 metrics={'f1_val': 0.8254298525000495, 'auprc': 0.8399219877692543, 'loss_val': 0.5096400223190187, 'psi': 0.8312267066077315}-{'f1_val': 0.7080289903876797, 'auprc': 0.8617510372106776, 'loss_val': 0.5513253844405563, 'psi': 0.7695178091168788}
[S3] START round=35 head_norm_before_train=1.474549 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.348218 metrics={'f1_val': 0.9323161047302355, 'auprc': 0.9784936415294192, 'loss_val': 0.19928027848562382, 'psi': 0.950787119449909}-{'f1_val': 0.8404228146101285, 'auprc': 0.9690141269970071, 'loss_val': 0.31591851890484185, 'psi': 0.8918593395648798}
[S4] START round=35 head_norm_before_train=1.476353 cos_to_last_merge=0.9996 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9526711455728945, 'auprc': 0.9267653032144713, 'loss_val': 0.2789249004477114, 'psi': 0.9423088086295252}-{'f1_val': 0.9521606192857863, 'auprc': 0.9415752784545468, 'loss_val': 0.30000801458160603, 'psi': 0.9479264829532905}
[S5] START round=35 head_norm_before_train=1.712467 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.158840 metrics={'f1_val': 0.5029474913959794, 'auprc': 0.8544639876035401, 'loss_val': 0.7132100595752174, 'psi': 0.6435540898790038}-{'f1_val': 0.4437927227564323, 'auprc': 0.8628912153648989, 'loss_val': 0.7012438890617856, 'psi': 0.6114321197998189}
[S6] START round=35 head_norm_before_train=1.676395 cos_to_last_merge=0.9983 (last merge round=31)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.5018909513782168, 'auprc': 0.7577951672351111, 'loss_val': 0.9861216156121965, 'psi': 0.6042526377209745}-{'f1_val': 0.820198906704992, 'auprc': 0.9134446382611837, 'loss_val': 0.44656724119846464, 'psi': 0.8574971993274687}
[S7] START round=35 head_norm_before_train=1.376341 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5209536139814009, 'auprc': 0.7781817503777719, 'loss_val': 0.995622767014354, 'psi': 0.6238448685399494}-{'f1_val': 0.6510882525369945, 'auprc': 0.8126025679984861, 'loss_val': 0.5957501897889818, 'psi': 0.7156939787215911}
[S8] START round=35 head_norm_before_train=1.217748 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.057733 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9961706137520463, 'loss_val': 0.18456484063719233, 'psi': 0.9931198751462593}-{'f1_val': 0.9910860494090681, 'auprc': 0.9959875154924348, 'loss_val': 0.29948151168005444, 'psi': 0.9930466358424148}
[S9] START round=35 head_norm_before_train=2.130812 (no previous merge yet)
[S9] round=35 local utility u=0.007807 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999387032510803, 'loss_val': 0.018446946538359175, 'psi': 0.9977380987386758}-{'f1_val': 0.9941897064172326, 'auprc': 0.9999445001211968, 'loss_val': 0.021591310920416613, 'psi': 0.9964916238988184}
[S10] START round=35 head_norm_before_train=2.139376 cos_to_last_merge=0.9996 (last merge round=33)
[S10] round=35 local utility u=0.004510 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9968261406749598, 'loss_val': 0.04801705718823493, 'psi': 0.9958431596816087}-{'f1_val': 0.9949681865317428, 'auprc': 0.9971476587972126, 'loss_val': 0.0566833329921132, 'psi': 0.9958399754379308}
[S11] START round=35 head_norm_before_train=2.102245 (no previous merge yet)
[S11] round=35 local utility u=0.004270 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9979691429576328, 'loss_val': 0.021706234487617684, 'psi': 0.9971304060503279}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989251255867804, 'loss_val': 0.03311506971207722, 'psi': 0.9975127991019869}
[S13] START round=35 head_norm_before_train=1.932080 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.028804 metrics={'f1_val': 0.6130374827648499, 'auprc': 0.7044268215711761, 'loss_val': 0.8470425984886099, 'psi': 0.6495932182873805}-{'f1_val': 0.5995736670589216, 'auprc': 0.7006971381465219, 'loss_val': 0.8126784777247158, 'psi': 0.6400230554939617}
[S14] START round=35 head_norm_before_train=1.943235 cos_to_last_merge=0.9999 (last merge round=33)
[S14] round=35 local utility u=0.001627 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9992514148360306, 'loss_val': 0.038958007594045434, 'psi': 0.9977552079605787}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988850019596501, 'loss_val': 0.04255069017436202, 'psi': 0.9977525056784591}
[S15] START round=35 head_norm_before_train=2.096200 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7605901908221343, 'auprc': 0.9924118524654645, 'loss_val': 0.40419812894108287, 'psi': 0.8533188554794664}-{'f1_val': 0.989635249632218, 'auprc': 0.998254550305842, 'loss_val': 0.03640409675488085, 'psi': 0.9930829699016677}
[S16] START round=35 head_norm_before_train=1.241187 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.689496 metrics={'f1_val': 0.9827215740636395, 'auprc': 0.9876450721648867, 'loss_val': 0.20098346283412652, 'psi': 0.9846909733041385}-{'f1_val': 0.8423009916650502, 'auprc': 0.9839389253572757, 'loss_val': 0.7263339225173414, 'psi': 0.8989561651419404}
[S17] START round=35 head_norm_before_train=1.935084 (no previous merge yet)
[S17] round=35 local utility u=0.252207 metrics={'f1_val': 0.6208290316831957, 'auprc': 0.8589197070494626, 'loss_val': 1.084402146143181, 'psi': 0.7160653018297025}-{'f1_val': 0.5987938128334613, 'auprc': 0.8054792579866646, 'loss_val': 1.2962825057923832, 'psi': 0.6814679908947427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:50313
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:50303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:50311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] cosine check vs S5: cos=0.7804
[S10] RECEIVED delta(kind=head bytes=1805) from S11
[S10] cosine check vs S11: cos=0.9967
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.8130
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.9814
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] cosine check vs S14: cos=0.9983
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.9205
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] cosine check vs S9: cos=0.7173
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9382
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9972
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.8650
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9981
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.5019 head_norm=1.692014
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.315364e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.5376 head_norm=1.568576 delta_norm=0.331536
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.278 → S7@127.0.0.1:50308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9527 head_norm=1.507153
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.710011e-01
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9527 head_norm=1.365785 delta_norm=0.271001
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.015 → S8@127.0.0.1:50309
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5210 head_norm=1.410872
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.907959e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5596 head_norm=1.730077 delta_norm=0.590796
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.179 → S8@127.0.0.1:50309
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9968 head_norm=1.963138
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.073685e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9968 head_norm=1.953427 delta_norm=0.060737
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.013 → S13@127.0.0.1:50313
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6130 head_norm=1.942312
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.810259e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6117 head_norm=1.951888 delta_norm=0.058103
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.052 → S16@127.0.0.1:50316
[S11] ⇄ pheromone p=0.008 → S10@127.0.0.1:50311
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.9323 head_norm=1.509232
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.389159e-01
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.9330 head_norm=1.479812 delta_norm=0.138916
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.169 → S6@127.0.0.1:50307
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9827 head_norm=1.267323
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.468762e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9870 head_norm=1.358129 delta_norm=0.246876
[S16] aggregate: ACCEPT kept=['S13', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.231 → S4@127.0.0.1:50304
[S2] ⇄ pheromone p=0.244 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=0.005 → S3@127.0.0.1:50303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.5029 head_norm=1.719084
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.560048e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.5222 head_norm=1.730552 delta_norm=0.065600
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.195 → S3@127.0.0.1:50303
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9952 head_norm=2.166530
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.061202e-02
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9952 head_norm=2.137454 delta_norm=0.090612
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.010 → S7@127.0.0.1:50308
[S8] ⇄ pheromone p=0.069 → S16@127.0.0.1:50316
[S15] ⇄ pheromone p=0.090 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=0.090 → S14@127.0.0.1:50314
[S2] START round=36 head_norm_before_train=1.744414 cos_to_last_merge=0.8071 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7225107488945979, 'auprc': 0.7922021376860425, 'loss_val': 0.8848484618434385, 'psi': 0.7503873044111757}-{'f1_val': 0.8254298525000495, 'auprc': 0.8399219877692543, 'loss_val': 0.5096400223190187, 'psi': 0.8312267066077315}
[S3] START round=36 head_norm_before_train=1.479812 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.262751 metrics={'f1_val': 0.9927455214567068, 'auprc': 0.9972216077052714, 'loss_val': 0.09253855103303399, 'psi': 0.9945359559561326}-{'f1_val': 0.9323161047302355, 'auprc': 0.9784936415294192, 'loss_val': 0.19928027848562382, 'psi': 0.950787119449909}
[S4] START round=36 head_norm_before_train=1.365785 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9402654015382713, 'auprc': 0.9367336941251714, 'loss_val': 0.32553474029876645, 'psi': 0.9388527185730313}-{'f1_val': 0.9526711455728945, 'auprc': 0.9267653032144713, 'loss_val': 0.2789249004477114, 'psi': 0.9423088086295252}
[S5] START round=36 head_norm_before_train=1.730552 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.7008686948557086, 'auprc': 0.9895317694173855, 'loss_val': 0.22829549266852098, 'psi': 0.8163339246803794}-{'f1_val': 0.5029474913959794, 'auprc': 0.8544639876035401, 'loss_val': 0.7132100595752174, 'psi': 0.6435540898790038}
[S6] START round=36 head_norm_before_train=1.568576 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9604375437099987, 'auprc': 0.9732407355675237, 'loss_val': 0.28680241263437467, 'psi': 0.9655588204530087}-{'f1_val': 0.5018909513782168, 'auprc': 0.7577951672351111, 'loss_val': 0.9861216156121965, 'psi': 0.6042526377209745}
[S7] START round=36 head_norm_before_train=1.730077 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.7443497484385373, 'auprc': 0.8818447926913915, 'loss_val': 0.3669738141311666, 'psi': 0.799347766139679}-{'f1_val': 0.5209536139814009, 'auprc': 0.7781817503777719, 'loss_val': 0.995622767014354, 'psi': 0.6238448685399494}
[S8] START round=36 head_norm_before_train=1.259045 cos_to_last_merge=0.9987 (last merge round=34)
[S8] round=36 local utility u=0.002302 metrics={'f1_val': 0.9931548986711313, 'auprc': 0.9837501050107592, 'loss_val': 0.15511262980386634, 'psi': 0.9893929812069824}-{'f1_val': 0.9910860494090681, 'auprc': 0.9961706137520463, 'loss_val': 0.18456484063719233, 'psi': 0.9931198751462593}
[S9] START round=36 head_norm_before_train=2.139699 (no previous merge yet)
[S9] round=36 local utility u=0.001549 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998035318408374, 'loss_val': 0.017280179154397477, 'psi': 0.9979177198246698}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999387032510803, 'loss_val': 0.018446946538359175, 'psi': 0.9977380987386758}
[S10] START round=36 head_norm_before_train=2.137454 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9967478611612355, 'loss_val': 0.049915935509467976, 'psi': 0.9958118478761191}-{'f1_val': 0.9951878390193748, 'auprc': 0.9968261406749598, 'loss_val': 0.04801705718823493, 'psi': 0.9958431596816087}
[S11] START round=36 head_norm_before_train=2.111868 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9853789917439917, 'auprc': 0.999090993709409, 'loss_val': 0.059307994870949815, 'psi': 0.9908637925301587}-{'f1_val': 0.9965712481121245, 'auprc': 0.9979691429576328, 'loss_val': 0.021706234487617684, 'psi': 0.9971304060503279}
[S13] START round=36 head_norm_before_train=1.951888 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6147163417264996, 'auprc': 0.7103403696458163, 'loss_val': 0.9284794824357391, 'psi': 0.6529659528942262}-{'f1_val': 0.6130374827648499, 'auprc': 0.7044268215711761, 'loss_val': 0.8470425984886099, 'psi': 0.6495932182873805}
[S14] START round=36 head_norm_before_train=1.953427 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.001035 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990851726154139, 'loss_val': 0.03784760232171505, 'psi': 0.9978344969747122}-{'f1_val': 0.9967577367102773, 'auprc': 0.9992514148360306, 'loss_val': 0.038958007594045434, 'psi': 0.9977552079605787}
[S15] START round=36 head_norm_before_train=2.107135 (no previous merge yet)
[S15] round=36 local utility u=0.911124 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9987453671848627, 'loss_val': 0.020113310251492152, 'psi': 0.9977684989908052}-{'f1_val': 0.7605901908221343, 'auprc': 0.9924118524654645, 'loss_val': 0.40419812894108287, 'psi': 0.8533188554794664}
[S16] START round=36 head_norm_before_train=1.358129 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8436808347814508, 'auprc': 0.987789737883523, 'loss_val': 0.6523023940789467, 'psi': 0.9013243960222797}-{'f1_val': 0.9827215740636395, 'auprc': 0.9876450721648867, 'loss_val': 0.20098346283412652, 'psi': 0.9846909733041385}
[S17] START round=36 head_norm_before_train=1.945565 (no previous merge yet)
[S17] round=36 local utility u=0.036281 metrics={'f1_val': 0.633079225659575, 'auprc': 0.856209474830486, 'loss_val': 1.0772111481725346, 'psi': 0.7223313253279393}-{'f1_val': 0.6208290316831957, 'auprc': 0.8589197070494626, 'loss_val': 1.084402146143181, 'psi': 0.7160653018297025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S6] → sending delta(kind=head bytes=1810) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:50303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:50316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:50313
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1810 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S14
[S13] cosine check vs S14: cos=0.9987
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.9863
[S3] RECEIVED delta(kind=head bytes=1808) from S5
[S3] cosine check vs S5: cos=0.7336
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.5456
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.0123
[S7] RECEIVED delta(kind=head bytes=1810) from S6
[S7] cosine check vs S6: cos=0.4141
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=0.7693
[S16] RECEIVED delta(kind=head bytes=1806) from S8
[S16] cosine check vs S8: cos=0.9347
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9990
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.7443 head_norm=1.754102
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.189686e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.8935 head_norm=1.200352 delta_norm=0.918969
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9932 head_norm=1.300544
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.547934e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9932 head_norm=1.347008 delta_norm=0.754793
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.9604 head_norm=1.579055
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.321409e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.9612 head_norm=1.540869 delta_norm=0.132141
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9927 head_norm=1.513295
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.798777e-02
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9932 head_norm=1.490830 delta_norm=0.087988
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6147 head_norm=1.961418
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.978283e-02
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6144 head_norm=1.967088 delta_norm=0.049783
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8437 head_norm=1.388320
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.466515e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8439 head_norm=1.322341 delta_norm=0.246652
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9970 head_norm=1.973997
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.473916e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9970 head_norm=1.964400 delta_norm=0.044739
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.762175 cos_to_last_merge=0.8048 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=37 local utility u=0.008925 metrics={'f1_val': 0.7267251681400886, 'auprc': 0.7593901906433881, 'loss_val': 0.7938492147049677, 'psi': 0.7397911771414083}-{'f1_val': 0.7225107488945979, 'auprc': 0.7922021376860425, 'loss_val': 0.8848484618434385, 'psi': 0.7503873044111757}
[S3] START round=37 head_norm_before_train=1.490830 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8970901324293564, 'auprc': 0.975389259588145, 'loss_val': 0.22421164518684983, 'psi': 0.9284097832928719}-{'f1_val': 0.9927455214567068, 'auprc': 0.9972216077052714, 'loss_val': 0.09253855103303399, 'psi': 0.9945359559561326}
[S4] START round=37 head_norm_before_train=1.391570 cos_to_last_merge=0.9996 (last merge round=35)
[S4] round=37 local utility u=0.051516 metrics={'f1_val': 0.9419560072973607, 'auprc': 0.9689755081201191, 'loss_val': 0.3293722304215998, 'psi': 0.9527638076264642}-{'f1_val': 0.9402654015382713, 'auprc': 0.9367336941251714, 'loss_val': 0.32553474029876645, 'psi': 0.9388527185730313}
[S5] START round=37 head_norm_before_train=1.736460 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.43385906248970074, 'auprc': 0.7621207517838426, 'loss_val': 0.8402159760807458, 'psi': 0.5651637382073575}-{'f1_val': 0.7008686948557086, 'auprc': 0.9895317694173855, 'loss_val': 0.22829549266852098, 'psi': 0.8163339246803794}
[S6] START round=37 head_norm_before_train=1.540869 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7880100523416981, 'auprc': 0.8986124608273082, 'loss_val': 0.532573094592883, 'psi': 0.8322510157359422}-{'f1_val': 0.9604375437099987, 'auprc': 0.9732407355675237, 'loss_val': 0.28680241263437467, 'psi': 0.9655588204530087}
[S7] START round=37 head_norm_before_train=1.200352 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6520352031786165, 'auprc': 0.8107558842910251, 'loss_val': 0.6238309838114858, 'psi': 0.71552347562358}-{'f1_val': 0.7443497484385373, 'auprc': 0.8818447926913915, 'loss_val': 0.3669738141311666, 'psi': 0.799347766139679}
[S8] START round=37 head_norm_before_train=1.347008 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9864436062227302, 'auprc': 0.9996815225847676, 'loss_val': 0.25653832338932053, 'psi': 0.9917387727675452}-{'f1_val': 0.9931548986711313, 'auprc': 0.9837501050107592, 'loss_val': 0.15511262980386634, 'psi': 0.9893929812069824}
[S9] START round=37 head_norm_before_train=2.148974 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9997338609551804, 'loss_val': 0.019011630138411312, 'psi': 0.9972393797125809}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998035318408374, 'loss_val': 0.017280179154397477, 'psi': 0.9979177198246698}
[S10] START round=37 head_norm_before_train=2.162280 cos_to_last_merge=0.9998 (last merge round=35)
[S10] round=37 local utility u=0.003739 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9970194474471756, 'loss_val': 0.0432520385386149, 'psi': 0.995920482390495}-{'f1_val': 0.9951878390193748, 'auprc': 0.9967478611612355, 'loss_val': 0.049915935509467976, 'psi': 0.9958118478761191}
[S11] START round=37 head_norm_before_train=2.121478 (no previous merge yet)
[S11] round=37 local utility u=0.052493 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9987723922371389, 'loss_val': 0.020520121530831124, 'psi': 0.9974517057621303}-{'f1_val': 0.9853789917439917, 'auprc': 0.999090993709409, 'loss_val': 0.059307994870949815, 'psi': 0.9908637925301587}
[S13] START round=37 head_norm_before_train=1.967088 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.110521 metrics={'f1_val': 0.6275411471132062, 'auprc': 0.7194250021867499, 'loss_val': 0.8116393147932864, 'psi': 0.6642946891426236}-{'f1_val': 0.6147163417264996, 'auprc': 0.7103403696458163, 'loss_val': 0.9284794824357391, 'psi': 0.6529659528942262}
[S14] START round=37 head_norm_before_train=1.964400 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.001317 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9990972650522935, 'loss_val': 0.03670778099592464, 'psi': 0.9979850430783408}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990851726154139, 'loss_val': 0.03784760232171505, 'psi': 0.9978344969747122}
[S15] START round=37 head_norm_before_train=2.117247 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9987041515788515, 'loss_val': 0.025062978790631296, 'psi': 0.9977520127484008}-{'f1_val': 0.9971172535281002, 'auprc': 0.9987453671848627, 'loss_val': 0.020113310251492152, 'psi': 0.9977684989908052}
[S16] START round=37 head_norm_before_train=1.322341 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.425771 metrics={'f1_val': 0.925444651625628, 'auprc': 0.9934140281172424, 'loss_val': 0.30821520559844057, 'psi': 0.9526324022222739}-{'f1_val': 0.8436808347814508, 'auprc': 0.987789737883523, 'loss_val': 0.6523023940789467, 'psi': 0.9013243960222797}
[S17] START round=37 head_norm_before_train=1.955780 (no previous merge yet)
[S17] round=37 local utility u=0.156113 metrics={'f1_val': 0.6552063889644606, 'auprc': 0.875342142167278, 'loss_val': 0.9551462100736062, 'psi': 0.7432606902455876}-{'f1_val': 0.633079225659575, 'auprc': 0.856209474830486, 'loss_val': 1.0772111481725346, 'psi': 0.7223313253279393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:50309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.7003
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=0.9969
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.7735
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.8075
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:50304
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9992
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:50314
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] cosine check vs S2: cos=0.9979
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9884
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9993
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.4339 head_norm=1.747528
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.927770e-02
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.4412 head_norm=1.761347 delta_norm=0.059278
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9420 head_norm=1.420206
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.110729e-01
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9420 head_norm=1.380898 delta_norm=0.111073
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.9952 head_norm=2.186195
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.947671e-02
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.9952 head_norm=2.156797 delta_norm=0.089477
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9864 head_norm=1.383454
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.428998e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9857 head_norm=1.292565 delta_norm=0.542900
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6520 head_norm=1.233208
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.296227e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6558 head_norm=1.617954 delta_norm=0.729623
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6275 head_norm=1.978183
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.090214e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6288 head_norm=1.980632 delta_norm=0.040902
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9972 head_norm=1.983921
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.709684e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9972 head_norm=1.974475 delta_norm=0.037097
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9254 head_norm=1.349610
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.964627e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9152 head_norm=1.584790 delta_norm=0.596463
[S16] aggregate: ROLLBACK (f1_val pre=0.925 post=0.915 tol_abs=0.005 tol_rel=0.0)
[S2] START round=38 head_norm_before_train=1.777037 cos_to_last_merge=0.8030 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=38 local utility u=0.096091 metrics={'f1_val': 0.7220404806750418, 'auprc': 0.8030977590002152, 'loss_val': 0.704681291017832, 'psi': 0.7544633920051111}-{'f1_val': 0.7267251681400886, 'auprc': 0.7593901906433881, 'loss_val': 0.7938492147049677, 'psi': 0.7397911771414083}
[S3] START round=38 head_norm_before_train=1.534957 cos_to_last_merge=0.9990 (last merge round=36)
[S3] round=38 local utility u=0.218051 metrics={'f1_val': 0.9486745244411668, 'auprc': 0.9864944049376314, 'loss_val': 0.13093103864626637, 'psi': 0.9638024766397527}-{'f1_val': 0.8970901324293564, 'auprc': 0.975389259588145, 'loss_val': 0.22421164518684983, 'psi': 0.9284097832928719}
[S4] START round=38 head_norm_before_train=1.380898 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9414626146197189, 'auprc': 0.9436210983997401, 'loss_val': 0.29551000900281377, 'psi': 0.9423260081317274}-{'f1_val': 0.9419560072973607, 'auprc': 0.9689755081201191, 'loss_val': 0.3293722304215998, 'psi': 0.9527638076264642}
[S5] START round=38 head_norm_before_train=1.761347 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9402897354799644, 'loss_val': 0.33961865299995464, 'psi': 0.7965080849194413}-{'f1_val': 0.43385906248970074, 'auprc': 0.7621207517838426, 'loss_val': 0.8402159760807458, 'psi': 0.5651637382073575}
[S6] START round=38 head_norm_before_train=1.553023 cos_to_last_merge=0.9997 (last merge round=36)
[S6] round=38 local utility u=0.059088 metrics={'f1_val': 0.7867429889270801, 'auprc': 0.9318280721228609, 'loss_val': 0.5064419677132161, 'psi': 0.8447770222053924}-{'f1_val': 0.7880100523416981, 'auprc': 0.8986124608273082, 'loss_val': 0.532573094592883, 'psi': 0.8322510157359422}
[S7] START round=38 head_norm_before_train=1.617954 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5977836348259025, 'auprc': 0.7940746278524606, 'loss_val': 0.7853516233476089, 'psi': 0.6763000320365258}-{'f1_val': 0.6520352031786165, 'auprc': 0.8107558842910251, 'loss_val': 0.6238309838114858, 'psi': 0.71552347562358}
[S8] START round=38 head_norm_before_train=1.292565 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.067137 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9991419166576763, 'loss_val': 0.1463295656520686, 'psi': 0.9940914062679094}-{'f1_val': 0.9864436062227302, 'auprc': 0.9996815225847676, 'loss_val': 0.25653832338932053, 'psi': 0.9917387727675452}
[S9] START round=38 head_norm_before_train=2.153668 (no previous merge yet)
[S9] round=38 local utility u=0.003489 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99945878641735, 'loss_val': 0.017713451443226468, 'psi': 0.9977798216552749}-{'f1_val': 0.9955763922175147, 'auprc': 0.9997338609551804, 'loss_val': 0.019011630138411312, 'psi': 0.9972393797125809}
[S10] START round=38 head_norm_before_train=2.156797 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969812300822845, 'loss_val': 0.04600249361660587, 'psi': 0.9959051954445386}-{'f1_val': 0.9951878390193748, 'auprc': 0.9970194474471756, 'loss_val': 0.0432520385386149, 'psi': 0.995920482390495}
[S11] START round=38 head_norm_before_train=2.130753 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9981680327652059, 'loss_val': 0.02402496593849404, 'psi': 0.9972099619733571}-{'f1_val': 0.9965712481121245, 'auprc': 0.9987723922371389, 'loss_val': 0.020520121530831124, 'psi': 0.9974517057621303}
[S13] START round=38 head_norm_before_train=1.980632 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5965389688556665, 'auprc': 0.7171385432051787, 'loss_val': 0.9245647932525249, 'psi': 0.6447787985954714}-{'f1_val': 0.6275411471132062, 'auprc': 0.7194250021867499, 'loss_val': 0.8116393147932864, 'psi': 0.6642946891426236}
[S14] START round=38 head_norm_before_train=1.974475 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.996971921494445, 'loss_val': 0.03880724806285088, 'psi': 0.9968414875899968}-{'f1_val': 0.9972435617623723, 'auprc': 0.9990972650522935, 'loss_val': 0.03670778099592464, 'psi': 0.9979850430783408}
[S15] START round=38 head_norm_before_train=2.125389 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7074984470222931, 'auprc': 0.9901225547814018, 'loss_val': 0.3206071727698056, 'psi': 0.8205480901259365}-{'f1_val': 0.9971172535281002, 'auprc': 0.9987041515788515, 'loss_val': 0.025062978790631296, 'psi': 0.9977520127484008}
[S16] START round=38 head_norm_before_train=1.584790 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.162437 metrics={'f1_val': 0.9547336422649517, 'auprc': 0.9932032823352727, 'loss_val': 0.15844324707987337, 'psi': 0.97012149829308}-{'f1_val': 0.925444651625628, 'auprc': 0.9934140281172424, 'loss_val': 0.30821520559844057, 'psi': 0.9526324022222739}
[S17] START round=38 head_norm_before_train=1.965683 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6062851159587986, 'auprc': 0.8110397598528413, 'loss_val': 1.2897228014244793, 'psi': 0.6881869735164157}-{'f1_val': 0.6552063889644606, 'auprc': 0.875342142167278, 'loss_val': 0.9551462100736062, 'psi': 0.7432606902455876}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:50305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S2@127.0.0.1:50302
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:50303
[S6] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1808) from S5
[S2] cosine check vs S5: cos=0.9989
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.6700
[S5] RECEIVED delta(kind=head bytes=1806) from S3
[S5] cosine check vs S3: cos=0.7022
[S3] RECEIVED delta(kind=head bytes=1806) from S6
[S3] cosine check vs S6: cos=0.9937
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] cosine check vs S16: cos=0.8100
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.5978 head_norm=1.646097
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.224361e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.5902 head_norm=1.365829 delta_norm=0.622436
[S7] aggregate: ROLLBACK (f1_val pre=0.598 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.7220 head_norm=1.793213
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.320363e-02
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.7223 head_norm=1.781012 delta_norm=0.043204
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9487 head_norm=1.585973
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.923006e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9500 head_norm=1.576600 delta_norm=0.089230
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9907 head_norm=1.340223
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.729080e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9896 head_norm=1.404685 delta_norm=0.472908
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.7007 head_norm=1.769783
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.530044e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.7007 head_norm=1.548324 delta_norm=0.653004
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.781012 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.455519524837864, 'auprc': 0.6973975038568945, 'loss_val': 1.2969471733106162, 'psi': 0.5522707164454762}-{'f1_val': 0.7220404806750418, 'auprc': 0.8030977590002152, 'loss_val': 0.704681291017832, 'psi': 0.7544633920051111}
[S3] START round=39 head_norm_before_train=1.576600 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.033813 metrics={'f1_val': 0.953986891469977, 'auprc': 0.9934412180117931, 'loss_val': 0.11602018303464198, 'psi': 0.9697686220867034}-{'f1_val': 0.9486745244411668, 'auprc': 0.9864944049376314, 'loss_val': 0.13093103864626637, 'psi': 0.9638024766397527}
[S4] START round=39 head_norm_before_train=1.404288 cos_to_last_merge=0.9997 (last merge round=37)
[S4] round=39 local utility u=0.051346 metrics={'f1_val': 0.950934816519918, 'auprc': 0.9510353422139596, 'loss_val': 0.27189301570495167, 'psi': 0.9509750267975345}-{'f1_val': 0.9414626146197189, 'auprc': 0.9436210983997401, 'loss_val': 0.29551000900281377, 'psi': 0.9423260081317274}
[S5] START round=39 head_norm_before_train=1.548324 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6630183600923153, 'auprc': 0.8787072267152546, 'loss_val': 0.3999214788038803, 'psi': 0.749293906741491}-{'f1_val': 0.7006536512124258, 'auprc': 0.9402897354799644, 'loss_val': 0.33961865299995464, 'psi': 0.7965080849194413}
[S6] START round=39 head_norm_before_train=1.572243 cos_to_last_merge=0.9985 (last merge round=36)
[S6] round=39 local utility u=0.364874 metrics={'f1_val': 0.8588804861799958, 'auprc': 0.9673872581717105, 'loss_val': 0.3161968700622005, 'psi': 0.9022831949766816}-{'f1_val': 0.7867429889270801, 'auprc': 0.9318280721228609, 'loss_val': 0.5064419677132161, 'psi': 0.8447770222053924}
[S7] START round=39 head_norm_before_train=1.365829 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5543215292194553, 'auprc': 0.7783139611150885, 'loss_val': 0.893951177249368, 'psi': 0.6439185019777086}-{'f1_val': 0.5977836348259025, 'auprc': 0.7940746278524606, 'loss_val': 0.7853516233476089, 'psi': 0.6763000320365258}
[S8] START round=39 head_norm_before_train=1.404685 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9816827445838038, 'loss_val': 0.15127029017840501, 'psi': 0.9881959325828227}-{'f1_val': 0.9907243993413981, 'auprc': 0.9991419166576763, 'loss_val': 0.1463295656520686, 'psi': 0.9940914062679094}
[S9] START round=39 head_norm_before_train=2.156852 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9999304796775556, 'loss_val': 0.020123416688727264, 'psi': 0.9968362462675682}-{'f1_val': 0.9966605118138915, 'auprc': 0.99945878641735, 'loss_val': 0.017713451443226468, 'psi': 0.9977798216552749}
[S10] START round=39 head_norm_before_train=2.178977 cos_to_last_merge=0.9999 (last merge round=37)
[S10] round=39 local utility u=0.002060 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969367544085459, 'loss_val': 0.04174959878658657, 'psi': 0.9958874051750433}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969812300822845, 'loss_val': 0.04600249361660587, 'psi': 0.9959051954445386}
[S11] START round=39 head_norm_before_train=2.140270 (no previous merge yet)
[S11] round=39 local utility u=0.003560 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990222453091298, 'loss_val': 0.019467612644615842, 'psi': 0.9975516469909267}-{'f1_val': 0.9965712481121245, 'auprc': 0.9981680327652059, 'loss_val': 0.02402496593849404, 'psi': 0.9972099619733571}
[S13] START round=39 head_norm_before_train=1.993010 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=39 local utility u=0.084663 metrics={'f1_val': 0.6214623522887504, 'auprc': 0.7273185278113368, 'loss_val': 0.9353195042098468, 'psi': 0.6638048224977849}-{'f1_val': 0.5965389688556665, 'auprc': 0.7171385432051787, 'loss_val': 0.9245647932525249, 'psi': 0.6447787985954714}
[S14] START round=39 head_norm_before_train=1.988819 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=39 local utility u=0.001329 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9969782652812312, 'loss_val': 0.036187821342281816, 'psi': 0.9968459481386589}-{'f1_val': 0.996754531653698, 'auprc': 0.996971921494445, 'loss_val': 0.03880724806285088, 'psi': 0.9968414875899968}
[S15] START round=39 head_norm_before_train=2.132937 (no previous merge yet)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9974005142255595, 'auprc': 0.9975058454281791, 'loss_val': 0.019663977760748345, 'psi': 0.9974426467066073}-{'f1_val': 0.7074984470222931, 'auprc': 0.9901225547814018, 'loss_val': 0.3206071727698056, 'psi': 0.8205480901259365}
[S16] START round=39 head_norm_before_train=1.611635 cos_to_last_merge=0.9998 (last merge round=37)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8810938552364784, 'auprc': 0.9889292792411363, 'loss_val': 0.4656096741161949, 'psi': 0.9242280248383415}-{'f1_val': 0.9547336422649517, 'auprc': 0.9932032823352727, 'loss_val': 0.15844324707987337, 'psi': 0.97012149829308}
[S17] START round=39 head_norm_before_train=1.972226 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5489928583471473, 'auprc': 0.7856042761265838, 'loss_val': 1.5544210600636243, 'psi': 0.6436374254589219}-{'f1_val': 0.6062851159587986, 'auprc': 0.8110397598528413, 'loss_val': 1.2897228014244793, 'psi': 0.6881869735164157}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:50314
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:50317
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:50303
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] cosine check vs S4: cos=0.9378
[S14] RECEIVED delta(kind=head bytes=1796) from S13
[S14] cosine check vs S13: cos=0.9991
[S11] RECEIVED delta(kind=head bytes=1802) from S10
[S11] cosine check vs S10: cos=0.9975
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.9990
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=0.9014
[S3] RECEIVED delta(kind=head bytes=1802) from S6
[S3] cosine check vs S6: cos=0.9960
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.997 u=1.0000 p_local=0.3303 f1=0.997 auprc=0.998 bytes=32409
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9966 head_norm=2.149620
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.063047e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9966 head_norm=2.172658 delta_norm=0.080630
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.998 u=0.0036 p_local=0.0105 f1=0.997 auprc=0.999 bytes=39607
[S2] r=40 psi=0.552 u=0.0000 p_local=0.1166 f1=0.456 auprc=0.697 bytes=32412
[S7] r=40 psi=0.644 u=0.0000 p_local=0.1756 f1=0.554 auprc=0.778 bytes=26968
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.6630 head_norm=1.559920
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.543216e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.6687 head_norm=1.550478 delta_norm=0.354322
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.749 u=0.0000 p_local=0.3423 f1=0.663 auprc=0.879 bytes=30631
[S8] r=40 psi=0.988 u=0.0000 p_local=0.0392 f1=0.993 auprc=0.982 bytes=32362
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0030 f1=0.995 auprc=1.000 bytes=34126
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.8811 head_norm=1.635898
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.881787e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.8869 head_norm=1.511543 delta_norm=0.288179
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.924 u=0.0000 p_local=0.1749 f1=0.881 auprc=0.989 bytes=32369
[S13] r=40 psi=0.664 u=0.0847 p_local=0.0525 f1=0.621 auprc=0.727 bytes=32356
[S6] r=40 psi=0.902 u=0.3649 p_local=0.2985 f1=0.859 auprc=0.967 bytes=32378
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9968 head_norm=2.002773
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.173933e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9968 head_norm=2.003221 delta_norm=0.041739
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.997 u=0.0013 p_local=0.0057 f1=0.997 auprc=0.997 bytes=34135
[S4] r=40 psi=0.951 u=0.0513 p_local=0.0232 f1=0.951 auprc=0.951 bytes=32346
[S10] r=40 psi=0.996 u=0.0021 p_local=0.0049 f1=0.995 auprc=0.997 bytes=34197
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9540 head_norm=1.620401
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.283688e-02
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9552 head_norm=1.607033 delta_norm=0.072837
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.970 u=0.0338 p_local=0.1377 f1=0.954 auprc=0.993 bytes=32374
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.5490 head_norm=1.982484
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.591553e-02
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.5510 head_norm=1.992125 delta_norm=0.045916
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.644 u=0.0000 p_local=0.0605 f1=0.549 auprc=0.786 bytes=28761
[S2] START round=40 head_norm_before_train=1.794489 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=40 local utility u=1.000000 metrics={'f1_val': 0.7179065194494307, 'auprc': 0.80540353025889, 'loss_val': 0.5820697779875502, 'psi': 0.7529053237732144}-{'f1_val': 0.455519524837864, 'auprc': 0.6973975038568945, 'loss_val': 1.2969471733106162, 'psi': 0.5522707164454762}
[S3] START round=40 head_norm_before_train=1.607033 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8029491720330583, 'auprc': 0.9651696628185127, 'loss_val': 0.4393515365896388, 'psi': 0.86783736834724}-{'f1_val': 0.953986891469977, 'auprc': 0.9934412180117931, 'loss_val': 0.11602018303464198, 'psi': 0.9697686220867034}
[S4] START round=40 head_norm_before_train=1.435081 cos_to_last_merge=0.9987 (last merge round=37)
[S4] round=40 local utility u=0.008221 metrics={'f1_val': 0.9533755844347843, 'auprc': 0.9492840575999367, 'loss_val': 0.26484176229946776, 'psi': 0.9517389737008453}-{'f1_val': 0.950934816519918, 'auprc': 0.9510353422139596, 'loss_val': 0.27189301570495167, 'psi': 0.9509750267975345}
[S5] START round=40 head_norm_before_train=1.550478 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6215377910794215, 'auprc': 0.9267623638281549, 'loss_val': 0.416164679088439, 'psi': 0.7436276201789149}-{'f1_val': 0.6630183600923153, 'auprc': 0.8787072267152546, 'loss_val': 0.3999214788038803, 'psi': 0.749293906741491}
[S6] START round=40 head_norm_before_train=1.596878 cos_to_last_merge=0.9964 (last merge round=36)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.81374540427442, 'auprc': 0.9470482980188945, 'loss_val': 0.4527942627825308, 'psi': 0.8670665617722098}-{'f1_val': 0.8588804861799958, 'auprc': 0.9673872581717105, 'loss_val': 0.3161968700622005, 'psi': 0.9022831949766816}
[S7] START round=40 head_norm_before_train=1.392878 cos_to_last_merge=0.9994 (last merge round=38)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5527238631802253, 'auprc': 0.7802171440053094, 'loss_val': 0.9891403424104113, 'psi': 0.643721175510259}-{'f1_val': 0.5543215292194553, 'auprc': 0.7783139611150885, 'loss_val': 0.893951177249368, 'psi': 0.6439185019777086}
[S8] START round=40 head_norm_before_train=1.448761 cos_to_last_merge=0.9986 (last merge round=38)
[S8] round=40 local utility u=0.033400 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9940877211108814, 'loss_val': 0.11297365472588333, 'psi': 0.9922867180897934}-{'f1_val': 0.9925380579155019, 'auprc': 0.9816827445838038, 'loss_val': 0.15127029017840501, 'psi': 0.9881959325828227}
[S9] START round=40 head_norm_before_train=2.161938 (no previous merge yet)
[S9] round=40 local utility u=0.004278 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.999939522363106, 'loss_val': 0.01811516859022217, 'psi': 0.9974918914710357}-{'f1_val': 0.9947734239942433, 'auprc': 0.9999304796775556, 'loss_val': 0.020123416688727264, 'psi': 0.9968362462675682}
[S10] START round=40 head_norm_before_train=2.198414 cos_to_last_merge=0.9995 (last merge round=37)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947590783550317, 'loss_val': 0.04027333852997821, 'psi': 0.9950163347536376}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969367544085459, 'loss_val': 0.04174959878658657, 'psi': 0.9958874051750433}
[S11] START round=40 head_norm_before_train=2.172658 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000057 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989124464712831, 'loss_val': 0.019023911997746563, 'psi': 0.997507727455788}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990222453091298, 'loss_val': 0.019467612644615842, 'psi': 0.9975516469909267}
[S13] START round=40 head_norm_before_train=2.004538 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=40 local utility u=0.010270 metrics={'f1_val': 0.6204906900390058, 'auprc': 0.7178171540834329, 'loss_val': 0.8804459951923614, 'psi': 0.6594212756567767}-{'f1_val': 0.6214623522887504, 'auprc': 0.7273185278113368, 'loss_val': 0.9353195042098468, 'psi': 0.6638048224977849}
[S14] START round=40 head_norm_before_train=2.003221 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.007297 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991392290653609, 'loss_val': 0.031996785855527454, 'psi': 0.9981022881868413}-{'f1_val': 0.9967577367102773, 'auprc': 0.9969782652812312, 'loss_val': 0.036187821342281816, 'psi': 0.9968459481386589}
[S15] START round=40 head_norm_before_train=2.135596 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9990748194651398, 'loss_val': 0.0336908706528102, 'psi': 0.9981586841906513}-{'f1_val': 0.9974005142255595, 'auprc': 0.9975058454281791, 'loss_val': 0.019663977760748345, 'psi': 0.9974426467066073}
[S16] START round=40 head_norm_before_train=1.511543 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.202424 metrics={'f1_val': 0.9250688541617623, 'auprc': 0.9892684509700992, 'loss_val': 0.32562965847206643, 'psi': 0.950748692885097}-{'f1_val': 0.8810938552364784, 'auprc': 0.9889292792411363, 'loss_val': 0.4656096741161949, 'psi': 0.9242280248383415}
[S17] START round=40 head_norm_before_train=1.992125 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.168408 metrics={'f1_val': 0.6010271697711987, 'auprc': 0.780549794463222, 'loss_val': 1.514646788487296, 'psi': 0.6728362196480081}-{'f1_val': 0.5489928583471473, 'auprc': 0.7856042761265838, 'loss_val': 1.5544210600636243, 'psi': 0.6436374254589219}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:50317
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:50309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S14
[S17] cosine check vs S14: cos=0.9990
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] cosine check vs S4: cos=0.9803
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.7274
[S8] RECEIVED delta(kind=head bytes=1804) from S16
[S8] cosine check vs S16: cos=0.9802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1787 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1787) from S13
[S14] cosine check vs S13: cos=0.9996
[S10] ⇄ pheromone p=0.004 → S11@127.0.0.1:50312
[S6] ⇄ pheromone p=0.239 → S3@127.0.0.1:50303
[S3] ⇄ pheromone p=0.110 → S5@127.0.0.1:50305
[S5] ⇄ pheromone p=0.274 → S2@127.0.0.1:50302
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.5527 head_norm=1.416554
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.383315e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.5519 head_norm=1.352331 delta_norm=0.538332
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.140 → S6@127.0.0.1:50307
[S4] ⇄ pheromone p=0.020 → S16@127.0.0.1:50316
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9911 head_norm=1.493511
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.518585e-01
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9911 head_norm=1.506465 delta_norm=0.151858
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.038 → S7@127.0.0.1:50308
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9974 head_norm=2.018363
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.872400e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9974 head_norm=2.015441 delta_norm=0.028724
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.006 → S17@127.0.0.1:50317
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6010 head_norm=2.003755
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.582793e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6026 head_norm=2.010550 delta_norm=0.045828
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.082 → S14@127.0.0.1:50314
[S13] ⇄ pheromone p=0.044 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9251 head_norm=1.534413
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.531051e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9272 head_norm=1.489856 delta_norm=0.153105
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.180 → S8@127.0.0.1:50309
[S2] START round=41 head_norm_before_train=1.803476 cos_to_last_merge=0.9999 (last merge round=38)
[S2] round=41 local utility u=0.360877 metrics={'f1_val': 0.8103076789976308, 'auprc': 0.8370859728514533, 'loss_val': 0.5097699969885384, 'psi': 0.8210189965391598}-{'f1_val': 0.7179065194494307, 'auprc': 0.80540353025889, 'loss_val': 0.5820697779875502, 'psi': 0.7529053237732144}
[S3] START round=41 head_norm_before_train=1.639652 cos_to_last_merge=0.9998 (last merge round=39)
[S3] round=41 local utility u=0.531594 metrics={'f1_val': 0.9240454429287811, 'auprc': 0.9834192004612433, 'loss_val': 0.15748887984889612, 'psi': 0.947794945941766}-{'f1_val': 0.8029491720330583, 'auprc': 0.9651696628185127, 'loss_val': 0.4393515365896388, 'psi': 0.86783736834724}
[S4] START round=41 head_norm_before_train=1.460068 cos_to_last_merge=0.9974 (last merge round=37)
[S4] round=41 local utility u=0.003098 metrics={'f1_val': 0.9478154677083719, 'auprc': 0.9629331554022469, 'loss_val': 0.2662331861696542, 'psi': 0.9538625427859219}-{'f1_val': 0.9533755844347843, 'auprc': 0.9492840575999367, 'loss_val': 0.26484176229946776, 'psi': 0.9517389737008453}
[S5] START round=41 head_norm_before_train=1.575061 cos_to_last_merge=0.9994 (last merge round=39)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.6676593541454052, 'auprc': 0.8009431318877553, 'loss_val': 0.4453737920161995, 'psi': 0.7209728652423453}-{'f1_val': 0.6215377910794215, 'auprc': 0.9267623638281549, 'loss_val': 0.416164679088439, 'psi': 0.7436276201789149}
[S6] START round=41 head_norm_before_train=1.626688 cos_to_last_merge=0.9934 (last merge round=36)
[S6] round=41 local utility u=0.155099 metrics={'f1_val': 0.8373821952422952, 'auprc': 0.9605929816977885, 'loss_val': 0.3250519026070789, 'psi': 0.8866665098244926}-{'f1_val': 0.81374540427442, 'auprc': 0.9470482980188945, 'loss_val': 0.4527942627825308, 'psi': 0.8670665617722098}
[S7] START round=41 head_norm_before_train=1.352331 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.514539 metrics={'f1_val': 0.6474415685867554, 'auprc': 0.807949900782927, 'loss_val': 0.6115658691314731, 'psi': 0.7116449014652241}-{'f1_val': 0.5527238631802253, 'auprc': 0.7802171440053094, 'loss_val': 0.9891403424104113, 'psi': 0.643721175510259}
[S8] START round=41 head_norm_before_train=1.506465 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.000152 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9875570898638368, 'loss_val': 0.10397543898308205, 'psi': 0.9907642895047204}-{'f1_val': 0.9910860494090681, 'auprc': 0.9940877211108814, 'loss_val': 0.11297365472588333, 'psi': 0.9922867180897934}
[S9] START round=41 head_norm_before_train=2.167500 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9998982184016899, 'loss_val': 0.027042316452404697, 'psi': 0.9945616900328893}-{'f1_val': 0.9958601375429889, 'auprc': 0.999939522363106, 'loss_val': 0.01811516859022217, 'psi': 0.9974918914710357}
[S10] START round=41 head_norm_before_train=2.216523 cos_to_last_merge=0.9990 (last merge round=37)
[S10] round=41 local utility u=0.007130 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9974052782193512, 'loss_val': 0.0347632359601501, 'psi': 0.9961559836259787}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947590783550317, 'loss_val': 0.04027333852997821, 'psi': 0.9950163347536376}
[S11] START round=41 head_norm_before_train=2.179917 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9977701661509787, 'loss_val': 0.01920507254722061, 'psi': 0.9970508153276663}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989124464712831, 'loss_val': 0.019023911997746563, 'psi': 0.997507727455788}
[S13] START round=41 head_norm_before_train=2.012925 cos_to_last_merge=0.9996 (last merge round=37)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5896053660833523, 'auprc': 0.7366759002627232, 'loss_val': 1.0278873617446962, 'psi': 0.6484335797551006}-{'f1_val': 0.6204906900390058, 'auprc': 0.7178171540834329, 'loss_val': 0.8804459951923614, 'psi': 0.6594212756567767}
[S14] START round=41 head_norm_before_train=2.015441 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.000080 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.999224993574438, 'loss_val': 0.03207862502215184, 'psi': 0.9981349591308105}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991392290653609, 'loss_val': 0.031996785855527454, 'psi': 0.9981022881868413}
[S15] START round=41 head_norm_before_train=2.139170 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9013069076647195, 'auprc': 0.9971622822271071, 'loss_val': 0.29403522780652946, 'psi': 0.9396490574896745}-{'f1_val': 0.9975479273409924, 'auprc': 0.9990748194651398, 'loss_val': 0.0336908706528102, 'psi': 0.9981586841906513}
[S16] START round=41 head_norm_before_train=1.489856 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.325139 metrics={'f1_val': 0.9896078415739858, 'auprc': 0.9956848188092261, 'loss_val': 0.08183494355592047, 'psi': 0.9920386324680819}-{'f1_val': 0.9250688541617623, 'auprc': 0.9892684509700992, 'loss_val': 0.32562965847206643, 'psi': 0.950748692885097}
[S17] START round=41 head_norm_before_train=2.010550 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.465308 metrics={'f1_val': 0.636534568829776, 'auprc': 0.8781989464136584, 'loss_val': 1.0900217727873365, 'psi': 0.733200319863329}-{'f1_val': 0.6010271697711987, 'auprc': 0.780549794463222, 'loss_val': 1.514646788487296, 'psi': 0.6728362196480081}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:50312
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:50317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:50307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S10
[S11] cosine check vs S10: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] cosine check vs S14: cos=0.9992
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.9960
[S3] RECEIVED delta(kind=head bytes=1796) from S6
[S3] cosine check vs S6: cos=0.9946
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.9936
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.9946
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.3452
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:50305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1808) from S2
[S5] cosine check vs S2: cos=0.8324
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.9992
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.9960
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9240 head_norm=1.668553
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.647663e-02
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9270 head_norm=1.662484 delta_norm=0.086477
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9966 head_norm=2.187197
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.813756e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9966 head_norm=2.209324 delta_norm=0.068138
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.6677 head_norm=1.604551
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.048223e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.6680 head_norm=1.636420 delta_norm=0.504822
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9929 head_norm=1.546028
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.061510e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9929 head_norm=1.526396 delta_norm=0.070615
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.8374 head_norm=1.660901
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.409453e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.8370 head_norm=1.401714 delta_norm=0.440945
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9974 head_norm=2.030543
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.968029e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9974 head_norm=2.025348 delta_norm=0.039680
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6365 head_norm=2.020919
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.968028e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6388 head_norm=2.025348 delta_norm=0.039680
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9896 head_norm=1.509814
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.392612e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9898 head_norm=1.508947 delta_norm=0.053926
[S16] aggregate: ACCEPT kept=['S8', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.814070 cos_to_last_merge=0.9999 (last merge round=38)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7222856152375121, 'auprc': 0.7847322321428103, 'loss_val': 0.880197156096937, 'psi': 0.7472642619996314}-{'f1_val': 0.8103076789976308, 'auprc': 0.8370859728514533, 'loss_val': 0.5097699969885384, 'psi': 0.8210189965391598}
[S3] START round=42 head_norm_before_train=1.662484 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.272595 metrics={'f1_val': 0.990757327329802, 'auprc': 0.9973521661995168, 'loss_val': 0.05436823240324406, 'psi': 0.993395262877688}-{'f1_val': 0.9240454429287811, 'auprc': 0.9834192004612433, 'loss_val': 0.15748887984889612, 'psi': 0.947794945941766}
[S4] START round=42 head_norm_before_train=1.482006 cos_to_last_merge=0.9961 (last merge round=37)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.941199093279516, 'auprc': 0.9409597421153747, 'loss_val': 0.2789807186903028, 'psi': 0.9411033528138595}-{'f1_val': 0.9478154677083719, 'auprc': 0.9629331554022469, 'loss_val': 0.2662331861696542, 'psi': 0.9538625427859219}
[S5] START round=42 head_norm_before_train=1.636420 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.5678014162315184, 'auprc': 0.8027425207672232, 'loss_val': 0.6456848572271228, 'psi': 0.6617778580458002}-{'f1_val': 0.6676593541454052, 'auprc': 0.8009431318877553, 'loss_val': 0.4453737920161995, 'psi': 0.7209728652423453}
[S6] START round=42 head_norm_before_train=1.401714 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.46776254812854967, 'auprc': 0.7735792267076083, 'loss_val': 0.8336628012240087, 'psi': 0.5900892195601731}-{'f1_val': 0.8373821952422952, 'auprc': 0.9605929816977885, 'loss_val': 0.3250519026070789, 'psi': 0.8866665098244926}
[S7] START round=42 head_norm_before_train=1.368167 cos_to_last_merge=0.9996 (last merge round=40)
[S7] round=42 local utility u=0.864374 metrics={'f1_val': 0.7857619190355678, 'auprc': 0.9983955194936073, 'loss_val': 0.28407583771056466, 'psi': 0.8708153592187835}-{'f1_val': 0.6474415685867554, 'auprc': 0.807949900782927, 'loss_val': 0.6115658691314731, 'psi': 0.7116449014652241}
[S8] START round=42 head_norm_before_train=1.526396 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.013191 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9987705198350522, 'loss_val': 0.09383587425794927, 'psi': 0.9935098321968032}-{'f1_val': 0.9929024225986427, 'auprc': 0.9875570898638368, 'loss_val': 0.10397543898308205, 'psi': 0.9907642895047204}
[S9] START round=42 head_norm_before_train=2.173009 (no previous merge yet)
[S9] round=42 local utility u=0.017497 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9998222401376365, 'loss_val': 0.019255229807553776, 'psi': 0.9972747313855634}-{'f1_val': 0.9910040044536889, 'auprc': 0.9998982184016899, 'loss_val': 0.027042316452404697, 'psi': 0.9945616900328893}
[S10] START round=42 head_norm_before_train=2.233311 cos_to_last_merge=0.9985 (last merge round=37)
[S10] round=42 local utility u=0.000613 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997234541301302, 'loss_val': 0.033026009610917735, 'psi': 0.996087688858759}-{'f1_val': 0.9953231205637304, 'auprc': 0.9974052782193512, 'loss_val': 0.0347632359601501, 'psi': 0.9961559836259787}
[S11] START round=42 head_norm_before_train=2.209324 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9920141937413387, 'auprc': 0.9990871523330087, 'loss_val': 0.026652008780830808, 'psi': 0.9948433771780067}-{'f1_val': 0.9965712481121245, 'auprc': 0.9977701661509787, 'loss_val': 0.01920507254722061, 'psi': 0.9970508153276663}
[S13] START round=42 head_norm_before_train=2.019546 cos_to_last_merge=0.9995 (last merge round=37)
[S13] round=42 local utility u=0.385185 metrics={'f1_val': 0.6836536806526788, 'auprc': 0.7443391859206654, 'loss_val': 0.8447967365769111, 'psi': 0.7079278827598734}-{'f1_val': 0.5896053660833523, 'auprc': 0.7366759002627232, 'loss_val': 1.0278873617446962, 'psi': 0.6484335797551006}
[S14] START round=42 head_norm_before_train=2.025348 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.001347 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991196925620673, 'loss_val': 0.029084852796127186, 'psi': 0.9980944735855238}-{'f1_val': 0.9974082695017256, 'auprc': 0.999224993574438, 'loss_val': 0.03207862502215184, 'psi': 0.9981349591308105}
[S15] START round=42 head_norm_before_train=2.145580 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8810692545565351, 'auprc': 0.997120358113659, 'loss_val': 0.2512636190492209, 'psi': 0.9274896959793846}-{'f1_val': 0.9013069076647195, 'auprc': 0.9971622822271071, 'loss_val': 0.29403522780652946, 'psi': 0.9396490574896745}
[S16] START round=42 head_norm_before_train=1.508947 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9545877380118005, 'auprc': 0.9954879426398504, 'loss_val': 0.14244263480454908, 'psi': 0.9709478198630205}-{'f1_val': 0.9896078415739858, 'auprc': 0.9956848188092261, 'loss_val': 0.08183494355592047, 'psi': 0.9920386324680819}
[S17] START round=42 head_norm_before_train=2.025348 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.044182 metrics={'f1_val': 0.6531985450917184, 'auprc': 0.8799798273627732, 'loss_val': 1.106984955867371, 'psi': 0.7439110580001403}-{'f1_val': 0.636534568829776, 'auprc': 0.8781989464136584, 'loss_val': 1.0900217727873365, 'psi': 0.733200319863329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.9739
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:50312
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.5473
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=0.9993
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:50317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:50314
[S14] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S13
[S14] cosine check vs S13: cos=0.9993
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.9988
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9999
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.6532 head_norm=2.034805
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.362861e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.6537 head_norm=2.038016 delta_norm=0.013629
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9974 head_norm=2.041312
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.151103e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9974 head_norm=2.035737 delta_norm=0.021511
[S14] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9920 head_norm=2.216009
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.544492e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9920 head_norm=2.232030 delta_norm=0.045445
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.4678 head_norm=1.434493
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.298669e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.4633 head_norm=1.331238 delta_norm=0.229867
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9546 head_norm=1.528525
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.186119e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9550 head_norm=1.545713 delta_norm=0.041861
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.828219 cos_to_last_merge=0.9998 (last merge round=38)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7237568946199175, 'auprc': 0.7767889689430062, 'loss_val': 0.932288697844641, 'psi': 0.7449697243491531}-{'f1_val': 0.7222856152375121, 'auprc': 0.7847322321428103, 'loss_val': 0.880197156096937, 'psi': 0.7472642619996314}
[S3] START round=43 head_norm_before_train=1.685054 cos_to_last_merge=0.9999 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8014810190481306, 'auprc': 0.9458543886492502, 'loss_val': 0.4780290111790661, 'psi': 0.8592303668885785}-{'f1_val': 0.990757327329802, 'auprc': 0.9973521661995168, 'loss_val': 0.05436823240324406, 'psi': 0.993395262877688}
[S4] START round=43 head_norm_before_train=1.504527 cos_to_last_merge=0.9945 (last merge round=37)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9397290873230627, 'auprc': 0.933609896767726, 'loss_val': 0.28407702087285924, 'psi': 0.937281411100928}-{'f1_val': 0.941199093279516, 'auprc': 0.9409597421153747, 'loss_val': 0.2789807186903028, 'psi': 0.9411033528138595}
[S5] START round=43 head_norm_before_train=1.661114 cos_to_last_merge=0.9998 (last merge round=41)
[S5] round=43 local utility u=1.000000 metrics={'f1_val': 0.9299725894277939, 'auprc': 0.991962896747215, 'loss_val': 0.16283269267439898, 'psi': 0.9547687123555624}-{'f1_val': 0.5678014162315184, 'auprc': 0.8027425207672232, 'loss_val': 0.6456848572271228, 'psi': 0.6617778580458002}
[S6] START round=43 head_norm_before_train=1.331238 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8274944128029842, 'auprc': 0.9539350576978504, 'loss_val': 0.436713285932823, 'psi': 0.8780706707609307}-{'f1_val': 0.46776254812854967, 'auprc': 0.7735792267076083, 'loss_val': 0.8336628012240087, 'psi': 0.5900892195601731}
[S7] START round=43 head_norm_before_train=1.381705 cos_to_last_merge=0.9990 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6373808055374651, 'auprc': 0.80159082246259, 'loss_val': 0.5974654098730862, 'psi': 0.7030648123075152}-{'f1_val': 0.7857619190355678, 'auprc': 0.9983955194936073, 'loss_val': 0.28407583771056466, 'psi': 0.8708153592187835}
[S8] START round=43 head_norm_before_train=1.563833 cos_to_last_merge=0.9994 (last merge round=41)
[S8] round=43 local utility u=0.005245 metrics={'f1_val': 0.9936527300581187, 'auprc': 0.9915167811583151, 'loss_val': 0.08348465546740308, 'psi': 0.9927983504981972}-{'f1_val': 0.9900027071046373, 'auprc': 0.9987705198350522, 'loss_val': 0.09383587425794927, 'psi': 0.9935098321968032}
[S9] START round=43 head_norm_before_train=2.181290 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9996590651094425, 'loss_val': 0.018814132938060862, 'psi': 0.9972121639523737}-{'f1_val': 0.9955763922175147, 'auprc': 0.9998222401376365, 'loss_val': 0.019255229807553776, 'psi': 0.9972747313855634}
[S10] START round=43 head_norm_before_train=2.248855 cos_to_last_merge=0.9980 (last merge round=37)
[S10] round=43 local utility u=0.001456 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975595064760256, 'loss_val': 0.031089066655660507, 'psi': 0.9962176749286484}-{'f1_val': 0.9953231205637304, 'auprc': 0.997234541301302, 'loss_val': 0.033026009610917735, 'psi': 0.996087688858759}
[S11] START round=43 head_norm_before_train=2.232030 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.017961 metrics={'f1_val': 0.9965718709689133, 'auprc': 0.9990792297435991, 'loss_val': 0.01805159530901866, 'psi': 0.9975748144787876}-{'f1_val': 0.9920141937413387, 'auprc': 0.9990871523330087, 'loss_val': 0.026652008780830808, 'psi': 0.9948433771780067}
[S13] START round=43 head_norm_before_train=2.026783 cos_to_last_merge=0.9993 (last merge round=37)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6429902530096031, 'auprc': 0.7383427544543332, 'loss_val': 0.8195734096302877, 'psi': 0.6811312535874952}-{'f1_val': 0.6836536806526788, 'auprc': 0.7443391859206654, 'loss_val': 0.8447967365769111, 'psi': 0.7079278827598734}
[S14] START round=43 head_norm_before_train=2.035737 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.001796 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992289268923117, 'loss_val': 0.027146749063259257, 'psi': 0.9982707547308505}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991196925620673, 'loss_val': 0.029084852796127186, 'psi': 0.9980944735855238}
[S15] START round=43 head_norm_before_train=2.153648 (no previous merge yet)
[S15] round=43 local utility u=0.129260 metrics={'f1_val': 0.9046110573901857, 'auprc': 0.9979236507855944, 'loss_val': 0.13640397649026234, 'psi': 0.941936094748349}-{'f1_val': 0.8810692545565351, 'auprc': 0.997120358113659, 'loss_val': 0.2512636190492209, 'psi': 0.9274896959793846}
[S16] START round=43 head_norm_before_train=1.545713 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8762107520830693, 'auprc': 0.9877924348954179, 'loss_val': 0.4938285299920866, 'psi': 0.9208434252080087}-{'f1_val': 0.9545877380118005, 'auprc': 0.9954879426398504, 'loss_val': 0.14244263480454908, 'psi': 0.9709478198630205}
[S17] START round=43 head_norm_before_train=2.038016 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.116497 metrics={'f1_val': 0.6714066113510623, 'auprc': 0.8834031585581912, 'loss_val': 0.9935083629184118, 'psi': 0.7562052302339138}-{'f1_val': 0.6531985450917184, 'auprc': 0.8799798273627732, 'loss_val': 1.106984955867371, 'psi': 0.7439110580001403}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:50317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:50302
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1799) from S6
[S3] cosine check vs S6: cos=0.9336
[S2] RECEIVED delta(kind=head bytes=1805) from S5
[S2] cosine check vs S5: cos=0.9611
[S11] RECEIVED delta(kind=head bytes=1800) from S10
[S11] cosine check vs S10: cos=0.9996
[S17] RECEIVED delta(kind=head bytes=1789) from S14
[S17] cosine check vs S14: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9987
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.7238 head_norm=1.841020
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.584351e-01
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.7238 head_norm=1.742098 delta_norm=0.258435
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.8015 head_norm=1.699076
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.248778e-01
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.7932 head_norm=1.504010 delta_norm=0.324878
[S3] aggregate: ROLLBACK (f1_val pre=0.801 post=0.793 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9966 head_norm=2.238493
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.276113e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9963 head_norm=2.250626 delta_norm=0.032761
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.9953 head_norm=2.263168
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.276113e-02
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.9953 head_norm=2.250626 delta_norm=0.032761
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.8762 head_norm=1.564255
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.322251e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.8758 head_norm=1.580368 delta_norm=0.043223
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6714 head_norm=2.048080
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.654515e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6726 head_norm=2.047890 delta_norm=0.016545
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=43 metric=0.9976 head_norm=2.047834
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.654516e-02
[S14] stored merged vector for next round verification (round=43)
[S14] DEBUG after merge:  round=43 metric=0.9976 head_norm=2.047890 delta_norm=0.016545
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.742098 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.044702 metrics={'f1_val': 0.7235316139205841, 'auprc': 0.78199650180646, 'loss_val': 0.8571547295162454, 'psi': 0.7469175690749345}-{'f1_val': 0.7237568946199175, 'auprc': 0.7767889689430062, 'loss_val': 0.932288697844641, 'psi': 0.7449697243491531}
[S3] START round=44 head_norm_before_train=1.504010 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.831723 metrics={'f1_val': 0.9852454023881507, 'auprc': 0.9978713777505572, 'loss_val': 0.07322102470394695, 'psi': 0.9902957925331133}-{'f1_val': 0.8014810190481306, 'auprc': 0.9458543886492502, 'loss_val': 0.4780290111790661, 'psi': 0.8592303668885785}
[S4] START round=44 head_norm_before_train=1.529139 cos_to_last_merge=0.9927 (last merge round=37)
[S4] round=44 local utility u=0.090553 metrics={'f1_val': 0.9484698534666417, 'auprc': 0.9686482207698563, 'loss_val': 0.260529674533179, 'psi': 0.9565412003879277}-{'f1_val': 0.9397290873230627, 'auprc': 0.933609896767726, 'loss_val': 0.28407702087285924, 'psi': 0.937281411100928}
[S5] START round=44 head_norm_before_train=1.677508 cos_to_last_merge=0.9993 (last merge round=41)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9856506422910765, 'loss_val': 0.3099473690082645, 'psi': 0.8147292636346684}-{'f1_val': 0.9299725894277939, 'auprc': 0.991962896747215, 'loss_val': 0.16283269267439898, 'psi': 0.9547687123555624}
[S6] START round=44 head_norm_before_train=1.359532 cos_to_last_merge=0.9995 (last merge round=42)
[S6] round=44 local utility u=0.238569 metrics={'f1_val': 0.874960476716335, 'auprc': 0.9673653912033688, 'loss_val': 0.28466337247279155, 'psi': 0.9119224425111485}-{'f1_val': 0.8274944128029842, 'auprc': 0.9539350576978504, 'loss_val': 0.436713285932823, 'psi': 0.8780706707609307}
[S7] START round=44 head_norm_before_train=1.394226 cos_to_last_merge=0.9979 (last merge round=40)
[S7] round=44 local utility u=0.189487 metrics={'f1_val': 0.6639010340526104, 'auprc': 0.8309980506963126, 'loss_val': 0.4658349660705324, 'psi': 0.7307398407100913}-{'f1_val': 0.6373808055374651, 'auprc': 0.80159082246259, 'loss_val': 0.5974654098730862, 'psi': 0.7030648123075152}
[S8] START round=44 head_norm_before_train=1.597488 cos_to_last_merge=0.9981 (last merge round=41)
[S8] round=44 local utility u=0.001234 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9976448543962666, 'loss_val': 0.07326488616510934, 'psi': 0.9926360729765222}-{'f1_val': 0.9936527300581187, 'auprc': 0.9915167811583151, 'loss_val': 0.08348465546740308, 'psi': 0.9927983504981972}
[S9] START round=44 head_norm_before_train=2.191159 (no previous merge yet)
[S9] round=44 local utility u=0.004198 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998966582901864, 'loss_val': 0.017608512069781198, 'psi': 0.9979549704044094}-{'f1_val': 0.9955808965143278, 'auprc': 0.9996590651094425, 'loss_val': 0.018814132938060862, 'psi': 0.9972121639523737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=44 head_norm_before_train=2.250626 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969389837549822, 'loss_val': 0.0320188501165366, 'psi': 0.9959694658402312}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975595064760256, 'loss_val': 0.031089066655660507, 'psi': 0.9962176749286484}
[S11] START round=44 head_norm_before_train=2.250626 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9970486630920883, 'loss_val': 0.01860191544467052, 'psi': 0.9967500182338936}-{'f1_val': 0.9965718709689133, 'auprc': 0.9990792297435991, 'loss_val': 0.01805159530901866, 'psi': 0.9975748144787876}
[S13] START round=44 head_norm_before_train=2.034127 cos_to_last_merge=0.9991 (last merge round=37)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6471380554226226, 'auprc': 0.7439476909179161, 'loss_val': 0.911908620358902, 'psi': 0.68586190962074}-{'f1_val': 0.6429902530096031, 'auprc': 0.7383427544543332, 'loss_val': 0.8195734096302877, 'psi': 0.6811312535874952}
[S14] START round=44 head_norm_before_train=2.047890 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991205720841221, 'loss_val': 0.02715631987268959, 'psi': 0.9980948253943458}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992289268923117, 'loss_val': 0.027146749063259257, 'psi': 0.9982707547308505}
[S15] START round=44 head_norm_before_train=2.162597 (no previous merge yet)
[S15] round=44 local utility u=0.318152 metrics={'f1_val': 0.9924454346774874, 'auprc': 0.9986856262137209, 'loss_val': 0.029392244238699617, 'psi': 0.9949415112919808}-{'f1_val': 0.9046110573901857, 'auprc': 0.9979236507855944, 'loss_val': 0.13640397649026234, 'psi': 0.941936094748349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=44 head_norm_before_train=1.580368 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.570498 metrics={'f1_val': 0.9914078877355929, 'auprc': 0.994230173591226, 'loss_val': 0.06332856722936513, 'psi': 0.9925368020778462}-{'f1_val': 0.8762107520830693, 'auprc': 0.9877924348954179, 'loss_val': 0.4938285299920866, 'psi': 0.9208434252080087}
[S17] START round=44 head_norm_before_train=2.047890 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6256014397065859, 'auprc': 0.8089338794091401, 'loss_val': 1.3596422969396857, 'psi': 0.6989344155876076}-{'f1_val': 0.6714066113510623, 'auprc': 0.8834031585581912, 'loss_val': 0.9935083629184118, 'psi': 0.7562052302339138}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] → sending delta(kind=head bytes=1809) to S5@127.0.0.1:50305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1809 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] cosine check vs S4: cos=0.9902
[S5] RECEIVED delta(kind=head bytes=1809) from S2
[S5] cosine check vs S2: cos=0.9886
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S3] RECEIVED delta(kind=head bytes=1801) from S6
[S3] cosine check vs S6: cos=0.9793
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.7008 head_norm=1.688833
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.342811e-01
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.7008 head_norm=1.717256 delta_norm=0.134281
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.9989
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.9793
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.9852 head_norm=1.524946
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.617848e-01
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.9845 head_norm=1.452791 delta_norm=0.161785
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.8750 head_norm=1.395740
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.617848e-01
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.9228 head_norm=1.452791 delta_norm=0.161785
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.9989
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9914 head_norm=1.597942
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.780568e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9910 head_norm=1.588535 delta_norm=0.057806
[S16] aggregate: ACCEPT kept=['S4', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] CommDone barrier timeout: have=1 need=2 — continuing
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9893 head_norm=1.621435
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.873209e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9893 head_norm=1.609265 delta_norm=0.038732
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:50307
[S7] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] cosine check vs S7: cos=0.5715
[S10]  timeout peer S11
[S16]  timeout peer S8
[S16]  timeout peer S13
[S3]  timeout peer S5
[S3]  timeout peer S9
[S8]  timeout peer S4
[S8]  timeout peer S7
[S4]  timeout peer S16
[S13]  timeout peer S14
[S5]  timeout peer S2
[S7]  timeout peer S6
[S7]  timeout peer S10
[S7]  timeout peer S15
[S6]  timeout peer S3
[S2] START round=45 head_norm_before_train=1.755517 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=45 local utility u=0.300203 metrics={'f1_val': 0.7520128719508703, 'auprc': 0.8179975378234428, 'loss_val': 0.5356398432433864, 'psi': 0.7784067382998993}-{'f1_val': 0.7235316139205841, 'auprc': 0.78199650180646, 'loss_val': 0.8571547295162454, 'psi': 0.7469175690749345}
[S3] START round=45 head_norm_before_train=1.452791 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9836759817379355, 'auprc': 0.9967085087731844, 'loss_val': 0.07668299450386627, 'psi': 0.988888992552035}-{'f1_val': 0.9852454023881507, 'auprc': 0.9978713777505572, 'loss_val': 0.07322102470394695, 'psi': 0.9902957925331133}
[S4] START round=45 head_norm_before_train=1.549715 cos_to_last_merge=0.9910 (last merge round=37)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9394011748606523, 'auprc': 0.9306582914816871, 'loss_val': 0.2943284148805736, 'psi': 0.9359040215090663}-{'f1_val': 0.9484698534666417, 'auprc': 0.9686482207698563, 'loss_val': 0.260529674533179, 'psi': 0.9565412003879277}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.717256 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.099350 metrics={'f1_val': 0.7764498824018594, 'auprc': 0.9442982891868997, 'loss_val': 0.4412001683444124, 'psi': 0.8435892451158755}-{'f1_val': 0.7007816778637295, 'auprc': 0.9856506422910765, 'loss_val': 0.3099473690082645, 'psi': 0.8147292636346684}
[S6] START round=45 head_norm_before_train=1.452791 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7496024242647649, 'auprc': 0.9517484493915743, 'loss_val': 0.5062846106965565, 'psi': 0.8304608343154887}-{'f1_val': 0.874960476716335, 'auprc': 0.9673653912033688, 'loss_val': 0.28466337247279155, 'psi': 0.9119224425111485}
[S7] START round=45 head_norm_before_train=1.413269 cos_to_last_merge=0.9963 (last merge round=40)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6153358676141916, 'auprc': 0.798872734888648, 'loss_val': 0.6808036075498192, 'psi': 0.6887506145239741}-{'f1_val': 0.6639010340526104, 'auprc': 0.8309980506963126, 'loss_val': 0.4658349660705324, 'psi': 0.7307398407100913}
[S8] START round=45 head_norm_before_train=1.609265 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.011140 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9963626542328035, 'loss_val': 0.06440266488894561, 'psi': 0.9938496059111884}-{'f1_val': 0.9892968853633592, 'auprc': 0.9976448543962666, 'loss_val': 0.07326488616510934, 'psi': 0.9926360729765222}
[S9] START round=45 head_norm_before_train=2.196396 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995982900576145, 'loss_val': 0.017427940307714402, 'psi': 0.9978356231113806}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998966582901864, 'loss_val': 0.017608512069781198, 'psi': 0.9979549704044094}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.261827 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=45 local utility u=0.000546 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969744616688977, 'loss_val': 0.03103277277969163, 'psi': 0.9959836570057973}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969389837549822, 'loss_val': 0.0320188501165366, 'psi': 0.9959694658402312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=45 head_norm_before_train=2.257231 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9647863684512241, 'auprc': 0.9994583030159088, 'loss_val': 0.11286973294593174, 'psi': 0.9786551422770979}-{'f1_val': 0.9965509216617638, 'auprc': 0.9970486630920883, 'loss_val': 0.01860191544467052, 'psi': 0.9967500182338936}
[S13] START round=45 head_norm_before_train=2.041042 cos_to_last_merge=0.9989 (last merge round=37)
[S13] round=45 local utility u=0.111131 metrics={'f1_val': 0.654713810076829, 'auprc': 0.7602754961462719, 'loss_val': 0.7840843296505324, 'psi': 0.6969384845046063}-{'f1_val': 0.6471380554226226, 'auprc': 0.7439476909179161, 'loss_val': 0.911908620358902, 'psi': 0.68586190962074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=45 head_norm_before_train=2.060749 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9991130795444927, 'loss_val': 0.02665110205719, 'psi': 0.9978456597463438}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991205720841221, 'loss_val': 0.02715631987268959, 'psi': 0.9980948253943458}
[S15] START round=45 head_norm_before_train=2.171649 (no previous merge yet)
[S15] round=45 local utility u=0.001085 metrics={'f1_val': 0.9946291607851364, 'auprc': 0.9994269252455281, 'loss_val': 0.0425475128510321, 'psi': 0.9965482665692931}-{'f1_val': 0.9924454346774874, 'auprc': 0.9986856262137209, 'loss_val': 0.029392244238699617, 'psi': 0.9949415112919808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=1.588535 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.006143 metrics={'f1_val': 0.9907075760323867, 'auprc': 0.9972118917078118, 'loss_val': 0.05578636443594933, 'psi': 0.9933093023025568}-{'f1_val': 0.9914078877355929, 'auprc': 0.994230173591226, 'loss_val': 0.06332856722936513, 'psi': 0.9925368020778462}
[S17] START round=45 head_norm_before_train=2.055635 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=45 local utility u=0.606819 metrics={'f1_val': 0.6864051518697495, 'auprc': 0.9052113767914575, 'loss_val': 0.7996590261398141, 'psi': 0.7739276418384327}-{'f1_val': 0.6256014397065859, 'auprc': 0.8089338794091401, 'loss_val': 1.3596422969396857, 'psi': 0.6989344155876076}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S2] sending update (kind=head size=1811 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.7496 head_norm=1.488989
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.782047e-01
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.6351 head_norm=1.283451 delta_norm=0.678205
[S6] aggregate: ROLLBACK (f1_val pre=0.750 post=0.635 tol_abs=0.005 tol_rel=0.0)
[S2] START round=46 head_norm_before_train=1.771361 cos_to_last_merge=0.9999 (last merge round=43)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7060974973746971, 'auprc': 0.8028905924821483, 'loss_val': 0.8291306176919703, 'psi': 0.7448147354176775}-{'f1_val': 0.7520128719508703, 'auprc': 0.8179975378234428, 'loss_val': 0.5356398432433864, 'psi': 0.7784067382998993}
[S3] START round=46 head_norm_before_train=1.497675 cos_to_last_merge=0.9995 (last merge round=44)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8793567143189117, 'auprc': 0.9669762689063509, 'loss_val': 0.29378234765191985, 'psi': 0.9144045361538874}-{'f1_val': 0.9836759817379355, 'auprc': 0.9967085087731844, 'loss_val': 0.07668299450386627, 'psi': 0.988888992552035}
[S4] START round=46 head_norm_before_train=1.563174 cos_to_last_merge=0.9899 (last merge round=37)
[S4] round=46 local utility u=0.058164 metrics={'f1_val': 0.9413197464928325, 'auprc': 0.9605563192967441, 'loss_val': 0.2792054989506117, 'psi': 0.9490143756143972}-{'f1_val': 0.9394011748606523, 'auprc': 0.9306582914816871, 'loss_val': 0.2943284148805736, 'psi': 0.9359040215090663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=46 head_norm_before_train=1.726019 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=46 local utility u=0.447592 metrics={'f1_val': 0.8542754571505956, 'auprc': 0.9913404711861633, 'loss_val': 0.15409541355534717, 'psi': 0.9091014627648227}-{'f1_val': 0.7764498824018594, 'auprc': 0.9442982891868997, 'loss_val': 0.4412001683444124, 'psi': 0.8435892451158755}
[S6] START round=46 head_norm_before_train=1.283451 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.274206 metrics={'f1_val': 0.8258665417881318, 'auprc': 0.9644801267767182, 'loss_val': 0.453652351649438, 'psi': 0.8813119757835663}-{'f1_val': 0.7496024242647649, 'auprc': 0.9517484493915743, 'loss_val': 0.5062846106965565, 'psi': 0.8304608343154887}
[S7] START round=46 head_norm_before_train=1.439484 cos_to_last_merge=0.9938 (last merge round=40)
[S7] round=46 local utility u=0.077661 metrics={'f1_val': 0.6311211012443815, 'auprc': 0.8030243039063446, 'loss_val': 0.6326480949278629, 'psi': 0.6998823823091667}-{'f1_val': 0.6153358676141916, 'auprc': 0.798872734888648, 'loss_val': 0.6808036075498192, 'psi': 0.6887506145239741}
[S8] START round=46 head_norm_before_train=1.627132 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.8771621607869678, 'auprc': 0.9898475146550922, 'loss_val': 0.16627041424921013, 'psi': 0.9222363023342176}-{'f1_val': 0.992174240363445, 'auprc': 0.9963626542328035, 'loss_val': 0.06440266488894561, 'psi': 0.9938496059111884}
[S9] START round=46 head_norm_before_train=2.204819 (no previous merge yet)
[S9] round=46 local utility u=0.000643 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998981112959541, 'loss_val': 0.017042050649346274, 'psi': 0.9979555516067165}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995982900576145, 'loss_val': 0.017427940307714402, 'psi': 0.9978356231113806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=46 head_norm_before_train=2.273393 cos_to_last_merge=0.9999 (last merge round=43)
[S10] round=46 local utility u=0.001401 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9974534294419746, 'loss_val': 0.029667140018276052, 'psi': 0.996175244115028}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969744616688977, 'loss_val': 0.03103277277969163, 'psi': 0.9959836570057973}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=46 head_norm_before_train=2.262861 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=46 local utility u=0.140334 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9978583630130909, 'loss_val': 0.01811130530034515, 'psi': 0.9970860940725111}-{'f1_val': 0.9647863684512241, 'auprc': 0.9994583030159088, 'loss_val': 0.11286973294593174, 'psi': 0.9786551422770979}
[S13] START round=46 head_norm_before_train=2.048306 cos_to_last_merge=0.9986 (last merge round=37)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.662574089737979, 'auprc': 0.7446894369614822, 'loss_val': 0.9797398222935837, 'psi': 0.6954202286273803}-{'f1_val': 0.654713810076829, 'auprc': 0.7602754961462719, 'loss_val': 0.7840843296505324, 'psi': 0.6969384845046063}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.071130 cos_to_last_merge=0.9999 (last merge round=43)
[S14] round=46 local utility u=0.000421 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9989937534330815, 'loss_val': 0.026455213693570036, 'psi': 0.9978983120315492}-{'f1_val': 0.9970007132142444, 'auprc': 0.9991130795444927, 'loss_val': 0.02665110205719, 'psi': 0.9978456597463438}
[S15] START round=46 head_norm_before_train=2.180208 (no previous merge yet)
[S15] round=46 local utility u=0.017106 metrics={'f1_val': 0.9974005142255595, 'auprc': 0.9988664172532494, 'loss_val': 0.02328170879877285, 'psi': 0.9979868754366354}-{'f1_val': 0.9946291607851364, 'auprc': 0.9994269252455281, 'loss_val': 0.0425475128510321, 'psi': 0.9965482665692931}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=46 head_norm_before_train=1.604393 cos_to_last_merge=0.9999 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9738760894513948, 'auprc': 0.9923441428239053, 'loss_val': 0.10038435589250509, 'psi': 0.981263310800399}-{'f1_val': 0.9907075760323867, 'auprc': 0.9972118917078118, 'loss_val': 0.05578636443594933, 'psi': 0.9933093023025568}
[S17] START round=46 head_norm_before_train=2.061041 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.646166690098398, 'auprc': 0.8925677952509354, 'loss_val': 0.9521673269999738, 'psi': 0.744727132159413}-{'f1_val': 0.6864051518697495, 'auprc': 0.9052113767914575, 'loss_val': 0.7996590261398141, 'psi': 0.7739276418384327}
[S5] not sending this round → trigger blocked (psi=0.909)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S7] sending update (kind=head size=1810 to 1 peers)
[S2] START round=47 head_norm_before_train=1.783871 cos_to_last_merge=0.9998 (last merge round=43)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7228235006232475, 'auprc': 0.7833345746925053, 'loss_val': 1.003313386691362, 'psi': 0.7470279302509506}-{'f1_val': 0.7060974973746971, 'auprc': 0.8028905924821483, 'loss_val': 0.8291306176919703, 'psi': 0.7448147354176775}
[S3] START round=47 head_norm_before_train=1.545405 cos_to_last_merge=0.9981 (last merge round=44)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8071464869001888, 'auprc': 0.9960019304991391, 'loss_val': 0.29235271764570586, 'psi': 0.8826886643397689}-{'f1_val': 0.8793567143189117, 'auprc': 0.9669762689063509, 'loss_val': 0.29378234765191985, 'psi': 0.9144045361538874}
[S4] START round=47 head_norm_before_train=1.577256 cos_to_last_merge=0.9887 (last merge round=37)
[S4] round=47 local utility u=0.018110 metrics={'f1_val': 0.944167177958505, 'auprc': 0.9650190983524263, 'loss_val': 0.2734586749807106, 'psi': 0.9525079461160735}-{'f1_val': 0.9413197464928325, 'auprc': 0.9605563192967441, 'loss_val': 0.2792054989506117, 'psi': 0.9490143756143972}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=47 head_norm_before_train=1.735774 cos_to_last_merge=0.9999 (last merge round=44)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6765610946074738, 'auprc': 0.9450563026903654, 'loss_val': 0.3435393910594777, 'psi': 0.7839591778406305}-{'f1_val': 0.8542754571505956, 'auprc': 0.9913404711861633, 'loss_val': 0.15409541355534717, 'psi': 0.9091014627648227}
[S6] START round=47 head_norm_before_train=1.318127 cos_to_last_merge=0.9989 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7979540729763677, 'auprc': 0.9510423702853321, 'loss_val': 0.46295984776343097, 'psi': 0.8591893918999534}-{'f1_val': 0.8258665417881318, 'auprc': 0.9644801267767182, 'loss_val': 0.453652351649438, 'psi': 0.8813119757835663}
[S7] START round=47 head_norm_before_train=1.463430 cos_to_last_merge=0.9913 (last merge round=40)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5199327933899139, 'auprc': 0.7778428374881938, 'loss_val': 1.1096580115343075, 'psi': 0.6230968110292259}-{'f1_val': 0.6311211012443815, 'auprc': 0.8030243039063446, 'loss_val': 0.6326480949278629, 'psi': 0.6998823823091667}
[S8] START round=47 head_norm_before_train=1.640931 cos_to_last_merge=0.9997 (last merge round=44)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.8534438302846747, 'auprc': 0.9991924229313841, 'loss_val': 0.27394279719656467, 'psi': 0.9117432673433585}-{'f1_val': 0.8771621607869678, 'auprc': 0.9898475146550922, 'loss_val': 0.16627041424921013, 'psi': 0.9222363023342176}
[S9] START round=47 head_norm_before_train=2.211126 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9999080622861578, 'loss_val': 0.020120026062935423, 'psi': 0.9972097176676}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998981112959541, 'loss_val': 0.017042050649346274, 'psi': 0.9979555516067165}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.284853 cos_to_last_merge=0.9998 (last merge round=43)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9967882670823163, 'loss_val': 0.02973694717252046, 'psi': 0.9958280102445514}-{'f1_val': 0.9953231205637304, 'auprc': 0.9974534294419746, 'loss_val': 0.029667140018276052, 'psi': 0.996175244115028}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.268611 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9969520758842118, 'loss_val': 0.018413800729954303, 'psi': 0.996711383350743}-{'f1_val': 0.9965712481121245, 'auprc': 0.9978583630130909, 'loss_val': 0.01811130530034515, 'psi': 0.9970860940725111}
[S13] START round=47 head_norm_before_train=2.054573 cos_to_last_merge=0.9984 (last merge round=37)
[S13] round=47 local utility u=0.019891 metrics={'f1_val': 0.6403252972593886, 'auprc': 0.7570934622909378, 'loss_val': 0.8436774439290282, 'psi': 0.6870325632720082}-{'f1_val': 0.662574089737979, 'auprc': 0.7446894369614822, 'loss_val': 0.9797398222935837, 'psi': 0.6954202286273803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=47 head_norm_before_train=2.081841 cos_to_last_merge=0.9999 (last merge round=43)
[S14] round=47 local utility u=0.000611 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9991149070043712, 'loss_val': 0.024593461100731517, 'psi': 0.9978463907302952}-{'f1_val': 0.9971680177638609, 'auprc': 0.9989937534330815, 'loss_val': 0.026455213693570036, 'psi': 0.9978983120315492}
[S15] START round=47 head_norm_before_train=2.188233 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.969413302994408, 'auprc': 0.9971983321247098, 'loss_val': 0.04977128748552076, 'psi': 0.9805273146465288}-{'f1_val': 0.9974005142255595, 'auprc': 0.9988664172532494, 'loss_val': 0.02328170879877285, 'psi': 0.9979868754366354}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.619462 cos_to_last_merge=0.9998 (last merge round=44)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9258450000167955, 'auprc': 0.9900328143898297, 'loss_val': 0.33050269740653615, 'psi': 0.9515201257660091}-{'f1_val': 0.9738760894513948, 'auprc': 0.9923441428239053, 'loss_val': 0.10038435589250509, 'psi': 0.981263310800399}
[S17] START round=47 head_norm_before_train=2.065790 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5718223810741967, 'auprc': 0.7439987100430346, 'loss_val': 1.7516543458746319, 'psi': 0.6406929126617319}-{'f1_val': 0.646166690098398, 'auprc': 0.8925677952509354, 'loss_val': 0.9521673269999738, 'psi': 0.744727132159413}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S2] START round=48 head_norm_before_train=1.796301 cos_to_last_merge=0.9997 (last merge round=43)
[S2] round=48 local utility u=0.104936 metrics={'f1_val': 0.7224904940642461, 'auprc': 0.7938726834133801, 'loss_val': 0.8230583482401014, 'psi': 0.7510433698038999}-{'f1_val': 0.7228235006232475, 'auprc': 0.7833345746925053, 'loss_val': 1.003313386691362, 'psi': 0.7470279302509506}
[S3] START round=48 head_norm_before_train=1.589507 cos_to_last_merge=0.9963 (last merge round=44)
[S3] round=48 local utility u=0.131840 metrics={'f1_val': 0.8714196806470493, 'auprc': 0.9658512634669929, 'loss_val': 0.3238588961459481, 'psi': 0.9091923137750267}-{'f1_val': 0.8071464869001888, 'auprc': 0.9960019304991391, 'loss_val': 0.29235271764570586, 'psi': 0.8826886643397689}
[S4] START round=48 head_norm_before_train=1.592941 cos_to_last_merge=0.9873 (last merge round=37)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9404156208145489, 'auprc': 0.9601697540691145, 'loss_val': 0.2845421842059799, 'psi': 0.9483172741163751}-{'f1_val': 0.944167177958505, 'auprc': 0.9650190983524263, 'loss_val': 0.2734586749807106, 'psi': 0.9525079461160735}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.748925 cos_to_last_merge=0.9996 (last merge round=44)
[S5] round=48 local utility u=0.329455 metrics={'f1_val': 0.7541975535018353, 'auprc': 0.976241320906405, 'loss_val': 0.24400408333429235, 'psi': 0.8430150604636633}-{'f1_val': 0.6765610946074738, 'auprc': 0.9450563026903654, 'loss_val': 0.3435393910594777, 'psi': 0.7839591778406305}
[S6] START round=48 head_norm_before_train=1.360073 cos_to_last_merge=0.9956 (last merge round=45)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.600460404840292, 'auprc': 0.8988222661931986, 'loss_val': 0.7376191558279577, 'psi': 0.7198051493814546}-{'f1_val': 0.7979540729763677, 'auprc': 0.9510423702853321, 'loss_val': 0.46295984776343097, 'psi': 0.8591893918999534}
[S7] START round=48 head_norm_before_train=1.477044 cos_to_last_merge=0.9896 (last merge round=40)
[S7] round=48 local utility u=0.687414 metrics={'f1_val': 0.6383954582876769, 'auprc': 0.8101956120140683, 'loss_val': 0.542664911345289, 'psi': 0.7071155197782335}-{'f1_val': 0.5199327933899139, 'auprc': 0.7778428374881938, 'loss_val': 1.1096580115343075, 'psi': 0.6230968110292259}
[S8] START round=48 head_norm_before_train=1.653390 cos_to_last_merge=0.9995 (last merge round=44)
[S8] round=48 local utility u=0.481174 metrics={'f1_val': 0.9856484573520051, 'auprc': 0.9945633024449523, 'loss_val': 0.09093556607288035, 'psi': 0.989214395389184}-{'f1_val': 0.8534438302846747, 'auprc': 0.9991924229313841, 'loss_val': 0.27394279719656467, 'psi': 0.9117432673433585}
[S9] START round=48 head_norm_before_train=2.221274 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9999066783743028, 'loss_val': 0.033925520382243744, 'psi': 0.9944374706339922}-{'f1_val': 0.9954108212552283, 'auprc': 0.9999080622861578, 'loss_val': 0.020120026062935423, 'psi': 0.9972097176676}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.294301 cos_to_last_merge=0.9997 (last merge round=43)
[S10] round=48 local utility u=0.000533 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9968859401379699, 'loss_val': 0.02896416973098719, 'psi': 0.9958670794668127}-{'f1_val': 0.9951878390193748, 'auprc': 0.9967882670823163, 'loss_val': 0.02973694717252046, 'psi': 0.9958280102445514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=48 head_norm_before_train=2.274333 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=48 local utility u=0.000840 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9974143923904861, 'loss_val': 0.018242837337248585, 'psi': 0.9969085058234692}-{'f1_val': 0.9965509216617638, 'auprc': 0.9969520758842118, 'loss_val': 0.018413800729954303, 'psi': 0.996711383350743}
[S13] START round=48 head_norm_before_train=2.061997 cos_to_last_merge=0.9981 (last merge round=37)
[S13] round=48 local utility u=0.297122 metrics={'f1_val': 0.6920827146588454, 'auprc': 0.7744147247856326, 'loss_val': 0.6119414097562937, 'psi': 0.7250155187095603}-{'f1_val': 0.6403252972593886, 'auprc': 0.7570934622909378, 'loss_val': 0.8436774439290282, 'psi': 0.6870325632720082}
[S13] not sending this round → trigger blocked (psi=0.725)
[S14] START round=48 head_norm_before_train=2.092880 cos_to_last_merge=0.9998 (last merge round=43)
[S14] round=48 local utility u=0.001213 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991214905578621, 'loss_val': 0.024633403405681605, 'psi': 0.9980935579241802}-{'f1_val': 0.9970007132142444, 'auprc': 0.9991149070043712, 'loss_val': 0.024593461100731517, 'psi': 0.9978463907302952}
[S15] START round=48 head_norm_before_train=2.196570 (no previous merge yet)
[S15] round=48 local utility u=0.100681 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9979291134642925, 'loss_val': 0.016301350142791084, 'psi': 0.9973896028367049}-{'f1_val': 0.969413302994408, 'auprc': 0.9971983321247098, 'loss_val': 0.04977128748552076, 'psi': 0.9805273146465288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=48 head_norm_before_train=1.633147 cos_to_last_merge=0.9996 (last merge round=44)
[S16] round=48 local utility u=0.310822 metrics={'f1_val': 0.9841643029542152, 'auprc': 0.9959897382794436, 'loss_val': 0.07664586751084745, 'psi': 0.9888944770843066}-{'f1_val': 0.9258450000167955, 'auprc': 0.9900328143898297, 'loss_val': 0.33050269740653615, 'psi': 0.9515201257660091}
[S17] START round=48 head_norm_before_train=2.069413 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=48 local utility u=0.075021 metrics={'f1_val': 0.5838982730778735, 'auprc': 0.7695594706613651, 'loss_val': 1.7507500565200091, 'psi': 0.6581627521112701}-{'f1_val': 0.5718223810741967, 'auprc': 0.7439987100430346, 'loss_val': 1.7516543458746319, 'psi': 0.6406929126617319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] START round=49 head_norm_before_train=1.808694 cos_to_last_merge=0.9996 (last merge round=43)
[S2] round=49 local utility u=0.082596 metrics={'f1_val': 0.7166813069694979, 'auprc': 0.8017898102971888, 'loss_val': 0.6467622020213455, 'psi': 0.7507247083005743}-{'f1_val': 0.7224904940642461, 'auprc': 0.7938726834133801, 'loss_val': 0.8230583482401014, 'psi': 0.7510433698038999}
[S3] START round=49 head_norm_before_train=1.626090 cos_to_last_merge=0.9946 (last merge round=44)
[S3] round=49 local utility u=0.392717 metrics={'f1_val': 0.9550055761317612, 'auprc': 0.9891653402347318, 'loss_val': 0.10988162322986768, 'psi': 0.9686694817729493}-{'f1_val': 0.8714196806470493, 'auprc': 0.9658512634669929, 'loss_val': 0.3238588961459481, 'psi': 0.9091923137750267}
[S4] START round=49 head_norm_before_train=1.608071 cos_to_last_merge=0.9859 (last merge round=37)
[S4] round=49 local utility u=0.046449 metrics={'f1_val': 0.9492478675347399, 'auprc': 0.967969868453519, 'loss_val': 0.26803828718393985, 'psi': 0.9567366679022515}-{'f1_val': 0.9404156208145489, 'auprc': 0.9601697540691145, 'loss_val': 0.2845421842059799, 'psi': 0.9483172741163751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=49 head_norm_before_train=1.763947 cos_to_last_merge=0.9991 (last merge round=44)
[S5] round=49 local utility u=0.015781 metrics={'f1_val': 0.7648994754184706, 'auprc': 0.9676261724474708, 'loss_val': 0.25080775338560746, 'psi': 0.8459901542300707}-{'f1_val': 0.7541975535018353, 'auprc': 0.976241320906405, 'loss_val': 0.24400408333429235, 'psi': 0.8430150604636633}
[S6] START round=49 head_norm_before_train=1.404384 cos_to_last_merge=0.9907 (last merge round=45)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.9859953807369986, 'auprc': 0.9765607683503237, 'loss_val': 0.13057707294228868, 'psi': 0.9822215357823285}-{'f1_val': 0.600460404840292, 'auprc': 0.8988222661931986, 'loss_val': 0.7376191558279577, 'psi': 0.7198051493814546}
[S7] START round=49 head_norm_before_train=1.483598 cos_to_last_merge=0.9887 (last merge round=40)
[S7] round=49 local utility u=0.251208 metrics={'f1_val': 0.6760297913804033, 'auprc': 0.8437728197970145, 'loss_val': 0.36678725994056804, 'psi': 0.7431270027470478}-{'f1_val': 0.6383954582876769, 'auprc': 0.8101956120140683, 'loss_val': 0.542664911345289, 'psi': 0.7071155197782335}
[S8] START round=49 head_norm_before_train=1.663158 cos_to_last_merge=0.9993 (last merge round=44)
[S8] round=49 local utility u=0.049742 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.998617591906483, 'loss_val': 0.053197526816319216, 'psi': 0.9957944016296012}-{'f1_val': 0.9856484573520051, 'auprc': 0.9945633024449523, 'loss_val': 0.09093556607288035, 'psi': 0.989214395389184}
[S9] START round=49 head_norm_before_train=2.225755 (no previous merge yet)
[S9] round=49 local utility u=0.017985 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999112339494818, 'loss_val': 0.02086234855036412, 'psi': 0.9967286833494142}-{'f1_val': 0.9907913321404518, 'auprc': 0.9999066783743028, 'loss_val': 0.033925520382243744, 'psi': 0.9944374706339922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=2.303394 cos_to_last_merge=0.9996 (last merge round=43)
[S10] round=49 local utility u=0.002202 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997603061109342, 'loss_val': 0.027523369842272938, 'psi': 0.9962350967819751}-{'f1_val': 0.9951878390193748, 'auprc': 0.9968859401379699, 'loss_val': 0.02896416973098719, 'psi': 0.9958670794668127}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=49 head_norm_before_train=2.280379 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=49 local utility u=0.000575 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9977277178683095, 'loss_val': 0.018033311145100785, 'psi': 0.9970338360145985}-{'f1_val': 0.9965712481121245, 'auprc': 0.9974143923904861, 'loss_val': 0.018242837337248585, 'psi': 0.9969085058234692}
[S13] START round=49 head_norm_before_train=2.069211 cos_to_last_merge=0.9979 (last merge round=37)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6629398208256523, 'auprc': 0.7480207308222457, 'loss_val': 0.7898755627946444, 'psi': 0.6969721848242896}-{'f1_val': 0.6920827146588454, 'auprc': 0.7744147247856326, 'loss_val': 0.6119414097562937, 'psi': 0.7250155187095603}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.103280 cos_to_last_merge=0.9996 (last merge round=43)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9919535831054036, 'auprc': 0.9990814834704996, 'loss_val': 0.04215712044502036, 'psi': 0.9948047432514421}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991214905578621, 'loss_val': 0.024633403405681605, 'psi': 0.9980935579241802}
[S15] START round=49 head_norm_before_train=2.204082 (no previous merge yet)
[S15] round=49 local utility u=0.000863 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9995001915370476, 'loss_val': 0.022395739430552866, 'psi': 0.9983288330194146}-{'f1_val': 0.9970299290849798, 'auprc': 0.9979291134642925, 'loss_val': 0.016301350142791084, 'psi': 0.9973896028367049}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=49 head_norm_before_train=1.645984 cos_to_last_merge=0.9994 (last merge round=44)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9179091110774378, 'auprc': 0.9924655655595277, 'loss_val': 0.36036655065675804, 'psi': 0.9477316928702737}-{'f1_val': 0.9841643029542152, 'auprc': 0.9959897382794436, 'loss_val': 0.07664586751084745, 'psi': 0.9888944770843066}
[S17] START round=49 head_norm_before_train=2.073273 cos_to_last_merge=0.9998 (last merge round=43)
[S17] round=49 local utility u=0.720429 metrics={'f1_val': 0.6406295253607798, 'auprc': 0.8996134892595626, 'loss_val': 1.0404412310361535, 'psi': 0.7442231109202929}-{'f1_val': 0.5838982730778735, 'auprc': 0.7695594706613651, 'loss_val': 1.7507500565200091, 'psi': 0.6581627521112701}
[S5] not sending this round → trigger blocked (psi=0.846)
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → trigger blocked (psi=0.969)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.743)
[S2] not sending this round → trigger blocked (psi=0.751)
[S17] not sending this round → trigger blocked (psi=0.744)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.823803 cos_to_last_merge=0.9993 (last merge round=43)
[S2] round=50 local utility u=0.012815 metrics={'f1_val': 0.7082956751932759, 'auprc': 0.8178301156595007, 'loss_val': 0.6189387788240877, 'psi': 0.7521094513797658}-{'f1_val': 0.7166813069694979, 'auprc': 0.8017898102971888, 'loss_val': 0.6467622020213455, 'psi': 0.7507247083005743}
[S3] START round=50 head_norm_before_train=1.654157 cos_to_last_merge=0.9932 (last merge round=44)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9255958368124146, 'auprc': 0.9701276352707039, 'loss_val': 0.22295505054748932, 'psi': 0.9434085561957303}-{'f1_val': 0.9550055761317612, 'auprc': 0.9891653402347318, 'loss_val': 0.10988162322986768, 'psi': 0.9686694817729493}
[S4] START round=50 head_norm_before_train=1.618870 cos_to_last_merge=0.9847 (last merge round=37)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9423360813941031, 'auprc': 0.9505105638344273, 'loss_val': 0.2808951605316223, 'psi': 0.9456058743702328}-{'f1_val': 0.9492478675347399, 'auprc': 0.967969868453519, 'loss_val': 0.26803828718393985, 'psi': 0.9567366679022515}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.777202 cos_to_last_merge=0.9987 (last merge round=44)
[S5] round=50 local utility u=0.286816 metrics={'f1_val': 0.8388026222600118, 'auprc': 0.987300169416946, 'loss_val': 0.1796160615109615, 'psi': 0.8982016411227856}-{'f1_val': 0.7648994754184706, 'auprc': 0.9676261724474708, 'loss_val': 0.25080775338560746, 'psi': 0.8459901542300707}
[S6] START round=50 head_norm_before_train=1.436338 cos_to_last_merge=0.9866 (last merge round=45)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.8207253436195878, 'auprc': 0.9396652840836455, 'loss_val': 0.4428486529887983, 'psi': 0.868301319805211}-{'f1_val': 0.9859953807369986, 'auprc': 0.9765607683503237, 'loss_val': 0.13057707294228868, 'psi': 0.9822215357823285}
[S7] START round=50 head_norm_before_train=1.488855 cos_to_last_merge=0.9878 (last merge round=40)
[S7] round=50 local utility u=0.345078 metrics={'f1_val': 0.6996583456524053, 'auprc': 0.98193849267729, 'loss_val': 0.2328997460559669, 'psi': 0.8125704044623592}-{'f1_val': 0.6760297913804033, 'auprc': 0.8437728197970145, 'loss_val': 0.36678725994056804, 'psi': 0.7431270027470478}
[S8] START round=50 head_norm_before_train=1.671509 cos_to_last_merge=0.9991 (last merge round=44)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9875097078386601, 'auprc': 0.9934698378883138, 'loss_val': 0.065494431773712, 'psi': 0.9898937598585216}-{'f1_val': 0.9939122747783468, 'auprc': 0.998617591906483, 'loss_val': 0.053197526816319216, 'psi': 0.9957944016296012}
[S9] START round=50 head_norm_before_train=2.229074 (no previous merge yet)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9947220065202225, 'loss_val': 0.018009717138499963, 'psi': 0.9956388594756556}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999112339494818, 'loss_val': 0.02086234855036412, 'psi': 0.9967286833494142}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.312804 cos_to_last_merge=0.9995 (last merge round=43)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995804637340397, 'loss_val': 0.02835798711427607, 'psi': 0.9954345583477837}-{'f1_val': 0.9953231205637304, 'auprc': 0.997603061109342, 'loss_val': 0.027523369842272938, 'psi': 0.9962350967819751}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=2.286741 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=50 local utility u=0.000990 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9983026085114834, 'loss_val': 0.017777279534036846, 'psi': 0.9972637922718681}-{'f1_val': 0.9965712481121245, 'auprc': 0.9977277178683095, 'loss_val': 0.018033311145100785, 'psi': 0.9970338360145985}
[S13] START round=50 head_norm_before_train=2.074903 cos_to_last_merge=0.9976 (last merge round=37)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6411495527814691, 'auprc': 0.7665938099561458, 'loss_val': 0.960851767043011, 'psi': 0.6913272556513399}-{'f1_val': 0.6629398208256523, 'auprc': 0.7480207308222457, 'loss_val': 0.7898755627946444, 'psi': 0.6969721848242896}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=2.112263 cos_to_last_merge=0.9995 (last merge round=43)
[S14] round=50 local utility u=0.024902 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990068388601019, 'loss_val': 0.02239292894292863, 'psi': 0.9978012404386398}-{'f1_val': 0.9919535831054036, 'auprc': 0.9990814834704996, 'loss_val': 0.04215712044502036, 'psi': 0.9948047432514421}
[S15] START round=50 head_norm_before_train=2.211549 (no previous merge yet)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987932573884403, 'loss_val': 0.01694731717825029, 'psi': 0.9975653039878885}-{'f1_val': 0.9975479273409924, 'auprc': 0.9995001915370476, 'loss_val': 0.022395739430552866, 'psi': 0.9983288330194146}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.657105 cos_to_last_merge=0.9992 (last merge round=44)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9172821305362645, 'auprc': 0.9919828577310122, 'loss_val': 0.3669370664115075, 'psi': 0.9471624214141636}-{'f1_val': 0.9179091110774378, 'auprc': 0.9924655655595277, 'loss_val': 0.36036655065675804, 'psi': 0.9477316928702737}
[S17] START round=50 head_norm_before_train=2.079554 cos_to_last_merge=0.9998 (last merge round=43)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6238942107065704, 'auprc': 0.8639602896931858, 'loss_val': 1.301409901711781, 'psi': 0.7199206423012166}-{'f1_val': 0.6406295253607798, 'auprc': 0.8996134892595626, 'loss_val': 1.0404412310361535, 'psi': 0.7442231109202929}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] sending update (kind=head size=1809 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.837728 cos_to_last_merge=0.9991 (last merge round=43)
[S2] round=51 local utility u=0.084258 metrics={'f1_val': 0.7093087271683097, 'auprc': 0.846431433757428, 'loss_val': 0.5423046819311135, 'psi': 0.764157809803957}-{'f1_val': 0.7082956751932759, 'auprc': 0.8178301156595007, 'loss_val': 0.6189387788240877, 'psi': 0.7521094513797658}
[S3] START round=51 head_norm_before_train=1.677903 cos_to_last_merge=0.9920 (last merge round=44)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.8750326689249008, 'auprc': 0.9990610427353199, 'loss_val': 0.19359467801163216, 'psi': 0.9246440184490685}-{'f1_val': 0.9255958368124146, 'auprc': 0.9701276352707039, 'loss_val': 0.22295505054748932, 'psi': 0.9434085561957303}
[S4] START round=51 head_norm_before_train=1.627693 cos_to_last_merge=0.9838 (last merge round=37)
[S4] round=51 local utility u=0.011298 metrics={'f1_val': 0.9460073847512891, 'auprc': 0.9496056836026718, 'loss_val': 0.2776130909224148, 'psi': 0.9474467042918422}-{'f1_val': 0.9423360813941031, 'auprc': 0.9505105638344273, 'loss_val': 0.2808951605316223, 'psi': 0.9456058743702328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=51 head_norm_before_train=1.789975 cos_to_last_merge=0.9981 (last merge round=44)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.7009056240671169, 'auprc': 0.9532606804795485, 'loss_val': 0.40841165648959776, 'psi': 0.8018476466320895}-{'f1_val': 0.8388026222600118, 'auprc': 0.987300169416946, 'loss_val': 0.1796160615109615, 'psi': 0.8982016411227856}
[S6] START round=51 head_norm_before_train=1.460972 cos_to_last_merge=0.9833 (last merge round=45)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.6718165159595124, 'auprc': 0.9407245644223675, 'loss_val': 0.6546024057159059, 'psi': 0.7793797353446545}-{'f1_val': 0.8207253436195878, 'auprc': 0.9396652840836455, 'loss_val': 0.4428486529887983, 'psi': 0.868301319805211}
[S7] START round=51 head_norm_before_train=1.498429 cos_to_last_merge=0.9867 (last merge round=40)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6510476376670299, 'auprc': 0.8004528682545508, 'loss_val': 0.5931688501115282, 'psi': 0.7108097299020383}-{'f1_val': 0.6996583456524053, 'auprc': 0.98193849267729, 'loss_val': 0.2328997460559669, 'psi': 0.8125704044623592}
[S8] START round=51 head_norm_before_train=1.681022 cos_to_last_merge=0.9988 (last merge round=44)
[S8] round=51 local utility u=0.024266 metrics={'f1_val': 0.9931151371785213, 'auprc': 0.9933958823941725, 'loss_val': 0.05037334962878533, 'psi': 0.9932274352647819}-{'f1_val': 0.9875097078386601, 'auprc': 0.9934698378883138, 'loss_val': 0.065494431773712, 'psi': 0.9898937598585216}
[S9] START round=51 head_norm_before_train=2.236896 (no previous merge yet)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9991559472393916, 'loss_val': 0.022612165861443444, 'psi': 0.9965088356655873}-{'f1_val': 0.9962500947792776, 'auprc': 0.9947220065202225, 'loss_val': 0.018009717138499963, 'psi': 0.9956388594756556}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=2.322131 cos_to_last_merge=0.9993 (last merge round=43)
[S10] round=51 local utility u=0.002049 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9968840039356097, 'loss_val': 0.027498713708971587, 'psi': 0.9958663049858687}-{'f1_val': 0.9951878390193748, 'auprc': 0.995804637340397, 'loss_val': 0.02835798711427607, 'psi': 0.9954345583477837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=51 head_norm_before_train=2.293016 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=51 local utility u=0.000924 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9987381124617696, 'loss_val': 0.017236137578645738, 'psi': 0.9974379938519826}-{'f1_val': 0.9965712481121245, 'auprc': 0.9983026085114834, 'loss_val': 0.017777279534036846, 'psi': 0.9972637922718681}
[S13] START round=51 head_norm_before_train=2.082069 cos_to_last_merge=0.9973 (last merge round=37)
[S13] round=51 local utility u=0.055700 metrics={'f1_val': 0.6522175110540297, 'auprc': 0.7408428171482287, 'loss_val': 0.8386062021715672, 'psi': 0.6876676334917093}-{'f1_val': 0.6411495527814691, 'auprc': 0.7665938099561458, 'loss_val': 0.960851767043011, 'psi': 0.6913272556513399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=51 head_norm_before_train=2.122042 cos_to_last_merge=0.9993 (last merge round=43)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9990025114720089, 'loss_val': 0.02388838503510046, 'psi': 0.99765564661497}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990068388601019, 'loss_val': 0.02239292894292863, 'psi': 0.9978012404386398}
[S15] START round=51 head_norm_before_train=2.218734 (no previous merge yet)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.9532040485296963, 'auprc': 0.9977836927726005, 'loss_val': 0.06279353381665762, 'psi': 0.971035906226858}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987932573884403, 'loss_val': 0.01694731717825029, 'psi': 0.9975653039878885}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.668304 cos_to_last_merge=0.9990 (last merge round=44)
[S16] round=51 local utility u=0.379743 metrics={'f1_val': 0.9893938359408495, 'auprc': 0.9974052885774347, 'loss_val': 0.056388538261784596, 'psi': 0.9925984169954836}-{'f1_val': 0.9172821305362645, 'auprc': 0.9919828577310122, 'loss_val': 0.3669370664115075, 'psi': 0.9471624214141636}
[S17] START round=51 head_norm_before_train=2.087908 cos_to_last_merge=0.9998 (last merge round=43)
[S17] round=51 local utility u=0.080981 metrics={'f1_val': 0.627370741492975, 'auprc': 0.880071623357657, 'loss_val': 1.2086404143918452, 'psi': 0.7284510942388478}-{'f1_val': 0.6238942107065704, 'auprc': 0.8639602896931858, 'loss_val': 1.301409901711781, 'psi': 0.7199206423012166}
[S11]  timeout peer S10
[S7]  timeout peer S8
[S3]  timeout peer S6
[S17]  timeout peer S14
[S5]  timeout peer S3
[S2]  timeout peer S5
[S8]  timeout peer S16
[S6]  timeout peer S7
[S16]  timeout peer S4
[S14]  timeout peer S13
[S14]  timeout peer S17
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.764)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.847436 cos_to_last_merge=0.9990 (last merge round=43)
[S2] round=52 local utility u=0.052051 metrics={'f1_val': 0.7080294889864958, 'auprc': 0.9024989478929495, 'loss_val': 0.5987301412064152, 'psi': 0.7858172725490773}-{'f1_val': 0.7093087271683097, 'auprc': 0.846431433757428, 'loss_val': 0.5423046819311135, 'psi': 0.764157809803957}
[S2] not sending this round → trigger blocked (psi=0.786)
[S3] START round=52 head_norm_before_train=1.696936 cos_to_last_merge=0.9910 (last merge round=44)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8915738423084264, 'auprc': 0.9694892897165787, 'loss_val': 0.26297825603405556, 'psi': 0.9227400212716872}-{'f1_val': 0.8750326689249008, 'auprc': 0.9990610427353199, 'loss_val': 0.19359467801163216, 'psi': 0.9246440184490685}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.635539 cos_to_last_merge=0.9829 (last merge round=37)
[S4] round=52 local utility u=0.039565 metrics={'f1_val': 0.9469053979580402, 'auprc': 0.9717790255508811, 'loss_val': 0.270390399373852, 'psi': 0.9568548489951766}-{'f1_val': 0.9460073847512891, 'auprc': 0.9496056836026718, 'loss_val': 0.2776130909224148, 'psi': 0.9474467042918422}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=52 head_norm_before_train=1.801060 cos_to_last_merge=0.9974 (last merge round=44)
[S5] round=52 local utility u=1.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.994961145024915, 'loss_val': 0.06266893443096032, 'psi': 0.9960481787910478}-{'f1_val': 0.7009056240671169, 'auprc': 0.9532606804795485, 'loss_val': 0.40841165648959776, 'psi': 0.8018476466320895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=52 head_norm_before_train=1.480823 cos_to_last_merge=0.9805 (last merge round=45)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6164772556812848, 'auprc': 0.8047678729453314, 'loss_val': 0.8124223168466909, 'psi': 0.6917935025869034}-{'f1_val': 0.6718165159595124, 'auprc': 0.9407245644223675, 'loss_val': 0.6546024057159059, 'psi': 0.7793797353446545}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.512113 cos_to_last_merge=0.9851 (last merge round=40)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6329248958101669, 'auprc': 0.8000764257875869, 'loss_val': 0.597844764092286, 'psi': 0.6997855078011349}-{'f1_val': 0.6510476376670299, 'auprc': 0.8004528682545508, 'loss_val': 0.5931688501115282, 'psi': 0.7108097299020383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.690756 cos_to_last_merge=0.9986 (last merge round=44)
[S8] round=52 local utility u=0.007391 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9959352296867244, 'loss_val': 0.0484705167930866, 'psi': 0.9947692336277978}-{'f1_val': 0.9931151371785213, 'auprc': 0.9933958823941725, 'loss_val': 0.05037334962878533, 'psi': 0.9932274352647819}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=52 head_norm_before_train=2.240087 (no previous merge yet)
[S9] round=52 local utility u=0.011482 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998827528304222, 'loss_val': 0.015981549470271684, 'psi': 0.9982148486394545}-{'f1_val': 0.9947440946163844, 'auprc': 0.9991559472393916, 'loss_val': 0.022612165861443444, 'psi': 0.9965088356655873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=52 head_norm_before_train=2.331168 cos_to_last_merge=0.9992 (last merge round=43)
[S10] round=52 local utility u=0.001707 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976106994006848, 'loss_val': 0.02626538193620481, 'psi': 0.9961569831718988}-{'f1_val': 0.9951878390193748, 'auprc': 0.9968840039356097, 'loss_val': 0.027498713708971587, 'psi': 0.9958663049858687}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=52 head_norm_before_train=2.299146 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.998336542166777, 'loss_val': 0.017431590197801407, 'psi': 0.9972773657339855}-{'f1_val': 0.9965712481121245, 'auprc': 0.9987381124617696, 'loss_val': 0.017236137578645738, 'psi': 0.9974379938519826}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=2.087506 cos_to_last_merge=0.9971 (last merge round=37)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6161515383293918, 'auprc': 0.7417223640115387, 'loss_val': 1.0747576632045284, 'psi': 0.6663798686022506}-{'f1_val': 0.6522175110540297, 'auprc': 0.7408428171482287, 'loss_val': 0.8386062021715672, 'psi': 0.6876676334917093}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=2.130024 cos_to_last_merge=0.9991 (last merge round=43)
[S14] round=52 local utility u=0.002133 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9990079399968853, 'loss_val': 0.022100469109872276, 'psi': 0.9979039866570707}-{'f1_val': 0.9967577367102773, 'auprc': 0.9990025114720089, 'loss_val': 0.02388838503510046, 'psi': 0.99765564661497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=52 head_norm_before_train=2.225610 (no previous merge yet)
[S15] round=52 local utility u=0.153316 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998574694546559, 'loss_val': 0.019790915371286563, 'psi': 0.9974778788511359}-{'f1_val': 0.9532040485296963, 'auprc': 0.9977836927726005, 'loss_val': 0.06279353381665762, 'psi': 0.971035906226858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=52 head_norm_before_train=1.678455 cos_to_last_merge=0.9988 (last merge round=44)
[S16] round=52 local utility u=0.005347 metrics={'f1_val': 0.990218050461623, 'auprc': 0.9970850939025653, 'loss_val': 0.0496787078712476, 'psi': 0.9929648678379999}-{'f1_val': 0.9893938359408495, 'auprc': 0.9974052885774347, 'loss_val': 0.056388538261784596, 'psi': 0.9925984169954836}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=52 head_norm_before_train=2.090775 cos_to_last_merge=0.9997 (last merge round=43)
[S17] round=52 local utility u=0.414963 metrics={'f1_val': 0.6581936712979715, 'auprc': 0.9234671928992921, 'loss_val': 0.6938391816660543, 'psi': 0.7643030799384998}-{'f1_val': 0.627370741492975, 'auprc': 0.880071623357657, 'loss_val': 1.2086404143918452, 'psi': 0.7284510942388478}
[S17] not sending this round → trigger blocked (psi=0.764)
[S2] START round=53 head_norm_before_train=1.854771 cos_to_last_merge=0.9989 (last merge round=43)
[S2] round=53 local utility u=0.033773 metrics={'f1_val': 0.7080294889864958, 'auprc': 0.9214809750293949, 'loss_val': 0.588130942253022, 'psi': 0.7934100834036555}-{'f1_val': 0.7080294889864958, 'auprc': 0.9024989478929495, 'loss_val': 0.5987301412064152, 'psi': 0.7858172725490773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] sending update (kind=head size=1809 to 1 peers)
[S3] START round=53 head_norm_before_train=1.713238 cos_to_last_merge=0.9901 (last merge round=44)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.7392198365831016, 'auprc': 0.993459212100802, 'loss_val': 0.41340810172240494, 'psi': 0.8409155867901819}-{'f1_val': 0.8915738423084264, 'auprc': 0.9694892897165787, 'loss_val': 0.26297825603405556, 'psi': 0.9227400212716872}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.645398 cos_to_last_merge=0.9821 (last merge round=37)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9399998489347142, 'auprc': 0.9427119706937293, 'loss_val': 0.291779435775852, 'psi': 0.9410846976383203}-{'f1_val': 0.9469053979580402, 'auprc': 0.9717790255508811, 'loss_val': 0.270390399373852, 'psi': 0.9568548489951766}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.810053 cos_to_last_merge=0.9969 (last merge round=44)
[S5] round=53 local utility u=0.012055 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9974383519676263, 'loss_val': 0.04819853048412806, 'psi': 0.9972599579878255}-{'f1_val': 0.9967728679684698, 'auprc': 0.994961145024915, 'loss_val': 0.06266893443096032, 'psi': 0.9960481787910478}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=53 head_norm_before_train=1.495061 cos_to_last_merge=0.9785 (last merge round=45)
[S6] round=53 local utility u=0.591579 metrics={'f1_val': 0.7171440576239478, 'auprc': 0.9357368695949481, 'loss_val': 0.6261715425152051, 'psi': 0.8045811824123479}-{'f1_val': 0.6164772556812848, 'auprc': 0.8047678729453314, 'loss_val': 0.8124223168466909, 'psi': 0.6917935025869034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=53 head_norm_before_train=1.525778 cos_to_last_merge=0.9837 (last merge round=40)
[S7] round=53 local utility u=0.623558 metrics={'f1_val': 0.6993064173275508, 'auprc': 0.9654075966380301, 'loss_val': 0.24501155303357827, 'psi': 0.8057468890517425}-{'f1_val': 0.6329248958101669, 'auprc': 0.8000764257875869, 'loss_val': 0.597844764092286, 'psi': 0.6997855078011349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=53 head_norm_before_train=1.701790 cos_to_last_merge=0.9982 (last merge round=44)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9687942767934877, 'auprc': 0.9993557392026344, 'loss_val': 0.0996455236029074, 'psi': 0.9810188617571464}-{'f1_val': 0.9939919029218467, 'auprc': 0.9959352296867244, 'loss_val': 0.0484705167930866, 'psi': 0.9947692336277978}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=2.245573 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.981867343096408, 'auprc': 0.999838347258996, 'loss_val': 0.060267033089698344, 'psi': 0.9890557447614432}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998827528304222, 'loss_val': 0.015981549470271684, 'psi': 0.9982148486394545}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.339970 cos_to_last_merge=0.9990 (last merge round=43)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962421459718834, 'loss_val': 0.02729542995232127, 'psi': 0.9956095618003782}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976106994006848, 'loss_val': 0.02626538193620481, 'psi': 0.9961569831718988}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=2.305142 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9863220659812656, 'auprc': 0.9989359463491394, 'loss_val': 0.05136224324493567, 'psi': 0.991367618128415}-{'f1_val': 0.9965712481121245, 'auprc': 0.998336542166777, 'loss_val': 0.017431590197801407, 'psi': 0.9972773657339855}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=2.092776 cos_to_last_merge=0.9968 (last merge round=37)
[S13] round=53 local utility u=0.270591 metrics={'f1_val': 0.6559307124718774, 'auprc': 0.7562594239100336, 'loss_val': 0.8158620814164012, 'psi': 0.6960621970471399}-{'f1_val': 0.6161515383293918, 'auprc': 0.7417223640115387, 'loss_val': 1.0747576632045284, 'psi': 0.6663798686022506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=53 head_norm_before_train=2.137743 cos_to_last_merge=0.9989 (last merge round=43)
[S14] round=53 local utility u=0.001687 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9991324798393942, 'loss_val': 0.02042693199238457, 'psi': 0.998086467061496}-{'f1_val': 0.9971680177638609, 'auprc': 0.9990079399968853, 'loss_val': 0.022100469109872276, 'psi': 0.9979039866570707}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=53 head_norm_before_train=2.232401 (no previous merge yet)
[S15] round=53 local utility u=0.003120 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9988678650143179, 'loss_val': 0.01665389389416975, 'psi': 0.9978174981225872}-{'f1_val': 0.9967466683875206, 'auprc': 0.998574694546559, 'loss_val': 0.019790915371286563, 'psi': 0.9974778788511359}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=53 head_norm_before_train=1.688503 cos_to_last_merge=0.9985 (last merge round=44)
[S16] round=53 local utility u=0.000620 metrics={'f1_val': 0.990218050461623, 'auprc': 0.99730668799757, 'loss_val': 0.04910274956915347, 'psi': 0.9930535054760018}-{'f1_val': 0.990218050461623, 'auprc': 0.9970850939025653, 'loss_val': 0.0496787078712476, 'psi': 0.9929648678379999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=53 head_norm_before_train=2.092898 cos_to_last_merge=0.9996 (last merge round=43)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6190889572144335, 'auprc': 0.8067534506434038, 'loss_val': 1.315274184480856, 'psi': 0.6941547545860216}-{'f1_val': 0.6581936712979715, 'auprc': 0.9234671928992921, 'loss_val': 0.6938391816660543, 'psi': 0.7643030799384998}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.861792 cos_to_last_merge=0.9988 (last merge round=43)
[S2] round=54 local utility u=0.048004 metrics={'f1_val': 0.7273504412943016, 'auprc': 0.8776406962327198, 'loss_val': 0.4765281106182078, 'psi': 0.7874665432696689}-{'f1_val': 0.7080294889864958, 'auprc': 0.9214809750293949, 'loss_val': 0.588130942253022, 'psi': 0.7934100834036555}
[S2] not sending this round → trigger blocked (psi=0.787)
[S3] START round=54 head_norm_before_train=1.731597 cos_to_last_merge=0.9891 (last merge round=44)
[S3] round=54 local utility u=0.963496 metrics={'f1_val': 0.9930978081296382, 'auprc': 0.9993532195658399, 'loss_val': 0.027365904704540544, 'psi': 0.9955999727041189}-{'f1_val': 0.7392198365831016, 'auprc': 0.993459212100802, 'loss_val': 0.41340810172240494, 'psi': 0.8409155867901819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=54 head_norm_before_train=1.655917 cos_to_last_merge=0.9812 (last merge round=37)
[S4] round=54 local utility u=0.062455 metrics={'f1_val': 0.9443403354065717, 'auprc': 0.9711401687633189, 'loss_val': 0.2781967313648896, 'psi': 0.9550602687492705}-{'f1_val': 0.9399998489347142, 'auprc': 0.9427119706937293, 'loss_val': 0.291779435775852, 'psi': 0.9410846976383203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=54 head_norm_before_train=1.818574 cos_to_last_merge=0.9963 (last merge round=44)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9982993291880612, 'loss_val': 0.051511648514613616, 'psi': 0.9973409127622991}-{'f1_val': 0.9971410286679584, 'auprc': 0.9974383519676263, 'loss_val': 0.04819853048412806, 'psi': 0.9972599579878255}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.508991 cos_to_last_merge=0.9767 (last merge round=45)
[S6] round=54 local utility u=0.524847 metrics={'f1_val': 0.8518177144439993, 'auprc': 0.9437071926759741, 'loss_val': 0.4084296667807749, 'psi': 0.8885735057367892}-{'f1_val': 0.7171440576239478, 'auprc': 0.9357368695949481, 'loss_val': 0.6261715425152051, 'psi': 0.8045811824123479}
[S6] not sending this round → trigger blocked (psi=0.889)
[S7] START round=54 head_norm_before_train=1.539456 cos_to_last_merge=0.9823 (last merge round=40)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6157128609827995, 'auprc': 0.798876165618998, 'loss_val': 0.6352646380306366, 'psi': 0.688978182837279}-{'f1_val': 0.6993064173275508, 'auprc': 0.9654075966380301, 'loss_val': 0.24501155303357827, 'psi': 0.8057468890517425}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.713008 cos_to_last_merge=0.9978 (last merge round=44)
[S8] round=54 local utility u=0.093122 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9947808437088902, 'loss_val': 0.0499908549874187, 'psi': 0.9942202214320348}-{'f1_val': 0.9687942767934877, 'auprc': 0.9993557392026344, 'loss_val': 0.0996455236029074, 'psi': 0.9810188617571464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=54 head_norm_before_train=2.254715 (no previous merge yet)
[S9] round=54 local utility u=0.068477 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998549244979682, 'loss_val': 0.014775352290566405, 'psi': 0.998203717306473}-{'f1_val': 0.981867343096408, 'auprc': 0.999838347258996, 'loss_val': 0.060267033089698344, 'psi': 0.9890557447614432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=54 head_norm_before_train=2.346236 cos_to_last_merge=0.9989 (last merge round=43)
[S10] round=54 local utility u=0.002063 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9972849441661652, 'loss_val': 0.026296967755151928, 'psi': 0.9960266810780909}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962421459718834, 'loss_val': 0.02729542995232127, 'psi': 0.9956095618003782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=54 head_norm_before_train=2.309669 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=54 local utility u=0.043209 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9962720978569721, 'loss_val': 0.018326771562122684, 'psi': 0.9964393921398472}-{'f1_val': 0.9863220659812656, 'auprc': 0.9989359463491394, 'loss_val': 0.05136224324493567, 'psi': 0.991367618128415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=54 head_norm_before_train=2.097004 cos_to_last_merge=0.9966 (last merge round=37)
[S13] round=54 local utility u=0.113330 metrics={'f1_val': 0.7119089760370301, 'auprc': 0.7373871070347011, 'loss_val': 0.8684537181257578, 'psi': 0.7221002284360984}-{'f1_val': 0.6559307124718774, 'auprc': 0.7562594239100336, 'loss_val': 0.8158620814164012, 'psi': 0.6960621970471399}
[S13] not sending this round → trigger blocked (psi=0.722)
[S14] START round=54 head_norm_before_train=2.144399 cos_to_last_merge=0.9988 (last merge round=43)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990102551134572, 'loss_val': 0.021684571994414606, 'psi': 0.9980490637464182}-{'f1_val': 0.9973891252095638, 'auprc': 0.9991324798393942, 'loss_val': 0.02042693199238457, 'psi': 0.998086467061496}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.239223 (no previous merge yet)
[S15] round=54 local utility u=0.000107 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9988793035813102, 'loss_val': 0.016473697018128154, 'psi': 0.9978220735493841}-{'f1_val': 0.9971172535281002, 'auprc': 0.9988678650143179, 'loss_val': 0.01665389389416975, 'psi': 0.9978174981225872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=54 head_norm_before_train=1.698010 cos_to_last_merge=0.9983 (last merge round=44)
[S16] round=54 local utility u=0.000549 metrics={'f1_val': 0.9904150969966521, 'auprc': 0.9975822114968897, 'loss_val': 0.05001335584740786, 'psi': 0.9932819427967472}-{'f1_val': 0.990218050461623, 'auprc': 0.99730668799757, 'loss_val': 0.04910274956915347, 'psi': 0.9930535054760018}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=54 head_norm_before_train=2.096084 cos_to_last_merge=0.9996 (last merge round=43)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.5060211671782778, 'auprc': 0.7596285445328576, 'loss_val': 1.803611529894506, 'psi': 0.6074641181201097}-{'f1_val': 0.6190889572144335, 'auprc': 0.8067534506434038, 'loss_val': 1.315274184480856, 'psi': 0.6941547545860216}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=1.870434 cos_to_last_merge=0.9987 (last merge round=43)
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.7079181921765229, 'auprc': 0.9269215595685708, 'loss_val': 0.5709982803178177, 'psi': 0.7955195391333421}-{'f1_val': 0.7273504412943016, 'auprc': 0.8776406962327198, 'loss_val': 0.4765281106182078, 'psi': 0.7874665432696689}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=1.749578 cos_to_last_merge=0.9881 (last merge round=44)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.958786414597253, 'auprc': 0.9934351853065146, 'loss_val': 0.13340285422116596, 'psi': 0.9726459228809576}-{'f1_val': 0.9930978081296382, 'auprc': 0.9993532195658399, 'loss_val': 0.027365904704540544, 'psi': 0.9955999727041189}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.664815 cos_to_last_merge=0.9803 (last merge round=37)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9442040154636909, 'auprc': 0.9326495048787979, 'loss_val': 0.2868412704927304, 'psi': 0.9395822112297337}-{'f1_val': 0.9443403354065717, 'auprc': 0.9711401687633189, 'loss_val': 0.2781967313648896, 'psi': 0.9550602687492705}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.834138 cos_to_last_merge=0.9951 (last merge round=44)
[S5] round=55 local utility u=0.008355 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9987844623689969, 'loss_val': 0.03889187450322805, 'psi': 0.9977984021483737}-{'f1_val': 0.9967019684784577, 'auprc': 0.9982993291880612, 'loss_val': 0.051511648514613616, 'psi': 0.9973409127622991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=55 head_norm_before_train=1.525003 cos_to_last_merge=0.9745 (last merge round=45)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7172506265511523, 'auprc': 0.9260637615062922, 'loss_val': 0.5966580278792636, 'psi': 0.8007758805332084}-{'f1_val': 0.8518177144439993, 'auprc': 0.9437071926759741, 'loss_val': 0.4084296667807749, 'psi': 0.8885735057367892}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.547168 cos_to_last_merge=0.9814 (last merge round=40)
[S7] round=55 local utility u=0.038629 metrics={'f1_val': 0.6259742734375151, 'auprc': 0.8025847661816817, 'loss_val': 0.6307008563876306, 'psi': 0.6966184705351818}-{'f1_val': 0.6157128609827995, 'auprc': 0.798876165618998, 'loss_val': 0.6352646380306366, 'psi': 0.688978182837279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=55 head_norm_before_train=1.721721 cos_to_last_merge=0.9975 (last merge round=44)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9831460082764785, 'auprc': 0.9934807350080612, 'loss_val': 0.06807695210484495, 'psi': 0.9872798989691116}-{'f1_val': 0.9938464732474644, 'auprc': 0.9947808437088902, 'loss_val': 0.0499908549874187, 'psi': 0.9942202214320348}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.261647 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9998602564100827, 'loss_val': 0.032349478281766125, 'psi': 0.9944374038756993}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998549244979682, 'loss_val': 0.014775352290566405, 'psi': 0.998203717306473}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.352897 cos_to_last_merge=0.9987 (last merge round=43)
[S10] round=55 local utility u=0.000151 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9973009067829014, 'loss_val': 0.02604380274321884, 'psi': 0.9960330661247854}-{'f1_val': 0.9951878390193748, 'auprc': 0.9972849441661652, 'loss_val': 0.026296967755151928, 'psi': 0.9960266810780909}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=55 head_norm_before_train=2.314590 cos_to_last_merge=0.9997 (last merge round=43)
[S11] round=55 local utility u=0.000610 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9965934938624581, 'loss_val': 0.01807165358804592, 'psi': 0.9965679505420416}-{'f1_val': 0.9965509216617638, 'auprc': 0.9962720978569721, 'loss_val': 0.018326771562122684, 'psi': 0.9964393921398472}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=55 head_norm_before_train=2.100745 cos_to_last_merge=0.9964 (last merge round=37)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6675334927256226, 'auprc': 0.7686336939912639, 'loss_val': 0.730364268736641, 'psi': 0.7079735732318791}-{'f1_val': 0.7119089760370301, 'auprc': 0.7373871070347011, 'loss_val': 0.8684537181257578, 'psi': 0.7221002284360984}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=2.152103 cos_to_last_merge=0.9987 (last merge round=43)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969421138912897, 'loss_val': 0.026724958989922006, 'psi': 0.997076021355171}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990102551134572, 'loss_val': 0.021684571994414606, 'psi': 0.9980490637464182}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=2.246245 (no previous merge yet)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9815036917622131, 'auprc': 0.998734507522718, 'loss_val': 0.03310528539964566, 'psi': 0.9883960180664151}-{'f1_val': 0.9971172535281002, 'auprc': 0.9988793035813102, 'loss_val': 0.016473697018128154, 'psi': 0.9978220735493841}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.708066 cos_to_last_merge=0.9980 (last merge round=44)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9902637317285794, 'auprc': 0.9954766372188099, 'loss_val': 0.053399321085421086, 'psi': 0.9923488939246716}-{'f1_val': 0.9904150969966521, 'auprc': 0.9975822114968897, 'loss_val': 0.05001335584740786, 'psi': 0.9932819427967472}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=2.102716 cos_to_last_merge=0.9995 (last merge round=43)
[S17] round=55 local utility u=0.649772 metrics={'f1_val': 0.6157957334721301, 'auprc': 0.8288140983848036, 'loss_val': 1.3702719076591199, 'psi': 0.7010030794371995}-{'f1_val': 0.5060211671782778, 'auprc': 0.7596285445328576, 'loss_val': 1.803611529894506, 'psi': 0.6074641181201097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=56 head_norm_before_train=1.881926 cos_to_last_merge=0.9985 (last merge round=43)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.6570988541117379, 'auprc': 0.7778100317757027, 'loss_val': 1.1446052726443603, 'psi': 0.7053833251773238}-{'f1_val': 0.7079181921765229, 'auprc': 0.9269215595685708, 'loss_val': 0.5709982803178177, 'psi': 0.7955195391333421}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.767265 cos_to_last_merge=0.9871 (last merge round=44)
[S3] round=56 local utility u=0.143044 metrics={'f1_val': 0.9874407235268892, 'auprc': 0.9994557180750145, 'loss_val': 0.037302700139294376, 'psi': 0.9922467213461393}-{'f1_val': 0.958786414597253, 'auprc': 0.9934351853065146, 'loss_val': 0.13340285422116596, 'psi': 0.9726459228809576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=56 head_norm_before_train=1.672998 cos_to_last_merge=0.9795 (last merge round=37)
[S4] round=56 local utility u=0.007371 metrics={'f1_val': 0.9469379642607093, 'auprc': 0.9325659651838403, 'loss_val': 0.2882532938955941, 'psi': 0.9411891646299617}-{'f1_val': 0.9442040154636909, 'auprc': 0.9326495048787979, 'loss_val': 0.2868412704927304, 'psi': 0.9395822112297337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=56 head_norm_before_train=1.853276 cos_to_last_merge=0.9935 (last merge round=44)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9986567804033967, 'loss_val': 0.04119110629717878, 'psi': 0.9977473293621337}-{'f1_val': 0.9971410286679584, 'auprc': 0.9987844623689969, 'loss_val': 0.03889187450322805, 'psi': 0.9977984021483737}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.539047 cos_to_last_merge=0.9726 (last merge round=45)
[S6] round=56 local utility u=0.972218 metrics={'f1_val': 0.954501167523036, 'auprc': 0.9641547618326953, 'loss_val': 0.18999810674203746, 'psi': 0.9583626052468998}-{'f1_val': 0.7172506265511523, 'auprc': 0.9260637615062922, 'loss_val': 0.5966580278792636, 'psi': 0.8007758805332084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=56 head_norm_before_train=1.557291 cos_to_last_merge=0.9802 (last merge round=40)
[S7] round=56 local utility u=0.198583 metrics={'f1_val': 0.6548535581443466, 'auprc': 0.8169673604042165, 'loss_val': 0.44995881961873124, 'psi': 0.7196990790482947}-{'f1_val': 0.6259742734375151, 'auprc': 0.8025847661816817, 'loss_val': 0.6307008563876306, 'psi': 0.6966184705351818}
[S7] not sending this round → trigger blocked (psi=0.720)
[S8] START round=56 head_norm_before_train=1.730510 cos_to_last_merge=0.9971 (last merge round=44)
[S8] round=56 local utility u=0.036969 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9984298286473253, 'loss_val': 0.047965253987714014, 'psi': 0.9931575279433005}-{'f1_val': 0.9831460082764785, 'auprc': 0.9934807350080612, 'loss_val': 0.06807695210484495, 'psi': 0.9872798989691116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=56 head_norm_before_train=2.262204 (no previous merge yet)
[S9] round=56 local utility u=0.003130 metrics={'f1_val': 0.991254331540241, 'auprc': 0.999882209131236, 'loss_val': 0.028749304326267905, 'psi': 0.994705482576639}-{'f1_val': 0.9908221688527771, 'auprc': 0.9998602564100827, 'loss_val': 0.032349478281766125, 'psi': 0.9944374038756993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=56 head_norm_before_train=2.359985 cos_to_last_merge=0.9986 (last merge round=43)
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969073349792259, 'loss_val': 0.026282048263720506, 'psi': 0.9958756374033152}-{'f1_val': 0.9951878390193748, 'auprc': 0.9973009067829014, 'loss_val': 0.02604380274321884, 'psi': 0.9960330661247854}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=2.319919 cos_to_last_merge=0.9997 (last merge round=43)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9225014976548437, 'auprc': 0.9992557208638299, 'loss_val': 0.27617406733335115, 'psi': 0.9532031869384381}-{'f1_val': 0.9965509216617638, 'auprc': 0.9965934938624581, 'loss_val': 0.01807165358804592, 'psi': 0.9965679505420416}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=2.105255 cos_to_last_merge=0.9962 (last merge round=37)
[S13] round=56 local utility u=0.069010 metrics={'f1_val': 0.7142211158740833, 'auprc': 0.7677442431171821, 'loss_val': 0.869802225709303, 'psi': 0.7356303667713229}-{'f1_val': 0.6675334927256226, 'auprc': 0.7686336939912639, 'loss_val': 0.730364268736641, 'psi': 0.7079735732318791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=56 head_norm_before_train=2.159666 cos_to_last_merge=0.9985 (last merge round=43)
[S14] round=56 local utility u=0.006687 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991114527697993, 'loss_val': 0.021317529592231675, 'psi': 0.9980895428089551}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969421138912897, 'loss_val': 0.026724958989922006, 'psi': 0.997076021355171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=56 head_norm_before_train=2.253219 (no previous merge yet)
[S15] round=56 local utility u=0.049479 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977279047931706, 'loss_val': 0.02258557645352776, 'psi': 0.9971391629497806}-{'f1_val': 0.9815036917622131, 'auprc': 0.998734507522718, 'loss_val': 0.03310528539964566, 'psi': 0.9883960180664151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=56 head_norm_before_train=1.717135 cos_to_last_merge=0.9977 (last merge round=44)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9896078415739858, 'auprc': 0.9950327374903452, 'loss_val': 0.0559220990140766, 'psi': 0.9917777999405295}-{'f1_val': 0.9902637317285794, 'auprc': 0.9954766372188099, 'loss_val': 0.053399321085421086, 'psi': 0.9923488939246716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=2.107852 cos_to_last_merge=0.9995 (last merge round=43)
[S17] round=56 local utility u=0.477833 metrics={'f1_val': 0.6484886696629109, 'auprc': 0.9130510401441123, 'loss_val': 0.8634751362207124, 'psi': 0.7543136178553914}-{'f1_val': 0.6157957334721301, 'auprc': 0.8288140983848036, 'loss_val': 1.3702719076591199, 'psi': 0.7010030794371995}
[S17] not sending this round → trigger blocked (psi=0.754)
[S2] START round=57 head_norm_before_train=1.893187 cos_to_last_merge=0.9982 (last merge round=43)
[S2] round=57 local utility u=0.385973 metrics={'f1_val': 0.7224571237679218, 'auprc': 0.7968964952096425, 'loss_val': 0.8220676087638805, 'psi': 0.7522328723446101}-{'f1_val': 0.6570988541117379, 'auprc': 0.7778100317757027, 'loss_val': 1.1446052726443603, 'psi': 0.7053833251773238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=57 head_norm_before_train=1.782467 cos_to_last_merge=0.9862 (last merge round=44)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9581433648295932, 'auprc': 0.992842976121017, 'loss_val': 0.11685223143990385, 'psi': 0.9720232093461627}-{'f1_val': 0.9874407235268892, 'auprc': 0.9994557180750145, 'loss_val': 0.037302700139294376, 'psi': 0.9922467213461393}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.678831 cos_to_last_merge=0.9789 (last merge round=37)
[S4] round=57 local utility u=0.062668 metrics={'f1_val': 0.9529350333581882, 'auprc': 0.9583117614041848, 'loss_val': 0.27613720776979256, 'psi': 0.9550857245765869}-{'f1_val': 0.9469379642607093, 'auprc': 0.9325659651838403, 'loss_val': 0.2882532938955941, 'psi': 0.9411891646299617}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=57 head_norm_before_train=1.873850 cos_to_last_merge=0.9918 (last merge round=44)
[S5] round=57 local utility u=0.001836 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9987658686022427, 'loss_val': 0.03784650305640224, 'psi': 0.997790964641672}-{'f1_val': 0.9971410286679584, 'auprc': 0.9986567804033967, 'loss_val': 0.04119110629717878, 'psi': 0.9977473293621337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=57 head_norm_before_train=1.555850 cos_to_last_merge=0.9704 (last merge round=45)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.6067155483821912, 'auprc': 0.9341796123509964, 'loss_val': 0.8157553630787346, 'psi': 0.7377011739697134}-{'f1_val': 0.954501167523036, 'auprc': 0.9641547618326953, 'loss_val': 0.18999810674203746, 'psi': 0.9583626052468998}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.568570 cos_to_last_merge=0.9790 (last merge round=40)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5792041602829139, 'auprc': 0.7932893095179215, 'loss_val': 0.7671238271057227, 'psi': 0.6648382199769169}-{'f1_val': 0.6548535581443466, 'auprc': 0.8169673604042165, 'loss_val': 0.44995881961873124, 'psi': 0.7196990790482947}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.739682 cos_to_last_merge=0.9968 (last merge round=44)
[S8] round=57 local utility u=0.004545 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9901419127666546, 'loss_val': 0.041828284257706225, 'psi': 0.9926240694580799}-{'f1_val': 0.9896426608072839, 'auprc': 0.9984298286473253, 'loss_val': 0.047965253987714014, 'psi': 0.9931575279433005}
[S8] not sending this round → trigger blocked (psi=0.993)
[S9] START round=57 head_norm_before_train=2.261541 (no previous merge yet)
[S9] round=57 local utility u=0.002750 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9998845240282614, 'loss_val': 0.02578195479723329, 'psi': 0.9949589506049317}-{'f1_val': 0.991254331540241, 'auprc': 0.999882209131236, 'loss_val': 0.028749304326267905, 'psi': 0.994705482576639}
[S9] not sending this round → trigger blocked (psi=0.995)
[S10] START round=57 head_norm_before_train=2.367186 cos_to_last_merge=0.9984 (last merge round=43)
[S10] round=57 local utility u=0.000884 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997287429248741, 'loss_val': 0.025653587090770934, 'psi': 0.9960276751111212}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969073349792259, 'loss_val': 0.026282048263720506, 'psi': 0.9958756374033152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=57 head_norm_before_train=2.323547 cos_to_last_merge=0.9996 (last merge round=43)
[S11] round=57 local utility u=0.345920 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9965415262215038, 'loss_val': 0.01903793943892477, 'psi': 0.9964020612588227}-{'f1_val': 0.9225014976548437, 'auprc': 0.9992557208638299, 'loss_val': 0.27617406733335115, 'psi': 0.9532031869384381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=57 head_norm_before_train=2.108782 cos_to_last_merge=0.9960 (last merge round=37)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6038678894795544, 'auprc': 0.7788773429139944, 'loss_val': 1.1092518364236874, 'psi': 0.6738716708533303}-{'f1_val': 0.7142211158740833, 'auprc': 0.7677442431171821, 'loss_val': 0.869802225709303, 'psi': 0.7356303667713229}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=2.167917 cos_to_last_merge=0.9983 (last merge round=43)
[S14] round=57 local utility u=0.001124 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988454535468507, 'loss_val': 0.019595594026616467, 'psi': 0.9981156472556766}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991114527697993, 'loss_val': 0.021317529592231675, 'psi': 0.9980895428089551}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=57 head_norm_before_train=2.260011 (no previous merge yet)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997771617112192, 'loss_val': 0.027884569817047032, 'psi': 0.9971566478773891}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977279047931706, 'loss_val': 0.02258557645352776, 'psi': 0.9971391629497806}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.725654 cos_to_last_merge=0.9974 (last merge round=44)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9802943436763871, 'auprc': 0.9943872935024164, 'loss_val': 0.0789415176127801, 'psi': 0.9859315236067988}-{'f1_val': 0.9896078415739858, 'auprc': 0.9950327374903452, 'loss_val': 0.0559220990140766, 'psi': 0.9917777999405295}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=2.112736 cos_to_last_merge=0.9995 (last merge round=43)
[S17] round=57 local utility u=0.334871 metrics={'f1_val': 0.7256450937177953, 'auprc': 0.9312193643224804, 'loss_val': 0.7111775566100357, 'psi': 0.8078748019596693}-{'f1_val': 0.6484886696629109, 'auprc': 0.9130510401441123, 'loss_val': 0.8634751362207124, 'psi': 0.7543136178553914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=58 head_norm_before_train=1.903933 cos_to_last_merge=0.9980 (last merge round=43)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7242159720842458, 'auprc': 0.7742441223065202, 'loss_val': 1.0582022857381195, 'psi': 0.7442272321731556}-{'f1_val': 0.7224571237679218, 'auprc': 0.7968964952096425, 'loss_val': 0.8220676087638805, 'psi': 0.7522328723446101}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=1.798995 cos_to_last_merge=0.9852 (last merge round=44)
[S3] round=58 local utility u=0.152689 metrics={'f1_val': 0.9931194223029961, 'auprc': 0.9992114869870803, 'loss_val': 0.04043538649192564, 'psi': 0.9955562481766298}-{'f1_val': 0.9581433648295932, 'auprc': 0.992842976121017, 'loss_val': 0.11685223143990385, 'psi': 0.9720232093461627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=58 head_norm_before_train=1.683894 cos_to_last_merge=0.9781 (last merge round=37)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9516275358586899, 'auprc': 0.9596649134007068, 'loss_val': 0.28073731847606215, 'psi': 0.9548424868754967}-{'f1_val': 0.9529350333581882, 'auprc': 0.9583117614041848, 'loss_val': 0.27613720776979256, 'psi': 0.9550857245765869}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.893299 cos_to_last_merge=0.9902 (last merge round=44)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9959650868991299, 'auprc': 0.9969061102660173, 'loss_val': 0.045881875600917076, 'psi': 0.9963414962458849}-{'f1_val': 0.9971410286679584, 'auprc': 0.9987658686022427, 'loss_val': 0.03784650305640224, 'psi': 0.997790964641672}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.571103 cos_to_last_merge=0.9684 (last merge round=45)
[S6] round=58 local utility u=1.000000 metrics={'f1_val': 0.8872983708606371, 'auprc': 0.9664263058327673, 'loss_val': 0.2505309920558674, 'psi': 0.9189495448494892}-{'f1_val': 0.6067155483821912, 'auprc': 0.9341796123509964, 'loss_val': 0.8157553630787346, 'psi': 0.7377011739697134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=58 head_norm_before_train=1.580700 cos_to_last_merge=0.9776 (last merge round=40)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.560288978982648, 'auprc': 0.7873768915235012, 'loss_val': 0.892507577596214, 'psi': 0.6511241439989892}-{'f1_val': 0.5792041602829139, 'auprc': 0.7932893095179215, 'loss_val': 0.7671238271057227, 'psi': 0.6648382199769169}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.750256 cos_to_last_merge=0.9963 (last merge round=44)
[S8] round=58 local utility u=0.011671 metrics={'f1_val': 0.9935542741987232, 'auprc': 0.9986722180495532, 'loss_val': 0.03972942271323689, 'psi': 0.9956014517390552}-{'f1_val': 0.9942788405856967, 'auprc': 0.9901419127666546, 'loss_val': 0.041828284257706225, 'psi': 0.9926240694580799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=58 head_norm_before_train=2.259440 (no previous merge yet)
[S9] round=58 local utility u=0.021114 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998880456442476, 'loss_val': 0.016130395561375542, 'psi': 0.9982169657649848}-{'f1_val': 0.9916752349893785, 'auprc': 0.9998845240282614, 'loss_val': 0.02578195479723329, 'psi': 0.9949589506049317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=58 head_norm_before_train=2.374261 cos_to_last_merge=0.9982 (last merge round=43)
[S10] round=58 local utility u=0.000600 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9975683701363516, 'loss_val': 0.025297267222072223, 'psi': 0.9961400514661655}-{'f1_val': 0.9951878390193748, 'auprc': 0.997287429248741, 'loss_val': 0.025653587090770934, 'psi': 0.9960276751111212}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=58 head_norm_before_train=2.325378 cos_to_last_merge=0.9996 (last merge round=43)
[S11] round=58 local utility u=0.002937 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9976032615456825, 'loss_val': 0.017801059201331168, 'psi': 0.9969718576153314}-{'f1_val': 0.9963090846170353, 'auprc': 0.9965415262215038, 'loss_val': 0.01903793943892477, 'psi': 0.9964020612588227}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=58 head_norm_before_train=2.111555 cos_to_last_merge=0.9959 (last merge round=37)
[S13] round=58 local utility u=0.024856 metrics={'f1_val': 0.6111721004098836, 'auprc': 0.8190577727307896, 'loss_val': 1.2239055565905363, 'psi': 0.694326369338246}-{'f1_val': 0.6038678894795544, 'auprc': 0.7788773429139944, 'loss_val': 1.1092518364236874, 'psi': 0.6738716708533303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=58 head_norm_before_train=2.174294 cos_to_last_merge=0.9982 (last merge round=43)
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9990365448588947, 'loss_val': 0.020502949433774238, 'psi': 0.997913793742213}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988454535468507, 'loss_val': 0.019595594026616467, 'psi': 0.9981156472556766}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=2.266344 (no previous merge yet)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9019887683499603, 'auprc': 0.9671014189774524, 'loss_val': 0.26491121721686844, 'psi': 0.9280338286009572}-{'f1_val': 0.9967466683875206, 'auprc': 0.997771617112192, 'loss_val': 0.027884569817047032, 'psi': 0.9971566478773891}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.733651 cos_to_last_merge=0.9972 (last merge round=44)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8541584311074014, 'auprc': 0.9810897582893054, 'loss_val': 0.8137043836043133, 'psi': 0.904930961980163}-{'f1_val': 0.9802943436763871, 'auprc': 0.9943872935024164, 'loss_val': 0.0789415176127801, 'psi': 0.9859315236067988}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=2.117885 cos_to_last_merge=0.9994 (last merge round=43)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6674658007046047, 'auprc': 0.8491701450443794, 'loss_val': 0.9842535981329461, 'psi': 0.7401475384405146}-{'f1_val': 0.7256450937177953, 'auprc': 0.9312193643224804, 'loss_val': 0.7111775566100357, 'psi': 0.8078748019596693}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.914227 cos_to_last_merge=0.9977 (last merge round=43)
[S2] round=59 local utility u=0.144304 metrics={'f1_val': 0.7226824118209301, 'auprc': 0.7967225447142943, 'loss_val': 0.8278272362200021, 'psi': 0.7522984649782758}-{'f1_val': 0.7242159720842458, 'auprc': 0.7742441223065202, 'loss_val': 1.0582022857381195, 'psi': 0.7442272321731556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S2] r=60 psi=0.752 u=0.1443 p_local=0.1006 f1=0.723 auprc=0.797 bytes=48683
[S3] START round=59 head_norm_before_train=1.812319 cos_to_last_merge=0.9844 (last merge round=44)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.7633866629343358, 'auprc': 0.9657139576832663, 'loss_val': 0.5711704027863922, 'psi': 0.844317580833908}-{'f1_val': 0.9931194223029961, 'auprc': 0.9992114869870803, 'loss_val': 0.04043538649192564, 'psi': 0.9955562481766298}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.844 u=0.0000 p_local=0.1235 f1=0.763 auprc=0.966 bytes=44973
[S4] START round=59 head_norm_before_train=1.688508 cos_to_last_merge=0.9777 (last merge round=37)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9485294878674305, 'auprc': 0.9574677300835824, 'loss_val': 0.28527133234974356, 'psi': 0.9521047847538913}-{'f1_val': 0.9516275358586899, 'auprc': 0.9596649134007068, 'loss_val': 0.28073731847606215, 'psi': 0.9548424868754967}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.952 u=0.0000 p_local=0.0177 f1=0.949 auprc=0.957 bytes=46733
[S5] START round=59 head_norm_before_train=1.914946 cos_to_last_merge=0.9889 (last merge round=44)
[S5] round=59 local utility u=0.008675 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9975686537861395, 'loss_val': 0.03273119530660296, 'psi': 0.9968277486925898}-{'f1_val': 0.9959650868991299, 'auprc': 0.9969061102660173, 'loss_val': 0.045881875600917076, 'psi': 0.9963414962458849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=60 psi=0.997 u=0.0087 p_local=0.0743 f1=0.996 auprc=0.998 bytes=45060
[S6] START round=59 head_norm_before_train=1.583127 cos_to_last_merge=0.9669 (last merge round=45)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.8793037494114523, 'auprc': 0.9626098910034435, 'loss_val': 0.28420019249792494, 'psi': 0.9126262060482488}-{'f1_val': 0.8872983708606371, 'auprc': 0.9664263058327673, 'loss_val': 0.2505309920558674, 'psi': 0.9189495448494892}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.913 u=0.0000 p_local=0.3608 f1=0.879 auprc=0.963 bytes=46783
[S7] START round=59 head_norm_before_train=1.591971 cos_to_last_merge=0.9764 (last merge round=40)
[S7] round=59 local utility u=0.611409 metrics={'f1_val': 0.6667213079229392, 'auprc': 0.8277340688886228, 'loss_val': 0.4293554837418441, 'psi': 0.7311264123092126}-{'f1_val': 0.560288978982648, 'auprc': 0.7873768915235012, 'loss_val': 0.892507577596214, 'psi': 0.6511241439989892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=60 psi=0.731 u=0.6114 p_local=0.2149 f1=0.667 auprc=0.828 bytes=43197
[S8] START round=59 head_norm_before_train=1.759872 cos_to_last_merge=0.9959 (last merge round=44)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9853820930993438, 'auprc': 0.9994465200601713, 'loss_val': 0.05655081550238493, 'psi': 0.9910078638836748}-{'f1_val': 0.9935542741987232, 'auprc': 0.9986722180495532, 'loss_val': 0.03972942271323689, 'psi': 0.9956014517390552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.991 u=0.0000 p_local=0.0235 f1=0.985 auprc=0.999 bytes=52172
[S9] START round=59 head_norm_before_train=2.265581 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998654468987215, 'loss_val': 0.016089146734327524, 'psi': 0.9979424858478234}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998880456442476, 'loss_val': 0.016130395561375542, 'psi': 0.9982169657649848}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.998 u=0.0000 p_local=0.0096 f1=0.997 auprc=1.000 bytes=50271
[S10] START round=59 head_norm_before_train=2.378412 cos_to_last_merge=0.9981 (last merge round=43)
[S10] round=59 local utility u=0.000237 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978128468041099, 'loss_val': 0.025556028424231297, 'psi': 0.9962378421332687}-{'f1_val': 0.9951878390193748, 'auprc': 0.9975683701363516, 'loss_val': 0.025297267222072223, 'psi': 0.9961400514661655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=60 psi=0.996 u=0.0002 p_local=0.0007 f1=0.995 auprc=0.998 bytes=50384
[S11] START round=59 head_norm_before_train=2.327906 cos_to_last_merge=0.9995 (last merge round=43)
[S11] round=59 local utility u=0.002735 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990140456592154, 'loss_val': 0.016684891108051825, 'psi': 0.9975483671309608}-{'f1_val': 0.9965509216617638, 'auprc': 0.9976032615456825, 'loss_val': 0.017801059201331168, 'psi': 0.9969718576153314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S11] r=60 psi=0.998 u=0.0027 p_local=0.0500 f1=0.997 auprc=0.999 bytes=53980
[S13] START round=59 head_norm_before_train=2.116612 cos_to_last_merge=0.9956 (last merge round=37)
[S13] round=59 local utility u=0.150689 metrics={'f1_val': 0.6447290112869564, 'auprc': 0.7542779729647149, 'loss_val': 0.9295299327414247, 'psi': 0.6885485959580597}-{'f1_val': 0.6111721004098836, 'auprc': 0.8190577727307896, 'loss_val': 1.2239055565905363, 'psi': 0.694326369338246}
[S13] not sending this round → trigger blocked (psi=0.689)
[S13] r=60 psi=0.689 u=0.1507 p_local=0.0734 f1=0.645 auprc=0.754 bytes=46734
[S14] START round=59 head_norm_before_train=2.175878 cos_to_last_merge=0.9982 (last merge round=43)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969238428290419, 'loss_val': 0.0225294609137845, 'psi': 0.9970687129302719}-{'f1_val': 0.9971652929977585, 'auprc': 0.9990365448588947, 'loss_val': 0.020502949433774238, 'psi': 0.997913793742213}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0018 f1=0.997 auprc=0.997 bytes=50298
[S15] START round=59 head_norm_before_train=2.272253 (no previous merge yet)
[S15] round=59 local utility u=0.014422 metrics={'f1_val': 0.9031293167126629, 'auprc': 0.965178966781075, 'loss_val': 0.23714265295387765, 'psi': 0.9279491767400277}-{'f1_val': 0.9019887683499603, 'auprc': 0.9671014189774524, 'loss_val': 0.26491121721686844, 'psi': 0.9280338286009572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=60 psi=0.928 u=0.0144 p_local=0.0233 f1=0.903 auprc=0.965 bytes=46801
[S16] START round=59 head_norm_before_train=1.741306 cos_to_last_merge=0.9970 (last merge round=44)
[S16] round=59 local utility u=0.821176 metrics={'f1_val': 0.9922852347148108, 'auprc': 0.9942559065804945, 'loss_val': 0.03961175257394763, 'psi': 0.9930735034610843}-{'f1_val': 0.8541584311074014, 'auprc': 0.9810897582893054, 'loss_val': 0.8137043836043133, 'psi': 0.904930961980163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S16] r=60 psi=0.993 u=0.8212 p_local=0.1904 f1=0.992 auprc=0.994 bytes=46755
[S17] START round=59 head_norm_before_train=2.125401 cos_to_last_merge=0.9993 (last merge round=43)
[S17] round=59 local utility u=0.269997 metrics={'f1_val': 0.7006993984952898, 'auprc': 0.9008627676444975, 'loss_val': 0.7987381888632344, 'psi': 0.7807647461549729}-{'f1_val': 0.6674658007046047, 'auprc': 0.8491701450443794, 'loss_val': 0.9842535981329461, 'psi': 0.7401475384405146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=60 psi=0.781 u=0.2700 p_local=0.2450 f1=0.701 auprc=0.901 bytes=46734
[S2] START round=60 head_norm_before_train=1.916996 cos_to_last_merge=0.9975 (last merge round=43)
[S2] round=60 local utility u=0.485334 metrics={'f1_val': 0.8112150613696328, 'auprc': 0.8399747147243206, 'loss_val': 0.5181120944159606, 'psi': 0.8227189227115079}-{'f1_val': 0.7226824118209301, 'auprc': 0.7967225447142943, 'loss_val': 0.8278272362200021, 'psi': 0.7522984649782758}
[S2] not sending this round → trigger blocked (psi=0.823)
[S3] START round=60 head_norm_before_train=1.822909 cos_to_last_merge=0.9838 (last merge round=44)
[S3] round=60 local utility u=0.963125 metrics={'f1_val': 0.98171973132522, 'auprc': 0.9992409552114057, 'loss_val': 0.055500717472425694, 'psi': 0.9887282208796943}-{'f1_val': 0.7633866629343358, 'auprc': 0.9657139576832663, 'loss_val': 0.5711704027863922, 'psi': 0.844317580833908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=60 head_norm_before_train=1.696240 cos_to_last_merge=0.9770 (last merge round=37)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9453498786181936, 'auprc': 0.9332219736326578, 'loss_val': 0.29351149420554007, 'psi': 0.9404987166239793}-{'f1_val': 0.9485294878674305, 'auprc': 0.9574677300835824, 'loss_val': 0.28527133234974356, 'psi': 0.9521047847538913}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.926805 cos_to_last_merge=0.9880 (last merge round=44)
[S5] round=60 local utility u=0.007920 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.999524290242473, 'loss_val': 0.027600646440682667, 'psi': 0.9980943332977642}-{'f1_val': 0.9963338119635569, 'auprc': 0.9975686537861395, 'loss_val': 0.03273119530660296, 'psi': 0.9968277486925898}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=60 head_norm_before_train=1.597947 cos_to_last_merge=0.9649 (last merge round=45)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.614790720977516, 'auprc': 0.8020552421987552, 'loss_val': 0.9285123018979287, 'psi': 0.6896965294660118}-{'f1_val': 0.8793037494114523, 'auprc': 0.9626098910034435, 'loss_val': 0.28420019249792494, 'psi': 0.9126262060482488}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.602677 cos_to_last_merge=0.9751 (last merge round=40)
[S7] round=60 local utility u=1.000000 metrics={'f1_val': 0.9268937262558441, 'auprc': 0.9899657558110102, 'loss_val': 0.16813919681939976, 'psi': 0.9521225380779106}-{'f1_val': 0.6667213079229392, 'auprc': 0.8277340688886228, 'loss_val': 0.4293554837418441, 'psi': 0.7311264123092126}
[S7] not sending this round → trigger blocked (psi=0.952)
[S8] START round=60 head_norm_before_train=1.768561 cos_to_last_merge=0.9955 (last merge round=44)
[S8] round=60 local utility u=0.031998 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9994093406041265, 'loss_val': 0.03751339015421516, 'psi': 0.9955000597206198}-{'f1_val': 0.9853820930993438, 'auprc': 0.9994465200601713, 'loss_val': 0.05655081550238493, 'psi': 0.9910078638836748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=60 head_norm_before_train=2.273113 (no previous merge yet)
[S9] round=60 local utility u=0.001676 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999279924170612, 'loss_val': 0.015578539774276652, 'psi': 0.9982329444741102}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998654468987215, 'loss_val': 0.016089146734327524, 'psi': 0.9979424858478234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=60 head_norm_before_train=2.381462 cos_to_last_merge=0.9980 (last merge round=43)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9977109364870466, 'loss_val': 0.025763166740572715, 'psi': 0.9961970780064435}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978128468041099, 'loss_val': 0.025556028424231297, 'psi': 0.9962378421332687}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=2.331663 cos_to_last_merge=0.9995 (last merge round=43)
[S11] round=60 local utility u=0.000778 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9994371925529608, 'loss_val': 0.016398932500141388, 'psi': 0.997717625888459}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990140456592154, 'loss_val': 0.016684891108051825, 'psi': 0.9975483671309608}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=60 head_norm_before_train=2.120235 cos_to_last_merge=0.9954 (last merge round=37)
[S13] round=60 local utility u=0.324166 metrics={'f1_val': 0.7290366125425873, 'auprc': 0.7828377632101444, 'loss_val': 0.8727226923505739, 'psi': 0.7505570728096103}-{'f1_val': 0.6447290112869564, 'auprc': 0.7542779729647149, 'loss_val': 0.9295299327414247, 'psi': 0.6885485959580597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=60 head_norm_before_train=2.176216 cos_to_last_merge=0.9981 (last merge round=43)
[S14] round=60 local utility u=0.004057 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988366057049543, 'loss_val': 0.021480174470649472, 'psi': 0.9979663992707306}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969238428290419, 'loss_val': 0.0225294609137845, 'psi': 0.9970687129302719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=60 head_norm_before_train=2.278268 (no previous merge yet)
[S15] round=60 local utility u=0.428040 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9920624240850928, 'loss_val': 0.02119058253773101, 'psi': 0.9946502778202309}-{'f1_val': 0.9031293167126629, 'auprc': 0.965178966781075, 'loss_val': 0.23714265295387765, 'psi': 0.9279491767400277}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=60 head_norm_before_train=1.748465 cos_to_last_merge=0.9968 (last merge round=44)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8248492927804866, 'auprc': 0.9630018873242641, 'loss_val': 0.7355850075861825, 'psi': 0.8801103305979976}-{'f1_val': 0.9922852347148108, 'auprc': 0.9942559065804945, 'loss_val': 0.03961175257394763, 'psi': 0.9930735034610843}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=2.132521 cos_to_last_merge=0.9992 (last merge round=43)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6516267370470323, 'auprc': 0.9161628686946812, 'loss_val': 0.8862994669246353, 'psi': 0.757441189706092}-{'f1_val': 0.7006993984952898, 'auprc': 0.9008627676444975, 'loss_val': 0.7987381888632344, 'psi': 0.7807647461549729}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=1.923006 cos_to_last_merge=0.9973 (last merge round=43)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7080527970109329, 'auprc': 0.8950786139673487, 'loss_val': 0.6466144240969112, 'psi': 0.7828631237934993}-{'f1_val': 0.8112150613696328, 'auprc': 0.8399747147243206, 'loss_val': 0.5181120944159606, 'psi': 0.8227189227115079}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=1.837532 cos_to_last_merge=0.9829 (last merge round=44)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.873215203668291, 'auprc': 0.9678994871793434, 'loss_val': 0.3383821830786051, 'psi': 0.9110889170727119}-{'f1_val': 0.98171973132522, 'auprc': 0.9992409552114057, 'loss_val': 0.055500717472425694, 'psi': 0.9887282208796943}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.703282 cos_to_last_merge=0.9762 (last merge round=37)
[S4] round=61 local utility u=0.079645 metrics={'f1_val': 0.9538724961109101, 'auprc': 0.9631836360178385, 'loss_val': 0.27524287291589866, 'psi': 0.9575969520736815}-{'f1_val': 0.9453498786181936, 'auprc': 0.9332219736326578, 'loss_val': 0.29351149420554007, 'psi': 0.9404987166239793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=61 head_norm_before_train=1.934783 cos_to_last_merge=0.9870 (last merge round=44)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9989999551003323, 'loss_val': 0.029060214530718484, 'psi': 0.997884599240908}-{'f1_val': 0.9971410286679584, 'auprc': 0.999524290242473, 'loss_val': 0.027600646440682667, 'psi': 0.9980943332977642}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.612509 cos_to_last_merge=0.9628 (last merge round=45)
[S6] round=61 local utility u=0.224079 metrics={'f1_val': 0.6514540067829031, 'auprc': 0.8264960249973353, 'loss_val': 0.7736561883230428, 'psi': 0.721470814068676}-{'f1_val': 0.614790720977516, 'auprc': 0.8020552421987552, 'loss_val': 0.9285123018979287, 'psi': 0.6896965294660118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=61 head_norm_before_train=1.614120 cos_to_last_merge=0.9738 (last merge round=40)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5182073519297685, 'auprc': 0.7756399870863265, 'loss_val': 1.102002848582741, 'psi': 0.6211804059923918}-{'f1_val': 0.9268937262558441, 'auprc': 0.9899657558110102, 'loss_val': 0.16813919681939976, 'psi': 0.9521225380779106}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.777853 cos_to_last_merge=0.9950 (last merge round=44)
[S8] round=61 local utility u=0.000166 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9994138362117816, 'loss_val': 0.037194876788937535, 'psi': 0.9955018579636818}-{'f1_val': 0.9928938724649488, 'auprc': 0.9994093406041265, 'loss_val': 0.03751339015421516, 'psi': 0.9955000597206198}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=61 head_norm_before_train=2.283174 (no previous merge yet)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999359614733292, 'loss_val': 0.015869363197912333, 'psi': 0.9977370020275753}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999279924170612, 'loss_val': 0.015578539774276652, 'psi': 0.9982329444741102}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.386251 cos_to_last_merge=0.9979 (last merge round=43)
[S10] round=61 local utility u=0.000136 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9977384176002972, 'loss_val': 0.025574096654506367, 'psi': 0.9962080704517438}-{'f1_val': 0.9951878390193748, 'auprc': 0.9977109364870466, 'loss_val': 0.025763166740572715, 'psi': 0.9961970780064435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=61 head_norm_before_train=2.336202 cos_to_last_merge=0.9994 (last merge round=43)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9978401280601568, 'loss_val': 0.01755866242128433, 'psi': 0.9970788000913374}-{'f1_val': 0.9965712481121245, 'auprc': 0.9994371925529608, 'loss_val': 0.016398932500141388, 'psi': 0.997717625888459}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=2.123417 cos_to_last_merge=0.9953 (last merge round=37)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6071497725572708, 'auprc': 0.7241629400024073, 'loss_val': 1.0139191110558163, 'psi': 0.6539550395353253}-{'f1_val': 0.7290366125425873, 'auprc': 0.7828377632101444, 'loss_val': 0.8727226923505739, 'psi': 0.7505570728096103}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=2.174188 cos_to_last_merge=0.9981 (last merge round=43)
[S14] round=61 local utility u=0.000764 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992248653964086, 'loss_val': 0.021133743549772814, 'psi': 0.9981234212843018}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988366057049543, 'loss_val': 0.021480174470649472, 'psi': 0.9979663992707306}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=61 head_norm_before_train=2.283030 (no previous merge yet)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7781975002951323, 'auprc': 0.9008175459115352, 'loss_val': 0.4700285509815226, 'psi': 0.8272455185416935}-{'f1_val': 0.9963755136436562, 'auprc': 0.9920624240850928, 'loss_val': 0.02119058253773101, 'psi': 0.9946502778202309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.754928 cos_to_last_merge=0.9966 (last merge round=44)
[S16] round=61 local utility u=0.897695 metrics={'f1_val': 0.9922852347148108, 'auprc': 0.994404481332901, 'loss_val': 0.039018532575159345, 'psi': 0.9931329333620469}-{'f1_val': 0.8248492927804866, 'auprc': 0.9630018873242641, 'loss_val': 0.7355850075861825, 'psi': 0.8801103305979976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=61 head_norm_before_train=2.138881 cos_to_last_merge=0.9990 (last merge round=43)
[S17] round=61 local utility u=0.071858 metrics={'f1_val': 0.6726178902875699, 'auprc': 0.9184217358034117, 'loss_val': 0.8753062699513281, 'psi': 0.7709394284939066}-{'f1_val': 0.6516267370470323, 'auprc': 0.9161628686946812, 'loss_val': 0.8862994669246353, 'psi': 0.757441189706092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=62 head_norm_before_train=1.929022 cos_to_last_merge=0.9972 (last merge round=43)
[S2] round=62 local utility u=0.102467 metrics={'f1_val': 0.7516560360052521, 'auprc': 0.8392631728867611, 'loss_val': 0.5358534162362255, 'psi': 0.7866988907578557}-{'f1_val': 0.7080527970109329, 'auprc': 0.8950786139673487, 'loss_val': 0.6466144240969112, 'psi': 0.7828631237934993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=62 head_norm_before_train=1.849993 cos_to_last_merge=0.9822 (last merge round=44)
[S3] round=62 local utility u=0.365044 metrics={'f1_val': 0.955586634794862, 'auprc': 0.9838200605303781, 'loss_val': 0.15028532106918907, 'psi': 0.9668800050890685}-{'f1_val': 0.873215203668291, 'auprc': 0.9678994871793434, 'loss_val': 0.3383821830786051, 'psi': 0.9110889170727119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=62 head_norm_before_train=1.710615 cos_to_last_merge=0.9754 (last merge round=37)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9499042337185105, 'auprc': 0.9350578203189619, 'loss_val': 0.2933356511644706, 'psi': 0.943965668358691}-{'f1_val': 0.9538724961109101, 'auprc': 0.9631836360178385, 'loss_val': 0.27524287291589866, 'psi': 0.9575969520736815}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.944998 cos_to_last_merge=0.9864 (last merge round=44)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9981120814522398, 'loss_val': 0.03591960111654008, 'psi': 0.9973085533619778}-{'f1_val': 0.9971410286679584, 'auprc': 0.9989999551003323, 'loss_val': 0.029060214530718484, 'psi': 0.997884599240908}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=1.622920 cos_to_last_merge=0.9612 (last merge round=45)
[S6] round=62 local utility u=1.000000 metrics={'f1_val': 0.9686346439981567, 'auprc': 0.9797830024981189, 'loss_val': 0.1355799844280667, 'psi': 0.9730939873981417}-{'f1_val': 0.6514540067829031, 'auprc': 0.8264960249973353, 'loss_val': 0.7736561883230428, 'psi': 0.721470814068676}
[S6] not sending this round → trigger blocked (psi=0.973)
[S7] START round=62 head_norm_before_train=1.619785 cos_to_last_merge=0.9728 (last merge round=40)
[S7] round=62 local utility u=1.000000 metrics={'f1_val': 0.7306346028393005, 'auprc': 0.9167878887032848, 'loss_val': 0.3395773181866984, 'psi': 0.8050959171848941}-{'f1_val': 0.5182073519297685, 'auprc': 0.7756399870863265, 'loss_val': 1.102002848582741, 'psi': 0.6211804059923918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=62 head_norm_before_train=1.786615 cos_to_last_merge=0.9946 (last merge round=44)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.999403525344434, 'loss_val': 0.043076287606579874, 'psi': 0.9937630344005559}-{'f1_val': 0.9928938724649488, 'auprc': 0.9994138362117816, 'loss_val': 0.037194876788937535, 'psi': 0.9955018579636818}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.288031 (no previous merge yet)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9999118618095423, 'loss_val': 0.015915553061811756, 'psi': 0.9974808272496102}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999359614733292, 'loss_val': 0.015869363197912333, 'psi': 0.9977370020275753}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.391912 cos_to_last_merge=0.9977 (last merge round=43)
[S10] round=62 local utility u=0.000499 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978893441079963, 'loss_val': 0.025029065717779027, 'psi': 0.9962684410548234}-{'f1_val': 0.9951878390193748, 'auprc': 0.9977384176002972, 'loss_val': 0.025574096654506367, 'psi': 0.9962080704517438}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=62 head_norm_before_train=2.341205 cos_to_last_merge=0.9994 (last merge round=43)
[S11] round=62 local utility u=0.002128 metrics={'f1_val': 0.9968129605654896, 'auprc': 0.9986503403084387, 'loss_val': 0.017183711843492832, 'psi': 0.9975479124626693}-{'f1_val': 0.9965712481121245, 'auprc': 0.9978401280601568, 'loss_val': 0.01755866242128433, 'psi': 0.9970788000913374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=62 head_norm_before_train=2.127975 cos_to_last_merge=0.9951 (last merge round=37)
[S13] round=62 local utility u=0.495610 metrics={'f1_val': 0.7205012422444159, 'auprc': 0.7436117507488439, 'loss_val': 0.7611538182322408, 'psi': 0.7297454456461872}-{'f1_val': 0.6071497725572708, 'auprc': 0.7241629400024073, 'loss_val': 1.0139191110558163, 'psi': 0.6539550395353253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=62 head_norm_before_train=2.177181 cos_to_last_merge=0.9979 (last merge round=43)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9992259687807945, 'loss_val': 0.021305065970821838, 'psi': 0.9978908154408646}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992248653964086, 'loss_val': 0.021133743549772814, 'psi': 0.9981234212843018}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=2.287245 (no previous merge yet)
[S15] round=62 local utility u=0.983253 metrics={'f1_val': 0.9840546292631226, 'auprc': 0.9989256102551888, 'loss_val': 0.03298942542944686, 'psi': 0.990003021659949}-{'f1_val': 0.7781975002951323, 'auprc': 0.9008175459115352, 'loss_val': 0.4700285509815226, 'psi': 0.8272455185416935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=62 head_norm_before_train=1.760422 cos_to_last_merge=0.9963 (last merge round=44)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9922485786660792, 'auprc': 0.9865273762300263, 'loss_val': 0.03977495732435585, 'psi': 0.989960097691658}-{'f1_val': 0.9922852347148108, 'auprc': 0.994404481332901, 'loss_val': 0.039018532575159345, 'psi': 0.9931329333620469}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.145698 cos_to_last_merge=0.9988 (last merge round=43)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.670636828010102, 'auprc': 0.913540969222765, 'loss_val': 0.960279612295099, 'psi': 0.7677984844951673}-{'f1_val': 0.6726178902875699, 'auprc': 0.9184217358034117, 'loss_val': 0.8753062699513281, 'psi': 0.7709394284939066}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.935707 cos_to_last_merge=0.9970 (last merge round=43)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.7089136476232363, 'auprc': 0.8812866543162441, 'loss_val': 0.6246431831360321, 'psi': 0.7778628503004394}-{'f1_val': 0.7516560360052521, 'auprc': 0.8392631728867611, 'loss_val': 0.5358534162362255, 'psi': 0.7866988907578557}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=1.862622 cos_to_last_merge=0.9814 (last merge round=44)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.7596616105529174, 'auprc': 0.9647915443355064, 'loss_val': 0.6655082898486909, 'psi': 0.841713584065953}-{'f1_val': 0.955586634794862, 'auprc': 0.9838200605303781, 'loss_val': 0.15028532106918907, 'psi': 0.9668800050890685}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.716494 cos_to_last_merge=0.9749 (last merge round=37)
[S4] round=63 local utility u=0.037014 metrics={'f1_val': 0.9504721626646218, 'auprc': 0.957110471644197, 'loss_val': 0.2888735588548338, 'psi': 0.9531274862564518}-{'f1_val': 0.9499042337185105, 'auprc': 0.9350578203189619, 'loss_val': 0.2933356511644706, 'psi': 0.943965668358691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=63 head_norm_before_train=1.960010 cos_to_last_merge=0.9854 (last merge round=44)
[S5] round=63 local utility u=0.005128 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9987073058739016, 'loss_val': 0.027024453295511012, 'psi': 0.9975041034366352}-{'f1_val': 0.9967728679684698, 'auprc': 0.9981120814522398, 'loss_val': 0.03591960111654008, 'psi': 0.9973085533619778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=63 head_norm_before_train=1.629174 cos_to_last_merge=0.9605 (last merge round=45)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.6141421858559865, 'auprc': 0.8560399357879902, 'loss_val': 0.8782167450478383, 'psi': 0.710901285828788}-{'f1_val': 0.9686346439981567, 'auprc': 0.9797830024981189, 'loss_val': 0.1355799844280667, 'psi': 0.9730939873981417}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.625004 cos_to_last_merge=0.9722 (last merge round=40)
[S7] round=63 local utility u=0.018542 metrics={'f1_val': 0.6982718644240038, 'auprc': 0.9800164816835333, 'loss_val': 0.2980032436166156, 'psi': 0.8109697113278156}-{'f1_val': 0.7306346028393005, 'auprc': 0.9167878887032848, 'loss_val': 0.3395773181866984, 'psi': 0.8050959171848941}
[S7] not sending this round → trigger blocked (psi=0.811)
[S8] START round=63 head_norm_before_train=1.793162 cos_to_last_merge=0.9943 (last merge round=44)
[S8] round=63 local utility u=0.008165 metrics={'f1_val': 0.992032490903249, 'auprc': 0.9991751808160976, 'loss_val': 0.038240926924866886, 'psi': 0.9948895668683884}-{'f1_val': 0.9900027071046373, 'auprc': 0.999403525344434, 'loss_val': 0.043076287606579874, 'psi': 0.9937630344005559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=63 head_norm_before_train=2.288537 (no previous merge yet)
[S9] round=63 local utility u=0.000249 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999887596332264, 'loss_val': 0.017809696530043394, 'psi': 0.9977176559711493}-{'f1_val': 0.9958601375429889, 'auprc': 0.9999118618095423, 'loss_val': 0.015915553061811756, 'psi': 0.9974808272496102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=63 head_norm_before_train=2.397947 cos_to_last_merge=0.9976 (last merge round=43)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976570550644404, 'loss_val': 0.025536278573189772, 'psi': 0.996175525437401}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978893441079963, 'loss_val': 0.025029065717779027, 'psi': 0.9962684410548234}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=2.345761 cos_to_last_merge=0.9993 (last merge round=43)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9936883215526718, 'auprc': 0.9985118221847405, 'loss_val': 0.03197695481716518, 'psi': 0.9956177218054993}-{'f1_val': 0.9968129605654896, 'auprc': 0.9986503403084387, 'loss_val': 0.017183711843492832, 'psi': 0.9975479124626693}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=2.132014 cos_to_last_merge=0.9948 (last merge round=37)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.670880924822775, 'auprc': 0.7535630138250715, 'loss_val': 0.8349406807593781, 'psi': 0.7039537604236936}-{'f1_val': 0.7205012422444159, 'auprc': 0.7436117507488439, 'loss_val': 0.7611538182322408, 'psi': 0.7297454456461872}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=2.181768 cos_to_last_merge=0.9978 (last merge round=43)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9347692789129906, 'auprc': 0.9982794545222844, 'loss_val': 0.10236389301227686, 'psi': 0.9601733491567082}-{'f1_val': 0.9970007132142444, 'auprc': 0.9992259687807945, 'loss_val': 0.021305065970821838, 'psi': 0.9978908154408646}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.291044 (no previous merge yet)
[S15] round=63 local utility u=0.043883 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975993908713433, 'loss_val': 0.017397996621075246, 'psi': 0.9970877573810497}-{'f1_val': 0.9840546292631226, 'auprc': 0.9989256102551888, 'loss_val': 0.03298942542944686, 'psi': 0.990003021659949}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=63 head_norm_before_train=1.767024 cos_to_last_merge=0.9961 (last merge round=44)
[S16] round=63 local utility u=0.014396 metrics={'f1_val': 0.9927032863016021, 'auprc': 0.9947748044471885, 'loss_val': 0.038454433162614904, 'psi': 0.9935318935598366}-{'f1_val': 0.9922485786660792, 'auprc': 0.9865273762300263, 'loss_val': 0.03977495732435585, 'psi': 0.989960097691658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=63 head_norm_before_train=2.152132 cos_to_last_merge=0.9987 (last merge round=43)
[S17] round=63 local utility u=0.390585 metrics={'f1_val': 0.7517605298957104, 'auprc': 0.92273266286063, 'loss_val': 0.6934260732712837, 'psi': 0.8201493830816783}-{'f1_val': 0.670636828010102, 'auprc': 0.913540969222765, 'loss_val': 0.960279612295099, 'psi': 0.7677984844951673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=64 head_norm_before_train=1.941052 cos_to_last_merge=0.9969 (last merge round=43)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.7108779372996205, 'auprc': 0.8726392756518258, 'loss_val': 0.6334695750967064, 'psi': 0.7755824726405026}-{'f1_val': 0.7089136476232363, 'auprc': 0.8812866543162441, 'loss_val': 0.6246431831360321, 'psi': 0.7778628503004394}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=1.874920 cos_to_last_merge=0.9806 (last merge round=44)
[S3] round=64 local utility u=0.628825 metrics={'f1_val': 0.8847640112061381, 'auprc': 0.9954349807475448, 'loss_val': 0.25040341715266706, 'psi': 0.9290323990227008}-{'f1_val': 0.7596616105529174, 'auprc': 0.9647915443355064, 'loss_val': 0.6655082898486909, 'psi': 0.841713584065953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=64 head_norm_before_train=1.721980 cos_to_last_merge=0.9744 (last merge round=37)
[S4] round=64 local utility u=0.022165 metrics={'f1_val': 0.9524076419658924, 'auprc': 0.9663897581007932, 'loss_val': 0.28399484354074517, 'psi': 0.9580004884198527}-{'f1_val': 0.9504721626646218, 'auprc': 0.957110471644197, 'loss_val': 0.2888735588548338, 'psi': 0.9531274862564518}
[S4] not sending this round → trigger blocked (psi=0.958)
[S5] START round=64 head_norm_before_train=1.965871 cos_to_last_merge=0.9849 (last merge round=44)
[S5] round=64 local utility u=0.000946 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9988463637096432, 'loss_val': 0.02555038208793446, 'psi': 0.997559726570932}-{'f1_val': 0.9967019684784577, 'auprc': 0.9987073058739016, 'loss_val': 0.027024453295511012, 'psi': 0.9975041034366352}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=64 head_norm_before_train=1.633458 cos_to_last_merge=0.9599 (last merge round=45)
[S6] round=64 local utility u=0.793137 metrics={'f1_val': 0.7789213432549547, 'auprc': 0.9488057589626697, 'loss_val': 0.5589143662450192, 'psi': 0.8468751095380407}-{'f1_val': 0.6141421858559865, 'auprc': 0.8560399357879902, 'loss_val': 0.8782167450478383, 'psi': 0.710901285828788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=64 head_norm_before_train=1.631758 cos_to_last_merge=0.9714 (last merge round=40)
[S7] round=64 local utility u=0.744256 metrics={'f1_val': 0.9302769376939838, 'auprc': 0.9843573546771686, 'loss_val': 0.214545221519796, 'psi': 0.9519091044872577}-{'f1_val': 0.6982718644240038, 'auprc': 0.9800164816835333, 'loss_val': 0.2980032436166156, 'psi': 0.8109697113278156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=64 head_norm_before_train=1.798535 cos_to_last_merge=0.9940 (last merge round=44)
[S8] round=64 local utility u=0.002715 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9989563655264942, 'loss_val': 0.03646119554280713, 'psi': 0.9952327252694899}-{'f1_val': 0.992032490903249, 'auprc': 0.9991751808160976, 'loss_val': 0.038240926924866886, 'psi': 0.9948895668683884}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=64 head_norm_before_train=2.295349 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.9998884473382902, 'loss_val': 0.027643593093041326, 'psi': 0.9949547350974521}-{'f1_val': 0.9962710290637395, 'auprc': 0.999887596332264, 'loss_val': 0.017809696530043394, 'psi': 0.9977176559711493}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.401813 cos_to_last_merge=0.9974 (last merge round=43)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9975836335295813, 'loss_val': 0.025547623575957253, 'psi': 0.9961461568234573}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976570550644404, 'loss_val': 0.025536278573189772, 'psi': 0.996175525437401}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=2.347611 cos_to_last_merge=0.9993 (last merge round=43)
[S11] round=64 local utility u=0.016165 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9984773210009621, 'loss_val': 0.016840150618384588, 'psi': 0.9973336772676595}-{'f1_val': 0.9936883215526718, 'auprc': 0.9985118221847405, 'loss_val': 0.03197695481716518, 'psi': 0.9956177218054993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=64 head_norm_before_train=2.136205 cos_to_last_merge=0.9946 (last merge round=37)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6343788554629701, 'auprc': 0.7679756660129251, 'loss_val': 1.034197983476856, 'psi': 0.6878175796829521}-{'f1_val': 0.670880924822775, 'auprc': 0.7535630138250715, 'loss_val': 0.8349406807593781, 'psi': 0.7039537604236936}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.184457 cos_to_last_merge=0.9978 (last merge round=43)
[S14] round=64 local utility u=0.230683 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992287972437207, 'loss_val': 0.019695376428642795, 'psi': 0.9981381154581852}-{'f1_val': 0.9347692789129906, 'auprc': 0.9982794545222844, 'loss_val': 0.10236389301227686, 'psi': 0.9601733491567082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=64 head_norm_before_train=2.295225 (no previous merge yet)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985797127454342, 'loss_val': 0.02415334641757, 'psi': 0.997479886130686}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975993908713433, 'loss_val': 0.017397996621075246, 'psi': 0.9970877573810497}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.774689 cos_to_last_merge=0.9958 (last merge round=44)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9915550722228358, 'auprc': 0.9970139061283269, 'loss_val': 0.04091918698706089, 'psi': 0.9937386057850321}-{'f1_val': 0.9927032863016021, 'auprc': 0.9947748044471885, 'loss_val': 0.038454433162614904, 'psi': 0.9935318935598366}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=2.159232 cos_to_last_merge=0.9985 (last merge round=43)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6399828874305884, 'auprc': 0.8188868652617644, 'loss_val': 1.45623960048928, 'psi': 0.7115444785630588}-{'f1_val': 0.7517605298957104, 'auprc': 0.92273266286063, 'loss_val': 0.6934260732712837, 'psi': 0.8201493830816783}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=1.947515 cos_to_last_merge=0.9967 (last merge round=43)
[S2] round=65 local utility u=0.008599 metrics={'f1_val': 0.713839203133497, 'auprc': 0.8728852807908198, 'loss_val': 0.6347763745121847, 'psi': 0.7774576341964261}-{'f1_val': 0.7108779372996205, 'auprc': 0.8726392756518258, 'loss_val': 0.6334695750967064, 'psi': 0.7755824726405026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=65 head_norm_before_train=1.884622 cos_to_last_merge=0.9800 (last merge round=44)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.8083348812873501, 'auprc': 0.9661803451060031, 'loss_val': 0.4928710621521601, 'psi': 0.8714730668148113}-{'f1_val': 0.8847640112061381, 'auprc': 0.9954349807475448, 'loss_val': 0.25040341715266706, 'psi': 0.9290323990227008}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.729418 cos_to_last_merge=0.9737 (last merge round=37)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9480632043798566, 'auprc': 0.9628334445994959, 'loss_val': 0.289620731752833, 'psi': 0.9539713004677123}-{'f1_val': 0.9524076419658924, 'auprc': 0.9663897581007932, 'loss_val': 0.28399484354074517, 'psi': 0.9580004884198527}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.974038 cos_to_last_merge=0.9844 (last merge round=44)
[S5] round=65 local utility u=0.002658 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9994499897058067, 'loss_val': 0.024679662169992657, 'psi': 0.9980646130830977}-{'f1_val': 0.9967019684784577, 'auprc': 0.9988463637096432, 'loss_val': 0.02555038208793446, 'psi': 0.997559726570932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=65 head_norm_before_train=1.638189 cos_to_last_merge=0.9592 (last merge round=45)
[S6] round=65 local utility u=0.287010 metrics={'f1_val': 0.8413350942024539, 'auprc': 0.9550001291692698, 'loss_val': 0.3779601001865227, 'psi': 0.8868011081891802}-{'f1_val': 0.7789213432549547, 'auprc': 0.9488057589626697, 'loss_val': 0.5589143662450192, 'psi': 0.8468751095380407}
[S6] not sending this round → trigger blocked (psi=0.887)
[S7] START round=65 head_norm_before_train=1.640048 cos_to_last_merge=0.9705 (last merge round=40)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.68330910148765, 'auprc': 0.915593389193663, 'loss_val': 0.3665816812133444, 'psi': 0.7762228165700551}-{'f1_val': 0.9302769376939838, 'auprc': 0.9843573546771686, 'loss_val': 0.214545221519796, 'psi': 0.9519091044872577}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.802872 cos_to_last_merge=0.9937 (last merge round=44)
[S8] round=65 local utility u=0.000665 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9991495063367495, 'loss_val': 0.03662301724803256, 'psi': 0.9954012560938854}-{'f1_val': 0.992750298431487, 'auprc': 0.9989563655264942, 'loss_val': 0.03646119554280713, 'psi': 0.9952327252694899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=65 head_norm_before_train=2.303382 (no previous merge yet)
[S9] round=65 local utility u=0.017598 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.999893010770597, 'loss_val': 0.017427906657520673, 'psi': 0.99745323532675}-{'f1_val': 0.9916655936035601, 'auprc': 0.9998884473382902, 'loss_val': 0.027643593093041326, 'psi': 0.9949547350974521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=65 head_norm_before_train=2.406370 cos_to_last_merge=0.9973 (last merge round=43)
[S10] round=65 local utility u=0.000121 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976232662248135, 'loss_val': 0.02542494530480224, 'psi': 0.9961620099015502}-{'f1_val': 0.9951878390193748, 'auprc': 0.9975836335295813, 'loss_val': 0.025547623575957253, 'psi': 0.9961461568234573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=65 head_norm_before_train=2.350669 cos_to_last_merge=0.9992 (last merge round=43)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9980440555289525, 'loss_val': 0.01710785331621389, 'psi': 0.9971603710788557}-{'f1_val': 0.9965712481121245, 'auprc': 0.9984773210009621, 'loss_val': 0.016840150618384588, 'psi': 0.9973336772676595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=2.140128 cos_to_last_merge=0.9944 (last merge round=37)
[S13] round=65 local utility u=0.258998 metrics={'f1_val': 0.6727181846725666, 'auprc': 0.7605735564831139, 'loss_val': 0.7240325031942746, 'psi': 0.7078603333967856}-{'f1_val': 0.6343788554629701, 'auprc': 0.7679756660129251, 'loss_val': 1.034197983476856, 'psi': 0.6878175796829521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=65 head_norm_before_train=2.188384 cos_to_last_merge=0.9976 (last merge round=43)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9992239462698939, 'loss_val': 0.02141346494227456, 'psi': 0.9978900064365042}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992287972437207, 'loss_val': 0.019695376428642795, 'psi': 0.9981381154581852}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=2.300417 (no previous merge yet)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9201259419329781, 'auprc': 0.9986428895830626, 'loss_val': 0.09615386373795991, 'psi': 0.9515327209930119}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985797127454342, 'loss_val': 0.02415334641757, 'psi': 0.997479886130686}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.782539 cos_to_last_merge=0.9955 (last merge round=44)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9911361313038187, 'auprc': 0.996203353176879, 'loss_val': 0.04175971550042975, 'psi': 0.9931630200530428}-{'f1_val': 0.9915550722228358, 'auprc': 0.9970139061283269, 'loss_val': 0.04091918698706089, 'psi': 0.9937386057850321}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=2.166627 cos_to_last_merge=0.9983 (last merge round=43)
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6098035265459573, 'auprc': 0.7931955738879056, 'loss_val': 1.6749415173969289, 'psi': 0.6831603454827366}-{'f1_val': 0.6399828874305884, 'auprc': 0.8188868652617644, 'loss_val': 1.45623960048928, 'psi': 0.7115444785630588}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.954880 cos_to_last_merge=0.9966 (last merge round=43)
[S2] round=66 local utility u=0.260849 metrics={'f1_val': 0.8071203969492508, 'auprc': 0.8297109088182532, 'loss_val': 0.5432420434266588, 'psi': 0.8161566016968518}-{'f1_val': 0.713839203133497, 'auprc': 0.8728852807908198, 'loss_val': 0.6347763745121847, 'psi': 0.7774576341964261}
[S2] not sending this round → trigger blocked (psi=0.816)
[S3] START round=66 head_norm_before_train=1.894583 cos_to_last_merge=0.9794 (last merge round=44)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.7565854448638454, 'auprc': 0.9661603745755725, 'loss_val': 0.5990293852563316, 'psi': 0.8404154167485363}-{'f1_val': 0.8083348812873501, 'auprc': 0.9661803451060031, 'loss_val': 0.4928710621521601, 'psi': 0.8714730668148113}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=1.739317 cos_to_last_merge=0.9729 (last merge round=37)
[S4] round=66 local utility u=0.038333 metrics={'f1_val': 0.9564981217372879, 'auprc': 0.9670557598348948, 'loss_val': 0.2762314629021242, 'psi': 0.9607211769763306}-{'f1_val': 0.9480632043798566, 'auprc': 0.9628334445994959, 'loss_val': 0.289620731752833, 'psi': 0.9539713004677123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=66 head_norm_before_train=1.982923 cos_to_last_merge=0.9837 (last merge round=44)
[S5] round=66 local utility u=0.000023 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9994809522064861, 'loss_val': 0.024725812376419805, 'psi': 0.9980769980833695}-{'f1_val': 0.9971410286679584, 'auprc': 0.9994499897058067, 'loss_val': 0.024679662169992657, 'psi': 0.9980646130830977}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=66 head_norm_before_train=1.645569 cos_to_last_merge=0.9581 (last merge round=45)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.601363778483958, 'auprc': 0.9096475225026143, 'loss_val': 0.8946992395696282, 'psi': 0.7246772760914204}-{'f1_val': 0.8413350942024539, 'auprc': 0.9550001291692698, 'loss_val': 0.3779601001865227, 'psi': 0.8868011081891802}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.650983 cos_to_last_merge=0.9693 (last merge round=40)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6192017261877379, 'auprc': 0.8118436562805437, 'loss_val': 0.538924612679439, 'psi': 0.6962584982248603}-{'f1_val': 0.68330910148765, 'auprc': 0.915593389193663, 'loss_val': 0.3665816812133444, 'psi': 0.7762228165700551}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.809776 cos_to_last_merge=0.9934 (last merge round=44)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9871538275294434, 'auprc': 0.9989215468207084, 'loss_val': 0.05010311121764644, 'psi': 0.9918609152459494}-{'f1_val': 0.9929024225986427, 'auprc': 0.9991495063367495, 'loss_val': 0.03662301724803256, 'psi': 0.9954012560938854}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.310352 (no previous merge yet)
[S9] round=66 local utility u=0.003387 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998994726474033, 'loss_val': 0.01567540811601476, 'psi': 0.9979560961472962}-{'f1_val': 0.9958267183641853, 'auprc': 0.999893010770597, 'loss_val': 0.017427906657520673, 'psi': 0.99745323532675}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=66 head_norm_before_train=2.411694 cos_to_last_merge=0.9971 (last merge round=43)
[S10] round=66 local utility u=0.001031 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979546621830442, 'loss_val': 0.02435637953525334, 'psi': 0.9962945682848425}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976232662248135, 'loss_val': 0.02542494530480224, 'psi': 0.9961620099015502}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=66 head_norm_before_train=2.354772 cos_to_last_merge=0.9992 (last merge round=43)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9978503656327193, 'loss_val': 0.017439506392577273, 'psi': 0.9970828951203625}-{'f1_val': 0.9965712481121245, 'auprc': 0.9980440555289525, 'loss_val': 0.01710785331621389, 'psi': 0.9971603710788557}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=2.144886 cos_to_last_merge=0.9942 (last merge round=37)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6919351036994917, 'auprc': 0.652528528872717, 'loss_val': 1.0720834005330764, 'psi': 0.6761724737687818}-{'f1_val': 0.6727181846725666, 'auprc': 0.7605735564831139, 'loss_val': 0.7240325031942746, 'psi': 0.7078603333967856}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.191757 cos_to_last_merge=0.9974 (last merge round=43)
[S14] round=66 local utility u=0.001010 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991736354116632, 'loss_val': 0.021704301125348813, 'psi': 0.9981160507253621}-{'f1_val': 0.9970007132142444, 'auprc': 0.9992239462698939, 'loss_val': 0.02141346494227456, 'psi': 0.9978900064365042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=66 head_norm_before_train=2.305912 (no previous merge yet)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9130778639503965, 'auprc': 0.9983505251485101, 'loss_val': 0.11995286483593857, 'psi': 0.9471869284296419}-{'f1_val': 0.9201259419329781, 'auprc': 0.9986428895830626, 'loss_val': 0.09615386373795991, 'psi': 0.9515327209930119}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.790089 cos_to_last_merge=0.9953 (last merge round=44)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.9918969789708006, 'auprc': 0.9911491239095982, 'loss_val': 0.03810747361127267, 'psi': 0.9915978369463196}-{'f1_val': 0.9911361313038187, 'auprc': 0.996203353176879, 'loss_val': 0.04175971550042975, 'psi': 0.9931630200530428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=2.169777 cos_to_last_merge=0.9982 (last merge round=43)
[S17] round=66 local utility u=1.000000 metrics={'f1_val': 0.8382575052899333, 'auprc': 0.9686631847339682, 'loss_val': 0.4352771038507627, 'psi': 0.8904197770675473}-{'f1_val': 0.6098035265459573, 'auprc': 0.7931955738879056, 'loss_val': 1.6749415173969289, 'psi': 0.6831603454827366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=67 head_norm_before_train=1.962353 cos_to_last_merge=0.9964 (last merge round=43)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.6580427302456325, 'auprc': 0.7727374383231872, 'loss_val': 1.141044215774976, 'psi': 0.7039206134766545}-{'f1_val': 0.8071203969492508, 'auprc': 0.8297109088182532, 'loss_val': 0.5432420434266588, 'psi': 0.8161566016968518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=1.905764 cos_to_last_merge=0.9787 (last merge round=44)
[S3] round=67 local utility u=0.610566 metrics={'f1_val': 0.8905821361132411, 'auprc': 0.9856787799249365, 'loss_val': 0.24043247691173378, 'psi': 0.9286207936379192}-{'f1_val': 0.7565854448638454, 'auprc': 0.9661603745755725, 'loss_val': 0.5990293852563316, 'psi': 0.8404154167485363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=67 head_norm_before_train=1.747879 cos_to_last_merge=0.9721 (last merge round=37)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.94883445088756, 'auprc': 0.9244148730483395, 'loss_val': 0.29707314647990496, 'psi': 0.9390666197518718}-{'f1_val': 0.9564981217372879, 'auprc': 0.9670557598348948, 'loss_val': 0.2762314629021242, 'psi': 0.9607211769763306}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.990801 cos_to_last_merge=0.9829 (last merge round=44)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9988191266597304, 'loss_val': 0.029952444541170728, 'psi': 0.997591371444974}-{'f1_val': 0.9971410286679584, 'auprc': 0.9994809522064861, 'loss_val': 0.024725812376419805, 'psi': 0.9980769980833695}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.653311 cos_to_last_merge=0.9570 (last merge round=45)
[S6] round=67 local utility u=1.000000 metrics={'f1_val': 0.8475029632001692, 'auprc': 0.9357502453115187, 'loss_val': 0.43888032270991484, 'psi': 0.8828018760447089}-{'f1_val': 0.601363778483958, 'auprc': 0.9096475225026143, 'loss_val': 0.8946992395696282, 'psi': 0.7246772760914204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=67 head_norm_before_train=1.664257 cos_to_last_merge=0.9678 (last merge round=40)
[S7] round=67 local utility u=0.083576 metrics={'f1_val': 0.6165137551444753, 'auprc': 0.8767581019789752, 'loss_val': 0.5503880031414536, 'psi': 0.7206114938782753}-{'f1_val': 0.6192017261877379, 'auprc': 0.8118436562805437, 'loss_val': 0.538924612679439, 'psi': 0.6962584982248603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=67 head_norm_before_train=1.817012 cos_to_last_merge=0.9930 (last merge round=44)
[S8] round=67 local utility u=0.013439 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9903992719466268, 'loss_val': 0.03674051939950269, 'psi': 0.9923602965897904}-{'f1_val': 0.9871538275294434, 'auprc': 0.9989215468207084, 'loss_val': 0.05010311121764644, 'psi': 0.9918609152459494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=67 head_norm_before_train=2.317492 (no previous merge yet)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9997656584952589, 'loss_val': 0.0179852136320696, 'psi': 0.9971527561512405}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998994726474033, 'loss_val': 0.01567540811601476, 'psi': 0.9979560961472962}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.417360 cos_to_last_merge=0.9970 (last merge round=43)
[S10] round=67 local utility u=0.001660 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9984336116223513, 'loss_val': 0.023643685335212914, 'psi': 0.9966032549739599}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979546621830442, 'loss_val': 0.02435637953525334, 'psi': 0.9962945682848425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=67 head_norm_before_train=2.359229 cos_to_last_merge=0.9991 (last merge round=43)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9939279545461042, 'auprc': 0.9989144634944257, 'loss_val': 0.020775520299004074, 'psi': 0.9959225581254328}-{'f1_val': 0.9965712481121245, 'auprc': 0.9978503656327193, 'loss_val': 0.017439506392577273, 'psi': 0.9970828951203625}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=2.149691 cos_to_last_merge=0.9939 (last merge round=37)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6918502921608491, 'auprc': 0.6639578978740827, 'loss_val': 1.1152430327556235, 'psi': 0.6806933344461426}-{'f1_val': 0.6919351036994917, 'auprc': 0.652528528872717, 'loss_val': 1.0720834005330764, 'psi': 0.6761724737687818}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=2.196554 cos_to_last_merge=0.9972 (last merge round=43)
[S14] round=67 local utility u=0.000132 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992178769548937, 'loss_val': 0.02144115884077761, 'psi': 0.9981206259076958}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991736354116632, 'loss_val': 0.021704301125348813, 'psi': 0.9981160507253621}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=67 head_norm_before_train=2.311335 (no previous merge yet)
[S15] round=67 local utility u=0.300380 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974129991491986, 'loss_val': 0.018392170723287853, 'psi': 0.9970132006921918}-{'f1_val': 0.9130778639503965, 'auprc': 0.9983505251485101, 'loss_val': 0.11995286483593857, 'psi': 0.9471869284296419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=67 head_norm_before_train=1.794022 cos_to_last_merge=0.9951 (last merge round=44)
[S16] round=67 local utility u=0.004535 metrics={'f1_val': 0.9914321359471406, 'auprc': 0.9952848711821595, 'loss_val': 0.038655739003751785, 'psi': 0.9929732300411482}-{'f1_val': 0.9918969789708006, 'auprc': 0.9911491239095982, 'loss_val': 0.03810747361127267, 'psi': 0.9915978369463196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=67 head_norm_before_train=2.170891 cos_to_last_merge=0.9982 (last merge round=43)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.649560932777177, 'auprc': 0.918212194577893, 'loss_val': 0.8526280646450436, 'psi': 0.7570214374974634}-{'f1_val': 0.8382575052899333, 'auprc': 0.9686631847339682, 'loss_val': 0.4352771038507627, 'psi': 0.8904197770675473}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=1.969491 cos_to_last_merge=0.9962 (last merge round=43)
[S2] round=68 local utility u=0.749099 metrics={'f1_val': 0.7736326709848744, 'auprc': 0.8412117593869226, 'loss_val': 0.5418080013267791, 'psi': 0.8006643063456937}-{'f1_val': 0.6580427302456325, 'auprc': 0.7727374383231872, 'loss_val': 1.141044215774976, 'psi': 0.7039206134766545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=68 head_norm_before_train=1.917864 cos_to_last_merge=0.9779 (last merge round=44)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.7738165062798893, 'auprc': 0.9660182178132044, 'loss_val': 0.5956014590422233, 'psi': 0.8506971908932153}-{'f1_val': 0.8905821361132411, 'auprc': 0.9856787799249365, 'loss_val': 0.24043247691173378, 'psi': 0.9286207936379192}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.752089 cos_to_last_merge=0.9715 (last merge round=37)
[S4] round=68 local utility u=0.025621 metrics={'f1_val': 0.9510989689351391, 'auprc': 0.9357479905430833, 'loss_val': 0.2934166858212082, 'psi': 0.9449585775783167}-{'f1_val': 0.94883445088756, 'auprc': 0.9244148730483395, 'loss_val': 0.29707314647990496, 'psi': 0.9390666197518718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=68 head_norm_before_train=1.996293 cos_to_last_merge=0.9822 (last merge round=44)
[S5] round=68 local utility u=0.004036 metrics={'f1_val': 0.9975805015905128, 'auprc': 0.9996908610319291, 'loss_val': 0.029341591600779367, 'psi': 0.9984246453670793}-{'f1_val': 0.9967728679684698, 'auprc': 0.9988191266597304, 'loss_val': 0.029952444541170728, 'psi': 0.997591371444974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=68 head_norm_before_train=1.662472 cos_to_last_merge=0.9558 (last merge round=45)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7645792255603026, 'auprc': 0.9516696349550668, 'loss_val': 0.5071262771027342, 'psi': 0.8394153893182082}-{'f1_val': 0.8475029632001692, 'auprc': 0.9357502453115187, 'loss_val': 0.43888032270991484, 'psi': 0.8828018760447089}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.677980 cos_to_last_merge=0.9662 (last merge round=40)
[S7] round=68 local utility u=0.480035 metrics={'f1_val': 0.7490893079854536, 'auprc': 0.9355393058067065, 'loss_val': 0.5621153235516941, 'psi': 0.8236693071139547}-{'f1_val': 0.6165137551444753, 'auprc': 0.8767581019789752, 'loss_val': 0.5503880031414536, 'psi': 0.7206114938782753}
[S7] not sending this round → trigger blocked (psi=0.824)
[S8] START round=68 head_norm_before_train=1.824082 cos_to_last_merge=0.9926 (last merge round=44)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9993270162215571, 'loss_val': 0.04314156080438331, 'psi': 0.9935164029729933}-{'f1_val': 0.9936676463518993, 'auprc': 0.9903992719466268, 'loss_val': 0.03674051939950269, 'psi': 0.9923602965897904}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.324122 (no previous merge yet)
[S9] round=68 local utility u=0.003211 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980203906111422, 'loss_val': 0.01647971670741786, 'psi': 0.9974699037517426}-{'f1_val': 0.9954108212552283, 'auprc': 0.9997656584952589, 'loss_val': 0.0179852136320696, 'psi': 0.9971527561512405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=68 head_norm_before_train=2.423239 cos_to_last_merge=0.9968 (last merge round=43)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9974992044327615, 'loss_val': 0.025278430170355082, 'psi': 0.9961123851847294}-{'f1_val': 0.9953830172083656, 'auprc': 0.9984336116223513, 'loss_val': 0.023643685335212914, 'psi': 0.9966032549739599}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.363282 cos_to_last_merge=0.9991 (last merge round=43)
[S11] round=68 local utility u=0.007576 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9976446310936712, 'loss_val': 0.01767346155202014, 'psi': 0.9970006013047432}-{'f1_val': 0.9939279545461042, 'auprc': 0.9989144634944257, 'loss_val': 0.020775520299004074, 'psi': 0.9959225581254328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=68 head_norm_before_train=2.152855 cos_to_last_merge=0.9938 (last merge round=37)
[S13] round=68 local utility u=0.199493 metrics={'f1_val': 0.6667222899937363, 'auprc': 0.7417571397042217, 'loss_val': 0.7988875115571453, 'psi': 0.6967362298779305}-{'f1_val': 0.6918502921608491, 'auprc': 0.6639578978740827, 'loss_val': 1.1152430327556235, 'psi': 0.6806933344461426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=68 head_norm_before_train=2.203151 cos_to_last_merge=0.9970 (last merge round=43)
[S14] round=68 local utility u=0.000198 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9991722271339236, 'loss_val': 0.023359022538930536, 'psi': 0.9983473970095061}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992178769548937, 'loss_val': 0.02144115884077761, 'psi': 0.9981206259076958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=68 head_norm_before_train=2.316191 (no previous merge yet)
[S15] round=68 local utility u=0.000371 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985634248473427, 'loss_val': 0.021100491925868693, 'psi': 0.9974733709714494}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974129991491986, 'loss_val': 0.018392170723287853, 'psi': 0.9970132006921918}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=68 head_norm_before_train=1.799259 cos_to_last_merge=0.9948 (last merge round=44)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.9918969789708006, 'auprc': 0.9904366894425566, 'loss_val': 0.03704878558476443, 'psi': 0.991312863159503}-{'f1_val': 0.9914321359471406, 'auprc': 0.9952848711821595, 'loss_val': 0.038655739003751785, 'psi': 0.9929732300411482}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=2.174824 cos_to_last_merge=0.9981 (last merge round=43)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.6241439199926726, 'auprc': 0.9037377312364772, 'loss_val': 1.0710560799122057, 'psi': 0.7359814444901944}-{'f1_val': 0.649560932777177, 'auprc': 0.918212194577893, 'loss_val': 0.8526280646450436, 'psi': 0.7570214374974634}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=1.976784 cos_to_last_merge=0.9960 (last merge round=43)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7209978614376121, 'auprc': 0.8610154917236645, 'loss_val': 0.7171821074156515, 'psi': 0.7770049135520332}-{'f1_val': 0.7736326709848744, 'auprc': 0.8412117593869226, 'loss_val': 0.5418080013267791, 'psi': 0.8006643063456937}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=1.929133 cos_to_last_merge=0.9772 (last merge round=44)
[S3] round=69 local utility u=0.951380 metrics={'f1_val': 0.9825120167788531, 'auprc': 0.999552621756013, 'loss_val': 0.045618286777994795, 'psi': 0.9893282587697171}-{'f1_val': 0.7738165062798893, 'auprc': 0.9660182178132044, 'loss_val': 0.5956014590422233, 'psi': 0.8506971908932153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=69 head_norm_before_train=1.756122 cos_to_last_merge=0.9709 (last merge round=37)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9509685688916617, 'auprc': 0.9271102293711156, 'loss_val': 0.2956773113516096, 'psi': 0.9414252330834434}-{'f1_val': 0.9510989689351391, 'auprc': 0.9357479905430833, 'loss_val': 0.2934166858212082, 'psi': 0.9449585775783167}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.996580 cos_to_last_merge=0.9816 (last merge round=44)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9959650868991299, 'auprc': 0.9979341771196425, 'loss_val': 0.03578434064691304, 'psi': 0.996752722987335}-{'f1_val': 0.9975805015905128, 'auprc': 0.9996908610319291, 'loss_val': 0.029341591600779367, 'psi': 0.9984246453670793}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.673950 cos_to_last_merge=0.9542 (last merge round=45)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7415825611984963, 'auprc': 0.9410422475749648, 'loss_val': 0.5203397105986668, 'psi': 0.8213664357490837}-{'f1_val': 0.7645792255603026, 'auprc': 0.9516696349550668, 'loss_val': 0.5071262771027342, 'psi': 0.8394153893182082}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.692422 cos_to_last_merge=0.9646 (last merge round=40)
[S7] round=69 local utility u=0.611337 metrics={'f1_val': 0.8944363722215067, 'auprc': 0.9792400354095967, 'loss_val': 0.3426258436355796, 'psi': 0.9283578374967427}-{'f1_val': 0.7490893079854536, 'auprc': 0.9355393058067065, 'loss_val': 0.5621153235516941, 'psi': 0.8236693071139547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=69 head_norm_before_train=1.830953 cos_to_last_merge=0.9922 (last merge round=44)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9753790605419683, 'auprc': 0.999358804559612, 'loss_val': 0.06835774948929492, 'psi': 0.9849709581490258}-{'f1_val': 0.9896426608072839, 'auprc': 0.9993270162215571, 'loss_val': 0.04314156080438331, 'psi': 0.9935164029729933}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.325310 (no previous merge yet)
[S9] round=69 local utility u=0.001462 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998450550777476, 'loss_val': 0.016375291276194207, 'psi': 0.9979343291194339}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980203906111422, 'loss_val': 0.01647971670741786, 'psi': 0.9974699037517426}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=69 head_norm_before_train=2.429050 cos_to_last_merge=0.9967 (last merge round=43)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958664386217055, 'loss_val': 0.025848157627046474, 'psi': 0.995459278860307}-{'f1_val': 0.9951878390193748, 'auprc': 0.9974992044327615, 'loss_val': 0.025278430170355082, 'psi': 0.9961123851847294}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=2.367476 cos_to_last_merge=0.9990 (last merge round=43)
[S11] round=69 local utility u=0.001112 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9981828284656961, 'loss_val': 0.01706489084503127, 'psi': 0.9972158802535531}-{'f1_val': 0.9965712481121245, 'auprc': 0.9976446310936712, 'loss_val': 0.01767346155202014, 'psi': 0.9970006013047432}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=69 head_norm_before_train=2.156944 cos_to_last_merge=0.9936 (last merge round=37)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6417117164748795, 'auprc': 0.7390232471387321, 'loss_val': 1.0544810530345436, 'psi': 0.6806363287404205}-{'f1_val': 0.6667222899937363, 'auprc': 0.7417571397042217, 'loss_val': 0.7988875115571453, 'psi': 0.6967362298779305}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.208193 cos_to_last_merge=0.9970 (last merge round=43)
[S14] round=69 local utility u=0.000176 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.999174688310086, 'loss_val': 0.023014716175109504, 'psi': 0.9983483814799711}-{'f1_val': 0.9977975102598944, 'auprc': 0.9991722271339236, 'loss_val': 0.023359022538930536, 'psi': 0.9983473970095061}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=69 head_norm_before_train=2.321186 (no previous merge yet)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9185156955850095, 'auprc': 0.9976078309278367, 'loss_val': 0.09636550884801896, 'psi': 0.9501525497221404}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985634248473427, 'loss_val': 0.021100491925868693, 'psi': 0.9974733709714494}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.804711 cos_to_last_merge=0.9946 (last merge round=44)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9926882628360972, 'auprc': 0.9885634493440734, 'loss_val': 0.03763259585528108, 'psi': 0.9910383374392877}-{'f1_val': 0.9918969789708006, 'auprc': 0.9904366894425566, 'loss_val': 0.03704878558476443, 'psi': 0.991312863159503}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=2.180243 cos_to_last_merge=0.9980 (last merge round=43)
[S17] round=69 local utility u=0.052502 metrics={'f1_val': 0.6475840208690788, 'auprc': 0.8944789036204951, 'loss_val': 1.0789168406500973, 'psi': 0.7463419739696453}-{'f1_val': 0.6241439199926726, 'auprc': 0.9037377312364772, 'loss_val': 1.0710560799122057, 'psi': 0.7359814444901944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=70 head_norm_before_train=1.981047 cos_to_last_merge=0.9959 (last merge round=43)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7236364538250931, 'auprc': 0.7981754538084034, 'loss_val': 0.7466415138798915, 'psi': 0.7534520538184173}-{'f1_val': 0.7209978614376121, 'auprc': 0.8610154917236645, 'loss_val': 0.7171821074156515, 'psi': 0.7770049135520332}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=1.939466 cos_to_last_merge=0.9766 (last merge round=44)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.695451648921649, 'auprc': 0.9644855544220359, 'loss_val': 0.843110582981479, 'psi': 0.8030652111218037}-{'f1_val': 0.9825120167788531, 'auprc': 0.999552621756013, 'loss_val': 0.045618286777994795, 'psi': 0.9893282587697171}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.759369 cos_to_last_merge=0.9704 (last merge round=37)
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9450678046708897, 'auprc': 0.9216346418916586, 'loss_val': 0.3103291445874893, 'psi': 0.9356945395591973}-{'f1_val': 0.9509685688916617, 'auprc': 0.9271102293711156, 'loss_val': 0.2956773113516096, 'psi': 0.9414252330834434}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=1.999902 cos_to_last_merge=0.9811 (last merge round=44)
[S5] round=70 local utility u=0.008189 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9987322872744262, 'loss_val': 0.024012072942037877, 'psi': 0.9972932020879046}-{'f1_val': 0.9959650868991299, 'auprc': 0.9979341771196425, 'loss_val': 0.03578434064691304, 'psi': 0.996752722987335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=70 head_norm_before_train=1.682835 cos_to_last_merge=0.9530 (last merge round=45)
[S6] round=70 local utility u=0.601257 metrics={'f1_val': 0.8890271179223876, 'auprc': 0.9627720731236176, 'loss_val': 0.2676817126190883, 'psi': 0.9185251000028796}-{'f1_val': 0.7415825611984963, 'auprc': 0.9410422475749648, 'loss_val': 0.5203397105986668, 'psi': 0.8213664357490837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=70 head_norm_before_train=1.706571 cos_to_last_merge=0.9629 (last merge round=40)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6333395419761055, 'auprc': 0.927434551617896, 'loss_val': 0.5240717841263894, 'psi': 0.7509775458328218}-{'f1_val': 0.8944363722215067, 'auprc': 0.9792400354095967, 'loss_val': 0.3426258436355796, 'psi': 0.9283578374967427}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=1.838244 cos_to_last_merge=0.9918 (last merge round=44)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9706785885925733, 'auprc': 0.9992844174491773, 'loss_val': 0.08306261740149128, 'psi': 0.9821209201352148}-{'f1_val': 0.9753790605419683, 'auprc': 0.999358804559612, 'loss_val': 0.06835774948929492, 'psi': 0.9849709581490258}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.332443 (no previous merge yet)
[S9] round=70 local utility u=0.000432 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998871335377277, 'loss_val': 0.015636821335420083, 'psi': 0.9979511605034259}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998450550777476, 'loss_val': 0.016375291276194207, 'psi': 0.9979343291194339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=70 head_norm_before_train=2.432717 cos_to_last_merge=0.9965 (last merge round=43)
[S10] round=70 local utility u=0.003664 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978548857355017, 'loss_val': 0.02448533476474442, 'psi': 0.9962546577058256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958664386217055, 'loss_val': 0.025848157627046474, 'psi': 0.995459278860307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=70 head_norm_before_train=2.371498 cos_to_last_merge=0.9990 (last merge round=43)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.996090062210376, 'auprc': 0.9986650985681473, 'loss_val': 0.017362108650893226, 'psi': 0.9971200767534845}-{'f1_val': 0.9965712481121245, 'auprc': 0.9981828284656961, 'loss_val': 0.01706489084503127, 'psi': 0.9972158802535531}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=2.159504 cos_to_last_merge=0.9934 (last merge round=37)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6175302608306446, 'auprc': 0.6683877979022673, 'loss_val': 1.056997907650866, 'psi': 0.6378732756592936}-{'f1_val': 0.6417117164748795, 'auprc': 0.7390232471387321, 'loss_val': 1.0544810530345436, 'psi': 0.6806363287404205}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.211265 cos_to_last_merge=0.9969 (last merge round=43)
[S14] round=70 local utility u=0.001778 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992229354462342, 'loss_val': 0.01974923514507135, 'psi': 0.9983822297911491}-{'f1_val': 0.9977975102598944, 'auprc': 0.999174688310086, 'loss_val': 0.023014716175109504, 'psi': 0.9983483814799711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=70 head_norm_before_train=2.326178 (no previous merge yet)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9046630385760085, 'auprc': 0.9811833459172357, 'loss_val': 0.1574530387555561, 'psi': 0.9352711615124993}-{'f1_val': 0.9185156955850095, 'auprc': 0.9976078309278367, 'loss_val': 0.09636550884801896, 'psi': 0.9501525497221404}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.809903 cos_to_last_merge=0.9944 (last merge round=44)
[S16] round=70 local utility u=0.004567 metrics={'f1_val': 0.990998034151813, 'auprc': 0.9952494125054039, 'loss_val': 0.03841562666384051, 'psi': 0.9926985854932494}-{'f1_val': 0.9926882628360972, 'auprc': 0.9885634493440734, 'loss_val': 0.03763259585528108, 'psi': 0.9910383374392877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=70 head_norm_before_train=2.186779 cos_to_last_merge=0.9979 (last merge round=43)
[S17] round=70 local utility u=0.271672 metrics={'f1_val': 0.6741904171917255, 'auprc': 0.9154331855156319, 'loss_val': 0.7580744203165134, 'psi': 0.7706875245212881}-{'f1_val': 0.6475840208690788, 'auprc': 0.8944789036204951, 'loss_val': 1.0789168406500973, 'psi': 0.7463419739696453}
[S17] not sending this round → trigger blocked (psi=0.771)
[S2] START round=71 head_norm_before_train=1.984783 cos_to_last_merge=0.9958 (last merge round=43)
[S2] round=71 local utility u=0.053810 metrics={'f1_val': 0.7221580049978502, 'auprc': 0.8411149886078131, 'loss_val': 0.7589691217887012, 'psi': 0.7697407984418354}-{'f1_val': 0.7236364538250931, 'auprc': 0.7981754538084034, 'loss_val': 0.7466415138798915, 'psi': 0.7534520538184173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=71 head_norm_before_train=1.946192 cos_to_last_merge=0.9761 (last merge round=44)
[S3] round=71 local utility u=0.496458 metrics={'f1_val': 0.7849657944593427, 'auprc': 0.9908077763396905, 'loss_val': 0.46624527903673924, 'psi': 0.8673025872114818}-{'f1_val': 0.695451648921649, 'auprc': 0.9644855544220359, 'loss_val': 0.843110582981479, 'psi': 0.8030652111218037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=71 head_norm_before_train=1.762781 cos_to_last_merge=0.9698 (last merge round=37)
[S4] round=71 local utility u=0.017016 metrics={'f1_val': 0.9480084631111207, 'auprc': 0.9270060219163148, 'loss_val': 0.3100542803931733, 'psi': 0.9396074866331984}-{'f1_val': 0.9450678046708897, 'auprc': 0.9216346418916586, 'loss_val': 0.3103291445874893, 'psi': 0.9356945395591973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=71 head_norm_before_train=2.010916 cos_to_last_merge=0.9805 (last merge round=44)
[S5] round=71 local utility u=0.003294 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994716016524279, 'loss_val': 0.02185032678386727, 'psi': 0.9978098217480458}-{'f1_val': 0.9963338119635569, 'auprc': 0.9987322872744262, 'loss_val': 0.024012072942037877, 'psi': 0.9972932020879046}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=71 head_norm_before_train=1.691423 cos_to_last_merge=0.9519 (last merge round=45)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6349955608989768, 'auprc': 0.9471111306874418, 'loss_val': 0.7696435235052369, 'psi': 0.7598417888143628}-{'f1_val': 0.8890271179223876, 'auprc': 0.9627720731236176, 'loss_val': 0.2676817126190883, 'psi': 0.9185251000028796}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.720342 cos_to_last_merge=0.9612 (last merge round=40)
[S7] round=71 local utility u=0.700981 metrics={'f1_val': 0.8114977858536342, 'auprc': 0.9818804273508398, 'loss_val': 0.3543969236473316, 'psi': 0.8796508424525165}-{'f1_val': 0.6333395419761055, 'auprc': 0.927434551617896, 'loss_val': 0.5240717841263894, 'psi': 0.7509775458328218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=71 head_norm_before_train=1.843725 cos_to_last_merge=0.9916 (last merge round=44)
[S8] round=71 local utility u=0.072981 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9876010633147944, 'loss_val': 0.03559597541691587, 'psi': 0.9908021346910119}-{'f1_val': 0.9706785885925733, 'auprc': 0.9992844174491773, 'loss_val': 0.08306261740149128, 'psi': 0.9821209201352148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=71 head_norm_before_train=2.340882 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9997611243079161, 'loss_val': 0.020340398394639955, 'psi': 0.995898691875156}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998871335377277, 'loss_val': 0.015636821335420083, 'psi': 0.9979511605034259}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.436488 cos_to_last_merge=0.9964 (last merge round=43)
[S10] round=71 local utility u=0.000067 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978700575897945, 'loss_val': 0.02439708122794066, 'psi': 0.9962607264475427}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978548857355017, 'loss_val': 0.02448533476474442, 'psi': 0.9962546577058256}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=71 head_norm_before_train=2.374488 cos_to_last_merge=0.9989 (last merge round=43)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9972021270739293, 'loss_val': 0.018259443914498404, 'psi': 0.996666301599793}-{'f1_val': 0.996090062210376, 'auprc': 0.9986650985681473, 'loss_val': 0.017362108650893226, 'psi': 0.9971200767534845}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=2.162014 cos_to_last_merge=0.9933 (last merge round=37)
[S13] round=71 local utility u=0.658853 metrics={'f1_val': 0.7312712726911289, 'auprc': 0.8098904751360033, 'loss_val': 0.8462464388214799, 'psi': 0.7627189536690786}-{'f1_val': 0.6175302608306446, 'auprc': 0.6683877979022673, 'loss_val': 1.056997907650866, 'psi': 0.6378732756592936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=71 head_norm_before_train=2.216298 cos_to_last_merge=0.9968 (last merge round=43)
[S14] round=71 local utility u=0.000363 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992260448913937, 'loss_val': 0.01903193623709347, 'psi': 0.9983834735692129}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992229354462342, 'loss_val': 0.01974923514507135, 'psi': 0.9983822297911491}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=71 head_norm_before_train=2.331187 (no previous merge yet)
[S15] round=71 local utility u=0.373081 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998664249692648, 'loss_val': 0.016235942667731366, 'psi': 0.9975137009095716}-{'f1_val': 0.9046630385760085, 'auprc': 0.9811833459172357, 'loss_val': 0.1574530387555561, 'psi': 0.9352711615124993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=71 head_norm_before_train=1.815772 cos_to_last_merge=0.9942 (last merge round=44)
[S16] round=71 local utility u=0.004410 metrics={'f1_val': 0.9917745098305579, 'auprc': 0.9970171981651305, 'loss_val': 0.03955731509683115, 'psi': 0.9938715851643869}-{'f1_val': 0.990998034151813, 'auprc': 0.9952494125054039, 'loss_val': 0.03841562666384051, 'psi': 0.9926985854932494}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=71 head_norm_before_train=2.191664 cos_to_last_merge=0.9977 (last merge round=43)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.6473467574834817, 'auprc': 0.9145130993872821, 'loss_val': 0.8476868151609005, 'psi': 0.7542132942450019}-{'f1_val': 0.6741904171917255, 'auprc': 0.9154331855156319, 'loss_val': 0.7580744203165134, 'psi': 0.7706875245212881}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=1.987897 cos_to_last_merge=0.9958 (last merge round=43)
[S2] round=72 local utility u=0.307643 metrics={'f1_val': 0.7735617997424407, 'auprc': 0.8598697155395187, 'loss_val': 0.5083693845999295, 'psi': 0.8080849660612719}-{'f1_val': 0.7221580049978502, 'auprc': 0.8411149886078131, 'loss_val': 0.7589691217887012, 'psi': 0.7697407984418354}
[S2] not sending this round → trigger blocked (psi=0.808)
[S3] START round=72 head_norm_before_train=1.951783 cos_to_last_merge=0.9758 (last merge round=44)
[S3] round=72 local utility u=0.641201 metrics={'f1_val': 0.9452497917715696, 'auprc': 0.988307852444701, 'loss_val': 0.1380475838178135, 'psi': 0.9624730160408221}-{'f1_val': 0.7849657944593427, 'auprc': 0.9908077763396905, 'loss_val': 0.46624527903673924, 'psi': 0.8673025872114818}
[S3] not sending this round → trigger blocked (psi=0.962)
[S4] START round=72 head_norm_before_train=1.764186 cos_to_last_merge=0.9693 (last merge round=37)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9488228582355587, 'auprc': 0.9220739536174567, 'loss_val': 0.30136383187323285, 'psi': 0.9381232963883179}-{'f1_val': 0.9480084631111207, 'auprc': 0.9270060219163148, 'loss_val': 0.3100542803931733, 'psi': 0.9396074866331984}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=2.024734 cos_to_last_merge=0.9798 (last merge round=44)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9974735028726371, 'loss_val': 0.022217028447339773, 'psi': 0.9970105822361295}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994716016524279, 'loss_val': 0.02185032678386727, 'psi': 0.9978098217480458}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.698874 cos_to_last_merge=0.9509 (last merge round=45)
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.8865017431246714, 'auprc': 0.9633286369129521, 'loss_val': 0.2584526818847916, 'psi': 0.9172325006399837}-{'f1_val': 0.6349955608989768, 'auprc': 0.9471111306874418, 'loss_val': 0.7696435235052369, 'psi': 0.7598417888143628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=72 head_norm_before_train=1.732390 cos_to_last_merge=0.9597 (last merge round=40)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5424735884072655, 'auprc': 0.6726611933189052, 'loss_val': 1.012502600318897, 'psi': 0.5945486303719213}-{'f1_val': 0.8114977858536342, 'auprc': 0.9818804273508398, 'loss_val': 0.3543969236473316, 'psi': 0.8796508424525165}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.847979 cos_to_last_merge=0.9913 (last merge round=44)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.961249863879932, 'auprc': 0.9991689313294135, 'loss_val': 0.11877929567521975, 'psi': 0.9764174908597246}-{'f1_val': 0.9929361822751569, 'auprc': 0.9876010633147944, 'loss_val': 0.03559597541691587, 'psi': 0.9908021346910119}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.341763 (no previous merge yet)
[S9] round=72 local utility u=0.012783 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9999091493597648, 'loss_val': 0.015218194807540263, 'psi': 0.9979578669235527}-{'f1_val': 0.9933237369199828, 'auprc': 0.9997611243079161, 'loss_val': 0.020340398394639955, 'psi': 0.995898691875156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=72 head_norm_before_train=2.441074 cos_to_last_merge=0.9962 (last merge round=43)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9973888801547924, 'loss_val': 0.02516652152098998, 'psi': 0.9960682554735418}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978700575897945, 'loss_val': 0.02439708122794066, 'psi': 0.9962607264475427}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.377886 cos_to_last_merge=0.9989 (last merge round=43)
[S11] round=72 local utility u=0.001905 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9977509578501909, 'loss_val': 0.017669058303145063, 'psi': 0.9970431320073511}-{'f1_val': 0.9963090846170353, 'auprc': 0.9972021270739293, 'loss_val': 0.018259443914498404, 'psi': 0.996666301599793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=72 head_norm_before_train=2.165106 cos_to_last_merge=0.9931 (last merge round=37)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6049623877789017, 'auprc': 0.7156305331668694, 'loss_val': 1.107881481828961, 'psi': 0.6492296459340887}-{'f1_val': 0.7312712726911289, 'auprc': 0.8098904751360033, 'loss_val': 0.8462464388214799, 'psi': 0.7627189536690786}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.222955 cos_to_last_merge=0.9966 (last merge round=43)
[S14] round=72 local utility u=0.000225 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9992250857893247, 'loss_val': 0.018447209347339323, 'psi': 0.9983699685815973}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992260448913937, 'loss_val': 0.01903193623709347, 'psi': 0.9983834735692129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=72 head_norm_before_train=2.335928 (no previous merge yet)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977916358161745, 'loss_val': 0.01949688061467682, 'psi': 0.9971646553589821}-{'f1_val': 0.9967466683875206, 'auprc': 0.998664249692648, 'loss_val': 0.016235942667731366, 'psi': 0.9975137009095716}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.820814 cos_to_last_merge=0.9940 (last merge round=44)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9915033728562261, 'auprc': 0.9948693021668094, 'loss_val': 0.04043004324205213, 'psi': 0.9928497445804594}-{'f1_val': 0.9917745098305579, 'auprc': 0.9970171981651305, 'loss_val': 0.03955731509683115, 'psi': 0.9938715851643869}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.197844 cos_to_last_merge=0.9971 (last merge round=43)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.620328666591227, 'auprc': 0.9021839617833044, 'loss_val': 1.0608582062546765, 'psi': 0.733070784668058}-{'f1_val': 0.6473467574834817, 'auprc': 0.9145130993872821, 'loss_val': 0.8476868151609005, 'psi': 0.7542132942450019}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=1.991791 cos_to_last_merge=0.9957 (last merge round=43)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.7034550451130663, 'auprc': 0.8590103541610982, 'loss_val': 0.6783929681515987, 'psi': 0.7656771687322791}-{'f1_val': 0.7735617997424407, 'auprc': 0.8598697155395187, 'loss_val': 0.5083693845999295, 'psi': 0.8080849660612719}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=1.960289 cos_to_last_merge=0.9753 (last merge round=44)
[S3] round=73 local utility u=0.149453 metrics={'f1_val': 0.9755116463701856, 'auprc': 0.9994599845043406, 'loss_val': 0.05416929164335547, 'psi': 0.9850909816238476}-{'f1_val': 0.9452497917715696, 'auprc': 0.988307852444701, 'loss_val': 0.1380475838178135, 'psi': 0.9624730160408221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=73 head_norm_before_train=1.765387 cos_to_last_merge=0.9686 (last merge round=37)
[S4] round=73 local utility u=0.075098 metrics={'f1_val': 0.9555163285678537, 'auprc': 0.9532921399371196, 'loss_val': 0.2849831944557228, 'psi': 0.95462665311556}-{'f1_val': 0.9488228582355587, 'auprc': 0.9220739536174567, 'loss_val': 0.30136383187323285, 'psi': 0.9381232963883179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=73 head_norm_before_train=2.034364 cos_to_last_merge=0.9791 (last merge round=44)
[S5] round=73 local utility u=0.001356 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9983511533423879, 'loss_val': 0.02213844148937452, 'psi': 0.9973616424240297}-{'f1_val': 0.9967019684784577, 'auprc': 0.9974735028726371, 'loss_val': 0.022217028447339773, 'psi': 0.9970105822361295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=73 head_norm_before_train=1.706919 cos_to_last_merge=0.9499 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6172167328902807, 'auprc': 0.9159299124064321, 'loss_val': 0.7410557904463344, 'psi': 0.7367020046967412}-{'f1_val': 0.8865017431246714, 'auprc': 0.9633286369129521, 'loss_val': 0.2584526818847916, 'psi': 0.9172325006399837}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.744741 cos_to_last_merge=0.9581 (last merge round=40)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.5421670710280827, 'auprc': 0.6450819949594563, 'loss_val': 1.1352487459230256, 'psi': 0.5833330406006321}-{'f1_val': 0.5424735884072655, 'auprc': 0.6726611933189052, 'loss_val': 1.012502600318897, 'psi': 0.5945486303719213}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=1.851706 cos_to_last_merge=0.9911 (last merge round=44)
[S8] round=73 local utility u=0.084930 metrics={'f1_val': 0.9789864289159705, 'auprc': 0.9992542893762109, 'loss_val': 0.05559406526250158, 'psi': 0.9870935731000667}-{'f1_val': 0.961249863879932, 'auprc': 0.9991689313294135, 'loss_val': 0.11877929567521975, 'psi': 0.9764174908597246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=73 head_norm_before_train=2.347315 (no previous merge yet)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.986572608707039, 'auprc': 0.9998726457728704, 'loss_val': 0.04899751533461986, 'psi': 0.9918926235333716}-{'f1_val': 0.9966570119660778, 'auprc': 0.9999091493597648, 'loss_val': 0.015218194807540263, 'psi': 0.9979578669235527}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.446025 cos_to_last_merge=0.9961 (last merge round=43)
[S10] round=73 local utility u=0.000841 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9977808169201949, 'loss_val': 0.024661257961367616, 'psi': 0.9962250301797029}-{'f1_val': 0.9951878390193748, 'auprc': 0.9973888801547924, 'loss_val': 0.02516652152098998, 'psi': 0.9960682554735418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=73 head_norm_before_train=2.381486 cos_to_last_merge=0.9988 (last merge round=43)
[S11] round=73 local utility u=0.001597 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9983040112377634, 'loss_val': 0.01613465020613787, 'psi': 0.9972643533623801}-{'f1_val': 0.9965712481121245, 'auprc': 0.9977509578501909, 'loss_val': 0.017669058303145063, 'psi': 0.9970431320073511}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=73 head_norm_before_train=2.168746 cos_to_last_merge=0.9929 (last merge round=37)
[S13] round=73 local utility u=0.610035 metrics={'f1_val': 0.7214181193044622, 'auprc': 0.8298765355517819, 'loss_val': 0.9292829570634358, 'psi': 0.76480148580339}-{'f1_val': 0.6049623877789017, 'auprc': 0.7156305331668694, 'loss_val': 1.107881481828961, 'psi': 0.6492296459340887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=73 head_norm_before_train=2.229645 cos_to_last_merge=0.9965 (last merge round=43)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9437956314670307, 'auprc': 0.9987776335429241, 'loss_val': 0.0739949347371224, 'psi': 0.9657884322973882}-{'f1_val': 0.9977998904431125, 'auprc': 0.9992250857893247, 'loss_val': 0.018447209347339323, 'psi': 0.9983699685815973}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.340797 (no previous merge yet)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.8740429887916334, 'auprc': 0.9963550710125435, 'loss_val': 0.372744436894347, 'psi': 0.9229678216799975}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977916358161745, 'loss_val': 0.01949688061467682, 'psi': 0.9971646553589821}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.826839 cos_to_last_merge=0.9937 (last merge round=44)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9924453639007486, 'auprc': 0.9846527318426334, 'loss_val': 0.039906225464719586, 'psi': 0.9893283110775025}-{'f1_val': 0.9915033728562261, 'auprc': 0.9948693021668094, 'loss_val': 0.04043004324205213, 'psi': 0.9928497445804594}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.203965 cos_to_last_merge=0.9966 (last merge round=43)
[S17] round=73 local utility u=0.807836 metrics={'f1_val': 0.7485611517630404, 'auprc': 0.9820248667808247, 'loss_val': 0.454104346622294, 'psi': 0.8419466377701541}-{'f1_val': 0.620328666591227, 'auprc': 0.9021839617833044, 'loss_val': 1.0608582062546765, 'psi': 0.733070784668058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=74 head_norm_before_train=1.998186 cos_to_last_merge=0.9955 (last merge round=43)
[S2] round=74 local utility u=0.084601 metrics={'f1_val': 0.7094357182069685, 'auprc': 0.8803261519606592, 'loss_val': 0.6090231578231778, 'psi': 0.7777918917084448}-{'f1_val': 0.7034550451130663, 'auprc': 0.8590103541610982, 'loss_val': 0.6783929681515987, 'psi': 0.7656771687322791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S2] sending update (kind=head size=1811 to 1 peers)
[S3] START round=74 head_norm_before_train=1.969398 cos_to_last_merge=0.9747 (last merge round=44)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9573948056733027, 'auprc': 0.9858125462579548, 'loss_val': 0.15341244330946913, 'psi': 0.9687619019071635}-{'f1_val': 0.9755116463701856, 'auprc': 0.9994599845043406, 'loss_val': 0.05416929164335547, 'psi': 0.9850909816238476}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.765013 cos_to_last_merge=0.9683 (last merge round=37)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9489207382284102, 'auprc': 0.9230015162451051, 'loss_val': 0.308208883118682, 'psi': 0.9385530494350882}-{'f1_val': 0.9555163285678537, 'auprc': 0.9532921399371196, 'loss_val': 0.2849831944557228, 'psi': 0.95462665311556}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=2.035275 cos_to_last_merge=0.9788 (last merge round=44)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9652577546847164, 'auprc': 0.9953775414482001, 'loss_val': 0.07684131097756805, 'psi': 0.9773056693901099}-{'f1_val': 0.9967019684784577, 'auprc': 0.9983511533423879, 'loss_val': 0.02213844148937452, 'psi': 0.9973616424240297}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.714870 cos_to_last_merge=0.9490 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.5408806202945491, 'auprc': 0.7787676448155441, 'loss_val': 0.7648451959560991, 'psi': 0.636035430102947}-{'f1_val': 0.6172167328902807, 'auprc': 0.9159299124064321, 'loss_val': 0.7410557904463344, 'psi': 0.7367020046967412}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.761620 cos_to_last_merge=0.9561 (last merge round=40)
[S7] round=74 local utility u=0.314682 metrics={'f1_val': 0.5731244409062353, 'auprc': 0.735763944531856, 'loss_val': 0.9636755005843617, 'psi': 0.6381802423564835}-{'f1_val': 0.5421670710280827, 'auprc': 0.6450819949594563, 'loss_val': 1.1352487459230256, 'psi': 0.5833330406006321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=74 head_norm_before_train=1.857572 cos_to_last_merge=0.9907 (last merge round=44)
[S8] round=74 local utility u=0.033981 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9874133151384126, 'loss_val': 0.035807439445752494, 'psi': 0.9907270354204591}-{'f1_val': 0.9789864289159705, 'auprc': 0.9992542893762109, 'loss_val': 0.05559406526250158, 'psi': 0.9870935731000667}
[S8] not sending this round → trigger blocked (psi=0.991)
[S9] START round=74 head_norm_before_train=2.354863 (no previous merge yet)
[S9] round=74 local utility u=0.039193 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.99486352149797, 'loss_val': 0.01630294690332275, 'psi': 0.9959609033580453}-{'f1_val': 0.986572608707039, 'auprc': 0.9998726457728704, 'loss_val': 0.04899751533461986, 'psi': 0.9918926235333716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=74 head_norm_before_train=2.451104 cos_to_last_merge=0.9959 (last merge round=43)
[S10] round=74 local utility u=0.000437 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979134845941515, 'loss_val': 0.02418617169742249, 'psi': 0.9962780972492855}-{'f1_val': 0.9951878390193748, 'auprc': 0.9977808169201949, 'loss_val': 0.024661257961367616, 'psi': 0.9962250301797029}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=74 head_norm_before_train=2.385346 cos_to_last_merge=0.9987 (last merge round=43)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9982554460355488, 'loss_val': 0.016148654079079842, 'psi': 0.9972449272814943}-{'f1_val': 0.9965712481121245, 'auprc': 0.9983040112377634, 'loss_val': 0.01613465020613787, 'psi': 0.9972643533623801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=2.172464 cos_to_last_merge=0.9927 (last merge round=37)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6940252297654195, 'auprc': 0.7988663972654283, 'loss_val': 0.8892189946404602, 'psi': 0.735961696765423}-{'f1_val': 0.7214181193044622, 'auprc': 0.8298765355517819, 'loss_val': 0.9292829570634358, 'psi': 0.76480148580339}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.234305 cos_to_last_merge=0.9963 (last merge round=43)
[S14] round=74 local utility u=0.190143 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9992229970439018, 'loss_val': 0.019055769326094842, 'psi': 0.9983677049734974}-{'f1_val': 0.9437956314670307, 'auprc': 0.9987776335429241, 'loss_val': 0.0739949347371224, 'psi': 0.9657884322973882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=74 head_norm_before_train=2.345621 (no previous merge yet)
[S15] round=74 local utility u=0.550005 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998690974736882, 'loss_val': 0.015964279232396284, 'psi': 0.9975243909272651}-{'f1_val': 0.8740429887916334, 'auprc': 0.9963550710125435, 'loss_val': 0.372744436894347, 'psi': 0.9229678216799975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=74 head_norm_before_train=1.832108 cos_to_last_merge=0.9935 (last merge round=44)
[S16] round=74 local utility u=0.009255 metrics={'f1_val': 0.9923142353105251, 'auprc': 0.9901858951937463, 'loss_val': 0.03720925466060697, 'psi': 0.9914628992638136}-{'f1_val': 0.9924453639007486, 'auprc': 0.9846527318426334, 'loss_val': 0.039906225464719586, 'psi': 0.9893283110775025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=74 head_norm_before_train=2.210802 cos_to_last_merge=0.9962 (last merge round=43)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.5732558309067304, 'auprc': 0.8863125402629649, 'loss_val': 1.1005636752621109, 'psi': 0.6984785146492243}-{'f1_val': 0.7485611517630404, 'auprc': 0.9820248667808247, 'loss_val': 0.454104346622294, 'psi': 0.8419466377701541}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.005964 cos_to_last_merge=0.9953 (last merge round=43)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7183332619035763, 'auprc': 0.8589270839387846, 'loss_val': 0.6224662297058288, 'psi': 0.7745707907176596}-{'f1_val': 0.7094357182069685, 'auprc': 0.8803261519606592, 'loss_val': 0.6090231578231778, 'psi': 0.7777918917084448}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=1.978210 cos_to_last_merge=0.9741 (last merge round=44)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.8774629169469335, 'auprc': 0.9903826451340045, 'loss_val': 0.2719501174407954, 'psi': 0.9226308082217618}-{'f1_val': 0.9573948056733027, 'auprc': 0.9858125462579548, 'loss_val': 0.15341244330946913, 'psi': 0.9687619019071635}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.765498 cos_to_last_merge=0.9680 (last merge round=37)
[S4] round=75 local utility u=0.002669 metrics={'f1_val': 0.9486683015190847, 'auprc': 0.9266161168536247, 'loss_val': 0.3121995701646728, 'psi': 0.9398474276529006}-{'f1_val': 0.9489207382284102, 'auprc': 0.9230015162451051, 'loss_val': 0.308208883118682, 'psi': 0.9385530494350882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=75 head_norm_before_train=2.039025 cos_to_last_merge=0.9783 (last merge round=44)
[S5] round=75 local utility u=0.129461 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9997308368511544, 'loss_val': 0.02227945212412685, 'psi': 0.9981769519412367}-{'f1_val': 0.9652577546847164, 'auprc': 0.9953775414482001, 'loss_val': 0.07684131097756805, 'psi': 0.9773056693901099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=75 head_norm_before_train=1.721483 cos_to_last_merge=0.9481 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=75 local utility u=1.000000 metrics={'f1_val': 0.8057013451558143, 'auprc': 0.9425042938988317, 'loss_val': 0.3680700639451228, 'psi': 0.8604225246530213}-{'f1_val': 0.5408806202945491, 'auprc': 0.7787676448155441, 'loss_val': 0.7648451959560991, 'psi': 0.636035430102947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=75 head_norm_before_train=1.778830 cos_to_last_merge=0.9540 (last merge round=40)
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.7965542073010794, 'auprc': 0.9186629493676641, 'loss_val': 0.44270953159272786, 'psi': 0.8453977041277132}-{'f1_val': 0.5731244409062353, 'auprc': 0.735763944531856, 'loss_val': 0.9636755005843617, 'psi': 0.6381802423564835}
[S7] not sending this round → trigger blocked (psi=0.845)
[S8] START round=75 head_norm_before_train=1.864115 cos_to_last_merge=0.9904 (last merge round=44)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9700077239007503, 'auprc': 0.999085644137341, 'loss_val': 0.08949184546525496, 'psi': 0.9816388919953866}-{'f1_val': 0.9929361822751569, 'auprc': 0.9874133151384126, 'loss_val': 0.035807439445752494, 'psi': 0.9907270354204591}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.358409 (no previous merge yet)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9447213571522681, 'auprc': 0.9996129266015545, 'loss_val': 0.10982828035415383, 'psi': 0.9666779849319828}-{'f1_val': 0.9966924912647621, 'auprc': 0.99486352149797, 'loss_val': 0.01630294690332275, 'psi': 0.9959609033580453}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.456222 cos_to_last_merge=0.9958 (last merge round=43)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978555260200789, 'loss_val': 0.02432773783102018, 'psi': 0.9962549138196564}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979134845941515, 'loss_val': 0.02418617169742249, 'psi': 0.9962780972492855}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.389508 cos_to_last_merge=0.9987 (last merge round=43)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9922530037320493, 'auprc': 0.9989617170078052, 'loss_val': 0.02363060170444843, 'psi': 0.9949364890423517}-{'f1_val': 0.9965712481121245, 'auprc': 0.9982554460355488, 'loss_val': 0.016148654079079842, 'psi': 0.9972449272814943}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=2.175882 cos_to_last_merge=0.9925 (last merge round=37)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6652047054538975, 'auprc': 0.7836298318429678, 'loss_val': 0.9957115106242227, 'psi': 0.7125747560095257}-{'f1_val': 0.6940252297654195, 'auprc': 0.7988663972654283, 'loss_val': 0.8892189946404602, 'psi': 0.735961696765423}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.236371 cos_to_last_merge=0.9962 (last merge round=43)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9992267130031962, 'loss_val': 0.019892824871843164, 'psi': 0.9979919533170376}-{'f1_val': 0.9977975102598944, 'auprc': 0.9992229970439018, 'loss_val': 0.019055769326094842, 'psi': 0.9983677049734974}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.350358 (no previous merge yet)
[S15] round=75 local utility u=0.002160 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9992027525464253, 'loss_val': 0.015403837770360421, 'psi': 0.9979514531354302}-{'f1_val': 0.9967466683875206, 'auprc': 0.998690974736882, 'loss_val': 0.015964279232396284, 'psi': 0.9975243909272651}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=75 head_norm_before_train=1.836000 cos_to_last_merge=0.9933 (last merge round=44)
[S16] round=75 local utility u=0.003663 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.9954252384524467, 'loss_val': 0.03858381446793968, 'psi': 0.992856850139238}-{'f1_val': 0.9923142353105251, 'auprc': 0.9901858951937463, 'loss_val': 0.03720925466060697, 'psi': 0.9914628992638136}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=75 head_norm_before_train=2.219072 cos_to_last_merge=0.9955 (last merge round=43)
[S17] round=75 local utility u=0.215788 metrics={'f1_val': 0.5971195741576876, 'auprc': 0.9368026246603657, 'loss_val': 0.9636394977188192, 'psi': 0.7329927943587589}-{'f1_val': 0.5732558309067304, 'auprc': 0.8863125402629649, 'loss_val': 1.1005636752621109, 'psi': 0.6984785146492243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=76 head_norm_before_train=2.011783 cos_to_last_merge=0.9952 (last merge round=43)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7181374718276868, 'auprc': 0.8584414875838828, 'loss_val': 0.6417392110782524, 'psi': 0.7742590781301653}-{'f1_val': 0.7183332619035763, 'auprc': 0.8589270839387846, 'loss_val': 0.6224662297058288, 'psi': 0.7745707907176596}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=1.985193 cos_to_last_merge=0.9737 (last merge round=44)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.6384956391926128, 'auprc': 0.894572396336306, 'loss_val': 1.2018622310240554, 'psi': 0.7409263420500901}-{'f1_val': 0.8774629169469335, 'auprc': 0.9903826451340045, 'loss_val': 0.2719501174407954, 'psi': 0.9226308082217618}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.766335 cos_to_last_merge=0.9675 (last merge round=37)
[S4] round=76 local utility u=0.063490 metrics={'f1_val': 0.9522773420749177, 'auprc': 0.9564208072959117, 'loss_val': 0.2962879824311778, 'psi': 0.9539347281633153}-{'f1_val': 0.9486683015190847, 'auprc': 0.9266161168536247, 'loss_val': 0.3121995701646728, 'psi': 0.9398474276529006}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=76 head_norm_before_train=2.046815 cos_to_last_merge=0.9779 (last merge round=44)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9997823997249313, 'loss_val': 0.024479887943722536, 'psi': 0.9981975770907475}-{'f1_val': 0.9971410286679584, 'auprc': 0.9997308368511544, 'loss_val': 0.02227945212412685, 'psi': 0.9981769519412367}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.725547 cos_to_last_merge=0.9473 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.6150866968643397, 'auprc': 0.9180043642461744, 'loss_val': 0.9914008572050812, 'psi': 0.7362537638170736}-{'f1_val': 0.8057013451558143, 'auprc': 0.9425042938988317, 'loss_val': 0.3680700639451228, 'psi': 0.8604225246530213}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.792938 cos_to_last_merge=0.9522 (last merge round=40)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.7941301409033727, 'auprc': 0.8601242200876804, 'loss_val': 0.5406034101061445, 'psi': 0.8205277725770959}-{'f1_val': 0.7965542073010794, 'auprc': 0.9186629493676641, 'loss_val': 0.44270953159272786, 'psi': 0.8453977041277132}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.870263 cos_to_last_merge=0.9900 (last merge round=44)
[S8] round=76 local utility u=0.072778 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9847652218802145, 'loss_val': 0.03569552232075118, 'psi': 0.9893827955684629}-{'f1_val': 0.9700077239007503, 'auprc': 0.999085644137341, 'loss_val': 0.08949184546525496, 'psi': 0.9816388919953866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=76 head_norm_before_train=2.363070 (no previous merge yet)
[S9] round=76 local utility u=0.195821 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9951594446031529, 'loss_val': 0.01665351784651311, 'psi': 0.9960792726001184}-{'f1_val': 0.9447213571522681, 'auprc': 0.9996129266015545, 'loss_val': 0.10982828035415383, 'psi': 0.9666779849319828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=76 head_norm_before_train=2.459153 cos_to_last_merge=0.9957 (last merge round=43)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9977721085928588, 'loss_val': 0.02470296532330456, 'psi': 0.9962215468487683}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978555260200789, 'loss_val': 0.02432773783102018, 'psi': 0.9962549138196564}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.392585 cos_to_last_merge=0.9986 (last merge round=43)
[S11] round=76 local utility u=0.015130 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9981454173457119, 'loss_val': 0.01683192073545559, 'psi': 0.9972009158055595}-{'f1_val': 0.9922530037320493, 'auprc': 0.9989617170078052, 'loss_val': 0.02363060170444843, 'psi': 0.9949364890423517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=76 head_norm_before_train=2.179745 cos_to_last_merge=0.9922 (last merge round=37)
[S13] round=76 local utility u=0.022260 metrics={'f1_val': 0.6437027055808321, 'auprc': 0.8718339267363331, 'loss_val': 1.0867909283479529, 'psi': 0.7349551940430326}-{'f1_val': 0.6652047054538975, 'auprc': 0.7836298318429678, 'loss_val': 0.9957115106242227, 'psi': 0.7125747560095257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=76 head_norm_before_train=2.239502 cos_to_last_merge=0.9960 (last merge round=43)
[S14] round=76 local utility u=0.000981 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992286188767783, 'loss_val': 0.019258166617771754, 'psi': 0.9981249226764497}-{'f1_val': 0.9971687801929319, 'auprc': 0.9992267130031962, 'loss_val': 0.019892824871843164, 'psi': 0.9979919533170376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=76 head_norm_before_train=2.355142 (no previous merge yet)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998885693027003, 'loss_val': 0.015278653672059333, 'psi': 0.9978246293276614}-{'f1_val': 0.9971172535281002, 'auprc': 0.9992027525464253, 'loss_val': 0.015403837770360421, 'psi': 0.9979514531354302}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.840501 cos_to_last_merge=0.9931 (last merge round=44)
[S16] round=76 local utility u=0.003487 metrics={'f1_val': 0.9913640279953416, 'auprc': 0.997434082351151, 'loss_val': 0.038952182487069054, 'psi': 0.9937920497376653}-{'f1_val': 0.9911445912637655, 'auprc': 0.9954252384524467, 'loss_val': 0.03858381446793968, 'psi': 0.992856850139238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=76 head_norm_before_train=2.224418 cos_to_last_merge=0.9949 (last merge round=43)
[S17] round=76 local utility u=1.000000 metrics={'f1_val': 0.8342736800922167, 'auprc': 0.9941828974152503, 'loss_val': 0.3739984061559032, 'psi': 0.8982373670214301}-{'f1_val': 0.5971195741576876, 'auprc': 0.9368026246603657, 'loss_val': 0.9636394977188192, 'psi': 0.7329927943587589}
[S17] not sending this round → trigger blocked (psi=0.898)
[S2] START round=77 head_norm_before_train=2.015370 cos_to_last_merge=0.9951 (last merge round=43)
[S2] round=77 local utility u=0.196557 metrics={'f1_val': 0.7646065306789289, 'auprc': 0.8607216943277612, 'loss_val': 0.5342806158676646, 'psi': 0.8030525961384618}-{'f1_val': 0.7181374718276868, 'auprc': 0.8584414875838828, 'loss_val': 0.6417392110782524, 'psi': 0.7742590781301653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=77 head_norm_before_train=1.993066 cos_to_last_merge=0.9732 (last merge round=44)
[S3] round=77 local utility u=1.000000 metrics={'f1_val': 0.8983358488964649, 'auprc': 0.9986964347204349, 'loss_val': 0.21874328468053916, 'psi': 0.9384800832260529}-{'f1_val': 0.6384956391926128, 'auprc': 0.894572396336306, 'loss_val': 1.2018622310240554, 'psi': 0.7409263420500901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=77 head_norm_before_train=1.768905 cos_to_last_merge=0.9667 (last merge round=37)
[S4] round=77 local utility u=0.030012 metrics={'f1_val': 0.9524137545592453, 'auprc': 0.9748804470514694, 'loss_val': 0.2924606502706946, 'psi': 0.9614004315561349}-{'f1_val': 0.9522773420749177, 'auprc': 0.9564208072959117, 'loss_val': 0.2962879824311778, 'psi': 0.9539347281633153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=77 head_norm_before_train=2.052994 cos_to_last_merge=0.9776 (last merge round=44)
[S5] round=77 local utility u=0.000687 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9997640803882959, 'loss_val': 0.02305022904703105, 'psi': 0.9981902493560934}-{'f1_val': 0.9971410286679584, 'auprc': 0.9997823997249313, 'loss_val': 0.024479887943722536, 'psi': 0.9981975770907475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=77 head_norm_before_train=1.731260 cos_to_last_merge=0.9463 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=77 local utility u=0.781677 metrics={'f1_val': 0.7634877398986071, 'auprc': 0.9580469394087123, 'loss_val': 0.4385815194072528, 'psi': 0.8413114197026492}-{'f1_val': 0.6150866968643397, 'auprc': 0.9180043642461744, 'loss_val': 0.9914008572050812, 'psi': 0.7362537638170736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=77 head_norm_before_train=1.802214 cos_to_last_merge=0.9510 (last merge round=40)
[S7] round=77 local utility u=0.791057 metrics={'f1_val': 0.9380356107211295, 'auprc': 0.9876070754516314, 'loss_val': 0.20436995637803126, 'psi': 0.9578641966133302}-{'f1_val': 0.7941301409033727, 'auprc': 0.8601242200876804, 'loss_val': 0.5406034101061445, 'psi': 0.8205277725770959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=77 head_norm_before_train=1.876565 cos_to_last_merge=0.9896 (last merge round=44)
[S8] round=77 local utility u=0.001651 metrics={'f1_val': 0.9874407651932935, 'auprc': 0.9993613464588778, 'loss_val': 0.046059302541676284, 'psi': 0.9922089976995272}-{'f1_val': 0.9924611780272952, 'auprc': 0.9847652218802145, 'loss_val': 0.03569552232075118, 'psi': 0.9893827955684629}
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] START round=77 head_norm_before_train=2.365870 (no previous merge yet)
[S9] round=77 local utility u=0.005297 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977799358264043, 'loss_val': 0.01638269176272844, 'psi': 0.9973737218378474}-{'f1_val': 0.9966924912647621, 'auprc': 0.9951594446031529, 'loss_val': 0.01665351784651311, 'psi': 0.9960792726001184}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=77 head_norm_before_train=2.462229 cos_to_last_merge=0.9955 (last merge round=43)
[S10] round=77 local utility u=0.000309 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979088262334836, 'loss_val': 0.024494740335138016, 'psi': 0.9962762339050183}-{'f1_val': 0.9951878390193748, 'auprc': 0.9977721085928588, 'loss_val': 0.02470296532330456, 'psi': 0.9962215468487683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=77 head_norm_before_train=2.395480 cos_to_last_merge=0.9986 (last merge round=43)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9979517735442297, 'loss_val': 0.01744046207223111, 'psi': 0.9971234582849666}-{'f1_val': 0.9965712481121245, 'auprc': 0.9981454173457119, 'loss_val': 0.01683192073545559, 'psi': 0.9972009158055595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=2.184948 cos_to_last_merge=0.9919 (last merge round=37)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.636431466756378, 'auprc': 0.6622210520008, 'loss_val': 1.1368246642211863, 'psi': 0.6467473008541468}-{'f1_val': 0.6437027055808321, 'auprc': 0.8718339267363331, 'loss_val': 1.0867909283479529, 'psi': 0.7349551940430326}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.244439 cos_to_last_merge=0.9959 (last merge round=43)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992273352759151, 'loss_val': 0.021425061048534724, 'psi': 0.9981244092361043}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992286188767783, 'loss_val': 0.019258166617771754, 'psi': 0.9981249226764497}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.360034 (no previous merge yet)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.805059451070942, 'auprc': 0.9640754646056781, 'loss_val': 0.4781582092992015, 'psi': 0.8686658564848364}-{'f1_val': 0.9971172535281002, 'auprc': 0.998885693027003, 'loss_val': 0.015278653672059333, 'psi': 0.9978246293276614}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=1.845149 cos_to_last_merge=0.9928 (last merge round=44)
[S16] round=77 local utility u=0.001295 metrics={'f1_val': 0.9919223247061469, 'auprc': 0.997287884388181, 'loss_val': 0.03927416916307071, 'psi': 0.9940685485789605}-{'f1_val': 0.9913640279953416, 'auprc': 0.997434082351151, 'loss_val': 0.038952182487069054, 'psi': 0.9937920497376653}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=77 head_norm_before_train=2.232606 cos_to_last_merge=0.9944 (last merge round=43)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6281423772238632, 'auprc': 0.9371977616923959, 'loss_val': 1.0416724946943343, 'psi': 0.7517645310112764}-{'f1_val': 0.8342736800922167, 'auprc': 0.9941828974152503, 'loss_val': 0.3739984061559032, 'psi': 0.8982373670214301}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.020948 cos_to_last_merge=0.9949 (last merge round=43)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.768228451032968, 'auprc': 0.8193084308361687, 'loss_val': 0.6005327900186412, 'psi': 0.7886604429542483}-{'f1_val': 0.7646065306789289, 'auprc': 0.8607216943277612, 'loss_val': 0.5342806158676646, 'psi': 0.8030525961384618}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=1.999708 cos_to_last_merge=0.9728 (last merge round=44)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.7481378272345668, 'auprc': 0.9391103712228189, 'loss_val': 0.6211628794951448, 'psi': 0.8245268448298677}-{'f1_val': 0.8983358488964649, 'auprc': 0.9986964347204349, 'loss_val': 0.21874328468053916, 'psi': 0.9384800832260529}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.772014 cos_to_last_merge=0.9661 (last merge round=37)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.946418420058209, 'auprc': 0.952636129327894, 'loss_val': 0.3021294777616856, 'psi': 0.948905503766083}-{'f1_val': 0.9524137545592453, 'auprc': 0.9748804470514694, 'loss_val': 0.2924606502706946, 'psi': 0.9614004315561349}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=2.056879 cos_to_last_merge=0.9772 (last merge round=44)
[S5] round=78 local utility u=0.000734 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.999576647178576, 'loss_val': 0.02102090967790858, 'psi': 0.9981152760722054}-{'f1_val': 0.9971410286679584, 'auprc': 0.9997640803882959, 'loss_val': 0.02305022904703105, 'psi': 0.9981902493560934}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=78 head_norm_before_train=1.736360 cos_to_last_merge=0.9455 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=78 local utility u=0.531923 metrics={'f1_val': 0.8897942396505515, 'auprc': 0.9739756427457058, 'loss_val': 0.18036108399127154, 'psi': 0.9234668008886132}-{'f1_val': 0.7634877398986071, 'auprc': 0.9580469394087123, 'loss_val': 0.4385815194072528, 'psi': 0.8413114197026492}
[S6] not sending this round → trigger blocked (psi=0.923)
[S7] START round=78 head_norm_before_train=1.813219 cos_to_last_merge=0.9497 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.8845818569861339, 'auprc': 0.9764397475846668, 'loss_val': 0.35207997339523694, 'psi': 0.921325013225547}-{'f1_val': 0.9380356107211295, 'auprc': 0.9876070754516314, 'loss_val': 0.20436995637803126, 'psi': 0.9578641966133302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.882886 cos_to_last_merge=0.9893 (last merge round=44)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9648009109845477, 'auprc': 0.9990824923171615, 'loss_val': 0.10907599033948151, 'psi': 0.9785135435175932}-{'f1_val': 0.9874407651932935, 'auprc': 0.9993613464588778, 'loss_val': 0.046059302541676284, 'psi': 0.9922089976995272}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.367692 (no previous merge yet)
[S9] round=78 local utility u=0.000925 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998826549046458, 'loss_val': 0.015850278652792746, 'psi': 0.997715679400102}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977799358264043, 'loss_val': 0.01638269176272844, 'psi': 0.9973737218378474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] START round=78 head_norm_before_train=2.463387 cos_to_last_merge=0.9954 (last merge round=43)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978145177387662, 'loss_val': 0.024771479588980606, 'psi': 0.9962385105071313}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979088262334836, 'loss_val': 0.024494740335138016, 'psi': 0.9962762339050183}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.399124 cos_to_last_merge=0.9985 (last merge round=43)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9799880923296015, 'auprc': 0.9991923029344195, 'loss_val': 0.08282692732673426, 'psi': 0.9876697765715288}-{'f1_val': 0.9965712481121245, 'auprc': 0.9979517735442297, 'loss_val': 0.01744046207223111, 'psi': 0.9971234582849666}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=2.190118 cos_to_last_merge=0.9917 (last merge round=37)
[S13] round=78 local utility u=0.036215 metrics={'f1_val': 0.6538031218372885, 'auprc': 0.65604198616306, 'loss_val': 1.1500871949621132, 'psi': 0.6546986675675971}-{'f1_val': 0.636431466756378, 'auprc': 0.6622210520008, 'loss_val': 1.1368246642211863, 'psi': 0.6467473008541468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=78 head_norm_before_train=2.249765 cos_to_last_merge=0.9957 (last merge round=43)
[S14] round=78 local utility u=0.000778 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992294012304175, 'loss_val': 0.01987562854982655, 'psi': 0.9981252356179053}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992273352759151, 'loss_val': 0.021425061048534724, 'psi': 0.9981244092361043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=78 head_norm_before_train=2.364590 (no previous merge yet)
[S15] round=78 local utility u=0.857702 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9986034360969326, 'loss_val': 0.016460870447809466, 'psi': 0.9974893754712854}-{'f1_val': 0.805059451070942, 'auprc': 0.9640754646056781, 'loss_val': 0.4781582092992015, 'psi': 0.8686658564848364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=78 head_norm_before_train=1.850070 cos_to_last_merge=0.9926 (last merge round=44)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9915793213105296, 'auprc': 0.9954106910526683, 'loss_val': 0.03842041084130022, 'psi': 0.993111869207385}-{'f1_val': 0.9919223247061469, 'auprc': 0.997287884388181, 'loss_val': 0.03927416916307071, 'psi': 0.9940685485789605}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.239580 cos_to_last_merge=0.9941 (last merge round=43)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6225621646557601, 'auprc': 0.9164465116618993, 'loss_val': 1.1682156654227498, 'psi': 0.7401159034582158}-{'f1_val': 0.6281423772238632, 'auprc': 0.9371977616923959, 'loss_val': 1.0416724946943343, 'psi': 0.7517645310112764}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.026377 cos_to_last_merge=0.9947 (last merge round=43)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.7085266722289566, 'auprc': 0.8601752222252194, 'loss_val': 0.7088448544197661, 'psi': 0.7691860922274617}-{'f1_val': 0.768228451032968, 'auprc': 0.8193084308361687, 'loss_val': 0.6005327900186412, 'psi': 0.7886604429542483}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.769 u=0.0000 p_local=0.0642 f1=0.709 auprc=0.860 bytes=59522
[S3] START round=79 head_norm_before_train=2.006803 cos_to_last_merge=0.9724 (last merge round=44)
[S3] round=79 local utility u=1.000000 metrics={'f1_val': 0.9861663683539634, 'auprc': 0.9985885081988836, 'loss_val': 0.04301888877820481, 'psi': 0.9911352242919316}-{'f1_val': 0.7481378272345668, 'auprc': 0.9391103712228189, 'loss_val': 0.6211628794951448, 'psi': 0.8245268448298677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=80 psi=0.991 u=1.0000 p_local=0.4185 f1=0.986 auprc=0.999 bytes=61164
[S4] START round=79 head_norm_before_train=1.775782 cos_to_last_merge=0.9656 (last merge round=37)
[S4] round=79 local utility u=0.056433 metrics={'f1_val': 0.9534230615774029, 'auprc': 0.9705981555706084, 'loss_val': 0.2851778582970101, 'psi': 0.9602930991746851}-{'f1_val': 0.946418420058209, 'auprc': 0.952636129327894, 'loss_val': 0.3021294777616856, 'psi': 0.948905503766083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=80 psi=0.960 u=0.0564 p_local=0.0281 f1=0.953 auprc=0.971 bytes=62927
[S5] START round=79 head_norm_before_train=2.064804 cos_to_last_merge=0.9766 (last merge round=44)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9993671750125982, 'loss_val': 0.02069643994293134, 'psi': 0.9978105907861211}-{'f1_val': 0.9971410286679584, 'auprc': 0.999576647178576, 'loss_val': 0.02102090967790858, 'psi': 0.9981152760722054}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.998 u=0.0000 p_local=0.0122 f1=0.997 auprc=0.999 bytes=57663
[S6] START round=79 head_norm_before_train=1.741388 cos_to_last_merge=0.9448 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.60396659252804, 'auprc': 0.8223702931359551, 'loss_val': 1.0720196624790248, 'psi': 0.691328072771206}-{'f1_val': 0.8897942396505515, 'auprc': 0.9739756427457058, 'loss_val': 0.18036108399127154, 'psi': 0.9234668008886132}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.691 u=0.0000 p_local=0.3565 f1=0.604 auprc=0.822 bytes=59381
[S7] START round=79 head_norm_before_train=1.821095 cos_to_last_merge=0.9488 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6414909445557825, 'auprc': 0.8245262511075178, 'loss_val': 0.9646273749655225, 'psi': 0.7147050671764766}-{'f1_val': 0.8845818569861339, 'auprc': 0.9764397475846668, 'loss_val': 0.35207997339523694, 'psi': 0.921325013225547}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.715 u=0.0000 p_local=0.2650 f1=0.641 auprc=0.825 bytes=55822
[S8] START round=79 head_norm_before_train=1.888916 cos_to_last_merge=0.9889 (last merge round=44)
[S8] round=79 local utility u=0.122858 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.997649111021015, 'loss_val': 0.03226067775273919, 'psi': 0.9952602322195456}-{'f1_val': 0.9648009109845477, 'auprc': 0.9990824923171615, 'loss_val': 0.10907599033948151, 'psi': 0.9785135435175932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S8] r=80 psi=0.995 u=0.1229 p_local=0.0420 f1=0.994 auprc=0.998 bytes=66591
[S9] START round=79 head_norm_before_train=2.375300 (no previous merge yet)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998400218341095, 'loss_val': 0.01805630864322877, 'psi': 0.9976986261718874}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998826549046458, 'loss_val': 0.015850278652792746, 'psi': 0.997715679400102}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.998 u=0.0000 p_local=0.0244 f1=0.996 auprc=1.000 bytes=66402
[S10] START round=79 head_norm_before_train=2.466363 cos_to_last_merge=0.9953 (last merge round=43)
[S10] round=79 local utility u=0.000314 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979261183802977, 'loss_val': 0.024478188561495806, 'psi': 0.996283150763744}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978145177387662, 'loss_val': 0.024771479588980606, 'psi': 0.9962385105071313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=80 psi=0.996 u=0.0003 p_local=0.0003 f1=0.995 auprc=0.998 bytes=62962
[S11] START round=79 head_norm_before_train=2.399014 cos_to_last_merge=0.9984 (last merge round=43)
[S11] round=79 local utility u=0.080618 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9979775268715705, 'loss_val': 0.017446369469385978, 'psi': 0.9971337596159029}-{'f1_val': 0.9799880923296015, 'auprc': 0.9991923029344195, 'loss_val': 0.08282692732673426, 'psi': 0.9876697765715288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=80 psi=0.997 u=0.0806 p_local=0.0187 f1=0.997 auprc=0.998 bytes=64762
[S13] START round=79 head_norm_before_train=2.198120 cos_to_last_merge=0.9912 (last merge round=37)
[S13] round=79 local utility u=0.550009 metrics={'f1_val': 0.7412859171303037, 'auprc': 0.7626925273197297, 'loss_val': 0.8949176769760517, 'psi': 0.7498485612060741}-{'f1_val': 0.6538031218372885, 'auprc': 0.65604198616306, 'loss_val': 1.1500871949621132, 'psi': 0.6546986675675971}
[S13] not sending this round → trigger blocked (psi=0.750)
[S13] r=80 psi=0.750 u=0.5500 p_local=0.1819 f1=0.741 auprc=0.763 bytes=61122
[S14] START round=79 head_norm_before_train=2.255326 cos_to_last_merge=0.9955 (last merge round=43)
[S14] round=79 local utility u=0.000417 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.999229102665948, 'loss_val': 0.019040927053736428, 'psi': 0.9981251161921175}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992294012304175, 'loss_val': 0.01987562854982655, 'psi': 0.9981252356179053}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=80 psi=0.998 u=0.0004 p_local=0.0145 f1=0.997 auprc=0.999 bytes=66459
[S15] START round=79 head_norm_before_train=2.368839 (no previous merge yet)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9989959171371154, 'loss_val': 0.020346418806431173, 'psi': 0.9978687189717063}-{'f1_val': 0.9967466683875206, 'auprc': 0.9986034360969326, 'loss_val': 0.016460870447809466, 'psi': 0.9974893754712854}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.998 u=0.0000 p_local=0.1963 f1=0.997 auprc=0.999 bytes=55790
[S16] START round=79 head_norm_before_train=1.855603 cos_to_last_merge=0.9924 (last merge round=44)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.991815439672853, 'auprc': 0.9830629353366095, 'loss_val': 0.04147782746248363, 'psi': 0.9883144379383555}-{'f1_val': 0.9915793213105296, 'auprc': 0.9954106910526683, 'loss_val': 0.03842041084130022, 'psi': 0.993111869207385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.988 u=0.0000 p_local=0.0073 f1=0.992 auprc=0.983 bytes=57541
[S17] START round=79 head_norm_before_train=2.247082 cos_to_last_merge=0.9938 (last merge round=43)
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.6215421301616415, 'auprc': 0.9128693485416521, 'loss_val': 1.1975461957186566, 'psi': 0.7380730175136458}-{'f1_val': 0.6225621646557601, 'auprc': 0.9164465116618993, 'loss_val': 1.1682156654227498, 'psi': 0.7401159034582158}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.738 u=0.0000 p_local=0.1871 f1=0.622 auprc=0.913 bytes=57509
[S2] START round=80 head_norm_before_train=2.030403 cos_to_last_merge=0.9946 (last merge round=43)
[S2] round=80 local utility u=0.151602 metrics={'f1_val': 0.7377358204763798, 'auprc': 0.8555427726208, 'loss_val': 0.5669978311598227, 'psi': 0.7848586013341479}-{'f1_val': 0.7085266722289566, 'auprc': 0.8601752222252194, 'loss_val': 0.7088448544197661, 'psi': 0.7691860922274617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=80 head_norm_before_train=2.015223 cos_to_last_merge=0.9718 (last merge round=44)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9582547498207286, 'auprc': 0.9892540330964056, 'loss_val': 0.1440541274606826, 'psi': 0.9706544631309993}-{'f1_val': 0.9861663683539634, 'auprc': 0.9985885081988836, 'loss_val': 0.04301888877820481, 'psi': 0.9911352242919316}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.780577 cos_to_last_merge=0.9652 (last merge round=37)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9501635975323177, 'auprc': 0.9743395288422378, 'loss_val': 0.2980890592522655, 'psi': 0.9598339700562858}-{'f1_val': 0.9534230615774029, 'auprc': 0.9705981555706084, 'loss_val': 0.2851778582970101, 'psi': 0.9602930991746851}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=2.075080 cos_to_last_merge=0.9759 (last merge round=44)
[S5] round=80 local utility u=0.000325 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9995959222799783, 'loss_val': 0.020306423516169462, 'psi': 0.9978595499990659}-{'f1_val': 0.9967728679684698, 'auprc': 0.9993671750125982, 'loss_val': 0.02069643994293134, 'psi': 0.9978105907861211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=80 head_norm_before_train=1.744742 cos_to_last_merge=0.9443 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=80 local utility u=1.000000 metrics={'f1_val': 0.8658301746241547, 'auprc': 0.9594958964976774, 'loss_val': 0.3060593503719104, 'psi': 0.9032964633735637}-{'f1_val': 0.60396659252804, 'auprc': 0.8223702931359551, 'loss_val': 1.0720196624790248, 'psi': 0.691328072771206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=80 head_norm_before_train=1.831142 cos_to_last_merge=0.9477 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=80 local utility u=1.000000 metrics={'f1_val': 0.9154405996699402, 'auprc': 0.9759190677567149, 'loss_val': 0.2972117158598166, 'psi': 0.9396319869046501}-{'f1_val': 0.6414909445557825, 'auprc': 0.8245262511075178, 'loss_val': 0.9646273749655225, 'psi': 0.7147050671764766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=80 head_norm_before_train=1.895589 cos_to_last_merge=0.9885 (last merge round=44)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9641517641247963, 'auprc': 0.9991639279942892, 'loss_val': 0.11299396136085284, 'psi': 0.9781566296725935}-{'f1_val': 0.9936676463518993, 'auprc': 0.997649111021015, 'loss_val': 0.03226067775273919, 'psi': 0.9952602322195456}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.383657 (no previous merge yet)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9997641609329345, 'loss_val': 0.05856608549530126, 'psi': 0.9924674081794502}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998400218341095, 'loss_val': 0.01805630864322877, 'psi': 0.9976986261718874}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.470334 cos_to_last_merge=0.9952 (last merge round=43)
[S10] round=80 local utility u=0.000166 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997967728824276, 'loss_val': 0.024271864564084502, 'psi': 0.9962997949413352}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979261183802977, 'loss_val': 0.024478188561495806, 'psi': 0.996283150763744}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=80 head_norm_before_train=2.400697 cos_to_last_merge=0.9983 (last merge round=43)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9979019598267513, 'loss_val': 0.01755121769790632, 'psi': 0.9971035327979753}-{'f1_val': 0.9965712481121245, 'auprc': 0.9979775268715705, 'loss_val': 0.017446369469385978, 'psi': 0.9971337596159029}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=2.204580 cos_to_last_merge=0.9909 (last merge round=37)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.7215218525644416, 'auprc': 0.7289832541204901, 'loss_val': 1.0669927166592987, 'psi': 0.724506413186861}-{'f1_val': 0.7412859171303037, 'auprc': 0.7626925273197297, 'loss_val': 0.8949176769760517, 'psi': 0.7498485612060741}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.261534 cos_to_last_merge=0.9953 (last merge round=43)
[S14] round=80 local utility u=0.001114 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9992270692836968, 'loss_val': 0.019257460317190403, 'psi': 0.9983693338694154}-{'f1_val': 0.9973891252095638, 'auprc': 0.999229102665948, 'loss_val': 0.019040927053736428, 'psi': 0.9981251161921175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=80 head_norm_before_train=2.373056 (no previous merge yet)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.7141020014882713, 'auprc': 0.9216338214808768, 'loss_val': 0.6454698163025737, 'psi': 0.7971147294853135}-{'f1_val': 0.9971172535281002, 'auprc': 0.9989959171371154, 'loss_val': 0.020346418806431173, 'psi': 0.9978687189717063}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.861013 cos_to_last_merge=0.9922 (last merge round=44)
[S16] round=80 local utility u=0.019358 metrics={'f1_val': 0.9927032863016021, 'auprc': 0.9925285150460377, 'loss_val': 0.036486377513809634, 'psi': 0.9926333777993763}-{'f1_val': 0.991815439672853, 'auprc': 0.9830629353366095, 'loss_val': 0.04147782746248363, 'psi': 0.9883144379383555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=80 head_norm_before_train=2.253838 cos_to_last_merge=0.9935 (last merge round=43)
[S17] round=80 local utility u=0.634984 metrics={'f1_val': 0.7356186340225186, 'auprc': 0.9702705219151466, 'loss_val': 0.7842405611766459, 'psi': 0.8294793891795698}-{'f1_val': 0.6215421301616415, 'auprc': 0.9128693485416521, 'loss_val': 1.1975461957186566, 'psi': 0.7380730175136458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=81 head_norm_before_train=2.034846 cos_to_last_merge=0.9945 (last merge round=43)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7093443933273814, 'auprc': 0.861068598910214, 'loss_val': 0.7185663659829159, 'psi': 0.7700340755605144}-{'f1_val': 0.7377358204763798, 'auprc': 0.8555427726208, 'loss_val': 0.5669978311598227, 'psi': 0.7848586013341479}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.023297 cos_to_last_merge=0.9713 (last merge round=44)
[S3] round=81 local utility u=0.036407 metrics={'f1_val': 0.9590033980848174, 'auprc': 0.9965207268064604, 'loss_val': 0.09753181958601094, 'psi': 0.9740103295734746}-{'f1_val': 0.9582547498207286, 'auprc': 0.9892540330964056, 'loss_val': 0.1440541274606826, 'psi': 0.9706544631309993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=81 head_norm_before_train=1.785763 cos_to_last_merge=0.9648 (last merge round=37)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9499316984269347, 'auprc': 0.9398687976818072, 'loss_val': 0.3053269567362196, 'psi': 0.9459065381288836}-{'f1_val': 0.9501635975323177, 'auprc': 0.9743395288422378, 'loss_val': 0.2980890592522655, 'psi': 0.9598339700562858}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.082006 cos_to_last_merge=0.9756 (last merge round=44)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.8627636655402122, 'auprc': 0.9903330334918133, 'loss_val': 0.25920625731903496, 'psi': 0.9137914127208526}-{'f1_val': 0.9967019684784577, 'auprc': 0.9995959222799783, 'loss_val': 0.020306423516169462, 'psi': 0.9978595499990659}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.748751 cos_to_last_merge=0.9436 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=81 local utility u=0.164433 metrics={'f1_val': 0.8929084758686382, 'auprc': 0.9691996309007829, 'loss_val': 0.1687747478668359, 'psi': 0.923424937881496}-{'f1_val': 0.8658301746241547, 'auprc': 0.9594958964976774, 'loss_val': 0.3060593503719104, 'psi': 0.9032964633735637}
[S6] not sending this round → trigger blocked (psi=0.923)
[S7] START round=81 head_norm_before_train=1.844416 cos_to_last_merge=0.9462 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.7919670293292977, 'auprc': 0.9907188842983984, 'loss_val': 0.38354602883912564, 'psi': 0.871467771316938}-{'f1_val': 0.9154405996699402, 'auprc': 0.9759190677567149, 'loss_val': 0.2972117158598166, 'psi': 0.9396319869046501}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.902026 cos_to_last_merge=0.9882 (last merge round=44)
[S8] round=81 local utility u=0.089543 metrics={'f1_val': 0.9838460548583284, 'auprc': 0.9989519985270884, 'loss_val': 0.051437784252672834, 'psi': 0.9898884323258323}-{'f1_val': 0.9641517641247963, 'auprc': 0.9991639279942892, 'loss_val': 0.11299396136085284, 'psi': 0.9781566296725935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=81 head_norm_before_train=2.389987 (no previous merge yet)
[S9] round=81 local utility u=0.039333 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9998149888071715, 'loss_val': 0.022076114563916036, 'psi': 0.9966901852924901}-{'f1_val': 0.9876029063437939, 'auprc': 0.9997641609329345, 'loss_val': 0.05856608549530126, 'psi': 0.9924674081794502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=81 head_norm_before_train=2.474765 cos_to_last_merge=0.9950 (last merge round=43)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979262038343659, 'loss_val': 0.024380576038166787, 'psi': 0.9962831849453713}-{'f1_val': 0.9951878390193748, 'auprc': 0.997967728824276, 'loss_val': 0.024271864564084502, 'psi': 0.9962997949413352}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.403418 cos_to_last_merge=0.9982 (last merge round=43)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9905872806723728, 'auprc': 0.9984866935537428, 'loss_val': 0.03196302359270218, 'psi': 0.9937470458249208}-{'f1_val': 0.9965712481121245, 'auprc': 0.9979019598267513, 'loss_val': 0.01755121769790632, 'psi': 0.9971035327979753}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=2.209707 cos_to_last_merge=0.9906 (last merge round=37)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.7066814496003407, 'auprc': 0.6848124884110138, 'loss_val': 1.0272482976561248, 'psi': 0.69793386512461}-{'f1_val': 0.7215218525644416, 'auprc': 0.7289832541204901, 'loss_val': 1.0669927166592987, 'psi': 0.724506413186861}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.263838 cos_to_last_merge=0.9953 (last merge round=43)
[S14] round=81 local utility u=0.000969 metrics={'f1_val': 0.9979907967189754, 'auprc': 0.9992326261177411, 'loss_val': 0.01849523851134244, 'psi': 0.9984875284784817}-{'f1_val': 0.9977975102598944, 'auprc': 0.9992270692836968, 'loss_val': 0.019257460317190403, 'psi': 0.9983693338694154}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=81 head_norm_before_train=2.376687 (no previous merge yet)
[S15] round=81 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9989318008052649, 'loss_val': 0.015541715402959174, 'psi': 0.9978430724389661}-{'f1_val': 0.7141020014882713, 'auprc': 0.9216338214808768, 'loss_val': 0.6454698163025737, 'psi': 0.7971147294853135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=81 head_norm_before_train=1.866243 cos_to_last_merge=0.9921 (last merge round=44)
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9915112133587306, 'auprc': 0.9945611880999705, 'loss_val': 0.03831117702657512, 'psi': 0.9927312032552266}-{'f1_val': 0.9927032863016021, 'auprc': 0.9925285150460377, 'loss_val': 0.036486377513809634, 'psi': 0.9926333777993763}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=2.259791 cos_to_last_merge=0.9933 (last merge round=43)
[S17] round=81 local utility u=0.236026 metrics={'f1_val': 0.7900208314813921, 'auprc': 0.9746526612127837, 'loss_val': 0.6517481077973705, 'psi': 0.8638735633739487}-{'f1_val': 0.7356186340225186, 'auprc': 0.9702705219151466, 'loss_val': 0.7842405611766459, 'psi': 0.8294793891795698}
[S17] not sending this round → trigger blocked (psi=0.864)
[S2] START round=82 head_norm_before_train=2.039122 cos_to_last_merge=0.9944 (last merge round=43)
[S2] round=82 local utility u=0.057315 metrics={'f1_val': 0.7102548315446842, 'auprc': 0.8622237952183862, 'loss_val': 0.6128653277030292, 'psi': 0.771042417014165}-{'f1_val': 0.7093443933273814, 'auprc': 0.861068598910214, 'loss_val': 0.7185663659829159, 'psi': 0.7700340755605144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=82 head_norm_before_train=2.030985 cos_to_last_merge=0.9708 (last merge round=44)
[S3] round=82 local utility u=0.059165 metrics={'f1_val': 0.9726348666603518, 'auprc': 0.9976894402029466, 'loss_val': 0.06449671082775257, 'psi': 0.9826566960773897}-{'f1_val': 0.9590033980848174, 'auprc': 0.9965207268064604, 'loss_val': 0.09753181958601094, 'psi': 0.9740103295734746}
[S3] not sending this round → trigger blocked (psi=0.983)
[S4] START round=82 head_norm_before_train=1.786760 cos_to_last_merge=0.9648 (last merge round=37)
[S4] round=82 local utility u=0.043895 metrics={'f1_val': 0.9527773034504434, 'auprc': 0.9613276866087017, 'loss_val': 0.2989879091863522, 'psi': 0.9561974567137467}-{'f1_val': 0.9499316984269347, 'auprc': 0.9398687976818072, 'loss_val': 0.3053269567362196, 'psi': 0.9459065381288836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=82 head_norm_before_train=2.085055 cos_to_last_merge=0.9751 (last merge round=44)
[S5] round=82 local utility u=0.535634 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9996667014804308, 'loss_val': 0.02220266093774617, 'psi': 0.9981512977929473}-{'f1_val': 0.8627636655402122, 'auprc': 0.9903330334918133, 'loss_val': 0.25920625731903496, 'psi': 0.9137914127208526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=82 head_norm_before_train=1.750850 cos_to_last_merge=0.9434 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.6650350369878506, 'auprc': 0.9337867676272366, 'loss_val': 0.668009357270983, 'psi': 0.772535729243605}-{'f1_val': 0.8929084758686382, 'auprc': 0.9691996309007829, 'loss_val': 0.1687747478668359, 'psi': 0.923424937881496}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.854249 cos_to_last_merge=0.9451 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=82 local utility u=0.572540 metrics={'f1_val': 0.948892607583377, 'auprc': 0.9897059296778967, 'loss_val': 0.1769810647418127, 'psi': 0.9652179364211849}-{'f1_val': 0.7919670293292977, 'auprc': 0.9907188842983984, 'loss_val': 0.38354602883912564, 'psi': 0.871467771316938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=82 head_norm_before_train=1.907267 cos_to_last_merge=0.9878 (last merge round=44)
[S8] round=82 local utility u=0.034208 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9955500937992673, 'loss_val': 0.03174464192549242, 'psi': 0.9944206253308465}-{'f1_val': 0.9838460548583284, 'auprc': 0.9989519985270884, 'loss_val': 0.051437784252672834, 'psi': 0.9898884323258323}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=82 head_norm_before_train=2.396769 (no previous merge yet)
[S9] round=82 local utility u=0.009283 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998483474619853, 'loss_val': 0.015932293672269733, 'psi': 0.997935646073129}-{'f1_val': 0.9946069829493691, 'auprc': 0.9998149888071715, 'loss_val': 0.022076114563916036, 'psi': 0.9966901852924901}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=82 head_norm_before_train=2.478788 cos_to_last_merge=0.9949 (last merge round=43)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979035825203251, 'loss_val': 0.02450526120088402, 'psi': 0.9962741364197549}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979262038343659, 'loss_val': 0.024380576038166787, 'psi': 0.9962831849453713}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.406592 cos_to_last_merge=0.9982 (last merge round=43)
[S11] round=82 local utility u=0.023896 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9977904482460201, 'loss_val': 0.01786377526405574, 'psi': 0.9970467322954664}-{'f1_val': 0.9905872806723728, 'auprc': 0.9984866935537428, 'loss_val': 0.03196302359270218, 'psi': 0.9937470458249208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=82 head_norm_before_train=2.213821 cos_to_last_merge=0.9903 (last merge round=37)
[S13] round=82 local utility u=0.045072 metrics={'f1_val': 0.7085881471827029, 'auprc': 0.6994167321740706, 'loss_val': 0.9923582022403179, 'psi': 0.7049195811792499}-{'f1_val': 0.7066814496003407, 'auprc': 0.6848124884110138, 'loss_val': 1.0272482976561248, 'psi': 0.69793386512461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=82 head_norm_before_train=2.266799 cos_to_last_merge=0.9952 (last merge round=43)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9812554061266638, 'auprc': 0.9992031937603169, 'loss_val': 0.036541248668948895, 'psi': 0.988434521180125}-{'f1_val': 0.9979907967189754, 'auprc': 0.9992326261177411, 'loss_val': 0.01849523851134244, 'psi': 0.9984875284784817}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.380652 (no previous merge yet)
[S15] round=82 local utility u=0.000117 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9992808448964489, 'loss_val': 0.016355166012940757, 'psi': 0.9979826900754396}-{'f1_val': 0.9971172535281002, 'auprc': 0.9989318008052649, 'loss_val': 0.015541715402959174, 'psi': 0.9978430724389661}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=82 head_norm_before_train=1.870841 cos_to_last_merge=0.9918 (last merge round=44)
[S16] round=82 local utility u=0.002092 metrics={'f1_val': 0.9917987580421058, 'auprc': 0.9948187079444741, 'loss_val': 0.036625075005527384, 'psi': 0.9930067380030532}-{'f1_val': 0.9915112133587306, 'auprc': 0.9945611880999705, 'loss_val': 0.03831117702657512, 'psi': 0.9927312032552266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=82 head_norm_before_train=2.266680 cos_to_last_merge=0.9931 (last merge round=43)
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.6223240395205216, 'auprc': 0.9163979455464516, 'loss_val': 1.1979450781083272, 'psi': 0.7399536019308937}-{'f1_val': 0.7900208314813921, 'auprc': 0.9746526612127837, 'loss_val': 0.6517481077973705, 'psi': 0.8638735633739487}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.041581 cos_to_last_merge=0.9942 (last merge round=43)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7141839005354554, 'auprc': 0.8622536170371964, 'loss_val': 0.6524216173577932, 'psi': 0.7734117871361519}-{'f1_val': 0.7102548315446842, 'auprc': 0.8622237952183862, 'loss_val': 0.6128653277030292, 'psi': 0.771042417014165}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.038777 cos_to_last_merge=0.9703 (last merge round=44)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.9233413303196987, 'auprc': 0.9610396179073462, 'loss_val': 0.28573751244220713, 'psi': 0.9384206453547577}-{'f1_val': 0.9726348666603518, 'auprc': 0.9976894402029466, 'loss_val': 0.06449671082775257, 'psi': 0.9826566960773897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.787438 cos_to_last_merge=0.9645 (last merge round=37)
[S4] round=83 local utility u=0.007720 metrics={'f1_val': 0.9538739579142408, 'auprc': 0.9645059642739899, 'loss_val': 0.2996636027658893, 'psi': 0.9581267604581405}-{'f1_val': 0.9527773034504434, 'auprc': 0.9613276866087017, 'loss_val': 0.2989879091863522, 'psi': 0.9561974567137467}
[S4] not sending this round → trigger blocked (psi=0.958)
[S5] START round=83 head_norm_before_train=2.085933 cos_to_last_merge=0.9748 (last merge round=44)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9375344924626459, 'auprc': 0.9932186296015604, 'loss_val': 0.11333167130369583, 'psi': 0.9598081473182117}-{'f1_val': 0.9971410286679584, 'auprc': 0.9996667014804308, 'loss_val': 0.02220266093774617, 'psi': 0.9981512977929473}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.753197 cos_to_last_merge=0.9431 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=83 local utility u=0.660518 metrics={'f1_val': 0.8239028991684477, 'auprc': 0.9626818329803917, 'loss_val': 0.3868650128877838, 'psi': 0.8794144726932254}-{'f1_val': 0.6650350369878506, 'auprc': 0.9337867676272366, 'loss_val': 0.668009357270983, 'psi': 0.772535729243605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=83 head_norm_before_train=1.861585 cos_to_last_merge=0.9443 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.8148578254204614, 'auprc': 0.9420694245967407, 'loss_val': 0.6462375151972395, 'psi': 0.8657424650909731}-{'f1_val': 0.948892607583377, 'auprc': 0.9897059296778967, 'loss_val': 0.1769810647418127, 'psi': 0.9652179364211849}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.912923 cos_to_last_merge=0.9875 (last merge round=44)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9892253440581832, 'auprc': 0.9994356944636923, 'loss_val': 0.04275850485372559, 'psi': 0.9933094842203868}-{'f1_val': 0.9936676463518993, 'auprc': 0.9955500937992673, 'loss_val': 0.03174464192549242, 'psi': 0.9944206253308465}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.395851 (no previous merge yet)
[S9] round=83 local utility u=0.000024 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9999418820792305, 'loss_val': 0.016144417279906682, 'psi': 0.9979709600113389}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998483474619853, 'loss_val': 0.015932293672269733, 'psi': 0.997935646073129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=83 head_norm_before_train=2.480910 cos_to_last_merge=0.9948 (last merge round=43)
[S10] round=83 local utility u=0.000147 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979403044178121, 'loss_val': 0.02432083271086658, 'psi': 0.9962888251787496}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979035825203251, 'loss_val': 0.02450526120088402, 'psi': 0.9962741364197549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=83 head_norm_before_train=2.410329 cos_to_last_merge=0.9981 (last merge round=43)
[S11] round=83 local utility u=0.000765 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9981127686397716, 'loss_val': 0.017422586028678796, 'psi': 0.9971878563231834}-{'f1_val': 0.9965509216617638, 'auprc': 0.9977904482460201, 'loss_val': 0.01786377526405574, 'psi': 0.9970467322954664}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=83 head_norm_before_train=2.218900 cos_to_last_merge=0.9900 (last merge round=37)
[S13] round=83 local utility u=0.053613 metrics={'f1_val': 0.7353477399091697, 'auprc': 0.71192693291502, 'loss_val': 1.0832208311517955, 'psi': 0.7259794171115098}-{'f1_val': 0.7085881471827029, 'auprc': 0.6994167321740706, 'loss_val': 0.9923582022403179, 'psi': 0.7049195811792499}
[S13] not sending this round → trigger blocked (psi=0.726)
[S14] START round=83 head_norm_before_train=2.269478 cos_to_last_merge=0.9952 (last merge round=43)
[S14] round=83 local utility u=0.058482 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992313591231421, 'loss_val': 0.01646496228469635, 'psi': 0.9981260187749952}-{'f1_val': 0.9812554061266638, 'auprc': 0.9992031937603169, 'loss_val': 0.036541248668948895, 'psi': 0.988434521180125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=83 head_norm_before_train=2.384777 (no previous merge yet)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9988821328684159, 'loss_val': 0.015352545572632225, 'psi': 0.9978232052642264}-{'f1_val': 0.9971172535281002, 'auprc': 0.9992808448964489, 'loss_val': 0.016355166012940757, 'psi': 0.9979826900754396}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.875807 cos_to_last_merge=0.9916 (last merge round=44)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9929589123119194, 'auprc': 0.9861570595796796, 'loss_val': 0.03511957246485716, 'psi': 0.9902381712190234}-{'f1_val': 0.9917987580421058, 'auprc': 0.9948187079444741, 'loss_val': 0.036625075005527384, 'psi': 0.9930067380030532}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=2.273184 cos_to_last_merge=0.9929 (last merge round=43)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.6125100355957306, 'auprc': 0.8904116564538596, 'loss_val': 1.350019246478284, 'psi': 0.7236706839389822}-{'f1_val': 0.6223240395205216, 'auprc': 0.9163979455464516, 'loss_val': 1.1979450781083272, 'psi': 0.7399536019308937}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.041319 cos_to_last_merge=0.9941 (last merge round=43)
[S2] round=84 local utility u=0.221627 metrics={'f1_val': 0.7704815520152188, 'auprc': 0.8543003316411216, 'loss_val': 0.5230939214718373, 'psi': 0.8040090638655799}-{'f1_val': 0.7141839005354554, 'auprc': 0.8622536170371964, 'loss_val': 0.6524216173577932, 'psi': 0.7734117871361519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=84 head_norm_before_train=2.046255 cos_to_last_merge=0.9698 (last merge round=44)
[S3] round=84 local utility u=0.181177 metrics={'f1_val': 0.9527269596713882, 'auprc': 0.9838417092110634, 'loss_val': 0.16810306507586253, 'psi': 0.9651728594872583}-{'f1_val': 0.9233413303196987, 'auprc': 0.9610396179073462, 'loss_val': 0.28573751244220713, 'psi': 0.9384206453547577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=84 head_norm_before_train=1.787442 cos_to_last_merge=0.9643 (last merge round=37)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9509685688916617, 'auprc': 0.9443106439458068, 'loss_val': 0.2978782534214997, 'psi': 0.9483053989133198}-{'f1_val': 0.9538739579142408, 'auprc': 0.9645059642739899, 'loss_val': 0.2996636027658893, 'psi': 0.9581267604581405}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=2.088290 cos_to_last_merge=0.9746 (last merge round=44)
[S5] round=84 local utility u=0.220554 metrics={'f1_val': 0.9959650868991299, 'auprc': 0.9964708581558119, 'loss_val': 0.032564668752134415, 'psi': 0.9961673954018027}-{'f1_val': 0.9375344924626459, 'auprc': 0.9932186296015604, 'loss_val': 0.11333167130369583, 'psi': 0.9598081473182117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=84 head_norm_before_train=1.761195 cos_to_last_merge=0.9422 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.6324654615568608, 'auprc': 0.7893669887376729, 'loss_val': 0.7335081655518237, 'psi': 0.6952260724291857}-{'f1_val': 0.8239028991684477, 'auprc': 0.9626818329803917, 'loss_val': 0.3868650128877838, 'psi': 0.8794144726932254}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.865956 cos_to_last_merge=0.9437 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5056797141553436, 'auprc': 0.6426950513565309, 'loss_val': 1.5429798298215396, 'psi': 0.5604858490358186}-{'f1_val': 0.8148578254204614, 'auprc': 0.9420694245967407, 'loss_val': 0.6462375151972395, 'psi': 0.8657424650909731}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.917255 cos_to_last_merge=0.9872 (last merge round=44)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9729079278466329, 'auprc': 0.9991438989540633, 'loss_val': 0.07550298056260445, 'psi': 0.9834023162896051}-{'f1_val': 0.9892253440581832, 'auprc': 0.9994356944636923, 'loss_val': 0.04275850485372559, 'psi': 0.9933094842203868}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=2.398202 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.99994054684183, 'loss_val': 0.020230557411539635, 'psi': 0.9972227114898689}-{'f1_val': 0.9966570119660778, 'auprc': 0.9999418820792305, 'loss_val': 0.016144417279906682, 'psi': 0.9979709600113389}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.484328 cos_to_last_merge=0.9946 (last merge round=43)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979033259048586, 'loss_val': 0.02447629439894223, 'psi': 0.9962740337735683}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979403044178121, 'loss_val': 0.02432083271086658, 'psi': 0.9962888251787496}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.414170 cos_to_last_merge=0.9981 (last merge round=43)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9634217179386175, 'auprc': 0.9991657272051129, 'loss_val': 0.13959576495359707, 'psi': 0.9777193216452157}-{'f1_val': 0.9965712481121245, 'auprc': 0.9981127686397716, 'loss_val': 0.017422586028678796, 'psi': 0.9971878563231834}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.225125 cos_to_last_merge=0.9896 (last merge round=37)
[S13] round=84 local utility u=0.092037 metrics={'f1_val': 0.7373806056729092, 'auprc': 0.7326349011752207, 'loss_val': 0.9734687825908327, 'psi': 0.7354823238738338}-{'f1_val': 0.7353477399091697, 'auprc': 0.71192693291502, 'loss_val': 1.0832208311517955, 'psi': 0.7259794171115098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=84 head_norm_before_train=2.269809 cos_to_last_merge=0.9951 (last merge round=43)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992313849747065, 'loss_val': 0.01785039746786869, 'psi': 0.9981260291156209}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992313591231421, 'loss_val': 0.01646496228469635, 'psi': 0.9981260187749952}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.389140 (no previous merge yet)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998581794181046, 'loss_val': 0.015905837624967736, 'psi': 0.9974807187049307}-{'f1_val': 0.9971172535281002, 'auprc': 0.9988821328684159, 'loss_val': 0.015352545572632225, 'psi': 0.9978232052642264}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=1.880826 cos_to_last_merge=0.9914 (last merge round=44)
[S16] round=84 local utility u=0.009003 metrics={'f1_val': 0.9917825805535123, 'auprc': 0.9948541634082451, 'loss_val': 0.03614611261495927, 'psi': 0.9930112136954055}-{'f1_val': 0.9929589123119194, 'auprc': 0.9861570595796796, 'loss_val': 0.03511957246485716, 'psi': 0.9902381712190234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=84 head_norm_before_train=2.280675 cos_to_last_merge=0.9926 (last merge round=43)
[S17] round=84 local utility u=0.194907 metrics={'f1_val': 0.6311338169226974, 'auprc': 0.9278435161738193, 'loss_val': 1.1842435714885573, 'psi': 0.7498176966231462}-{'f1_val': 0.6125100355957306, 'auprc': 0.8904116564538596, 'loss_val': 1.350019246478284, 'psi': 0.7236706839389822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=85 head_norm_before_train=2.043825 cos_to_last_merge=0.9940 (last merge round=43)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.707374259465677, 'auprc': 0.8458366416430256, 'loss_val': 0.5990135376309872, 'psi': 0.7627592123366165}-{'f1_val': 0.7704815520152188, 'auprc': 0.8543003316411216, 'loss_val': 0.5230939214718373, 'psi': 0.8040090638655799}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.054180 cos_to_last_merge=0.9693 (last merge round=44)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.8882853390983574, 'auprc': 0.9642508508741336, 'loss_val': 0.3203332455031242, 'psi': 0.9186715438086679}-{'f1_val': 0.9527269596713882, 'auprc': 0.9838417092110634, 'loss_val': 0.16810306507586253, 'psi': 0.9651728594872583}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.791083 cos_to_last_merge=0.9640 (last merge round=37)
[S4] round=85 local utility u=0.010614 metrics={'f1_val': 0.9415248909295775, 'auprc': 0.9729961201089377, 'loss_val': 0.3060455625739232, 'psi': 0.9541133826013215}-{'f1_val': 0.9509685688916617, 'auprc': 0.9443106439458068, 'loss_val': 0.2978782534214997, 'psi': 0.9483053989133198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=85 head_norm_before_train=2.091664 cos_to_last_merge=0.9745 (last merge round=44)
[S5] round=85 local utility u=0.013769 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9995517250142547, 'loss_val': 0.021325601156803375, 'psi': 0.9981053072064769}-{'f1_val': 0.9959650868991299, 'auprc': 0.9964708581558119, 'loss_val': 0.032564668752134415, 'psi': 0.9961673954018027}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=85 head_norm_before_train=1.766824 cos_to_last_merge=0.9417 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=85 local utility u=0.106957 metrics={'f1_val': 0.6158889541805306, 'auprc': 0.9349508867628707, 'loss_val': 0.8568863848569357, 'psi': 0.7435137272134666}-{'f1_val': 0.6324654615568608, 'auprc': 0.7893669887376729, 'loss_val': 0.7335081655518237, 'psi': 0.6952260724291857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=85 head_norm_before_train=1.870147 cos_to_last_merge=0.9433 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=85 local utility u=0.802257 metrics={'f1_val': 0.5772327973398774, 'auprc': 0.8921412056230267, 'loss_val': 1.1161237286327317, 'psi': 0.7031961606531372}-{'f1_val': 0.5056797141553436, 'auprc': 0.6426950513565309, 'loss_val': 1.5429798298215396, 'psi': 0.5604858490358186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=85 head_norm_before_train=1.920700 cos_to_last_merge=0.9870 (last merge round=44)
[S8] round=85 local utility u=0.082419 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9992026211557857, 'loss_val': 0.03100968690655946, 'psi': 0.9954427578274084}-{'f1_val': 0.9729079278466329, 'auprc': 0.9991438989540633, 'loss_val': 0.07550298056260445, 'psi': 0.9834023162896051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=85 head_norm_before_train=2.397883 (no previous merge yet)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9965002746362641, 'auprc': 0.9960973543097407, 'loss_val': 0.017265322529016785, 'psi': 0.9963391065056547}-{'f1_val': 0.9954108212552283, 'auprc': 0.99994054684183, 'loss_val': 0.020230557411539635, 'psi': 0.9972227114898689}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.488357 cos_to_last_merge=0.9945 (last merge round=43)
[S10] round=85 local utility u=0.000031 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979122470237292, 'loss_val': 0.024441521474930443, 'psi': 0.9962776022211165}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979033259048586, 'loss_val': 0.02447629439894223, 'psi': 0.9962740337735683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=85 head_norm_before_train=2.418069 cos_to_last_merge=0.9981 (last merge round=43)
[S11] round=85 local utility u=0.158754 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9980528818382468, 'loss_val': 0.017647315689607847, 'psi': 0.9971639016025735}-{'f1_val': 0.9634217179386175, 'auprc': 0.9991657272051129, 'loss_val': 0.13959576495359707, 'psi': 0.9777193216452157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=85 head_norm_before_train=2.232433 cos_to_last_merge=0.9892 (last merge round=37)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.7038863076509039, 'auprc': 0.7060821431444653, 'loss_val': 1.0021924986343478, 'psi': 0.7047646418483284}-{'f1_val': 0.7373806056729092, 'auprc': 0.7326349011752207, 'loss_val': 0.9734687825908327, 'psi': 0.7354823238738338}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.270873 cos_to_last_merge=0.9949 (last merge round=43)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988528775692805, 'loss_val': 0.020904347243715857, 'psi': 0.9982210852935797}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992313849747065, 'loss_val': 0.01785039746786869, 'psi': 0.9981260291156209}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.393366 (no previous merge yet)
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984596871624902, 'loss_val': 0.016772116906997495, 'psi': 0.9974318758975085}-{'f1_val': 0.9967466683875206, 'auprc': 0.998581794181046, 'loss_val': 0.015905837624967736, 'psi': 0.9974807187049307}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=1.884035 cos_to_last_merge=0.9912 (last merge round=44)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9917226101384911, 'auprc': 0.994090128009901, 'loss_val': 0.039396267435607535, 'psi': 0.992669617287055}-{'f1_val': 0.9917825805535123, 'auprc': 0.9948541634082451, 'loss_val': 0.03614611261495927, 'psi': 0.9930112136954055}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.285819 cos_to_last_merge=0.9924 (last merge round=43)
[S17] round=85 local utility u=0.522735 metrics={'f1_val': 0.7302883124503292, 'auprc': 0.9668515229494561, 'loss_val': 0.8507238290718595, 'psi': 0.82491359664998}-{'f1_val': 0.6311338169226974, 'auprc': 0.9278435161738193, 'loss_val': 1.1842435714885573, 'psi': 0.7498176966231462}
[S17] not sending this round → trigger blocked (psi=0.825)
[S2] START round=86 head_norm_before_train=2.047174 cos_to_last_merge=0.9938 (last merge round=43)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.707374259465677, 'auprc': 0.8384329567065403, 'loss_val': 0.620119690361554, 'psi': 0.7597977383620222}-{'f1_val': 0.707374259465677, 'auprc': 0.8458366416430256, 'loss_val': 0.5990135376309872, 'psi': 0.7627592123366165}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.061021 cos_to_last_merge=0.9688 (last merge round=44)
[S3] round=86 local utility u=0.535649 metrics={'f1_val': 0.9979993017510456, 'auprc': 0.9987727779718051, 'loss_val': 0.010885363478647417, 'psi': 0.9983086922393494}-{'f1_val': 0.8882853390983574, 'auprc': 0.9642508508741336, 'loss_val': 0.3203332455031242, 'psi': 0.9186715438086679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=86 head_norm_before_train=1.798893 cos_to_last_merge=0.9634 (last merge round=37)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9407139445208261, 'auprc': 0.9331758385884067, 'loss_val': 0.31310136383285064, 'psi': 0.9376987021478583}-{'f1_val': 0.9415248909295775, 'auprc': 0.9729961201089377, 'loss_val': 0.3060455625739232, 'psi': 0.9541133826013215}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=2.096388 cos_to_last_merge=0.9743 (last merge round=44)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9993185523203452, 'loss_val': 0.021049226199400573, 'psi': 0.998012038128913}-{'f1_val': 0.9971410286679584, 'auprc': 0.9995517250142547, 'loss_val': 0.021325601156803375, 'psi': 0.9981053072064769}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.771471 cos_to_last_merge=0.9411 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=86 local utility u=1.000000 metrics={'f1_val': 0.8582141057542075, 'auprc': 0.9499629452304872, 'loss_val': 0.31149105167979185, 'psi': 0.8949136415447194}-{'f1_val': 0.6158889541805306, 'auprc': 0.9349508867628707, 'loss_val': 0.8568863848569357, 'psi': 0.7435137272134666}
[S6] not sending this round → trigger blocked (psi=0.895)
[S7] START round=86 head_norm_before_train=1.873351 cos_to_last_merge=0.9429 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=86 local utility u=0.787203 metrics={'f1_val': 0.7660650900025636, 'auprc': 0.9426091876979963, 'loss_val': 0.8261152108904759, 'psi': 0.8366827290807367}-{'f1_val': 0.5772327973398774, 'auprc': 0.8921412056230267, 'loss_val': 1.1161237286327317, 'psi': 0.7031961606531372}
[S7] not sending this round → trigger blocked (psi=0.837)
[S8] START round=86 head_norm_before_train=1.924911 cos_to_last_merge=0.9868 (last merge round=44)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9892533794312297, 'loss_val': 0.030658541282022615, 'psi': 0.9916098378497712}-{'f1_val': 0.9929361822751569, 'auprc': 0.9992026211557857, 'loss_val': 0.03100968690655946, 'psi': 0.9954427578274084}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.396800 (no previous merge yet)
[S9] round=86 local utility u=0.003916 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999194731565124, 'loss_val': 0.01685899235085904, 'psi': 0.9974638202811162}-{'f1_val': 0.9965002746362641, 'auprc': 0.9960973543097407, 'loss_val': 0.017265322529016785, 'psi': 0.9963391065056547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=86 head_norm_before_train=2.492714 cos_to_last_merge=0.9944 (last merge round=43)
[S10] round=86 local utility u=0.000103 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997941665485197, 'loss_val': 0.024323175713947123, 'psi': 0.9962893696057036}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979122470237292, 'loss_val': 0.024441521474930443, 'psi': 0.9962776022211165}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=86 head_norm_before_train=2.421399 cos_to_last_merge=0.9980 (last merge round=43)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9971965027284967, 'loss_val': 0.019847993403690933, 'psi': 0.9966640518616199}-{'f1_val': 0.9965712481121245, 'auprc': 0.9980528818382468, 'loss_val': 0.017647315689607847, 'psi': 0.9971639016025735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=2.240501 cos_to_last_merge=0.9887 (last merge round=37)
[S13] round=86 local utility u=0.076931 metrics={'f1_val': 0.7258560452008805, 'auprc': 0.7473406416803989, 'loss_val': 1.103924974084483, 'psi': 0.7344498837926878}-{'f1_val': 0.7038863076509039, 'auprc': 0.7060821431444653, 'loss_val': 1.0021924986343478, 'psi': 0.7047646418483284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=86 head_norm_before_train=2.273514 cos_to_last_merge=0.9946 (last merge round=43)
[S14] round=86 local utility u=0.000232 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992315379499426, 'loss_val': 0.019111397108459847, 'psi': 0.9981260903057154}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988528775692805, 'loss_val': 0.020904347243715857, 'psi': 0.9982210852935797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=86 head_norm_before_train=2.397499 (no previous merge yet)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980337587220489, 'loss_val': 0.01840205569239598, 'psi': 0.9972615045213319}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984596871624902, 'loss_val': 0.016772116906997495, 'psi': 0.9974318758975085}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=1.888119 cos_to_last_merge=0.9910 (last merge round=44)
[S16] round=86 local utility u=0.000827 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.9949977478132419, 'loss_val': 0.03699639976061676, 'psi': 0.9926858538835561}-{'f1_val': 0.9917226101384911, 'auprc': 0.994090128009901, 'loss_val': 0.039396267435607535, 'psi': 0.992669617287055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=86 head_norm_before_train=2.289837 cos_to_last_merge=0.9923 (last merge round=43)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.6597137503029699, 'auprc': 0.9549297211280742, 'loss_val': 1.0530471959587582, 'psi': 0.7778001386330116}-{'f1_val': 0.7302883124503292, 'auprc': 0.9668515229494561, 'loss_val': 0.8507238290718595, 'psi': 0.82491359664998}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.052754 cos_to_last_merge=0.9937 (last merge round=43)
[S2] round=87 local utility u=0.316498 metrics={'f1_val': 0.800735308807971, 'auprc': 0.83736525430946, 'loss_val': 0.5440870056560994, 'psi': 0.8153872870085666}-{'f1_val': 0.707374259465677, 'auprc': 0.8384329567065403, 'loss_val': 0.620119690361554, 'psi': 0.7597977383620222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=87 head_norm_before_train=2.066175 cos_to_last_merge=0.9685 (last merge round=44)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.8867665329677141, 'auprc': 0.9307472344910734, 'loss_val': 0.4386702775442255, 'psi': 0.9043588135770579}-{'f1_val': 0.9979993017510456, 'auprc': 0.9987727779718051, 'loss_val': 0.010885363478647417, 'psi': 0.9983086922393494}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.805397 cos_to_last_merge=0.9627 (last merge round=37)
[S4] round=87 local utility u=0.022175 metrics={'f1_val': 0.9466641313945809, 'auprc': 0.9327304097923574, 'loss_val': 0.3031161364246054, 'psi': 0.9410906427536916}-{'f1_val': 0.9407139445208261, 'auprc': 0.9331758385884067, 'loss_val': 0.31310136383285064, 'psi': 0.9376987021478583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=87 head_norm_before_train=2.104110 cos_to_last_merge=0.9739 (last merge round=44)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9990662648554047, 'loss_val': 0.01951104049861061, 'psi': 0.9976476870292366}-{'f1_val': 0.9971410286679584, 'auprc': 0.9993185523203452, 'loss_val': 0.021049226199400573, 'psi': 0.998012038128913}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=1.775931 cos_to_last_merge=0.9406 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.8225994087263265, 'auprc': 0.9583427199370096, 'loss_val': 0.39171768985116867, 'psi': 0.8768967332105997}-{'f1_val': 0.8582141057542075, 'auprc': 0.9499629452304872, 'loss_val': 0.31149105167979185, 'psi': 0.8949136415447194}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.882482 cos_to_last_merge=0.9420 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=87 local utility u=0.175914 metrics={'f1_val': 0.7957582325988382, 'auprc': 0.9595069756302976, 'loss_val': 0.7031392938869909, 'psi': 0.8612577298114219}-{'f1_val': 0.7660650900025636, 'auprc': 0.9426091876979963, 'loss_val': 0.8261152108904759, 'psi': 0.8366827290807367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=87 head_norm_before_train=1.929858 cos_to_last_merge=0.9865 (last merge round=44)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9580615275479363, 'auprc': 0.999147585489069, 'loss_val': 0.12165931753171208, 'psi': 0.9744959507243894}-{'f1_val': 0.9931808101287989, 'auprc': 0.9892533794312297, 'loss_val': 0.030658541282022615, 'psi': 0.9916098378497712}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.399038 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9909631199453779, 'auprc': 0.9998195155908977, 'loss_val': 0.03307452593961698, 'psi': 0.9945056782035857}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999194731565124, 'loss_val': 0.01685899235085904, 'psi': 0.9974638202811162}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.497232 cos_to_last_merge=0.9942 (last merge round=43)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979214909259871, 'loss_val': 0.024373601330360244, 'psi': 0.9962812997820196}-{'f1_val': 0.9951878390193748, 'auprc': 0.997941665485197, 'loss_val': 0.024323175713947123, 'psi': 0.9962893696057036}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.421394 cos_to_last_merge=0.9979 (last merge round=43)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9944092829953568, 'auprc': 0.9986222880776754, 'loss_val': 0.020152000217145343, 'psi': 0.9960944850282842}-{'f1_val': 0.9963090846170353, 'auprc': 0.9971965027284967, 'loss_val': 0.019847993403690933, 'psi': 0.9966640518616199}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=2.247600 cos_to_last_merge=0.9884 (last merge round=37)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6945027206678154, 'auprc': 0.707605806705809, 'loss_val': 1.0489671977238424, 'psi': 0.6997439550830128}-{'f1_val': 0.7258560452008805, 'auprc': 0.7473406416803989, 'loss_val': 1.103924974084483, 'psi': 0.7344498837926878}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.276323 cos_to_last_merge=0.9944 (last merge round=43)
[S14] round=87 local utility u=0.000189 metrics={'f1_val': 0.997411628228889, 'auprc': 0.9992309796740795, 'loss_val': 0.01886620627162827, 'psi': 0.9981393688069652}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992315379499426, 'loss_val': 0.019111397108459847, 'psi': 0.9981260903057154}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=87 head_norm_before_train=2.401623 (no previous merge yet)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978035518533745, 'loss_val': 0.018867969975594548, 'psi': 0.9971694217738621}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980337587220489, 'loss_val': 0.01840205569239598, 'psi': 0.9972615045213319}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.892348 cos_to_last_merge=0.9908 (last merge round=44)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9908353819319027, 'loss_val': 0.036275432245336296, 'psi': 0.9920446601174846}-{'f1_val': 0.9911445912637655, 'auprc': 0.9949977478132419, 'loss_val': 0.03699639976061676, 'psi': 0.9926858538835561}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.294819 cos_to_last_merge=0.9921 (last merge round=43)
[S17] round=87 local utility u=0.282238 metrics={'f1_val': 0.7173511821399435, 'auprc': 0.9709029253689384, 'loss_val': 0.8823153724276981, 'psi': 0.8187718794315415}-{'f1_val': 0.6597137503029699, 'auprc': 0.9549297211280742, 'loss_val': 1.0530471959587582, 'psi': 0.7778001386330116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=88 head_norm_before_train=2.059028 cos_to_last_merge=0.9935 (last merge round=43)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7082627559848672, 'auprc': 0.8586128565550261, 'loss_val': 0.6484444170353817, 'psi': 0.7684027962129307}-{'f1_val': 0.800735308807971, 'auprc': 0.83736525430946, 'loss_val': 0.5440870056560994, 'psi': 0.8153872870085666}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.071278 cos_to_last_merge=0.9681 (last merge round=44)
[S3] round=88 local utility u=0.644697 metrics={'f1_val': 0.9973443261882198, 'auprc': 0.9987728802277155, 'loss_val': 0.016820285218102617, 'psi': 0.9979157478040181}-{'f1_val': 0.8867665329677141, 'auprc': 0.9307472344910734, 'loss_val': 0.4386702775442255, 'psi': 0.9043588135770579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=88 head_norm_before_train=1.809405 cos_to_last_merge=0.9620 (last merge round=37)
[S4] round=88 local utility u=0.022427 metrics={'f1_val': 0.9492302720698202, 'auprc': 0.9395828700494716, 'loss_val': 0.2942172052185157, 'psi': 0.9453713112616808}-{'f1_val': 0.9466641313945809, 'auprc': 0.9327304097923574, 'loss_val': 0.3031161364246054, 'psi': 0.9410906427536916}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=88 head_norm_before_train=2.113824 cos_to_last_merge=0.9733 (last merge round=44)
[S5] round=88 local utility u=0.002220 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9996839370959151, 'loss_val': 0.02176415248832585, 'psi': 0.9983787482040013}-{'f1_val': 0.9967019684784577, 'auprc': 0.9990662648554047, 'loss_val': 0.01951104049861061, 'psi': 0.9976476870292366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=88 head_norm_before_train=1.782484 cos_to_last_merge=0.9398 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=88 local utility u=0.099962 metrics={'f1_val': 0.8563739713016777, 'auprc': 0.950443319453469, 'loss_val': 0.3707435529960461, 'psi': 0.8940017105623943}-{'f1_val': 0.8225994087263265, 'auprc': 0.9583427199370096, 'loss_val': 0.39171768985116867, 'psi': 0.8768967332105997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=88 head_norm_before_train=1.892951 cos_to_last_merge=0.9409 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=88 local utility u=0.582167 metrics={'f1_val': 0.9132294338533837, 'auprc': 0.9799689551435015, 'loss_val': 0.3050191528396834, 'psi': 0.9399252423694308}-{'f1_val': 0.7957582325988382, 'auprc': 0.9595069756302976, 'loss_val': 0.7031392938869909, 'psi': 0.8612577298114219}
[S7] not sending this round → trigger blocked (psi=0.940)
[S8] START round=88 head_norm_before_train=1.933568 cos_to_last_merge=0.9862 (last merge round=44)
[S8] round=88 local utility u=0.069164 metrics={'f1_val': 0.9735792596874677, 'auprc': 0.9987857340814792, 'loss_val': 0.07535253664782286, 'psi': 0.9836618494450723}-{'f1_val': 0.9580615275479363, 'auprc': 0.999147585489069, 'loss_val': 0.12165931753171208, 'psi': 0.9744959507243894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=88 head_norm_before_train=2.405598 (no previous merge yet)
[S9] round=88 local utility u=0.027597 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999337767348532, 'loss_val': 0.015062756146654192, 'psi': 0.9982352582012269}-{'f1_val': 0.9909631199453779, 'auprc': 0.9998195155908977, 'loss_val': 0.03307452593961698, 'psi': 0.9945056782035857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=88 head_norm_before_train=2.501751 cos_to_last_merge=0.9941 (last merge round=43)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978400708381013, 'loss_val': 0.02455798933974311, 'psi': 0.9962487317468653}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979214909259871, 'loss_val': 0.024373601330360244, 'psi': 0.9962812997820196}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=2.421180 cos_to_last_merge=0.9978 (last merge round=43)
[S11] round=88 local utility u=0.007729 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9983666607803049, 'loss_val': 0.016897970449081867, 'psi': 0.9972894131793967}-{'f1_val': 0.9944092829953568, 'auprc': 0.9986222880776754, 'loss_val': 0.020152000217145343, 'psi': 0.9960944850282842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=88 head_norm_before_train=2.251215 cos_to_last_merge=0.9882 (last merge round=37)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6951149137447064, 'auprc': 0.6655630616860734, 'loss_val': 1.1876022941361575, 'psi': 0.6832941729212532}-{'f1_val': 0.6945027206678154, 'auprc': 0.707605806705809, 'loss_val': 1.0489671977238424, 'psi': 0.6997439550830128}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.281528 cos_to_last_merge=0.9942 (last merge round=43)
[S14] round=88 local utility u=0.000245 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992319910901482, 'loss_val': 0.018243939986208157, 'psi': 0.9981262715617976}-{'f1_val': 0.997411628228889, 'auprc': 0.9992309796740795, 'loss_val': 0.01886620627162827, 'psi': 0.9981393688069652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=88 head_norm_before_train=2.405722 (no previous merge yet)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997615850022598, 'loss_val': 0.0184104403878056, 'psi': 0.9970943410415516}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978035518533745, 'loss_val': 0.018867969975594548, 'psi': 0.9971694217738621}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.897370 cos_to_last_merge=0.9907 (last merge round=44)
[S16] round=88 local utility u=0.000103 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.9945226779088439, 'loss_val': 0.03689379293555291, 'psi': 0.9924958259217969}-{'f1_val': 0.9928508455745393, 'auprc': 0.9908353819319027, 'loss_val': 0.036275432245336296, 'psi': 0.9920446601174846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=88 head_norm_before_train=2.299147 cos_to_last_merge=0.9919 (last merge round=43)
[S17] round=88 local utility u=0.703368 metrics={'f1_val': 0.8711839580529485, 'auprc': 0.9908065658166227, 'loss_val': 0.4582870320267698, 'psi': 0.9190330011584182}-{'f1_val': 0.7173511821399435, 'auprc': 0.9709029253689384, 'loss_val': 0.8823153724276981, 'psi': 0.8187718794315415}
[S17] not sending this round → trigger blocked (psi=0.919)
[S2] START round=89 head_norm_before_train=2.064679 cos_to_last_merge=0.9934 (last merge round=43)
[S2] round=89 local utility u=0.197578 metrics={'f1_val': 0.7603618288240461, 'auprc': 0.8529542492463167, 'loss_val': 0.5489064131568782, 'psi': 0.7973987969929544}-{'f1_val': 0.7082627559848672, 'auprc': 0.8586128565550261, 'loss_val': 0.6484444170353817, 'psi': 0.7684027962129307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=89 head_norm_before_train=2.073699 cos_to_last_merge=0.9680 (last merge round=44)
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9320444784394935, 'auprc': 0.9981795556633195, 'loss_val': 0.21058926377725065, 'psi': 0.9584985093290239}-{'f1_val': 0.9973443261882198, 'auprc': 0.9987728802277155, 'loss_val': 0.016820285218102617, 'psi': 0.9979157478040181}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.814130 cos_to_last_merge=0.9612 (last merge round=37)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9398584495410333, 'auprc': 0.9233128639999146, 'loss_val': 0.32166274306506093, 'psi': 0.9332402153245858}-{'f1_val': 0.9492302720698202, 'auprc': 0.9395828700494716, 'loss_val': 0.2942172052185157, 'psi': 0.9453713112616808}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.121935 cos_to_last_merge=0.9728 (last merge round=44)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9383785958336569, 'auprc': 0.9918240360227448, 'loss_val': 0.11770183743203733, 'psi': 0.9597567719092921}-{'f1_val': 0.9975086222760589, 'auprc': 0.9996839370959151, 'loss_val': 0.02176415248832585, 'psi': 0.9983787482040013}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.788274 cos_to_last_merge=0.9391 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.6913168258345191, 'auprc': 0.9504181991135361, 'loss_val': 0.6591221561829265, 'psi': 0.794957375146126}-{'f1_val': 0.8563739713016777, 'auprc': 0.950443319453469, 'loss_val': 0.3707435529960461, 'psi': 0.8940017105623943}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.903533 cos_to_last_merge=0.9398 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.558316105164714, 'auprc': 0.7135581999464375, 'loss_val': 1.3312847385858566, 'psi': 0.6204129430774035}-{'f1_val': 0.9132294338533837, 'auprc': 0.9799689551435015, 'loss_val': 0.3050191528396834, 'psi': 0.9399252423694308}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.937186 cos_to_last_merge=0.9860 (last merge round=44)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.8932484388408942, 'auprc': 0.9956190974751392, 'loss_val': 0.21095819312187128, 'psi': 0.9341967022945923}-{'f1_val': 0.9735792596874677, 'auprc': 0.9987857340814792, 'loss_val': 0.07535253664782286, 'psi': 0.9836618494450723}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.409117 (no previous merge yet)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999319765901493, 'loss_val': 0.01781223083341486, 'psi': 0.9977354080743034}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999337767348532, 'loss_val': 0.015062756146654192, 'psi': 0.9982352582012269}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.505541 cos_to_last_merge=0.9940 (last merge round=43)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978273090326033, 'loss_val': 0.02452029279786546, 'psi': 0.9962436270246662}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978400708381013, 'loss_val': 0.02455798933974311, 'psi': 0.9962487317468653}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.422483 cos_to_last_merge=0.9977 (last merge round=43)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9974064805046664, 'loss_val': 0.01966640027338703, 'psi': 0.9967480429720877}-{'f1_val': 0.9965712481121245, 'auprc': 0.9983666607803049, 'loss_val': 0.016897970449081867, 'psi': 0.9972894131793967}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.254376 cos_to_last_merge=0.9881 (last merge round=37)
[S13] round=89 local utility u=0.159270 metrics={'f1_val': 0.7327150990731209, 'auprc': 0.6956843046393526, 'loss_val': 1.1850262837860888, 'psi': 0.7179027812996136}-{'f1_val': 0.6951149137447064, 'auprc': 0.6655630616860734, 'loss_val': 1.1876022941361575, 'psi': 0.6832941729212532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=89 head_norm_before_train=2.286845 cos_to_last_merge=0.9941 (last merge round=43)
[S14] round=89 local utility u=0.000229 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992313849747065, 'loss_val': 0.017784682410107423, 'psi': 0.9981260291156209}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992319910901482, 'loss_val': 0.018243939986208157, 'psi': 0.9981262715617976}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=89 head_norm_before_train=2.409750 (no previous merge yet)
[S15] round=89 local utility u=0.000133 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976261628789673, 'loss_val': 0.018176113999548344, 'psi': 0.9970984661840993}-{'f1_val': 0.9967466683875206, 'auprc': 0.997615850022598, 'loss_val': 0.0184104403878056, 'psi': 0.9970943410415516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=89 head_norm_before_train=1.902035 cos_to_last_merge=0.9905 (last merge round=44)
[S16] round=89 local utility u=0.000567 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.994897614894811, 'loss_val': 0.03688443504507343, 'psi': 0.9926458007161837}-{'f1_val': 0.9911445912637655, 'auprc': 0.9945226779088439, 'loss_val': 0.03689379293555291, 'psi': 0.9924958259217969}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=89 head_norm_before_train=2.304307 cos_to_last_merge=0.9917 (last merge round=43)
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.6905129594209376, 'auprc': 0.9722628357727676, 'loss_val': 0.944224867140962, 'psi': 0.8032129099616696}-{'f1_val': 0.8711839580529485, 'auprc': 0.9908065658166227, 'loss_val': 0.4582870320267698, 'psi': 0.9190330011584182}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.069662 cos_to_last_merge=0.9933 (last merge round=43)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.713258482803394, 'auprc': 0.8602304380927167, 'loss_val': 0.68234938347761, 'psi': 0.772047264919123}-{'f1_val': 0.7603618288240461, 'auprc': 0.8529542492463167, 'loss_val': 0.5489064131568782, 'psi': 0.7973987969929544}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.077018 cos_to_last_merge=0.9678 (last merge round=44)
[S3] round=90 local utility u=0.296173 metrics={'f1_val': 0.9973723651999591, 'auprc': 0.9994508066255166, 'loss_val': 0.014023840969612759, 'psi': 0.9982037417701821}-{'f1_val': 0.9320444784394935, 'auprc': 0.9981795556633195, 'loss_val': 0.21058926377725065, 'psi': 0.9584985093290239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=90 head_norm_before_train=1.816567 cos_to_last_merge=0.9607 (last merge round=37)
[S4] round=90 local utility u=0.041605 metrics={'f1_val': 0.9478739580970797, 'auprc': 0.9301381545258833, 'loss_val': 0.30702140752116325, 'psi': 0.9407796366686012}-{'f1_val': 0.9398584495410333, 'auprc': 0.9233128639999146, 'loss_val': 0.32166274306506093, 'psi': 0.9332402153245858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=90 head_norm_before_train=2.128394 cos_to_last_merge=0.9723 (last merge round=44)
[S5] round=90 local utility u=0.229259 metrics={'f1_val': 0.9959650868991299, 'auprc': 0.9978557119822549, 'loss_val': 0.02279687685957857, 'psi': 0.99672133693238}-{'f1_val': 0.9383785958336569, 'auprc': 0.9918240360227448, 'loss_val': 0.11770183743203733, 'psi': 0.9597567719092921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=90 head_norm_before_train=1.793180 cos_to_last_merge=0.9384 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.6485473390200847, 'auprc': 0.93930243198985, 'loss_val': 0.6610089562365972, 'psi': 0.7648493762079909}-{'f1_val': 0.6913168258345191, 'auprc': 0.9504181991135361, 'loss_val': 0.6591221561829265, 'psi': 0.794957375146126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.914466 cos_to_last_merge=0.9387 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=90 local utility u=0.625119 metrics={'f1_val': 0.6085096150485354, 'auprc': 0.9396359468500345, 'loss_val': 1.0604406711299725, 'psi': 0.740960147769135}-{'f1_val': 0.558316105164714, 'auprc': 0.7135581999464375, 'loss_val': 1.3312847385858566, 'psi': 0.6204129430774035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=90 head_norm_before_train=1.938156 cos_to_last_merge=0.9859 (last merge round=44)
[S8] round=90 local utility u=0.136086 metrics={'f1_val': 0.9305669455352661, 'auprc': 0.9948909043221803, 'loss_val': 0.1605117242829347, 'psi': 0.9562965290500318}-{'f1_val': 0.8932484388408942, 'auprc': 0.9956190974751392, 'loss_val': 0.21095819312187128, 'psi': 0.9341967022945923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=90 head_norm_before_train=2.411963 (no previous merge yet)
[S9] round=90 local utility u=0.003805 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999311502363613, 'loss_val': 0.015001587315245462, 'psi': 0.9982153080161646}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999319765901493, 'loss_val': 0.01781223083341486, 'psi': 0.9977354080743034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=90 head_norm_before_train=2.507129 cos_to_last_merge=0.9938 (last merge round=43)
[S10] round=90 local utility u=0.000254 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979222248223142, 'loss_val': 0.02429655668805456, 'psi': 0.9962815933405504}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978273090326033, 'loss_val': 0.02452029279786546, 'psi': 0.9962436270246662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=90 head_norm_before_train=2.424945 cos_to_last_merge=0.9977 (last merge round=43)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9922557487939716, 'auprc': 0.9993418973590977, 'loss_val': 0.027434053036599012, 'psi': 0.995090208220022}-{'f1_val': 0.9963090846170353, 'auprc': 0.9974064805046664, 'loss_val': 0.01966640027338703, 'psi': 0.9967480429720877}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=2.257522 cos_to_last_merge=0.9878 (last merge round=37)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6978788810489239, 'auprc': 0.6851089818880477, 'loss_val': 1.109218787173134, 'psi': 0.6927709213845734}-{'f1_val': 0.7327150990731209, 'auprc': 0.6956843046393526, 'loss_val': 1.1850262837860888, 'psi': 0.7179027812996136}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.290779 cos_to_last_merge=0.9940 (last merge round=43)
[S14] round=90 local utility u=0.001288 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9992321432208039, 'loss_val': 0.017675119006042853, 'psi': 0.998372791554189}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992313849747065, 'loss_val': 0.017784682410107423, 'psi': 0.9981260291156209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=90 head_norm_before_train=2.413714 (no previous merge yet)
[S15] round=90 local utility u=0.000522 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978617561249911, 'loss_val': 0.017838207761079385, 'psi': 0.9971927034825088}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976261628789673, 'loss_val': 0.018176113999548344, 'psi': 0.9970984661840993}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=90 head_norm_before_train=1.904522 cos_to_last_merge=0.9902 (last merge round=44)
[S16] round=90 local utility u=0.000529 metrics={'f1_val': 0.9912919143280989, 'auprc': 0.9949512397465411, 'loss_val': 0.03687093301898783, 'psi': 0.9927556444954757}-{'f1_val': 0.9911445912637655, 'auprc': 0.994897614894811, 'loss_val': 0.03688443504507343, 'psi': 0.9926458007161837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=90 head_norm_before_train=2.309042 cos_to_last_merge=0.9915 (last merge round=43)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.6204644842724302, 'auprc': 0.9530326438062067, 'loss_val': 1.224497180727303, 'psi': 0.7534917480859408}-{'f1_val': 0.6905129594209376, 'auprc': 0.9722628357727676, 'loss_val': 0.944224867140962, 'psi': 0.8032129099616696}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.072443 cos_to_last_merge=0.9932 (last merge round=43)
[S2] round=91 local utility u=0.421061 metrics={'f1_val': 0.8338843179824105, 'auprc': 0.8464010112322863, 'loss_val': 0.5224941026858128, 'psi': 0.8388909952823609}-{'f1_val': 0.713258482803394, 'auprc': 0.8602304380927167, 'loss_val': 0.68234938347761, 'psi': 0.772047264919123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=91 head_norm_before_train=2.077646 cos_to_last_merge=0.9677 (last merge round=44)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9533430796450505, 'auprc': 0.9741964871699342, 'loss_val': 0.17930062945801495, 'psi': 0.961684442655004}-{'f1_val': 0.9973723651999591, 'auprc': 0.9994508066255166, 'loss_val': 0.014023840969612759, 'psi': 0.9982037417701821}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.818245 cos_to_last_merge=0.9603 (last merge round=37)
[S4] round=91 local utility u=0.015326 metrics={'f1_val': 0.9483521062220472, 'auprc': 0.9372373585984922, 'loss_val': 0.3005349462514176, 'psi': 0.9439062071726252}-{'f1_val': 0.9478739580970797, 'auprc': 0.9301381545258833, 'loss_val': 0.30702140752116325, 'psi': 0.9407796366686012}
[S4] not sending this round → trigger blocked (psi=0.944)
[S5] START round=91 head_norm_before_train=2.132856 cos_to_last_merge=0.9721 (last merge round=44)
[S5] round=91 local utility u=0.008350 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9999765255122035, 'loss_val': 0.0195143453307256, 'psi': 0.9982752274056563}-{'f1_val': 0.9959650868991299, 'auprc': 0.9978557119822549, 'loss_val': 0.02279687685957857, 'psi': 0.99672133693238}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=91 head_norm_before_train=1.799791 cos_to_last_merge=0.9377 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=91 local utility u=0.823738 metrics={'f1_val': 0.8564689713825364, 'auprc': 0.9641216116167639, 'loss_val': 0.33552068978056887, 'psi': 0.8995300274762273}-{'f1_val': 0.6485473390200847, 'auprc': 0.93930243198985, 'loss_val': 0.6610089562365972, 'psi': 0.7648493762079909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=91 head_norm_before_train=1.920669 cos_to_last_merge=0.9379 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=91 local utility u=0.532042 metrics={'f1_val': 0.7813654554826778, 'auprc': 0.8676430720948997, 'loss_val': 0.8175127513117432, 'psi': 0.8158765021275665}-{'f1_val': 0.6085096150485354, 'auprc': 0.9396359468500345, 'loss_val': 1.0604406711299725, 'psi': 0.740960147769135}
[S7] not sending this round → trigger blocked (psi=0.816)
[S8] START round=91 head_norm_before_train=1.939845 cos_to_last_merge=0.9857 (last merge round=44)
[S8] round=91 local utility u=0.262072 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9993493689900882, 'loss_val': 0.029814789155351396, 'psi': 0.9960871124630433}-{'f1_val': 0.9305669455352661, 'auprc': 0.9948909043221803, 'loss_val': 0.1605117242829347, 'psi': 0.9562965290500318}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=91 head_norm_before_train=2.415558 (no previous merge yet)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999321723851398, 'loss_val': 0.016736522996865972, 'psi': 0.9974688999725672}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999311502363613, 'loss_val': 0.015001587315245462, 'psi': 0.9982153080161646}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.509984 cos_to_last_merge=0.9937 (last merge round=43)
[S10] round=91 local utility u=0.000046 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9979404088004256, 'loss_val': 0.024258314518142615, 'psi': 0.9962888669317951}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979222248223142, 'loss_val': 0.02429655668805456, 'psi': 0.9962815933405504}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=91 head_norm_before_train=2.426236 cos_to_last_merge=0.9976 (last merge round=43)
[S11] round=91 local utility u=0.018100 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9992211470909929, 'loss_val': 0.01676569516517979, 'psi': 0.9976312077036719}-{'f1_val': 0.9922557487939716, 'auprc': 0.9993418973590977, 'loss_val': 0.027434053036599012, 'psi': 0.995090208220022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=91 head_norm_before_train=2.262415 cos_to_last_merge=0.9875 (last merge round=37)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6901255184032877, 'auprc': 0.6832621010394099, 'loss_val': 1.0791062112084981, 'psi': 0.6873801514577367}-{'f1_val': 0.6978788810489239, 'auprc': 0.6851089818880477, 'loss_val': 1.109218787173134, 'psi': 0.6927709213845734}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.290529 cos_to_last_merge=0.9940 (last merge round=43)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.972013587409803, 'auprc': 0.9944991256516527, 'loss_val': 0.09440407411346982, 'psi': 0.9810078027065429}-{'f1_val': 0.9977998904431125, 'auprc': 0.9992321432208039, 'loss_val': 0.017675119006042853, 'psi': 0.998372791554189}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.417558 (no previous merge yet)
[S15] round=91 local utility u=0.000311 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979992877865246, 'loss_val': 0.017628056247854032, 'psi': 0.9972477161471222}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978617561249911, 'loss_val': 0.017838207761079385, 'psi': 0.9971927034825088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=91 head_norm_before_train=1.908305 cos_to_last_merge=0.9900 (last merge round=44)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9915793213105296, 'auprc': 0.9929367646568517, 'loss_val': 0.03672892438723229, 'psi': 0.9921222986490583}-{'f1_val': 0.9912919143280989, 'auprc': 0.9949512397465411, 'loss_val': 0.03687093301898783, 'psi': 0.9927556444954757}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.313963 cos_to_last_merge=0.9914 (last merge round=43)
[S17] round=91 local utility u=0.428677 metrics={'f1_val': 0.6980120091683972, 'auprc': 0.9789336908968804, 'loss_val': 0.9101314060635894, 'psi': 0.8103806818597905}-{'f1_val': 0.6204644842724302, 'auprc': 0.9530326438062067, 'loss_val': 1.224497180727303, 'psi': 0.7534917480859408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=92 head_norm_before_train=2.067231 cos_to_last_merge=0.9929 (last merge round=43)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6999068363319535, 'auprc': 0.8583751987324653, 'loss_val': 0.6256487549587342, 'psi': 0.7632941812921582}-{'f1_val': 0.8338843179824105, 'auprc': 0.8464010112322863, 'loss_val': 0.5224941026858128, 'psi': 0.8388909952823609}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.082638 cos_to_last_merge=0.9674 (last merge round=44)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.8977609058554636, 'auprc': 0.967042400671195, 'loss_val': 0.30015962448364286, 'psi': 0.9254735037817562}-{'f1_val': 0.9533430796450505, 'auprc': 0.9741964871699342, 'loss_val': 0.17930062945801495, 'psi': 0.961684442655004}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.823974 cos_to_last_merge=0.9598 (last merge round=37)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9424998981426209, 'auprc': 0.9316110621561176, 'loss_val': 0.30859907045403323, 'psi': 0.9381443637480196}-{'f1_val': 0.9483521062220472, 'auprc': 0.9372373585984922, 'loss_val': 0.3005349462514176, 'psi': 0.9439062071726252}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=2.137620 cos_to_last_merge=0.9718 (last merge round=44)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.902081370464707, 'auprc': 0.9950180622616424, 'loss_val': 0.13374692747958297, 'psi': 0.9392560471834812}-{'f1_val': 0.9971410286679584, 'auprc': 0.9999765255122035, 'loss_val': 0.0195143453307256, 'psi': 0.9982752274056563}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=1.807516 cos_to_last_merge=0.9369 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.5305462199487568, 'auprc': 0.7313012354943578, 'loss_val': 1.258024696284791, 'psi': 0.6108482261669972}-{'f1_val': 0.8564689713825364, 'auprc': 0.9641216116167639, 'loss_val': 0.33552068978056887, 'psi': 0.8995300274762273}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.929830 cos_to_last_merge=0.9369 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.6740141113296014, 'auprc': 0.9366186951693749, 'loss_val': 0.986707933031217, 'psi': 0.7790559448655108}-{'f1_val': 0.7813654554826778, 'auprc': 0.8676430720948997, 'loss_val': 0.8175127513117432, 'psi': 0.8158765021275665}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=1.941384 cos_to_last_merge=0.9856 (last merge round=44)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.8898659498504109, 'auprc': 0.9970532996968252, 'loss_val': 0.24197915519967636, 'psi': 0.9327408897889766}-{'f1_val': 0.9939122747783468, 'auprc': 0.9993493689900882, 'loss_val': 0.029814789155351396, 'psi': 0.9960871124630433}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.413594 (no previous merge yet)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9999242190382032, 'loss_val': 0.03264754582956933, 'psi': 0.9944444868995523}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999321723851398, 'loss_val': 0.016736522996865972, 'psi': 0.9974688999725672}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.513547 cos_to_last_merge=0.9936 (last merge round=43)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978604065115475, 'loss_val': 0.0244370253386769, 'psi': 0.9962568660162439}-{'f1_val': 0.9951878390193748, 'auprc': 0.9979404088004256, 'loss_val': 0.024258314518142615, 'psi': 0.9962888669317951}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.428728 cos_to_last_merge=0.9975 (last merge round=43)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9978397762543826, 'loss_val': 0.019466644976933404, 'psi': 0.9969213612719743}-{'f1_val': 0.9965712481121245, 'auprc': 0.9992211470909929, 'loss_val': 0.01676569516517979, 'psi': 0.9976312077036719}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.266115 cos_to_last_merge=0.9873 (last merge round=37)
[S13] round=92 local utility u=0.289623 metrics={'f1_val': 0.7518688903621549, 'auprc': 0.7324588322959859, 'loss_val': 1.0179105997503417, 'psi': 0.7441048671356872}-{'f1_val': 0.6901255184032877, 'auprc': 0.6832621010394099, 'loss_val': 1.0791062112084981, 'psi': 0.6873801514577367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=92 head_norm_before_train=2.294097 cos_to_last_merge=0.9939 (last merge round=43)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9591655205481913, 'auprc': 0.9992319982434266, 'loss_val': 0.05975117997231971, 'psi': 0.9751921116262854}-{'f1_val': 0.972013587409803, 'auprc': 0.9944991256516527, 'loss_val': 0.09440407411346982, 'psi': 0.9810078027065429}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.421364 (no previous merge yet)
[S15] round=92 local utility u=0.000106 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980225116766833, 'loss_val': 0.01748659559174364, 'psi': 0.9972570057031857}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979992877865246, 'loss_val': 0.017628056247854032, 'psi': 0.9972477161471222}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=92 head_norm_before_train=1.911307 cos_to_last_merge=0.9899 (last merge round=44)
[S16] round=92 local utility u=0.001199 metrics={'f1_val': 0.9915793213105296, 'auprc': 0.9937905127570673, 'loss_val': 0.03689208010679869, 'psi': 0.9924637978891446}-{'f1_val': 0.9915793213105296, 'auprc': 0.9929367646568517, 'loss_val': 0.03672892438723229, 'psi': 0.9921222986490583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=92 head_norm_before_train=2.319049 cos_to_last_merge=0.9912 (last merge round=43)
[S17] round=92 local utility u=0.569925 metrics={'f1_val': 0.8239859674813645, 'auprc': 0.9908737331174495, 'loss_val': 0.561946094797951, 'psi': 0.8907410737357986}-{'f1_val': 0.6980120091683972, 'auprc': 0.9789336908968804, 'loss_val': 0.9101314060635894, 'psi': 0.8103806818597905}
[S17] not sending this round → trigger blocked (psi=0.891)
[S2] START round=93 head_norm_before_train=2.066336 cos_to_last_merge=0.9926 (last merge round=43)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.6948341797296465, 'auprc': 0.8271990033626829, 'loss_val': 0.5742895895431107, 'psi': 0.7477801091828611}-{'f1_val': 0.6999068363319535, 'auprc': 0.8583751987324653, 'loss_val': 0.6256487549587342, 'psi': 0.7632941812921582}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.090088 cos_to_last_merge=0.9669 (last merge round=44)
[S3] round=93 local utility u=0.089728 metrics={'f1_val': 0.9206761670993153, 'auprc': 0.9601257130797001, 'loss_val': 0.23744525309567388, 'psi': 0.9364559854914691}-{'f1_val': 0.8977609058554636, 'auprc': 0.967042400671195, 'loss_val': 0.30015962448364286, 'psi': 0.9254735037817562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=93 head_norm_before_train=1.829205 cos_to_last_merge=0.9593 (last merge round=37)
[S4] round=93 local utility u=0.058040 metrics={'f1_val': 0.9465349821948587, 'auprc': 0.9601726277923199, 'loss_val': 0.3024136068715088, 'psi': 0.9519900404338432}-{'f1_val': 0.9424998981426209, 'auprc': 0.9316110621561176, 'loss_val': 0.30859907045403323, 'psi': 0.9381443637480196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=93 head_norm_before_train=2.142889 cos_to_last_merge=0.9715 (last merge round=44)
[S5] round=93 local utility u=0.348626 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9994925612026028, 'loss_val': 0.020277025052329874, 'psi': 0.9980816416818161}-{'f1_val': 0.902081370464707, 'auprc': 0.9950180622616424, 'loss_val': 0.13374692747958297, 'psi': 0.9392560471834812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=93 head_norm_before_train=1.812878 cos_to_last_merge=0.9362 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=93 local utility u=0.780843 metrics={'f1_val': 0.6240726394798842, 'auprc': 0.9187623891353895, 'loss_val': 0.8198801130307557, 'psi': 0.7419485393420864}-{'f1_val': 0.5305462199487568, 'auprc': 0.7313012354943578, 'loss_val': 1.258024696284791, 'psi': 0.6108482261669972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=93 head_norm_before_train=1.944635 cos_to_last_merge=0.9353 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.6644302556304431, 'auprc': 0.9523721201005941, 'loss_val': 1.0543176082521994, 'psi': 0.7796070014185035}-{'f1_val': 0.6740141113296014, 'auprc': 0.9366186951693749, 'loss_val': 0.986707933031217, 'psi': 0.7790559448655108}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=1.943696 cos_to_last_merge=0.9854 (last merge round=44)
[S8] round=93 local utility u=0.395728 metrics={'f1_val': 0.9925913229537972, 'auprc': 0.9872431420610183, 'loss_val': 0.03744537407318488, 'psi': 0.9904520505966856}-{'f1_val': 0.8898659498504109, 'auprc': 0.9970532996968252, 'loss_val': 0.24197915519967636, 'psi': 0.9327408897889766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=93 head_norm_before_train=2.417735 (no previous merge yet)
[S9] round=93 local utility u=0.025532 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999289583166958, 'loss_val': 0.016812698171068886, 'psi': 0.9979678904150132}-{'f1_val': 0.9907913321404518, 'auprc': 0.9999242190382032, 'loss_val': 0.03264754582956933, 'psi': 0.9944444868995523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=93 head_norm_before_train=2.517469 cos_to_last_merge=0.9935 (last merge round=43)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9978264418836827, 'loss_val': 0.024395690256281088, 'psi': 0.996243280165098}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978604065115475, 'loss_val': 0.0244370253386769, 'psi': 0.9962568660162439}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.431489 cos_to_last_merge=0.9975 (last merge round=43)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.8911552190433835, 'auprc': 0.9872301921677853, 'loss_val': 0.6363428414067096, 'psi': 0.9295852082931442}-{'f1_val': 0.9963090846170353, 'auprc': 0.9978397762543826, 'loss_val': 0.019466644976933404, 'psi': 0.9969213612719743}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=2.270252 cos_to_last_merge=0.9871 (last merge round=37)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.713594377398427, 'auprc': 0.6985073886383258, 'loss_val': 1.06643129597071, 'psi': 0.7075595818943865}-{'f1_val': 0.7518688903621549, 'auprc': 0.7324588322959859, 'loss_val': 1.0179105997503417, 'psi': 0.7441048671356872}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.297765 cos_to_last_merge=0.9937 (last merge round=43)
[S14] round=93 local utility u=0.040567 metrics={'f1_val': 0.9710855403330124, 'auprc': 0.9992319982434266, 'loss_val': 0.05013675645560604, 'psi': 0.9823441234971781}-{'f1_val': 0.9591655205481913, 'auprc': 0.9992319982434266, 'loss_val': 0.05975117997231971, 'psi': 0.9751921116262854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=93 head_norm_before_train=2.425191 (no previous merge yet)
[S15] round=93 local utility u=0.000011 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980371737510686, 'loss_val': 0.017508731506323864, 'psi': 0.9972628705329398}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980225116766833, 'loss_val': 0.01748659559174364, 'psi': 0.9972570057031857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=93 head_norm_before_train=1.915564 cos_to_last_merge=0.9897 (last merge round=44)
[S16] round=93 local utility u=0.000769 metrics={'f1_val': 0.9912919143280989, 'auprc': 0.9948974422666319, 'loss_val': 0.036949655643794994, 'psi': 0.992734125503512}-{'f1_val': 0.9915793213105296, 'auprc': 0.9937905127570673, 'loss_val': 0.03689208010679869, 'psi': 0.9924637978891446}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=93 head_norm_before_train=2.324137 cos_to_last_merge=0.9910 (last merge round=43)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.7049244890929713, 'auprc': 0.9692410548940734, 'loss_val': 0.8880122783203553, 'psi': 0.8106511154134122}-{'f1_val': 0.8239859674813645, 'auprc': 0.9908737331174495, 'loss_val': 0.561946094797951, 'psi': 0.8907410737357986}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.065818 cos_to_last_merge=0.9923 (last merge round=43)
[S2] round=94 local utility u=0.513366 metrics={'f1_val': 0.8250014396181724, 'auprc': 0.8624753150104325, 'loss_val': 0.43439003163713474, 'psi': 0.8399909897750764}-{'f1_val': 0.6948341797296465, 'auprc': 0.8271990033626829, 'loss_val': 0.5742895895431107, 'psi': 0.7477801091828611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=94 head_norm_before_train=2.098282 cos_to_last_merge=0.9664 (last merge round=44)
[S3] round=94 local utility u=0.250106 metrics={'f1_val': 0.9613238019923649, 'auprc': 0.9978029165461781, 'loss_val': 0.0941510624290751, 'psi': 0.9759154478138902}-{'f1_val': 0.9206761670993153, 'auprc': 0.9601257130797001, 'loss_val': 0.23744525309567388, 'psi': 0.9364559854914691}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=94 head_norm_before_train=1.834780 cos_to_last_merge=0.9589 (last merge round=37)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9440395649831085, 'auprc': 0.9318740986018564, 'loss_val': 0.30719656480661756, 'psi': 0.9391733784306077}-{'f1_val': 0.9465349821948587, 'auprc': 0.9601726277923199, 'loss_val': 0.3024136068715088, 'psi': 0.9519900404338432}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=2.144520 cos_to_last_merge=0.9709 (last merge round=44)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9992575353667056, 'loss_val': 0.018961320926838457, 'psi': 0.9977241952337568}-{'f1_val': 0.9971410286679584, 'auprc': 0.9994925612026028, 'loss_val': 0.020277025052329874, 'psi': 0.9980816416818161}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=1.817060 cos_to_last_merge=0.9356 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=94 local utility u=1.000000 metrics={'f1_val': 0.866666126165949, 'auprc': 0.9477807725214493, 'loss_val': 0.34364530668519283, 'psi': 0.8991119847081491}-{'f1_val': 0.6240726394798842, 'auprc': 0.9187623891353895, 'loss_val': 0.8198801130307557, 'psi': 0.7419485393420864}
[S6] not sending this round → trigger blocked (psi=0.899)
[S7] START round=94 head_norm_before_train=1.963203 cos_to_last_merge=0.9332 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=94 local utility u=0.125813 metrics={'f1_val': 0.6999576846203596, 'auprc': 0.9554439005335151, 'loss_val': 1.0250723048157022, 'psi': 0.8021521709856219}-{'f1_val': 0.6644302556304431, 'auprc': 0.9523721201005941, 'loss_val': 1.0543176082521994, 'psi': 0.7796070014185035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=94 head_norm_before_train=1.947575 cos_to_last_merge=0.9852 (last merge round=44)
[S8] round=94 local utility u=0.017480 metrics={'f1_val': 0.9921080114009074, 'auprc': 0.9993332108760643, 'loss_val': 0.03585662310200797, 'psi': 0.9949980911909702}-{'f1_val': 0.9925913229537972, 'auprc': 0.9872431420610183, 'loss_val': 0.03744537407318488, 'psi': 0.9904520505966856}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=94 head_norm_before_train=2.421043 (no previous merge yet)
[S9] round=94 local utility u=0.001532 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999229121291195, 'loss_val': 0.016196388064570168, 'psi': 0.9982120127732679}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999289583166958, 'loss_val': 0.016812698171068886, 'psi': 0.9979678904150132}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=94 head_norm_before_train=2.520232 cos_to_last_merge=0.9933 (last merge round=43)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997692065282845, 'loss_val': 0.024534468102840816, 'psi': 0.9961895295247629}-{'f1_val': 0.9951878390193748, 'auprc': 0.9978264418836827, 'loss_val': 0.024395690256281088, 'psi': 0.996243280165098}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.432259 cos_to_last_merge=0.9974 (last merge round=43)
[S11] round=94 local utility u=0.640675 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9981916360008634, 'loss_val': 0.01892320948109588, 'psi': 0.9970743006969596}-{'f1_val': 0.8911552190433835, 'auprc': 0.9872301921677853, 'loss_val': 0.6363428414067096, 'psi': 0.9295852082931442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=94 head_norm_before_train=2.276534 cos_to_last_merge=0.9867 (last merge round=37)
[S13] round=94 local utility u=0.048774 metrics={'f1_val': 0.744392589826464, 'auprc': 0.7064718743249142, 'loss_val': 1.1775659689507394, 'psi': 0.729224303625844}-{'f1_val': 0.713594377398427, 'auprc': 0.6985073886383258, 'loss_val': 1.06643129597071, 'psi': 0.7075595818943865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=94 head_norm_before_train=2.301106 cos_to_last_merge=0.9936 (last merge round=43)
[S14] round=94 local utility u=0.095488 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.999229568214339, 'loss_val': 0.016975088433489625, 'psi': 0.9981253024114739}-{'f1_val': 0.9710855403330124, 'auprc': 0.9992319982434266, 'loss_val': 0.05013675645560604, 'psi': 0.9823441234971781}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=94 head_norm_before_train=2.428993 (no previous merge yet)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980465313805854, 'loss_val': 0.017643054927648897, 'psi': 0.9972666135847466}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980371737510686, 'loss_val': 0.017508731506323864, 'psi': 0.9972628705329398}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.919231 cos_to_last_merge=0.9895 (last merge round=44)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9922981514819476, 'auprc': 0.9841958350569979, 'loss_val': 0.03804684469906144, 'psi': 0.9890572249119677}-{'f1_val': 0.9912919143280989, 'auprc': 0.9948974422666319, 'loss_val': 0.036949655643794994, 'psi': 0.992734125503512}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.330398 cos_to_last_merge=0.9908 (last merge round=43)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.5985375359867624, 'auprc': 0.9145555699942881, 'loss_val': 1.3446521614933473, 'psi': 0.7249447495897727}-{'f1_val': 0.7049244890929713, 'auprc': 0.9692410548940734, 'loss_val': 0.8880122783203553, 'psi': 0.8106511154134122}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.069375 cos_to_last_merge=0.9922 (last merge round=43)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7092149219425574, 'auprc': 0.8653075807989088, 'loss_val': 0.5856875913797346, 'psi': 0.7716519854850981}-{'f1_val': 0.8250014396181724, 'auprc': 0.8624753150104325, 'loss_val': 0.43439003163713474, 'psi': 0.8399909897750764}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.104999 cos_to_last_merge=0.9659 (last merge round=44)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.7948193149629711, 'auprc': 0.9723959609123487, 'loss_val': 0.5160273712963201, 'psi': 0.8658499733427221}-{'f1_val': 0.9613238019923649, 'auprc': 0.9978029165461781, 'loss_val': 0.0941510624290751, 'psi': 0.9759154478138902}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=1.837032 cos_to_last_merge=0.9586 (last merge round=37)
[S4] round=95 local utility u=0.010339 metrics={'f1_val': 0.9466276250117688, 'auprc': 0.9331349786367323, 'loss_val': 0.30582967005765904, 'psi': 0.9412305664617542}-{'f1_val': 0.9440395649831085, 'auprc': 0.9318740986018564, 'loss_val': 0.30719656480661756, 'psi': 0.9391733784306077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=95 head_norm_before_train=2.148886 cos_to_last_merge=0.9704 (last merge round=44)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9399002210679339, 'auprc': 0.9926107897775601, 'loss_val': 0.09959202052191511, 'psi': 0.9609844485517844}-{'f1_val': 0.9967019684784577, 'auprc': 0.9992575353667056, 'loss_val': 0.018961320926838457, 'psi': 0.9977241952337568}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.822525 cos_to_last_merge=0.9350 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6425531984840178, 'auprc': 0.891886716992749, 'loss_val': 0.7826372042787589, 'psi': 0.7422866058875104}-{'f1_val': 0.866666126165949, 'auprc': 0.9477807725214493, 'loss_val': 0.34364530668519283, 'psi': 0.8991119847081491}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.976786 cos_to_last_merge=0.9318 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=95 local utility u=0.916879 metrics={'f1_val': 0.8748464144370895, 'auprc': 0.9731913141370889, 'loss_val': 0.2938884128230203, 'psi': 0.9141843743170893}-{'f1_val': 0.6999576846203596, 'auprc': 0.9554439005335151, 'loss_val': 1.0250723048157022, 'psi': 0.8021521709856219}
[S7] not sending this round → trigger blocked (psi=0.914)
[S8] START round=95 head_norm_before_train=1.950975 cos_to_last_merge=0.9850 (last merge round=44)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.8225046058219343, 'auprc': 0.9961733812147223, 'loss_val': 0.4935923008086616, 'psi': 0.8919721159790495}-{'f1_val': 0.9921080114009074, 'auprc': 0.9993332108760643, 'loss_val': 0.03585662310200797, 'psi': 0.9949980911909702}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.420957 (no previous merge yet)
[S9] round=95 local utility u=0.002169 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998596928604271, 'loss_val': 0.014323249678993524, 'psi': 0.9984521675982174}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999229121291195, 'loss_val': 0.016196388064570168, 'psi': 0.9982120127732679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=95 head_norm_before_train=2.521803 cos_to_last_merge=0.9932 (last merge round=43)
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976514099298155, 'loss_val': 0.024436645356352805, 'psi': 0.996173267383551}-{'f1_val': 0.9951878390193748, 'auprc': 0.997692065282845, 'loss_val': 0.024534468102840816, 'psi': 0.9961895295247629}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=2.433466 cos_to_last_merge=0.9973 (last merge round=43)
[S11] round=95 local utility u=0.003578 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9994250238382014, 'loss_val': 0.01691750464938896, 'psi': 0.9977127584025554}-{'f1_val': 0.9963294104943571, 'auprc': 0.9981916360008634, 'loss_val': 0.01892320948109588, 'psi': 0.9970743006969596}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=95 head_norm_before_train=2.283630 cos_to_last_merge=0.9863 (last merge round=37)
[S13] round=95 local utility u=0.098361 metrics={'f1_val': 0.7427933513406929, 'auprc': 0.7440473798105536, 'loss_val': 1.0839748879302782, 'psi': 0.7432949627286372}-{'f1_val': 0.744392589826464, 'auprc': 0.7064718743249142, 'loss_val': 1.1775659689507394, 'psi': 0.729224303625844}
[S13] not sending this round → trigger blocked (psi=0.743)
[S14] START round=95 head_norm_before_train=2.301688 cos_to_last_merge=0.9935 (last merge round=43)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9991071194412744, 'loss_val': 0.019880551854377992, 'psi': 0.9976979472601188}-{'f1_val': 0.9973891252095638, 'auprc': 0.999229568214339, 'loss_val': 0.016975088433489625, 'psi': 0.9981253024114739}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.432711 (no previous merge yet)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979825484158154, 'loss_val': 0.017688882223620944, 'psi': 0.9972410203988384}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980465313805854, 'loss_val': 0.017643054927648897, 'psi': 0.9972666135847466}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=1.922651 cos_to_last_merge=0.9893 (last merge round=44)
[S16] round=95 local utility u=0.016331 metrics={'f1_val': 0.9929231374444487, 'auprc': 0.9923817447838149, 'loss_val': 0.03369224929000491, 'psi': 0.9927065803801951}-{'f1_val': 0.9922981514819476, 'auprc': 0.9841958350569979, 'loss_val': 0.03804684469906144, 'psi': 0.9890572249119677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=95 head_norm_before_train=2.336691 cos_to_last_merge=0.9906 (last merge round=43)
[S17] round=95 local utility u=0.917438 metrics={'f1_val': 0.786715005800986, 'auprc': 0.9743631732977924, 'loss_val': 0.818264750039653, 'psi': 0.8617742727997086}-{'f1_val': 0.5985375359867624, 'auprc': 0.9145555699942881, 'loss_val': 1.3446521614933473, 'psi': 0.7249447495897727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=96 head_norm_before_train=2.074819 cos_to_last_merge=0.9921 (last merge round=43)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.6824024083816456, 'auprc': 0.8171341975447726, 'loss_val': 0.6727501968204787, 'psi': 0.7362951240468965}-{'f1_val': 0.7092149219425574, 'auprc': 0.8653075807989088, 'loss_val': 0.5856875913797346, 'psi': 0.7716519854850981}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.109359 cos_to_last_merge=0.9656 (last merge round=44)
[S3] round=96 local utility u=0.413893 metrics={'f1_val': 0.87937214940574, 'auprc': 0.9929658094218321, 'loss_val': 0.25726748685460865, 'psi': 0.9248096134121768}-{'f1_val': 0.7948193149629711, 'auprc': 0.9723959609123487, 'loss_val': 0.5160273712963201, 'psi': 0.8658499733427221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=96 head_norm_before_train=1.840000 cos_to_last_merge=0.9585 (last merge round=37)
[S4] round=96 local utility u=0.049204 metrics={'f1_val': 0.9483521062220472, 'auprc': 0.9608069490960505, 'loss_val': 0.3007839738661283, 'psi': 0.9533340433716485}-{'f1_val': 0.9466276250117688, 'auprc': 0.9331349786367323, 'loss_val': 0.30582967005765904, 'psi': 0.9412305664617542}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=96 head_norm_before_train=2.151048 cos_to_last_merge=0.9701 (last merge round=44)
[S5] round=96 local utility u=0.219984 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994348930356151, 'loss_val': 0.020905990453244597, 'psi': 0.9977951383013206}-{'f1_val': 0.9399002210679339, 'auprc': 0.9926107897775601, 'loss_val': 0.09959202052191511, 'psi': 0.9609844485517844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=96 head_norm_before_train=1.826897 cos_to_last_merge=0.9345 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=96 local utility u=0.506150 metrics={'f1_val': 0.7520148378210766, 'auprc': 0.9552909566566847, 'loss_val': 0.6173204563341862, 'psi': 0.8333252853553198}-{'f1_val': 0.6425531984840178, 'auprc': 0.891886716992749, 'loss_val': 0.7826372042787589, 'psi': 0.7422866058875104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=96 head_norm_before_train=1.984644 cos_to_last_merge=0.9309 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.7821219070721755, 'auprc': 0.9367067583658447, 'loss_val': 0.9710613299806055, 'psi': 0.8439558475896431}-{'f1_val': 0.8748464144370895, 'auprc': 0.9731913141370889, 'loss_val': 0.2938884128230203, 'psi': 0.9141843743170893}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=1.953468 cos_to_last_merge=0.9848 (last merge round=44)
[S8] round=96 local utility u=0.745339 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.9978460830881305, 'loss_val': 0.03257044434101852, 'psi': 0.9951049669629701}-{'f1_val': 0.8225046058219343, 'auprc': 0.9961733812147223, 'loss_val': 0.4935923008086616, 'psi': 0.8919721159790495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=96 head_norm_before_train=2.425075 (no previous merge yet)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9997950417769379, 'loss_val': 0.013812494816276553, 'psi': 0.9981797642180609}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998596928604271, 'loss_val': 0.014323249678993524, 'psi': 0.9984521675982174}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.522003 cos_to_last_merge=0.9931 (last merge round=43)
[S10] round=96 local utility u=0.000098 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976565398914407, 'loss_val': 0.024255751000083235, 'psi': 0.996175319368201}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976514099298155, 'loss_val': 0.024436645356352805, 'psi': 0.996173267383551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=96 head_norm_before_train=2.435660 cos_to_last_merge=0.9973 (last merge round=43)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.999382981108107, 'loss_val': 0.017394175192769798, 'psi': 0.9976959413105175}-{'f1_val': 0.9965712481121245, 'auprc': 0.9994250238382014, 'loss_val': 0.01691750464938896, 'psi': 0.9977127584025554}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.289654 cos_to_last_merge=0.9859 (last merge round=37)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6600864317864933, 'auprc': 0.6453132337517173, 'loss_val': 1.3901739930863557, 'psi': 0.6541771525725829}-{'f1_val': 0.7427933513406929, 'auprc': 0.7440473798105536, 'loss_val': 1.0839748879302782, 'psi': 0.7432949627286372}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.304625 cos_to_last_merge=0.9934 (last merge round=43)
[S14] round=96 local utility u=0.000034 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9988467617250156, 'loss_val': 0.020354018688006043, 'psi': 0.9977260110511289}-{'f1_val': 0.9967584991393483, 'auprc': 0.9991071194412744, 'loss_val': 0.019880551854377992, 'psi': 0.9976979472601188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=96 head_norm_before_train=2.436402 (no previous merge yet)
[S15] round=96 local utility u=0.000015 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979901845806565, 'loss_val': 0.017682357603595624, 'psi': 0.997244074864775}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979825484158154, 'loss_val': 0.017688882223620944, 'psi': 0.9972410203988384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=96 head_norm_before_train=1.925210 cos_to_last_merge=0.9890 (last merge round=44)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9929231374444487, 'auprc': 0.9924744251773344, 'loss_val': 0.03412955282695545, 'psi': 0.992743652537603}-{'f1_val': 0.9929231374444487, 'auprc': 0.9923817447838149, 'loss_val': 0.03369224929000491, 'psi': 0.9927065803801951}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.340740 cos_to_last_merge=0.9905 (last merge round=43)
[S17] round=96 local utility u=0.398563 metrics={'f1_val': 0.874585497426745, 'auprc': 0.9789741428133396, 'loss_val': 0.5621951296442671, 'psi': 0.9163409555813828}-{'f1_val': 0.786715005800986, 'auprc': 0.9743631732977924, 'loss_val': 0.818264750039653, 'psi': 0.8617742727997086}
[S17] not sending this round → trigger blocked (psi=0.916)
[S2] START round=97 head_norm_before_train=2.079954 cos_to_last_merge=0.9919 (last merge round=43)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7000555971708763, 'auprc': 0.7300133517137253, 'loss_val': 0.9403577128123968, 'psi': 0.7120386989880159}-{'f1_val': 0.6824024083816456, 'auprc': 0.8171341975447726, 'loss_val': 0.6727501968204787, 'psi': 0.7362951240468965}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.114696 cos_to_last_merge=0.9653 (last merge round=44)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.8582993061837176, 'auprc': 0.9653857478975078, 'loss_val': 0.38997293640791914, 'psi': 0.9011338828692337}-{'f1_val': 0.87937214940574, 'auprc': 0.9929658094218321, 'loss_val': 0.25726748685460865, 'psi': 0.9248096134121768}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.844576 cos_to_last_merge=0.9581 (last merge round=37)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9478693606538124, 'auprc': 0.9621037945030713, 'loss_val': 0.30499890591720535, 'psi': 0.953563134193516}-{'f1_val': 0.9483521062220472, 'auprc': 0.9608069490960505, 'loss_val': 0.3007839738661283, 'psi': 0.9533340433716485}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.154769 cos_to_last_merge=0.9697 (last merge round=44)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.998587715575577, 'loss_val': 0.02291173988301373, 'psi': 0.9974988070113127}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994348930356151, 'loss_val': 0.020905990453244597, 'psi': 0.9977951383013206}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.833092 cos_to_last_merge=0.9338 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6479323074639299, 'auprc': 0.9488671712967222, 'loss_val': 0.8401121556056586, 'psi': 0.7683062529970468}-{'f1_val': 0.7520148378210766, 'auprc': 0.9552909566566847, 'loss_val': 0.6173204563341862, 'psi': 0.8333252853553198}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.992666 cos_to_last_merge=0.9300 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.5401817386361398, 'auprc': 0.7489921995266433, 'loss_val': 1.590528538050126, 'psi': 0.6237059229923412}-{'f1_val': 0.7821219070721755, 'auprc': 0.9367067583658447, 'loss_val': 0.9710613299806055, 'psi': 0.8439558475896431}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=1.957023 cos_to_last_merge=0.9846 (last merge round=44)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9777620017838513, 'auprc': 0.997408051654016, 'loss_val': 0.06548129176693185, 'psi': 0.9856204217319171}-{'f1_val': 0.9932775562128633, 'auprc': 0.9978460830881305, 'loss_val': 0.03257044434101852, 'psi': 0.9951049669629701}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.432095 (no previous merge yet)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999932143878937, 'loss_val': 0.014792302554798478, 'psi': 0.9982346050588605}-{'f1_val': 0.9971029125121428, 'auprc': 0.9997950417769379, 'loss_val': 0.013812494816276553, 'psi': 0.9981797642180609}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.523861 cos_to_last_merge=0.9930 (last merge round=43)
[S10] round=97 local utility u=0.000079 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976898284907595, 'loss_val': 0.024197216504228493, 'psi': 0.9961886348079286}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976565398914407, 'loss_val': 0.024255751000083235, 'psi': 0.996175319368201}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=97 head_norm_before_train=2.437971 cos_to_last_merge=0.9973 (last merge round=43)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9993536869143768, 'loss_val': 0.017736661641845678, 'psi': 0.9976842236330254}-{'f1_val': 0.9965712481121245, 'auprc': 0.999382981108107, 'loss_val': 0.017394175192769798, 'psi': 0.9976959413105175}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.293071 cos_to_last_merge=0.9858 (last merge round=37)
[S13] round=97 local utility u=0.555604 metrics={'f1_val': 0.7238670749204116, 'auprc': 0.7893763644116347, 'loss_val': 1.0938382579362989, 'psi': 0.7500707907169009}-{'f1_val': 0.6600864317864933, 'auprc': 0.6453132337517173, 'loss_val': 1.3901739930863557, 'psi': 0.6541771525725829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=97 head_norm_before_train=2.301957 cos_to_last_merge=0.9932 (last merge round=43)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9987321337164756, 'loss_val': 0.021200693701517538, 'psi': 0.9976801598477129}-{'f1_val': 0.9969788439352044, 'auprc': 0.9988467617250156, 'loss_val': 0.020354018688006043, 'psi': 0.9977260110511289}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.440072 (no previous merge yet)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980471948762337, 'loss_val': 0.017994295486152695, 'psi': 0.9972668789830058}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979901845806565, 'loss_val': 0.017682357603595624, 'psi': 0.997244074864775}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=1.928474 cos_to_last_merge=0.9888 (last merge round=44)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9918812734926371, 'auprc': 0.9889069731962499, 'loss_val': 0.03708630267387976, 'psi': 0.9906915533740822}-{'f1_val': 0.9929231374444487, 'auprc': 0.9924744251773344, 'loss_val': 0.03412955282695545, 'psi': 0.992743652537603}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.343710 cos_to_last_merge=0.9904 (last merge round=43)
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.7090081048281127, 'auprc': 0.9590385521659459, 'loss_val': 1.0313352368077993, 'psi': 0.8090202837632461}-{'f1_val': 0.874585497426745, 'auprc': 0.9789741428133396, 'loss_val': 0.5621951296442671, 'psi': 0.9163409555813828}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.085266 cos_to_last_merge=0.9918 (last merge round=43)
[S2] round=98 local utility u=0.355124 metrics={'f1_val': 0.70319446953561, 'auprc': 0.8637296222682048, 'loss_val': 0.6500910177017729, 'psi': 0.767408530628648}-{'f1_val': 0.7000555971708763, 'auprc': 0.7300133517137253, 'loss_val': 0.9403577128123968, 'psi': 0.7120386989880159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=98 head_norm_before_train=2.120497 cos_to_last_merge=0.9649 (last merge round=44)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.6994408346492148, 'auprc': 0.947003309015424, 'loss_val': 0.8567175529840796, 'psi': 0.7984658243956985}-{'f1_val': 0.8582993061837176, 'auprc': 0.9653857478975078, 'loss_val': 0.38997293640791914, 'psi': 0.9011338828692337}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=1.847277 cos_to_last_merge=0.9576 (last merge round=37)
[S4] round=98 local utility u=0.019164 metrics={'f1_val': 0.9499690206177585, 'auprc': 0.9695728449575112, 'loss_val': 0.3016752009798656, 'psi': 0.9578105503536596}-{'f1_val': 0.9478693606538124, 'auprc': 0.9621037945030713, 'loss_val': 0.30499890591720535, 'psi': 0.953563134193516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=98 head_norm_before_train=2.158413 cos_to_last_merge=0.9693 (last merge round=44)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9969244957159844, 'loss_val': 0.019003167891862103, 'psi': 0.9967909793734684}-{'f1_val': 0.9967728679684698, 'auprc': 0.998587715575577, 'loss_val': 0.02291173988301373, 'psi': 0.9974988070113127}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=1.839265 cos_to_last_merge=0.9331 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=98 local utility u=0.131367 metrics={'f1_val': 0.6675641082031193, 'auprc': 0.9290607840187144, 'loss_val': 0.6357499085142208, 'psi': 0.7721627785293573}-{'f1_val': 0.6479323074639299, 'auprc': 0.9488671712967222, 'loss_val': 0.8401121556056586, 'psi': 0.7683062529970468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=98 head_norm_before_train=2.005357 cos_to_last_merge=0.9290 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=98 local utility u=1.000000 metrics={'f1_val': 0.7290852578640907, 'auprc': 0.9403223642881359, 'loss_val': 1.116559912235783, 'psi': 0.8135801004337088}-{'f1_val': 0.5401817386361398, 'auprc': 0.7489921995266433, 'loss_val': 1.590528538050126, 'psi': 0.6237059229923412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1813 reason=None
[S7] sending update (kind=head size=1813 to 1 peers)
[S8] START round=98 head_norm_before_train=1.961033 cos_to_last_merge=0.9844 (last merge round=44)
[S8] round=98 local utility u=0.028595 metrics={'f1_val': 0.9839737891748364, 'auprc': 0.9994000710915152, 'loss_val': 0.05153887320806289, 'psi': 0.9901443019415078}-{'f1_val': 0.9777620017838513, 'auprc': 0.997408051654016, 'loss_val': 0.06548129176693185, 'psi': 0.9856204217319171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=98 head_norm_before_train=2.431609 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9999331694639187, 'loss_val': 0.03469198445486894, 'psi': 0.9939592330259803}-{'f1_val': 0.9971029125121428, 'auprc': 0.999932143878937, 'loss_val': 0.014792302554798478, 'psi': 0.9982346050588605}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.526922 cos_to_last_merge=0.9929 (last merge round=43)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9976370269252514, 'loss_val': 0.024398283783497548, 'psi': 0.9961675141817254}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976898284907595, 'loss_val': 0.024197216504228493, 'psi': 0.9961886348079286}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.440636 cos_to_last_merge=0.9973 (last merge round=43)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9961101567972493, 'auprc': 0.9993572944729617, 'loss_val': 0.018964730060018566, 'psi': 0.9974090118675343}-{'f1_val': 0.9965712481121245, 'auprc': 0.9993536869143768, 'loss_val': 0.017736661641845678, 'psi': 0.9976842236330254}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.294946 cos_to_last_merge=0.9856 (last merge round=37)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.593308664924204, 'auprc': 0.6255818042527789, 'loss_val': 1.5149192394962983, 'psi': 0.606217920655634}-{'f1_val': 0.7238670749204116, 'auprc': 0.7893763644116347, 'loss_val': 1.0938382579362989, 'psi': 0.7500707907169009}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.301808 cos_to_last_merge=0.9930 (last merge round=43)
[S14] round=98 local utility u=0.003251 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988537617351506, 'loss_val': 0.01998960387658235, 'psi': 0.9982214389599277}-{'f1_val': 0.9969788439352044, 'auprc': 0.9987321337164756, 'loss_val': 0.021200693701517538, 'psi': 0.9976801598477129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=98 head_norm_before_train=2.443624 (no previous merge yet)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.99810407154322, 'loss_val': 0.018193225363905302, 'psi': 0.9972896296498004}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980471948762337, 'loss_val': 0.017994295486152695, 'psi': 0.9972668789830058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=1.932596 cos_to_last_merge=0.9887 (last merge round=44)
[S16] round=98 local utility u=0.009528 metrics={'f1_val': 0.9929231374444487, 'auprc': 0.992443440760898, 'loss_val': 0.03489014937677051, 'psi': 0.9927312587710284}-{'f1_val': 0.9918812734926371, 'auprc': 0.9889069731962499, 'loss_val': 0.03708630267387976, 'psi': 0.9906915533740822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=98 head_norm_before_train=2.346216 cos_to_last_merge=0.9903 (last merge round=43)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.6642424324394768, 'auprc': 0.9549499239785888, 'loss_val': 1.159566251244891, 'psi': 0.7805254290551216}-{'f1_val': 0.7090081048281127, 'auprc': 0.9590385521659459, 'loss_val': 1.0313352368077993, 'psi': 0.8090202837632461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.089791 cos_to_last_merge=0.9917 (last merge round=43)
[S2] round=99 local utility u=0.056015 metrics={'f1_val': 0.7075215789725932, 'auprc': 0.8664055537867058, 'loss_val': 0.5720520304349523, 'psi': 0.7710751688982382}-{'f1_val': 0.70319446953561, 'auprc': 0.8637296222682048, 'loss_val': 0.6500910177017729, 'psi': 0.767408530628648}
[S2] not sending this round → trigger blocked (psi=0.771)
[S2] r=100 psi=0.771 u=0.0560 p_local=0.1274 f1=0.708 auprc=0.866 bytes=73953
[S3] START round=99 head_norm_before_train=2.126776 cos_to_last_merge=0.9645 (last merge round=44)
[S3] round=99 local utility u=0.372119 metrics={'f1_val': 0.7524353477086669, 'auprc': 0.9899459490226116, 'loss_val': 0.5592747552085465, 'psi': 0.8474395882342447}-{'f1_val': 0.6994408346492148, 'auprc': 0.947003309015424, 'loss_val': 0.8567175529840796, 'psi': 0.7984658243956985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=100 psi=0.847 u=0.3721 p_local=0.1693 f1=0.752 auprc=0.990 bytes=75532
[S4] START round=99 head_norm_before_train=1.850234 cos_to_last_merge=0.9571 (last merge round=37)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9510989689351391, 'auprc': 0.9489681368271907, 'loss_val': 0.30708557346564236, 'psi': 0.9502466360919597}-{'f1_val': 0.9499690206177585, 'auprc': 0.9695728449575112, 'loss_val': 0.3016752009798656, 'psi': 0.9578105503536596}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.950 u=0.0000 p_local=0.0150 f1=0.951 auprc=0.949 bytes=75530
[S5] START round=99 head_norm_before_train=2.164098 cos_to_last_merge=0.9689 (last merge round=44)
[S5] round=99 local utility u=0.002491 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984971556223459, 'loss_val': 0.018738802180750313, 'psi': 0.997420043336013}-{'f1_val': 0.9967019684784577, 'auprc': 0.9969244957159844, 'loss_val': 0.019003167891862103, 'psi': 0.9967909793734684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S5] r=100 psi=0.997 u=0.0025 p_local=0.0520 f1=0.997 auprc=0.998 bytes=72050
[S6] START round=99 head_norm_before_train=1.843787 cos_to_last_merge=0.9328 (last merge round=45)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=99 local utility u=0.002869 metrics={'f1_val': 0.6732528688150282, 'auprc': 0.9298388277555845, 'loss_val': 0.6664793473683773, 'psi': 0.7758872523912508}-{'f1_val': 0.6675641082031193, 'auprc': 0.9290607840187144, 'loss_val': 0.6357499085142208, 'psi': 0.7721627785293573}
[S6] not sending this round → trigger blocked (psi=0.776)
[S6] r=100 psi=0.776 u=0.0029 p_local=0.2325 f1=0.673 auprc=0.930 bytes=73779
[S7] START round=99 head_norm_before_train=2.014357 cos_to_last_merge=0.9281 (last merge round=40)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=99 local utility u=0.113530 metrics={'f1_val': 0.7525791560300806, 'auprc': 0.9493251506073476, 'loss_val': 1.057472627471349, 'psi': 0.8312775538609873}-{'f1_val': 0.7290852578640907, 'auprc': 0.9403223642881359, 'loss_val': 1.116559912235783, 'psi': 0.8135801004337088}
[S7] not sending this round → trigger blocked (psi=0.831)
[S7] r=100 psi=0.831 u=0.1135 p_local=0.3373 f1=0.753 auprc=0.949 bytes=68471
[S8] START round=99 head_norm_before_train=1.965622 cos_to_last_merge=0.9841 (last merge round=44)
[S8] round=99 local utility u=0.036426 metrics={'f1_val': 0.9940203979744721, 'auprc': 0.9966579666277612, 'loss_val': 0.030740869395146475, 'psi': 0.9950754254357876}-{'f1_val': 0.9839737891748364, 'auprc': 0.9994000710915152, 'loss_val': 0.05153887320806289, 'psi': 0.9901443019415078}
[S8] not sending this round → trigger blocked (psi=0.995)
[S8] r=100 psi=0.995 u=0.0364 p_local=0.1254 f1=0.994 auprc=0.997 bytes=79205
[S9] START round=99 head_norm_before_train=2.430329 (no previous merge yet)
[S9] round=99 local utility u=0.031069 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999335739338543, 'loss_val': 0.015313243037603974, 'psi': 0.9982351770808274}-{'f1_val': 0.9899766087340214, 'auprc': 0.9999331694639187, 'loss_val': 0.03469198445486894, 'psi': 0.9939592330259803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S9] r=100 psi=0.998 u=0.0311 p_local=0.0089 f1=0.997 auprc=1.000 bytes=80751
[S10] START round=99 head_norm_before_train=2.530590 cos_to_last_merge=0.9927 (last merge round=43)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9974546793417182, 'loss_val': 0.024725371147421255, 'psi': 0.9960945751483121}-{'f1_val': 0.9951878390193748, 'auprc': 0.9976370269252514, 'loss_val': 0.024398283783497548, 'psi': 0.9961675141817254}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.997 bytes=70147
[S11] START round=99 head_norm_before_train=2.443910 cos_to_last_merge=0.9973 (last merge round=43)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9823351476257097, 'auprc': 0.9973045026870886, 'loss_val': 0.09186214928080326, 'psi': 0.9883228896502613}-{'f1_val': 0.9961101567972493, 'auprc': 0.9993572944729617, 'loss_val': 0.018964730060018566, 'psi': 0.9974090118675343}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.988 u=0.0000 p_local=0.0447 f1=0.982 auprc=0.997 bytes=73743
[S13] START round=99 head_norm_before_train=2.295451 cos_to_last_merge=0.9855 (last merge round=37)
[S13] round=99 local utility u=0.921746 metrics={'f1_val': 0.7549330048733194, 'auprc': 0.7562505203038448, 'loss_val': 1.0331794955187317, 'psi': 0.7554600110455296}-{'f1_val': 0.593308664924204, 'auprc': 0.6255818042527789, 'loss_val': 1.5149192394962983, 'psi': 0.606217920655634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=100 psi=0.755 u=0.9217 p_local=0.2864 f1=0.755 auprc=0.756 bytes=75506
[S14] START round=99 head_norm_before_train=2.304718 cos_to_last_merge=0.9929 (last merge round=43)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9988869040648745, 'loss_val': 0.018085928540953623, 'psi': 0.9979882367516881}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988537617351506, 'loss_val': 0.01998960387658235, 'psi': 0.9982214389599277}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0095 f1=0.997 auprc=0.999 bytes=80828
[S15] START round=99 head_norm_before_train=2.447125 (no previous merge yet)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981233131791509, 'loss_val': 0.018653951533644842, 'psi': 0.9972973263041727}-{'f1_val': 0.9967466683875206, 'auprc': 0.99810407154322, 'loss_val': 0.018193225363905302, 'psi': 0.9972896296498004}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.997 u=0.0000 p_local=0.0059 f1=0.997 auprc=0.998 bytes=64768
[S16] START round=99 head_norm_before_train=1.937306 cos_to_last_merge=0.9885 (last merge round=44)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.8748419543528828, 'auprc': 0.9874779213927325, 'loss_val': 0.44611928359135955, 'psi': 0.9198963411688227}-{'f1_val': 0.9929231374444487, 'auprc': 0.992443440760898, 'loss_val': 0.03489014937677051, 'psi': 0.9927312587710284}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.920 u=0.0000 p_local=0.0032 f1=0.875 auprc=0.987 bytes=73702
[S17] START round=99 head_norm_before_train=2.350773 cos_to_last_merge=0.9902 (last merge round=43)
[S17] round=99 local utility u=1.000000 metrics={'f1_val': 0.871217394335117, 'auprc': 0.9898122294805585, 'loss_val': 0.4983964344824096, 'psi': 0.9186553283932937}-{'f1_val': 0.6642424324394768, 'auprc': 0.9549499239785888, 'loss_val': 1.159566251244891, 'psi': 0.7805254290551216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=100 psi=0.919 u=1.0000 p_local=0.3810 f1=0.871 auprc=0.990 bytes=68283
[runner] rounds complete.
[runner] all agents stopped.
