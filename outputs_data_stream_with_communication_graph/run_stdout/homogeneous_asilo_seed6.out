[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63203
[S3] → join 127.0.0.1:63202
[S4] → join 127.0.0.1:63202
[S5] → join 127.0.0.1:63202
[S6] → join 127.0.0.1:63202
[S7] → join 127.0.0.1:63202
[S8] → join 127.0.0.1:63202
[S9] → join 127.0.0.1:63202
[S10] → join 127.0.0.1:63202
[S11] → join 127.0.0.1:63202
[S13] → join 127.0.0.1:63202
[S14] → join 127.0.0.1:63202
[S15] → join 127.0.0.1:63202
[S16] → join 127.0.0.1:63202
[S17] → join 127.0.0.1:63202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.196132 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.163093 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.146978 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.133188 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.191029 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.204062 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.204424 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.220717 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.094788 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.188332 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.140983 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.085151 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.172360 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.161924 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.205990 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S17
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S7
[S4] + discovered S3
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S11
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S7
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S16
[S5] + discovered S11
[S5] + discovered S10
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S17
[S6] + discovered S4
[S5] + discovered S7
[S5] + discovered S16
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S6
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S16
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S15
[S7] + discovered S2
[S8] + discovered S5
[S7] + discovered S16
[S7] + discovered S13
[S8] + discovered S7
[S7] + discovered S14
[S7] + discovered S9
[S8] + discovered S2
[S7] + discovered S10
[S8] + discovered S3
[S7] + discovered S8
[S7] + discovered S11
[S8] + discovered S4
[S7] + discovered S17
[S8] + discovered S6
[S7] + discovered S15
[S9] + discovered S4
[S8] + discovered S11
[S8] + discovered S16
[S9] + discovered S2
[S8] + discovered S13
[S8] + discovered S14
[S9] + discovered S3
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S17
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S8
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S4
[S9] + discovered S14
[S10] + discovered S2
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S17
[S10] + discovered S7
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S13
[S10] + discovered S8
[S10] + discovered S9
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S2
[S10] + discovered S11
[S11] + discovered S3
[S10] + discovered S14
[S11] + discovered S10
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S7
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S8
[S11] + discovered S15
[S14] + discovered S11
[S13] + discovered S14
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S2
[S13] + discovered S15
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S9
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S8
[S15] + discovered S7
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S3
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S8
[S15] + discovered S16
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S11
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S15
[S17] + discovered S14
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:63211
[S13] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:63215
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S6] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:63212
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:63208
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S17] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S2] START round=1 head_norm_before_train=1.196372 (no previous merge yet)
[S2] round=1 local utility u=0.427089 metrics={'f1_val': 0.16707376648754274, 'auprc': 0.7743690095112924, 'loss_val': 1.33896450005541, 'psi': 0.40999186369704266}-{'f1_val': 0.05585516178736518, 'auprc': 0.7256665200291383, 'loss_val': 1.379723958427647, 'psi': 0.32377970508407444}
[S3] START round=1 head_norm_before_train=1.170219 (no previous merge yet)
[S3] round=1 local utility u=0.723533 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7237329704724687, 'loss_val': 1.3420497276441263, 'psi': 0.37339722755745164}-{'f1_val': 0.0007106310403638431, 'auprc': 0.5298062242172329, 'loss_val': 1.372558731016081, 'psi': 0.21234886831111147}
[S4] START round=1 head_norm_before_train=1.149990 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7938087550717238, 'loss_val': 1.2959412105424297, 'psi': 0.4016594793658}-{'f1_val': 0.14022662889518414, 'auprc': 0.8967754061630318, 'loss_val': 1.3226097714597735, 'psi': 0.4428461398023232}
[S5] START round=1 head_norm_before_train=1.137411 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.733217783701937, 'loss_val': 1.3092527914026066, 'psi': 0.37864425633791765}-{'f1_val': 0.37143414621440085, 'auprc': 0.6204271069480051, 'loss_val': 1.3433741425802475, 'psi': 0.4710313305078425}
[S6] START round=1 head_norm_before_train=1.190171 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.386930824905648, 'auprc': 0.7940553428402655, 'loss_val': 1.3506332077459673, 'psi': 0.549780632079495}-{'f1_val': 0.08954368264159597, 'auprc': 0.29961863548217904, 'loss_val': 1.381401174791608, 'psi': 0.1735736637778292}
[S7] START round=1 head_norm_before_train=1.211901 (no previous merge yet)
[S7] round=1 local utility u=0.099202 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7807261843808805, 'loss_val': 1.3162120722631028, 'psi': 0.3975245673898072}-{'f1_val': 0.14205682272909165, 'auprc': 0.7242227694767336, 'loss_val': 1.3451057930134371, 'psi': 0.37492320142814844}
[S8] START round=1 head_norm_before_train=1.212711 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.3915296385067547, 'auprc': 0.7573657800458969, 'loss_val': 1.3097373431871075, 'psi': 0.5378640951224116}-{'f1_val': 0.10450549450549451, 'auprc': 0.6332653042118944, 'loss_val': 1.349233572407635, 'psi': 0.3160094183880545}
[S9] START round=1 head_norm_before_train=1.223558 (no previous merge yet)
[S9] round=1 local utility u=0.130075 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6692037381470191, 'loss_val': 1.2911279573108978, 'psi': 0.35252026954280524}-{'f1_val': 0.141397957139996, 'auprc': 0.5969260655679812, 'loss_val': 1.334444522319674, 'psi': 0.3236092005111901}
[S10] START round=1 head_norm_before_train=1.104628 (no previous merge yet)
[S10] round=1 local utility u=0.038256 metrics={'f1_val': 0.09576103667911268, 'auprc': 0.848339141816271, 'loss_val': 1.336318135715268, 'psi': 0.39679227873397604}-{'f1_val': 0.09576103667911268, 'auprc': 0.834232157905597, 'loss_val': 1.370508350243422, 'psi': 0.39114948516970643}
[S11] START round=1 head_norm_before_train=1.190366 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39100763568022456, 'auprc': 0.756698693294046, 'loss_val': 1.3383796113406694, 'psi': 0.5372840587257532}-{'f1_val': 0.10359570269677702, 'auprc': 0.5315052647849665, 'loss_val': 1.3754854124606442, 'psi': 0.27475952753205285}
[S13] START round=1 head_norm_before_train=1.141234 (no previous merge yet)
[S13] round=1 local utility u=0.134727 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6002989420330097, 'loss_val': 1.3424958370380615, 'psi': 0.32435103435943574}-{'f1_val': 0.1428584319229998, 'auprc': 0.5165889449373142, 'loss_val': 1.375654887428353, 'psi': 0.29235063712872555}
[S14] START round=1 head_norm_before_train=1.082633 (no previous merge yet)
[S14] round=1 local utility u=0.440226 metrics={'f1_val': 0.2257865400418695, 'auprc': 0.622484926974179, 'loss_val': 1.3517651248198967, 'psi': 0.3844658948147933}-{'f1_val': 0.1038107752956636, 'auprc': 0.579674957617018, 'loss_val': 1.3719317208175106, 'psi': 0.2941564482242054}
[S15] START round=1 head_norm_before_train=1.179481 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.3303936908965295, 'auprc': 0.7685493382877174, 'loss_val': 1.3334144506324674, 'psi': 0.5056559498530047}-{'f1_val': 0.5464005826571517, 'auprc': 0.5841775762997603, 'loss_val': 1.3689842490367967, 'psi': 0.5615113801141951}
[S16] START round=1 head_norm_before_train=1.163027 (no previous merge yet)
[S16] round=1 local utility u=0.517288 metrics={'f1_val': 0.4146064829671071, 'auprc': 0.7932922088763316, 'loss_val': 1.3292713809379062, 'psi': 0.5660807733307969}-{'f1_val': 0.30344086388291547, 'auprc': 0.6796576970320896, 'loss_val': 1.3559495953299958, 'psi': 0.4539275971425851}
[S17] START round=1 head_norm_before_train=1.215351 (no previous merge yet)
[S17] round=1 local utility u=0.055425 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6465907662603093, 'loss_val': 1.3130280145618216, 'psi': 0.34320568449455435}-{'f1_val': 0.14094896331738438, 'auprc': 0.6173246488770907, 'loss_val': 1.3360791781021546, 'psi': 0.3314992375412669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:63210
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:63210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:63210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S13] → sending delta(kind=head bytes=1783) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:63208
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1783 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1789) from S3
[S6] cosine check vs S3: cos=-0.0236
[S6] DROPPED delta from S3 (cos=-0.0236 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.0423
[S9] RECEIVED delta(kind=head bytes=1787) from S16
[S9] cosine check vs S16: cos=0.0044
[S7] RECEIVED delta(kind=head bytes=1788) from S8
[S7] cosine check vs S8: cos=0.0503
[S9] RECEIVED delta(kind=head bytes=1794) from S14
[S9] cosine check vs S14: cos=0.0914
[S4] RECEIVED delta(kind=head bytes=1783) from S13
[S4] cosine check vs S13: cos=0.0105
[S4] RECEIVED delta(kind=head bytes=1790) from S9
[S4] cosine check vs S9: cos=-0.0385
[S4] DROPPED delta from S9 (cos=-0.0385 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S6
[S11] cosine check vs S6: cos=-0.0204
[S11] DROPPED delta from S6 (cos=-0.0204 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S2
[S7] cosine check vs S2: cos=-0.0241
[S7] DROPPED delta from S2 (cos=-0.0241 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1787) from S7
[S5] cosine check vs S7: cos=0.0257
[S7] RECEIVED delta(kind=head bytes=1791) from S10
[S7] cosine check vs S10: cos=0.0598
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63209
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=-0.0608
[S8] DROPPED delta from S17 (cos=-0.0608 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.152939
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.295829e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.3936 head_norm=0.851115 delta_norm=0.829583
[S5] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.165843
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.157865e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.824365 delta_norm=0.815787
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.237644
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.780940e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.725379 delta_norm=0.678094
[S9] aggregate: ACCEPT kept=['S11', 'S16', 'S14'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.223086
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.169997e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.770044 delta_norm=0.717000
[S7] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.208518 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7751812170764352, 'loss_val': 1.2894224781940893, 'psi': 0.39513876686371413}-{'f1_val': 0.16707376648754274, 'auprc': 0.7743690095112924, 'loss_val': 1.33896450005541, 'psi': 0.40999186369704266}
[S3] START round=2 head_norm_before_train=1.183117 (no previous merge yet)
[S3] round=2 local utility u=0.345275 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.94064073925279, 'loss_val': 1.302223216561424, 'psi': 0.4601603350695802}-{'f1_val': 0.13984006561410703, 'auprc': 0.7237329704724687, 'loss_val': 1.3420497276441263, 'psi': 0.37339722755745164}
[S4] START round=2 head_norm_before_train=0.824365 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7930913631576989, 'loss_val': 1.3108094704545756, 'psi': 0.4013725226001901}-{'f1_val': 0.14022662889518414, 'auprc': 0.7938087550717238, 'loss_val': 1.2959412105424297, 'psi': 0.4016594793658}
[S5] START round=2 head_norm_before_train=0.851115 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.055334 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7694796902985117, 'loss_val': 1.3073706626975907, 'psi': 0.3931490189765476}-{'f1_val': 0.14226190476190476, 'auprc': 0.733217783701937, 'loss_val': 1.3092527914026066, 'psi': 0.37864425633791765}
[S6] START round=2 head_norm_before_train=1.198244 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7974531336466271, 'loss_val': 1.3142000602006456, 'psi': 0.40383702268942007}-{'f1_val': 0.386930824905648, 'auprc': 0.7940553428402655, 'loss_val': 1.3506332077459673, 'psi': 0.549780632079495}
[S7] START round=2 head_norm_before_train=0.770044 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7588380534156525, 'loss_val': 1.3117669409833619, 'psi': 0.388769315003716}-{'f1_val': 0.14205682272909165, 'auprc': 0.7807261843808805, 'loss_val': 1.3162120722631028, 'psi': 0.3975245673898072}
[S8] START round=2 head_norm_before_train=1.230819 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7423929263445683, 'loss_val': 1.2684717905046585, 'psi': 0.38093075997360165}-{'f1_val': 0.3915296385067547, 'auprc': 0.7573657800458969, 'loss_val': 1.3097373431871075, 'psi': 0.5378640951224116}
[S9] START round=2 head_norm_before_train=0.725379 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.394595 metrics={'f1_val': 0.141397957139996, 'auprc': 0.933586837370044, 'loss_val': 1.2950875140803266, 'psi': 0.4582735092320152}-{'f1_val': 0.141397957139996, 'auprc': 0.6692037381470191, 'loss_val': 1.2911279573108978, 'psi': 0.35252026954280524}
[S10] START round=2 head_norm_before_train=1.121918 (no previous merge yet)
[S10] round=2 local utility u=0.834806 metrics={'f1_val': 0.37770787620190915, 'auprc': 0.8284398436710513, 'loss_val': 1.2986886541661236, 'psi': 0.558000663189566}-{'f1_val': 0.09576103667911268, 'auprc': 0.848339141816271, 'loss_val': 1.336318135715268, 'psi': 0.39679227873397604}
[S11] START round=2 head_norm_before_train=1.203576 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7609697003218143, 'loss_val': 1.2949362771747146, 'psi': 0.3886360901525921}-{'f1_val': 0.39100763568022456, 'auprc': 0.756698693294046, 'loss_val': 1.3383796113406694, 'psi': 0.5372840587257532}
[S13] START round=2 head_norm_before_train=1.153682 (no previous merge yet)
[S13] round=2 local utility u=0.004208 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5910223173227022, 'loss_val': 1.3062498403264844, 'psi': 0.32064038447531273}-{'f1_val': 0.1403857625770531, 'auprc': 0.6002989420330097, 'loss_val': 1.3424958370380615, 'psi': 0.32435103435943574}
[S14] START round=2 head_norm_before_train=1.090528 (no previous merge yet)
[S14] round=2 local utility u=0.630275 metrics={'f1_val': 0.42250899536887043, 'auprc': 0.6415845205163326, 'loss_val': 1.3288476833180554, 'psi': 0.5101392054278553}-{'f1_val': 0.2257865400418695, 'auprc': 0.622484926974179, 'loss_val': 1.3517651248198967, 'psi': 0.3844658948147933}
[S15] START round=2 head_norm_before_train=1.194773 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.766066693401968, 'loss_val': 1.2953507819844614, 'psi': 0.3902668681777222}-{'f1_val': 0.3303936908965295, 'auprc': 0.7685493382877174, 'loss_val': 1.3334144506324674, 'psi': 0.5056559498530047}
[S16] START round=2 head_norm_before_train=1.173997 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7686005056710126, 'loss_val': 1.2986361190559674, 'psi': 0.391822672387927}-{'f1_val': 0.4146064829671071, 'auprc': 0.7932922088763316, 'loss_val': 1.3292713809379062, 'psi': 0.5660807733307969}
[S17] START round=2 head_norm_before_train=1.233011 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6006838814278888, 'loss_val': 1.2824090081551043, 'psi': 0.32484293056158614}-{'f1_val': 0.14094896331738438, 'auprc': 0.6465907662603093, 'loss_val': 1.3130280145618216, 'psi': 0.34320568449455435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:63208
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:63208
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:63212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63208
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.0072
[S7] RECEIVED delta(kind=head bytes=1787) from S14
[S7] cosine check vs S14: cos=0.1135
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.4192
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=-0.0179
[S11] DROPPED delta from S5 (cos=-0.0179 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S3
[S14] cosine check vs S3: cos=-0.0392
[S14] DROPPED delta from S3 (cos=-0.0392 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1788) from S13
[S7] cosine check vs S13: cos=-0.1405
[S7] DROPPED delta from S13 (cos=-0.1405 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.791977
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.482053e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.663781 delta_norm=0.448205
[S7] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=0.869211
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.721049e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.2981 head_norm=0.576185 delta_norm=0.572105
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.230281 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.617312948614812, 'loss_val': 1.2278095504653186, 'psi': 0.33199145947906483}-{'f1_val': 0.1417771333885667, 'auprc': 0.7751812170764352, 'loss_val': 1.2894224781940893, 'psi': 0.39513876686371413}
[S3] START round=3 head_norm_before_train=1.204311 (no previous merge yet)
[S3] round=3 local utility u=0.018655 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9373960689920636, 'loss_val': 1.2551783524575013, 'psi': 0.45886246696528965}-{'f1_val': 0.13984006561410703, 'auprc': 0.94064073925279, 'loss_val': 1.302223216561424, 'psi': 0.4601603350695802}
[S4] START round=3 head_norm_before_train=0.845743 cos_to_last_merge=0.9970 (last merge round=1)
[S4] round=3 local utility u=0.019197 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7925533715274017, 'loss_val': 1.2708014740403657, 'psi': 0.4011573259480712}-{'f1_val': 0.14022662889518414, 'auprc': 0.7930913631576989, 'loss_val': 1.3108094704545756, 'psi': 0.4013725226001901}
[S5] START round=3 head_norm_before_train=0.576185 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7252520732734904, 'loss_val': 1.3111705684837685, 'psi': 0.37545797216653903}-{'f1_val': 0.14226190476190476, 'auprc': 0.7694796902985117, 'loss_val': 1.3073706626975907, 'psi': 0.3931490189765476}
[S6] START round=3 head_norm_before_train=1.215216 (no previous merge yet)
[S6] round=3 local utility u=0.117560 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8609212073466801, 'loss_val': 1.2694839450074948, 'psi': 0.42922425216944127}-{'f1_val': 0.14142628205128205, 'auprc': 0.7974531336466271, 'loss_val': 1.3142000602006456, 'psi': 0.40383702268942007}
[S7] START round=3 head_norm_before_train=0.663781 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.010535 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7626565642139347, 'loss_val': 1.3021525357717654, 'psi': 0.3902967193230289}-{'f1_val': 0.14205682272909165, 'auprc': 0.7588380534156525, 'loss_val': 1.3117669409833619, 'psi': 0.388769315003716}
[S8] START round=3 head_norm_before_train=1.255667 (no previous merge yet)
[S8] round=3 local utility u=0.009971 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7315908824812721, 'loss_val': 1.2161241628408548, 'psi': 0.37660994242828316}-{'f1_val': 0.13995598239295717, 'auprc': 0.7423929263445683, 'loss_val': 1.2684717905046585, 'psi': 0.38093075997360165}
[S9] START round=3 head_norm_before_train=0.750373 cos_to_last_merge=0.9957 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8734956511109594, 'loss_val': 1.2346156537496413, 'psi': 0.4342370347283814}-{'f1_val': 0.141397957139996, 'auprc': 0.933586837370044, 'loss_val': 1.2950875140803266, 'psi': 0.4582735092320152}
[S10] START round=3 head_norm_before_train=1.144341 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8265380077254495, 'loss_val': 1.247391406900019, 'psi': 0.4137881856152142}-{'f1_val': 0.37770787620190915, 'auprc': 0.8284398436710513, 'loss_val': 1.2986886541661236, 'psi': 0.558000663189566}
[S11] START round=3 head_norm_before_train=1.223791 (no previous merge yet)
[S11] round=3 local utility u=0.017015 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7545249715101503, 'loss_val': 1.2415717331468537, 'psi': 0.3860581986279265}-{'f1_val': 0.14041368337311058, 'auprc': 0.7609697003218143, 'loss_val': 1.2949362771747146, 'psi': 0.3886360901525921}
[S13] START round=3 head_norm_before_train=1.176199 (no previous merge yet)
[S13] round=3 local utility u=0.014372 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5878717617180227, 'loss_val': 1.268054486306555, 'psi': 0.31938016223344096}-{'f1_val': 0.1403857625770531, 'auprc': 0.5910223173227022, 'loss_val': 1.3062498403264844, 'psi': 0.32064038447531273}
[S14] START round=3 head_norm_before_train=1.107713 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7427794028204349, 'loss_val': 1.2998759365388508, 'psi': 0.3813264728577962}-{'f1_val': 0.42250899536887043, 'auprc': 0.6415845205163326, 'loss_val': 1.3288476833180554, 'psi': 0.5101392054278553}
[S15] START round=3 head_norm_before_train=1.215486 (no previous merge yet)
[S15] round=3 local utility u=0.027436 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7696412038018593, 'loss_val': 1.2512015228684639, 'psi': 0.39169667233767874}-{'f1_val': 0.13973365136155833, 'auprc': 0.766066693401968, 'loss_val': 1.2953507819844614, 'psi': 0.3902668681777222}
[S16] START round=3 head_norm_before_train=1.195463 (no previous merge yet)
[S16] round=3 local utility u=0.176967 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8736874210572725, 'loss_val': 1.2599623268902196, 'psi': 0.433857438542431}-{'f1_val': 0.14063745019920318, 'auprc': 0.7686005056710126, 'loss_val': 1.2986361190559674, 'psi': 0.391822672387927}
[S17] START round=3 head_norm_before_train=1.258926 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5816881341994046, 'loss_val': 1.2293445395030933, 'psi': 0.31724463167019246}-{'f1_val': 0.14094896331738438, 'auprc': 0.6006838814278888, 'loss_val': 1.2824090081551043, 'psi': 0.32484293056158614}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63215
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:63212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[S13] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1788) from S13
[S3] cosine check vs S13: cos=0.0599
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=-0.0432
[S2] DROPPED delta from S8 (cos=-0.0432 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.0559
[S13] RECEIVED delta(kind=head bytes=1794) from S15
[S13] cosine check vs S15: cos=0.0256
[S13] RECEIVED delta(kind=head bytes=1792) from S6
[S13] cosine check vs S6: cos=-0.0707
[S13] DROPPED delta from S6 (cos=-0.0707 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] cosine check vs S11: cos=0.0229
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.1266
[S7] DROPPED delta from S4 (cos=-0.1266 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=-0.0365
[S3] DROPPED delta from S7 (cos=-0.0365 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] cosine check vs S3: cos=-0.1389
[S11] DROPPED delta from S3 (cos=-0.1389 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.242455
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.704962e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1989 head_norm=0.890660 delta_norm=0.870496
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.203503
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.537546e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.4093 head_norm=0.875877 delta_norm=0.853755
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.878195
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.326033e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.772509 delta_norm=0.732603
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.233406
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.354604e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.887052 delta_norm=0.835460
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.259663 (no previous merge yet)
[S2] round=4 local utility u=0.017884 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6132205488501964, 'loss_val': 1.1797644882627674, 'psi': 0.3303544995732186}-{'f1_val': 0.1417771333885667, 'auprc': 0.617312948614812, 'loss_val': 1.2278095504653186, 'psi': 0.33199145947906483}
[S3] START round=4 head_norm_before_train=0.887052 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8063447748286287, 'loss_val': 1.2627239569577982, 'psi': 0.40644194929991573}-{'f1_val': 0.13984006561410703, 'auprc': 0.9373960689920636, 'loss_val': 1.2551783524575013, 'psi': 0.45886246696528965}
[S4] START round=4 head_norm_before_train=0.772509 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.006189 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7912402876985416, 'loss_val': 1.2544850110383177, 'psi': 0.40063209241652714}-{'f1_val': 0.14022662889518414, 'auprc': 0.7925533715274017, 'loss_val': 1.2708014740403657, 'psi': 0.4011573259480712}
[S5] START round=4 head_norm_before_train=0.596445 cos_to_last_merge=0.9940 (last merge round=2)
[S5] round=4 local utility u=0.089032 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7669731936407623, 'loss_val': 1.2582692683842092, 'psi': 0.3921464203134478}-{'f1_val': 0.14226190476190476, 'auprc': 0.7252520732734904, 'loss_val': 1.3111705684837685, 'psi': 0.37545797216653903}
[S6] START round=4 head_norm_before_train=1.240488 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7368893010789274, 'loss_val': 1.2242417751337522, 'psi': 0.37961148966234015}-{'f1_val': 0.14142628205128205, 'auprc': 0.8609212073466801, 'loss_val': 1.2694839450074948, 'psi': 0.42922425216944127}
[S7] START round=4 head_norm_before_train=0.688445 cos_to_last_merge=0.9955 (last merge round=2)
[S7] round=4 local utility u=0.030474 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7735257602825816, 'loss_val': 1.2738115530289922, 'psi': 0.39464439775048765}-{'f1_val': 0.14205682272909165, 'auprc': 0.7626565642139347, 'loss_val': 1.3021525357717654, 'psi': 0.3902967193230289}
[S8] START round=4 head_norm_before_train=1.286870 (no previous merge yet)
[S8] round=4 local utility u=0.526633 metrics={'f1_val': 0.2877439518307804, 'auprc': 0.7660994729888837, 'loss_val': 1.1531118198116945, 'psi': 0.47908616029402173}-{'f1_val': 0.13995598239295717, 'auprc': 0.7315908824812721, 'loss_val': 1.2161241628408548, 'psi': 0.37660994242828316}
[S9] START round=4 head_norm_before_train=0.787232 cos_to_last_merge=0.9839 (last merge round=1)
[S9] round=4 local utility u=0.017396 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656995363574638, 'loss_val': 1.176434787887569, 'psi': 0.4311185888269831}-{'f1_val': 0.141397957139996, 'auprc': 0.8734956511109594, 'loss_val': 1.2346156537496413, 'psi': 0.4342370347283814}
[S10] START round=4 head_norm_before_train=1.173666 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8029605252805782, 'loss_val': 1.1793852155490976, 'psi': 0.40435719263726566}-{'f1_val': 0.13862163754172394, 'auprc': 0.8265380077254495, 'loss_val': 1.247391406900019, 'psi': 0.4137881856152142}
[S11] START round=4 head_norm_before_train=1.248353 (no previous merge yet)
[S11] round=4 local utility u=0.026958 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7494841657268558, 'loss_val': 1.1725327392172755, 'psi': 0.3840418763146087}-{'f1_val': 0.14041368337311058, 'auprc': 0.7545249715101503, 'loss_val': 1.2415717331468537, 'psi': 0.3860581986279265}
[S13] START round=4 head_norm_before_train=0.875877 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5752234648252685, 'loss_val': 1.2640500261147611, 'psi': 0.31432084347633926}-{'f1_val': 0.1403857625770531, 'auprc': 0.5878717617180227, 'loss_val': 1.268054486306555, 'psi': 0.31938016223344096}
[S14] START round=4 head_norm_before_train=1.133468 (no previous merge yet)
[S14] round=4 local utility u=0.210664 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8706814881349625, 'loss_val': 1.2622541188308676, 'psi': 0.43248730698360727}-{'f1_val': 0.14035785288270378, 'auprc': 0.7427794028204349, 'loss_val': 1.2998759365388508, 'psi': 0.3813264728577962}
[S15] START round=4 head_norm_before_train=0.890660 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.003894 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7742012839325532, 'loss_val': 1.2570946309233666, 'psi': 0.3935207043899563}-{'f1_val': 0.13973365136155833, 'auprc': 0.7696412038018593, 'loss_val': 1.2512015228684639, 'psi': 0.39169667233767874}
[S16] START round=4 head_norm_before_train=1.223000 (no previous merge yet)
[S16] round=4 local utility u=0.022953 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8700652675882132, 'loss_val': 1.2031895681072522, 'psi': 0.4324085771548072}-{'f1_val': 0.14063745019920318, 'auprc': 0.8736874210572725, 'loss_val': 1.2599623268902196, 'psi': 0.433857438542431}
[S17] START round=4 head_norm_before_train=1.294759 (no previous merge yet)
[S17] round=4 local utility u=0.031668 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5679304641930611, 'loss_val': 1.1247350090377168, 'psi': 0.3117415636676551}-{'f1_val': 0.14094896331738438, 'auprc': 0.5816881341994046, 'loss_val': 1.2293445395030933, 'psi': 0.31724463167019246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63205
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=0.6926
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.0401
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0424
[S2] DROPPED delta from S8 (cos=-0.0424 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0054
[S3] DROPPED delta from S5 (cos=-0.0054 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S15
[S13] cosine check vs S15: cos=0.5366
[S7] RECEIVED delta(kind=head bytes=1793) from S4
[S7] cosine check vs S4: cos=-0.0364
[S7] DROPPED delta from S4 (cos=-0.0364 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.6095
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=-0.1161
[S3] DROPPED delta from S7 (cos=-0.1161 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.0385
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.7970
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S17
[S2] cosine check vs S17: cos=-0.1275
[S2] DROPPED delta from S17 (cos=-0.1275 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=1.209748
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.244781e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.856809 delta_norm=0.824478
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.904032
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.380426e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1513 head_norm=0.797596 delta_norm=0.438043
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.915864
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.615662e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.5535 head_norm=1.012092 delta_norm=0.461566
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.802628
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.028468e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.765272 delta_norm=0.402847
[S4] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.626630
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.332703e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.653203 delta_norm=0.333270
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.286868 (no previous merge yet)
[S2] round=5 local utility u=0.917303 metrics={'f1_val': 0.40501679555408504, 'auprc': 0.673519613023313, 'loss_val': 1.105492943897453, 'psi': 0.5124179225417762}-{'f1_val': 0.1417771333885667, 'auprc': 0.6132205488501964, 'loss_val': 1.1797644882627674, 'psi': 0.3303544995732186}
[S3] START round=5 head_norm_before_train=0.911043 cos_to_last_merge=0.9968 (last merge round=3)
[S3] round=5 local utility u=0.039930 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8184255231076967, 'loss_val': 1.2191062726250392, 'psi': 0.41127424861154294}-{'f1_val': 0.13984006561410703, 'auprc': 0.8063447748286287, 'loss_val': 1.2627239569577982, 'psi': 0.40644194929991573}
[S4] START round=5 head_norm_before_train=0.765272 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.413976 metrics={'f1_val': 0.27109406361797905, 'auprc': 0.7926807598836929, 'loss_val': 1.2160593262716772, 'psi': 0.47972874212426464}-{'f1_val': 0.14022662889518414, 'auprc': 0.7912402876985416, 'loss_val': 1.2544850110383177, 'psi': 0.40063209241652714}
[S5] START round=5 head_norm_before_train=0.653203 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6221053582405475, 'loss_val': 1.2386083679052013, 'psi': 0.33419928615336186}-{'f1_val': 0.14226190476190476, 'auprc': 0.7669731936407623, 'loss_val': 1.2582692683842092, 'psi': 0.3921464203134478}
[S6] START round=5 head_norm_before_train=1.267138 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6534481997562637, 'loss_val': 1.1634555550332966, 'psi': 0.3462350491332747}-{'f1_val': 0.14142628205128205, 'auprc': 0.7368893010789274, 'loss_val': 1.2242417751337522, 'psi': 0.37961148966234015}
[S7] START round=5 head_norm_before_train=0.712455 cos_to_last_merge=0.9863 (last merge round=2)
[S7] round=5 local utility u=0.016361 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773591776174588, 'loss_val': 1.2525892079072651, 'psi': 0.3961777646844385}-{'f1_val': 0.14205682272909165, 'auprc': 0.7735257602825816, 'loss_val': 1.2738115530289922, 'psi': 0.39464439775048765}
[S8] START round=5 head_norm_before_train=1.316395 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.6761618657399561, 'auprc': 0.7672585514517667, 'loss_val': 1.0525722562908373, 'psi': 0.7126005400246803}-{'f1_val': 0.2877439518307804, 'auprc': 0.7660994729888837, 'loss_val': 1.1531118198116945, 'psi': 0.47908616029402173}
[S9] START round=5 head_norm_before_train=0.826331 cos_to_last_merge=0.9695 (last merge round=1)
[S9] round=5 local utility u=0.053359 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659655918852942, 'loss_val': 1.0705140396020845, 'psi': 0.43122501103811534}-{'f1_val': 0.141397957139996, 'auprc': 0.8656995363574638, 'loss_val': 1.176434787887569, 'psi': 0.4311185888269831}
[S10] START round=5 head_norm_before_train=0.856809 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7175272236211372, 'loss_val': 1.1840353828271095, 'psi': 0.37018387197348923}-{'f1_val': 0.13862163754172394, 'auprc': 0.8029605252805782, 'loss_val': 1.1793852155490976, 'psi': 0.40435719263726566}
[S11] START round=5 head_norm_before_train=1.279038 (no previous merge yet)
[S11] round=5 local utility u=0.675783 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.5985226411261296, 'loss_val': 1.062024923328118, 'psi': 0.4930514906887789}-{'f1_val': 0.14041368337311058, 'auprc': 0.7494841657268558, 'loss_val': 1.1725327392172755, 'psi': 0.3840418763146087}
[S13] START round=5 head_norm_before_train=0.797596 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.014462 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5796164013418464, 'loss_val': 1.2483042164776563, 'psi': 0.3160780180829704}-{'f1_val': 0.1403857625770531, 'auprc': 0.5752234648252685, 'loss_val': 1.2640500261147611, 'psi': 0.31432084347633926}
[S14] START round=5 head_norm_before_train=1.168024 (no previous merge yet)
[S14] round=5 local utility u=0.006170 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8546601822133093, 'loss_val': 1.2018508450168872, 'psi': 0.42607878461494597}-{'f1_val': 0.14035785288270378, 'auprc': 0.8706814881349625, 'loss_val': 1.2622541188308676, 'psi': 0.43248730698360727}
[S15] START round=5 head_norm_before_train=1.012092 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.015875 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7757796093145091, 'loss_val': 1.2300804118597395, 'psi': 0.39415203454273867}-{'f1_val': 0.13973365136155833, 'auprc': 0.7742012839325532, 'loss_val': 1.2570946309233666, 'psi': 0.3935207043899563}
[S16] START round=5 head_norm_before_train=1.258759 (no previous merge yet)
[S16] round=5 local utility u=0.624961 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.6988212871049606, 'loss_val': 1.1002409583894797, 'psi': 0.5299815648515742}-{'f1_val': 0.14063745019920318, 'auprc': 0.8700652675882132, 'loss_val': 1.2031895681072522, 'psi': 0.4324085771548072}
[S17] START round=5 head_norm_before_train=1.342100 (no previous merge yet)
[S17] round=5 local utility u=0.840712 metrics={'f1_val': 0.3892035294565077, 'auprc': 0.5807370682211452, 'loss_val': 0.9712584731947338, 'psi': 0.4658169449623627}-{'f1_val': 0.14094896331738438, 'auprc': 0.5679304641930611, 'loss_val': 1.1247350090377168, 'psi': 0.3117415636676551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:63212
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=-0.0422
[S2] DROPPED delta from S8 (cos=-0.0422 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.9255
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=-0.1212
[S3] DROPPED delta from S7 (cos=-0.1212 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S13
[S3] cosine check vs S13: cos=0.3205
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.4509
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.6796
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=0.6746
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] cosine check vs S4: cos=-0.0194
[S7] DROPPED delta from S4 (cos=-0.0194 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.8947
[S11] RECEIVED delta(kind=head bytes=1791) from S3
[S11] cosine check vs S3: cos=-0.0865
[S11] DROPPED delta from S3 (cos=-0.0865 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.8289
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S17
[S2] cosine check vs S17: cos=-0.1203
[S2] DROPPED delta from S17 (cos=-0.1203 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.889776
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.429960e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1392 head_norm=0.961348 delta_norm=0.442996
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.416 → S5@127.0.0.1:63205
[S6] ⇄ pheromone p=0.425 → S13@127.0.0.1:63213
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.676338
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.996888e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.751128 delta_norm=0.199689
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.348 → S3@127.0.0.1:63203
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=1.031066
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.656484e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.3002 head_norm=1.150989 delta_norm=0.265648
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.335 → S13@127.0.0.1:63213
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.2711 head_norm=0.794985
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.273594e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1581 head_norm=0.845257 delta_norm=0.227359
[S4] aggregate: ROLLBACK (f1_val pre=0.271 post=0.158 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.414 → S7@127.0.0.1:63208
[S7] ⇄ pheromone p=0.345 → S3@127.0.0.1:63203
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.936793
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.157129e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.716882 delta_norm=0.515713
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.433 → S11@127.0.0.1:63212
[S2] ⇄ pheromone p=0.549 → S4@127.0.0.1:63204
[S11] ⇄ pheromone p=0.551 → S15@127.0.0.1:63215
[S14] ⇄ pheromone p=0.463 → S10@127.0.0.1:63211
[S16] ⇄ pheromone p=0.521 → S4@127.0.0.1:63204
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.825941
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.861044e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.850624 delta_norm=0.386104
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.344 → S3@127.0.0.1:63203
[S8] ⇄ pheromone p=0.695 → S2@127.0.0.1:63202
[S9] ⇄ pheromone p=0.392 → S5@127.0.0.1:63205
[S17] ⇄ pheromone p=0.505 → S2@127.0.0.1:63202
[S2] START round=6 head_norm_before_train=1.311407 (no previous merge yet)
[S2] round=6 local utility u=0.244412 metrics={'f1_val': 0.41668927637069086, 'auprc': 0.7758799107448833, 'loss_val': 0.9937843297119427, 'psi': 0.5603655301203678}-{'f1_val': 0.40501679555408504, 'auprc': 0.673519613023313, 'loss_val': 1.105492943897453, 'psi': 0.5124179225417762}
[S3] START round=6 head_norm_before_train=0.716882 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.048658 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8394856111274883, 'loss_val': 1.1849713399980923, 'psi': 0.4196982838194596}-{'f1_val': 0.13984006561410703, 'auprc': 0.8184255231076967, 'loss_val': 1.2191062726250392, 'psi': 0.41127424861154294}
[S4] START round=6 head_norm_before_train=0.845257 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.481811 metrics={'f1_val': 0.4150135411368775, 'auprc': 0.7927904817511481, 'loss_val': 1.116283296418612, 'psi': 0.5661243173825857}-{'f1_val': 0.27109406361797905, 'auprc': 0.7926807598836929, 'loss_val': 1.2160593262716772, 'psi': 0.47972874212426464}
[S5] START round=6 head_norm_before_train=0.751128 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.469293 metrics={'f1_val': 0.24076158149410093, 'auprc': 0.721709925900538, 'loss_val': 1.1898341279269162, 'psi': 0.43314091925667575}-{'f1_val': 0.14226190476190476, 'auprc': 0.6221053582405475, 'loss_val': 1.2386083679052013, 'psi': 0.33419928615336186}
[S6] START round=6 head_norm_before_train=1.296160 (no previous merge yet)
[S6] round=6 local utility u=0.951061 metrics={'f1_val': 0.3853314012366891, 'auprc': 0.7660738418897084, 'loss_val': 1.0626412023751564, 'psi': 0.5376283774978968}-{'f1_val': 0.14142628205128205, 'auprc': 0.6534481997562637, 'loss_val': 1.1634555550332966, 'psi': 0.3462350491332747}
[S7] START round=6 head_norm_before_train=0.737599 cos_to_last_merge=0.9753 (last merge round=2)
[S7] round=6 local utility u=0.014378 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773733018678788, 'loss_val': 1.2238749643694833, 'psi': 0.3961834143846065}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773591776174588, 'loss_val': 1.2525892079072651, 'psi': 0.3961777646844385}
[S8] START round=6 head_norm_before_train=1.349338 (no previous merge yet)
[S8] round=6 local utility u=0.240703 metrics={'f1_val': 0.71525550077189, 'auprc': 0.7945208167990397, 'loss_val': 0.887514650119986, 'psi': 0.7469616271827499}-{'f1_val': 0.6761618657399561, 'auprc': 0.7672585514517667, 'loss_val': 1.0525722562908373, 'psi': 0.7126005400246803}
[S9] START round=6 head_norm_before_train=0.866432 cos_to_last_merge=0.9550 (last merge round=1)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7012675768428742, 'auprc': 0.9863708746110693, 'loss_val': 0.8997119416201781, 'psi': 0.8153088959501522}-{'f1_val': 0.141397957139996, 'auprc': 0.8659655918852942, 'loss_val': 1.0705140396020845, 'psi': 0.43122501103811534}
[S10] START round=6 head_norm_before_train=0.961348 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.932763 metrics={'f1_val': 0.4157904658747533, 'auprc': 0.7751518866222527, 'loss_val': 1.1543963520410405, 'psi': 0.559535034173753}-{'f1_val': 0.13862163754172394, 'auprc': 0.7175272236211372, 'loss_val': 1.1840353828271095, 'psi': 0.37018387197348923}
[S11] START round=6 head_norm_before_train=1.314378 (no previous merge yet)
[S11] round=6 local utility u=0.413486 metrics={'f1_val': 0.41491559158615293, 'auprc': 0.834058308163917, 'loss_val': 0.894728758243328, 'psi': 0.5825726782172586}-{'f1_val': 0.42273739039721175, 'auprc': 0.5985226411261296, 'loss_val': 1.062024923328118, 'psi': 0.4930514906887789}
[S13] START round=6 head_norm_before_train=0.850624 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.004393 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5754974994090504, 'loss_val': 1.227161781417195, 'psi': 0.31443045730985203}-{'f1_val': 0.1403857625770531, 'auprc': 0.5796164013418464, 'loss_val': 1.2483042164776563, 'psi': 0.3160780180829704}
[S14] START round=6 head_norm_before_train=1.203815 (no previous merge yet)
[S14] round=6 local utility u=0.743178 metrics={'f1_val': 0.3966600486558318, 'auprc': 0.7964871927049327, 'loss_val': 1.0787898689791813, 'psi': 0.5565909062754721}-{'f1_val': 0.14035785288270378, 'auprc': 0.8546601822133093, 'loss_val': 1.2018508450168872, 'psi': 0.42607878461494597}
[S15] START round=6 head_norm_before_train=1.150989 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.017554 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7757448486419619, 'loss_val': 1.194869064727633, 'psi': 0.3941381302737198}-{'f1_val': 0.13973365136155833, 'auprc': 0.7757796093145091, 'loss_val': 1.2300804118597395, 'psi': 0.39415203454273867}
[S16] START round=6 head_norm_before_train=1.298249 (no previous merge yet)
[S16] round=6 local utility u=0.046664 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.6750143462457509, 'loss_val': 0.9345966310520991, 'psi': 0.5203692716842686}-{'f1_val': 0.41742175001598325, 'auprc': 0.6988212871049606, 'loss_val': 1.1002409583894797, 'psi': 0.5299815648515742}
[S17] START round=6 head_norm_before_train=1.385829 (no previous merge yet)
[S17] round=6 local utility u=0.371104 metrics={'f1_val': 0.41920943949687295, 'auprc': 0.7668398862962118, 'loss_val': 0.9673952735343676, 'psi': 0.5582616182166085}-{'f1_val': 0.3892035294565077, 'auprc': 0.5807370682211452, 'loss_val': 0.9712584731947338, 'psi': 0.4658169449623627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63215
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.9742
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.7859
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0415
[S2] DROPPED delta from S8 (cos=-0.0415 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.0973
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=-0.1244
[S3] DROPPED delta from S7 (cos=-0.1244 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.6073
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.8562
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9160
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.3265
[S5] RECEIVED delta(kind=head bytes=1790) from S9
[S5] cosine check vs S9: cos=0.9569
[S13] RECEIVED delta(kind=head bytes=1793) from S6
[S13] cosine check vs S6: cos=-0.0252
[S13] DROPPED delta from S6 (cos=-0.0252 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.1713
[S3] RECEIVED delta(kind=head bytes=1791) from S13
[S3] cosine check vs S13: cos=0.5998
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.0132
[S7] DROPPED delta from S4 (cos=-0.0132 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S17
[S2] cosine check vs S17: cos=-0.1120
[S2] DROPPED delta from S17 (cos=-0.1120 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.2408 head_norm=0.771457
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.545863e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.2659 head_norm=0.724644 delta_norm=0.254586
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=1.166344
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.690728e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.2705 head_norm=1.249294 delta_norm=0.169073
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.4158 head_norm=0.984261
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.630499e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.4167 head_norm=1.093458 delta_norm=0.263050
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4150 head_norm=0.875312
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.480269e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4150 head_norm=0.914529 delta_norm=0.148027
[S4] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=0.873985
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.077106e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1417 head_norm=0.983574 delta_norm=0.307711
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4149 head_norm=1.348437
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.109414e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4148 head_norm=0.822075 delta_norm=0.710941
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.737704
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.512895e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.2416 head_norm=0.586901 delta_norm=0.351290
[S3] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.338545 (no previous merge yet)
[S2] round=7 local utility u=0.779457 metrics={'f1_val': 0.6514848596995394, 'auprc': 0.7749479038936234, 'loss_val': 0.8408479473223973, 'psi': 0.700870077377173}-{'f1_val': 0.41668927637069086, 'auprc': 0.7758799107448833, 'loss_val': 0.9937843297119427, 'psi': 0.5603655301203678}
[S3] START round=7 head_norm_before_train=0.586901 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.010718 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.830469323760409, 'loss_val': 1.1364873213695363, 'psi': 0.4160917688726279}-{'f1_val': 0.13984006561410703, 'auprc': 0.8394856111274883, 'loss_val': 1.1849713399980923, 'psi': 0.4196982838194596}
[S4] START round=7 head_norm_before_train=0.914529 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.070573 metrics={'f1_val': 0.41387245678921186, 'auprc': 0.7875910725485047, 'loss_val': 0.952693213179703, 'psi': 0.563359903092929}-{'f1_val': 0.4150135411368775, 'auprc': 0.7927904817511481, 'loss_val': 1.116283296418612, 'psi': 0.5661243173825857}
[S5] START round=7 head_norm_before_train=0.724644 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.650455 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.7772580368156692, 'loss_val': 1.1162970936554797, 'psi': 0.5614329531379043}-{'f1_val': 0.24076158149410093, 'auprc': 0.721709925900538, 'loss_val': 1.1898341279269162, 'psi': 0.43314091925667575}
[S6] START round=7 head_norm_before_train=1.330186 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.3867107059912057, 'auprc': 0.6662025464681884, 'loss_val': 0.9140953244117965, 'psi': 0.4985074421819988}-{'f1_val': 0.3853314012366891, 'auprc': 0.7660738418897084, 'loss_val': 1.0626412023751564, 'psi': 0.5376283774978968}
[S7] START round=7 head_norm_before_train=0.749915 cos_to_last_merge=0.9694 (last merge round=2)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7422498980143488, 'loss_val': 1.1708003102181244, 'psi': 0.3821340528431945}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773733018678788, 'loss_val': 1.2238749643694833, 'psi': 0.3961834143846065}
[S8] START round=7 head_norm_before_train=1.390186 (no previous merge yet)
[S8] round=7 local utility u=0.096507 metrics={'f1_val': 0.7146827657388013, 'auprc': 0.7948019944085205, 'loss_val': 0.6919075940752331, 'psi': 0.746730457206689}-{'f1_val': 0.71525550077189, 'auprc': 0.7945208167990397, 'loss_val': 0.887514650119986, 'psi': 0.7469616271827499}
[S9] START round=7 head_norm_before_train=0.911259 cos_to_last_merge=0.9393 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.6989242300624688, 'auprc': 0.890673122428102, 'loss_val': 0.7208873091994227, 'psi': 0.7756237870087221}-{'f1_val': 0.7012675768428742, 'auprc': 0.9863708746110693, 'loss_val': 0.8997119416201781, 'psi': 0.8153088959501522}
[S10] START round=7 head_norm_before_train=1.093458 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7307449677846536, 'loss_val': 1.0676426669868297, 'psi': 0.5425291048931107}-{'f1_val': 0.4157904658747533, 'auprc': 0.7751518866222527, 'loss_val': 1.1543963520410405, 'psi': 0.559535034173753}
[S11] START round=7 head_norm_before_train=0.822075 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.173610 metrics={'f1_val': 0.41446671390066236, 'auprc': 0.9379737173958196, 'loss_val': 0.8565607679297729, 'psi': 0.6238695152987253}-{'f1_val': 0.41491559158615293, 'auprc': 0.834058308163917, 'loss_val': 0.894728758243328, 'psi': 0.5825726782172586}
[S13] START round=7 head_norm_before_train=0.983574 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.805755 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.5430288784292974, 'loss_val': 1.1700348487004104, 'psi': 0.46662191203096076}-{'f1_val': 0.1403857625770531, 'auprc': 0.5754974994090504, 'loss_val': 1.227161781417195, 'psi': 0.31443045730985203}
[S14] START round=7 head_norm_before_train=1.249369 (no previous merge yet)
[S14] round=7 local utility u=0.238228 metrics={'f1_val': 0.39639674314244955, 'auprc': 0.9006662828238746, 'loss_val': 0.9132911248216157, 'psi': 0.5981045590150196}-{'f1_val': 0.3966600486558318, 'auprc': 0.7964871927049327, 'loss_val': 1.0787898689791813, 'psi': 0.5565909062754721}
[S15] START round=7 head_norm_before_train=1.249294 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.868462 metrics={'f1_val': 0.4220877132128219, 'auprc': 0.7759236864701776, 'loss_val': 1.1526064461978114, 'psi': 0.5636221025157642}-{'f1_val': 0.13973365136155833, 'auprc': 0.7757448486419619, 'loss_val': 1.194869064727633, 'psi': 0.3941381302737198}
[S16] START round=7 head_norm_before_train=1.333514 (no previous merge yet)
[S16] round=7 local utility u=0.005418 metrics={'f1_val': 0.38504994848135876, 'auprc': 0.7108724175800538, 'loss_val': 0.8379998951057938, 'psi': 0.5153789361208367}-{'f1_val': 0.41727255530994717, 'auprc': 0.6750143462457509, 'loss_val': 0.9345966310520991, 'psi': 0.5203692716842686}
[S17] START round=7 head_norm_before_train=1.422945 (no previous merge yet)
[S17] round=7 local utility u=0.061679 metrics={'f1_val': 0.35366891327616834, 'auprc': 0.916994478495055, 'loss_val': 0.9012574943947915, 'psi': 0.578999139363723}-{'f1_val': 0.41920943949687295, 'auprc': 0.7668398862962118, 'loss_val': 0.9673952735343676, 'psi': 0.5582616182166085}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63213
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63204
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:63202
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.6638
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.0080
[S7] DROPPED delta from S4 (cos=-0.0080 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.3849
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.7591
[S3] RECEIVED delta(kind=head bytes=1794) from S13
[S3] cosine check vs S13: cos=0.6637
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.7204
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=0.9666
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.9152
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=0.9425
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0390
[S2] DROPPED delta from S8 (cos=-0.0390 < 0.0)
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S17
[S2] cosine check vs S17: cos=-0.1040
[S2] DROPPED delta from S17 (cos=-0.1040 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4171 head_norm=1.114556
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.809381e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.7152 head_norm=1.197095 delta_norm=0.180938
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4145 head_norm=0.872266
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.025219e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4145 head_norm=0.692414 delta_norm=0.302522
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4157 head_norm=1.004208
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.303902e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4156 head_norm=1.116919 delta_norm=0.230390
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4139 head_norm=0.951512
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.194566e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4139 head_norm=0.969325 delta_norm=0.119457
[S4] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4221 head_norm=1.262038
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.909406e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4221 head_norm=1.045059 delta_norm=0.290941
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.617304
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.443970e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.0897 head_norm=0.595345 delta_norm=0.244397
[S3] aggregate: ROLLBACK (f1_val pre=0.140 post=0.090 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.370734 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.6244309643020154, 'auprc': 0.7635942841077673, 'loss_val': 0.8444341632058585, 'psi': 0.6800962922243161}-{'f1_val': 0.6514848596995394, 'auprc': 0.7749479038936234, 'loss_val': 0.8408479473223973, 'psi': 0.700870077377173}
[S3] START round=8 head_norm_before_train=0.595345 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.705496 metrics={'f1_val': 0.39375626981913037, 'auprc': 0.7714629540943575, 'loss_val': 1.0719732072299326, 'psi': 0.5448389435292212}-{'f1_val': 0.13984006561410703, 'auprc': 0.830469323760409, 'loss_val': 1.1364873213695363, 'psi': 0.4160917688726279}
[S4] START round=8 head_norm_before_train=0.969325 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.689949 metrics={'f1_val': 0.6836651309281447, 'auprc': 0.6644529410453097, 'loss_val': 0.8221370193313837, 'psi': 0.6759802549750107}-{'f1_val': 0.41387245678921186, 'auprc': 0.7875910725485047, 'loss_val': 0.952693213179703, 'psi': 0.563359903092929}
[S5] START round=8 head_norm_before_train=0.749119 cos_to_last_merge=0.9949 (last merge round=6)
[S5] round=8 local utility u=0.053629 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7772093335681242, 'loss_val': 1.0091204671877634, 'psi': 0.5614361595545233}-{'f1_val': 0.41754956401939425, 'auprc': 0.7772580368156692, 'loss_val': 1.1162970936554797, 'psi': 0.5614329531379043}
[S6] START round=8 head_norm_before_train=1.361149 (no previous merge yet)
[S6] round=8 local utility u=0.217067 metrics={'f1_val': 0.38859568342885287, 'auprc': 0.7649973938930996, 'loss_val': 0.7876562947694625, 'psi': 0.5391563676145517}-{'f1_val': 0.3867107059912057, 'auprc': 0.6662025464681884, 'loss_val': 0.9140953244117965, 'psi': 0.4985074421819988}
[S7] START round=8 head_norm_before_train=0.764811 cos_to_last_merge=0.9639 (last merge round=2)
[S7] round=8 local utility u=0.894111 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.7545297889946415, 'loss_val': 1.0671063865645172, 'psi': 0.5518147670070692}-{'f1_val': 0.14205682272909165, 'auprc': 0.7422498980143488, 'loss_val': 1.1708003102181244, 'psi': 0.3821340528431945}
[S8] START round=8 head_norm_before_train=1.437043 (no previous merge yet)
[S8] round=8 local utility u=0.374230 metrics={'f1_val': 0.7142028940814904, 'auprc': 0.9992524678833232, 'loss_val': 0.5539207306639846, 'psi': 0.8282227236022235}-{'f1_val': 0.7146827657388013, 'auprc': 0.7948019944085205, 'loss_val': 0.6919075940752331, 'psi': 0.746730457206689}
[S9] START round=8 head_norm_before_train=0.967681 cos_to_last_merge=0.9197 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=8 local utility u=0.254952 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9985366366781311, 'loss_val': 0.5507177147825608, 'psi': 0.8203835641021895}-{'f1_val': 0.6989242300624688, 'auprc': 0.890673122428102, 'loss_val': 0.7208873091994227, 'psi': 0.7756237870087221}
[S10] START round=8 head_norm_before_train=1.197095 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.851911 metrics={'f1_val': 0.7013704343360756, 'auprc': 0.6809495290826895, 'loss_val': 0.9203448446343385, 'psi': 0.6932020722347212}-{'f1_val': 0.4170518629654155, 'auprc': 0.7307449677846536, 'loss_val': 1.0676426669868297, 'psi': 0.5425291048931107}
[S11] START round=8 head_norm_before_train=0.692414 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.40137695705405213, 'auprc': 0.799663905735735, 'loss_val': 0.8407236510336392, 'psi': 0.5606917365267253}-{'f1_val': 0.41446671390066236, 'auprc': 0.9379737173958196, 'loss_val': 0.8565607679297729, 'psi': 0.6238695152987253}
[S13] START round=8 head_norm_before_train=1.116919 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3793706293706294, 'auprc': 0.5065096802937463, 'loss_val': 1.0960704577048201, 'psi': 0.4302262497398761}-{'f1_val': 0.4156839344320697, 'auprc': 0.5430288784292974, 'loss_val': 1.1700348487004104, 'psi': 0.46662191203096076}
[S14] START round=8 head_norm_before_train=1.299736 (no previous merge yet)
[S14] round=8 local utility u=0.570648 metrics={'f1_val': 0.5191699765015638, 'auprc': 0.9688470571316962, 'loss_val': 0.7131763157793548, 'psi': 0.6990408087536168}-{'f1_val': 0.39639674314244955, 'auprc': 0.9006662828238746, 'loss_val': 0.9132911248216157, 'psi': 0.5981045590150196}
[S15] START round=8 head_norm_before_train=1.045059 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.722372 metrics={'f1_val': 0.6447550477412233, 'auprc': 0.7777685798750095, 'loss_val': 1.0494014006375332, 'psi': 0.6979604605947378}-{'f1_val': 0.4220877132128219, 'auprc': 0.7759236864701776, 'loss_val': 1.1526064461978114, 'psi': 0.5636221025157642}
[S16] START round=8 head_norm_before_train=1.363470 (no previous merge yet)
[S16] round=8 local utility u=0.073363 metrics={'f1_val': 0.3948694439669169, 'auprc': 0.7334758112662185, 'loss_val': 0.8180017059717332, 'psi': 0.5303119908866376}-{'f1_val': 0.38504994848135876, 'auprc': 0.7108724175800538, 'loss_val': 0.8379998951057938, 'psi': 0.5153789361208367}
[S17] START round=8 head_norm_before_train=1.464431 (no previous merge yet)
[S17] round=8 local utility u=0.074183 metrics={'f1_val': 0.3555880650535054, 'auprc': 0.936497537449676, 'loss_val': 0.8229160113297666, 'psi': 0.5879518540119737}-{'f1_val': 0.35366891327616834, 'auprc': 0.916994478495055, 'loss_val': 0.9012574943947915, 'psi': 0.578999139363723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:63212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0351
[S2] DROPPED delta from S8 (cos=-0.0351 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.5436
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.0545
[S13] DROPPED delta from S6 (cos=-0.0545 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=0.9892
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.0414
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=0.8714
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9792
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] cosine check vs S4: cos=-0.0003
[S7] DROPPED delta from S4 (cos=-0.0003 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.8864
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63205
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.7482
[S2] RECEIVED delta(kind=head bytes=1797) from S17
[S2] cosine check vs S17: cos=-0.0974
[S2] DROPPED delta from S17 (cos=-0.0974 < 0.0)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.5841
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.3794 head_norm=1.137420
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.854686e-02
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.3684 head_norm=1.098622 delta_norm=0.088547
[S13] aggregate: ROLLBACK (f1_val pre=0.379 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4014 head_norm=0.742835
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.726162e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4018 head_norm=0.665784 delta_norm=0.172616
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3938 head_norm=0.627954
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.645136e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.4033 head_norm=0.526736 delta_norm=0.364514
[S3] aggregate: ACCEPT kept=['S5', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6837 head_norm=1.008920
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.628550e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6826 head_norm=1.125445 delta_norm=0.462855
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4176 head_norm=0.786970
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.162583e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4176 head_norm=0.825067 delta_norm=0.216258
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7014 head_norm=1.220756
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.474237e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.7014 head_norm=1.281448 delta_norm=0.147424
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.407643 (no previous merge yet)
[S2] round=9 local utility u=0.365948 metrics={'f1_val': 0.7121820562569285, 'auprc': 0.7790623519723916, 'loss_val': 0.6854483048616373, 'psi': 0.7389341745431137}-{'f1_val': 0.6244309643020154, 'auprc': 0.7635942841077673, 'loss_val': 0.8444341632058585, 'psi': 0.6800962922243161}
[S3] START round=9 head_norm_before_train=0.526736 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.6966941976799569, 'loss_val': 1.0418298836087507, 'psi': 0.5165114939158676}-{'f1_val': 0.39375626981913037, 'auprc': 0.7714629540943575, 'loss_val': 1.0719732072299326, 'psi': 0.5448389435292212}
[S4] START round=9 head_norm_before_train=1.125445 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.049066 metrics={'f1_val': 0.6717674903179397, 'auprc': 0.6638535341186154, 'loss_val': 0.6508202327062794, 'psi': 0.6686019078382099}-{'f1_val': 0.6836651309281447, 'auprc': 0.6644529410453097, 'loss_val': 0.8221370193313837, 'psi': 0.6759802549750107}
[S5] START round=9 head_norm_before_train=0.825067 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.037107 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.774791662234095, 'loss_val': 0.9281317534513731, 'psi': 0.5605169762734852}-{'f1_val': 0.4175873768787894, 'auprc': 0.7772093335681242, 'loss_val': 1.0091204671877634, 'psi': 0.5614361595545233}
[S6] START round=9 head_norm_before_train=1.392987 (no previous merge yet)
[S6] round=9 local utility u=0.782422 metrics={'f1_val': 0.6165691328979942, 'auprc': 0.7954451687444428, 'loss_val': 0.681996632120143, 'psi': 0.6881195472365736}-{'f1_val': 0.38859568342885287, 'auprc': 0.7649973938930996, 'loss_val': 0.7876562947694625, 'psi': 0.5391563676145517}
[S7] START round=9 head_norm_before_train=0.789258 cos_to_last_merge=0.9541 (last merge round=2)
[S7] round=9 local utility u=0.115315 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.794368483170668, 'loss_val': 0.9589125653821252, 'psi': 0.5680421854273312}-{'f1_val': 0.4166714190153544, 'auprc': 0.7545297889946415, 'loss_val': 1.0671063865645172, 'psi': 0.5518147670070692}
[S8] START round=9 head_norm_before_train=1.489686 (no previous merge yet)
[S8] round=9 local utility u=0.089049 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9986327554431599, 'loss_val': 0.37551011661250905, 'psi': 0.8281294658332445}-{'f1_val': 0.7142028940814904, 'auprc': 0.9992524678833232, 'loss_val': 0.5539207306639846, 'psi': 0.8282227236022235}
[S9] START round=9 head_norm_before_train=1.030630 cos_to_last_merge=0.8994 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=9 local utility u=0.069645 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998234583253409, 'loss_val': 0.4090211648340002, 'psi': 0.820112633932869}-{'f1_val': 0.7016148490515617, 'auprc': 0.9985366366781311, 'loss_val': 0.5507177147825608, 'psi': 0.8203835641021895}
[S10] START round=9 head_norm_before_train=1.281448 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.177001 metrics={'f1_val': 0.7013704343360756, 'auprc': 0.7364328045425302, 'loss_val': 0.7327933983942375, 'psi': 0.7153953824186574}-{'f1_val': 0.7013704343360756, 'auprc': 0.6809495290826895, 'loss_val': 0.9203448446343385, 'psi': 0.6932020722347212}
[S11] START round=9 head_norm_before_train=0.665784 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.287824 metrics={'f1_val': 0.396639232794319, 'auprc': 0.9869432690480038, 'loss_val': 0.7984864458133043, 'psi': 0.632760847295793}-{'f1_val': 0.40137695705405213, 'auprc': 0.799663905735735, 'loss_val': 0.8407236510336392, 'psi': 0.5606917365267253}
[S13] START round=9 head_norm_before_train=1.098622 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3712556504004206, 'auprc': 0.5076949264721703, 'loss_val': 1.1546544278956186, 'psi': 0.42583136082912043}-{'f1_val': 0.3793706293706294, 'auprc': 0.5065096802937463, 'loss_val': 1.0960704577048201, 'psi': 0.4302262497398761}
[S14] START round=9 head_norm_before_train=1.355523 (no previous merge yet)
[S14] round=9 local utility u=0.109867 metrics={'f1_val': 0.5266325814074985, 'auprc': 0.9949926932136675, 'loss_val': 0.616654412154625, 'psi': 0.713976626129966}-{'f1_val': 0.5191699765015638, 'auprc': 0.9688470571316962, 'loss_val': 0.7131763157793548, 'psi': 0.6990408087536168}
[S15] START round=9 head_norm_before_train=1.065786 cos_to_last_merge=0.9984 (last merge round=7)
[S15] round=9 local utility u=0.238159 metrics={'f1_val': 0.6950104632722295, 'auprc': 0.7987613649259446, 'loss_val': 0.9375949080829087, 'psi': 0.7365108239337155}-{'f1_val': 0.6447550477412233, 'auprc': 0.7777685798750095, 'loss_val': 1.0494014006375332, 'psi': 0.6979604605947378}
[S16] START round=9 head_norm_before_train=1.394203 (no previous merge yet)
[S16] round=9 local utility u=0.142769 metrics={'f1_val': 0.4311985378848725, 'auprc': 0.7435904800102243, 'loss_val': 0.7807827506720197, 'psi': 0.5561553147350132}-{'f1_val': 0.3948694439669169, 'auprc': 0.7334758112662185, 'loss_val': 0.8180017059717332, 'psi': 0.5303119908866376}
[S17] START round=9 head_norm_before_train=1.504641 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35365989610565973, 'auprc': 0.926595212481655, 'loss_val': 0.8623329787296615, 'psi': 0.5828340226560579}-{'f1_val': 0.3555880650535054, 'auprc': 0.936497537449676, 'loss_val': 0.8229160113297666, 'psi': 0.5879518540119737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63213
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4818
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.8255
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.7240
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9840
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.0369
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.0720
[S13] DROPPED delta from S6 (cos=-0.0720 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[S15] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=0.9930
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:63203
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.9436
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=-0.0309
[S2] DROPPED delta from S8 (cos=-0.0309 < 0.0)
[S5] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1790) from S5
[S3] cosine check vs S5: cos=0.7655
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.8639
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] cosine check vs S2: cos=0.3555
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.3964 head_norm=0.562301
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.329160e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6258 head_norm=0.592496 delta_norm=0.232916
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3713 head_norm=1.125058
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.730289e-02
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3668 head_norm=1.108045 delta_norm=0.067303
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6718 head_norm=1.173270
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.782721e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6712 head_norm=1.080399 delta_norm=0.278272
[S4] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.7014 head_norm=1.311008
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.292411e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.7012 head_norm=1.350259 delta_norm=0.129241
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4172 head_norm=0.816698
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.022834e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4172 head_norm=0.727034 delta_norm=0.702283
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6950 head_norm=1.094911
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.977528e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7031 head_norm=0.877929 delta_norm=0.297753
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4177 head_norm=0.865030
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.575554e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.6449 head_norm=0.909604 delta_norm=0.157555
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.444927 (no previous merge yet)
[S2] round=10 local utility u=0.040515 metrics={'f1_val': 0.6990155139584596, 'auprc': 0.7794909592998627, 'loss_val': 0.5267056993979519, 'psi': 0.731205692095021}-{'f1_val': 0.7121820562569285, 'auprc': 0.7790623519723916, 'loss_val': 0.6854483048616373, 'psi': 0.7389341745431137}
[S3] START round=10 head_norm_before_train=0.592496 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.157122 metrics={'f1_val': 0.3970957353225883, 'auprc': 0.7866403212802456, 'loss_val': 1.0016596268623308, 'psi': 0.5529135697056513}-{'f1_val': 0.39638969140647473, 'auprc': 0.6966941976799569, 'loss_val': 1.0418298836087507, 'psi': 0.5165114939158676}
[S4] START round=10 head_norm_before_train=1.080399 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.086195 metrics={'f1_val': 0.6502347877501969, 'auprc': 0.7477377501453762, 'loss_val': 0.6008867122251502, 'psi': 0.6892359727082686}-{'f1_val': 0.6717674903179397, 'auprc': 0.6638535341186154, 'loss_val': 0.6508202327062794, 'psi': 0.6686019078382099}
[S5] START round=10 head_norm_before_train=0.909604 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.023051 metrics={'f1_val': 0.4173841268229622, 'auprc': 0.7696765220391304, 'loss_val': 0.864986358326018, 'psi': 0.5583010849094295}-{'f1_val': 0.4176671856330787, 'auprc': 0.774791662234095, 'loss_val': 0.9281317534513731, 'psi': 0.5605169762734852}
[S6] START round=10 head_norm_before_train=1.429018 (no previous merge yet)
[S6] round=10 local utility u=0.044516 metrics={'f1_val': 0.6198572330627532, 'auprc': 0.7925632862507145, 'loss_val': 0.6040475751286583, 'psi': 0.6889396543379378}-{'f1_val': 0.6165691328979942, 'auprc': 0.7954451687444428, 'loss_val': 0.681996632120143, 'psi': 0.6881195472365736}
[S7] START round=10 head_norm_before_train=0.727034 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.007492 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.79451477269905, 'loss_val': 0.9424139121622805, 'psi': 0.567905388738684}-{'f1_val': 0.4171579869317734, 'auprc': 0.794368483170668, 'loss_val': 0.9589125653821252, 'psi': 0.5680421854273312}
[S8] START round=10 head_norm_before_train=1.540997 (no previous merge yet)
[S8] round=10 local utility u=0.052186 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9980191712053594, 'loss_val': 0.2692966093514525, 'psi': 0.8278840321381243}-{'f1_val': 0.714460606093301, 'auprc': 0.9986327554431599, 'loss_val': 0.37551011661250905, 'psi': 0.8281294658332445}
[S9] START round=10 head_norm_before_train=1.097952 cos_to_last_merge=0.8806 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=10 local utility u=0.034198 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982555785309364, 'loss_val': 0.3406889593785023, 'psi': 0.8201210320438801}-{'f1_val': 0.7013646677191758, 'auprc': 0.998234583253409, 'loss_val': 0.4090211648340002, 'psi': 0.820112633932869}
[S10] START round=10 head_norm_before_train=1.350259 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.382888 metrics={'f1_val': 0.6903413660108837, 'auprc': 0.9611910119295182, 'loss_val': 0.5751186004945055, 'psi': 0.7986812243783374}-{'f1_val': 0.7013704343360756, 'auprc': 0.7364328045425302, 'loss_val': 0.7327933983942375, 'psi': 0.7153953824186574}
[S11] START round=10 head_norm_before_train=0.721111 cos_to_last_merge=0.9900 (last merge round=8)
[S11] round=10 local utility u=0.536833 metrics={'f1_val': 0.5485750331089144, 'auprc': 0.9969226684557881, 'loss_val': 0.6663732307898572, 'psi': 0.7279140872476639}-{'f1_val': 0.396639232794319, 'auprc': 0.9869432690480038, 'loss_val': 0.7984864458133043, 'psi': 0.632760847295793}
[S13] START round=10 head_norm_before_train=1.108045 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3540556512894239, 'auprc': 0.46733379280483744, 'loss_val': 1.078362659850686, 'psi': 0.3993669078955893}-{'f1_val': 0.3712556504004206, 'auprc': 0.5076949264721703, 'loss_val': 1.1546544278956186, 'psi': 0.42583136082912043}
[S14] START round=10 head_norm_before_train=1.400379 (no previous merge yet)
[S14] round=10 local utility u=0.572952 metrics={'f1_val': 0.7012668323717848, 'auprc': 0.9967492482129486, 'loss_val': 0.5238254117078646, 'psi': 0.8194597987082504}-{'f1_val': 0.5266325814074985, 'auprc': 0.9949926932136675, 'loss_val': 0.616654412154625, 'psi': 0.713976626129966}
[S15] START round=10 head_norm_before_train=0.877929 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.111399 metrics={'f1_val': 0.7137448784524676, 'auprc': 0.798819059855607, 'loss_val': 0.8273762005927491, 'psi': 0.7477745510137234}-{'f1_val': 0.6950104632722295, 'auprc': 0.7987613649259446, 'loss_val': 0.9375949080829087, 'psi': 0.7365108239337155}
[S16] START round=10 head_norm_before_train=1.424420 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3402231545681844, 'auprc': 0.7611844329910197, 'loss_val': 0.7354663890301794, 'psi': 0.5086076659373185}-{'f1_val': 0.4311985378848725, 'auprc': 0.7435904800102243, 'loss_val': 0.7807827506720197, 'psi': 0.5561553147350132}
[S17] START round=10 head_norm_before_train=1.531861 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35277173603230394, 'auprc': 0.8246291968545763, 'loss_val': 0.8990610849005033, 'psi': 0.5415147203612128}-{'f1_val': 0.35365989610565973, 'auprc': 0.926595212481655, 'loss_val': 0.8623329787296615, 'psi': 0.5828340226560579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63215
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.7734
[S3] RECEIVED delta(kind=head bytes=1803) from S7
[S3] cosine check vs S7: cos=0.4651
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.5428
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.8032
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=-0.0266
[S2] DROPPED delta from S8 (cos=-0.0266 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9419
[S13] RECEIVED delta(kind=head bytes=1789) from S15
[S13] cosine check vs S15: cos=0.9775
[S5] RECEIVED delta(kind=head bytes=1790) from S9
[S5] cosine check vs S9: cos=0.7976
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.0878
[S13] DROPPED delta from S6 (cos=-0.0878 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.4421
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.7810
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9879
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3541 head_norm=1.136819
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.547060e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3525 head_norm=1.020436 delta_norm=0.154706
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.196 → S3@127.0.0.1:63203
[S14] ⇄ pheromone p=0.442 → S10@127.0.0.1:63211
[S6] ⇄ pheromone p=0.379 → S13@127.0.0.1:63213
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4174 head_norm=0.949143
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.267535e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6376 head_norm=0.983944 delta_norm=0.126754
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.236 → S3@127.0.0.1:63203
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.3971 head_norm=0.624924
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.112505e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.3335 head_norm=0.626603 delta_norm=0.211251
[S3] aggregate: ROLLBACK (f1_val pre=0.397 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.269 → S11@127.0.0.1:63212
[S8] ⇄ pheromone p=0.330 → S2@127.0.0.1:63202
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.6903 head_norm=1.383212
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.134993e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.6890 head_norm=1.407955 delta_norm=0.113499
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.427 → S5@127.0.0.1:63205
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7137 head_norm=0.915472
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.588060e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7151 head_norm=0.836982 delta_norm=0.158806
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.353 → S13@127.0.0.1:63213
[S9] ⇄ pheromone p=0.261 → S5@127.0.0.1:63205
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4168 head_norm=0.755533
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.642604e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4168 head_norm=0.891529 delta_norm=0.364260
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.249 → S3@127.0.0.1:63203
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6502 head_norm=1.133221
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.440577e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3790 head_norm=1.151951 delta_norm=0.644058
[S4] aggregate: ROLLBACK (f1_val pre=0.650 post=0.379 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.296 → S7@127.0.0.1:63208
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.5486 head_norm=0.783215
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.778779e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.4410 head_norm=0.599322 delta_norm=0.377878
[S11] aggregate: ROLLBACK (f1_val pre=0.549 post=0.441 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.386 → S15@127.0.0.1:63215
[S2] ⇄ pheromone p=0.346 → S4@127.0.0.1:63204
[S16] ⇄ pheromone p=0.207 → S4@127.0.0.1:63204
[S17] ⇄ pheromone p=0.212 → S2@127.0.0.1:63202
[S2] START round=11 head_norm_before_train=1.483042 (no previous merge yet)
[S2] round=11 local utility u=0.043130 metrics={'f1_val': 0.7116962920071813, 'auprc': 0.7782127238192136, 'loss_val': 0.5126952863640073, 'psi': 0.7383028647319942}-{'f1_val': 0.6990155139584596, 'auprc': 0.7794909592998627, 'loss_val': 0.5267056993979519, 'psi': 0.731205692095021}
[S3] START round=11 head_norm_before_train=0.626603 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.067232 metrics={'f1_val': 0.3978001223979562, 'auprc': 0.8252736597270063, 'loss_val': 0.9873216500162336, 'psi': 0.5687895373295763}-{'f1_val': 0.3970957353225883, 'auprc': 0.7866403212802456, 'loss_val': 1.0016596268623308, 'psi': 0.5529135697056513}
[S4] START round=11 head_norm_before_train=1.151951 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.232631 metrics={'f1_val': 0.6673528553827899, 'auprc': 0.8563384018230781, 'loss_val': 0.5641350123997567, 'psi': 0.7429470739589051}-{'f1_val': 0.6502347877501969, 'auprc': 0.7477377501453762, 'loss_val': 0.6008867122251502, 'psi': 0.6892359727082686}
[S5] START round=11 head_norm_before_train=0.983944 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.668267 metrics={'f1_val': 0.6263511516029949, 'auprc': 0.7635803502921199, 'loss_val': 0.7639656007285118, 'psi': 0.6812428310786449}-{'f1_val': 0.4173841268229622, 'auprc': 0.7696765220391304, 'loss_val': 0.864986358326018, 'psi': 0.5583010849094295}
[S6] START round=11 head_norm_before_train=1.469058 (no previous merge yet)
[S6] round=11 local utility u=0.332940 metrics={'f1_val': 0.7103034527822595, 'auprc': 0.7919532277744764, 'loss_val': 0.4790141888032892, 'psi': 0.7429633627791463}-{'f1_val': 0.6198572330627532, 'auprc': 0.7925632862507145, 'loss_val': 0.6040475751286583, 'psi': 0.6889396543379378}
[S7] START round=11 head_norm_before_train=0.891529 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.005679 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7926486924618605, 'loss_val': 0.92545766836046, 'psi': 0.5671589566438082}-{'f1_val': 0.41683246609844005, 'auprc': 0.79451477269905, 'loss_val': 0.9424139121622805, 'psi': 0.567905388738684}
[S8] START round=11 head_norm_before_train=1.585946 (no previous merge yet)
[S8] round=11 local utility u=0.812146 metrics={'f1_val': 0.9713909598719446, 'auprc': 0.9979843881637055, 'loss_val': 0.18648307088857882, 'psi': 0.9820283311886489}-{'f1_val': 0.714460606093301, 'auprc': 0.9980191712053594, 'loss_val': 0.2692966093514525, 'psi': 0.8278840321381243}
[S9] START round=11 head_norm_before_train=1.160937 cos_to_last_merge=0.8629 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.863
[S9] round=11 local utility u=0.019258 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982197672603192, 'loss_val': 0.30206604021775146, 'psi': 0.8201067075356332}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982555785309364, 'loss_val': 0.3406889593785023, 'psi': 0.8201210320438801}
[S10] START round=11 head_norm_before_train=1.407955 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.041284 metrics={'f1_val': 0.6795600600435412, 'auprc': 0.9821340757070406, 'loss_val': 0.49069243559117925, 'psi': 0.8005896663089409}-{'f1_val': 0.6903413660108837, 'auprc': 0.9611910119295182, 'loss_val': 0.5751186004945055, 'psi': 0.7986812243783374}
[S11] START round=11 head_norm_before_train=0.599322 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.4477789745440496, 'auprc': 0.9974031845535026, 'loss_val': 0.7372047182793268, 'psi': 0.6676286585478308}-{'f1_val': 0.5485750331089144, 'auprc': 0.9969226684557881, 'loss_val': 0.6663732307898572, 'psi': 0.7279140872476639}
[S13] START round=11 head_norm_before_train=1.020436 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.050877 metrics={'f1_val': 0.34706653047445474, 'auprc': 0.4998981512995418, 'loss_val': 1.0323660787642517, 'psi': 0.4081991788044895}-{'f1_val': 0.3540556512894239, 'auprc': 0.46733379280483744, 'loss_val': 1.078362659850686, 'psi': 0.3993669078955893}
[S14] START round=11 head_norm_before_train=1.441236 (no previous merge yet)
[S14] round=11 local utility u=0.926400 metrics={'f1_val': 0.9965988080835264, 'auprc': 0.9966832355981363, 'loss_val': 0.44282012793609804, 'psi': 0.9966325790893704}-{'f1_val': 0.7012668323717848, 'auprc': 0.9967492482129486, 'loss_val': 0.5238254117078646, 'psi': 0.8194597987082504}
[S15] START round=11 head_norm_before_train=0.836982 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6948913291668561, 'auprc': 0.7994666083202553, 'loss_val': 0.7714403195285963, 'psi': 0.7367214408282159}-{'f1_val': 0.7137448784524676, 'auprc': 0.798819059855607, 'loss_val': 0.8273762005927491, 'psi': 0.7477745510137234}
[S16] START round=11 head_norm_before_train=1.458386 (no previous merge yet)
[S16] round=11 local utility u=0.195661 metrics={'f1_val': 0.40597163455104507, 'auprc': 0.7491277984127639, 'loss_val': 0.7024654717714705, 'psi': 0.5432341000957326}-{'f1_val': 0.3402231545681844, 'auprc': 0.7611844329910197, 'loss_val': 0.7354663890301794, 'psi': 0.5086076659373185}
[S17] START round=11 head_norm_before_train=1.555039 (no previous merge yet)
[S17] round=11 local utility u=0.004176 metrics={'f1_val': 0.35501608239204374, 'auprc': 0.8158708515662714, 'loss_val': 0.8778999654200489, 'psi': 0.5393579900617348}-{'f1_val': 0.35277173603230394, 'auprc': 0.8246291968545763, 'loss_val': 0.8990610849005033, 'psi': 0.5415147203612128}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S9] → sending delta(kind=head bytes=1785) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:63203
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1785 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.7579
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.8076
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.0997
[S13] DROPPED delta from S6 (cos=-0.0997 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1785) from S9
[S5] cosine check vs S9: cos=0.7856
[S11] RECEIVED delta(kind=head bytes=1806) from S3
[S11] cosine check vs S3: cos=0.6787
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0237
[S2] DROPPED delta from S8 (cos=-0.0237 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.4703
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.8180
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=0.8910
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1789 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1789) from S13
[S3] cosine check vs S13: cos=0.1841
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9913
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] cosine check vs S16: cos=0.4920
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S17
[S2] cosine check vs S17: cos=-0.0798
[S2] DROPPED delta from S17 (cos=-0.0798 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6796 head_norm=1.442994
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.826299e-02
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6791 head_norm=1.458042 delta_norm=0.098263
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4168 head_norm=0.916296
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.901186e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4168 head_norm=0.991272 delta_norm=0.390119
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.3978 head_norm=0.658111
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.935660e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.3338 head_norm=0.615633 delta_norm=0.193566
[S3] aggregate: ROLLBACK (f1_val pre=0.398 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6674 head_norm=1.195837
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.980431e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6678 head_norm=1.136915 delta_norm=0.198043
[S4] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6264 head_norm=1.020235
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.062699e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7006 head_norm=1.045886 delta_norm=0.106270
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.4478 head_norm=0.655256
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.632179e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.3966 head_norm=0.601624 delta_norm=0.263218
[S11] aggregate: ROLLBACK (f1_val pre=0.448 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.526325 (no previous merge yet)
[S2] round=12 local utility u=0.038644 metrics={'f1_val': 0.6987599498280124, 'auprc': 0.7918772516486594, 'loss_val': 0.3987818399566968, 'psi': 0.7360068705562712}-{'f1_val': 0.7116962920071813, 'auprc': 0.7782127238192136, 'loss_val': 0.5126952863640073, 'psi': 0.7383028647319942}
[S3] START round=12 head_norm_before_train=0.615633 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.221428 metrics={'f1_val': 0.4675951021021954, 'auprc': 0.822155498502799, 'loss_val': 0.9538806758249868, 'psi': 0.6094192606624369}-{'f1_val': 0.3978001223979562, 'auprc': 0.8252736597270063, 'loss_val': 0.9873216500162336, 'psi': 0.5687895373295763}
[S4] START round=12 head_norm_before_train=1.136915 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6688573363668389, 'auprc': 0.6598957434919759, 'loss_val': 0.5167238021744699, 'psi': 0.6652726992168937}-{'f1_val': 0.6673528553827899, 'auprc': 0.8563384018230781, 'loss_val': 0.5641350123997567, 'psi': 0.7429470739589051}
[S5] START round=12 head_norm_before_train=1.045886 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.581325 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.9594898153691303, 'loss_val': 0.6343569668572363, 'psi': 0.8041378869774178}-{'f1_val': 0.6263511516029949, 'auprc': 0.7635803502921199, 'loss_val': 0.7639656007285118, 'psi': 0.6812428310786449}
[S6] START round=12 head_norm_before_train=1.514045 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7090951279100618, 'auprc': 0.7900057891192434, 'loss_val': 0.47051175816968005, 'psi': 0.7414593923937345}-{'f1_val': 0.7103034527822595, 'auprc': 0.7919532277744764, 'loss_val': 0.4790141888032892, 'psi': 0.7429633627791463}
[S7] START round=12 head_norm_before_train=0.991272 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.004362 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.791980295262595, 'loss_val': 0.914728520619412, 'psi': 0.566891597764102}-{'f1_val': 0.41683246609844005, 'auprc': 0.7926486924618605, 'loss_val': 0.92545766836046, 'psi': 0.5671589566438082}
[S8] START round=12 head_norm_before_train=1.625158 (no previous merge yet)
[S8] round=12 local utility u=0.088302 metrics={'f1_val': 0.9942359932363742, 'auprc': 0.9987137665571811, 'loss_val': 0.1491372692352652, 'psi': 0.996027102564697}-{'f1_val': 0.9713909598719446, 'auprc': 0.9979843881637055, 'loss_val': 0.18648307088857882, 'psi': 0.9820283311886489}
[S9] START round=12 head_norm_before_train=1.218045 cos_to_last_merge=0.8477 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.848
[S9] round=12 local utility u=0.006539 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982313794276296, 'loss_val': 0.28857858724657104, 'psi': 0.8200668418955899}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982197672603192, 'loss_val': 0.30206604021775146, 'psi': 0.8201067075356332}
[S10] START round=12 head_norm_before_train=1.458042 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.058045 metrics={'f1_val': 0.686259893937312, 'auprc': 0.9790445389874238, 'loss_val': 0.40553326643901055, 'psi': 0.8033737519573567}-{'f1_val': 0.6795600600435412, 'auprc': 0.9821340757070406, 'loss_val': 0.49069243559117925, 'psi': 0.8005896663089409}
[S11] START round=12 head_norm_before_train=0.601624 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.248624 metrics={'f1_val': 0.5493203320863632, 'auprc': 0.9758040239813169, 'loss_val': 0.7844066872138348, 'psi': 0.7199138088443447}-{'f1_val': 0.4477789745440496, 'auprc': 0.9974031845535026, 'loss_val': 0.7372047182793268, 'psi': 0.6676286585478308}
[S13] START round=12 head_norm_before_train=1.053679 cos_to_last_merge=0.9983 (last merge round=10)
[S13] round=12 local utility u=0.600914 metrics={'f1_val': 0.5166702831848052, 'auprc': 0.5246709072767434, 'loss_val': 0.9224789568282372, 'psi': 0.5198705328215805}-{'f1_val': 0.34706653047445474, 'auprc': 0.4998981512995418, 'loss_val': 1.0323660787642517, 'psi': 0.4081991788044895}
[S14] START round=12 head_norm_before_train=1.479476 (no previous merge yet)
[S14] round=12 local utility u=0.064072 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9971456522131028, 'loss_val': 0.32396753812750084, 'psi': 0.9976079663677854}-{'f1_val': 0.9965988080835264, 'auprc': 0.9966832355981363, 'loss_val': 0.44282012793609804, 'psi': 0.9966325790893704}
[S15] START round=12 head_norm_before_train=0.876876 cos_to_last_merge=0.9970 (last merge round=10)
[S15] round=12 local utility u=0.111645 metrics={'f1_val': 0.7037210630711284, 'auprc': 0.7996264889566826, 'loss_val': 0.6016082864445662, 'psi': 0.7420832334253501}-{'f1_val': 0.6948913291668561, 'auprc': 0.7994666083202553, 'loss_val': 0.7714403195285963, 'psi': 0.7367214408282159}
[S16] START round=12 head_norm_before_train=1.496479 (no previous merge yet)
[S16] round=12 local utility u=0.457122 metrics={'f1_val': 0.5486614920958275, 'auprc': 0.7693451037963944, 'loss_val': 0.7050124066409311, 'psi': 0.6369349367760542}-{'f1_val': 0.40597163455104507, 'auprc': 0.7491277984127639, 'loss_val': 0.7024654717714705, 'psi': 0.5432341000957326}
[S17] START round=12 head_norm_before_train=1.573486 (no previous merge yet)
[S17] round=12 local utility u=0.059159 metrics={'f1_val': 0.36724007212689685, 'auprc': 0.816697314543235, 'loss_val': 0.8354053751287246, 'psi': 0.5470229690934321}-{'f1_val': 0.35501608239204374, 'auprc': 0.8158708515662714, 'loss_val': 0.8778999654200489, 'psi': 0.5393579900617348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63215
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:63213
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.4439
[S5] RECEIVED delta(kind=head bytes=1790) from S9
[S5] cosine check vs S9: cos=0.7813
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9927
[S3] RECEIVED delta(kind=head bytes=1794) from S13
[S3] cosine check vs S13: cos=0.3641
[S15] RECEIVED delta(kind=head bytes=1795) from S11
[S15] cosine check vs S11: cos=0.6864
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=-0.0201
[S2] DROPPED delta from S8 (cos=-0.0201 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[S15] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S15
[S13] cosine check vs S15: cos=0.9595
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63205
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.6230
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:63202
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8200
[S2] RECEIVED delta(kind=head bytes=1804) from S17
[S2] cosine check vs S17: cos=-0.0751
[S2] DROPPED delta from S17 (cos=-0.0751 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.7780
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.8110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:63212
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9037
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6689 head_norm=1.186825
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.260994e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6689 head_norm=1.156197 delta_norm=0.126099
[S4] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.5493 head_norm=0.652704
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.430577e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.3966 head_norm=0.636128 delta_norm=0.143058
[S11] aggregate: ROLLBACK (f1_val pre=0.549 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5167 head_norm=1.089294
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.643564e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.4037 head_norm=0.998079 delta_norm=0.164356
[S13] aggregate: ROLLBACK (f1_val pre=0.517 post=0.404 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=1.080751
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.102228e-02
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.098605 delta_norm=0.091022
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.4676 head_norm=0.651327
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.633227e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.3335 head_norm=0.635316 delta_norm=0.163323
[S3] aggregate: ROLLBACK (f1_val pre=0.468 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6863 head_norm=1.496930
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.215132e-02
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.6802 head_norm=1.506802 delta_norm=0.092151
[S10] aggregate: ROLLBACK (f1_val pre=0.686 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7037 head_norm=0.927249
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.372734e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7051 head_norm=0.727429 delta_norm=0.337273
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.562823 (no previous merge yet)
[S2] round=13 local utility u=0.021419 metrics={'f1_val': 0.7103354414353142, 'auprc': 0.7918666226574285, 'loss_val': 0.4253648919541843, 'psi': 0.7429479139241599}-{'f1_val': 0.6987599498280124, 'auprc': 0.7918772516486594, 'loss_val': 0.3987818399566968, 'psi': 0.7360068705562712}
[S3] START round=13 head_norm_before_train=0.635316 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.261789 metrics={'f1_val': 0.5534034439547144, 'auprc': 0.8139184670078593, 'loss_val': 0.9204421191059277, 'psi': 0.6576094531759724}-{'f1_val': 0.4675951021021954, 'auprc': 0.822155498502799, 'loss_val': 0.9538806758249868, 'psi': 0.6094192606624369}
[S4] START round=13 head_norm_before_train=1.156197 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.014421 metrics={'f1_val': 0.6683564446678976, 'auprc': 0.6588001402106051, 'loss_val': 0.48158983868730704, 'psi': 0.6645339228849806}-{'f1_val': 0.6688573363668389, 'auprc': 0.6598957434919759, 'loss_val': 0.5167238021744699, 'psi': 0.6652726992168937}
[S5] START round=13 head_norm_before_train=1.098605 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8748122707978173, 'loss_val': 0.5655336188630272, 'psi': 0.7702664014252851}-{'f1_val': 0.7005699347162762, 'auprc': 0.9594898153691303, 'loss_val': 0.6343569668572363, 'psi': 0.8041378869774178}
[S6] START round=13 head_norm_before_train=1.554181 (no previous merge yet)
[S6] round=13 local utility u=0.309498 metrics={'f1_val': 0.7078471678841252, 'auprc': 0.9626514092653986, 'loss_val': 0.3619643855702564, 'psi': 0.8097688644366345}-{'f1_val': 0.7090951279100618, 'auprc': 0.7900057891192434, 'loss_val': 0.47051175816968005, 'psi': 0.7414593923937345}
[S7] START round=13 head_norm_before_train=1.010185 cos_to_last_merge=0.9956 (last merge round=11)
[S7] round=13 local utility u=0.022875 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7895745168825022, 'loss_val': 0.8610272010926463, 'psi': 0.565855877619615}-{'f1_val': 0.41683246609844005, 'auprc': 0.791980295262595, 'loss_val': 0.914728520619412, 'psi': 0.566891597764102}
[S8] START round=13 head_norm_before_train=1.659304 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9979853064272708, 'loss_val': 0.2754038626972663, 'psi': 0.8277375858096059}-{'f1_val': 0.9942359932363742, 'auprc': 0.9987137665571811, 'loss_val': 0.1491372692352652, 'psi': 0.996027102564697}
[S9] START round=13 head_norm_before_train=1.267980 cos_to_last_merge=0.8359 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.836
[S9] round=13 local utility u=0.012407 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984261458809546, 'loss_val': 0.2643483506714981, 'psi': 0.8201447484769199}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982313794276296, 'loss_val': 0.28857858724657104, 'psi': 0.8200668418955899}
[S10] START round=13 head_norm_before_train=1.506802 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6606480461072903, 'auprc': 0.9781120215180369, 'loss_val': 0.46016364174623586, 'psi': 0.787633636271589}-{'f1_val': 0.686259893937312, 'auprc': 0.9790445389874238, 'loss_val': 0.40553326643901055, 'psi': 0.8033737519573567}
[S11] START round=13 head_norm_before_train=0.636128 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.001502 metrics={'f1_val': 0.5508367266264811, 'auprc': 0.956401172165118, 'loss_val': 0.732293464011376, 'psi': 0.7130625048419359}-{'f1_val': 0.5493203320863632, 'auprc': 0.9758040239813169, 'loss_val': 0.7844066872138348, 'psi': 0.7199138088443447}
[S13] START round=13 head_norm_before_train=0.998079 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.496954 metrics={'f1_val': 0.5602221943074365, 'auprc': 0.7326984880498558, 'loss_val': 0.8139653457198899, 'psi': 0.6292127118044042}-{'f1_val': 0.5166702831848052, 'auprc': 0.5246709072767434, 'loss_val': 0.9224789568282372, 'psi': 0.5198705328215805}
[S14] START round=13 head_norm_before_train=1.522199 (no previous merge yet)
[S14] round=13 local utility u=0.037030 metrics={'f1_val': 0.9954619835403262, 'auprc': 0.99715837487165, 'loss_val': 0.235219624923114, 'psi': 0.9961405400728557}-{'f1_val': 0.9979161758042404, 'auprc': 0.9971456522131028, 'loss_val': 0.32396753812750084, 'psi': 0.9976079663677854}
[S15] START round=13 head_norm_before_train=0.727429 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.050401 metrics={'f1_val': 0.69682510158281, 'auprc': 0.8407609295240999, 'loss_val': 0.5828331450944237, 'psi': 0.754399432759326}-{'f1_val': 0.7037210630711284, 'auprc': 0.7996264889566826, 'loss_val': 0.6016082864445662, 'psi': 0.7420832334253501}
[S16] START round=13 head_norm_before_train=1.538358 (no previous merge yet)
[S16] round=13 local utility u=0.036115 metrics={'f1_val': 0.5530865149209893, 'auprc': 0.7862902912333285, 'loss_val': 0.7101686993156262, 'psi': 0.646368025445925}-{'f1_val': 0.5486614920958275, 'auprc': 0.7693451037963944, 'loss_val': 0.7050124066409311, 'psi': 0.6369349367760542}
[S17] START round=13 head_norm_before_train=1.584954 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.37828117367334146, 'auprc': 0.7521233655794741, 'loss_val': 0.7789161133714718, 'psi': 0.5278180504357946}-{'f1_val': 0.36724007212689685, 'auprc': 0.816697314543235, 'loss_val': 0.8354053751287246, 'psi': 0.5470229690934321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4924
[S4] RECEIVED delta(kind=head bytes=1804) from S2
[S4] cosine check vs S2: cos=0.7648
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.9383
[S13] RECEIVED delta(kind=head bytes=1803) from S6
[S13] cosine check vs S6: cos=-0.1143
[S13] DROPPED delta from S6 (cos=-0.1143 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S3@127.0.0.1:63203
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.8377
[S13] sending update (kind=head size=1788 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1788) from S13
[S3] cosine check vs S13: cos=0.5046
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:63208
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S15
[S13] cosine check vs S15: cos=0.9139
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:63204
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=0.9485
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=0.6823
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.7797
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9940
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7006 head_norm=1.129899
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.124031e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.148769 delta_norm=0.412403
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.5534 head_norm=0.671978
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.614830e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.6955 head_norm=0.644538 delta_norm=0.261483
[S3] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=1.036940
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.981610e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=1.106542 delta_norm=0.198161
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6606 head_norm=1.543917
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.592465e-02
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6849 head_norm=1.552515 delta_norm=0.085925
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.5508 head_norm=0.686552
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.194752e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.5585 head_norm=0.668715 delta_norm=0.119475
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6684 head_norm=1.205055
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.007428e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6684 head_norm=1.181233 delta_norm=0.100743
[S4] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5602 head_norm=1.035081
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.248717e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5555 head_norm=0.890991 delta_norm=0.224872
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6968 head_norm=0.785794
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.150588e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6970 head_norm=0.705807 delta_norm=0.215059
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.597430 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7112532734571527, 'auprc': 0.783272148516664, 'loss_val': 0.5890748316131421, 'psi': 0.7400608234809573}-{'f1_val': 0.7103354414353142, 'auprc': 0.7918666226574285, 'loss_val': 0.4253648919541843, 'psi': 0.7429479139241599}
[S3] START round=14 head_norm_before_train=0.644538 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.3920032758207499, 'auprc': 0.7572609316344758, 'loss_val': 0.9687717224130804, 'psi': 0.5381063381462403}-{'f1_val': 0.5534034439547144, 'auprc': 0.8139184670078593, 'loss_val': 0.9204421191059277, 'psi': 0.6576094531759724}
[S4] START round=14 head_norm_before_train=1.181233 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.266808 metrics={'f1_val': 0.6666549537306822, 'auprc': 0.83673983291723, 'loss_val': 0.4715838340190231, 'psi': 0.7346889054053013}-{'f1_val': 0.6683564446678976, 'auprc': 0.6588001402106051, 'loss_val': 0.48158983868730704, 'psi': 0.6645339228849806}
[S5] START round=14 head_norm_before_train=1.148769 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7845868382587252, 'loss_val': 0.5324583880849072, 'psi': 0.7340270943983055}-{'f1_val': 0.7005691551769304, 'auprc': 0.8748122707978173, 'loss_val': 0.5655336188630272, 'psi': 0.7702664014252851}
[S6] START round=14 head_norm_before_train=1.588567 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7072167379149058, 'auprc': 0.9435576140886242, 'loss_val': 0.35791088439385105, 'psi': 0.8017530883843932}-{'f1_val': 0.7078471678841252, 'auprc': 0.9626514092653986, 'loss_val': 0.3619643855702564, 'psi': 0.8097688644366345}
[S7] START round=14 head_norm_before_train=1.106542 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7842667512209651, 'loss_val': 0.8622281767272718, 'psi': 0.5637327713550001}-{'f1_val': 0.41671011811102343, 'auprc': 0.7895745168825022, 'loss_val': 0.8610272010926463, 'psi': 0.565855877619615}
[S8] START round=14 head_norm_before_train=1.692502 (no previous merge yet)
[S8] round=14 local utility u=0.904322 metrics={'f1_val': 0.9892815050191147, 'auprc': 0.9985674508182312, 'loss_val': 0.11876110080061715, 'psi': 0.9929958833387613}-{'f1_val': 0.7142391053978291, 'auprc': 0.9979853064272708, 'loss_val': 0.2754038626972663, 'psi': 0.8277375858096059}
[S9] START round=14 head_norm_before_train=1.304922 cos_to_last_merge=0.8262 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=14 local utility u=0.016115 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981308087525886, 'loss_val': 0.23078990939155483, 'psi': 0.8199822719650466}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984261458809546, 'loss_val': 0.2643483506714981, 'psi': 0.8201447484769199}
[S10] START round=14 head_norm_before_train=1.552515 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=1.000000 metrics={'f1_val': 0.9795634185008993, 'auprc': 0.9915671097502946, 'loss_val': 0.257914293057133, 'psi': 0.9843648950006574}-{'f1_val': 0.6606480461072903, 'auprc': 0.9781120215180369, 'loss_val': 0.46016364174623586, 'psi': 0.787633636271589}
[S11] START round=14 head_norm_before_train=0.668715 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.462816 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9395843451188378, 'loss_val': 0.6613517508259217, 'psi': 0.7968498257996901}-{'f1_val': 0.5508367266264811, 'auprc': 0.956401172165118, 'loss_val': 0.732293464011376, 'psi': 0.7130625048419359}
[S13] START round=14 head_norm_before_train=0.890991 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5285640330722845, 'auprc': 0.6182821809180838, 'loss_val': 0.8733786294500859, 'psi': 0.5644512922106042}-{'f1_val': 0.5602221943074365, 'auprc': 0.7326984880498558, 'loss_val': 0.8139653457198899, 'psi': 0.6292127118044042}
[S14] START round=14 head_norm_before_train=1.565789 (no previous merge yet)
[S14] round=14 local utility u=0.030645 metrics={'f1_val': 0.9979187620675374, 'auprc': 0.9971576941194819, 'loss_val': 0.1886678974345245, 'psi': 0.9976143348883151}-{'f1_val': 0.9954619835403262, 'auprc': 0.99715837487165, 'loss_val': 0.235219624923114, 'psi': 0.9961405400728557}
[S15] START round=14 head_norm_before_train=0.705807 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.154878 metrics={'f1_val': 0.699346973499265, 'auprc': 0.9291198824559177, 'loss_val': 0.5532862138647209, 'psi': 0.791256137081926}-{'f1_val': 0.69682510158281, 'auprc': 0.8407609295240999, 'loss_val': 0.5828331450944237, 'psi': 0.754399432759326}
[S16] START round=14 head_norm_before_train=1.578681 (no previous merge yet)
[S16] round=14 local utility u=0.215318 metrics={'f1_val': 0.5729943327283898, 'auprc': 0.8417622099844774, 'loss_val': 0.5653957934254772, 'psi': 0.6805014836308249}-{'f1_val': 0.5530865149209893, 'auprc': 0.7862902912333285, 'loss_val': 0.7101686993156262, 'psi': 0.646368025445925}
[S17] START round=14 head_norm_before_train=1.596321 (no previous merge yet)
[S17] round=14 local utility u=0.042974 metrics={'f1_val': 0.384999397036687, 'auprc': 0.748449512450808, 'loss_val': 0.7222556749697265, 'psi': 0.5303794432023354}-{'f1_val': 0.37828117367334146, 'auprc': 0.7521233655794741, 'loss_val': 0.7789161133714718, 'psi': 0.5278180504357946}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:63214
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9178
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.7437
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9952
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.9246
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7113 head_norm=1.631782
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.455075e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7116 head_norm=1.336842 delta_norm=0.545507
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.3920 head_norm=0.683219
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.440301e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.3919 head_norm=0.689128 delta_norm=0.144030
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9979 head_norm=1.603968
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.887452e-02
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9979 head_norm=1.592519 delta_norm=0.078875
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.724220
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.464104e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.731889 delta_norm=0.146410
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.336842 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.066246 metrics={'f1_val': 0.7006386570678014, 'auprc': 0.7925879837338962, 'loss_val': 0.42084213263912784, 'psi': 0.7374183877342393}-{'f1_val': 0.7112532734571527, 'auprc': 0.783272148516664, 'loss_val': 0.5890748316131421, 'psi': 0.7400608234809573}
[S3] START round=15 head_norm_before_train=0.689128 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.206624 metrics={'f1_val': 0.39161052266070295, 'auprc': 0.8527945349291619, 'loss_val': 0.8397685904914829, 'psi': 0.5760841275680866}-{'f1_val': 0.3920032758207499, 'auprc': 0.7572609316344758, 'loss_val': 0.9687717224130804, 'psi': 0.5381063381462403}
[S4] START round=15 head_norm_before_train=1.227492 cos_to_last_merge=0.9980 (last merge round=13)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6680581340068477, 'auprc': 0.6617150708272264, 'loss_val': 0.45665992777876774, 'psi': 0.6655209087349991}-{'f1_val': 0.6666549537306822, 'auprc': 0.83673983291723, 'loss_val': 0.4715838340190231, 'psi': 0.7346889054053013}
[S5] START round=15 head_norm_before_train=1.182411 cos_to_last_merge=0.9987 (last merge round=13)
[S5] round=15 local utility u=0.155921 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8580083049513558, 'loss_val': 0.4408804441328934, 'psi': 0.7633956810753577}-{'f1_val': 0.700320598491359, 'auprc': 0.7845868382587252, 'loss_val': 0.5324583880849072, 'psi': 0.7340270943983055}
[S6] START round=15 head_norm_before_train=1.615689 (no previous merge yet)
[S6] round=15 local utility u=0.687387 metrics={'f1_val': 0.9141447176014366, 'auprc': 0.956355826557966, 'loss_val': 0.2630990150914273, 'psi': 0.9310291611840483}-{'f1_val': 0.7072167379149058, 'auprc': 0.9435576140886242, 'loss_val': 0.35791088439385105, 'psi': 0.8017530883843932}
[S7] START round=15 head_norm_before_train=1.128821 cos_to_last_merge=0.9980 (last merge round=13)
[S7] round=15 local utility u=0.010075 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7809540490664246, 'loss_val': 0.8321394366264028, 'psi': 0.5624076904931838}-{'f1_val': 0.41671011811102343, 'auprc': 0.7842667512209651, 'loss_val': 0.8622281767272718, 'psi': 0.5637327713550001}
[S8] START round=15 head_norm_before_train=1.717360 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9862211113266615, 'auprc': 0.9986252013020569, 'loss_val': 0.12621512158813925, 'psi': 0.9911827473168197}-{'f1_val': 0.9892815050191147, 'auprc': 0.9985674508182312, 'loss_val': 0.11876110080061715, 'psi': 0.9929958833387613}
[S9] START round=15 head_norm_before_train=1.336861 cos_to_last_merge=0.8181 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.818
[S9] round=15 local utility u=0.021445 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979258163572713, 'loss_val': 0.18728480535929795, 'psi': 0.8199002750069196}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981308087525886, 'loss_val': 0.23078990939155483, 'psi': 0.8199822719650466}
[S10] START round=15 head_norm_before_train=1.584918 cos_to_last_merge=0.9994 (last merge round=13)
[S10] round=15 local utility u=0.056823 metrics={'f1_val': 0.9891606012210763, 'auprc': 0.9922573109942143, 'loss_val': 0.20392172293838565, 'psi': 0.9903992851303316}-{'f1_val': 0.9795634185008993, 'auprc': 0.9915671097502946, 'loss_val': 0.257914293057133, 'psi': 0.9843648950006574}
[S11] START round=15 head_norm_before_train=0.731889 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.154687 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9904626500568885, 'loss_val': 0.5046123717563538, 'psi': 0.8172011477749104}-{'f1_val': 0.7016934795869249, 'auprc': 0.9395843451188378, 'loss_val': 0.6613517508259217, 'psi': 0.7968498257996901}
[S13] START round=15 head_norm_before_train=0.923432 cos_to_last_merge=0.9982 (last merge round=13)
[S13] round=15 local utility u=0.473643 metrics={'f1_val': 0.6138468495008802, 'auprc': 0.7078208159365169, 'loss_val': 0.7064048771310585, 'psi': 0.6514364360751349}-{'f1_val': 0.5285640330722845, 'auprc': 0.6182821809180838, 'loss_val': 0.8733786294500859, 'psi': 0.5644512922106042}
[S14] START round=15 head_norm_before_train=1.592519 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.015429 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9971578766252845, 'loss_val': 0.15622097357668593, 'psi': 0.9974554563396874}-{'f1_val': 0.9979187620675374, 'auprc': 0.9971576941194819, 'loss_val': 0.1886678974345245, 'psi': 0.9976143348883151}
[S15] START round=15 head_norm_before_train=0.767920 cos_to_last_merge=0.9940 (last merge round=13)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6961120390300846, 'auprc': 0.8355880484056035, 'loss_val': 0.4859459462072084, 'psi': 0.7519024427802922}-{'f1_val': 0.699346973499265, 'auprc': 0.9291198824559177, 'loss_val': 0.5532862138647209, 'psi': 0.791256137081926}
[S16] START round=15 head_norm_before_train=1.610793 (no previous merge yet)
[S16] round=15 local utility u=0.820340 metrics={'f1_val': 0.8131402161427913, 'auprc': 0.8831559291985829, 'loss_val': 0.4897718796463645, 'psi': 0.8411465013651079}-{'f1_val': 0.5729943327283898, 'auprc': 0.8417622099844774, 'loss_val': 0.5653957934254772, 'psi': 0.6805014836308249}
[S17] START round=15 head_norm_before_train=1.607938 (no previous merge yet)
[S17] round=15 local utility u=0.054824 metrics={'f1_val': 0.3918971723647105, 'auprc': 0.7595336521898074, 'loss_val': 0.687246476867745, 'psi': 0.5389517642947492}-{'f1_val': 0.384999397036687, 'auprc': 0.748449512450808, 'loss_val': 0.7222556749697265, 'psi': 0.5303794432023354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:63207
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S10] → sending delta(kind=head bytes=1810) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1810 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S13
[S6] cosine check vs S13: cos=-0.1216
[S6] DROPPED delta from S13 (cos=-0.1216 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9382
[S14] RECEIVED delta(kind=head bytes=1810) from S10
[S14] cosine check vs S10: cos=0.9959
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0177
[S8] DROPPED delta from S2 (cos=-0.0177 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9628
[S10] RECEIVED delta(kind=head bytes=1792) from S5
[S10] cosine check vs S5: cos=0.5799
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] cosine check vs S3: cos=0.4523
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.3916 head_norm=0.739898
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.391592e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.3916 head_norm=0.759486 delta_norm=0.139159
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.191 → S7@127.0.0.1:63208
[S2] ⇄ pheromone p=0.137 → S8@127.0.0.1:63209
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9892 head_norm=1.615644
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.727275e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9896 head_norm=1.261505 delta_norm=0.672728
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.321 → S14@127.0.0.1:63214
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9977 head_norm=1.627053
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.350940e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9972 head_norm=1.619691 delta_norm=0.073509
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.240 → S10@127.0.0.1:63211
[S8] ⇄ pheromone p=0.328 → S2@127.0.0.1:63202
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6681 head_norm=1.271585
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.758023e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6681 head_norm=1.199796 delta_norm=0.175802
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.160 → S2@127.0.0.1:63202
[S13] ⇄ pheromone p=0.288 → S6@127.0.0.1:63207
[S5] ⇄ pheromone p=0.223 → S10@127.0.0.1:63211
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4167 head_norm=1.150610
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.247086e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4167 head_norm=0.812624 delta_norm=0.524709
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.087 → S4@127.0.0.1:63204
[S15] ⇄ pheromone p=0.158 → S11@127.0.0.1:63212
[S6] ⇄ pheromone p=0.329 → S13@127.0.0.1:63213
[S11] ⇄ pheromone p=0.257 → S3@127.0.0.1:63203
[S2] START round=16 head_norm_before_train=1.372667 cos_to_last_merge=0.9993 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6986999629239061, 'auprc': 0.7924163369891255, 'loss_val': 0.4100073465614331, 'psi': 0.7361865125499939}-{'f1_val': 0.7006386570678014, 'auprc': 0.7925879837338962, 'loss_val': 0.42084213263912784, 'psi': 0.7374183877342393}
[S3] START round=16 head_norm_before_train=0.759486 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.430095 metrics={'f1_val': 0.5537704346223864, 'auprc': 0.8095861688466099, 'loss_val': 0.8229138102307886, 'psi': 0.6560967283120758}-{'f1_val': 0.39161052266070295, 'auprc': 0.8527945349291619, 'loss_val': 0.8397685904914829, 'psi': 0.5760841275680866}
[S4] START round=16 head_norm_before_train=1.199796 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.318300 metrics={'f1_val': 0.6715809832285902, 'auprc': 0.85693073344846, 'loss_val': 0.4268436688689374, 'psi': 0.7457208833165381}-{'f1_val': 0.6680581340068477, 'auprc': 0.6617150708272264, 'loss_val': 0.45665992777876774, 'psi': 0.6655209087349991}
[S5] START round=16 head_norm_before_train=1.215570 cos_to_last_merge=0.9958 (last merge round=13)
[S5] round=16 local utility u=0.198760 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9698446016238528, 'loss_val': 0.37886844129193314, 'psi': 0.8081301997443565}-{'f1_val': 0.700320598491359, 'auprc': 0.8580083049513558, 'loss_val': 0.4408804441328934, 'psi': 0.7633956810753577}
[S6] START round=16 head_norm_before_train=1.639609 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6195200693530615, 'auprc': 0.7864047810143324, 'loss_val': 0.5611590794258788, 'psi': 0.6862739540175699}-{'f1_val': 0.9141447176014366, 'auprc': 0.956355826557966, 'loss_val': 0.2630990150914273, 'psi': 0.9310291611840483}
[S7] START round=16 head_norm_before_train=0.812624 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.374001 metrics={'f1_val': 0.5520980545284027, 'auprc': 0.7750713974014698, 'loss_val': 0.8788171651285395, 'psi': 0.6412873916776296}-{'f1_val': 0.41671011811102343, 'auprc': 0.7809540490664246, 'loss_val': 0.8321394366264028, 'psi': 0.5624076904931838}
[S8] START round=16 head_norm_before_train=1.739769 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7402348874801601, 'auprc': 0.9966340206430402, 'loss_val': 0.14483253700723925, 'psi': 0.8427945407453121}-{'f1_val': 0.9862211113266615, 'auprc': 0.9986252013020569, 'loss_val': 0.12621512158813925, 'psi': 0.9911827473168197}
[S9] START round=16 head_norm_before_train=1.366384 cos_to_last_merge=0.8111 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.6992743488532054, 'auprc': 0.9588241576486503, 'loss_val': 0.26517329416480734, 'psi': 0.8030942723713834}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979258163572713, 'loss_val': 0.18728480535929795, 'psi': 0.8199002750069196}
[S10] START round=16 head_norm_before_train=1.261505 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9291434870556516, 'auprc': 0.9849632009957903, 'loss_val': 0.358230980213743, 'psi': 0.9514713726317071}-{'f1_val': 0.9891606012210763, 'auprc': 0.9922573109942143, 'loss_val': 0.20392172293838565, 'psi': 0.9903992851303316}
[S11] START round=16 head_norm_before_train=0.803069 cos_to_last_merge=0.9952 (last merge round=14)
[S11] round=16 local utility u=0.052282 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9948045721574106, 'loss_val': 0.41307394256182844, 'psi': 0.8189379166151192}-{'f1_val': 0.7016934795869249, 'auprc': 0.9904626500568885, 'loss_val': 0.5046123717563538, 'psi': 0.8172011477749104}
[S13] START round=16 head_norm_before_train=0.952349 cos_to_last_merge=0.9949 (last merge round=13)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5720124393316286, 'auprc': 0.7198392725714771, 'loss_val': 0.7671283053981833, 'psi': 0.631143172627568}-{'f1_val': 0.6138468495008802, 'auprc': 0.7078208159365169, 'loss_val': 0.7064048771310585, 'psi': 0.6514364360751349}
[S14] START round=16 head_norm_before_train=1.619691 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.015933 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9971487493216822, 'loss_val': 0.12184873686337061, 'psi': 0.9972040173828762}-{'f1_val': 0.9976538428159559, 'auprc': 0.9971578766252845, 'loss_val': 0.15622097357668593, 'psi': 0.9974554563396874}
[S15] START round=16 head_norm_before_train=0.834995 cos_to_last_merge=0.9812 (last merge round=13)
[S15] round=16 local utility u=0.220979 metrics={'f1_val': 0.6966185725993175, 'auprc': 0.9493863736027094, 'loss_val': 0.3884230706733437, 'psi': 0.7977256930006742}-{'f1_val': 0.6961120390300846, 'auprc': 0.8355880484056035, 'loss_val': 0.4859459462072084, 'psi': 0.7519024427802922}
[S16] START round=16 head_norm_before_train=1.640046 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.8510374308162643, 'auprc': 0.8587922781045556, 'loss_val': 0.6502441646565782, 'psi': 0.8541393697315808}-{'f1_val': 0.8131402161427913, 'auprc': 0.8831559291985829, 'loss_val': 0.4897718796463645, 'psi': 0.8411465013651079}
[S17] START round=16 head_norm_before_train=1.612209 (no previous merge yet)
[S17] round=16 local utility u=0.090563 metrics={'f1_val': 0.4224074360152528, 'auprc': 0.7478900860340805, 'loss_val': 0.6542511962504742, 'psi': 0.5526004960227839}-{'f1_val': 0.3918971723647105, 'auprc': 0.7595336521898074, 'loss_val': 0.687246476867745, 'psi': 0.5389517642947492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63212
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=0.8808
[S11] RECEIVED delta(kind=head bytes=1796) from S15
[S11] cosine check vs S15: cos=0.9481
[S10] RECEIVED delta(kind=head bytes=1798) from S5
[S10] cosine check vs S5: cos=0.8452
[S3] RECEIVED delta(kind=head bytes=1795) from S11
[S3] cosine check vs S11: cos=0.9654
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9654
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9194
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.8916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9291 head_norm=1.292315
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.698452e-02
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9344 head_norm=1.291787 delta_norm=0.046985
[S10] aggregate: ACCEPT kept=['S5', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.6987 head_norm=1.411255
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.341797e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7011 head_norm=1.282406 delta_norm=0.334180
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6716 head_norm=1.233223
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.078247e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6723 head_norm=1.009333 delta_norm=0.307825
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=0.869136
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.998967e-02
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=0.847303 delta_norm=0.089990
[S11] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.5538 head_norm=0.807125
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.145037e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.5637 head_norm=0.830851 delta_norm=0.114504
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.282406 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.695065047192635, 'auprc': 0.7124369775700848, 'loss_val': 0.43466159926485687, 'psi': 0.702013819343615}-{'f1_val': 0.6986999629239061, 'auprc': 0.7924163369891255, 'loss_val': 0.4100073465614331, 'psi': 0.7361865125499939}
[S3] START round=17 head_norm_before_train=0.830851 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.416112 metrics={'f1_val': 0.6512994602375306, 'auprc': 0.8511220968368601, 'loss_val': 0.7004707694113063, 'psi': 0.7312285148772624}-{'f1_val': 0.5537704346223864, 'auprc': 0.8095861688466099, 'loss_val': 0.8229138102307886, 'psi': 0.6560967283120758}
[S4] START round=17 head_norm_before_train=1.009333 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6651913771085508, 'auprc': 0.8123760881059044, 'loss_val': 0.45024824239325223, 'psi': 0.7240652615074923}-{'f1_val': 0.6715809832285902, 'auprc': 0.85693073344846, 'loss_val': 0.4268436688689374, 'psi': 0.7457208833165381}
[S5] START round=17 head_norm_before_train=1.251429 cos_to_last_merge=0.9921 (last merge round=13)
[S5] round=17 local utility u=0.060351 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9959762431914361, 'loss_val': 0.3365655637597334, 'psi': 0.8185832877369227}-{'f1_val': 0.700320598491359, 'auprc': 0.9698446016238528, 'loss_val': 0.37886844129193314, 'psi': 0.8081301997443565}
[S6] START round=17 head_norm_before_train=1.659872 (no previous merge yet)
[S6] round=17 local utility u=0.645132 metrics={'f1_val': 0.6987617220394666, 'auprc': 0.9580068079928241, 'loss_val': 0.2611513983933802, 'psi': 0.8024597564208096}-{'f1_val': 0.6195200693530615, 'auprc': 0.7864047810143324, 'loss_val': 0.5611590794258788, 'psi': 0.6862739540175699}
[S7] START round=17 head_norm_before_train=0.840344 cos_to_last_merge=0.9973 (last merge round=15)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.41662931103489464, 'auprc': 0.76805860476946, 'loss_val': 0.835697436816285, 'psi': 0.5572010285287208}-{'f1_val': 0.5520980545284027, 'auprc': 0.7750713974014698, 'loss_val': 0.8788171651285395, 'psi': 0.6412873916776296}
[S8] START round=17 head_norm_before_train=1.757178 (no previous merge yet)
[S8] round=17 local utility u=0.766302 metrics={'f1_val': 0.986558854519165, 'auprc': 0.9985190527348191, 'loss_val': 0.0958271980145218, 'psi': 0.9913429338054267}-{'f1_val': 0.7402348874801601, 'auprc': 0.9966340206430402, 'loss_val': 0.14483253700723925, 'psi': 0.8427945407453121}
[S9] START round=17 head_norm_before_train=1.393486 cos_to_last_merge=0.8052 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=17 local utility u=1.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9980876837287442, 'loss_val': 0.12570008026036775, 'psi': 0.9967311045100089}-{'f1_val': 0.6992743488532054, 'auprc': 0.9588241576486503, 'loss_val': 0.26517329416480734, 'psi': 0.8030942723713834}
[S10] START round=17 head_norm_before_train=1.291787 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.7453644308927975, 'auprc': 0.9932329519658336, 'loss_val': 0.3696345139776007, 'psi': 0.8445118393220119}-{'f1_val': 0.9291434870556516, 'auprc': 0.9849632009957903, 'loss_val': 0.358230980213743, 'psi': 0.9514713726317071}
[S11] START round=17 head_norm_before_train=0.847303 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.020185 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9952092305117106, 'loss_val': 0.37391835070880447, 'psi': 0.8190997799568391}-{'f1_val': 0.7016934795869249, 'auprc': 0.9948045721574106, 'loss_val': 0.41307394256182844, 'psi': 0.8189379166151192}
[S13] START round=17 head_norm_before_train=0.990587 cos_to_last_merge=0.9891 (last merge round=13)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5923363703952103, 'auprc': 0.5441893932623729, 'loss_val': 0.8304448667421575, 'psi': 0.5730775795420753}-{'f1_val': 0.5720124393316286, 'auprc': 0.7198392725714771, 'loss_val': 0.7671283053981833, 'psi': 0.631143172627568}
[S14] START round=17 head_norm_before_train=1.654825 cos_to_last_merge=0.9996 (last merge round=15)
[S14] round=17 local utility u=0.016250 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971559805807463, 'loss_val': 0.09183232594991525, 'psi': 0.9974530630622107}-{'f1_val': 0.9972408627570057, 'auprc': 0.9971487493216822, 'loss_val': 0.12184873686337061, 'psi': 0.9972040173828762}
[S15] START round=17 head_norm_before_train=0.901034 cos_to_last_merge=0.9673 (last merge round=13)
[S15] round=17 local utility u=1.000000 metrics={'f1_val': 0.9966480709346631, 'auprc': 0.9935377650903148, 'loss_val': 0.2664959867986249, 'psi': 0.9954039485969238}-{'f1_val': 0.6966185725993175, 'auprc': 0.9493863736027094, 'loss_val': 0.3884230706733437, 'psi': 0.7977256930006742}
[S16] START round=17 head_norm_before_train=1.667796 (no previous merge yet)
[S16] round=17 local utility u=0.637935 metrics={'f1_val': 0.9477108441563709, 'auprc': 0.9693024327444147, 'loss_val': 0.28594599478990296, 'psi': 0.9563474795915885}-{'f1_val': 0.8510374308162643, 'auprc': 0.8587922781045556, 'loss_val': 0.6502441646565782, 'psi': 0.8541393697315808}
[S17] START round=17 head_norm_before_train=1.616896 (no previous merge yet)
[S17] round=17 local utility u=0.204101 metrics={'f1_val': 0.48996743404412224, 'auprc': 0.7408871013125002, 'loss_val': 0.6304008080846004, 'psi': 0.5903353009514735}-{'f1_val': 0.4224074360152528, 'auprc': 0.7478900860340805, 'loss_val': 0.6542511962504742, 'psi': 0.5526004960227839}
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S11
[S3] cosine check vs S11: cos=0.9858
[S13] RECEIVED delta(kind=head bytes=1805) from S6
[S13] cosine check vs S6: cos=-0.1344
[S13] DROPPED delta from S6 (cos=-0.1344 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S5
[S10] cosine check vs S5: cos=0.8410
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.9858
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0150
[S2] DROPPED delta from S8 (cos=-0.0150 < 0.0)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.7454 head_norm=1.323333
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.679556e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.7230 head_norm=1.250432 delta_norm=0.367956
[S10] aggregate: ROLLBACK (f1_val pre=0.745 post=0.723 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=0.902724
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.619315e-02
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=0.885233 delta_norm=0.076193
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S15
[S11] cosine check vs S15: cos=0.9383
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.7806
[S3] CommDone barrier timeout: have=2 need=3 — continuing
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6513 head_norm=0.874057
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.619315e-02
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6556 head_norm=0.885233 delta_norm=0.076193
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.319036 cos_to_last_merge=0.9988 (last merge round=16)
[S2] round=18 local utility u=0.019404 metrics={'f1_val': 0.7117438311112861, 'auprc': 0.7759608580354445, 'loss_val': 0.6864982706245805, 'psi': 0.7374306418809495}-{'f1_val': 0.695065047192635, 'auprc': 0.7124369775700848, 'loss_val': 0.43466159926485687, 'psi': 0.702013819343615}
[S3] START round=18 head_norm_before_train=0.885233 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.056194 metrics={'f1_val': 0.669111148480028, 'auprc': 0.8196759278933099, 'loss_val': 0.6006148433410434, 'psi': 0.7293370602453407}-{'f1_val': 0.6512994602375306, 'auprc': 0.8511220968368601, 'loss_val': 0.7004707694113063, 'psi': 0.7312285148772624}
[S4] START round=18 head_norm_before_train=1.048816 cos_to_last_merge=0.9991 (last merge round=16)
[S4] round=18 local utility u=1.000000 metrics={'f1_val': 0.9435002290762837, 'auprc': 0.9381892655952981, 'loss_val': 0.43006185788729745, 'psi': 0.9413758436838895}-{'f1_val': 0.6651913771085508, 'auprc': 0.8123760881059044, 'loss_val': 0.45024824239325223, 'psi': 0.7240652615074923}
[S5] START round=18 head_norm_before_train=1.283250 cos_to_last_merge=0.9884 (last merge round=13)
[S5] round=18 local utility u=0.002177 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9943576487760757, 'loss_val': 0.3258626567166836, 'psi': 0.8177865910107576}-{'f1_val': 0.7003213174339138, 'auprc': 0.9959762431914361, 'loss_val': 0.3365655637597334, 'psi': 0.8185832877369227}
[S6] START round=18 head_norm_before_train=1.674210 (no previous merge yet)
[S6] round=18 local utility u=0.449234 metrics={'f1_val': 0.8687687518815795, 'auprc': 0.9434336146146551, 'loss_val': 0.33900615516979327, 'psi': 0.8986346969748098}-{'f1_val': 0.6987617220394666, 'auprc': 0.9580068079928241, 'loss_val': 0.2611513983933802, 'psi': 0.8024597564208096}
[S7] START round=18 head_norm_before_train=0.871235 cos_to_last_merge=0.9923 (last merge round=15)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6824510653693593, 'loss_val': 0.8200647564930351, 'psi': 0.5230064970143578}-{'f1_val': 0.41662931103489464, 'auprc': 0.76805860476946, 'loss_val': 0.835697436816285, 'psi': 0.5572010285287208}
[S8] START round=18 head_norm_before_train=1.772012 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.8705121663634063, 'auprc': 0.9884974806249628, 'loss_val': 0.12902467226027456, 'psi': 0.917706292068029}-{'f1_val': 0.986558854519165, 'auprc': 0.9985190527348191, 'loss_val': 0.0958271980145218, 'psi': 0.9913429338054267}
[S9] START round=18 head_norm_before_train=1.416953 cos_to_last_merge=0.8000 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=18 local utility u=0.005751 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9980889429184574, 'loss_val': 0.10420146741431194, 'psi': 0.995731637191057}-{'f1_val': 0.9958267183641853, 'auprc': 0.9980876837287442, 'loss_val': 0.12570008026036775, 'psi': 0.9967311045100089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=18 head_norm_before_train=1.250432 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.7243092209398659, 'auprc': 0.9929229780503773, 'loss_val': 0.4560247266535527, 'psi': 0.8317547237840706}-{'f1_val': 0.7453644308927975, 'auprc': 0.9932329519658336, 'loss_val': 0.3696345139776007, 'psi': 0.8445118393220119}
[S11] START round=18 head_norm_before_train=0.885233 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.013882 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9981408715173623, 'loss_val': 0.3549482871577887, 'psi': 0.8202724363590999}-{'f1_val': 0.7016934795869249, 'auprc': 0.9952092305117106, 'loss_val': 0.37391835070880447, 'psi': 0.8190997799568391}
[S13] START round=18 head_norm_before_train=1.033057 cos_to_last_merge=0.9817 (last merge round=13)
[S13] round=18 local utility u=0.186866 metrics={'f1_val': 0.5735201377324636, 'auprc': 0.6911044822083975, 'loss_val': 0.7845602527623499, 'psi': 0.6205538755228371}-{'f1_val': 0.5923363703952103, 'auprc': 0.5441893932623729, 'loss_val': 0.8304448667421575, 'psi': 0.5730775795420753}
[S14] START round=18 head_norm_before_train=1.692619 cos_to_last_merge=0.9985 (last merge round=15)
[S14] round=18 local utility u=0.003839 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9956966062730082, 'loss_val': 0.08078564556693739, 'psi': 0.9969703532895343}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971559805807463, 'loss_val': 0.09183232594991525, 'psi': 0.9974530630622107}
[S15] START round=18 head_norm_before_train=0.965861 cos_to_last_merge=0.9542 (last merge round=13)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6966178353014845, 'auprc': 0.8373053134405688, 'loss_val': 0.3858529280578823, 'psi': 0.7528928265571182}-{'f1_val': 0.9966480709346631, 'auprc': 0.9935377650903148, 'loss_val': 0.2664959867986249, 'psi': 0.9954039485969238}
[S16] START round=18 head_norm_before_train=1.698164 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9302871448889852, 'auprc': 0.9793136482193656, 'loss_val': 0.2621889665382905, 'psi': 0.9498977462211374}-{'f1_val': 0.9477108441563709, 'auprc': 0.9693024327444147, 'loss_val': 0.28594599478990296, 'psi': 0.9563474795915885}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.625232 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.418550699833207, 'auprc': 0.7374278297346134, 'loss_val': 0.6147753741086612, 'psi': 0.5461015517937695}-{'f1_val': 0.48996743404412224, 'auprc': 0.7408871013125002, 'loss_val': 0.6304008080846004, 'psi': 0.5903353009514735}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63213
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:63215
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S6
[S13] cosine check vs S6: cos=-0.1383
[S13] DROPPED delta from S6 (cos=-0.1383 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.7886
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[S15] RECEIVED delta(kind=head bytes=1789) from S11
[S15] cosine check vs S11: cos=0.9262
[S6] RECEIVED delta(kind=head bytes=1793) from S13
[S6] cosine check vs S13: cos=-0.1383
[S6] DROPPED delta from S13 (cos=-0.1383 < 0.0)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.7243 head_norm=1.282808
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.258225e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.7231 head_norm=1.417126 delta_norm=0.525823
[S10] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0129
[S8] DROPPED delta from S2 (cos=-0.0129 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.9411
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7017 head_norm=0.932320
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.712510e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7017 head_norm=0.933663 delta_norm=0.171251
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4167 head_norm=0.901752
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.950734e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4167 head_norm=0.982348 delta_norm=0.195073
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5]  timeout peer S9
[S5]  timeout peer S10
[S11]  timeout peer S3
[S3]  timeout peer S5
[S3]  timeout peer S7
[S3]  timeout peer S13
[S15]  timeout peer S11
[S13]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:63212
[S4]  timeout peer S2
[S4]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S4
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.9795
[S2] START round=19 head_norm_before_train=1.359983 cos_to_last_merge=0.9960 (last merge round=16)
[S2] round=19 local utility u=0.008723 metrics={'f1_val': 0.7115741117840517, 'auprc': 0.7743386714168496, 'loss_val': 0.6631666481705831, 'psi': 0.7366799356371709}-{'f1_val': 0.7117438311112861, 'auprc': 0.7759608580354445, 'loss_val': 0.6864982706245805, 'psi': 0.7374306418809495}
[S3] START round=19 head_norm_before_train=0.928140 cos_to_last_merge=0.9981 (last merge round=17)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.4620810418989699, 'auprc': 0.7355184171473899, 'loss_val': 0.858856038043623, 'psi': 0.5714559919983379}-{'f1_val': 0.669111148480028, 'auprc': 0.8196759278933099, 'loss_val': 0.6006148433410434, 'psi': 0.7293370602453407}
[S4] START round=19 head_norm_before_train=1.092230 cos_to_last_merge=0.9965 (last merge round=16)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.668156182426697, 'auprc': 0.9533371532996954, 'loss_val': 0.41994541414402115, 'psi': 0.7822285707758964}-{'f1_val': 0.9435002290762837, 'auprc': 0.9381892655952981, 'loss_val': 0.43006185788729745, 'psi': 0.9413758436838895}
[S5] START round=19 head_norm_before_train=1.309656 cos_to_last_merge=0.9851 (last merge round=13)
[S5] round=19 local utility u=0.007952 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9944973804273979, 'loss_val': 0.31037846758223686, 'psi': 0.8178424836712865}-{'f1_val': 0.7000725525005456, 'auprc': 0.9943576487760757, 'loss_val': 0.3258626567166836, 'psi': 0.8177865910107576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=20 psi=0.818 u=0.0080 p_local=0.1213 f1=0.700 auprc=0.994 bytes=25161
[S6] START round=19 head_norm_before_train=1.682854 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6188234201284832, 'auprc': 0.8020870015397011, 'loss_val': 0.5112173153642932, 'psi': 0.6921288526929704}-{'f1_val': 0.8687687518815795, 'auprc': 0.9434336146146551, 'loss_val': 0.33900615516979327, 'psi': 0.8986346969748098}
[S7] START round=19 head_norm_before_train=0.982348 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.074972 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7314376563438267, 'loss_val': 0.817081064066781, 'psi': 0.5426011334041447}-{'f1_val': 0.41671011811102343, 'auprc': 0.6824510653693593, 'loss_val': 0.8200647564930351, 'psi': 0.5230064970143578}
[S8] START round=19 head_norm_before_train=1.784471 (no previous merge yet)
[S8] round=19 local utility u=0.415648 metrics={'f1_val': 0.9937260093124592, 'auprc': 0.9986576926768671, 'loss_val': 0.06749193907123487, 'psi': 0.9956986826582224}-{'f1_val': 0.8705121663634063, 'auprc': 0.9884974806249628, 'loss_val': 0.12902467226027456, 'psi': 0.917706292068029}
[S9] START round=19 head_norm_before_train=1.444204 cos_to_last_merge=0.7943 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.998462428344637, 'loss_val': 0.08532301930111745, 'psi': 0.9925885958395155}-{'f1_val': 0.9941601000394567, 'auprc': 0.9980889429184574, 'loss_val': 0.10420146741431194, 'psi': 0.995731637191057}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.993 u=0.0000 p_local=0.1683 f1=0.989 auprc=0.998 bytes=26905
[S10] START round=19 head_norm_before_train=1.417126 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.568050 metrics={'f1_val': 0.87078697147797, 'auprc': 0.9953831887812857, 'loss_val': 0.20617155444545962, 'psi': 0.9206254583992963}-{'f1_val': 0.7243092209398659, 'auprc': 0.9929229780503773, 'loss_val': 0.4560247266535527, 'psi': 0.8317547237840706}
[S11] START round=19 head_norm_before_train=0.933663 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.019005 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9974670864792606, 'loss_val': 0.3145259525678976, 'psi': 0.819963803930247}-{'f1_val': 0.7016934795869249, 'auprc': 0.9981408715173623, 'loss_val': 0.3549482871577887, 'psi': 0.8202724363590999}
[S13] START round=19 head_norm_before_train=1.067470 cos_to_last_merge=0.9751 (last merge round=13)
[S13] round=19 local utility u=0.034345 metrics={'f1_val': 0.5985033356651228, 'auprc': 0.6571667142314033, 'loss_val': 0.7639560601988482, 'psi': 0.621968687091635}-{'f1_val': 0.5735201377324636, 'auprc': 0.6911044822083975, 'loss_val': 0.7845602527623499, 'psi': 0.6205538755228371}
[S14] START round=19 head_norm_before_train=1.727486 cos_to_last_merge=0.9970 (last merge round=15)
[S14] round=19 local utility u=0.012594 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9971291157128007, 'loss_val': 0.06034058599206382, 'psi': 0.9975879497214493}-{'f1_val': 0.9978195179672185, 'auprc': 0.9956966062730082, 'loss_val': 0.08078564556693739, 'psi': 0.9969703532895343}
[S15] START round=19 head_norm_before_train=1.014903 cos_to_last_merge=0.9447 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=19 local utility u=0.553844 metrics={'f1_val': 0.7885899396528373, 'auprc': 0.9855246693951639, 'loss_val': 0.27465565326246577, 'psi': 0.867363831549768}-{'f1_val': 0.6966178353014845, 'auprc': 0.8373053134405688, 'loss_val': 0.3858529280578823, 'psi': 0.7528928265571182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7886 head_norm=1.057313
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.094271e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7895 head_norm=0.974529 delta_norm=0.209427
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.867 u=0.5538 p_local=0.3262 f1=0.789 auprc=0.986 bytes=25111
[S16] START round=19 head_norm_before_train=1.732136 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8807745597796272, 'auprc': 0.9666393724179314, 'loss_val': 0.48112121732898755, 'psi': 0.9151204848349489}-{'f1_val': 0.9302871448889852, 'auprc': 0.9793136482193656, 'loss_val': 0.2621889665382905, 'psi': 0.9498977462211374}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.915 u=0.0000 p_local=0.2184 f1=0.881 auprc=0.967 bytes=25192
[S17] START round=19 head_norm_before_train=1.632777 (no previous merge yet)
[S17] round=19 local utility u=0.030848 metrics={'f1_val': 0.4195867419417906, 'auprc': 0.741335318998167, 'loss_val': 0.5710179686202925, 'psi': 0.5482861727643411}-{'f1_val': 0.418550699833207, 'auprc': 0.7374278297346134, 'loss_val': 0.6147753741086612, 'psi': 0.5461015517937695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=20 psi=0.548 u=0.0308 p_local=0.0799 f1=0.420 auprc=0.741 bytes=23401
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63215
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.571 u=0.0000 p_local=0.1845 f1=0.462 auprc=0.736 bytes=26970
[S4] r=20 psi=0.782 u=0.0000 p_local=0.2583 f1=0.668 auprc=0.953 bytes=23385
[S13] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] r=20 psi=0.692 u=0.0000 p_local=0.2890 f1=0.619 auprc=0.802 bytes=19780
[S11] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:63214
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9589
[S2] RECEIVED delta(kind=head bytes=1803) from S8
[S2] cosine check vs S8: cos=-0.0132
[S2] DROPPED delta from S8 (cos=-0.0132 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S13
[S6] cosine check vs S13: cos=-0.1407
[S6] DROPPED delta from S13 (cos=-0.1407 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4803
[S15] RECEIVED delta(kind=head bytes=1792) from S11
[S15] cosine check vs S11: cos=0.9981
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7016 head_norm=0.976423
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.001877e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7016 head_norm=0.947304 delta_norm=0.100188
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0190 p_local=0.1192 f1=0.702 auprc=0.997 bytes=28730
[S8] r=20 psi=0.996 u=0.4156 p_local=0.3157 f1=0.994 auprc=0.999 bytes=25177
[S14] r=20 psi=0.998 u=0.0126 p_local=0.1052 f1=0.998 auprc=0.997 bytes=32399
[S7] r=20 psi=0.543 u=0.0750 p_local=0.0891 f1=0.417 auprc=0.731 bytes=25165
[S13] r=20 psi=0.622 u=0.0343 p_local=0.1548 f1=0.599 auprc=0.657 bytes=21483
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0132
[S8] DROPPED delta from S2 (cos=-0.0132 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9589
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.8708 head_norm=1.457112
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.748643e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.8623 head_norm=1.591934 delta_norm=0.274864
[S10] aggregate: ROLLBACK (f1_val pre=0.871 post=0.862 tol_abs=0.005 tol_rel=0.0)
[S10] r=20 psi=0.921 u=0.5681 p_local=0.2449 f1=0.871 auprc=0.995 bytes=19808
[S2] r=20 psi=0.737 u=0.0087 p_local=0.0610 f1=0.712 auprc=0.774 bytes=23365
[S2] START round=20 head_norm_before_train=1.401909 cos_to_last_merge=0.9926 (last merge round=16)
[S2] round=20 local utility u=0.055663 metrics={'f1_val': 0.694023493482989, 'auprc': 0.7760245849761962, 'loss_val': 0.45159563325233154, 'psi': 0.7268239300802719}-{'f1_val': 0.7115741117840517, 'auprc': 0.7743386714168496, 'loss_val': 0.6631666481705831, 'psi': 0.7366799356371709}
[S3] START round=20 head_norm_before_train=0.969205 cos_to_last_merge=0.9938 (last merge round=17)
[S3] round=20 local utility u=1.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.804652682249275, 'loss_val': 0.4353142040815478, 'psi': 0.7423601139149965}-{'f1_val': 0.4620810418989699, 'auprc': 0.7355184171473899, 'loss_val': 0.858856038043623, 'psi': 0.5714559919983379}
[S4] START round=20 head_norm_before_train=1.138900 cos_to_last_merge=0.9926 (last merge round=16)
[S4] round=20 local utility u=0.876746 metrics={'f1_val': 0.9474097304386613, 'auprc': 0.961089123172264, 'loss_val': 0.3652314637687681, 'psi': 0.9528814875321023}-{'f1_val': 0.668156182426697, 'auprc': 0.9533371532996954, 'loss_val': 0.41994541414402115, 'psi': 0.7822285707758964}
[S5] START round=20 head_norm_before_train=1.335580 cos_to_last_merge=0.9819 (last merge round=13)
[S5] round=20 local utility u=0.011191 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9957230953844127, 'loss_val': 0.29167335108895703, 'psi': 0.8183327696540924}-{'f1_val': 0.7000725525005456, 'auprc': 0.9944973804273979, 'loss_val': 0.31037846758223686, 'psi': 0.8178424836712865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=20 head_norm_before_train=1.688888 (no previous merge yet)
[S6] round=20 local utility u=0.150619 metrics={'f1_val': 0.6451750739922341, 'auprc': 0.816526106762928, 'loss_val': 0.4114061247761785, 'psi': 0.7137154871005117}-{'f1_val': 0.6188234201284832, 'auprc': 0.8020870015397011, 'loss_val': 0.5112173153642932, 'psi': 0.6921288526929704}
[S7] START round=20 head_norm_before_train=1.002921 cos_to_last_merge=0.9994 (last merge round=18)
[S7] round=20 local utility u=0.579458 metrics={'f1_val': 0.6108816898620256, 'auprc': 0.7253066994627986, 'loss_val': 0.804801386280176, 'psi': 0.6566516937023348}-{'f1_val': 0.41671011811102343, 'auprc': 0.7314376563438267, 'loss_val': 0.817081064066781, 'psi': 0.5426011334041447}
[S8] START round=20 head_norm_before_train=1.798293 (no previous merge yet)
[S8] round=20 local utility u=0.006069 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9988677028361707, 'loss_val': 0.056028112620824494, 'psi': 0.995787111475537}-{'f1_val': 0.9937260093124592, 'auprc': 0.9986576926768671, 'loss_val': 0.06749193907123487, 'psi': 0.9956986826582224}
[S9] START round=20 head_norm_before_train=1.475372 cos_to_last_merge=0.7878 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=20 local utility u=0.010038 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9984509031407434, 'loss_val': 0.06776176744425719, 'psi': 0.9928388701687574}-{'f1_val': 0.9886727075027679, 'auprc': 0.998462428344637, 'loss_val': 0.08532301930111745, 'psi': 0.9925885958395155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=20 head_norm_before_train=1.591934 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.094081 metrics={'f1_val': 0.9184872840064722, 'auprc': 0.9827449514416658, 'loss_val': 0.2662963758519985, 'psi': 0.9441903509805496}-{'f1_val': 0.87078697147797, 'auprc': 0.9953831887812857, 'loss_val': 0.20617155444545962, 'psi': 0.9206254583992963}
[S11] START round=20 head_norm_before_train=0.947304 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.012912 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9980750324252938, 'loss_val': 0.2905262731287781, 'psi': 0.8202069823086604}-{'f1_val': 0.7016282822309048, 'auprc': 0.9974670864792606, 'loss_val': 0.3145259525678976, 'psi': 0.819963803930247}
[S13] START round=20 head_norm_before_train=1.094774 cos_to_last_merge=0.9695 (last merge round=13)
[S13] round=20 local utility u=0.158639 metrics={'f1_val': 0.6403907438966714, 'auprc': 0.6345677264570537, 'loss_val': 0.6302050299515612, 'psi': 0.6380615369208242}-{'f1_val': 0.5985033356651228, 'auprc': 0.6571667142314033, 'loss_val': 0.7639560601988482, 'psi': 0.621968687091635}
[S14] START round=20 head_norm_before_train=1.759669 cos_to_last_merge=0.9953 (last merge round=15)
[S14] round=20 local utility u=0.002435 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971283588992618, 'loss_val': 0.051546954543588215, 'psi': 0.9971955575831806}-{'f1_val': 0.9978938390605482, 'auprc': 0.9971291157128007, 'loss_val': 0.06034058599206382, 'psi': 0.9975879497214493}
[S15] START round=20 head_norm_before_train=0.974529 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7063499639197471, 'auprc': 0.9797390258307398, 'loss_val': 0.33085396842572345, 'psi': 0.8157055886841442}-{'f1_val': 0.7885899396528373, 'auprc': 0.9855246693951639, 'loss_val': 0.27465565326246577, 'psi': 0.867363831549768}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.7063 head_norm=1.007710
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.560302e-02
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6981 head_norm=0.991141 delta_norm=0.045603
[S15] aggregate: ROLLBACK (f1_val pre=0.706 post=0.698 tol_abs=0.005 tol_rel=0.0)
[S16] START round=20 head_norm_before_train=1.762994 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8796052137474005, 'auprc': 0.9654743939863536, 'loss_val': 0.48345704844024107, 'psi': 0.9139528858429817}-{'f1_val': 0.8807745597796272, 'auprc': 0.9666393724179314, 'loss_val': 0.48112121732898755, 'psi': 0.9151204848349489}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.645858 (no previous merge yet)
[S17] round=20 local utility u=0.025661 metrics={'f1_val': 0.4159763249120967, 'auprc': 0.7693982205842096, 'loss_val': 0.5822214266887527, 'psi': 0.5573450831809419}-{'f1_val': 0.4195867419417906, 'auprc': 0.741335318998167, 'loss_val': 0.5710179686202925, 'psi': 0.5482861727643411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S4] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:63214
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S7
[S3] cosine check vs S7: cos=0.4737
[S13] RECEIVED delta(kind=head bytes=1803) from S6
[S13] cosine check vs S6: cos=-0.1419
[S13] DROPPED delta from S6 (cos=-0.1419 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9899
[S6] RECEIVED delta(kind=head bytes=1797) from S13
[S6] cosine check vs S13: cos=-0.1419
[S6] DROPPED delta from S13 (cos=-0.1419 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9730
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9914
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=-0.0140
[S2] DROPPED delta from S8 (cos=-0.0140 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.9840
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7008 head_norm=1.001769
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.160076e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7011 head_norm=0.864936 delta_norm=0.516008
[S3] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.348 → S11@127.0.0.1:63212
[S8] ⇄ pheromone p=0.254 → S2@127.0.0.1:63202
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.261 → S13@127.0.0.1:63213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9972 head_norm=1.790364
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.878529e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9972 head_norm=1.606683 delta_norm=0.287853
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.085 → S10@127.0.0.1:63211
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6109 head_norm=1.022392
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.510316e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4167 head_norm=1.095560 delta_norm=0.151032
[S7] aggregate: ROLLBACK (f1_val pre=0.611 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.187 → S3@127.0.0.1:63203
[S13] ⇄ pheromone p=0.156 → S6@127.0.0.1:63207
[S4] ⇄ pheromone p=0.382 → S7@127.0.0.1:63208
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7016 head_norm=0.987826
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.913065e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7016 head_norm=0.990821 delta_norm=0.089131
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.098 → S15@127.0.0.1:63215
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9996
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0140
[S8] DROPPED delta from S2 (cos=-0.0140 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9185 head_norm=1.620243
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.477989e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9224 head_norm=1.701015 delta_norm=0.147799
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.215 → S5@127.0.0.1:63205
[S2] ⇄ pheromone p=0.060 → S8@127.0.0.1:63209
[S2] START round=21 head_norm_before_train=1.439801 cos_to_last_merge=0.9892 (last merge round=16)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7113653550404744, 'auprc': 0.772499487411868, 'loss_val': 0.6155801936566396, 'psi': 0.7358190079890319}-{'f1_val': 0.694023493482989, 'auprc': 0.7760245849761962, 'loss_val': 0.45159563325233154, 'psi': 0.7268239300802719}
[S3] START round=21 head_norm_before_train=0.864936 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.6615984678235296, 'loss_val': 0.5133043361942505, 'psi': 0.6850479629286127}-{'f1_val': 0.7008317350254774, 'auprc': 0.804652682249275, 'loss_val': 0.4353142040815478, 'psi': 0.7423601139149965}
[S4] START round=21 head_norm_before_train=1.183571 cos_to_last_merge=0.9880 (last merge round=16)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9386507411591679, 'auprc': 0.9590520211415222, 'loss_val': 0.3425263310594114, 'psi': 0.9468112531521096}-{'f1_val': 0.9474097304386613, 'auprc': 0.961089123172264, 'loss_val': 0.3652314637687681, 'psi': 0.9528814875321023}
[S5] START round=21 head_norm_before_train=1.360965 cos_to_last_merge=0.9790 (last merge round=13)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7005668692019353, 'auprc': 0.8154721492581922, 'loss_val': 0.32676706706079095, 'psi': 0.7465289812244381}-{'f1_val': 0.7000725525005456, 'auprc': 0.9957230953844127, 'loss_val': 0.29167335108895703, 'psi': 0.8183327696540924}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.695864 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.95285251021851, 'auprc': 0.9612095138847018, 'loss_val': 0.2761078775121167, 'psi': 0.9561953116849867}-{'f1_val': 0.6451750739922341, 'auprc': 0.816526106762928, 'loss_val': 0.4114061247761785, 'psi': 0.7137154871005117}
[S7] START round=21 head_norm_before_train=1.095560 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.301014 metrics={'f1_val': 0.681723389618368, 'auprc': 0.7642339562231713, 'loss_val': 0.7446050351417415, 'psi': 0.7147276162602894}-{'f1_val': 0.6108816898620256, 'auprc': 0.7253066994627986, 'loss_val': 0.804801386280176, 'psi': 0.6566516937023348}
[S8] START round=21 head_norm_before_train=1.814062 (no previous merge yet)
[S8] round=21 local utility u=0.000694 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9987001344317932, 'loss_val': 0.05267042330788765, 'psi': 0.9955733454465177}-{'f1_val': 0.9937333839017813, 'auprc': 0.9988677028361707, 'loss_val': 0.056028112620824494, 'psi': 0.995787111475537}
[S9] START round=21 head_norm_before_train=1.507172 cos_to_last_merge=0.7817 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9856836147752347, 'auprc': 0.9924041869424589, 'loss_val': 0.08125462214599026, 'psi': 0.9883718436421243}-{'f1_val': 0.9890975148541, 'auprc': 0.9984509031407434, 'loss_val': 0.06776176744425719, 'psi': 0.9928388701687574}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.701015 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.87328186032916, 'auprc': 0.9953683875598645, 'loss_val': 0.16064207724189628, 'psi': 0.9221164712214418}-{'f1_val': 0.9184872840064722, 'auprc': 0.9827449514416658, 'loss_val': 0.2662963758519985, 'psi': 0.9441903509805496}
[S11] START round=21 head_norm_before_train=0.990821 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.766490 metrics={'f1_val': 0.9541159264994155, 'auprc': 0.9975305401152599, 'loss_val': 0.2708392281599247, 'psi': 0.9714817719457531}-{'f1_val': 0.7016282822309048, 'auprc': 0.9980750324252938, 'loss_val': 0.2905262731287781, 'psi': 0.8202069823086604}
[S13] START round=21 head_norm_before_train=1.118367 cos_to_last_merge=0.9645 (last merge round=13)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5572962998475743, 'auprc': 0.7128028854010947, 'loss_val': 0.905922623947764, 'psi': 0.6194989340689825}-{'f1_val': 0.6403907438966714, 'auprc': 0.6345677264570537, 'loss_val': 0.6302050299515612, 'psi': 0.6380615369208242}
[S14] START round=21 head_norm_before_train=1.606683 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971006972534209, 'loss_val': 0.06778509168117645, 'psi': 0.9974309497312805}-{'f1_val': 0.997240356705793, 'auprc': 0.9971283588992618, 'loss_val': 0.051546954543588215, 'psi': 0.9971955575831806}
[S15] START round=21 head_norm_before_train=0.991141 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.563286 metrics={'f1_val': 0.8821285781259466, 'auprc': 0.9849885614789569, 'loss_val': 0.2747022169674374, 'psi': 0.9232725714671507}-{'f1_val': 0.7063499639197471, 'auprc': 0.9797390258307398, 'loss_val': 0.33085396842572345, 'psi': 0.8157055886841442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8821 head_norm=1.029703
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.362761e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8711 head_norm=1.005511 delta_norm=0.083628
[S15] aggregate: ROLLBACK (f1_val pre=0.882 post=0.871 tol_abs=0.005 tol_rel=0.0)
[S16] START round=21 head_norm_before_train=1.790722 (no previous merge yet)
[S16] round=21 local utility u=0.520863 metrics={'f1_val': 0.9862563910161006, 'auprc': 0.9858154114037995, 'loss_val': 0.1426605564416892, 'psi': 0.9860799991711802}-{'f1_val': 0.8796052137474005, 'auprc': 0.9654743939863536, 'loss_val': 0.48345704844024107, 'psi': 0.9139528858429817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=21 head_norm_before_train=1.662767 (no previous merge yet)
[S17] round=21 local utility u=0.771919 metrics={'f1_val': 0.6514642150724889, 'auprc': 0.7888069048382169, 'loss_val': 0.5095370089643415, 'psi': 0.70640129097878}-{'f1_val': 0.4159763249120967, 'auprc': 0.7693982205842096, 'loss_val': 0.5822214266887527, 'psi': 0.5573450831809419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:63215
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.630520
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.226812e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.625069 delta_norm=0.032268
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1789 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=-0.0141
[S2] DROPPED delta from S8 (cos=-0.0141 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S11
[S15] cosine check vs S11: cos=0.9899
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=0.8102
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1425
[S13] DROPPED delta from S6 (cos=-0.1425 < 0.0)
[S2] START round=22 head_norm_before_train=1.471119 cos_to_last_merge=0.9864 (last merge round=16)
[S2] round=22 local utility u=0.001874 metrics={'f1_val': 0.7066924277689124, 'auprc': 0.7703369189047202, 'loss_val': 0.5773062455132185, 'psi': 0.7321502242232356}-{'f1_val': 0.7113653550404744, 'auprc': 0.772499487411868, 'loss_val': 0.6155801936566396, 'psi': 0.7358190079890319}
[S3] START round=22 head_norm_before_train=0.891749 cos_to_last_merge=0.9989 (last merge round=20)
[S3] round=22 local utility u=0.124078 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.7237909681782709, 'loss_val': 0.4517250355526171, 'psi': 0.7099249630705092}-{'f1_val': 0.7006809596653347, 'auprc': 0.6615984678235296, 'loss_val': 0.5133043361942505, 'psi': 0.6850479629286127}
[S4] START round=22 head_norm_before_train=1.221485 cos_to_last_merge=0.9834 (last merge round=16)
[S4] round=22 local utility u=0.096357 metrics={'f1_val': 0.9545708215107898, 'auprc': 0.9700326760745629, 'loss_val': 0.2782747207966116, 'psi': 0.960755563336299}-{'f1_val': 0.9386507411591679, 'auprc': 0.9590520211415222, 'loss_val': 0.3425263310594114, 'psi': 0.9468112531521096}
[S5] START round=22 head_norm_before_train=1.380644 cos_to_last_merge=0.9765 (last merge round=13)
[S5] round=22 local utility u=0.301041 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.996708097054568, 'loss_val': 0.26692560316588143, 'psi': 0.8188765412112264}-{'f1_val': 0.7005668692019353, 'auprc': 0.8154721492581922, 'loss_val': 0.32676706706079095, 'psi': 0.7465289812244381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=22 head_norm_before_train=1.704219 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8309747688528857, 'auprc': 0.9536239128681419, 'loss_val': 0.3394269936770528, 'psi': 0.8800344264589881}-{'f1_val': 0.95285251021851, 'auprc': 0.9612095138847018, 'loss_val': 0.2761078775121167, 'psi': 0.9561953116849867}
[S7] START round=22 head_norm_before_train=1.115047 cos_to_last_merge=0.9992 (last merge round=20)
[S7] round=22 local utility u=0.006449 metrics={'f1_val': 0.667132461399256, 'auprc': 0.7765995744345148, 'loss_val': 0.6812579231308316, 'psi': 0.7109193066133594}-{'f1_val': 0.681723389618368, 'auprc': 0.7642339562231713, 'loss_val': 0.7446050351417415, 'psi': 0.7147276162602894}
[S8] START round=22 head_norm_before_train=1.831898 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9853629043478473, 'auprc': 0.9986556455600855, 'loss_val': 0.06042355888576989, 'psi': 0.9906800008327425}-{'f1_val': 0.9934888194563342, 'auprc': 0.9987001344317932, 'loss_val': 0.05267042330788765, 'psi': 0.9955733454465177}
[S9] START round=22 head_norm_before_train=1.537008 cos_to_last_merge=0.7765 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.777
[S9] round=22 local utility u=0.051134 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933186762803505, 'loss_val': 0.045128659058877654, 'psi': 0.9950775273797068}-{'f1_val': 0.9856836147752347, 'auprc': 0.9924041869424589, 'loss_val': 0.08125462214599026, 'psi': 0.9883718436421243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=22 head_norm_before_train=1.719200 cos_to_last_merge=0.9999 (last merge round=20)
[S10] round=22 local utility u=0.361218 metrics={'f1_val': 0.9931848690893955, 'auprc': 0.9933138885625505, 'loss_val': 0.1514605726705892, 'psi': 0.9932364768786576}-{'f1_val': 0.87328186032916, 'auprc': 0.9953683875598645, 'loss_val': 0.16064207724189628, 'psi': 0.9221164712214418}
[S11] START round=22 head_norm_before_train=1.024991 cos_to_last_merge=0.9994 (last merge round=20)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.7944348851910062, 'auprc': 0.9982615737830629, 'loss_val': 0.2367223409542756, 'psi': 0.8759655606278289}-{'f1_val': 0.9541159264994155, 'auprc': 0.9975305401152599, 'loss_val': 0.2708392281599247, 'psi': 0.9714817719457531}
[S13] START round=22 head_norm_before_train=1.137029 cos_to_last_merge=0.9608 (last merge round=13)
[S13] round=22 local utility u=0.184794 metrics={'f1_val': 0.6061525580287157, 'auprc': 0.665340540974747, 'loss_val': 0.6870859656587018, 'psi': 0.6298277512071282}-{'f1_val': 0.5572962998475743, 'auprc': 0.7128028854010947, 'loss_val': 0.905922623947764, 'psi': 0.6194989340689825}
[S14] START round=22 head_norm_before_train=1.625069 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.006548 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9990414743990366, 'loss_val': 0.061967882282064436, 'psi': 0.9983528931959436}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971006972534209, 'loss_val': 0.06778509168117645, 'psi': 0.9974309497312805}
[S15] START round=22 head_norm_before_train=1.005511 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7957954772686127, 'auprc': 0.98506006573049, 'loss_val': 0.27988375870413873, 'psi': 0.8715013126533636}-{'f1_val': 0.8821285781259466, 'auprc': 0.9849885614789569, 'loss_val': 0.2747022169674374, 'psi': 0.9232725714671507}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7958 head_norm=1.051781
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.138028e-02
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7800 head_norm=1.034444 delta_norm=0.091380
[S15] aggregate: ROLLBACK (f1_val pre=0.796 post=0.780 tol_abs=0.005 tol_rel=0.0)
[S16] START round=22 head_norm_before_train=1.820959 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9835706283069872, 'auprc': 0.9870670099223838, 'loss_val': 0.13167931110799103, 'psi': 0.9849691809531458}-{'f1_val': 0.9862563910161006, 'auprc': 0.9858154114037995, 'loss_val': 0.1426605564416892, 'psi': 0.9860799991711802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.681212 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6013221613243305, 'auprc': 0.7780105380921849, 'loss_val': 0.5290878759783212, 'psi': 0.6719975120314723}-{'f1_val': 0.6514642150724889, 'auprc': 0.7888069048382169, 'loss_val': 0.5095370089643415, 'psi': 0.70640129097878}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63207
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63205
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=0.7917
[S6] RECEIVED delta(kind=head bytes=1793) from S13
[S6] cosine check vs S13: cos=-0.1424
[S6] DROPPED delta from S13 (cos=-0.1424 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S4
[S7] cosine check vs S4: cos=0.9823
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9980
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.8568
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7007 head_norm=0.925366
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.432522e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7007 head_norm=0.971175 delta_norm=0.343252
[S3] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6671 head_norm=1.135350
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.277598e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6708 head_norm=1.190590 delta_norm=0.127760
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0138
[S8] DROPPED delta from S2 (cos=-0.0138 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.6093
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9932 head_norm=1.731707
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.902991e-02
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9930 head_norm=1.686405 delta_norm=0.069030
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.498724 cos_to_last_merge=0.9837 (last merge round=16)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7138856681546022, 'auprc': 0.7511386583550796, 'loss_val': 0.7092369019341477, 'psi': 0.7287868642347932}-{'f1_val': 0.7066924277689124, 'auprc': 0.7703369189047202, 'loss_val': 0.5773062455132185, 'psi': 0.7321502242232356}
[S3] START round=23 head_norm_before_train=0.971175 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.315884 metrics={'f1_val': 0.6963041045078708, 'auprc': 0.9877389311362523, 'loss_val': 0.5855399353393849, 'psi': 0.8128780351592234}-{'f1_val': 0.7006809596653347, 'auprc': 0.7237909681782709, 'loss_val': 0.4517250355526171, 'psi': 0.7099249630705092}
[S4] START round=23 head_norm_before_train=1.256438 cos_to_last_merge=0.9786 (last merge round=16)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9469410217880184, 'auprc': 0.9637428238521757, 'loss_val': 0.27313242437375485, 'psi': 0.9536617426136813}-{'f1_val': 0.9545708215107898, 'auprc': 0.9700326760745629, 'loss_val': 0.2782747207966116, 'psi': 0.960755563336299}
[S5] START round=23 head_norm_before_train=1.398090 cos_to_last_merge=0.9741 (last merge round=13)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7010268222207128, 'auprc': 0.8943581393320592, 'loss_val': 0.30466238824621683, 'psi': 0.7783593490652514}-{'f1_val': 0.7003221706489986, 'auprc': 0.996708097054568, 'loss_val': 0.26692560316588143, 'psi': 0.8188765412112264}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7010 head_norm=1.411713
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.098332e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7006 head_norm=1.411386 delta_norm=0.709833
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] START round=23 head_norm_before_train=1.715906 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6032317948389854, 'auprc': 0.7882830810852761, 'loss_val': 0.6391421914406962, 'psi': 0.6772523093375017}-{'f1_val': 0.8309747688528857, 'auprc': 0.9536239128681419, 'loss_val': 0.3394269936770528, 'psi': 0.8800344264589881}
[S7] START round=23 head_norm_before_train=1.190590 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.3755932042479355, 'auprc': 0.7734231694965146, 'loss_val': 0.8937405176123837, 'psi': 0.5347251903473671}-{'f1_val': 0.667132461399256, 'auprc': 0.7765995744345148, 'loss_val': 0.6812579231308316, 'psi': 0.7109193066133594}
[S8] START round=23 head_norm_before_train=1.849441 (no previous merge yet)
[S8] round=23 local utility u=0.028392 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9976945720239064, 'loss_val': 0.0471729476684694, 'psi': 0.9949372579317826}-{'f1_val': 0.9853629043478473, 'auprc': 0.9986556455600855, 'loss_val': 0.06042355888576989, 'psi': 0.9906800008327425}
[S9] START round=23 head_norm_before_train=1.559218 cos_to_last_merge=0.7728 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.773
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9934014317454061, 'loss_val': 0.05571445309551023, 'psi': 0.9908190816106224}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933186762803505, 'loss_val': 0.045128659058877654, 'psi': 0.9950775273797068}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.686405 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9636661811118348, 'auprc': 0.992493928536095, 'loss_val': 0.17989043445861455, 'psi': 0.9751972800815388}-{'f1_val': 0.9931848690893955, 'auprc': 0.9933138885625505, 'loss_val': 0.1514605726705892, 'psi': 0.9932364768786576}
[S11] START round=23 head_norm_before_train=1.058402 cos_to_last_merge=0.9977 (last merge round=20)
[S11] round=23 local utility u=0.515555 metrics={'f1_val': 0.959446266417366, 'auprc': 0.9981238338508985, 'loss_val': 0.1952665415861405, 'psi': 0.9749172933907789}-{'f1_val': 0.7944348851910062, 'auprc': 0.9982615737830629, 'loss_val': 0.2367223409542756, 'psi': 0.8759655606278289}
[S13] START round=23 head_norm_before_train=1.148713 cos_to_last_merge=0.9578 (last merge round=13)
[S13] round=23 local utility u=0.022679 metrics={'f1_val': 0.6025673197526447, 'auprc': 0.6689386236773969, 'loss_val': 0.6310117273621857, 'psi': 0.6291158413225455}-{'f1_val': 0.6061525580287157, 'auprc': 0.665340540974747, 'loss_val': 0.6870859656587018, 'psi': 0.6298277512071282}
[S14] START round=23 head_norm_before_train=1.642755 cos_to_last_merge=0.9999 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9987997126676182, 'loss_val': 0.05869087717783525, 'psi': 0.9978640990905232}-{'f1_val': 0.9978938390605482, 'auprc': 0.9990414743990366, 'loss_val': 0.061967882282064436, 'psi': 0.9983528931959436}
[S15] START round=23 head_norm_before_train=1.034444 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.314471 metrics={'f1_val': 0.8937938837098987, 'auprc': 0.987618476355135, 'loss_val': 0.24660803911294796, 'psi': 0.9313237207679932}-{'f1_val': 0.7957954772686127, 'auprc': 0.98506006573049, 'loss_val': 0.27988375870413873, 'psi': 0.8715013126533636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=23 head_norm_before_train=1.850547 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8609115104602835, 'auprc': 0.9141035885833454, 'loss_val': 0.6449605056984349, 'psi': 0.8821883417095082}-{'f1_val': 0.9835706283069872, 'auprc': 0.9870670099223838, 'loss_val': 0.13167931110799103, 'psi': 0.9849691809531458}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.704284 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5478278971337358, 'auprc': 0.7011059483754927, 'loss_val': 0.6265660094750658, 'psi': 0.6091391176304386}-{'f1_val': 0.6013221613243305, 'auprc': 0.7780105380921849, 'loss_val': 0.5290878759783212, 'psi': 0.6719975120314723}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] sending update (kind=head size=1787 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:63207
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9594 head_norm=1.090620
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.850870e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9590 head_norm=0.970362 delta_norm=0.285087
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0132
[S2] DROPPED delta from S8 (cos=-0.0132 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S13
[S6] cosine check vs S13: cos=-0.1422
[S6] DROPPED delta from S13 (cos=-0.1422 < 0.0)
[S2] START round=24 head_norm_before_train=1.519475 cos_to_last_merge=0.9816 (last merge round=16)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7137647603182954, 'auprc': 0.7402936264771494, 'loss_val': 0.7427663174921366, 'psi': 0.724376306781837}-{'f1_val': 0.7138856681546022, 'auprc': 0.7511386583550796, 'loss_val': 0.7092369019341477, 'psi': 0.7287868642347932}
[S3] START round=24 head_norm_before_train=0.997698 cos_to_last_merge=0.9982 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.677155647151851, 'auprc': 0.9939681871125947, 'loss_val': 0.5374413689650648, 'psi': 0.8038806631361485}-{'f1_val': 0.6963041045078708, 'auprc': 0.9877389311362523, 'loss_val': 0.5855399353393849, 'psi': 0.8128780351592234}
[S4] START round=24 head_norm_before_train=1.286196 cos_to_last_merge=0.9743 (last merge round=16)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9396912256528765, 'auprc': 0.9393307746945331, 'loss_val': 0.26454008564678433, 'psi': 0.9395470452695391}-{'f1_val': 0.9469410217880184, 'auprc': 0.9637428238521757, 'loss_val': 0.27313242437375485, 'psi': 0.9536617426136813}
[S5] START round=24 head_norm_before_train=1.411386 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.166051 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9959465883035639, 'loss_val': 0.273087588000072, 'psi': 0.8185709944162409}-{'f1_val': 0.7010268222207128, 'auprc': 0.8943581393320592, 'loss_val': 0.30466238824621683, 'psi': 0.7783593490652514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=24 head_norm_before_train=1.728134 (no previous merge yet)
[S6] round=24 local utility u=0.661237 metrics={'f1_val': 0.6991116546280103, 'auprc': 0.9595990604032961, 'loss_val': 0.4058954664307961, 'psi': 0.8033066169381247}-{'f1_val': 0.6032317948389854, 'auprc': 0.7882830810852761, 'loss_val': 0.6391421914406962, 'psi': 0.6772523093375017}
[S7] START round=24 head_norm_before_train=1.206382 cos_to_last_merge=0.9996 (last merge round=22)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6669706009185931, 'auprc': 0.783185089600266, 'loss_val': 0.6153398338270503, 'psi': 0.7134563963912622}-{'f1_val': 0.3755932042479355, 'auprc': 0.7734231694965146, 'loss_val': 0.8937405176123837, 'psi': 0.5347251903473671}
[S8] START round=24 head_norm_before_train=1.865908 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.989929598471134, 'auprc': 0.998675920655034, 'loss_val': 0.045578454528452494, 'psi': 0.9934281273446941}-{'f1_val': 0.9930990485370332, 'auprc': 0.9976945720239064, 'loss_val': 0.0471729476684694, 'psi': 0.9949372579317826}
[S9] START round=24 head_norm_before_train=1.579024 cos_to_last_merge=0.7699 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.770
[S9] round=24 local utility u=0.029994 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9934085566613949, 'loss_val': 0.03866350604458478, 'psi': 0.9951134795321246}-{'f1_val': 0.9890975148541, 'auprc': 0.9934014317454061, 'loss_val': 0.05571445309551023, 'psi': 0.9908190816106224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=24 head_norm_before_train=1.696490 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=24 local utility u=0.125050 metrics={'f1_val': 0.9949011811505593, 'auprc': 0.9953119731514755, 'loss_val': 0.12565439810928125, 'psi': 0.9950654979509257}-{'f1_val': 0.9636661811118348, 'auprc': 0.992493928536095, 'loss_val': 0.17989043445861455, 'psi': 0.9751972800815388}
[S11] START round=24 head_norm_before_train=0.970362 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.069570 metrics={'f1_val': 0.9916728650652858, 'auprc': 0.9979916180353215, 'loss_val': 0.2490891667287853, 'psi': 0.9942003662533001}-{'f1_val': 0.959446266417366, 'auprc': 0.9981238338508985, 'loss_val': 0.1952665415861405, 'psi': 0.9749172933907789}
[S13] START round=24 head_norm_before_train=1.160712 cos_to_last_merge=0.9550 (last merge round=13)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5658872950705387, 'auprc': 0.7010832664607838, 'loss_val': 0.8274983600921498, 'psi': 0.6199656836266367}-{'f1_val': 0.6025673197526447, 'auprc': 0.6689386236773969, 'loss_val': 0.6310117273621857, 'psi': 0.6291158413225455}
[S14] START round=24 head_norm_before_train=1.658472 cos_to_last_merge=0.9996 (last merge round=21)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971047208156124, 'loss_val': 0.058558252983337215, 'psi': 0.997040393220844}-{'f1_val': 0.997240356705793, 'auprc': 0.9987997126676182, 'loss_val': 0.05869087717783525, 'psi': 0.9978640990905232}
[S15] START round=24 head_norm_before_train=1.078467 cos_to_last_merge=0.9991 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8844245836651535, 'auprc': 0.986212124849005, 'loss_val': 0.22664365390879063, 'psi': 0.9251396001386942}-{'f1_val': 0.8937938837098987, 'auprc': 0.987618476355135, 'loss_val': 0.24660803911294796, 'psi': 0.9313237207679932}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.876518 (no previous merge yet)
[S16] round=24 local utility u=0.016585 metrics={'f1_val': 0.8536481139548554, 'auprc': 0.9513670973203517, 'loss_val': 0.6799996621313866, 'psi': 0.892735707301054}-{'f1_val': 0.8609115104602835, 'auprc': 0.9141035885833454, 'loss_val': 0.6449605056984349, 'psi': 0.8821883417095082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=24 head_norm_before_train=1.730835 (no previous merge yet)
[S17] round=24 local utility u=0.182996 metrics={'f1_val': 0.5760687546320685, 'auprc': 0.7766237331408323, 'loss_val': 0.6565724691815443, 'psi': 0.656290746035574}-{'f1_val': 0.5478278971337358, 'auprc': 0.7011059483754927, 'loss_val': 0.6265660094750658, 'psi': 0.6091391176304386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63214
[S13] RECEIVED delta(kind=head bytes=1803) from S6
[S13] cosine check vs S6: cos=-0.1425
[S13] DROPPED delta from S6 (cos=-0.1425 < 0.0)
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9987
[S2] START round=25 head_norm_before_train=1.536189 cos_to_last_merge=0.9798 (last merge round=16)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6967391232692324, 'auprc': 0.7274597106673758, 'loss_val': 0.8147499891992795, 'psi': 0.7090273582284897}-{'f1_val': 0.7137647603182954, 'auprc': 0.7402936264771494, 'loss_val': 0.7427663174921366, 'psi': 0.724376306781837}
[S3] START round=25 head_norm_before_train=1.030893 cos_to_last_merge=0.9926 (last merge round=22)
[S3] round=25 local utility u=0.147086 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9986065877205512, 'loss_val': 0.39878870668078836, 'psi': 0.8198963573294002}-{'f1_val': 0.677155647151851, 'auprc': 0.9939681871125947, 'loss_val': 0.5374413689650648, 'psi': 0.8038806631361485}
[S4] START round=25 head_norm_before_train=1.311303 cos_to_last_merge=0.9710 (last merge round=16)
[S4] round=25 local utility u=0.095849 metrics={'f1_val': 0.9507838849296278, 'auprc': 0.9807983996755224, 'loss_val': 0.2638019053306488, 'psi': 0.9627896908279856}-{'f1_val': 0.9396912256528765, 'auprc': 0.9393307746945331, 'loss_val': 0.26454008564678433, 'psi': 0.9395470452695391}
[S5] START round=25 head_norm_before_train=1.429656 cos_to_last_merge=0.9998 (last merge round=23)
[S5] round=25 local utility u=0.008007 metrics={'f1_val': 0.700320598491359, 'auprc': 0.995608599749932, 'loss_val': 0.25605873071518853, 'psi': 0.8184357989947881}-{'f1_val': 0.700320598491359, 'auprc': 0.9959465883035639, 'loss_val': 0.273087588000072, 'psi': 0.8185709944162409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=25 head_norm_before_train=1.739004 (no previous merge yet)
[S6] round=25 local utility u=0.391650 metrics={'f1_val': 0.821634557176284, 'auprc': 0.9595837588361384, 'loss_val': 0.3576870528456995, 'psi': 0.8768142378402257}-{'f1_val': 0.6991116546280103, 'auprc': 0.9595990604032961, 'loss_val': 0.4058954664307961, 'psi': 0.8033066169381247}
[S7] START round=25 head_norm_before_train=1.219567 cos_to_last_merge=0.9988 (last merge round=22)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.38166273895035924, 'auprc': 0.64560451635106, 'loss_val': 0.9336146349851681, 'psi': 0.4872394499106395}-{'f1_val': 0.6669706009185931, 'auprc': 0.783185089600266, 'loss_val': 0.6153398338270503, 'psi': 0.7134563963912622}
[S8] START round=25 head_norm_before_train=1.885605 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9921505420845177, 'auprc': 0.9883215055657807, 'loss_val': 0.06517284530504312, 'psi': 0.9906189274770228}-{'f1_val': 0.989929598471134, 'auprc': 0.998675920655034, 'loss_val': 0.045578454528452494, 'psi': 0.9934281273446941}
[S9] START round=25 head_norm_before_train=1.596245 cos_to_last_merge=0.7675 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.767
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9977601357619972, 'loss_val': 0.046121977875053725, 'psi': 0.9930713548099258}-{'f1_val': 0.9962500947792776, 'auprc': 0.9934085566613949, 'loss_val': 0.03866350604458478, 'psi': 0.9951134795321246}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.706331 cos_to_last_merge=0.9998 (last merge round=22)
[S10] round=25 local utility u=0.006438 metrics={'f1_val': 0.9940406171852029, 'auprc': 0.995199825999171, 'loss_val': 0.107277862907583, 'psi': 0.9945043007107901}-{'f1_val': 0.9949011811505593, 'auprc': 0.9953119731514755, 'loss_val': 0.12565439810928125, 'psi': 0.9950654979509257}
[S11] START round=25 head_norm_before_train=0.996714 cos_to_last_merge=0.9994 (last merge round=23)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9595377185543704, 'auprc': 0.9966713477605695, 'loss_val': 0.2118181801220977, 'psi': 0.9743911702368501}-{'f1_val': 0.9916728650652858, 'auprc': 0.9979916180353215, 'loss_val': 0.2490891667287853, 'psi': 0.9942003662533001}
[S13] START round=25 head_norm_before_train=1.173864 cos_to_last_merge=0.9521 (last merge round=13)
[S13] round=25 local utility u=0.105337 metrics={'f1_val': 0.5865387946047929, 'auprc': 0.6861423138927469, 'loss_val': 0.6959099834404223, 'psi': 0.6263802023199745}-{'f1_val': 0.5658872950705387, 'auprc': 0.7010832664607838, 'loss_val': 0.8274983600921498, 'psi': 0.6199656836266367}
[S14] START round=25 head_norm_before_train=1.680245 cos_to_last_merge=0.9990 (last merge round=21)
[S14] round=25 local utility u=0.008490 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9991094081969573, 'loss_val': 0.04759170952393041, 'psi': 0.997842268173382}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971047208156124, 'loss_val': 0.058558252983337215, 'psi': 0.997040393220844}
[S15] START round=25 head_norm_before_train=1.118166 cos_to_last_merge=0.9970 (last merge round=22)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.8437065137009638, 'auprc': 0.9881375253591335, 'loss_val': 0.248891439831705, 'psi': 0.9014789183642317}-{'f1_val': 0.8844245836651535, 'auprc': 0.986212124849005, 'loss_val': 0.22664365390879063, 'psi': 0.9251396001386942}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.900082 (no previous merge yet)
[S16] round=25 local utility u=0.768477 metrics={'f1_val': 0.9893420961818707, 'auprc': 0.9910864499805045, 'loss_val': 0.0763666755570276, 'psi': 0.9900398377013242}-{'f1_val': 0.8536481139548554, 'auprc': 0.9513670973203517, 'loss_val': 0.6799996621313866, 'psi': 0.892735707301054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=25 head_norm_before_train=1.754408 (no previous merge yet)
[S17] round=25 local utility u=0.315348 metrics={'f1_val': 0.5942175498141902, 'auprc': 0.9322572094755918, 'loss_val': 0.601670183871223, 'psi': 0.7294334136787508}-{'f1_val': 0.5760687546320685, 'auprc': 0.7766237331408323, 'loss_val': 0.6565724691815443, 'psi': 0.656290746035574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9970 head_norm=1.705984
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.155620e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9970 head_norm=1.705378 delta_norm=0.051556
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.087 → S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[S6] RECEIVED delta(kind=head bytes=1795) from S13
[S6] cosine check vs S13: cos=-0.1425
[S6] DROPPED delta from S13 (cos=-0.1425 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1425
[S13] DROPPED delta from S6 (cos=-0.1425 < 0.0)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] ⇄ pheromone p=0.352 → S13@127.0.0.1:63213
[S13] ⇄ pheromone p=0.094 → S6@127.0.0.1:63207
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9993
[S2] ⇄ pheromone p=0.020 → S8@127.0.0.1:63209
[S10] ⇄ pheromone p=0.129 → S14@127.0.0.1:63214
[S2] START round=26 head_norm_before_train=1.553914 cos_to_last_merge=0.9778 (last merge round=16)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6805169124960562, 'auprc': 0.7260520109279383, 'loss_val': 0.8998240247003676, 'psi': 0.698730951868809}-{'f1_val': 0.6967391232692324, 'auprc': 0.7274597106673758, 'loss_val': 0.8147499891992795, 'psi': 0.7090273582284897}
[S3] START round=26 head_norm_before_train=1.067640 cos_to_last_merge=0.9846 (last merge round=22)
[S3] round=26 local utility u=0.020040 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9980965938184017, 'loss_val': 0.3562777425884995, 'psi': 0.819602239027484}-{'f1_val': 0.7007562037352997, 'auprc': 0.9986065877205512, 'loss_val': 0.39878870668078836, 'psi': 0.8198963573294002}
[S4] START round=26 head_norm_before_train=1.337302 cos_to_last_merge=0.9675 (last merge round=16)
[S4] round=26 local utility u=0.015441 metrics={'f1_val': 0.9538955323106693, 'auprc': 0.9828810491270121, 'loss_val': 0.2578373360456014, 'psi': 0.9654897390372064}-{'f1_val': 0.9507838849296278, 'auprc': 0.9807983996755224, 'loss_val': 0.2638019053306488, 'psi': 0.9627896908279856}
[S5] START round=26 head_norm_before_train=1.449676 cos_to_last_merge=0.9993 (last merge round=23)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7124073669763791, 'auprc': 0.8224920798498617, 'loss_val': 0.3944318568698845, 'psi': 0.7564412521257722}-{'f1_val': 0.700320598491359, 'auprc': 0.995608599749932, 'loss_val': 0.25605873071518853, 'psi': 0.8184357989947881}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.743962 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.46412620268011917, 'auprc': 0.7750579367517141, 'loss_val': 0.9219641969242556, 'psi': 0.5884988963087572}-{'f1_val': 0.821634557176284, 'auprc': 0.9595837588361384, 'loss_val': 0.3576870528456995, 'psi': 0.8768142378402257}
[S7] START round=26 head_norm_before_train=1.233523 cos_to_last_merge=0.9974 (last merge round=22)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6673207144113041, 'auprc': 0.7872657659230097, 'loss_val': 0.5567167460548462, 'psi': 0.7152987350159864}-{'f1_val': 0.38166273895035924, 'auprc': 0.64560451635106, 'loss_val': 0.9336146349851681, 'psi': 0.4872394499106395}
[S8] START round=26 head_norm_before_train=1.899370 (no previous merge yet)
[S8] round=26 local utility u=0.030726 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9983316544594594, 'loss_val': 0.042043427896881265, 'psi': 0.9954522443602657}-{'f1_val': 0.9921505420845177, 'auprc': 0.9883215055657807, 'loss_val': 0.06517284530504312, 'psi': 0.9906189274770228}
[S9] START round=26 head_norm_before_train=1.613347 cos_to_last_merge=0.7653 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.765
[S9] round=26 local utility u=0.006491 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9984615631768268, 'loss_val': 0.04038482135375521, 'psi': 0.993865944167329}-{'f1_val': 0.9899455008418782, 'auprc': 0.9977601357619972, 'loss_val': 0.046121977875053725, 'psi': 0.9930713548099258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=26 head_norm_before_train=1.718175 cos_to_last_merge=0.9996 (last merge round=22)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9216759161598442, 'auprc': 0.9923953642172032, 'loss_val': 0.22334804696770202, 'psi': 0.9499636953827879}-{'f1_val': 0.9940406171852029, 'auprc': 0.995199825999171, 'loss_val': 0.107277862907583, 'psi': 0.9945043007107901}
[S11] START round=26 head_norm_before_train=1.025746 cos_to_last_merge=0.9976 (last merge round=23)
[S11] round=26 local utility u=0.017400 metrics={'f1_val': 0.9600079283012086, 'auprc': 0.9979628927607653, 'loss_val': 0.1837134129492076, 'psi': 0.9751899140850313}-{'f1_val': 0.9595377185543704, 'auprc': 0.9966713477605695, 'loss_val': 0.2118181801220977, 'psi': 0.9743911702368501}
[S13] START round=26 head_norm_before_train=1.184709 cos_to_last_merge=0.9480 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5936015855291394, 'auprc': 0.6347832291805519, 'loss_val': 0.6661818228633558, 'psi': 0.6100742429897044}-{'f1_val': 0.5865387946047929, 'auprc': 0.6861423138927469, 'loss_val': 0.6959099834404223, 'psi': 0.6263802023199745}
[S14] START round=26 head_norm_before_train=1.705378 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.003518 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991127849260062, 'loss_val': 0.04302973935321484, 'psi': 0.9980900756714378}-{'f1_val': 0.9969975081576651, 'auprc': 0.9991094081969573, 'loss_val': 0.04759170952393041, 'psi': 0.997842268173382}
[S15] START round=26 head_norm_before_train=1.151718 cos_to_last_merge=0.9948 (last merge round=22)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7498311210797114, 'auprc': 0.9869650538381778, 'loss_val': 0.3135757851103999, 'psi': 0.844684694183098}-{'f1_val': 0.8437065137009638, 'auprc': 0.9881375253591335, 'loss_val': 0.248891439831705, 'psi': 0.9014789183642317}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.916290 (no previous merge yet)
[S16] round=26 local utility u=0.008282 metrics={'f1_val': 0.9897632756813073, 'auprc': 0.9924392588674606, 'loss_val': 0.06638907164518439, 'psi': 0.9908336689557686}-{'f1_val': 0.9893420961818707, 'auprc': 0.9910864499805045, 'loss_val': 0.0763666755570276, 'psi': 0.9900398377013242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=26 head_norm_before_train=1.782417 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.39409893199349333, 'auprc': 0.6922004670060827, 'loss_val': 1.007034897266259, 'psi': 0.513339545998529}-{'f1_val': 0.5942175498141902, 'auprc': 0.9322572094755918, 'loss_val': 0.601670183871223, 'psi': 0.7294334136787508}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0131
[S2] DROPPED delta from S8 (cos=-0.0131 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9986
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9974 head_norm=1.731536
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.984039e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9974 head_norm=1.724408 delta_norm=0.039840
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9217 head_norm=1.732495
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.586365e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9245 head_norm=1.731408 delta_norm=0.045864
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.573217 cos_to_last_merge=0.9752 (last merge round=16)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6614023919333412, 'auprc': 0.7171100365237616, 'loss_val': 0.9720526551001398, 'psi': 0.6836854497695093}-{'f1_val': 0.6805169124960562, 'auprc': 0.7260520109279383, 'loss_val': 0.8998240247003676, 'psi': 0.698730951868809}
[S3] START round=27 head_norm_before_train=1.106774 cos_to_last_merge=0.9761 (last merge round=22)
[S3] round=27 local utility u=0.009433 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9981758932812171, 'loss_val': 0.33764975250137874, 'psi': 0.8196339588126103}-{'f1_val': 0.7006060025002057, 'auprc': 0.9980965938184017, 'loss_val': 0.3562777425884995, 'psi': 0.819602239027484}
[S4] START round=27 head_norm_before_train=1.360876 cos_to_last_merge=0.9642 (last merge round=16)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9490105195186996, 'auprc': 0.9800894719258991, 'loss_val': 0.26316480729611513, 'psi': 0.9614421004815794}-{'f1_val': 0.9538955323106693, 'auprc': 0.9828810491270121, 'loss_val': 0.2578373360456014, 'psi': 0.9654897390372064}
[S5] START round=27 head_norm_before_train=1.466725 cos_to_last_merge=0.9986 (last merge round=23)
[S5] round=27 local utility u=0.272968 metrics={'f1_val': 0.7010414965223207, 'auprc': 0.9818387393378423, 'loss_val': 0.2583408414525805, 'psi': 0.8133603936485294}-{'f1_val': 0.7124073669763791, 'auprc': 0.8224920798498617, 'loss_val': 0.3944318568698845, 'psi': 0.7564412521257722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=27 head_norm_before_train=1.747181 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9608971554364456, 'auprc': 0.9818643087676637, 'loss_val': 0.17310297923693213, 'psi': 0.9692840167689328}-{'f1_val': 0.46412620268011917, 'auprc': 0.7750579367517141, 'loss_val': 0.9219641969242556, 'psi': 0.5884988963087572}
[S7] START round=27 head_norm_before_train=1.248612 cos_to_last_merge=0.9957 (last merge round=22)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.40410285275183266, 'auprc': 0.7261148965906148, 'loss_val': 0.9009297366028182, 'psi': 0.5329076702873455}-{'f1_val': 0.6673207144113041, 'auprc': 0.7872657659230097, 'loss_val': 0.5567167460548462, 'psi': 0.7152987350159864}
[S8] START round=27 head_norm_before_train=1.910550 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9867128099339056, 'auprc': 0.9986671569293192, 'loss_val': 0.046864240423124724, 'psi': 0.9914945487320711}-{'f1_val': 0.9935326376274699, 'auprc': 0.9983316544594594, 'loss_val': 0.042043427896881265, 'psi': 0.9954522443602657}
[S9] START round=27 head_norm_before_train=1.628840 cos_to_last_merge=0.7632 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.763
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.998473155423226, 'loss_val': 0.04015428839172356, 'psi': 0.99361732234117}-{'f1_val': 0.9908021981609972, 'auprc': 0.9984615631768268, 'loss_val': 0.04038482135375521, 'psi': 0.993865944167329}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.731408 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.016157 metrics={'f1_val': 0.9252966493830697, 'auprc': 0.9924465695189548, 'loss_val': 0.21291148297616713, 'psi': 0.9521566174374237}-{'f1_val': 0.9216759161598442, 'auprc': 0.9923953642172032, 'loss_val': 0.22334804696770202, 'psi': 0.9499636953827879}
[S11] START round=27 head_norm_before_train=1.061167 cos_to_last_merge=0.9942 (last merge round=23)
[S11] round=27 local utility u=0.128380 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9971322616883049, 'loss_val': 0.14723044893433723, 'psi': 0.9971346543111005}-{'f1_val': 0.9600079283012086, 'auprc': 0.9979628927607653, 'loss_val': 0.1837134129492076, 'psi': 0.9751899140850313}
[S13] START round=27 head_norm_before_train=1.200460 cos_to_last_merge=0.9433 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.562802780932782, 'auprc': 0.696853573214432, 'loss_val': 0.8369543906819255, 'psi': 0.6164230978454419}-{'f1_val': 0.5936015855291394, 'auprc': 0.6347832291805519, 'loss_val': 0.6661818228633558, 'psi': 0.6100742429897044}
[S14] START round=27 head_norm_before_train=1.724408 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.002400 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990747122391146, 'loss_val': 0.039572954088467116, 'psi': 0.998220555725558}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991127849260062, 'loss_val': 0.04302973935321484, 'psi': 0.9980900756714378}
[S15] START round=27 head_norm_before_train=1.188470 cos_to_last_merge=0.9920 (last merge round=22)
[S15] round=27 local utility u=0.070531 metrics={'f1_val': 0.7703545344374838, 'auprc': 0.9856716552848054, 'loss_val': 0.29177329441407596, 'psi': 0.8564813827764124}-{'f1_val': 0.7498311210797114, 'auprc': 0.9869650538381778, 'loss_val': 0.3135757851103999, 'psi': 0.844684694183098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=27 head_norm_before_train=1.932542 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9146582048010744, 'auprc': 0.9852307233524705, 'loss_val': 0.39635674539893945, 'psi': 0.9428872122216327}-{'f1_val': 0.9897632756813073, 'auprc': 0.9924392588674606, 'loss_val': 0.06638907164518439, 'psi': 0.9908336689557686}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.806891 (no previous merge yet)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.5931540557667827, 'auprc': 0.9370983067295726, 'loss_val': 0.6169987425144454, 'psi': 0.7307317561518987}-{'f1_val': 0.39409893199349333, 'auprc': 0.6922004670060827, 'loss_val': 1.007034897266259, 'psi': 0.513339545998529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:63214
[S13] RECEIVED delta(kind=head bytes=1803) from S6
[S13] cosine check vs S6: cos=-0.1442
[S13] DROPPED delta from S6 (cos=-0.1442 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=0.9997
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9997
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9253 head_norm=1.746851
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.185848e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9258 head_norm=1.747931 delta_norm=0.021858
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.591140 cos_to_last_merge=0.9726 (last merge round=16)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6072100471040688, 'auprc': 0.7001527920521964, 'loss_val': 1.1451295964825916, 'psi': 0.6443871450833198}-{'f1_val': 0.6614023919333412, 'auprc': 0.7171100365237616, 'loss_val': 0.9720526551001398, 'psi': 0.6836854497695093}
[S3] START round=28 head_norm_before_train=1.137998 cos_to_last_merge=0.9697 (last merge round=22)
[S3] round=28 local utility u=0.011568 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9985116749490541, 'loss_val': 0.31597112417149, 'psi': 0.8198132457788225}-{'f1_val': 0.7006060025002057, 'auprc': 0.9981758932812171, 'loss_val': 0.33764975250137874, 'psi': 0.8196339588126103}
[S4] START round=28 head_norm_before_train=1.380189 cos_to_last_merge=0.9615 (last merge round=16)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.940585959688138, 'auprc': 0.9370250586941687, 'loss_val': 0.2798657712557193, 'psi': 0.9391615992905502}-{'f1_val': 0.9490105195186996, 'auprc': 0.9800894719258991, 'loss_val': 0.26316480729611513, 'psi': 0.9614421004815794}
[S5] START round=28 head_norm_before_train=1.482164 cos_to_last_merge=0.9979 (last merge round=23)
[S5] round=28 local utility u=0.041295 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9952867947864092, 'loss_val': 0.211769530481986, 'psi': 0.8183070770093791}-{'f1_val': 0.7010414965223207, 'auprc': 0.9818387393378423, 'loss_val': 0.2583408414525805, 'psi': 0.8133603936485294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=28 head_norm_before_train=1.750866 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7709723566262886, 'auprc': 0.8158728201421845, 'loss_val': 0.5454115093103504, 'psi': 0.788932542032647}-{'f1_val': 0.9608971554364456, 'auprc': 0.9818643087676637, 'loss_val': 0.17310297923693213, 'psi': 0.9692840167689328}
[S7] START round=28 head_norm_before_train=1.264341 cos_to_last_merge=0.9935 (last merge round=22)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.38733453775984494, 'auprc': 0.648142360767914, 'loss_val': 0.9780654534986963, 'psi': 0.49165766696307256}-{'f1_val': 0.40410285275183266, 'auprc': 0.7261148965906148, 'loss_val': 0.9009297366028182, 'psi': 0.5329076702873455}
[S8] START round=28 head_norm_before_train=1.923040 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9836436583279925, 'auprc': 0.9985961909102539, 'loss_val': 0.05591752134199231, 'psi': 0.989624671360897}-{'f1_val': 0.9867128099339056, 'auprc': 0.9986671569293192, 'loss_val': 0.046864240423124724, 'psi': 0.9914945487320711}
[S9] START round=28 head_norm_before_train=1.644593 cos_to_last_merge=0.7611 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.761
[S9] round=28 local utility u=0.000984 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9984738189535729, 'loss_val': 0.038188321520792094, 'psi': 0.9936175877533088}-{'f1_val': 0.9903801002864661, 'auprc': 0.998473155423226, 'loss_val': 0.04015428839172356, 'psi': 0.99361732234117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=28 head_norm_before_train=1.747931 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.274089 metrics={'f1_val': 0.99406584719663, 'auprc': 0.9952850714615682, 'loss_val': 0.08586375644372264, 'psi': 0.9945535369026053}-{'f1_val': 0.9252966493830697, 'auprc': 0.9924465695189548, 'loss_val': 0.21291148297616713, 'psi': 0.9521566174374237}
[S11] START round=28 head_norm_before_train=1.098581 cos_to_last_merge=0.9894 (last merge round=23)
[S11] round=28 local utility u=0.013052 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.997082069472035, 'loss_val': 0.11849354397874269, 'psi': 0.9968662795377232}-{'f1_val': 0.9971362493929642, 'auprc': 0.9971322616883049, 'loss_val': 0.14723044893433723, 'psi': 0.9971346543111005}
[S13] START round=28 head_norm_before_train=1.215564 cos_to_last_merge=0.9403 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=28 local utility u=0.077206 metrics={'f1_val': 0.5866054228123161, 'auprc': 0.6760042103869834, 'loss_val': 0.7628094111662569, 'psi': 0.6223649378421829}-{'f1_val': 0.562802780932782, 'auprc': 0.696853573214432, 'loss_val': 0.8369543906819255, 'psi': 0.6164230978454419}
[S14] START round=28 head_norm_before_train=1.749283 cos_to_last_merge=0.9999 (last merge round=26)
[S14] round=28 local utility u=0.002725 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9990721670143534, 'loss_val': 0.03658307067676467, 'psi': 0.9984662867149492}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990747122391146, 'loss_val': 0.039572954088467116, 'psi': 0.998220555725558}
[S15] START round=28 head_norm_before_train=1.221295 cos_to_last_merge=0.9892 (last merge round=22)
[S15] round=28 local utility u=0.782484 metrics={'f1_val': 0.9963989292454516, 'auprc': 0.991101665536087, 'loss_val': 0.09936084538176852, 'psi': 0.9942800237617058}-{'f1_val': 0.7703545344374838, 'auprc': 0.9856716552848054, 'loss_val': 0.29177329441407596, 'psi': 0.8564813827764124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=28 head_norm_before_train=1.947670 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8705215735541465, 'auprc': 0.9260222445576982, 'loss_val': 0.6244067539285978, 'psi': 0.8927218419555671}-{'f1_val': 0.9146582048010744, 'auprc': 0.9852307233524705, 'loss_val': 0.39635674539893945, 'psi': 0.9428872122216327}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.824227 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5806577978960605, 'auprc': 0.8630530689903346, 'loss_val': 0.7637299626280439, 'psi': 0.6936159063337701}-{'f1_val': 0.5931540557667827, 'auprc': 0.9370983067295726, 'loss_val': 0.6169987425144454, 'psi': 0.7307317561518987}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63214
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9995
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=-0.1445
[S6] DROPPED delta from S13 (cos=-0.1445 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9981 head_norm=1.771980
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.300241e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9981 head_norm=1.759151 delta_norm=0.033002
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9941 head_norm=1.763216
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.772604e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9941 head_norm=1.767386 delta_norm=0.027726
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.607325 cos_to_last_merge=0.9702 (last merge round=16)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6230922073002634, 'auprc': 0.707639225968014, 'loss_val': 1.2984410314880097, 'psi': 0.6569110147673636}-{'f1_val': 0.6072100471040688, 'auprc': 0.7001527920521964, 'loss_val': 1.1451295964825916, 'psi': 0.6443871450833198}
[S3] START round=29 head_norm_before_train=1.164912 cos_to_last_merge=0.9643 (last merge round=22)
[S3] round=29 local utility u=0.003786 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.998926310097253, 'loss_val': 0.31054784489292203, 'psi': 0.8200695650541876}-{'f1_val': 0.7006809596653347, 'auprc': 0.9985116749490541, 'loss_val': 0.31597112417149, 'psi': 0.8198132457788225}
[S4] START round=29 head_norm_before_train=1.399428 cos_to_last_merge=0.9588 (last merge round=16)
[S4] round=29 local utility u=0.032639 metrics={'f1_val': 0.9446845604115247, 'auprc': 0.9469536499314177, 'loss_val': 0.2689653077880013, 'psi': 0.945592196219482}-{'f1_val': 0.940585959688138, 'auprc': 0.9370250586941687, 'loss_val': 0.2798657712557193, 'psi': 0.9391615992905502}
[S5] START round=29 head_norm_before_train=1.498181 cos_to_last_merge=0.9972 (last merge round=23)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7138808545923863, 'auprc': 0.7996071495597386, 'loss_val': 0.42824675215529945, 'psi': 0.7481713725793272}-{'f1_val': 0.700320598491359, 'auprc': 0.9952867947864092, 'loss_val': 0.211769530481986, 'psi': 0.8183070770093791}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.753390 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.741918286639356, 'auprc': 0.7966461305765288, 'loss_val': 0.5502178130537296, 'psi': 0.763809424214225}-{'f1_val': 0.7709723566262886, 'auprc': 0.8158728201421845, 'loss_val': 0.5454115093103504, 'psi': 0.788932542032647}
[S7] START round=29 head_norm_before_train=1.276574 cos_to_last_merge=0.9916 (last merge round=22)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.651319323869477, 'auprc': 0.8366635823487433, 'loss_val': 0.5641186061929455, 'psi': 0.7254570272611836}-{'f1_val': 0.38733453775984494, 'auprc': 0.648142360767914, 'loss_val': 0.9780654534986963, 'psi': 0.49165766696307256}
[S8] START round=29 head_norm_before_train=1.936360 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9859707310140916, 'loss_val': 0.37133135327006916, 'psi': 0.8225351332799957}-{'f1_val': 0.9836436583279925, 'auprc': 0.9985961909102539, 'loss_val': 0.05591752134199231, 'psi': 0.989624671360897}
[S9] START round=29 head_norm_before_train=1.658289 cos_to_last_merge=0.7593 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.759
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9984943224639858, 'loss_val': 0.043816174360612595, 'psi': 0.9923461412894627}-{'f1_val': 0.9903801002864661, 'auprc': 0.9984738189535729, 'loss_val': 0.038188321520792094, 'psi': 0.9936175877533088}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.767386 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.995203457536764, 'loss_val': 0.09605816817085673, 'psi': 0.9945355783128739}-{'f1_val': 0.99406584719663, 'auprc': 0.9952850714615682, 'loss_val': 0.08586375644372264, 'psi': 0.9945535369026053}
[S11] START round=29 head_norm_before_train=1.140664 cos_to_last_merge=0.9834 (last merge round=23)
[S11] round=29 local utility u=0.012400 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9985405432884348, 'loss_val': 0.09806988279216601, 'psi': 0.9974496690642831}-{'f1_val': 0.9967224195815153, 'auprc': 0.997082069472035, 'loss_val': 0.11849354397874269, 'psi': 0.9968662795377232}
[S13] START round=29 head_norm_before_train=1.229610 cos_to_last_merge=0.9382 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=29 local utility u=0.061342 metrics={'f1_val': 0.5944713607169736, 'auprc': 0.6727721399801739, 'loss_val': 0.6776255905083038, 'psi': 0.6257916724222536}-{'f1_val': 0.5866054228123161, 'auprc': 0.6760042103869834, 'loss_val': 0.7628094111662569, 'psi': 0.6223649378421829}
[S14] START round=29 head_norm_before_train=1.759151 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990034044273695, 'loss_val': 0.035243461908692604, 'psi': 0.9980463234719832}-{'f1_val': 0.9980623665153463, 'auprc': 0.9990721670143534, 'loss_val': 0.03658307067676467, 'psi': 0.9984662867149492}
[S15] START round=29 head_norm_before_train=1.252541 cos_to_last_merge=0.9862 (last merge round=22)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9933166449538194, 'auprc': 0.994906992327691, 'loss_val': 0.098852825906056, 'psi': 0.993952783903368}-{'f1_val': 0.9963989292454516, 'auprc': 0.991101665536087, 'loss_val': 0.09936084538176852, 'psi': 0.9942800237617058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.959089 (no previous merge yet)
[S16] round=29 local utility u=0.385924 metrics={'f1_val': 0.9244327939438277, 'auprc': 0.9905740324285908, 'loss_val': 0.3696807066955116, 'psi': 0.950889289337733}-{'f1_val': 0.8705215735541465, 'auprc': 0.9260222445576982, 'loss_val': 0.6244067539285978, 'psi': 0.8927218419555671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=29 head_norm_before_train=1.838060 (no previous merge yet)
[S17] round=29 local utility u=0.067114 metrics={'f1_val': 0.5927718835329703, 'auprc': 0.8802315328885146, 'loss_val': 0.7537217236792881, 'psi': 0.707755743275188}-{'f1_val': 0.5806577978960605, 'auprc': 0.8630530689903346, 'loss_val': 0.7637299626280439, 'psi': 0.6936159063337701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9974 head_norm=1.780864
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.137646e-02
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9974 head_norm=1.771933 delta_norm=0.021376
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1439
[S6] DROPPED delta from S13 (cos=-0.1439 < 0.0)
[S2] START round=30 head_norm_before_train=1.619681 cos_to_last_merge=0.9685 (last merge round=16)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6202276214167213, 'auprc': 0.7028172478889521, 'loss_val': 1.3392678023234286, 'psi': 0.6532634720056136}-{'f1_val': 0.6230922073002634, 'auprc': 0.707639225968014, 'loss_val': 1.2984410314880097, 'psi': 0.6569110147673636}
[S3] START round=30 head_norm_before_train=1.190919 cos_to_last_merge=0.9595 (last merge round=22)
[S3] round=30 local utility u=0.012347 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9995125855959168, 'loss_val': 0.28761334870561844, 'psi': 0.8203040752536532}-{'f1_val': 0.7008317350254774, 'auprc': 0.998926310097253, 'loss_val': 0.31054784489292203, 'psi': 0.8200695650541876}
[S4] START round=30 head_norm_before_train=1.418949 cos_to_last_merge=0.9560 (last merge round=16)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9415651732758712, 'auprc': 0.9424784698890538, 'loss_val': 0.27321997361204176, 'psi': 0.9419304919211442}-{'f1_val': 0.9446845604115247, 'auprc': 0.9469536499314177, 'loss_val': 0.2689653077880013, 'psi': 0.945592196219482}
[S5] START round=30 head_norm_before_train=1.514822 cos_to_last_merge=0.9961 (last merge round=23)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9346264966125452, 'auprc': 0.9965935269663073, 'loss_val': 0.18168372250700082, 'psi': 0.95941330875405}-{'f1_val': 0.7138808545923863, 'auprc': 0.7996071495597386, 'loss_val': 0.42824675215529945, 'psi': 0.7481713725793272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=30 head_norm_before_train=1.761405 (no previous merge yet)
[S6] round=30 local utility u=0.411170 metrics={'f1_val': 0.8043960592611094, 'auprc': 0.9357072345153725, 'loss_val': 0.5199270533404259, 'psi': 0.8569205293628146}-{'f1_val': 0.741918286639356, 'auprc': 0.7966461305765288, 'loss_val': 0.5502178130537296, 'psi': 0.763809424214225}
[S7] START round=30 head_norm_before_train=1.285428 cos_to_last_merge=0.9902 (last merge round=22)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.45178027002829324, 'auprc': 0.7812407767886929, 'loss_val': 0.8595677518059791, 'psi': 0.5835644727324532}-{'f1_val': 0.651319323869477, 'auprc': 0.8366635823487433, 'loss_val': 0.5641186061929455, 'psi': 0.7254570272611836}
[S8] START round=30 head_norm_before_train=1.949704 (no previous merge yet)
[S8] round=30 local utility u=1.000000 metrics={'f1_val': 0.9881372834100528, 'auprc': 0.9986774100084969, 'loss_val': 0.042235822061555586, 'psi': 0.9923533340494304}-{'f1_val': 0.7135780681239317, 'auprc': 0.9859707310140916, 'loss_val': 0.37133135327006916, 'psi': 0.8225351332799957}
[S9] START round=30 head_norm_before_train=1.672194 cos_to_last_merge=0.7577 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.758
[S9] round=30 local utility u=0.031564 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964935350879833, 'loss_val': 0.027818603165906796, 'psi': 0.996859161542479}-{'f1_val': 0.9882473538397808, 'auprc': 0.9984943224639858, 'loss_val': 0.043816174360612595, 'psi': 0.9923461412894627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=30 head_norm_before_train=1.787899 cos_to_last_merge=0.9999 (last merge round=28)
[S10] round=30 local utility u=0.013871 metrics={'f1_val': 0.9946988340531434, 'auprc': 0.9953681175417637, 'loss_val': 0.07246125630683828, 'psi': 0.9949665474485916}-{'f1_val': 0.9940903254969471, 'auprc': 0.995203457536764, 'loss_val': 0.09605816817085673, 'psi': 0.9945355783128739}
[S11] START round=30 head_norm_before_train=1.183360 cos_to_last_merge=0.9773 (last merge round=23)
[S11] round=30 local utility u=0.007245 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9980379663447726, 'loss_val': 0.08207142470870589, 'psi': 0.9972486382868182}-{'f1_val': 0.9967224195815153, 'auprc': 0.9985405432884348, 'loss_val': 0.09806988279216601, 'psi': 0.9974496690642831}
[S13] START round=30 head_norm_before_train=1.245053 cos_to_last_merge=0.9354 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.57078864134886, 'auprc': 0.687835720099133, 'loss_val': 0.7605397311848948, 'psi': 0.6176074728489691}-{'f1_val': 0.5944713607169736, 'auprc': 0.6727721399801739, 'loss_val': 0.6776255905083038, 'psi': 0.6257916724222536}
[S14] START round=30 head_norm_before_train=1.771933 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985423764721244, 'loss_val': 0.037014842422276165, 'psi': 0.9976022506391156}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990034044273695, 'loss_val': 0.035243461908692604, 'psi': 0.9980463234719832}
[S15] START round=30 head_norm_before_train=1.280652 cos_to_last_merge=0.9835 (last merge round=22)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7007174010114438, 'auprc': 0.9060676875422595, 'loss_val': 0.4092802584343698, 'psi': 0.78285751562377}-{'f1_val': 0.9933166449538194, 'auprc': 0.994906992327691, 'loss_val': 0.098852825906056, 'psi': 0.993952783903368}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.971415 (no previous merge yet)
[S16] round=30 local utility u=0.305571 metrics={'f1_val': 0.9774499037484317, 'auprc': 0.9923584862300399, 'loss_val': 0.08199519589307443, 'psi': 0.983413336741075}-{'f1_val': 0.9244327939438277, 'auprc': 0.9905740324285908, 'loss_val': 0.3696807066955116, 'psi': 0.950889289337733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=30 head_norm_before_train=1.853010 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.561146516838983, 'auprc': 0.7608602439587158, 'loss_val': 1.028255429399812, 'psi': 0.6410320076868761}-{'f1_val': 0.5927718835329703, 'auprc': 0.8802315328885146, 'loss_val': 0.7537217236792881, 'psi': 0.707755743275188}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10]  timeout peer S5
[S4]  timeout peer S7
[S7]  timeout peer S3
[S2]  timeout peer S4
[S11]  timeout peer S15
[S3]  timeout peer S11
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:63213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S14] ⇄ pheromone p=0.011 → S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63214
[S13] ⇄ pheromone p=0.050 → S6@127.0.0.1:63207
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S6
[S13] cosine check vs S6: cos=-0.1445
[S13] DROPPED delta from S6 (cos=-0.1445 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=-0.0128
[S2] DROPPED delta from S8 (cos=-0.0128 < 0.0)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] ⇄ pheromone p=0.006 → S8@127.0.0.1:63209
[S8] ⇄ pheromone p=0.231 → S2@127.0.0.1:63202
[S6] ⇄ pheromone p=0.300 → S13@127.0.0.1:63213
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9996
[S10] ⇄ pheromone p=0.082 → S14@127.0.0.1:63214
[S2] START round=31 head_norm_before_train=1.630406 cos_to_last_merge=0.9669 (last merge round=16)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6039587974880639, 'auprc': 0.6855508027383249, 'loss_val': 1.4116035443314556, 'psi': 0.6365955995881682}-{'f1_val': 0.6202276214167213, 'auprc': 0.7028172478889521, 'loss_val': 1.3392678023234286, 'psi': 0.6532634720056136}
[S3] START round=31 head_norm_before_train=1.217000 cos_to_last_merge=0.9540 (last merge round=22)
[S3] round=31 local utility u=0.011788 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9991983867693449, 'loss_val': 0.26219042004677007, 'psi': 0.8200879305069388}-{'f1_val': 0.7008317350254774, 'auprc': 0.9995125855959168, 'loss_val': 0.28761334870561844, 'psi': 0.8203040752536532}
[S3] not sending this round → trigger blocked (psi=0.820)
[S4] START round=31 head_norm_before_train=1.439279 cos_to_last_merge=0.9531 (last merge round=16)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9402074098204879, 'auprc': 0.9370403034544509, 'loss_val': 0.28632251692887883, 'psi': 0.9389405672740732}-{'f1_val': 0.9415651732758712, 'auprc': 0.9424784698890538, 'loss_val': 0.27321997361204176, 'psi': 0.9419304919211442}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.528862 cos_to_last_merge=0.9951 (last merge round=23)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7140122240634571, 'auprc': 0.7935054048611526, 'loss_val': 0.5154702934207, 'psi': 0.7458094963825354}-{'f1_val': 0.9346264966125452, 'auprc': 0.9965935269663073, 'loss_val': 0.18168372250700082, 'psi': 0.95941330875405}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.770764 (no previous merge yet)
[S6] round=31 local utility u=0.159488 metrics={'f1_val': 0.8223065257711784, 'auprc': 0.9556677182299442, 'loss_val': 0.36829455347573914, 'psi': 0.8756510027546847}-{'f1_val': 0.8043960592611094, 'auprc': 0.9357072345153725, 'loss_val': 0.5199270533404259, 'psi': 0.8569205293628146}
[S7] START round=31 head_norm_before_train=1.294118 cos_to_last_merge=0.9888 (last merge round=22)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.39782012052621424, 'auprc': 0.7644608373652144, 'loss_val': 0.9998601263828893, 'psi': 0.5444764072618143}-{'f1_val': 0.45178027002829324, 'auprc': 0.7812407767886929, 'loss_val': 0.8595677518059791, 'psi': 0.5835644727324532}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.958401 (no previous merge yet)
[S8] round=31 local utility u=0.006899 metrics={'f1_val': 0.989929598471134, 'auprc': 0.9986691693942303, 'loss_val': 0.03916629854194064, 'psi': 0.9934254268403726}-{'f1_val': 0.9881372834100528, 'auprc': 0.9986774100084969, 'loss_val': 0.042235822061555586, 'psi': 0.9923533340494304}
[S9] START round=31 head_norm_before_train=1.686131 cos_to_last_merge=0.7561 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.756
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9984608912443337, 'loss_val': 0.03982612804682478, 'psi': 0.9930974235685596}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964935350879833, 'loss_val': 0.027818603165906796, 'psi': 0.996859161542479}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.810619 cos_to_last_merge=0.9995 (last merge round=28)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9905493776799077, 'auprc': 0.9938731010894946, 'loss_val': 0.10246348297712014, 'psi': 0.9918788670437425}-{'f1_val': 0.9946988340531434, 'auprc': 0.9953681175417637, 'loss_val': 0.07246125630683828, 'psi': 0.9949665474485916}
[S11] START round=31 head_norm_before_train=1.223283 cos_to_last_merge=0.9718 (last merge round=23)
[S11] round=31 local utility u=0.001598 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9961375468039821, 'loss_val': 0.07069317114613145, 'psi': 0.9962404694918141}-{'f1_val': 0.9967224195815153, 'auprc': 0.9980379663447726, 'loss_val': 0.08207142470870589, 'psi': 0.9972486382868182}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=31 head_norm_before_train=1.260165 cos_to_last_merge=0.9335 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=31 local utility u=0.053204 metrics={'f1_val': 0.5862493036890802, 'auprc': 0.6785457785552258, 'loss_val': 0.71902597304553, 'psi': 0.6231678936355385}-{'f1_val': 0.57078864134886, 'auprc': 0.687835720099133, 'loss_val': 0.7605397311848948, 'psi': 0.6176074728489691}
[S14] START round=31 head_norm_before_train=1.789710 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=31 local utility u=0.000620 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9983157609152934, 'loss_val': 0.03524602690168656, 'psi': 0.997526732294664}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985423764721244, 'loss_val': 0.037014842422276165, 'psi': 0.9976022506391156}
[S15] START round=31 head_norm_before_train=1.308186 cos_to_last_merge=0.9809 (last merge round=22)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9941958262497868, 'auprc': 0.993427926634523, 'loss_val': 0.07426869966724439, 'psi': 0.9938886664036812}-{'f1_val': 0.7007174010114438, 'auprc': 0.9060676875422595, 'loss_val': 0.4092802584343698, 'psi': 0.78285751562377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=31 head_norm_before_train=1.985214 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9608343403648612, 'auprc': 0.9928512803753906, 'loss_val': 0.1181584466541057, 'psi': 0.973641116369073}-{'f1_val': 0.9774499037484317, 'auprc': 0.9923584862300399, 'loss_val': 0.08199519589307443, 'psi': 0.983413336741075}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.863846 (no previous merge yet)
[S17] round=31 local utility u=0.631442 metrics={'f1_val': 0.5993340364515909, 'auprc': 0.9969410546151299, 'loss_val': 0.70273855493191, 'psi': 0.7583768437170065}-{'f1_val': 0.561146516838983, 'auprc': 0.7608602439587158, 'loss_val': 1.028255429399812, 'psi': 0.6410320076868761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1445
[S13] DROPPED delta from S6 (cos=-0.1445 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1445
[S6] DROPPED delta from S13 (cos=-0.1445 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9990
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=-0.0133
[S2] DROPPED delta from S8 (cos=-0.0133 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9970 head_norm=1.803697
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.887489e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9970 head_norm=1.806931 delta_norm=0.028875
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.646447 cos_to_last_merge=0.9645 (last merge round=16)
[S2] round=32 local utility u=0.180577 metrics={'f1_val': 0.6302559302607571, 'auprc': 0.6857795803278104, 'loss_val': 1.2089178067943782, 'psi': 0.6524653902875783}-{'f1_val': 0.6039587974880639, 'auprc': 0.6855508027383249, 'loss_val': 1.4116035443314556, 'psi': 0.6365955995881682}
[S3] START round=32 head_norm_before_train=1.242995 cos_to_last_merge=0.9490 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=32 local utility u=0.006829 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9991897527519458, 'loss_val': 0.24850741567332127, 'psi': 0.8200844768999791}-{'f1_val': 0.7006809596653347, 'auprc': 0.9991983867693449, 'loss_val': 0.26219042004677007, 'psi': 0.8200879305069388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=32 head_norm_before_train=1.455776 cos_to_last_merge=0.9506 (last merge round=16)
[S4] round=32 local utility u=0.018053 metrics={'f1_val': 0.9393864973879131, 'auprc': 0.9498784647511959, 'loss_val': 0.28380534667502816, 'psi': 0.9435832843332262}-{'f1_val': 0.9402074098204879, 'auprc': 0.9370403034544509, 'loss_val': 0.28632251692887883, 'psi': 0.9389405672740732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=32 head_norm_before_train=1.538212 cos_to_last_merge=0.9944 (last merge round=23)
[S5] round=32 local utility u=0.513239 metrics={'f1_val': 0.7267407497872846, 'auprc': 0.9971626267058249, 'loss_val': 0.1763347365300004, 'psi': 0.8349095005547007}-{'f1_val': 0.7140122240634571, 'auprc': 0.7935054048611526, 'loss_val': 0.5154702934207, 'psi': 0.7458094963825354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=32 head_norm_before_train=1.781594 (no previous merge yet)
[S6] round=32 local utility u=0.020493 metrics={'f1_val': 0.8237281851629136, 'auprc': 0.9622744213211671, 'loss_val': 0.35565905450059093, 'psi': 0.8791466796262151}-{'f1_val': 0.8223065257711784, 'auprc': 0.9556677182299442, 'loss_val': 0.36829455347573914, 'psi': 0.8756510027546847}
[S7] START round=32 head_norm_before_train=1.305544 cos_to_last_merge=0.9870 (last merge round=22)
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.6350430690640585, 'auprc': 0.8348107097363112, 'loss_val': 0.5637063685919607, 'psi': 0.7149501253329595}-{'f1_val': 0.39782012052621424, 'auprc': 0.7644608373652144, 'loss_val': 0.9998601263828893, 'psi': 0.5444764072618143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=32 head_norm_before_train=1.964323 (no previous merge yet)
[S8] round=32 local utility u=0.008399 metrics={'f1_val': 0.992392260479464, 'auprc': 0.998657371837666, 'loss_val': 0.037109420521879675, 'psi': 0.9948983050227449}-{'f1_val': 0.989929598471134, 'auprc': 0.9986691693942303, 'loss_val': 0.03916629854194064, 'psi': 0.9934254268403726}
[S9] START round=32 head_norm_before_train=1.701075 cos_to_last_merge=0.7545 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.754
[S9] round=32 local utility u=0.014571 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9984688248956569, 'loss_val': 0.03100693345983452, 'psi': 0.9951303999966662}-{'f1_val': 0.9895217784513768, 'auprc': 0.9984608912443337, 'loss_val': 0.03982612804682478, 'psi': 0.9930974235685596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=32 head_norm_before_train=1.833791 cos_to_last_merge=0.9989 (last merge round=28)
[S10] round=32 local utility u=0.032756 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.995665532900897, 'loss_val': 0.06357527631455848, 'psi': 0.994720408458527}-{'f1_val': 0.9905493776799077, 'auprc': 0.9938731010894946, 'loss_val': 0.10246348297712014, 'psi': 0.9918788670437425}
[S11] START round=32 head_norm_before_train=1.258578 cos_to_last_merge=0.9671 (last merge round=23)
[S11] round=32 local utility u=0.008496 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9982396254470686, 'loss_val': 0.062486808247505424, 'psi': 0.9973293019277367}-{'f1_val': 0.9963090846170353, 'auprc': 0.9961375468039821, 'loss_val': 0.07069317114613145, 'psi': 0.9962404694918141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=32 head_norm_before_train=1.278499 cos_to_last_merge=0.9319 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5331406504474674, 'auprc': 0.6913392949918565, 'loss_val': 0.7963142008022475, 'psi': 0.5964201082652231}-{'f1_val': 0.5862493036890802, 'auprc': 0.6785457785552258, 'loss_val': 0.71902597304553, 'psi': 0.6231678936355385}
[S14] START round=32 head_norm_before_train=1.806931 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000992 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985989442944958, 'loss_val': 0.03396018935717174, 'psi': 0.9976248777680642}-{'f1_val': 0.9970007132142444, 'auprc': 0.9983157609152934, 'loss_val': 0.03524602690168656, 'psi': 0.997526732294664}
[S15] START round=32 head_norm_before_train=1.329681 cos_to_last_merge=0.9788 (last merge round=22)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6995104170540507, 'auprc': 0.7136711508225445, 'loss_val': 0.4820127572764526, 'psi': 0.7051747105614482}-{'f1_val': 0.9941958262497868, 'auprc': 0.993427926634523, 'loss_val': 0.07426869966724439, 'psi': 0.9938886664036812}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.998114 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9195948054538342, 'auprc': 0.9884471857729904, 'loss_val': 0.4186472274943442, 'psi': 0.9471357575814967}-{'f1_val': 0.9608343403648612, 'auprc': 0.9928512803753906, 'loss_val': 0.1181584466541057, 'psi': 0.973641116369073}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.874747 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5861542575857053, 'auprc': 0.9062243207746232, 'loss_val': 0.7970703369739022, 'psi': 0.7141822828612725}-{'f1_val': 0.5993340364515909, 'auprc': 0.9969410546151299, 'loss_val': 0.70273855493191, 'psi': 0.7583768437170065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0135
[S8] DROPPED delta from S2 (cos=-0.0135 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.1446
[S13] DROPPED delta from S6 (cos=-0.1446 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9990
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0135
[S2] DROPPED delta from S8 (cos=-0.0135 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9990
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9941 head_norm=1.856750
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.187810e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9945 head_norm=1.833585 delta_norm=0.051878
[S10] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9970 head_norm=1.819617
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.458729e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9970 head_norm=1.837737 delta_norm=0.044587
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.661469 cos_to_last_merge=0.9624 (last merge round=16)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.62172395885217, 'auprc': 0.6841772443174992, 'loss_val': 1.376041865878654, 'psi': 0.6467052730383016}-{'f1_val': 0.6302559302607571, 'auprc': 0.6857795803278104, 'loss_val': 1.2089178067943782, 'psi': 0.6524653902875783}
[S3] START round=33 head_norm_before_train=1.267668 cos_to_last_merge=0.9447 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=33 local utility u=0.016447 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9994619367485946, 'loss_val': 0.21688088674047276, 'psi': 0.8202384969406176}-{'f1_val': 0.7006809596653347, 'auprc': 0.9991897527519458, 'loss_val': 0.24850741567332127, 'psi': 0.8200844768999791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=33 head_norm_before_train=1.469564 cos_to_last_merge=0.9487 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=33 local utility u=0.014348 metrics={'f1_val': 0.9453888267054535, 'auprc': 0.9450860624610046, 'loss_val': 0.2767463345771005, 'psi': 0.945267721007674}-{'f1_val': 0.9393864973879131, 'auprc': 0.9498784647511959, 'loss_val': 0.28380534667502816, 'psi': 0.9435832843332262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=33 head_norm_before_train=1.545054 cos_to_last_merge=0.9939 (last merge round=23)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7141437322562503, 'auprc': 0.7935624889963482, 'loss_val': 0.5095277596306941, 'psi': 0.7459112349522894}-{'f1_val': 0.7267407497872846, 'auprc': 0.9971626267058249, 'loss_val': 0.1763347365300004, 'psi': 0.8349095005547007}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.791200 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7179331134946915, 'auprc': 0.8004874858432907, 'loss_val': 0.7258094745739732, 'psi': 0.7509548624341311}-{'f1_val': 0.8237281851629136, 'auprc': 0.9622744213211671, 'loss_val': 0.35565905450059093, 'psi': 0.8791466796262151}
[S7] START round=33 head_norm_before_train=1.314728 cos_to_last_merge=0.9855 (last merge round=22)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.3982071242779465, 'auprc': 0.7728999074605496, 'loss_val': 1.048360721209084, 'psi': 0.5480842375509878}-{'f1_val': 0.6350430690640585, 'auprc': 0.8348107097363112, 'loss_val': 0.5637063685919607, 'psi': 0.7149501253329595}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.968507 (no previous merge yet)
[S8] round=33 local utility u=0.002774 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9987779105063119, 'loss_val': 0.03625905137698364, 'psi': 0.9953800971430373}-{'f1_val': 0.992392260479464, 'auprc': 0.998657371837666, 'loss_val': 0.037109420521879675, 'psi': 0.9948983050227449}
[S9] START round=33 head_norm_before_train=1.714441 cos_to_last_merge=0.7530 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.753
[S9] round=33 local utility u=0.010361 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958785897341336, 'loss_val': 0.025048456465650907, 'psi': 0.9963477429819882}-{'f1_val': 0.992904783397339, 'auprc': 0.9984688248956569, 'loss_val': 0.03100693345983452, 'psi': 0.9951303999966662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=33 head_norm_before_train=1.833585 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.002487 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9955739304493203, 'loss_val': 0.05701063579266777, 'psi': 0.994552199810055}-{'f1_val': 0.9940903254969471, 'auprc': 0.995665532900897, 'loss_val': 0.06357527631455848, 'psi': 0.994720408458527}
[S11] START round=33 head_norm_before_train=1.288451 cos_to_last_merge=0.9630 (last merge round=23)
[S11] round=33 local utility u=0.002077 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9976623347278419, 'loss_val': 0.05660028747607723, 'psi': 0.9970983856400459}-{'f1_val': 0.9967224195815153, 'auprc': 0.9982396254470686, 'loss_val': 0.062486808247505424, 'psi': 0.9973293019277367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=33 head_norm_before_train=1.294969 cos_to_last_merge=0.9301 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=33 local utility u=0.168521 metrics={'f1_val': 0.5976078245493459, 'auprc': 0.6739139500413718, 'loss_val': 0.7937983267627208, 'psi': 0.6281302747461563}-{'f1_val': 0.5331406504474674, 'auprc': 0.6913392949918565, 'loss_val': 0.7963142008022475, 'psi': 0.5964201082652231}
[S14] START round=33 head_norm_before_train=1.837737 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.001566 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985982336562915, 'loss_val': 0.03082631490809214, 'psi': 0.9976245935127824}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985989442944958, 'loss_val': 0.03396018935717174, 'psi': 0.9976248777680642}
[S15] START round=33 head_norm_before_train=1.348619 cos_to_last_merge=0.9769 (last merge round=22)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9960181616253683, 'loss_val': 0.05821420713552191, 'psi': 0.9964552656826596}-{'f1_val': 0.6995104170540507, 'auprc': 0.7136711508225445, 'loss_val': 0.4820127572764526, 'psi': 0.7051747105614482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=33 head_norm_before_train=2.006652 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9175056386418443, 'auprc': 0.9878818556018181, 'loss_val': 0.43481513484116563, 'psi': 0.9456561254258339}-{'f1_val': 0.9195948054538342, 'auprc': 0.9884471857729904, 'loss_val': 0.4186472274943442, 'psi': 0.9471357575814967}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.882238 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5815535421382143, 'auprc': 0.8078741791645161, 'loss_val': 0.9083931811284015, 'psi': 0.6720817969487349}-{'f1_val': 0.5861542575857053, 'auprc': 0.9062243207746232, 'loss_val': 0.7970703369739022, 'psi': 0.7141822828612725}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=-0.0132
[S2] DROPPED delta from S8 (cos=-0.0132 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1800) from S13
[S6] cosine check vs S13: cos=-0.1444
[S6] DROPPED delta from S13 (cos=-0.1444 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9939 head_norm=1.855546
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.229838e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9939 head_norm=1.853083 delta_norm=0.012298
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9970 head_norm=1.850699
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.229837e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.853083 delta_norm=0.012298
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.671181 cos_to_last_merge=0.9610 (last merge round=16)
[S2] round=34 local utility u=0.226246 metrics={'f1_val': 0.652762323747349, 'auprc': 0.7022199019503433, 'loss_val': 1.1639073142020304, 'psi': 0.6725453550285467}-{'f1_val': 0.62172395885217, 'auprc': 0.6841772443174992, 'loss_val': 1.376041865878654, 'psi': 0.6467052730383016}
[S3] START round=34 head_norm_before_train=1.292191 cos_to_last_merge=0.9404 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=34 local utility u=0.002608 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9989641923179292, 'loss_val': 0.2097207184223308, 'psi': 0.8199942527263726}-{'f1_val': 0.7007562037352997, 'auprc': 0.9994619367485946, 'loss_val': 0.21688088674047276, 'psi': 0.8202384969406176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=34 head_norm_before_train=1.482129 cos_to_last_merge=0.9472 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=34 local utility u=0.012385 metrics={'f1_val': 0.947569950722248, 'auprc': 0.9485675092492014, 'loss_val': 0.2755073570445578, 'psi': 0.9479689741330293}-{'f1_val': 0.9453888267054535, 'auprc': 0.9450860624610046, 'loss_val': 0.2767463345771005, 'psi': 0.945267721007674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=34 head_norm_before_train=1.551068 cos_to_last_merge=0.9933 (last merge round=23)
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.996187222237285, 'auprc': 0.9968357474160802, 'loss_val': 0.15747564024485297, 'psi': 0.996446632308803}-{'f1_val': 0.7141437322562503, 'auprc': 0.7935624889963482, 'loss_val': 0.5095277596306941, 'psi': 0.7459112349522894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=34 head_norm_before_train=1.801062 (no previous merge yet)
[S6] round=34 local utility u=0.963979 metrics={'f1_val': 0.9084767249311837, 'auprc': 0.9349202763268754, 'loss_val': 0.3444122812559609, 'psi': 0.9190541454894604}-{'f1_val': 0.7179331134946915, 'auprc': 0.8004874858432907, 'loss_val': 0.7258094745739732, 'psi': 0.7509548624341311}
[S7] START round=34 head_norm_before_train=1.321012 cos_to_last_merge=0.9846 (last merge round=22)
[S7] round=34 local utility u=0.134347 metrics={'f1_val': 0.4254060355205683, 'auprc': 0.777353049461229, 'loss_val': 0.9562201476992325, 'psi': 0.5661848410968326}-{'f1_val': 0.3982071242779465, 'auprc': 0.7728999074605496, 'loss_val': 1.048360721209084, 'psi': 0.5480842375509878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=34 head_norm_before_train=1.976632 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9987626492069565, 'loss_val': 0.03564251910018241, 'psi': 0.994757708720102}-{'f1_val': 0.9931148882341876, 'auprc': 0.9987779105063119, 'loss_val': 0.03625905137698364, 'psi': 0.9953800971430373}
[S9] START round=34 head_norm_before_train=1.725284 cos_to_last_merge=0.7517 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.752
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9986783032325652, 'loss_val': 0.038786511824550673, 'psi': 0.9931843883638521}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958785897341336, 'loss_val': 0.025048456465650907, 'psi': 0.9963477429819882}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.853083 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000073 metrics={'f1_val': 0.9934082608615626, 'auprc': 0.9957319445477403, 'loss_val': 0.05456215724679168, 'psi': 0.9943377343360337}-{'f1_val': 0.993871046050545, 'auprc': 0.9955739304493203, 'loss_val': 0.05701063579266777, 'psi': 0.994552199810055}
[S11] START round=34 head_norm_before_train=1.316580 cos_to_last_merge=0.9590 (last merge round=23)
[S11] round=34 local utility u=0.004451 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983248309637747, 'loss_val': 0.04968520740381183, 'psi': 0.9973633841344192}-{'f1_val': 0.9967224195815153, 'auprc': 0.9976623347278419, 'loss_val': 0.05660028747607723, 'psi': 0.9970983856400459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=34 head_norm_before_train=1.306882 cos_to_last_merge=0.9287 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=34 local utility u=0.024845 metrics={'f1_val': 0.5823500426976684, 'auprc': 0.6811774865349978, 'loss_val': 0.6743520232860616, 'psi': 0.6218810202326002}-{'f1_val': 0.5976078245493459, 'auprc': 0.6739139500413718, 'loss_val': 0.7937983267627208, 'psi': 0.6281302747461563}
[S14] START round=34 head_norm_before_train=1.853083 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.001851 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9989720707207413, 'loss_val': 0.030710047172914486, 'psi': 0.9980205852770454}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985982336562915, 'loss_val': 0.03082631490809214, 'psi': 0.9976245935127824}
[S15] START round=34 head_norm_before_train=1.365641 cos_to_last_merge=0.9754 (last merge round=22)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8303001474484712, 'auprc': 0.9897075056523877, 'loss_val': 0.20923600631046305, 'psi': 0.8940630907300379}-{'f1_val': 0.9967466683875206, 'auprc': 0.9960181616253683, 'loss_val': 0.05821420713552191, 'psi': 0.9964552656826596}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=2.015242 (no previous merge yet)
[S16] round=34 local utility u=0.150428 metrics={'f1_val': 0.9390264323888888, 'auprc': 0.9910945595363025, 'loss_val': 0.2727210312956572, 'psi': 0.9598536832478544}-{'f1_val': 0.9175056386418443, 'auprc': 0.9878818556018181, 'loss_val': 0.43481513484116563, 'psi': 0.9456561254258339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=34 head_norm_before_train=1.894022 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.56491664243311, 'auprc': 0.7954055131239194, 'loss_val': 0.9102156295072291, 'psi': 0.6571121907094337}-{'f1_val': 0.5815535421382143, 'auprc': 0.8078741791645161, 'loss_val': 0.9083931811284015, 'psi': 0.6720817969487349}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S6
[S13] cosine check vs S6: cos=-0.1439
[S13] DROPPED delta from S6 (cos=-0.1439 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1439
[S6] DROPPED delta from S13 (cos=-0.1439 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0128
[S8] DROPPED delta from S2 (cos=-0.0128 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9934 head_norm=1.873540
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.355875e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9934 head_norm=1.870715 delta_norm=0.013559
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9974 head_norm=1.867985
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.355875e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9974 head_norm=1.870715 delta_norm=0.013559
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.680649 cos_to_last_merge=0.9597 (last merge round=16)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6115625172493615, 'auprc': 0.7162812727616404, 'loss_val': 1.3107584846936182, 'psi': 0.6534500194542732}-{'f1_val': 0.652762323747349, 'auprc': 0.7022199019503433, 'loss_val': 1.1639073142020304, 'psi': 0.6725453550285467}
[S3] START round=35 head_norm_before_train=1.314903 cos_to_last_merge=0.9364 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=35 local utility u=0.830550 metrics={'f1_val': 0.9701750245561839, 'auprc': 0.9989501742091813, 'loss_val': 0.16554253005260675, 'psi': 0.9816850844173829}-{'f1_val': 0.7006809596653347, 'auprc': 0.9989641923179292, 'loss_val': 0.2097207184223308, 'psi': 0.8199942527263726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=35 head_norm_before_train=1.490229 cos_to_last_merge=0.9465 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=35 local utility u=0.006938 metrics={'f1_val': 0.9451641286757774, 'auprc': 0.9587503975163651, 'loss_val': 0.27774602165496876, 'psi': 0.9505986362120125}-{'f1_val': 0.947569950722248, 'auprc': 0.9485675092492014, 'loss_val': 0.2755073570445578, 'psi': 0.9479689741330293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=35 head_norm_before_train=1.559395 cos_to_last_merge=0.9925 (last merge round=23)
[S5] round=35 local utility u=0.004035 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9967006659898001, 'loss_val': 0.1472361435528507, 'psi': 0.9962162606671237}-{'f1_val': 0.996187222237285, 'auprc': 0.9968357474160802, 'loss_val': 0.15747564024485297, 'psi': 0.996446632308803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=35 head_norm_before_train=1.812102 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.710036675698242, 'auprc': 0.8972900688525633, 'loss_val': 0.6453523906831695, 'psi': 0.7849380329599706}-{'f1_val': 0.9084767249311837, 'auprc': 0.9349202763268754, 'loss_val': 0.3444122812559609, 'psi': 0.9190541454894604}
[S7] START round=35 head_norm_before_train=1.325613 cos_to_last_merge=0.9839 (last merge round=22)
[S7] round=35 local utility u=0.854108 metrics={'f1_val': 0.626893240230874, 'auprc': 0.8233338478205922, 'loss_val': 0.5948692436146613, 'psi': 0.7054694832667613}-{'f1_val': 0.4254060355205683, 'auprc': 0.777353049461229, 'loss_val': 0.9562201476992325, 'psi': 0.5661848410968326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=35 head_norm_before_train=1.988862 (no previous merge yet)
[S8] round=35 local utility u=0.002916 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9988701471814775, 'loss_val': 0.03415054926957546, 'psi': 0.9952023952956666}-{'f1_val': 0.9920877483955324, 'auprc': 0.9987626492069565, 'loss_val': 0.03564251910018241, 'psi': 0.994757708720102}
[S9] START round=35 head_norm_before_train=1.737515 cos_to_last_merge=0.7504 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.750
[S9] round=35 local utility u=0.021225 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9937088070371818, 'loss_val': 0.024259464158104364, 'psi': 0.9954798299032076}-{'f1_val': 0.9895217784513768, 'auprc': 0.9986783032325652, 'loss_val': 0.038786511824550673, 'psi': 0.9931843883638521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=35 head_norm_before_train=1.870715 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9924599695188009, 'loss_val': 0.05911604304429531, 'psi': 0.9938331533391438}-{'f1_val': 0.9934082608615626, 'auprc': 0.9957319445477403, 'loss_val': 0.05456215724679168, 'psi': 0.9943377343360337}
[S11] START round=35 head_norm_before_train=1.342502 cos_to_last_merge=0.9555 (last merge round=23)
[S11] round=35 local utility u=0.002521 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983834696285572, 'loss_val': 0.04481927686669787, 'psi': 0.997386839600332}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983248309637747, 'loss_val': 0.04968520740381183, 'psi': 0.9973633841344192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=35 head_norm_before_train=1.313792 cos_to_last_merge=0.9271 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5154198727533945, 'auprc': 0.706250469542994, 'loss_val': 0.8444058110902766, 'psi': 0.5917521114692343}-{'f1_val': 0.5823500426976684, 'auprc': 0.6811774865349978, 'loss_val': 0.6743520232860616, 'psi': 0.6218810202326002}
[S14] START round=35 head_norm_before_train=1.870715 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.001827 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989735389752685, 'loss_val': 0.02719256345749591, 'psi': 0.9980343772911427}-{'f1_val': 0.9973862616479148, 'auprc': 0.9989720707207413, 'loss_val': 0.030710047172914486, 'psi': 0.9980205852770454}
[S15] START round=35 head_norm_before_train=1.380313 cos_to_last_merge=0.9739 (last merge round=22)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7928181489938089, 'auprc': 0.9291483188907962, 'loss_val': 0.31621370356323697, 'psi': 0.8473502169526037}-{'f1_val': 0.8303001474484712, 'auprc': 0.9897075056523877, 'loss_val': 0.20923600631046305, 'psi': 0.8940630907300379}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=2.024521 (no previous merge yet)
[S16] round=35 local utility u=0.202589 metrics={'f1_val': 0.9742283082197473, 'auprc': 0.9935886759122312, 'loss_val': 0.08623740119978585, 'psi': 0.9819724552967408}-{'f1_val': 0.9390264323888888, 'auprc': 0.9910945595363025, 'loss_val': 0.2727210312956572, 'psi': 0.9598536832478544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=35 head_norm_before_train=1.908957 (no previous merge yet)
[S17] round=35 local utility u=0.501805 metrics={'f1_val': 0.6521491392368053, 'auprc': 0.8920713230795763, 'loss_val': 0.7199977532483979, 'psi': 0.7481180127739137}-{'f1_val': 0.56491664243311, 'auprc': 0.7954055131239194, 'loss_val': 0.9102156295072291, 'psi': 0.6571121907094337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] ⇄ pheromone p=0.030 → S14@127.0.0.1:63214
[S2] ⇄ pheromone p=0.057 → S8@127.0.0.1:63209
[S13] ⇄ pheromone p=0.046 → S6@127.0.0.1:63207
[S6] ⇄ pheromone p=0.268 → S13@127.0.0.1:63213
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=-0.0124
[S2] DROPPED delta from S8 (cos=-0.0124 < 0.0)
[S14] ⇄ pheromone p=0.005 → S10@127.0.0.1:63211
[S8] ⇄ pheromone p=0.078 → S2@127.0.0.1:63202
[S2] START round=36 head_norm_before_train=1.691086 cos_to_last_merge=0.9582 (last merge round=16)
[S2] round=36 local utility u=0.178593 metrics={'f1_val': 0.6508035426443308, 'auprc': 0.7127526519701028, 'loss_val': 1.1784318501002555, 'psi': 0.6755831863746397}-{'f1_val': 0.6115625172493615, 'auprc': 0.7162812727616404, 'loss_val': 1.3107584846936182, 'psi': 0.6534500194542732}
[S3] START round=36 head_norm_before_train=1.337226 cos_to_last_merge=0.9322 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=36 local utility u=0.100190 metrics={'f1_val': 0.9981674568065335, 'auprc': 0.99894635717741, 'loss_val': 0.13310592243906877, 'psi': 0.9984790169548841}-{'f1_val': 0.9701750245561839, 'auprc': 0.9989501742091813, 'loss_val': 0.16554253005260675, 'psi': 0.9816850844173829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=36 head_norm_before_train=1.496718 cos_to_last_merge=0.9459 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=36 local utility u=0.070230 metrics={'f1_val': 0.9538564947244587, 'auprc': 0.9801204990109613, 'loss_val': 0.2535502422299218, 'psi': 0.9643620964390597}-{'f1_val': 0.9451641286757774, 'auprc': 0.9587503975163651, 'loss_val': 0.27774602165496876, 'psi': 0.9505986362120125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=36 head_norm_before_train=1.567680 cos_to_last_merge=0.9917 (last merge round=23)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9948245764820217, 'auprc': 0.9969972949820519, 'loss_val': 0.15273012545578704, 'psi': 0.9956936638820337}-{'f1_val': 0.9958933237853395, 'auprc': 0.9967006659898001, 'loss_val': 0.1472361435528507, 'psi': 0.9962162606671237}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.821884 (no previous merge yet)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9619856852406237, 'auprc': 0.96508810160734, 'loss_val': 0.2144404751333235, 'psi': 0.9632266517873103}-{'f1_val': 0.710036675698242, 'auprc': 0.8972900688525633, 'loss_val': 0.6453523906831695, 'psi': 0.7849380329599706}
[S7] START round=36 head_norm_before_train=1.329403 cos_to_last_merge=0.9832 (last merge round=22)
[S7] round=36 local utility u=0.034978 metrics={'f1_val': 0.6321451353940337, 'auprc': 0.8269736728443573, 'loss_val': 0.5673438852093832, 'psi': 0.7100765503741632}-{'f1_val': 0.626893240230874, 'auprc': 0.8233338478205922, 'loss_val': 0.5948692436146613, 'psi': 0.7054694832667613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=36 head_norm_before_train=2.000315 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9988330094014743, 'loss_val': 0.03548845048722347, 'psi': 0.994749909862541}-{'f1_val': 0.9927572273717925, 'auprc': 0.9988701471814775, 'loss_val': 0.03415054926957546, 'psi': 0.9952023952956666}
[S9] START round=36 head_norm_before_train=1.749746 cos_to_last_merge=0.7491 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.749
[S9] round=36 local utility u=0.003513 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9988459069307818, 'loss_val': 0.02514704134396667, 'psi': 0.9967848555254497}-{'f1_val': 0.9966605118138915, 'auprc': 0.9937088070371818, 'loss_val': 0.024259464158104364, 'psi': 0.9954798299032076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=36 head_norm_before_train=1.888032 cos_to_last_merge=0.9999 (last merge round=34)
[S10] round=36 local utility u=0.007679 metrics={'f1_val': 0.99406584719663, 'auprc': 0.9956848095673729, 'loss_val': 0.049335232574141685, 'psi': 0.9947134321449271}-{'f1_val': 0.9947486092193725, 'auprc': 0.9924599695188009, 'loss_val': 0.05911604304429531, 'psi': 0.9938331533391438}
[S11] START round=36 head_norm_before_train=1.365885 cos_to_last_merge=0.9527 (last merge round=23)
[S11] round=36 local utility u=0.001787 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9978684297549905, 'loss_val': 0.04115071042611998, 'psi': 0.9973259258777425}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983834696285572, 'loss_val': 0.04481927686669787, 'psi': 0.997386839600332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=36 head_norm_before_train=1.322101 cos_to_last_merge=0.9254 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=36 local utility u=0.084927 metrics={'f1_val': 0.5645440595216455, 'auprc': 0.7159550181280466, 'loss_val': 0.9984102914365713, 'psi': 0.625108442964206}-{'f1_val': 0.5154198727533945, 'auprc': 0.706250469542994, 'loss_val': 0.8444058110902766, 'psi': 0.5917521114692343}
[S14] START round=36 head_norm_before_train=1.887238 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9982905079312474, 'loss_val': 0.027645577879795723, 'psi': 0.9977462331897029}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989735389752685, 'loss_val': 0.02719256345749591, 'psi': 0.9980343772911427}
[S15] START round=36 head_norm_before_train=1.395083 cos_to_last_merge=0.9725 (last merge round=22)
[S15] round=36 local utility u=0.792242 metrics={'f1_val': 0.9875976719931775, 'auprc': 0.9917057661629312, 'loss_val': 0.08807830348427009, 'psi': 0.989240909661079}-{'f1_val': 0.7928181489938089, 'auprc': 0.9291483188907962, 'loss_val': 0.31621370356323697, 'psi': 0.8473502169526037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=36 head_norm_before_train=2.035066 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9432027656410467, 'auprc': 0.9938725720030102, 'loss_val': 0.16282801313615136, 'psi': 0.9634706881858321}-{'f1_val': 0.9742283082197473, 'auprc': 0.9935886759122312, 'loss_val': 0.08623740119978585, 'psi': 0.9819724552967408}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.922601 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6389652459300246, 'auprc': 0.8793892384407576, 'loss_val': 0.7857277862537057, 'psi': 0.7351348429343177}-{'f1_val': 0.6521491392368053, 'auprc': 0.8920713230795763, 'loss_val': 0.7199977532483979, 'psi': 0.7481180127739137}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63214
[S2] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S6
[S13] cosine check vs S6: cos=-0.1438
[S13] DROPPED delta from S6 (cos=-0.1438 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=-0.0118
[S8] DROPPED delta from S2 (cos=-0.0118 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1438
[S6] DROPPED delta from S13 (cos=-0.1438 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9997
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.9941 head_norm=1.905176
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.159613e-02
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.9941 head_norm=1.896105 delta_norm=0.021596
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.700954 cos_to_last_merge=0.9569 (last merge round=16)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6376681628747778, 'auprc': 0.7052461652641142, 'loss_val': 1.32710023909168, 'psi': 0.6646993638305123}-{'f1_val': 0.6508035426443308, 'auprc': 0.7127526519701028, 'loss_val': 1.1784318501002555, 'psi': 0.6755831863746397}
[S3] START round=37 head_norm_before_train=1.358873 cos_to_last_merge=0.9279 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.7562714611096413, 'auprc': 0.9997762498120042, 'loss_val': 0.20966450659858465, 'psi': 0.8536733765905864}-{'f1_val': 0.9981674568065335, 'auprc': 0.99894635717741, 'loss_val': 0.13310592243906877, 'psi': 0.9984790169548841}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.500609 cos_to_last_merge=0.9458 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9423412551241037, 'auprc': 0.9448665640705781, 'loss_val': 0.28523660439192905, 'psi': 0.9433513787026935}-{'f1_val': 0.9538564947244587, 'auprc': 0.9801204990109613, 'loss_val': 0.2535502422299218, 'psi': 0.9643620964390597}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.575175 cos_to_last_merge=0.9910 (last merge round=23)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7141437322562503, 'auprc': 0.808316513075737, 'loss_val': 0.4061859234860264, 'psi': 0.751812844584045}-{'f1_val': 0.9948245764820217, 'auprc': 0.9969972949820519, 'loss_val': 0.15273012545578704, 'psi': 0.9956936638820337}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.830447 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7723934071830361, 'auprc': 0.948793182238349, 'loss_val': 0.6387860667351344, 'psi': 0.8429533172051612}-{'f1_val': 0.9619856852406237, 'auprc': 0.96508810160734, 'loss_val': 0.2144404751333235, 'psi': 0.9632266517873103}
[S7] START round=37 head_norm_before_train=1.334065 cos_to_last_merge=0.9825 (last merge round=22)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.4066417453330551, 'auprc': 0.7805075346293916, 'loss_val': 0.9922366078871132, 'psi': 0.5561880610515897}-{'f1_val': 0.6321451353940337, 'auprc': 0.8269736728443573, 'loss_val': 0.5673438852093832, 'psi': 0.7100765503741632}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=2.006450 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.986357977512754, 'auprc': 0.9986736759088706, 'loss_val': 0.04371910428646736, 'psi': 0.9912842568712006}-{'f1_val': 0.992027843503252, 'auprc': 0.9988330094014743, 'loss_val': 0.03548845048722347, 'psi': 0.994749909862541}
[S9] START round=37 head_norm_before_train=1.758919 cos_to_last_merge=0.7481 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.748
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9987227487951462, 'loss_val': 0.024778504097129932, 'psi': 0.9967355922711953}-{'f1_val': 0.9954108212552283, 'auprc': 0.9988459069307818, 'loss_val': 0.02514704134396667, 'psi': 0.9967848555254497}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.896105 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9945733682696013, 'loss_val': 0.04987098458643138, 'psi': 0.9941519749381675}-{'f1_val': 0.99406584719663, 'auprc': 0.9956848095673729, 'loss_val': 0.049335232574141685, 'psi': 0.9947134321449271}
[S11] START round=37 head_norm_before_train=1.387229 cos_to_last_merge=0.9502 (last merge round=23)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.99716793581348, 'loss_val': 0.0388284609805223, 'psi': 0.9969006260743012}-{'f1_val': 0.9969642566262439, 'auprc': 0.9978684297549905, 'loss_val': 0.04115071042611998, 'psi': 0.9973259258777425}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.330078 cos_to_last_merge=0.9238 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.4294743460971312, 'auprc': 0.5422270876715628, 'loss_val': 0.9100137462681684, 'psi': 0.4745754427269039}-{'f1_val': 0.5645440595216455, 'auprc': 0.7159550181280466, 'loss_val': 0.9984102914365713, 'psi': 0.625108442964206}
[S14] START round=37 head_norm_before_train=1.903401 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=37 local utility u=0.000646 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989815246056948, 'loss_val': 0.026110854258980017, 'psi': 0.997791114736877}-{'f1_val': 0.9973833833620065, 'auprc': 0.9982905079312474, 'loss_val': 0.027645577879795723, 'psi': 0.9977462331897029}
[S15] START round=37 head_norm_before_train=1.411729 cos_to_last_merge=0.9709 (last merge round=22)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8947913489803321, 'auprc': 0.9916397319713439, 'loss_val': 0.16223453801245585, 'psi': 0.9335307021767367}-{'f1_val': 0.9875976719931775, 'auprc': 0.9917057661629312, 'loss_val': 0.08807830348427009, 'psi': 0.989240909661079}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=2.045533 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8684536656302844, 'auprc': 0.9200455595731263, 'loss_val': 0.7421081167917477, 'psi': 0.8890904232074212}-{'f1_val': 0.9432027656410467, 'auprc': 0.9938725720030102, 'loss_val': 0.16282801313615136, 'psi': 0.9634706881858321}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.936927 (no previous merge yet)
[S17] round=37 local utility u=0.361248 metrics={'f1_val': 0.6845034228580116, 'auprc': 0.97941827330776, 'loss_val': 0.6365477729150212, 'psi': 0.8024693630379109}-{'f1_val': 0.6389652459300246, 'auprc': 0.8793892384407576, 'loss_val': 0.7857277862537057, 'psi': 0.7351348429343177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9997
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9970 head_norm=1.915803
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.829855e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9970 head_norm=1.910287 delta_norm=0.028299
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.709149 cos_to_last_merge=0.9562 (last merge round=16)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6350581037666683, 'auprc': 0.713047951446074, 'loss_val': 1.3429179777510323, 'psi': 0.6662540428384305}-{'f1_val': 0.6376681628747778, 'auprc': 0.7052461652641142, 'loss_val': 1.32710023909168, 'psi': 0.6646993638305123}
[S3] START round=38 head_norm_before_train=1.378737 cos_to_last_merge=0.9240 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=38 local utility u=0.742880 metrics={'f1_val': 0.9978179756248426, 'auprc': 0.9996458700972944, 'loss_val': 0.1727931197455134, 'psi': 0.9985491334138235}-{'f1_val': 0.7562714611096413, 'auprc': 0.9997762498120042, 'loss_val': 0.20966450659858465, 'psi': 0.8536733765905864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=38 head_norm_before_train=1.500975 cos_to_last_merge=0.9458 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=38 local utility u=0.043910 metrics={'f1_val': 0.9493700252256261, 'auprc': 0.9547163437278201, 'loss_val': 0.2691386969464809, 'psi': 0.9515085526265037}-{'f1_val': 0.9423412551241037, 'auprc': 0.9448665640705781, 'loss_val': 0.28523660439192905, 'psi': 0.9433513787026935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=38 head_norm_before_train=1.579970 cos_to_last_merge=0.9906 (last merge round=23)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.9747241935889351, 'auprc': 0.9971675758004677, 'loss_val': 0.15123907953455998, 'psi': 0.9837015464735481}-{'f1_val': 0.7141437322562503, 'auprc': 0.808316513075737, 'loss_val': 0.4061859234860264, 'psi': 0.751812844584045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=38 head_norm_before_train=1.839383 (no previous merge yet)
[S6] round=38 local utility u=0.296067 metrics={'f1_val': 0.8262508029872759, 'auprc': 0.9441665823030706, 'loss_val': 0.3559158037536316, 'psi': 0.8734171147135938}-{'f1_val': 0.7723934071830361, 'auprc': 0.948793182238349, 'loss_val': 0.6387860667351344, 'psi': 0.8429533172051612}
[S7] START round=38 head_norm_before_train=1.340688 cos_to_last_merge=0.9813 (last merge round=22)
[S7] round=38 local utility u=0.397845 metrics={'f1_val': 0.5094605192518434, 'auprc': 0.7861518890970869, 'loss_val': 0.8303917134241631, 'psi': 0.6201370671899409}-{'f1_val': 0.4066417453330551, 'auprc': 0.7805075346293916, 'loss_val': 0.9922366078871132, 'psi': 0.5561880610515897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=38 head_norm_before_train=2.015240 (no previous merge yet)
[S8] round=38 local utility u=0.021333 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9984890369110087, 'loss_val': 0.03889439560371539, 'psi': 0.9950499511874791}-{'f1_val': 0.986357977512754, 'auprc': 0.9986736759088706, 'loss_val': 0.04371910428646736, 'psi': 0.9912842568712006}
[S9] START round=38 head_norm_before_train=1.768538 cos_to_last_merge=0.7471 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.747
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946467549517766, 'loss_val': 0.022196554400711936, 'psi': 0.9958550090690454}-{'f1_val': 0.9954108212552283, 'auprc': 0.9987227487951462, 'loss_val': 0.024778504097129932, 'psi': 0.9967355922711953}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.913035 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=38 local utility u=0.004417 metrics={'f1_val': 0.9944624437190478, 'auprc': 0.9957830521713201, 'loss_val': 0.04821467238244256, 'psi': 0.9949906870999567}-{'f1_val': 0.993871046050545, 'auprc': 0.9945733682696013, 'loss_val': 0.04987098458643138, 'psi': 0.9941519749381675}
[S11] START round=38 head_norm_before_train=1.407258 cos_to_last_merge=0.9479 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=38 local utility u=0.002663 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9977205334225638, 'loss_val': 0.03661105031310517, 'psi': 0.9972667673447718}-{'f1_val': 0.9967224195815153, 'auprc': 0.99716793581348, 'loss_val': 0.0388284609805223, 'psi': 0.9969006260743012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=38 head_norm_before_train=1.334959 cos_to_last_merge=0.9231 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=38 local utility u=0.531396 metrics={'f1_val': 0.5162765054694887, 'auprc': 0.6958389404879147, 'loss_val': 0.8288693080752343, 'psi': 0.5881014794768591}-{'f1_val': 0.4294743460971312, 'auprc': 0.5422270876715628, 'loss_val': 0.9100137462681684, 'psi': 0.4745754427269039}
[S14] START round=38 head_norm_before_train=1.910287 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9985914902689011, 'loss_val': 0.02776495232548371, 'psi': 0.99772256754544}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989815246056948, 'loss_val': 0.026110854258980017, 'psi': 0.997791114736877}
[S15] START round=38 head_norm_before_train=1.428905 cos_to_last_merge=0.9694 (last merge round=22)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7033074474745398, 'auprc': 0.9875895327848374, 'loss_val': 0.3291020293299842, 'psi': 0.8170202815986589}-{'f1_val': 0.8947913489803321, 'auprc': 0.9916397319713439, 'loss_val': 0.16223453801245585, 'psi': 0.9335307021767367}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=2.054285 (no previous merge yet)
[S16] round=38 local utility u=0.394539 metrics={'f1_val': 0.9175213331067839, 'auprc': 0.9882507777810313, 'loss_val': 0.4520520924262897, 'psi': 0.9458131109764829}-{'f1_val': 0.8684536656302844, 'auprc': 0.9200455595731263, 'loss_val': 0.7421081167917477, 'psi': 0.8890904232074212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=38 head_norm_before_train=1.950282 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6055373576007617, 'auprc': 0.8557594173945646, 'loss_val': 0.8741665111224534, 'psi': 0.7056261815182829}-{'f1_val': 0.6845034228580116, 'auprc': 0.97941827330776, 'loss_val': 0.6365477729150212, 'psi': 0.8024693630379109}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:63207
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S13
[S6] cosine check vs S13: cos=-0.1421
[S6] DROPPED delta from S13 (cos=-0.1421 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=-0.0117
[S2] DROPPED delta from S8 (cos=-0.0117 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1421
[S13] DROPPED delta from S6 (cos=-0.1421 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9945 head_norm=1.927992
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.077751e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9945 head_norm=1.921660 delta_norm=0.030778
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.716318 cos_to_last_merge=0.9555 (last merge round=16)
[S2] round=39 local utility u=0.306846 metrics={'f1_val': 0.6898887531341477, 'auprc': 0.7189061905362057, 'loss_val': 1.075785102796992, 'psi': 0.701495728094971}-{'f1_val': 0.6350581037666683, 'auprc': 0.713047951446074, 'loss_val': 1.3429179777510323, 'psi': 0.6662540428384305}
[S3] START round=39 head_norm_before_train=1.393581 cos_to_last_merge=0.9211 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.6479654105836693, 'auprc': 0.9954868899685698, 'loss_val': 0.657331747080854, 'psi': 0.7869740023376295}-{'f1_val': 0.9978179756248426, 'auprc': 0.9996458700972944, 'loss_val': 0.1727931197455134, 'psi': 0.9985491334138235}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.787 u=0.0000 p_local=0.2085 f1=0.648 auprc=0.995 bytes=53952
[S4] START round=39 head_norm_before_train=1.502534 cos_to_last_merge=0.9457 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9442116962088848, 'auprc': 0.9589014047276196, 'loss_val': 0.2692533847657273, 'psi': 0.9500875796163788}-{'f1_val': 0.9493700252256261, 'auprc': 0.9547163437278201, 'loss_val': 0.2691386969464809, 'psi': 0.9515085526265037}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.950 u=0.0000 p_local=0.0248 f1=0.944 auprc=0.959 bytes=43202
[S5] START round=39 head_norm_before_train=1.585657 cos_to_last_merge=0.9900 (last merge round=23)
[S5] round=39 local utility u=0.074794 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9967534745096189, 'loss_val': 0.12830256872364693, 'psi': 0.9963253249472708}-{'f1_val': 0.9747241935889351, 'auprc': 0.9971675758004677, 'loss_val': 0.15123907953455998, 'psi': 0.9837015464735481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] r=40 psi=0.996 u=0.0748 p_local=0.2977 f1=0.996 auprc=0.997 bytes=46757
[S6] START round=39 head_norm_before_train=1.847986 (no previous merge yet)
[S6] round=39 local utility u=0.031711 metrics={'f1_val': 0.8538964099961355, 'auprc': 0.9384740932456894, 'loss_val': 0.44128981317665955, 'psi': 0.8877274832959571}-{'f1_val': 0.8262508029872759, 'auprc': 0.9441665823030706, 'loss_val': 0.3559158037536316, 'psi': 0.8734171147135938}
[S7] START round=39 head_norm_before_train=1.348218 cos_to_last_merge=0.9801 (last merge round=22)
[S7] round=39 local utility u=0.703855 metrics={'f1_val': 0.6585599223027998, 'auprc': 0.8404817650263791, 'loss_val': 0.4802682828861492, 'psi': 0.7313286593922315}-{'f1_val': 0.5094605192518434, 'auprc': 0.7861518890970869, 'loss_val': 0.8303917134241631, 'psi': 0.6201370671899409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.731 u=0.7039 p_local=0.3720 f1=0.659 auprc=0.840 bytes=46733
[S8] START round=39 head_norm_before_train=2.022221 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9843467557835309, 'auprc': 0.9986484670823861, 'loss_val': 0.04872216375557286, 'psi': 0.990067440303073}-{'f1_val': 0.9927572273717925, 'auprc': 0.9984890369110087, 'loss_val': 0.03889439560371539, 'psi': 0.9950499511874791}
[S9] START round=39 head_norm_before_train=1.778520 cos_to_last_merge=0.7461 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.746
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9989927940518009, 'loss_val': 0.030046502098789063, 'psi': 0.9945840010034571}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946467549517766, 'loss_val': 0.022196554400711936, 'psi': 0.9958550090690454}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.995 u=0.0000 p_local=0.0066 f1=0.992 auprc=0.999 bytes=44900
[S10] START round=39 head_norm_before_train=1.921660 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9942928605461898, 'auprc': 0.9952862413089189, 'loss_val': 0.057125513297777174, 'psi': 0.9946902128512815}-{'f1_val': 0.9944624437190478, 'auprc': 0.9957830521713201, 'loss_val': 0.04821467238244256, 'psi': 0.9949906870999567}
[S11] START round=39 head_norm_before_train=1.426260 cos_to_last_merge=0.9454 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9947204127176196, 'loss_val': 0.035669307307594024, 'psi': 0.995673615857269}-{'f1_val': 0.9969642566262439, 'auprc': 0.9977205334225638, 'loss_val': 0.03661105031310517, 'psi': 0.9972667673447718}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.996 u=0.0000 p_local=0.0118 f1=0.996 auprc=0.995 bytes=55653
[S13] START round=39 head_norm_before_train=1.338727 cos_to_last_merge=0.9226 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=39 local utility u=0.077899 metrics={'f1_val': 0.5675778711048581, 'auprc': 0.6957957266287057, 'loss_val': 0.9807492059038044, 'psi': 0.6188650133143971}-{'f1_val': 0.5162765054694887, 'auprc': 0.6958389404879147, 'loss_val': 0.8288693080752343, 'psi': 0.5881014794768591}
[S14] START round=39 head_norm_before_train=1.919200 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.001821 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990758038366696, 'loss_val': 0.024701248354547525, 'psi': 0.997828826429267}-{'f1_val': 0.9971432857297993, 'auprc': 0.9985914902689011, 'loss_val': 0.02776495232548371, 'psi': 0.99772256754544}
[S15] START round=39 head_norm_before_train=1.447460 cos_to_last_merge=0.9676 (last merge round=22)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9911588791936475, 'auprc': 0.9918696035809872, 'loss_val': 0.05987760634583053, 'psi': 0.9914431689485834}-{'f1_val': 0.7033074474745398, 'auprc': 0.9875895327848374, 'loss_val': 0.3291020293299842, 'psi': 0.8170202815986589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.991 u=1.0000 p_local=0.3891 f1=0.991 auprc=0.992 bytes=39486
[S16] START round=39 head_norm_before_train=2.062606 (no previous merge yet)
[S16] round=39 local utility u=0.245495 metrics={'f1_val': 0.9463390750140596, 'auprc': 0.9941824880454266, 'loss_val': 0.15176432798143052, 'psi': 0.9654764402266064}-{'f1_val': 0.9175213331067839, 'auprc': 0.9882507777810313, 'loss_val': 0.4520520924262897, 'psi': 0.9458131109764829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=40 psi=0.965 u=0.2455 p_local=0.1665 f1=0.946 auprc=0.994 bytes=43163
[S17] START round=39 head_norm_before_train=1.959387 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6083263015717769, 'auprc': 0.852987069306608, 'loss_val': 0.9756179893435616, 'psi': 0.7061906086657093}-{'f1_val': 0.6055373576007617, 'auprc': 0.8557594173945646, 'loss_val': 0.8741665111224534, 'psi': 0.7056261815182829}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.706 u=0.0000 p_local=0.1316 f1=0.608 auprc=0.853 bytes=39600
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63209
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0140 f1=0.994 auprc=0.995 bytes=41407
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] r=40 psi=0.990 u=0.0000 p_local=0.0354 f1=0.984 auprc=0.999 bytes=43168
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0121
[S8] DROPPED delta from S2 (cos=-0.0121 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1414
[S6] DROPPED delta from S13 (cos=-0.1414 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S6
[S13] cosine check vs S6: cos=-0.1414
[S13] DROPPED delta from S6 (cos=-0.1414 < 0.0)
[S6] r=40 psi=0.888 u=0.0317 p_local=0.2657 f1=0.854 auprc=0.938 bytes=41404
[S13] r=40 psi=0.619 u=0.0779 p_local=0.1283 f1=0.568 auprc=0.696 bytes=43085
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9970 head_norm=1.930820
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.465490e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9970 head_norm=1.929249 delta_norm=0.024655
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0018 p_local=0.0023 f1=0.997 auprc=0.999 bytes=55794
[S2] r=40 psi=0.701 u=0.3068 p_local=0.1029 f1=0.690 auprc=0.719 bytes=34147
[S2] START round=40 head_norm_before_train=1.728124 cos_to_last_merge=0.9540 (last merge round=16)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6016149470064137, 'auprc': 0.7174644989355438, 'loss_val': 1.5068235165339727, 'psi': 0.6479547677780657}-{'f1_val': 0.6898887531341477, 'auprc': 0.7189061905362057, 'loss_val': 1.075785102796992, 'psi': 0.701495728094971}
[S3] START round=40 head_norm_before_train=1.407639 cos_to_last_merge=0.9185 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=40 local utility u=1.000000 metrics={'f1_val': 0.9975289288627188, 'auprc': 0.999028542077133, 'loss_val': 0.09828258164126187, 'psi': 0.9981287741484844}-{'f1_val': 0.6479654105836693, 'auprc': 0.9954868899685698, 'loss_val': 0.657331747080854, 'psi': 0.7869740023376295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[S4] START round=40 head_norm_before_train=1.506859 cos_to_last_merge=0.9452 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9372010583965764, 'auprc': 0.9497442710172146, 'loss_val': 0.285214041657411, 'psi': 0.9422183434448317}-{'f1_val': 0.9442116962088848, 'auprc': 0.9589014047276196, 'loss_val': 0.2692533847657273, 'psi': 0.9500875796163788}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.594796 cos_to_last_merge=0.9889 (last merge round=23)
[S5] round=40 local utility u=0.007458 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9969124538837122, 'loss_val': 0.11386434591727436, 'psi': 0.996388916696908}-{'f1_val': 0.9960398919057053, 'auprc': 0.9967534745096189, 'loss_val': 0.12830256872364693, 'psi': 0.9963253249472708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=40 head_norm_before_train=1.855971 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.8216639202511786, 'auprc': 0.9431540858886158, 'loss_val': 0.5294829027099988, 'psi': 0.8702599865061535}-{'f1_val': 0.8538964099961355, 'auprc': 0.9384740932456894, 'loss_val': 0.44128981317665955, 'psi': 0.8877274832959571}
[S7] START round=40 head_norm_before_train=1.355399 cos_to_last_merge=0.9790 (last merge round=22)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6193425957358734, 'auprc': 0.8092421805458337, 'loss_val': 0.6070345074069616, 'psi': 0.6953024296598576}-{'f1_val': 0.6585599223027998, 'auprc': 0.8404817650263791, 'loss_val': 0.4802682828861492, 'psi': 0.7313286593922315}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.031377 (no previous merge yet)
[S8] round=40 local utility u=0.034521 metrics={'f1_val': 0.9933514266435809, 'auprc': 0.9987977473889141, 'loss_val': 0.03415532202210137, 'psi': 0.9955299549417143}-{'f1_val': 0.9843467557835309, 'auprc': 0.9986484670823861, 'loss_val': 0.04872216375557286, 'psi': 0.990067440303073}
[S9] START round=40 head_norm_before_train=1.788637 cos_to_last_merge=0.7452 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.745
[S9] round=40 local utility u=0.015975 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988421538825714, 'loss_val': 0.02273623495998826, 'psi': 0.9970328925715398}-{'f1_val': 0.9916448056378947, 'auprc': 0.9989927940518009, 'loss_val': 0.030046502098789063, 'psi': 0.9945840010034571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=40 head_norm_before_train=1.933920 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9936462998727585, 'auprc': 0.991974356942925, 'loss_val': 0.07182013641267819, 'psi': 0.9929775227008252}-{'f1_val': 0.9942928605461898, 'auprc': 0.9952862413089189, 'loss_val': 0.057125513297777174, 'psi': 0.9946902128512815}
[S11] START round=40 head_norm_before_train=1.441856 cos_to_last_merge=0.9435 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=40 local utility u=0.004466 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9962626462637165, 'loss_val': 0.03384353612914954, 'psi': 0.9965385102543958}-{'f1_val': 0.9963090846170353, 'auprc': 0.9947204127176196, 'loss_val': 0.035669307307594024, 'psi': 0.995673615857269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=40 head_norm_before_train=1.342505 cos_to_last_merge=0.9224 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=40 local utility u=0.132638 metrics={'f1_val': 0.5870705443778367, 'auprc': 0.6911876289444503, 'loss_val': 0.8186055906963554, 'psi': 0.6287173782044821}-{'f1_val': 0.5675778711048581, 'auprc': 0.6957957266287057, 'loss_val': 0.9807492059038044, 'psi': 0.6188650133143971}
[S14] START round=40 head_norm_before_train=1.929249 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.001556 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9985723718655368, 'loss_val': 0.024879644482737728, 'psi': 0.9981074549021514}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990758038366696, 'loss_val': 0.024701248354547525, 'psi': 0.997828826429267}
[S15] START round=40 head_norm_before_train=1.465614 cos_to_last_merge=0.9657 (last merge round=22)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7834621166536923, 'auprc': 0.9879177944923004, 'loss_val': 0.30384943520067337, 'psi': 0.8652443877891356}-{'f1_val': 0.9911588791936475, 'auprc': 0.9918696035809872, 'loss_val': 0.05987760634583053, 'psi': 0.9914431689485834}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.069588 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9463646639821316, 'auprc': 0.9941448813960456, 'loss_val': 0.1527630721049991, 'psi': 0.9654767509476972}-{'f1_val': 0.9463390750140596, 'auprc': 0.9941824880454266, 'loss_val': 0.15176432798143052, 'psi': 0.9654764402266064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.964349 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6157347281559256, 'auprc': 0.7981978256586535, 'loss_val': 1.2364157916767606, 'psi': 0.6887199671570168}-{'f1_val': 0.6083263015717769, 'auprc': 0.852987069306608, 'loss_val': 0.9756179893435616, 'psi': 0.7061906086657093}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:63211
[S6] ⇄ pheromone p=0.213 → S13@127.0.0.1:63213
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] ⇄ pheromone p=0.082 → S8@127.0.0.1:63209
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=40 metric=0.9936 head_norm=1.946924
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.151637e-02
[S10] stored merged vector for next round verification (round=40)
[S10] DEBUG after merge:  round=40 metric=0.9934 head_norm=1.938770 delta_norm=0.021516
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.011 → S14@127.0.0.1:63214
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0120
[S2] DROPPED delta from S8 (cos=-0.0120 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] cosine check vs S13: cos=-0.1422
[S6] DROPPED delta from S13 (cos=-0.1422 < 0.0)
[S8] ⇄ pheromone p=0.035 → S2@127.0.0.1:63202
[S14] ⇄ pheromone p=0.002 → S10@127.0.0.1:63211
[S13] ⇄ pheromone p=0.129 → S6@127.0.0.1:63207
[S2] START round=41 head_norm_before_train=1.737275 cos_to_last_merge=0.9527 (last merge round=16)
[S2] round=41 local utility u=0.401251 metrics={'f1_val': 0.671822874168412, 'auprc': 0.7205563949146092, 'loss_val': 1.1348447703327487, 'psi': 0.6913162824668908}-{'f1_val': 0.6016149470064137, 'auprc': 0.7174644989355438, 'loss_val': 1.5068235165339727, 'psi': 0.6479547677780657}
[S3] START round=41 head_norm_before_train=1.418313 cos_to_last_merge=0.9166 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9787992823618218, 'auprc': 0.9991117807829885, 'loss_val': 0.10715426240604106, 'psi': 0.9869242817302885}-{'f1_val': 0.9975289288627188, 'auprc': 0.999028542077133, 'loss_val': 0.09828258164126187, 'psi': 0.9981287741484844}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.512738 cos_to_last_merge=0.9444 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=41 local utility u=0.018992 metrics={'f1_val': 0.9405639365809528, 'auprc': 0.954202567168496, 'loss_val': 0.28078248702547925, 'psi': 0.9460193888159701}-{'f1_val': 0.9372010583965764, 'auprc': 0.9497442710172146, 'loss_val': 0.285214041657411, 'psi': 0.9422183434448317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S4] sending update (kind=head size=1811 to 1 peers)
[S5] START round=41 head_norm_before_train=1.605637 cos_to_last_merge=0.9874 (last merge round=23)
[S5] round=41 local utility u=0.006634 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9969615928114004, 'loss_val': 0.10074327497872997, 'psi': 0.9964085722679834}-{'f1_val': 0.9960398919057053, 'auprc': 0.9969124538837122, 'loss_val': 0.11386434591727436, 'psi': 0.996388916696908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=41 head_norm_before_train=1.869255 (no previous merge yet)
[S6] round=41 local utility u=0.025985 metrics={'f1_val': 0.8278744383311434, 'auprc': 0.9543043448699747, 'loss_val': 0.5482259647310852, 'psi': 0.8784464009466759}-{'f1_val': 0.8216639202511786, 'auprc': 0.9431540858886158, 'loss_val': 0.5294829027099988, 'psi': 0.8702599865061535}
[S7] START round=41 head_norm_before_train=1.362471 cos_to_last_merge=0.9779 (last merge round=22)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.520170904319287, 'auprc': 0.7813332137153678, 'loss_val': 0.8660392713243177, 'psi': 0.6246358280777193}-{'f1_val': 0.6193425957358734, 'auprc': 0.8092421805458337, 'loss_val': 0.6070345074069616, 'psi': 0.6953024296598576}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.035958 (no previous merge yet)
[S8] round=41 local utility u=0.001568 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9989716433115834, 'loss_val': 0.03236555252375765, 'psi': 0.9956819489984339}-{'f1_val': 0.9933514266435809, 'auprc': 0.9987977473889141, 'loss_val': 0.03415532202210137, 'psi': 0.9955299549417143}
[S9] START round=41 head_norm_before_train=1.797918 cos_to_last_merge=0.7444 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.744
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9989308570154689, 'loss_val': 0.032515731156076484, 'psi': 0.9938004029780672}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988421538825714, 'loss_val': 0.02273623495998826, 'psi': 0.9970328925715398}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.938770 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=41 local utility u=0.002234 metrics={'f1_val': 0.994087454857489, 'auprc': 0.991919624440786, 'loss_val': 0.0698356373576082, 'psi': 0.9932203226908077}-{'f1_val': 0.9936462998727585, 'auprc': 0.991974356942925, 'loss_val': 0.07182013641267819, 'psi': 0.9929775227008252}
[S11] START round=41 head_norm_before_train=1.456560 cos_to_last_merge=0.9416 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=41 local utility u=0.003445 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9980230876543894, 'loss_val': 0.032234182987618154, 'psi': 0.997242686810665}-{'f1_val': 0.9967224195815153, 'auprc': 0.9962626462637165, 'loss_val': 0.03384353612914954, 'psi': 0.9965385102543958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=41 head_norm_before_train=1.342350 cos_to_last_merge=0.9201 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5637862712627244, 'auprc': 0.697602691965606, 'loss_val': 0.84507857489181, 'psi': 0.6173128395438771}-{'f1_val': 0.5870705443778367, 'auprc': 0.6911876289444503, 'loss_val': 0.8186055906963554, 'psi': 0.6287173782044821}
[S14] START round=41 head_norm_before_train=1.941858 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9985864024285163, 'loss_val': 0.02551157418568801, 'psi': 0.9981130671273432}-{'f1_val': 0.9977975102598944, 'auprc': 0.9985723718655368, 'loss_val': 0.024879644482737728, 'psi': 0.9981074549021514}
[S15] START round=41 head_norm_before_train=1.484160 cos_to_last_merge=0.9636 (last merge round=22)
[S15] round=41 local utility u=0.710584 metrics={'f1_val': 0.977676980491241, 'auprc': 0.9929531059345229, 'loss_val': 0.06307555901631431, 'psi': 0.9837874306685537}-{'f1_val': 0.7834621166536923, 'auprc': 0.9879177944923004, 'loss_val': 0.30384943520067337, 'psi': 0.8652443877891356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=41 head_norm_before_train=2.074511 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8884400712908503, 'auprc': 0.9678032848962417, 'loss_val': 0.585615697598824, 'psi': 0.9201853567330068}-{'f1_val': 0.9463646639821316, 'auprc': 0.9941448813960456, 'loss_val': 0.1527630721049991, 'psi': 0.9654767509476972}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.970713 (no previous merge yet)
[S17] round=41 local utility u=0.353642 metrics={'f1_val': 0.6080226130502924, 'auprc': 0.9336188543998347, 'loss_val': 0.8891222445673651, 'psi': 0.7382611095901093}-{'f1_val': 0.6157347281559256, 'auprc': 0.7981978256586535, 'loss_val': 1.2364157916767606, 'psi': 0.6887199671570168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[S2] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0115
[S8] DROPPED delta from S2 (cos=-0.0115 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] cosine check vs S6: cos=-0.1430
[S13] DROPPED delta from S6 (cos=-0.1430 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=-0.0115
[S2] DROPPED delta from S8 (cos=-0.0115 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9941 head_norm=1.950408
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.588754e-03
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9941 head_norm=1.946119 delta_norm=0.008589
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.744825 cos_to_last_merge=0.9521 (last merge round=16)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6424135558529455, 'auprc': 0.7135945189483008, 'loss_val': 1.3179764229105182, 'psi': 0.6708859410910877}-{'f1_val': 0.671822874168412, 'auprc': 0.7205563949146092, 'loss_val': 1.1348447703327487, 'psi': 0.6913162824668908}
[S3] START round=42 head_norm_before_train=1.428768 cos_to_last_merge=0.9153 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9098464760207543, 'auprc': 0.9992504882058881, 'loss_val': 0.2289270213280091, 'psi': 0.9456080808948077}-{'f1_val': 0.9787992823618218, 'auprc': 0.9991117807829885, 'loss_val': 0.10715426240604106, 'psi': 0.9869242817302885}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.521897 cos_to_last_merge=0.9434 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.706575852449496, 'auprc': 0.9190255910159671, 'loss_val': 0.5205287023860957, 'psi': 0.7915557478760844}-{'f1_val': 0.9405639365809528, 'auprc': 0.954202567168496, 'loss_val': 0.28078248702547925, 'psi': 0.9460193888159701}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.615972 cos_to_last_merge=0.9861 (last merge round=23)
[S5] round=42 local utility u=0.001691 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9963625157403149, 'loss_val': 0.09468384938713961, 'psi': 0.9960810005673296}-{'f1_val': 0.9960398919057053, 'auprc': 0.9969615928114004, 'loss_val': 0.10074327497872997, 'psi': 0.9964085722679834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=42 head_norm_before_train=1.882424 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8121497605844905, 'auprc': 0.9477795323503337, 'loss_val': 0.565601532215579, 'psi': 0.8664016692908278}-{'f1_val': 0.8278744383311434, 'auprc': 0.9543043448699747, 'loss_val': 0.5482259647310852, 'psi': 0.8784464009466759}
[S7] START round=42 head_norm_before_train=1.368811 cos_to_last_merge=0.9770 (last merge round=22)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.40837003186597165, 'auprc': 0.7762026097095611, 'loss_val': 1.0837037976706567, 'psi': 0.5555030630034075}-{'f1_val': 0.520170904319287, 'auprc': 0.7813332137153678, 'loss_val': 0.8660392713243177, 'psi': 0.6246358280777193}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.042344 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9989055295875966, 'loss_val': 0.0411886098629545, 'psi': 0.9933478083194089}-{'f1_val': 0.9934888194563342, 'auprc': 0.9989716433115834, 'loss_val': 0.03236555252375765, 'psi': 0.9956819489984339}
[S9] START round=42 head_norm_before_train=1.807217 cos_to_last_merge=0.7437 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.744
[S9] round=42 local utility u=0.018729 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950045012570392, 'loss_val': 0.020960568292087686, 'psi': 0.9959981075911506}-{'f1_val': 0.9903801002864661, 'auprc': 0.9989308570154689, 'loss_val': 0.032515731156076484, 'psi': 0.9938004029780672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=42 head_norm_before_train=1.946119 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.015950 metrics={'f1_val': 0.9933416400801217, 'auprc': 0.9958508395131028, 'loss_val': 0.04525493045158808, 'psi': 0.9943453198533141}-{'f1_val': 0.994087454857489, 'auprc': 0.991919624440786, 'loss_val': 0.0698356373576082, 'psi': 0.9932203226908077}
[S11] START round=42 head_norm_before_train=1.471280 cos_to_last_merge=0.9397 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9976830225305107, 'loss_val': 0.031214302210147787, 'psi': 0.9968586597824254}-{'f1_val': 0.9967224195815153, 'auprc': 0.9980230876543894, 'loss_val': 0.032234182987618154, 'psi': 0.997242686810665}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.345812 cos_to_last_merge=0.9163 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=42 local utility u=0.073997 metrics={'f1_val': 0.5700881309811406, 'auprc': 0.6812535045582662, 'loss_val': 0.6858490135073605, 'psi': 0.6145542804119908}-{'f1_val': 0.5637862712627244, 'auprc': 0.697602691965606, 'loss_val': 0.84507857489181, 'psi': 0.6173128395438771}
[S14] START round=42 head_norm_before_train=1.952038 cos_to_last_merge=0.9999 (last merge round=39)
[S14] round=42 local utility u=0.000644 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989233155936226, 'loss_val': 0.022898619110444215, 'psi': 0.9980142879384843}-{'f1_val': 0.9977975102598944, 'auprc': 0.9985864024285163, 'loss_val': 0.02551157418568801, 'psi': 0.9981130671273432}
[S15] START round=42 head_norm_before_train=1.500923 cos_to_last_merge=0.9619 (last merge round=22)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9198523567048773, 'auprc': 0.9930746355272067, 'loss_val': 0.1228212196825989, 'psi': 0.949141268233809}-{'f1_val': 0.977676980491241, 'auprc': 0.9929531059345229, 'loss_val': 0.06307555901631431, 'psi': 0.9837874306685537}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.075178 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8607904056283675, 'auprc': 0.8901215167814239, 'loss_val': 0.8662139370964709, 'psi': 0.8725228500895901}-{'f1_val': 0.8884400712908503, 'auprc': 0.9678032848962417, 'loss_val': 0.585615697598824, 'psi': 0.9201853567330068}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.977553 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6147216948259688, 'auprc': 0.9032251916127416, 'loss_val': 0.9904121067848155, 'psi': 0.730123093540678}-{'f1_val': 0.6080226130502924, 'auprc': 0.9336188543998347, 'loss_val': 0.8891222445673651, 'psi': 0.7382611095901093}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=42 metric=0.9933 head_norm=1.957591
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.488936e-02
[S10] stored merged vector for next round verification (round=42)
[S10] DEBUG after merge:  round=42 metric=0.9933 head_norm=1.959639 delta_norm=0.014889
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9974 head_norm=1.961798
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.532143e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9974 head_norm=1.957841 delta_norm=0.015321
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1429
[S6] DROPPED delta from S13 (cos=-0.1429 < 0.0)
[S2] START round=43 head_norm_before_train=1.752691 cos_to_last_merge=0.9516 (last merge round=16)
[S2] round=43 local utility u=0.141910 metrics={'f1_val': 0.6638973441488568, 'auprc': 0.7146950136156718, 'loss_val': 1.1663608530532075, 'psi': 0.6842164119355828}-{'f1_val': 0.6424135558529455, 'auprc': 0.7135945189483008, 'loss_val': 1.3179764229105182, 'psi': 0.6708859410910877}
[S3] START round=43 head_norm_before_train=1.440615 cos_to_last_merge=0.9136 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=43 local utility u=0.134637 metrics={'f1_val': 0.9432155175661902, 'auprc': 0.9996218911692787, 'loss_val': 0.1609824094862817, 'psi': 0.9657780670074256}-{'f1_val': 0.9098464760207543, 'auprc': 0.9992504882058881, 'loss_val': 0.2289270213280091, 'psi': 0.9456080808948077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=43 head_norm_before_train=1.531309 cos_to_last_merge=0.9422 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=43 local utility u=0.901095 metrics={'f1_val': 0.9423299929062046, 'auprc': 0.9676011853378259, 'loss_val': 0.27858933710350997, 'psi': 0.9524384698788531}-{'f1_val': 0.706575852449496, 'auprc': 0.9190255910159671, 'loss_val': 0.5205287023860957, 'psi': 0.7915557478760844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=43 head_norm_before_train=1.629396 cos_to_last_merge=0.9843 (last merge round=23)
[S5] round=43 local utility u=0.001845 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9944844004835183, 'loss_val': 0.08535984441532654, 'psi': 0.9953297544646109}-{'f1_val': 0.9958933237853395, 'auprc': 0.9963625157403149, 'loss_val': 0.09468384938713961, 'psi': 0.9960810005673296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=43 head_norm_before_train=1.890431 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6011986462873529, 'auprc': 0.8756369662326886, 'loss_val': 0.9796398950968295, 'psi': 0.7109739742654871}-{'f1_val': 0.8121497605844905, 'auprc': 0.9477795323503337, 'loss_val': 0.565601532215579, 'psi': 0.8664016692908278}
[S7] START round=43 head_norm_before_train=1.375330 cos_to_last_merge=0.9763 (last merge round=22)
[S7] round=43 local utility u=1.000000 metrics={'f1_val': 0.6832059689557088, 'auprc': 0.8960700315429176, 'loss_val': 0.36670359945268877, 'psi': 0.7683515939905923}-{'f1_val': 0.40837003186597165, 'auprc': 0.7762026097095611, 'loss_val': 1.0837037976706567, 'psi': 0.5555030630034075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=43 head_norm_before_train=2.046525 (no previous merge yet)
[S8] round=43 local utility u=0.014046 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9988807669112258, 'loss_val': 0.03829820700511633, 'psi': 0.9958655761328771}-{'f1_val': 0.9896426608072839, 'auprc': 0.9989055295875966, 'loss_val': 0.0411886098629545, 'psi': 0.9933478083194089}
[S9] START round=43 head_norm_before_train=1.815521 cos_to_last_merge=0.7430 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.743
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9934995566352728, 'loss_val': 0.021211926461098658, 'psi': 0.9951498795216757}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950045012570392, 'loss_val': 0.020960568292087686, 'psi': 0.9959981075911506}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.959639 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9934384007301157, 'loss_val': 0.04342695014462169, 'psi': 0.9936979879223733}-{'f1_val': 0.9933416400801217, 'auprc': 0.9958508395131028, 'loss_val': 0.04525493045158808, 'psi': 0.9943453198533141}
[S11] START round=43 head_norm_before_train=1.484786 cos_to_last_merge=0.9380 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=43 local utility u=0.002375 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9980867664691299, 'loss_val': 0.02912588499109053, 'psi': 0.9971652595847103}-{'f1_val': 0.9963090846170353, 'auprc': 0.9976830225305107, 'loss_val': 0.031214302210147787, 'psi': 0.9968586597824254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=43 head_norm_before_train=1.351631 cos_to_last_merge=0.9148 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5601699369584715, 'auprc': 0.6872124347839621, 'loss_val': 0.7491147615890263, 'psi': 0.6109869360886677}-{'f1_val': 0.5700881309811406, 'auprc': 0.6812535045582662, 'loss_val': 0.6858490135073605, 'psi': 0.6145542804119908}
[S14] START round=43 head_norm_before_train=1.957841 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.998974221674679, 'loss_val': 0.025238162633399563, 'psi': 0.9980197186870754}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989233155936226, 'loss_val': 0.022898619110444215, 'psi': 0.9980142879384843}
[S15] START round=43 head_norm_before_train=1.515535 cos_to_last_merge=0.9605 (last merge round=22)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7653828295194588, 'auprc': 0.955950339865075, 'loss_val': 0.39686947061637085, 'psi': 0.8416098336577054}-{'f1_val': 0.9198523567048773, 'auprc': 0.9930746355272067, 'loss_val': 0.1228212196825989, 'psi': 0.949141268233809}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=2.079605 (no previous merge yet)
[S16] round=43 local utility u=0.660577 metrics={'f1_val': 0.9384004154387376, 'auprc': 0.9908586826737099, 'loss_val': 0.3129305159366216, 'psi': 0.9593837223327266}-{'f1_val': 0.8607904056283675, 'auprc': 0.8901215167814239, 'loss_val': 0.8662139370964709, 'psi': 0.8725228500895901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=43 head_norm_before_train=1.983179 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6025206199944139, 'auprc': 0.8669009228689588, 'loss_val': 1.0887033565667368, 'psi': 0.7082727411442319}-{'f1_val': 0.6147216948259688, 'auprc': 0.9032251916127416, 'loss_val': 0.9904121067848155, 'psi': 0.730123093540678}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:63202
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0100
[S8] DROPPED delta from S2 (cos=-0.0100 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S8
[S2] cosine check vs S8: cos=-0.0100
[S2] DROPPED delta from S8 (cos=-0.0100 < 0.0)
[S2] START round=44 head_norm_before_train=1.764609 cos_to_last_merge=0.9506 (last merge round=16)
[S2] round=44 local utility u=0.157586 metrics={'f1_val': 0.700712791188455, 'auprc': 0.7169773163288904, 'loss_val': 1.0789290748248415, 'psi': 0.7072186012446291}-{'f1_val': 0.6638973441488568, 'auprc': 0.7146950136156718, 'loss_val': 1.1663608530532075, 'psi': 0.6842164119355828}
[S3] START round=44 head_norm_before_train=1.454498 cos_to_last_merge=0.9112 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=44 local utility u=0.100658 metrics={'f1_val': 0.9697579993498621, 'auprc': 0.9996749490602226, 'loss_val': 0.11907988474394307, 'psi': 0.9817247792340063}-{'f1_val': 0.9432155175661902, 'auprc': 0.9996218911692787, 'loss_val': 0.1609824094862817, 'psi': 0.9657780670074256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=1.539961 cos_to_last_merge=0.9410 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.6319577423437723, 'auprc': 0.9127427351848023, 'loss_val': 0.6446751408619825, 'psi': 0.7442717394801843}-{'f1_val': 0.9423299929062046, 'auprc': 0.9676011853378259, 'loss_val': 0.27858933710350997, 'psi': 0.9524384698788531}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.645862 cos_to_last_merge=0.9820 (last merge round=23)
[S5] round=44 local utility u=0.010253 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9970822216653841, 'loss_val': 0.07264814160618781, 'psi': 0.9963688829373573}-{'f1_val': 0.9958933237853395, 'auprc': 0.9944844004835183, 'loss_val': 0.08535984441532654, 'psi': 0.9953297544646109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=44 head_norm_before_train=1.896153 (no previous merge yet)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.9360933041738294, 'auprc': 0.9709081302440938, 'loss_val': 0.25239008309346295, 'psi': 0.9500192346019352}-{'f1_val': 0.6011986462873529, 'auprc': 0.8756369662326886, 'loss_val': 0.9796398950968295, 'psi': 0.7109739742654871}
[S7] START round=44 head_norm_before_train=1.380214 cos_to_last_merge=0.9756 (last merge round=22)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.4213287341146889, 'auprc': 0.7809179549661792, 'loss_val': 1.0136059889412377, 'psi': 0.5651644224552851}-{'f1_val': 0.6832059689557088, 'auprc': 0.8960700315429176, 'loss_val': 0.36670359945268877, 'psi': 0.7683515939905923}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.050607 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9882500123346475, 'auprc': 0.9987556830350756, 'loss_val': 0.04228760300675916, 'psi': 0.9924522806148188}-{'f1_val': 0.9938554489473111, 'auprc': 0.9988807669112258, 'loss_val': 0.03829820700511633, 'psi': 0.9958655761328771}
[S9] START round=44 head_norm_before_train=1.824117 cos_to_last_merge=0.7422 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.742
[S9] round=44 local utility u=0.001002 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9989177893509865, 'loss_val': 0.022922843419837222, 'psi': 0.9960631757640686}-{'f1_val': 0.9962500947792776, 'auprc': 0.9934995566352728, 'loss_val': 0.021211926461098658, 'psi': 0.9951498795216757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=44 head_norm_before_train=1.968629 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9525886391967706, 'auprc': 0.9920213675260592, 'loss_val': 0.11604541801315976, 'psi': 0.9683617305284861}-{'f1_val': 0.993871046050545, 'auprc': 0.9934384007301157, 'loss_val': 0.04342695014462169, 'psi': 0.9936979879223733}
[S11] START round=44 head_norm_before_train=1.497938 cos_to_last_merge=0.9364 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9919306794946181, 'auprc': 0.9986628317597637, 'loss_val': 0.0408126265704225, 'psi': 0.9946235404006764}-{'f1_val': 0.9965509216617638, 'auprc': 0.9980867664691299, 'loss_val': 0.02912588499109053, 'psi': 0.9971652595847103}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.358797 cos_to_last_merge=0.9146 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=44 local utility u=0.026509 metrics={'f1_val': 0.5756082325557671, 'auprc': 0.6890607020189893, 'loss_val': 0.7942706291815406, 'psi': 0.620989220341056}-{'f1_val': 0.5601699369584715, 'auprc': 0.6872124347839621, 'loss_val': 0.7491147615890263, 'psi': 0.6109869360886677}
[S14] START round=44 head_norm_before_train=1.967542 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.002771 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988287933876764, 'loss_val': 0.02073439396717751, 'psi': 0.9981089831920069}-{'f1_val': 0.9973833833620065, 'auprc': 0.998974221674679, 'loss_val': 0.025238162633399563, 'psi': 0.9980197186870754}
[S15] START round=44 head_norm_before_train=1.530418 cos_to_last_merge=0.9591 (last merge round=22)
[S15] round=44 local utility u=0.194909 metrics={'f1_val': 0.7933059102170296, 'auprc': 0.9894125529577187, 'loss_val': 0.2749760279656105, 'psi': 0.8717485673133052}-{'f1_val': 0.7653828295194588, 'auprc': 0.955950339865075, 'loss_val': 0.39686947061637085, 'psi': 0.8416098336577054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=44 head_norm_before_train=2.086810 (no previous merge yet)
[S16] round=44 local utility u=0.283882 metrics={'f1_val': 0.9880586131524365, 'auprc': 0.9942198954768946, 'loss_val': 0.053198433776816205, 'psi': 0.9905231260822197}-{'f1_val': 0.9384004154387376, 'auprc': 0.9908586826737099, 'loss_val': 0.3129305159366216, 'psi': 0.9593837223327266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=44 head_norm_before_train=1.987451 (no previous merge yet)
[S17] round=44 local utility u=0.179490 metrics={'f1_val': 0.6098257528338892, 'auprc': 0.9251094865518377, 'loss_val': 0.9481802454034071, 'psi': 0.7359392463210686}-{'f1_val': 0.6025206199944139, 'auprc': 0.8669009228689588, 'loss_val': 1.0887033565667368, 'psi': 0.7082727411442319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0100
[S8] DROPPED delta from S2 (cos=-0.0100 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1410
[S6] DROPPED delta from S13 (cos=-0.1410 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1804) from S6
[S13] cosine check vs S6: cos=-0.1410
[S13] DROPPED delta from S6 (cos=-0.1410 < 0.0)
[S2] START round=45 head_norm_before_train=1.772868 cos_to_last_merge=0.9500 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6601226527629804, 'auprc': 0.7135645577847319, 'loss_val': 1.269168124682098, 'psi': 0.6814994147716811}-{'f1_val': 0.700712791188455, 'auprc': 0.7169773163288904, 'loss_val': 1.0789290748248415, 'psi': 0.7072186012446291}
[S3] START round=45 head_norm_before_train=1.468725 cos_to_last_merge=0.9084 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9528210035859969, 'auprc': 0.9990641630232796, 'loss_val': 0.14097316201441934, 'psi': 0.97131826736091}-{'f1_val': 0.9697579993498621, 'auprc': 0.9996749490602226, 'loss_val': 0.11907988474394307, 'psi': 0.9817247792340063}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.545992 cos_to_last_merge=0.9402 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=45 local utility u=1.000000 metrics={'f1_val': 0.9370099298845167, 'auprc': 0.9368975249402388, 'loss_val': 0.2868347878256008, 'psi': 0.9369649679068056}-{'f1_val': 0.6319577423437723, 'auprc': 0.9127427351848023, 'loss_val': 0.6446751408619825, 'psi': 0.7442717394801843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=45 head_norm_before_train=1.666262 cos_to_last_merge=0.9791 (last merge round=23)
[S5] round=45 local utility u=0.004877 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9971173794698807, 'loss_val': 0.0638798481003339, 'psi': 0.9964708869313754}-{'f1_val': 0.9958933237853395, 'auprc': 0.9970822216653841, 'loss_val': 0.07264814160618781, 'psi': 0.9963688829373573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=45 head_norm_before_train=1.901615 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8160282094903841, 'auprc': 0.9432821482670386, 'loss_val': 0.42277766973143377, 'psi': 0.8669297850010459}-{'f1_val': 0.9360933041738294, 'auprc': 0.9709081302440938, 'loss_val': 0.25239008309346295, 'psi': 0.9500192346019352}
[S7] START round=45 head_norm_before_train=1.384287 cos_to_last_merge=0.9749 (last merge round=22)
[S7] round=45 local utility u=0.742891 metrics={'f1_val': 0.60071593779799, 'auprc': 0.799345917141169, 'loss_val': 0.6594312293422581, 'psi': 0.6801679295352616}-{'f1_val': 0.4213287341146889, 'auprc': 0.7809179549661792, 'loss_val': 1.0136059889412377, 'psi': 0.5651644224552851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=45 head_norm_before_train=2.058482 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9839526961539431, 'auprc': 0.9989318661517883, 'loss_val': 0.04918992342869394, 'psi': 0.9899443641530812}-{'f1_val': 0.9882500123346475, 'auprc': 0.9987556830350756, 'loss_val': 0.04228760300675916, 'psi': 0.9924522806148188}
[S9] START round=45 head_norm_before_train=1.832314 cos_to_last_merge=0.7415 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.741
[S9] round=45 local utility u=0.004814 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9961569004720172, 'loss_val': 0.020013850839655605, 'psi': 0.9964590672771417}-{'f1_val': 0.9941601000394567, 'auprc': 0.9989177893509865, 'loss_val': 0.022922843419837222, 'psi': 0.9960631757640686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=45 head_norm_before_train=1.978959 cos_to_last_merge=0.9999 (last merge round=42)
[S10] round=45 local utility u=0.171328 metrics={'f1_val': 0.9951206605869882, 'auprc': 0.9958449010468646, 'loss_val': 0.040052602515681504, 'psi': 0.9954103567709387}-{'f1_val': 0.9525886391967706, 'auprc': 0.9920213675260592, 'loss_val': 0.11604541801315976, 'psi': 0.9683617305284861}
[S11] START round=45 head_norm_before_train=1.510996 cos_to_last_merge=0.9348 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=45 local utility u=0.017617 metrics={'f1_val': 0.9960013849390938, 'auprc': 0.9984036984937162, 'loss_val': 0.029225163190561818, 'psi': 0.9969623103609428}-{'f1_val': 0.9919306794946181, 'auprc': 0.9986628317597637, 'loss_val': 0.0408126265704225, 'psi': 0.9946235404006764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=45 head_norm_before_train=1.368619 cos_to_last_merge=0.9152 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=45 local utility u=0.001836 metrics={'f1_val': 0.5664901134728443, 'auprc': 0.6817720641804506, 'loss_val': 0.7140234291195807, 'psi': 0.6126028937558867}-{'f1_val': 0.5756082325557671, 'auprc': 0.6890607020189893, 'loss_val': 0.7942706291815406, 'psi': 0.620989220341056}
[S14] START round=45 head_norm_before_train=1.978330 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.998733159120057, 'loss_val': 0.02140308067367146, 'psi': 0.9978242725464761}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988287933876764, 'loss_val': 0.02073439396717751, 'psi': 0.9981089831920069}
[S15] START round=45 head_norm_before_train=1.545662 cos_to_last_merge=0.9576 (last merge round=22)
[S15] round=45 local utility u=0.728977 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9912198949581617, 'loss_val': 0.040862376787449556, 'psi': 0.9943132661694585}-{'f1_val': 0.7933059102170296, 'auprc': 0.9894125529577187, 'loss_val': 0.2749760279656105, 'psi': 0.8717485673133052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=45 head_norm_before_train=2.095087 (no previous merge yet)
[S16] round=45 local utility u=0.014886 metrics={'f1_val': 0.9914581070074141, 'auprc': 0.9943214399104763, 'loss_val': 0.04412830813580434, 'psi': 0.992603440168639}-{'f1_val': 0.9880586131524365, 'auprc': 0.9942198954768946, 'loss_val': 0.053198433776816205, 'psi': 0.9905231260822197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=45 head_norm_before_train=1.991235 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6164841111927526, 'auprc': 0.9066856707991046, 'loss_val': 0.9785442797926914, 'psi': 0.7325647350352934}-{'f1_val': 0.6098257528338892, 'auprc': 0.9251094865518377, 'loss_val': 0.9481802454034071, 'psi': 0.7359392463210686}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.232 → S13@127.0.0.1:63213
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] ⇄ pheromone p=0.013 → S2@127.0.0.1:63202
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] ⇄ pheromone p=0.103 → S8@127.0.0.1:63209
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1799) from S13
[S6] cosine check vs S13: cos=-0.1399
[S6] DROPPED delta from S13 (cos=-0.1399 < 0.0)
[S13] ⇄ pheromone p=0.055 → S6@127.0.0.1:63207
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.9951 head_norm=1.990076
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.923775e-02
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.9951 head_norm=1.984119 delta_norm=0.019238
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.040 → S14@127.0.0.1:63214
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9972 head_norm=1.989018
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.110966e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9972 head_norm=1.989435 delta_norm=0.021110
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.001 → S10@127.0.0.1:63211
[S2] START round=46 head_norm_before_train=1.778279 cos_to_last_merge=0.9496 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=46 local utility u=0.012549 metrics={'f1_val': 0.6606305850768077, 'auprc': 0.7125203541780786, 'loss_val': 1.243985753697275, 'psi': 0.6813864927173161}-{'f1_val': 0.6601226527629804, 'auprc': 0.7135645577847319, 'loss_val': 1.269168124682098, 'psi': 0.6814994147716811}
[S3] START round=46 head_norm_before_train=1.484861 cos_to_last_merge=0.9054 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8212508492667554, 'auprc': 0.9709960351730569, 'loss_val': 0.3528136995523354, 'psi': 0.881148923629276}-{'f1_val': 0.9528210035859969, 'auprc': 0.9990641630232796, 'loss_val': 0.14097316201441934, 'psi': 0.97131826736091}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.551160 cos_to_last_merge=0.9394 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=46 local utility u=0.106617 metrics={'f1_val': 0.9528052592044087, 'auprc': 0.9605986978181643, 'loss_val': 0.23947558633848653, 'psi': 0.955922634649911}-{'f1_val': 0.9370099298845167, 'auprc': 0.9368975249402388, 'loss_val': 0.2868347878256008, 'psi': 0.9369649679068056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=46 head_norm_before_train=1.688026 cos_to_last_merge=0.9762 (last merge round=23)
[S5] round=46 local utility u=0.002439 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9971996370555316, 'loss_val': 0.058370121932782626, 'psi': 0.9964158490934163}-{'f1_val': 0.9960398919057053, 'auprc': 0.9971173794698807, 'loss_val': 0.0638798481003339, 'psi': 0.9964708869313754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=46 head_norm_before_train=1.908555 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6017576082882985, 'auprc': 0.9393880974909369, 'loss_val': 0.9215479874027966, 'psi': 0.7368098039693538}-{'f1_val': 0.8160282094903841, 'auprc': 0.9432821482670386, 'loss_val': 0.42277766973143377, 'psi': 0.8669297850010459}
[S7] START round=46 head_norm_before_train=1.390871 cos_to_last_merge=0.9739 (last merge round=22)
[S7] round=46 local utility u=0.442957 metrics={'f1_val': 0.6742213710134985, 'auprc': 0.8641924743555368, 'loss_val': 0.40908947567572873, 'psi': 0.7502098123503138}-{'f1_val': 0.60071593779799, 'auprc': 0.799345917141169, 'loss_val': 0.6594312293422581, 'psi': 0.6801679295352616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=2.065644 (no previous merge yet)
[S8] round=46 local utility u=0.023227 metrics={'f1_val': 0.9897498716558931, 'auprc': 0.9991131545173078, 'loss_val': 0.03806273116713092, 'psi': 0.993495184800459}-{'f1_val': 0.9839526961539431, 'auprc': 0.9989318661517883, 'loss_val': 0.04918992342869394, 'psi': 0.9899443641530812}
[S9] START round=46 head_norm_before_train=1.840182 cos_to_last_merge=0.7408 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.741
[S9] round=46 local utility u=0.001348 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969142143617522, 'loss_val': 0.01958915931424621, 'psi': 0.9967619928330358}-{'f1_val': 0.9966605118138915, 'auprc': 0.9961569004720172, 'loss_val': 0.020013850839655605, 'psi': 0.9964590672771417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=46 head_norm_before_train=1.984119 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.86933816027986, 'auprc': 0.9920898134847073, 'loss_val': 0.2794656244773773, 'psi': 0.9184388215617989}-{'f1_val': 0.9951206605869882, 'auprc': 0.9958449010468646, 'loss_val': 0.040052602515681504, 'psi': 0.9954103567709387}
[S11] START round=46 head_norm_before_train=1.523923 cos_to_last_merge=0.9332 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=46 local utility u=0.002572 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9978011894710991, 'loss_val': 0.02660072298646599, 'psi': 0.9971539275373489}-{'f1_val': 0.9960013849390938, 'auprc': 0.9984036984937162, 'loss_val': 0.029225163190561818, 'psi': 0.9969623103609428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=46 head_norm_before_train=1.382002 cos_to_last_merge=0.9152 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5502526060352574, 'auprc': 0.6916180889451554, 'loss_val': 0.8951580520189417, 'psi': 0.6067987991992166}-{'f1_val': 0.5664901134728443, 'auprc': 0.6817720641804506, 'loss_val': 0.7140234291195807, 'psi': 0.6126028937558867}
[S14] START round=46 head_norm_before_train=1.989435 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000890 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9985939496513134, 'loss_val': 0.022681212880465308, 'psi': 0.9981160860164621}-{'f1_val': 0.9972183481640888, 'auprc': 0.998733159120057, 'loss_val': 0.02140308067367146, 'psi': 0.9978242725464761}
[S15] START round=46 head_norm_before_train=1.556675 cos_to_last_merge=0.9565 (last merge round=22)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6986405611798521, 'auprc': 0.7202187960749236, 'loss_val': 0.586725428888849, 'psi': 0.7072718551378807}-{'f1_val': 0.9963755136436562, 'auprc': 0.9912198949581617, 'loss_val': 0.040862376787449556, 'psi': 0.9943132661694585}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.103726 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9344671511894155, 'auprc': 0.9931234747342276, 'loss_val': 0.3782738423412935, 'psi': 0.9579296806073403}-{'f1_val': 0.9914581070074141, 'auprc': 0.9943214399104763, 'loss_val': 0.04412830813580434, 'psi': 0.992603440168639}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.995836 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5999783543103275, 'auprc': 0.8611407107736617, 'loss_val': 1.0777106995667072, 'psi': 0.7044432968956613}-{'f1_val': 0.6164841111927526, 'auprc': 0.9066856707991046, 'loss_val': 0.9785442797926914, 'psi': 0.7325647350352934}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S8
[S2] cosine check vs S8: cos=-0.0098
[S2] DROPPED delta from S8 (cos=-0.0098 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0098
[S8] DROPPED delta from S2 (cos=-0.0098 < 0.0)
[S2] START round=47 head_norm_before_train=1.785092 cos_to_last_merge=0.9491 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6345852216807363, 'auprc': 0.7137495328766024, 'loss_val': 1.4251308323372822, 'psi': 0.6662509461590826}-{'f1_val': 0.6606305850768077, 'auprc': 0.7125203541780786, 'loss_val': 1.243985753697275, 'psi': 0.6813864927173161}
[S3] START round=47 head_norm_before_train=1.500577 cos_to_last_merge=0.9028 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=47 local utility u=0.719429 metrics={'f1_val': 0.9971324581808498, 'auprc': 0.9996335706509837, 'loss_val': 0.055157473805730134, 'psi': 0.9981329031689034}-{'f1_val': 0.8212508492667554, 'auprc': 0.9709960351730569, 'loss_val': 0.3528136995523354, 'psi': 0.881148923629276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[S4] START round=47 head_norm_before_train=1.555686 cos_to_last_merge=0.9388 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9450399716725256, 'auprc': 0.9709403292263755, 'loss_val': 0.26062991870148283, 'psi': 0.9554001146940656}-{'f1_val': 0.9528052592044087, 'auprc': 0.9605986978181643, 'loss_val': 0.23947558633848653, 'psi': 0.955922634649911}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.705138 cos_to_last_merge=0.9739 (last merge round=23)
[S5] round=47 local utility u=0.003387 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9977477449033542, 'loss_val': 0.053240773823086854, 'psi': 0.9966350922325453}-{'f1_val': 0.9958933237853395, 'auprc': 0.9971996370555316, 'loss_val': 0.058370121932782626, 'psi': 0.9964158490934163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.914778 (no previous merge yet)
[S6] round=47 local utility u=0.708153 metrics={'f1_val': 0.7924314037183615, 'auprc': 0.9316646271937604, 'loss_val': 0.6261137503527295, 'psi': 0.8481246931085211}-{'f1_val': 0.6017576082882985, 'auprc': 0.9393880974909369, 'loss_val': 0.9215479874027966, 'psi': 0.7368098039693538}
[S7] START round=47 head_norm_before_train=1.396636 cos_to_last_merge=0.9730 (last merge round=22)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.4081669030900682, 'auprc': 0.7766542392279618, 'loss_val': 1.1258731463107248, 'psi': 0.5555618375452256}-{'f1_val': 0.6742213710134985, 'auprc': 0.8641924743555368, 'loss_val': 0.40908947567572873, 'psi': 0.7502098123503138}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.073131 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9905104527786056, 'auprc': 0.986292986043101, 'loss_val': 0.06152161068067228, 'psi': 0.9888234660844037}-{'f1_val': 0.9897498716558931, 'auprc': 0.9991131545173078, 'loss_val': 0.03806273116713092, 'psi': 0.993495184800459}
[S9] START round=47 head_norm_before_train=1.847458 cos_to_last_merge=0.7402 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.740
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.998977085369553, 'loss_val': 0.023370259972399447, 'psi': 0.9960868941714951}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969142143617522, 'loss_val': 0.01958915931424621, 'psi': 0.9967619928330358}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.993335 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=47 local utility u=0.217614 metrics={'f1_val': 0.9260685874121395, 'auprc': 0.9921302290223817, 'loss_val': 0.1847406674981474, 'psi': 0.9524932440562364}-{'f1_val': 0.86933816027986, 'auprc': 0.9920898134847073, 'loss_val': 0.2794656244773773, 'psi': 0.9184388215617989}
[S11] START round=47 head_norm_before_train=1.536294 cos_to_last_merge=0.9317 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962419185632914, 'auprc': 0.9979847254735305, 'loss_val': 0.026062233302469172, 'psi': 0.996939041327387}-{'f1_val': 0.9967224195815153, 'auprc': 0.9978011894710991, 'loss_val': 0.02660072298646599, 'psi': 0.9971539275373489}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.397080 cos_to_last_merge=0.9141 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=47 local utility u=0.062750 metrics={'f1_val': 0.5654065186610842, 'auprc': 0.6877702441876538, 'loss_val': 0.8490379417448751, 'psi': 0.614352008871712}-{'f1_val': 0.5502526060352574, 'auprc': 0.6916180889451554, 'loss_val': 0.8951580520189417, 'psi': 0.6067987991992166}
[S14] START round=47 head_norm_before_train=1.997199 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=47 local utility u=0.001137 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992220269140301, 'loss_val': 0.019955014012149486, 'psi': 0.9981337724666474}-{'f1_val': 0.9977975102598944, 'auprc': 0.9985939496513134, 'loss_val': 0.022681212880465308, 'psi': 0.9981160860164621}
[S15] START round=47 head_norm_before_train=1.566359 cos_to_last_merge=0.9555 (last merge round=22)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9910663767491443, 'auprc': 0.9945331149183438, 'loss_val': 0.058627631461331924, 'psi': 0.9924530720168242}-{'f1_val': 0.6986405611798521, 'auprc': 0.7202187960749236, 'loss_val': 0.586725428888849, 'psi': 0.7072718551378807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=47 head_norm_before_train=2.109623 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8728898035110573, 'auprc': 0.9864732704600828, 'loss_val': 0.7520281350057257, 'psi': 0.9183231902906674}-{'f1_val': 0.9344671511894155, 'auprc': 0.9931234747342276, 'loss_val': 0.3782738423412935, 'psi': 0.9579296806073403}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.002738 (no previous merge yet)
[S17] round=47 local utility u=0.152555 metrics={'f1_val': 0.6028277473093445, 'auprc': 0.9245656148129289, 'loss_val': 0.9799718162842624, 'psi': 0.7315228943107783}-{'f1_val': 0.5999783543103275, 'auprc': 0.8611407107736617, 'loss_val': 1.0777106995667072, 'psi': 0.7044432968956613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1379
[S6] DROPPED delta from S13 (cos=-0.1379 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S6
[S13] cosine check vs S6: cos=-0.1379
[S13] DROPPED delta from S6 (cos=-0.1379 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9974 head_norm=2.005100
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.439204e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9974 head_norm=2.002820 delta_norm=0.014392
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=47 metric=0.9261 head_norm=2.000642
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.274312e-02
[S10] stored merged vector for next round verification (round=47)
[S10] DEBUG after merge:  round=47 metric=0.9258 head_norm=2.000853 delta_norm=0.012743
[S10] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.792636 cos_to_last_merge=0.9484 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=48 local utility u=0.318003 metrics={'f1_val': 0.6928546749071475, 'auprc': 0.7152734022623315, 'loss_val': 1.1433124357168152, 'psi': 0.7018221658492211}-{'f1_val': 0.6345852216807363, 'auprc': 0.7137495328766024, 'loss_val': 1.4251308323372822, 'psi': 0.6662509461590826}
[S3] START round=48 head_norm_before_train=1.514205 cos_to_last_merge=0.9004 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9208849717551173, 'auprc': 0.980069095943195, 'loss_val': 0.204868709643255, 'psi': 0.9445586214303484}-{'f1_val': 0.9971324581808498, 'auprc': 0.9996335706509837, 'loss_val': 0.055157473805730134, 'psi': 0.9981329031689034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.560335 cos_to_last_merge=0.9382 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9141562578992737, 'auprc': 0.9182676557636247, 'loss_val': 0.36441093653049483, 'psi': 0.915800817045014}-{'f1_val': 0.9450399716725256, 'auprc': 0.9709403292263755, 'loss_val': 0.26062991870148283, 'psi': 0.9554001146940656}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.722378 cos_to_last_merge=0.9717 (last merge round=23)
[S5] round=48 local utility u=0.001883 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9975939091770389, 'loss_val': 0.049892898395568354, 'psi': 0.9966614988142388}-{'f1_val': 0.9958933237853395, 'auprc': 0.9977477449033542, 'loss_val': 0.053240773823086854, 'psi': 0.9966350922325453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.920323 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7314119116525973, 'auprc': 0.9510194147256468, 'loss_val': 0.7201322776061293, 'psi': 0.8192549128818172}-{'f1_val': 0.7924314037183615, 'auprc': 0.9316646271937604, 'loss_val': 0.6261137503527295, 'psi': 0.8481246931085211}
[S7] START round=48 head_norm_before_train=1.399660 cos_to_last_merge=0.9726 (last merge round=22)
[S7] round=48 local utility u=0.655128 metrics={'f1_val': 0.5570641603985546, 'auprc': 0.7930435249589886, 'loss_val': 0.7581680553746295, 'psi': 0.6514559062227281}-{'f1_val': 0.4081669030900682, 'auprc': 0.7766542392279618, 'loss_val': 1.1258731463107248, 'psi': 0.5555618375452256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=2.082248 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9702626944505955, 'auprc': 0.9989259657244193, 'loss_val': 0.07274455465865698, 'psi': 0.981728002960125}-{'f1_val': 0.9905104527786056, 'auprc': 0.986292986043101, 'loss_val': 0.06152161068067228, 'psi': 0.9888234660844037}
[S9] START round=48 head_norm_before_train=1.854262 cos_to_last_merge=0.7397 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.740
[S9] round=48 local utility u=0.004175 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.996181724499621, 'loss_val': 0.019151056878072194, 'psi': 0.9962203587793799}-{'f1_val': 0.9941601000394567, 'auprc': 0.998977085369553, 'loss_val': 0.023370259972399447, 'psi': 0.9960868941714951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=48 head_norm_before_train=2.000853 cos_to_last_merge=1.0000 (last merge round=47)
[S10] round=48 local utility u=0.259189 metrics={'f1_val': 0.9926296321948362, 'auprc': 0.9955305686434652, 'loss_val': 0.07593038831751298, 'psi': 0.9937900067742877}-{'f1_val': 0.9260685874121395, 'auprc': 0.9921302290223817, 'loss_val': 0.1847406674981474, 'psi': 0.9524932440562364}
[S11] START round=48 head_norm_before_train=1.547778 cos_to_last_merge=0.9303 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9968270316712569, 'loss_val': 0.026088819359725155, 'psi': 0.9965162634387239}-{'f1_val': 0.9962419185632914, 'auprc': 0.9979847254735305, 'loss_val': 0.026062233302469172, 'psi': 0.996939041327387}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.410228 cos_to_last_merge=0.9127 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=48 local utility u=0.048090 metrics={'f1_val': 0.5817619845190515, 'auprc': 0.6908274377762167, 'loss_val': 0.8601617940880225, 'psi': 0.6253881658219176}-{'f1_val': 0.5654065186610842, 'auprc': 0.6877702441876538, 'loss_val': 0.8490379417448751, 'psi': 0.614352008871712}
[S14] START round=48 head_norm_before_train=2.002820 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9991993345459185, 'loss_val': 0.021482752816392472, 'psi': 0.9978782387129664}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992220269140301, 'loss_val': 0.019955014012149486, 'psi': 0.9981337724666474}
[S15] START round=48 head_norm_before_train=1.575066 cos_to_last_merge=0.9546 (last merge round=22)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9580616525339647, 'auprc': 0.9901130957726619, 'loss_val': 0.07478863312553231, 'psi': 0.9708822298294436}-{'f1_val': 0.9910663767491443, 'auprc': 0.9945331149183438, 'loss_val': 0.058627631461331924, 'psi': 0.9924530720168242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.112377 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.853487356601478, 'auprc': 0.8894249745103043, 'loss_val': 1.0018195735665019, 'psi': 0.8678624037650086}-{'f1_val': 0.8728898035110573, 'auprc': 0.9864732704600828, 'loss_val': 0.7520281350057257, 'psi': 0.9183231902906674}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.009696 (no previous merge yet)
[S17] round=48 local utility u=0.479632 metrics={'f1_val': 0.6889595310936872, 'auprc': 0.9910440316848574, 'loss_val': 0.7369331859069067, 'psi': 0.8097933313301553}-{'f1_val': 0.6028277473093445, 'auprc': 0.9245656148129289, 'loss_val': 0.9799718162842624, 'psi': 0.7315228943107783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0095
[S8] DROPPED delta from S2 (cos=-0.0095 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1371
[S6] DROPPED delta from S13 (cos=-0.1371 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S2] START round=49 head_norm_before_train=1.798043 cos_to_last_merge=0.9480 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6764316575256312, 'auprc': 0.7111687792966221, 'loss_val': 1.1685812977689407, 'psi': 0.6903265062340276}-{'f1_val': 0.6928546749071475, 'auprc': 0.7152734022623315, 'loss_val': 1.1433124357168152, 'psi': 0.7018221658492211}
[S3] START round=49 head_norm_before_train=1.526178 cos_to_last_merge=0.8983 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=49 local utility u=0.294173 metrics={'f1_val': 0.9879819545967933, 'auprc': 0.9996195576591508, 'loss_val': 0.07775598994840101, 'psi': 0.9926369958217363}-{'f1_val': 0.9208849717551173, 'auprc': 0.980069095943195, 'loss_val': 0.204868709643255, 'psi': 0.9445586214303484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=49 head_norm_before_train=1.567332 cos_to_last_merge=0.9372 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=49 local utility u=0.099655 metrics={'f1_val': 0.9369266054332741, 'auprc': 0.9258332385916865, 'loss_val': 0.32441914289308604, 'psi': 0.9324892586966391}-{'f1_val': 0.9141562578992737, 'auprc': 0.9182676557636247, 'loss_val': 0.36441093653049483, 'psi': 0.915800817045014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=49 head_norm_before_train=1.740219 cos_to_last_merge=0.9695 (last merge round=23)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9277258641546658, 'auprc': 0.9899953248407508, 'loss_val': 0.12314523985092135, 'psi': 0.9526336484290998}-{'f1_val': 0.9960398919057053, 'auprc': 0.9975939091770389, 'loss_val': 0.049892898395568354, 'psi': 0.9966614988142388}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.927758 (no previous merge yet)
[S6] round=49 local utility u=0.560596 metrics={'f1_val': 0.8670046071987321, 'auprc': 0.9558699115909324, 'loss_val': 0.4270488036552326, 'psi': 0.9025507289556122}-{'f1_val': 0.7314119116525973, 'auprc': 0.9510194147256468, 'loss_val': 0.7201322776061293, 'psi': 0.8192549128818172}
[S7] START round=49 head_norm_before_train=1.403994 cos_to_last_merge=0.9719 (last merge round=22)
[S7] round=49 local utility u=0.355692 metrics={'f1_val': 0.6263768182825882, 'auprc': 0.8198658719753357, 'loss_val': 0.5431265987289127, 'psi': 0.7037724397596872}-{'f1_val': 0.5570641603985546, 'auprc': 0.7930435249589886, 'loss_val': 0.7581680553746295, 'psi': 0.6514559062227281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=2.091070 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9861047955759558, 'loss_val': 0.3336653076827267, 'psi': 0.8225887591047414}-{'f1_val': 0.9702626944505955, 'auprc': 0.9989259657244193, 'loss_val': 0.07274455465865698, 'psi': 0.981728002960125}
[S9] START round=49 head_norm_before_train=1.861604 cos_to_last_merge=0.7391 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.739
[S9] round=49 local utility u=0.000443 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955772275783192, 'loss_val': 0.018938727426538623, 'psi': 0.9962271981196625}-{'f1_val': 0.9962461149658858, 'auprc': 0.996181724499621, 'loss_val': 0.019151056878072194, 'psi': 0.9962203587793799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=49 head_norm_before_train=2.007924 cos_to_last_merge=1.0000 (last merge round=47)
[S10] round=49 local utility u=0.017322 metrics={'f1_val': 0.9949429933780081, 'auprc': 0.9955298222015242, 'loss_val': 0.055164137572517584, 'psi': 0.9951777249074145}-{'f1_val': 0.9926296321948362, 'auprc': 0.9955305686434652, 'loss_val': 0.07593038831751298, 'psi': 0.9937900067742877}
[S11] START round=49 head_norm_before_train=1.555553 cos_to_last_merge=0.9295 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9953015515531684, 'loss_val': 0.026298102719881256, 'psi': 0.9959060713914885}-{'f1_val': 0.9963090846170353, 'auprc': 0.9968270316712569, 'loss_val': 0.026088819359725155, 'psi': 0.9965162634387239}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.418534 cos_to_last_merge=0.9114 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5398062089400657, 'auprc': 0.7067101167935539, 'loss_val': 0.9674776598779415, 'psi': 0.6065677720814611}-{'f1_val': 0.5817619845190515, 'auprc': 0.6908274377762167, 'loss_val': 0.8601617940880225, 'psi': 0.6253881658219176}
[S14] START round=49 head_norm_before_train=2.011886 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.001049 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991356009607135, 'loss_val': 0.021674901317063327, 'psi': 0.9981008369449823}-{'f1_val': 0.9969975081576651, 'auprc': 0.9991993345459185, 'loss_val': 0.021482752816392472, 'psi': 0.9978782387129664}
[S15] START round=49 head_norm_before_train=1.583624 cos_to_last_merge=0.9538 (last merge round=22)
[S15] round=49 local utility u=0.134515 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9913192245363818, 'loss_val': 0.03926003970787324, 'psi': 0.9943529980007464}-{'f1_val': 0.9580616525339647, 'auprc': 0.9901130957726619, 'loss_val': 0.07478863312553231, 'psi': 0.9708822298294436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=49 head_norm_before_train=2.116417 (no previous merge yet)
[S16] round=49 local utility u=1.000000 metrics={'f1_val': 0.9882141128472468, 'auprc': 0.9913539043507469, 'loss_val': 0.05640666017786426, 'psi': 0.9894700294486468}-{'f1_val': 0.853487356601478, 'auprc': 0.8894249745103043, 'loss_val': 1.0018195735665019, 'psi': 0.8678624037650086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=49 head_norm_before_train=2.014496 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6058637177100454, 'auprc': 0.8304463347459122, 'loss_val': 1.043068248172655, 'psi': 0.6956967645243921}-{'f1_val': 0.6889595310936872, 'auprc': 0.9910440316848574, 'loss_val': 0.7369331859069067, 'psi': 0.8097933313301553}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63214
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1363
[S13] DROPPED delta from S6 (cos=-0.1363 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=49 metric=0.9949 head_norm=2.016532
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.172487e-02
[S10] stored merged vector for next round verification (round=49)
[S10] DEBUG after merge:  round=49 metric=0.9949 head_norm=2.019776 delta_norm=0.011725
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9974 head_norm=2.023082
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.154344e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9974 head_norm=2.017627 delta_norm=0.011543
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=1.804714 cos_to_last_merge=0.9474 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.6549981308918189, 'auprc': 0.6929369827507025, 'loss_val': 1.3030282783574385, 'psi': 0.6701736716353723}-{'f1_val': 0.6764316575256312, 'auprc': 0.7111687792966221, 'loss_val': 1.1685812977689407, 'psi': 0.6903265062340276}
[S3] START round=50 head_norm_before_train=1.536609 cos_to_last_merge=0.8965 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.8677400930463343, 'auprc': 0.9734205528854667, 'loss_val': 0.26632742081893734, 'psi': 0.9100122769819872}-{'f1_val': 0.9879819545967933, 'auprc': 0.9996195576591508, 'loss_val': 0.07775598994840101, 'psi': 0.9926369958217363}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.570884 cos_to_last_merge=0.9369 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.6248880779472602, 'auprc': 0.9055236678215797, 'loss_val': 0.7738531356909528, 'psi': 0.7371423138969879}-{'f1_val': 0.9369266054332741, 'auprc': 0.9258332385916865, 'loss_val': 0.32441914289308604, 'psi': 0.9324892586966391}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.755016 cos_to_last_merge=0.9679 (last merge round=23)
[S5] round=50 local utility u=0.132002 metrics={'f1_val': 0.9636616932429868, 'auprc': 0.9975569930927266, 'loss_val': 0.09744069573714031, 'psi': 0.9772198131828828}-{'f1_val': 0.9277258641546658, 'auprc': 0.9899953248407508, 'loss_val': 0.12314523985092135, 'psi': 0.9526336484290998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=50 head_norm_before_train=1.934942 (no previous merge yet)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.6198370995818423, 'auprc': 0.9419503998611374, 'loss_val': 0.8999824222837263, 'psi': 0.7486824196935603}-{'f1_val': 0.8670046071987321, 'auprc': 0.9558699115909324, 'loss_val': 0.4270488036552326, 'psi': 0.9025507289556122}
[S7] START round=50 head_norm_before_train=1.411588 cos_to_last_merge=0.9704 (last merge round=22)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.4978110948554323, 'auprc': 0.7835955052589566, 'loss_val': 0.91098625748058, 'psi': 0.612124859016842}-{'f1_val': 0.6263768182825882, 'auprc': 0.8198658719753357, 'loss_val': 0.5431265987289127, 'psi': 0.7037724397596872}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=2.098250 (no previous merge yet)
[S8] round=50 local utility u=1.000000 metrics={'f1_val': 0.992392260479464, 'auprc': 0.998945332419493, 'loss_val': 0.03164864280676764, 'psi': 0.9950134892554756}-{'f1_val': 0.7135780681239317, 'auprc': 0.9861047955759558, 'loss_val': 0.3336653076827267, 'psi': 0.8225887591047414}
[S9] START round=50 head_norm_before_train=1.866959 cos_to_last_merge=0.7387 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.739
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9991133081652986, 'loss_val': 0.02210099906464959, 'psi': 0.9966419757239524}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955772275783192, 'loss_val': 0.018938727426538623, 'psi': 0.9962271981196625}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.019776 cos_to_last_merge=1.0000 (last merge round=49)
[S10] round=50 local utility u=0.002104 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9955087368285366, 'loss_val': 0.05221375772292208, 'psi': 0.9953014759595873}-{'f1_val': 0.9949429933780081, 'auprc': 0.9955298222015242, 'loss_val': 0.055164137572517584, 'psi': 0.9951777249074145}
[S11] START round=50 head_norm_before_train=1.563100 cos_to_last_merge=0.9287 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9068894228347826, 'auprc': 0.9576006627806751, 'loss_val': 0.3797142939882538, 'psi': 0.9271739188131396}-{'f1_val': 0.9963090846170353, 'auprc': 0.9953015515531684, 'loss_val': 0.026298102719881256, 'psi': 0.9959060713914885}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.425816 cos_to_last_merge=0.9103 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=50 local utility u=0.240590 metrics={'f1_val': 0.5881551067376208, 'auprc': 0.709116898214269, 'loss_val': 0.7836123885507813, 'psi': 0.6365398233282802}-{'f1_val': 0.5398062089400657, 'auprc': 0.7067101167935539, 'loss_val': 0.9674776598779415, 'psi': 0.6065677720814611}
[S14] START round=50 head_norm_before_train=2.017627 cos_to_last_merge=1.0000 (last merge round=49)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.998570116894514, 'loss_val': 0.025743371498966057, 'psi': 0.9976133468080715}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991356009607135, 'loss_val': 0.021674901317063327, 'psi': 0.9981008369449823}
[S15] START round=50 head_norm_before_train=1.593318 cos_to_last_merge=0.9530 (last merge round=22)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9186615920281194, 'auprc': 0.9928480708635874, 'loss_val': 0.12147462286903173, 'psi': 0.9483361835623065}-{'f1_val': 0.9963755136436562, 'auprc': 0.9913192245363818, 'loss_val': 0.03926003970787324, 'psi': 0.9943529980007464}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=2.122529 (no previous merge yet)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.910373131243684, 'auprc': 0.9932942467470254, 'loss_val': 0.1865210678544318, 'psi': 0.9435415774450205}-{'f1_val': 0.9882141128472468, 'auprc': 0.9913539043507469, 'loss_val': 0.05640666017786426, 'psi': 0.9894700294486468}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=2.018978 (no previous merge yet)
[S17] round=50 local utility u=0.034410 metrics={'f1_val': 0.6042412776376009, 'auprc': 0.8362471638075462, 'loss_val': 0.9819151005728786, 'psi': 0.6970436321055791}-{'f1_val': 0.6058637177100454, 'auprc': 0.8304463347459122, 'loss_val': 1.043068248172655, 'psi': 0.6956967645243921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S6] ⇄ pheromone p=0.238 → S13@127.0.0.1:63213
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] ⇄ pheromone p=0.076 → S8@127.0.0.1:63209
[S14] ⇄ pheromone p=0.001 → S10@127.0.0.1:63211
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=-0.0094
[S2] DROPPED delta from S8 (cos=-0.0094 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1357
[S6] DROPPED delta from S13 (cos=-0.1357 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] ⇄ pheromone p=0.072 → S14@127.0.0.1:63214
[S8] ⇄ pheromone p=0.206 → S2@127.0.0.1:63202
[S13] ⇄ pheromone p=0.079 → S6@127.0.0.1:63207
[S2] START round=51 head_norm_before_train=1.812978 cos_to_last_merge=0.9466 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.6329049506606431, 'auprc': 0.6784671597682403, 'loss_val': 1.4708867493251436, 'psi': 0.651129834303682}-{'f1_val': 0.6549981308918189, 'auprc': 0.6929369827507025, 'loss_val': 1.3030282783574385, 'psi': 0.6701736716353723}
[S3] START round=51 head_norm_before_train=1.548542 cos_to_last_merge=0.8945 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=51 local utility u=0.509280 metrics={'f1_val': 0.9903488992161398, 'auprc': 0.9996627954001661, 'loss_val': 0.062146942351428536, 'psi': 0.9940744576897502}-{'f1_val': 0.8677400930463343, 'auprc': 0.9734205528854667, 'loss_val': 0.26632742081893734, 'psi': 0.9100122769819872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=51 head_norm_before_train=1.576595 cos_to_last_merge=0.9364 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=51 local utility u=1.000000 metrics={'f1_val': 0.9419198248472338, 'auprc': 0.949503036791715, 'loss_val': 0.2877444931832646, 'psi': 0.9449531096250263}-{'f1_val': 0.6248880779472602, 'auprc': 0.9055236678215797, 'loss_val': 0.7738531356909528, 'psi': 0.7371423138969879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=51 head_norm_before_train=1.765735 cos_to_last_merge=0.9666 (last merge round=23)
[S5] round=51 local utility u=0.117347 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9942269041904039, 'loss_val': 0.0461466496159236, 'psi': 0.9952267559473652}-{'f1_val': 0.9636616932429868, 'auprc': 0.9975569930927266, 'loss_val': 0.09744069573714031, 'psi': 0.9772198131828828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=51 head_norm_before_train=1.940743 (no previous merge yet)
[S6] round=51 local utility u=0.839655 metrics={'f1_val': 0.831302551225637, 'auprc': 0.9524867553621786, 'loss_val': 0.5210743115986906, 'psi': 0.8797762328802536}-{'f1_val': 0.6198370995818423, 'auprc': 0.9419503998611374, 'loss_val': 0.8999824222837263, 'psi': 0.7486824196935603}
[S7] START round=51 head_norm_before_train=1.419501 cos_to_last_merge=0.9690 (last merge round=22)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.46340980918264457, 'auprc': 0.7815862950186918, 'loss_val': 0.9963981718219769, 'psi': 0.5906804035170635}-{'f1_val': 0.4978110948554323, 'auprc': 0.7835955052589566, 'loss_val': 0.91098625748058, 'psi': 0.612124859016842}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=2.101703 (no previous merge yet)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9988844452888723, 'loss_val': 0.03169380508336174, 'psi': 0.994917222031462}-{'f1_val': 0.992392260479464, 'auprc': 0.998945332419493, 'loss_val': 0.03164864280676764, 'psi': 0.9950134892554756}
[S9] START round=51 head_norm_before_train=1.870396 cos_to_last_merge=0.7385 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.738
[S9] round=51 local utility u=0.000046 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995146355619647, 'loss_val': 0.020104941693863364, 'psi': 0.9960548493361937}-{'f1_val': 0.994994420763055, 'auprc': 0.9991133081652986, 'loss_val': 0.02210099906464959, 'psi': 0.9966419757239524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=51 head_norm_before_train=2.027428 cos_to_last_merge=1.0000 (last merge round=49)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.96394569819784, 'auprc': 0.9920465525295618, 'loss_val': 0.09058281738801237, 'psi': 0.9751860399305288}-{'f1_val': 0.9951633020469546, 'auprc': 0.9955087368285366, 'loss_val': 0.05221375772292208, 'psi': 0.9953014759595873}
[S11] START round=51 head_norm_before_train=1.570391 cos_to_last_merge=0.9278 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=51 local utility u=0.507534 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9978947340249487, 'loss_val': 0.024525570392519003, 'psi': 0.9971913453588888}-{'f1_val': 0.9068894228347826, 'auprc': 0.9576006627806751, 'loss_val': 0.3797142939882538, 'psi': 0.9271739188131396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=51 head_norm_before_train=1.432847 cos_to_last_merge=0.9096 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.5544892205660675, 'auprc': 0.7100957259967506, 'loss_val': 1.020485551275347, 'psi': 0.6167318227383407}-{'f1_val': 0.5881551067376208, 'auprc': 0.709116898214269, 'loss_val': 0.7836123885507813, 'psi': 0.6365398233282802}
[S14] START round=51 head_norm_before_train=2.026274 cos_to_last_merge=1.0000 (last merge round=49)
[S14] round=51 local utility u=0.004694 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9991902852624229, 'loss_val': 0.020698046599393574, 'psi': 0.9981095892307075}-{'f1_val': 0.9969755000837764, 'auprc': 0.998570116894514, 'loss_val': 0.025743371498966057, 'psi': 0.9976133468080715}
[S15] START round=51 head_norm_before_train=1.604891 cos_to_last_merge=0.9520 (last merge round=22)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.7773180039064336, 'auprc': 0.9891619436238496, 'loss_val': 0.31287371686758375, 'psi': 0.8620555797934}-{'f1_val': 0.9186615920281194, 'auprc': 0.9928480708635874, 'loss_val': 0.12147462286903173, 'psi': 0.9483361835623065}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.127202 (no previous merge yet)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.9372525754026564, 'auprc': 0.9834968617561317, 'loss_val': 0.3905174924203875, 'psi': 0.9557502899440465}-{'f1_val': 0.910373131243684, 'auprc': 0.9932942467470254, 'loss_val': 0.1865210678544318, 'psi': 0.9435415774450205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=2.026566 (no previous merge yet)
[S17] round=51 local utility u=0.630320 metrics={'f1_val': 0.6590259551198965, 'auprc': 0.9988335305747915, 'loss_val': 0.5377420695758183, 'psi': 0.7949489853018545}-{'f1_val': 0.6042412776376009, 'auprc': 0.8362471638075462, 'loss_val': 0.9819151005728786, 'psi': 0.6970436321055791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1353
[S13] DROPPED delta from S6 (cos=-0.1353 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=51 metric=0.9974 head_norm=2.033278
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.049604e-02
[S14] stored merged vector for next round verification (round=51)
[S14] DEBUG after merge:  round=51 metric=0.9974 head_norm=2.030328 delta_norm=0.010496
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=52 head_norm_before_train=1.822933 cos_to_last_merge=0.9455 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=52 local utility u=0.006356 metrics={'f1_val': 0.6309561364103107, 'auprc': 0.6829868534440747, 'loss_val': 1.4600414762354903, 'psi': 0.6517684232238163}-{'f1_val': 0.6329049506606431, 'auprc': 0.6784671597682403, 'loss_val': 1.4708867493251436, 'psi': 0.651129834303682}
[S3] START round=52 head_norm_before_train=1.560533 cos_to_last_merge=0.8924 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.892
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9556723307883446, 'auprc': 0.996519402588252, 'loss_val': 0.12116978426116352, 'psi': 0.9720111595083075}-{'f1_val': 0.9903488992161398, 'auprc': 0.9996627954001661, 'loss_val': 0.062146942351428536, 'psi': 0.9940744576897502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.584623 cos_to_last_merge=0.9352 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9395422314458797, 'auprc': 0.9310854686252844, 'loss_val': 0.29595058850764455, 'psi': 0.9361595263176415}-{'f1_val': 0.9419198248472338, 'auprc': 0.949503036791715, 'loss_val': 0.2877444931832646, 'psi': 0.9449531096250263}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.773188 cos_to_last_merge=0.9658 (last merge round=23)
[S5] round=52 local utility u=0.001013 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9943442012792079, 'loss_val': 0.04447257283517472, 'psi': 0.9952736747828868}-{'f1_val': 0.9958933237853395, 'auprc': 0.9942269041904039, 'loss_val': 0.0461466496159236, 'psi': 0.9952267559473652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=52 head_norm_before_train=1.947443 (no previous merge yet)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.7425022743242249, 'auprc': 0.8771892785378865, 'loss_val': 0.6511907899635936, 'psi': 0.7963770760096895}-{'f1_val': 0.831302551225637, 'auprc': 0.9524867553621786, 'loss_val': 0.5210743115986906, 'psi': 0.8797762328802536}
[S7] START round=52 head_norm_before_train=1.425355 cos_to_last_merge=0.9680 (last merge round=22)
[S7] round=52 local utility u=1.000000 metrics={'f1_val': 0.67351595148766, 'auprc': 0.8504287750138886, 'loss_val': 0.396125558199059, 'psi': 0.7442810808981515}-{'f1_val': 0.46340980918264457, 'auprc': 0.7815862950186918, 'loss_val': 0.9963981718219769, 'psi': 0.5906804035170635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=52 head_norm_before_train=2.106585 (no previous merge yet)
[S8] round=52 local utility u=0.003353 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9989140556842762, 'loss_val': 0.02945354817110118, 'psi': 0.9953666969653829}-{'f1_val': 0.9922724065265219, 'auprc': 0.9988844452888723, 'loss_val': 0.03169380508336174, 'psi': 0.994917222031462}
[S9] START round=52 head_norm_before_train=1.874562 cos_to_last_merge=0.7381 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.738
[S9] round=52 local utility u=0.006472 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9991177528739705, 'loss_val': 0.01907471981030777, 'psi': 0.9976434082379231}-{'f1_val': 0.9966605118138915, 'auprc': 0.995146355619647, 'loss_val': 0.020104941693863364, 'psi': 0.9960548493361937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=52 head_norm_before_train=2.036192 cos_to_last_merge=1.0000 (last merge round=49)
[S10] round=52 local utility u=0.116189 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9934695203222812, 'loss_val': 0.049821083642272876, 'psi': 0.9944900623579228}-{'f1_val': 0.96394569819784, 'auprc': 0.9920465525295618, 'loss_val': 0.09058281738801237, 'psi': 0.9751860399305288}
[S11] START round=52 head_norm_before_train=1.576522 cos_to_last_merge=0.9271 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=52 local utility u=0.000646 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9980871330745161, 'loss_val': 0.02381047907505888, 'psi': 0.9972683049787157}-{'f1_val': 0.9967224195815153, 'auprc': 0.9978947340249487, 'loss_val': 0.024525570392519003, 'psi': 0.9971913453588888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=52 head_norm_before_train=1.445570 cos_to_last_merge=0.9090 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=52 local utility u=0.178356 metrics={'f1_val': 0.5896470002748013, 'auprc': 0.7075803597537846, 'loss_val': 0.8671738075259711, 'psi': 0.6368203440663947}-{'f1_val': 0.5544892205660675, 'auprc': 0.7100957259967506, 'loss_val': 1.020485551275347, 'psi': 0.6167318227383407}
[S14] START round=52 head_norm_before_train=2.030328 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988050755342961, 'loss_val': 0.01988981775201597, 'psi': 0.9979537872024673}-{'f1_val': 0.9973891252095638, 'auprc': 0.9991902852624229, 'loss_val': 0.020698046599393574, 'psi': 0.9981095892307075}
[S15] START round=52 head_norm_before_train=1.616673 cos_to_last_merge=0.9509 (last merge round=22)
[S15] round=52 local utility u=0.805514 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.992450175580532, 'loss_val': 0.028282984508861946, 'psi': 0.9950280712647251}-{'f1_val': 0.7773180039064336, 'auprc': 0.9891619436238496, 'loss_val': 0.31287371686758375, 'psi': 0.8620555797934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=52 head_norm_before_train=2.128508 (no previous merge yet)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9229106316677831, 'auprc': 0.9870489192830298, 'loss_val': 0.47561300954193503, 'psi': 0.9485659467138818}-{'f1_val': 0.9372525754026564, 'auprc': 0.9834968617561317, 'loss_val': 0.3905174924203875, 'psi': 0.9557502899440465}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=2.033332 (no previous merge yet)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5910018301818944, 'auprc': 0.89946495733859, 'loss_val': 0.8333483784190547, 'psi': 0.7143870810445727}-{'f1_val': 0.6590259551198965, 'auprc': 0.9988335305747915, 'loss_val': 0.5377420695758183, 'psi': 0.7949489853018545}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0097
[S8] DROPPED delta from S2 (cos=-0.0097 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1344
[S6] DROPPED delta from S13 (cos=-0.1344 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=-0.0097
[S2] DROPPED delta from S8 (cos=-0.0097 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=52 metric=0.9952 head_norm=2.046071
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.732374e-02
[S10] stored merged vector for next round verification (round=52)
[S10] DEBUG after merge:  round=52 metric=0.9952 head_norm=2.039611 delta_norm=0.017324
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.832942 cos_to_last_merge=0.9444 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=53 local utility u=0.020496 metrics={'f1_val': 0.6339990018099522, 'auprc': 0.6958679273255426, 'loss_val': 1.4759503127580036, 'psi': 0.6587465720161884}-{'f1_val': 0.6309561364103107, 'auprc': 0.6829868534440747, 'loss_val': 1.4600414762354903, 'psi': 0.6517684232238163}
[S3] START round=53 head_norm_before_train=1.570705 cos_to_last_merge=0.8907 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9178505152453769, 'auprc': 0.9776276241454807, 'loss_val': 0.20137336664735925, 'psi': 0.9417613588054183}-{'f1_val': 0.9556723307883446, 'auprc': 0.996519402588252, 'loss_val': 0.12116978426116352, 'psi': 0.9720111595083075}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.590417 cos_to_last_merge=0.9345 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=53 local utility u=0.075440 metrics={'f1_val': 0.9454249945008455, 'auprc': 0.9648542373244119, 'loss_val': 0.28167265498897615, 'psi': 0.9531966916302721}-{'f1_val': 0.9395422314458797, 'auprc': 0.9310854686252844, 'loss_val': 0.29595058850764455, 'psi': 0.9361595263176415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=53 head_norm_before_train=1.782651 cos_to_last_merge=0.9648 (last merge round=23)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9914206431972847, 'loss_val': 0.04360663000401685, 'psi': 0.9941042515501175}-{'f1_val': 0.9958933237853395, 'auprc': 0.9943442012792079, 'loss_val': 0.04447257283517472, 'psi': 0.9952736747828868}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.949796 (no previous merge yet)
[S6] round=53 local utility u=0.136890 metrics={'f1_val': 0.7523875864398198, 'auprc': 0.9529739372468748, 'loss_val': 0.6640773342946276, 'psi': 0.8326221267626418}-{'f1_val': 0.7425022743242249, 'auprc': 0.8771892785378865, 'loss_val': 0.6511907899635936, 'psi': 0.7963770760096895}
[S7] START round=53 head_norm_before_train=1.430397 cos_to_last_merge=0.9672 (last merge round=22)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5374438522648257, 'auprc': 0.7844048583478996, 'loss_val': 0.8785541774368366, 'psi': 0.6362282546980553}-{'f1_val': 0.67351595148766, 'auprc': 0.8504287750138886, 'loss_val': 0.396125558199059, 'psi': 0.7442810808981515}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=2.110338 (no previous merge yet)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.9988602747477255, 'loss_val': 0.036778116792165826, 'psi': 0.9926409284975379}-{'f1_val': 0.9930017911527874, 'auprc': 0.9989140556842762, 'loss_val': 0.02945354817110118, 'psi': 0.9953666969653829}
[S9] START round=53 head_norm_before_train=1.879419 cos_to_last_merge=0.7378 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.738
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9967331650080189, 'loss_val': 0.018563044277424164, 'psi': 0.9966895730915424}-{'f1_val': 0.9966605118138915, 'auprc': 0.9991177528739705, 'loss_val': 0.01907471981030777, 'psi': 0.9976434082379231}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.039611 cos_to_last_merge=1.0000 (last merge round=52)
[S10] round=53 local utility u=0.005183 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9939163045280474, 'loss_val': 0.03766183982436657, 'psi': 0.9943553501448087}-{'f1_val': 0.9951704237150173, 'auprc': 0.9934695203222812, 'loss_val': 0.049821083642272876, 'psi': 0.9944900623579228}
[S11] START round=53 head_norm_before_train=1.582505 cos_to_last_merge=0.9264 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.998308634843266, 'loss_val': 0.02425226670770248, 'psi': 0.9971089047075277}-{'f1_val': 0.9967224195815153, 'auprc': 0.9980871330745161, 'loss_val': 0.02381047907505888, 'psi': 0.9972683049787157}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.455287 cos_to_last_merge=0.9080 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=53 local utility u=0.055804 metrics={'f1_val': 0.5994739095691317, 'auprc': 0.714899742054727, 'loss_val': 0.8364851442772597, 'psi': 0.6456442425633697}-{'f1_val': 0.5896470002748013, 'auprc': 0.7075803597537846, 'loss_val': 0.8671738075259711, 'psi': 0.6368203440663947}
[S14] START round=53 head_norm_before_train=2.038383 cos_to_last_merge=1.0000 (last merge round=51)
[S14] round=53 local utility u=0.000849 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9985966316391671, 'loss_val': 0.020033777953795604, 'psi': 0.9981171588116036}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988050755342961, 'loss_val': 0.01988981775201597, 'psi': 0.9979537872024673}
[S15] START round=53 head_norm_before_train=1.627387 cos_to_last_merge=0.9500 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9137759332629245, 'loss_val': 0.5138315897004321, 'psi': 0.7860605596069439}-{'f1_val': 0.9967466683875206, 'auprc': 0.992450175580532, 'loss_val': 0.028282984508861946, 'psi': 0.9950280712647251}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=2.132237 (no previous merge yet)
[S16] round=53 local utility u=0.226958 metrics={'f1_val': 0.9446399775125834, 'auprc': 0.9936506545659016, 'loss_val': 0.17187799886390315, 'psi': 0.9642442483339106}-{'f1_val': 0.9229106316677831, 'auprc': 0.9870489192830298, 'loss_val': 0.47561300954193503, 'psi': 0.9485659467138818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=53 head_norm_before_train=2.039099 (no previous merge yet)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.597381825784193, 'auprc': 0.8783873295999595, 'loss_val': 0.8881621720893541, 'psi': 0.7097840273104996}-{'f1_val': 0.5910018301818944, 'auprc': 0.89946495733859, 'loss_val': 0.8333483784190547, 'psi': 0.7143870810445727}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:63207
[S13] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1797) from S6
[S13] cosine check vs S6: cos=-0.1331
[S13] DROPPED delta from S6 (cos=-0.1331 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S13
[S6] cosine check vs S13: cos=-0.1331
[S6] DROPPED delta from S13 (cos=-0.1331 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0099
[S8] DROPPED delta from S2 (cos=-0.0099 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=53 metric=0.9946 head_norm=2.049784
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.176419e-02
[S10] stored merged vector for next round verification (round=53)
[S10] DEBUG after merge:  round=53 metric=0.9946 head_norm=2.048993 delta_norm=0.011764
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=53 metric=0.9978 head_norm=2.048270
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.354430e-02
[S14] stored merged vector for next round verification (round=53)
[S14] DEBUG after merge:  round=53 metric=0.9978 head_norm=2.048050 delta_norm=0.013544
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.843730 cos_to_last_merge=0.9432 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=54 local utility u=0.113292 metrics={'f1_val': 0.6531841573912822, 'auprc': 0.6954443353577255, 'loss_val': 1.363207128602527, 'psi': 0.6700882285778595}-{'f1_val': 0.6339990018099522, 'auprc': 0.6958679273255426, 'loss_val': 1.4759503127580036, 'psi': 0.6587465720161884}
[S3] START round=54 head_norm_before_train=1.580744 cos_to_last_merge=0.8890 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=54 local utility u=0.118718 metrics={'f1_val': 0.9371117237759903, 'auprc': 0.9988227541483443, 'loss_val': 0.14308983737295045, 'psi': 0.9617961359249318}-{'f1_val': 0.9178505152453769, 'auprc': 0.9776276241454807, 'loss_val': 0.20137336664735925, 'psi': 0.9417613588054183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=54 head_norm_before_train=1.594354 cos_to_last_merge=0.9339 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=54 local utility u=0.019262 metrics={'f1_val': 0.9493349408484371, 'auprc': 0.9636565213076322, 'loss_val': 0.2630153892461286, 'psi': 0.9550635730321151}-{'f1_val': 0.9454249945008455, 'auprc': 0.9648542373244119, 'loss_val': 0.28167265498897615, 'psi': 0.9531966916302721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=54 head_norm_before_train=1.794469 cos_to_last_merge=0.9636 (last merge round=23)
[S5] round=54 local utility u=0.005436 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9940979751644536, 'loss_val': 0.040766979516757666, 'psi': 0.9951751843369852}-{'f1_val': 0.9958933237853395, 'auprc': 0.9914206431972847, 'loss_val': 0.04360663000401685, 'psi': 0.9941042515501175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=54 head_norm_before_train=1.953938 (no previous merge yet)
[S6] round=54 local utility u=0.378996 metrics={'f1_val': 0.8343826201082993, 'auprc': 0.9659130899431496, 'loss_val': 0.43687380306755097, 'psi': 0.8869948080422394}-{'f1_val': 0.7523875864398198, 'auprc': 0.9529739372468748, 'loss_val': 0.6640773342946276, 'psi': 0.8326221267626418}
[S7] START round=54 head_norm_before_train=1.435079 cos_to_last_merge=0.9665 (last merge round=22)
[S7] round=54 local utility u=0.831817 metrics={'f1_val': 0.6845733783449259, 'auprc': 0.8693443917695096, 'loss_val': 0.35251554053033246, 'psi': 0.7584817837147595}-{'f1_val': 0.5374438522648257, 'auprc': 0.7844048583478996, 'loss_val': 0.8785541774368366, 'psi': 0.6362282546980553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=54 head_norm_before_train=2.117068 (no previous merge yet)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9713135452177676, 'auprc': 0.998571345691404, 'loss_val': 0.06681266341134465, 'psi': 0.9822166654072222}-{'f1_val': 0.9884946976640797, 'auprc': 0.9988602747477255, 'loss_val': 0.036778116792165826, 'psi': 0.9926409284975379}
[S9] START round=54 head_norm_before_train=1.886239 cos_to_last_merge=0.7373 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.737
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946972901903008, 'loss_val': 0.01867783772028293, 'psi': 0.996140663583406}-{'f1_val': 0.9966605118138915, 'auprc': 0.9967331650080189, 'loss_val': 0.018563044277424164, 'psi': 0.9966895730915424}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.048993 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9922345518952336, 'loss_val': 0.04202034572937023, 'psi': 0.9937429862897169}-{'f1_val': 0.9946480472226495, 'auprc': 0.9939163045280474, 'loss_val': 0.03766183982436657, 'psi': 0.9943553501448087}
[S11] START round=54 head_norm_before_train=1.589387 cos_to_last_merge=0.9257 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=54 local utility u=0.001082 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986081656862343, 'loss_val': 0.0229871177341043, 'psi': 0.9972287170447149}-{'f1_val': 0.9963090846170353, 'auprc': 0.998308634843266, 'loss_val': 0.02425226670770248, 'psi': 0.9971089047075277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=54 head_norm_before_train=1.468013 cos_to_last_merge=0.9066 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.907
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5914821240832309, 'auprc': 0.7208708790650012, 'loss_val': 0.9266918529003626, 'psi': 0.643237626075939}-{'f1_val': 0.5994739095691317, 'auprc': 0.714899742054727, 'loss_val': 0.8364851442772597, 'psi': 0.6456442425633697}
[S14] START round=54 head_norm_before_train=2.048050 cos_to_last_merge=1.0000 (last merge round=53)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9986021016050386, 'loss_val': 0.020613273664856182, 'psi': 0.9978708706592193}-{'f1_val': 0.9977975102598944, 'auprc': 0.9985966316391671, 'loss_val': 0.020033777953795604, 'psi': 0.9981171588116036}
[S15] START round=54 head_norm_before_train=1.636654 cos_to_last_merge=0.9491 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=54 local utility u=0.781505 metrics={'f1_val': 0.8786707323418326, 'auprc': 0.9928961778200767, 'loss_val': 0.2547044025788375, 'psi': 0.9243609105331302}-{'f1_val': 0.7009169771696235, 'auprc': 0.9137759332629245, 'loss_val': 0.5138315897004321, 'psi': 0.7860605596069439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=54 head_norm_before_train=2.138070 (no previous merge yet)
[S16] round=54 local utility u=0.114468 metrics={'f1_val': 0.9714085299158902, 'auprc': 0.9934610613891437, 'loss_val': 0.10298468871503039, 'psi': 0.9802295425051916}-{'f1_val': 0.9446399775125834, 'auprc': 0.9936506545659016, 'loss_val': 0.17187799886390315, 'psi': 0.9642442483339106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=54 head_norm_before_train=2.045955 (no previous merge yet)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.6162041889391418, 'auprc': 0.8290604796208696, 'loss_val': 0.8619891398415619, 'psi': 0.701346705211833}-{'f1_val': 0.597381825784193, 'auprc': 0.8783873295999595, 'loss_val': 0.8881621720893541, 'psi': 0.7097840273104996}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0100
[S8] DROPPED delta from S2 (cos=-0.0100 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1321
[S13] DROPPED delta from S6 (cos=-0.1321 < 0.0)
[S2] START round=55 head_norm_before_train=1.854481 cos_to_last_merge=0.9419 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.6174927047540564, 'auprc': 0.6967476609470034, 'loss_val': 1.5179015434218663, 'psi': 0.6491946872312352}-{'f1_val': 0.6531841573912822, 'auprc': 0.6954443353577255, 'loss_val': 1.363207128602527, 'psi': 0.6700882285778595}
[S3] START round=55 head_norm_before_train=1.591694 cos_to_last_merge=0.8872 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.8930367812975524, 'auprc': 0.9939201765558797, 'loss_val': 0.203369972822486, 'psi': 0.9333901394008833}-{'f1_val': 0.9371117237759903, 'auprc': 0.9988227541483443, 'loss_val': 0.14308983737295045, 'psi': 0.9617961359249318}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.598044 cos_to_last_merge=0.9331 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9484853711738874, 'auprc': 0.9650865278064329, 'loss_val': 0.2659563374354872, 'psi': 0.9551258338269056}-{'f1_val': 0.9493349408484371, 'auprc': 0.9636565213076322, 'loss_val': 0.2630153892461286, 'psi': 0.9550635730321151}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.809821 cos_to_last_merge=0.9621 (last merge round=23)
[S5] round=55 local utility u=0.008983 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9985391652517374, 'loss_val': 0.03700370538553435, 'psi': 0.9970396012441181}-{'f1_val': 0.9958933237853395, 'auprc': 0.9940979751644536, 'loss_val': 0.040766979516757666, 'psi': 0.9951751843369852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=55 head_norm_before_train=1.957477 (no previous merge yet)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7695478193685592, 'auprc': 0.9421422952391709, 'loss_val': 0.6620308663858888, 'psi': 0.8385856097168038}-{'f1_val': 0.8343826201082993, 'auprc': 0.9659130899431496, 'loss_val': 0.43687380306755097, 'psi': 0.8869948080422394}
[S7] START round=55 head_norm_before_train=1.439505 cos_to_last_merge=0.9659 (last merge round=22)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5111461077548277, 'auprc': 0.7816642378128653, 'loss_val': 0.8950926389203636, 'psi': 0.6193533597780427}-{'f1_val': 0.6845733783449259, 'auprc': 0.8693443917695096, 'loss_val': 0.35251554053033246, 'psi': 0.7584817837147595}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=2.124624 (no previous merge yet)
[S8] round=55 local utility u=0.083309 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9989293893329405, 'loss_val': 0.029930742586778518, 'psi': 0.9952260921562517}-{'f1_val': 0.9713135452177676, 'auprc': 0.998571345691404, 'loss_val': 0.06681266341134465, 'psi': 0.9822166654072222}
[S9] START round=55 head_norm_before_train=1.893878 cos_to_last_merge=0.7366 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.737
[S9] round=55 local utility u=0.000498 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9949540894443959, 'loss_val': 0.018453051735021812, 'psi': 0.996243383285044}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946972901903008, 'loss_val': 0.01867783772028293, 'psi': 0.996140663583406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=55 head_norm_before_train=2.058218 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=55 local utility u=0.002495 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9933057443631066, 'loss_val': 0.040243139015258805, 'psi': 0.9941714632768661}-{'f1_val': 0.9947486092193725, 'auprc': 0.9922345518952336, 'loss_val': 0.04202034572937023, 'psi': 0.9937429862897169}
[S11] START round=55 head_norm_before_train=1.596665 cos_to_last_merge=0.9249 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=55 local utility u=0.003093 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987791085433441, 'loss_val': 0.0212459389307592, 'psi': 0.9976901973930838}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986081656862343, 'loss_val': 0.0229871177341043, 'psi': 0.9972287170447149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=55 head_norm_before_train=1.478888 cos_to_last_merge=0.9051 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=55 local utility u=0.038589 metrics={'f1_val': 0.5953973504147752, 'auprc': 0.7289909000806055, 'loss_val': 0.8973654851489445, 'psi': 0.6488347702811073}-{'f1_val': 0.5914821240832309, 'auprc': 0.7208708790650012, 'loss_val': 0.9266918529003626, 'psi': 0.643237626075939}
[S14] START round=55 head_norm_before_train=2.057323 cos_to_last_merge=1.0000 (last merge round=53)
[S14] round=55 local utility u=0.002263 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988027024219563, 'loss_val': 0.018163527657341524, 'psi': 0.9980985468057189}-{'f1_val': 0.9973833833620065, 'auprc': 0.9986021016050386, 'loss_val': 0.020613273664856182, 'psi': 0.9978708706592193}
[S15] START round=55 head_norm_before_train=1.644285 cos_to_last_merge=0.9485 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.7680417708498289, 'auprc': 0.9890078347570749, 'loss_val': 0.3644594440559483, 'psi': 0.8564281964127274}-{'f1_val': 0.8786707323418326, 'auprc': 0.9928961778200767, 'loss_val': 0.2547044025788375, 'psi': 0.9243609105331302}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=2.145092 (no previous merge yet)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9394119056733132, 'auprc': 0.9935453725610137, 'loss_val': 0.29479574878626, 'psi': 0.9610652924283934}-{'f1_val': 0.9714085299158902, 'auprc': 0.9934610613891437, 'loss_val': 0.10298468871503039, 'psi': 0.9802295425051916}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=2.052175 (no previous merge yet)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.5987969288325712, 'auprc': 0.7923946953489752, 'loss_val': 1.301923940596219, 'psi': 0.6762360354391328}-{'f1_val': 0.6162041889391418, 'auprc': 0.8290604796208696, 'loss_val': 0.8619891398415619, 'psi': 0.701346705211833}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.225 → S13@127.0.0.1:63213
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1809 to 1 peers)
[S2] ⇄ pheromone p=0.046 → S8@127.0.0.1:63209
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0099
[S2] DROPPED delta from S8 (cos=-0.0099 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1809) from S13
[S6] cosine check vs S13: cos=-0.1308
[S6] DROPPED delta from S13 (cos=-0.1308 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=55 metric=0.9947 head_norm=2.066102
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.940920e-03
[S10] stored merged vector for next round verification (round=55)
[S10] DEBUG after merge:  round=55 metric=0.9947 head_norm=2.065380 delta_norm=0.009941
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.037 → S14@127.0.0.1:63214
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=55 metric=0.9976 head_norm=2.064705
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.940911e-03
[S14] stored merged vector for next round verification (round=55)
[S14] DEBUG after merge:  round=55 metric=0.9976 head_norm=2.065380 delta_norm=0.009941
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.001 → S10@127.0.0.1:63211
[S8] ⇄ pheromone p=0.085 → S2@127.0.0.1:63202
[S13] ⇄ pheromone p=0.059 → S6@127.0.0.1:63207
[S2] START round=56 head_norm_before_train=1.864486 cos_to_last_merge=0.9408 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=56 local utility u=0.011459 metrics={'f1_val': 0.6291662584537746, 'auprc': 0.6830060374135566, 'loss_val': 1.5237991031265004, 'psi': 0.6507021700376874}-{'f1_val': 0.6174927047540564, 'auprc': 0.6967476609470034, 'loss_val': 1.5179015434218663, 'psi': 0.6491946872312352}
[S3] START round=56 head_norm_before_train=1.603036 cos_to_last_merge=0.8855 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.8597207723681584, 'auprc': 0.9880096121867572, 'loss_val': 0.25635061104609536, 'psi': 0.9110363082955979}-{'f1_val': 0.8930367812975524, 'auprc': 0.9939201765558797, 'loss_val': 0.203369972822486, 'psi': 0.9333901394008833}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.601255 cos_to_last_merge=0.9324 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9475455840162312, 'auprc': 0.9615840929268344, 'loss_val': 0.27288738610914753, 'psi': 0.9531609875804725}-{'f1_val': 0.9484853711738874, 'auprc': 0.9650865278064329, 'loss_val': 0.2659563374354872, 'psi': 0.9551258338269056}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.824545 cos_to_last_merge=0.9606 (last merge round=23)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9945004957254434, 'loss_val': 0.0376756145262935, 'psi': 0.995248707893851}-{'f1_val': 0.9960398919057053, 'auprc': 0.9985391652517374, 'loss_val': 0.03700370538553435, 'psi': 0.9970396012441181}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.962812 (no previous merge yet)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.6705285406568637, 'auprc': 0.9234013676515979, 'loss_val': 0.7684467771870264, 'psi': 0.7716776714547573}-{'f1_val': 0.7695478193685592, 'auprc': 0.9421422952391709, 'loss_val': 0.6620308663858888, 'psi': 0.8385856097168038}
[S7] START round=56 head_norm_before_train=1.443075 cos_to_last_merge=0.9653 (last merge round=22)
[S7] round=56 local utility u=1.000000 metrics={'f1_val': 0.7256122834339889, 'auprc': 0.9877160915648783, 'loss_val': 0.2423126241985264, 'psi': 0.8304538066863447}-{'f1_val': 0.5111461077548277, 'auprc': 0.7816642378128653, 'loss_val': 0.8950926389203636, 'psi': 0.6193533597780427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=56 head_norm_before_train=2.128031 (no previous merge yet)
[S8] round=56 local utility u=0.001206 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.999112252398177, 'loss_val': 0.029535492809267583, 'psi': 0.9954459756509433}-{'f1_val': 0.9927572273717925, 'auprc': 0.9989293893329405, 'loss_val': 0.029930742586778518, 'psi': 0.9952260921562517}
[S9] START round=56 head_norm_before_train=1.902003 cos_to_last_merge=0.7360 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.736
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9988572243492402, 'loss_val': 0.024483888490313858, 'psi': 0.9958060411822727}-{'f1_val': 0.9971029125121428, 'auprc': 0.9949540894443959, 'loss_val': 0.018453051735021812, 'psi': 0.996243383285044}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.065380 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=56 local utility u=0.006521 metrics={'f1_val': 0.9945046060794613, 'auprc': 0.9959457722991728, 'loss_val': 0.03365747137513567, 'psi': 0.995081072567346}-{'f1_val': 0.9947486092193725, 'auprc': 0.9933057443631066, 'loss_val': 0.040243139015258805, 'psi': 0.9941714632768661}
[S11] START round=56 head_norm_before_train=1.604434 cos_to_last_merge=0.9240 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986478359890645, 'loss_val': 0.021877213195473623, 'psi': 0.997492586144535}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987791085433441, 'loss_val': 0.0212459389307592, 'psi': 0.9976901973930838}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.489855 cos_to_last_merge=0.9038 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=56 local utility u=0.125000 metrics={'f1_val': 0.6302464273653078, 'auprc': 0.7256836529278843, 'loss_val': 0.846538340119085, 'psi': 0.6684213175903384}-{'f1_val': 0.5953973504147752, 'auprc': 0.7289909000806055, 'loss_val': 0.8973654851489445, 'psi': 0.6488347702811073}
[S14] START round=56 head_norm_before_train=2.065380 cos_to_last_merge=1.0000 (last merge round=55)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9992200274689185, 'loss_val': 0.019025275062382715, 'psi': 0.9980341480449908}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988027024219563, 'loss_val': 0.018163527657341524, 'psi': 0.9980985468057189}
[S15] START round=56 head_norm_before_train=1.650942 cos_to_last_merge=0.9479 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=56 local utility u=0.859131 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9918228065204284, 'loss_val': 0.026872209134821842, 'psi': 0.9947771236406837}-{'f1_val': 0.7680417708498289, 'auprc': 0.9890078347570749, 'loss_val': 0.3644594440559483, 'psi': 0.8564281964127274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=56 head_norm_before_train=2.152634 (no previous merge yet)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8997725013255564, 'auprc': 0.9903079466464568, 'loss_val': 0.5726376673306063, 'psi': 0.9359866794539167}-{'f1_val': 0.9394119056733132, 'auprc': 0.9935453725610137, 'loss_val': 0.29479574878626, 'psi': 0.9610652924283934}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=2.056557 (no previous merge yet)
[S17] round=56 local utility u=0.366720 metrics={'f1_val': 0.6305368827807873, 'auprc': 0.892634690460684, 'loss_val': 1.059644296980528, 'psi': 0.7353760058527461}-{'f1_val': 0.5987969288325712, 'auprc': 0.7923946953489752, 'loss_val': 1.301923940596219, 'psi': 0.6762360354391328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:63207
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0098
[S2] DROPPED delta from S8 (cos=-0.0098 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S13
[S6] cosine check vs S13: cos=-0.1303
[S6] DROPPED delta from S13 (cos=-0.1303 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0098
[S8] DROPPED delta from S2 (cos=-0.0098 < 0.0)
[S2] START round=57 head_norm_before_train=1.873529 cos_to_last_merge=0.9399 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=57 local utility u=0.065770 metrics={'f1_val': 0.6474831827579531, 'auprc': 0.6820906296039763, 'loss_val': 1.4994149694397323, 'psi': 0.6613261614963624}-{'f1_val': 0.6291662584537746, 'auprc': 0.6830060374135566, 'loss_val': 1.5237991031265004, 'psi': 0.6507021700376874}
[S3] START round=57 head_norm_before_train=1.614061 cos_to_last_merge=0.8839 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=57 local utility u=0.462173 metrics={'f1_val': 0.977745945818427, 'auprc': 0.9991456960142764, 'loss_val': 0.07356480855114331, 'psi': 0.9863058458967667}-{'f1_val': 0.8597207723681584, 'auprc': 0.9880096121867572, 'loss_val': 0.25635061104609536, 'psi': 0.9110363082955979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=57 head_norm_before_train=1.608219 cos_to_last_merge=0.9317 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9482673020439516, 'auprc': 0.9627959026438662, 'loss_val': 0.28159282392579876, 'psi': 0.9540787422839174}-{'f1_val': 0.9475455840162312, 'auprc': 0.9615840929268344, 'loss_val': 0.27288738610914753, 'psi': 0.9531609875804725}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.835605 cos_to_last_merge=0.9594 (last merge round=23)
[S5] round=57 local utility u=0.001739 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9952392685355318, 'loss_val': 0.03728800189282376, 'psi': 0.9956317016854164}-{'f1_val': 0.9957475160061228, 'auprc': 0.9945004957254434, 'loss_val': 0.0376756145262935, 'psi': 0.995248707893851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=57 head_norm_before_train=1.967997 (no previous merge yet)
[S6] round=57 local utility u=0.818134 metrics={'f1_val': 0.8667217284232702, 'auprc': 0.9582019347115833, 'loss_val': 0.41373889729441804, 'psi': 0.9033138109385954}-{'f1_val': 0.6705285406568637, 'auprc': 0.9234013676515979, 'loss_val': 0.7684467771870264, 'psi': 0.7716776714547573}
[S7] START round=57 head_norm_before_train=1.447052 cos_to_last_merge=0.9646 (last merge round=22)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.4703026483124348, 'auprc': 0.7796283791831571, 'loss_val': 0.9052970583953225, 'psi': 0.5940329406607237}-{'f1_val': 0.7256122834339889, 'auprc': 0.9877160915648783, 'loss_val': 0.2423126241985264, 'psi': 0.8304538066863447}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=2.131773 (no previous merge yet)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.999125616496846, 'loss_val': 0.030357704988496496, 'psi': 0.9954513212904108}-{'f1_val': 0.9930017911527874, 'auprc': 0.999112252398177, 'loss_val': 0.029535492809267583, 'psi': 0.9954459756509433}
[S9] START round=57 head_norm_before_train=1.910375 cos_to_last_merge=0.7353 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.735
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9989436497014648, 'loss_val': 0.03031972186665945, 'psi': 0.9943300588047305}-{'f1_val': 0.9937719190709611, 'auprc': 0.9988572243492402, 'loss_val': 0.024483888490313858, 'psi': 0.9958060411822727}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.074190 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=57 local utility u=0.000734 metrics={'f1_val': 0.9945046060794613, 'auprc': 0.9962001063981443, 'loss_val': 0.03295301456563126, 'psi': 0.9951828062069346}-{'f1_val': 0.9945046060794613, 'auprc': 0.9959457722991728, 'loss_val': 0.03365747137513567, 'psi': 0.995081072567346}
[S11] START round=57 head_norm_before_train=1.612939 cos_to_last_merge=0.9230 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9981002004212727, 'loss_val': 0.022353337316405, 'psi': 0.9972735319174183}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986478359890645, 'loss_val': 0.021877213195473623, 'psi': 0.997492586144535}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.497702 cos_to_last_merge=0.9031 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=57 local utility u=0.001379 metrics={'f1_val': 0.614935027369574, 'auprc': 0.7417826504071328, 'loss_val': 0.8002090821641188, 'psi': 0.6656740765845974}-{'f1_val': 0.6302464273653078, 'auprc': 0.7256836529278843, 'loss_val': 0.846538340119085, 'psi': 0.6684213175903384}
[S14] START round=57 head_norm_before_train=2.073308 cos_to_last_merge=1.0000 (last merge round=55)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9983175581694284, 'loss_val': 0.020554218581053055, 'psi': 0.997527451196318}-{'f1_val': 0.9972435617623723, 'auprc': 0.9992200274689185, 'loss_val': 0.019025275062382715, 'psi': 0.9980341480449908}
[S15] START round=57 head_norm_before_train=1.658744 cos_to_last_merge=0.9471 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7554374286631393, 'auprc': 0.9712924512059924, 'loss_val': 0.4197368597927158, 'psi': 0.8417794376802805}-{'f1_val': 0.9967466683875206, 'auprc': 0.9918228065204284, 'loss_val': 0.026872209134821842, 'psi': 0.9947771236406837}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.158814 (no previous merge yet)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.8633117678459816, 'auprc': 0.9885630931461543, 'loss_val': 0.858330163371726, 'psi': 0.9134122979660506}-{'f1_val': 0.8997725013255564, 'auprc': 0.9903079466464568, 'loss_val': 0.5726376673306063, 'psi': 0.9359866794539167}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=2.061575 (no previous merge yet)
[S17] round=57 local utility u=0.166342 metrics={'f1_val': 0.6392107058594999, 'auprc': 0.9603822227460067, 'loss_val': 0.9822460367017538, 'psi': 0.7676793126141026}-{'f1_val': 0.6305368827807873, 'auprc': 0.892634690460684, 'loss_val': 1.059644296980528, 'psi': 0.7353760058527461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:63207
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=57 metric=0.9970 head_norm=2.079940
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.004991e-02
[S14] stored merged vector for next round verification (round=57)
[S14] DEBUG after merge:  round=57 metric=0.9970 head_norm=2.077043 delta_norm=0.010050
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1806) from S13
[S6] cosine check vs S13: cos=-0.1301
[S6] DROPPED delta from S13 (cos=-0.1301 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0098
[S8] DROPPED delta from S2 (cos=-0.0098 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1301
[S13] DROPPED delta from S6 (cos=-0.1301 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=1.0000
[S2] START round=58 head_norm_before_train=1.884494 cos_to_last_merge=0.9387 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.6321087189211304, 'auprc': 0.6911290606111647, 'loss_val': 1.5093355270621907, 'psi': 0.6557168555971442}-{'f1_val': 0.6474831827579531, 'auprc': 0.6820906296039763, 'loss_val': 1.4994149694397323, 'psi': 0.6613261614963624}
[S3] START round=58 head_norm_before_train=1.623324 cos_to_last_merge=0.8826 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.883
[S3] round=58 local utility u=0.064820 metrics={'f1_val': 0.9923851879828639, 'auprc': 0.999602800803117, 'loss_val': 0.03313146328544741, 'psi': 0.9952722331109651}-{'f1_val': 0.977745945818427, 'auprc': 0.9991456960142764, 'loss_val': 0.07356480855114331, 'psi': 0.9863058458967667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=58 head_norm_before_train=1.617507 cos_to_last_merge=0.9305 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=58 local utility u=0.034035 metrics={'f1_val': 0.9536717053268962, 'auprc': 0.9747595226115495, 'loss_val': 0.28183990173476897, 'psi': 0.9621068322407575}-{'f1_val': 0.9482673020439516, 'auprc': 0.9627959026438662, 'loss_val': 0.28159282392579876, 'psi': 0.9540787422839174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=58 head_norm_before_train=1.842072 cos_to_last_merge=0.9586 (last merge round=23)
[S5] round=58 local utility u=0.005228 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9984200449381053, 'loss_val': 0.036375253193148695, 'psi': 0.9969040122464458}-{'f1_val': 0.9958933237853395, 'auprc': 0.9952392685355318, 'loss_val': 0.03728800189282376, 'psi': 0.9956317016854164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=58 head_norm_before_train=1.974775 (no previous merge yet)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7226140370237774, 'auprc': 0.9456403467715084, 'loss_val': 0.7135460825322661, 'psi': 0.8118245609228698}-{'f1_val': 0.8667217284232702, 'auprc': 0.9582019347115833, 'loss_val': 0.41373889729441804, 'psi': 0.9033138109385954}
[S7] START round=58 head_norm_before_train=1.450410 cos_to_last_merge=0.9639 (last merge round=22)
[S7] round=58 local utility u=0.903357 metrics={'f1_val': 0.6729563529732865, 'auprc': 0.8212861520064845, 'loss_val': 0.43947875597764996, 'psi': 0.7322882725865657}-{'f1_val': 0.4703026483124348, 'auprc': 0.7796283791831571, 'loss_val': 0.9052970583953225, 'psi': 0.5940329406607237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=58 head_norm_before_train=2.135825 (no previous merge yet)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9989229390977243, 'loss_val': 0.03137704447292471, 'psi': 0.9952235120621653}-{'f1_val': 0.9930017911527874, 'auprc': 0.999125616496846, 'loss_val': 0.030357704988496496, 'psi': 0.9954513212904108}
[S9] START round=58 head_norm_before_train=1.917374 cos_to_last_merge=0.7348 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.735
[S9] round=58 local utility u=0.014343 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993797451843096, 'loss_val': 0.0188236637099528, 'psi': 0.9955344754960957}-{'f1_val': 0.991254331540241, 'auprc': 0.9989436497014648, 'loss_val': 0.03031972186665945, 'psi': 0.9943300588047305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=58 head_norm_before_train=2.083341 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9957148495789347, 'loss_val': 0.034551024491990386, 'psi': 0.9950034039106105}-{'f1_val': 0.9945046060794613, 'auprc': 0.9962001063981443, 'loss_val': 0.03295301456563126, 'psi': 0.9951828062069346}
[S11] START round=58 head_norm_before_train=1.621511 cos_to_last_merge=0.9221 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9973401727707402, 'loss_val': 0.023459329986221494, 'psi': 0.9967215198785173}-{'f1_val': 0.9967224195815153, 'auprc': 0.9981002004212727, 'loss_val': 0.022353337316405, 'psi': 0.9972735319174183}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.503564 cos_to_last_merge=0.9025 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.902
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.5891699855895016, 'auprc': 0.7527779907870751, 'loss_val': 0.990406785850268, 'psi': 0.654613187668531}-{'f1_val': 0.614935027369574, 'auprc': 0.7417826504071328, 'loss_val': 0.8002090821641188, 'psi': 0.6656740765845974}
[S14] START round=58 head_norm_before_train=2.077043 cos_to_last_merge=1.0000 (last merge round=57)
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9982742609604136, 'loss_val': 0.0207255171069196, 'psi': 0.9973512251944188}-{'f1_val': 0.9970007132142444, 'auprc': 0.9983175581694284, 'loss_val': 0.020554218581053055, 'psi': 0.997527451196318}
[S15] START round=58 head_norm_before_train=1.667183 cos_to_last_merge=0.9464 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=58 local utility u=0.049851 metrics={'f1_val': 0.7762393855453872, 'auprc': 0.9578089161911265, 'loss_val': 0.40439543750991913, 'psi': 0.8488671978036829}-{'f1_val': 0.7554374286631393, 'auprc': 0.9712924512059924, 'loss_val': 0.4197368597927158, 'psi': 0.8417794376802805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=58 head_norm_before_train=2.160547 (no previous merge yet)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8329942014723747, 'auprc': 0.8352967916081594, 'loss_val': 1.4092877632988707, 'psi': 0.8339152375266885}-{'f1_val': 0.8633117678459816, 'auprc': 0.9885630931461543, 'loss_val': 0.858330163371726, 'psi': 0.9134122979660506}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=2.068783 (no previous merge yet)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6321358208754191, 'auprc': 0.9662342423841088, 'loss_val': 1.0113999717874118, 'psi': 0.765775189478895}-{'f1_val': 0.6392107058594999, 'auprc': 0.9603822227460067, 'loss_val': 0.9822460367017538, 'psi': 0.7676793126141026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=58 metric=0.9967 head_norm=2.085492
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.056810e-02
[S14] stored merged vector for next round verification (round=58)
[S14] DEBUG after merge:  round=58 metric=0.9967 head_norm=2.084390 delta_norm=0.010568
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.893892 cos_to_last_merge=0.9380 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6343448913266816, 'auprc': 0.7022727263741059, 'loss_val': 1.603150381551488, 'psi': 0.6615160253456513}-{'f1_val': 0.6321087189211304, 'auprc': 0.6911290606111647, 'loss_val': 1.5093355270621907, 'psi': 0.6557168555971442}
[S3] START round=59 head_norm_before_train=1.633265 cos_to_last_merge=0.8811 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.881
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.9490353385580639, 'auprc': 0.9812477470070505, 'loss_val': 0.14987637778375057, 'psi': 0.9619203019376585}-{'f1_val': 0.9923851879828639, 'auprc': 0.999602800803117, 'loss_val': 0.03313146328544741, 'psi': 0.9952722331109651}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.962 u=0.0000 p_local=0.1174 f1=0.949 auprc=0.981 bytes=70187
[S4] START round=59 head_norm_before_train=1.619648 cos_to_last_merge=0.9300 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9398617986478397, 'auprc': 0.9458311168677237, 'loss_val': 0.30671703484836577, 'psi': 0.9422495259357933}-{'f1_val': 0.9536717053268962, 'auprc': 0.9747595226115495, 'loss_val': 0.28183990173476897, 'psi': 0.9621068322407575}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.942 u=0.0000 p_local=0.0618 f1=0.940 auprc=0.946 bytes=59430
[S5] START round=59 head_norm_before_train=1.848126 cos_to_last_merge=0.9580 (last merge round=23)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9921268204147151, 'loss_val': 0.03938155128660063, 'psi': 0.9943867224370897}-{'f1_val': 0.9958933237853395, 'auprc': 0.9984200449381053, 'loss_val': 0.036375253193148695, 'psi': 0.9969040122464458}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.994 u=0.0000 p_local=0.0134 f1=0.996 auprc=0.992 bytes=75573
[S6] START round=59 head_norm_before_train=1.982781 (no previous merge yet)
[S6] round=59 local utility u=0.581883 metrics={'f1_val': 0.8496083265450398, 'auprc': 0.9514110954028541, 'loss_val': 0.32905768142044167, 'psi': 0.8903294340881656}-{'f1_val': 0.7226140370237774, 'auprc': 0.9456403467715084, 'loss_val': 0.7135460825322661, 'psi': 0.8118245609228698}
[S7] START round=59 head_norm_before_train=1.454545 cos_to_last_merge=0.9633 (last merge round=22)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.628950179212308, 'auprc': 0.7901568076196883, 'loss_val': 0.636059145699077, 'psi': 0.6934328305752602}-{'f1_val': 0.6729563529732865, 'auprc': 0.8212861520064845, 'loss_val': 0.43947875597764996, 'psi': 0.7322882725865657}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.693 u=0.0000 p_local=0.3836 f1=0.629 auprc=0.790 bytes=62918
[S8] START round=59 head_norm_before_train=2.143227 (no previous merge yet)
[S8] round=59 local utility u=0.004785 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9991518799162915, 'loss_val': 0.029082515200398416, 'psi': 0.9959740213349033}-{'f1_val': 0.9927572273717925, 'auprc': 0.9989229390977243, 'loss_val': 0.03137704447292471, 'psi': 0.9952235120621653}
[S9] START round=59 head_norm_before_train=1.918965 cos_to_last_merge=0.7345 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.735
[S9] round=59 local utility u=0.003632 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962085077548558, 'loss_val': 0.018600735713840445, 'psi': 0.9964797101902771}-{'f1_val': 0.9966924912647621, 'auprc': 0.993797451843096, 'loss_val': 0.0188236637099528, 'psi': 0.9955344754960957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=60 psi=0.996 u=0.0036 p_local=0.0037 f1=0.997 auprc=0.996 bytes=66482
[S10] START round=59 head_norm_before_train=2.092387 cos_to_last_merge=0.9999 (last merge round=55)
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994327638701096, 'loss_val': 0.036355091892744724, 'psi': 0.9945802210120619}-{'f1_val': 0.9945291067983943, 'auprc': 0.9957148495789347, 'loss_val': 0.034551024491990386, 'psi': 0.9950034039106105}
[S11] START round=59 head_norm_before_train=1.628982 cos_to_last_merge=0.9212 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=59 local utility u=0.001244 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9978508482562429, 'loss_val': 0.02250379744956478, 'psi': 0.9969257900727184}-{'f1_val': 0.9963090846170353, 'auprc': 0.9973401727707402, 'loss_val': 0.023459329986221494, 'psi': 0.9967215198785173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] r=60 psi=0.997 u=0.0012 p_local=0.0180 f1=0.996 auprc=0.998 bytes=73656
[S13] START round=59 head_norm_before_train=1.509273 cos_to_last_merge=0.9020 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.902
[S13] round=59 local utility u=0.166105 metrics={'f1_val': 0.6133080717674584, 'auprc': 0.7549141752610153, 'loss_val': 0.8094333428333647, 'psi': 0.6699505131648812}-{'f1_val': 0.5891699855895016, 'auprc': 0.7527779907870751, 'loss_val': 0.990406785850268, 'psi': 0.654613187668531}
[S14] START round=59 head_norm_before_train=2.084390 cos_to_last_merge=1.0000 (last merge round=58)
[S14] round=59 local utility u=0.001924 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986684633124963, 'loss_val': 0.01949796694605181, 'psi': 0.9976526853752643}-{'f1_val': 0.9967358680170888, 'auprc': 0.9982742609604136, 'loss_val': 0.0207255171069196, 'psi': 0.9973512251944188}
[S15] START round=59 head_norm_before_train=1.677115 cos_to_last_merge=0.9455 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=59 local utility u=0.905455 metrics={'f1_val': 0.9958642312648849, 'auprc': 0.9971489986408233, 'loss_val': 0.02925420478020405, 'psi': 0.9963781382152602}-{'f1_val': 0.7762393855453872, 'auprc': 0.9578089161911265, 'loss_val': 0.40439543750991913, 'psi': 0.8488671978036829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=60 psi=0.996 u=0.9055 p_local=0.3935 f1=0.996 auprc=0.997 bytes=57472
[S16] START round=59 head_norm_before_train=2.162493 (no previous merge yet)
[S16] round=59 local utility u=0.629420 metrics={'f1_val': 0.8710401606445459, 'auprc': 0.9743424714745306, 'loss_val': 0.7958606509874495, 'psi': 0.9123610849765398}-{'f1_val': 0.8329942014723747, 'auprc': 0.8352967916081594, 'loss_val': 1.4092877632988707, 'psi': 0.8339152375266885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=60 psi=0.912 u=0.6294 p_local=0.1745 f1=0.871 auprc=0.974 bytes=55736
[S17] START round=59 head_norm_before_train=2.079882 (no previous merge yet)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6426272224492393, 'auprc': 0.8652266475751349, 'loss_val': 1.139197056611533, 'psi': 0.7316669924995975}-{'f1_val': 0.6321358208754191, 'auprc': 0.9662342423841088, 'loss_val': 1.0113999717874118, 'psi': 0.765775189478895}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.732 u=0.0000 p_local=0.0953 f1=0.643 auprc=0.865 bytes=53993
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:63202
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0157 f1=0.995 auprc=0.994 bytes=62985
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S2] r=60 psi=0.662 u=0.0000 p_local=0.0285 f1=0.634 auprc=0.702 bytes=52128
[S2] RECEIVED delta(kind=head bytes=1792) from S8
[S2] cosine check vs S8: cos=-0.0093
[S2] DROPPED delta from S8 (cos=-0.0093 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1293
[S6] DROPPED delta from S13 (cos=-0.1293 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] cosine check vs S6: cos=-0.1293
[S13] DROPPED delta from S6 (cos=-0.1293 < 0.0)
[S8] r=60 psi=0.996 u=0.0048 p_local=0.0357 f1=0.994 auprc=0.999 bytes=59364
[S13] r=60 psi=0.670 u=0.1661 p_local=0.0703 f1=0.613 auprc=0.755 bytes=66536
[S14] r=60 psi=0.998 u=0.0019 p_local=0.0009 f1=0.997 auprc=0.999 bytes=73786
[S6] r=60 psi=0.890 u=0.5819 p_local=0.3133 f1=0.850 auprc=0.951 bytes=57606
[S2] START round=60 head_norm_before_train=1.902131 cos_to_last_merge=0.9372 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.6233188613449234, 'auprc': 0.6984168649752514, 'loss_val': 1.6074995468579947, 'psi': 0.6533580627970546}-{'f1_val': 0.6343448913266816, 'auprc': 0.7022727263741059, 'loss_val': 1.603150381551488, 'psi': 0.6615160253456513}
[S3] START round=60 head_norm_before_train=1.643110 cos_to_last_merge=0.8798 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.880
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9414599441445283, 'auprc': 0.9910768784949233, 'loss_val': 0.1433850816130144, 'psi': 0.9613067178846862}-{'f1_val': 0.9490353385580639, 'auprc': 0.9812477470070505, 'loss_val': 0.14987637778375057, 'psi': 0.9619203019376585}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.622474 cos_to_last_merge=0.9296 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=60 local utility u=0.041130 metrics={'f1_val': 0.9442358619617686, 'auprc': 0.9621274439748806, 'loss_val': 0.2995893998245102, 'psi': 0.9513924947670134}-{'f1_val': 0.9398617986478397, 'auprc': 0.9458311168677237, 'loss_val': 0.30671703484836577, 'psi': 0.9422495259357933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=60 head_norm_before_train=1.849300 cos_to_last_merge=0.9579 (last merge round=23)
[S5] round=60 local utility u=0.011580 metrics={'f1_val': 0.9962614844848281, 'auprc': 0.9979396934479169, 'loss_val': 0.03586904103612367, 'psi': 0.9969327680700637}-{'f1_val': 0.9958933237853395, 'auprc': 0.9921268204147151, 'loss_val': 0.03938155128660063, 'psi': 0.9943867224370897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=60 head_norm_before_train=1.991252 (no previous merge yet)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.7692692822094209, 'auprc': 0.9377673239605324, 'loss_val': 0.7427783531609623, 'psi': 0.8366684989098655}-{'f1_val': 0.8496083265450398, 'auprc': 0.9514110954028541, 'loss_val': 0.32905768142044167, 'psi': 0.8903294340881656}
[S7] START round=60 head_norm_before_train=1.458648 cos_to_last_merge=0.9627 (last merge round=22)
[S7] round=60 local utility u=0.468009 metrics={'f1_val': 0.6915652088806292, 'auprc': 0.871633281703889, 'loss_val': 0.3201611653812582, 'psi': 0.7635924380099331}-{'f1_val': 0.628950179212308, 'auprc': 0.7901568076196883, 'loss_val': 0.636059145699077, 'psi': 0.6934328305752602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=60 head_norm_before_train=2.151176 (no previous merge yet)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9979774127265575, 'loss_val': 0.02959723981505993, 'psi': 0.995650973304702}-{'f1_val': 0.9938554489473111, 'auprc': 0.9991518799162915, 'loss_val': 0.029082515200398416, 'psi': 0.9959740213349033}
[S9] START round=60 head_norm_before_train=1.919936 cos_to_last_merge=0.7344 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.734
[S9] round=60 local utility u=0.000612 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.996752833213718, 'loss_val': 0.01900953016187185, 'psi': 0.996697440373822}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962085077548558, 'loss_val': 0.018600735713840445, 'psi': 0.9964797101902771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=60 head_norm_before_train=2.101259 cos_to_last_merge=0.9999 (last merge round=55)
[S10] round=60 local utility u=0.001464 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9956574145680392, 'loss_val': 0.03346611230111267, 'psi': 0.994717161125384}-{'f1_val': 0.9947486092193725, 'auprc': 0.994327638701096, 'loss_val': 0.036355091892744724, 'psi': 0.9945802210120619}
[S11] START round=60 head_norm_before_train=1.636249 cos_to_last_merge=0.9204 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=60 local utility u=0.004191 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9985870373071332, 'loss_val': 0.020261751331647343, 'psi': 0.9976133688985995}-{'f1_val': 0.9963090846170353, 'auprc': 0.9978508482562429, 'loss_val': 0.02250379744956478, 'psi': 0.9969257900727184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=60 head_norm_before_train=1.514118 cos_to_last_merge=0.9013 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6263222442194457, 'auprc': 0.7346494109948855, 'loss_val': 0.8826497896441259, 'psi': 0.6696531109296215}-{'f1_val': 0.6133080717674584, 'auprc': 0.7549141752610153, 'loss_val': 0.8094333428333647, 'psi': 0.6699505131648812}
[S14] START round=60 head_norm_before_train=2.092846 cos_to_last_merge=1.0000 (last merge round=58)
[S14] round=60 local utility u=0.001202 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9988412648346717, 'loss_val': 0.019068619390781465, 'psi': 0.997867514832322}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986684633124963, 'loss_val': 0.01949796694605181, 'psi': 0.9976526853752643}
[S15] START round=60 head_norm_before_train=1.687896 cos_to_last_merge=0.9445 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8116405392631847, 'auprc': 0.989285705682857, 'loss_val': 0.25567065343397316, 'psi': 0.8826986058310535}-{'f1_val': 0.9958642312648849, 'auprc': 0.9971489986408233, 'loss_val': 0.02925420478020405, 'psi': 0.9963781382152602}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.167381 (no previous merge yet)
[S16] round=60 local utility u=0.746593 metrics={'f1_val': 0.988019549747397, 'auprc': 0.9927744589462094, 'loss_val': 0.05984771682334921, 'psi': 0.989921513426922}-{'f1_val': 0.8710401606445459, 'auprc': 0.9743424714745306, 'loss_val': 0.7958606509874495, 'psi': 0.9123610849765398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=60 head_norm_before_train=2.086943 (no previous merge yet)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6631174762596301, 'auprc': 0.8153467972132022, 'loss_val': 1.2183719611140205, 'psi': 0.7240092046410589}-{'f1_val': 0.6426272224492393, 'auprc': 0.8652266475751349, 'loss_val': 1.139197056611533, 'psi': 0.7316669924995975}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] ⇄ pheromone p=0.029 → S2@127.0.0.1:63202
[S2] ⇄ pheromone p=0.023 → S8@127.0.0.1:63209
[S6] ⇄ pheromone p=0.251 → S13@127.0.0.1:63213
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] ⇄ pheromone p=0.056 → S6@127.0.0.1:63207
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=60 metric=0.9972 head_norm=2.101405
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.848094e-02
[S14] stored merged vector for next round verification (round=60)
[S14] DEBUG after merge:  round=60 metric=0.9972 head_norm=2.105626 delta_norm=0.018481
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.001 → S10@127.0.0.1:63211
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=60 metric=0.9941 head_norm=2.110000
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.817169e-02
[S10] stored merged vector for next round verification (round=60)
[S10] DEBUG after merge:  round=60 metric=0.9941 head_norm=2.103492 delta_norm=0.018172
[S10] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.013 → S14@127.0.0.1:63214
[S2] START round=61 head_norm_before_train=1.908743 cos_to_last_merge=0.9367 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=61 local utility u=0.070995 metrics={'f1_val': 0.6442027413702079, 'auprc': 0.6801462731737529, 'loss_val': 1.5360008915924548, 'psi': 0.6585801540916258}-{'f1_val': 0.6233188613449234, 'auprc': 0.6984168649752514, 'loss_val': 1.6074995468579947, 'psi': 0.6533580627970546}
[S3] START round=61 head_norm_before_train=1.652354 cos_to_last_merge=0.8784 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.878
[S3] round=61 local utility u=0.240441 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9995497397119524, 'loss_val': 0.023552014043081642, 'psi': 0.9982588373524154}-{'f1_val': 0.9414599441445283, 'auprc': 0.9910768784949233, 'loss_val': 0.1433850816130144, 'psi': 0.9613067178846862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=61 head_norm_before_train=1.625644 cos_to_last_merge=0.9292 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9409417671266509, 'auprc': 0.9365026973684742, 'loss_val': 0.30725218107437496, 'psi': 0.9391661392233802}-{'f1_val': 0.9442358619617686, 'auprc': 0.9621274439748806, 'loss_val': 0.2995893998245102, 'psi': 0.9513924947670134}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.851815 cos_to_last_merge=0.9576 (last merge round=23)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9920754300878265, 'loss_val': 0.03760182298476025, 'psi': 0.9942786816388043}-{'f1_val': 0.9962614844848281, 'auprc': 0.9979396934479169, 'loss_val': 0.03586904103612367, 'psi': 0.9969327680700637}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.997780 (no previous merge yet)
[S6] round=61 local utility u=0.246743 metrics={'f1_val': 0.8144099304546412, 'auprc': 0.9495249355296699, 'loss_val': 0.5554084227629826, 'psi': 0.8684559324846526}-{'f1_val': 0.7692692822094209, 'auprc': 0.9377673239605324, 'loss_val': 0.7427783531609623, 'psi': 0.8366684989098655}
[S7] START round=61 head_norm_before_train=1.465607 cos_to_last_merge=0.9614 (last merge round=22)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5612617029551882, 'auprc': 0.7817318270929687, 'loss_val': 0.8060906501165715, 'psi': 0.6494497526103005}-{'f1_val': 0.6915652088806292, 'auprc': 0.871633281703889, 'loss_val': 0.3201611653812582, 'psi': 0.7635924380099331}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=2.159304 (no previous merge yet)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9936700521263312, 'auprc': 0.9989210425080477, 'loss_val': 0.0316329658140972, 'psi': 0.9957704482790178}-{'f1_val': 0.9941000136901317, 'auprc': 0.9979774127265575, 'loss_val': 0.02959723981505993, 'psi': 0.995650973304702}
[S9] START round=61 head_norm_before_train=1.924268 cos_to_last_merge=0.7339 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.734
[S9] round=61 local utility u=0.004821 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998637805213373, 'loss_val': 0.018701306263949426, 'psi': 0.9979418192968698}-{'f1_val': 0.9966605118138915, 'auprc': 0.996752833213718, 'loss_val': 0.01900953016187185, 'psi': 0.996697440373822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=61 head_norm_before_train=2.103492 cos_to_last_merge=1.0000 (last merge round=60)
[S10] round=61 local utility u=0.000893 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9964071707587794, 'loss_val': 0.03261359301210071, 'psi': 0.9948854959338387}-{'f1_val': 0.9940903254969471, 'auprc': 0.9956574145680392, 'loss_val': 0.03346611230111267, 'psi': 0.994717161125384}
[S11] START round=61 head_norm_before_train=1.643359 cos_to_last_merge=0.9196 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9972303262621764, 'loss_val': 0.022036668500000096, 'psi': 0.9969255822537798}-{'f1_val': 0.9969642566262439, 'auprc': 0.9985870373071332, 'loss_val': 0.020261751331647343, 'psi': 0.9976133688985995}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.521372 cos_to_last_merge=0.9004 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=61 local utility u=0.035811 metrics={'f1_val': 0.6252668841993936, 'auprc': 0.7552358443981241, 'loss_val': 0.8664555945139271, 'psi': 0.6772544682788858}-{'f1_val': 0.6263222442194457, 'auprc': 0.7346494109948855, 'loss_val': 0.8826497896441259, 'psi': 0.6696531109296215}
[S14] START round=61 head_norm_before_train=2.105626 cos_to_last_merge=1.0000 (last merge round=60)
[S14] round=61 local utility u=0.001990 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.998812699013869, 'loss_val': 0.01746753637619914, 'psi': 0.9981025454424839}-{'f1_val': 0.9972183481640888, 'auprc': 0.9988412648346717, 'loss_val': 0.019068619390781465, 'psi': 0.997867514832322}
[S15] START round=61 head_norm_before_train=1.697886 cos_to_last_merge=0.9435 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=61 local utility u=0.624519 metrics={'f1_val': 0.9819355251412296, 'auprc': 0.9962741696154089, 'loss_val': 0.04936740448589342, 'psi': 0.9876709829309014}-{'f1_val': 0.8116405392631847, 'auprc': 0.989285705682857, 'loss_val': 0.25567065343397316, 'psi': 0.8826986058310535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=61 head_norm_before_train=2.173310 (no previous merge yet)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9348009793050722, 'auprc': 0.9828846387460057, 'loss_val': 0.43968232302527166, 'psi': 0.9540344430814456}-{'f1_val': 0.988019549747397, 'auprc': 0.9927744589462094, 'loss_val': 0.05984771682334921, 'psi': 0.989921513426922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=2.091904 (no previous merge yet)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.6295650092887443, 'auprc': 0.8269814698393848, 'loss_val': 1.3002729517852158, 'psi': 0.7085315935090004}-{'f1_val': 0.6631174762596301, 'auprc': 0.8153467972132022, 'loss_val': 1.2183719611140205, 'psi': 0.7240092046410589}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S6
[S13] cosine check vs S6: cos=-0.1279
[S13] DROPPED delta from S6 (cos=-0.1279 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1279
[S6] DROPPED delta from S13 (cos=-0.1279 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0081
[S8] DROPPED delta from S2 (cos=-0.0081 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=61 metric=0.9939 head_norm=2.111984
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.873326e-03
[S10] stored merged vector for next round verification (round=61)
[S10] DEBUG after merge:  round=61 metric=0.9939 head_norm=2.111873 delta_norm=0.005873
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=61 metric=0.9976 head_norm=2.111778
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.873327e-03
[S14] stored merged vector for next round verification (round=61)
[S14] DEBUG after merge:  round=61 metric=0.9976 head_norm=2.111873 delta_norm=0.005873
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.915826 cos_to_last_merge=0.9360 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.62430650665597, 'auprc': 0.6764268143120544, 'loss_val': 1.6481553145385954, 'psi': 0.6451546297184038}-{'f1_val': 0.6442027413702079, 'auprc': 0.6801462731737529, 'loss_val': 1.5360008915924548, 'psi': 0.6585801540916258}
[S3] START round=62 head_norm_before_train=1.662019 cos_to_last_merge=0.8770 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.877
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.901388085147427, 'auprc': 0.9711084257005657, 'loss_val': 0.23227948820941174, 'psi': 0.9292762213686825}-{'f1_val': 0.9973982357793907, 'auprc': 0.9995497397119524, 'loss_val': 0.023552014043081642, 'psi': 0.9982588373524154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.629039 cos_to_last_merge=0.9285 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9413528115524286, 'auprc': 0.9268590500253426, 'loss_val': 0.3060708285536852, 'psi': 0.9355553069415942}-{'f1_val': 0.9409417671266509, 'auprc': 0.9365026973684742, 'loss_val': 0.30725218107437496, 'psi': 0.9391661392233802}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.855498 cos_to_last_merge=0.9572 (last merge round=23)
[S5] round=62 local utility u=0.004853 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.99486085789863, 'loss_val': 0.03712750395829045, 'psi': 0.9954803374306557}-{'f1_val': 0.9957475160061228, 'auprc': 0.9920754300878265, 'loss_val': 0.03760182298476025, 'psi': 0.9942786816388043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=62 head_norm_before_train=2.003517 (no previous merge yet)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.7507577414971305, 'auprc': 0.9282502679206168, 'loss_val': 0.6581211701771474, 'psi': 0.8217547520665249}-{'f1_val': 0.8144099304546412, 'auprc': 0.9495249355296699, 'loss_val': 0.5554084227629826, 'psi': 0.8684559324846526}
[S7] START round=62 head_norm_before_train=1.471041 cos_to_last_merge=0.9603 (last merge round=22)
[S7] round=62 local utility u=0.463335 metrics={'f1_val': 0.6541104547642296, 'auprc': 0.8044981501080218, 'loss_val': 0.5048130397256053, 'psi': 0.7142655329017464}-{'f1_val': 0.5612617029551882, 'auprc': 0.7817318270929687, 'loss_val': 0.8060906501165715, 'psi': 0.6494497526103005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=62 head_norm_before_train=2.162276 (no previous merge yet)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9850518562300145, 'auprc': 0.9981544342912776, 'loss_val': 0.05159204254852388, 'psi': 0.9902928874545197}-{'f1_val': 0.9936700521263312, 'auprc': 0.9989210425080477, 'loss_val': 0.0316329658140972, 'psi': 0.9957704482790178}
[S9] START round=62 head_norm_before_train=1.928548 cos_to_last_merge=0.7338 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.734
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991659166656788, 'loss_val': 0.017596259239387586, 'psi': 0.9974289841045152}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998637805213373, 'loss_val': 0.018701306263949426, 'psi': 0.9979418192968698}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.111873 cos_to_last_merge=1.0000 (last merge round=61)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.8690323809154586, 'auprc': 0.992779628004021, 'loss_val': 0.3129874981113957, 'psi': 0.9185312797508836}-{'f1_val': 0.993871046050545, 'auprc': 0.9964071707587794, 'loss_val': 0.03261359301210071, 'psi': 0.9948854959338387}
[S11] START round=62 head_norm_before_train=1.649994 cos_to_last_merge=0.9189 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.919
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9200121860121891, 'auprc': 0.9328364614500029, 'loss_val': 0.3493435381353396, 'psi': 0.9251418961873146}-{'f1_val': 0.9967224195815153, 'auprc': 0.9972303262621764, 'loss_val': 0.022036668500000096, 'psi': 0.9969255822537798}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.526840 cos_to_last_merge=0.8996 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5923368559680029, 'auprc': 0.7647674510610966, 'loss_val': 1.1557418659742937, 'psi': 0.6613090940052404}-{'f1_val': 0.6252668841993936, 'auprc': 0.7552358443981241, 'loss_val': 0.8664555945139271, 'psi': 0.6772544682788858}
[S14] START round=62 head_norm_before_train=2.111873 cos_to_last_merge=1.0000 (last merge round=61)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9423113125118692, 'auprc': 0.998440725936206, 'loss_val': 0.09634123959805622, 'psi': 0.9647630778816039}-{'f1_val': 0.9976291097282272, 'auprc': 0.998812699013869, 'loss_val': 0.01746753637619914, 'psi': 0.9981025454424839}
[S15] START round=62 head_norm_before_train=1.706605 cos_to_last_merge=0.9428 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.9859787316496257, 'auprc': 0.9861151141627942, 'loss_val': 0.07630019456180964, 'psi': 0.9860332846548931}-{'f1_val': 0.9819355251412296, 'auprc': 0.9962741696154089, 'loss_val': 0.04936740448589342, 'psi': 0.9876709829309014}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=2.176662 (no previous merge yet)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9245064140850968, 'auprc': 0.9751175422652228, 'loss_val': 0.5005509261088023, 'psi': 0.9447508653571473}-{'f1_val': 0.9348009793050722, 'auprc': 0.9828846387460057, 'loss_val': 0.43968232302527166, 'psi': 0.9540344430814456}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.096051 (no previous merge yet)
[S17] round=62 local utility u=0.771925 metrics={'f1_val': 0.7032955615956336, 'auprc': 0.9744955134869515, 'loss_val': 0.6413483372081022, 'psi': 0.8117755423521607}-{'f1_val': 0.6295650092887443, 'auprc': 0.8269814698393848, 'loss_val': 1.3002729517852158, 'psi': 0.7085315935090004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.923964 cos_to_last_merge=0.9352 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.6075190182093874, 'auprc': 0.6816640879114092, 'loss_val': 1.8644744052156716, 'psi': 0.6371770460901961}-{'f1_val': 0.62430650665597, 'auprc': 0.6764268143120544, 'loss_val': 1.6481553145385954, 'psi': 0.6451546297184038}
[S3] START round=63 head_norm_before_train=1.670171 cos_to_last_merge=0.8757 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.876
[S3] round=63 local utility u=0.031324 metrics={'f1_val': 0.8916764415451792, 'auprc': 0.9984619136545594, 'loss_val': 0.1934217621105513, 'psi': 0.9343906303889313}-{'f1_val': 0.901388085147427, 'auprc': 0.9711084257005657, 'loss_val': 0.23227948820941174, 'psi': 0.9292762213686825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=63 head_norm_before_train=1.626855 cos_to_last_merge=0.9281 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=63 local utility u=0.035052 metrics={'f1_val': 0.9431923039260601, 'auprc': 0.9449439809873635, 'loss_val': 0.30125781770307536, 'psi': 0.9438929747505815}-{'f1_val': 0.9413528115524286, 'auprc': 0.9268590500253426, 'loss_val': 0.3060708285536852, 'psi': 0.9355553069415942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=63 head_norm_before_train=1.860136 cos_to_last_merge=0.9565 (last merge round=23)
[S5] round=63 local utility u=0.000367 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9947335005649305, 'loss_val': 0.036011382195837285, 'psi': 0.9954293944971758}-{'f1_val': 0.9958933237853395, 'auprc': 0.99486085789863, 'loss_val': 0.03712750395829045, 'psi': 0.9954803374306557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=63 head_norm_before_train=2.005821 (no previous merge yet)
[S6] round=63 local utility u=0.093249 metrics={'f1_val': 0.7676780430617549, 'auprc': 0.9412110450841716, 'loss_val': 0.6120266941313226, 'psi': 0.8370912438707216}-{'f1_val': 0.7507577414971305, 'auprc': 0.9282502679206168, 'loss_val': 0.6581211701771474, 'psi': 0.8217547520665249}
[S7] START round=63 head_norm_before_train=1.476560 cos_to_last_merge=0.9595 (last merge round=22)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6127040839767068, 'auprc': 0.7925538936322531, 'loss_val': 0.6456537224557969, 'psi': 0.6846440078389253}-{'f1_val': 0.6541104547642296, 'auprc': 0.8044981501080218, 'loss_val': 0.5048130397256053, 'psi': 0.7142655329017464}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=2.163881 (no previous merge yet)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9805040990903584, 'auprc': 0.9956784687147967, 'loss_val': 0.05419136174908864, 'psi': 0.9865738469401337}-{'f1_val': 0.9850518562300145, 'auprc': 0.9981544342912776, 'loss_val': 0.05159204254852388, 'psi': 0.9902928874545197}
[S9] START round=63 head_norm_before_train=1.934685 cos_to_last_merge=0.7334 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.733
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995998267770162, 'loss_val': 0.017409451077667094, 'psi': 0.9966610546153505}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991659166656788, 'loss_val': 0.017596259239387586, 'psi': 0.9974289841045152}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.117476 cos_to_last_merge=1.0000 (last merge round=61)
[S10] round=63 local utility u=0.066060 metrics={'f1_val': 0.8830854586357109, 'auprc': 0.9941721335776891, 'loss_val': 0.26936394548795056, 'psi': 0.9275201286125021}-{'f1_val': 0.8690323809154586, 'auprc': 0.992779628004021, 'loss_val': 0.3129874981113957, 'psi': 0.9185312797508836}
[S11] START round=63 head_norm_before_train=1.654761 cos_to_last_merge=0.9184 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=63 local utility u=0.491544 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9977693270747907, 'loss_val': 0.021316049828606933, 'psi': 0.9971411825788254}-{'f1_val': 0.9200121860121891, 'auprc': 0.9328364614500029, 'loss_val': 0.3493435381353396, 'psi': 0.9251418961873146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=63 head_norm_before_train=1.531689 cos_to_last_merge=0.8992 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=63 local utility u=0.304347 metrics={'f1_val': 0.6416756145662527, 'auprc': 0.7657878596292371, 'loss_val': 0.8461424851015074, 'psi': 0.6913205125914466}-{'f1_val': 0.5923368559680029, 'auprc': 0.7647674510610966, 'loss_val': 1.1557418659742937, 'psi': 0.6613090940052404}
[S14] START round=63 head_norm_before_train=2.115748 cos_to_last_merge=1.0000 (last merge round=61)
[S14] round=63 local utility u=0.206140 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990925216307691, 'loss_val': 0.016598282925269093, 'psi': 0.998081970353343}-{'f1_val': 0.9423113125118692, 'auprc': 0.998440725936206, 'loss_val': 0.09634123959805622, 'psi': 0.9647630778816039}
[S15] START round=63 head_norm_before_train=1.713056 cos_to_last_merge=0.9424 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.8023553890081857, 'auprc': 0.9523558920491932, 'loss_val': 0.43547957624857486, 'psi': 0.8623555902245887}-{'f1_val': 0.9859787316496257, 'auprc': 0.9861151141627942, 'loss_val': 0.07630019456180964, 'psi': 0.9860332846548931}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=2.177180 (no previous merge yet)
[S16] round=63 local utility u=0.140894 metrics={'f1_val': 0.9402291688660154, 'auprc': 0.9843899965541102, 'loss_val': 0.34091718312521885, 'psi': 0.9578934999412533}-{'f1_val': 0.9245064140850968, 'auprc': 0.9751175422652228, 'loss_val': 0.5005509261088023, 'psi': 0.9447508653571473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=63 head_norm_before_train=2.103724 (no previous merge yet)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.6235340474514541, 'auprc': 0.8924034168438458, 'loss_val': 1.0866857131958576, 'psi': 0.7310817952084108}-{'f1_val': 0.7032955615956336, 'auprc': 0.9744955134869515, 'loss_val': 0.6413483372081022, 'psi': 0.8117755423521607}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1268
[S6] DROPPED delta from S13 (cos=-0.1268 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S6
[S13] cosine check vs S6: cos=-0.1268
[S13] DROPPED delta from S6 (cos=-0.1268 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=63 metric=0.9974 head_norm=2.119083
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.462333e-02
[S14] stored merged vector for next round verification (round=63)
[S14] DEBUG after merge:  round=63 metric=0.9974 head_norm=2.119700 delta_norm=0.014623
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=63 metric=0.8831 head_norm=2.120419
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.462332e-02
[S10] stored merged vector for next round verification (round=63)
[S10] DEBUG after merge:  round=63 metric=0.8819 head_norm=2.119700 delta_norm=0.014623
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.934069 cos_to_last_merge=0.9341 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.934
[S2] round=64 local utility u=0.093731 metrics={'f1_val': 0.6185499343997568, 'auprc': 0.6731824406893295, 'loss_val': 1.717753912391828, 'psi': 0.6404029369155859}-{'f1_val': 0.6075190182093874, 'auprc': 0.6816640879114092, 'loss_val': 1.8644744052156716, 'psi': 0.6371770460901961}
[S3] START round=64 head_norm_before_train=1.677484 cos_to_last_merge=0.8747 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.875
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.8096913905631162, 'auprc': 0.9914938419806953, 'loss_val': 0.34805661541170596, 'psi': 0.8824123711301479}-{'f1_val': 0.8916764415451792, 'auprc': 0.9984619136545594, 'loss_val': 0.1934217621105513, 'psi': 0.9343906303889313}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=1.629446 cos_to_last_merge=0.9279 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9414644222104088, 'auprc': 0.9412267968919164, 'loss_val': 0.30556434715878045, 'psi': 0.9413693720830119}-{'f1_val': 0.9431923039260601, 'auprc': 0.9449439809873635, 'loss_val': 0.30125781770307536, 'psi': 0.9438929747505815}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.866174 cos_to_last_merge=0.9553 (last merge round=23)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9928866575591375, 'loss_val': 0.03560251773211339, 'psi': 0.9946906572948586}-{'f1_val': 0.9958933237853395, 'auprc': 0.9947335005649305, 'loss_val': 0.036011382195837285, 'psi': 0.9954293944971758}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=2.011537 (no previous merge yet)
[S6] round=64 local utility u=0.196570 metrics={'f1_val': 0.8153030378102315, 'auprc': 0.951395829603967, 'loss_val': 0.5351905379996134, 'psi': 0.8697401545277257}-{'f1_val': 0.7676780430617549, 'auprc': 0.9412110450841716, 'loss_val': 0.6120266941313226, 'psi': 0.8370912438707216}
[S7] START round=64 head_norm_before_train=1.482967 cos_to_last_merge=0.9585 (last merge round=22)
[S7] round=64 local utility u=0.192715 metrics={'f1_val': 0.6516330068810788, 'auprc': 0.8040274555788361, 'loss_val': 0.5282188277016443, 'psi': 0.7125907863601818}-{'f1_val': 0.6127040839767068, 'auprc': 0.7925538936322531, 'loss_val': 0.6456537224557969, 'psi': 0.6846440078389253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=64 head_norm_before_train=2.170780 (no previous merge yet)
[S8] round=64 local utility u=0.051857 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9991259132846668, 'loss_val': 0.03250461677614988, 'psi': 0.9951212975852081}-{'f1_val': 0.9805040990903584, 'auprc': 0.9956784687147967, 'loss_val': 0.05419136174908864, 'psi': 0.9865738469401337}
[S9] START round=64 head_norm_before_train=1.941857 cos_to_last_merge=0.7329 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.733
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9994741337915045, 'loss_val': 0.02701601616122759, 'psi': 0.9943920561888151}-{'f1_val': 0.9971029125121428, 'auprc': 0.995998267770162, 'loss_val': 0.017409451077667094, 'psi': 0.9966610546153505}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.119700 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.8696436337468809, 'auprc': 0.9936353300637201, 'loss_val': 0.3218890818896444, 'psi': 0.9192403122736166}-{'f1_val': 0.8830854586357109, 'auprc': 0.9941721335776891, 'loss_val': 0.26936394548795056, 'psi': 0.9275201286125021}
[S11] START round=64 head_norm_before_train=1.659014 cos_to_last_merge=0.9179 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9667306389728358, 'auprc': 0.9965193096242905, 'loss_val': 0.12230485562548621, 'psi': 0.9786461072334177}-{'f1_val': 0.9967224195815153, 'auprc': 0.9977693270747907, 'loss_val': 0.021316049828606933, 'psi': 0.9971411825788254}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.534613 cos_to_last_merge=0.8988 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6012556656229254, 'auprc': 0.7610967581916865, 'loss_val': 1.039388625393474, 'psi': 0.6651921026504299}-{'f1_val': 0.6416756145662527, 'auprc': 0.7657878596292371, 'loss_val': 0.8461424851015074, 'psi': 0.6913205125914466}
[S14] START round=64 head_norm_before_train=2.119700 cos_to_last_merge=1.0000 (last merge round=63)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990450908071199, 'loss_val': 0.017481788445469326, 'psi': 0.9980646328835449}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990925216307691, 'loss_val': 0.016598282925269093, 'psi': 0.998081970353343}
[S15] START round=64 head_norm_before_train=1.719844 cos_to_last_merge=0.9419 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=64 local utility u=0.161112 metrics={'f1_val': 0.8191603075347953, 'auprc': 0.9921907346138724, 'loss_val': 0.33359030350406327, 'psi': 0.8883724783664262}-{'f1_val': 0.8023553890081857, 'auprc': 0.9523558920491932, 'loss_val': 0.43547957624857486, 'psi': 0.8623555902245887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=64 head_norm_before_train=2.180645 (no previous merge yet)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9311517388093552, 'auprc': 0.9833252387908523, 'loss_val': 0.4773673242887216, 'psi': 0.9520211388019542}-{'f1_val': 0.9402291688660154, 'auprc': 0.9843899965541102, 'loss_val': 0.34091718312521885, 'psi': 0.9578934999412533}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=2.111037 (no previous merge yet)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6103739133269068, 'auprc': 0.861424206527261, 'loss_val': 1.3025235553270653, 'psi': 0.7107940306070485}-{'f1_val': 0.6235340474514541, 'auprc': 0.8924034168438458, 'loss_val': 1.0866857131958576, 'psi': 0.7310817952084108}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63209
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0080
[S8] DROPPED delta from S2 (cos=-0.0080 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.1267
[S13] DROPPED delta from S6 (cos=-0.1267 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=-0.0080
[S2] DROPPED delta from S8 (cos=-0.0080 < 0.0)
[S2] START round=65 head_norm_before_train=1.944792 cos_to_last_merge=0.9331 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=65 local utility u=0.051361 metrics={'f1_val': 0.6291349640356317, 'auprc': 0.6719790345291208, 'loss_val': 1.6749310950104386, 'psi': 0.6462725922330274}-{'f1_val': 0.6185499343997568, 'auprc': 0.6731824406893295, 'loss_val': 1.717753912391828, 'psi': 0.6404029369155859}
[S3] START round=65 head_norm_before_train=1.684610 cos_to_last_merge=0.8737 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.874
[S3] round=65 local utility u=0.531468 metrics={'f1_val': 0.9586507017895287, 'auprc': 0.9808900580552014, 'loss_val': 0.1470651044810947, 'psi': 0.9675464442957977}-{'f1_val': 0.8096913905631162, 'auprc': 0.9914938419806953, 'loss_val': 0.34805661541170596, 'psi': 0.8824123711301479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=65 head_norm_before_train=1.635462 cos_to_last_merge=0.9272 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=65 local utility u=0.023718 metrics={'f1_val': 0.9440348548954167, 'auprc': 0.9511425176228254, 'loss_val': 0.3032979220984056, 'psi': 0.9468779199863803}-{'f1_val': 0.9414644222104088, 'auprc': 0.9412267968919164, 'loss_val': 0.30556434715878045, 'psi': 0.9413693720830119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=65 head_norm_before_train=1.871603 cos_to_last_merge=0.9543 (last merge round=23)
[S5] round=65 local utility u=0.009162 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9983890485576892, 'loss_val': 0.03378542694054468, 'psi': 0.9968916136942794}-{'f1_val': 0.9958933237853395, 'auprc': 0.9928866575591375, 'loss_val': 0.03560251773211339, 'psi': 0.9946906572948586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=65 head_norm_before_train=2.019941 (no previous merge yet)
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.594371706711569, 'auprc': 0.7028496788288453, 'loss_val': 1.197608319686694, 'psi': 0.6377628955584795}-{'f1_val': 0.8153030378102315, 'auprc': 0.951395829603967, 'loss_val': 0.5351905379996134, 'psi': 0.8697401545277257}
[S7] START round=65 head_norm_before_train=1.493398 cos_to_last_merge=0.9570 (last merge round=22)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5780149481490902, 'auprc': 0.7852141262461692, 'loss_val': 0.7785808004473951, 'psi': 0.6608946193879217}-{'f1_val': 0.6516330068810788, 'auprc': 0.8040274555788361, 'loss_val': 0.5282188277016443, 'psi': 0.7125907863601818}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=2.176316 (no previous merge yet)
[S8] round=65 local utility u=0.000308 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9991316489951632, 'loss_val': 0.03083161765572666, 'psi': 0.9950161035139784}-{'f1_val': 0.9924515537855688, 'auprc': 0.9991259132846668, 'loss_val': 0.03250461677614988, 'psi': 0.9951212975852081}
[S9] START round=65 head_norm_before_train=1.948729 cos_to_last_merge=0.7324 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.732
[S9] round=65 local utility u=0.016982 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9971409447950506, 'loss_val': 0.0161530243989177, 'psi': 0.9964687991043326}-{'f1_val': 0.9910040044536889, 'auprc': 0.9994741337915045, 'loss_val': 0.02701601616122759, 'psi': 0.9943920561888151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=65 head_norm_before_train=2.124869 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=65 local utility u=0.475417 metrics={'f1_val': 0.9838187000952766, 'auprc': 0.9962707688270965, 'loss_val': 0.06401082432856149, 'psi': 0.9887995275880046}-{'f1_val': 0.8696436337468809, 'auprc': 0.9936353300637201, 'loss_val': 0.3218890818896444, 'psi': 0.9192403122736166}
[S11] START round=65 head_norm_before_train=1.663550 cos_to_last_merge=0.9174 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=65 local utility u=0.144006 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986350304522149, 'loss_val': 0.020590588728516344, 'psi': 0.9974874639297953}-{'f1_val': 0.9667306389728358, 'auprc': 0.9965193096242905, 'loss_val': 0.12230485562548621, 'psi': 0.9786461072334177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=65 head_norm_before_train=1.538163 cos_to_last_merge=0.8985 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=65 local utility u=0.091787 metrics={'f1_val': 0.6283338351201053, 'auprc': 0.7514365937434434, 'loss_val': 0.9893027989260329, 'psi': 0.6775749385694405}-{'f1_val': 0.6012556656229254, 'auprc': 0.7610967581916865, 'loss_val': 1.039388625393474, 'psi': 0.6651921026504299}
[S14] START round=65 head_norm_before_train=2.121886 cos_to_last_merge=1.0000 (last merge round=63)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989994802409542, 'loss_val': 0.021706528649283623, 'psi': 0.9980463886570785}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990450908071199, 'loss_val': 0.017481788445469326, 'psi': 0.9980646328835449}
[S15] START round=65 head_norm_before_train=1.726666 cos_to_last_merge=0.9414 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=65 local utility u=0.270157 metrics={'f1_val': 0.8824339855113507, 'auprc': 0.9907134457116362, 'loss_val': 0.16848724217042746, 'psi': 0.9257457695914648}-{'f1_val': 0.8191603075347953, 'auprc': 0.9921907346138724, 'loss_val': 0.33359030350406327, 'psi': 0.8883724783664262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=65 head_norm_before_train=2.186110 (no previous merge yet)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8599249072233854, 'auprc': 0.8857039198907595, 'loss_val': 0.9998916571758337, 'psi': 0.870236512290335}-{'f1_val': 0.9311517388093552, 'auprc': 0.9833252387908523, 'loss_val': 0.4773673242887216, 'psi': 0.9520211388019542}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=2.112929 (no previous merge yet)
[S17] round=65 local utility u=0.888231 metrics={'f1_val': 0.7896097361062973, 'auprc': 0.8994895077212055, 'loss_val': 0.7156715431452595, 'psi': 0.8335616447522606}-{'f1_val': 0.6103739133269068, 'auprc': 0.861424206527261, 'loss_val': 1.3025235553270653, 'psi': 0.7107940306070485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:63214
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] ⇄ pheromone p=0.146 → S13@127.0.0.1:63213
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] ⇄ pheromone p=0.027 → S10@127.0.0.1:63211
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] cosine check vs S13: cos=-0.1266
[S6] DROPPED delta from S13 (cos=-0.1266 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0079
[S8] DROPPED delta from S2 (cos=-0.0079 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0079
[S2] DROPPED delta from S8 (cos=-0.0079 < 0.0)
[S8] ⇄ pheromone p=0.018 → S2@127.0.0.1:63202
[S2] ⇄ pheromone p=0.039 → S8@127.0.0.1:63209
[S13] ⇄ pheromone p=0.079 → S6@127.0.0.1:63207
[S10] ⇄ pheromone p=0.108 → S14@127.0.0.1:63214
[S2] START round=66 head_norm_before_train=1.954887 cos_to_last_merge=0.9320 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=66 local utility u=0.298087 metrics={'f1_val': 0.6634886627496921, 'auprc': 0.7166906783729472, 'loss_val': 1.419013288962693, 'psi': 0.6847694689989942}-{'f1_val': 0.6291349640356317, 'auprc': 0.6719790345291208, 'loss_val': 1.6749310950104386, 'psi': 0.6462725922330274}
[S3] START round=66 head_norm_before_train=1.691677 cos_to_last_merge=0.8727 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.873
[S3] round=66 local utility u=0.050927 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9973045831751102, 'loss_val': 0.10924265935503721, 'psi': 0.9755909876107356}-{'f1_val': 0.9586507017895287, 'auprc': 0.9808900580552014, 'loss_val': 0.1470651044810947, 'psi': 0.9675464442957977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=66 head_norm_before_train=1.643056 cos_to_last_merge=0.9262 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9411126657775764, 'auprc': 0.9324956410840887, 'loss_val': 0.3148197501686244, 'psi': 0.9376658559001813}-{'f1_val': 0.9440348548954167, 'auprc': 0.9511425176228254, 'loss_val': 0.3032979220984056, 'psi': 0.9468779199863803}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.879422 cos_to_last_merge=0.9533 (last merge round=23)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9952656907088682, 'loss_val': 0.03361805167721997, 'psi': 0.995642270554751}-{'f1_val': 0.9958933237853395, 'auprc': 0.9983890485576892, 'loss_val': 0.03378542694054468, 'psi': 0.9968916136942794}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=2.025781 (no previous merge yet)
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.9555959237081498, 'auprc': 0.9620654834670306, 'loss_val': 0.21450679302747142, 'psi': 0.9581837476117021}-{'f1_val': 0.594371706711569, 'auprc': 0.7028496788288453, 'loss_val': 1.197608319686694, 'psi': 0.6377628955584795}
[S7] START round=66 head_norm_before_train=1.500620 cos_to_last_merge=0.9560 (last merge round=22)
[S7] round=66 local utility u=0.266851 metrics={'f1_val': 0.6304584827325681, 'auprc': 0.7997420862639631, 'loss_val': 0.6031236919939214, 'psi': 0.6981719241451261}-{'f1_val': 0.5780149481490902, 'auprc': 0.7852141262461692, 'loss_val': 0.7785808004473951, 'psi': 0.6608946193879217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=66 head_norm_before_train=2.182752 (no previous merge yet)
[S8] round=66 local utility u=0.005834 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9990277695693746, 'loss_val': 0.028349978249918834, 'psi': 0.9959243771961366}-{'f1_val': 0.9922724065265219, 'auprc': 0.9991316489951632, 'loss_val': 0.03083161765572666, 'psi': 0.9950161035139784}
[S9] START round=66 head_norm_before_train=1.955209 cos_to_last_merge=0.7320 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.732
[S9] round=66 local utility u=0.001273 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9970545923500036, 'loss_val': 0.015856745985468577, 'psi': 0.9966851296667731}-{'f1_val': 0.9960207019771873, 'auprc': 0.9971409447950506, 'loss_val': 0.0161530243989177, 'psi': 0.9964687991043326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=66 head_norm_before_train=2.131536 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9361633964699486, 'auprc': 0.9926903710724786, 'loss_val': 0.1544358896797115, 'psi': 0.9587741863109607}-{'f1_val': 0.9838187000952766, 'auprc': 0.9962707688270965, 'loss_val': 0.06401082432856149, 'psi': 0.9887995275880046}
[S11] START round=66 head_norm_before_train=1.668612 cos_to_last_merge=0.9169 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9972575995422005, 'loss_val': 0.021943005623132564, 'psi': 0.9966884905871014}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986350304522149, 'loss_val': 0.020590588728516344, 'psi': 0.9974874639297953}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.542870 cos_to_last_merge=0.8979 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=66 local utility u=0.099575 metrics={'f1_val': 0.6404864201205808, 'auprc': 0.7069536990215433, 'loss_val': 0.7296202206565604, 'psi': 0.6670733316809658}-{'f1_val': 0.6283338351201053, 'auprc': 0.7514365937434434, 'loss_val': 0.9893027989260329, 'psi': 0.6775749385694405}
[S14] START round=66 head_norm_before_train=2.126428 cos_to_last_merge=1.0000 (last merge round=63)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990054662174295, 'loss_val': 0.01939213095347357, 'psi': 0.9978026144155185}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989994802409542, 'loss_val': 0.021706528649283623, 'psi': 0.9980463886570785}
[S15] START round=66 head_norm_before_train=1.734830 cos_to_last_merge=0.9407 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=66 local utility u=0.022956 metrics={'f1_val': 0.8891839530774377, 'auprc': 0.9904211078670926, 'loss_val': 0.16219892906757866, 'psi': 0.9296788149932996}-{'f1_val': 0.8824339855113507, 'auprc': 0.9907134457116362, 'loss_val': 0.16848724217042746, 'psi': 0.9257457695914648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=66 head_norm_before_train=2.191322 (no previous merge yet)
[S16] round=66 local utility u=1.000000 metrics={'f1_val': 0.9925808634255231, 'auprc': 0.9930141474231663, 'loss_val': 0.04195611084554949, 'psi': 0.9927541770245804}-{'f1_val': 0.8599249072233854, 'auprc': 0.8857039198907595, 'loss_val': 0.9998916571758337, 'psi': 0.870236512290335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=66 head_norm_before_train=2.115272 (no previous merge yet)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6382612041709259, 'auprc': 0.82172592457888, 'loss_val': 1.3727894766973392, 'psi': 0.7116470923341076}-{'f1_val': 0.7896097361062973, 'auprc': 0.8994895077212055, 'loss_val': 0.7156715431452595, 'psi': 0.8335616447522606}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=66 metric=0.9970 head_norm=2.132416
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.446860e-02
[S14] stored merged vector for next round verification (round=66)
[S14] DEBUG after merge:  round=66 metric=0.9970 head_norm=2.131927 delta_norm=0.014469
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1263
[S13] DROPPED delta from S6 (cos=-0.1263 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0082
[S8] DROPPED delta from S2 (cos=-0.0082 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=-0.0082
[S2] DROPPED delta from S8 (cos=-0.0082 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1263
[S6] DROPPED delta from S13 (cos=-0.1263 < 0.0)
[S2] START round=67 head_norm_before_train=1.962764 cos_to_last_merge=0.9311 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=67 local utility u=0.240658 metrics={'f1_val': 0.7080952152318726, 'auprc': 0.7233610133469855, 'loss_val': 1.225348151206984, 'psi': 0.7142015344779178}-{'f1_val': 0.6634886627496921, 'auprc': 0.7166906783729472, 'loss_val': 1.419013288962693, 'psi': 0.6847694689989942}
[S3] START round=67 head_norm_before_train=1.698581 cos_to_last_merge=0.8717 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.872
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.940657795550915, 'auprc': 0.9911074873301311, 'loss_val': 0.14386876436518098, 'psi': 0.9608376722626014}-{'f1_val': 0.9611152572344858, 'auprc': 0.9973045831751102, 'loss_val': 0.10924265935503721, 'psi': 0.9755909876107356}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.651289 cos_to_last_merge=0.9251 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=67 local utility u=0.015928 metrics={'f1_val': 0.9415413845779973, 'auprc': 0.9412262635560111, 'loss_val': 0.31172752510605356, 'psi': 0.9414153361692028}-{'f1_val': 0.9411126657775764, 'auprc': 0.9324956410840887, 'loss_val': 0.3148197501686244, 'psi': 0.9376658559001813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=67 head_norm_before_train=1.889542 cos_to_last_merge=0.9523 (last merge round=23)
[S5] round=67 local utility u=0.005626 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9983984199184681, 'loss_val': 0.031763487886057894, 'psi': 0.9968953622385909}-{'f1_val': 0.9958933237853395, 'auprc': 0.9952656907088682, 'loss_val': 0.03361805167721997, 'psi': 0.995642270554751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=67 head_norm_before_train=2.030140 (no previous merge yet)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7328886016494125, 'auprc': 0.9337627020446522, 'loss_val': 0.7654742064607648, 'psi': 0.8132382418075084}-{'f1_val': 0.9555959237081498, 'auprc': 0.9620654834670306, 'loss_val': 0.21450679302747142, 'psi': 0.9581837476117021}
[S7] START round=67 head_norm_before_train=1.508324 cos_to_last_merge=0.9551 (last merge round=22)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.5548462882144916, 'auprc': 0.7814695426230122, 'loss_val': 0.8841791063715321, 'psi': 0.6454955899778998}-{'f1_val': 0.6304584827325681, 'auprc': 0.7997420862639631, 'loss_val': 0.6031236919939214, 'psi': 0.6981719241451261}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.187856 (no previous merge yet)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9990659030610409, 'loss_val': 0.028609241844778546, 'psi': 0.9952806976474919}-{'f1_val': 0.9938554489473111, 'auprc': 0.9990277695693746, 'loss_val': 0.028349978249918834, 'psi': 0.9959243771961366}
[S9] START round=67 head_norm_before_train=1.961313 cos_to_last_merge=0.7317 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.732
[S9] round=67 local utility u=0.001407 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968842706734447, 'loss_val': 0.016515668701839625, 'psi': 0.9970154557766635}-{'f1_val': 0.9964388212112862, 'auprc': 0.9970545923500036, 'loss_val': 0.015856745985468577, 'psi': 0.9966851296667731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=67 head_norm_before_train=2.138427 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=67 local utility u=0.237644 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9944746815246376, 'loss_val': 0.03732994244217266, 'psi': 0.9947707845289007}-{'f1_val': 0.9361633964699486, 'auprc': 0.9926903710724786, 'loss_val': 0.1544358896797115, 'psi': 0.9587741863109607}
[S11] START round=67 head_norm_before_train=1.674527 cos_to_last_merge=0.9163 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9836663783644507, 'auprc': 0.9994040047290397, 'loss_val': 0.054990816497739674, 'psi': 0.9899614289102863}-{'f1_val': 0.9963090846170353, 'auprc': 0.9972575995422005, 'loss_val': 0.021943005623132564, 'psi': 0.9966884905871014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.547408 cos_to_last_merge=0.8973 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6040100501333616, 'auprc': 0.7642570108520502, 'loss_val': 0.9603933034983728, 'psi': 0.668108834420837}-{'f1_val': 0.6404864201205808, 'auprc': 0.7069536990215433, 'loss_val': 0.7296202206565604, 'psi': 0.6670733316809658}
[S14] START round=67 head_norm_before_train=2.131927 cos_to_last_merge=1.0000 (last merge round=66)
[S14] round=67 local utility u=0.000823 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.998643480464065, 'loss_val': 0.0189905718788763, 'psi': 0.9978908673113643}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990054662174295, 'loss_val': 0.01939213095347357, 'psi': 0.9978026144155185}
[S15] START round=67 head_norm_before_train=1.743618 cos_to_last_merge=0.9399 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=67 local utility u=0.170258 metrics={'f1_val': 0.9327933604132876, 'auprc': 0.9928173024014383, 'loss_val': 0.0905275370649757, 'psi': 0.9568029372085479}-{'f1_val': 0.8891839530774377, 'auprc': 0.9904211078670926, 'loss_val': 0.16219892906757866, 'psi': 0.9296788149932996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=67 head_norm_before_train=2.194853 (no previous merge yet)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9923121867931906, 'auprc': 0.9926678356482945, 'loss_val': 0.039542880893627376, 'psi': 0.9924544463352322}-{'f1_val': 0.9925808634255231, 'auprc': 0.9930141474231663, 'loss_val': 0.04195611084554949, 'psi': 0.9927541770245804}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.120556 (no previous merge yet)
[S17] round=67 local utility u=0.204788 metrics={'f1_val': 0.6413017457498476, 'auprc': 0.8751920415077155, 'loss_val': 1.1418546066270756, 'psi': 0.7348578640529948}-{'f1_val': 0.6382612041709259, 'auprc': 0.82172592457888, 'loss_val': 1.3727894766973392, 'psi': 0.7116470923341076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0082
[S8] DROPPED delta from S2 (cos=-0.0082 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=67 metric=0.9974 head_norm=2.139808
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.282564e-02
[S14] stored merged vector for next round verification (round=67)
[S14] DEBUG after merge:  round=67 metric=0.9974 head_norm=2.142577 delta_norm=0.012826
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=67 metric=0.9950 head_norm=2.145420
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.282563e-02
[S10] stored merged vector for next round verification (round=67)
[S10] DEBUG after merge:  round=67 metric=0.9950 head_norm=2.142577 delta_norm=0.012826
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=1.969885 cos_to_last_merge=0.9304 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=68 local utility u=0.085082 metrics={'f1_val': 0.7186652023550684, 'auprc': 0.7261716438245895, 'loss_val': 1.1270356747672234, 'psi': 0.7216677789428768}-{'f1_val': 0.7080952152318726, 'auprc': 0.7233610133469855, 'loss_val': 1.225348151206984, 'psi': 0.7142015344779178}
[S3] START round=68 head_norm_before_train=1.705846 cos_to_last_merge=0.8706 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.871
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9275338747488857, 'auprc': 0.9721674447734902, 'loss_val': 0.20464868866715746, 'psi': 0.9453873027587275}-{'f1_val': 0.940657795550915, 'auprc': 0.9911074873301311, 'loss_val': 0.14386876436518098, 'psi': 0.9608376722626014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.659059 cos_to_last_merge=0.9239 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9399976370208236, 'auprc': 0.927388285156616, 'loss_val': 0.3203927417950731, 'psi': 0.9349538962751405}-{'f1_val': 0.9415413845779973, 'auprc': 0.9412262635560111, 'loss_val': 0.31172752510605356, 'psi': 0.9414153361692028}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.901685 cos_to_last_merge=0.9511 (last merge round=23)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9918659264345845, 'loss_val': 0.03378100344235342, 'psi': 0.9941948801775076}-{'f1_val': 0.9958933237853395, 'auprc': 0.9983984199184681, 'loss_val': 0.031763487886057894, 'psi': 0.9968953622385909}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=2.033986 (no previous merge yet)
[S6] round=68 local utility u=0.052076 metrics={'f1_val': 0.7509552786183865, 'auprc': 0.9239095391155938, 'loss_val': 0.7401626295428922, 'psi': 0.8201369828172694}-{'f1_val': 0.7328886016494125, 'auprc': 0.9337627020446522, 'loss_val': 0.7654742064607648, 'psi': 0.8132382418075084}
[S7] START round=68 head_norm_before_train=1.516044 cos_to_last_merge=0.9540 (last merge round=22)
[S7] round=68 local utility u=0.632017 metrics={'f1_val': 0.6691515436941379, 'auprc': 0.8244680356456386, 'loss_val': 0.43497152694881414, 'psi': 0.7312781404747382}-{'f1_val': 0.5548462882144916, 'auprc': 0.7814695426230122, 'loss_val': 0.8841791063715321, 'psi': 0.6454955899778998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=68 head_norm_before_train=2.192958 (no previous merge yet)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.928979634840067, 'auprc': 0.998721241955771, 'loss_val': 0.1510564636124255, 'psi': 0.9568762776863486}-{'f1_val': 0.9927572273717925, 'auprc': 0.9990659030610409, 'loss_val': 0.028609241844778546, 'psi': 0.9952806976474919}
[S9] START round=68 head_norm_before_train=1.962167 cos_to_last_merge=0.7316 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.732
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969377765558841, 'loss_val': 0.017010749290296643, 'psi': 0.9970368581296394}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968842706734447, 'loss_val': 0.016515668701839625, 'psi': 0.9970154557766635}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.142577 cos_to_last_merge=1.0000 (last merge round=67)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9743322331865678, 'auprc': 0.9926752991521028, 'loss_val': 0.07514190502015859, 'psi': 0.9816694595727818}-{'f1_val': 0.9949681865317428, 'auprc': 0.9944746815246376, 'loss_val': 0.03732994244217266, 'psi': 0.9947707845289007}
[S11] START round=68 head_norm_before_train=1.680665 cos_to_last_merge=0.9157 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=68 local utility u=0.052797 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9980103923001168, 'loss_val': 0.02107150576694657, 'psi': 0.9969896076902679}-{'f1_val': 0.9836663783644507, 'auprc': 0.9994040047290397, 'loss_val': 0.054990816497739674, 'psi': 0.9899614289102863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=68 head_norm_before_train=1.555423 cos_to_last_merge=0.8964 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=68 local utility u=0.226168 metrics={'f1_val': 0.6533079570058589, 'auprc': 0.7534762423144586, 'loss_val': 0.7715018939231921, 'psi': 0.6933752711292988}-{'f1_val': 0.6040100501333616, 'auprc': 0.7642570108520502, 'loss_val': 0.9603933034983728, 'psi': 0.668108834420837}
[S14] START round=68 head_norm_before_train=2.142577 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986491044377501, 'loss_val': 0.017825917441693276, 'psi': 0.9976449418253659}-{'f1_val': 0.9973891252095638, 'auprc': 0.998643480464065, 'loss_val': 0.0189905718788763, 'psi': 0.9978908673113643}
[S15] START round=68 head_norm_before_train=1.752768 cos_to_last_merge=0.9390 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=68 local utility u=0.229181 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9967406604520495, 'loss_val': 0.025073903838315773, 'psi': 0.9964861269533725}-{'f1_val': 0.9327933604132876, 'auprc': 0.9928173024014383, 'loss_val': 0.0905275370649757, 'psi': 0.9568029372085479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=68 head_norm_before_train=2.195473 (no previous merge yet)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.8524622672419767, 'auprc': 0.911777751536754, 'loss_val': 1.1352839095976583, 'psi': 0.8761884609598876}-{'f1_val': 0.9923121867931906, 'auprc': 0.9926678356482945, 'loss_val': 0.039542880893627376, 'psi': 0.9924544463352322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=2.128762 (no previous merge yet)
[S17] round=68 local utility u=1.000000 metrics={'f1_val': 0.8576414685957711, 'auprc': 0.9864620700199185, 'loss_val': 0.3883110771552305, 'psi': 0.90916970916543}-{'f1_val': 0.6413017457498476, 'auprc': 0.8751920415077155, 'loss_val': 1.1418546066270756, 'psi': 0.7348578640529948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S6
[S13] cosine check vs S6: cos=-0.1245
[S13] DROPPED delta from S6 (cos=-0.1245 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0083
[S8] DROPPED delta from S2 (cos=-0.0083 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1245
[S6] DROPPED delta from S13 (cos=-0.1245 < 0.0)
[S2] START round=69 head_norm_before_train=1.977041 cos_to_last_merge=0.9297 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.660066063482538, 'auprc': 0.728305115171292, 'loss_val': 1.4732367163388727, 'psi': 0.6873616841580397}-{'f1_val': 0.7186652023550684, 'auprc': 0.7261716438245895, 'loss_val': 1.1270356747672234, 'psi': 0.7216677789428768}
[S3] START round=69 head_norm_before_train=1.713768 cos_to_last_merge=0.8695 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.870
[S3] round=69 local utility u=0.191958 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9979337310824552, 'loss_val': 0.09952013922912474, 'psi': 0.9758426467736736}-{'f1_val': 0.9275338747488857, 'auprc': 0.9721674447734902, 'loss_val': 0.20464868866715746, 'psi': 0.9453873027587275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=69 head_norm_before_train=1.665762 cos_to_last_merge=0.9229 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=69 local utility u=0.068424 metrics={'f1_val': 0.9454074291641942, 'auprc': 0.9585459582431769, 'loss_val': 0.3094769551072519, 'psi': 0.9506628407957873}-{'f1_val': 0.9399976370208236, 'auprc': 0.927388285156616, 'loss_val': 0.3203927417950731, 'psi': 0.9349538962751405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=69 head_norm_before_train=1.911071 cos_to_last_merge=0.9502 (last merge round=23)
[S5] round=69 local utility u=0.006581 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9952051422236673, 'loss_val': 0.031511632594316365, 'psi': 0.9956180511606706}-{'f1_val': 0.9957475160061228, 'auprc': 0.9918659264345845, 'loss_val': 0.03378100344235342, 'psi': 0.9941948801775076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=69 head_norm_before_train=2.036817 (no previous merge yet)
[S6] round=69 local utility u=0.511695 metrics={'f1_val': 0.8545929841534411, 'auprc': 0.9472465198181043, 'loss_val': 0.4086099449184188, 'psi': 0.8916543984193064}-{'f1_val': 0.7509552786183865, 'auprc': 0.9239095391155938, 'loss_val': 0.7401626295428922, 'psi': 0.8201369828172694}
[S7] START round=69 head_norm_before_train=1.522016 cos_to_last_merge=0.9533 (last merge round=22)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5575502174247827, 'auprc': 0.7812693288603082, 'loss_val': 0.8331772640402271, 'psi': 0.6470378619989929}-{'f1_val': 0.6691515436941379, 'auprc': 0.8244680356456386, 'loss_val': 0.43497152694881414, 'psi': 0.7312781404747382}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=2.196340 (no previous merge yet)
[S8] round=69 local utility u=0.258035 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9991735916149006, 'loss_val': 0.027066760176861694, 'psi': 0.9961294448600393}-{'f1_val': 0.928979634840067, 'auprc': 0.998721241955771, 'loss_val': 0.1510564636124255, 'psi': 0.9568762776863486}
[S9] START round=69 head_norm_before_train=1.965895 cos_to_last_merge=0.7314 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.731
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966214171268938, 'loss_val': 0.01682484944666548, 'psi': 0.9969103143580432}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969377765558841, 'loss_val': 0.017010749290296643, 'psi': 0.9970368581296394}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.149472 cos_to_last_merge=1.0000 (last merge round=67)
[S10] round=69 local utility u=0.091140 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9963335214324011, 'loss_val': 0.02882359996883722, 'psi': 0.9956313898011331}-{'f1_val': 0.9743322331865678, 'auprc': 0.9926752991521028, 'loss_val': 0.07514190502015859, 'psi': 0.9816694595727818}
[S11] START round=69 head_norm_before_train=1.686501 cos_to_last_merge=0.9151 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=69 local utility u=0.001412 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986082628085583, 'loss_val': 0.020041583733717314, 'psi': 0.9972287558936446}-{'f1_val': 0.9963090846170353, 'auprc': 0.9980103923001168, 'loss_val': 0.02107150576694657, 'psi': 0.9969896076902679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=69 head_norm_before_train=1.564553 cos_to_last_merge=0.8954 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6103085609781117, 'auprc': 0.7722784874019956, 'loss_val': 1.1023677077141614, 'psi': 0.6750965315476652}-{'f1_val': 0.6533079570058589, 'auprc': 0.7534762423144586, 'loss_val': 0.7715018939231921, 'psi': 0.6933752711292988}
[S14] START round=69 head_norm_before_train=2.150817 cos_to_last_merge=1.0000 (last merge round=67)
[S14] round=69 local utility u=0.002501 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988522377946125, 'loss_val': 0.017354464205349023, 'psi': 0.9981183609547812}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986491044377501, 'loss_val': 0.017825917441693276, 'psi': 0.9976449418253659}
[S15] START round=69 head_norm_before_train=1.761859 cos_to_last_merge=0.9381 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=69 local utility u=0.001437 metrics={'f1_val': 0.9963052986881302, 'auprc': 0.9973864995859545, 'loss_val': 0.02407010323662853, 'psi': 0.99673777904726}-{'f1_val': 0.9963164379542544, 'auprc': 0.9967406604520495, 'loss_val': 0.025073903838315773, 'psi': 0.9964861269533725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=69 head_norm_before_train=2.196420 (no previous merge yet)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.8471343463489256, 'auprc': 0.8738286980577598, 'loss_val': 1.2534083120940898, 'psi': 0.8578120870324593}-{'f1_val': 0.8524622672419767, 'auprc': 0.911777751536754, 'loss_val': 1.1352839095976583, 'psi': 0.8761884609598876}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=2.139282 (no previous merge yet)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.647986407851795, 'auprc': 0.9060383440354367, 'loss_val': 1.023218906318773, 'psi': 0.7512071823252517}-{'f1_val': 0.8576414685957711, 'auprc': 0.9864620700199185, 'loss_val': 0.3883110771552305, 'psi': 0.90916970916543}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=-0.0076
[S2] DROPPED delta from S8 (cos=-0.0076 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1796) from S6
[S13] cosine check vs S6: cos=-0.1241
[S13] DROPPED delta from S6 (cos=-0.1241 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=69 metric=0.9976 head_norm=2.155763
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.242173e-03
[S14] stored merged vector for next round verification (round=69)
[S14] DEBUG after merge:  round=69 metric=0.9976 head_norm=2.155349 delta_norm=0.008242
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=69 metric=0.9952 head_norm=2.154967
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.242176e-03
[S10] stored merged vector for next round verification (round=69)
[S10] DEBUG after merge:  round=69 metric=0.9952 head_norm=2.155349 delta_norm=0.008242
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.982420 cos_to_last_merge=0.9295 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=70 local utility u=0.108005 metrics={'f1_val': 0.6740534243778001, 'auprc': 0.7276451194274053, 'loss_val': 1.339170590093819, 'psi': 0.6954901023976422}-{'f1_val': 0.660066063482538, 'auprc': 0.728305115171292, 'loss_val': 1.4732367163388727, 'psi': 0.6873616841580397}
[S3] START round=70 head_norm_before_train=1.721971 cos_to_last_merge=0.8684 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.868
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9954021202579857, 'loss_val': 0.11926372175029037, 'psi': 0.9748300024438857}-{'f1_val': 0.9611152572344858, 'auprc': 0.9979337310824552, 'loss_val': 0.09952013922912474, 'psi': 0.9758426467736736}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.667877 cos_to_last_merge=0.9230 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=70 local utility u=0.046963 metrics={'f1_val': 0.9519026684263874, 'auprc': 0.9745063281758455, 'loss_val': 0.30240273078717217, 'psi': 0.9609441323261707}-{'f1_val': 0.9454074291641942, 'auprc': 0.9585459582431769, 'loss_val': 0.3094769551072519, 'psi': 0.9506628407957873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=70 head_norm_before_train=1.918633 cos_to_last_merge=0.9495 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9925911897791964, 'loss_val': 0.032007755719901394, 'psi': 0.9945724701828822}-{'f1_val': 0.9958933237853395, 'auprc': 0.9952051422236673, 'loss_val': 0.031511632594316365, 'psi': 0.9956180511606706}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.040120 (no previous merge yet)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6363598220681403, 'auprc': 0.9198648088655683, 'loss_val': 0.925270456969412, 'psi': 0.7497618167871116}-{'f1_val': 0.8545929841534411, 'auprc': 0.9472465198181043, 'loss_val': 0.4086099449184188, 'psi': 0.8916543984193064}
[S7] START round=70 head_norm_before_train=1.526301 cos_to_last_merge=0.9527 (last merge round=22)
[S7] round=70 local utility u=0.718117 metrics={'f1_val': 0.6786604885052209, 'auprc': 0.8494778406355912, 'loss_val': 0.3282306511017115, 'psi': 0.7469874293573691}-{'f1_val': 0.5575502174247827, 'auprc': 0.7812693288603082, 'loss_val': 0.8331772640402271, 'psi': 0.6470378619989929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=70 head_norm_before_train=2.199256 (no previous merge yet)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9991932333314262, 'loss_val': 0.03264920808837276, 'psi': 0.9961373015466495}-{'f1_val': 0.9941000136901317, 'auprc': 0.9991735916149006, 'loss_val': 0.027066760176861694, 'psi': 0.9961294448600393}
[S9] START round=70 head_norm_before_train=1.971142 cos_to_last_merge=0.7311 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.731
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9990749381739461, 'loss_val': 0.018723580069092232, 'psi': 0.9972423964558907}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966214171268938, 'loss_val': 0.01682484944666548, 'psi': 0.9969103143580432}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.155349 cos_to_last_merge=1.0000 (last merge round=69)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9551972705330999, 'auprc': 0.9927903817798143, 'loss_val': 0.10331943813961424, 'psi': 0.9702345150317857}-{'f1_val': 0.9951633020469546, 'auprc': 0.9963335214324011, 'loss_val': 0.02882359996883722, 'psi': 0.9956313898011331}
[S11] START round=70 head_norm_before_train=1.692462 cos_to_last_merge=0.9145 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=70 local utility u=0.005728 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994431371489783, 'loss_val': 0.017642932065960997, 'psi': 0.9982179692896371}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986082628085583, 'loss_val': 0.020041583733717314, 'psi': 0.9972287558936446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=70 head_norm_before_train=1.572799 cos_to_last_merge=0.8943 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=70 local utility u=0.366485 metrics={'f1_val': 0.6734353376551843, 'auprc': 0.7788981866106565, 'loss_val': 0.7680177160329671, 'psi': 0.7156204772373731}-{'f1_val': 0.6103085609781117, 'auprc': 0.7722784874019956, 'loss_val': 1.1023677077141614, 'psi': 0.6750965315476652}
[S14] START round=70 head_norm_before_train=2.155349 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988532412484301, 'loss_val': 0.018078817499071604, 'psi': 0.9981187623363084}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988522377946125, 'loss_val': 0.017354464205349023, 'psi': 0.9981183609547812}
[S15] START round=70 head_norm_before_train=1.770396 cos_to_last_merge=0.9373 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.7031613197293327, 'auprc': 0.9900575252622401, 'loss_val': 0.42571786316626997, 'psi': 0.8179198019424956}-{'f1_val': 0.9963052986881302, 'auprc': 0.9973864995859545, 'loss_val': 0.02407010323662853, 'psi': 0.99673777904726}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=2.196759 (no previous merge yet)
[S16] round=70 local utility u=1.000000 metrics={'f1_val': 0.9930293008342569, 'auprc': 0.9927740424927456, 'loss_val': 0.03415983498858804, 'psi': 0.9929271974976523}-{'f1_val': 0.8471343463489256, 'auprc': 0.8738286980577598, 'loss_val': 1.2534083120940898, 'psi': 0.8578120870324593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=70 head_norm_before_train=2.147794 (no previous merge yet)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.6496541148607959, 'auprc': 0.8969361998877781, 'loss_val': 1.0095545894918458, 'psi': 0.7485669488715888}-{'f1_val': 0.647986407851795, 'auprc': 0.9060383440354367, 'loss_val': 1.023218906318773, 'psi': 0.7512071823252517}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] ⇄ pheromone p=0.218 → S13@127.0.0.1:63213
[S8] ⇄ pheromone p=0.048 → S2@127.0.0.1:63202
[S10] ⇄ pheromone p=0.074 → S14@127.0.0.1:63214
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.009 → S10@127.0.0.1:63211
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1240
[S6] DROPPED delta from S13 (cos=-0.1240 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0069
[S8] DROPPED delta from S2 (cos=-0.0069 < 0.0)
[S2] ⇄ pheromone p=0.094 → S8@127.0.0.1:63209
[S13] ⇄ pheromone p=0.136 → S6@127.0.0.1:63207
[S2] START round=71 head_norm_before_train=1.988198 cos_to_last_merge=0.9292 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=71 local utility u=0.245023 metrics={'f1_val': 0.7185922432850036, 'auprc': 0.7310037095952553, 'loss_val': 1.126432533256884, 'psi': 0.7235568298091042}-{'f1_val': 0.6740534243778001, 'auprc': 0.7276451194274053, 'loss_val': 1.339170590093819, 'psi': 0.6954901023976422}
[S3] START round=71 head_norm_before_train=1.730159 cos_to_last_merge=0.8674 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.867
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9298169378666898, 'auprc': 0.963121755251344, 'loss_val': 0.20961263399669133, 'psi': 0.9431388648205515}-{'f1_val': 0.9611152572344858, 'auprc': 0.9954021202579857, 'loss_val': 0.11926372175029037, 'psi': 0.9748300024438857}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.670640 cos_to_last_merge=0.9228 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.951130810185414, 'auprc': 0.9659654556093982, 'loss_val': 0.3077058846050042, 'psi': 0.9570646683550077}-{'f1_val': 0.9519026684263874, 'auprc': 0.9745063281758455, 'loss_val': 0.30240273078717217, 'psi': 0.9609441323261707}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.925519 cos_to_last_merge=0.9488 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=71 local utility u=0.009274 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9983619672955812, 'loss_val': 0.030771159966770545, 'psi': 0.9968807811894361}-{'f1_val': 0.9958933237853395, 'auprc': 0.9925911897791964, 'loss_val': 0.032007755719901394, 'psi': 0.9945724701828822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=71 head_norm_before_train=2.049083 (no previous merge yet)
[S6] round=71 local utility u=0.833930 metrics={'f1_val': 0.8344388852360067, 'auprc': 0.9517784360325666, 'loss_val': 0.5416248998653781, 'psi': 0.8813747055546306}-{'f1_val': 0.6363598220681403, 'auprc': 0.9198648088655683, 'loss_val': 0.925270456969412, 'psi': 0.7497618167871116}
[S7] START round=71 head_norm_before_train=1.529775 cos_to_last_merge=0.9521 (last merge round=22)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6174659612246799, 'auprc': 0.7957823777931509, 'loss_val': 0.5781503564342129, 'psi': 0.6887925278520683}-{'f1_val': 0.6786604885052209, 'auprc': 0.8494778406355912, 'loss_val': 0.3282306511017115, 'psi': 0.7469874293573691}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=2.202922 (no previous merge yet)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9990466941395248, 'loss_val': 0.037063622920874624, 'psi': 0.9951614453290951}-{'f1_val': 0.9941000136901317, 'auprc': 0.9991932333314262, 'loss_val': 0.03264920808837276, 'psi': 0.9961373015466495}
[S9] START round=71 head_norm_before_train=1.973862 cos_to_last_merge=0.7309 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.731
[S9] round=71 local utility u=0.004444 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9990775108186121, 'loss_val': 0.016336048754518273, 'psi': 0.9978927518347305}-{'f1_val': 0.9960207019771873, 'auprc': 0.9990749381739461, 'loss_val': 0.018723580069092232, 'psi': 0.9972423964558907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=71 head_norm_before_train=2.160376 cos_to_last_merge=1.0000 (last merge round=69)
[S10] round=71 local utility u=0.161698 metrics={'f1_val': 0.9946988340531434, 'auprc': 0.9966124149301345, 'loss_val': 0.028397920955685583, 'psi': 0.9954642664039399}-{'f1_val': 0.9551972705330999, 'auprc': 0.9927903817798143, 'loss_val': 0.10331943813961424, 'psi': 0.9702345150317857}
[S11] START round=71 head_norm_before_train=1.698697 cos_to_last_merge=0.9139 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9987710288876115, 'loss_val': 0.019436409427711628, 'psi': 0.9975560198389135}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994431371489783, 'loss_val': 0.017642932065960997, 'psi': 0.9982179692896371}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.576164 cos_to_last_merge=0.8936 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.6428936484376899, 'auprc': 0.7555925402150565, 'loss_val': 0.8860078519359917, 'psi': 0.6879732051486365}-{'f1_val': 0.6734353376551843, 'auprc': 0.7788981866106565, 'loss_val': 0.7680177160329671, 'psi': 0.7156204772373731}
[S14] START round=71 head_norm_before_train=2.158818 cos_to_last_merge=1.0000 (last merge round=69)
[S14] round=71 local utility u=0.000440 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9987882115280324, 'loss_val': 0.017004446942834085, 'psi': 0.9980927504481493}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988532412484301, 'loss_val': 0.018078817499071604, 'psi': 0.9981187623363084}
[S15] START round=71 head_norm_before_train=1.776811 cos_to_last_merge=0.9367 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=71 local utility u=0.836033 metrics={'f1_val': 0.9265218006378109, 'auprc': 0.9928003305109994, 'loss_val': 0.10204254624242161, 'psi': 0.9530332125870863}-{'f1_val': 0.7031613197293327, 'auprc': 0.9900575252622401, 'loss_val': 0.42571786316626997, 'psi': 0.8179198019424956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=71 head_norm_before_train=2.199528 (no previous merge yet)
[S16] round=71 local utility u=0.001140 metrics={'f1_val': 0.9932913840280244, 'auprc': 0.9927390948457445, 'loss_val': 0.03334810178499369, 'psi': 0.9930704683551125}-{'f1_val': 0.9930293008342569, 'auprc': 0.9927740424927456, 'loss_val': 0.03415983498858804, 'psi': 0.9929271974976523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=71 head_norm_before_train=2.153924 (no previous merge yet)
[S17] round=71 local utility u=1.000000 metrics={'f1_val': 0.8475789505209979, 'auprc': 0.9742165207709206, 'loss_val': 0.3971230638292406, 'psi': 0.898233978620967}-{'f1_val': 0.6496541148607959, 'auprc': 0.8969361998877781, 'loss_val': 1.0095545894918458, 'psi': 0.7485669488715888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.1240
[S13] DROPPED delta from S6 (cos=-0.1240 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0064
[S8] DROPPED delta from S2 (cos=-0.0064 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=71 metric=0.9976 head_norm=2.163604
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.349689e-03
[S14] stored merged vector for next round verification (round=71)
[S14] DEBUG after merge:  round=71 metric=0.9976 head_norm=2.164835 delta_norm=0.009350
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=71 metric=0.9947 head_norm=2.166107
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.349693e-03
[S10] stored merged vector for next round verification (round=71)
[S10] DEBUG after merge:  round=71 metric=0.9947 head_norm=2.164835 delta_norm=0.009350
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=1.992329 cos_to_last_merge=0.9290 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.705855980340212, 'auprc': 0.7244017544608337, 'loss_val': 1.2614231811674232, 'psi': 0.7132742899884608}-{'f1_val': 0.7185922432850036, 'auprc': 0.7310037095952553, 'loss_val': 1.126432533256884, 'psi': 0.7235568298091042}
[S3] START round=72 head_norm_before_train=1.737652 cos_to_last_merge=0.8665 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=72 local utility u=0.342031 metrics={'f1_val': 0.9944876617066728, 'auprc': 0.9993129132941272, 'loss_val': 0.02214914771304655, 'psi': 0.9964177623416546}-{'f1_val': 0.9298169378666898, 'auprc': 0.963121755251344, 'loss_val': 0.20961263399669133, 'psi': 0.9431388648205515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=72 head_norm_before_train=1.674286 cos_to_last_merge=0.9219 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=72 local utility u=0.003670 metrics={'f1_val': 0.9525096313764929, 'auprc': 0.964066285065249, 'loss_val': 0.3029418690112361, 'psi': 0.9571322928519954}-{'f1_val': 0.951130810185414, 'auprc': 0.9659654556093982, 'loss_val': 0.3077058846050042, 'psi': 0.9570646683550077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=72 head_norm_before_train=1.930247 cos_to_last_merge=0.9476 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9936495230630998, 'loss_val': 0.03145272670138198, 'psi': 0.9949083188289136}-{'f1_val': 0.9958933237853395, 'auprc': 0.9983619672955812, 'loss_val': 0.030771159966770545, 'psi': 0.9968807811894361}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=2.060772 (no previous merge yet)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.7701635322059052, 'auprc': 0.9295390862784118, 'loss_val': 0.7942593642158378, 'psi': 0.8339137538349077}-{'f1_val': 0.8344388852360067, 'auprc': 0.9517784360325666, 'loss_val': 0.5416248998653781, 'psi': 0.8813747055546306}
[S7] START round=72 head_norm_before_train=1.533170 cos_to_last_merge=0.9515 (last merge round=22)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.48140850273714386, 'auprc': 0.7791301180530347, 'loss_val': 0.9818152189081106, 'psi': 0.6004971488635003}-{'f1_val': 0.6174659612246799, 'auprc': 0.7957823777931509, 'loss_val': 0.5781503564342129, 'psi': 0.6887925278520683}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.207871 (no previous merge yet)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9990385046307495, 'loss_val': 0.03794455789783511, 'psi': 0.9950863341236411}-{'f1_val': 0.9925712794554754, 'auprc': 0.9990466941395248, 'loss_val': 0.037063622920874624, 'psi': 0.9951614453290951}
[S9] START round=72 head_norm_before_train=1.976607 cos_to_last_merge=0.7305 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.731
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987685450039857, 'loss_val': 0.016989328262858615, 'psi': 0.99776916550888}-{'f1_val': 0.9971029125121428, 'auprc': 0.9990775108186121, 'loss_val': 0.016336048754518273, 'psi': 0.9978927518347305}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.164835 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9872098497486999, 'auprc': 0.9923565414802634, 'loss_val': 0.060022122132215305, 'psi': 0.9892685264413252}-{'f1_val': 0.9946988340531434, 'auprc': 0.9966124149301345, 'loss_val': 0.028397920955685583, 'psi': 0.9954642664039399}
[S11] START round=72 head_norm_before_train=1.703201 cos_to_last_merge=0.9134 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9951233519837372, 'loss_val': 0.02174906518799236, 'psi': 0.995834791563716}-{'f1_val': 0.9967460138064482, 'auprc': 0.9987710288876115, 'loss_val': 0.019436409427711628, 'psi': 0.9975560198389135}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.579356 cos_to_last_merge=0.8933 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6253827127743604, 'auprc': 0.7878378636417706, 'loss_val': 1.112192233426743, 'psi': 0.6903647731213245}-{'f1_val': 0.6428936484376899, 'auprc': 0.7555925402150565, 'loss_val': 0.8860078519359917, 'psi': 0.6879732051486365}
[S14] START round=72 head_norm_before_train=2.164835 cos_to_last_merge=1.0000 (last merge round=71)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.998670697638098, 'loss_val': 0.016319553543039357, 'psi': 0.9979017541809776}-{'f1_val': 0.9976291097282272, 'auprc': 0.9987882115280324, 'loss_val': 0.017004446942834085, 'psi': 0.9980927504481493}
[S15] START round=72 head_norm_before_train=1.783011 cos_to_last_merge=0.9361 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9152880654675062, 'auprc': 0.995964814231493, 'loss_val': 0.1469106997433277, 'psi': 0.9475587649731009}-{'f1_val': 0.9265218006378109, 'auprc': 0.9928003305109994, 'loss_val': 0.10204254624242161, 'psi': 0.9530332125870863}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=2.200821 (no previous merge yet)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9925207403478591, 'auprc': 0.9891196736456987, 'loss_val': 0.04226810974225327, 'psi': 0.9911603136669949}-{'f1_val': 0.9932913840280244, 'auprc': 0.9927390948457445, 'loss_val': 0.03334810178499369, 'psi': 0.9930704683551125}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.159000 (no previous merge yet)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6351826121898614, 'auprc': 0.8727753839987189, 'loss_val': 1.2573501669758813, 'psi': 0.7302197209134045}-{'f1_val': 0.8475789505209979, 'auprc': 0.9742165207709206, 'loss_val': 0.3971230638292406, 'psi': 0.898233978620967}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=1.997378 cos_to_last_merge=0.9287 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=73 local utility u=0.061655 metrics={'f1_val': 0.7099163241010021, 'auprc': 0.7279817986615292, 'loss_val': 1.173216027228132, 'psi': 0.717142513925213}-{'f1_val': 0.705855980340212, 'auprc': 0.7244017544608337, 'loss_val': 1.2614231811674232, 'psi': 0.7132742899884608}
[S3] START round=73 head_norm_before_train=1.744745 cos_to_last_merge=0.8656 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.9813379442156313, 'auprc': 0.9961996299930841, 'loss_val': 0.06435202317422044, 'psi': 0.9872826185266124}-{'f1_val': 0.9944876617066728, 'auprc': 0.9993129132941272, 'loss_val': 0.02214914771304655, 'psi': 0.9964177623416546}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.674479 cos_to_last_merge=0.9212 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9472653688872593, 'auprc': 0.9647360929643989, 'loss_val': 0.3016053416981594, 'psi': 0.9542536585181152}-{'f1_val': 0.9525096313764929, 'auprc': 0.964066285065249, 'loss_val': 0.3029418690112361, 'psi': 0.9571322928519954}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.934828 cos_to_last_merge=0.9468 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=73 local utility u=0.006665 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9976389573836209, 'loss_val': 0.030965307030735658, 'psi': 0.996591577224652}-{'f1_val': 0.9957475160061228, 'auprc': 0.9936495230630998, 'loss_val': 0.03145272670138198, 'psi': 0.9949083188289136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=73 head_norm_before_train=2.072973 (no previous merge yet)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6160443322883347, 'auprc': 0.7692354902066962, 'loss_val': 1.1557195021455846, 'psi': 0.6773207954556792}-{'f1_val': 0.7701635322059052, 'auprc': 0.9295390862784118, 'loss_val': 0.7942593642158378, 'psi': 0.8339137538349077}
[S7] START round=73 head_norm_before_train=1.538168 cos_to_last_merge=0.9507 (last merge round=22)
[S7] round=73 local utility u=0.704697 metrics={'f1_val': 0.6315206894807341, 'auprc': 0.8011293750602884, 'loss_val': 0.5390912225742084, 'psi': 0.6993641637125558}-{'f1_val': 0.48140850273714386, 'auprc': 0.7791301180530347, 'loss_val': 0.9818152189081106, 'psi': 0.6004971488635003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=73 head_norm_before_train=2.209440 (no previous merge yet)
[S8] round=73 local utility u=0.005200 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9991635940517276, 'loss_val': 0.03010503266261368, 'psi': 0.9953549818133928}-{'f1_val': 0.9924515537855688, 'auprc': 0.9990385046307495, 'loss_val': 0.03794455789783511, 'psi': 0.9950863341236411}
[S9] START round=73 head_norm_before_train=1.981272 cos_to_last_merge=0.7301 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.730
[S9] round=73 local utility u=0.000863 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9990744020730333, 'loss_val': 0.01616291487317852, 'psi': 0.9978897905527513}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987685450039857, 'loss_val': 0.016989328262858615, 'psi': 0.99776916550888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=73 head_norm_before_train=2.170660 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=73 local utility u=0.039488 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994031035926814, 'loss_val': 0.031301857494970706, 'psi': 0.9944615799023491}-{'f1_val': 0.9872098497486999, 'auprc': 0.9923565414802634, 'loss_val': 0.060022122132215305, 'psi': 0.9892685264413252}
[S11] START round=73 head_norm_before_train=1.708437 cos_to_last_merge=0.9128 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=73 local utility u=0.005626 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982250629661876, 'loss_val': 0.019802400890444573, 'psi': 0.9970754759566962}-{'f1_val': 0.9963090846170353, 'auprc': 0.9951233519837372, 'loss_val': 0.02174906518799236, 'psi': 0.995834791563716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=73 head_norm_before_train=1.582660 cos_to_last_merge=0.8927 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6047188443064891, 'auprc': 0.7633917765559535, 'loss_val': 1.1483922197661498, 'psi': 0.6681880172062749}-{'f1_val': 0.6253827127743604, 'auprc': 0.7878378636417706, 'loss_val': 1.112192233426743, 'psi': 0.6903647731213245}
[S14] START round=73 head_norm_before_train=2.168383 cos_to_last_merge=1.0000 (last merge round=71)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9986440519904195, 'loss_val': 0.017993546129756465, 'psi': 0.9978893777849167}-{'f1_val': 0.9973891252095638, 'auprc': 0.998670697638098, 'loss_val': 0.016319553543039357, 'psi': 0.9979017541809776}
[S15] START round=73 head_norm_before_train=1.789894 cos_to_last_merge=0.9355 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.7573652343037198, 'auprc': 0.9083911013684235, 'loss_val': 0.5276495814374161, 'psi': 0.8177755811296012}-{'f1_val': 0.9152880654675062, 'auprc': 0.995964814231493, 'loss_val': 0.1469106997433277, 'psi': 0.9475587649731009}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=2.204750 (no previous merge yet)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9463971494331143, 'auprc': 0.9862199972708678, 'loss_val': 0.20858377104610198, 'psi': 0.9623262885682157}-{'f1_val': 0.9925207403478591, 'auprc': 0.9891196736456987, 'loss_val': 0.04226810974225327, 'psi': 0.9911603136669949}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.161264 (no previous merge yet)
[S17] round=73 local utility u=0.652184 metrics={'f1_val': 0.7303155284198788, 'auprc': 0.9516325881293117, 'loss_val': 0.7603513016784836, 'psi': 0.818842352303652}-{'f1_val': 0.6351826121898614, 'auprc': 0.8727753839987189, 'loss_val': 1.2573501669758813, 'psi': 0.7302197209134045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63202
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63214
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=-0.0056
[S2] DROPPED delta from S8 (cos=-0.0056 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0056
[S8] DROPPED delta from S2 (cos=-0.0056 < 0.0)
[S2] START round=74 head_norm_before_train=2.000529 cos_to_last_merge=0.9285 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7112349294381405, 'auprc': 0.7246345100795692, 'loss_val': 1.2153873649321023, 'psi': 0.7165947616947119}-{'f1_val': 0.7099163241010021, 'auprc': 0.7279817986615292, 'loss_val': 1.173216027228132, 'psi': 0.717142513925213}
[S3] START round=74 head_norm_before_train=1.751233 cos_to_last_merge=0.8647 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.865
[S3] round=74 local utility u=0.065233 metrics={'f1_val': 0.9953513155969688, 'auprc': 0.998758390837926, 'loss_val': 0.025642446674823335, 'psi': 0.9967141456933517}-{'f1_val': 0.9813379442156313, 'auprc': 0.9961996299930841, 'loss_val': 0.06435202317422044, 'psi': 0.9872826185266124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=74 head_norm_before_train=1.679554 cos_to_last_merge=0.9201 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.938940641102485, 'auprc': 0.9181053897965661, 'loss_val': 0.32813133983007114, 'psi': 0.9306065405801174}-{'f1_val': 0.9472653688872593, 'auprc': 0.9647360929643989, 'loss_val': 0.3016053416981594, 'psi': 0.9542536585181152}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.941733 cos_to_last_merge=0.9460 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9913455109694753, 'loss_val': 0.0321086585398169, 'psi': 0.9940741986589938}-{'f1_val': 0.9958933237853395, 'auprc': 0.9976389573836209, 'loss_val': 0.030965307030735658, 'psi': 0.996591577224652}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.084441 (no previous merge yet)
[S6] round=74 local utility u=0.475600 metrics={'f1_val': 0.681342294644947, 'auprc': 0.9139116993163526, 'loss_val': 1.030336861942828, 'psi': 0.7743700565135092}-{'f1_val': 0.6160443322883347, 'auprc': 0.7692354902066962, 'loss_val': 1.1557195021455846, 'psi': 0.6773207954556792}
[S7] START round=74 head_norm_before_train=1.542671 cos_to_last_merge=0.9502 (last merge round=22)
[S7] round=74 local utility u=0.520833 metrics={'f1_val': 0.6938747394684466, 'auprc': 0.9251605560737721, 'loss_val': 0.24364214478240628, 'psi': 0.7863890661105768}-{'f1_val': 0.6315206894807341, 'auprc': 0.8011293750602884, 'loss_val': 0.5390912225742084, 'psi': 0.6993641637125558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=74 head_norm_before_train=2.215472 (no previous merge yet)
[S8] round=74 local utility u=0.004159 metrics={'f1_val': 0.9940317422932848, 'auprc': 0.998905755143475, 'loss_val': 0.028308452238966324, 'psi': 0.995981347433361}-{'f1_val': 0.9928159069878363, 'auprc': 0.9991635940517276, 'loss_val': 0.03010503266261368, 'psi': 0.9953549818133928}
[S9] START round=74 head_norm_before_train=1.986793 cos_to_last_merge=0.7297 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.730
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968431805650863, 'loss_val': 0.016994933269683297, 'psi': 0.9969990197333202}-{'f1_val': 0.9971000495392299, 'auprc': 0.9990744020730333, 'loss_val': 0.01616291487317852, 'psi': 0.9978897905527513}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.176791 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9939152800065549, 'loss_val': 0.032034514257279156, 'psi': 0.9944152775342454}-{'f1_val': 0.9947486092193725, 'auprc': 0.994031035926814, 'loss_val': 0.031301857494970706, 'psi': 0.9944615799023491}
[S11] START round=74 head_norm_before_train=1.712654 cos_to_last_merge=0.9124 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=74 local utility u=0.000421 metrics={'f1_val': 0.9961969786615787, 'auprc': 0.9993322191188977, 'loss_val': 0.021609005274361756, 'psi': 0.9974510748445063}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982250629661876, 'loss_val': 0.019802400890444573, 'psi': 0.9970754759566962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=74 head_norm_before_train=1.586385 cos_to_last_merge=0.8925 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=74 local utility u=0.383019 metrics={'f1_val': 0.6615847643216778, 'auprc': 0.7586535278450688, 'loss_val': 0.7093348761666266, 'psi': 0.7004122697310342}-{'f1_val': 0.6047188443064891, 'auprc': 0.7633917765559535, 'loss_val': 1.1483922197661498, 'psi': 0.6681880172062749}
[S14] START round=74 head_norm_before_train=2.171365 cos_to_last_merge=0.9999 (last merge round=71)
[S14] round=74 local utility u=0.002222 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992045126329201, 'loss_val': 0.01670502525553277, 'psi': 0.9982609890270938}-{'f1_val': 0.9973862616479148, 'auprc': 0.9986440519904195, 'loss_val': 0.017993546129756465, 'psi': 0.9978893777849167}
[S15] START round=74 head_norm_before_train=1.797027 cos_to_last_merge=0.9349 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=74 local utility u=0.747588 metrics={'f1_val': 0.9060152931473927, 'auprc': 0.9931430821809383, 'loss_val': 0.17863083657036857, 'psi': 0.940866408760811}-{'f1_val': 0.7573652343037198, 'auprc': 0.9083911013684235, 'loss_val': 0.5276495814374161, 'psi': 0.8177755811296012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=74 head_norm_before_train=2.210553 (no previous merge yet)
[S16] round=74 local utility u=0.007439 metrics={'f1_val': 0.9468653737578385, 'auprc': 0.9893781292683121, 'loss_val': 0.2059895721478672, 'psi': 0.963870475962028}-{'f1_val': 0.9463971494331143, 'auprc': 0.9862199972708678, 'loss_val': 0.20858377104610198, 'psi': 0.9623262885682157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=74 head_norm_before_train=2.165135 (no previous merge yet)
[S17] round=74 local utility u=0.464196 metrics={'f1_val': 0.835443901123563, 'auprc': 0.9523880129724478, 'loss_val': 0.4649963039829959, 'psi': 0.8822215458631169}-{'f1_val': 0.7303155284198788, 'auprc': 0.9516325881293117, 'loss_val': 0.7603513016784836, 'psi': 0.818842352303652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1797) from S6
[S13] cosine check vs S6: cos=-0.1238
[S13] DROPPED delta from S6 (cos=-0.1238 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1238
[S6] DROPPED delta from S13 (cos=-0.1238 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=-0.0054
[S2] DROPPED delta from S8 (cos=-0.0054 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=74 metric=0.9976 head_norm=2.173783
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.573454e-02
[S14] stored merged vector for next round verification (round=74)
[S14] DEBUG after merge:  round=74 metric=0.9976 head_norm=2.175231 delta_norm=0.015735
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=2.004249 cos_to_last_merge=0.9282 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=75 local utility u=0.062170 metrics={'f1_val': 0.718358695008348, 'auprc': 0.7277539657474545, 'loss_val': 1.1431488012683804, 'psi': 0.7221168033039906}-{'f1_val': 0.7112349294381405, 'auprc': 0.7246345100795692, 'loss_val': 1.2153873649321023, 'psi': 0.7165947616947119}
[S3] START round=75 head_norm_before_train=1.757541 cos_to_last_merge=0.8639 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.864
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9740192015029603, 'auprc': 0.998244971430845, 'loss_val': 0.06357027199309734, 'psi': 0.9837095094741142}-{'f1_val': 0.9953513155969688, 'auprc': 0.998758390837926, 'loss_val': 0.025642446674823335, 'psi': 0.9967141456933517}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.683889 cos_to_last_merge=0.9192 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=75 local utility u=0.015237 metrics={'f1_val': 0.9403206822944631, 'auprc': 0.9240148628365307, 'loss_val': 0.3236663312598948, 'psi': 0.9337983545112901}-{'f1_val': 0.938940641102485, 'auprc': 0.9181053897965661, 'loss_val': 0.32813133983007114, 'psi': 0.9306065405801174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=75 head_norm_before_train=1.941785 cos_to_last_merge=0.9452 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=75 local utility u=0.005649 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9948336985787017, 'loss_val': 0.03127604344147932, 'psi': 0.9954694737026843}-{'f1_val': 0.9958933237853395, 'auprc': 0.9913455109694753, 'loss_val': 0.0321086585398169, 'psi': 0.9940741986589938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=75 head_norm_before_train=2.092696 (no previous merge yet)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6704856405725221, 'auprc': 0.9127389813215392, 'loss_val': 1.049316483069743, 'psi': 0.7673869768721289}-{'f1_val': 0.681342294644947, 'auprc': 0.9139116993163526, 'loss_val': 1.030336861942828, 'psi': 0.7743700565135092}
[S7] START round=75 head_norm_before_train=1.545198 cos_to_last_merge=0.9500 (last merge round=22)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.40432117861155703, 'auprc': 0.7752698751518394, 'loss_val': 1.288028397977308, 'psi': 0.55270065722767}-{'f1_val': 0.6938747394684466, 'auprc': 0.9251605560737721, 'loss_val': 0.24364214478240628, 'psi': 0.7863890661105768}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.221241 (no previous merge yet)
[S8] round=75 local utility u=0.000747 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9990069416738391, 'loss_val': 0.026060447507423194, 'psi': 0.9959160460379224}-{'f1_val': 0.9940317422932848, 'auprc': 0.998905755143475, 'loss_val': 0.028308452238966324, 'psi': 0.995981347433361}
[S9] START round=75 head_norm_before_train=1.990683 cos_to_last_merge=0.7293 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.729
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9990548320109428, 'loss_val': 0.0414028919365119, 'psi': 0.9930992686503572}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968431805650863, 'loss_val': 0.016994933269683297, 'psi': 0.9969990197333202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.183066 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9566254138716745, 'auprc': 0.9921607749911491, 'loss_val': 0.09972845861019647, 'psi': 0.9708395583194644}-{'f1_val': 0.9947486092193725, 'auprc': 0.9939152800065549, 'loss_val': 0.032034514257279156, 'psi': 0.9944152775342454}
[S11] START round=75 head_norm_before_train=1.716326 cos_to_last_merge=0.9120 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=75 local utility u=0.001731 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986530994128211, 'loss_val': 0.019261525549122277, 'psi': 0.9974946915140377}-{'f1_val': 0.9961969786615787, 'auprc': 0.9993322191188977, 'loss_val': 0.021609005274361756, 'psi': 0.9974510748445063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=75 head_norm_before_train=1.590700 cos_to_last_merge=0.8920 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.5880109659523136, 'auprc': 0.7746559393250795, 'loss_val': 1.1347971076543262, 'psi': 0.66266895530142}-{'f1_val': 0.6615847643216778, 'auprc': 0.7586535278450688, 'loss_val': 0.7093348761666266, 'psi': 0.7004122697310342}
[S14] START round=75 head_norm_before_train=2.175231 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9982830790006876, 'auprc': 0.9988559080815423, 'loss_val': 0.02093888857037234, 'psi': 0.9985122106330294}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992045126329201, 'loss_val': 0.01670502525553277, 'psi': 0.9982609890270938}
[S15] START round=75 head_norm_before_train=1.804172 cos_to_last_merge=0.9343 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=75 local utility u=0.353315 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9951828352206114, 'loss_val': 0.02250820798233041, 'psi': 0.9961211351207568}-{'f1_val': 0.9060152931473927, 'auprc': 0.9931430821809383, 'loss_val': 0.17863083657036857, 'psi': 0.940866408760811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=75 head_norm_before_train=2.215716 (no previous merge yet)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9449801671830145, 'auprc': 0.9913928775135257, 'loss_val': 0.2596110155165565, 'psi': 0.963545251315219}-{'f1_val': 0.9468653737578385, 'auprc': 0.9893781292683121, 'loss_val': 0.2059895721478672, 'psi': 0.963870475962028}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=2.169511 (no previous merge yet)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.6254166067926714, 'auprc': 0.8653240633582892, 'loss_val': 1.1270990303924264, 'psi': 0.7213795894189186}-{'f1_val': 0.835443901123563, 'auprc': 0.9523880129724478, 'loss_val': 0.4649963039829959, 'psi': 0.8822215458631169}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.106 → S6@127.0.0.1:63207
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=75 metric=0.9566 head_norm=2.186706
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.901579e-02
[S10] stored merged vector for next round verification (round=75)
[S10] DEBUG after merge:  round=75 metric=0.9554 head_norm=2.180171 delta_norm=0.019016
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.043 → S14@127.0.0.1:63214
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] ⇄ pheromone p=0.216 → S13@127.0.0.1:63213
[S14] ⇄ pheromone p=0.003 → S10@127.0.0.1:63211
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0053
[S8] DROPPED delta from S2 (cos=-0.0053 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=-0.0053
[S2] DROPPED delta from S8 (cos=-0.0053 < 0.0)
[S2] ⇄ pheromone p=0.071 → S8@127.0.0.1:63209
[S8] ⇄ pheromone p=0.017 → S2@127.0.0.1:63202
[S2] START round=76 head_norm_before_train=2.009099 cos_to_last_merge=0.9278 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7179792284967421, 'auprc': 0.7261294300644375, 'loss_val': 1.1454635448280972, 'psi': 0.7212393091238203}-{'f1_val': 0.718358695008348, 'auprc': 0.7277539657474545, 'loss_val': 1.1431488012683804, 'psi': 0.7221168033039906}
[S3] START round=76 head_norm_before_train=1.764109 cos_to_last_merge=0.8631 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8700538312814784, 'auprc': 0.9679901104981352, 'loss_val': 0.28500339990194684, 'psi': 0.9092283429681411}-{'f1_val': 0.9740192015029603, 'auprc': 0.998244971430845, 'loss_val': 0.06357027199309734, 'psi': 0.9837095094741142}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.687295 cos_to_last_merge=0.9188 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=76 local utility u=0.031480 metrics={'f1_val': 0.9418234375104546, 'auprc': 0.9392684183704897, 'loss_val': 0.3154839628935056, 'psi': 0.9408014298544686}-{'f1_val': 0.9403206822944631, 'auprc': 0.9240148628365307, 'loss_val': 0.3236663312598948, 'psi': 0.9337983545112901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=76 head_norm_before_train=1.946792 cos_to_last_merge=0.9443 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=76 local utility u=0.001415 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9958540605239318, 'loss_val': 0.03063264478501457, 'psi': 0.9957901338132464}-{'f1_val': 0.9958933237853395, 'auprc': 0.9948336985787017, 'loss_val': 0.03127604344147932, 'psi': 0.9954694737026843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=76 head_norm_before_train=2.094095 (no previous merge yet)
[S6] round=76 local utility u=1.000000 metrics={'f1_val': 0.9606167421345835, 'auprc': 0.965644134869888, 'loss_val': 0.1910056700225719, 'psi': 0.9626276992287053}-{'f1_val': 0.6704856405725221, 'auprc': 0.9127389813215392, 'loss_val': 1.049316483069743, 'psi': 0.7673869768721289}
[S7] START round=76 head_norm_before_train=1.545784 cos_to_last_merge=0.9500 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=76 local utility u=1.000000 metrics={'f1_val': 0.688427365902277, 'auprc': 0.8869850234441305, 'loss_val': 0.28625981193590666, 'psi': 0.7678504289190184}-{'f1_val': 0.40432117861155703, 'auprc': 0.7752698751518394, 'loss_val': 1.288028397977308, 'psi': 0.55270065722767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=76 head_norm_before_train=2.228002 (no previous merge yet)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9850518562300145, 'auprc': 0.9988372548546045, 'loss_val': 0.042721933381331394, 'psi': 0.9905660156798505}-{'f1_val': 0.9938554489473111, 'auprc': 0.9990069416738391, 'loss_val': 0.026060447507423194, 'psi': 0.9959160460379224}
[S9] START round=76 head_norm_before_train=1.993938 cos_to_last_merge=0.7290 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.729
[S9] round=76 local utility u=0.035442 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9983508528883952, 'loss_val': 0.01623417262703023, 'psi': 0.9976003708788961}-{'f1_val': 0.9891288930766337, 'auprc': 0.9990548320109428, 'loss_val': 0.0414028919365119, 'psi': 0.9930992686503572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=76 head_norm_before_train=2.180171 cos_to_last_merge=1.0000 (last merge round=75)
[S10] round=76 local utility u=0.155001 metrics={'f1_val': 0.9945046060794613, 'auprc': 0.9961549644396182, 'loss_val': 0.028984410792176802, 'psi': 0.9951647494235241}-{'f1_val': 0.9566254138716745, 'auprc': 0.9921607749911491, 'loss_val': 0.09972845861019647, 'psi': 0.9708395583194644}
[S11] START round=76 head_norm_before_train=1.721133 cos_to_last_merge=0.9114 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=76 local utility u=0.001974 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9988713000861369, 'loss_val': 0.01858906166905634, 'psi': 0.9978441318938402}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986530994128211, 'loss_val': 0.019261525549122277, 'psi': 0.9974946915140377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=76 head_norm_before_train=1.594818 cos_to_last_merge=0.8915 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=76 local utility u=0.023788 metrics={'f1_val': 0.5935463056679419, 'auprc': 0.7769817483813067, 'loss_val': 1.1274108564871401, 'psi': 0.6669204827532879}-{'f1_val': 0.5880109659523136, 'auprc': 0.7746559393250795, 'loss_val': 1.1347971076543262, 'psi': 0.66266895530142}
[S14] START round=76 head_norm_before_train=2.178231 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9437956314670307, 'auprc': 0.9983102835245352, 'loss_val': 0.09683491542850281, 'psi': 0.9656014922900326}-{'f1_val': 0.9982830790006876, 'auprc': 0.9988559080815423, 'loss_val': 0.02093888857037234, 'psi': 0.9985122106330294}
[S15] START round=76 head_norm_before_train=1.810922 cos_to_last_merge=0.9337 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.7800353859628009, 'auprc': 0.9904407289824277, 'loss_val': 0.3636515706402548, 'psi': 0.8641975231706516}-{'f1_val': 0.9967466683875206, 'auprc': 0.9951828352206114, 'loss_val': 0.02250820798233041, 'psi': 0.9961211351207568}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.219647 (no previous merge yet)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9397502357768613, 'auprc': 0.9889590873393009, 'loss_val': 0.3782758097475068, 'psi': 0.9594337764018372}-{'f1_val': 0.9449801671830145, 'auprc': 0.9913928775135257, 'loss_val': 0.2596110155165565, 'psi': 0.963545251315219}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.175544 (no previous merge yet)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6037251004243375, 'auprc': 0.8320199396509054, 'loss_val': 1.2887201882781236, 'psi': 0.6950430361149647}-{'f1_val': 0.6254166067926714, 'auprc': 0.8653240633582892, 'loss_val': 1.1270990303924264, 'psi': 0.7213795894189186}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1233
[S6] DROPPED delta from S13 (cos=-0.1233 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.1233
[S13] DROPPED delta from S6 (cos=-0.1233 < 0.0)
[S2] START round=77 head_norm_before_train=2.009912 cos_to_last_merge=0.9283 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.6833232335668178, 'auprc': 0.7279363732899685, 'loss_val': 1.2591674869172094, 'psi': 0.7011684894560781}-{'f1_val': 0.7179792284967421, 'auprc': 0.7261294300644375, 'loss_val': 1.1454635448280972, 'psi': 0.7212393091238203}
[S3] START round=77 head_norm_before_train=1.769692 cos_to_last_merge=0.8625 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.862
[S3] round=77 local utility u=0.064515 metrics={'f1_val': 0.8689316320459964, 'auprc': 0.9983761121826329, 'loss_val': 0.24039833697446572, 'psi': 0.920709424100651}-{'f1_val': 0.8700538312814784, 'auprc': 0.9679901104981352, 'loss_val': 0.28500339990194684, 'psi': 0.9092283429681411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=77 head_norm_before_train=1.689136 cos_to_last_merge=0.9188 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9400181945198094, 'auprc': 0.9350529273356943, 'loss_val': 0.3180124561834127, 'psi': 0.9380320876461634}-{'f1_val': 0.9418234375104546, 'auprc': 0.9392684183704897, 'loss_val': 0.3154839628935056, 'psi': 0.9408014298544686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.953549 cos_to_last_merge=0.9436 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=77 local utility u=0.003740 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.997938336664003, 'loss_val': 0.03027933639835979, 'psi': 0.9967113289368048}-{'f1_val': 0.9957475160061228, 'auprc': 0.9958540605239318, 'loss_val': 0.03063264478501457, 'psi': 0.9957901338132464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=77 head_norm_before_train=2.095670 (no previous merge yet)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.620107990154141, 'auprc': 0.9246522868387321, 'loss_val': 0.9290455846570989, 'psi': 0.7419257088279774}-{'f1_val': 0.9606167421345835, 'auprc': 0.965644134869888, 'loss_val': 0.1910056700225719, 'psi': 0.9626276992287053}
[S7] START round=77 head_norm_before_train=1.548190 cos_to_last_merge=0.9496 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5565070613865976, 'auprc': 0.7825888348937131, 'loss_val': 0.7679942825063761, 'psi': 0.6469397707894438}-{'f1_val': 0.688427365902277, 'auprc': 0.8869850234441305, 'loss_val': 0.28625981193590666, 'psi': 0.7678504289190184}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.231443 (no previous merge yet)
[S8] round=77 local utility u=0.030087 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9991430920231562, 'loss_val': 0.029697003189380084, 'psi': 0.9953115732323381}-{'f1_val': 0.9850518562300145, 'auprc': 0.9988372548546045, 'loss_val': 0.042721933381331394, 'psi': 0.9905660156798505}
[S9] START round=77 head_norm_before_train=1.998686 cos_to_last_merge=0.7286 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.729
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9917489261407266, 'loss_val': 0.018724615856644256, 'psi': 0.994715065215148}-{'f1_val': 0.9971000495392299, 'auprc': 0.9983508528883952, 'loss_val': 0.01623417262703023, 'psi': 0.9976003708788961}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.183107 cos_to_last_merge=1.0000 (last merge round=75)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9927616125686023, 'auprc': 0.99340708558015, 'loss_val': 0.05099938928333838, 'psi': 0.9930198017732215}-{'f1_val': 0.9945046060794613, 'auprc': 0.9961549644396182, 'loss_val': 0.028984410792176802, 'psi': 0.9951647494235241}
[S11] START round=77 head_norm_before_train=1.726474 cos_to_last_merge=0.9108 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=77 local utility u=0.001645 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989736531334954, 'loss_val': 0.017057657586622525, 'psi': 0.998030175683444}-{'f1_val': 0.9971593530989756, 'auprc': 0.9988713000861369, 'loss_val': 0.01858906166905634, 'psi': 0.9978441318938402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=77 head_norm_before_train=1.598992 cos_to_last_merge=0.8908 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=77 local utility u=0.196808 metrics={'f1_val': 0.6463411133001382, 'auprc': 0.7164288266710416, 'loss_val': 0.8689042928428417, 'psi': 0.6743761986484995}-{'f1_val': 0.5935463056679419, 'auprc': 0.7769817483813067, 'loss_val': 1.1274108564871401, 'psi': 0.6669204827532879}
[S14] START round=77 head_norm_before_train=2.183865 cos_to_last_merge=1.0000 (last merge round=74)
[S14] round=77 local utility u=0.201248 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9986907024724969, 'loss_val': 0.019491833925401172, 'psi': 0.9981547871449354}-{'f1_val': 0.9437956314670307, 'auprc': 0.9983102835245352, 'loss_val': 0.09683491542850281, 'psi': 0.9656014922900326}
[S15] START round=77 head_norm_before_train=1.817312 cos_to_last_merge=0.9332 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=77 local utility u=0.822971 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9920009787079986, 'loss_val': 0.02265809259762554, 'psi': 0.9948483925157118}-{'f1_val': 0.7800353859628009, 'auprc': 0.9904407289824277, 'loss_val': 0.3636515706402548, 'psi': 0.8641975231706516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=77 head_norm_before_train=2.221268 (no previous merge yet)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9328570129591366, 'auprc': 0.9879244464065402, 'loss_val': 0.4478251383772486, 'psi': 0.954883986338098}-{'f1_val': 0.9397502357768613, 'auprc': 0.9889590873393009, 'loss_val': 0.3782758097475068, 'psi': 0.9594337764018372}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=2.181380 (no previous merge yet)
[S17] round=77 local utility u=1.000000 metrics={'f1_val': 0.8473980044857368, 'auprc': 0.965673300072804, 'loss_val': 0.40763515572538905, 'psi': 0.8947081227205637}-{'f1_val': 0.6037251004243375, 'auprc': 0.8320199396509054, 'loss_val': 1.2887201882781236, 'psi': 0.6950430361149647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:63202
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1227
[S6] DROPPED delta from S13 (cos=-0.1227 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1789) from S8
[S2] cosine check vs S8: cos=-0.0042
[S2] DROPPED delta from S8 (cos=-0.0042 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=77 metric=0.9978 head_norm=2.186820
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.869267e-03
[S14] stored merged vector for next round verification (round=77)
[S14] DEBUG after merge:  round=77 metric=0.9978 head_norm=2.184946 delta_norm=0.008869
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=2.014171 cos_to_last_merge=0.9281 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6795989005084809, 'auprc': 0.7277590239976539, 'loss_val': 1.3257409227188746, 'psi': 0.6988629499041501}-{'f1_val': 0.6833232335668178, 'auprc': 0.7279363732899685, 'loss_val': 1.2591674869172094, 'psi': 0.7011684894560781}
[S3] START round=78 head_norm_before_train=1.773827 cos_to_last_merge=0.8621 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.862
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.8250740520009009, 'auprc': 0.9888347574084849, 'loss_val': 0.3091358742624399, 'psi': 0.8905783341639345}-{'f1_val': 0.8689316320459964, 'auprc': 0.9983761121826329, 'loss_val': 0.24039833697446572, 'psi': 0.920709424100651}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.689605 cos_to_last_merge=0.9185 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=78 local utility u=0.054116 metrics={'f1_val': 0.9428215670966387, 'auprc': 0.9612333169612644, 'loss_val': 0.3051412391921976, 'psi': 0.950186267042489}-{'f1_val': 0.9400181945198094, 'auprc': 0.9350529273356943, 'loss_val': 0.3180124561834127, 'psi': 0.9380320876461634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=78 head_norm_before_train=1.957253 cos_to_last_merge=0.9431 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9905335360396241, 'loss_val': 0.031804193929303635, 'psi': 0.9936619240195234}-{'f1_val': 0.9958933237853395, 'auprc': 0.997938336664003, 'loss_val': 0.03027933639835979, 'psi': 0.9967113289368048}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.097038 (no previous merge yet)
[S6] round=78 local utility u=0.072196 metrics={'f1_val': 0.6272617725459444, 'auprc': 0.926940308949765, 'loss_val': 0.8344399097616387, 'psi': 0.7471331871074727}-{'f1_val': 0.620107990154141, 'auprc': 0.9246522868387321, 'loss_val': 0.9290455846570989, 'psi': 0.7419257088279774}
[S7] START round=78 head_norm_before_train=1.550087 cos_to_last_merge=0.9494 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=78 local utility u=0.278793 metrics={'f1_val': 0.6136907889094534, 'auprc': 0.7941615084885827, 'loss_val': 0.5882285870223841, 'psi': 0.6858790767411052}-{'f1_val': 0.5565070613865976, 'auprc': 0.7825888348937131, 'loss_val': 0.7679942825063761, 'psi': 0.6469397707894438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=78 head_norm_before_train=2.232571 (no previous merge yet)
[S8] round=78 local utility u=0.006818 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9993886817774579, 'loss_val': 0.027057243048689783, 'psi': 0.9964357938924202}-{'f1_val': 0.9927572273717925, 'auprc': 0.9991430920231562, 'loss_val': 0.029697003189380084, 'psi': 0.9953115732323381}
[S9] START round=78 head_norm_before_train=2.003887 cos_to_last_merge=0.7282 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9990191424166334, 'loss_val': 0.03205678160051983, 'psi': 0.9939507620263883}-{'f1_val': 0.9966924912647621, 'auprc': 0.9917489261407266, 'loss_val': 0.018724615856644256, 'psi': 0.994715065215148}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.184247 cos_to_last_merge=1.0000 (last merge round=75)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9564074033034284, 'auprc': 0.9923935317722252, 'loss_val': 0.09928827994678366, 'psi': 0.9708018546909472}-{'f1_val': 0.9927616125686023, 'auprc': 0.99340708558015, 'loss_val': 0.05099938928333838, 'psi': 0.9930198017732215}
[S11] START round=78 head_norm_before_train=1.732334 cos_to_last_merge=0.9102 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=78 local utility u=0.000623 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.999381393975911, 'loss_val': 0.017035492096038635, 'psi': 0.9981932720204102}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989736531334954, 'loss_val': 0.017057657586622525, 'psi': 0.998030175683444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=78 head_norm_before_train=1.604695 cos_to_last_merge=0.8901 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.890
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6184790408135286, 'auprc': 0.7802369333214533, 'loss_val': 0.9941824272542352, 'psi': 0.6831821978166984}-{'f1_val': 0.6463411133001382, 'auprc': 0.7164288266710416, 'loss_val': 0.8689042928428417, 'psi': 0.6743761986484995}
[S14] START round=78 head_norm_before_train=2.184946 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=78 local utility u=0.000556 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9991390993336428, 'loss_val': 0.018731257583424872, 'psi': 0.9982348237073828}-{'f1_val': 0.9977975102598944, 'auprc': 0.9986907024724969, 'loss_val': 0.019491833925401172, 'psi': 0.9981547871449354}
[S15] START round=78 head_norm_before_train=1.823649 cos_to_last_merge=0.9327 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.9393483497521811, 'auprc': 0.9932766097712471, 'loss_val': 0.09087607870451019, 'psi': 0.9609196537598075}-{'f1_val': 0.9967466683875206, 'auprc': 0.9920009787079986, 'loss_val': 0.02265809259762554, 'psi': 0.9948483925157118}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.225509 (no previous merge yet)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.8957000054292473, 'auprc': 0.9852876372355626, 'loss_val': 0.5911401352796534, 'psi': 0.9315350581517734}-{'f1_val': 0.9328570129591366, 'auprc': 0.9879244464065402, 'loss_val': 0.4478251383772486, 'psi': 0.954883986338098}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.187893 (no previous merge yet)
[S17] round=78 local utility u=0.011081 metrics={'f1_val': 0.8508308642541254, 'auprc': 0.9691026737344515, 'loss_val': 0.4163588056247861, 'psi': 0.8981395880462558}-{'f1_val': 0.8473980044857368, 'auprc': 0.965673300072804, 'loss_val': 0.40763515572538905, 'psi': 0.8947081227205637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=78 metric=0.9564 head_norm=2.187981
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.498425e-02
[S10] stored merged vector for next round verification (round=78)
[S10] DEBUG after merge:  round=78 metric=0.9552 head_norm=2.187349 delta_norm=0.014984
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.1225
[S13] DROPPED delta from S6 (cos=-0.1225 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=-0.0041
[S2] DROPPED delta from S8 (cos=-0.0041 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=1.0000
[S2] START round=79 head_norm_before_train=2.021520 cos_to_last_merge=0.9275 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.679527711821752, 'auprc': 0.7235901857532127, 'loss_val': 1.3494363397206952, 'psi': 0.6971527013943363}-{'f1_val': 0.6795989005084809, 'auprc': 0.7277590239976539, 'loss_val': 1.3257409227188746, 'psi': 0.6988629499041501}
[S3] START round=79 head_norm_before_train=1.777584 cos_to_last_merge=0.8618 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.862
[S3] round=79 local utility u=0.625402 metrics={'f1_val': 0.983867992857389, 'auprc': 0.9992732981885941, 'loss_val': 0.04241117852003332, 'psi': 0.9900301149898711}-{'f1_val': 0.8250740520009009, 'auprc': 0.9888347574084849, 'loss_val': 0.3091358742624399, 'psi': 0.8905783341639345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=80 psi=0.990 u=0.6254 p_local=0.1637 f1=0.984 auprc=0.999 bytes=86419
[S4] START round=79 head_norm_before_train=1.694217 cos_to_last_merge=0.9179 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9409948924411913, 'auprc': 0.942093417866801, 'loss_val': 0.3169994975469878, 'psi': 0.9414343026114352}-{'f1_val': 0.9428215670966387, 'auprc': 0.9612333169612644, 'loss_val': 0.3051412391921976, 'psi': 0.950186267042489}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.941 u=0.0000 p_local=0.0175 f1=0.941 auprc=0.942 bytes=77420
[S5] START round=79 head_norm_before_train=1.961458 cos_to_last_merge=0.9426 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=79 local utility u=0.014199 metrics={'f1_val': 0.9962614844848281, 'auprc': 0.9980424775994983, 'loss_val': 0.02901608412718774, 'psi': 0.9969738817306962}-{'f1_val': 0.9957475160061228, 'auprc': 0.9905335360396241, 'loss_val': 0.031804193929303635, 'psi': 0.9936619240195234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S5] r=80 psi=0.997 u=0.0142 p_local=0.0051 f1=0.996 auprc=0.998 bytes=97205
[S6] START round=79 head_norm_before_train=2.100595 (no previous merge yet)
[S6] round=79 local utility u=1.000000 metrics={'f1_val': 0.871544689876953, 'auprc': 0.9602729373766411, 'loss_val': 0.2984232842915721, 'psi': 0.9070359888768282}-{'f1_val': 0.6272617725459444, 'auprc': 0.926940308949765, 'loss_val': 0.8344399097616387, 'psi': 0.7471331871074727}
[S7] START round=79 head_norm_before_train=1.553133 cos_to_last_merge=0.9489 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=79 local utility u=0.106499 metrics={'f1_val': 0.6428779927175515, 'auprc': 0.7983960780144762, 'loss_val': 0.5630578403975162, 'psi': 0.7050852268363215}-{'f1_val': 0.6136907889094534, 'auprc': 0.7941615084885827, 'loss_val': 0.5882285870223841, 'psi': 0.6858790767411052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=80 psi=0.705 u=0.1065 p_local=0.2817 f1=0.643 auprc=0.798 bytes=82719
[S8] START round=79 head_norm_before_train=2.235506 (no previous merge yet)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.999301817235769, 'loss_val': 0.02777203128826979, 'psi': 0.9961807351083867}-{'f1_val': 0.9944672019690619, 'auprc': 0.9993886817774579, 'loss_val': 0.027057243048689783, 'psi': 0.9964357938924202}
[S9] START round=79 head_norm_before_train=2.006587 cos_to_last_merge=0.7282 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9989985229386102, 'loss_val': 0.03462965488472309, 'psi': 0.9934351781639257}-{'f1_val': 0.9905718417662249, 'auprc': 0.9990191424166334, 'loss_val': 0.03205678160051983, 'psi': 0.9939507620263883}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.993 u=0.0000 p_local=0.0041 f1=0.990 auprc=0.999 bytes=80873
[S10] START round=79 head_norm_before_train=2.187349 cos_to_last_merge=1.0000 (last merge round=78)
[S10] round=79 local utility u=0.158050 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9964174098381287, 'loss_val': 0.028606863832297567, 'psi': 0.9957461179199979}-{'f1_val': 0.9564074033034284, 'auprc': 0.9923935317722252, 'loss_val': 0.09928827994678366, 'psi': 0.9708018546909472}
[S11] START round=79 head_norm_before_train=1.738116 cos_to_last_merge=0.9096 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987053894393098, 'loss_val': 0.01900726154541191, 'psi': 0.9972676065459452}-{'f1_val': 0.9974011907167429, 'auprc': 0.999381393975911, 'loss_val': 0.017035492096038635, 'psi': 0.9981932720204102}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.997 u=0.0000 p_local=0.0063 f1=0.996 auprc=0.999 bytes=95224
[S13] START round=79 head_norm_before_train=1.610705 cos_to_last_merge=0.8892 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.600568972831216, 'auprc': 0.7839172672018919, 'loss_val': 1.0373427986659214, 'psi': 0.6739082905794864}-{'f1_val': 0.6184790408135286, 'auprc': 0.7802369333214533, 'loss_val': 0.9941824272542352, 'psi': 0.6831821978166984}
[S14] START round=79 head_norm_before_train=2.189534 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989959913639814, 'loss_val': 0.01807003226464474, 'psi': 0.9980449931062895}-{'f1_val': 0.9976319732898762, 'auprc': 0.9991390993336428, 'loss_val': 0.018731257583424872, 'psi': 0.9982348237073828}
[S15] START round=79 head_norm_before_train=1.829545 cos_to_last_merge=0.9322 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.8138652758552053, 'loss_val': 0.6896709532367633, 'psi': 0.7460056636035317}-{'f1_val': 0.9393483497521811, 'auprc': 0.9932766097712471, 'loss_val': 0.09087607870451019, 'psi': 0.9609196537598075}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.746 u=0.0000 p_local=0.2282 f1=0.701 auprc=0.814 bytes=77261
[S16] START round=79 head_norm_before_train=2.228953 (no previous merge yet)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.8848470283203353, 'auprc': 0.9841715038179728, 'loss_val': 0.6887557016413878, 'psi': 0.9245768185193903}-{'f1_val': 0.8957000054292473, 'auprc': 0.9852876372355626, 'loss_val': 0.5911401352796534, 'psi': 0.9315350581517734}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.925 u=0.0000 p_local=0.0433 f1=0.885 auprc=0.984 bytes=66511
[S17] START round=79 head_norm_before_train=2.194423 (no previous merge yet)
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.6125149585041734, 'auprc': 0.809253547316337, 'loss_val': 1.3953664057739013, 'psi': 0.6912103940290388}-{'f1_val': 0.8508308642541254, 'auprc': 0.9691026737344515, 'loss_val': 0.4163588056247861, 'psi': 0.8981395880462558}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.691 u=0.0000 p_local=0.2603 f1=0.613 auprc=0.809 bytes=70177
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] r=80 psi=0.996 u=0.0000 p_local=0.0119 f1=0.994 auprc=0.999 bytes=75523
[S2] r=80 psi=0.697 u=0.0000 p_local=0.0292 f1=0.680 auprc=0.724 bytes=70116
[S13] r=80 psi=0.674 u=0.0000 p_local=0.0710 f1=0.601 auprc=0.784 bytes=82759
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0273 f1=0.997 auprc=0.999 bytes=89964
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1796) from S6
[S13] cosine check vs S6: cos=-0.1223
[S13] DROPPED delta from S6 (cos=-0.1223 < 0.0)
[S6] r=80 psi=0.907 u=1.0000 p_local=0.4024 f1=0.872 auprc=0.960 bytes=77382
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=79 metric=0.9953 head_norm=2.192652
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.151476e-03
[S10] stored merged vector for next round verification (round=79)
[S10] DEBUG after merge:  round=79 metric=0.9952 head_norm=2.191082 delta_norm=0.007151
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] r=80 psi=0.996 u=0.1581 p_local=0.0649 f1=0.995 auprc=0.996 bytes=80942
[S2] START round=80 head_norm_before_train=2.029270 cos_to_last_merge=0.9268 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.927
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.6513811792267322, 'auprc': 0.7266334454287857, 'loss_val': 1.576169490245839, 'psi': 0.6814820857075536}-{'f1_val': 0.679527711821752, 'auprc': 0.7235901857532127, 'loss_val': 1.3494363397206952, 'psi': 0.6971527013943363}
[S3] START round=80 head_norm_before_train=1.782438 cos_to_last_merge=0.8614 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.861
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.999293938901233, 'loss_val': 0.11057519768020906, 'psi': 0.9763387262237593}-{'f1_val': 0.983867992857389, 'auprc': 0.9992732981885941, 'loss_val': 0.04241117852003332, 'psi': 0.9900301149898711}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.700041 cos_to_last_merge=0.9167 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=80 local utility u=0.007434 metrics={'f1_val': 0.9420673777147184, 'auprc': 0.9442615991284147, 'loss_val': 0.31507172152612256, 'psi': 0.9429450662801969}-{'f1_val': 0.9409948924411913, 'auprc': 0.942093417866801, 'loss_val': 0.3169994975469878, 'psi': 0.9414343026114352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=80 head_norm_before_train=1.966955 cos_to_last_merge=0.9421 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9880081104158542, 'loss_val': 0.03215570721101226, 'psi': 0.9926517537700155}-{'f1_val': 0.9962614844848281, 'auprc': 0.9980424775994983, 'loss_val': 0.02901608412718774, 'psi': 0.9969738817306962}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=2.105214 (no previous merge yet)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.5946593311738753, 'auprc': 0.70904848292653, 'loss_val': 1.319277837530734, 'psi': 0.6404149918749371}-{'f1_val': 0.871544689876953, 'auprc': 0.9602729373766411, 'loss_val': 0.2984232842915721, 'psi': 0.9070359888768282}
[S7] START round=80 head_norm_before_train=1.557425 cos_to_last_merge=0.9482 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=80 local utility u=0.031569 metrics={'f1_val': 0.6471182525310589, 'auprc': 0.8000317778469451, 'loss_val': 0.5302686698658087, 'psi': 0.7082836626574134}-{'f1_val': 0.6428779927175515, 'auprc': 0.7983960780144762, 'loss_val': 0.5630578403975162, 'psi': 0.7050852268363215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=80 head_norm_before_train=2.238872 (no previous merge yet)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9798117476688298, 'auprc': 0.9972528560982479, 'loss_val': 0.05276746497652445, 'psi': 0.9867881910405971}-{'f1_val': 0.9941000136901317, 'auprc': 0.999301817235769, 'loss_val': 0.02777203128826979, 'psi': 0.9961807351083867}
[S9] START round=80 head_norm_before_train=2.010340 cos_to_last_merge=0.7281 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=80 local utility u=0.029344 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977985221200958, 'loss_val': 0.016601878092815155, 'psi': 0.997381156355324}-{'f1_val': 0.9897262816474692, 'auprc': 0.9989985229386102, 'loss_val': 0.03462965488472309, 'psi': 0.9934351781639257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=80 head_norm_before_train=2.191082 cos_to_last_merge=1.0000 (last merge round=79)
[S10] round=80 local utility u=0.000386 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9958673141756105, 'loss_val': 0.028719270854225196, 'psi': 0.9957795471797095}-{'f1_val': 0.9952985899745774, 'auprc': 0.9964174098381287, 'loss_val': 0.028606863832297567, 'psi': 0.9957461179199979}
[S11] START round=80 head_norm_before_train=1.742529 cos_to_last_merge=0.9092 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9976092934188799, 'loss_val': 0.020280139181883622, 'psi': 0.9968291681377732}-{'f1_val': 0.9963090846170353, 'auprc': 0.9987053894393098, 'loss_val': 0.01900726154541191, 'psi': 0.9972676065459452}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.616164 cos_to_last_merge=0.8885 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=80 local utility u=0.091383 metrics={'f1_val': 0.6203154751258207, 'auprc': 0.7812807969924309, 'loss_val': 0.9651458223490453, 'psi': 0.6847016038724648}-{'f1_val': 0.600568972831216, 'auprc': 0.7839172672018919, 'loss_val': 1.0373427986659214, 'psi': 0.6739082905794864}
[S14] START round=80 head_norm_before_train=2.196401 cos_to_last_merge=1.0000 (last merge round=77)
[S14] round=80 local utility u=0.000356 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989893318127471, 'loss_val': 0.017337560549181397, 'psi': 0.9980423292857957}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989959913639814, 'loss_val': 0.01807003226464474, 'psi': 0.9980449931062895}
[S15] START round=80 head_norm_before_train=1.834697 cos_to_last_merge=0.9318 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=80 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9957417844197234, 'loss_val': 0.022287264340257337, 'psi': 0.9963447148004017}-{'f1_val': 0.7007659221024161, 'auprc': 0.8138652758552053, 'loss_val': 0.6896709532367633, 'psi': 0.7460056636035317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=80 head_norm_before_train=2.230894 (no previous merge yet)
[S16] round=80 local utility u=0.343760 metrics={'f1_val': 0.9397812428859793, 'auprc': 0.9913431334430105, 'loss_val': 0.35235663250954846, 'psi': 0.9604059991087918}-{'f1_val': 0.8848470283203353, 'auprc': 0.9841715038179728, 'loss_val': 0.6887557016413878, 'psi': 0.9245768185193903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=80 head_norm_before_train=2.200773 (no previous merge yet)
[S17] round=80 local utility u=0.719454 metrics={'f1_val': 0.7158305147492747, 'auprc': 0.9023645383597847, 'loss_val': 0.8556844383196098, 'psi': 0.7904441241934788}-{'f1_val': 0.6125149585041734, 'auprc': 0.809253547316337, 'loss_val': 1.3953664057739013, 'psi': 0.6912103940290388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:63211
[S6] ⇄ pheromone p=0.322 → S13@127.0.0.1:63213
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S8] ⇄ pheromone p=0.010 → S2@127.0.0.1:63202
[S2] ⇄ pheromone p=0.023 → S8@127.0.0.1:63209
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1214
[S6] DROPPED delta from S13 (cos=-0.1214 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S14
[S10] cosine check vs S14: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=80 metric=0.9957 head_norm=2.197105
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.897386e-03
[S10] stored merged vector for next round verification (round=80)
[S10] DEBUG after merge:  round=80 metric=0.9957 head_norm=2.200625 delta_norm=0.008897
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.052 → S14@127.0.0.1:63214
[S13] ⇄ pheromone p=0.075 → S6@127.0.0.1:63207
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=80 metric=0.9974 head_norm=2.204176
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.979068e-03
[S14] stored merged vector for next round verification (round=80)
[S14] DEBUG after merge:  round=80 metric=0.9974 head_norm=2.199508 delta_norm=0.009979
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.022 → S10@127.0.0.1:63211
[S2] START round=81 head_norm_before_train=2.037294 cos_to_last_merge=0.9261 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=81 local utility u=0.121668 metrics={'f1_val': 0.668900750873553, 'auprc': 0.7269045368861153, 'loss_val': 1.4387632064394955, 'psi': 0.692102265278578}-{'f1_val': 0.6513811792267322, 'auprc': 0.7266334454287857, 'loss_val': 1.576169490245839, 'psi': 0.6814820857075536}
[S3] START round=81 head_norm_before_train=1.787955 cos_to_last_merge=0.8609 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.861
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.8336480232565626, 'auprc': 0.9476741122493826, 'loss_val': 0.34779028357998026, 'psi': 0.8792584588536906}-{'f1_val': 0.9610352511054436, 'auprc': 0.999293938901233, 'loss_val': 0.11057519768020906, 'psi': 0.9763387262237593}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.705396 cos_to_last_merge=0.9154 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9414849794720169, 'auprc': 0.9397626532493978, 'loss_val': 0.32133479030184947, 'psi': 0.9407960489829692}-{'f1_val': 0.9420673777147184, 'auprc': 0.9442615991284147, 'loss_val': 0.31507172152612256, 'psi': 0.9429450662801969}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.973145 cos_to_last_merge=0.9416 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=81 local utility u=0.015004 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9972167427645662, 'loss_val': 0.03064786618715263, 'psi': 0.9964226913770301}-{'f1_val': 0.9957475160061228, 'auprc': 0.9880081104158542, 'loss_val': 0.03215570721101226, 'psi': 0.9926517537700155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=81 head_norm_before_train=2.109141 (no previous merge yet)
[S6] round=81 local utility u=0.246639 metrics={'f1_val': 0.6446661993122004, 'auprc': 0.743740887170266, 'loss_val': 1.2301186840932454, 'psi': 0.6842960744554266}-{'f1_val': 0.5946593311738753, 'auprc': 0.70904848292653, 'loss_val': 1.319277837530734, 'psi': 0.6404149918749371}
[S7] START round=81 head_norm_before_train=1.561692 cos_to_last_merge=0.9474 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6024596888877826, 'auprc': 0.7889025478051095, 'loss_val': 0.6517373176114645, 'psi': 0.6770368324547134}-{'f1_val': 0.6471182525310589, 'auprc': 0.8000317778469451, 'loss_val': 0.5302686698658087, 'psi': 0.7082836626574134}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.243714 (no previous merge yet)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9693543769936931, 'auprc': 0.9956876166840474, 'loss_val': 0.08789453862356376, 'psi': 0.9798876728698347}-{'f1_val': 0.9798117476688298, 'auprc': 0.9972528560982479, 'loss_val': 0.05276746497652445, 'psi': 0.9867881910405971}
[S9] START round=81 head_norm_before_train=2.013180 cos_to_last_merge=0.7280 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976854140937554, 'loss_val': 0.017375961809880536, 'psi': 0.9973359131447879}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977985221200958, 'loss_val': 0.016601878092815155, 'psi': 0.997381156355324}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.200625 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9941144426664517, 'loss_val': 0.03020785308490488, 'psi': 0.9948295756336255}-{'f1_val': 0.9957210358491089, 'auprc': 0.9958673141756105, 'loss_val': 0.028719270854225196, 'psi': 0.9957795471797095}
[S11] START round=81 head_norm_before_train=1.747736 cos_to_last_merge=0.9087 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=81 local utility u=0.000941 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9980322099599372, 'loss_val': 0.019666227515352894, 'psi': 0.9969983347541961}-{'f1_val': 0.9963090846170353, 'auprc': 0.9976092934188799, 'loss_val': 0.020280139181883622, 'psi': 0.9968291681377732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=81 head_norm_before_train=1.620547 cos_to_last_merge=0.8877 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=81 local utility u=0.110056 metrics={'f1_val': 0.645122162195261, 'auprc': 0.7813070852465971, 'loss_val': 0.893952519171757, 'psi': 0.6995961314157955}-{'f1_val': 0.6203154751258207, 'auprc': 0.7812807969924309, 'loss_val': 0.9651458223490453, 'psi': 0.6847016038724648}
[S14] START round=81 head_norm_before_train=2.199508 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9988113161795201, 'loss_val': 0.017876158687931014, 'psi': 0.9979580015975464}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989893318127471, 'loss_val': 0.017337560549181397, 'psi': 0.9980423292857957}
[S15] START round=81 head_norm_before_train=1.839003 cos_to_last_merge=0.9315 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.994295640191232, 'loss_val': 0.023850066012630938, 'psi': 0.9957662571090051}-{'f1_val': 0.9967466683875206, 'auprc': 0.9957417844197234, 'loss_val': 0.022287264340257337, 'psi': 0.9963447148004017}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.233056 (no previous merge yet)
[S16] round=81 local utility u=0.324144 metrics={'f1_val': 0.9934349715259067, 'auprc': 0.9946037643830874, 'loss_val': 0.035773109560361754, 'psi': 0.993902488668779}-{'f1_val': 0.9397812428859793, 'auprc': 0.9913431334430105, 'loss_val': 0.35235663250954846, 'psi': 0.9604059991087918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=81 head_norm_before_train=2.206708 (no previous merge yet)
[S17] round=81 local utility u=0.547333 metrics={'f1_val': 0.8299735189451233, 'auprc': 0.9623797498554247, 'loss_val': 0.6259220117662329, 'psi': 0.8829360113092439}-{'f1_val': 0.7158305147492747, 'auprc': 0.9023645383597847, 'loss_val': 0.8556844383196098, 'psi': 0.7904441241934788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1203
[S13] DROPPED delta from S6 (cos=-0.1203 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1203
[S6] DROPPED delta from S13 (cos=-0.1203 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0033
[S8] DROPPED delta from S2 (cos=-0.0033 < 0.0)
[S2] START round=82 head_norm_before_train=2.039557 cos_to_last_merge=0.9263 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=82 local utility u=0.051439 metrics={'f1_val': 0.675601843906051, 'auprc': 0.7271456166464454, 'loss_val': 1.3768142708131075, 'psi': 0.6962193530022087}-{'f1_val': 0.668900750873553, 'auprc': 0.7269045368861153, 'loss_val': 1.4387632064394955, 'psi': 0.692102265278578}
[S3] START round=82 head_norm_before_train=1.793109 cos_to_last_merge=0.8603 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.860
[S3] round=82 local utility u=0.341215 metrics={'f1_val': 0.8948867141789939, 'auprc': 0.9983346959157545, 'loss_val': 0.1847751454690266, 'psi': 0.9362659068736982}-{'f1_val': 0.8336480232565626, 'auprc': 0.9476741122493826, 'loss_val': 0.34779028357998026, 'psi': 0.8792584588536906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=82 head_norm_before_train=1.709773 cos_to_last_merge=0.9145 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9410485357852784, 'auprc': 0.937451409761709, 'loss_val': 0.32777593936503713, 'psi': 0.9396096853758507}-{'f1_val': 0.9414849794720169, 'auprc': 0.9397626532493978, 'loss_val': 0.32133479030184947, 'psi': 0.9407960489829692}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.977313 cos_to_last_merge=0.9413 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9944702832503862, 'loss_val': 0.030160158993839267, 'psi': 0.9953241075713581}-{'f1_val': 0.9958933237853395, 'auprc': 0.9972167427645662, 'loss_val': 0.03064786618715263, 'psi': 0.9964226913770301}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.111521 (no previous merge yet)
[S6] round=82 local utility u=0.867719 metrics={'f1_val': 0.756606270784817, 'auprc': 0.9076587555905624, 'loss_val': 0.6580741192941013, 'psi': 0.8170272647071152}-{'f1_val': 0.6446661993122004, 'auprc': 0.743740887170266, 'loss_val': 1.2301186840932454, 'psi': 0.6842960744554266}
[S7] START round=82 head_norm_before_train=1.567492 cos_to_last_merge=0.9464 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.5836999368210329, 'auprc': 0.7849277799981091, 'loss_val': 0.7803276194737413, 'psi': 0.6641910740918634}-{'f1_val': 0.6024596888877826, 'auprc': 0.7889025478051095, 'loss_val': 0.6517373176114645, 'psi': 0.6770368324547134}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=2.245656 (no previous merge yet)
[S8] round=82 local utility u=0.105955 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9992595761631439, 'loss_val': 0.03077729762335504, 'psi': 0.9957242167296668}-{'f1_val': 0.9693543769936931, 'auprc': 0.9956876166840474, 'loss_val': 0.08789453862356376, 'psi': 0.9798876728698347}
[S9] START round=82 head_norm_before_train=2.013888 cos_to_last_merge=0.7280 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991159206217055, 'loss_val': 0.01987542211952977, 'psi': 0.9972587894349945}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976854140937554, 'loss_val': 0.017375961809880536, 'psi': 0.9973359131447879}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.206914 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9933357877838936, 'loss_val': 0.0326672564552352, 'psi': 0.994183480645181}-{'f1_val': 0.9953063309450747, 'auprc': 0.9941144426664517, 'loss_val': 0.03020785308490488, 'psi': 0.9948295756336255}
[S11] START round=82 head_norm_before_train=1.752452 cos_to_last_merge=0.9082 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=82 local utility u=0.004990 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9991869545480929, 'loss_val': 0.01722397517649603, 'psi': 0.9978674926737666}-{'f1_val': 0.9963090846170353, 'auprc': 0.9980322099599372, 'loss_val': 0.019666227515352894, 'psi': 0.9969983347541961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=82 head_norm_before_train=1.627174 cos_to_last_merge=0.8867 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6132742804139242, 'auprc': 0.7134489418060606, 'loss_val': 1.2798278620442491, 'psi': 0.6533441449707788}-{'f1_val': 0.645122162195261, 'auprc': 0.7813070852465971, 'loss_val': 0.893952519171757, 'psi': 0.6995961314157955}
[S14] START round=82 head_norm_before_train=2.204175 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.99862213591527, 'loss_val': 0.017947396990994006, 'psi': 0.9978823294918464}-{'f1_val': 0.9973891252095638, 'auprc': 0.9988113161795201, 'loss_val': 0.017876158687931014, 'psi': 0.9979580015975464}
[S15] START round=82 head_norm_before_train=1.843961 cos_to_last_merge=0.9312 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.7055373485874056, 'auprc': 0.9891683679799712, 'loss_val': 0.4379502662468759, 'psi': 0.8189897563444318}-{'f1_val': 0.9967466683875206, 'auprc': 0.994295640191232, 'loss_val': 0.023850066012630938, 'psi': 0.9957662571090051}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.235634 (no previous merge yet)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9874059421990427, 'auprc': 0.9915373691888475, 'loss_val': 0.05862652534383912, 'psi': 0.9890585129949645}-{'f1_val': 0.9934349715259067, 'auprc': 0.9946037643830874, 'loss_val': 0.035773109560361754, 'psi': 0.993902488668779}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.213188 (no previous merge yet)
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.62835818346566, 'auprc': 0.8895753219714105, 'loss_val': 1.303398996479676, 'psi': 0.7328450388679602}-{'f1_val': 0.8299735189451233, 'auprc': 0.9623797498554247, 'loss_val': 0.6259220117662329, 'psi': 0.8829360113092439}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63209
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0028
[S8] DROPPED delta from S2 (cos=-0.0028 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S6
[S13] cosine check vs S6: cos=-0.1198
[S13] DROPPED delta from S6 (cos=-0.1198 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=-0.0028
[S2] DROPPED delta from S8 (cos=-0.0028 < 0.0)
[S2] START round=83 head_norm_before_train=2.045078 cos_to_last_merge=0.9260 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.6449470373841795, 'auprc': 0.7259264040720472, 'loss_val': 1.630218816926121, 'psi': 0.6773387840593266}-{'f1_val': 0.675601843906051, 'auprc': 0.7271456166464454, 'loss_val': 1.3768142708131075, 'psi': 0.6962193530022087}
[S3] START round=83 head_norm_before_train=1.798140 cos_to_last_merge=0.8596 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.860
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.8825573716106496, 'auprc': 0.9982776330878791, 'loss_val': 0.2186421465960701, 'psi': 0.9288454762015415}-{'f1_val': 0.8948867141789939, 'auprc': 0.9983346959157545, 'loss_val': 0.1847751454690266, 'psi': 0.9362659068736982}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.710803 cos_to_last_merge=0.9141 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=83 local utility u=0.096459 metrics={'f1_val': 0.953334404391597, 'auprc': 0.9703136016276874, 'loss_val': 0.3071601214365371, 'psi': 0.9601260832860332}-{'f1_val': 0.9410485357852784, 'auprc': 0.937451409761709, 'loss_val': 0.32777593936503713, 'psi': 0.9396096853758507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=83 head_norm_before_train=1.981506 cos_to_last_merge=0.9407 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=83 local utility u=0.000515 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9946479489370247, 'loss_val': 0.029663380887153253, 'psi': 0.9953951738460135}-{'f1_val': 0.9958933237853395, 'auprc': 0.9944702832503862, 'loss_val': 0.030160158993839267, 'psi': 0.9953241075713581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=83 head_norm_before_train=2.115958 (no previous merge yet)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7143893502648037, 'auprc': 0.8603605265683789, 'loss_val': 0.7260235502221338, 'psi': 0.7727778207862337}-{'f1_val': 0.756606270784817, 'auprc': 0.9076587555905624, 'loss_val': 0.6580741192941013, 'psi': 0.8170272647071152}
[S7] START round=83 head_norm_before_train=1.575146 cos_to_last_merge=0.9452 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=83 local utility u=0.343257 metrics={'f1_val': 0.642797318423652, 'auprc': 0.8038745702238539, 'loss_val': 0.5052373364728069, 'psi': 0.7072282191437327}-{'f1_val': 0.5836999368210329, 'auprc': 0.7849277799981091, 'loss_val': 0.7803276194737413, 'psi': 0.6641910740918634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=83 head_norm_before_train=2.246977 (no previous merge yet)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9992210382614719, 'loss_val': 0.034274087189391976, 'psi': 0.995708801568998}-{'f1_val': 0.9933673104406822, 'auprc': 0.9992595761631439, 'loss_val': 0.03077729762335504, 'psi': 0.9957242167296668}
[S9] START round=83 head_norm_before_train=2.015350 cos_to_last_merge=0.7281 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=83 local utility u=0.001018 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999137477393155, 'loss_val': 0.019405405704930132, 'psi': 0.9974176083955056}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991159206217055, 'loss_val': 0.01987542211952977, 'psi': 0.9972587894349945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=83 head_norm_before_train=2.213241 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9924352548005163, 'loss_val': 0.03293892960559441, 'psi': 0.99382326745183}-{'f1_val': 0.9947486092193725, 'auprc': 0.9933357877838936, 'loss_val': 0.0326672564552352, 'psi': 0.994183480645181}
[S11] START round=83 head_norm_before_train=1.756131 cos_to_last_merge=0.9078 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=83 local utility u=0.000007 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9991732391344104, 'loss_val': 0.01716865253384523, 'psi': 0.9978620065082936}-{'f1_val': 0.9969878514242156, 'auprc': 0.9991869545480929, 'loss_val': 0.01722397517649603, 'psi': 0.9978674926737666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=83 head_norm_before_train=1.635192 cos_to_last_merge=0.8859 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=83 local utility u=0.343187 metrics={'f1_val': 0.6311342871907112, 'auprc': 0.8220698772661874, 'loss_val': 1.0264764855992827, 'psi': 0.7075085232209017}-{'f1_val': 0.6132742804139242, 'auprc': 0.7134489418060606, 'loss_val': 1.2798278620442491, 'psi': 0.6533441449707788}
[S14] START round=83 head_norm_before_train=2.209935 cos_to_last_merge=1.0000 (last merge round=80)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9982830790006876, 'auprc': 0.998789673596652, 'loss_val': 0.025383665859290718, 'psi': 0.9984857168390733}-{'f1_val': 0.9973891252095638, 'auprc': 0.99862213591527, 'loss_val': 0.017947396990994006, 'psi': 0.9978823294918464}
[S15] START round=83 head_norm_before_train=1.849039 cos_to_last_merge=0.9308 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=83 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9955776909358398, 'loss_val': 0.021675929698003988, 'psi': 0.9960209391468886}-{'f1_val': 0.7055373485874056, 'auprc': 0.9891683679799712, 'loss_val': 0.4379502662468759, 'psi': 0.8189897563444318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=83 head_norm_before_train=2.236164 (no previous merge yet)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9692903175067809, 'auprc': 0.9908984643811988, 'loss_val': 0.10066383500241438, 'psi': 0.977933576256548}-{'f1_val': 0.9874059421990427, 'auprc': 0.9915373691888475, 'loss_val': 0.05862652534383912, 'psi': 0.9890585129949645}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=2.219072 (no previous merge yet)
[S17] round=83 local utility u=1.000000 metrics={'f1_val': 0.8574440567714564, 'auprc': 0.9820381552800321, 'loss_val': 0.5457647755856692, 'psi': 0.9072816961748867}-{'f1_val': 0.62835818346566, 'auprc': 0.8895753219714105, 'loss_val': 1.303398996479676, 'psi': 0.7328450388679602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S13
[S6] cosine check vs S13: cos=-0.1194
[S6] DROPPED delta from S13 (cos=-0.1194 < 0.0)
[S2] START round=84 head_norm_before_train=2.052356 cos_to_last_merge=0.9254 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.6421956520860019, 'auprc': 0.728523015591988, 'loss_val': 1.6528630553306773, 'psi': 0.6767265974883963}-{'f1_val': 0.6449470373841795, 'auprc': 0.7259264040720472, 'loss_val': 1.630218816926121, 'psi': 0.6773387840593266}
[S3] START round=84 head_norm_before_train=1.803163 cos_to_last_merge=0.8591 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.815013522621842, 'auprc': 0.9501287841310846, 'loss_val': 0.42086766016259247, 'psi': 0.8690596272255391}-{'f1_val': 0.8825573716106496, 'auprc': 0.9982776330878791, 'loss_val': 0.2186421465960701, 'psi': 0.9288454762015415}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.707090 cos_to_last_merge=0.9147 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9455350348422938, 'auprc': 0.9593435192608282, 'loss_val': 0.3196086881994112, 'psi': 0.9510584286097076}-{'f1_val': 0.953334404391597, 'auprc': 0.9703136016276874, 'loss_val': 0.3071601214365371, 'psi': 0.9601260832860332}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.985712 cos_to_last_merge=0.9399 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9942585859846769, 'loss_val': 0.030208368083308696, 'psi': 0.9951519439975445}-{'f1_val': 0.9958933237853395, 'auprc': 0.9946479489370247, 'loss_val': 0.029663380887153253, 'psi': 0.9953951738460135}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.123821 (no previous merge yet)
[S6] round=84 local utility u=0.465871 metrics={'f1_val': 0.785170406178761, 'auprc': 0.9255612097863284, 'loss_val': 0.4145698736351298, 'psi': 0.841326727621788}-{'f1_val': 0.7143893502648037, 'auprc': 0.8603605265683789, 'loss_val': 0.7260235502221338, 'psi': 0.7727778207862337}
[S7] START round=84 head_norm_before_train=1.580617 cos_to_last_merge=0.9441 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5838920937001266, 'auprc': 0.7846884289952969, 'loss_val': 0.8349312983397597, 'psi': 0.6642106278181947}-{'f1_val': 0.642797318423652, 'auprc': 0.8038745702238539, 'loss_val': 0.5052373364728069, 'psi': 0.7072282191437327}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.250501 (no previous merge yet)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9676603585262462, 'auprc': 0.9955792727623645, 'loss_val': 0.09240869905191516, 'psi': 0.9788279242206934}-{'f1_val': 0.9933673104406822, 'auprc': 0.9992210382614719, 'loss_val': 0.034274087189391976, 'psi': 0.995708801568998}
[S9] START round=84 head_norm_before_train=2.019220 cos_to_last_merge=0.7278 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963737185993975, 'loss_val': 0.016989883880673323, 'psi': 0.9968112349470447}-{'f1_val': 0.9962710290637395, 'auprc': 0.999137477393155, 'loss_val': 0.019405405704930132, 'psi': 0.9974176083955056}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.219588 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=84 local utility u=0.002245 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9932441935574046, 'loss_val': 0.030876243318414393, 'psi': 0.9941468429545853}-{'f1_val': 0.9947486092193725, 'auprc': 0.9924352548005163, 'loss_val': 0.03293892960559441, 'psi': 0.99382326745183}
[S11] START round=84 head_norm_before_train=1.760333 cos_to_last_merge=0.9073 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9988931366145171, 'loss_val': 0.01864536100742662, 'psi': 0.997342705416028}-{'f1_val': 0.9969878514242156, 'auprc': 0.9991732391344104, 'loss_val': 0.01716865253384523, 'psi': 0.9978620065082936}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.642485 cos_to_last_merge=0.8851 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6163516050780566, 'auprc': 0.7771349556768774, 'loss_val': 1.2246495473514014, 'psi': 0.680664945317585}-{'f1_val': 0.6311342871907112, 'auprc': 0.8220698772661874, 'loss_val': 1.0264764855992827, 'psi': 0.7075085232209017}
[S14] START round=84 head_norm_before_train=2.215474 cos_to_last_merge=0.9999 (last merge round=80)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9440384795473431, 'auprc': 0.9971441208031119, 'loss_val': 0.10304817619936137, 'psi': 0.9652807360496507}-{'f1_val': 0.9982830790006876, 'auprc': 0.998789673596652, 'loss_val': 0.025383665859290718, 'psi': 0.9984857168390733}
[S15] START round=84 head_norm_before_train=1.852813 cos_to_last_merge=0.9306 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=84 local utility u=0.004370 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973201014152924, 'loss_val': 0.020744295547221164, 'psi': 0.9969760415986293}-{'f1_val': 0.9963164379542544, 'auprc': 0.9955776909358398, 'loss_val': 0.021675929698003988, 'psi': 0.9960209391468886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=84 head_norm_before_train=2.239088 (no previous merge yet)
[S16] round=84 local utility u=0.109384 metrics={'f1_val': 0.9930225761616748, 'auprc': 0.994455342117978, 'loss_val': 0.034960708378727307, 'psi': 0.9935956825441961}-{'f1_val': 0.9692903175067809, 'auprc': 0.9908984643811988, 'loss_val': 0.10066383500241438, 'psi': 0.977933576256548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=84 head_norm_before_train=2.225211 (no previous merge yet)
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8477690516737024, 'auprc': 0.9772171533723069, 'loss_val': 0.61213459171099, 'psi': 0.8995482923531442}-{'f1_val': 0.8574440567714564, 'auprc': 0.9820381552800321, 'loss_val': 0.5457647755856692, 'psi': 0.9072816961748867}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1194
[S13] DROPPED delta from S6 (cos=-0.1194 < 0.0)
[S2] START round=85 head_norm_before_train=2.060951 cos_to_last_merge=0.9245 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=85 local utility u=0.134359 metrics={'f1_val': 0.6621459369998466, 'auprc': 0.7297596575888315, 'loss_val': 1.507556909573632, 'psi': 0.6891914252354405}-{'f1_val': 0.6421956520860019, 'auprc': 0.728523015591988, 'loss_val': 1.6528630553306773, 'psi': 0.6767265974883963}
[S3] START round=85 head_norm_before_train=1.808044 cos_to_last_merge=0.8586 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=85 local utility u=0.794831 metrics={'f1_val': 0.9916120361929777, 'auprc': 0.9991438689353933, 'loss_val': 0.03784099949675815, 'psi': 0.9946247692899439}-{'f1_val': 0.815013522621842, 'auprc': 0.9501287841310846, 'loss_val': 0.42086766016259247, 'psi': 0.8690596272255391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=85 head_norm_before_train=1.709998 cos_to_last_merge=0.9143 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9400042275608214, 'auprc': 0.940361686421948, 'loss_val': 0.33236466701208955, 'psi': 0.940147211105272}-{'f1_val': 0.9455350348422938, 'auprc': 0.9593435192608282, 'loss_val': 0.3196086881994112, 'psi': 0.9510584286097076}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.990024 cos_to_last_merge=0.9392 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=85 local utility u=0.001692 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9948872177785814, 'loss_val': 0.02870982672300145, 'psi': 0.9954033967151062}-{'f1_val': 0.9957475160061228, 'auprc': 0.9942585859846769, 'loss_val': 0.030208368083308696, 'psi': 0.9951519439975445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=85 head_norm_before_train=2.130881 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.7915728310797141, 'auprc': 0.9246976277991732, 'loss_val': 0.7126933332312436, 'psi': 0.8448227497674977}-{'f1_val': 0.785170406178761, 'auprc': 0.9255612097863284, 'loss_val': 0.4145698736351298, 'psi': 0.841326727621788}
[S7] START round=85 head_norm_before_train=1.586437 cos_to_last_merge=0.9434 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=85 local utility u=0.232525 metrics={'f1_val': 0.6262857035976427, 'auprc': 0.7927330031958191, 'loss_val': 0.6483763061137912, 'psi': 0.6928646234369132}-{'f1_val': 0.5838920937001266, 'auprc': 0.7846884289952969, 'loss_val': 0.8349312983397597, 'psi': 0.6642106278181947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=85 head_norm_before_train=2.256610 (no previous merge yet)
[S8] round=85 local utility u=0.101179 metrics={'f1_val': 0.9896716780486329, 'auprc': 0.9990317102609997, 'loss_val': 0.032475703388071264, 'psi': 0.9934156909335796}-{'f1_val': 0.9676603585262462, 'auprc': 0.9955792727623645, 'loss_val': 0.09240869905191516, 'psi': 0.9788279242206934}
[S9] START round=85 head_norm_before_train=2.022655 cos_to_last_merge=0.7275 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.728
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962573138630016, 'loss_val': 0.017496394053213484, 'psi': 0.9967646730524864}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963737185993975, 'loss_val': 0.016989883880673323, 'psi': 0.9968112349470447}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.225806 cos_to_last_merge=0.9999 (last merge round=80)
[S10] round=85 local utility u=0.001447 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9938127055673175, 'loss_val': 0.02968707014088071, 'psi': 0.9943742477585504}-{'f1_val': 0.9947486092193725, 'auprc': 0.9932441935574046, 'loss_val': 0.030876243318414393, 'psi': 0.9941468429545853}
[S11] START round=85 head_norm_before_train=1.765514 cos_to_last_merge=0.9068 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9983267339668997, 'loss_val': 0.01892785475566544, 'psi': 0.9971161443569811}-{'f1_val': 0.9963090846170353, 'auprc': 0.9988931366145171, 'loss_val': 0.01864536100742662, 'psi': 0.997342705416028}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.647732 cos_to_last_merge=0.8845 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=85 local utility u=0.562316 metrics={'f1_val': 0.7074128710950411, 'auprc': 0.8527875547238315, 'loss_val': 0.8733432121907767, 'psi': 0.7655627445465574}-{'f1_val': 0.6163516050780566, 'auprc': 0.7771349556768774, 'loss_val': 1.2246495473514014, 'psi': 0.680664945317585}
[S14] START round=85 head_norm_before_train=2.219203 cos_to_last_merge=0.9999 (last merge round=80)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.932722996890846, 'auprc': 0.9946908617709351, 'loss_val': 0.19687189226324323, 'psi': 0.9575101428428817}-{'f1_val': 0.9440384795473431, 'auprc': 0.9971441208031119, 'loss_val': 0.10304817619936137, 'psi': 0.9652807360496507}
[S15] START round=85 head_norm_before_train=1.856068 cos_to_last_merge=0.9305 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9014356094611158, 'auprc': 0.9943698616763718, 'loss_val': 0.2526049745003675, 'psi': 0.9386093103472182}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973201014152924, 'loss_val': 0.020744295547221164, 'psi': 0.9969760415986293}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.243968 (no previous merge yet)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9389034639244547, 'auprc': 0.9815548944585358, 'loss_val': 0.41238383612672713, 'psi': 0.9559640361380871}-{'f1_val': 0.9930225761616748, 'auprc': 0.994455342117978, 'loss_val': 0.034960708378727307, 'psi': 0.9935956825441961}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.230689 (no previous merge yet)
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.684911165643561, 'auprc': 0.8723122823446425, 'loss_val': 1.09816484463125, 'psi': 0.7598716123239937}-{'f1_val': 0.8477690516737024, 'auprc': 0.9772171533723069, 'loss_val': 0.61213459171099, 'psi': 0.8995482923531442}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=85 metric=0.9327 head_norm=2.224743
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.902325e-02
[S14] stored merged vector for next round verification (round=85)
[S14] DEBUG after merge:  round=85 metric=0.9327 head_norm=2.225193 delta_norm=0.019023
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.007 → S10@127.0.0.1:63211
[S6] ⇄ pheromone p=0.289 → S13@127.0.0.1:63213
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1196
[S6] DROPPED delta from S13 (cos=-0.1196 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0036
[S8] DROPPED delta from S2 (cos=-0.0036 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=-0.0036
[S2] DROPPED delta from S8 (cos=-0.0036 < 0.0)
[S2] ⇄ pheromone p=0.050 → S8@127.0.0.1:63209
[S10] ⇄ pheromone p=0.018 → S14@127.0.0.1:63214
[S13] ⇄ pheromone p=0.190 → S6@127.0.0.1:63207
[S8] ⇄ pheromone p=0.034 → S2@127.0.0.1:63202
[S2] START round=86 head_norm_before_train=2.066744 cos_to_last_merge=0.9240 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=86 local utility u=0.168693 metrics={'f1_val': 0.6827145418767304, 'auprc': 0.7303317225545545, 'loss_val': 1.2952988581679066, 'psi': 0.7017614141478601}-{'f1_val': 0.6621459369998466, 'auprc': 0.7297596575888315, 'loss_val': 1.507556909573632, 'psi': 0.6891914252354405}
[S3] START round=86 head_norm_before_train=1.812210 cos_to_last_merge=0.8582 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.858
[S3] round=86 local utility u=0.004785 metrics={'f1_val': 0.993079262725192, 'auprc': 0.9991070043261738, 'loss_val': 0.03696423175281863, 'psi': 0.9954903593655848}-{'f1_val': 0.9916120361929777, 'auprc': 0.9991438689353933, 'loss_val': 0.03784099949675815, 'psi': 0.9946247692899439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[S4] START round=86 head_norm_before_train=1.713482 cos_to_last_merge=0.9137 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=86 local utility u=0.081792 metrics={'f1_val': 0.9472810569274356, 'auprc': 0.9739018974732242, 'loss_val': 0.3130630365870238, 'psi': 0.9579293931457511}-{'f1_val': 0.9400042275608214, 'auprc': 0.940361686421948, 'loss_val': 0.33236466701208955, 'psi': 0.940147211105272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=86 head_norm_before_train=1.996507 cos_to_last_merge=0.9387 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9903057822560525, 'loss_val': 0.03095386732073075, 'psi': 0.9935708225060946}-{'f1_val': 0.9957475160061228, 'auprc': 0.9948872177785814, 'loss_val': 0.02870982672300145, 'psi': 0.9954033967151062}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.139974 (no previous merge yet)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.760093055555448, 'auprc': 0.8832489105701032, 'loss_val': 0.6513140394325366, 'psi': 0.8093553975613101}-{'f1_val': 0.7915728310797141, 'auprc': 0.9246976277991732, 'loss_val': 0.7126933332312436, 'psi': 0.8448227497674977}
[S7] START round=86 head_norm_before_train=1.591767 cos_to_last_merge=0.9427 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=86 local utility u=0.278596 metrics={'f1_val': 0.6701963829795411, 'auprc': 0.8136313469636822, 'loss_val': 0.4173433641253807, 'psi': 0.7275703685731976}-{'f1_val': 0.6262857035976427, 'auprc': 0.7927330031958191, 'loss_val': 0.6483763061137912, 'psi': 0.6928646234369132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=86 head_norm_before_train=2.265413 (no previous merge yet)
[S8] round=86 local utility u=0.015160 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9990662367347648, 'loss_val': 0.02736118880988481, 'psi': 0.9959397640622927}-{'f1_val': 0.9896716780486329, 'auprc': 0.9990317102609997, 'loss_val': 0.032475703388071264, 'psi': 0.9934156909335796}
[S9] START round=86 head_norm_before_train=2.025053 cos_to_last_merge=0.7274 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9991541850775816, 'loss_val': 0.02933418382503679, 'psi': 0.9944142729551773}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962573138630016, 'loss_val': 0.017496394053213484, 'psi': 0.9967646730524864}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.229254 cos_to_last_merge=0.9999 (last merge round=80)
[S10] round=86 local utility u=0.001462 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9946837097758358, 'loss_val': 0.02937508288785542, 'psi': 0.9947226494419579}-{'f1_val': 0.9947486092193725, 'auprc': 0.9938127055673175, 'loss_val': 0.02968707014088071, 'psi': 0.9943742477585504}
[S11] START round=86 head_norm_before_train=1.771146 cos_to_last_merge=0.9063 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=86 local utility u=0.000911 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987781160778784, 'loss_val': 0.0184608259228717, 'psi': 0.9972966972013726}-{'f1_val': 0.9963090846170353, 'auprc': 0.9983267339668997, 'loss_val': 0.01892785475566544, 'psi': 0.9971161443569811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=86 head_norm_before_train=1.653833 cos_to_last_merge=0.8838 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6013876156059326, 'auprc': 0.810944518926034, 'loss_val': 1.1967110064890383, 'psi': 0.6852103769339731}-{'f1_val': 0.7074128710950411, 'auprc': 0.8527875547238315, 'loss_val': 0.8733432121907767, 'psi': 0.7655627445465574}
[S14] START round=86 head_norm_before_train=2.225193 cos_to_last_merge=1.0000 (last merge round=85)
[S14] round=86 local utility u=0.198446 metrics={'f1_val': 0.9728783280721126, 'auprc': 0.9980890810200574, 'loss_val': 0.05110679214389647, 'psi': 0.9829626292512905}-{'f1_val': 0.932722996890846, 'auprc': 0.9946908617709351, 'loss_val': 0.19687189226324323, 'psi': 0.9575101428428817}
[S15] START round=86 head_norm_before_train=1.860542 cos_to_last_merge=0.9302 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.7742117326151426, 'auprc': 0.8685927621326551, 'loss_val': 0.5090398276243949, 'psi': 0.8119641444221477}-{'f1_val': 0.9014356094611158, 'auprc': 0.9943698616763718, 'loss_val': 0.2526049745003675, 'psi': 0.9386093103472182}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.249023 (no previous merge yet)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9367800876467862, 'auprc': 0.9827989445400174, 'loss_val': 0.43134141103174206, 'psi': 0.9551876304040787}-{'f1_val': 0.9389034639244547, 'auprc': 0.9815548944585358, 'loss_val': 0.41238383612672713, 'psi': 0.9559640361380871}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.237358 (no previous merge yet)
[S17] round=86 local utility u=0.580548 metrics={'f1_val': 0.7972060079198038, 'auprc': 0.9135321669250875, 'loss_val': 0.7344970516082069, 'psi': 0.8437364715219173}-{'f1_val': 0.684911165643561, 'auprc': 0.8723122823446425, 'loss_val': 1.09816484463125, 'psi': 0.7598716123239937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0036
[S8] DROPPED delta from S2 (cos=-0.0036 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1790) from S8
[S2] cosine check vs S8: cos=-0.0036
[S2] DROPPED delta from S8 (cos=-0.0036 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=86 metric=0.9947 head_norm=2.231126
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.553174e-02
[S10] stored merged vector for next round verification (round=86)
[S10] DEBUG after merge:  round=86 metric=0.9947 head_norm=2.230325 delta_norm=0.015532
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=86 metric=0.9729 head_norm=2.229632
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.394830e-02
[S14] stored merged vector for next round verification (round=86)
[S14] DEBUG after merge:  round=86 metric=0.9729 head_norm=2.229863 delta_norm=0.013948
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.073529 cos_to_last_merge=0.9234 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=87 local utility u=0.104442 metrics={'f1_val': 0.7112349294381405, 'auprc': 0.7279155289416208, 'loss_val': 1.250289372287086, 'psi': 0.7179071692395327}-{'f1_val': 0.6827145418767304, 'auprc': 0.7303317225545545, 'loss_val': 1.2952988581679066, 'psi': 0.7017614141478601}
[S3] START round=87 head_norm_before_train=1.816156 cos_to_last_merge=0.8578 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.858
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.8412352015800292, 'auprc': 0.9501881705705384, 'loss_val': 0.3653512040152235, 'psi': 0.8848163891762328}-{'f1_val': 0.993079262725192, 'auprc': 0.9991070043261738, 'loss_val': 0.03696423175281863, 'psi': 0.9954903593655848}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.715573 cos_to_last_merge=0.9134 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=87 local utility u=0.002601 metrics={'f1_val': 0.9513295013856087, 'auprc': 0.9678075114689568, 'loss_val': 0.31386865032832156, 'psi': 0.9579207054189479}-{'f1_val': 0.9472810569274356, 'auprc': 0.9739018974732242, 'loss_val': 0.3130630365870238, 'psi': 0.9579293931457511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=87 head_norm_before_train=1.999707 cos_to_last_merge=0.9383 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=87 local utility u=0.009018 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9961644411611239, 'loss_val': 0.0313678207130368, 'psi': 0.9960017707356532}-{'f1_val': 0.9957475160061228, 'auprc': 0.9903057822560525, 'loss_val': 0.03095386732073075, 'psi': 0.9935708225060946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=87 head_norm_before_train=2.150168 (no previous merge yet)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.6467687403820771, 'auprc': 0.8434242633904867, 'loss_val': 0.9918171062496177, 'psi': 0.725430949585441}-{'f1_val': 0.760093055555448, 'auprc': 0.8832489105701032, 'loss_val': 0.6513140394325366, 'psi': 0.8093553975613101}
[S7] START round=87 head_norm_before_train=1.596232 cos_to_last_merge=0.9420 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.5984050789189808, 'auprc': 0.782917948563583, 'loss_val': 0.7458215263369903, 'psi': 0.6722102267768216}-{'f1_val': 0.6701963829795411, 'auprc': 0.8136313469636822, 'loss_val': 0.4173433641253807, 'psi': 0.7275703685731976}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.274291 (no previous merge yet)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9989769219565783, 'loss_val': 0.02772797688500701, 'psi': 0.995904038151018}-{'f1_val': 0.9938554489473111, 'auprc': 0.9990662367347648, 'loss_val': 0.02736118880988481, 'psi': 0.9959397640622927}
[S9] START round=87 head_norm_before_train=2.027967 cos_to_last_merge=0.7274 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=87 local utility u=0.010334 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9991299704557245, 'loss_val': 0.024704619703640504, 'psi': 0.9960156157806981}-{'f1_val': 0.991254331540241, 'auprc': 0.9991541850775816, 'loss_val': 0.02933418382503679, 'psi': 0.9944142729551773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=87 head_norm_before_train=2.230325 cos_to_last_merge=1.0000 (last merge round=86)
[S10] round=87 local utility u=0.000671 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9950680455513568, 'loss_val': 0.029186834420660696, 'psi': 0.9948763837521661}-{'f1_val': 0.9947486092193725, 'auprc': 0.9946837097758358, 'loss_val': 0.02937508288785542, 'psi': 0.9947226494419579}
[S11] START round=87 head_norm_before_train=1.777023 cos_to_last_merge=0.9057 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.991648388588299, 'auprc': 0.9993506450693507, 'loss_val': 0.0385599071598953, 'psi': 0.9947292911807196}-{'f1_val': 0.9963090846170353, 'auprc': 0.9987781160778784, 'loss_val': 0.0184608259228717, 'psi': 0.9972966972013726}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.659050 cos_to_last_merge=0.8834 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=87 local utility u=0.299698 metrics={'f1_val': 0.6450723439631492, 'auprc': 0.8148470872708491, 'loss_val': 0.8711308465561761, 'psi': 0.7129822412862291}-{'f1_val': 0.6013876156059326, 'auprc': 0.810944518926034, 'loss_val': 1.1967110064890383, 'psi': 0.6852103769339731}
[S14] START round=87 head_norm_before_train=2.229863 cos_to_last_merge=1.0000 (last merge round=86)
[S14] round=87 local utility u=0.092002 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9986568885005068, 'loss_val': 0.017311081061458223, 'psi': 0.9980402212371391}-{'f1_val': 0.9728783280721126, 'auprc': 0.9980890810200574, 'loss_val': 0.05110679214389647, 'psi': 0.9829626292512905}
[S15] START round=87 head_norm_before_train=1.865731 cos_to_last_merge=0.9297 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=87 local utility u=0.351503 metrics={'f1_val': 0.824355107501532, 'auprc': 0.9640830618875421, 'loss_val': 0.39336511451252515, 'psi': 0.880246289255936}-{'f1_val': 0.7742117326151426, 'auprc': 0.8685927621326551, 'loss_val': 0.5090398276243949, 'psi': 0.8119641444221477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=87 head_norm_before_train=2.252136 (no previous merge yet)
[S16] round=87 local utility u=0.376543 metrics={'f1_val': 0.9921038158683511, 'auprc': 0.9930763884000137, 'loss_val': 0.04103102779759299, 'psi': 0.9924928448810161}-{'f1_val': 0.9367800876467862, 'auprc': 0.9827989445400174, 'loss_val': 0.43134141103174206, 'psi': 0.9551876304040787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=87 head_norm_before_train=2.245888 (no previous merge yet)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.6281935779402804, 'auprc': 0.8761480678836706, 'loss_val': 1.285174972712434, 'psi': 0.7273753739176365}-{'f1_val': 0.7972060079198038, 'auprc': 0.9135321669250875, 'loss_val': 0.7344970516082069, 'psi': 0.8437364715219173}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1793) from S14
[S10] cosine check vs S14: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0041
[S8] DROPPED delta from S2 (cos=-0.0041 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S13
[S6] cosine check vs S13: cos=-0.1195
[S6] DROPPED delta from S13 (cos=-0.1195 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=87 metric=0.9947 head_norm=2.232845
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.889706e-03
[S10] stored merged vector for next round verification (round=87)
[S10] DEBUG after merge:  round=87 metric=0.9947 head_norm=2.233939 delta_norm=0.006890
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=87 metric=0.9976 head_norm=2.235053
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.889713e-03
[S14] stored merged vector for next round verification (round=87)
[S14] DEBUG after merge:  round=87 metric=0.9976 head_norm=2.233939 delta_norm=0.006890
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.081077 cos_to_last_merge=0.9227 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.707886689306608, 'auprc': 0.7290152410671276, 'loss_val': 1.3154044983074253, 'psi': 0.7163381100108158}-{'f1_val': 0.7112349294381405, 'auprc': 0.7279155289416208, 'loss_val': 1.250289372287086, 'psi': 0.7179071692395327}
[S3] START round=88 head_norm_before_train=1.819851 cos_to_last_merge=0.8575 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.857
[S3] round=88 local utility u=0.646956 metrics={'f1_val': 0.9798397892170636, 'auprc': 0.999137620115614, 'loss_val': 0.049915433563037105, 'psi': 0.9875589215764837}-{'f1_val': 0.8412352015800292, 'auprc': 0.9501881705705384, 'loss_val': 0.3653512040152235, 'psi': 0.8848163891762328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] sending update (kind=head size=1809 to 1 peers)
[S4] START round=88 head_norm_before_train=1.717843 cos_to_last_merge=0.9131 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=88 local utility u=0.015281 metrics={'f1_val': 0.9545198809061542, 'auprc': 0.9710451112312535, 'loss_val': 0.312161565341359, 'psi': 0.961129973036194}-{'f1_val': 0.9513295013856087, 'auprc': 0.9678075114689568, 'loss_val': 0.31386865032832156, 'psi': 0.9579207054189479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=88 head_norm_before_train=2.003296 cos_to_last_merge=0.9379 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.993464183399781, 'loss_val': 0.032011266570459385, 'psi': 0.9949216676311161}-{'f1_val': 0.9958933237853395, 'auprc': 0.9961644411611239, 'loss_val': 0.0313678207130368, 'psi': 0.9960017707356532}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.154492 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.5709925399113944, 'auprc': 0.6485999956725917, 'loss_val': 1.5371187119185237, 'psi': 0.6020355222158733}-{'f1_val': 0.6467687403820771, 'auprc': 0.8434242633904867, 'loss_val': 0.9918171062496177, 'psi': 0.725430949585441}
[S7] START round=88 head_norm_before_train=1.599525 cos_to_last_merge=0.9417 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=88 local utility u=0.153516 metrics={'f1_val': 0.6176649743137599, 'auprc': 0.7939355929294503, 'loss_val': 0.5874025427195003, 'psi': 0.688173221760036}-{'f1_val': 0.5984050789189808, 'auprc': 0.782917948563583, 'loss_val': 0.7458215263369903, 'psi': 0.6722102267768216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=88 head_norm_before_train=2.277721 (no previous merge yet)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9990474615573051, 'loss_val': 0.029410717890317028, 'psi': 0.9950543409106005}-{'f1_val': 0.9938554489473111, 'auprc': 0.9989769219565783, 'loss_val': 0.02772797688500701, 'psi': 0.995904038151018}
[S9] START round=88 head_norm_before_train=2.032367 cos_to_last_merge=0.7272 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=88 local utility u=0.008244 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959749508850448, 'loss_val': 0.017732338224346895, 'psi': 0.9966517278613036}-{'f1_val': 0.9939393793306803, 'auprc': 0.9991299704557245, 'loss_val': 0.024704619703640504, 'psi': 0.9960156157806981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=88 head_norm_before_train=2.233939 cos_to_last_merge=1.0000 (last merge round=87)
[S10] round=88 local utility u=0.000168 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995187089063269, 'loss_val': 0.029208145097802122, 'psi': 0.9949240011569311}-{'f1_val': 0.9947486092193725, 'auprc': 0.9950680455513568, 'loss_val': 0.029186834420660696, 'psi': 0.9948763837521661}
[S11] START round=88 head_norm_before_train=1.782546 cos_to_last_merge=0.9053 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=88 local utility u=0.025072 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987694273744623, 'loss_val': 0.01711639307432193, 'psi': 0.9975412226986942}-{'f1_val': 0.991648388588299, 'auprc': 0.9993506450693507, 'loss_val': 0.0385599071598953, 'psi': 0.9947292911807196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=88 head_norm_before_train=1.662796 cos_to_last_merge=0.8829 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=88 local utility u=0.257854 metrics={'f1_val': 0.6952599215143898, 'auprc': 0.8210086353914015, 'loss_val': 0.6750333474224913, 'psi': 0.7455594070651944}-{'f1_val': 0.6450723439631492, 'auprc': 0.8148470872708491, 'loss_val': 0.8711308465561761, 'psi': 0.7129822412862291}
[S14] START round=88 head_norm_before_train=2.233939 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9986511315594523, 'loss_val': 0.018121589470564723, 'psi': 0.9978922096125298}-{'f1_val': 0.9976291097282272, 'auprc': 0.9986568885005068, 'loss_val': 0.017311081061458223, 'psi': 0.9980402212371391}
[S15] START round=88 head_norm_before_train=1.871522 cos_to_last_merge=0.9292 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=88 local utility u=0.715684 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.997210730959483, 'loss_val': 0.03266626140185208, 'psi': 0.9906258771130476}-{'f1_val': 0.824355107501532, 'auprc': 0.9640830618875421, 'loss_val': 0.39336511451252515, 'psi': 0.880246289255936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=88 head_norm_before_train=2.256079 (no previous merge yet)
[S16] round=88 local utility u=0.001590 metrics={'f1_val': 0.9923121867931906, 'auprc': 0.9931599194888902, 'loss_val': 0.039351707874912024, 'psi': 0.9926512798714704}-{'f1_val': 0.9921038158683511, 'auprc': 0.9930763884000137, 'loss_val': 0.04103102779759299, 'psi': 0.9924928448810161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=88 head_norm_before_train=2.253421 (no previous merge yet)
[S17] round=88 local utility u=1.000000 metrics={'f1_val': 0.913272654610252, 'auprc': 0.9984773070404038, 'loss_val': 0.34202323260924933, 'psi': 0.9473545155823127}-{'f1_val': 0.6281935779402804, 'auprc': 0.8761480678836706, 'loss_val': 1.285174972712434, 'psi': 0.7273753739176365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1193
[S6] DROPPED delta from S13 (cos=-0.1193 < 0.0)
[S2] START round=89 head_norm_before_train=2.088667 cos_to_last_merge=0.9219 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7079619921234236, 'auprc': 0.7263110956393762, 'loss_val': 1.3194836581567215, 'psi': 0.7153016335298047}-{'f1_val': 0.707886689306608, 'auprc': 0.7290152410671276, 'loss_val': 1.3154044983074253, 'psi': 0.7163381100108158}
[S3] START round=89 head_norm_before_train=1.823224 cos_to_last_merge=0.8571 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.857
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9776094809532907, 'auprc': 0.9961007092015575, 'loss_val': 0.07228092554466196, 'psi': 0.9850059722525975}-{'f1_val': 0.9798397892170636, 'auprc': 0.999137620115614, 'loss_val': 0.049915433563037105, 'psi': 0.9875589215764837}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.718485 cos_to_last_merge=0.9125 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.939606038814967, 'auprc': 0.9512698636647463, 'loss_val': 0.3349430607290528, 'psi': 0.9442715687548786}-{'f1_val': 0.9545198809061542, 'auprc': 0.9710451112312535, 'loss_val': 0.312161565341359, 'psi': 0.961129973036194}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.004820 cos_to_last_merge=0.9371 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.990373627305952, 'loss_val': 0.030322350687832577, 'psi': 0.9935979605260545}-{'f1_val': 0.9958933237853395, 'auprc': 0.993464183399781, 'loss_val': 0.032011266570459385, 'psi': 0.9949216676311161}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.156752 (no previous merge yet)
[S6] round=89 local utility u=1.000000 metrics={'f1_val': 0.8158272906282068, 'auprc': 0.9439478924405147, 'loss_val': 0.47220744409901744, 'psi': 0.86707553135313}-{'f1_val': 0.5709925399113944, 'auprc': 0.6485999956725917, 'loss_val': 1.5371187119185237, 'psi': 0.6020355222158733}
[S7] START round=89 head_norm_before_train=1.602709 cos_to_last_merge=0.9411 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5855811287342513, 'auprc': 0.7823855271703017, 'loss_val': 0.7879910860459857, 'psi': 0.6643028881086714}-{'f1_val': 0.6176649743137599, 'auprc': 0.7939355929294503, 'loss_val': 0.5874025427195003, 'psi': 0.688173221760036}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.278506 (no previous merge yet)
[S8] round=89 local utility u=0.007172 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9992697242814608, 'loss_val': 0.025980685185276808, 'psi': 0.9961678979266633}-{'f1_val': 0.992392260479464, 'auprc': 0.9990474615573051, 'loss_val': 0.029410717890317028, 'psi': 0.9950543409106005}
[S9] START round=89 head_norm_before_train=2.035529 cos_to_last_merge=0.7269 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9952255418989198, 'loss_val': 0.018339876958415234, 'psi': 0.9961057115184252}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959749508850448, 'loss_val': 0.017732338224346895, 'psi': 0.9966517278613036}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.238069 cos_to_last_merge=1.0000 (last merge round=87)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9950674096408876, 'loss_val': 0.029381307565433185, 'psi': 0.9948761293879785}-{'f1_val': 0.9947486092193725, 'auprc': 0.995187089063269, 'loss_val': 0.029208145097802122, 'psi': 0.9949240011569311}
[S11] START round=89 head_norm_before_train=1.786851 cos_to_last_merge=0.9049 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9979787588438385, 'loss_val': 0.0190734216912533, 'psi': 0.9969769543077566}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987694273744623, 'loss_val': 0.01711639307432193, 'psi': 0.9975412226986942}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.666934 cos_to_last_merge=0.8825 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6315007403092121, 'auprc': 0.7674822021714456, 'loss_val': 1.0181212513061566, 'psi': 0.6858933250541055}-{'f1_val': 0.6952599215143898, 'auprc': 0.8210086353914015, 'loss_val': 0.6750333474224913, 'psi': 0.7455594070651944}
[S14] START round=89 head_norm_before_train=2.239969 cos_to_last_merge=1.0000 (last merge round=87)
[S14] round=89 local utility u=0.000132 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.998622480011785, 'loss_val': 0.01777247295766382, 'psi': 0.9978807489934629}-{'f1_val': 0.9973862616479148, 'auprc': 0.9986511315594523, 'loss_val': 0.018121589470564723, 'psi': 0.9978922096125298}
[S15] START round=89 head_norm_before_train=1.877348 cos_to_last_merge=0.9287 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=89 local utility u=0.028210 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9914273883291338, 'loss_val': 0.02196067936609518, 'psi': 0.9946189563641659}-{'f1_val': 0.9862359745487574, 'auprc': 0.997210730959483, 'loss_val': 0.03266626140185208, 'psi': 0.9906258771130476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=89 head_norm_before_train=2.258538 (no previous merge yet)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9923121867931906, 'auprc': 0.9931464134683917, 'loss_val': 0.03984401478010767, 'psi': 0.992645877463271}-{'f1_val': 0.9923121867931906, 'auprc': 0.9931599194888902, 'loss_val': 0.039351707874912024, 'psi': 0.9926512798714704}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.259934 (no previous merge yet)
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.9124236483216266, 'auprc': 0.998911401284042, 'loss_val': 0.3613249339157984, 'psi': 0.9470187495065927}-{'f1_val': 0.913272654610252, 'auprc': 0.9984773070404038, 'loss_val': 0.34202323260924933, 'psi': 0.9473545155823127}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:63211
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=-0.0037
[S2] DROPPED delta from S8 (cos=-0.0037 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] cosine check vs S6: cos=-0.1190
[S13] DROPPED delta from S6 (cos=-0.1190 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=89 metric=0.9974 head_norm=2.243721
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.656588e-03
[S14] stored merged vector for next round verification (round=89)
[S14] DEBUG after merge:  round=89 metric=0.9974 head_norm=2.240887 delta_norm=0.006657
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=2.093497 cos_to_last_merge=0.9217 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=90 local utility u=0.023006 metrics={'f1_val': 0.7100208579529355, 'auprc': 0.7270486953240437, 'loss_val': 1.2880379015062429, 'psi': 0.7168319929013788}-{'f1_val': 0.7079619921234236, 'auprc': 0.7263110956393762, 'loss_val': 1.3194836581567215, 'psi': 0.7153016335298047}
[S3] START round=90 head_norm_before_train=1.827370 cos_to_last_merge=0.8567 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.857
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.7010314215887568, 'auprc': 0.8985837407884303, 'loss_val': 0.6542667402685076, 'psi': 0.7800523492686262}-{'f1_val': 0.9776094809532907, 'auprc': 0.9961007092015575, 'loss_val': 0.07228092554466196, 'psi': 0.9850059722525975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.721030 cos_to_last_merge=0.9118 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.6335869359262254, 'auprc': 0.9342560093773, 'loss_val': 0.6947842962896653, 'psi': 0.7538545653066553}-{'f1_val': 0.939606038814967, 'auprc': 0.9512698636647463, 'loss_val': 0.3349430607290528, 'psi': 0.9442715687548786}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=2.011232 cos_to_last_merge=0.9364 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=90 local utility u=0.007714 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9946615180607494, 'loss_val': 0.028633758224702682, 'psi': 0.9954006014955035}-{'f1_val': 0.9957475160061228, 'auprc': 0.990373627305952, 'loss_val': 0.030322350687832577, 'psi': 0.9935979605260545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=90 head_norm_before_train=2.160432 (no previous merge yet)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7825498606850291, 'auprc': 0.9515077863779247, 'loss_val': 0.50880683448002, 'psi': 0.8501330309621873}-{'f1_val': 0.8158272906282068, 'auprc': 0.9439478924405147, 'loss_val': 0.47220744409901744, 'psi': 0.86707553135313}
[S7] START round=90 head_norm_before_train=1.608281 cos_to_last_merge=0.9400 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=90 local utility u=0.238844 metrics={'f1_val': 0.617703614325313, 'auprc': 0.7996001032176577, 'loss_val': 0.55468242010919, 'psi': 0.6904622098822508}-{'f1_val': 0.5855811287342513, 'auprc': 0.7823855271703017, 'loss_val': 0.7879910860459857, 'psi': 0.6643028881086714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=90 head_norm_before_train=2.278718 (no previous merge yet)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9993135010679736, 'loss_val': 0.02723964298831954, 'psi': 0.9957457866915986}-{'f1_val': 0.9941000136901317, 'auprc': 0.9992697242814608, 'loss_val': 0.025980685185276808, 'psi': 0.9961678979266633}
[S9] START round=90 head_norm_before_train=2.037035 cos_to_last_merge=0.7270 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=90 local utility u=0.004711 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9976840452896905, 'loss_val': 0.01725319549014241, 'psi': 0.9971851693712306}-{'f1_val': 0.9966924912647621, 'auprc': 0.9952255418989198, 'loss_val': 0.018339876958415234, 'psi': 0.9961057115184252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=90 head_norm_before_train=2.243023 cos_to_last_merge=1.0000 (last merge round=87)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945361312899639, 'loss_val': 0.02997007732762235, 'psi': 0.994663618047609}-{'f1_val': 0.9947486092193725, 'auprc': 0.9950674096408876, 'loss_val': 0.029381307565433185, 'psi': 0.9948761293879785}
[S11] START round=90 head_norm_before_train=1.791675 cos_to_last_merge=0.9044 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=90 local utility u=0.003444 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987182864574136, 'loss_val': 0.01688358802770315, 'psi': 0.9975207663318746}-{'f1_val': 0.9963090846170353, 'auprc': 0.9979787588438385, 'loss_val': 0.0190734216912533, 'psi': 0.9969769543077566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=90 head_norm_before_train=1.672066 cos_to_last_merge=0.8821 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=90 local utility u=0.374541 metrics={'f1_val': 0.7223622257887471, 'auprc': 0.7989594205229936, 'loss_val': 0.9086401368348983, 'psi': 0.7530011036824458}-{'f1_val': 0.6315007403092121, 'auprc': 0.7674822021714456, 'loss_val': 1.0181212513061566, 'psi': 0.6858933250541055}
[S14] START round=90 head_norm_before_train=2.240887 cos_to_last_merge=1.0000 (last merge round=89)
[S14] round=90 local utility u=0.000245 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9986083597903445, 'loss_val': 0.017257516242741917, 'psi': 0.9978768190418761}-{'f1_val': 0.9973862616479148, 'auprc': 0.998622480011785, 'loss_val': 0.01777247295766382, 'psi': 0.9978807489934629}
[S15] START round=90 head_norm_before_train=1.883325 cos_to_last_merge=0.9283 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9016191743390298, 'auprc': 0.9925981674760226, 'loss_val': 0.23214104511786454, 'psi': 0.938010771593827}-{'f1_val': 0.9967466683875206, 'auprc': 0.9914273883291338, 'loss_val': 0.02196067936609518, 'psi': 0.9946189563641659}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.263172 (no previous merge yet)
[S16] round=90 local utility u=0.000032 metrics={'f1_val': 0.9924624549696315, 'auprc': 0.9929859446072717, 'loss_val': 0.04019952862811425, 'psi': 0.9926718508246877}-{'f1_val': 0.9923121867931906, 'auprc': 0.9931464134683917, 'loss_val': 0.03984401478010767, 'psi': 0.992645877463271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=90 head_norm_before_train=2.265967 (no previous merge yet)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.7384255514492906, 'auprc': 0.9824207073460536, 'loss_val': 0.9400954026265387, 'psi': 0.8360236138079957}-{'f1_val': 0.9124236483216266, 'auprc': 0.998911401284042, 'loss_val': 0.3613249339157984, 'psi': 0.9470187495065927}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:63207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:63211
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=90 metric=0.9947 head_norm=2.248427
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.711736e-03
[S10] stored merged vector for next round verification (round=90)
[S10] DEBUG after merge:  round=90 metric=0.9947 head_norm=2.246058 delta_norm=0.008712
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.006 → S14@127.0.0.1:63214
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.014 → S2@127.0.0.1:63202
[S6] ⇄ pheromone p=0.255 → S13@127.0.0.1:63213
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S14
[S10] cosine check vs S14: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0035
[S8] DROPPED delta from S2 (cos=-0.0035 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S13
[S6] cosine check vs S13: cos=-0.1188
[S6] DROPPED delta from S13 (cos=-0.1188 < 0.0)
[S2] ⇄ pheromone p=0.045 → S8@127.0.0.1:63209
[S13] ⇄ pheromone p=0.201 → S6@127.0.0.1:63207
[S14] ⇄ pheromone p=0.028 → S10@127.0.0.1:63211
[S2] START round=91 head_norm_before_train=2.098825 cos_to_last_merge=0.9213 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=91 local utility u=0.047476 metrics={'f1_val': 0.7137811212810672, 'auprc': 0.7284694128850021, 'loss_val': 1.2199095443922234, 'psi': 0.7196564379226411}-{'f1_val': 0.7100208579529355, 'auprc': 0.7270486953240437, 'loss_val': 1.2880379015062429, 'psi': 0.7168319929013788}
[S3] START round=91 head_norm_before_train=1.831778 cos_to_last_merge=0.8562 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.856
[S3] round=91 local utility u=0.954061 metrics={'f1_val': 0.8908894546783144, 'auprc': 0.99755440964592, 'loss_val': 0.18220422144647075, 'psi': 0.9335554366653567}-{'f1_val': 0.7010314215887568, 'auprc': 0.8985837407884303, 'loss_val': 0.6542667402685076, 'psi': 0.7800523492686262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=91 head_norm_before_train=1.724638 cos_to_last_merge=0.9115 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=91 local utility u=1.000000 metrics={'f1_val': 0.9400021376380653, 'auprc': 0.948980707206396, 'loss_val': 0.3353818828030014, 'psi': 0.9435935654653975}-{'f1_val': 0.6335869359262254, 'auprc': 0.9342560093773, 'loss_val': 0.6947842962896653, 'psi': 0.7538545653066553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=91 head_norm_before_train=2.018713 cos_to_last_merge=0.9358 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=91 local utility u=0.003818 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9969926184187357, 'loss_val': 0.027991800855581547, 'psi': 0.996333041638698}-{'f1_val': 0.9958933237853395, 'auprc': 0.9946615180607494, 'loss_val': 0.028633758224702682, 'psi': 0.9954006014955035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=91 head_norm_before_train=2.165663 (no previous merge yet)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6239114646361167, 'auprc': 0.8909003906934452, 'loss_val': 1.0705857758183441, 'psi': 0.7307070350590481}-{'f1_val': 0.7825498606850291, 'auprc': 0.9515077863779247, 'loss_val': 0.50880683448002, 'psi': 0.8501330309621873}
[S7] START round=91 head_norm_before_train=1.614525 cos_to_last_merge=0.9390 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.5792154375735913, 'auprc': 0.7823121521447098, 'loss_val': 0.7885087890306327, 'psi': 0.6604541234020387}-{'f1_val': 0.617703614325313, 'auprc': 0.7996001032176577, 'loss_val': 0.55468242010919, 'psi': 0.6904622098822508}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.282818 (no previous merge yet)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9722277198565958, 'auprc': 0.9990043549358743, 'loss_val': 0.0690243652606019, 'psi': 0.9829383738883072}-{'f1_val': 0.9933673104406822, 'auprc': 0.9993135010679736, 'loss_val': 0.02723964298831954, 'psi': 0.9957457866915986}
[S9] START round=91 head_norm_before_train=2.040530 cos_to_last_merge=0.7270 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.978968186336951, 'auprc': 0.9916095777523316, 'loss_val': 0.08104186466350193, 'psi': 0.9840247429031033}-{'f1_val': 0.9968525854255906, 'auprc': 0.9976840452896905, 'loss_val': 0.01725319549014241, 'psi': 0.9971851693712306}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.246058 cos_to_last_merge=1.0000 (last merge round=90)
[S10] round=91 local utility u=0.000063 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945572699482507, 'loss_val': 0.029907394903327895, 'psi': 0.9946720735109238}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945361312899639, 'loss_val': 0.02997007732762235, 'psi': 0.994663618047609}
[S11] START round=91 head_norm_before_train=1.796606 cos_to_last_merge=0.9039 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9923637684229022, 'auprc': 0.999210401667415, 'loss_val': 0.030155885994225643, 'psi': 0.9951024217207074}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987182864574136, 'loss_val': 0.01688358802770315, 'psi': 0.9975207663318746}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.677570 cos_to_last_merge=0.8816 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6143502458050596, 'auprc': 0.6529444510596103, 'loss_val': 1.3106378709226056, 'psi': 0.6297879279068799}-{'f1_val': 0.7223622257887471, 'auprc': 0.7989594205229936, 'loss_val': 0.9086401368348983, 'psi': 0.7530011036824458}
[S14] START round=91 head_norm_before_train=2.246794 cos_to_last_merge=1.0000 (last merge round=89)
[S14] round=91 local utility u=0.000777 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9989362789725406, 'loss_val': 0.016687112331142753, 'psi': 0.9980079867147545}-{'f1_val': 0.9973891252095638, 'auprc': 0.9986083597903445, 'loss_val': 0.017257516242741917, 'psi': 0.9978768190418761}
[S15] START round=91 head_norm_before_train=1.889064 cos_to_last_merge=0.9278 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.8838506131832098, 'auprc': 0.9920199962936306, 'loss_val': 0.3252104283378425, 'psi': 0.9271183664273781}-{'f1_val': 0.9016191743390298, 'auprc': 0.9925981674760226, 'loss_val': 0.23214104511786454, 'psi': 0.938010771593827}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.268963 (no previous merge yet)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9922921272282386, 'auprc': 0.992527418500313, 'loss_val': 0.03966145437232731, 'psi': 0.9923862437370683}-{'f1_val': 0.9924624549696315, 'auprc': 0.9929859446072717, 'loss_val': 0.04019952862811425, 'psi': 0.9926718508246877}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.271065 (no previous merge yet)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.7243246189172087, 'auprc': 0.9673643618807631, 'loss_val': 1.0049400808477214, 'psi': 0.8215405161026305}-{'f1_val': 0.7384255514492906, 'auprc': 0.9824207073460536, 'loss_val': 0.9400954026265387, 'psi': 0.8360236138079957}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63209
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63214
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0030
[S8] DROPPED delta from S2 (cos=-0.0030 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=1.0000
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=91 metric=0.9947 head_norm=2.251635
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.401516e-03
[S10] stored merged vector for next round verification (round=91)
[S10] DEBUG after merge:  round=91 metric=0.9947 head_norm=2.250839 delta_norm=0.006402
[S10] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=91 metric=0.9974 head_norm=2.253333
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.362801e-03
[S14] stored merged vector for next round verification (round=91)
[S14] DEBUG after merge:  round=91 metric=0.9974 head_norm=2.252472 delta_norm=0.007363
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=2.101440 cos_to_last_merge=0.9214 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=92 local utility u=0.006537 metrics={'f1_val': 0.7152758644769993, 'auprc': 0.7279198129646857, 'loss_val': 1.2141547181537327, 'psi': 0.7203334438720739}-{'f1_val': 0.7137811212810672, 'auprc': 0.7284694128850021, 'loss_val': 1.2199095443922234, 'psi': 0.7196564379226411}
[S3] START round=92 head_norm_before_train=1.836125 cos_to_last_merge=0.8557 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.856
[S3] round=92 local utility u=0.393193 metrics={'f1_val': 0.9956877112170308, 'auprc': 0.999052945517819, 'loss_val': 0.029102464827498464, 'psi': 0.9970338049373461}-{'f1_val': 0.8908894546783144, 'auprc': 0.99755440964592, 'loss_val': 0.18220422144647075, 'psi': 0.9335554366653567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=92 head_norm_before_train=1.728817 cos_to_last_merge=0.9108 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=92 local utility u=0.045809 metrics={'f1_val': 0.9436226276060854, 'auprc': 0.9680202635116419, 'loss_val': 0.3226048772276429, 'psi': 0.953381681968308}-{'f1_val': 0.9400021376380653, 'auprc': 0.948980707206396, 'loss_val': 0.3353818828030014, 'psi': 0.9435935654653975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=92 head_norm_before_train=2.025053 cos_to_last_merge=0.9352 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9903624071519663, 'loss_val': 0.03055757118238657, 'psi': 0.9935934724644602}-{'f1_val': 0.9958933237853395, 'auprc': 0.9969926184187357, 'loss_val': 0.027991800855581547, 'psi': 0.996333041638698}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.171628 (no previous merge yet)
[S6] round=92 local utility u=1.000000 metrics={'f1_val': 0.8586293749370847, 'auprc': 0.9540065156958715, 'loss_val': 0.4495619331543612, 'psi': 0.8967802312405995}-{'f1_val': 0.6239114646361167, 'auprc': 0.8909003906934452, 'loss_val': 1.0705857758183441, 'psi': 0.7307070350590481}
[S7] START round=92 head_norm_before_train=1.622109 cos_to_last_merge=0.9378 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=92 local utility u=0.209760 metrics={'f1_val': 0.6163710114851604, 'auprc': 0.7925343478275815, 'loss_val': 0.622589804669358, 'psi': 0.6868363460221287}-{'f1_val': 0.5792154375735913, 'auprc': 0.7823121521447098, 'loss_val': 0.7885087890306327, 'psi': 0.6604541234020387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=92 head_norm_before_train=2.285177 (no previous merge yet)
[S8] round=92 local utility u=0.083827 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9991684230108154, 'loss_val': 0.027232309369019447, 'psi': 0.9955410169938224}-{'f1_val': 0.9722277198565958, 'auprc': 0.9990043549358743, 'loss_val': 0.0690243652606019, 'psi': 0.9829383738883072}
[S9] START round=92 head_norm_before_train=2.045291 cos_to_last_merge=0.7267 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=92 local utility u=0.093533 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962479241841979, 'loss_val': 0.016699407623582577, 'psi': 0.9967609171809648}-{'f1_val': 0.978968186336951, 'auprc': 0.9916095777523316, 'loss_val': 0.08104186466350193, 'psi': 0.9840247429031033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=92 head_norm_before_train=2.250839 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=92 local utility u=0.000601 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9948049517065473, 'loss_val': 0.029448579935283093, 'psi': 0.9947711462142423}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945572699482507, 'loss_val': 0.029907394903327895, 'psi': 0.9946720735109238}
[S11] START round=92 head_norm_before_train=1.801585 cos_to_last_merge=0.9035 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=92 local utility u=0.018710 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987020729760989, 'loss_val': 0.017362397580096566, 'psi': 0.9975142809393488}-{'f1_val': 0.9923637684229022, 'auprc': 0.999210401667415, 'loss_val': 0.030155885994225643, 'psi': 0.9951024217207074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=92 head_norm_before_train=1.682162 cos_to_last_merge=0.8813 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=92 local utility u=0.568751 metrics={'f1_val': 0.6614767859347492, 'auprc': 0.8096556402309287, 'loss_val': 0.9260280770404686, 'psi': 0.720748327653221}-{'f1_val': 0.6143502458050596, 'auprc': 0.6529444510596103, 'loss_val': 1.3106378709226056, 'psi': 0.6297879279068799}
[S14] START round=92 head_norm_before_train=2.252472 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9986425924237166, 'loss_val': 0.01737992158294029, 'psi': 0.9980362209434124}-{'f1_val': 0.9973891252095638, 'auprc': 0.9989362789725406, 'loss_val': 0.016687112331142753, 'psi': 0.9980079867147545}
[S15] START round=92 head_norm_before_train=1.894394 cos_to_last_merge=0.9274 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=92 local utility u=0.162908 metrics={'f1_val': 0.9099274680888554, 'auprc': 0.9961759122113121, 'loss_val': 0.16832388826973813, 'psi': 0.944426845737838}-{'f1_val': 0.8838506131832098, 'auprc': 0.9920199962936306, 'loss_val': 0.3252104283378425, 'psi': 0.9271183664273781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=92 head_norm_before_train=2.268989 (no previous merge yet)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9924726039977416, 'auprc': 0.9907744743835415, 'loss_val': 0.0407693698285839, 'psi': 0.9917933521520617}-{'f1_val': 0.9922921272282386, 'auprc': 0.992527418500313, 'loss_val': 0.03966145437232731, 'psi': 0.9923862437370683}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.274569 (no previous merge yet)
[S17] round=92 local utility u=0.270140 metrics={'f1_val': 0.8035717071438886, 'auprc': 0.9030113180821853, 'loss_val': 0.7470834529391087, 'psi': 0.8433475515192073}-{'f1_val': 0.7243246189172087, 'auprc': 0.9673643618807631, 'loss_val': 1.0049400808477214, 'psi': 0.8215405161026305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0027
[S8] DROPPED delta from S2 (cos=-0.0027 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1802) from S13
[S6] cosine check vs S13: cos=-0.1186
[S6] DROPPED delta from S13 (cos=-0.1186 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=-0.0027
[S2] DROPPED delta from S8 (cos=-0.0027 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S6
[S13] cosine check vs S6: cos=-0.1186
[S13] DROPPED delta from S6 (cos=-0.1186 < 0.0)
[S2] START round=93 head_norm_before_train=2.106236 cos_to_last_merge=0.9211 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=93 local utility u=0.004502 metrics={'f1_val': 0.7165031599295603, 'auprc': 0.7277140994585258, 'loss_val': 1.2118975415535613, 'psi': 0.7209875357411465}-{'f1_val': 0.7152758644769993, 'auprc': 0.7279198129646857, 'loss_val': 1.2141547181537327, 'psi': 0.7203334438720739}
[S3] START round=93 head_norm_before_train=1.840970 cos_to_last_merge=0.8551 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.8725352706209929, 'auprc': 0.9856391803540441, 'loss_val': 0.23767661999007245, 'psi': 0.9177768345142134}-{'f1_val': 0.9956877112170308, 'auprc': 0.999052945517819, 'loss_val': 0.029102464827498464, 'psi': 0.9970338049373461}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.733382 cos_to_last_merge=0.9098 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.951522959691689, 'auprc': 0.9359800269970099, 'loss_val': 0.31336753781484694, 'psi': 0.9453057866138173}-{'f1_val': 0.9436226276060854, 'auprc': 0.9680202635116419, 'loss_val': 0.3226048772276429, 'psi': 0.953381681968308}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=2.027037 cos_to_last_merge=0.9351 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=93 local utility u=0.007282 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9945701934817275, 'loss_val': 0.029492345216143228, 'psi': 0.9953640716638946}-{'f1_val': 0.9957475160061228, 'auprc': 0.9903624071519663, 'loss_val': 0.03055757118238657, 'psi': 0.9935934724644602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=93 head_norm_before_train=2.178225 (no previous merge yet)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7927542859821006, 'auprc': 0.919780223976558, 'loss_val': 0.768460839361608, 'psi': 0.8435646611798835}-{'f1_val': 0.8586293749370847, 'auprc': 0.9540065156958715, 'loss_val': 0.4495619331543612, 'psi': 0.8967802312405995}
[S7] START round=93 head_norm_before_train=1.630140 cos_to_last_merge=0.9362 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=93 local utility u=0.158730 metrics={'f1_val': 0.6489179344531603, 'auprc': 0.8016593466523994, 'loss_val': 0.5277871123947067, 'psi': 0.7100144993328559}-{'f1_val': 0.6163710114851604, 'auprc': 0.7925343478275815, 'loss_val': 0.622589804669358, 'psi': 0.6868363460221287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=93 head_norm_before_train=2.287198 (no previous merge yet)
[S8] round=93 local utility u=0.002792 metrics={'f1_val': 0.9942761170547124, 'auprc': 0.9991814623452908, 'loss_val': 0.02860858870404964, 'psi': 0.9962382551709439}-{'f1_val': 0.993122746315827, 'auprc': 0.9991684230108154, 'loss_val': 0.027232309369019447, 'psi': 0.9955410169938224}
[S9] START round=93 head_norm_before_train=2.050172 cos_to_last_merge=0.7264 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.726
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9926697248572618, 'loss_val': 0.018365688053031074, 'psi': 0.995083384701762}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962479241841979, 'loss_val': 0.016699407623582577, 'psi': 0.9967609171809648}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.256424 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=93 local utility u=0.000586 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9951153314511929, 'loss_val': 0.02920693281483233, 'psi': 0.9948952981121006}-{'f1_val': 0.9947486092193725, 'auprc': 0.9948049517065473, 'loss_val': 0.029448579935283093, 'psi': 0.9947711462142423}
[S11] START round=93 head_norm_before_train=1.806817 cos_to_last_merge=0.9030 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9980493502891831, 'loss_val': 0.018582594727559038, 'psi': 0.9970051908858943}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987020729760989, 'loss_val': 0.017362397580096566, 'psi': 0.9975142809393488}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.685170 cos_to_last_merge=0.8811 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.5887316362522007, 'auprc': 0.6669450576799054, 'loss_val': 1.457524367818457, 'psi': 0.6200170048232826}-{'f1_val': 0.6614767859347492, 'auprc': 0.8096556402309287, 'loss_val': 0.9260280770404686, 'psi': 0.720748327653221}
[S14] START round=93 head_norm_before_train=2.256727 cos_to_last_merge=1.0000 (last merge round=91)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9982830790006876, 'auprc': 0.9987832506919496, 'loss_val': 0.02456232065483263, 'psi': 0.9984831476771924}-{'f1_val': 0.9976319732898762, 'auprc': 0.9986425924237166, 'loss_val': 0.01737992158294029, 'psi': 0.9980362209434124}
[S15] START round=93 head_norm_before_train=1.899574 cos_to_last_merge=0.9269 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=93 local utility u=0.336041 metrics={'f1_val': 0.9968965306828483, 'auprc': 0.9972939361484249, 'loss_val': 0.021409432206508663, 'psi': 0.9970554928690789}-{'f1_val': 0.9099274680888554, 'auprc': 0.9961759122113121, 'loss_val': 0.16832388826973813, 'psi': 0.944426845737838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=93 head_norm_before_train=2.267469 (no previous merge yet)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9923012088395753, 'auprc': 0.9891186419863782, 'loss_val': 0.04259353853637635, 'psi': 0.9910281820982965}-{'f1_val': 0.9924726039977416, 'auprc': 0.9907744743835415, 'loss_val': 0.0407693698285839, 'psi': 0.9917933521520617}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.279312 (no previous merge yet)
[S17] round=93 local utility u=0.426875 metrics={'f1_val': 0.8848762786418184, 'auprc': 0.9274753402065516, 'loss_val': 0.45455338354957114, 'psi': 0.9019159032677116}-{'f1_val': 0.8035717071438886, 'auprc': 0.9030113180821853, 'loss_val': 0.7470834529391087, 'psi': 0.8433475515192073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:63202
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63209
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:63214
[S2] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=93 metric=0.9983 head_norm=2.258778
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.267755e-03
[S14] stored merged vector for next round verification (round=93)
[S14] DEBUG after merge:  round=93 metric=0.9983 head_norm=2.257590 delta_norm=0.007268
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0027
[S8] DROPPED delta from S2 (cos=-0.0027 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] cosine check vs S10: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=-0.0027
[S2] DROPPED delta from S8 (cos=-0.0027 < 0.0)
[S2] START round=94 head_norm_before_train=2.112725 cos_to_last_merge=0.9205 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=94 local utility u=0.006964 metrics={'f1_val': 0.7176744503867171, 'auprc': 0.72645100068545, 'loss_val': 1.2012074757171018, 'psi': 0.7211850705062103}-{'f1_val': 0.7165031599295603, 'auprc': 0.7277140994585258, 'loss_val': 1.2118975415535613, 'psi': 0.7209875357411465}
[S3] START round=94 head_norm_before_train=1.845637 cos_to_last_merge=0.8546 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.7837301494109485, 'auprc': 0.9755007021109369, 'loss_val': 0.39088925838739896, 'psi': 0.8604383704909438}-{'f1_val': 0.8725352706209929, 'auprc': 0.9856391803540441, 'loss_val': 0.23767661999007245, 'psi': 0.9177768345142134}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.737540 cos_to_last_merge=0.9089 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=94 local utility u=0.028940 metrics={'f1_val': 0.9561737339136077, 'auprc': 0.9447259514089273, 'loss_val': 0.3096291919322662, 'psi': 0.9515946209117355}-{'f1_val': 0.951522959691689, 'auprc': 0.9359800269970099, 'loss_val': 0.31336753781484694, 'psi': 0.9453057866138173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=94 head_norm_before_train=2.031782 cos_to_last_merge=0.9347 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9913333879411173, 'loss_val': 0.02900819609980341, 'psi': 0.9939818647801206}-{'f1_val': 0.9958933237853395, 'auprc': 0.9945701934817275, 'loss_val': 0.029492345216143228, 'psi': 0.9953640716638946}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.181382 (no previous merge yet)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.7185969809903368, 'auprc': 0.8495465500006991, 'loss_val': 0.9995905170459937, 'psi': 0.7709768085944817}-{'f1_val': 0.7927542859821006, 'auprc': 0.919780223976558, 'loss_val': 0.768460839361608, 'psi': 0.8435646611798835}
[S7] START round=94 head_norm_before_train=1.635641 cos_to_last_merge=0.9350 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5968238725598842, 'auprc': 0.7857704239963452, 'loss_val': 0.8181383575939011, 'psi': 0.6724024931344686}-{'f1_val': 0.6489179344531603, 'auprc': 0.8016593466523994, 'loss_val': 0.5277871123947067, 'psi': 0.7100144993328559}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.291116 (no previous merge yet)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.999224776697317, 'loss_val': 0.03824434901369785, 'psi': 0.9927867292773747}-{'f1_val': 0.9942761170547124, 'auprc': 0.9991814623452908, 'loss_val': 0.02860858870404964, 'psi': 0.9962382551709439}
[S9] START round=94 head_norm_before_train=2.049981 cos_to_last_merge=0.7264 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.726
[S9] round=94 local utility u=0.012834 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9999201793200551, 'loss_val': 0.016894597659354145, 'psi': 0.99822810145156}-{'f1_val': 0.9966924912647621, 'auprc': 0.9926697248572618, 'loss_val': 0.018365688053031074, 'psi': 0.995083384701762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=94 head_norm_before_train=2.259658 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=94 local utility u=0.000443 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953634357210458, 'loss_val': 0.029065422390172426, 'psi': 0.9949945398200418}-{'f1_val': 0.9947486092193725, 'auprc': 0.9951153314511929, 'loss_val': 0.02920693281483233, 'psi': 0.9948952981121006}
[S11] START round=94 head_norm_before_train=1.812228 cos_to_last_merge=0.9025 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=94 local utility u=0.005872 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989141831147601, 'loss_val': 0.015986109295012246, 'psi': 0.9980063876759498}-{'f1_val': 0.9963090846170353, 'auprc': 0.9980493502891831, 'loss_val': 0.018582594727559038, 'psi': 0.9970051908858943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=94 head_norm_before_train=1.686922 cos_to_last_merge=0.8811 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=94 local utility u=0.854869 metrics={'f1_val': 0.7109017490060954, 'auprc': 0.867373710299546, 'loss_val': 1.0820924678692276, 'psi': 0.7734905335234756}-{'f1_val': 0.5887316362522007, 'auprc': 0.6669450576799054, 'loss_val': 1.457524367818457, 'psi': 0.6200170048232826}
[S14] START round=94 head_norm_before_train=2.257590 cos_to_last_merge=1.0000 (last merge round=93)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9355213399565925, 'auprc': 0.9955798689622679, 'loss_val': 0.17686014909093464, 'psi': 0.9595447515588627}-{'f1_val': 0.9982830790006876, 'auprc': 0.9987832506919496, 'loss_val': 0.02456232065483263, 'psi': 0.9984831476771924}
[S15] START round=94 head_norm_before_train=1.904688 cos_to_last_merge=0.9265 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9965048937324283, 'loss_val': 0.021150016780029816, 'psi': 0.9966499585254837}-{'f1_val': 0.9968965306828483, 'auprc': 0.9972939361484249, 'loss_val': 0.021409432206508663, 'psi': 0.9970554928690789}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.269560 (no previous merge yet)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9918632989011847, 'auprc': 0.9891386522714842, 'loss_val': 0.044687455586713686, 'psi': 0.9907734402493046}-{'f1_val': 0.9923012088395753, 'auprc': 0.9891186419863782, 'loss_val': 0.04259353853637635, 'psi': 0.9910281820982965}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.285447 (no previous merge yet)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7906105561116676, 'auprc': 0.8971847837206199, 'loss_val': 0.7262004541772676, 'psi': 0.8332402471552485}-{'f1_val': 0.8848762786418184, 'auprc': 0.9274753402065516, 'loss_val': 0.45455338354957114, 'psi': 0.9019159032677116}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=94 metric=0.9355 head_norm=2.259362
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.153584e-03
[S14] stored merged vector for next round verification (round=94)
[S14] DEBUG after merge:  round=94 metric=0.9355 head_norm=2.259502 delta_norm=0.006154
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0026
[S8] DROPPED delta from S2 (cos=-0.0026 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S13
[S6] cosine check vs S13: cos=-0.1187
[S6] DROPPED delta from S13 (cos=-0.1187 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S2] START round=95 head_norm_before_train=2.117357 cos_to_last_merge=0.9203 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.6571792808101238, 'auprc': 0.7326326398363399, 'loss_val': 1.6191020022757676, 'psi': 0.6873606244206102}-{'f1_val': 0.7176744503867171, 'auprc': 0.72645100068545, 'loss_val': 1.2012074757171018, 'psi': 0.7211850705062103}
[S3] START round=95 head_norm_before_train=1.850348 cos_to_last_merge=0.8541 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=95 local utility u=0.150218 metrics={'f1_val': 0.8145333701334463, 'auprc': 0.9926523440411239, 'loss_val': 0.32672814823212354, 'psi': 0.8857809596965174}-{'f1_val': 0.7837301494109485, 'auprc': 0.9755007021109369, 'loss_val': 0.39088925838739896, 'psi': 0.8604383704909438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=95 head_norm_before_train=1.739273 cos_to_last_merge=0.9085 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9398455244488452, 'auprc': 0.944631022977457, 'loss_val': 0.33398166000017293, 'psi': 0.9417597238602899}-{'f1_val': 0.9561737339136077, 'auprc': 0.9447259514089273, 'loss_val': 0.3096291919322662, 'psi': 0.9515946209117355}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.036638 cos_to_last_merge=0.9346 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=95 local utility u=0.009302 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9970688137959072, 'loss_val': 0.028485628209083225, 'psi': 0.9963635197895665}-{'f1_val': 0.9957475160061228, 'auprc': 0.9913333879411173, 'loss_val': 0.02900819609980341, 'psi': 0.9939818647801206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=95 head_norm_before_train=2.182338 (no previous merge yet)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.5746204042232845, 'auprc': 0.6604641245291956, 'loss_val': 1.5560714495269101, 'psi': 0.6089578923456489}-{'f1_val': 0.7185969809903368, 'auprc': 0.8495465500006991, 'loss_val': 0.9995905170459937, 'psi': 0.7709768085944817}
[S7] START round=95 head_norm_before_train=1.640182 cos_to_last_merge=0.9341 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=95 local utility u=0.996905 metrics={'f1_val': 0.8339563984535874, 'auprc': 0.8347984472379819, 'loss_val': 0.3942081174286305, 'psi': 0.8342932179673452}-{'f1_val': 0.5968238725598842, 'auprc': 0.7857704239963452, 'loss_val': 0.8181383575939011, 'psi': 0.6724024931344686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=95 head_norm_before_train=2.292219 (no previous merge yet)
[S8] round=95 local utility u=0.016045 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9991679627212118, 'loss_val': 0.032632685315248905, 'psi': 0.9954288944535788}-{'f1_val': 0.9884946976640797, 'auprc': 0.999224776697317, 'loss_val': 0.03824434901369785, 'psi': 0.9927867292773747}
[S9] START round=95 head_norm_before_train=2.046188 cos_to_last_merge=0.7269 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9999135326103081, 'loss_val': 0.020283432771507987, 'psi': 0.9969796636926006}-{'f1_val': 0.9971000495392299, 'auprc': 0.9999201793200551, 'loss_val': 0.016894597659354145, 'psi': 0.99822810145156}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.263110 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=95 local utility u=0.000345 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995570833875057, 'loss_val': 0.028998590432069586, 'psi': 0.9950774990816462}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953634357210458, 'loss_val': 0.029065422390172426, 'psi': 0.9949945398200418}
[S11] START round=95 head_norm_before_train=1.815353 cos_to_last_merge=0.9022 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988908406833461, 'loss_val': 0.016126413795738995, 'psi': 0.9977348902490848}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989141831147601, 'loss_val': 0.015986109295012246, 'psi': 0.9980063876759498}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.689475 cos_to_last_merge=0.8808 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6263599552834836, 'auprc': 0.7798723094435112, 'loss_val': 1.1377715313880863, 'psi': 0.6877648969474947}-{'f1_val': 0.7109017490060954, 'auprc': 0.867373710299546, 'loss_val': 1.0820924678692276, 'psi': 0.7734905335234756}
[S14] START round=95 head_norm_before_train=2.259502 cos_to_last_merge=1.0000 (last merge round=94)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9309145532741842, 'auprc': 0.9969695282955244, 'loss_val': 0.20537730246632568, 'psi': 0.9573365432827203}-{'f1_val': 0.9355213399565925, 'auprc': 0.9955798689622679, 'loss_val': 0.17686014909093464, 'psi': 0.9595447515588627}
[S15] START round=95 head_norm_before_train=1.910017 cos_to_last_merge=0.9261 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9950587619138033, 'loss_val': 0.021898002937385294, 'psi': 0.9960715057980336}-{'f1_val': 0.9967466683875206, 'auprc': 0.9965048937324283, 'loss_val': 0.021150016780029816, 'psi': 0.9966499585254837}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.273287 (no previous merge yet)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9100434355820948, 'auprc': 0.9618091900486704, 'loss_val': 0.5696525117063388, 'psi': 0.930749737368725}-{'f1_val': 0.9918632989011847, 'auprc': 0.9891386522714842, 'loss_val': 0.044687455586713686, 'psi': 0.9907734402493046}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.292651 (no previous merge yet)
[S17] round=95 local utility u=0.053999 metrics={'f1_val': 0.8110572899664528, 'auprc': 0.9001943330556297, 'loss_val': 0.7499110906878311, 'psi': 0.8467121072021235}-{'f1_val': 0.7906105561116676, 'auprc': 0.8971847837206199, 'loss_val': 0.7262004541772676, 'psi': 0.8332402471552485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:63214
[S2] ⇄ pheromone p=0.021 → S8@127.0.0.1:63209
[S8] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] ⇄ pheromone p=0.261 → S6@127.0.0.1:63207
[S6] ⇄ pheromone p=0.186 → S13@127.0.0.1:63213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=95 metric=0.9309 head_norm=2.261365
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.594286e-03
[S14] stored merged vector for next round verification (round=95)
[S14] DEBUG after merge:  round=95 metric=0.9309 head_norm=2.262221 delta_norm=0.008594
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.009 → S10@127.0.0.1:63211
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1792) from S8
[S2] cosine check vs S8: cos=-0.0030
[S2] DROPPED delta from S8 (cos=-0.0030 < 0.0)
[S10] ⇄ pheromone p=0.002 → S14@127.0.0.1:63214
[S8] ⇄ pheromone p=0.017 → S2@127.0.0.1:63202
[S2] START round=96 head_norm_before_train=2.123424 cos_to_last_merge=0.9199 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=96 local utility u=0.290691 metrics={'f1_val': 0.6972132474138086, 'auprc': 0.7271194884520111, 'loss_val': 1.2613844000718586, 'psi': 0.7091757438290897}-{'f1_val': 0.6571792808101238, 'auprc': 0.7326326398363399, 'loss_val': 1.6191020022757676, 'psi': 0.6873606244206102}
[S3] START round=96 head_norm_before_train=1.855309 cos_to_last_merge=0.8536 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=96 local utility u=0.072045 metrics={'f1_val': 0.8449492220071982, 'auprc': 0.9774960605792051, 'loss_val': 0.3196646101960752, 'psi': 0.897967957436001}-{'f1_val': 0.8145333701334463, 'auprc': 0.9926523440411239, 'loss_val': 0.32672814823212354, 'psi': 0.8857809596965174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=96 head_norm_before_train=1.742455 cos_to_last_merge=0.9080 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9210707837867699, 'auprc': 0.9401296338756173, 'loss_val': 0.378846342021104, 'psi': 0.9286943238223089}-{'f1_val': 0.9398455244488452, 'auprc': 0.944631022977457, 'loss_val': 0.33398166000017293, 'psi': 0.9417597238602899}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.040987 cos_to_last_merge=0.9343 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9923910867175473, 'loss_val': 0.028473648578990617, 'psi': 0.9944049442906926}-{'f1_val': 0.9958933237853395, 'auprc': 0.9970688137959072, 'loss_val': 0.028485628209083225, 'psi': 0.9963635197895665}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.185395 (no previous merge yet)
[S6] round=96 local utility u=1.000000 metrics={'f1_val': 0.7153638034174458, 'auprc': 0.8763252052476148, 'loss_val': 0.8037091633064896, 'psi': 0.7797483641495134}-{'f1_val': 0.5746204042232845, 'auprc': 0.6604641245291956, 'loss_val': 1.5560714495269101, 'psi': 0.6089578923456489}
[S7] START round=96 head_norm_before_train=1.644800 cos_to_last_merge=0.9332 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5989956496418982, 'auprc': 0.7870093531828115, 'loss_val': 0.7460329225211266, 'psi': 0.6742011310582635}-{'f1_val': 0.8339563984535874, 'auprc': 0.8347984472379819, 'loss_val': 0.3942081174286305, 'psi': 0.8342932179673452}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.296532 (no previous merge yet)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9871793305831165, 'auprc': 0.9991285135391601, 'loss_val': 0.0393471535158469, 'psi': 0.9919590037655339}-{'f1_val': 0.9929361822751569, 'auprc': 0.9991679627212118, 'loss_val': 0.032632685315248905, 'psi': 0.9954288944535788}
[S9] START round=96 head_norm_before_train=2.047180 cos_to_last_merge=0.7270 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=96 local utility u=0.007914 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999083526618162, 'loss_val': 0.01691404706438617, 'psi': 0.9982250885720122}-{'f1_val': 0.9950237510807955, 'auprc': 0.9999135326103081, 'loss_val': 0.020283432771507987, 'psi': 0.9969796636926006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=96 head_norm_before_train=2.267501 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=96 local utility u=0.000635 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9964460734312619, 'loss_val': 0.02903752005034618, 'psi': 0.9952958934515413}-{'f1_val': 0.9947486092193725, 'auprc': 0.995570833875057, 'loss_val': 0.028998590432069586, 'psi': 0.9950774990816462}
[S11] START round=96 head_norm_before_train=1.818170 cos_to_last_merge=0.9019 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982317343428266, 'loss_val': 0.018703273614554147, 'psi': 0.9970781445073518}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988908406833461, 'loss_val': 0.016126413795738995, 'psi': 0.9977348902490848}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.692782 cos_to_last_merge=0.8806 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=96 local utility u=0.493960 metrics={'f1_val': 0.722932953156719, 'auprc': 0.8306169429279922, 'loss_val': 0.8815239238660877, 'psi': 0.7660065490652284}-{'f1_val': 0.6263599552834836, 'auprc': 0.7798723094435112, 'loss_val': 1.1377715313880863, 'psi': 0.6877648969474947}
[S14] START round=96 head_norm_before_train=2.262221 cos_to_last_merge=1.0000 (last merge round=95)
[S14] round=96 local utility u=0.015226 metrics={'f1_val': 0.9347692789129906, 'auprc': 0.9944434522411595, 'loss_val': 0.19047586841099615, 'psi': 0.9586389482442581}-{'f1_val': 0.9309145532741842, 'auprc': 0.9969695282955244, 'loss_val': 0.20537730246632568, 'psi': 0.9573365432827203}
[S15] START round=96 head_norm_before_train=1.915241 cos_to_last_merge=0.9257 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.8228113097681083, 'auprc': 0.9718727961905471, 'loss_val': 0.4059772366497391, 'psi': 0.8824359043370839}-{'f1_val': 0.9967466683875206, 'auprc': 0.9950587619138033, 'loss_val': 0.021898002937385294, 'psi': 0.9960715057980336}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.275706 (no previous merge yet)
[S16] round=96 local utility u=0.552813 metrics={'f1_val': 0.9918393368414223, 'auprc': 0.9913698755042433, 'loss_val': 0.043484892523918926, 'psi': 0.9916515523065507}-{'f1_val': 0.9100434355820948, 'auprc': 0.9618091900486704, 'loss_val': 0.5696525117063388, 'psi': 0.930749737368725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=96 head_norm_before_train=2.300284 (no previous merge yet)
[S17] round=96 local utility u=0.092980 metrics={'f1_val': 0.8256105112452681, 'auprc': 0.9277236415971472, 'loss_val': 0.7338585569786155, 'psi': 0.8664557633860197}-{'f1_val': 0.8110572899664528, 'auprc': 0.9001943330556297, 'loss_val': 0.7499110906878311, 'psi': 0.8467121072021235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:63211
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1792) from S14
[S10] cosine check vs S14: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] cosine check vs S6: cos=-0.1189
[S13] DROPPED delta from S6 (cos=-0.1189 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S13
[S6] cosine check vs S13: cos=-0.1189
[S6] DROPPED delta from S13 (cos=-0.1189 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1790) from S2
[S8] cosine check vs S2: cos=-0.0033
[S8] DROPPED delta from S2 (cos=-0.0033 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=96 metric=0.9945 head_norm=2.272347
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.134503e-02
[S10] stored merged vector for next round verification (round=96)
[S10] DEBUG after merge:  round=96 metric=0.9945 head_norm=2.268745 delta_norm=0.011345
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=96 metric=0.9348 head_norm=2.265193
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.045012e-02
[S14] stored merged vector for next round verification (round=96)
[S14] DEBUG after merge:  round=96 metric=0.9348 head_norm=2.267535 delta_norm=0.010450
[S14] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.128512 cos_to_last_merge=0.9195 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.6840568138405946, 'auprc': 0.7415594672297842, 'loss_val': 1.3138383982078166, 'psi': 0.7070578751962704}-{'f1_val': 0.6972132474138086, 'auprc': 0.7271194884520111, 'loss_val': 1.2613844000718586, 'psi': 0.7091757438290897}
[S3] START round=97 head_norm_before_train=1.859367 cos_to_last_merge=0.8534 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.8117801463310258, 'auprc': 0.9282440186643497, 'loss_val': 0.44191228513928393, 'psi': 0.8583656952643554}-{'f1_val': 0.8449492220071982, 'auprc': 0.9774960605792051, 'loss_val': 0.3196646101960752, 'psi': 0.897967957436001}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.748719 cos_to_last_merge=0.9073 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.7523435046554939, 'auprc': 0.9223754280918459, 'loss_val': 0.5717592895090469, 'psi': 0.8203562740300347}-{'f1_val': 0.9210707837867699, 'auprc': 0.9401296338756173, 'loss_val': 0.378846342021104, 'psi': 0.9286943238223089}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.045792 cos_to_last_merge=0.9339 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9903879890359277, 'loss_val': 0.029491484066378786, 'psi': 0.9936037052180449}-{'f1_val': 0.9957475160061228, 'auprc': 0.9923910867175473, 'loss_val': 0.028473648578990617, 'psi': 0.9944049442906926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.188438 (no previous merge yet)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.7266194035235385, 'auprc': 0.8894390939172669, 'loss_val': 0.9828881770637138, 'psi': 0.7917472796810299}-{'f1_val': 0.7153638034174458, 'auprc': 0.8763252052476148, 'loss_val': 0.8037091633064896, 'psi': 0.7797483641495134}
[S7] START round=97 head_norm_before_train=1.648521 cos_to_last_merge=0.9328 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.5871043930525579, 'auprc': 0.7827883701556424, 'loss_val': 0.8422339346647144, 'psi': 0.6653779838937917}-{'f1_val': 0.5989956496418982, 'auprc': 0.7870093531828115, 'loss_val': 0.7460329225211266, 'psi': 0.6742011310582635}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=2.302307 (no previous merge yet)
[S8] round=97 local utility u=0.019039 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9993638883025328, 'loss_val': 0.032141373984895284, 'psi': 0.9950697112796978}-{'f1_val': 0.9871793305831165, 'auprc': 0.9991285135391601, 'loss_val': 0.0393471535158469, 'psi': 0.9919590037655339}
[S9] START round=97 head_norm_before_train=2.050546 cos_to_last_merge=0.7269 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9991312507347759, 'loss_val': 0.038440018489953466, 'psi': 0.9927248363858208}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999083526618162, 'loss_val': 0.01691404706438617, 'psi': 0.9982250885720122}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.268745 cos_to_last_merge=1.0000 (last merge round=96)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955103296755359, 'loss_val': 0.029156785441244722, 'psi': 0.9950532974018378}-{'f1_val': 0.9945291067983943, 'auprc': 0.9964460734312619, 'loss_val': 0.02903752005034618, 'psi': 0.9952958934515413}
[S11] START round=97 head_norm_before_train=1.820136 cos_to_last_merge=0.9016 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=97 local utility u=0.003113 metrics={'f1_val': 0.9966782942738902, 'auprc': 0.9990728216608102, 'loss_val': 0.017215014512938144, 'psi': 0.9976361052286582}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982317343428266, 'loss_val': 0.018703273614554147, 'psi': 0.9970781445073518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=97 head_norm_before_train=1.695744 cos_to_last_merge=0.8803 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.665742889979615, 'auprc': 0.8440924319895022, 'loss_val': 1.1919877961994663, 'psi': 0.7370827067835699}-{'f1_val': 0.722932953156719, 'auprc': 0.8306169429279922, 'loss_val': 0.8815239238660877, 'psi': 0.7660065490652284}
[S14] START round=97 head_norm_before_train=2.267535 cos_to_last_merge=1.0000 (last merge round=96)
[S14] round=97 local utility u=0.109539 metrics={'f1_val': 0.9520630579819123, 'auprc': 0.9982249747280423, 'loss_val': 0.0865053937659697, 'psi': 0.9705278246803644}-{'f1_val': 0.9347692789129906, 'auprc': 0.9944434522411595, 'loss_val': 0.19047586841099615, 'psi': 0.9586389482442581}
[S15] START round=97 head_norm_before_train=1.920400 cos_to_last_merge=0.9252 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=97 local utility u=0.337398 metrics={'f1_val': 0.9010284389996162, 'auprc': 0.9938820145133611, 'loss_val': 0.266511551503764, 'psi': 0.9381698692051141}-{'f1_val': 0.8228113097681083, 'auprc': 0.9718727961905471, 'loss_val': 0.4059772366497391, 'psi': 0.8824359043370839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=97 head_norm_before_train=2.279602 (no previous merge yet)
[S16] round=97 local utility u=0.009277 metrics={'f1_val': 0.9931673086796463, 'auprc': 0.9930405801075491, 'loss_val': 0.03791179562633253, 'psi': 0.9931166172508075}-{'f1_val': 0.9918393368414223, 'auprc': 0.9913698755042433, 'loss_val': 0.043484892523918926, 'psi': 0.9916515523065507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=97 head_norm_before_train=2.305652 (no previous merge yet)
[S17] round=97 local utility u=0.023186 metrics={'f1_val': 0.8253055651806621, 'auprc': 0.9476978208796172, 'loss_val': 0.7455787737220191, 'psi': 0.8742624674602442}-{'f1_val': 0.8256105112452681, 'auprc': 0.9277236415971472, 'loss_val': 0.7338585569786155, 'psi': 0.8664557633860197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=-0.0033
[S2] DROPPED delta from S8 (cos=-0.0033 < 0.0)
[S2] START round=98 head_norm_before_train=2.132024 cos_to_last_merge=0.9192 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.6922967107517017, 'auprc': 0.7237630359107456, 'loss_val': 1.475193921924674, 'psi': 0.7048832408153193}-{'f1_val': 0.6840568138405946, 'auprc': 0.7415594672297842, 'loss_val': 1.3138383982078166, 'psi': 0.7070578751962704}
[S3] START round=98 head_norm_before_train=1.863714 cos_to_last_merge=0.8531 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=98 local utility u=0.800711 metrics={'f1_val': 0.9798994016848347, 'auprc': 0.9982324535897686, 'loss_val': 0.05917103201355852, 'psi': 0.9872326224468082}-{'f1_val': 0.8117801463310258, 'auprc': 0.9282440186643497, 'loss_val': 0.44191228513928393, 'psi': 0.8583656952643554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=98 head_norm_before_train=1.754648 cos_to_last_merge=0.9066 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=98 local utility u=0.315474 metrics={'f1_val': 0.8330878610554977, 'auprc': 0.9372843401606015, 'loss_val': 0.4700033368809273, 'psi': 0.8747664526975392}-{'f1_val': 0.7523435046554939, 'auprc': 0.9223754280918459, 'loss_val': 0.5717592895090469, 'psi': 0.8203562740300347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=98 head_norm_before_train=2.045938 cos_to_last_merge=0.9331 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=98 local utility u=0.009844 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9964920688115999, 'loss_val': 0.02899146933875393, 'psi': 0.9961328217958436}-{'f1_val': 0.9957475160061228, 'auprc': 0.9903879890359277, 'loss_val': 0.029491484066378786, 'psi': 0.9936037052180449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=98 head_norm_before_train=2.193806 (no previous merge yet)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.6037026318396672, 'auprc': 0.694963375202389, 'loss_val': 1.329821287250505, 'psi': 0.640206929184756}-{'f1_val': 0.7266194035235385, 'auprc': 0.8894390939172669, 'loss_val': 0.9828881770637138, 'psi': 0.7917472796810299}
[S7] START round=98 head_norm_before_train=1.652317 cos_to_last_merge=0.9325 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=98 local utility u=0.415379 metrics={'f1_val': 0.6517405662876578, 'auprc': 0.8050510255559249, 'loss_val': 0.4660814518063597, 'psi': 0.7130647499949646}-{'f1_val': 0.5871043930525579, 'auprc': 0.7827883701556424, 'loss_val': 0.8422339346647144, 'psi': 0.6653779838937917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=98 head_norm_before_train=2.304729 (no previous merge yet)
[S8] round=98 local utility u=0.007310 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9993853268030224, 'loss_val': 0.027477310534324978, 'psi': 0.9960674000895957}-{'f1_val': 0.9922069265978078, 'auprc': 0.9993638883025328, 'loss_val': 0.032141373984895284, 'psi': 0.9950697112796978}
[S9] START round=98 head_norm_before_train=2.051630 cos_to_last_merge=0.7270 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=98 local utility u=0.029273 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9991879972161868, 'loss_val': 0.020478243191329504, 'psi': 0.9967890105638387}-{'f1_val': 0.9884538934865174, 'auprc': 0.9991312507347759, 'loss_val': 0.038440018489953466, 'psi': 0.9927248363858208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=98 head_norm_before_train=2.273843 cos_to_last_merge=1.0000 (last merge round=96)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953316359853877, 'loss_val': 0.029293595281330544, 'psi': 0.9949818199257785}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955103296755359, 'loss_val': 0.029156785441244722, 'psi': 0.9950532974018378}
[S11] START round=98 head_norm_before_train=1.822485 cos_to_last_merge=0.9014 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9989700839256939, 'loss_val': 0.016497510518991843, 'psi': 0.9973734843404987}-{'f1_val': 0.9966782942738902, 'auprc': 0.9990728216608102, 'loss_val': 0.017215014512938144, 'psi': 0.9976361052286582}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.702214 cos_to_last_merge=0.8795 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=98 local utility u=0.196702 metrics={'f1_val': 0.7046430343141097, 'auprc': 0.8451904801636965, 'loss_val': 1.0352787028434332, 'psi': 0.7608620126539445}-{'f1_val': 0.665742889979615, 'auprc': 0.8440924319895022, 'loss_val': 1.1919877961994663, 'psi': 0.7370827067835699}
[S14] START round=98 head_norm_before_train=2.270031 cos_to_last_merge=1.0000 (last merge round=96)
[S14] round=98 local utility u=0.143298 metrics={'f1_val': 0.9928091977738309, 'auprc': 0.9985120021487729, 'loss_val': 0.045247879120442626, 'psi': 0.9950903195238077}-{'f1_val': 0.9520630579819123, 'auprc': 0.9982249747280423, 'loss_val': 0.0865053937659697, 'psi': 0.9705278246803644}
[S15] START round=98 head_norm_before_train=1.924351 cos_to_last_merge=0.9250 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=98 local utility u=0.414600 metrics={'f1_val': 0.9964553122065998, 'auprc': 0.9978600010936094, 'loss_val': 0.021805876359770163, 'psi': 0.9970171877614037}-{'f1_val': 0.9010284389996162, 'auprc': 0.9938820145133611, 'loss_val': 0.266511551503764, 'psi': 0.9381698692051141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=98 head_norm_before_train=2.284788 (no previous merge yet)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9913790076685718, 'auprc': 0.9896740546069579, 'loss_val': 0.048209327368968984, 'psi': 0.9906970264439262}-{'f1_val': 0.9931673086796463, 'auprc': 0.9930405801075491, 'loss_val': 0.03791179562633253, 'psi': 0.9931166172508075}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.310534 (no previous merge yet)
[S17] round=98 local utility u=0.119033 metrics={'f1_val': 0.8413550887752201, 'auprc': 0.9689926916414234, 'loss_val': 0.6676936165295154, 'psi': 0.8924101299217014}-{'f1_val': 0.8253055651806621, 'auprc': 0.9476978208796172, 'loss_val': 0.7455787737220191, 'psi': 0.8742624674602442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63207
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=98 metric=0.9947 head_norm=2.278282
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.784121e-03
[S10] stored merged vector for next round verification (round=98)
[S10] DEBUG after merge:  round=98 metric=0.9947 head_norm=2.274147 delta_norm=0.007784
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=-0.1188
[S6] DROPPED delta from S13 (cos=-0.1188 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=-0.0032
[S2] DROPPED delta from S8 (cos=-0.0032 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] cosine check vs S14: cos=1.0000
[S2] START round=99 head_norm_before_train=2.136597 cos_to_last_merge=0.9186 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=99 local utility u=0.188722 metrics={'f1_val': 0.711926956980927, 'auprc': 0.735811974893017, 'loss_val': 1.251678514166957, 'psi': 0.7214809641457629}-{'f1_val': 0.6922967107517017, 'auprc': 0.7237630359107456, 'loss_val': 1.475193921924674, 'psi': 0.7048832408153193}
[S3] START round=99 head_norm_before_train=1.868059 cos_to_last_merge=0.8527 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=99 local utility u=0.058125 metrics={'f1_val': 0.9925507290203709, 'auprc': 0.998734129013974, 'loss_val': 0.020333520010965896, 'psi': 0.9950240890178121}-{'f1_val': 0.9798994016848347, 'auprc': 0.9982324535897686, 'loss_val': 0.05917103201355852, 'psi': 0.9872326224468082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S3] r=100 psi=0.995 u=0.0581 p_local=0.2295 f1=0.993 auprc=0.999 bytes=104467
[S4] START round=99 head_norm_before_train=1.759681 cos_to_last_merge=0.9062 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=99 local utility u=0.433021 metrics={'f1_val': 0.9416023945935778, 'auprc': 0.9628340810405013, 'loss_val': 0.33169829757086333, 'psi': 0.9500950691723471}-{'f1_val': 0.8330878610554977, 'auprc': 0.9372843401606015, 'loss_val': 0.4700033368809273, 'psi': 0.8747664526975392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=100 psi=0.950 u=0.4330 p_local=0.1764 f1=0.942 auprc=0.963 bytes=95432
[S5] START round=99 head_norm_before_train=2.049803 cos_to_last_merge=0.9325 (last merge round=23)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9962657769875565, 'loss_val': 0.029131269823442964, 'psi': 0.9960423050662263}-{'f1_val': 0.9958933237853395, 'auprc': 0.9964920688115999, 'loss_val': 0.02899146933875393, 'psi': 0.9961328217958436}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.996 u=0.0000 p_local=0.0033 f1=0.996 auprc=0.996 bytes=113421
[S6] START round=99 head_norm_before_train=2.201687 (no previous merge yet)
[S6] round=99 local utility u=0.780940 metrics={'f1_val': 0.7178047197628709, 'auprc': 0.8724920689359263, 'loss_val': 0.9851390876118469, 'psi': 0.779679659432093}-{'f1_val': 0.6037026318396672, 'auprc': 0.694963375202389, 'loss_val': 1.329821287250505, 'psi': 0.640206929184756}
[S7] START round=99 head_norm_before_train=1.656100 cos_to_last_merge=0.9321 (last merge round=22)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.5714994592514029, 'auprc': 0.7805482553339954, 'loss_val': 0.888526626634881, 'psi': 0.6551189776844399}-{'f1_val': 0.6517405662876578, 'auprc': 0.8050510255559249, 'loss_val': 0.4660814518063597, 'psi': 0.7130647499949646}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.655 u=0.0000 p_local=0.1847 f1=0.571 auprc=0.781 bytes=100713
[S8] START round=99 head_norm_before_train=2.308272 (no previous merge yet)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9994286493047568, 'loss_val': 0.025832529233714253, 'psi': 0.9956451075113989}-{'f1_val': 0.9938554489473111, 'auprc': 0.9993853268030224, 'loss_val': 0.027477310534324978, 'psi': 0.9960674000895957}
[S9] START round=99 head_norm_before_train=2.053319 cos_to_last_merge=0.7269 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=99 local utility u=0.006619 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9999528399876454, 'loss_val': 0.018550843756111764, 'psi': 0.9979966307539154}-{'f1_val': 0.99518968612894, 'auprc': 0.9991879972161868, 'loss_val': 0.020478243191329504, 'psi': 0.9967890105638387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=100 psi=0.998 u=0.0066 p_local=0.0121 f1=0.997 auprc=1.000 bytes=98858
[S10] START round=99 head_norm_before_train=2.274147 cos_to_last_merge=1.0000 (last merge round=98)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9952165114336412, 'loss_val': 0.029507503921356093, 'psi': 0.99493577010508}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953316359853877, 'loss_val': 0.029293595281330544, 'psi': 0.9949818199257785}
[S11] START round=99 head_norm_before_train=1.825927 cos_to_last_merge=0.9010 (last merge round=23)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=99 local utility u=0.003643 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9990316611726348, 'loss_val': 0.015947924050046944, 'psi': 0.9980533788990997}-{'f1_val': 0.9963090846170353, 'auprc': 0.9989700839256939, 'loss_val': 0.016497510518991843, 'psi': 0.9973734843404987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=100 psi=0.998 u=0.0036 p_local=0.0029 f1=0.997 auprc=0.999 bytes=113213
[S13] START round=99 head_norm_before_train=1.705521 cos_to_last_merge=0.8784 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=99 local utility u=0.086933 metrics={'f1_val': 0.7128035415605793, 'auprc': 0.8251215642913933, 'loss_val': 0.8501684214902759, 'psi': 0.757730750652905}-{'f1_val': 0.7046430343141097, 'auprc': 0.8451904801636965, 'loss_val': 1.0352787028434332, 'psi': 0.7608620126539445}
[S14] START round=99 head_norm_before_train=2.274908 cos_to_last_merge=1.0000 (last merge round=96)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.8700764349800767, 'auprc': 0.9986644565938076, 'loss_val': 0.5768722389901441, 'psi': 0.921511643625569}-{'f1_val': 0.9928091977738309, 'auprc': 0.9985120021487729, 'loss_val': 0.045247879120442626, 'psi': 0.9950903195238077}
[S15] START round=99 head_norm_before_train=1.927766 cos_to_last_merge=0.9249 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.8925764204579876, 'loss_val': 0.6494156359271104, 'psi': 0.7774901214446447}-{'f1_val': 0.9964553122065998, 'auprc': 0.9978600010936094, 'loss_val': 0.021805876359770163, 'psi': 0.9970171877614037}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.777 u=0.0000 p_local=0.1629 f1=0.701 auprc=0.893 bytes=95248
[S16] START round=99 head_norm_before_train=2.289063 (no previous merge yet)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9393371806227819, 'auprc': 0.9874656782602078, 'loss_val': 0.4025603729125613, 'psi': 0.9585885796777522}-{'f1_val': 0.9913790076685718, 'auprc': 0.9896740546069579, 'loss_val': 0.048209327368968984, 'psi': 0.9906970264439262}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.959 u=0.0000 p_local=0.0664 f1=0.939 auprc=0.987 bytes=80888
[S17] START round=99 head_norm_before_train=2.314144 (no previous merge yet)
[S17] round=99 local utility u=0.256388 metrics={'f1_val': 0.8965716844233451, 'auprc': 0.972038780755754, 'loss_val': 0.4953549456149976, 'psi': 0.9267585229563087}-{'f1_val': 0.8413550887752201, 'auprc': 0.9689926916414234, 'loss_val': 0.6676936165295154, 'psi': 0.8924101299217014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S17] r=100 psi=0.927 u=0.2564 p_local=0.1572 f1=0.897 auprc=0.972 bytes=91734
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63209
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=99 metric=0.9947 head_norm=2.276125
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.088479e-03
[S10] stored merged vector for next round verification (round=99)
[S10] DEBUG after merge:  round=99 metric=0.9947 head_norm=2.275506 delta_norm=0.007088
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0010 f1=0.995 auprc=0.995 bytes=102488
[S14] r=100 psi=0.922 u=0.0000 p_local=0.0423 f1=0.870 auprc=0.999 bytes=106112
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] r=100 psi=0.996 u=0.0000 p_local=0.0104 f1=0.993 auprc=0.999 bytes=91669
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S13
[S6] cosine check vs S13: cos=-0.1183
[S6] DROPPED delta from S13 (cos=-0.1183 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0033
[S8] DROPPED delta from S2 (cos=-0.0033 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.1183
[S13] DROPPED delta from S6 (cos=-0.1183 < 0.0)
[S6] r=100 psi=0.780 u=0.7809 p_local=0.3347 f1=0.718 auprc=0.872 bytes=89975
[S2] r=100 psi=0.721 u=0.1887 p_local=0.0762 f1=0.712 auprc=0.736 bytes=91687
[S13] r=100 psi=0.758 u=0.0869 p_local=0.2063 f1=0.713 auprc=0.825 bytes=104388
[runner] rounds complete.
[runner] all agents stopped.
