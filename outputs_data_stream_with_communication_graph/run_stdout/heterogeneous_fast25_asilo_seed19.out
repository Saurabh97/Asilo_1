[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61003
[S3] → join 127.0.0.1:61002
[S4] → join 127.0.0.1:61002
[S5] → join 127.0.0.1:61002
[S6] → join 127.0.0.1:61002
[S7] → join 127.0.0.1:61002
[S8] → join 127.0.0.1:61002
[S9] → join 127.0.0.1:61002
[S10] → join 127.0.0.1:61002
[S11] → join 127.0.0.1:61002
[S13] → join 127.0.0.1:61002
[S14] → join 127.0.0.1:61002
[S15] → join 127.0.0.1:61002
[S16] → join 127.0.0.1:61002
[S17] → join 127.0.0.1:61002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.161812 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.160970 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.161773 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.162354 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.145681 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.127327 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.121864 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.189316 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.146232 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.216689 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.184121 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.175882 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.201203 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.118848 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.200028 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S9
[S4] + discovered S2
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S11
[S4] + discovered S9
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S13
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S2
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S7
[S8] + discovered S6
[S7] + discovered S9
[S8] + discovered S4
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S15
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S7] + discovered S10
[S8] + discovered S5
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S16
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S6
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S4
[S9] + discovered S13
[S10] + discovered S2
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S5
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S10
[S13] + discovered S3
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S9
[S11] + discovered S14
[S13] + discovered S7
[S11] + discovered S15
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S10
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S10
[S14] + discovered S13
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S15
[S15] + discovered S5
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S9
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S8
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S15
[S16] + discovered S17
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61010
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:61014
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61015
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61013
[S2] START round=1 head_norm_before_train=1.164043 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7309710552865181, 'loss_val': 1.3107039780514504, 'psi': 0.3774547021477473}-{'f1_val': 0.1417771333885667, 'auprc': 0.8639010681192298, 'loss_val': 1.3402528444690531, 'psi': 0.430626707280832}
[S3] START round=1 head_norm_before_train=1.177171 (no previous merge yet)
[S3] round=1 local utility u=0.279549 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.999015597501193, 'loss_val': 1.276679238415074, 'psi': 0.48351027836894145}-{'f1_val': 0.13984006561410703, 'auprc': 0.8314280238006386, 'loss_val': 1.3330151337005258, 'psi': 0.4164752488887197}
[S4] START round=1 head_norm_before_train=1.165644 (no previous merge yet)
[S4] round=1 local utility u=0.147308 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7572048574746386, 'loss_val': 1.3281897218432162, 'psi': 0.38701792032696597}-{'f1_val': 0.14022662889518414, 'auprc': 0.6686357220811722, 'loss_val': 1.3570978296684428, 'psi': 0.35159026616957934}
[S5] START round=1 head_norm_before_train=1.174044 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7373307791830253, 'loss_val': 1.270798022047885, 'psi': 0.38028945453035295}-{'f1_val': 0.14226190476190476, 'auprc': 0.7697502424295789, 'loss_val': 1.3336645034081973, 'psi': 0.3932572398289744}
[S6] START round=1 head_norm_before_train=1.149785 (no previous merge yet)
[S6] round=1 local utility u=0.169931 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8571077932942265, 'loss_val': 1.318314885511439, 'psi': 0.42769888654845983}-{'f1_val': 0.14142628205128205, 'auprc': 0.7542445489974045, 'loss_val': 1.3495862153625688, 'psi': 0.386553588829731}
[S7] START round=1 head_norm_before_train=1.148177 (no previous merge yet)
[S7] round=1 local utility u=0.028183 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7884675968103946, 'loss_val': 1.2675252786339506, 'psi': 0.40062113236161284}-{'f1_val': 0.14205682272909165, 'auprc': 0.7876458783766036, 'loss_val': 1.3214268395346842, 'psi': 0.40029244498809646}
[S8] START round=1 head_norm_before_train=1.124863 (no previous merge yet)
[S8] round=1 local utility u=0.553802 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6720410726371537, 'loss_val': 1.335156594647883, 'psi': 0.35279001849063585}-{'f1_val': 0.002625760088446656, 'auprc': 0.5892328651657196, 'loss_val': 1.3703550503290254, 'psi': 0.23726860211935585}
[S9] START round=1 head_norm_before_train=1.197565 (no previous merge yet)
[S9] round=1 local utility u=0.025008 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9938209223439247, 'loss_val': 1.236804219996836, 'psi': 0.48236714322156754}-{'f1_val': 0.141397957139996, 'auprc': 0.9996053001685996, 'loss_val': 1.3041727510493908, 'psi': 0.48468089435143746}
[S10] START round=1 head_norm_before_train=1.158986 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.15775773589849978, 'auprc': 0.8336711518998847, 'loss_val': 1.312377916238624, 'psi': 0.42812310229905376}-{'f1_val': 0.41584779080291717, 'auprc': 0.804380484440643, 'loss_val': 1.3433846295422391, 'psi': 0.5712608682580076}
[S11] START round=1 head_norm_before_train=1.219207 (no previous merge yet)
[S11] round=1 local utility u=0.330304 metrics={'f1_val': 0.14601861427094107, 'auprc': 0.8386858182275102, 'loss_val': 1.3446681924131731, 'psi': 0.42308549585356875}-{'f1_val': 0.0921497856981728, 'auprc': 0.7370266062913818, 'loss_val': 1.3770860732714243, 'psi': 0.35010051393545644}
[S13] START round=1 head_norm_before_train=1.190126 (no previous merge yet)
[S13] round=1 local utility u=0.190244 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7094089282486034, 'loss_val': 1.309096622024018, 'psi': 0.3679950288456732}-{'f1_val': 0.1403857625770531, 'auprc': 0.591896153631196, 'loss_val': 1.3370468979044268, 'psi': 0.32098991899871027}
[S14] START round=1 head_norm_before_train=1.182048 (no previous merge yet)
[S14] round=1 local utility u=0.025835 metrics={'f1_val': 0.1038107752956636, 'auprc': 0.7649411149869775, 'loss_val': 1.344775527337815, 'psi': 0.3682629111721892}-{'f1_val': 0.1038107752956636, 'auprc': 0.7562005309121198, 'loss_val': 1.3702231852654685, 'psi': 0.3647666775422461}
[S15] START round=1 head_norm_before_train=1.207920 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7788923142763108, 'loss_val': 1.3306836557834818, 'psi': 0.39539711652745935}-{'f1_val': 0.13973365136155833, 'auprc': 0.7917808034188798, 'loss_val': 1.362147697139676, 'psi': 0.40055251218448695}
[S16] START round=1 head_norm_before_train=1.125041 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7461426354944253, 'loss_val': 1.3364975227468328, 'psi': 0.38283952431729207}-{'f1_val': 0.3293253561899985, 'auprc': 0.6307363244314937, 'loss_val': 1.3673415269265057, 'psi': 0.4498897434865966}
[S17] START round=1 head_norm_before_train=1.206345 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.15734775724838831, 'auprc': 0.7434315351134296, 'loss_val': 1.323007000896786, 'psi': 0.39178126839440486}-{'f1_val': 0.34384780619597954, 'auprc': 0.6052981425026526, 'loss_val': 1.3503512219067826, 'psi': 0.4484279407186488}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1781 reason=None
[S11] → sending delta(kind=head bytes=1781) to S5@127.0.0.1:61005
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:61017
[S3] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1781 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] cosine check vs S8: cos=0.0158
[S16] RECEIVED delta(kind=head bytes=1789) from S3
[S16] cosine check vs S3: cos=-0.0408
[S16] DROPPED delta from S3 (cos=-0.0408 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1781) from S11
[S5] cosine check vs S11: cos=0.0084
[S8] RECEIVED delta(kind=head bytes=1789) from S7
[S8] cosine check vs S7: cos=0.0131
[S6] RECEIVED delta(kind=head bytes=1788) from S14
[S6] cosine check vs S14: cos=-0.0156
[S6] DROPPED delta from S14 (cos=-0.0156 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S6
[S5] cosine check vs S6: cos=0.0466
[S8] RECEIVED delta(kind=head bytes=1795) from S9
[S8] cosine check vs S9: cos=-0.0331
[S8] DROPPED delta from S9 (cos=-0.0331 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1787) from S13
[S8] cosine check vs S13: cos=0.0273
[S8] RECEIVED delta(kind=head bytes=1788) from S4
[S8] cosine check vs S4: cos=0.1063
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.207716
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.185698e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.745222 delta_norm=0.718570
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.140038
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.248701e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.674276 delta_norm=0.624870
[S8] aggregate: ACCEPT kept=['S7', 'S13', 'S4'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1573 head_norm=1.221485
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.287960e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3883 head_norm=0.841994 delta_norm=0.828796
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.177225 (no previous merge yet)
[S2] round=2 local utility u=0.039328 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7465423123837469, 'loss_val': 1.2787625233059579, 'psi': 0.3836832049866388}-{'f1_val': 0.1417771333885667, 'auprc': 0.7309710552865181, 'loss_val': 1.3107039780514504, 'psi': 0.3774547021477473}
[S3] START round=2 head_norm_before_train=1.217656 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8575410436221323, 'loss_val': 1.2062070332661006, 'psi': 0.42692045681731716}-{'f1_val': 0.13984006561410703, 'auprc': 0.999015597501193, 'loss_val': 1.276679238415074, 'psi': 0.48351027836894145}
[S4] START round=2 head_norm_before_train=1.178948 (no previous merge yet)
[S4] round=2 local utility u=0.069608 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7895763560025717, 'loss_val': 1.286087776514884, 'psi': 0.3999665197381392}-{'f1_val': 0.14022662889518414, 'auprc': 0.7572048574746386, 'loss_val': 1.3281897218432162, 'psi': 0.38701792032696597}
[S5] START round=2 head_norm_before_train=0.745222 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.003898 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7323104866996795, 'loss_val': 1.2479404280700452, 'psi': 0.37828133753701465}-{'f1_val': 0.14226190476190476, 'auprc': 0.7373307791830253, 'loss_val': 1.270798022047885, 'psi': 0.38028945453035295}
[S6] START round=2 head_norm_before_train=1.163909 (no previous merge yet)
[S6] round=2 local utility u=0.024005 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8627394032803738, 'loss_val': 1.287200679363944, 'psi': 0.42995153054291874}-{'f1_val': 0.14142628205128205, 'auprc': 0.8571077932942265, 'loss_val': 1.318314885511439, 'psi': 0.42769888654845983}
[S7] START round=2 head_norm_before_train=1.189794 (no previous merge yet)
[S7] round=2 local utility u=0.039516 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.79495740344988, 'loss_val': 1.2079626270841881, 'psi': 0.403217055017407}-{'f1_val': 0.14205682272909165, 'auprc': 0.7884675968103946, 'loss_val': 1.2675252786339506, 'psi': 0.40062113236161284}
[S8] START round=2 head_norm_before_train=0.674276 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.106659 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7401810366753099, 'loss_val': 1.3262587084970379, 'psi': 0.3800460041058983}-{'f1_val': 0.13995598239295717, 'auprc': 0.6720410726371537, 'loss_val': 1.335156594647883, 'psi': 0.35279001849063585}
[S9] START round=2 head_norm_before_train=1.236475 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661127563656735, 'loss_val': 1.1281531205431896, 'psi': 0.43128387683026703}-{'f1_val': 0.141397957139996, 'auprc': 0.9938209223439247, 'loss_val': 1.236804219996836, 'psi': 0.48236714322156754}
[S10] START round=2 head_norm_before_train=1.179292 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7972722461064649, 'loss_val': 1.2703253958522167, 'psi': 0.4020818809676203}-{'f1_val': 0.15775773589849978, 'auprc': 0.8336711518998847, 'loss_val': 1.312377916238624, 'psi': 0.42812310229905376}
[S11] START round=2 head_norm_before_train=1.230412 (no previous merge yet)
[S11] round=2 local utility u=0.032776 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8599507478404719, 'loss_val': 1.309280505020458, 'psi': 0.4282285091600551}-{'f1_val': 0.14601861427094107, 'auprc': 0.8386858182275102, 'loss_val': 1.3446681924131731, 'psi': 0.42308549585356875}
[S13] START round=2 head_norm_before_train=1.203723 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6752648856023107, 'loss_val': 1.278578861418527, 'psi': 0.3543374117871561}-{'f1_val': 0.1403857625770531, 'auprc': 0.7094089282486034, 'loss_val': 1.309096622024018, 'psi': 0.3679950288456732}
[S14] START round=2 head_norm_before_train=1.199176 (no previous merge yet)
[S14] round=2 local utility u=0.521983 metrics={'f1_val': 0.3033295214637579, 'auprc': 0.7037295914163532, 'loss_val': 1.314287530220068, 'psi': 0.46348954944479603}-{'f1_val': 0.1038107752956636, 'auprc': 0.7649411149869775, 'loss_val': 1.344775527337815, 'psi': 0.3682629111721892}
[S15] START round=2 head_norm_before_train=1.224892 (no previous merge yet)
[S15] round=2 local utility u=0.018546 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.780356228374357, 'loss_val': 1.2979834862933473, 'psi': 0.3959826821666778}-{'f1_val': 0.13973365136155833, 'auprc': 0.7788923142763108, 'loss_val': 1.3306836557834818, 'psi': 0.39539711652745935}
[S16] START round=2 head_norm_before_train=1.141479 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6567003440222636, 'loss_val': 1.299175097334397, 'psi': 0.34706260772842734}-{'f1_val': 0.14063745019920318, 'auprc': 0.7461426354944253, 'loss_val': 1.3364975227468328, 'psi': 0.38283952431729207}
[S17] START round=2 head_norm_before_train=0.841994 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6048620556827342, 'loss_val': 1.328719101848082, 'psi': 0.3265142002635243}-{'f1_val': 0.15734775724838831, 'auprc': 0.7434315351134296, 'loss_val': 1.323007000896786, 'psi': 0.39178126839440486}
[S6] not sending this round → trigger blocked (psi=0.430)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.400)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S2] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:61016
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.403)
[S14] not sending this round → trigger blocked (psi=0.463)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:61014
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.428)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:61016
[S8] not sending this round → trigger blocked (psi=0.380)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1786 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S5
[S14] cosine check vs S5: cos=0.0682
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] cosine check vs S15: cos=-0.0583
[S16] DROPPED delta from S15 (cos=-0.0583 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1786) from S2
[S16] cosine check vs S2: cos=-0.0068
[S16] DROPPED delta from S2 (cos=-0.0068 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.3033 head_norm=1.222696
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.046452e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.3964 head_norm=0.749908 delta_norm=0.704645
[S14] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.198555 (no previous merge yet)
[S2] round=3 local utility u=0.015041 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7447321495237221, 'loss_val': 1.243249596449322, 'psi': 0.3829591398426289}-{'f1_val': 0.1417771333885667, 'auprc': 0.7465423123837469, 'loss_val': 1.2787625233059579, 'psi': 0.3836832049866388}
[S3] START round=3 head_norm_before_train=1.269851 (no previous merge yet)
[S3] round=3 local utility u=0.846918 metrics={'f1_val': 0.4224727193828194, 'auprc': 0.8040040712590365, 'loss_val': 1.0475567551961733, 'psi': 0.5750852601333063}-{'f1_val': 0.13984006561410703, 'auprc': 0.8575410436221323, 'loss_val': 1.2062070332661006, 'psi': 0.42692045681731716}
[S4] START round=3 head_norm_before_train=1.203513 (no previous merge yet)
[S4] round=3 local utility u=0.036142 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.791332815662504, 'loss_val': 1.2190739052836772, 'psi': 0.4006691036021121}-{'f1_val': 0.14022662889518414, 'auprc': 0.7895763560025717, 'loss_val': 1.286087776514884, 'psi': 0.3999665197381392}
[S5] START round=3 head_norm_before_train=0.789169 cos_to_last_merge=0.9921 (last merge round=1)
[S5] round=3 local utility u=0.063417 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7546719907156605, 'loss_val': 1.1881903378100975, 'psi': 0.3872259391434071}-{'f1_val': 0.14226190476190476, 'auprc': 0.7323104866996795, 'loss_val': 1.2479404280700452, 'psi': 0.37828133753701465}
[S6] START round=3 head_norm_before_train=1.186010 (no previous merge yet)
[S6] round=3 local utility u=0.015432 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8623491291751649, 'loss_val': 1.2551659576347274, 'psi': 0.4297954209008352}-{'f1_val': 0.14142628205128205, 'auprc': 0.8627394032803738, 'loss_val': 1.287200679363944, 'psi': 0.42995153054291874}
[S7] START round=3 head_norm_before_train=1.235177 (no previous merge yet)
[S7] round=3 local utility u=0.886014 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.7950016754203534, 'loss_val': 1.0874107439722434, 'psi': 0.5683691362679055}-{'f1_val': 0.14205682272909165, 'auprc': 0.79495740344988, 'loss_val': 1.2079626270841881, 'psi': 0.403217055017407}
[S8] START round=3 head_norm_before_train=0.699563 cos_to_last_merge=0.9949 (last merge round=1)
[S8] round=3 local utility u=0.063846 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7706586253578279, 'loss_val': 1.2899998735062015, 'psi': 0.3922370395789055}-{'f1_val': 0.13995598239295717, 'auprc': 0.7401810366753099, 'loss_val': 1.3262587084970379, 'psi': 0.3800460041058983}
[S9] START round=3 head_norm_before_train=1.295145 (no previous merge yet)
[S9] round=3 local utility u=0.953088 metrics={'f1_val': 0.4165724968026165, 'auprc': 0.8660044305648033, 'loss_val': 0.8726995904147724, 'psi': 0.5963452703074912}-{'f1_val': 0.141397957139996, 'auprc': 0.8661127563656735, 'loss_val': 1.1281531205431896, 'psi': 0.43128387683026703}
[S10] START round=3 head_norm_before_train=1.208318 (no previous merge yet)
[S10] round=3 local utility u=0.004729 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7775151443550253, 'loss_val': 1.2015963175685547, 'psi': 0.39417904026704453}-{'f1_val': 0.13862163754172394, 'auprc': 0.7972722461064649, 'loss_val': 1.2703253958522167, 'psi': 0.4020818809676203}
[S11] START round=3 head_norm_before_train=1.250491 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.763333112961738, 'loss_val': 1.2613692626961357, 'psi': 0.3895814552085616}-{'f1_val': 0.14041368337311058, 'auprc': 0.8599507478404719, 'loss_val': 1.309280505020458, 'psi': 0.4282285091600551}
[S13] START round=3 head_norm_before_train=1.225997 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5823197013983169, 'loss_val': 1.2393860974061477, 'psi': 0.31715933810555863}-{'f1_val': 0.1403857625770531, 'auprc': 0.6752648856023107, 'loss_val': 1.278578861418527, 'psi': 0.3543374117871561}
[S14] START round=3 head_norm_before_train=0.749908 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8524912752511014, 'loss_val': 1.3055186000048968, 'psi': 0.4252112218300628}-{'f1_val': 0.3033295214637579, 'auprc': 0.7037295914163532, 'loss_val': 1.314287530220068, 'psi': 0.46348954944479603}
[S15] START round=3 head_norm_before_train=1.247084 (no previous merge yet)
[S15] round=3 local utility u=0.012164 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7777243008780039, 'loss_val': 1.265760551120789, 'psi': 0.3949299111681366}-{'f1_val': 0.13973365136155833, 'auprc': 0.780356228374357, 'loss_val': 1.2979834862933473, 'psi': 0.3959826821666778}
[S16] START round=3 head_norm_before_train=1.165635 (no previous merge yet)
[S16] round=3 local utility u=0.000657 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6439919401227394, 'loss_val': 1.25973628101512, 'psi': 0.34197924616861763}-{'f1_val': 0.14063745019920318, 'auprc': 0.6567003440222636, 'loss_val': 1.299175097334397, 'psi': 0.34706260772842734}
[S17] START round=3 head_norm_before_train=0.862461 cos_to_last_merge=0.9966 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5884128098881514, 'loss_val': 1.2818519157323551, 'psi': 0.3199345019456912}-{'f1_val': 0.14094896331738438, 'auprc': 0.6048620556827342, 'loss_val': 1.328719101848082, 'psi': 0.3265142002635243}
[S2] not sending this round → trigger blocked (psi=0.383)
[S5] not sending this round → trigger blocked (psi=0.387)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S15] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61008
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=-0.0220
[S14] DROPPED delta from S10 (cos=-0.0220 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.1386
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.2760
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.0448
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.0277
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=-0.0595
[S17] DROPPED delta from S6 (cos=-0.0595 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=-0.0651
[S17] DROPPED delta from S7 (cos=-0.0651 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.0977
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.278675
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.516379e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.979061 delta_norm=0.851638
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.4173 head_norm=1.278082
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.553748e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.4178 head_norm=0.894547 delta_norm=0.855375
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.733590
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.267112e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.802267 delta_norm=0.626711
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.272189
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.025439e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.764684 delta_norm=0.702544
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.894424
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.055586e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.826254 delta_norm=0.805559
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.225189 (no previous merge yet)
[S2] round=4 local utility u=0.022172 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7459030634652385, 'loss_val': 1.2024190306667928, 'psi': 0.3834275054192354}-{'f1_val': 0.1417771333885667, 'auprc': 0.7447321495237221, 'loss_val': 1.243249596449322, 'psi': 0.3829591398426289}
[S3] START round=4 head_norm_before_train=1.316314 (no previous merge yet)
[S3] round=4 local utility u=0.940764 metrics={'f1_val': 0.5824186119589253, 'auprc': 0.9979982003954253, 'loss_val': 0.7076857858374955, 'psi': 0.7486504473335254}-{'f1_val': 0.4224727193828194, 'auprc': 0.8040040712590365, 'loss_val': 1.0475567551961733, 'psi': 0.5750852601333063}
[S4] START round=4 head_norm_before_train=1.238807 (no previous merge yet)
[S4] round=4 local utility u=0.369553 metrics={'f1_val': 0.2468668805852983, 'auprc': 0.7923882985138216, 'loss_val': 1.122976235101323, 'psi': 0.4650754477567076}-{'f1_val': 0.14022662889518414, 'auprc': 0.791332815662504, 'loss_val': 1.2190739052836772, 'psi': 0.4006691036021121}
[S5] START round=4 head_norm_before_train=0.820522 cos_to_last_merge=0.9814 (last merge round=1)
[S5] round=4 local utility u=0.904129 metrics={'f1_val': 0.4167436894719335, 'auprc': 0.7716080669202293, 'loss_val': 1.0776316527234817, 'psi': 0.5586894404512519}-{'f1_val': 0.14226190476190476, 'auprc': 0.7546719907156605, 'loss_val': 1.1881903378100975, 'psi': 0.3872259391434071}
[S6] START round=4 head_norm_before_train=1.213098 (no previous merge yet)
[S6] round=4 local utility u=0.014027 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.863554932174587, 'loss_val': 1.230729172826697, 'psi': 0.43027774210060404}-{'f1_val': 0.14142628205128205, 'auprc': 0.8623491291751649, 'loss_val': 1.2551659576347274, 'psi': 0.4297954209008352}
[S7] START round=4 head_norm_before_train=0.894547 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.064825 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7849487671652831, 'loss_val': 0.9268645301242879, 'psi': 0.5642742990251772}-{'f1_val': 0.4172807768329403, 'auprc': 0.7950016754203534, 'loss_val': 1.0874107439722434, 'psi': 0.5683691362679055}
[S8] START round=4 head_norm_before_train=0.802267 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7668493219586334, 'loss_val': 1.2922872449576388, 'psi': 0.3907133182192277}-{'f1_val': 0.13995598239295717, 'auprc': 0.7706586253578279, 'loss_val': 1.2899998735062015, 'psi': 0.3922370395789055}
[S9] START round=4 head_norm_before_train=1.365008 (no previous merge yet)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9989901921262152, 'loss_val': 0.5231941254461051, 'psi': 0.820564986281423}-{'f1_val': 0.4165724968026165, 'auprc': 0.8660044305648033, 'loss_val': 0.8726995904147724, 'psi': 0.5963452703074912}
[S10] START round=4 head_norm_before_train=1.245034 (no previous merge yet)
[S10] round=4 local utility u=0.005198 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7479860568964065, 'loss_val': 1.102613083126527, 'psi': 0.382367405283597}-{'f1_val': 0.13862163754172394, 'auprc': 0.7775151443550253, 'loss_val': 1.2015963175685547, 'psi': 0.39417904026704453}
[S11] START round=4 head_norm_before_train=0.979061 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7543432188430252, 'loss_val': 1.2438752661606531, 'psi': 0.3859854975610765}-{'f1_val': 0.14041368337311058, 'auprc': 0.763333112961738, 'loss_val': 1.2613692626961357, 'psi': 0.3895814552085616}
[S13] START round=4 head_norm_before_train=1.256416 (no previous merge yet)
[S13] round=4 local utility u=0.045530 metrics={'f1_val': 0.15503807124507837, 'auprc': 0.5650192410771842, 'loss_val': 1.184338456507772, 'psi': 0.3190305391779207}-{'f1_val': 0.1403857625770531, 'auprc': 0.5823197013983169, 'loss_val': 1.2393860974061477, 'psi': 0.31715933810555863}
[S14] START round=4 head_norm_before_train=0.779335 cos_to_last_merge=0.9968 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8317494663158976, 'loss_val': 1.2613438190656157, 'psi': 0.4169144982559813}-{'f1_val': 0.14035785288270378, 'auprc': 0.8524912752511014, 'loss_val': 1.3055186000048968, 'psi': 0.4252112218300628}
[S15] START round=4 head_norm_before_train=0.764684 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764704575270676, 'loss_val': 1.2707855485229842, 'psi': 0.394428373827762}-{'f1_val': 0.13973365136155833, 'auprc': 0.7777243008780039, 'loss_val': 1.265760551120789, 'psi': 0.3949299111681366}
[S16] START round=4 head_norm_before_train=1.195937 (no previous merge yet)
[S16] round=4 local utility u=0.002509 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6311393511967676, 'loss_val': 1.2161607968009842, 'psi': 0.33683821059822894}-{'f1_val': 0.14063745019920318, 'auprc': 0.6439919401227394, 'loss_val': 1.25973628101512, 'psi': 0.34197924616861763}
[S17] START round=4 head_norm_before_train=0.826254 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.038832 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6069298955789262, 'loss_val': 1.2597382570877917, 'psi': 0.3273413362220011}-{'f1_val': 0.14094896331738438, 'auprc': 0.5884128098881514, 'loss_val': 1.2818519157323551, 'psi': 0.3199345019456912}
[S3] not sending this round → trigger blocked (psi=0.749)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.382)
[S7] not sending this round → trigger blocked (psi=0.564)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:61009
[S4] not sending this round → trigger blocked (psi=0.465)
[S6] not sending this round → trigger blocked (psi=0.430)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.337)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S9] not sending this round → trigger blocked (psi=0.821)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] cosine check vs S2: cos=0.1103
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.2822
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] cosine check vs S13: cos=-0.0157
[S7] DROPPED delta from S13 (cos=-0.0157 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S17
[S13] cosine check vs S17: cos=-0.0662
[S13] DROPPED delta from S17 (cos=-0.0662 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.826496
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.126147e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.788846 delta_norm=0.712615
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.013999
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.634782e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.749817 delta_norm=0.563478
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.255826 (no previous merge yet)
[S2] round=5 local utility u=0.040239 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7476447987850288, 'loss_val': 1.1271656171499183, 'psi': 0.38412419954715155}-{'f1_val': 0.1417771333885667, 'auprc': 0.7459030634652385, 'loss_val': 1.2024190306667928, 'psi': 0.3834275054192354}
[S3] START round=5 head_norm_before_train=1.388314 (no previous merge yet)
[S3] round=5 local utility u=0.104909 metrics={'f1_val': 0.5899537635481809, 'auprc': 0.9990398251452364, 'loss_val': 0.5462036522240958, 'psi': 0.753588188187003}-{'f1_val': 0.5824186119589253, 'auprc': 0.9979982003954253, 'loss_val': 0.7076857858374955, 'psi': 0.7486504473335254}
[S4] START round=5 head_norm_before_train=1.278829 (no previous merge yet)
[S4] round=5 local utility u=0.579262 metrics={'f1_val': 0.4150135411368775, 'auprc': 0.7912138619906778, 'loss_val': 0.9698082178562059, 'psi': 0.5654936694783976}-{'f1_val': 0.2468668805852983, 'auprc': 0.7923882985138216, 'loss_val': 1.122976235101323, 'psi': 0.4650754477567076}
[S5] START round=5 head_norm_before_train=0.855145 cos_to_last_merge=0.9685 (last merge round=1)
[S5] round=5 local utility u=0.092943 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7787488984065642, 'loss_val': 0.9189563142525912, 'psi': 0.5621246463092768}-{'f1_val': 0.4167436894719335, 'auprc': 0.7716080669202293, 'loss_val': 1.0776316527234817, 'psi': 0.5586894404512519}
[S6] START round=5 head_norm_before_train=1.228716 (no previous merge yet)
[S6] round=5 local utility u=0.042620 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8787855305294808, 'loss_val': 1.191181389709604, 'psi': 0.43636998144256156}-{'f1_val': 0.14142628205128205, 'auprc': 0.863554932174587, 'loss_val': 1.230729172826697, 'psi': 0.43027774210060404}
[S7] START round=5 head_norm_before_train=0.964359 cos_to_last_merge=0.9939 (last merge round=3)
[S7] round=5 local utility u=0.454548 metrics={'f1_val': 0.5601899319199861, 'auprc': 0.7672989500583219, 'loss_val': 0.8230104901164593, 'psi': 0.6430335391753205}-{'f1_val': 0.4171579869317734, 'auprc': 0.7849487671652831, 'loss_val': 0.9268645301242879, 'psi': 0.5642742990251772}
[S8] START round=5 head_norm_before_train=0.788846 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.5451739556302234, 'loss_val': 1.2744661464963023, 'psi': 0.3020431716878637}-{'f1_val': 0.13995598239295717, 'auprc': 0.7668493219586334, 'loss_val': 1.2922872449576388, 'psi': 0.3907133182192277}
[S9] START round=5 head_norm_before_train=1.445468 (no previous merge yet)
[S9] round=5 local utility u=0.099538 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998657252014964, 'loss_val': 0.32117269414847993, 'psi': 0.8202371909305237}-{'f1_val': 0.7016148490515617, 'auprc': 0.9989901921262152, 'loss_val': 0.5231941254461051, 'psi': 0.820564986281423}
[S10] START round=5 head_norm_before_train=1.284990 (no previous merge yet)
[S10] round=5 local utility u=0.928655 metrics={'f1_val': 0.41694859683592245, 'auprc': 0.7645280617502203, 'loss_val': 0.9648913339596078, 'psi': 0.5559803828016416}-{'f1_val': 0.13862163754172394, 'auprc': 0.7479860568964065, 'loss_val': 1.102613083126527, 'psi': 0.382367405283597}
[S11] START round=5 head_norm_before_train=0.749817 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5976114138876755, 'loss_val': 1.207022031296986, 'psi': 0.32329277557893654}-{'f1_val': 0.14041368337311058, 'auprc': 0.7543432188430252, 'loss_val': 1.2438752661606531, 'psi': 0.3859854975610765}
[S13] START round=5 head_norm_before_train=1.291351 (no previous merge yet)
[S13] round=5 local utility u=0.797136 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.5451920686974502, 'loss_val': 1.0996583219952474, 'psi': 0.46800703292642043}-{'f1_val': 0.15503807124507837, 'auprc': 0.5650192410771842, 'loss_val': 1.184338456507772, 'psi': 0.3190305391779207}
[S14] START round=5 head_norm_before_train=0.816969 cos_to_last_merge=0.9894 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7586068133434921, 'loss_val': 1.1930519801841473, 'psi': 0.3876574370670191}-{'f1_val': 0.14035785288270378, 'auprc': 0.8317494663158976, 'loss_val': 1.2613438190656157, 'psi': 0.4169144982559813}
[S15] START round=5 head_norm_before_train=0.793508 cos_to_last_merge=0.9971 (last merge round=3)
[S15] round=5 local utility u=0.025979 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7779075924187323, 'loss_val': 1.2231389380005482, 'psi': 0.3950032277844279}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764704575270676, 'loss_val': 1.2707855485229842, 'psi': 0.394428373827762}
[S16] START round=5 head_norm_before_train=1.226956 (no previous merge yet)
[S16] round=5 local utility u=0.590280 metrics={'f1_val': 0.4140870532610207, 'auprc': 0.45187022875965766, 'loss_val': 1.1384902762640763, 'psi': 0.42920032346047543}-{'f1_val': 0.14063745019920318, 'auprc': 0.6311393511967676, 'loss_val': 1.2161607968009842, 'psi': 0.33683821059822894}
[S17] START round=5 head_norm_before_train=0.849158 cos_to_last_merge=0.9963 (last merge round=3)
[S17] round=5 local utility u=0.014770 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5873809175801321, 'loss_val': 1.1715508771244896, 'psi': 0.3195217450224835}-{'f1_val': 0.14094896331738438, 'auprc': 0.6069298955789262, 'loss_val': 1.2597382570877917, 'psi': 0.3273413362220011}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[S13] not sending this round → trigger blocked (psi=0.468)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[S2] not sending this round → trigger blocked (psi=0.384)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:61010
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.7832
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=-0.0211
[S17] DROPPED delta from S6 (cos=-0.0211 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.6319
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=-0.0164
[S14] DROPPED delta from S10 (cos=-0.0164 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=-0.0467
[S17] DROPPED delta from S7 (cos=-0.0467 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=-0.1580
[S9] DROPPED delta from S15 (cos=-0.1580 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.5040
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.5188
[S17] not sending this round → trigger blocked (psi=0.320)
[S5] ⇄ pheromone p=0.499 → S11@127.0.0.1:61012
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.791864
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.278214e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.998677 delta_norm=0.627821
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.358 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.345 → S8@127.0.0.1:61009
[S13] ⇄ pheromone p=0.510 → S7@127.0.0.1:61008
[S14] ⇄ pheromone p=0.383 → S8@127.0.0.1:61009
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.814514
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.753264e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.934474 delta_norm=0.575326
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.392 → S15@127.0.0.1:61015
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.5602 head_norm=1.041091
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.039292e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.6696 head_norm=1.041191 delta_norm=0.503929
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.549 → S17@127.0.0.1:61017
[S4] ⇄ pheromone p=0.526 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=0.515 → S14@127.0.0.1:61014
[S9] ⇄ pheromone p=0.632 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.630 → S11@127.0.0.1:61012
[S15] ⇄ pheromone p=0.336 → S9@127.0.0.1:61010
[S16] ⇄ pheromone p=0.446 → S7@127.0.0.1:61008
[S6] ⇄ pheromone p=0.357 → S17@127.0.0.1:61017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.879198
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.017263e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=1.142480 delta_norm=0.501726
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.337 → S13@127.0.0.1:61013
[S2] START round=6 head_norm_before_train=1.286016 (no previous merge yet)
[S2] round=6 local utility u=0.057040 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7448257481954855, 'loss_val': 1.0046290485913245, 'psi': 0.38299657931133424}-{'f1_val': 0.1417771333885667, 'auprc': 0.7476447987850288, 'loss_val': 1.1271656171499183, 'psi': 0.38412419954715155}
[S3] START round=6 head_norm_before_train=1.468326 (no previous merge yet)
[S3] round=6 local utility u=0.416335 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9986659919607581, 'loss_val': 0.37617873486268305, 'psi': 0.8198152343795563}-{'f1_val': 0.5899537635481809, 'auprc': 0.9990398251452364, 'loss_val': 0.5462036522240958, 'psi': 0.753588188187003}
[S4] START round=6 head_norm_before_train=1.321004 (no previous merge yet)
[S4] round=6 local utility u=0.089284 metrics={'f1_val': 0.41550149173126444, 'auprc': 0.7846937219681286, 'loss_val': 0.7746070418001928, 'psi': 0.5631783838260102}-{'f1_val': 0.4150135411368775, 'auprc': 0.7912138619906778, 'loss_val': 0.9698082178562059, 'psi': 0.5654936694783976}
[S5] START round=6 head_norm_before_train=0.908473 cos_to_last_merge=0.9475 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=6 local utility u=0.176572 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.856988157499051, 'loss_val': 0.7995584314036625, 'psi': 0.5933231941041476}-{'f1_val': 0.41770847824441854, 'auprc': 0.7787488984065642, 'loss_val': 0.9189563142525912, 'psi': 0.5621246463092768}
[S6] START round=6 head_norm_before_train=1.249379 (no previous merge yet)
[S6] round=6 local utility u=0.153951 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9520685607549111, 'loss_val': 1.1031294739565816, 'psi': 0.4656831935327337}-{'f1_val': 0.14142628205128205, 'auprc': 0.8787855305294808, 'loss_val': 1.191181389709604, 'psi': 0.43636998144256156}
[S7] START round=6 head_norm_before_train=1.041191 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.385842 metrics={'f1_val': 0.679593466041997, 'auprc': 0.7714295950746208, 'loss_val': 0.7801399478065049, 'psi': 0.7163279176550466}-{'f1_val': 0.5601899319199861, 'auprc': 0.7672989500583219, 'loss_val': 0.8230104901164593, 'psi': 0.6430335391753205}
[S8] START round=6 head_norm_before_train=0.934474 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.157181 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.631811584571148, 'loss_val': 1.2200174855705577, 'psi': 0.33669822326423354}-{'f1_val': 0.13995598239295717, 'auprc': 0.5451739556302234, 'loss_val': 1.2744661464963023, 'psi': 0.3020431716878637}
[S9] START round=6 head_norm_before_train=1.530029 (no previous merge yet)
[S9] round=6 local utility u=0.037075 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979469022109787, 'loss_val': 0.24444743366407584, 'psi': 0.8199087093484027}-{'f1_val': 0.7012904835408967, 'auprc': 0.998657252014964, 'loss_val': 0.32117269414847993, 'psi': 0.8202371909305237}
[S10] START round=6 head_norm_before_train=1.322898 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.7089445796120125, 'loss_val': 0.8027146424742666, 'psi': 0.5167838532675646}-{'f1_val': 0.41694859683592245, 'auprc': 0.7645280617502203, 'loss_val': 0.9648913339596078, 'psi': 0.5559803828016416}
[S11] START round=6 head_norm_before_train=0.998677 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.655160 metrics={'f1_val': 0.3270966965327625, 'auprc': 0.6358726267988031, 'loss_val': 1.1315842135709204, 'psi': 0.45060706863917876}-{'f1_val': 0.14041368337311058, 'auprc': 0.5976114138876755, 'loss_val': 1.207022031296986, 'psi': 0.32329277557893654}
[S13] START round=6 head_norm_before_train=1.333312 (no previous merge yet)
[S13] round=6 local utility u=0.051059 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.5383459146946049, 'loss_val': 0.9737234922539805, 'psi': 0.46494068563731905}-{'f1_val': 0.41655034241240063, 'auprc': 0.5451920686974502, 'loss_val': 1.0996583219952474, 'psi': 0.46800703292642043}
[S14] START round=6 head_norm_before_train=0.859819 cos_to_last_merge=0.9804 (last merge round=2)
[S14] round=6 local utility u=0.814943 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.7424722518863667, 'loss_val': 1.05197863203871, 'psi': 0.5349252221407417}-{'f1_val': 0.14035785288270378, 'auprc': 0.7586068133434921, 'loss_val': 1.1930519801841473, 'psi': 0.3876574370670191}
[S15] START round=6 head_norm_before_train=0.824463 cos_to_last_merge=0.9899 (last merge round=3)
[S15] round=6 local utility u=0.627904 metrics={'f1_val': 0.32645567741471715, 'auprc': 0.7970226315527793, 'loss_val': 1.1450088977715704, 'psi': 0.514682459069942}-{'f1_val': 0.13973365136155833, 'auprc': 0.7779075924187323, 'loss_val': 1.2231389380005482, 'psi': 0.3950032277844279}
[S16] START round=6 head_norm_before_train=1.261816 (no previous merge yet)
[S16] round=6 local utility u=0.329076 metrics={'f1_val': 0.4168465600829343, 'auprc': 0.6390301762693438, 'loss_val': 1.0583753350784741, 'psi': 0.505720006557498}-{'f1_val': 0.4140870532610207, 'auprc': 0.45187022875965766, 'loss_val': 1.1384902762640763, 'psi': 0.42920032346047543}
[S17] START round=6 head_norm_before_train=1.142480 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=1.000000 metrics={'f1_val': 0.539465831066994, 'auprc': 0.6587642796966353, 'loss_val': 1.0769955256049168, 'psi': 0.5871852105188504}-{'f1_val': 0.14094896331738438, 'auprc': 0.5873809175801321, 'loss_val': 1.1715508771244896, 'psi': 0.3195217450224835}
[S9] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.716)
[S6] not sending this round → trigger blocked (psi=0.466)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S4] not sending this round → trigger blocked (psi=0.563)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S15] not sending this round → trigger blocked (psi=0.515)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S16] not sending this round → trigger blocked (psi=0.506)
[S3] not sending this round → trigger blocked (psi=0.820)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1791) from S5
[S11] cosine check vs S5: cos=0.3492
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=-0.0109
[S8] DROPPED delta from S11 (cos=-0.0109 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.4138
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=-0.0391
[S8] DROPPED delta from S14 (cos=-0.0391 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=-0.0131
[S7] DROPPED delta from S13 (cos=-0.0131 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.2274
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0567
[S13] DROPPED delta from S17 (cos=-0.0567 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.3265 head_norm=0.861074
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.647029e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.2694 head_norm=0.710916 delta_norm=0.564703
[S15] aggregate: ROLLBACK (f1_val pre=0.326 post=0.269 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.3271 head_norm=1.028780
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.718712e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.822925 delta_norm=0.571871
[S11] aggregate: ROLLBACK (f1_val pre=0.327 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.952436
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.333259e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.959378 delta_norm=0.633326
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.317529 (no previous merge yet)
[S2] round=7 local utility u=1.000000 metrics={'f1_val': 0.7010339554510421, 'auprc': 0.6543860781723417, 'loss_val': 0.832514878506014, 'psi': 0.6823748045395619}-{'f1_val': 0.1417771333885667, 'auprc': 0.7448257481954855, 'loss_val': 1.0046290485913245, 'psi': 0.38299657931133424}
[S3] START round=7 head_norm_before_train=1.536629 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9969201968359119, 'loss_val': 0.3606194638588689, 'psi': 0.8144180060238012}-{'f1_val': 0.7005813959920884, 'auprc': 0.9986659919607581, 'loss_val': 0.37617873486268305, 'psi': 0.8198152343795563}
[S4] START round=7 head_norm_before_train=1.366092 (no previous merge yet)
[S4] round=7 local utility u=0.606013 metrics={'f1_val': 0.6659491533452553, 'auprc': 0.6575499898912522, 'loss_val': 0.68383663706246, 'psi': 0.662589487963654}-{'f1_val': 0.41550149173126444, 'auprc': 0.7846937219681286, 'loss_val': 0.7746070418001928, 'psi': 0.5631783838260102}
[S5] START round=7 head_norm_before_train=0.974729 cos_to_last_merge=0.9187 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.919
[S5] round=7 local utility u=0.114598 metrics={'f1_val': 0.4370288370727938, 'auprc': 0.8717483469854874, 'loss_val': 0.7315372862212529, 'psi': 0.6109166410378712}-{'f1_val': 0.4175465518408786, 'auprc': 0.856988157499051, 'loss_val': 0.7995584314036625, 'psi': 0.5933231941041476}
[S6] START round=7 head_norm_before_train=1.281010 (no previous merge yet)
[S6] round=7 local utility u=0.762228 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.8614215067253598, 'loss_val': 0.9556894448024458, 'psi': 0.5943201040645933}-{'f1_val': 0.14142628205128205, 'auprc': 0.9520685607549111, 'loss_val': 1.1031294739565816, 'psi': 0.4656831935327337}
[S7] START round=7 head_norm_before_train=1.105698 cos_to_last_merge=0.9943 (last merge round=5)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.4006112027421136, 'auprc': 0.7688682076735354, 'loss_val': 0.8485048374994067, 'psi': 0.5479140047146823}-{'f1_val': 0.679593466041997, 'auprc': 0.7714295950746208, 'loss_val': 0.7801399478065049, 'psi': 0.7163279176550466}
[S8] START round=7 head_norm_before_train=0.959378 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.567344711992223, 'loss_val': 1.1873441611494386, 'psi': 0.3109114742326635}-{'f1_val': 0.13995598239295717, 'auprc': 0.631811584571148, 'loss_val': 1.2200174855705577, 'psi': 0.33669822326423354}
[S9] START round=7 head_norm_before_train=1.595756 (no previous merge yet)
[S9] round=7 local utility u=0.903718 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9980743165603501, 'loss_val': 0.16212992649276065, 'psi': 0.9924333511258008}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979469022109787, 'loss_val': 0.24444743366407584, 'psi': 0.8199087093484027}
[S10] START round=7 head_norm_before_train=1.367391 (no previous merge yet)
[S10] round=7 local utility u=0.364621 metrics={'f1_val': 0.3887653133414668, 'auprc': 0.9172374823774664, 'loss_val': 0.6988823411397822, 'psi': 0.6001541809558667}-{'f1_val': 0.38867670237126606, 'auprc': 0.7089445796120125, 'loss_val': 0.8027146424742666, 'psi': 0.5167838532675646}
[S11] START round=7 head_norm_before_train=0.822925 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.459469 metrics={'f1_val': 0.4141702997151663, 'auprc': 0.7329024060931207, 'loss_val': 1.0261768066808992, 'psi': 0.541663142266348}-{'f1_val': 0.3270966965327625, 'auprc': 0.6358726267988031, 'loss_val': 1.1315842135709204, 'psi': 0.45060706863917876}
[S13] START round=7 head_norm_before_train=1.368510 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37148979094291945, 'auprc': 0.5375673605081609, 'loss_val': 0.9329038272149487, 'psi': 0.437920818769016}-{'f1_val': 0.4160038662657951, 'auprc': 0.5383459146946049, 'loss_val': 0.9737234922539805, 'psi': 0.46494068563731905}
[S14] START round=7 head_norm_before_train=0.909597 cos_to_last_merge=0.9683 (last merge round=2)
[S14] round=7 local utility u=0.454726 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9713636971272743, 'loss_val': 0.8290022993873256, 'psi': 0.6264620214980643}-{'f1_val': 0.39656053564365834, 'auprc': 0.7424722518863667, 'loss_val': 1.05197863203871, 'psi': 0.5349252221407417}
[S15] START round=7 head_norm_before_train=0.710916 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.209144 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.755773519647776, 'loss_val': 1.1424949732639722, 'psi': 0.5521349115634768}-{'f1_val': 0.32645567741471715, 'auprc': 0.7970226315527793, 'loss_val': 1.1450088977715704, 'psi': 0.514682459069942}
[S16] START round=7 head_norm_before_train=1.304183 (no previous merge yet)
[S16] round=7 local utility u=0.036519 metrics={'f1_val': 0.40521556573017203, 'auprc': 0.671745743772659, 'loss_val': 1.013698054370844, 'psi': 0.5118276369471668}-{'f1_val': 0.4168465600829343, 'auprc': 0.6390301762693438, 'loss_val': 1.0583753350784741, 'psi': 0.505720006557498}
[S17] START round=7 head_norm_before_train=1.166136 cos_to_last_merge=0.9971 (last merge round=5)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3894099104288671, 'auprc': 0.6859035152810276, 'loss_val': 0.9505057282793933, 'psi': 0.5080073523697313}-{'f1_val': 0.539465831066994, 'auprc': 0.6587642796966353, 'loss_val': 1.0769955256049168, 'psi': 0.5871852105188504}
[S14] not sending this round → trigger blocked (psi=0.626)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:61014
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.611)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:61017
[S11] not sending this round → trigger blocked (psi=0.542)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S2] not sending this round → trigger blocked (psi=0.682)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0188
[S14] DROPPED delta from S10 (cos=-0.0188 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.5031
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.1421
[S9] DROPPED delta from S15 (cos=-0.1421 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.8557
[S17] RECEIVED delta(kind=head bytes=1807) from S9
[S17] cosine check vs S9: cos=0.9267
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.0039
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.1400 head_norm=0.974006
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.234434e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.4163 head_norm=1.038987 delta_norm=0.623443
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4006 head_norm=1.174112
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.478967e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4006 head_norm=1.213000 delta_norm=0.347897
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3894 head_norm=1.203348
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.330410e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3880 head_norm=1.054112 delta_norm=0.433041
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.355232 (no previous merge yet)
[S2] round=8 local utility u=0.088863 metrics={'f1_val': 0.7015542259878702, 'auprc': 0.648749915743959, 'loss_val': 0.6410010229659722, 'psi': 0.6804325018903057}-{'f1_val': 0.7010339554510421, 'auprc': 0.6543860781723417, 'loss_val': 0.832514878506014, 'psi': 0.6823748045395619}
[S3] START round=8 head_norm_before_train=1.593073 (no previous merge yet)
[S3] round=8 local utility u=0.079589 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.998390629102558, 'loss_val': 0.25389066833216684, 'psi': 0.819809973882203}-{'f1_val': 0.6927498788157274, 'auprc': 0.9969201968359119, 'loss_val': 0.3606194638588689, 'psi': 0.8144180060238012}
[S4] START round=8 head_norm_before_train=1.409844 (no previous merge yet)
[S4] round=8 local utility u=0.234514 metrics={'f1_val': 0.6681436520760969, 'auprc': 0.767692114146709, 'loss_val': 0.5584028557720123, 'psi': 0.7079630369043418}-{'f1_val': 0.6659491533452553, 'auprc': 0.6575499898912522, 'loss_val': 0.68383663706246, 'psi': 0.662589487963654}
[S5] START round=8 head_norm_before_train=1.037432 cos_to_last_merge=0.8927 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=8 local utility u=0.761608 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8149160841353661, 'loss_val': 0.6205519860908166, 'psi': 0.7464565489606607}-{'f1_val': 0.4370288370727938, 'auprc': 0.8717483469854874, 'loss_val': 0.7315372862212529, 'psi': 0.6109166410378712}
[S6] START round=8 head_norm_before_train=1.319933 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.788763954213002, 'loss_val': 0.8132919777393993, 'psi': 0.5656186932115213}-{'f1_val': 0.41625250229074906, 'auprc': 0.8614215067253598, 'loss_val': 0.9556894448024458, 'psi': 0.5943201040645933}
[S7] START round=8 head_norm_before_train=1.213000 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.3948911257141996, 'auprc': 0.6080056054920822, 'loss_val': 0.9863240272012819, 'psi': 0.4801369176253526}-{'f1_val': 0.4006112027421136, 'auprc': 0.7688682076735354, 'loss_val': 0.8485048374994067, 'psi': 0.5479140047146823}
[S8] START round=8 head_norm_before_train=1.038987 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.885473 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.6396410981280817, 'loss_val': 1.0295422826326057, 'psi': 0.47945560571351237}-{'f1_val': 0.13995598239295717, 'auprc': 0.567344711992223, 'loss_val': 1.1873441611494386, 'psi': 0.3109114742326635}
[S9] START round=8 head_norm_before_train=1.650908 (no previous merge yet)
[S9] round=8 local utility u=0.053559 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984671531145608, 'loss_val': 0.09911360730179192, 'psi': 0.9968828922643356}-{'f1_val': 0.9886727075027679, 'auprc': 0.9980743165603501, 'loss_val': 0.16212992649276065, 'psi': 0.9924333511258008}
[S10] START round=8 head_norm_before_train=1.412513 (no previous merge yet)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.6954130750102367, 'auprc': 0.9414241322716183, 'loss_val': 0.6011185379269776, 'psi': 0.7938174979147894}-{'f1_val': 0.3887653133414668, 'auprc': 0.9172374823774664, 'loss_val': 0.6988823411397822, 'psi': 0.6001541809558667}
[S11] START round=8 head_norm_before_train=0.864337 cos_to_last_merge=0.9951 (last merge round=6)
[S11] round=8 local utility u=0.350125 metrics={'f1_val': 0.40117310908082265, 'auprc': 0.933566641165281, 'loss_val': 0.8499371070650418, 'psi': 0.614130521914606}-{'f1_val': 0.4141702997151663, 'auprc': 0.7329024060931207, 'loss_val': 1.0261768066808992, 'psi': 0.541663142266348}
[S13] START round=8 head_norm_before_train=1.406176 (no previous merge yet)
[S13] round=8 local utility u=0.674888 metrics={'f1_val': 0.46905147089395316, 'auprc': 0.7380591388865594, 'loss_val': 0.7699740232117234, 'psi': 0.5766545380909956}-{'f1_val': 0.37148979094291945, 'auprc': 0.5375673605081609, 'loss_val': 0.9329038272149487, 'psi': 0.437920818769016}
[S14] START round=8 head_norm_before_train=0.961814 cos_to_last_merge=0.9547 (last merge round=2)
[S14] round=8 local utility u=0.109053 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9965814760274747, 'loss_val': 0.6867482359930326, 'psi': 0.6365689117971849}-{'f1_val': 0.39652757107859105, 'auprc': 0.9713636971272743, 'loss_val': 0.8290022993873256, 'psi': 0.6264620214980643}
[S15] START round=8 head_norm_before_train=0.745519 cos_to_last_merge=0.9949 (last merge round=6)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.38381574747486924, 'auprc': 0.6551029046875158, 'loss_val': 1.005926543320039, 'psi': 0.49233061035992787}-{'f1_val': 0.4163758395072774, 'auprc': 0.755773519647776, 'loss_val': 1.1424949732639722, 'psi': 0.5521349115634768}
[S16] START round=8 head_norm_before_train=1.343973 (no previous merge yet)
[S16] round=8 local utility u=0.100595 metrics={'f1_val': 0.4016028658195537, 'auprc': 0.7351439921948866, 'loss_val': 0.9810259717695413, 'psi': 0.5350193163696868}-{'f1_val': 0.40521556573017203, 'auprc': 0.671745743772659, 'loss_val': 1.013698054370844, 'psi': 0.5118276369471668}
[S17] START round=8 head_norm_before_train=1.054112 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35435030412535395, 'auprc': 0.6737045943264774, 'loss_val': 0.9263588258597378, 'psi': 0.48209202020580333}-{'f1_val': 0.3894099104288671, 'auprc': 0.6859035152810276, 'loss_val': 0.9505057282793933, 'psi': 0.5080073523697313}
[S16] not sending this round → trigger blocked (psi=0.535)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:61009
[S10] not sending this round → trigger blocked (psi=0.794)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.708)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:61015
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.7640
[S8] RECEIVED delta(kind=head bytes=1790) from S14
[S8] cosine check vs S14: cos=-0.0415
[S8] DROPPED delta from S14 (cos=-0.0415 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.4544
[S8] RECEIVED delta(kind=head bytes=1792) from S11
[S8] cosine check vs S11: cos=-0.0357
[S8] DROPPED delta from S11 (cos=-0.0357 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.5848
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=-0.0104
[S7] DROPPED delta from S13 (cos=-0.0104 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] cosine check vs S8: cos=0.6982
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.3838 head_norm=0.786463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.805669e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3839 head_norm=0.853022 delta_norm=0.380567
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3727 head_norm=1.061334
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.603570e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.4160 head_norm=1.055131 delta_norm=0.660357
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4012 head_norm=0.918166
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.373887e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4369 head_norm=0.939795 delta_norm=0.237389
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.404391 (no previous merge yet)
[S2] round=9 local utility u=0.070075 metrics={'f1_val': 0.7020713970912296, 'auprc': 0.6487049700776298, 'loss_val': 0.5038190735318767, 'psi': 0.6807248262857897}-{'f1_val': 0.7015542259878702, 'auprc': 0.648749915743959, 'loss_val': 0.6410010229659722, 'psi': 0.6804325018903057}
[S3] START round=9 head_norm_before_train=1.655204 (no previous merge yet)
[S3] round=9 local utility u=0.038086 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986622231874934, 'loss_val': 0.17808181743948856, 'psi': 0.8198734650741982}-{'f1_val': 0.7007562037352997, 'auprc': 0.998390629102558, 'loss_val': 0.25389066833216684, 'psi': 0.819809973882203}
[S4] START round=9 head_norm_before_train=1.457958 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6495347126496571, 'auprc': 0.649379683395629, 'loss_val': 0.49765256028115085, 'psi': 0.6494727009480459}-{'f1_val': 0.6681436520760969, 'auprc': 0.767692114146709, 'loss_val': 0.5584028557720123, 'psi': 0.7079630369043418}
[S5] START round=9 head_norm_before_train=1.090493 cos_to_last_merge=0.8761 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.876
[S5] round=9 local utility u=0.112682 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8360387764772861, 'loss_val': 0.45855552207934724, 'psi': 0.7549056258974287}-{'f1_val': 0.7008168588441903, 'auprc': 0.8149160841353661, 'loss_val': 0.6205519860908166, 'psi': 0.7464565489606607}
[S6] START round=9 head_norm_before_train=1.360309 (no previous merge yet)
[S6] round=9 local utility u=0.474575 metrics={'f1_val': 0.5213925497535326, 'auprc': 0.829204761830634, 'loss_val': 0.6126882843382878, 'psi': 0.6445174345843732}-{'f1_val': 0.4168551858772006, 'auprc': 0.788763954213002, 'loss_val': 0.8132919777393993, 'psi': 0.5656186932115213}
[S7] START round=9 head_norm_before_train=1.265602 cos_to_last_merge=0.9967 (last merge round=7)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.3807431066716169, 'auprc': 0.5878167304813813, 'loss_val': 1.108518203742407, 'psi': 0.4635725561955227}-{'f1_val': 0.3948911257141996, 'auprc': 0.6080056054920822, 'loss_val': 0.9863240272012819, 'psi': 0.4801369176253526}
[S8] START round=9 head_norm_before_train=1.055131 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.297941 metrics={'f1_val': 0.4158203383005801, 'auprc': 0.737873881664068, 'loss_val': 0.9872894083025122, 'psi': 0.5446417556459753}-{'f1_val': 0.3726652774371328, 'auprc': 0.6396410981280817, 'loss_val': 1.0295422826326057, 'psi': 0.47945560571351237}
[S9] START round=9 head_norm_before_train=1.695851 (no previous merge yet)
[S9] round=9 local utility u=0.012175 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9993216770553413, 'loss_val': 0.0698323480866713, 'psi': 0.9964751795177034}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984671531145608, 'loss_val': 0.09911360730179192, 'psi': 0.9968828922643356}
[S10] START round=9 head_norm_before_train=1.457468 (no previous merge yet)
[S10] round=9 local utility u=0.160229 metrics={'f1_val': 0.701696512414446, 'auprc': 0.9944012529360211, 'loss_val': 0.47729273951565687, 'psi': 0.818778408623076}-{'f1_val': 0.6954130750102367, 'auprc': 0.9414241322716183, 'loss_val': 0.6011185379269776, 'psi': 0.7938174979147894}
[S11] START round=9 head_norm_before_train=0.939795 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.167248 metrics={'f1_val': 0.47543760714106637, 'auprc': 0.8748098929384531, 'loss_val': 0.7847575449782671, 'psi': 0.6351865214600211}-{'f1_val': 0.40117310908082265, 'auprc': 0.933566641165281, 'loss_val': 0.8499371070650418, 'psi': 0.614130521914606}
[S13] START round=9 head_norm_before_train=1.444303 (no previous merge yet)
[S13] round=9 local utility u=0.780513 metrics={'f1_val': 0.7118396729657227, 'auprc': 0.7388037955768784, 'loss_val': 0.6679116871118697, 'psi': 0.722625322010185}-{'f1_val': 0.46905147089395316, 'auprc': 0.7380591388865594, 'loss_val': 0.7699740232117234, 'psi': 0.5766545380909956}
[S14] START round=9 head_norm_before_train=1.019844 cos_to_last_merge=0.9385 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=9 local utility u=0.046382 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9965499962821902, 'loss_val': 0.5940883501227701, 'psi': 0.6365761605416334}-{'f1_val': 0.39656053564365834, 'auprc': 0.9965814760274747, 'loss_val': 0.6867482359930326, 'psi': 0.6365689117971849}
[S15] START round=9 head_norm_before_train=0.853022 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.4169300365619384, 'auprc': 0.5596169927924988, 'loss_val': 0.9968689948879754, 'psi': 0.47400481905416253}-{'f1_val': 0.38381574747486924, 'auprc': 0.6551029046875158, 'loss_val': 1.005926543320039, 'psi': 0.49233061035992787}
[S16] START round=9 head_norm_before_train=1.385198 (no previous merge yet)
[S16] round=9 local utility u=0.070026 metrics={'f1_val': 0.4115311289448251, 'auprc': 0.7418883835493096, 'loss_val': 0.9207771995635173, 'psi': 0.5436740307866189}-{'f1_val': 0.4016028658195537, 'auprc': 0.7351439921948866, 'loss_val': 0.9810259717695413, 'psi': 0.5350193163696868}
[S17] START round=9 head_norm_before_train=1.091264 cos_to_last_merge=0.9959 (last merge round=7)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3525862967346304, 'auprc': 0.6137606555706285, 'loss_val': 0.9001577179977327, 'psi': 0.45705604026902963}-{'f1_val': 0.35435030412535395, 'auprc': 0.6737045943264774, 'loss_val': 0.9263588258597378, 'psi': 0.48209202020580333}
[S3] not sending this round → trigger blocked (psi=0.820)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.635)
[S14] not sending this round → trigger blocked (psi=0.637)
[S5] not sending this round → trigger blocked (psi=0.755)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[S13] not sending this round → trigger blocked (psi=0.723)
[S8] not sending this round → trigger blocked (psi=0.545)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S2] not sending this round → trigger blocked (psi=0.681)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0197
[S14] DROPPED delta from S10 (cos=-0.0197 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9285
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.8905
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.2902
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.3807 head_norm=1.306500
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.642993e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.3811 head_norm=1.340255 delta_norm=0.264299
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3526 head_norm=1.135561
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.968073e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3523 head_norm=1.094542 delta_norm=0.296807
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.459222 (no previous merge yet)
[S2] round=10 local utility u=0.092201 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6691893423927262, 'loss_val': 0.37834506210117125, 'psi': 0.6886661023125883}-{'f1_val': 0.7020713970912296, 'auprc': 0.6487049700776298, 'loss_val': 0.5038190735318767, 'psi': 0.6807248262857897}
[S3] START round=10 head_norm_before_train=1.706195 (no previous merge yet)
[S3] round=10 local utility u=0.625780 metrics={'f1_val': 0.9047911942254349, 'auprc': 0.9986616309765828, 'loss_val': 0.1511814970114134, 'psi': 0.942339368925894}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986622231874934, 'loss_val': 0.17808181743948856, 'psi': 0.8198734650741982}
[S4] START round=10 head_norm_before_train=1.501053 (no previous merge yet)
[S4] round=10 local utility u=0.027712 metrics={'f1_val': 0.652649078705775, 'auprc': 0.6520084716581579, 'loss_val': 0.46880145787551025, 'psi': 0.6523928358867281}-{'f1_val': 0.6495347126496571, 'auprc': 0.649379683395629, 'loss_val': 0.49765256028115085, 'psi': 0.6494727009480459}
[S5] START round=10 head_norm_before_train=1.147784 cos_to_last_merge=0.8614 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=10 local utility u=0.248768 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9691534894148224, 'loss_val': 0.35911796207100927, 'psi': 0.8080268521693974}-{'f1_val': 0.7008168588441903, 'auprc': 0.8360387764772861, 'loss_val': 0.45855552207934724, 'psi': 0.7549056258974287}
[S6] START round=10 head_norm_before_train=1.400116 (no previous merge yet)
[S6] round=10 local utility u=0.600467 metrics={'f1_val': 0.6925299412002757, 'auprc': 0.8459538560813668, 'loss_val': 0.4888250396503831, 'psi': 0.7538995071527121}-{'f1_val': 0.5213925497535326, 'auprc': 0.829204761830634, 'loss_val': 0.6126882843382878, 'psi': 0.6445174345843732}
[S7] START round=10 head_norm_before_train=1.340255 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=1.000000 metrics={'f1_val': 0.5967403488844198, 'auprc': 0.7196509091779115, 'loss_val': 0.7478584851669784, 'psi': 0.6459045730018165}-{'f1_val': 0.3807431066716169, 'auprc': 0.5878167304813813, 'loss_val': 1.108518203742407, 'psi': 0.4635725561955227}
[S8] START round=10 head_norm_before_train=1.076162 cos_to_last_merge=0.9973 (last merge round=8)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9988211755767605, 'loss_val': 0.7789645643436175, 'psi': 0.8278609503091732}-{'f1_val': 0.4158203383005801, 'auprc': 0.737873881664068, 'loss_val': 0.9872894083025122, 'psi': 0.5446417556459753}
[S9] START round=10 head_norm_before_train=1.738988 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.7920101312876707, 'auprc': 0.9786753094256647, 'loss_val': 0.19661951099069178, 'psi': 0.8666762025428683}-{'f1_val': 0.9945775144926113, 'auprc': 0.9993216770553413, 'loss_val': 0.0698323480866713, 'psi': 0.9964751795177034}
[S10] START round=10 head_norm_before_train=1.503714 (no previous merge yet)
[S10] round=10 local utility u=0.041638 metrics={'f1_val': 0.6993689984634683, 'auprc': 0.9982913505267927, 'loss_val': 0.3917220087795419, 'psi': 0.8189379392887981}-{'f1_val': 0.701696512414446, 'auprc': 0.9944012529360211, 'loss_val': 0.47729273951565687, 'psi': 0.818778408623076}
[S11] START round=10 head_norm_before_train=0.993465 cos_to_last_merge=0.9954 (last merge round=8)
[S11] round=10 local utility u=0.706588 metrics={'f1_val': 0.6519720350613614, 'auprc': 0.9394715610779305, 'loss_val': 0.6247737452767931, 'psi': 0.766971845467989}-{'f1_val': 0.47543760714106637, 'auprc': 0.8748098929384531, 'loss_val': 0.7847575449782671, 'psi': 0.6351865214600211}
[S13] START round=10 head_norm_before_train=1.476997 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.7090377480497637, 'auprc': 0.7340036207867877, 'loss_val': 0.6524876861543291, 'psi': 0.7190240971445733}-{'f1_val': 0.7118396729657227, 'auprc': 0.7388037955768784, 'loss_val': 0.6679116871118697, 'psi': 0.722625322010185}
[S14] START round=10 head_norm_before_train=1.077609 cos_to_last_merge=0.9238 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.924
[S14] round=10 local utility u=0.957044 metrics={'f1_val': 0.7013294913791999, 'auprc': 0.9966647325197664, 'loss_val': 0.508758931354846, 'psi': 0.8194635878354264}-{'f1_val': 0.39659360338126215, 'auprc': 0.9965499962821902, 'loss_val': 0.5940883501227701, 'psi': 0.6365761605416334}
[S15] START round=10 head_norm_before_train=0.885861 cos_to_last_merge=0.9932 (last merge round=8)
[S15] round=10 local utility u=0.051518 metrics={'f1_val': 0.3839821842782005, 'auprc': 0.613916267949574, 'loss_val': 0.8590446092129945, 'psi': 0.4759558177467499}-{'f1_val': 0.4169300365619384, 'auprc': 0.5596169927924988, 'loss_val': 0.9968689948879754, 'psi': 0.47400481905416253}
[S16] START round=10 head_norm_before_train=1.423142 (no previous merge yet)
[S16] round=10 local utility u=0.097232 metrics={'f1_val': 0.4308471284179741, 'auprc': 0.7407001986380581, 'loss_val': 0.8386437867349664, 'psi': 0.5547883565060077}-{'f1_val': 0.4115311289448251, 'auprc': 0.7418883835493096, 'loss_val': 0.9207771995635173, 'psi': 0.5436740307866189}
[S17] START round=10 head_norm_before_train=1.094542 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3518456193796448, 'auprc': 0.6117749607904029, 'loss_val': 0.9269579007862778, 'psi': 0.4558173559439481}-{'f1_val': 0.3525862967346304, 'auprc': 0.6137606555706285, 'loss_val': 0.9001577179977327, 'psi': 0.45705604026902963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:61012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.555)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S6] not sending this round → trigger blocked (psi=0.754)
[S10] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.8585
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] cosine check vs S7: cos=-0.1662
[S17] DROPPED delta from S7 (cos=-0.1662 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] cosine check vs S8: cos=0.7435
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.7024
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.6612
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.1040
[S9] DROPPED delta from S15 (cos=-0.1040 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1787) from S11
[S8] cosine check vs S11: cos=-0.0098
[S8] DROPPED delta from S11 (cos=-0.0098 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=-0.0362
[S8] DROPPED delta from S14 (cos=-0.0362 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.5161
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.311 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.368 → S14@127.0.0.1:61014
[S6] ⇄ pheromone p=0.404 → S17@127.0.0.1:61017
[S13] ⇄ pheromone p=0.383 → S7@127.0.0.1:61008
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6520 head_norm=1.050182
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.936554e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6325 head_norm=1.049791 delta_norm=0.193655
[S11] aggregate: ROLLBACK (f1_val pre=0.652 post=0.633 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.431 → S8@127.0.0.1:61009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.3840 head_norm=0.934983
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.727571e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3841 head_norm=0.951079 delta_norm=0.372757
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.193 → S9@127.0.0.1:61010
[S5] ⇄ pheromone p=0.355 → S11@127.0.0.1:61012
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7139 head_norm=1.101274
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.997537e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7139 head_norm=1.092447 delta_norm=0.199754
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.502 → S15@127.0.0.1:61015
[S2] ⇄ pheromone p=0.261 → S8@127.0.0.1:61009
[S14] ⇄ pheromone p=0.452 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.277 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.382 → S11@127.0.0.1:61012
[S7] ⇄ pheromone p=0.411 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.220 → S7@127.0.0.1:61008
[S17] ⇄ pheromone p=0.192 → S13@127.0.0.1:61013
[S2] START round=11 head_norm_before_train=1.512632 (no previous merge yet)
[S2] round=11 local utility u=0.061425 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6863422613565008, 'loss_val': 0.30647629978297053, 'psi': 0.6954795399657494}-{'f1_val': 0.7016506089258296, 'auprc': 0.6691893423927262, 'loss_val': 0.37834506210117125, 'psi': 0.6886661023125883}
[S3] START round=11 head_norm_before_train=1.749048 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.8742068843371745, 'auprc': 0.9979983989138093, 'loss_val': 0.1821429322507028, 'psi': 0.9237234901678284}-{'f1_val': 0.9047911942254349, 'auprc': 0.9986616309765828, 'loss_val': 0.1511814970114134, 'psi': 0.942339368925894}
[S4] START round=11 head_norm_before_train=1.543123 (no previous merge yet)
[S4] round=11 local utility u=0.017498 metrics={'f1_val': 0.663175097987948, 'auprc': 0.6541826705510069, 'loss_val': 0.5034845443507019, 'psi': 0.6595781270131715}-{'f1_val': 0.652649078705775, 'auprc': 0.6520084716581579, 'loss_val': 0.46880145787551025, 'psi': 0.6523928358867281}
[S5] START round=11 head_norm_before_train=1.208010 cos_to_last_merge=0.8453 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=11 local utility u=0.049708 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9874694478441247, 'loss_val': 0.31464610811828664, 'psi': 0.8153528147352544}-{'f1_val': 0.7006090940057808, 'auprc': 0.9691534894148224, 'loss_val': 0.35911796207100927, 'psi': 0.8080268521693974}
[S6] START round=11 head_norm_before_train=1.443721 (no previous merge yet)
[S6] round=11 local utility u=0.062238 metrics={'f1_val': 0.7101942583316938, 'auprc': 0.825349404770754, 'loss_val': 0.4085211978177118, 'psi': 0.756256316907318}-{'f1_val': 0.6925299412002757, 'auprc': 0.8459538560813668, 'loss_val': 0.4888250396503831, 'psi': 0.7538995071527121}
[S7] START round=11 head_norm_before_train=1.374111 cos_to_last_merge=0.9990 (last merge round=9)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5643086230337009, 'auprc': 0.7728046187032568, 'loss_val': 0.7751252398460932, 'psi': 0.6477070213015232}-{'f1_val': 0.5967403488844198, 'auprc': 0.7196509091779115, 'loss_val': 0.7478584851669784, 'psi': 0.6459045730018165}
[S8] START round=11 head_norm_before_train=1.092447 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.055705 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9988402051626835, 'loss_val': 0.6676113768254717, 'psi': 0.8278685621435423}-{'f1_val': 0.7138874667974482, 'auprc': 0.9988211755767605, 'loss_val': 0.7789645643436175, 'psi': 0.8278609503091732}
[S9] START round=11 head_norm_before_train=1.782802 (no previous merge yet)
[S9] round=11 local utility u=0.710595 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9995834003651274, 'loss_val': 0.043522485737560415, 'psi': 0.9955762301844544}-{'f1_val': 0.7920101312876707, 'auprc': 0.9786753094256647, 'loss_val': 0.19661951099069178, 'psi': 0.8666762025428683}
[S10] START round=11 head_norm_before_train=1.547030 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6883283370027431, 'auprc': 0.9900352029513053, 'loss_val': 0.3316516234498579, 'psi': 0.809011083382168}-{'f1_val': 0.6993689984634683, 'auprc': 0.9982913505267927, 'loss_val': 0.3917220087795419, 'psi': 0.8189379392887981}
[S11] START round=11 head_norm_before_train=1.049791 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.6290746769453032, 'auprc': 0.8994805459951368, 'loss_val': 0.5584614851710833, 'psi': 0.7372370245652367}-{'f1_val': 0.6519720350613614, 'auprc': 0.9394715610779305, 'loss_val': 0.6247737452767931, 'psi': 0.766971845467989}
[S13] START round=11 head_norm_before_train=1.510678 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6081695251088745, 'auprc': 0.7266049319160368, 'loss_val': 0.6186225421002102, 'psi': 0.6555436878317393}-{'f1_val': 0.7090377480497637, 'auprc': 0.7340036207867877, 'loss_val': 0.6524876861543291, 'psi': 0.7190240971445733}
[S14] START round=11 head_norm_before_train=1.130044 cos_to_last_merge=0.9116 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.912
[S14] round=11 local utility u=0.050388 metrics={'f1_val': 0.7016403118876036, 'auprc': 0.9970829707593901, 'loss_val': 0.41110166595373027, 'psi': 0.8198173754363183}-{'f1_val': 0.7013294913791999, 'auprc': 0.9966647325197664, 'loss_val': 0.508758931354846, 'psi': 0.8194635878354264}
[S15] START round=11 head_norm_before_train=0.951079 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.256238 metrics={'f1_val': 0.38354069823051173, 'auprc': 0.7807881332389033, 'loss_val': 0.8445353392740146, 'psi': 0.5424396722338684}-{'f1_val': 0.3839821842782005, 'auprc': 0.613916267949574, 'loss_val': 0.8590446092129945, 'psi': 0.4759558177467499}
[S16] START round=11 head_norm_before_train=1.455420 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3800390804821036, 'auprc': 0.7449768062809596, 'loss_val': 0.877015596548991, 'psi': 0.526014170801646}-{'f1_val': 0.4308471284179741, 'auprc': 0.7407001986380581, 'loss_val': 0.8386437867349664, 'psi': 0.5547883565060077}
[S17] START round=11 head_norm_before_train=1.130732 cos_to_last_merge=0.9970 (last merge round=9)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.34075145127830075, 'auprc': 0.5949245816956218, 'loss_val': 1.0964262205493687, 'psi': 0.4424207034452292}-{'f1_val': 0.3518456193796448, 'auprc': 0.6117749607904029, 'loss_val': 0.9269579007862778, 'psi': 0.4558173559439481}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.828)
[S5] not sending this round → trigger blocked (psi=0.815)
[S4] not sending this round → trigger blocked (psi=0.660)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.695)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S15] not sending this round → trigger blocked (psi=0.542)
[S9] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4310
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.8496
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3408 head_norm=1.170210
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.363745e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3165 head_norm=1.155175 delta_norm=0.236374
[S17] aggregate: ROLLBACK (f1_val pre=0.341 post=0.316 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.555090 (no previous merge yet)
[S2] round=12 local utility u=0.167500 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.7888859770779048, 'loss_val': 0.28019753804368985, 'psi': 0.7366059390681405}-{'f1_val': 0.7015710590385817, 'auprc': 0.6863422613565008, 'loss_val': 0.30647629978297053, 'psi': 0.6954795399657494}
[S3] START round=12 head_norm_before_train=1.791414 (no previous merge yet)
[S3] round=12 local utility u=0.423615 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9992398633077012, 'loss_val': 0.08043019420882766, 'psi': 0.9983993018029678}-{'f1_val': 0.8742068843371745, 'auprc': 0.9979983989138093, 'loss_val': 0.1821429322507028, 'psi': 0.9237234901678284}
[S4] START round=12 head_norm_before_train=1.582235 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6624845249955077, 'auprc': 0.6530743679980328, 'loss_val': 0.5014881098299738, 'psi': 0.6587204621965177}-{'f1_val': 0.663175097987948, 'auprc': 0.6541826705510069, 'loss_val': 0.5034845443507019, 'psi': 0.6595781270131715}
[S5] START round=12 head_norm_before_train=1.258471 cos_to_last_merge=0.8310 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.8291174818753284, 'loss_val': 0.33843976404372167, 'psi': 0.7518631896318273}-{'f1_val': 0.7006083926626743, 'auprc': 0.9874694478441247, 'loss_val': 0.31464610811828664, 'psi': 0.8153528147352544}
[S6] START round=12 head_norm_before_train=1.490145 (no previous merge yet)
[S6] round=12 local utility u=0.221149 metrics={'f1_val': 0.7092224700698951, 'auprc': 0.9529315977887534, 'loss_val': 0.3431391170561048, 'psi': 0.8067061211574384}-{'f1_val': 0.7101942583316938, 'auprc': 0.825349404770754, 'loss_val': 0.4085211978177118, 'psi': 0.756256316907318}
[S7] START round=12 head_norm_before_train=1.413202 cos_to_last_merge=0.9960 (last merge round=9)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.43551573283902256, 'auprc': 0.7741275322573633, 'loss_val': 0.9589813708984511, 'psi': 0.5709604526063589}-{'f1_val': 0.5643086230337009, 'auprc': 0.7728046187032568, 'loss_val': 0.7751252398460932, 'psi': 0.6477070213015232}
[S8] START round=12 head_norm_before_train=1.125609 cos_to_last_merge=0.9977 (last merge round=10)
[S8] round=12 local utility u=0.041927 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9982332356718702, 'loss_val': 0.5811627607110647, 'psi': 0.8275484555369432}-{'f1_val': 0.7138874667974482, 'auprc': 0.9988402051626835, 'loss_val': 0.6676113768254717, 'psi': 0.8278685621435423}
[S9] START round=12 head_norm_before_train=1.816006 (no previous merge yet)
[S9] round=12 local utility u=0.000345 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9995936702251659, 'loss_val': 0.03632429941384095, 'psi': 0.9949264645300999}-{'f1_val': 0.992904783397339, 'auprc': 0.9995834003651274, 'loss_val': 0.043522485737560415, 'psi': 0.9955762301844544}
[S10] START round=12 head_norm_before_train=1.590446 (no previous merge yet)
[S10] round=12 local utility u=0.019487 metrics={'f1_val': 0.6882467044915941, 'auprc': 0.9863131873851729, 'loss_val': 0.28102168015551493, 'psi': 0.8074732976490256}-{'f1_val': 0.6883283370027431, 'auprc': 0.9900352029513053, 'loss_val': 0.3316516234498579, 'psi': 0.809011083382168}
[S11] START round=12 head_norm_before_train=1.098997 cos_to_last_merge=0.9980 (last merge round=10)
[S11] round=12 local utility u=0.396194 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9699250943204186, 'loss_val': 0.4145714078451904, 'psi': 0.8091312277071595}-{'f1_val': 0.6290746769453032, 'auprc': 0.8994805459951368, 'loss_val': 0.5584614851710833, 'psi': 0.7372370245652367}
[S13] START round=12 head_norm_before_train=1.541371 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5756061851869441, 'auprc': 0.7264758475008585, 'loss_val': 0.6565829601856767, 'psi': 0.6359540501125098}-{'f1_val': 0.6081695251088745, 'auprc': 0.7266049319160368, 'loss_val': 0.6186225421002102, 'psi': 0.6555436878317393}
[S14] START round=12 head_norm_before_train=1.178406 cos_to_last_merge=0.9017 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.902
[S14] round=12 local utility u=0.393112 metrics={'f1_val': 0.8192996217574701, 'auprc': 0.997155215816041, 'loss_val': 0.33105042924172234, 'psi': 0.8904418593808985}-{'f1_val': 0.7016403118876036, 'auprc': 0.9970829707593901, 'loss_val': 0.41110166595373027, 'psi': 0.8198173754363183}
[S15] START round=12 head_norm_before_train=0.993379 cos_to_last_merge=0.9948 (last merge round=10)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.43586406940870176, 'auprc': 0.5750450302849643, 'loss_val': 0.8192447253294785, 'psi': 0.4915364537592068}-{'f1_val': 0.38354069823051173, 'auprc': 0.7807881332389033, 'loss_val': 0.8445353392740146, 'psi': 0.5424396722338684}
[S16] START round=12 head_norm_before_train=1.487087 (no previous merge yet)
[S16] round=12 local utility u=0.562533 metrics={'f1_val': 0.5479496469053903, 'auprc': 0.7648880926176682, 'loss_val': 0.8191470727441752, 'psi': 0.6347250251903014}-{'f1_val': 0.3800390804821036, 'auprc': 0.7449768062809596, 'loss_val': 0.877015596548991, 'psi': 0.526014170801646}
[S17] START round=12 head_norm_before_train=1.155175 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.144491 metrics={'f1_val': 0.35288213132906776, 'auprc': 0.6107034828350356, 'loss_val': 0.9275648215433021, 'psi': 0.45601067193145495}-{'f1_val': 0.34075145127830075, 'auprc': 0.5949245816956218, 'loss_val': 1.0964262205493687, 'psi': 0.4424207034452292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[S6] not sending this round → trigger blocked (psi=0.807)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S9] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=0.7737
[S8] RECEIVED delta(kind=head bytes=1791) from S11
[S8] cosine check vs S11: cos=-0.0002
[S8] DROPPED delta from S11 (cos=-0.0002 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0324
[S8] DROPPED delta from S14 (cos=-0.0324 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0220
[S14] DROPPED delta from S10 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.9520
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9040
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.7501
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0200
[S13] DROPPED delta from S17 (cos=-0.0200 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4355 head_norm=1.445946
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.325567e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4294 head_norm=1.464459 delta_norm=0.232557
[S7] aggregate: ROLLBACK (f1_val pre=0.436 post=0.429 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7138 head_norm=1.163697
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.048342e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7046 head_norm=1.298642 delta_norm=0.504834
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.705 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=1.152599
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.123753e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.396824 delta_norm=0.612375
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.4359 head_norm=1.044341
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.488293e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.4359 head_norm=1.077267 delta_norm=0.248829
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.590115 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.7817047310543497, 'loss_val': 0.2748609112339586, 'psi': 0.7335776269488761}-{'f1_val': 0.7017525803949645, 'auprc': 0.7888859770779048, 'loss_val': 0.28019753804368985, 'psi': 0.7366059390681405}
[S3] START round=13 head_norm_before_train=1.823118 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.8956229858690459, 'auprc': 0.9984136969599926, 'loss_val': 0.17628320486363727, 'psi': 0.9367392703054246}-{'f1_val': 0.9978389274664787, 'auprc': 0.9992398633077012, 'loss_val': 0.08043019420882766, 'psi': 0.9983993018029678}
[S4] START round=13 head_norm_before_train=1.611881 (no previous merge yet)
[S4] round=13 local utility u=0.004151 metrics={'f1_val': 0.664965135180598, 'auprc': 0.6567567032596018, 'loss_val': 0.5191160554328429, 'psi': 0.6616817624121996}-{'f1_val': 0.6624845249955077, 'auprc': 0.6530743679980328, 'loss_val': 0.5014881098299738, 'psi': 0.6587204621965177}
[S5] START round=13 head_norm_before_train=1.304983 cos_to_last_merge=0.8215 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=13 local utility u=0.273442 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9869368986442522, 'loss_val': 0.2650130897176547, 'psi': 0.8149909563393968}-{'f1_val': 0.7003603281361598, 'auprc': 0.8291174818753284, 'loss_val': 0.33843976404372167, 'psi': 0.7518631896318273}
[S6] START round=13 head_norm_before_train=1.531866 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.7073090728396058, 'auprc': 0.8157379606711365, 'loss_val': 0.36180305144224345, 'psi': 0.750680627972218}-{'f1_val': 0.7092224700698951, 'auprc': 0.9529315977887534, 'loss_val': 0.3431391170561048, 'psi': 0.8067061211574384}
[S7] START round=13 head_norm_before_train=1.464459 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.097967 metrics={'f1_val': 0.4566125236552234, 'auprc': 0.7799340551914713, 'loss_val': 0.9070474966872173, 'psi': 0.5859411362697226}-{'f1_val': 0.43551573283902256, 'auprc': 0.7741275322573633, 'loss_val': 0.9589813708984511, 'psi': 0.5709604526063589}
[S8] START round=13 head_norm_before_train=1.298642 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.035590 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9947848440426615, 'loss_val': 0.500022943548847, 'psi': 0.8262077046074207}-{'f1_val': 0.7137586021136586, 'auprc': 0.9982332356718702, 'loss_val': 0.5811627607110647, 'psi': 0.8275484555369432}
[S9] START round=13 head_norm_before_train=1.846485 (no previous merge yet)
[S9] round=13 local utility u=0.016350 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9995881150932853, 'loss_val': 0.02785206873936524, 'psi': 0.9973487090861456}-{'f1_val': 0.9918149940667227, 'auprc': 0.9995936702251659, 'loss_val': 0.03632429941384095, 'psi': 0.9949264645300999}
[S10] START round=13 head_norm_before_train=1.630966 (no previous merge yet)
[S10] round=13 local utility u=0.827506 metrics={'f1_val': 0.9547118311878192, 'auprc': 0.9951965116704706, 'loss_val': 0.2514496633356725, 'psi': 0.9709057033808799}-{'f1_val': 0.6882467044915941, 'auprc': 0.9863131873851729, 'loss_val': 0.28102168015551493, 'psi': 0.8074732976490256}
[S11] START round=13 head_norm_before_train=1.396824 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.057619 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.994717642107817, 'loss_val': 0.3722594982108387, 'psi': 0.8189031445952817}-{'f1_val': 0.7019353166316534, 'auprc': 0.9699250943204186, 'loss_val': 0.4145714078451904, 'psi': 0.8091312277071595}
[S13] START round=13 head_norm_before_train=1.564832 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5969183003736911, 'auprc': 0.6163993552610626, 'loss_val': 0.6968867711900965, 'psi': 0.6047107223286396}-{'f1_val': 0.5756061851869441, 'auprc': 0.7264758475008585, 'loss_val': 0.6565829601856767, 'psi': 0.6359540501125098}
[S14] START round=13 head_norm_before_train=1.228658 cos_to_last_merge=0.8923 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.892
[S14] round=13 local utility u=0.438803 metrics={'f1_val': 0.9509970359101965, 'auprc': 0.9971534702266347, 'loss_val': 0.24362324169400437, 'psi': 0.9694596096367718}-{'f1_val': 0.8192996217574701, 'auprc': 0.997155215816041, 'loss_val': 0.33105042924172234, 'psi': 0.8904418593808985}
[S15] START round=13 head_norm_before_train=1.077267 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.260764 metrics={'f1_val': 0.5216361332762856, 'auprc': 0.5827760602992946, 'loss_val': 0.8355426109789629, 'psi': 0.5460921040854891}-{'f1_val': 0.43586406940870176, 'auprc': 0.5750450302849643, 'loss_val': 0.8192447253294785, 'psi': 0.4915364537592068}
[S16] START round=13 head_norm_before_train=1.518778 (no previous merge yet)
[S16] round=13 local utility u=0.142796 metrics={'f1_val': 0.5709076107862414, 'auprc': 0.7815512808206877, 'loss_val': 0.721293416276468, 'psi': 0.65516507880002}-{'f1_val': 0.5479496469053903, 'auprc': 0.7648880926176682, 'loss_val': 0.8191470727441752, 'psi': 0.6347250251903014}
[S17] START round=13 head_norm_before_train=1.185884 cos_to_last_merge=0.9981 (last merge round=11)
[S17] round=13 local utility u=0.197517 metrics={'f1_val': 0.3748246180396392, 'auprc': 0.6441518183932482, 'loss_val': 0.7645307423419173, 'psi': 0.4825554981810828}-{'f1_val': 0.35288213132906776, 'auprc': 0.6107034828350356, 'loss_val': 0.9275648215433021, 'psi': 0.45601067193145495}
[S11] not sending this round → trigger blocked (psi=0.819)
[S14] not sending this round → trigger blocked (psi=0.969)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.655)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.971)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61010
[S8] not sending this round → trigger blocked (psi=0.826)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.2871
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=-0.1143
[S9] DROPPED delta from S15 (cos=-0.1143 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.3402
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.8224
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.1702
[S17] DROPPED delta from S7 (cos=-0.1702 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.483)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7138 head_norm=1.330012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.604094e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7139 head_norm=1.216536 delta_norm=0.860409
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.437668
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.307019e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=1.115359 delta_norm=0.830702
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3748 head_norm=1.219571
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.583022e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3853 head_norm=1.481676 delta_norm=0.558302
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.618531 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7422565925359332, 'loss_val': 0.2734075788527443, 'psi': 0.7177977267526808}-{'f1_val': 0.7014928908785604, 'auprc': 0.7817047310543497, 'loss_val': 0.2748609112339586, 'psi': 0.7335776269488761}
[S3] START round=14 head_norm_before_train=1.860645 (no previous merge yet)
[S3] round=14 local utility u=0.364939 metrics={'f1_val': 0.9969808748199115, 'auprc': 0.998866157957286, 'loss_val': 0.055909536670862646, 'psi': 0.9977349880748613}-{'f1_val': 0.8956229858690459, 'auprc': 0.9984136969599926, 'loss_val': 0.17628320486363727, 'psi': 0.9367392703054246}
[S4] START round=14 head_norm_before_train=1.634502 (no previous merge yet)
[S4] round=14 local utility u=0.021126 metrics={'f1_val': 0.6673218161706854, 'auprc': 0.6663466601471831, 'loss_val': 0.5197735550967885, 'psi': 0.6669317537612844}-{'f1_val': 0.664965135180598, 'auprc': 0.6567567032596018, 'loss_val': 0.5191160554328429, 'psi': 0.6616817624121996}
[S5] START round=14 head_norm_before_train=1.342122 cos_to_last_merge=0.8143 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6746809233200975, 'auprc': 0.9565536077859063, 'loss_val': 0.30689849165545463, 'psi': 0.787429997106421}-{'f1_val': 0.7003603281361598, 'auprc': 0.9869368986442522, 'loss_val': 0.2650130897176547, 'psi': 0.8149909563393968}
[S6] START round=14 head_norm_before_train=1.565058 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.9669274526092063, 'auprc': 0.9715725729857985, 'loss_val': 0.20519123785304935, 'psi': 0.9687855007598432}-{'f1_val': 0.7073090728396058, 'auprc': 0.8157379606711365, 'loss_val': 0.36180305144224345, 'psi': 0.750680627972218}
[S7] START round=14 head_norm_before_train=1.493643 cos_to_last_merge=0.9995 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.39995260015968315, 'auprc': 0.7758616851959184, 'loss_val': 1.0738547116063357, 'psi': 0.5503162341741772}-{'f1_val': 0.4566125236552234, 'auprc': 0.7799340551914713, 'loss_val': 0.9070474966872173, 'psi': 0.5859411362697226}
[S8] START round=14 head_norm_before_train=1.216536 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.021570 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9956388181755215, 'loss_val': 0.45983185850492914, 'psi': 0.8265880073486775}-{'f1_val': 0.7138229449839267, 'auprc': 0.9947848440426615, 'loss_val': 0.500022943548847, 'psi': 0.8262077046074207}
[S9] START round=14 head_norm_before_train=1.877972 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.999593673243742, 'loss_val': 0.02696764659816761, 'psi': 0.9961833336331685}-{'f1_val': 0.9958557717480525, 'auprc': 0.9995881150932853, 'loss_val': 0.02785206873936524, 'psi': 0.9973487090861456}
[S10] START round=14 head_norm_before_train=1.664828 (no previous merge yet)
[S10] round=14 local utility u=0.036388 metrics={'f1_val': 0.9660589288018925, 'auprc': 0.9962863622283027, 'loss_val': 0.2500266856034048, 'psi': 0.9781499021724566}-{'f1_val': 0.9547118311878192, 'auprc': 0.9951965116704706, 'loss_val': 0.2514496633356725, 'psi': 0.9709057033808799}
[S11] START round=14 head_norm_before_train=1.115359 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.006191 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981374356995455, 'loss_val': 0.3715869507985722, 'psi': 0.8204161642588103}-{'f1_val': 0.7016934795869249, 'auprc': 0.994717642107817, 'loss_val': 0.3722594982108387, 'psi': 0.8189031445952817}
[S13] START round=14 head_norm_before_train=1.587518 (no previous merge yet)
[S13] round=14 local utility u=0.112850 metrics={'f1_val': 0.594565706880217, 'auprc': 0.6853408615836982, 'loss_val': 0.6638967103835047, 'psi': 0.6308757687616096}-{'f1_val': 0.5969183003736911, 'auprc': 0.6163993552610626, 'loss_val': 0.6968867711900965, 'psi': 0.6047107223286396}
[S14] START round=14 head_norm_before_train=1.278158 cos_to_last_merge=0.8841 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.884
[S14] round=14 local utility u=0.166664 metrics={'f1_val': 0.9970336855150863, 'auprc': 0.9956963121646673, 'loss_val': 0.182143289395875, 'psi': 0.9964987361749187}-{'f1_val': 0.9509970359101965, 'auprc': 0.9971534702266347, 'loss_val': 0.24362324169400437, 'psi': 0.9694596096367718}
[S15] START round=14 head_norm_before_train=1.120414 cos_to_last_merge=0.9971 (last merge round=12)
[S15] round=14 local utility u=0.697372 metrics={'f1_val': 0.5890495662137066, 'auprc': 0.8333516566442994, 'loss_val': 0.5970069576232886, 'psi': 0.6867704023859438}-{'f1_val': 0.5216361332762856, 'auprc': 0.5827760602992946, 'loss_val': 0.8355426109789629, 'psi': 0.5460921040854891}
[S16] START round=14 head_norm_before_train=1.545212 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5567621687347533, 'auprc': 0.8093817073143087, 'loss_val': 0.7661281192362038, 'psi': 0.6578099841665754}-{'f1_val': 0.5709076107862414, 'auprc': 0.7815512808206877, 'loss_val': 0.721293416276468, 'psi': 0.65516507880002}
[S17] START round=14 head_norm_before_train=1.481676 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.443008 metrics={'f1_val': 0.4137488309843923, 'auprc': 0.825074328332295, 'loss_val': 0.6548272818065798, 'psi': 0.5782790299235534}-{'f1_val': 0.3748246180396392, 'auprc': 0.6441518183932482, 'loss_val': 0.7645307423419173, 'psi': 0.4825554981810828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:61015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S4] not sending this round → trigger blocked (psi=0.667)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.687)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.2085
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.8939
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0227
[S14] DROPPED delta from S10 (cos=-0.0227 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S3
[S11] cosine check vs S3: cos=0.6271
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] cosine check vs S11: cos=-0.0056
[S8] DROPPED delta from S11 (cos=-0.0056 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0369
[S8] DROPPED delta from S14 (cos=-0.0369 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S13
[S7] cosine check vs S13: cos=-0.0160
[S7] DROPPED delta from S13 (cos=-0.0160 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0108
[S13] DROPPED delta from S17 (cos=-0.0108 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.5890 head_norm=1.164564
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.817929e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.5848 head_norm=1.176606 delta_norm=0.281793
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=1.162260
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.395763e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.389567 delta_norm=0.739576
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.4137 head_norm=1.509142
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.764140e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3896 head_norm=1.206066 delta_norm=0.976414
[S17] aggregate: ROLLBACK (f1_val pre=0.414 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.642861 (no previous merge yet)
[S2] round=15 local utility u=0.159732 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.8491995432011927, 'loss_val': 0.27368195279496677, 'psi': 0.7604658961041983}-{'f1_val': 0.7014918162305126, 'auprc': 0.7422565925359332, 'loss_val': 0.2734075788527443, 'psi': 0.7177977267526808}
[S3] START round=15 head_norm_before_train=1.898656 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.976948781713509, 'auprc': 0.998871547682804, 'loss_val': 0.11522711808867835, 'psi': 0.985717888101227}-{'f1_val': 0.9969808748199115, 'auprc': 0.998866157957286, 'loss_val': 0.055909536670862646, 'psi': 0.9977349880748613}
[S4] START round=15 head_norm_before_train=1.654661 (no previous merge yet)
[S4] round=15 local utility u=0.268186 metrics={'f1_val': 0.6635203980084383, 'auprc': 0.8481046709465656, 'loss_val': 0.5058661597788043, 'psi': 0.7373541071836892}-{'f1_val': 0.6673218161706854, 'auprc': 0.6663466601471831, 'loss_val': 0.5197735550967885, 'psi': 0.6669317537612844}
[S5] START round=15 head_norm_before_train=1.371254 cos_to_last_merge=0.8083 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=15 local utility u=0.117637 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9789144897094142, 'loss_val': 0.2927828436549112, 'psi': 0.8117819927654616}-{'f1_val': 0.6746809233200975, 'auprc': 0.9565536077859063, 'loss_val': 0.30689849165545463, 'psi': 0.787429997106421}
[S6] START round=15 head_norm_before_train=1.593252 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.9587228383873938, 'auprc': 0.9629892130471165, 'loss_val': 0.21923257138985644, 'psi': 0.9604293882512829}-{'f1_val': 0.9669274526092063, 'auprc': 0.9715725729857985, 'loss_val': 0.20519123785304935, 'psi': 0.9687855007598432}
[S7] START round=15 head_norm_before_train=1.513564 cos_to_last_merge=0.9987 (last merge round=12)
[S7] round=15 local utility u=0.479595 metrics={'f1_val': 0.5298159524569765, 'auprc': 0.7765916581658203, 'loss_val': 0.8960343171753334, 'psi': 0.6285262347405141}-{'f1_val': 0.39995260015968315, 'auprc': 0.7758616851959184, 'loss_val': 1.0738547116063357, 'psi': 0.5503162341741772}
[S8] START round=15 head_norm_before_train=1.253558 cos_to_last_merge=0.9985 (last merge round=13)
[S8] round=15 local utility u=0.030332 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9956827366148748, 'loss_val': 0.4010203961899581, 'psi': 0.8267776543517038}-{'f1_val': 0.7138874667974482, 'auprc': 0.9956388181755215, 'loss_val': 0.45983185850492914, 'psi': 0.8265880073486775}
[S9] START round=15 head_norm_before_train=1.903617 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9913944794912241, 'auprc': 0.9995980220704845, 'loss_val': 0.0315464070244388, 'psi': 0.9946758965229283}-{'f1_val': 0.993909773892786, 'auprc': 0.999593673243742, 'loss_val': 0.02696764659816761, 'psi': 0.9961833336331685}
[S10] START round=15 head_norm_before_train=1.692076 (no previous merge yet)
[S10] round=15 local utility u=0.148458 metrics={'f1_val': 0.9950524203231796, 'auprc': 0.9977103754897955, 'loss_val': 0.13134373528918997, 'psi': 0.9961156023898259}-{'f1_val': 0.9660589288018925, 'auprc': 0.9962863622283027, 'loss_val': 0.2500266856034048, 'psi': 0.9781499021724566}
[S11] START round=15 head_norm_before_train=1.389567 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.035209 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977057400055993, 'loss_val': 0.29987390480870263, 'psi': 0.8202434859812318}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981374356995455, 'loss_val': 0.3715869507985722, 'psi': 0.8204161642588103}
[S13] START round=15 head_norm_before_train=1.606611 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6042816642716446, 'auprc': 0.6047756847131229, 'loss_val': 0.6942826688926115, 'psi': 0.604479272448236}-{'f1_val': 0.594565706880217, 'auprc': 0.6853408615836982, 'loss_val': 0.6638967103835047, 'psi': 0.6308757687616096}
[S14] START round=15 head_norm_before_train=1.323007 cos_to_last_merge=0.8770 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.877
[S14] round=15 local utility u=0.022447 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9970987138550546, 'loss_val': 0.14529735189458043, 'psi': 0.9974437484394956}-{'f1_val': 0.9970336855150863, 'auprc': 0.9956963121646673, 'loss_val': 0.182143289395875, 'psi': 0.9964987361749187}
[S15] START round=15 head_norm_before_train=1.176606 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.029400 metrics={'f1_val': 0.6818894307467824, 'auprc': 0.681542857150991, 'loss_val': 0.6398207257127732, 'psi': 0.6817508013084659}-{'f1_val': 0.5890495662137066, 'auprc': 0.8333516566442994, 'loss_val': 0.5970069576232886, 'psi': 0.6867704023859438}
[S16] START round=15 head_norm_before_train=1.570494 (no previous merge yet)
[S16] round=15 local utility u=0.505596 metrics={'f1_val': 0.6202324911225318, 'auprc': 0.9195223549157597, 'loss_val': 0.4661802601201266, 'psi': 0.739948436639823}-{'f1_val': 0.5567621687347533, 'auprc': 0.8093817073143087, 'loss_val': 0.7661281192362038, 'psi': 0.6578099841665754}
[S17] START round=15 head_norm_before_train=1.206066 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.38943264104400416, 'auprc': 0.7104860470173022, 'loss_val': 0.7728420938534881, 'psi': 0.5178540034333234}-{'f1_val': 0.4137488309843923, 'auprc': 0.825074328332295, 'loss_val': 0.6548272818065798, 'psi': 0.5782790299235534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61010
[S8] not sending this round → trigger blocked (psi=0.827)
[S10] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[S11] not sending this round → trigger blocked (psi=0.820)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8422
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] cosine check vs S7: cos=-0.1962
[S17] DROPPED delta from S7 (cos=-0.1962 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.3520
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=-0.1016
[S9] DROPPED delta from S15 (cos=-0.1016 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9705
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.5668
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.264 → S14@127.0.0.1:61014
[S6] ⇄ pheromone p=0.320 → S17@127.0.0.1:61017
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.426516
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.046490e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=1.162152 delta_norm=0.804649
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.197 → S8@127.0.0.1:61009
[S14] ⇄ pheromone p=0.280 → S8@127.0.0.1:61009
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7142 head_norm=1.293082
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.771932e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7142 head_norm=1.244800 delta_norm=0.177193
[S8] aggregate: ACCEPT kept=['S4', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.188 → S15@127.0.0.1:61015
[S9] ⇄ pheromone p=0.162 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.227 → S11@127.0.0.1:61012
[S13] ⇄ pheromone p=0.143 → S7@127.0.0.1:61008
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.5298 head_norm=1.530944
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.928880e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5138 head_norm=1.553310 delta_norm=0.192888
[S7] aggregate: ROLLBACK (f1_val pre=0.530 post=0.514 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.243 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.249 → S7@127.0.0.1:61008
[S5] ⇄ pheromone p=0.179 → S11@127.0.0.1:61012
[S2] ⇄ pheromone p=0.140 → S8@127.0.0.1:61009
[S15] ⇄ pheromone p=0.235 → S9@127.0.0.1:61010
[S4] ⇄ pheromone p=0.150 → S8@127.0.0.1:61009
[S17] ⇄ pheromone p=0.174 → S13@127.0.0.1:61013
[S2] START round=16 head_norm_before_train=1.662931 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7170190193844848, 'loss_val': 0.28535893159105086, 'psi': 0.7075461413572617}-{'f1_val': 0.7013101313728686, 'auprc': 0.8491995432011927, 'loss_val': 0.27368195279496677, 'psi': 0.7604658961041983}
[S3] START round=16 head_norm_before_train=1.932549 (no previous merge yet)
[S3] round=16 local utility u=0.059508 metrics={'f1_val': 0.9873331884983466, 'auprc': 0.9988695150577072, 'loss_val': 0.05851192390192266, 'psi': 0.9919477191220909}-{'f1_val': 0.976948781713509, 'auprc': 0.998871547682804, 'loss_val': 0.11522711808867835, 'psi': 0.985717888101227}
[S4] START round=16 head_norm_before_train=1.668919 (no previous merge yet)
[S4] round=16 local utility u=0.058514 metrics={'f1_val': 0.6639332929847201, 'auprc': 0.8841051165231444, 'loss_val': 0.49931637162616266, 'psi': 0.7520020224000898}-{'f1_val': 0.6635203980084383, 'auprc': 0.8481046709465656, 'loss_val': 0.5058661597788043, 'psi': 0.7373541071836892}
[S5] START round=16 head_norm_before_train=1.400417 cos_to_last_merge=0.8042 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=16 local utility u=0.065332 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9877799733800265, 'loss_val': 0.1902083581732192, 'psi': 0.8154774457554791}-{'f1_val': 0.7003603281361598, 'auprc': 0.9789144897094142, 'loss_val': 0.2927828436549112, 'psi': 0.8117819927654616}
[S6] START round=16 head_norm_before_train=1.615486 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8296702883324103, 'auprc': 0.953131127746078, 'loss_val': 0.2433092859899387, 'psi': 0.8790546240978774}-{'f1_val': 0.9587228383873938, 'auprc': 0.9629892130471165, 'loss_val': 0.21923257138985644, 'psi': 0.9604293882512829}
[S7] START round=16 head_norm_before_train=1.553310 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.657347 metrics={'f1_val': 0.6693862741841929, 'auprc': 0.8080215491834744, 'loss_val': 0.5130522732301914, 'psi': 0.7248403841839055}-{'f1_val': 0.5298159524569765, 'auprc': 0.7765916581658203, 'loss_val': 0.8960343171753334, 'psi': 0.6285262347405141}
[S8] START round=16 head_norm_before_train=1.244800 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.020345 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.995163331027292, 'loss_val': 0.35705047002156703, 'psi': 0.8263978124893858}-{'f1_val': 0.7141742661762565, 'auprc': 0.9956827366148748, 'loss_val': 0.4010203961899581, 'psi': 0.8267776543517038}
[S9] START round=16 head_norm_before_train=1.925453 (no previous merge yet)
[S9] round=16 local utility u=0.016062 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965271677350362, 'loss_val': 0.021805182696794198, 'psi': 0.9966071741823493}-{'f1_val': 0.9913944794912241, 'auprc': 0.9995980220704845, 'loss_val': 0.0315464070244388, 'psi': 0.9946758965229283}
[S10] START round=16 head_norm_before_train=1.718476 (no previous merge yet)
[S10] round=16 local utility u=0.012174 metrics={'f1_val': 0.9957529764387818, 'auprc': 0.9970182369135523, 'loss_val': 0.10912245736431087, 'psi': 0.99625908062869}-{'f1_val': 0.9950524203231796, 'auprc': 0.9977103754897955, 'loss_val': 0.13134373528918997, 'psi': 0.9961156023898259}
[S11] START round=16 head_norm_before_train=1.162152 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.6893281950837387, 'auprc': 0.9963385956660376, 'loss_val': 0.3751640542902401, 'psi': 0.8121323553166582}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977057400055993, 'loss_val': 0.29987390480870263, 'psi': 0.8202434859812318}
[S13] START round=16 head_norm_before_train=1.623978 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.573364084836183, 'auprc': 0.6856897211610693, 'loss_val': 0.7613561171238956, 'psi': 0.6182943393661375}-{'f1_val': 0.6042816642716446, 'auprc': 0.6047756847131229, 'loss_val': 0.6942826688926115, 'psi': 0.604479272448236}
[S14] START round=16 head_norm_before_train=1.360421 cos_to_last_merge=0.8714 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.871
[S14] round=16 local utility u=0.014620 metrics={'f1_val': 0.9974284489365712, 'auprc': 0.9970927112816476, 'loss_val': 0.1145669957598291, 'psi': 0.9972941538746019}-{'f1_val': 0.9976737714957896, 'auprc': 0.9970987138550546, 'loss_val': 0.14529735189458043, 'psi': 0.9974437484394956}
[S15] START round=16 head_norm_before_train=1.213964 cos_to_last_merge=0.9983 (last merge round=14)
[S15] round=16 local utility u=0.803477 metrics={'f1_val': 0.8572662249729961, 'auprc': 0.8714986672391338, 'loss_val': 0.6549946888802622, 'psi': 0.8629592018794512}-{'f1_val': 0.6818894307467824, 'auprc': 0.681542857150991, 'loss_val': 0.6398207257127732, 'psi': 0.6817508013084659}
[S16] START round=16 head_norm_before_train=1.598801 (no previous merge yet)
[S16] round=16 local utility u=0.287540 metrics={'f1_val': 0.7620798090701779, 'auprc': 0.8824354704219102, 'loss_val': 0.6309232385996238, 'psi': 0.8102220736108707}-{'f1_val': 0.6202324911225318, 'auprc': 0.9195223549157597, 'loss_val': 0.4661802601201266, 'psi': 0.739948436639823}
[S17] START round=16 head_norm_before_train=1.224556 cos_to_last_merge=0.9981 (last merge round=14)
[S17] round=16 local utility u=0.806022 metrics={'f1_val': 0.5855552555939886, 'auprc': 0.8316302400408143, 'loss_val': 0.7009660047428186, 'psi': 0.6839852493727189}-{'f1_val': 0.38943264104400416, 'auprc': 0.7104860470173022, 'loss_val': 0.7728420938534881, 'psi': 0.5178540034333234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S16] not sending this round → trigger blocked (psi=0.810)
[S15] not sending this round → trigger blocked (psi=0.863)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.725)
[S5] not sending this round → trigger blocked (psi=0.815)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[S4] not sending this round → trigger blocked (psi=0.752)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0322
[S8] DROPPED delta from S14 (cos=-0.0322 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.6385
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.9617
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.5950
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=-0.0217
[S14] DROPPED delta from S10 (cos=-0.0217 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0107
[S13] DROPPED delta from S17 (cos=-0.0107 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8573 head_norm=1.249250
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.763447e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8557 head_norm=1.255648 delta_norm=0.176345
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.6893 head_norm=1.199293
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.899679e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.6983 head_norm=1.423594 delta_norm=0.789968
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.5856 head_norm=1.251316
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.481396e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3944 head_norm=1.453588 delta_norm=0.748140
[S17] aggregate: ROLLBACK (f1_val pre=0.586 post=0.394 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.680576 (no previous merge yet)
[S2] round=17 local utility u=0.093275 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7774872884219274, 'loss_val': 0.2802143307128445, 'psi': 0.7317334489722388}-{'f1_val': 0.701230889339113, 'auprc': 0.7170190193844848, 'loss_val': 0.28535893159105086, 'psi': 0.7075461413572617}
[S3] START round=17 head_norm_before_train=1.965460 (no previous merge yet)
[S3] round=17 local utility u=0.046231 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9990444101775833, 'loss_val': 0.029436548020418292, 'psi': 0.9983037846316091}-{'f1_val': 0.9873331884983466, 'auprc': 0.9988695150577072, 'loss_val': 0.05851192390192266, 'psi': 0.9919477191220909}
[S4] START round=17 head_norm_before_train=1.681969 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6669268580060899, 'auprc': 0.6798722738969666, 'loss_val': 0.5045878065817699, 'psi': 0.6721050243624406}-{'f1_val': 0.6639332929847201, 'auprc': 0.8841051165231444, 'loss_val': 0.49931637162616266, 'psi': 0.7520020224000898}
[S5] START round=17 head_norm_before_train=1.427274 cos_to_last_merge=0.7994 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=17 local utility u=0.000416 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9878465573233365, 'loss_val': 0.1895808887414595, 'psi': 0.8155045806923276}-{'f1_val': 0.7006090940057808, 'auprc': 0.9877799733800265, 'loss_val': 0.1902083581732192, 'psi': 0.8154774457554791}
[S6] START round=17 head_norm_before_train=1.634603 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5568128658675598, 'auprc': 0.7805067810377491, 'loss_val': 0.6696990574876567, 'psi': 0.6462904319356355}-{'f1_val': 0.8296702883324103, 'auprc': 0.953131127746078, 'loss_val': 0.2433092859899387, 'psi': 0.8790546240978774}
[S7] START round=17 head_norm_before_train=1.575929 cos_to_last_merge=0.9996 (last merge round=15)
[S7] round=17 local utility u=0.348316 metrics={'f1_val': 0.6959095226846692, 'auprc': 0.920815342614306, 'loss_val': 0.31394101631250443, 'psi': 0.7858718506565239}-{'f1_val': 0.6693862741841929, 'auprc': 0.8080215491834744, 'loss_val': 0.5130522732301914, 'psi': 0.7248403841839055}
[S8] START round=17 head_norm_before_train=1.286419 cos_to_last_merge=0.9987 (last merge round=15)
[S8] round=17 local utility u=0.023371 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.99885949536531, 'loss_val': 0.32178597008812565, 'psi': 0.8279150987865115}-{'f1_val': 0.7138874667974482, 'auprc': 0.995163331027292, 'loss_val': 0.35705047002156703, 'psi': 0.8263978124893858}
[S9] START round=17 head_norm_before_train=1.944086 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9930734107733121, 'auprc': 0.9997097518497483, 'loss_val': 0.026864906346467123, 'psi': 0.9957279472038866}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965271677350362, 'loss_val': 0.021805182696794198, 'psi': 0.9966071741823493}
[S10] START round=17 head_norm_before_train=1.742571 (no previous merge yet)
[S10] round=17 local utility u=0.005696 metrics={'f1_val': 0.9959488122292768, 'auprc': 0.9970115605726153, 'loss_val': 0.09888567403777734, 'psi': 0.9963739115666123}-{'f1_val': 0.9957529764387818, 'auprc': 0.9970182369135523, 'loss_val': 0.10912245736431087, 'psi': 0.99625908062869}
[S11] START round=17 head_norm_before_train=1.423594 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.107064 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9977276118979664, 'loss_val': 0.23939543310774242, 'psi': 0.8201071325113415}-{'f1_val': 0.6893281950837387, 'auprc': 0.9963385956660376, 'loss_val': 0.3751640542902401, 'psi': 0.8121323553166582}
[S13] START round=17 head_norm_before_train=1.639282 (no previous merge yet)
[S13] round=17 local utility u=0.124869 metrics={'f1_val': 0.6131655428167392, 'auprc': 0.6516581309411815, 'loss_val': 0.6483312490880692, 'psi': 0.6285625780665162}-{'f1_val': 0.573364084836183, 'auprc': 0.6856897211610693, 'loss_val': 0.7613561171238956, 'psi': 0.6182943393661375}
[S14] START round=17 head_norm_before_train=1.396625 cos_to_last_merge=0.8667 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.867
[S14] round=17 local utility u=0.009363 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9988419063204679, 'loss_val': 0.10124134782725455, 'psi': 0.9980090303313817}-{'f1_val': 0.9974284489365712, 'auprc': 0.9970927112816476, 'loss_val': 0.1145669957598291, 'psi': 0.9972941538746019}
[S15] START round=17 head_norm_before_train=1.255648 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6984698174753423, 'auprc': 0.7026140291166091, 'loss_val': 0.5146629045695342, 'psi': 0.700127502131849}-{'f1_val': 0.8572662249729961, 'auprc': 0.8714986672391338, 'loss_val': 0.6549946888802622, 'psi': 0.8629592018794512}
[S16] START round=17 head_norm_before_train=1.631991 (no previous merge yet)
[S16] round=17 local utility u=0.829058 metrics={'f1_val': 0.9268683089555307, 'auprc': 0.9936195972892603, 'loss_val': 0.29509067837578207, 'psi': 0.9535688242890226}-{'f1_val': 0.7620798090701779, 'auprc': 0.8824354704219102, 'loss_val': 0.6309232385996238, 'psi': 0.8102220736108707}
[S17] START round=17 head_norm_before_train=1.453588 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.43684787428426664, 'auprc': 0.8349794312334856, 'loss_val': 0.6145596057045636, 'psi': 0.5961004970639543}-{'f1_val': 0.5855552555939886, 'auprc': 0.8316302400408143, 'loss_val': 0.7009660047428186, 'psi': 0.6839852493727189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[S10] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → trigger blocked (psi=0.998)
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → trigger blocked (psi=0.828)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.3640
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.6469
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.0108
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.0169
[S7] DROPPED delta from S13 (cos=-0.0169 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.9818
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] cosine check vs S7: cos=-0.1590
[S17] DROPPED delta from S7 (cos=-0.1590 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7140 head_norm=1.323783
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.234675e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7140 head_norm=1.060601 delta_norm=0.623468
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.455467
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.179684e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7019 head_norm=1.197885 delta_norm=0.817968
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6959 head_norm=1.602944
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.592157e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6944 head_norm=1.628007 delta_norm=0.159216
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.695102 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.44222043046780757, 'auprc': 0.718198158301018, 'loss_val': 1.2521175850032933, 'psi': 0.5526115216010917}-{'f1_val': 0.701230889339113, 'auprc': 0.7774872884219274, 'loss_val': 0.2802143307128445, 'psi': 0.7317334489722388}
[S3] START round=18 head_norm_before_train=1.998128 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.98555620657673, 'auprc': 0.998291066949287, 'loss_val': 0.039485618054593226, 'psi': 0.9906501507257528}-{'f1_val': 0.9978100342676263, 'auprc': 0.9990444101775833, 'loss_val': 0.029436548020418292, 'psi': 0.9983037846316091}
[S4] START round=18 head_norm_before_train=1.693053 (no previous merge yet)
[S4] round=18 local utility u=0.385868 metrics={'f1_val': 0.6644147065302594, 'auprc': 0.9351108651586446, 'loss_val': 0.48349402414418835, 'psi': 0.7726931699816135}-{'f1_val': 0.6669268580060899, 'auprc': 0.6798722738969666, 'loss_val': 0.5045878065817699, 'psi': 0.6721050243624406}
[S5] START round=18 head_norm_before_train=1.445552 cos_to_last_merge=0.7971 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9877793666381809, 'loss_val': 0.21389856395799955, 'psi': 0.8155042801671103}-{'f1_val': 0.7006099296049884, 'auprc': 0.9878465573233365, 'loss_val': 0.1895808887414595, 'psi': 0.8155045806923276}
[S6] START round=18 head_norm_before_train=1.648089 (no previous merge yet)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.8460714563545871, 'auprc': 0.9613037249639622, 'loss_val': 0.25403051251446834, 'psi': 0.8921643637983372}-{'f1_val': 0.5568128658675598, 'auprc': 0.7805067810377491, 'loss_val': 0.6696990574876567, 'psi': 0.6462904319356355}
[S7] START round=18 head_norm_before_train=1.628007 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.500616418648653, 'auprc': 0.7796744940778109, 'loss_val': 0.9131508496652547, 'psi': 0.6122396488203161}-{'f1_val': 0.6959095226846692, 'auprc': 0.920815342614306, 'loss_val': 0.31394101631250443, 'psi': 0.7858718506565239}
[S8] START round=18 head_norm_before_train=1.060601 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.261521 metrics={'f1_val': 0.810643739786747, 'auprc': 0.9981727111653111, 'loss_val': 0.37683404733290227, 'psi': 0.8856553283381726}-{'f1_val': 0.7139521677339791, 'auprc': 0.99885949536531, 'loss_val': 0.32178597008812565, 'psi': 0.8279150987865115}
[S9] START round=18 head_norm_before_train=1.962439 (no previous merge yet)
[S9] round=18 local utility u=0.005558 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9996061130442659, 'loss_val': 0.02313796805037397, 'psi': 0.9964564387353966}-{'f1_val': 0.9930734107733121, 'auprc': 0.9997097518497483, 'loss_val': 0.026864906346467123, 'psi': 0.9957279472038866}
[S10] START round=18 head_norm_before_train=1.769129 (no previous merge yet)
[S10] round=18 local utility u=0.007779 metrics={'f1_val': 0.994512139992592, 'auprc': 0.9965469044698184, 'loss_val': 0.07331291132781102, 'psi': 0.9953260457834825}-{'f1_val': 0.9959488122292768, 'auprc': 0.9970115605726153, 'loss_val': 0.09888567403777734, 'psi': 0.9963739115666123}
[S11] START round=18 head_norm_before_train=1.197885 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.601589 metrics={'f1_val': 0.9206114380395387, 'auprc': 0.997310765697994, 'loss_val': 0.3484741914098336, 'psi': 0.9512911691029208}-{'f1_val': 0.7016934795869249, 'auprc': 0.9977276118979664, 'loss_val': 0.23939543310774242, 'psi': 0.8201071325113415}
[S13] START round=18 head_norm_before_train=1.655437 (no previous merge yet)
[S13] round=18 local utility u=0.025265 metrics={'f1_val': 0.611906238732522, 'auprc': 0.6825552214760541, 'loss_val': 0.6829375406797653, 'psi': 0.6401658318299348}-{'f1_val': 0.6131655428167392, 'auprc': 0.6516581309411815, 'loss_val': 0.6483312490880692, 'psi': 0.6285625780665162}
[S14] START round=18 head_norm_before_train=1.428171 cos_to_last_merge=0.8631 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.863
[S14] round=18 local utility u=0.004283 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9976377638051617, 'loss_val': 0.08393510712788489, 'psi': 0.9970146572805587}-{'f1_val': 0.9974537796719909, 'auprc': 0.9988419063204679, 'loss_val': 0.10124134782725455, 'psi': 0.9980090303313817}
[S15] START round=18 head_norm_before_train=1.279210 cos_to_last_merge=0.9994 (last merge round=16)
[S15] round=18 local utility u=0.367508 metrics={'f1_val': 0.6908650394331273, 'auprc': 0.9292224215323912, 'loss_val': 0.41384402602500386, 'psi': 0.7862079922728329}-{'f1_val': 0.6984698174753423, 'auprc': 0.7026140291166091, 'loss_val': 0.5146629045695342, 'psi': 0.700127502131849}
[S16] START round=18 head_norm_before_train=1.667958 (no previous merge yet)
[S16] round=18 local utility u=0.090918 metrics={'f1_val': 0.9413569564996023, 'auprc': 0.9956423596341306, 'loss_val': 0.206255508375457, 'psi': 0.9630711177534136}-{'f1_val': 0.9268683089555307, 'auprc': 0.9936195972892603, 'loss_val': 0.29509067837578207, 'psi': 0.9535688242890226}
[S17] START round=18 head_norm_before_train=1.485149 cos_to_last_merge=0.9988 (last merge round=16)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.4178028506728366, 'auprc': 0.8345847905055388, 'loss_val': 0.6239996660217602, 'psi': 0.5845156266059175}-{'f1_val': 0.43684787428426664, 'auprc': 0.8349794312334856, 'loss_val': 0.6145596057045636, 'psi': 0.5961004970639543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.640)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S16] not sending this round → trigger blocked (psi=0.963)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0991
[S9] DROPPED delta from S15 (cos=-0.0991 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.5098
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=-0.0191
[S14] DROPPED delta from S10 (cos=-0.0191 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.9381
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.3049
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.8783
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.0325
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.8106 head_norm=1.096838
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.949922e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9964 head_norm=0.925143 delta_norm=0.594992
[S8] aggregate: ACCEPT kept=['S4', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6909 head_norm=1.301479
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.119771e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6907 head_norm=1.162377 delta_norm=0.311977
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.4178 head_norm=1.514920
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.094155e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.4803 head_norm=1.374033 delta_norm=0.309416
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.707603 (no previous merge yet)
[S2] round=19 local utility u=1.000000 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.7832133849459457, 'loss_val': 0.2925217294784692, 'psi': 0.734336902215357}-{'f1_val': 0.44222043046780757, 'auprc': 0.718198158301018, 'loss_val': 1.2521175850032933, 'psi': 0.5526115216010917}
[S3] START round=19 head_norm_before_train=2.025441 (no previous merge yet)
[S3] round=19 local utility u=0.043252 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9989225568620328, 'loss_val': 0.025928534166291522, 'psi': 0.9980079642124475}-{'f1_val': 0.98555620657673, 'auprc': 0.998291066949287, 'loss_val': 0.039485618054593226, 'psi': 0.9906501507257528}
[S4] START round=19 head_norm_before_train=1.701776 (no previous merge yet)
[S4] round=19 local utility u=0.022537 metrics={'f1_val': 0.665757605585234, 'auprc': 0.9455967308180728, 'loss_val': 0.47793454722834, 'psi': 0.7776932556783696}-{'f1_val': 0.6644147065302594, 'auprc': 0.9351108651586446, 'loss_val': 0.48349402414418835, 'psi': 0.7726931699816135}
[S5] START round=19 head_norm_before_train=1.454993 cos_to_last_merge=0.7951 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8590329791188169, 'loss_val': 0.3348143787701837, 'psi': 0.7640053823749823}-{'f1_val': 0.7006542225197299, 'auprc': 0.9877793666381809, 'loss_val': 0.21389856395799955, 'psi': 0.8155042801671103}
[S6] START round=19 head_norm_before_train=1.657442 (no previous merge yet)
[S6] round=19 local utility u=0.033189 metrics={'f1_val': 0.8484891781552496, 'auprc': 0.9692361188169648, 'loss_val': 0.22595541853534065, 'psi': 0.8967879544199356}-{'f1_val': 0.8460714563545871, 'auprc': 0.9613037249639622, 'loss_val': 0.25403051251446834, 'psi': 0.8921643637983372}
[S7] START round=19 head_norm_before_train=1.653668 cos_to_last_merge=0.9997 (last merge round=17)
[S7] round=19 local utility u=0.221800 metrics={'f1_val': 0.5592213623583147, 'auprc': 0.7821262283844144, 'loss_val': 0.8285351280120203, 'psi': 0.6483833087687545}-{'f1_val': 0.500616418648653, 'auprc': 0.7796744940778109, 'loss_val': 0.9131508496652547, 'psi': 0.6122396488203161}
[S8] START round=19 head_norm_before_train=0.925143 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9988603156704496, 'loss_val': 0.4220108829209092, 'psi': 0.8279154269085673}-{'f1_val': 0.810643739786747, 'auprc': 0.9981727111653111, 'loss_val': 0.37683404733290227, 'psi': 0.8856553283381726}
[S9] START round=19 head_norm_before_train=1.983482 (no previous merge yet)
[S9] round=19 local utility u=0.006447 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970345311976733, 'loss_val': 0.019006304965899605, 'psi': 0.997075559986355}-{'f1_val': 0.994356655862817, 'auprc': 0.9996061130442659, 'loss_val': 0.02313796805037397, 'psi': 0.9964564387353966}
[S10] START round=19 head_norm_before_train=1.799461 (no previous merge yet)
[S10] round=19 local utility u=0.003645 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9959960925558646, 'loss_val': 0.05764454631917652, 'psi': 0.9944330472232404}-{'f1_val': 0.994512139992592, 'auprc': 0.9965469044698184, 'loss_val': 0.07331291132781102, 'psi': 0.9953260457834825}
[S11] START round=19 head_norm_before_train=1.234005 cos_to_last_merge=0.9988 (last merge round=17)
[S11] round=19 local utility u=0.230496 metrics={'f1_val': 0.9767336704419368, 'auprc': 0.9976880475741101, 'loss_val': 0.22534816708083433, 'psi': 0.9851154212948061}-{'f1_val': 0.9206114380395387, 'auprc': 0.997310765697994, 'loss_val': 0.3484741914098336, 'psi': 0.9512911691029208}
[S13] START round=19 head_norm_before_train=1.668549 (no previous merge yet)
[S13] round=19 local utility u=0.022473 metrics={'f1_val': 0.6072293348719571, 'auprc': 0.6764482612976228, 'loss_val': 0.5916086100100475, 'psi': 0.6349169054422235}-{'f1_val': 0.611906238732522, 'auprc': 0.6825552214760541, 'loss_val': 0.6829375406797653, 'psi': 0.6401658318299348}
[S14] START round=19 head_norm_before_train=1.461200 cos_to_last_merge=0.8593 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.859
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.959923847826051, 'auprc': 0.9970921905445878, 'loss_val': 0.08970091759284952, 'psi': 0.9747911849134657}-{'f1_val': 0.9965992529308234, 'auprc': 0.9976377638051617, 'loss_val': 0.08393510712788489, 'psi': 0.9970146572805587}
[S15] START round=19 head_norm_before_train=1.162377 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6953185561841557, 'auprc': 0.7972880921438961, 'loss_val': 0.49176812164296657, 'psi': 0.736106370568052}-{'f1_val': 0.6908650394331273, 'auprc': 0.9292224215323912, 'loss_val': 0.41384402602500386, 'psi': 0.7862079922728329}
[S16] START round=19 head_norm_before_train=1.703999 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.9390744956469821, 'auprc': 0.9937825427572007, 'loss_val': 0.2029519061977709, 'psi': 0.9609577144910695}-{'f1_val': 0.9413569564996023, 'auprc': 0.9956423596341306, 'loss_val': 0.206255508375457, 'psi': 0.9630711177534136}
[S17] START round=19 head_norm_before_train=1.374033 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.029481 metrics={'f1_val': 0.4233137273183516, 'auprc': 0.8457948316528077, 'loss_val': 0.6317327740073875, 'psi': 0.5923061690521341}-{'f1_val': 0.4178028506728366, 'auprc': 0.8345847905055388, 'loss_val': 0.6239996660217602, 'psi': 0.5845156266059175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S9] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S10] not sending this round → trigger blocked (psi=0.994)
[S6] not sending this round → trigger blocked (psi=0.897)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.778)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.5954
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=0.5070
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=0.2870
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=-0.0160
[S7] DROPPED delta from S13 (cos=-0.0160 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=-0.1745
[S17] DROPPED delta from S7 (cos=-0.1745 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.0010
[S15] r=20 psi=0.736 u=0.0000 p_local=0.2374 f1=0.695 auprc=0.797 bytes=12578
[S10] r=20 psi=0.994 u=0.0036 p_local=0.1121 f1=0.993 auprc=0.996 bytes=14373
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7140 head_norm=0.962128
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.629980e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9156 head_norm=0.899557 delta_norm=0.462998
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.828 u=0.0000 p_local=0.1237 f1=0.714 auprc=0.999 bytes=16148
[S5] r=20 psi=0.764 u=0.0000 p_local=0.0800 f1=0.701 auprc=0.859 bytes=14380
[S6] r=20 psi=0.897 u=0.0332 p_local=0.2977 f1=0.848 auprc=0.969 bytes=14368
[S9] r=20 psi=0.997 u=0.0064 p_local=0.0703 f1=0.997 auprc=0.997 bytes=16205
[S14] r=20 psi=0.975 u=0.0000 p_local=0.1180 f1=0.960 auprc=0.997 bytes=14371
[S4] r=20 psi=0.778 u=0.0225 p_local=0.1336 f1=0.666 auprc=0.946 bytes=14378
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6072 head_norm=1.680178
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.092770e+00
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5746 head_norm=1.093802 delta_norm=1.092770
[S13] aggregate: ROLLBACK (f1_val pre=0.607 post=0.575 tol_abs=0.005 tol_rel=0.0)
[S13] r=20 psi=0.635 u=0.0225 p_local=0.0833 f1=0.607 auprc=0.676 bytes=12582
[S3] r=20 psi=0.998 u=0.0433 p_local=0.1136 f1=0.997 auprc=0.999 bytes=16172
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9767 head_norm=1.274621
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.229797e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9593 head_norm=1.493757 delta_norm=0.822980
[S11] aggregate: ROLLBACK (f1_val pre=0.977 post=0.959 tol_abs=0.005 tol_rel=0.0)
[S11] r=20 psi=0.985 u=0.2305 p_local=0.2368 f1=0.977 auprc=0.998 bytes=14355
[S7] r=20 psi=0.648 u=0.2218 p_local=0.2559 f1=0.559 auprc=0.782 bytes=14385
[S2] r=20 psi=0.734 u=1.0000 p_local=0.2692 f1=0.702 auprc=0.783 bytes=16161
[S16] r=20 psi=0.961 u=0.0000 p_local=0.2522 f1=0.939 auprc=0.994 bytes=12586
[S17] r=20 psi=0.592 u=0.0295 p_local=0.1597 f1=0.423 auprc=0.846 bytes=10785
[S2] START round=20 head_norm_before_train=1.717091 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.453716374490725, 'auprc': 0.735495293291986, 'loss_val': 1.0158778780453075, 'psi': 0.5664279420112294}-{'f1_val': 0.7017525803949645, 'auprc': 0.7832133849459457, 'loss_val': 0.2925217294784692, 'psi': 0.734336902215357}
[S3] START round=20 head_norm_before_train=2.047572 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9971986087708467, 'loss_val': 0.11590872978595415, 'psi': 0.975524494748011}-{'f1_val': 0.9973982357793907, 'auprc': 0.9989225568620328, 'loss_val': 0.025928534166291522, 'psi': 0.9980079642124475}
[S4] START round=20 head_norm_before_train=1.714043 (no previous merge yet)
[S4] round=20 local utility u=0.885933 metrics={'f1_val': 0.9563568397050043, 'auprc': 0.9562313714125944, 'loss_val': 0.48156745869743306, 'psi': 0.9563066523880404}-{'f1_val': 0.665757605585234, 'auprc': 0.9455967308180728, 'loss_val': 0.47793454722834, 'psi': 0.7776932556783696}
[S5] START round=20 head_norm_before_train=1.468191 cos_to_last_merge=0.7920 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=20 local utility u=0.415718 metrics={'f1_val': 0.7745805343786053, 'auprc': 0.9639758835308344, 'loss_val': 0.2617677276463981, 'psi': 0.8503386740394969}-{'f1_val': 0.7006536512124258, 'auprc': 0.8590329791188169, 'loss_val': 0.3348143787701837, 'psi': 0.7640053823749823}
[S6] START round=20 head_norm_before_train=1.672322 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7684161809498986, 'auprc': 0.8541705783883395, 'loss_val': 0.4456049319140352, 'psi': 0.8027179399252751}-{'f1_val': 0.8484891781552496, 'auprc': 0.9692361188169648, 'loss_val': 0.22595541853534065, 'psi': 0.8967879544199356}
[S7] START round=20 head_norm_before_train=1.675282 cos_to_last_merge=0.9990 (last merge round=17)
[S7] round=20 local utility u=0.790205 metrics={'f1_val': 0.6916452948482876, 'auprc': 0.8788272670253914, 'loss_val': 0.33277109694779566, 'psi': 0.7665180837191292}-{'f1_val': 0.5592213623583147, 'auprc': 0.7821262283844144, 'loss_val': 0.8285351280120203, 'psi': 0.6483833087687545}
[S8] START round=20 head_norm_before_train=0.899557 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9980405987606581, 'loss_val': 0.42707319968002255, 'psi': 0.8275875401446506}-{'f1_val': 0.7139521677339791, 'auprc': 0.9988603156704496, 'loss_val': 0.4220108829209092, 'psi': 0.8279154269085673}
[S9] START round=20 head_norm_before_train=2.004422 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9995696158478551, 'loss_val': 0.03922206673304141, 'psi': 0.9934094630560137}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970345311976733, 'loss_val': 0.019006304965899605, 'psi': 0.997075559986355}
[S10] START round=20 head_norm_before_train=1.830653 (no previous merge yet)
[S10] round=20 local utility u=0.004583 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9960988879454551, 'loss_val': 0.04903709139498757, 'psi': 0.9944991800707256}-{'f1_val': 0.993391017001491, 'auprc': 0.9959960925558646, 'loss_val': 0.05764454631917652, 'psi': 0.9944330472232404}
[S11] START round=20 head_norm_before_train=1.493757 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.099589 metrics={'f1_val': 0.9965430658414957, 'auprc': 0.9974972901922253, 'loss_val': 0.14445430178531052, 'psi': 0.9969247555817875}-{'f1_val': 0.9767336704419368, 'auprc': 0.9976880475741101, 'loss_val': 0.22534816708083433, 'psi': 0.9851154212948061}
[S13] START round=20 head_norm_before_train=1.093802 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5198791967869447, 'auprc': 0.6818552202628976, 'loss_val': 0.8274726048169201, 'psi': 0.5846696061773259}-{'f1_val': 0.6072293348719571, 'auprc': 0.6764482612976228, 'loss_val': 0.5916086100100475, 'psi': 0.6349169054422235}
[S14] START round=20 head_norm_before_train=1.496220 cos_to_last_merge=0.8553 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.855
[S14] round=20 local utility u=0.107130 metrics={'f1_val': 0.9913383218557374, 'auprc': 0.9987439124124334, 'loss_val': 0.06888253138117642, 'psi': 0.9943005580784159}-{'f1_val': 0.959923847826051, 'auprc': 0.9970921905445878, 'loss_val': 0.08970091759284952, 'psi': 0.9747911849134657}
[S15] START round=20 head_norm_before_train=1.184309 cos_to_last_merge=0.9994 (last merge round=18)
[S15] round=20 local utility u=0.234334 metrics={'f1_val': 0.6856191636443688, 'auprc': 0.9523625122751501, 'loss_val': 0.4301277575489343, 'psi': 0.7923165030966813}-{'f1_val': 0.6953185561841557, 'auprc': 0.7972880921438961, 'loss_val': 0.49176812164296657, 'psi': 0.736106370568052}
[S16] START round=20 head_norm_before_train=1.739662 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8324025141098801, 'auprc': 0.8802527165258066, 'loss_val': 0.7857007317895827, 'psi': 0.8515425950762507}-{'f1_val': 0.9390744956469821, 'auprc': 0.9937825427572007, 'loss_val': 0.2029519061977709, 'psi': 0.9609577144910695}
[S17] START round=20 head_norm_before_train=1.399322 cos_to_last_merge=0.9992 (last merge round=18)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.4243279656791345, 'auprc': 0.8416306736660464, 'loss_val': 0.6469358569388819, 'psi': 0.5912490488738993}-{'f1_val': 0.4233137273183516, 'auprc': 0.8457948316528077, 'loss_val': 0.6317327740073875, 'psi': 0.5923061690521341}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → trigger blocked (psi=0.767)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:61014
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.1010
[S9] DROPPED delta from S15 (cos=-0.1010 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.3006
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.4437
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=-0.0164
[S14] DROPPED delta from S10 (cos=-0.0164 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.3673
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9965 head_norm=1.536031
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.494958e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9953 head_norm=1.248417 delta_norm=0.849496
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.209 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.215 → S8@127.0.0.1:61009
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.7140 head_norm=0.942852
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.069523e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9951 head_norm=0.913777 delta_norm=0.506952
[S8] aggregate: ACCEPT kept=['S14', 'S4'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.099 → S15@127.0.0.1:61015
[S13] ⇄ pheromone p=0.067 → S7@127.0.0.1:61008
[S6] ⇄ pheromone p=0.238 → S17@127.0.0.1:61017
[S7] ⇄ pheromone p=0.363 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.091 → S11@127.0.0.1:61012
[S9] ⇄ pheromone p=0.056 → S17@127.0.0.1:61017
[S15] ⇄ pheromone p=0.237 → S9@127.0.0.1:61010
[S5] ⇄ pheromone p=0.147 → S11@127.0.0.1:61012
[S10] ⇄ pheromone p=0.091 → S14@127.0.0.1:61014
[S14] ⇄ pheromone p=0.116 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.284 → S8@127.0.0.1:61009
[S17] ⇄ pheromone p=0.128 → S13@127.0.0.1:61013
[S16] ⇄ pheromone p=0.202 → S7@127.0.0.1:61008
[S2] START round=21 head_norm_before_train=1.726667 (no previous merge yet)
[S2] round=21 local utility u=1.000000 metrics={'f1_val': 0.8293817477898846, 'auprc': 0.7803566575476313, 'loss_val': 0.2956133224719237, 'psi': 0.8097717116929832}-{'f1_val': 0.453716374490725, 'auprc': 0.735495293291986, 'loss_val': 1.0158778780453075, 'psi': 0.5664279420112294}
[S3] START round=21 head_norm_before_train=2.068020 (no previous merge yet)
[S3] round=21 local utility u=0.154161 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9987578466636342, 'loss_val': 0.032847344991794473, 'psi': 0.998206495145341}-{'f1_val': 0.9610750853994537, 'auprc': 0.9971986087708467, 'loss_val': 0.11590872978595415, 'psi': 0.975524494748011}
[S4] START round=21 head_norm_before_train=1.729453 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.947922601111056, 'auprc': 0.9588019074196021, 'loss_val': 0.4729838098776659, 'psi': 0.9522743236344744}-{'f1_val': 0.9563568397050043, 'auprc': 0.9562313714125944, 'loss_val': 0.48156745869743306, 'psi': 0.9563066523880404}
[S5] START round=21 head_norm_before_train=1.483571 cos_to_last_merge=0.7900 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.9873636406039022, 'loss_val': 0.24238533008107807, 'psi': 0.8153895223976482}-{'f1_val': 0.7745805343786053, 'auprc': 0.9639758835308344, 'loss_val': 0.2617677276463981, 'psi': 0.8503386740394969}
[S6] START round=21 head_norm_before_train=1.691044 (no previous merge yet)
[S6] round=21 local utility u=0.246648 metrics={'f1_val': 0.7970345457646268, 'auprc': 0.9479677093464757, 'loss_val': 0.4054095460954255, 'psi': 0.8574078111973664}-{'f1_val': 0.7684161809498986, 'auprc': 0.8541705783883395, 'loss_val': 0.4456049319140352, 'psi': 0.8027179399252751}
[S7] START round=21 head_norm_before_train=1.692845 cos_to_last_merge=0.9982 (last merge round=17)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5561011300769525, 'auprc': 0.7829820192224012, 'loss_val': 0.869319526626978, 'psi': 0.646853485735132}-{'f1_val': 0.6916452948482876, 'auprc': 0.8788272670253914, 'loss_val': 0.33277109694779566, 'psi': 0.7665180837191292}
[S8] START round=21 head_norm_before_train=0.913777 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.009653 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9990610388701463, 'loss_val': 0.4108287271465706, 'psi': 0.8279957161884459}-{'f1_val': 0.7139521677339791, 'auprc': 0.9980405987606581, 'loss_val': 0.42707319968002255, 'psi': 0.8275875401446506}
[S9] START round=21 head_norm_before_train=2.019250 (no previous merge yet)
[S9] round=21 local utility u=0.030392 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997146201695283, 'loss_val': 0.0179695916536749, 'psi': 0.9971202281853989}-{'f1_val': 0.9893026945281196, 'auprc': 0.9995696158478551, 'loss_val': 0.03922206673304141, 'psi': 0.9934094630560137}
[S10] START round=21 head_norm_before_train=1.855100 (no previous merge yet)
[S10] round=21 local utility u=0.003639 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934622627233012, 'loss_val': 0.04437954326324491, 'psi': 0.9944976085009454}-{'f1_val': 0.9934327081542391, 'auprc': 0.9960988879454551, 'loss_val': 0.04903709139498757, 'psi': 0.9944991800707256}
[S11] START round=21 head_norm_before_train=1.248417 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9974190408796244, 'loss_val': 0.20509080301734037, 'psi': 0.9957415460457957}-{'f1_val': 0.9965430658414957, 'auprc': 0.9974972901922253, 'loss_val': 0.14445430178531052, 'psi': 0.9969247555817875}
[S13] START round=21 head_norm_before_train=1.110939 cos_to_last_merge=0.9995 (last merge round=19)
[S13] round=21 local utility u=0.292369 metrics={'f1_val': 0.6033734815336772, 'auprc': 0.6814097965957314, 'loss_val': 0.742364475677167, 'psi': 0.6345880075584989}-{'f1_val': 0.5198791967869447, 'auprc': 0.6818552202628976, 'loss_val': 0.8274726048169201, 'psi': 0.5846696061773259}
[S14] START round=21 head_norm_before_train=1.526343 cos_to_last_merge=0.8521 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.852
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9516472968236072, 'auprc': 0.9989281955770376, 'loss_val': 0.1586280244066833, 'psi': 0.9705596563249793}-{'f1_val': 0.9913383218557374, 'auprc': 0.9987439124124334, 'loss_val': 0.06888253138117642, 'psi': 0.9943005580784159}
[S15] START round=21 head_norm_before_train=1.211821 cos_to_last_merge=0.9976 (last merge round=18)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6921512908024718, 'auprc': 0.7972925782103361, 'loss_val': 0.4552073747156907, 'psi': 0.7342078057656176}-{'f1_val': 0.6856191636443688, 'auprc': 0.9523625122751501, 'loss_val': 0.4301277575489343, 'psi': 0.7923165030966813}
[S16] START round=21 head_norm_before_train=1.771258 (no previous merge yet)
[S16] round=21 local utility u=0.973219 metrics={'f1_val': 0.9899475605711491, 'auprc': 0.9920553036606997, 'loss_val': 0.11994116945062905, 'psi': 0.9907906578069694}-{'f1_val': 0.8324025141098801, 'auprc': 0.8802527165258066, 'loss_val': 0.7857007317895827, 'psi': 0.8515425950762507}
[S17] START round=21 head_norm_before_train=1.426284 cos_to_last_merge=0.9971 (last merge round=18)
[S17] round=21 local utility u=1.000000 metrics={'f1_val': 0.7418622562918885, 'auprc': 0.895499217026791, 'loss_val': 0.5130772060371219, 'psi': 0.8033170405858496}-{'f1_val': 0.4243279656791345, 'auprc': 0.8416306736660464, 'loss_val': 0.6469358569388819, 'psi': 0.5912490488738993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S10] not sending this round → trigger blocked (psi=0.994)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.1114
[S7] DROPPED delta from S13 (cos=-0.1114 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9785
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.4465
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.8749
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.5985
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.4232
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.7700
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.5924
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5561 head_norm=1.706844
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.867007e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5658 head_norm=1.741878 delta_norm=0.186701
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9946 head_norm=1.291850
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.371887e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9951 head_norm=1.521912 delta_norm=0.837189
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.7140 head_norm=0.964759
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.951544e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.7142 head_norm=1.158203 delta_norm=0.795154
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6034 head_norm=1.144132
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.022309e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5581 head_norm=1.160804 delta_norm=0.602231
[S13] aggregate: ROLLBACK (f1_val pre=0.603 post=0.558 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.6922 head_norm=1.241701
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.961365e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6920 head_norm=1.038926 delta_norm=0.396136
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.7419 head_norm=1.453016
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.138344e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.7512 head_norm=1.375871 delta_norm=0.213834
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.736850 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.458818793080254, 'auprc': 0.7155535020909831, 'loss_val': 0.9203561429295719, 'psi': 0.5615126766845456}-{'f1_val': 0.8293817477898846, 'auprc': 0.7803566575476313, 'loss_val': 0.2956133224719237, 'psi': 0.8097717116929832}
[S3] START round=22 head_norm_before_train=2.089336 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9861460463825814, 'auprc': 0.9979898820729871, 'loss_val': 0.06679990354407447, 'psi': 0.9908835806587437}-{'f1_val': 0.9978389274664787, 'auprc': 0.9987578466636342, 'loss_val': 0.032847344991794473, 'psi': 0.998206495145341}
[S4] START round=22 head_norm_before_train=1.743701 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.945197448685557, 'auprc': 0.9552655842510216, 'loss_val': 0.45697781684419525, 'psi': 0.9492247029117428}-{'f1_val': 0.947922601111056, 'auprc': 0.9588019074196021, 'loss_val': 0.4729838098776659, 'psi': 0.9522743236344744}
[S5] START round=22 head_norm_before_train=1.496258 cos_to_last_merge=0.7881 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.987345099068988, 'loss_val': 0.282090357353163, 'psi': 0.8153821057836824}-{'f1_val': 0.7007401102601454, 'auprc': 0.9873636406039022, 'loss_val': 0.24238533008107807, 'psi': 0.8153895223976482}
[S6] START round=22 head_norm_before_train=1.708892 (no previous merge yet)
[S6] round=22 local utility u=0.139682 metrics={'f1_val': 0.8316284917871692, 'auprc': 0.9532620763928394, 'loss_val': 0.34949182561274655, 'psi': 0.8802819256294374}-{'f1_val': 0.7970345457646268, 'auprc': 0.9479677093464757, 'loss_val': 0.4054095460954255, 'psi': 0.8574078111973664}
[S7] START round=22 head_norm_before_train=1.741878 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.173421 metrics={'f1_val': 0.5940336835656364, 'auprc': 0.7896242564844153, 'loss_val': 0.7699987591235768, 'psi': 0.672269912733148}-{'f1_val': 0.5561011300769525, 'auprc': 0.7829820192224012, 'loss_val': 0.869319526626978, 'psi': 0.646853485735132}
[S8] START round=22 head_norm_before_train=1.158203 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.041037 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9937230873268406, 'loss_val': 0.31273999420181126, 'psi': 0.8258605355711237}-{'f1_val': 0.7139521677339791, 'auprc': 0.9990610388701463, 'loss_val': 0.4108287271465706, 'psi': 0.8279957161884459}
[S9] START round=22 head_norm_before_train=2.034089 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9996628458707216, 'loss_val': 0.038058893794114784, 'psi': 0.9934467550651604}-{'f1_val': 0.9971029125121428, 'auprc': 0.997146201695283, 'loss_val': 0.0179695916536749, 'psi': 0.9971202281853989}
[S10] START round=22 head_norm_before_train=1.876448 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9923222846552487, 'loss_val': 0.04183974222205904, 'psi': 0.9937923358717028}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934622627233012, 'loss_val': 0.04437954326324491, 'psi': 0.9944976085009454}
[S11] START round=22 head_norm_before_train=1.521912 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.047046 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974514326395252, 'loss_val': 0.12263859160982936, 'psi': 0.9969087757639639}-{'f1_val': 0.9946232161565767, 'auprc': 0.9974190408796244, 'loss_val': 0.20509080301734037, 'psi': 0.9957415460457957}
[S13] START round=22 head_norm_before_train=1.160804 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5841955053341825, 'auprc': 0.655120440390889, 'loss_val': 0.9025701796137119, 'psi': 0.6125654793568651}-{'f1_val': 0.6033734815336772, 'auprc': 0.6814097965957314, 'loss_val': 0.742364475677167, 'psi': 0.6345880075584989}
[S14] START round=22 head_norm_before_train=1.551132 cos_to_last_merge=0.8494 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=22 local utility u=0.189711 metrics={'f1_val': 0.996993452559553, 'auprc': 0.998416174402377, 'loss_val': 0.04974653857203092, 'psi': 0.9975625412966825}-{'f1_val': 0.9516472968236072, 'auprc': 0.9989281955770376, 'loss_val': 0.1586280244066833, 'psi': 0.9705596563249793}
[S15] START round=22 head_norm_before_train=1.038926 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.087840 metrics={'f1_val': 0.6962603732170171, 'auprc': 0.8574963456818662, 'loss_val': 0.4847923506082994, 'psi': 0.7607547622029567}-{'f1_val': 0.6921512908024718, 'auprc': 0.7972925782103361, 'loss_val': 0.4552073747156907, 'psi': 0.7342078057656176}
[S16] START round=22 head_norm_before_train=1.795738 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9405211768361263, 'auprc': 0.9951246152385296, 'loss_val': 0.17393449503595113, 'psi': 0.9623625521970877}-{'f1_val': 0.9899475605711491, 'auprc': 0.9920553036606997, 'loss_val': 0.11994116945062905, 'psi': 0.9907906578069694}
[S17] START round=22 head_norm_before_train=1.375871 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.520463716379963, 'auprc': 0.706420248183097, 'loss_val': 0.7213118486941883, 'psi': 0.5948463291012167}-{'f1_val': 0.7418622562918885, 'auprc': 0.895499217026791, 'loss_val': 0.5130772060371219, 'psi': 0.8033170405858496}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.880)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.826)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S15
[S9] cosine check vs S15: cos=-0.1119
[S9] DROPPED delta from S15 (cos=-0.1119 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.2010
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=0.1237
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=-0.1821
[S17] DROPPED delta from S7 (cos=-0.1821 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.7140 head_norm=1.204367
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.525880e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9961 head_norm=0.934372 delta_norm=0.752588
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.746838 (no previous merge yet)
[S2] round=23 local utility u=1.000000 metrics={'f1_val': 0.8162693777791156, 'auprc': 0.8027489516292587, 'loss_val': 0.33890885208372273, 'psi': 0.8108612073191728}-{'f1_val': 0.458818793080254, 'auprc': 0.7155535020909831, 'loss_val': 0.9203561429295719, 'psi': 0.5615126766845456}
[S3] START round=23 head_norm_before_train=2.108592 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.8480392701185069, 'auprc': 0.9971954289370277, 'loss_val': 0.31903940551966675, 'psi': 0.9077017336459152}-{'f1_val': 0.9861460463825814, 'auprc': 0.9979898820729871, 'loss_val': 0.06679990354407447, 'psi': 0.9908835806587437}
[S4] START round=23 head_norm_before_train=1.756509 (no previous merge yet)
[S4] round=23 local utility u=0.077051 metrics={'f1_val': 0.9579566758145556, 'auprc': 0.9525389492654376, 'loss_val': 0.37125205849809934, 'psi': 0.9557895851949084}-{'f1_val': 0.945197448685557, 'auprc': 0.9552655842510216, 'loss_val': 0.45697781684419525, 'psi': 0.9492247029117428}
[S5] START round=23 head_norm_before_train=1.507030 cos_to_last_merge=0.7865 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=23 local utility u=0.635459 metrics={'f1_val': 0.8896265392825983, 'auprc': 0.9898094073443382, 'loss_val': 0.15188310131234764, 'psi': 0.9296996865072942}-{'f1_val': 0.7007401102601454, 'auprc': 0.987345099068988, 'loss_val': 0.282090357353163, 'psi': 0.8153821057836824}
[S6] START round=23 head_norm_before_train=1.724370 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.614719954965979, 'auprc': 0.8054601877914899, 'loss_val': 0.7429889230419435, 'psi': 0.6910160480961833}-{'f1_val': 0.8316284917871692, 'auprc': 0.9532620763928394, 'loss_val': 0.34949182561274655, 'psi': 0.8802819256294374}
[S7] START round=23 head_norm_before_train=1.753914 cos_to_last_merge=0.9999 (last merge round=21)
[S7] round=23 local utility u=0.150686 metrics={'f1_val': 0.6160097814810083, 'auprc': 0.797708617073648, 'loss_val': 0.6247369438946361, 'psi': 0.6886893157180642}-{'f1_val': 0.5940336835656364, 'auprc': 0.7896242564844153, 'loss_val': 0.7699987591235768, 'psi': 0.672269912733148}
[S8] START round=23 head_norm_before_train=0.934372 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.790213 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9940434884839602, 'loss_val': 0.4267809531920798, 'psi': 0.9953392574336758}-{'f1_val': 0.7139521677339791, 'auprc': 0.9937230873268406, 'loss_val': 0.31273999420181126, 'psi': 0.8258605355711237}
[S9] START round=23 head_norm_before_train=2.049354 (no previous merge yet)
[S9] round=23 local utility u=0.025851 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9954912725575097, 'loss_val': 0.018180217923838848, 'psi': 0.9962120037818611}-{'f1_val': 0.9893026945281196, 'auprc': 0.9996628458707216, 'loss_val': 0.038058893794114784, 'psi': 0.9934467550651604}
[S10] START round=23 head_norm_before_train=1.896333 (no previous merge yet)
[S10] round=23 local utility u=0.001128 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9955740995617471, 'loss_val': 0.04130217839976612, 'psi': 0.9942892647172423}-{'f1_val': 0.9947723700160056, 'auprc': 0.9923222846552487, 'loss_val': 0.04183974222205904, 'psi': 0.9937923358717028}
[S11] START round=23 head_norm_before_train=1.558349 cos_to_last_merge=0.9996 (last merge round=21)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9949334493842471, 'loss_val': 0.12550213045525457, 'psi': 0.9959015824618526}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974514326395252, 'loss_val': 0.12263859160982936, 'psi': 0.9969087757639639}
[S13] START round=23 head_norm_before_train=1.187176 cos_to_last_merge=0.9953 (last merge round=21)
[S13] round=23 local utility u=0.176509 metrics={'f1_val': 0.6172886308770946, 'auprc': 0.6574542052324727, 'loss_val': 0.7551129801959668, 'psi': 0.6333548606192458}-{'f1_val': 0.5841955053341825, 'auprc': 0.655120440390889, 'loss_val': 0.9025701796137119, 'psi': 0.6125654793568651}
[S14] START round=23 head_norm_before_train=1.574838 cos_to_last_merge=0.8467 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.847
[S14] round=23 local utility u=0.004424 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989229433349629, 'loss_val': 0.04490810289062649, 'psi': 0.9980141390350206}-{'f1_val': 0.996993452559553, 'auprc': 0.998416174402377, 'loss_val': 0.04974653857203092, 'psi': 0.9975625412966825}
[S15] START round=23 head_norm_before_train=1.070111 cos_to_last_merge=0.9988 (last merge round=21)
[S15] round=23 local utility u=0.302738 metrics={'f1_val': 0.7322619805889639, 'auprc': 0.9554529360666113, 'loss_val': 0.38919628195917905, 'psi': 0.8215383627800228}-{'f1_val': 0.6962603732170171, 'auprc': 0.8574963456818662, 'loss_val': 0.4847923506082994, 'psi': 0.7607547622029567}
[S16] START round=23 head_norm_before_train=1.819039 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8630155866385554, 'auprc': 0.9053549907397833, 'loss_val': 0.6285411781433574, 'psi': 0.8799513482790465}-{'f1_val': 0.9405211768361263, 'auprc': 0.9951246152385296, 'loss_val': 0.17393449503595113, 'psi': 0.9623625521970877}
[S17] START round=23 head_norm_before_train=1.399332 cos_to_last_merge=0.9995 (last merge round=21)
[S17] round=23 local utility u=0.153709 metrics={'f1_val': 0.5537507109766767, 'auprc': 0.7379751815205162, 'loss_val': 0.7082809784880336, 'psi': 0.6274404991942125}-{'f1_val': 0.520463716379963, 'auprc': 0.706420248183097, 'loss_val': 0.7213118486941883, 'psi': 0.5948463291012167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S7] not sending this round → trigger blocked (psi=0.689)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:61008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.822)
[S13] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.2390
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.6005
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.3724
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] cosine check vs S13: cos=-0.1516
[S7] DROPPED delta from S13 (cos=-0.1516 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.8334
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.7538
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=-0.0139
[S14] DROPPED delta from S10 (cos=-0.0139 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] cosine check vs S17: cos=0.8454
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9965 head_norm=1.590992
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.712232e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.287659 delta_norm=0.871223
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7323 head_norm=1.110577
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.711123e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7097 head_norm=0.975479 delta_norm=0.371112
[S15] aggregate: ROLLBACK (f1_val pre=0.732 post=0.710 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6173 head_norm=1.229742
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.800253e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6053 head_norm=1.273937 delta_norm=0.380025
[S13] aggregate: ROLLBACK (f1_val pre=0.617 post=0.605 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9962 head_norm=0.972207
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.399907e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9964 head_norm=1.004707 delta_norm=0.539991
[S8] aggregate: ACCEPT kept=['S4', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.5538 head_norm=1.422112
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.880897e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.5786 head_norm=1.669576 delta_norm=0.588090
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.755059 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.735199503786927, 'auprc': 0.7969794584732401, 'loss_val': 0.5352209296790705, 'psi': 0.7599114856614523}-{'f1_val': 0.8162693777791156, 'auprc': 0.8027489516292587, 'loss_val': 0.33890885208372273, 'psi': 0.8108612073191728}
[S3] START round=24 head_norm_before_train=2.124711 (no previous merge yet)
[S3] round=24 local utility u=0.450891 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9973529372138059, 'loss_val': 0.09872637337042593, 'psi': 0.9758642880585309}-{'f1_val': 0.8480392701185069, 'auprc': 0.9971954289370277, 'loss_val': 0.31903940551966675, 'psi': 0.9077017336459152}
[S4] START round=24 head_norm_before_train=1.769400 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9404000391788907, 'auprc': 0.9560503991616931, 'loss_val': 0.40873053297770556, 'psi': 0.9466601831720116}-{'f1_val': 0.9579566758145556, 'auprc': 0.9525389492654376, 'loss_val': 0.37125205849809934, 'psi': 0.9557895851949084}
[S5] START round=24 head_norm_before_train=1.517542 cos_to_last_merge=0.7851 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.8269381188621889, 'auprc': 0.9819916763470847, 'loss_val': 0.2028562450268449, 'psi': 0.8889595418561473}-{'f1_val': 0.8896265392825983, 'auprc': 0.9898094073443382, 'loss_val': 0.15188310131234764, 'psi': 0.9296996865072942}
[S6] START round=24 head_norm_before_train=1.739628 (no previous merge yet)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.975631249605701, 'auprc': 0.9682698815556321, 'loss_val': 0.1583736830325528, 'psi': 0.9726867023856736}-{'f1_val': 0.614719954965979, 'auprc': 0.8054601877914899, 'loss_val': 0.7429889230419435, 'psi': 0.6910160480961833}
[S7] START round=24 head_norm_before_train=1.764160 cos_to_last_merge=0.9998 (last merge round=21)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5748581662320805, 'auprc': 0.7851193417744757, 'loss_val': 0.7657701591307279, 'psi': 0.6589626364490386}-{'f1_val': 0.6160097814810083, 'auprc': 0.797708617073648, 'loss_val': 0.6247369438946361, 'psi': 0.6886893157180642}
[S8] START round=24 head_norm_before_train=1.004707 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9974015283513877, 'loss_val': 0.3901528760606073, 'psi': 0.8273708401248238}-{'f1_val': 0.9962031034001528, 'auprc': 0.9940434884839602, 'loss_val': 0.4267809531920798, 'psi': 0.9953392574336758}
[S9] START round=24 head_norm_before_train=2.060161 (no previous merge yet)
[S9] round=24 local utility u=0.006929 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9996427577607265, 'loss_val': 0.017736501803559585, 'psi': 0.9979686543596449}-{'f1_val': 0.9966924912647621, 'auprc': 0.9954912725575097, 'loss_val': 0.018180217923838848, 'psi': 0.9962120037818611}
[S10] START round=24 head_norm_before_train=1.911526 (no previous merge yet)
[S10] round=24 local utility u=0.001299 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9923878388760029, 'loss_val': 0.039675337990545734, 'psi': 0.994067838962026}-{'f1_val': 0.9934327081542391, 'auprc': 0.9955740995617471, 'loss_val': 0.04130217839976612, 'psi': 0.9942892647172423}
[S11] START round=24 head_norm_before_train=1.287659 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9950752890083077, 'loss_val': 0.14956410927940816, 'psi': 0.9959583183114769}-{'f1_val': 0.9965470045135896, 'auprc': 0.9949334493842471, 'loss_val': 0.12550213045525457, 'psi': 0.9959015824618526}
[S13] START round=24 head_norm_before_train=1.273937 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6049143095489504, 'auprc': 0.6554518719152994, 'loss_val': 0.8292446439609087, 'psi': 0.62512933449549}-{'f1_val': 0.6172886308770946, 'auprc': 0.6574542052324727, 'loss_val': 0.7551129801959668, 'psi': 0.6333548606192458}
[S14] START round=24 head_norm_before_train=1.598304 cos_to_last_merge=0.8443 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.844
[S14] round=24 local utility u=0.001512 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989270711784219, 'loss_val': 0.04189607136083545, 'psi': 0.9980157901724042}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989229433349629, 'loss_val': 0.04490810289062649, 'psi': 0.9980141390350206}
[S15] START round=24 head_norm_before_train=0.975479 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.698535568419837, 'auprc': 0.9379373225681862, 'loss_val': 0.49914215484403546, 'psi': 0.7942962700791767}-{'f1_val': 0.7322619805889639, 'auprc': 0.9554529360666113, 'loss_val': 0.38919628195917905, 'psi': 0.8215383627800228}
[S16] START round=24 head_norm_before_train=1.840714 (no previous merge yet)
[S16] round=24 local utility u=0.816101 metrics={'f1_val': 0.9927491997871516, 'auprc': 0.997136630140428, 'loss_val': 0.05008653287262656, 'psi': 0.9945041719284622}-{'f1_val': 0.8630155866385554, 'auprc': 0.9053549907397833, 'loss_val': 0.6285411781433574, 'psi': 0.8799513482790465}
[S17] START round=24 head_norm_before_train=1.669576 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5131045688460469, 'auprc': 0.6869037000380358, 'loss_val': 0.986578810329727, 'psi': 0.5826242213228425}-{'f1_val': 0.5537507109766767, 'auprc': 0.7379751815205162, 'loss_val': 0.7082809784880336, 'psi': 0.6274404991942125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S9] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S10] not sending this round → trigger blocked (psi=0.994)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.2262
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.2663
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.6004
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.9882
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5749 head_norm=1.780826
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.459577e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5743 head_norm=1.816260 delta_norm=0.145958
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.325482
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.546048e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.559139 delta_norm=0.854605
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7140 head_norm=1.044743
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.395384e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9784 head_norm=1.075203 delta_norm=0.839538
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.5131 head_norm=1.691069
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.071376e+00
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.4987 head_norm=1.348453 delta_norm=1.071376
[S17] aggregate: ROLLBACK (f1_val pre=0.513 post=0.499 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.762352 (no previous merge yet)
[S2] round=25 local utility u=0.491328 metrics={'f1_val': 0.8593059015312332, 'auprc': 0.8091837149725889, 'loss_val': 0.333815421763024, 'psi': 0.8392570269077755}-{'f1_val': 0.735199503786927, 'auprc': 0.7969794584732401, 'loss_val': 0.5352209296790705, 'psi': 0.7599114856614523}
[S3] START round=25 head_norm_before_train=2.136732 (no previous merge yet)
[S3] round=25 local utility u=0.105337 metrics={'f1_val': 0.9859851590918147, 'auprc': 0.99731293402743, 'loss_val': 0.034612610546060206, 'psi': 0.9905162690660608}-{'f1_val': 0.9615385219550141, 'auprc': 0.9973529372138059, 'loss_val': 0.09872637337042593, 'psi': 0.9758642880585309}
[S4] START round=25 head_norm_before_train=1.781512 (no previous merge yet)
[S4] round=25 local utility u=0.018107 metrics={'f1_val': 0.9401188420949204, 'auprc': 0.9512330367086941, 'loss_val': 0.356377182985526, 'psi': 0.9445645199404298}-{'f1_val': 0.9404000391788907, 'auprc': 0.9560503991616931, 'loss_val': 0.40873053297770556, 'psi': 0.9466601831720116}
[S5] START round=25 head_norm_before_train=1.535104 cos_to_last_merge=0.7826 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=25 local utility u=0.281471 metrics={'f1_val': 0.9062034667916529, 'auprc': 0.989881096065439, 'loss_val': 0.13917383731200808, 'psi': 0.9396745185011672}-{'f1_val': 0.8269381188621889, 'auprc': 0.9819916763470847, 'loss_val': 0.2028562450268449, 'psi': 0.8889595418561473}
[S6] START round=25 head_norm_before_train=1.752891 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7450355483957033, 'auprc': 0.9374837378568908, 'loss_val': 0.5469071300897209, 'psi': 0.8220148241801783}-{'f1_val': 0.975631249605701, 'auprc': 0.9682698815556321, 'loss_val': 0.1583736830325528, 'psi': 0.9726867023856736}
[S7] START round=25 head_norm_before_train=1.816260 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.045212 metrics={'f1_val': 0.589428387497291, 'auprc': 0.7860081917239465, 'loss_val': 0.7654332926143386, 'psi': 0.6680603091879532}-{'f1_val': 0.5748581662320805, 'auprc': 0.7851193417744757, 'loss_val': 0.7657701591307279, 'psi': 0.6589626364490386}
[S8] START round=25 head_norm_before_train=1.075203 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.819272 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9944347143574707, 'loss_val': 0.4367237128741771, 'psi': 0.995585730704363}-{'f1_val': 0.7140170479737811, 'auprc': 0.9974015283513877, 'loss_val': 0.3901528760606073, 'psi': 0.8273708401248238}
[S9] START round=25 head_norm_before_train=2.065098 (no previous merge yet)
[S9] round=25 local utility u=0.001479 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999492855455788, 'loss_val': 0.017200591496350174, 'psi': 0.9982414617255172}-{'f1_val': 0.9968525854255906, 'auprc': 0.9996427577607265, 'loss_val': 0.017736501803559585, 'psi': 0.9979686543596449}
[S10] START round=25 head_norm_before_train=1.926869 (no previous merge yet)
[S10] round=25 local utility u=0.004123 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937281540751755, 'loss_val': 0.03626177604290884, 'psi': 0.9946851339683084}-{'f1_val': 0.9951878390193748, 'auprc': 0.9923878388760029, 'loss_val': 0.039675337990545734, 'psi': 0.994067838962026}
[S11] START round=25 head_norm_before_train=1.559139 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.004816 metrics={'f1_val': 0.9872189173295064, 'auprc': 0.9980428455517041, 'loss_val': 0.09286591824095633, 'psi': 0.9915484886183854}-{'f1_val': 0.9965470045135896, 'auprc': 0.9950752890083077, 'loss_val': 0.14956410927940816, 'psi': 0.9959583183114769}
[S13] START round=25 head_norm_before_train=1.301336 cos_to_last_merge=0.9958 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5791483373047525, 'auprc': 0.661413177430518, 'loss_val': 0.8214258678538326, 'psi': 0.6120542733550587}-{'f1_val': 0.6049143095489504, 'auprc': 0.6554518719152994, 'loss_val': 0.8292446439609087, 'psi': 0.62512933449549}
[S14] START round=25 head_norm_before_train=1.621815 cos_to_last_merge=0.8418 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.842
[S14] round=25 local utility u=0.001898 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9989326374863445, 'loss_val': 0.03681136651996609, 'psi': 0.9978875279546302}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989270711784219, 'loss_val': 0.04189607136083545, 'psi': 0.9980157901724042}
[S15] START round=25 head_norm_before_train=1.010539 cos_to_last_merge=0.9981 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6504277216741223, 'auprc': 0.9550514920458345, 'loss_val': 0.487500140529862, 'psi': 0.7722772298228072}-{'f1_val': 0.698535568419837, 'auprc': 0.9379373225681862, 'loss_val': 0.49914215484403546, 'psi': 0.7942962700791767}
[S16] START round=25 head_norm_before_train=1.862490 (no previous merge yet)
[S16] round=25 local utility u=0.000501 metrics={'f1_val': 0.9925303069050562, 'auprc': 0.9969027224248758, 'loss_val': 0.047069266656324195, 'psi': 0.994279273112984}-{'f1_val': 0.9927491997871516, 'auprc': 0.997136630140428, 'loss_val': 0.05008653287262656, 'psi': 0.9945041719284622}
[S17] START round=25 head_norm_before_train=1.348453 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.649181 metrics={'f1_val': 0.6572728521988801, 'auprc': 0.7601134829215694, 'loss_val': 0.7728558943631945, 'psi': 0.6984091044879559}-{'f1_val': 0.5131045688460469, 'auprc': 0.6869037000380358, 'loss_val': 0.986578810329727, 'psi': 0.5826242213228425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:61014
[S3] not sending this round → trigger blocked (psi=0.991)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.7666
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=-0.1980
[S17] DROPPED delta from S7 (cos=-0.1980 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.6174
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.3695
[S8] RECEIVED delta(kind=head bytes=1805) from S4
[S8] cosine check vs S4: cos=0.2975
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0127
[S14] DROPPED delta from S10 (cos=-0.0127 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S11
[S8] cosine check vs S11: cos=0.2465
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.3703
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=0.8481
[S3] ⇄ pheromone p=0.136 → S11@127.0.0.1:61012
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5791 head_norm=1.337981
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.731287e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5702 head_norm=1.300630 delta_norm=0.373129
[S13] aggregate: ROLLBACK (f1_val pre=0.579 post=0.570 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.068 → S7@127.0.0.1:61008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.6504 head_norm=1.050781
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.681249e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7314 head_norm=1.010868 delta_norm=0.368125
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.125 → S9@127.0.0.1:61010
[S6] ⇄ pheromone p=0.273 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=0.059 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.165 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.031 → S14@127.0.0.1:61014
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9872 head_norm=1.596524
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.839160e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9872 head_norm=1.302451 delta_norm=0.883916
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.074 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.107 → S8@127.0.0.1:61009
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9964 head_norm=1.100272
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.190867e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9965 head_norm=0.921920 delta_norm=0.519087
[S8] aggregate: ACCEPT kept=['S4', 'S11', 'S2'] (k=3/3) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.302 → S15@127.0.0.1:61015
[S5] ⇄ pheromone p=0.186 → S11@127.0.0.1:61012
[S2] ⇄ pheromone p=0.379 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=0.026 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.277 → S7@127.0.0.1:61008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6573 head_norm=1.368041
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.154364e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6382 head_norm=1.553434 delta_norm=0.815436
[S17] aggregate: ROLLBACK (f1_val pre=0.657 post=0.638 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.273 → S13@127.0.0.1:61013
[S2] START round=26 head_norm_before_train=1.772905 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.8463900936810861, 'auprc': 0.806545350908164, 'loss_val': 0.3047008560096207, 'psi': 0.8304521965719173}-{'f1_val': 0.8593059015312332, 'auprc': 0.8091837149725889, 'loss_val': 0.333815421763024, 'psi': 0.8392570269077755}
[S3] START round=26 head_norm_before_train=2.153176 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9746456354643639, 'auprc': 0.9980743801478438, 'loss_val': 0.049668021164751504, 'psi': 0.9840171333377559}-{'f1_val': 0.9859851590918147, 'auprc': 0.99731293402743, 'loss_val': 0.034612610546060206, 'psi': 0.9905162690660608}
[S4] START round=26 head_norm_before_train=1.794189 (no previous merge yet)
[S4] round=26 local utility u=0.119258 metrics={'f1_val': 0.9570006968963041, 'auprc': 0.9779903707903891, 'loss_val': 0.2994250069454594, 'psi': 0.9653965664539381}-{'f1_val': 0.9401188420949204, 'auprc': 0.9512330367086941, 'loss_val': 0.356377182985526, 'psi': 0.9445645199404298}
[S5] START round=26 head_norm_before_train=1.551285 cos_to_last_merge=0.7796 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=26 local utility u=0.306120 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.991846261088759, 'loss_val': 0.07802495447052823, 'psi': 0.9949802396021422}-{'f1_val': 0.9062034667916529, 'auprc': 0.989881096065439, 'loss_val': 0.13917383731200808, 'psi': 0.9396745185011672}
[S6] START round=26 head_norm_before_train=1.764719 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6193266799059485, 'auprc': 0.9383806444877784, 'loss_val': 0.4085027396886513, 'psi': 0.7469482657386805}-{'f1_val': 0.7450355483957033, 'auprc': 0.9374837378568908, 'loss_val': 0.5469071300897209, 'psi': 0.8220148241801783}
[S7] START round=26 head_norm_before_train=1.830850 cos_to_last_merge=0.9998 (last merge round=24)
[S7] round=26 local utility u=0.222629 metrics={'f1_val': 0.6174983957308511, 'auprc': 0.8015256579590903, 'loss_val': 0.5351485430064509, 'psi': 0.6911093006221467}-{'f1_val': 0.589428387497291, 'auprc': 0.7860081917239465, 'loss_val': 0.7654332926143386, 'psi': 0.6680603091879532}
[S8] START round=26 head_norm_before_train=0.921920 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9979936790257934, 'loss_val': 0.39789383511930665, 'psi': 0.8276077003945861}-{'f1_val': 0.9963530749356245, 'auprc': 0.9944347143574707, 'loss_val': 0.4367237128741771, 'psi': 0.995585730704363}
[S9] START round=26 head_norm_before_train=2.069940 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9999168625486592, 'loss_val': 0.03386738508294151, 'psi': 0.9940563429502896}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999492855455788, 'loss_val': 0.017200591496350174, 'psi': 0.9982414617255172}
[S10] START round=26 head_norm_before_train=1.942811 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9956233918140733, 'loss_val': 0.035548035188444814, 'psi': 0.9947847209504109}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937281540751755, 'loss_val': 0.03626177604290884, 'psi': 0.9946851339683084}
[S11] START round=26 head_norm_before_train=1.302451 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000381 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994630600710086, 'loss_val': 0.1378352767140528, 'psi': 0.9957804429921882}-{'f1_val': 0.9872189173295064, 'auprc': 0.9980428455517041, 'loss_val': 0.09286591824095633, 'psi': 0.9915484886183854}
[S13] START round=26 head_norm_before_train=1.300630 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.103864 metrics={'f1_val': 0.6127497881659323, 'auprc': 0.6504680945909254, 'loss_val': 0.7824710297180196, 'psi': 0.6278371107359295}-{'f1_val': 0.5791483373047525, 'auprc': 0.661413177430518, 'loss_val': 0.8214258678538326, 'psi': 0.6120542733550587}
[S14] START round=26 head_norm_before_train=1.643521 cos_to_last_merge=0.8397 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.840
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9575312618070002, 'auprc': 0.9983689340498427, 'loss_val': 0.07474616628307487, 'psi': 0.9738663307041372}-{'f1_val': 0.9971907882668205, 'auprc': 0.9989326374863445, 'loss_val': 0.03681136651996609, 'psi': 0.9978875279546302}
[S15] START round=26 head_norm_before_train=1.010868 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.166866 metrics={'f1_val': 0.698819005148446, 'auprc': 0.9723851620971449, 'loss_val': 0.496116007827388, 'psi': 0.8082454679279256}-{'f1_val': 0.6504277216741223, 'auprc': 0.9550514920458345, 'loss_val': 0.487500140529862, 'psi': 0.7722772298228072}
[S16] START round=26 head_norm_before_train=1.882521 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.941921474009982, 'auprc': 0.9913152945690982, 'loss_val': 0.14984569401837575, 'psi': 0.9616790022336286}-{'f1_val': 0.9925303069050562, 'auprc': 0.9969027224248758, 'loss_val': 0.047069266656324195, 'psi': 0.994279273112984}
[S17] START round=26 head_norm_before_train=1.553434 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5419338658079875, 'auprc': 0.6592471728096286, 'loss_val': 1.0393205591328663, 'psi': 0.5888591886086441}-{'f1_val': 0.6572728521988801, 'auprc': 0.7601134829215694, 'loss_val': 0.7728558943631945, 'psi': 0.6984091044879559}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.965)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61008
[S7] not sending this round → trigger blocked (psi=0.691)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:61010
[S11] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.995)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=-0.1263
[S9] DROPPED delta from S15 (cos=-0.1263 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=-0.1974
[S7] DROPPED delta from S13 (cos=-0.1974 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.789062 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.8342793312309067, 'auprc': 0.8038500189932014, 'loss_val': 0.3187591871774521, 'psi': 0.8221076063358246}-{'f1_val': 0.8463900936810861, 'auprc': 0.806545350908164, 'loss_val': 0.3047008560096207, 'psi': 0.8304521965719173}
[S3] START round=27 head_norm_before_train=2.170347 (no previous merge yet)
[S3] round=27 local utility u=0.085344 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998862973274601, 'loss_val': 0.017690992759617052, 'psi': 0.9979670079048928}-{'f1_val': 0.9746456354643639, 'auprc': 0.9980743801478438, 'loss_val': 0.049668021164751504, 'psi': 0.9840171333377559}
[S4] START round=27 head_norm_before_train=1.806715 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9415352692176614, 'auprc': 0.9349061040917408, 'loss_val': 0.31669174702420216, 'psi': 0.9388836031672931}-{'f1_val': 0.9570006968963041, 'auprc': 0.9779903707903891, 'loss_val': 0.2994250069454594, 'psi': 0.9653965664539381}
[S5] START round=27 head_norm_before_train=1.565421 cos_to_last_merge=0.7766 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.777
[S5] round=27 local utility u=0.007347 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940144552104083, 'loss_val': 0.06762965607083293, 'psi': 0.995626963171238}-{'f1_val': 0.9970695586110643, 'auprc': 0.991846261088759, 'loss_val': 0.07802495447052823, 'psi': 0.9949802396021422}
[S6] START round=27 head_norm_before_train=1.777033 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6111004962725036, 'auprc': 0.7576188101681975, 'loss_val': 0.9226605904096525, 'psi': 0.6697078218307813}-{'f1_val': 0.6193266799059485, 'auprc': 0.9383806444877784, 'loss_val': 0.4085027396886513, 'psi': 0.7469482657386805}
[S7] START round=27 head_norm_before_train=1.849612 cos_to_last_merge=0.9996 (last merge round=24)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6156717163030629, 'auprc': 0.7995698299194025, 'loss_val': 0.6757387071923825, 'psi': 0.6892309617495989}-{'f1_val': 0.6174983957308511, 'auprc': 0.8015256579590903, 'loss_val': 0.5351485430064509, 'psi': 0.6911093006221467}
[S8] START round=27 head_norm_before_train=0.958971 cos_to_last_merge=0.9976 (last merge round=25)
[S8] round=27 local utility u=0.912974 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9987777227623201, 'loss_val': 0.2674140073409405, 'psi': 0.9972329511450198}-{'f1_val': 0.7140170479737811, 'auprc': 0.9979936790257934, 'loss_val': 0.39789383511930665, 'psi': 0.8276077003945861}
[S9] START round=27 head_norm_before_train=2.081983 (no previous merge yet)
[S9] round=27 local utility u=0.019682 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999097203723549, 'loss_val': 0.021227559377109097, 'psi': 0.9967280779185634}-{'f1_val': 0.9901493298847097, 'auprc': 0.9999168625486592, 'loss_val': 0.03386738508294151, 'psi': 0.9940563429502896}
[S10] START round=27 head_norm_before_train=1.959006 (no previous merge yet)
[S10] round=27 local utility u=0.001538 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937890570420387, 'loss_val': 0.0335544155245038, 'psi': 0.9947094951550537}-{'f1_val': 0.9942256070413027, 'auprc': 0.9956233918140733, 'loss_val': 0.035548035188444814, 'psi': 0.9947847209504109}
[S11] START round=27 head_norm_before_train=1.338937 cos_to_last_merge=0.9994 (last merge round=25)
[S11] round=27 local utility u=0.012618 metrics={'f1_val': 0.9957060066834579, 'auprc': 0.9968037261365201, 'loss_val': 0.11407295372704272, 'psi': 0.9961450944646828}-{'f1_val': 0.9965470045135896, 'auprc': 0.994630600710086, 'loss_val': 0.1378352767140528, 'psi': 0.9957804429921882}
[S13] START round=27 head_norm_before_train=1.329614 cos_to_last_merge=0.9969 (last merge round=25)
[S13] round=27 local utility u=0.065547 metrics={'f1_val': 0.6062571590415697, 'auprc': 0.6889022545664368, 'loss_val': 0.7277230586114146, 'psi': 0.6393151972515165}-{'f1_val': 0.6127497881659323, 'auprc': 0.6504680945909254, 'loss_val': 0.7824710297180196, 'psi': 0.6278371107359295}
[S14] START round=27 head_norm_before_train=1.663886 cos_to_last_merge=0.8377 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.838
[S14] round=27 local utility u=0.122835 metrics={'f1_val': 0.9934624845168429, 'auprc': 0.9988787179798612, 'loss_val': 0.04619198258599102, 'psi': 0.9956289779020502}-{'f1_val': 0.9575312618070002, 'auprc': 0.9983689340498427, 'loss_val': 0.07474616628307487, 'psi': 0.9738663307041372}
[S15] START round=27 head_norm_before_train=1.042533 cos_to_last_merge=0.9975 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6899896631788871, 'auprc': 0.9756222461856009, 'loss_val': 0.47258554125357777, 'psi': 0.8042426963815726}-{'f1_val': 0.698819005148446, 'auprc': 0.9723851620971449, 'loss_val': 0.496116007827388, 'psi': 0.8082454679279256}
[S16] START round=27 head_norm_before_train=1.898595 (no previous merge yet)
[S16] round=27 local utility u=0.049553 metrics={'f1_val': 0.9534407898251291, 'auprc': 0.9903616636545047, 'loss_val': 0.11699408492072179, 'psi': 0.9682091393568794}-{'f1_val': 0.941921474009982, 'auprc': 0.9913152945690982, 'loss_val': 0.14984569401837575, 'psi': 0.9616790022336286}
[S17] START round=27 head_norm_before_train=1.580805 cos_to_last_merge=0.9996 (last merge round=25)
[S17] round=27 local utility u=0.095373 metrics={'f1_val': 0.5579059030742005, 'auprc': 0.6771074011562737, 'loss_val': 0.9979867402824564, 'psi': 0.6055865023070298}-{'f1_val': 0.5419338658079875, 'auprc': 0.6592471728096286, 'loss_val': 1.0393205591328663, 'psi': 0.5888591886086441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S13] not sending this round → trigger blocked (psi=0.639)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:61009
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:61014
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S14
[S8] cosine check vs S14: cos=0.5188
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] cosine check vs S11: cos=0.4342
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.9918
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.9378
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] cosine check vs S8: cos=0.9597
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.6052
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.8068
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=-0.0121
[S14] DROPPED delta from S10 (cos=-0.0121 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.8809
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6157 head_norm=1.873638
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.223001e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6190 head_norm=1.888283 delta_norm=0.122300
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6063 head_norm=1.372047
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.808116e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5770 head_norm=1.444442 delta_norm=0.380812
[S13] aggregate: ROLLBACK (f1_val pre=0.606 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9962 head_norm=1.001144
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.203997e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9962 head_norm=1.003587 delta_norm=0.520400
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9957 head_norm=1.379728
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.189964e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9953 head_norm=1.357331 delta_norm=0.218996
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6900 head_norm=1.075477
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.519597e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6892 head_norm=1.027803 delta_norm=0.151960
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.5579 head_norm=1.606346
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.058936e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5706 head_norm=1.822707 delta_norm=0.405894
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.807192 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.734326930574479, 'auprc': 0.7699790833039897, 'loss_val': 0.5419993540190782, 'psi': 0.7485877916662833}-{'f1_val': 0.8342793312309067, 'auprc': 0.8038500189932014, 'loss_val': 0.3187591871774521, 'psi': 0.8221076063358246}
[S3] START round=28 head_norm_before_train=2.186846 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9974042069095206, 'loss_val': 0.1263676141337819, 'psi': 0.9755828334270744}-{'f1_val': 0.9973696976584205, 'auprc': 0.998862973274601, 'loss_val': 0.017690992759617052, 'psi': 0.9979670079048928}
[S4] START round=28 head_norm_before_train=1.821364 (no previous merge yet)
[S4] round=28 local utility u=0.007189 metrics={'f1_val': 0.9419556264153284, 'auprc': 0.9368853336895244, 'loss_val': 0.310774578028364, 'psi': 0.9399275093250068}-{'f1_val': 0.9415352692176614, 'auprc': 0.9349061040917408, 'loss_val': 0.31669174702420216, 'psi': 0.9388836031672931}
[S5] START round=28 head_norm_before_train=1.583439 cos_to_last_merge=0.7723 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.772
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.8603557509972058, 'auprc': 0.9899299140204748, 'loss_val': 0.16850379875390406, 'psi': 0.9121854162065134}-{'f1_val': 0.9967019684784577, 'auprc': 0.9940144552104083, 'loss_val': 0.06762965607083293, 'psi': 0.995626963171238}
[S6] START round=28 head_norm_before_train=1.786881 (no previous merge yet)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.7932396934845004, 'auprc': 0.9461426909747096, 'loss_val': 0.4553179506658752, 'psi': 0.8544008924805842}-{'f1_val': 0.6111004962725036, 'auprc': 0.7576188101681975, 'loss_val': 0.9226605904096525, 'psi': 0.6697078218307813}
[S7] START round=28 head_norm_before_train=1.888283 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5945345771425411, 'auprc': 0.7950662734955786, 'loss_val': 0.7747812046907471, 'psi': 0.6747472556837562}-{'f1_val': 0.6156717163030629, 'auprc': 0.7995698299194025, 'loss_val': 0.6757387071923825, 'psi': 0.6892309617495989}
[S8] START round=28 head_norm_before_train=1.003587 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951312942941762, 'auprc': 0.9947849995448236, 'loss_val': 0.3898512516492578, 'psi': 0.9949927763944353}-{'f1_val': 0.9962031034001528, 'auprc': 0.9987777227623201, 'loss_val': 0.2674140073409405, 'psi': 0.9972329511450198}
[S9] START round=28 head_norm_before_train=2.096108 (no previous merge yet)
[S9] round=28 local utility u=0.002341 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9959160368170664, 'loss_val': 0.017076972531644717, 'psi': 0.9963819094856838}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999097203723549, 'loss_val': 0.021227559377109097, 'psi': 0.9967280779185634}
[S10] START round=28 head_norm_before_train=1.973704 (no previous merge yet)
[S10] round=28 local utility u=0.000586 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9956732522654211, 'loss_val': 0.032765393378517554, 'psi': 0.9949362772239625}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937890570420387, 'loss_val': 0.0335544155245038, 'psi': 0.9947094951550537}
[S11] START round=28 head_norm_before_train=1.357331 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994773339129063, 'loss_val': 0.11941198783599458, 'psi': 0.995837538359779}-{'f1_val': 0.9957060066834579, 'auprc': 0.9968037261365201, 'loss_val': 0.11407295372704272, 'psi': 0.9961450944646828}
[S13] START round=28 head_norm_before_train=1.444442 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.006786 metrics={'f1_val': 0.6117298280187713, 'auprc': 0.6815899574911883, 'loss_val': 0.7250495016256594, 'psi': 0.6396738798077382}-{'f1_val': 0.6062571590415697, 'auprc': 0.6889022545664368, 'loss_val': 0.7277230586114146, 'psi': 0.6393151972515165}
[S14] START round=28 head_norm_before_train=1.680867 cos_to_last_merge=0.8360 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.836
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9568860464466216, 'auprc': 0.9987610267110594, 'loss_val': 0.07292622700250795, 'psi': 0.9736360385523967}-{'f1_val': 0.9934624845168429, 'auprc': 0.9988787179798612, 'loss_val': 0.04619198258599102, 'psi': 0.9956289779020502}
[S15] START round=28 head_norm_before_train=1.027803 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.042358 metrics={'f1_val': 0.6955777274645996, 'auprc': 0.9837710688924479, 'loss_val': 0.44584526567684246, 'psi': 0.8108550640357389}-{'f1_val': 0.6899896631788871, 'auprc': 0.9756222461856009, 'loss_val': 0.47258554125357777, 'psi': 0.8042426963815726}
[S16] START round=28 head_norm_before_train=1.910660 (no previous merge yet)
[S16] round=28 local utility u=0.165001 metrics={'f1_val': 0.9931627703103687, 'auprc': 0.9957449369473483, 'loss_val': 0.04147315103832121, 'psi': 0.9941956369651606}-{'f1_val': 0.9534407898251291, 'auprc': 0.9903616636545047, 'loss_val': 0.11699408492072179, 'psi': 0.9682091393568794}
[S17] START round=28 head_norm_before_train=1.822707 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.113336 metrics={'f1_val': 0.5807882642762859, 'auprc': 0.7060321480840882, 'loss_val': 0.9953825169665186, 'psi': 0.6308858177994068}-{'f1_val': 0.5579059030742005, 'auprc': 0.6771074011562737, 'loss_val': 0.9979867402824564, 'psi': 0.6055865023070298}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:61008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S9] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61010
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1808 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.2851
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.1499
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=-0.1208
[S9] DROPPED delta from S15 (cos=-0.1208 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1808) from S13
[S7] cosine check vs S13: cos=-0.1880
[S7] DROPPED delta from S13 (cos=-0.1880 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.631)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9951 head_norm=1.038692
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.166977e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9947 head_norm=1.176383 delta_norm=0.916698
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5808 head_norm=1.843845
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.185211e+00
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.6337 head_norm=1.378413 delta_norm=1.185211
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.825985 (no previous merge yet)
[S2] round=29 local utility u=0.494065 metrics={'f1_val': 0.8318486003543689, 'auprc': 0.8503049177863199, 'loss_val': 0.37997635349042397, 'psi': 0.8392311273271493}-{'f1_val': 0.734326930574479, 'auprc': 0.7699790833039897, 'loss_val': 0.5419993540190782, 'psi': 0.7485877916662833}
[S3] START round=29 head_norm_before_train=2.199632 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8917402218947444, 'auprc': 0.9985024860958271, 'loss_val': 0.15480354598258597, 'psi': 0.9344451275751775}-{'f1_val': 0.9610352511054436, 'auprc': 0.9974042069095206, 'loss_val': 0.1263676141337819, 'psi': 0.9755828334270744}
[S4] START round=29 head_norm_before_train=1.835631 (no previous merge yet)
[S4] round=29 local utility u=0.070601 metrics={'f1_val': 0.9519531106857116, 'auprc': 0.9575164472910389, 'loss_val': 0.2914515275997541, 'psi': 0.9541784453278426}-{'f1_val': 0.9419556264153284, 'auprc': 0.9368853336895244, 'loss_val': 0.310774578028364, 'psi': 0.9399275093250068}
[S5] START round=29 head_norm_before_train=1.594365 cos_to_last_merge=0.7698 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=29 local utility u=0.479712 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9990100046690219, 'loss_val': 0.05923793945050698, 'psi': 0.998109175233244}-{'f1_val': 0.8603557509972058, 'auprc': 0.9899299140204748, 'loss_val': 0.16850379875390406, 'psi': 0.9121854162065134}
[S6] START round=29 head_norm_before_train=1.791572 (no previous merge yet)
[S6] round=29 local utility u=0.270649 metrics={'f1_val': 0.8448245195115626, 'auprc': 0.9678686532020179, 'loss_val': 0.28870774006501054, 'psi': 0.8940421729877448}-{'f1_val': 0.7932396934845004, 'auprc': 0.9461426909747096, 'loss_val': 0.4553179506658752, 'psi': 0.8544008924805842}
[S7] START round=29 head_norm_before_train=1.904528 cos_to_last_merge=0.9999 (last merge round=27)
[S7] round=29 local utility u=0.532580 metrics={'f1_val': 0.6815289111510657, 'auprc': 0.8413928148481089, 'loss_val': 0.370566915010372, 'psi': 0.745474472629883}-{'f1_val': 0.5945345771425411, 'auprc': 0.7950662734955786, 'loss_val': 0.7747812046907471, 'psi': 0.6747472556837562}
[S8] START round=29 head_norm_before_train=1.176383 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.081659 metrics={'f1_val': 0.9953158400597293, 'auprc': 0.9965058539881035, 'loss_val': 0.23280371704357655, 'psi': 0.995791845631079}-{'f1_val': 0.9951312942941762, 'auprc': 0.9947849995448236, 'loss_val': 0.3898512516492578, 'psi': 0.9949927763944353}
[S9] START round=29 head_norm_before_train=2.107767 (no previous merge yet)
[S9] round=29 local utility u=0.003962 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976001147364721, 'loss_val': 0.016668627909463284, 'psi': 0.9973017934018745}-{'f1_val': 0.9966924912647621, 'auprc': 0.9959160368170664, 'loss_val': 0.017076972531644717, 'psi': 0.9963819094856838}
[S10] START round=29 head_norm_before_train=1.983877 (no previous merge yet)
[S10] round=29 local utility u=0.001192 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9942790702038232, 'loss_val': 0.03146869887061461, 'psi': 0.9949055004197676}-{'f1_val': 0.9944449605296568, 'auprc': 0.9956732522654211, 'loss_val': 0.032765393378517554, 'psi': 0.9949362772239625}
[S11] START round=29 head_norm_before_train=1.397755 cos_to_last_merge=0.9995 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9867723240748169, 'auprc': 0.9972983464217484, 'loss_val': 0.11424716867498724, 'psi': 0.9909827330135894}-{'f1_val': 0.9965470045135896, 'auprc': 0.994773339129063, 'loss_val': 0.11941198783599458, 'psi': 0.995837538359779}
[S13] START round=29 head_norm_before_train=1.475186 cos_to_last_merge=0.9983 (last merge round=27)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5927051692058327, 'auprc': 0.6849777788822008, 'loss_val': 0.7302458861657283, 'psi': 0.62961421307638}-{'f1_val': 0.6117298280187713, 'auprc': 0.6815899574911883, 'loss_val': 0.7250495016256594, 'psi': 0.6396738798077382}
[S14] START round=29 head_norm_before_train=1.697962 cos_to_last_merge=0.8344 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=29 local utility u=0.013113 metrics={'f1_val': 0.9596662228743902, 'auprc': 0.9989148291797832, 'loss_val': 0.06384306252361573, 'psi': 0.9753656653965475}-{'f1_val': 0.9568860464466216, 'auprc': 0.9987610267110594, 'loss_val': 0.07292622700250795, 'psi': 0.9736360385523967}
[S15] START round=29 head_norm_before_train=1.058047 cos_to_last_merge=0.9986 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.691975503264382, 'auprc': 0.9547335226545335, 'loss_val': 0.47173379709584523, 'psi': 0.7970787110204426}-{'f1_val': 0.6955777274645996, 'auprc': 0.9837710688924479, 'loss_val': 0.44584526567684246, 'psi': 0.8108550640357389}
[S16] START round=29 head_norm_before_train=1.923336 (no previous merge yet)
[S16] round=29 local utility u=0.000724 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9966589431192523, 'loss_val': 0.04028676895753519, 'psi': 0.9943131320827115}-{'f1_val': 0.9931627703103687, 'auprc': 0.9957449369473483, 'loss_val': 0.04147315103832121, 'psi': 0.9941956369651606}
[S17] START round=29 head_norm_before_train=1.378413 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.47146441705615627, 'auprc': 0.6660023449571347, 'loss_val': 1.012274073379969, 'psi': 0.5492795882165477}-{'f1_val': 0.5807882642762859, 'auprc': 0.7060321480840882, 'loss_val': 0.9953825169665186, 'psi': 0.6308858177994068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S4] not sending this round → trigger blocked (psi=0.954)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[S6] not sending this round → trigger blocked (psi=0.894)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.2017
[S17] DROPPED delta from S7 (cos=-0.2017 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.6688
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.7037
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.7908
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0117
[S14] DROPPED delta from S10 (cos=-0.0117 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9958
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.2045
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=0.3332
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9868 head_norm=1.436201
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.894426e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9800 head_norm=1.401901 delta_norm=0.589443
[S11] aggregate: ROLLBACK (f1_val pre=0.987 post=0.980 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6815 head_norm=1.914145
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.909310e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6799 head_norm=1.922577 delta_norm=0.089093
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9953 head_norm=1.224700
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.894964e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9938 head_norm=1.027348 delta_norm=0.689496
[S8] aggregate: ACCEPT kept=['S2', 'S14'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.4715 head_norm=1.400081
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.872986e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5185 head_norm=1.613311 delta_norm=0.787299
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.6920 head_norm=1.091892
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.798092e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.6920 head_norm=1.096268 delta_norm=0.379809
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.843631 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8337180665916071, 'auprc': 0.7861066198062875, 'loss_val': 0.35050289884661506, 'psi': 0.8146734878774793}-{'f1_val': 0.8318486003543689, 'auprc': 0.8503049177863199, 'loss_val': 0.37997635349042397, 'psi': 0.8392311273271493}
[S3] START round=30 head_norm_before_train=2.212126 (no previous merge yet)
[S3] round=30 local utility u=0.138105 metrics={'f1_val': 0.9409225677532407, 'auprc': 0.9976023183290396, 'loss_val': 0.1709878066164307, 'psi': 0.9635944679835602}-{'f1_val': 0.8917402218947444, 'auprc': 0.9985024860958271, 'loss_val': 0.15480354598258597, 'psi': 0.9344451275751775}
[S4] START round=30 head_norm_before_train=1.849253 (no previous merge yet)
[S4] round=30 local utility u=0.005721 metrics={'f1_val': 0.9522211827246322, 'auprc': 0.9617939966589464, 'loss_val': 0.29445072955429924, 'psi': 0.9560503082983579}-{'f1_val': 0.9519531106857116, 'auprc': 0.9575164472910389, 'loss_val': 0.2914515275997541, 'psi': 0.9541784453278426}
[S5] START round=30 head_norm_before_train=1.600894 cos_to_last_merge=0.7682 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.927542992874582, 'auprc': 0.9992516495801427, 'loss_val': 0.1549943157305704, 'psi': 0.9562264555568063}-{'f1_val': 0.9975086222760589, 'auprc': 0.9990100046690219, 'loss_val': 0.05923793945050698, 'psi': 0.998109175233244}
[S6] START round=30 head_norm_before_train=1.797923 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6999418498146821, 'auprc': 0.9356791376724611, 'loss_val': 0.6886920486697589, 'psi': 0.7942367649577937}-{'f1_val': 0.8448245195115626, 'auprc': 0.9678686532020179, 'loss_val': 0.28870774006501054, 'psi': 0.8940421729877448}
[S7] START round=30 head_norm_before_train=1.922577 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6421869853201573, 'auprc': 0.8043701474549343, 'loss_val': 0.5508109028743282, 'psi': 0.7070602501740682}-{'f1_val': 0.6815289111510657, 'auprc': 0.8413928148481089, 'loss_val': 0.370566915010372, 'psi': 0.745474472629883}
[S8] START round=30 head_norm_before_train=1.027348 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.008907 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9967608623861721, 'loss_val': 0.22107823212886765, 'psi': 0.9964262069945606}-{'f1_val': 0.9953158400597293, 'auprc': 0.9965058539881035, 'loss_val': 0.23280371704357655, 'psi': 0.995791845631079}
[S9] START round=30 head_norm_before_train=2.117781 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9999518474842662, 'loss_val': 0.017432389601847204, 'psi': 0.9975954771972506}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976001147364721, 'loss_val': 0.016668627909463284, 'psi': 0.9973017934018745}
[S10] START round=30 head_norm_before_train=1.995727 (no previous merge yet)
[S10] round=30 local utility u=0.000763 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.99583865092571, 'loss_val': 0.030668885999971498, 'psi': 0.9951340933759338}-{'f1_val': 0.9953231205637304, 'auprc': 0.9942790702038232, 'loss_val': 0.03146869887061461, 'psi': 0.9949055004197676}
[S11] START round=30 head_norm_before_train=1.401901 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.021331 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994451783873395, 'loss_val': 0.12169426859909281, 'psi': 0.9957089162575117}-{'f1_val': 0.9867723240748169, 'auprc': 0.9972983464217484, 'loss_val': 0.11424716867498724, 'psi': 0.9909827330135894}
[S13] START round=30 head_norm_before_train=1.503863 cos_to_last_merge=0.9949 (last merge round=27)
[S13] round=30 local utility u=0.080335 metrics={'f1_val': 0.6267403213189658, 'auprc': 0.6567215277010211, 'loss_val': 0.689017670409972, 'psi': 0.638732803871788}-{'f1_val': 0.5927051692058327, 'auprc': 0.6849777788822008, 'loss_val': 0.7302458861657283, 'psi': 0.62961421307638}
[S14] START round=30 head_norm_before_train=1.710896 cos_to_last_merge=0.8333 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.833
[S14] round=30 local utility u=0.077027 metrics={'f1_val': 0.9825848475181304, 'auprc': 0.9988669342458719, 'loss_val': 0.047157153230519666, 'psi': 0.989097682209227}-{'f1_val': 0.9596662228743902, 'auprc': 0.9989148291797832, 'loss_val': 0.06384306252361573, 'psi': 0.9753656653965475}
[S15] START round=30 head_norm_before_train=1.096268 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.787986 metrics={'f1_val': 0.9346491312565992, 'auprc': 0.9711972015265662, 'loss_val': 0.40119401542486055, 'psi': 0.949268359364586}-{'f1_val': 0.691975503264382, 'auprc': 0.9547335226545335, 'loss_val': 0.47173379709584523, 'psi': 0.7970787110204426}
[S16] START round=30 head_norm_before_train=1.935079 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9861738499175808, 'auprc': 0.9968037046912582, 'loss_val': 0.06489604486003268, 'psi': 0.9904257918270518}-{'f1_val': 0.992749258058351, 'auprc': 0.9966589431192523, 'loss_val': 0.04028676895753519, 'psi': 0.9943131320827115}
[S17] START round=30 head_norm_before_train=1.613311 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.717019 metrics={'f1_val': 0.5969280345439152, 'auprc': 0.8319893010515018, 'loss_val': 0.8289779178438677, 'psi': 0.6909525411469498}-{'f1_val': 0.47146441705615627, 'auprc': 0.6660023449571347, 'loss_val': 1.012274073379969, 'psi': 0.5492795882165477}
[S14] not sending this round → trigger blocked (psi=0.989)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:61010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S10] not sending this round → trigger blocked (psi=0.995)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1789) from S15
[S9] cosine check vs S15: cos=-0.1028
[S9] DROPPED delta from S15 (cos=-0.1028 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.4037
[S8] RECEIVED delta(kind=head bytes=1805) from S4
[S8] cosine check vs S4: cos=0.5710
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] cosine check vs S11: cos=0.3027
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=-0.1907
[S7] DROPPED delta from S13 (cos=-0.1907 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.9418
[S6] ⇄ pheromone p=0.261 → S17@127.0.0.1:61017
[S9] ⇄ pheromone p=0.011 → S17@127.0.0.1:61017
[S2] ⇄ pheromone p=0.203 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=0.163 → S11@127.0.0.1:61012
[S14] ⇄ pheromone p=0.049 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.158 → S17@127.0.0.1:61017
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9962 head_norm=1.079916
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.887273e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9962 head_norm=1.023556 delta_norm=0.488727
[S8] aggregate: ACCEPT kept=['S4', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.207 → S15@127.0.0.1:61015
[S10] ⇄ pheromone p=0.011 → S14@127.0.0.1:61014
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9965 head_norm=1.434655
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.052541e+00
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9965 head_norm=1.548018 delta_norm=1.052541
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.030 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.081 → S11@127.0.0.1:61012
[S15] ⇄ pheromone p=0.218 → S9@127.0.0.1:61010
[S4] ⇄ pheromone p=0.058 → S8@127.0.0.1:61009
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6267 head_norm=1.532298
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.762112e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6046 head_norm=1.564194 delta_norm=0.276211
[S13] aggregate: ROLLBACK (f1_val pre=0.627 post=0.605 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.055 → S7@127.0.0.1:61008
[S16] ⇄ pheromone p=0.117 → S7@127.0.0.1:61008
[S17] ⇄ pheromone p=0.257 → S13@127.0.0.1:61013
[S2] START round=31 head_norm_before_train=1.858791 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8460664335030944, 'auprc': 0.7830434006772856, 'loss_val': 0.43631884942250565, 'psi': 0.8208572203727709}-{'f1_val': 0.8337180665916071, 'auprc': 0.7861066198062875, 'loss_val': 0.35050289884661506, 'psi': 0.8146734878774793}
[S3] START round=31 head_norm_before_train=2.224898 (no previous merge yet)
[S3] round=31 local utility u=0.247468 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9988521167690134, 'loss_val': 0.018654441280967233, 'psi': 0.9979797881752398}-{'f1_val': 0.9409225677532407, 'auprc': 0.9976023183290396, 'loss_val': 0.1709878066164307, 'psi': 0.9635944679835602}
[S4] START round=31 head_norm_before_train=1.862798 (no previous merge yet)
[S4] round=31 local utility u=0.013872 metrics={'f1_val': 0.9546814739683411, 'auprc': 0.9633865375002958, 'loss_val': 0.28624558735272326, 'psi': 0.958163499381123}-{'f1_val': 0.9522211827246322, 'auprc': 0.9617939966589464, 'loss_val': 0.29445072955429924, 'psi': 0.9560503082983579}
[S5] START round=31 head_norm_before_train=1.601942 cos_to_last_merge=0.7686 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=31 local utility u=0.245861 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9951384509817476, 'loss_val': 0.06588624725877983, 'psi': 0.9960765614797736}-{'f1_val': 0.927542992874582, 'auprc': 0.9992516495801427, 'loss_val': 0.1549943157305704, 'psi': 0.9562264555568063}
[S6] START round=31 head_norm_before_train=1.804591 (no previous merge yet)
[S6] round=31 local utility u=0.982142 metrics={'f1_val': 0.9287715038735135, 'auprc': 0.9718651663531825, 'loss_val': 0.2059439335175336, 'psi': 0.946008968865381}-{'f1_val': 0.6999418498146821, 'auprc': 0.9356791376724611, 'loss_val': 0.6886920486697589, 'psi': 0.7942367649577937}
[S7] START round=31 head_norm_before_train=1.932032 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=31 local utility u=0.962958 metrics={'f1_val': 0.8425255005878134, 'auprc': 0.9533193022216587, 'loss_val': 0.2737742064502634, 'psi': 0.8868430212413515}-{'f1_val': 0.6421869853201573, 'auprc': 0.8043701474549343, 'loss_val': 0.5508109028743282, 'psi': 0.7070602501740682}
[S8] START round=31 head_norm_before_train=1.023556 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9954643576581512, 'auprc': 0.9956563812751128, 'loss_val': 0.23601068887750695, 'psi': 0.9955411671049359}-{'f1_val': 0.9962031034001528, 'auprc': 0.9967608623861721, 'loss_val': 0.22107823212886765, 'psi': 0.9964262069945606}
[S9] START round=31 head_norm_before_train=2.124618 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9999506549891816, 'loss_val': 0.019455875257364374, 'psi': 0.9973435287925727}-{'f1_val': 0.9960245636725735, 'auprc': 0.9999518474842662, 'loss_val': 0.017432389601847204, 'psi': 0.9975954771972506}
[S10] START round=31 head_norm_before_train=2.007866 (no previous merge yet)
[S10] round=31 local utility u=0.001384 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957074873506717, 'loss_val': 0.030141618896359513, 'psi': 0.9953450757859277}-{'f1_val': 0.9946643883427498, 'auprc': 0.99583865092571, 'loss_val': 0.030668885999971498, 'psi': 0.9951340933759338}
[S11] START round=31 head_norm_before_train=1.548018 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9908044219928431, 'auprc': 0.9962146928056458, 'loss_val': 0.12212828339116272, 'psi': 0.9929685303179642}-{'f1_val': 0.9965470045135896, 'auprc': 0.994451783873395, 'loss_val': 0.12169426859909281, 'psi': 0.9957089162575117}
[S13] START round=31 head_norm_before_train=1.564194 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5898126674077009, 'auprc': 0.6831675932655559, 'loss_val': 0.8535734524679477, 'psi': 0.6271546377508429}-{'f1_val': 0.6267403213189658, 'auprc': 0.6567215277010211, 'loss_val': 0.689017670409972, 'psi': 0.638732803871788}
[S14] START round=31 head_norm_before_train=1.724971 cos_to_last_merge=0.8321 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=31 local utility u=0.004961 metrics={'f1_val': 0.9838817521735587, 'auprc': 0.9987546808656622, 'loss_val': 0.04468081460384558, 'psi': 0.9898309236504}-{'f1_val': 0.9825848475181304, 'auprc': 0.9988669342458719, 'loss_val': 0.047157153230519666, 'psi': 0.989097682209227}
[S15] START round=31 head_norm_before_train=1.128592 cos_to_last_merge=0.9989 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6981184568635184, 'auprc': 0.9249828365588219, 'loss_val': 0.4642760044857643, 'psi': 0.7888642087416398}-{'f1_val': 0.9346491312565992, 'auprc': 0.9711972015265662, 'loss_val': 0.40119401542486055, 'psi': 0.949268359364586}
[S16] START round=31 head_norm_before_train=1.947654 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9423305142011675, 'auprc': 0.9966677871947283, 'loss_val': 0.14245270925093081, 'psi': 0.9640654233985918}-{'f1_val': 0.9861738499175808, 'auprc': 0.9968037046912582, 'loss_val': 0.06489604486003268, 'psi': 0.9904257918270518}
[S17] START round=31 head_norm_before_train=1.642575 cos_to_last_merge=0.9997 (last merge round=29)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5712751306265065, 'auprc': 0.6829646832027408, 'loss_val': 1.092804971110207, 'psi': 0.6159509516570002}-{'f1_val': 0.5969280345439152, 'auprc': 0.8319893010515018, 'loss_val': 0.8289779178438677, 'psi': 0.6909525411469498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.958)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.4535
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0112
[S14] DROPPED delta from S10 (cos=-0.0112 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.3158
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.4280
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.1653
[S17] DROPPED delta from S7 (cos=-0.1653 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9908 head_norm=1.581909
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.323835e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9528 head_norm=1.357342 delta_norm=0.832384
[S11] aggregate: ROLLBACK (f1_val pre=0.991 post=0.953 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9955 head_norm=1.078955
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.039585e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9957 head_norm=1.204159 delta_norm=0.803958
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5713 head_norm=1.672918
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.021652e+00
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5459 head_norm=1.415100 delta_norm=1.021652
[S17] aggregate: ROLLBACK (f1_val pre=0.571 post=0.546 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.874242 (no previous merge yet)
[S2] round=32 local utility u=0.012099 metrics={'f1_val': 0.8332512738823292, 'auprc': 0.7930509852927139, 'loss_val': 0.3652525807367827, 'psi': 0.8171711584464831}-{'f1_val': 0.8460664335030944, 'auprc': 0.7830434006772856, 'loss_val': 0.43631884942250565, 'psi': 0.8208572203727709}
[S3] START round=32 head_norm_before_train=2.238667 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9975295983523376, 'loss_val': 0.09185048051897937, 'psi': 0.9759111275048866}-{'f1_val': 0.9973982357793907, 'auprc': 0.9988521167690134, 'loss_val': 0.018654441280967233, 'psi': 0.9979797881752398}
[S4] START round=32 head_norm_before_train=1.875003 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9546145086489146, 'auprc': 0.9617950140147677, 'loss_val': 0.286899640567288, 'psi': 0.9574867107952558}-{'f1_val': 0.9546814739683411, 'auprc': 0.9633865375002958, 'loss_val': 0.28624558735272326, 'psi': 0.958163499381123}
[S5] START round=32 head_norm_before_train=1.602512 cos_to_last_merge=0.7682 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=32 local utility u=0.015815 metrics={'f1_val': 0.9978756509554264, 'auprc': 0.9994526671948561, 'loss_val': 0.05424002452139005, 'psi': 0.9985064574511983}-{'f1_val': 0.9967019684784577, 'auprc': 0.9951384509817476, 'loss_val': 0.06588624725877983, 'psi': 0.9960765614797736}
[S6] START round=32 head_norm_before_train=1.814913 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6103748078002837, 'auprc': 0.7605920285491818, 'loss_val': 0.9925956751202427, 'psi': 0.670461696099843}-{'f1_val': 0.9287715038735135, 'auprc': 0.9718651663531825, 'loss_val': 0.2059439335175336, 'psi': 0.946008968865381}
[S7] START round=32 head_norm_before_train=1.942284 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.7578198293167473, 'auprc': 0.8184579120839279, 'loss_val': 0.45775230781260395, 'psi': 0.7820750624236196}-{'f1_val': 0.8425255005878134, 'auprc': 0.9533193022216587, 'loss_val': 0.2737742064502634, 'psi': 0.8868430212413515}
[S8] START round=32 head_norm_before_train=1.204159 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9985426675919298, 'loss_val': 0.28096187174523, 'psi': 0.9970494104202192}-{'f1_val': 0.9954643576581512, 'auprc': 0.9956563812751128, 'loss_val': 0.23601068887750695, 'psi': 0.9955411671049359}
[S9] START round=32 head_norm_before_train=2.135212 (no previous merge yet)
[S9] round=32 local utility u=0.002188 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974166307554443, 'loss_val': 0.016462601142073, 'psi': 0.9972283998094634}-{'f1_val': 0.9956054446615002, 'auprc': 0.9999506549891816, 'loss_val': 0.019455875257364374, 'psi': 0.9973435287925727}
[S10] START round=32 head_norm_before_train=2.020060 (no previous merge yet)
[S10] round=32 local utility u=0.000122 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9956693728194626, 'loss_val': 0.029783790866037604, 'psi': 0.995329829973444}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957074873506717, 'loss_val': 0.030141618896359513, 'psi': 0.9953450757859277}
[S11] START round=32 head_norm_before_train=1.357342 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.026643 metrics={'f1_val': 0.996305167468861, 'auprc': 0.996109343479238, 'loss_val': 0.1015305762692705, 'psi': 0.9962268378730117}-{'f1_val': 0.9908044219928431, 'auprc': 0.9962146928056458, 'loss_val': 0.12212828339116272, 'psi': 0.9929685303179642}
[S13] START round=32 head_norm_before_train=1.584624 cos_to_last_merge=0.9995 (last merge round=30)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5937560764143759, 'auprc': 0.6193938055033033, 'loss_val': 0.7607878339280212, 'psi': 0.6040111680499468}-{'f1_val': 0.5898126674077009, 'auprc': 0.6831675932655559, 'loss_val': 0.8535734524679477, 'psi': 0.6271546377508429}
[S14] START round=32 head_norm_before_train=1.740274 cos_to_last_merge=0.8308 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9788862438402732, 'auprc': 0.9987450513001301, 'loss_val': 0.04726689201748756, 'psi': 0.9868297668242161}-{'f1_val': 0.9838817521735587, 'auprc': 0.9987546808656622, 'loss_val': 0.04468081460384558, 'psi': 0.9898309236504}
[S15] START round=32 head_norm_before_train=1.157618 cos_to_last_merge=0.9965 (last merge round=29)
[S15] round=32 local utility u=0.103824 metrics={'f1_val': 0.6919068801764066, 'auprc': 0.9852653702007692, 'loss_val': 0.4002058394314198, 'psi': 0.8092502761861516}-{'f1_val': 0.6981184568635184, 'auprc': 0.9249828365588219, 'loss_val': 0.4642760044857643, 'psi': 0.7888642087416398}
[S16] START round=32 head_norm_before_train=1.960372 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.935036455865302, 'auprc': 0.9951516850555687, 'loss_val': 0.279150503063632, 'psi': 0.9590825475414086}-{'f1_val': 0.9423305142011675, 'auprc': 0.9966677871947283, 'loss_val': 0.14245270925093081, 'psi': 0.9640654233985918}
[S17] START round=32 head_norm_before_train=1.415100 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.304990 metrics={'f1_val': 0.583116921985246, 'auprc': 0.7769266403970394, 'loss_val': 0.8357618518947526, 'psi': 0.6606408093499634}-{'f1_val': 0.5712751306265065, 'auprc': 0.6829646832027408, 'loss_val': 1.092804971110207, 'psi': 0.6159509516570002}
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.999)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.1040
[S9] DROPPED delta from S15 (cos=-0.1040 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] cosine check vs S9: cos=0.5768
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] cosine check vs S11: cos=0.4520
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.1671
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.8350
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5938 head_norm=1.611243
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.461349e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5919 head_norm=1.463958 delta_norm=0.446135
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9961 head_norm=1.245654
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.512087e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9961 head_norm=1.005802 delta_norm=0.651209
[S8] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.5831 head_norm=1.445101
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.821933e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.5901 head_norm=1.601847 delta_norm=0.882193
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.889319 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8332512738823292, 'auprc': 0.7691921336621486, 'loss_val': 0.37475793620565756, 'psi': 0.807627617794257}-{'f1_val': 0.8332512738823292, 'auprc': 0.7930509852927139, 'loss_val': 0.3652525807367827, 'psi': 0.8171711584464831}
[S3] START round=33 head_norm_before_train=2.252818 (no previous merge yet)
[S3] round=33 local utility u=0.145857 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9990188160895601, 'loss_val': 0.01998500724224502, 'psi': 0.9980449444816376}-{'f1_val': 0.961498813606586, 'auprc': 0.9975295983523376, 'loss_val': 0.09185048051897937, 'psi': 0.9759111275048866}
[S4] START round=33 head_norm_before_train=1.881233 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9544051999538506, 'auprc': 0.9600480006417269, 'loss_val': 0.2884527762854281, 'psi': 0.9566623202290011}-{'f1_val': 0.9546145086489146, 'auprc': 0.9617950140147677, 'loss_val': 0.286899640567288, 'psi': 0.9574867107952558}
[S5] START round=33 head_norm_before_train=1.609628 cos_to_last_merge=0.7669 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976930028131183, 'loss_val': 0.05634238101463943, 'psi': 0.9970983822123219}-{'f1_val': 0.9978756509554264, 'auprc': 0.9994526671948561, 'loss_val': 0.05424002452139005, 'psi': 0.9985064574511983}
[S6] START round=33 head_norm_before_train=1.823727 (no previous merge yet)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9772958473499491, 'auprc': 0.9731677284221049, 'loss_val': 0.13223303468767864, 'psi': 0.9756445997788115}-{'f1_val': 0.6103748078002837, 'auprc': 0.7605920285491818, 'loss_val': 0.9925956751202427, 'psi': 0.670461696099843}
[S7] START round=33 head_norm_before_train=1.953421 cos_to_last_merge=0.9997 (last merge round=29)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6683037783233763, 'auprc': 0.8161795846849323, 'loss_val': 0.5042210733379918, 'psi': 0.7274541008679987}-{'f1_val': 0.7578198293167473, 'auprc': 0.8184579120839279, 'loss_val': 0.45775230781260395, 'psi': 0.7820750624236196}
[S8] START round=33 head_norm_before_train=1.005802 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.018712 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9952121161063558, 'loss_val': 0.2344404996500321, 'psi': 0.9958067084826341}-{'f1_val': 0.9960539056390789, 'auprc': 0.9985426675919298, 'loss_val': 0.28096187174523, 'psi': 0.9970494104202192}
[S9] START round=33 head_norm_before_train=2.144771 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9997282154820932, 'loss_val': 0.04032078391457406, 'psi': 0.9933686220388175}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974166307554443, 'loss_val': 0.016462601142073, 'psi': 0.9972283998094634}
[S10] START round=33 head_norm_before_train=2.031993 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956708297417168, 'loss_val': 0.029624790597878665, 'psi': 0.9949857959757233}-{'f1_val': 0.9951034680760983, 'auprc': 0.9956693728194626, 'loss_val': 0.029783790866037604, 'psi': 0.995329829973444}
[S11] START round=33 head_norm_before_train=1.388595 cos_to_last_merge=0.9996 (last merge round=31)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9929462385309543, 'auprc': 0.9976557804982241, 'loss_val': 0.09470119013789056, 'psi': 0.9948300553178623}-{'f1_val': 0.996305167468861, 'auprc': 0.996109343479238, 'loss_val': 0.1015305762692705, 'psi': 0.9962268378730117}
[S13] START round=33 head_norm_before_train=1.463958 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5917246305239464, 'auprc': 0.6088975726543825, 'loss_val': 0.8053472264677011, 'psi': 0.5985938073761209}-{'f1_val': 0.5937560764143759, 'auprc': 0.6193938055033033, 'loss_val': 0.7607878339280212, 'psi': 0.6040111680499468}
[S14] START round=33 head_norm_before_train=1.755037 cos_to_last_merge=0.8295 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9441207477485891, 'auprc': 0.9987339954566483, 'loss_val': 0.10910360976619984, 'psi': 0.9659660468318128}-{'f1_val': 0.9788862438402732, 'auprc': 0.9987450513001301, 'loss_val': 0.04726689201748756, 'psi': 0.9868297668242161}
[S15] START round=33 head_norm_before_train=1.188308 cos_to_last_merge=0.9931 (last merge round=29)
[S15] round=33 local utility u=0.187750 metrics={'f1_val': 0.7416809182702281, 'auprc': 0.9866488781780771, 'loss_val': 0.32749964821945726, 'psi': 0.8396681022333676}-{'f1_val': 0.6919068801764066, 'auprc': 0.9852653702007692, 'loss_val': 0.4002058394314198, 'psi': 0.8092502761861516}
[S16] START round=33 head_norm_before_train=1.973105 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8878017113528044, 'auprc': 0.9880213519911459, 'loss_val': 0.5121085133508162, 'psi': 0.927889567608141}-{'f1_val': 0.935036455865302, 'auprc': 0.9951516850555687, 'loss_val': 0.279150503063632, 'psi': 0.9590825475414086}
[S17] START round=33 head_norm_before_train=1.601847 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.8119319113634366, 'auprc': 0.9211259790422333, 'loss_val': 0.5427438598775363, 'psi': 0.8556095384349552}-{'f1_val': 0.583116921985246, 'auprc': 0.7769266403970394, 'loss_val': 0.8357618518947526, 'psi': 0.6606408093499634}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:61015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.840)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S8] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.3603
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=0.7901
[S11] RECEIVED delta(kind=head bytes=1794) from S3
[S11] cosine check vs S3: cos=0.5584
[S17] not sending this round → trigger blocked (psi=0.856)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.7417 head_norm=1.228572
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.794891e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.7590 head_norm=1.085421 delta_norm=0.379489
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9929 head_norm=1.418812
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.409674e-01
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9946 head_norm=1.636022 delta_norm=0.940967
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.8119 head_norm=1.644139
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.855493e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.8576 head_norm=1.433813 delta_norm=0.985549
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.904598 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8324819018624932, 'auprc': 0.7719600945221003, 'loss_val': 0.3849696115408498, 'psi': 0.808273178926336}-{'f1_val': 0.8332512738823292, 'auprc': 0.7691921336621486, 'loss_val': 0.37475793620565756, 'psi': 0.807627617794257}
[S3] START round=34 head_norm_before_train=2.260740 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9791685743735303, 'auprc': 0.9986025158142391, 'loss_val': 0.07443512682050883, 'psi': 0.9869421509498139}-{'f1_val': 0.9973956967430226, 'auprc': 0.9990188160895601, 'loss_val': 0.01998500724224502, 'psi': 0.9980449444816376}
[S4] START round=34 head_norm_before_train=1.889546 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9523007588873954, 'auprc': 0.9587184660734437, 'loss_val': 0.29439429474838746, 'psi': 0.9548678417618147}-{'f1_val': 0.9544051999538506, 'auprc': 0.9600480006417269, 'loss_val': 0.2884527762854281, 'psi': 0.9566623202290011}
[S5] START round=34 head_norm_before_train=1.619796 cos_to_last_merge=0.7651 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=34 local utility u=0.008402 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9994547276591372, 'loss_val': 0.04923049920056532, 'psi': 0.9982438417752502}-{'f1_val': 0.9967019684784577, 'auprc': 0.9976930028131183, 'loss_val': 0.05634238101463943, 'psi': 0.9970983822123219}
[S6] START round=34 head_norm_before_train=1.830590 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5971981298322756, 'auprc': 0.7543806160272516, 'loss_val': 1.087071101966908, 'psi': 0.6600711243102659}-{'f1_val': 0.9772958473499491, 'auprc': 0.9731677284221049, 'loss_val': 0.13223303468767864, 'psi': 0.9756445997788115}
[S7] START round=34 head_norm_before_train=1.963120 cos_to_last_merge=0.9995 (last merge round=29)
[S7] round=34 local utility u=0.600937 metrics={'f1_val': 0.7273373406043855, 'auprc': 0.9891204885230646, 'loss_val': 0.17537023084392978, 'psi': 0.8320505997718571}-{'f1_val': 0.6683037783233763, 'auprc': 0.8161795846849323, 'loss_val': 0.5042210733379918, 'psi': 0.7274541008679987}
[S8] START round=34 head_norm_before_train=1.065323 cos_to_last_merge=0.9962 (last merge round=32)
[S8] round=34 local utility u=0.033731 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9981003832994607, 'loss_val': 0.17564329369411694, 'psi': 0.9969620153598759}-{'f1_val': 0.9962031034001528, 'auprc': 0.9952121161063558, 'loss_val': 0.2344404996500321, 'psi': 0.9958067084826341}
[S9] START round=34 head_norm_before_train=2.152074 (no previous merge yet)
[S9] round=34 local utility u=0.032582 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9999508200467271, 'loss_val': 0.016212536921547695, 'psi': 0.9974964105444841}-{'f1_val': 0.9891288930766337, 'auprc': 0.9997282154820932, 'loss_val': 0.04032078391457406, 'psi': 0.9933686220388175}
[S10] START round=34 head_norm_before_train=2.038172 (no previous merge yet)
[S10] round=34 local utility u=0.001563 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956550729142867, 'loss_val': 0.029086974496228112, 'psi': 0.9952429410847603}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956708297417168, 'loss_val': 0.029624790597878665, 'psi': 0.9949857959757233}
[S11] START round=34 head_norm_before_train=1.636022 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.8623477644783019, 'auprc': 0.9958423402254306, 'loss_val': 0.18073034953966052, 'psi': 0.9157455947771533}-{'f1_val': 0.9929462385309543, 'auprc': 0.9976557804982241, 'loss_val': 0.09470119013789056, 'psi': 0.9948300553178623}
[S13] START round=34 head_norm_before_train=1.489334 cos_to_last_merge=0.9993 (last merge round=32)
[S13] round=34 local utility u=0.104594 metrics={'f1_val': 0.6017798402274293, 'auprc': 0.6555060110506847, 'loss_val': 0.7963158869159831, 'psi': 0.6232703085567315}-{'f1_val': 0.5917246305239464, 'auprc': 0.6088975726543825, 'loss_val': 0.8053472264677011, 'psi': 0.5985938073761209}
[S14] START round=34 head_norm_before_train=1.768436 cos_to_last_merge=0.8284 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=34 local utility u=0.201720 metrics={'f1_val': 0.997842298753406, 'auprc': 0.9988090025721099, 'loss_val': 0.02821783187411535, 'psi': 0.9982289802808876}-{'f1_val': 0.9441207477485891, 'auprc': 0.9987339954566483, 'loss_val': 0.10910360976619984, 'psi': 0.9659660468318128}
[S15] START round=34 head_norm_before_train=1.085421 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6990808623839736, 'auprc': 0.9809245311341885, 'loss_val': 0.41618936120253924, 'psi': 0.8118183298840596}-{'f1_val': 0.7416809182702281, 'auprc': 0.9866488781780771, 'loss_val': 0.32749964821945726, 'psi': 0.8396681022333676}
[S16] START round=34 head_norm_before_train=1.982110 (no previous merge yet)
[S16] round=34 local utility u=0.561335 metrics={'f1_val': 0.9924083188175701, 'auprc': 0.9949486209133285, 'loss_val': 0.037860498399510494, 'psi': 0.9934244396558735}-{'f1_val': 0.8878017113528044, 'auprc': 0.9880213519911459, 'loss_val': 0.5121085133508162, 'psi': 0.927889567608141}
[S17] START round=34 head_norm_before_train=1.433813 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.33989039815179733, 'auprc': 0.6511452622743994, 'loss_val': 1.2897197486712308, 'psi': 0.46439234380083816}-{'f1_val': 0.8119319113634366, 'auprc': 0.9211259790422333, 'loss_val': 0.5427438598775363, 'psi': 0.8556095384349552}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9963
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=0.6185
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=-0.0111
[S14] DROPPED delta from S10 (cos=-0.0111 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.5455
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=-0.2020
[S17] DROPPED delta from S7 (cos=-0.2020 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.3926
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=-0.2049
[S7] DROPPED delta from S13 (cos=-0.2049 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.8623 head_norm=1.662974
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.081601e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.8471 head_norm=1.375000 delta_norm=0.908160
[S11] aggregate: ROLLBACK (f1_val pre=0.862 post=0.847 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9962 head_norm=1.129952
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.998797e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9961 head_norm=1.317006 delta_norm=0.699880
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.7273 head_norm=1.968504
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.633766e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.7641 head_norm=1.977938 delta_norm=0.086338
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.3399 head_norm=1.451540
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.142713e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.3795 head_norm=1.594872 delta_norm=0.914271
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.917984 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8332512738823292, 'auprc': 0.7681485653419144, 'loss_val': 0.3889980768550097, 'psi': 0.8072101904661633}-{'f1_val': 0.8324819018624932, 'auprc': 0.7719600945221003, 'loss_val': 0.3849696115408498, 'psi': 0.808273178926336}
[S3] START round=35 head_norm_before_train=2.266971 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9297730066122039, 'auprc': 0.9925909806973955, 'loss_val': 0.24279114661987547, 'psi': 0.9549001962462804}-{'f1_val': 0.9791685743735303, 'auprc': 0.9986025158142391, 'loss_val': 0.07443512682050883, 'psi': 0.9869421509498139}
[S4] START round=35 head_norm_before_train=1.896647 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9498114006911398, 'auprc': 0.9524382155178741, 'loss_val': 0.2965882186074998, 'psi': 0.9508621266218336}-{'f1_val': 0.9523007588873954, 'auprc': 0.9587184660734437, 'loss_val': 0.29439429474838746, 'psi': 0.9548678417618147}
[S5] START round=35 head_norm_before_train=1.632568 cos_to_last_merge=0.7629 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.763
[S5] round=35 local utility u=0.000430 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9989603331711345, 'loss_val': 0.04468441763674246, 'psi': 0.9978258684350925}-{'f1_val': 0.9974365845193254, 'auprc': 0.9994547276591372, 'loss_val': 0.04923049920056532, 'psi': 0.9982438417752502}
[S6] START round=35 head_norm_before_train=1.835872 (no previous merge yet)
[S6] round=35 local utility u=0.528788 metrics={'f1_val': 0.6808541362576785, 'auprc': 0.831231797977146, 'loss_val': 0.7619841897447613, 'psi': 0.7410052009454655}-{'f1_val': 0.5971981298322756, 'auprc': 0.7543806160272516, 'loss_val': 1.087071101966908, 'psi': 0.6600711243102659}
[S7] START round=35 head_norm_before_train=1.977938 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5869182582924264, 'auprc': 0.7925719508251186, 'loss_val': 0.8974899365496648, 'psi': 0.6691797353055033}-{'f1_val': 0.7273373406043855, 'auprc': 0.9891204885230646, 'loss_val': 0.17537023084392978, 'psi': 0.8320505997718571}
[S8] START round=35 head_norm_before_train=1.317006 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9945000134264828, 'loss_val': 0.21860904676671536, 'psi': 0.9955218674106848}-{'f1_val': 0.9962031034001528, 'auprc': 0.9981003832994607, 'loss_val': 0.17564329369411694, 'psi': 0.9969620153598759}
[S9] START round=35 head_norm_before_train=2.156860 (no previous merge yet)
[S9] round=35 local utility u=0.000357 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999955542874439, 'loss_val': 0.0179780425482033, 'psi': 0.9977448345880193}-{'f1_val': 0.9958601375429889, 'auprc': 0.9999508200467271, 'loss_val': 0.016212536921547695, 'psi': 0.9974964105444841}
[S10] START round=35 head_norm_before_train=2.045786 (no previous merge yet)
[S10] round=35 local utility u=0.000231 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956761022637259, 'loss_val': 0.028687541914768085, 'psi': 0.9952513528245361}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956550729142867, 'loss_val': 0.029086974496228112, 'psi': 0.9952429410847603}
[S11] START round=35 head_norm_before_train=1.375000 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.437872 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9956675510513229, 'loss_val': 0.10717683503772404, 'psi': 0.9959472253685148}-{'f1_val': 0.8623477644783019, 'auprc': 0.9958423402254306, 'loss_val': 0.18073034953966052, 'psi': 0.9157455947771533}
[S13] START round=35 head_norm_before_train=1.524445 cos_to_last_merge=0.9966 (last merge round=32)
[S13] round=35 local utility u=0.003245 metrics={'f1_val': 0.6000552184112196, 'auprc': 0.6495412663510015, 'loss_val': 0.7615836377176409, 'psi': 0.6198496375871323}-{'f1_val': 0.6017798402274293, 'auprc': 0.6555060110506847, 'loss_val': 0.7963158869159831, 'psi': 0.6232703085567315}
[S14] START round=35 head_norm_before_train=1.780977 cos_to_last_merge=0.8273 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.827
[S14] round=35 local utility u=0.000368 metrics={'f1_val': 0.9978201519282794, 'auprc': 0.9984721725170872, 'loss_val': 0.026337843197653244, 'psi': 0.9980809601638025}-{'f1_val': 0.997842298753406, 'auprc': 0.9988090025721099, 'loss_val': 0.02821783187411535, 'psi': 0.9982289802808876}
[S15] START round=35 head_norm_before_train=1.122846 cos_to_last_merge=0.9989 (last merge round=33)
[S15] round=35 local utility u=0.043315 metrics={'f1_val': 0.7313855001150841, 'auprc': 0.9580224851938474, 'loss_val': 0.4546802464634694, 'psi': 0.8220402941465894}-{'f1_val': 0.6990808623839736, 'auprc': 0.9809245311341885, 'loss_val': 0.41618936120253924, 'psi': 0.8118183298840596}
[S16] START round=35 head_norm_before_train=1.991074 (no previous merge yet)
[S16] round=35 local utility u=0.005714 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9972251823782793, 'loss_val': 0.03530754986222664, 'psi': 0.9945396277863223}-{'f1_val': 0.9924083188175701, 'auprc': 0.9949486209133285, 'loss_val': 0.037860498399510494, 'psi': 0.9934244396558735}
[S17] START round=35 head_norm_before_train=1.594872 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.857473 metrics={'f1_val': 0.5894428458522906, 'auprc': 0.6418882064863987, 'loss_val': 1.0443176876487283, 'psi': 0.6104209901059339}-{'f1_val': 0.33989039815179733, 'auprc': 0.6511452622743994, 'loss_val': 1.2897197486712308, 'psi': 0.46439234380083816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.3776
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=-0.2081
[S7] DROPPED delta from S13 (cos=-0.2081 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.1082
[S9] DROPPED delta from S15 (cos=-0.1082 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=0.9256
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0109
[S14] DROPPED delta from S10 (cos=-0.0109 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.8276
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.9250
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.4512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9988
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.400 → S17@127.0.0.1:61017
[S5] ⇄ pheromone p=0.077 → S11@127.0.0.1:61012
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5869 head_norm=1.983375
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.904285e-02
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5871 head_norm=1.991629 delta_norm=0.049043
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.227 → S17@127.0.0.1:61017
[S4] ⇄ pheromone p=0.020 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.068 → S8@127.0.0.1:61009
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9962 head_norm=1.359086
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.241320e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9961 head_norm=1.289159 delta_norm=0.324132
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.076 → S15@127.0.0.1:61015
[S10] ⇄ pheromone p=0.004 → S14@127.0.0.1:61014
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9961 head_norm=1.400559
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.628182e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9961 head_norm=1.457305 delta_norm=0.462818
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.100 → S8@127.0.0.1:61009
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6001 head_norm=1.557482
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.759674e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6067 head_norm=1.565129 delta_norm=0.275967
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.035 → S7@127.0.0.1:61008
[S14] ⇄ pheromone p=0.049 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=0.009 → S17@127.0.0.1:61017
[S15] ⇄ pheromone p=0.115 → S9@127.0.0.1:61010
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.5894 head_norm=1.620440
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.626182e-01
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.5899 head_norm=1.501552 delta_norm=0.262618
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.415 → S13@127.0.0.1:61013
[S16] ⇄ pheromone p=0.129 → S7@127.0.0.1:61008
[S2] START round=36 head_norm_before_train=1.932209 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8332512738823292, 'auprc': 0.7716885367499675, 'loss_val': 0.4042914023771453, 'psi': 0.8086261790293845}-{'f1_val': 0.8332512738823292, 'auprc': 0.7681485653419144, 'loss_val': 0.3889980768550097, 'psi': 0.8072101904661633}
[S3] START round=36 head_norm_before_train=2.279193 (no previous merge yet)
[S3] round=36 local utility u=0.318467 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9989300179858424, 'loss_val': 0.029017797943174578, 'psi': 0.9978501394962048}-{'f1_val': 0.9297730066122039, 'auprc': 0.9925909806973955, 'loss_val': 0.24279114661987547, 'psi': 0.9549001962462804}
[S4] START round=36 head_norm_before_train=1.905037 (no previous merge yet)
[S4] round=36 local utility u=0.042490 metrics={'f1_val': 0.9546512464391155, 'auprc': 0.9677570205149618, 'loss_val': 0.2866047033498975, 'psi': 0.959893556069454}-{'f1_val': 0.9498114006911398, 'auprc': 0.9524382155178741, 'loss_val': 0.2965882186074998, 'psi': 0.9508621266218336}
[S5] START round=36 head_norm_before_train=1.647517 cos_to_last_merge=0.7604 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9911404914940185, 'loss_val': 0.0628697196053656, 'psi': 0.994477377684682}-{'f1_val': 0.9970695586110643, 'auprc': 0.9989603331711345, 'loss_val': 0.04468441763674246, 'psi': 0.9978258684350925}
[S6] START round=36 head_norm_before_train=1.840921 (no previous merge yet)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9773981845362936, 'auprc': 0.9733689664645703, 'loss_val': 0.09459505836492675, 'psi': 0.9757864973076043}-{'f1_val': 0.6808541362576785, 'auprc': 0.831231797977146, 'loss_val': 0.7619841897447613, 'psi': 0.7410052009454655}
[S7] START round=36 head_norm_before_train=1.991629 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.561420 metrics={'f1_val': 0.6666829944027806, 'auprc': 0.8323807967365847, 'loss_val': 0.3726639412313654, 'psi': 0.7329621153363022}-{'f1_val': 0.5869182582924264, 'auprc': 0.7925719508251186, 'loss_val': 0.8974899365496648, 'psi': 0.6691797353055033}
[S8] START round=36 head_norm_before_train=1.289159 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9942198759949226, 'loss_val': 0.2517703457051707, 'psi': 0.9954098124380608}-{'f1_val': 0.9962031034001528, 'auprc': 0.9945000134264828, 'loss_val': 0.21860904676671536, 'psi': 0.9955218674106848}
[S9] START round=36 head_norm_before_train=2.164811 (no previous merge yet)
[S9] round=36 local utility u=0.000005 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999577056116364, 'loss_val': 0.01797395017368951, 'psi': 0.9977456996828983}-{'f1_val': 0.9962710290637395, 'auprc': 0.999955542874439, 'loss_val': 0.0179780425482033, 'psi': 0.9977448345880193}
[S10] START round=36 head_norm_before_train=2.054676 (no previous merge yet)
[S10] round=36 local utility u=0.000679 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957320963284788, 'loss_val': 0.028309478622765175, 'psi': 0.9953549193770505}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956761022637259, 'loss_val': 0.028687541914768085, 'psi': 0.9952513528245361}
[S11] START round=36 head_norm_before_train=1.457305 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9940256943701091, 'auprc': 0.9962555197431565, 'loss_val': 0.11532554666641809, 'psi': 0.9949176245193281}-{'f1_val': 0.9961336749133093, 'auprc': 0.9956675510513229, 'loss_val': 0.10717683503772404, 'psi': 0.9959472253685148}
[S13] START round=36 head_norm_before_train=1.565129 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.619893024695315, 'auprc': 0.601579691893611, 'loss_val': 0.8069167632779036, 'psi': 0.6125676915746334}-{'f1_val': 0.6000552184112196, 'auprc': 0.6495412663510015, 'loss_val': 0.7615836377176409, 'psi': 0.6198496375871323}
[S14] START round=36 head_norm_before_train=1.792433 cos_to_last_merge=0.8263 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.826
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9973571734564618, 'auprc': 0.9987998857297279, 'loss_val': 0.026455857803421027, 'psi': 0.9979342583657682}-{'f1_val': 0.9978201519282794, 'auprc': 0.9984721725170872, 'loss_val': 0.026337843197653244, 'psi': 0.9980809601638025}
[S15] START round=36 head_norm_before_train=1.161671 cos_to_last_merge=0.9962 (last merge round=33)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.696775540932514, 'auprc': 0.9817611838735048, 'loss_val': 0.4045944492685301, 'psi': 0.8107697981089104}-{'f1_val': 0.7313855001150841, 'auprc': 0.9580224851938474, 'loss_val': 0.4546802464634694, 'psi': 0.8220402941465894}
[S16] START round=36 head_norm_before_train=2.001051 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9908754358447946, 'auprc': 0.9967888587420557, 'loss_val': 0.05199518028534743, 'psi': 0.9932408050036992}-{'f1_val': 0.992749258058351, 'auprc': 0.9972251823782793, 'loss_val': 0.03530754986222664, 'psi': 0.9945396277863223}
[S17] START round=36 head_norm_before_train=1.501552 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.8284581671219875, 'auprc': 0.9700659298207754, 'loss_val': 0.4580193201479679, 'psi': 0.8851012722015026}-{'f1_val': 0.5894428458522906, 'auprc': 0.6418882064863987, 'loss_val': 1.0443176876487283, 'psi': 0.6104209901059339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] sending update (kind=head size=1787 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S17
[S6] cosine check vs S17: cos=0.5072
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=-0.1080
[S15] DROPPED delta from S9 (cos=-0.1080 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.9774 head_norm=1.848195
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.480901e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.9787 head_norm=1.464505 delta_norm=0.848090
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9909 head_norm=2.010621
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.057114e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9909 head_norm=2.003459 delta_norm=0.030571
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.945807 (no previous merge yet)
[S2] round=37 local utility u=0.150956 metrics={'f1_val': 0.8288619063081387, 'auprc': 0.895517548116439, 'loss_val': 0.447530486190633, 'psi': 0.8555241630314588}-{'f1_val': 0.8332512738823292, 'auprc': 0.7716885367499675, 'loss_val': 0.4042914023771453, 'psi': 0.8086261790293845}
[S3] START round=37 head_norm_before_train=2.290331 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9028027683049372, 'auprc': 0.9993017585442586, 'loss_val': 0.16555440555804965, 'psi': 0.9414023644006658}-{'f1_val': 0.9971302205031132, 'auprc': 0.9989300179858424, 'loss_val': 0.029017797943174578, 'psi': 0.9978501394962048}
[S4] START round=37 head_norm_before_train=1.914291 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9508263635270239, 'auprc': 0.9516618530099297, 'loss_val': 0.30177169877046284, 'psi': 0.9511605593201862}-{'f1_val': 0.9546512464391155, 'auprc': 0.9677570205149618, 'loss_val': 0.2866047033498975, 'psi': 0.959893556069454}
[S5] START round=37 head_norm_before_train=1.665448 cos_to_last_merge=0.7574 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=37 local utility u=0.023603 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9994484826755226, 'loss_val': 0.04499495726976342, 'psi': 0.9982413437818043}-{'f1_val': 0.9967019684784577, 'auprc': 0.9911404914940185, 'loss_val': 0.0628697196053656, 'psi': 0.994477377684682}
[S6] START round=37 head_norm_before_train=1.464505 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.4598221645993382, 'auprc': 0.7660977666507098, 'loss_val': 0.958827994595589, 'psi': 0.5823324054198868}-{'f1_val': 0.9773981845362936, 'auprc': 0.9733689664645703, 'loss_val': 0.09459505836492675, 'psi': 0.9757864973076043}
[S7] START round=37 head_norm_before_train=1.996739 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=37 local utility u=0.284324 metrics={'f1_val': 0.6983639604031636, 'auprc': 0.9229586880072029, 'loss_val': 0.2658362629881324, 'psi': 0.7882018514447793}-{'f1_val': 0.6666829944027806, 'auprc': 0.8323807967365847, 'loss_val': 0.3726639412313654, 'psi': 0.7329621153363022}
[S8] START round=37 head_norm_before_train=1.328083 cos_to_last_merge=0.9974 (last merge round=35)
[S8] round=37 local utility u=0.041535 metrics={'f1_val': 0.9956890572166568, 'auprc': 0.9971246739593116, 'loss_val': 0.17433019904985708, 'psi': 0.9962633039137188}-{'f1_val': 0.9962031034001528, 'auprc': 0.9942198759949226, 'loss_val': 0.2517703457051707, 'psi': 0.9954098124380608}
[S9] START round=37 head_norm_before_train=2.174591 (no previous merge yet)
[S9] round=37 local utility u=0.003354 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9999577056116363, 'loss_val': 0.01624014929936146, 'psi': 0.9982431119681925}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999577056116364, 'loss_val': 0.01797395017368951, 'psi': 0.9977456996828983}
[S10] START round=37 head_norm_before_train=2.064291 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995685492267588, 'loss_val': 0.02809488755883102, 'psi': 0.9952551088260808}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957320963284788, 'loss_val': 0.028309478622765175, 'psi': 0.9953549193770505}
[S11] START round=37 head_norm_before_train=1.486244 cos_to_last_merge=0.9993 (last merge round=35)
[S11] round=37 local utility u=0.019293 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9954408677411677, 'loss_val': 0.08942300949845265, 'psi': 0.9961045498046208}-{'f1_val': 0.9940256943701091, 'auprc': 0.9962555197431565, 'loss_val': 0.11532554666641809, 'psi': 0.9949176245193281}
[S13] START round=37 head_norm_before_train=1.593526 cos_to_last_merge=0.9994 (last merge round=35)
[S13] round=37 local utility u=0.218311 metrics={'f1_val': 0.6282914900595906, 'auprc': 0.6928406215229803, 'loss_val': 0.6944686852829467, 'psi': 0.6541111426449464}-{'f1_val': 0.619893024695315, 'auprc': 0.601579691893611, 'loss_val': 0.8069167632779036, 'psi': 0.6125676915746334}
[S14] START round=37 head_norm_before_train=1.799903 cos_to_last_merge=0.8251 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.825
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9990645446838102, 'loss_val': 0.02527657986916918, 'psi': 0.9978082128795139}-{'f1_val': 0.9973571734564618, 'auprc': 0.9987998857297279, 'loss_val': 0.026455857803421027, 'psi': 0.9979342583657682}
[S15] START round=37 head_norm_before_train=1.201012 cos_to_last_merge=0.9924 (last merge round=33)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6964762093702271, 'auprc': 0.9744475337083178, 'loss_val': 0.4202369728542523, 'psi': 0.8076647391054634}-{'f1_val': 0.696775540932514, 'auprc': 0.9817611838735048, 'loss_val': 0.4045944492685301, 'psi': 0.8107697981089104}
[S16] START round=37 head_norm_before_train=2.003459 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8450680628875034, 'auprc': 0.8913505740002325, 'loss_val': 0.9517450555860972, 'psi': 0.863581067332595}-{'f1_val': 0.9908754358447946, 'auprc': 0.9967888587420557, 'loss_val': 0.05199518028534743, 'psi': 0.9932408050036992}
[S17] START round=37 head_norm_before_train=1.520606 cos_to_last_merge=0.9998 (last merge round=35)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.40479346512883135, 'auprc': 0.5981233937149852, 'loss_val': 1.3293582154563863, 'psi': 0.4821254365632929}-{'f1_val': 0.8284581671219875, 'auprc': 0.9700659298207754, 'loss_val': 0.4580193201479679, 'psi': 0.8851012722015026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61016
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S8
[S11] cosine check vs S8: cos=0.6197
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=0.9858
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=-0.1084
[S15] DROPPED delta from S9 (cos=-0.1084 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9997
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:61003
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S11
[S3] cosine check vs S11: cos=0.3308
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9028 head_norm=2.301414
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.149858e+00
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.8715 head_norm=1.574061 delta_norm=1.149858
[S3] aggregate: ROLLBACK (f1_val pre=0.903 post=0.872 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9965 head_norm=1.517621
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.339887e-01
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9965 head_norm=1.302070 delta_norm=0.633989
[S11] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.4048 head_norm=1.535040
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.387706e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.4023 head_norm=1.570077 delta_norm=0.138771
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8451 head_norm=2.007708
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.317723e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8451 head_norm=2.005571 delta_norm=0.023177
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.955551 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.49665937432579443, 'auprc': 0.7169852641737013, 'loss_val': 1.1724449954630685, 'psi': 0.5847897302649572}-{'f1_val': 0.8288619063081387, 'auprc': 0.895517548116439, 'loss_val': 0.447530486190633, 'psi': 0.8555241630314588}
[S3] START round=38 head_norm_before_train=1.574061 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.196437 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.998493139271525, 'loss_val': 0.11988840921828643, 'psi': 0.9760423069482823}-{'f1_val': 0.9028027683049372, 'auprc': 0.9993017585442586, 'loss_val': 0.16555440555804965, 'psi': 0.9414023644006658}
[S4] START round=38 head_norm_before_train=1.921776 (no previous merge yet)
[S4] round=38 local utility u=0.056550 metrics={'f1_val': 0.957803051754386, 'auprc': 0.9700514316113095, 'loss_val': 0.28570095369624837, 'psi': 0.9627024036971554}-{'f1_val': 0.9508263635270239, 'auprc': 0.9516618530099297, 'loss_val': 0.30177169877046284, 'psi': 0.9511605593201862}
[S5] START round=38 head_norm_before_train=1.684200 cos_to_last_merge=0.7544 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.754
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9994405881077538, 'loss_val': 0.04871458777661528, 'psi': 0.9982381859546968}-{'f1_val': 0.9974365845193254, 'auprc': 0.9994484826755226, 'loss_val': 0.04499495726976342, 'psi': 0.9982413437818043}
[S6] START round=38 head_norm_before_train=1.480102 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.8426729811225545, 'auprc': 0.9360785465890398, 'loss_val': 0.4132133750953909, 'psi': 0.8800352073091486}-{'f1_val': 0.4598221645993382, 'auprc': 0.7660977666507098, 'loss_val': 0.958827994595589, 'psi': 0.5823324054198868}
[S7] START round=38 head_norm_before_train=2.003700 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6825056254045456, 'auprc': 0.82671644471348, 'loss_val': 0.3809884856813999, 'psi': 0.7401899531281193}-{'f1_val': 0.6983639604031636, 'auprc': 0.9229586880072029, 'loss_val': 0.2658362629881324, 'psi': 0.7882018514447793}
[S8] START round=38 head_norm_before_train=1.375313 cos_to_last_merge=0.9902 (last merge round=35)
[S8] round=38 local utility u=0.026856 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9978783685293936, 'loss_val': 0.12596335160918282, 'psi': 0.9968732094518491}-{'f1_val': 0.9956890572166568, 'auprc': 0.9971246739593116, 'loss_val': 0.17433019904985708, 'psi': 0.9962633039137188}
[S9] START round=38 head_norm_before_train=2.180120 (no previous merge yet)
[S9] round=38 local utility u=0.000178 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999532567164302, 'loss_val': 0.01588755486021195, 'psi': 0.9982430501938577}-{'f1_val': 0.9971000495392299, 'auprc': 0.9999577056116363, 'loss_val': 0.01624014929936146, 'psi': 0.9982431119681925}
[S10] START round=38 head_norm_before_train=2.073827 (no previous merge yet)
[S10] round=38 local utility u=0.000617 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956307371986073, 'loss_val': 0.02801468657351314, 'psi': 0.9953649982910677}-{'f1_val': 0.9949681865317428, 'auprc': 0.995685492267588, 'loss_val': 0.02809488755883102, 'psi': 0.9952551088260808}
[S11] START round=38 head_norm_before_train=1.302070 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971513096525872, 'loss_val': 0.12467816953599138, 'psi': 0.9967887265691886}-{'f1_val': 0.9965470045135896, 'auprc': 0.9954408677411677, 'loss_val': 0.08942300949845265, 'psi': 0.9961045498046208}
[S13] START round=38 head_norm_before_train=1.616309 cos_to_last_merge=0.9984 (last merge round=35)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6193486184543133, 'auprc': 0.6304357021316181, 'loss_val': 0.9206056244998018, 'psi': 0.6237834519252352}-{'f1_val': 0.6282914900595906, 'auprc': 0.6928406215229803, 'loss_val': 0.6944686852829467, 'psi': 0.6541111426449464}
[S14] START round=38 head_norm_before_train=1.807858 cos_to_last_merge=0.8242 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.824
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9988399990679475, 'loss_val': 0.02471783975076015, 'psi': 0.9974722263974377}-{'f1_val': 0.9969706583433163, 'auprc': 0.9990645446838102, 'loss_val': 0.02527657986916918, 'psi': 0.9978082128795139}
[S15] START round=38 head_norm_before_train=1.229880 cos_to_last_merge=0.9892 (last merge round=33)
[S15] round=38 local utility u=0.014267 metrics={'f1_val': 0.6979769049810707, 'auprc': 0.9779759339322875, 'loss_val': 0.4112929797112651, 'psi': 0.8099765165615574}-{'f1_val': 0.6964762093702271, 'auprc': 0.9744475337083178, 'loss_val': 0.4202369728542523, 'psi': 0.8076647391054634}
[S16] START round=38 head_norm_before_train=2.005571 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.325392 metrics={'f1_val': 0.8632208507704159, 'auprc': 0.988530071685845, 'loss_val': 0.7014170664664937, 'psi': 0.9133445391365875}-{'f1_val': 0.8450680628875034, 'auprc': 0.8913505740002325, 'loss_val': 0.9517450555860972, 'psi': 0.863581067332595}
[S17] START round=38 head_norm_before_train=1.570077 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.694629 metrics={'f1_val': 0.5722723844979797, 'auprc': 0.6270368059796771, 'loss_val': 1.0317146502987298, 'psi': 0.5941781530906587}-{'f1_val': 0.40479346512883135, 'auprc': 0.5981233937149852, 'loss_val': 1.3293582154563863, 'psi': 0.4821254365632929}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=-0.1087
[S15] DROPPED delta from S9 (cos=-0.1087 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S8
[S11] cosine check vs S8: cos=0.8764
[S8] RECEIVED delta(kind=head bytes=1805) from S15
[S8] cosine check vs S15: cos=0.7468
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.8185
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9965 head_norm=1.340899
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.456488e-01
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9965 head_norm=1.338159 delta_norm=0.345649
[S11] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8427 head_norm=1.499304
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.672825e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8431 head_norm=1.472918 delta_norm=0.467282
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9962 head_norm=1.422067
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.826664e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9962 head_norm=1.251645 delta_norm=0.482666
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.963965 (no previous merge yet)
[S2] round=39 local utility u=1.000000 metrics={'f1_val': 0.8288619063081387, 'auprc': 0.8609687806788484, 'loss_val': 0.46028228069385146, 'psi': 0.8417046560564226}-{'f1_val': 0.49665937432579443, 'auprc': 0.7169852641737013, 'loss_val': 1.1724449954630685, 'psi': 0.5847897302649572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] r=40 psi=0.842 u=1.0000 p_local=0.2471 f1=0.829 auprc=0.861 bytes=28748
[S3] START round=39 head_norm_before_train=1.619920 cos_to_last_merge=0.9996 (last merge round=37)
[S3] round=39 local utility u=0.093729 metrics={'f1_val': 0.983037983226718, 'auprc': 0.9985938098072273, 'loss_val': 0.06451011333762358, 'psi': 0.9892603138589218}-{'f1_val': 0.9610750853994537, 'auprc': 0.998493139271525, 'loss_val': 0.11988840921828643, 'psi': 0.9760423069482823}
[S3] not sending this round → trigger blocked (psi=0.989)
[S3] r=40 psi=0.989 u=0.0937 p_local=0.1096 f1=0.983 auprc=0.999 bytes=28746
[S4] START round=39 head_norm_before_train=1.926932 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9548071865916181, 'auprc': 0.9615782717089716, 'loss_val': 0.2903208241393799, 'psi': 0.9575156206385594}-{'f1_val': 0.957803051754386, 'auprc': 0.9700514316113095, 'loss_val': 0.28570095369624837, 'psi': 0.9627024036971554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.958 u=0.0000 p_local=0.0217 f1=0.955 auprc=0.962 bytes=26993
[S5] START round=39 head_norm_before_train=1.693753 cos_to_last_merge=0.7525 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=39 local utility u=0.000516 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9965883555888585, 'loss_val': 0.03692388564343073, 'psi': 0.996877077402182}-{'f1_val': 0.9974365845193254, 'auprc': 0.9994405881077538, 'loss_val': 0.04871458777661528, 'psi': 0.9982381859546968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=40 psi=0.997 u=0.0005 p_local=0.0346 f1=0.997 auprc=0.997 bytes=32381
[S6] START round=39 head_norm_before_train=1.472918 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.028553 metrics={'f1_val': 0.8298626403811635, 'auprc': 0.9597062706476712, 'loss_val': 0.35012832694944107, 'psi': 0.8818000924877666}-{'f1_val': 0.8426729811225545, 'auprc': 0.9360785465890398, 'loss_val': 0.4132133750953909, 'psi': 0.8800352073091486}
[S6] not sending this round → trigger blocked (psi=0.882)
[S6] r=40 psi=0.882 u=0.0286 p_local=0.4318 f1=0.830 auprc=0.960 bytes=28767
[S7] START round=39 head_norm_before_train=2.010761 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5824371024274495, 'auprc': 0.7841414930399185, 'loss_val': 0.877422042296312, 'psi': 0.6631188586724371}-{'f1_val': 0.6825056254045456, 'auprc': 0.82671644471348, 'loss_val': 0.3809884856813999, 'psi': 0.7401899531281193}
[S8] START round=39 head_norm_before_train=1.251645 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.010572 metrics={'f1_val': 0.9962454113599893, 'auprc': 0.9978769924186988, 'loss_val': 0.10506993990255857, 'psi': 0.9968980437834731}-{'f1_val': 0.9962031034001528, 'auprc': 0.9978783685293936, 'loss_val': 0.12596335160918282, 'psi': 0.9968732094518491}
[S9] START round=39 head_norm_before_train=2.185913 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.9999168152215295, 'loss_val': 0.0285405506506206, 'psi': 0.9949660822507479}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999532567164302, 'loss_val': 0.01588755486021195, 'psi': 0.9982430501938577}
[S10] START round=39 head_norm_before_train=2.083000 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956654218915203, 'loss_val': 0.02778223947150874, 'psi': 0.9952470806756538}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956307371986073, 'loss_val': 0.02801468657351314, 'psi': 0.9953649982910677}
[S11] START round=39 head_norm_before_train=1.338159 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9970447911510365, 'loss_val': 0.12988170501591956, 'psi': 0.9967461191685684}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971513096525872, 'loss_val': 0.12467816953599138, 'psi': 0.9967887265691886}
[S13] START round=39 head_norm_before_train=1.638023 cos_to_last_merge=0.9969 (last merge round=35)
[S13] round=39 local utility u=0.475931 metrics={'f1_val': 0.678588393512199, 'auprc': 0.7272135476620505, 'loss_val': 0.6145157758019019, 'psi': 0.6980384551721396}-{'f1_val': 0.6193486184543133, 'auprc': 0.6304357021316181, 'loss_val': 0.9206056244998018, 'psi': 0.6237834519252352}
[S14] START round=39 head_norm_before_train=1.815408 cos_to_last_merge=0.8233 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.823
[S14] round=39 local utility u=0.002077 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9983939560268342, 'loss_val': 0.026647963540849105, 'psi': 0.9980360885666704}-{'f1_val': 0.9965603779504312, 'auprc': 0.9988399990679475, 'loss_val': 0.02471783975076015, 'psi': 0.9974722263974377}
[S15] START round=39 head_norm_before_train=1.255742 cos_to_last_merge=0.9861 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6951601091366797, 'auprc': 0.9776940213158002, 'loss_val': 0.42503614001073897, 'psi': 0.8081736740083278}-{'f1_val': 0.6979769049810707, 'auprc': 0.9779759339322875, 'loss_val': 0.4112929797112651, 'psi': 0.8099765165615574}
[S16] START round=39 head_norm_before_train=2.010084 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=39 local utility u=0.729602 metrics={'f1_val': 0.9925061349006098, 'auprc': 0.9953895467404507, 'loss_val': 0.03850347768546855, 'psi': 0.9936594996365462}-{'f1_val': 0.8632208507704159, 'auprc': 0.988530071685845, 'loss_val': 0.7014170664664937, 'psi': 0.9133445391365875}
[S17] START round=39 head_norm_before_train=1.589896 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.747831 metrics={'f1_val': 0.6170213152032569, 'auprc': 0.9593703521463588, 'loss_val': 0.801546947396069, 'psi': 0.7539609299804977}-{'f1_val': 0.5722723844979797, 'auprc': 0.6270368059796771, 'loss_val': 1.0317146502987298, 'psi': 0.5941781530906587}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.995 u=0.0000 p_local=0.0042 f1=0.992 auprc=1.000 bytes=35976
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S8
[S11] cosine check vs S8: cos=0.8907
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=40 psi=0.994 u=0.7296 p_local=0.2509 f1=0.993 auprc=0.995 bytes=26974
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0018 f1=0.995 auprc=0.996 bytes=32318
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] r=40 psi=0.808 u=0.0000 p_local=0.0493 f1=0.695 auprc=0.978 bytes=26951
[S17] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=-0.0086
[S10] DROPPED delta from S14 (cos=-0.0086 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=0.9928
[S6] RECEIVED delta(kind=head bytes=1796) from S17
[S6] cosine check vs S17: cos=0.9484
[S14] r=40 psi=0.998 u=0.0021 p_local=0.0204 f1=0.998 auprc=0.998 bytes=30591
[S13] r=40 psi=0.698 u=0.4759 p_local=0.1376 f1=0.679 auprc=0.727 bytes=28800
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6170 head_norm=1.608005
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.005529e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6159 head_norm=1.628842 delta_norm=0.100553
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.754 u=0.7478 p_local=0.5331 f1=0.617 auprc=0.959 bytes=28778
[S7] r=40 psi=0.663 u=0.0000 p_local=0.1867 f1=0.582 auprc=0.784 bytes=26968
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9965 head_norm=1.384770
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.165589e-01
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9965 head_norm=1.305246 delta_norm=0.316559
[S11] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0435 f1=0.997 auprc=0.997 bytes=26965
[S8] CommDone barrier timeout: have=1 need=3 — continuing
[S8] r=40 psi=0.997 u=0.0106 p_local=0.0428 f1=0.996 auprc=0.998 bytes=32309
[S2] START round=40 head_norm_before_train=1.970605 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8315739887371474, 'auprc': 0.7549367755408365, 'loss_val': 0.44514018413817413, 'psi': 0.8009191034586229}-{'f1_val': 0.8288619063081387, 'auprc': 0.8609687806788484, 'loss_val': 0.46028228069385146, 'psi': 0.8417046560564226}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.691004 cos_to_last_merge=0.9977 (last merge round=37)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9423383089851239, 'auprc': 0.9990372279489546, 'loss_val': 0.1604606624577296, 'psi': 0.9650178765706562}-{'f1_val': 0.983037983226718, 'auprc': 0.9985938098072273, 'loss_val': 0.06451011333762358, 'psi': 0.9892603138589218}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.928742 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9437216854317121, 'auprc': 0.9443729662563247, 'loss_val': 0.30850728359677804, 'psi': 0.9439821977615572}-{'f1_val': 0.9548071865916181, 'auprc': 0.9615782717089716, 'loss_val': 0.2903208241393799, 'psi': 0.9575156206385594}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.711574 cos_to_last_merge=0.7496 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.750
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9953635850444074, 'loss_val': 0.035100292218406236, 'psi': 0.9963871691844015}-{'f1_val': 0.9970695586110643, 'auprc': 0.9965883555888585, 'loss_val': 0.03692388564343073, 'psi': 0.996877077402182}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.502332 cos_to_last_merge=0.9994 (last merge round=38)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.5955668838118005, 'auprc': 0.7682893151482209, 'loss_val': 0.810303408034613, 'psi': 0.6646558563463687}-{'f1_val': 0.8298626403811635, 'auprc': 0.9597062706476712, 'loss_val': 0.35012832694944107, 'psi': 0.8818000924877666}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.5956 head_norm=1.541241
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.770332e-01
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.5955 head_norm=1.550421 delta_norm=0.277033
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] START round=40 head_norm_before_train=2.013915 cos_to_last_merge=0.9998 (last merge round=35)
[S7] round=40 local utility u=1.000000 metrics={'f1_val': 0.995899557150905, 'auprc': 0.9981854653062426, 'loss_val': 0.13534237655109704, 'psi': 0.9968139204130401}-{'f1_val': 0.5824371024274495, 'auprc': 0.7841414930399185, 'loss_val': 0.877422042296312, 'psi': 0.6631188586724371}
[S8] START round=40 head_norm_before_train=1.300064 cos_to_last_merge=0.9994 (last merge round=38)
[S8] round=40 local utility u=0.008641 metrics={'f1_val': 0.9962454113599893, 'auprc': 0.9986761271685283, 'loss_val': 0.0901857229570491, 'psi': 0.9972176976834048}-{'f1_val': 0.9962454113599893, 'auprc': 0.9978769924186988, 'loss_val': 0.10506993990255857, 'psi': 0.9968980437834731}
[S9] START round=40 head_norm_before_train=2.193875 (no previous merge yet)
[S9] round=40 local utility u=0.020352 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983231571634137, 'loss_val': 0.015680236771066686, 'psi': 0.9975910103726512}-{'f1_val': 0.9916655936035601, 'auprc': 0.9999168152215295, 'loss_val': 0.0285405506506206, 'psi': 0.9949660822507479}
[S10] START round=40 head_norm_before_train=2.086780 (no previous merge yet)
[S10] round=40 local utility u=0.000088 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956641465457228, 'loss_val': 0.02760181438624549, 'psi': 0.9952465705373348}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956654218915203, 'loss_val': 0.02778223947150874, 'psi': 0.9952470806756538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=40 head_norm_before_train=1.305246 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9244776463575439, 'auprc': 0.9961456658733572, 'loss_val': 0.22921095101432398, 'psi': 0.9531448541638692}-{'f1_val': 0.9965470045135896, 'auprc': 0.9970447911510365, 'loss_val': 0.12988170501591956, 'psi': 0.9967461191685684}
[S13] START round=40 head_norm_before_train=1.655534 cos_to_last_merge=0.9957 (last merge round=35)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6339879031214092, 'auprc': 0.6105566688900732, 'loss_val': 0.9311124957642154, 'psi': 0.6246154094288747}-{'f1_val': 0.678588393512199, 'auprc': 0.7272135476620505, 'loss_val': 0.6145157758019019, 'psi': 0.6980384551721396}
[S14] START round=40 head_norm_before_train=1.820553 cos_to_last_merge=0.8226 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.823
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965515368176185, 'auprc': 0.9988076766576619, 'loss_val': 0.032408761410605454, 'psi': 0.9974539927536359}-{'f1_val': 0.9977975102598944, 'auprc': 0.9983939560268342, 'loss_val': 0.026647963540849105, 'psi': 0.9980360885666704}
[S15] START round=40 head_norm_before_train=1.283846 cos_to_last_merge=0.9828 (last merge round=33)
[S15] round=40 local utility u=0.274011 metrics={'f1_val': 0.7684971144663518, 'auprc': 0.9866757742969269, 'loss_val': 0.34398110741976134, 'psi': 0.8557685783985818}-{'f1_val': 0.6951601091366797, 'auprc': 0.9776940213158002, 'loss_val': 0.42503614001073897, 'psi': 0.8081736740083278}
[S16] START round=40 head_norm_before_train=2.016457 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=40 local utility u=0.002070 metrics={'f1_val': 0.9925579669270325, 'auprc': 0.9965415654761739, 'loss_val': 0.038130021317596886, 'psi': 0.994151406346689}-{'f1_val': 0.9925061349006098, 'auprc': 0.9953895467404507, 'loss_val': 0.03850347768546855, 'psi': 0.9936594996365462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=40 head_norm_before_train=1.628842 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.46578104988098956, 'auprc': 0.7915414164626082, 'loss_val': 1.1160856136621817, 'psi': 0.5960851965136371}-{'f1_val': 0.6170213152032569, 'auprc': 0.9593703521463588, 'loss_val': 0.801546947396069, 'psi': 0.7539609299804977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S14] ⇄ pheromone p=0.016 → S10@127.0.0.1:61011
[S13] ⇄ pheromone p=0.110 → S17@127.0.0.1:61017
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=0.9221
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=-0.1082
[S15] DROPPED delta from S9 (cos=-0.1082 < 0.0)
[S15] ⇄ pheromone p=0.094 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=0.007 → S15@127.0.0.1:61015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:61016
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.9997
[S11]  timeout peer S3
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S7]  timeout peer S13
[S7]  timeout peer S16
[S13]  timeout peer S17
[S15]  timeout peer S8
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S14]  timeout peer S10
[S9]  timeout peer S15
[S11]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9962 head_norm=1.337482
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.614593e-01
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9962 head_norm=1.296957 delta_norm=0.261459
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.978689 (no previous merge yet)
[S2] round=41 local utility u=0.011464 metrics={'f1_val': 0.8336500260730103, 'auprc': 0.7570557096639292, 'loss_val': 0.4410260959105696, 'psi': 0.8030122995093778}-{'f1_val': 0.8315739887371474, 'auprc': 0.7549367755408365, 'loss_val': 0.44514018413817413, 'psi': 0.8009191034586229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=41 head_norm_before_train=1.764885 cos_to_last_merge=0.9949 (last merge round=37)
[S3] round=41 local utility u=0.092968 metrics={'f1_val': 0.9640887450481161, 'auprc': 0.9995839692025729, 'loss_val': 0.10666686207446542, 'psi': 0.9782868347098989}-{'f1_val': 0.9423383089851239, 'auprc': 0.9990372279489546, 'loss_val': 0.1604606624577296, 'psi': 0.9650178765706562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=41 head_norm_before_train=1.931190 (no previous merge yet)
[S4] round=41 local utility u=0.054762 metrics={'f1_val': 0.9527563873819329, 'auprc': 0.9573838064172606, 'loss_val': 0.2922233357636738, 'psi': 0.954607354996064}-{'f1_val': 0.9437216854317121, 'auprc': 0.9443729662563247, 'loss_val': 0.30850728359677804, 'psi': 0.9439821977615572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=41 head_norm_before_train=1.739145 cos_to_last_merge=0.7457 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.746
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9989851441935744, 'loss_val': 0.05227166216082166, 'psi': 0.9980560083890251}-{'f1_val': 0.9970695586110643, 'auprc': 0.9953635850444074, 'loss_val': 0.035100292218406236, 'psi': 0.9963871691844015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.550421 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.8586704975064519, 'auprc': 0.9715702027796673, 'loss_val': 0.2851370582659358, 'psi': 0.9038303796157381}-{'f1_val': 0.5955668838118005, 'auprc': 0.7682893151482209, 'loss_val': 0.810303408034613, 'psi': 0.6646558563463687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=41 head_norm_before_train=2.016785 cos_to_last_merge=0.9998 (last merge round=35)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5960161445671353, 'auprc': 0.7816876012825195, 'loss_val': 0.9019476829255547, 'psi': 0.670284727253289}-{'f1_val': 0.995899557150905, 'auprc': 0.9981854653062426, 'loss_val': 0.13534237655109704, 'psi': 0.9968139204130401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.296957 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9986067406288854, 'loss_val': 0.09242094479134805, 'psi': 0.9955310130929287}-{'f1_val': 0.9962454113599893, 'auprc': 0.9986761271685283, 'loss_val': 0.0901857229570491, 'psi': 0.9972176976834048}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.203377 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9998629330223519, 'loss_val': 0.03860084023732056, 'psi': 0.9935267899258124}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983231571634137, 'loss_val': 0.015680236771066686, 'psi': 0.9975910103726512}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.092088 (no previous merge yet)
[S10] round=41 local utility u=0.000488 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955321483444095, 'loss_val': 0.027547468377022467, 'psi': 0.9953255627493887}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956641465457228, 'loss_val': 0.02760181438624549, 'psi': 0.9952465705373348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=41 head_norm_before_train=1.354781 cos_to_last_merge=0.9982 (last merge round=39)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9158091922064091, 'auprc': 0.9960433818765724, 'loss_val': 0.19487997822979145, 'psi': 0.9479028680744744}-{'f1_val': 0.9244776463575439, 'auprc': 0.9961456658733572, 'loss_val': 0.22921095101432398, 'psi': 0.9531448541638692}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.669155 cos_to_last_merge=0.9946 (last merge round=35)
[S13] round=41 local utility u=0.307669 metrics={'f1_val': 0.6563073230637264, 'auprc': 0.6927695029009813, 'loss_val': 0.6963286754641891, 'psi': 0.6708921949986284}-{'f1_val': 0.6339879031214092, 'auprc': 0.6105566688900732, 'loss_val': 0.9311124957642154, 'psi': 0.6246154094288747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=41 head_norm_before_train=1.829288 cos_to_last_merge=0.8219 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.822
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9650064421757489, 'auprc': 0.9988071281233122, 'loss_val': 0.04850028503137204, 'psi': 0.9785267165547742}-{'f1_val': 0.9965515368176185, 'auprc': 0.9988076766576619, 'loss_val': 0.032408761410605454, 'psi': 0.9974539927536359}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.308458 cos_to_last_merge=0.9797 (last merge round=33)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6979674017963109, 'auprc': 0.9392438454919311, 'loss_val': 0.5060373007523583, 'psi': 0.7944779792745589}-{'f1_val': 0.7684971144663518, 'auprc': 0.9866757742969269, 'loss_val': 0.34398110741976134, 'psi': 0.8557685783985818}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=2.022979 cos_to_last_merge=0.9999 (last merge round=37)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9424377114133068, 'auprc': 0.9870184112848229, 'loss_val': 0.2488901710460817, 'psi': 0.9602699913619133}-{'f1_val': 0.9925579669270325, 'auprc': 0.9965415654761739, 'loss_val': 0.038130021317596886, 'psi': 0.994151406346689}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9424 head_norm=2.030880
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.931785e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9420 head_norm=2.023633 delta_norm=0.029318
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] START round=41 head_norm_before_train=1.647018 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.3942267783628596, 'auprc': 0.7512447504715634, 'loss_val': 1.4218257771617189, 'psi': 0.5370339672063411}-{'f1_val': 0.46578104988098956, 'auprc': 0.7915414164626082, 'loss_val': 1.1160856136621817, 'psi': 0.5960851965136371}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.987957 (no previous merge yet)
[S2] round=42 local utility u=0.164589 metrics={'f1_val': 0.8288619063081387, 'auprc': 0.8814184594647425, 'loss_val': 0.4562085393131183, 'psi': 0.8498845275707803}-{'f1_val': 0.8336500260730103, 'auprc': 0.7570557096639292, 'loss_val': 0.4410260959105696, 'psi': 0.8030122995093778}
[S2] not sending this round → trigger blocked (psi=0.850)
[S3] START round=42 head_norm_before_train=1.830359 cos_to_last_merge=0.9920 (last merge round=37)
[S3] round=42 local utility u=0.050010 metrics={'f1_val': 0.9744284178574562, 'auprc': 0.9996440025392358, 'loss_val': 0.06886572019117314, 'psi': 0.9845146517301681}-{'f1_val': 0.9640887450481161, 'auprc': 0.9995839692025729, 'loss_val': 0.10666686207446542, 'psi': 0.9782868347098989}
[S3] not sending this round → trigger blocked (psi=0.985)
[S4] START round=42 head_norm_before_train=1.933291 (no previous merge yet)
[S4] round=42 local utility u=0.010485 metrics={'f1_val': 0.9542439362380064, 'auprc': 0.9606854815522945, 'loss_val': 0.2900844934231061, 'psi': 0.9568205543637216}-{'f1_val': 0.9527563873819329, 'auprc': 0.9573838064172606, 'loss_val': 0.2922233357636738, 'psi': 0.954607354996064}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=42 head_norm_before_train=1.758298 cos_to_last_merge=0.7433 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.743
[S5] round=42 local utility u=0.005769 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9957590618563453, 'loss_val': 0.028852742147023568, 'psi': 0.9965453599091767}-{'f1_val': 0.9974365845193254, 'auprc': 0.9989851441935744, 'loss_val': 0.05227166216082166, 'psi': 0.9980560083890251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=42 head_norm_before_train=1.586737 cos_to_last_merge=0.9992 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7645089347403791, 'auprc': 0.9463974351663484, 'loss_val': 0.5524597352117595, 'psi': 0.8372643349107668}-{'f1_val': 0.8586704975064519, 'auprc': 0.9715702027796673, 'loss_val': 0.2851370582659358, 'psi': 0.9038303796157381}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=2.022300 cos_to_last_merge=0.9997 (last merge round=35)
[S7] round=42 local utility u=0.257955 metrics={'f1_val': 0.6295288016081184, 'auprc': 0.7973690916962073, 'loss_val': 0.6341590472718036, 'psi': 0.6966649176433539}-{'f1_val': 0.5960161445671353, 'auprc': 0.7816876012825195, 'loss_val': 0.9019476829255547, 'psi': 0.670284727253289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=42 head_norm_before_train=1.328889 cos_to_last_merge=0.9997 (last merge round=40)
[S8] round=42 local utility u=0.009514 metrics={'f1_val': 0.9956890572166568, 'auprc': 0.9971974548944487, 'loss_val': 0.08241568924948549, 'psi': 0.9962924162877735}-{'f1_val': 0.9934805280689575, 'auprc': 0.9986067406288854, 'loss_val': 0.09242094479134805, 'psi': 0.9955310130929287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=42 head_norm_before_train=2.213584 (no previous merge yet)
[S9] round=42 local utility u=0.025158 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947501173507418, 'loss_val': 0.017284737707609646, 'psi': 0.9959155416991541}-{'f1_val': 0.9893026945281196, 'auprc': 0.9998629330223519, 'loss_val': 0.03860084023732056, 'psi': 0.9935267899258124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=2.098802 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956656122892537, 'loss_val': 0.0272819189912564, 'psi': 0.9952471568347472}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955321483444095, 'loss_val': 0.027547468377022467, 'psi': 0.9953255627493887}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.398660 cos_to_last_merge=0.9946 (last merge round=39)
[S11] round=42 local utility u=0.284683 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9974240344389869, 'loss_val': 0.11172598659822436, 'psi': 0.996662098622042}-{'f1_val': 0.9158091922064091, 'auprc': 0.9960433818765724, 'loss_val': 0.19487997822979145, 'psi': 0.9479028680744744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=42 head_norm_before_train=1.679757 cos_to_last_merge=0.9937 (last merge round=35)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6404150879623018, 'auprc': 0.6633664170882236, 'loss_val': 0.8035649696882052, 'psi': 0.6495956196126705}-{'f1_val': 0.6563073230637264, 'auprc': 0.6927695029009813, 'loss_val': 0.6963286754641891, 'psi': 0.6708921949986284}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.840761 cos_to_last_merge=0.8209 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.821
[S14] round=42 local utility u=0.100292 metrics={'f1_val': 0.9957218763831894, 'auprc': 0.9984645171114483, 'loss_val': 0.03118063451668265, 'psi': 0.996818932674493}-{'f1_val': 0.9650064421757489, 'auprc': 0.9988071281233122, 'loss_val': 0.04850028503137204, 'psi': 0.9785267165547742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=42 head_norm_before_train=1.332171 cos_to_last_merge=0.9768 (last merge round=33)
[S15] round=42 local utility u=0.568517 metrics={'f1_val': 0.8191576840362426, 'auprc': 0.9898706482877062, 'loss_val': 0.24802542096623267, 'psi': 0.887442869736828}-{'f1_val': 0.6979674017963109, 'auprc': 0.9392438454919311, 'loss_val': 0.5060373007523583, 'psi': 0.7944779792745589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=42 head_norm_before_train=2.023633 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.272504 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9965964311944937, 'loss_val': 0.034484993188328296, 'psi': 0.9942881273128081}-{'f1_val': 0.9424377114133068, 'auprc': 0.9870184112848229, 'loss_val': 0.2488901710460817, 'psi': 0.9602699913619133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=42 head_norm_before_train=1.666848 cos_to_last_merge=0.9996 (last merge round=39)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.3585494847169832, 'auprc': 0.6939698837241606, 'loss_val': 1.7754842846012213, 'psi': 0.4927176443198542}-{'f1_val': 0.3942267783628596, 'auprc': 0.7512447504715634, 'loss_val': 1.4218257771617189, 'psi': 0.5370339672063411}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.991915 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7387432439560819, 'auprc': 0.7492284644176281, 'loss_val': 0.602825716490046, 'psi': 0.7429373321407005}-{'f1_val': 0.8288619063081387, 'auprc': 0.8814184594647425, 'loss_val': 0.4562085393131183, 'psi': 0.8498845275707803}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.883287 cos_to_last_merge=0.9894 (last merge round=37)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8176923376629217, 'auprc': 0.9985720216599445, 'loss_val': 0.29649613987578555, 'psi': 0.8900442112617308}-{'f1_val': 0.9744284178574562, 'auprc': 0.9996440025392358, 'loss_val': 0.06886572019117314, 'psi': 0.9845146517301681}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.938508 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9471931130948528, 'auprc': 0.9436280446475673, 'loss_val': 0.30234364679784725, 'psi': 0.9457670857159386}-{'f1_val': 0.9542439362380064, 'auprc': 0.9606854815522945, 'loss_val': 0.2900844934231061, 'psi': 0.9568205543637216}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.774439 cos_to_last_merge=0.7410 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.741
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9928806376608266, 'loss_val': 0.0279464488831706, 'psi': 0.9951734361514053}-{'f1_val': 0.9970695586110643, 'auprc': 0.9957590618563453, 'loss_val': 0.028852742147023568, 'psi': 0.9965453599091767}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.629362 cos_to_last_merge=0.9971 (last merge round=40)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.5185813176401536, 'auprc': 0.7223960391370507, 'loss_val': 1.0046793902042208, 'psi': 0.6001072062389124}-{'f1_val': 0.7645089347403791, 'auprc': 0.9463974351663484, 'loss_val': 0.5524597352117595, 'psi': 0.8372643349107668}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=2.027698 cos_to_last_merge=0.9996 (last merge round=35)
[S7] round=43 local utility u=0.660792 metrics={'f1_val': 0.7020579335345445, 'auprc': 0.9659356049821948, 'loss_val': 0.25344940678526595, 'psi': 0.8076090021136046}-{'f1_val': 0.6295288016081184, 'auprc': 0.7973690916962073, 'loss_val': 0.6341590472718036, 'psi': 0.6966649176433539}
[S7] not sending this round → trigger blocked (psi=0.808)
[S8] START round=43 head_norm_before_train=1.356098 cos_to_last_merge=0.9991 (last merge round=40)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9898645730971362, 'auprc': 0.9983448428839308, 'loss_val': 0.08900129756134072, 'psi': 0.993256681011854}-{'f1_val': 0.9956890572166568, 'auprc': 0.9971974548944487, 'loss_val': 0.08241568924948549, 'psi': 0.9962924162877735}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.219338 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9998954917379985, 'loss_val': 0.024434062689393476, 'psi': 0.9954674774173335}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947501173507418, 'loss_val': 0.017284737707609646, 'psi': 0.9959155416991541}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.106219 (no previous merge yet)
[S10] round=43 local utility u=0.000098 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956650012235543, 'loss_val': 0.027084177445504024, 'psi': 0.9952469124084674}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956656122892537, 'loss_val': 0.0272819189912564, 'psi': 0.9952471568347472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=43 head_norm_before_train=1.436819 cos_to_last_merge=0.9907 (last merge round=39)
[S11] round=43 local utility u=0.011974 metrics={'f1_val': 0.9947094549336037, 'auprc': 0.9977128347884395, 'loss_val': 0.07997589859324719, 'psi': 0.995910806875538}-{'f1_val': 0.9961541414107454, 'auprc': 0.9974240344389869, 'loss_val': 0.11172598659822436, 'psi': 0.996662098622042}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=43 head_norm_before_train=1.691083 cos_to_last_merge=0.9927 (last merge round=35)
[S13] round=43 local utility u=0.311169 metrics={'f1_val': 0.7053629959764373, 'auprc': 0.7272115962424708, 'loss_val': 0.7624504494967395, 'psi': 0.7141024360828507}-{'f1_val': 0.6404150879623018, 'auprc': 0.6633664170882236, 'loss_val': 0.8035649696882052, 'psi': 0.6495956196126705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=43 head_norm_before_train=1.852176 cos_to_last_merge=0.8201 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.820
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9926172140104469, 'auprc': 0.9984896559657109, 'loss_val': 0.03291315796160297, 'psi': 0.9949661907925524}-{'f1_val': 0.9957218763831894, 'auprc': 0.9984645171114483, 'loss_val': 0.03118063451668265, 'psi': 0.996818932674493}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.350818 cos_to_last_merge=0.9745 (last merge round=33)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7004819460882693, 'auprc': 0.9724968860541239, 'loss_val': 0.4679475296196822, 'psi': 0.8092879220746112}-{'f1_val': 0.8191576840362426, 'auprc': 0.9898706482877062, 'loss_val': 0.24802542096623267, 'psi': 0.887442869736828}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=2.031613 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9931627703103687, 'auprc': 0.9954003087116055, 'loss_val': 0.03684077529766554, 'psi': 0.9940577856708634}-{'f1_val': 0.992749258058351, 'auprc': 0.9965964311944937, 'loss_val': 0.034484993188328296, 'psi': 0.9942881273128081}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.685279 cos_to_last_merge=0.9992 (last merge round=39)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.6434953765257678, 'auprc': 0.8454439846931471, 'loss_val': 0.9136605694482252, 'psi': 0.7242748197927196}-{'f1_val': 0.3585494847169832, 'auprc': 0.6939698837241606, 'loss_val': 1.7754842846012213, 'psi': 0.4927176443198542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=44 head_norm_before_train=1.997450 (no previous merge yet)
[S2] round=44 local utility u=0.494487 metrics={'f1_val': 0.8274873497121904, 'auprc': 0.8592019007689201, 'loss_val': 0.4762359899238575, 'psi': 0.8401731701348822}-{'f1_val': 0.7387432439560819, 'auprc': 0.7492284644176281, 'loss_val': 0.602825716490046, 'psi': 0.7429373321407005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=1.923348 cos_to_last_merge=0.9875 (last merge round=37)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7326800807658699, 'auprc': 0.9981090058386805, 'loss_val': 0.359093735874494, 'psi': 0.8388516507949941}-{'f1_val': 0.8176923376629217, 'auprc': 0.9985720216599445, 'loss_val': 0.29649613987578555, 'psi': 0.8900442112617308}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.943362 (no previous merge yet)
[S4] round=44 local utility u=0.066594 metrics={'f1_val': 0.9566211213420976, 'auprc': 0.9656681532989685, 'loss_val': 0.2918441860431548, 'psi': 0.960239934124846}-{'f1_val': 0.9471931130948528, 'auprc': 0.9436280446475673, 'loss_val': 0.30234364679784725, 'psi': 0.9457670857159386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=44 head_norm_before_train=1.787409 cos_to_last_merge=0.7389 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.739
[S5] round=44 local utility u=0.009374 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9993325422421414, 'loss_val': 0.030758838332735326, 'psi': 0.9979747520634952}-{'f1_val': 0.9967019684784577, 'auprc': 0.9928806376608266, 'loss_val': 0.0279464488831706, 'psi': 0.9951734361514053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=44 head_norm_before_train=1.661829 cos_to_last_merge=0.9947 (last merge round=40)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.9597537129334086, 'auprc': 0.9786672480570289, 'loss_val': 0.17654927270576962, 'psi': 0.9673191269828567}-{'f1_val': 0.5185813176401536, 'auprc': 0.7223960391370507, 'loss_val': 1.0046793902042208, 'psi': 0.6001072062389124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=44 head_norm_before_train=2.031077 cos_to_last_merge=0.9995 (last merge round=35)
[S7] round=44 local utility u=0.054001 metrics={'f1_val': 0.7077692998120697, 'auprc': 0.9795419045877277, 'loss_val': 0.22053471679258185, 'psi': 0.8164783417223329}-{'f1_val': 0.7020579335345445, 'auprc': 0.9659356049821948, 'loss_val': 0.25344940678526595, 'psi': 0.8076090021136046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=1.377533 cos_to_last_merge=0.9983 (last merge round=40)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9835749383111202, 'auprc': 0.9993006249752969, 'loss_val': 0.11692686180084473, 'psi': 0.9898652129767909}-{'f1_val': 0.9898645730971362, 'auprc': 0.9983448428839308, 'loss_val': 0.08900129756134072, 'psi': 0.993256681011854}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.222552 (no previous merge yet)
[S9] round=44 local utility u=0.018258 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998736188337942, 'loss_val': 0.01535922051717666, 'psi': 0.9982094772570557}-{'f1_val': 0.9925154678702236, 'auprc': 0.9998954917379985, 'loss_val': 0.024434062689393476, 'psi': 0.9954674774173335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=44 head_norm_before_train=2.114105 (no previous merge yet)
[S10] round=44 local utility u=0.000392 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995500282788781, 'loss_val': 0.027123699778170775, 'psi': 0.9953128165271372}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956650012235543, 'loss_val': 0.027084177445504024, 'psi': 0.9952469124084674}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=44 head_norm_before_train=1.474351 cos_to_last_merge=0.9865 (last merge round=39)
[S11] round=44 local utility u=0.016140 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978525242215285, 'loss_val': 0.05926268453742462, 'psi': 0.9970814920723396}-{'f1_val': 0.9947094549336037, 'auprc': 0.9977128347884395, 'loss_val': 0.07997589859324719, 'psi': 0.995910806875538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=44 head_norm_before_train=1.700772 cos_to_last_merge=0.9919 (last merge round=35)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6445010664579076, 'auprc': 0.6574782931033522, 'loss_val': 0.8176891250375246, 'psi': 0.6496919571160855}-{'f1_val': 0.7053629959764373, 'auprc': 0.7272115962424708, 'loss_val': 0.7624504494967395, 'psi': 0.7141024360828507}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.862470 cos_to_last_merge=0.8193 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.819
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9393189219353049, 'auprc': 0.9987934113131905, 'loss_val': 0.12676492444350124, 'psi': 0.9631087176864592}-{'f1_val': 0.9926172140104469, 'auprc': 0.9984896559657109, 'loss_val': 0.03291315796160297, 'psi': 0.9949661907925524}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.367741 cos_to_last_merge=0.9724 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7007462634806338, 'auprc': 0.8334001856251846, 'loss_val': 0.5232910873534732, 'psi': 0.7538078323384542}-{'f1_val': 0.7004819460882693, 'auprc': 0.9724968860541239, 'loss_val': 0.4679475296196822, 'psi': 0.8092879220746112}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=2.038297 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=44 local utility u=0.000774 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9964078523500042, 'loss_val': 0.035833405463829286, 'psi': 0.9942126957750123}-{'f1_val': 0.9931627703103687, 'auprc': 0.9954003087116055, 'loss_val': 0.03684077529766554, 'psi': 0.9940577856708634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=44 head_norm_before_train=1.699968 cos_to_last_merge=0.9987 (last merge round=39)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.37801938268582574, 'auprc': 0.6594339312882723, 'loss_val': 1.680328187875033, 'psi': 0.49058520212680434}-{'f1_val': 0.6434953765257678, 'auprc': 0.8454439846931471, 'loss_val': 0.9136605694482252, 'psi': 0.7242748197927196}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.005182 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.720678724978817, 'auprc': 0.7521588593425474, 'loss_val': 0.6781781871505704, 'psi': 0.7332707787243092}-{'f1_val': 0.8274873497121904, 'auprc': 0.8592019007689201, 'loss_val': 0.4762359899238575, 'psi': 0.8401731701348822}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.955076 cos_to_last_merge=0.9860 (last merge round=37)
[S3] round=45 local utility u=0.807409 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987317118755503, 'loss_val': 0.11627551897230318, 'psi': 0.9761138354134863}-{'f1_val': 0.7326800807658699, 'auprc': 0.9981090058386805, 'loss_val': 0.359093735874494, 'psi': 0.8388516507949941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=45 head_norm_before_train=1.947637 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9529949394385271, 'auprc': 0.9544890539854047, 'loss_val': 0.30489015106491624, 'psi': 0.9535925852572782}-{'f1_val': 0.9566211213420976, 'auprc': 0.9656681532989685, 'loss_val': 0.2918441860431548, 'psi': 0.960239934124846}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.803493 cos_to_last_merge=0.7368 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.737
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9964647965624328, 'loss_val': 0.029507794853917586, 'psi': 0.9968276537916118}-{'f1_val': 0.9970695586110643, 'auprc': 0.9993325422421414, 'loss_val': 0.030758838332735326, 'psi': 0.9979747520634952}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.689070 cos_to_last_merge=0.9924 (last merge round=40)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8387298814654502, 'auprc': 0.9734366383376339, 'loss_val': 0.3107761588062023, 'psi': 0.8926125842143238}-{'f1_val': 0.9597537129334086, 'auprc': 0.9786672480570289, 'loss_val': 0.17654927270576962, 'psi': 0.9673191269828567}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=2.036437 cos_to_last_merge=0.9993 (last merge round=35)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6372575847800609, 'auprc': 0.7963796986609879, 'loss_val': 0.6169040973340949, 'psi': 0.7009064303324317}-{'f1_val': 0.7077692998120697, 'auprc': 0.9795419045877277, 'loss_val': 0.22053471679258185, 'psi': 0.8164783417223329}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.391743 cos_to_last_merge=0.9977 (last merge round=40)
[S8] round=45 local utility u=0.045621 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9986141892273929, 'loss_val': 0.07765689264163696, 'psi': 0.9949938584204006}-{'f1_val': 0.9835749383111202, 'auprc': 0.9993006249752969, 'loss_val': 0.11692686180084473, 'psi': 0.9898652129767909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=45 head_norm_before_train=2.228419 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999540517284742, 'loss_val': 0.015873776667514473, 'psi': 0.9982433681986753}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998736188337942, 'loss_val': 0.01535922051717666, 'psi': 0.9982094772570557}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.117526 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.99566384448364, 'loss_val': 0.026821335801325945, 'psi': 0.9951147033250796}-{'f1_val': 0.9951878390193748, 'auprc': 0.995500282788781, 'loss_val': 0.027123699778170775, 'psi': 0.9953128165271372}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.511022 cos_to_last_merge=0.9824 (last merge round=39)
[S11] round=45 local utility u=0.004271 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977611881842339, 'loss_val': 0.05032337220428561, 'psi': 0.9970326779818472}-{'f1_val': 0.996567470639547, 'auprc': 0.9978525242215285, 'loss_val': 0.05926268453742462, 'psi': 0.9970814920723396}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.708726 cos_to_last_merge=0.9912 (last merge round=35)
[S13] round=45 local utility u=0.216684 metrics={'f1_val': 0.6515698462693662, 'auprc': 0.7520282513800404, 'loss_val': 0.710382980583506, 'psi': 0.6917532083136358}-{'f1_val': 0.6445010664579076, 'auprc': 0.6574782931033522, 'loss_val': 0.8176891250375246, 'psi': 0.6496919571160855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=45 head_norm_before_train=1.866640 cos_to_last_merge=0.8187 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.819
[S14] round=45 local utility u=0.222384 metrics={'f1_val': 0.9965515368176185, 'auprc': 0.9990344167754178, 'loss_val': 0.026115642673358676, 'psi': 0.9975446888007382}-{'f1_val': 0.9393189219353049, 'auprc': 0.9987934113131905, 'loss_val': 0.12676492444350124, 'psi': 0.9631087176864592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=45 head_norm_before_train=1.384033 cos_to_last_merge=0.9705 (last merge round=33)
[S15] round=45 local utility u=0.557572 metrics={'f1_val': 0.779286969558434, 'auprc': 0.983827796965894, 'loss_val': 0.33067417709622193, 'psi': 0.8611033005214179}-{'f1_val': 0.7007462634806338, 'auprc': 0.8334001856251846, 'loss_val': 0.5232910873534732, 'psi': 0.7538078323384542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=2.041232 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=45 local utility u=0.000177 metrics={'f1_val': 0.992749258058351, 'auprc': 0.996324949044744, 'loss_val': 0.035230548220546304, 'psi': 0.9941795344529082}-{'f1_val': 0.992749258058351, 'auprc': 0.9964078523500042, 'loss_val': 0.035833405463829286, 'psi': 0.9942126957750123}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=45 head_norm_before_train=1.713828 cos_to_last_merge=0.9981 (last merge round=39)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.6345652519010088, 'auprc': 0.9069790429458983, 'loss_val': 0.9870223896264398, 'psi': 0.7435307683189646}-{'f1_val': 0.37801938268582574, 'auprc': 0.6594339312882723, 'loss_val': 1.680328187875033, 'psi': 0.49058520212680434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=46 head_norm_before_train=2.009721 (no previous merge yet)
[S2] round=46 local utility u=0.524517 metrics={'f1_val': 0.8303079692098151, 'auprc': 0.8146400470731163, 'loss_val': 0.47436376105132577, 'psi': 0.8240408003551356}-{'f1_val': 0.720678724978817, 'auprc': 0.7521588593425474, 'loss_val': 0.6781781871505704, 'psi': 0.7332707787243092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=46 head_norm_before_train=1.982493 cos_to_last_merge=0.9845 (last merge round=37)
[S3] round=46 local utility u=0.158299 metrics={'f1_val': 0.9973415147416245, 'auprc': 0.9986438395714998, 'loss_val': 0.01725104593266149, 'psi': 0.9978624446735747}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987317118755503, 'loss_val': 0.11627551897230318, 'psi': 0.9761138354134863}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=46 head_norm_before_train=1.953223 (no previous merge yet)
[S4] round=46 local utility u=0.002106 metrics={'f1_val': 0.9531499149421627, 'auprc': 0.9560099232202913, 'loss_val': 0.30617013312306096, 'psi': 0.9542939182534143}-{'f1_val': 0.9529949394385271, 'auprc': 0.9544890539854047, 'loss_val': 0.30489015106491624, 'psi': 0.9535925852572782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=46 head_norm_before_train=1.815099 cos_to_last_merge=0.7351 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.735
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992594115302884, 'loss_val': 0.041371020582907314, 'psi': 0.9981657153237107}-{'f1_val': 0.9970695586110643, 'auprc': 0.9964647965624328, 'loss_val': 0.029507794853917586, 'psi': 0.9968276537916118}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.717036 cos_to_last_merge=0.9899 (last merge round=40)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6057883185232114, 'auprc': 0.886315056412907, 'loss_val': 0.9531223393112511, 'psi': 0.7179990136790896}-{'f1_val': 0.8387298814654502, 'auprc': 0.9734366383376339, 'loss_val': 0.3107761588062023, 'psi': 0.8926125842143238}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=2.041140 cos_to_last_merge=0.9992 (last merge round=35)
[S7] round=46 local utility u=0.018648 metrics={'f1_val': 0.6433301088813101, 'auprc': 0.7998717079537547, 'loss_val': 0.626518528732911, 'psi': 0.7059467485102879}-{'f1_val': 0.6372575847800609, 'auprc': 0.7963796986609879, 'loss_val': 0.6169040973340949, 'psi': 0.7009064303324317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=46 head_norm_before_train=1.402087 cos_to_last_merge=0.9973 (last merge round=40)
[S8] round=46 local utility u=0.011578 metrics={'f1_val': 0.9949536019818849, 'auprc': 0.999128931218316, 'loss_val': 0.0702846285359819, 'psi': 0.9966237336764573}-{'f1_val': 0.9925803045490724, 'auprc': 0.9986141892273929, 'loss_val': 0.07765689264163696, 'psi': 0.9949938584204006}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=46 head_norm_before_train=2.233578 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9999537129736036, 'loss_val': 0.021603625988857893, 'psi': 0.9964775452131154}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999540517284742, 'loss_val': 0.015873776667514473, 'psi': 0.9982433681986753}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.121343 (no previous merge yet)
[S10] round=46 local utility u=0.000710 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956650288523268, 'loss_val': 0.026721834555370805, 'psi': 0.9952469234599763}-{'f1_val': 0.9947486092193725, 'auprc': 0.99566384448364, 'loss_val': 0.026821335801325945, 'psi': 0.9951147033250796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=46 head_norm_before_train=1.544373 cos_to_last_merge=0.9786 (last merge round=39)
[S11] round=46 local utility u=0.001749 metrics={'f1_val': 0.9960854162000905, 'auprc': 0.9981986966256005, 'loss_val': 0.045368615641307446, 'psi': 0.9969307283702944}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977611881842339, 'loss_val': 0.05032337220428561, 'psi': 0.9970326779818472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=46 head_norm_before_train=1.719323 cos_to_last_merge=0.9903 (last merge round=35)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6159156025357618, 'auprc': 0.6209970992480769, 'loss_val': 0.9904999144493875, 'psi': 0.6179482012206878}-{'f1_val': 0.6515698462693662, 'auprc': 0.7520282513800404, 'loss_val': 0.710382980583506, 'psi': 0.6917532083136358}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.870315 cos_to_last_merge=0.8183 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.818
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9673143037173629, 'auprc': 0.9991319373324183, 'loss_val': 0.10202244172403996, 'psi': 0.9800413571633851}-{'f1_val': 0.9965515368176185, 'auprc': 0.9990344167754178, 'loss_val': 0.026115642673358676, 'psi': 0.9975446888007382}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.400244 cos_to_last_merge=0.9686 (last merge round=33)
[S15] round=46 local utility u=0.024716 metrics={'f1_val': 0.7830867640531196, 'auprc': 0.988408046499861, 'loss_val': 0.3177826000012475, 'psi': 0.8652152770318162}-{'f1_val': 0.779286969558434, 'auprc': 0.983827796965894, 'loss_val': 0.33067417709622193, 'psi': 0.8611033005214179}
[S15] not sending this round → trigger blocked (psi=0.865)
[S16] START round=46 head_norm_before_train=2.043681 cos_to_last_merge=0.9998 (last merge round=41)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8494503243264382, 'auprc': 0.9699491430850948, 'loss_val': 0.9305757668351597, 'psi': 0.8976498518299009}-{'f1_val': 0.992749258058351, 'auprc': 0.996324949044744, 'loss_val': 0.035230548220546304, 'psi': 0.9941795344529082}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.725787 cos_to_last_merge=0.9978 (last merge round=39)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.3902482364772735, 'auprc': 0.745440047979045, 'loss_val': 1.5635128094345396, 'psi': 0.5323249610779821}-{'f1_val': 0.6345652519010088, 'auprc': 0.9069790429458983, 'loss_val': 0.9870223896264398, 'psi': 0.7435307683189646}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.017555 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8317779327057064, 'auprc': 0.7680420689108092, 'loss_val': 0.44819768777342417, 'psi': 0.8062835871877475}-{'f1_val': 0.8303079692098151, 'auprc': 0.8146400470731163, 'loss_val': 0.47436376105132577, 'psi': 0.8240408003551356}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.003811 cos_to_last_merge=0.9835 (last merge round=37)
[S3] round=47 local utility u=0.001712 metrics={'f1_val': 0.9977533136161222, 'auprc': 0.9988134380186847, 'loss_val': 0.016807043722463062, 'psi': 0.9981773633771471}-{'f1_val': 0.9973415147416245, 'auprc': 0.9986438395714998, 'loss_val': 0.01725104593266149, 'psi': 0.9978624446735747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=47 head_norm_before_train=1.956304 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9542439362380064, 'auprc': 0.9502830325695023, 'loss_val': 0.30005048395843004, 'psi': 0.9526595747706048}-{'f1_val': 0.9531499149421627, 'auprc': 0.9560099232202913, 'loss_val': 0.30617013312306096, 'psi': 0.9542939182534143}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.823382 cos_to_last_merge=0.7343 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9970755020728289, 'auprc': 0.9990027948466158, 'loss_val': 0.0764225942435905, 'psi': 0.9978464191823437}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992594115302884, 'loss_val': 0.041371020582907314, 'psi': 0.9981657153237107}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.737854 cos_to_last_merge=0.9882 (last merge round=40)
[S6] round=47 local utility u=0.137473 metrics={'f1_val': 0.613084770781438, 'auprc': 0.9279431324039333, 'loss_val': 0.8468402081581575, 'psi': 0.7390281154304361}-{'f1_val': 0.6057883185232114, 'auprc': 0.886315056412907, 'loss_val': 0.9531223393112511, 'psi': 0.7179990136790896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=47 head_norm_before_train=2.049677 cos_to_last_merge=0.9991 (last merge round=35)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.638375098115153, 'auprc': 0.7981596707203712, 'loss_val': 0.6277410952979066, 'psi': 0.7022889271572403}-{'f1_val': 0.6433301088813101, 'auprc': 0.7998717079537547, 'loss_val': 0.626518528732911, 'psi': 0.7059467485102879}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.410363 cos_to_last_merge=0.9969 (last merge round=40)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9986281886051601, 'loss_val': 0.06652046934090533, 'psi': 0.9958718025866394}-{'f1_val': 0.9949536019818849, 'auprc': 0.999128931218316, 'loss_val': 0.0702846285359819, 'psi': 0.9966237336764573}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.238341 (no previous merge yet)
[S9] round=47 local utility u=0.006142 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966673584070288, 'loss_val': 0.017118393108290074, 'psi': 0.9969286908700972}-{'f1_val': 0.9941601000394567, 'auprc': 0.9999537129736036, 'loss_val': 0.021603625988857893, 'psi': 0.9964775452131154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=47 head_norm_before_train=2.123611 (no previous merge yet)
[S10] round=47 local utility u=0.000706 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956611210292102, 'loss_val': 0.02661684784398325, 'psi': 0.995377151823309}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956650288523268, 'loss_val': 0.026721834555370805, 'psi': 0.9952469234599763}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=47 head_norm_before_train=1.573460 cos_to_last_merge=0.9753 (last merge round=39)
[S11] round=47 local utility u=0.002838 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997657156279683, 'loss_val': 0.04083762390594394, 'psi': 0.9969910652200269}-{'f1_val': 0.9960854162000905, 'auprc': 0.9981986966256005, 'loss_val': 0.045368615641307446, 'psi': 0.9969307283702944}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.728738 cos_to_last_merge=0.9895 (last merge round=35)
[S13] round=47 local utility u=0.548864 metrics={'f1_val': 0.6981827910929688, 'auprc': 0.7402267763306111, 'loss_val': 0.7440641833718777, 'psi': 0.7150003851880258}-{'f1_val': 0.6159156025357618, 'auprc': 0.6209970992480769, 'loss_val': 0.9904999144493875, 'psi': 0.6179482012206878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.875935 cos_to_last_merge=0.8179 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.818
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9233072906953531, 'auprc': 0.9987793214789561, 'loss_val': 0.19672520428361623, 'psi': 0.9534961030087943}-{'f1_val': 0.9673143037173629, 'auprc': 0.9991319373324183, 'loss_val': 0.10202244172403996, 'psi': 0.9800413571633851}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.420256 cos_to_last_merge=0.9663 (last merge round=33)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7002447096282902, 'auprc': 0.8739770838944916, 'loss_val': 0.5400966028394623, 'psi': 0.7697376593347707}-{'f1_val': 0.7830867640531196, 'auprc': 0.988408046499861, 'loss_val': 0.3177826000012475, 'psi': 0.8652152770318162}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.047398 cos_to_last_merge=0.9997 (last merge round=41)
[S16] round=47 local utility u=0.418516 metrics={'f1_val': 0.9013919837070604, 'auprc': 0.9880405943193808, 'loss_val': 0.4594674176757617, 'psi': 0.9360514279519886}-{'f1_val': 0.8494503243264382, 'auprc': 0.9699491430850948, 'loss_val': 0.9305757668351597, 'psi': 0.8976498518299009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=47 head_norm_before_train=1.736774 cos_to_last_merge=0.9974 (last merge round=39)
[S17] round=47 local utility u=0.050347 metrics={'f1_val': 0.42363010000571844, 'auprc': 0.7023769181424282, 'loss_val': 1.5339215317798083, 'psi': 0.5351288272604023}-{'f1_val': 0.3902482364772735, 'auprc': 0.745440047979045, 'loss_val': 1.5635128094345396, 'psi': 0.5323249610779821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=48 head_norm_before_train=2.026199 (no previous merge yet)
[S2] round=48 local utility u=0.144681 metrics={'f1_val': 0.831710275826774, 'auprc': 0.8656519356744089, 'loss_val': 0.4512603398415308, 'psi': 0.845286939765828}-{'f1_val': 0.8317779327057064, 'auprc': 0.7680420689108092, 'loss_val': 0.44819768777342417, 'psi': 0.8062835871877475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=48 head_norm_before_train=2.019148 cos_to_last_merge=0.9827 (last merge round=37)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.998190367149468, 'loss_val': 0.11477684289198235, 'psi': 0.9758735993394888}-{'f1_val': 0.9977533136161222, 'auprc': 0.9988134380186847, 'loss_val': 0.016807043722463062, 'psi': 0.9981773633771471}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.958976 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9468408006509983, 'auprc': 0.9344241264447639, 'loss_val': 0.3101413330686998, 'psi': 0.9418741309685045}-{'f1_val': 0.9542439362380064, 'auprc': 0.9502830325695023, 'loss_val': 0.30005048395843004, 'psi': 0.9526595747706048}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.827248 cos_to_last_merge=0.7339 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=48 local utility u=0.013773 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9924930888602885, 'loss_val': 0.02710695574126951, 'psi': 0.99501841663119}-{'f1_val': 0.9970755020728289, 'auprc': 0.9990027948466158, 'loss_val': 0.0764225942435905, 'psi': 0.9978464191823437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=48 head_norm_before_train=1.755399 cos_to_last_merge=0.9867 (last merge round=40)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9098973944637497, 'auprc': 0.9847041862667236, 'loss_val': 0.18935953467258113, 'psi': 0.9398201111849394}-{'f1_val': 0.613084770781438, 'auprc': 0.9279431324039333, 'loss_val': 0.8468402081581575, 'psi': 0.7390281154304361}
[S6] not sending this round → trigger blocked (psi=0.940)
[S7] START round=48 head_norm_before_train=2.055597 cos_to_last_merge=0.9989 (last merge round=35)
[S7] round=48 local utility u=0.214728 metrics={'f1_val': 0.6705940596341022, 'auprc': 0.8124998244977037, 'loss_val': 0.43461944491220567, 'psi': 0.7273563655795429}-{'f1_val': 0.638375098115153, 'auprc': 0.7981596707203712, 'loss_val': 0.6277410952979066, 'psi': 0.7022889271572403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=48 head_norm_before_train=1.420732 cos_to_last_merge=0.9964 (last merge round=40)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.998630815884197, 'loss_val': 0.07691219870960302, 'psi': 0.9949950940269641}-{'f1_val': 0.9940342119076258, 'auprc': 0.9986281886051601, 'loss_val': 0.06652046934090533, 'psi': 0.9958718025866394}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.242475 (no previous merge yet)
[S9] round=48 local utility u=0.000241 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999621012990936, 'loss_val': 0.018863450200486034, 'psi': 0.9974808715381487}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966673584070288, 'loss_val': 0.017118393108290074, 'psi': 0.9969286908700972}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=48 head_norm_before_train=2.125995 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956683973329102, 'loss_val': 0.026369091222316628, 'psi': 0.9952482708522098}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956611210292102, 'loss_val': 0.02661684784398325, 'psi': 0.995377151823309}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.597227 cos_to_last_merge=0.9726 (last merge round=39)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9966204776910135, 'loss_val': 0.049809831852130546, 'psi': 0.9961832937975539}-{'f1_val': 0.9965470045135896, 'auprc': 0.997657156279683, 'loss_val': 0.04083762390594394, 'psi': 0.9969910652200269}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.737741 cos_to_last_merge=0.9888 (last merge round=35)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6364690304937308, 'auprc': 0.6531973447117476, 'loss_val': 0.9004510728440253, 'psi': 0.6431603561809376}-{'f1_val': 0.6981827910929688, 'auprc': 0.7402267763306111, 'loss_val': 0.7440641833718777, 'psi': 0.7150003851880258}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.885027 cos_to_last_merge=0.8173 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.817
[S14] round=48 local utility u=0.297183 metrics={'f1_val': 0.9942741881921484, 'auprc': 0.998697194060682, 'loss_val': 0.027914130356587217, 'psi': 0.9960433905395618}-{'f1_val': 0.9233072906953531, 'auprc': 0.9987793214789561, 'loss_val': 0.19672520428361623, 'psi': 0.9534961030087943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=48 head_norm_before_train=1.443180 cos_to_last_merge=0.9638 (last merge round=33)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9525359662053048, 'auprc': 0.9911419716822432, 'loss_val': 0.15137534356939975, 'psi': 0.9679783683960801}-{'f1_val': 0.7002447096282902, 'auprc': 0.8739770838944916, 'loss_val': 0.5400966028394623, 'psi': 0.7697376593347707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=48 head_norm_before_train=2.050936 cos_to_last_merge=0.9996 (last merge round=41)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8854774838189583, 'auprc': 0.9113902379583914, 'loss_val': 0.6315357836004919, 'psi': 0.8958425854747316}-{'f1_val': 0.9013919837070604, 'auprc': 0.9880405943193808, 'loss_val': 0.4594674176757617, 'psi': 0.9360514279519886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.749242 cos_to_last_merge=0.9967 (last merge round=39)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.621798355009322, 'auprc': 0.8811578409516883, 'loss_val': 1.1154296125096292, 'psi': 0.7255421493862686}-{'f1_val': 0.42363010000571844, 'auprc': 0.7023769181424282, 'loss_val': 1.5339215317798083, 'psi': 0.5351288272604023}
[S17] not sending this round → trigger blocked (psi=0.726)
[S2] START round=49 head_norm_before_train=2.033683 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7806194036324274, 'auprc': 0.7552457728431444, 'loss_val': 0.5526153897576451, 'psi': 0.7704699513167141}-{'f1_val': 0.831710275826774, 'auprc': 0.8656519356744089, 'loss_val': 0.4512603398415308, 'psi': 0.845286939765828}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.035781 cos_to_last_merge=0.9819 (last merge round=37)
[S3] round=49 local utility u=0.018246 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9985212681756679, 'loss_val': 0.08229541020355677, 'psi': 0.9763077954342188}-{'f1_val': 0.960995754132836, 'auprc': 0.998190367149468, 'loss_val': 0.11477684289198235, 'psi': 0.9758735993394888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=49 head_norm_before_train=1.959994 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9397976555722424, 'auprc': 0.9234005888859018, 'loss_val': 0.3224110188879109, 'psi': 0.9332388288977063}-{'f1_val': 0.9468408006509983, 'auprc': 0.9344241264447639, 'loss_val': 0.3101413330686998, 'psi': 0.9418741309685045}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.831277 cos_to_last_merge=0.7333 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.733
[S5] round=49 local utility u=0.008438 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9971379846265149, 'loss_val': 0.024165416648621308, 'psi': 0.9968763749376806}-{'f1_val': 0.9967019684784577, 'auprc': 0.9924930888602885, 'loss_val': 0.02710695574126951, 'psi': 0.99501841663119}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=49 head_norm_before_train=1.772853 cos_to_last_merge=0.9853 (last merge round=40)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8436565255175554, 'auprc': 0.9782191063556546, 'loss_val': 0.3507674100479726, 'psi': 0.897481557852795}-{'f1_val': 0.9098973944637497, 'auprc': 0.9847041862667236, 'loss_val': 0.18935953467258113, 'psi': 0.9398201111849394}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=2.063400 cos_to_last_merge=0.9987 (last merge round=35)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.9627063155552902, 'auprc': 0.9815942985707606, 'loss_val': 0.22810182181271368, 'psi': 0.9702615087614783}-{'f1_val': 0.6705940596341022, 'auprc': 0.8124998244977037, 'loss_val': 0.43461944491220567, 'psi': 0.7273563655795429}
[S7] not sending this round → trigger blocked (psi=0.970)
[S8] START round=49 head_norm_before_train=1.431030 cos_to_last_merge=0.9958 (last merge round=40)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.8818645136264596, 'auprc': 0.9981346645563633, 'loss_val': 0.15475887795266952, 'psi': 0.928372573998421}-{'f1_val': 0.9925712794554754, 'auprc': 0.998630815884197, 'loss_val': 0.07691219870960302, 'psi': 0.9949950940269641}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.249389 (no previous merge yet)
[S9] round=49 local utility u=0.005500 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999597529764139, 'loss_val': 0.015512605044104875, 'psi': 0.9982456486978513}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999621012990936, 'loss_val': 0.018863450200486034, 'psi': 0.9974808715381487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=2.130852 (no previous merge yet)
[S10] round=49 local utility u=0.000101 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956690236192788, 'loss_val': 0.026169842303940143, 'psi': 0.9952485213667572}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956683973329102, 'loss_val': 0.026369091222316628, 'psi': 0.9952482708522098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=49 head_norm_before_train=1.617472 cos_to_last_merge=0.9703 (last merge round=39)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.84303136756367, 'auprc': 0.9944339880946627, 'loss_val': 0.19402214636167214, 'psi': 0.9035924157760671}-{'f1_val': 0.9958918378685807, 'auprc': 0.9966204776910135, 'loss_val': 0.049809831852130546, 'psi': 0.9961832937975539}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.744945 cos_to_last_merge=0.9881 (last merge round=35)
[S13] round=49 local utility u=0.144896 metrics={'f1_val': 0.6334351698299435, 'auprc': 0.7510722903065719, 'loss_val': 0.8860805703724346, 'psi': 0.6804900180205948}-{'f1_val': 0.6364690304937308, 'auprc': 0.6531973447117476, 'loss_val': 0.9004510728440253, 'psi': 0.6431603561809376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=49 head_norm_before_train=1.893725 cos_to_last_merge=0.8165 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.817
[S14] round=49 local utility u=0.013140 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9986231083472316, 'loss_val': 0.020083768735255945, 'psi': 0.9978810003276415}-{'f1_val': 0.9942741881921484, 'auprc': 0.998697194060682, 'loss_val': 0.027914130356587217, 'psi': 0.9960433905395618}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.462412 cos_to_last_merge=0.9617 (last merge round=33)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7002205306465094, 'auprc': 0.8666758710950705, 'loss_val': 0.5711093280568612, 'psi': 0.7668026668259338}-{'f1_val': 0.9525359662053048, 'auprc': 0.9911419716822432, 'loss_val': 0.15137534356939975, 'psi': 0.9679783683960801}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.055936 cos_to_last_merge=0.9995 (last merge round=41)
[S16] round=49 local utility u=0.749019 metrics={'f1_val': 0.9931627703103687, 'auprc': 0.9968400990390124, 'loss_val': 0.03595935123499176, 'psi': 0.9946337018018262}-{'f1_val': 0.8854774838189583, 'auprc': 0.9113902379583914, 'loss_val': 0.6315357836004919, 'psi': 0.8958425854747316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=49 head_norm_before_train=1.762664 cos_to_last_merge=0.9961 (last merge round=39)
[S17] round=49 local utility u=0.337996 metrics={'f1_val': 0.6733607390303123, 'auprc': 0.9032271122457731, 'loss_val': 0.8150196981964395, 'psi': 0.7653072883164966}-{'f1_val': 0.621798355009322, 'auprc': 0.8811578409516883, 'loss_val': 1.1154296125096292, 'psi': 0.7255421493862686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=50 head_norm_before_train=2.038846 (no previous merge yet)
[S2] round=50 local utility u=0.052841 metrics={'f1_val': 0.7790747098146646, 'auprc': 0.7997123123576635, 'loss_val': 0.5710655358831424, 'psi': 0.7873297508318642}-{'f1_val': 0.7806194036324274, 'auprc': 0.7552457728431444, 'loss_val': 0.5526153897576451, 'psi': 0.7704699513167141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=50 head_norm_before_train=2.046992 cos_to_last_merge=0.9817 (last merge round=37)
[S3] round=50 local utility u=0.134330 metrics={'f1_val': 0.9957042260369158, 'auprc': 0.9986025591203282, 'loss_val': 0.019111728952165997, 'psi': 0.9968635592702808}-{'f1_val': 0.961498813606586, 'auprc': 0.9985212681756679, 'loss_val': 0.08229541020355677, 'psi': 0.9763077954342188}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=50 head_norm_before_train=1.959919 (no previous merge yet)
[S4] round=50 local utility u=0.058198 metrics={'f1_val': 0.9480024015720299, 'auprc': 0.9415849669212035, 'loss_val': 0.3097974662141436, 'psi': 0.9454354277116994}-{'f1_val': 0.9397976555722424, 'auprc': 0.9234005888859018, 'loss_val': 0.3224110188879109, 'psi': 0.9332388288977063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=50 head_norm_before_train=1.844568 cos_to_last_merge=0.7316 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.732
[S5] round=50 local utility u=0.004181 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990687958416212, 'loss_val': 0.0238020457028039, 'psi': 0.9978692535032871}-{'f1_val': 0.9967019684784577, 'auprc': 0.9971379846265149, 'loss_val': 0.024165416648621308, 'psi': 0.9968763749376806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=50 head_norm_before_train=1.789177 cos_to_last_merge=0.9838 (last merge round=40)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.6027111271316165, 'auprc': 0.9358003305157445, 'loss_val': 0.8389265994836997, 'psi': 0.7359468084852677}-{'f1_val': 0.8436565255175554, 'auprc': 0.9782191063556546, 'loss_val': 0.3507674100479726, 'psi': 0.897481557852795}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=2.068941 cos_to_last_merge=0.9986 (last merge round=35)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.9041907464731036, 'auprc': 0.9836845656398276, 'loss_val': 0.19945423115209693, 'psi': 0.9359882741397932}-{'f1_val': 0.9627063155552902, 'auprc': 0.9815942985707606, 'loss_val': 0.22810182181271368, 'psi': 0.9702615087614783}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.442321 cos_to_last_merge=0.9952 (last merge round=40)
[S8] round=50 local utility u=0.378817 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9988022797557043, 'loss_val': 0.07327569693612093, 'psi': 0.9960544940735042}-{'f1_val': 0.8818645136264596, 'auprc': 0.9981346645563633, 'loss_val': 0.15475887795266952, 'psi': 0.928372573998421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=50 head_norm_before_train=2.256497 (no previous merge yet)
[S9] round=50 local utility u=0.000003 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999323807025888, 'loss_val': 0.015424696078790483, 'psi': 0.9982346997883212}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999597529764139, 'loss_val': 0.015512605044104875, 'psi': 0.9982456486978513}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=50 head_norm_before_train=2.136962 (no previous merge yet)
[S10] round=50 local utility u=0.000081 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956682445060303, 'loss_val': 0.026005710237589092, 'psi': 0.9952482097214579}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956690236192788, 'loss_val': 0.026169842303940143, 'psi': 0.9952485213667572}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=50 head_norm_before_train=1.635801 cos_to_last_merge=0.9683 (last merge round=39)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.8435621813467377, 'auprc': 0.9940586399690372, 'loss_val': 0.20733676016001823, 'psi': 0.9037607647956574}-{'f1_val': 0.84303136756367, 'auprc': 0.9944339880946627, 'loss_val': 0.19402214636167214, 'psi': 0.9035924157760671}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.752974 cos_to_last_merge=0.9874 (last merge round=35)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6113161838369193, 'auprc': 0.6129818647588758, 'loss_val': 1.108004650536057, 'psi': 0.6119824562057019}-{'f1_val': 0.6334351698299435, 'auprc': 0.7510722903065719, 'loss_val': 0.8860805703724346, 'psi': 0.6804900180205948}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.900323 cos_to_last_merge=0.8159 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.816
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9828574781871016, 'auprc': 0.9986946013658278, 'loss_val': 0.05326607470307074, 'psi': 0.9891923274585921}-{'f1_val': 0.9973862616479148, 'auprc': 0.9986231083472316, 'loss_val': 0.020083768735255945, 'psi': 0.9978810003276415}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.479106 cos_to_last_merge=0.9600 (last merge round=33)
[S15] round=50 local utility u=0.724323 metrics={'f1_val': 0.8300206796339786, 'auprc': 0.9902948052701065, 'loss_val': 0.2721219005866598, 'psi': 0.8941303298884298}-{'f1_val': 0.7002205306465094, 'auprc': 0.8666758710950705, 'loss_val': 0.5711093280568612, 'psi': 0.7668026668259338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=50 head_norm_before_train=2.062865 cos_to_last_merge=0.9995 (last merge round=41)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9860059137490073, 'auprc': 0.9895142739685463, 'loss_val': 0.06954482227346452, 'psi': 0.9874092578368229}-{'f1_val': 0.9931627703103687, 'auprc': 0.9968400990390124, 'loss_val': 0.03595935123499176, 'psi': 0.9946337018018262}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.776854 cos_to_last_merge=0.9955 (last merge round=39)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.37408308482869257, 'auprc': 0.7027673876125967, 'loss_val': 1.8587827253004365, 'psi': 0.5055568059422542}-{'f1_val': 0.6733607390303123, 'auprc': 0.9032271122457731, 'loss_val': 0.8150196981964395, 'psi': 0.7653072883164966}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=2.043028 (no previous merge yet)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.6024006375107614, 'auprc': 0.7426021812680649, 'loss_val': 0.9107161641372957, 'psi': 0.6584812550136828}-{'f1_val': 0.7790747098146646, 'auprc': 0.7997123123576635, 'loss_val': 0.5710655358831424, 'psi': 0.7873297508318642}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=2.063053 cos_to_last_merge=0.9810 (last merge round=37)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9981511631380429, 'loss_val': 0.1535239887568786, 'psi': 0.9756030496765926}-{'f1_val': 0.9957042260369158, 'auprc': 0.9986025591203282, 'loss_val': 0.019111728952165997, 'psi': 0.9968635592702808}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.959858 (no previous merge yet)
[S4] round=51 local utility u=0.068934 metrics={'f1_val': 0.957178744056262, 'auprc': 0.9629228440533715, 'loss_val': 0.2910001852619404, 'psi': 0.9594763840551058}-{'f1_val': 0.9480024015720299, 'auprc': 0.9415849669212035, 'loss_val': 0.3097974662141436, 'psi': 0.9454354277116994}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=51 head_norm_before_train=1.851304 cos_to_last_merge=0.7307 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.731
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9927530421179225, 'loss_val': 0.02571431976800856, 'psi': 0.9951223979342436}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990687958416212, 'loss_val': 0.0238020457028039, 'psi': 0.9978692535032871}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.805575 cos_to_last_merge=0.9823 (last merge round=40)
[S6] round=51 local utility u=0.330423 metrics={'f1_val': 0.6665737069647389, 'auprc': 0.9562146867048266, 'loss_val': 0.6224990342628245, 'psi': 0.782430098860774}-{'f1_val': 0.6027111271316165, 'auprc': 0.9358003305157445, 'loss_val': 0.8389265994836997, 'psi': 0.7359468084852677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=51 head_norm_before_train=2.073997 cos_to_last_merge=0.9985 (last merge round=35)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6842746791494767, 'auprc': 0.7947791647194371, 'loss_val': 0.5321190025378769, 'psi': 0.7284764733774609}-{'f1_val': 0.9041907464731036, 'auprc': 0.9836845656398276, 'loss_val': 0.19945423115209693, 'psi': 0.9359882741397932}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.453531 cos_to_last_merge=0.9945 (last merge round=40)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.991479862271931, 'auprc': 0.9987439473630646, 'loss_val': 0.0629036021762275, 'psi': 0.9943854963083845}-{'f1_val': 0.9942226369520374, 'auprc': 0.9988022797557043, 'loss_val': 0.07327569693612093, 'psi': 0.9960544940735042}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.262907 (no previous merge yet)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.999876765620701, 'loss_val': 0.026785224713986578, 'psi': 0.9949500624104165}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999323807025888, 'loss_val': 0.015424696078790483, 'psi': 0.9982346997883212}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=2.138707 (no previous merge yet)
[S10] round=51 local utility u=0.000660 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956638001162655, 'loss_val': 0.025989387824557217, 'psi': 0.995378223458131}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956682445060303, 'loss_val': 0.026005710237589092, 'psi': 0.9952482097214579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=51 head_norm_before_train=1.652783 cos_to_last_merge=0.9665 (last merge round=39)
[S11] round=51 local utility u=0.433446 metrics={'f1_val': 0.9680283356170927, 'auprc': 0.9959679723950972, 'loss_val': 0.09297050916883048, 'psi': 0.9792041903282944}-{'f1_val': 0.8435621813467377, 'auprc': 0.9940586399690372, 'loss_val': 0.20733676016001823, 'psi': 0.9037607647956574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=51 head_norm_before_train=1.760048 cos_to_last_merge=0.9868 (last merge round=35)
[S13] round=51 local utility u=0.484735 metrics={'f1_val': 0.6392908193729766, 'auprc': 0.7944033381062716, 'loss_val': 0.8506459911826937, 'psi': 0.7013358268662946}-{'f1_val': 0.6113161838369193, 'auprc': 0.6129818647588758, 'loss_val': 1.108004650536057, 'psi': 0.6119824562057019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=51 head_norm_before_train=1.906988 cos_to_last_merge=0.8154 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.815
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9732574434027439, 'auprc': 0.9986922317729351, 'loss_val': 0.08446007793282315, 'psi': 0.9834313587508204}-{'f1_val': 0.9828574781871016, 'auprc': 0.9986946013658278, 'loss_val': 0.05326607470307074, 'psi': 0.9891923274585921}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.493564 cos_to_last_merge=0.9584 (last merge round=33)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.6959859567396673, 'auprc': 0.9557174507101585, 'loss_val': 0.5609633581641277, 'psi': 0.7998785543278637}-{'f1_val': 0.8300206796339786, 'auprc': 0.9902948052701065, 'loss_val': 0.2721219005866598, 'psi': 0.8941303298884298}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.070651 cos_to_last_merge=0.9994 (last merge round=41)
[S16] round=51 local utility u=0.044271 metrics={'f1_val': 0.9933656181690333, 'auprc': 0.992816575272793, 'loss_val': 0.035067283841631304, 'psi': 0.9931460010105372}-{'f1_val': 0.9860059137490073, 'auprc': 0.9895142739685463, 'loss_val': 0.06954482227346452, 'psi': 0.9874092578368229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=51 head_norm_before_train=1.789191 cos_to_last_merge=0.9947 (last merge round=39)
[S17] round=51 local utility u=1.000000 metrics={'f1_val': 0.7004403037310274, 'auprc': 0.9023187384596726, 'loss_val': 0.7824665930915612, 'psi': 0.7811916776224854}-{'f1_val': 0.37408308482869257, 'auprc': 0.7027673876125967, 'loss_val': 1.8587827253004365, 'psi': 0.5055568059422542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=52 head_norm_before_train=2.048753 (no previous merge yet)
[S2] round=52 local utility u=1.000000 metrics={'f1_val': 0.8217291217404586, 'auprc': 0.9517241500769436, 'loss_val': 0.4872324497855599, 'psi': 0.8737271330750526}-{'f1_val': 0.6024006375107614, 'auprc': 0.7426021812680649, 'loss_val': 0.9107161641372957, 'psi': 0.6584812550136828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=52 head_norm_before_train=2.077407 cos_to_last_merge=0.9804 (last merge round=37)
[S3] round=52 local utility u=0.179324 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9988250974466244, 'loss_val': 0.017690659543016095, 'psi': 0.9979518575737021}-{'f1_val': 0.9605709740356257, 'auprc': 0.9981511631380429, 'loss_val': 0.1535239887568786, 'psi': 0.9756030496765926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=52 head_norm_before_train=1.960224 (no previous merge yet)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9497985034462343, 'auprc': 0.9419861824354825, 'loss_val': 0.30462285345481466, 'psi': 0.9466735750419335}-{'f1_val': 0.957178744056262, 'auprc': 0.9629228440533715, 'loss_val': 0.2910001852619404, 'psi': 0.9594763840551058}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.855615 cos_to_last_merge=0.7300 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.730
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9920595910485165, 'loss_val': 0.026668136552323224, 'psi': 0.9948450175064811}-{'f1_val': 0.9967019684784577, 'auprc': 0.9927530421179225, 'loss_val': 0.02571431976800856, 'psi': 0.9951223979342436}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.816948 cos_to_last_merge=0.9811 (last merge round=40)
[S6] round=52 local utility u=0.068542 metrics={'f1_val': 0.642620435320817, 'auprc': 0.9713500474288653, 'loss_val': 0.38710064893891005, 'psi': 0.7741122801640363}-{'f1_val': 0.6665737069647389, 'auprc': 0.9562146867048266, 'loss_val': 0.6224990342628245, 'psi': 0.782430098860774}
[S6] not sending this round → trigger blocked (psi=0.774)
[S7] START round=52 head_norm_before_train=2.078230 cos_to_last_merge=0.9983 (last merge round=35)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6056203701174185, 'auprc': 0.7774398651079114, 'loss_val': 0.8846180594623293, 'psi': 0.6743481681136156}-{'f1_val': 0.6842746791494767, 'auprc': 0.7947791647194371, 'loss_val': 0.5321190025378769, 'psi': 0.7284764733774609}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.466872 cos_to_last_merge=0.9939 (last merge round=40)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9888526342761694, 'auprc': 0.9989255838247174, 'loss_val': 0.060816630064667, 'psi': 0.9928818140955886}-{'f1_val': 0.991479862271931, 'auprc': 0.9987439473630646, 'loss_val': 0.0629036021762275, 'psi': 0.9943854963083845}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=2.272448 (no previous merge yet)
[S9] round=52 local utility u=0.011881 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947736200451447, 'loss_val': 0.01787445307582321, 'psi': 0.9959249427769152}-{'f1_val': 0.9916655936035601, 'auprc': 0.999876765620701, 'loss_val': 0.026785224713986578, 'psi': 0.9949500624104165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=52 head_norm_before_train=2.142414 (no previous merge yet)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956550628166372, 'loss_val': 0.02600252621942243, 'psi': 0.9953747285382797}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956638001162655, 'loss_val': 0.025989387824557217, 'psi': 0.995378223458131}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.667617 cos_to_last_merge=0.9650 (last merge round=39)
[S11] round=52 local utility u=0.116045 metrics={'f1_val': 0.9958445741966941, 'auprc': 0.9972208651408265, 'loss_val': 0.031537395264478726, 'psi': 0.996395090574347}-{'f1_val': 0.9680283356170927, 'auprc': 0.9959679723950972, 'loss_val': 0.09297050916883048, 'psi': 0.9792041903282944}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=52 head_norm_before_train=1.767072 cos_to_last_merge=0.9862 (last merge round=35)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6224846962148645, 'auprc': 0.7126732937523804, 'loss_val': 0.9894530705343971, 'psi': 0.6585601352298709}-{'f1_val': 0.6392908193729766, 'auprc': 0.7944033381062716, 'loss_val': 0.8506459911826937, 'psi': 0.7013358268662946}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.915411 cos_to_last_merge=0.8148 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.815
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9298292257908326, 'auprc': 0.9985717744920548, 'loss_val': 0.18506544824925258, 'psi': 0.9573262452713214}-{'f1_val': 0.9732574434027439, 'auprc': 0.9986922317729351, 'loss_val': 0.08446007793282315, 'psi': 0.9834313587508204}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.506573 cos_to_last_merge=0.9570 (last merge round=33)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.7017590021673288, 'auprc': 0.9459244557050233, 'loss_val': 0.5678294151061465, 'psi': 0.7994251835824067}-{'f1_val': 0.6959859567396673, 'auprc': 0.9557174507101585, 'loss_val': 0.5609633581641277, 'psi': 0.7998785543278637}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=52 head_norm_before_train=2.077070 cos_to_last_merge=0.9993 (last merge round=41)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9433010676511769, 'auprc': 0.9868695289635607, 'loss_val': 0.2355094065710494, 'psi': 0.9607284521761306}-{'f1_val': 0.9933656181690333, 'auprc': 0.992816575272793, 'loss_val': 0.035067283841631304, 'psi': 0.9931460010105372}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.802856 cos_to_last_merge=0.9940 (last merge round=39)
[S17] round=52 local utility u=0.858520 metrics={'f1_val': 0.9061660042378933, 'auprc': 0.9569451489120774, 'loss_val': 0.46365902753846, 'psi': 0.926477662107567}-{'f1_val': 0.7004403037310274, 'auprc': 0.9023187384596726, 'loss_val': 0.7824665930915612, 'psi': 0.7811916776224854}
[S17] not sending this round → trigger blocked (psi=0.926)
[S2] START round=53 head_norm_before_train=2.052416 (no previous merge yet)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.7199002811534515, 'auprc': 0.7511668231849467, 'loss_val': 0.7680567171405104, 'psi': 0.7324068979660496}-{'f1_val': 0.8217291217404586, 'auprc': 0.9517241500769436, 'loss_val': 0.4872324497855599, 'psi': 0.8737271330750526}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.093147 cos_to_last_merge=0.9797 (last merge round=37)
[S3] round=53 local utility u=0.001940 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.99884045570633, 'loss_val': 0.016326874510523663, 'psi': 0.9982050801094906}-{'f1_val': 0.9973696976584205, 'auprc': 0.9988250974466244, 'loss_val': 0.017690659543016095, 'psi': 0.9979518575737021}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=53 head_norm_before_train=1.960778 (no previous merge yet)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9386414717375062, 'auprc': 0.9235794997149928, 'loss_val': 0.3260186218824211, 'psi': 0.9326166829285008}-{'f1_val': 0.9497985034462343, 'auprc': 0.9419861824354825, 'loss_val': 0.30462285345481466, 'psi': 0.9466735750419335}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.861507 cos_to_last_merge=0.7293 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.729
[S5] round=53 local utility u=0.001345 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9991512798244008, 'loss_val': 0.049660367986394935, 'psi': 0.9981224626413556}-{'f1_val': 0.9967019684784577, 'auprc': 0.9920595910485165, 'loss_val': 0.026668136552323224, 'psi': 0.9948450175064811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=53 head_norm_before_train=1.825405 cos_to_last_merge=0.9803 (last merge round=40)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.6174563433542138, 'auprc': 0.9259651952484075, 'loss_val': 0.9803549167530877, 'psi': 0.7408598841118913}-{'f1_val': 0.642620435320817, 'auprc': 0.9713500474288653, 'loss_val': 0.38710064893891005, 'psi': 0.7741122801640363}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=2.079160 cos_to_last_merge=0.9982 (last merge round=35)
[S7] round=53 local utility u=0.011377 metrics={'f1_val': 0.6064980446438035, 'auprc': 0.7786714372670532, 'loss_val': 0.8708249248772818, 'psi': 0.6753674016931035}-{'f1_val': 0.6056203701174185, 'auprc': 0.7774398651079114, 'loss_val': 0.8846180594623293, 'psi': 0.6743481681136156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=53 head_norm_before_train=1.481564 cos_to_last_merge=0.9931 (last merge round=40)
[S8] round=53 local utility u=0.013678 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9990437728156341, 'loss_val': 0.05505286732336302, 'psi': 0.9950528654139321}-{'f1_val': 0.9888526342761694, 'auprc': 0.9989255838247174, 'loss_val': 0.060816630064667, 'psi': 0.9928818140955886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=53 head_norm_before_train=2.275864 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9926462894722031, 'auprc': 0.9999672934080122, 'loss_val': 0.02516782817752797, 'psi': 0.9955746910465267}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947736200451447, 'loss_val': 0.01787445307582321, 'psi': 0.9959249427769152}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.147859 (no previous merge yet)
[S10] round=53 local utility u=0.000099 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956651648385619, 'loss_val': 0.025835585166751485, 'psi': 0.9953787693470496}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956550628166372, 'loss_val': 0.02600252621942243, 'psi': 0.9953747285382797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=53 head_norm_before_train=1.682631 cos_to_last_merge=0.9634 (last merge round=39)
[S11] round=53 local utility u=0.003836 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976495544552104, 'loss_val': 0.029365708420396232, 'psi': 0.9969880244902379}-{'f1_val': 0.9958445741966941, 'auprc': 0.9972208651408265, 'loss_val': 0.031537395264478726, 'psi': 0.996395090574347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=53 head_norm_before_train=1.770999 cos_to_last_merge=0.9858 (last merge round=35)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6203966063365137, 'auprc': 0.6117290964465585, 'loss_val': 1.1543494542372588, 'psi': 0.6169296023805316}-{'f1_val': 0.6224846962148645, 'auprc': 0.7126732937523804, 'loss_val': 0.9894530705343971, 'psi': 0.6585601352298709}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.922229 cos_to_last_merge=0.8142 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.814
[S14] round=53 local utility u=0.285250 metrics={'f1_val': 0.9975773038923221, 'auprc': 0.9990170833081455, 'loss_val': 0.022389358279168648, 'psi': 0.9981532156586514}-{'f1_val': 0.9298292257908326, 'auprc': 0.9985717744920548, 'loss_val': 0.18506544824925258, 'psi': 0.9573262452713214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=53 head_norm_before_train=1.519853 cos_to_last_merge=0.9556 (last merge round=33)
[S15] round=53 local utility u=1.000000 metrics={'f1_val': 0.9956284014057536, 'auprc': 0.991646673249206, 'loss_val': 0.04263655840769715, 'psi': 0.9940357101431345}-{'f1_val': 0.7017590021673288, 'auprc': 0.9459244557050233, 'loss_val': 0.5678294151061465, 'psi': 0.7994251835824067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=53 head_norm_before_train=2.080574 cos_to_last_merge=0.9991 (last merge round=41)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8952613993928505, 'auprc': 0.889949197735665, 'loss_val': 0.5855484514285824, 'psi': 0.8931365187299762}-{'f1_val': 0.9433010676511769, 'auprc': 0.9868695289635607, 'loss_val': 0.2355094065710494, 'psi': 0.9607284521761306}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.815813 cos_to_last_merge=0.9934 (last merge round=39)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.4711054423058411, 'auprc': 0.6875110125896848, 'loss_val': 1.6083473660414709, 'psi': 0.5576676704193786}-{'f1_val': 0.9061660042378933, 'auprc': 0.9569451489120774, 'loss_val': 0.46365902753846, 'psi': 0.926477662107567}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=2.051484 (no previous merge yet)
[S2] round=54 local utility u=0.408086 metrics={'f1_val': 0.8017671560222185, 'auprc': 0.7749107608449438, 'loss_val': 0.514318153421522, 'psi': 0.7910245979513086}-{'f1_val': 0.7199002811534515, 'auprc': 0.7511668231849467, 'loss_val': 0.7680567171405104, 'psi': 0.7324068979660496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=54 head_norm_before_train=2.108657 cos_to_last_merge=0.9789 (last merge round=37)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9934987433845879, 'loss_val': 0.16189741664167384, 'psi': 0.9740445485935074}-{'f1_val': 0.9977814963782642, 'auprc': 0.99884045570633, 'loss_val': 0.016326874510523663, 'psi': 0.9982050801094906}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.961303 (no previous merge yet)
[S4] round=54 local utility u=0.020087 metrics={'f1_val': 0.9408824235104565, 'auprc': 0.9304403361583378, 'loss_val': 0.31987319003820663, 'psi': 0.936705588569609}-{'f1_val': 0.9386414717375062, 'auprc': 0.9235794997149928, 'loss_val': 0.3260186218824211, 'psi': 0.9326166829285008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=54 head_norm_before_train=1.868153 cos_to_last_merge=0.7284 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.728
[S5] round=54 local utility u=0.009607 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984309886153395, 'loss_val': 0.02387789343387289, 'psi': 0.9973935765332105}-{'f1_val': 0.9974365845193254, 'auprc': 0.9991512798244008, 'loss_val': 0.049660367986394935, 'psi': 0.9981224626413556}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=54 head_norm_before_train=1.831746 cos_to_last_merge=0.9799 (last merge round=40)
[S6] round=54 local utility u=0.992365 metrics={'f1_val': 0.8445544171528471, 'auprc': 0.9626568218099878, 'loss_val': 0.4682875789785136, 'psi': 0.8917953790157034}-{'f1_val': 0.6174563433542138, 'auprc': 0.9259651952484075, 'loss_val': 0.9803549167530877, 'psi': 0.7408598841118913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=54 head_norm_before_train=2.083635 cos_to_last_merge=0.9981 (last merge round=35)
[S7] round=54 local utility u=0.195313 metrics={'f1_val': 0.6311398750711051, 'auprc': 0.7936685434294137, 'loss_val': 0.6730406219208083, 'psi': 0.6961513424144286}-{'f1_val': 0.6064980446438035, 'auprc': 0.7786714372670532, 'loss_val': 0.8708249248772818, 'psi': 0.6753674016931035}
[S7] not sending this round → trigger blocked (psi=0.696)
[S8] START round=54 head_norm_before_train=1.494547 cos_to_last_merge=0.9923 (last merge round=40)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9909378708519977, 'auprc': 0.9989174128898737, 'loss_val': 0.05105449927736141, 'psi': 0.994129687667148}-{'f1_val': 0.992392260479464, 'auprc': 0.9990437728156341, 'loss_val': 0.05505286732336302, 'psi': 0.9950528654139321}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.274192 (no previous merge yet)
[S9] round=54 local utility u=0.017760 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999638729587137, 'loss_val': 0.016377023203603087, 'psi': 0.9982472966907712}-{'f1_val': 0.9926462894722031, 'auprc': 0.9999672934080122, 'loss_val': 0.02516782817752797, 'psi': 0.9955746910465267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=54 head_norm_before_train=2.154124 (no previous merge yet)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956639710083817, 'loss_val': 0.02577036453413104, 'psi': 0.9951147539349762}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956651648385619, 'loss_val': 0.025835585166751485, 'psi': 0.9953787693470496}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.697522 cos_to_last_merge=0.9619 (last merge round=39)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9971366935387229, 'loss_val': 0.028197280193711028, 'psi': 0.9967951597992174}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976495544552104, 'loss_val': 0.029365708420396232, 'psi': 0.9969880244902379}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.772544 cos_to_last_merge=0.9855 (last merge round=35)
[S13] round=54 local utility u=0.487191 metrics={'f1_val': 0.676634340071931, 'auprc': 0.7129698062344085, 'loss_val': 0.8211151100233411, 'psi': 0.6911685265369221}-{'f1_val': 0.6203966063365137, 'auprc': 0.6117290964465585, 'loss_val': 1.1543494542372588, 'psi': 0.6169296023805316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=54 head_norm_before_train=1.924843 cos_to_last_merge=0.8137 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.814
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9878223169528347, 'auprc': 0.9986538067155334, 'loss_val': 0.04775453441552266, 'psi': 0.9921549128579142}-{'f1_val': 0.9975773038923221, 'auprc': 0.9990170833081455, 'loss_val': 0.022389358279168648, 'psi': 0.9981532156586514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.529734 cos_to_last_merge=0.9546 (last merge round=33)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.7002205306465094, 'auprc': 0.9274224771936891, 'loss_val': 0.5907488710827266, 'psi': 0.7911013092653812}-{'f1_val': 0.9956284014057536, 'auprc': 0.991646673249206, 'loss_val': 0.04263655840769715, 'psi': 0.9940357101431345}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=2.084680 cos_to_last_merge=0.9989 (last merge round=41)
[S16] round=54 local utility u=0.722830 metrics={'f1_val': 0.9933656181690333, 'auprc': 0.9923413296577419, 'loss_val': 0.03569023029288361, 'psi': 0.9929559027645167}-{'f1_val': 0.8952613993928505, 'auprc': 0.889949197735665, 'loss_val': 0.5855484514285824, 'psi': 0.8931365187299762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=54 head_norm_before_train=1.825115 cos_to_last_merge=0.9929 (last merge round=39)
[S17] round=54 local utility u=1.000000 metrics={'f1_val': 0.6459189837567704, 'auprc': 0.8852460773237782, 'loss_val': 0.9564923510273212, 'psi': 0.7416498211835736}-{'f1_val': 0.4711054423058411, 'auprc': 0.6875110125896848, 'loss_val': 1.6083473660414709, 'psi': 0.5576676704193786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=55 head_norm_before_train=2.053577 (no previous merge yet)
[S2] round=55 local utility u=0.185409 metrics={'f1_val': 0.8320388603714196, 'auprc': 0.8131919447463134, 'loss_val': 0.4399749096553657, 'psi': 0.8245000941213771}-{'f1_val': 0.8017671560222185, 'auprc': 0.7749107608449438, 'loss_val': 0.514318153421522, 'psi': 0.7910245979513086}
[S2] not sending this round → trigger blocked (psi=0.825)
[S3] START round=55 head_norm_before_train=2.116739 cos_to_last_merge=0.9786 (last merge round=37)
[S3] round=55 local utility u=0.183277 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9991108130630094, 'loss_val': 0.03098215272338693, 'psi': 0.9981695362041603}-{'f1_val': 0.9610750853994537, 'auprc': 0.9934987433845879, 'loss_val': 0.16189741664167384, 'psi': 0.9740445485935074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=55 head_norm_before_train=1.963717 (no previous merge yet)
[S4] round=55 local utility u=0.004888 metrics={'f1_val': 0.9414775806746425, 'auprc': 0.9321504774839258, 'loss_val': 0.31879893490348077, 'psi': 0.9377467393983558}-{'f1_val': 0.9408824235104565, 'auprc': 0.9304403361583378, 'loss_val': 0.31987319003820663, 'psi': 0.936705588569609}
[S4] not sending this round → trigger blocked (psi=0.938)
[S5] START round=55 head_norm_before_train=1.876516 cos_to_last_merge=0.7275 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.728
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9974389983671694, 'auprc': 0.9991624358857746, 'loss_val': 0.08922672698288113, 'psi': 0.9981283733746116}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984309886153395, 'loss_val': 0.02387789343387289, 'psi': 0.9973935765332105}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.838181 cos_to_last_merge=0.9794 (last merge round=40)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.6483484793069871, 'auprc': 0.9331842643321424, 'loss_val': 0.8040456163403193, 'psi': 0.7622827933170493}-{'f1_val': 0.8445544171528471, 'auprc': 0.9626568218099878, 'loss_val': 0.4682875789785136, 'psi': 0.8917953790157034}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=2.088967 cos_to_last_merge=0.9978 (last merge round=35)
[S7] round=55 local utility u=0.009161 metrics={'f1_val': 0.6346229535342526, 'auprc': 0.7956662336653324, 'loss_val': 0.6816095714805065, 'psi': 0.6990402655866845}-{'f1_val': 0.6311398750711051, 'auprc': 0.7936685434294137, 'loss_val': 0.6730406219208083, 'psi': 0.6961513424144286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=55 head_norm_before_train=1.506327 cos_to_last_merge=0.9916 (last merge round=40)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9877803895057649, 'auprc': 0.9987982486105038, 'loss_val': 0.05393256936476922, 'psi': 0.9921875331476604}-{'f1_val': 0.9909378708519977, 'auprc': 0.9989174128898737, 'loss_val': 0.05105449927736141, 'psi': 0.994129687667148}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.280106 (no previous merge yet)
[S9] round=55 local utility u=0.000445 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999366034779891, 'loss_val': 0.015405003813273683, 'psi': 0.9982363888984813}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999638729587137, 'loss_val': 0.016377023203603087, 'psi': 0.9982472966907712}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=55 head_norm_before_train=2.160732 (no previous merge yet)
[S10] round=55 local utility u=0.001354 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956693207276189, 'loss_val': 0.02571333294909103, 'psi': 0.9953804317026724}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956639710083817, 'loss_val': 0.02577036453413104, 'psi': 0.9951147539349762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=55 head_norm_before_train=1.711354 cos_to_last_merge=0.9604 (last merge round=39)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9946422000596432, 'auprc': 0.9971135478652999, 'loss_val': 0.032082329365931854, 'psi': 0.9956307391819059}-{'f1_val': 0.996567470639547, 'auprc': 0.9971366935387229, 'loss_val': 0.028197280193711028, 'psi': 0.9967951597992174}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.774001 cos_to_last_merge=0.9853 (last merge round=35)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6057989746308035, 'auprc': 0.5990892374500216, 'loss_val': 1.2414465771282825, 'psi': 0.6031150797584908}-{'f1_val': 0.676634340071931, 'auprc': 0.7129698062344085, 'loss_val': 0.8211151100233411, 'psi': 0.6911685265369221}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.928321 cos_to_last_merge=0.8133 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.813
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9469814973770474, 'auprc': 0.9986418940554636, 'loss_val': 0.14574674432413534, 'psi': 0.9676456560484139}-{'f1_val': 0.9878223169528347, 'auprc': 0.9986538067155334, 'loss_val': 0.04775453441552266, 'psi': 0.9921549128579142}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.535172 cos_to_last_merge=0.9539 (last merge round=33)
[S15] round=55 local utility u=0.790279 metrics={'f1_val': 0.918389153577493, 'auprc': 0.9687737419219725, 'loss_val': 0.44325635204411573, 'psi': 0.9385429889152848}-{'f1_val': 0.7002205306465094, 'auprc': 0.9274224771936891, 'loss_val': 0.5907488710827266, 'psi': 0.7911013092653812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=55 head_norm_before_train=2.089204 cos_to_last_merge=0.9988 (last merge round=41)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9913700028026304, 'auprc': 0.9926140354720798, 'loss_val': 0.048500917961136716, 'psi': 0.9918676158704103}-{'f1_val': 0.9933656181690333, 'auprc': 0.9923413296577419, 'loss_val': 0.03569023029288361, 'psi': 0.9929559027645167}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.833619 cos_to_last_merge=0.9925 (last merge round=39)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.41025585219967253, 'auprc': 0.7461381784327239, 'loss_val': 1.8840473603435408, 'psi': 0.5446087826928931}-{'f1_val': 0.6459189837567704, 'auprc': 0.8852460773237782, 'loss_val': 0.9564923510273212, 'psi': 0.7416498211835736}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=2.059979 (no previous merge yet)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.8283137648185168, 'auprc': 0.7523201554163061, 'loss_val': 0.444886686354778, 'psi': 0.7979163210576325}-{'f1_val': 0.8320388603714196, 'auprc': 0.8131919447463134, 'loss_val': 0.4399749096553657, 'psi': 0.8245000941213771}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.128836 cos_to_last_merge=0.9780 (last merge round=37)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9902806705241795, 'auprc': 0.9988383134998443, 'loss_val': 0.049775880143521564, 'psi': 0.9937037277144454}-{'f1_val': 0.997542018298261, 'auprc': 0.9991108130630094, 'loss_val': 0.03098215272338693, 'psi': 0.9981695362041603}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.967981 (no previous merge yet)
[S4] round=56 local utility u=0.010334 metrics={'f1_val': 0.9425076798568817, 'auprc': 0.9362514096060124, 'loss_val': 0.31661424394772014, 'psi': 0.9400051717565339}-{'f1_val': 0.9414775806746425, 'auprc': 0.9321504774839258, 'loss_val': 0.31879893490348077, 'psi': 0.9377467393983558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=56 head_norm_before_train=1.877482 cos_to_last_merge=0.7268 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9053935974670348, 'auprc': 0.9795084432654149, 'loss_val': 0.2197648658970834, 'psi': 0.9350395357863869}-{'f1_val': 0.9974389983671694, 'auprc': 0.9991624358857746, 'loss_val': 0.08922672698288113, 'psi': 0.9981283733746116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.844574 cos_to_last_merge=0.9788 (last merge round=40)
[S6] round=56 local utility u=0.664083 metrics={'f1_val': 0.79527494179895, 'auprc': 0.9599104909824803, 'loss_val': 0.43761771435976754, 'psi': 0.8611291614723621}-{'f1_val': 0.6483484793069871, 'auprc': 0.9331842643321424, 'loss_val': 0.8040456163403193, 'psi': 0.7622827933170493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=56 head_norm_before_train=2.094918 cos_to_last_merge=0.9976 (last merge round=35)
[S7] round=56 local utility u=0.054074 metrics={'f1_val': 0.6284536720684719, 'auprc': 0.80445049814727, 'loss_val': 0.5627986891668969, 'psi': 0.6988524024999911}-{'f1_val': 0.6346229535342526, 'auprc': 0.7956662336653324, 'loss_val': 0.6816095714805065, 'psi': 0.6990402655866845}
[S7] not sending this round → trigger blocked (psi=0.699)
[S8] START round=56 head_norm_before_train=1.518135 cos_to_last_merge=0.9910 (last merge round=40)
[S8] round=56 local utility u=0.018159 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9988779690055177, 'loss_val': 0.045524329381232354, 'psi': 0.9949865438898855}-{'f1_val': 0.9877803895057649, 'auprc': 0.9987982486105038, 'loss_val': 0.05393256936476922, 'psi': 0.9921875331476604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=56 head_norm_before_train=2.284973 (no previous merge yet)
[S9] round=56 local utility u=0.000078 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998823979776928, 'loss_val': 0.015069137867418652, 'psi': 0.9982129889146152}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999366034779891, 'loss_val': 0.015405003813273683, 'psi': 0.9982363888984813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=56 head_norm_before_train=2.161952 (no previous merge yet)
[S10] round=56 local utility u=0.000038 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956736273606533, 'loss_val': 0.025650589271079823, 'psi': 0.9953821543558862}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956693207276189, 'loss_val': 0.02571333294909103, 'psi': 0.9953804317026724}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=56 head_norm_before_train=1.723540 cos_to_last_merge=0.9592 (last merge round=39)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9946422000596432, 'auprc': 0.9970766284657704, 'loss_val': 0.03258338503565517, 'psi': 0.995615971422094}-{'f1_val': 0.9946422000596432, 'auprc': 0.9971135478652999, 'loss_val': 0.032082329365931854, 'psi': 0.9956307391819059}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.776648 cos_to_last_merge=0.9850 (last merge round=35)
[S13] round=56 local utility u=0.396004 metrics={'f1_val': 0.680660513118439, 'auprc': 0.6420622085330216, 'loss_val': 1.0275271298285418, 'psi': 0.665221191284272}-{'f1_val': 0.6057989746308035, 'auprc': 0.5990892374500216, 'loss_val': 1.2414465771282825, 'psi': 0.6031150797584908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=1.933592 cos_to_last_merge=0.8130 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.813
[S14] round=56 local utility u=0.209199 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9983516143860687, 'loss_val': 0.025272230512357295, 'psi': 0.9974089502587108}-{'f1_val': 0.9469814973770474, 'auprc': 0.9986418940554636, 'loss_val': 0.14574674432413534, 'psi': 0.9676456560484139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=56 head_norm_before_train=1.541989 cos_to_last_merge=0.9532 (last merge round=33)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.7593341739769766, 'auprc': 0.9720906500409144, 'loss_val': 0.48432801428982974, 'psi': 0.8444367644025517}-{'f1_val': 0.918389153577493, 'auprc': 0.9687737419219725, 'loss_val': 0.44325635204411573, 'psi': 0.9385429889152848}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=2.095380 cos_to_last_merge=0.9987 (last merge round=41)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8460818049020492, 'auprc': 0.8716245600112308, 'loss_val': 1.0897461390246315, 'psi': 0.8562989069457219}-{'f1_val': 0.9913700028026304, 'auprc': 0.9926140354720798, 'loss_val': 0.048500917961136716, 'psi': 0.9918676158704103}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.841393 cos_to_last_merge=0.9919 (last merge round=39)
[S17] round=56 local utility u=0.026189 metrics={'f1_val': 0.417684312734673, 'auprc': 0.7487944538610778, 'loss_val': 1.8842093471337344, 'psi': 0.550128369185235}-{'f1_val': 0.41025585219967253, 'auprc': 0.7461381784327239, 'loss_val': 1.8840473603435408, 'psi': 0.5446087826928931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=57 head_norm_before_train=2.067304 (no previous merge yet)
[S2] round=57 local utility u=0.105111 metrics={'f1_val': 0.8270748009366975, 'auprc': 0.8318956732695624, 'loss_val': 0.46595679827215264, 'psi': 0.8290031498698435}-{'f1_val': 0.8283137648185168, 'auprc': 0.7523201554163061, 'loss_val': 0.444886686354778, 'psi': 0.7979163210576325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=57 head_norm_before_train=2.142698 cos_to_last_merge=0.9774 (last merge round=37)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9107737987696327, 'auprc': 0.98812171664799, 'loss_val': 0.2548031950382075, 'psi': 0.9417129659209756}-{'f1_val': 0.9902806705241795, 'auprc': 0.9988383134998443, 'loss_val': 0.049775880143521564, 'psi': 0.9937037277144454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.974538 (no previous merge yet)
[S4] round=57 local utility u=0.042445 metrics={'f1_val': 0.9496341882408685, 'auprc': 0.9487417619612708, 'loss_val': 0.311955181115855, 'psi': 0.9492772177290295}-{'f1_val': 0.9425076798568817, 'auprc': 0.9362514096060124, 'loss_val': 0.31661424394772014, 'psi': 0.9400051717565339}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=57 head_norm_before_train=1.878372 cos_to_last_merge=0.7266 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=57 local utility u=0.394204 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9991399842895415, 'loss_val': 0.04030755953737223, 'psi': 0.9978977288824552}-{'f1_val': 0.9053935974670348, 'auprc': 0.9795084432654149, 'loss_val': 0.2197648658970834, 'psi': 0.9350395357863869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=57 head_norm_before_train=1.850684 cos_to_last_merge=0.9781 (last merge round=40)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.755479984289215, 'auprc': 0.9588077429825544, 'loss_val': 0.5809622019061103, 'psi': 0.8368110877665508}-{'f1_val': 0.79527494179895, 'auprc': 0.9599104909824803, 'loss_val': 0.43761771435976754, 'psi': 0.8611291614723621}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=2.104463 cos_to_last_merge=0.9973 (last merge round=35)
[S7] round=57 local utility u=0.205426 metrics={'f1_val': 0.6666592846482904, 'auprc': 0.8161747396010943, 'loss_val': 0.4163524741265751, 'psi': 0.7264654666294119}-{'f1_val': 0.6284536720684719, 'auprc': 0.80445049814727, 'loss_val': 0.5627986891668969, 'psi': 0.6988524024999911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=57 head_norm_before_train=1.531120 cos_to_last_merge=0.9903 (last merge round=40)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9868234720888559, 'auprc': 0.998938819494873, 'loss_val': 0.05128784076122812, 'psi': 0.9916696110512626}-{'f1_val': 0.992392260479464, 'auprc': 0.9988779690055177, 'loss_val': 0.045524329381232354, 'psi': 0.9949865438898855}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.289589 (no previous merge yet)
[S9] round=57 local utility u=0.000022 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998777426299857, 'loss_val': 0.01501152594091882, 'psi': 0.9982111267755323}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998823979776928, 'loss_val': 0.015069137867418652, 'psi': 0.9982129889146152}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=57 head_norm_before_train=2.166008 (no previous merge yet)
[S10] round=57 local utility u=0.000051 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956757490197287, 'loss_val': 0.02555452860151555, 'psi': 0.9953830030195163}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956736273606533, 'loss_val': 0.025650589271079823, 'psi': 0.9953821543558862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=57 head_norm_before_train=1.735498 cos_to_last_merge=0.9580 (last merge round=39)
[S11] round=57 local utility u=0.007065 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968576926034025, 'loss_val': 0.026868794929391836, 'psi': 0.9964355618878082}-{'f1_val': 0.9946422000596432, 'auprc': 0.9970766284657704, 'loss_val': 0.03258338503565517, 'psi': 0.995615971422094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=57 head_norm_before_train=1.779365 cos_to_last_merge=0.9847 (last merge round=35)
[S13] round=57 local utility u=0.129000 metrics={'f1_val': 0.6565966025147268, 'auprc': 0.6836291933330474, 'loss_val': 0.7498454514371163, 'psi': 0.6674096388420551}-{'f1_val': 0.680660513118439, 'auprc': 0.6420622085330216, 'loss_val': 1.0275271298285418, 'psi': 0.665221191284272}
[S13] not sending this round → trigger blocked (psi=0.667)
[S14] START round=57 head_norm_before_train=1.941669 cos_to_last_merge=0.8126 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.813
[S14] round=57 local utility u=0.001944 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9989642823803231, 'loss_val': 0.02190095302820192, 'psi': 0.997521939722388}-{'f1_val': 0.9967805075071389, 'auprc': 0.9983516143860687, 'loss_val': 0.025272230512357295, 'psi': 0.9974089502587108}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=57 head_norm_before_train=1.546969 cos_to_last_merge=0.9525 (last merge round=33)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.968041393198919, 'loss_val': 0.5968238138260538, 'psi': 0.807768729859968}-{'f1_val': 0.7593341739769766, 'auprc': 0.9720906500409144, 'loss_val': 0.48432801428982974, 'psi': 0.8444367644025517}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.101485 cos_to_last_merge=0.9986 (last merge round=41)
[S16] round=57 local utility u=0.857690 metrics={'f1_val': 0.9420674564586267, 'auprc': 0.9845260320688248, 'loss_val': 0.28898393838707087, 'psi': 0.9590508867027059}-{'f1_val': 0.8460818049020492, 'auprc': 0.8716245600112308, 'loss_val': 1.0897461390246315, 'psi': 0.8562989069457219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=57 head_norm_before_train=1.849969 cos_to_last_merge=0.9912 (last merge round=39)
[S17] round=57 local utility u=1.000000 metrics={'f1_val': 0.6938577699274843, 'auprc': 0.8862365860976549, 'loss_val': 0.9131280804954341, 'psi': 0.7708092963955525}-{'f1_val': 0.417684312734673, 'auprc': 0.7487944538610778, 'loss_val': 1.8842093471337344, 'psi': 0.550128369185235}
[S17] not sending this round → trigger blocked (psi=0.771)
[S2] START round=58 head_norm_before_train=2.073178 (no previous merge yet)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7559653127488614, 'auprc': 0.7604179228932495, 'loss_val': 0.5945581119278117, 'psi': 0.7577463568066166}-{'f1_val': 0.8270748009366975, 'auprc': 0.8318956732695624, 'loss_val': 0.46595679827215264, 'psi': 0.8290031498698435}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.152068 cos_to_last_merge=0.9768 (last merge round=37)
[S3] round=58 local utility u=0.035055 metrics={'f1_val': 0.8996085104313621, 'auprc': 0.9982617761525647, 'loss_val': 0.1481220236665469, 'psi': 0.9390698167198431}-{'f1_val': 0.9107737987696327, 'auprc': 0.98812171664799, 'loss_val': 0.2548031950382075, 'psi': 0.9417129659209756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=58 head_norm_before_train=1.981007 (no previous merge yet)
[S4] round=58 local utility u=0.009135 metrics={'f1_val': 0.9498257003501134, 'auprc': 0.9542571841570501, 'loss_val': 0.3113813982219017, 'psi': 0.9515982938728881}-{'f1_val': 0.9496341882408685, 'auprc': 0.9487417619612708, 'loss_val': 0.311955181115855, 'psi': 0.9492772177290295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=58 head_norm_before_train=1.882100 cos_to_last_merge=0.7265 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=58 local utility u=0.002011 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9972038033235369, 'loss_val': 0.028270608102072065, 'psi': 0.9969027024164894}-{'f1_val': 0.9970695586110643, 'auprc': 0.9991399842895415, 'loss_val': 0.04030755953737223, 'psi': 0.9978977288824552}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=58 head_norm_before_train=1.859021 cos_to_last_merge=0.9774 (last merge round=40)
[S6] round=58 local utility u=0.118192 metrics={'f1_val': 0.7774122275605224, 'auprc': 0.9623562487589756, 'loss_val': 0.4868167359479368, 'psi': 0.8513898360399037}-{'f1_val': 0.755479984289215, 'auprc': 0.9588077429825544, 'loss_val': 0.5809622019061103, 'psi': 0.8368110877665508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=58 head_norm_before_train=2.114869 cos_to_last_merge=0.9970 (last merge round=35)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.640424593040883, 'auprc': 0.808455399260369, 'loss_val': 0.549180089603491, 'psi': 0.7076369155286775}-{'f1_val': 0.6666592846482904, 'auprc': 0.8161747396010943, 'loss_val': 0.4163524741265751, 'psi': 0.7264654666294119}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.544096 cos_to_last_merge=0.9895 (last merge round=40)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9673735263185497, 'auprc': 0.9981431780252938, 'loss_val': 0.08855369815274554, 'psi': 0.9796813870012473}-{'f1_val': 0.9868234720888559, 'auprc': 0.998938819494873, 'loss_val': 0.05128784076122812, 'psi': 0.9916696110512626}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.297626 (no previous merge yet)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979795499852329, 'loss_val': 0.01724188901311526, 'psi': 0.9974535675013788}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998777426299857, 'loss_val': 0.01501152594091882, 'psi': 0.9982111267755323}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=2.171344 (no previous merge yet)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956748851382917, 'loss_val': 0.02537525415143754, 'psi': 0.9952508659743624}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956757490197287, 'loss_val': 0.02555452860151555, 'psi': 0.9953830030195163}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=1.745887 cos_to_last_merge=0.9570 (last merge round=39)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9965433440875909, 'loss_val': 0.026945659955766803, 'psi': 0.9963098224814836}-{'f1_val': 0.9961541414107454, 'auprc': 0.9968576926034025, 'loss_val': 0.026868794929391836, 'psi': 0.9964355618878082}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.782369 cos_to_last_merge=0.9844 (last merge round=35)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6196352065069592, 'auprc': 0.6371826449695985, 'loss_val': 1.0170153751646693, 'psi': 0.626654181892015}-{'f1_val': 0.6565966025147268, 'auprc': 0.6836291933330474, 'loss_val': 0.7498454514371163, 'psi': 0.6674096388420551}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.949330 cos_to_last_merge=0.8123 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.812
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9816855291397041, 'auprc': 0.9986582216353594, 'loss_val': 0.06255052308043912, 'psi': 0.9884746061379662}-{'f1_val': 0.9965603779504312, 'auprc': 0.9989642823803231, 'loss_val': 0.02190095302820192, 'psi': 0.997521939722388}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=1.552373 cos_to_last_merge=0.9518 (last merge round=33)
[S15] round=58 local utility u=0.286755 metrics={'f1_val': 0.7667735233112958, 'auprc': 0.9816754891512066, 'loss_val': 0.45933477986598353, 'psi': 0.8527343096472602}-{'f1_val': 0.7009202876340006, 'auprc': 0.968041393198919, 'loss_val': 0.5968238138260538, 'psi': 0.807768729859968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=58 head_norm_before_train=2.104325 cos_to_last_merge=0.9984 (last merge round=41)
[S16] round=58 local utility u=0.279292 metrics={'f1_val': 0.9924927623194406, 'auprc': 0.9869164695206655, 'loss_val': 0.04012380510821904, 'psi': 0.9902622451999306}-{'f1_val': 0.9420674564586267, 'auprc': 0.9845260320688248, 'loss_val': 0.28898393838707087, 'psi': 0.9590508867027059}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=58 head_norm_before_train=1.858890 cos_to_last_merge=0.9906 (last merge round=39)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6097607851258124, 'auprc': 0.865095986592745, 'loss_val': 1.167789803221836, 'psi': 0.7118948657125854}-{'f1_val': 0.6938577699274843, 'auprc': 0.8862365860976549, 'loss_val': 0.9131280804954341, 'psi': 0.7708092963955525}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.080256 (no previous merge yet)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6862510927766377, 'auprc': 0.8161321665651409, 'loss_val': 1.2252298727909108, 'psi': 0.7382035222920389}-{'f1_val': 0.7559653127488614, 'auprc': 0.7604179228932495, 'loss_val': 0.5945581119278117, 'psi': 0.7577463568066166}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.738 u=0.0000 p_local=0.1141 f1=0.686 auprc=0.816 bytes=43134
[S3] START round=59 head_norm_before_train=2.164485 cos_to_last_merge=0.9762 (last merge round=37)
[S3] round=59 local utility u=0.184364 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9995449534733445, 'loss_val': 0.15228428028335933, 'psi': 0.9764871357300293}-{'f1_val': 0.8996085104313621, 'auprc': 0.9982617761525647, 'loss_val': 0.1481220236665469, 'psi': 0.9390698167198431}
[S3] not sending this round → trigger blocked (psi=0.976)
[S3] r=60 psi=0.976 u=0.1844 p_local=0.0798 f1=0.961 auprc=1.000 bytes=41328
[S4] START round=59 head_norm_before_train=1.987193 (no previous merge yet)
[S4] round=59 local utility u=0.020369 metrics={'f1_val': 0.9530896230550198, 'auprc': 0.9602208642963458, 'loss_val': 0.30811700120949825, 'psi': 0.9559421195515502}-{'f1_val': 0.9498257003501134, 'auprc': 0.9542571841570501, 'loss_val': 0.3113813982219017, 'psi': 0.9515982938728881}
[S4] not sending this round → trigger blocked (psi=0.956)
[S4] r=60 psi=0.956 u=0.0204 p_local=0.0186 f1=0.953 auprc=0.960 bytes=39595
[S5] START round=59 head_norm_before_train=1.891025 cos_to_last_merge=0.7257 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9982421168594536, 'auprc': 0.9992090949477311, 'loss_val': 0.08730249292531833, 'psi': 0.9986289080947646}-{'f1_val': 0.9967019684784577, 'auprc': 0.9972038033235369, 'loss_val': 0.028270608102072065, 'psi': 0.9969027024164894}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.999 u=0.0000 p_local=0.0525 f1=0.998 auprc=0.999 bytes=43192
[S6] START round=59 head_norm_before_train=1.870684 cos_to_last_merge=0.9764 (last merge round=40)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6679310528380986, 'auprc': 0.928569991274433, 'loss_val': 0.8434308155672233, 'psi': 0.7721866282126324}-{'f1_val': 0.7774122275605224, 'auprc': 0.9623562487589756, 'loss_val': 0.4868167359479368, 'psi': 0.8513898360399037}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.772 u=0.0000 p_local=0.2006 f1=0.668 auprc=0.929 bytes=41371
[S7] START round=59 head_norm_before_train=2.125157 cos_to_last_merge=0.9965 (last merge round=35)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.6370682756874881, 'auprc': 0.8035226683122557, 'loss_val': 0.7806447061083892, 'psi': 0.7036500327373951}-{'f1_val': 0.640424593040883, 'auprc': 0.808455399260369, 'loss_val': 0.549180089603491, 'psi': 0.7076369155286775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.704 u=0.0000 p_local=0.0816 f1=0.637 auprc=0.804 bytes=41336
[S8] START round=59 head_norm_before_train=1.555996 cos_to_last_merge=0.9889 (last merge round=40)
[S8] round=59 local utility u=0.091325 metrics={'f1_val': 0.9900973316212444, 'auprc': 0.9989908289966196, 'loss_val': 0.044788484337955035, 'psi': 0.9936547305713945}-{'f1_val': 0.9673735263185497, 'auprc': 0.9981431780252938, 'loss_val': 0.08855369815274554, 'psi': 0.9796813870012473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=60 psi=0.994 u=0.0913 p_local=0.0321 f1=0.990 auprc=0.999 bytes=44894
[S9] START round=59 head_norm_before_train=2.300806 (no previous merge yet)
[S9] round=59 local utility u=0.000561 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.9999699687267187, 'loss_val': 0.01791312301677131, 'psi': 0.9978319989823318}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979795499852329, 'loss_val': 0.01724188901311526, 'psi': 0.9974535675013788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=60 psi=0.998 u=0.0006 p_local=0.0024 f1=0.996 auprc=1.000 bytes=52151
[S10] START round=59 head_norm_before_train=2.177325 (no previous merge yet)
[S10] round=59 local utility u=0.000630 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956818016170977, 'loss_val': 0.02545325348249933, 'psi': 0.9953854240584639}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956748851382917, 'loss_val': 0.02537525415143754, 'psi': 0.9952508659743624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] r=60 psi=0.995 u=0.0006 p_local=0.0003 f1=0.995 auprc=0.996 bytes=50271
[S11] START round=59 head_norm_before_train=1.756562 cos_to_last_merge=0.9559 (last merge round=39)
[S11] round=59 local utility u=0.000148 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964801690258517, 'loss_val': 0.02633809214810678, 'psi': 0.9962722725583263}-{'f1_val': 0.9961541414107454, 'auprc': 0.9965433440875909, 'loss_val': 0.026945659955766803, 'psi': 0.9963098224814836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S11] r=60 psi=0.996 u=0.0001 p_local=0.0226 f1=0.996 auprc=0.996 bytes=39585
[S13] START round=59 head_norm_before_train=1.787045 cos_to_last_merge=0.9840 (last merge round=35)
[S13] round=59 local utility u=0.281552 metrics={'f1_val': 0.6452970662281625, 'auprc': 0.7131845337867189, 'loss_val': 0.8358890608813357, 'psi': 0.6724520532515851}-{'f1_val': 0.6196352065069592, 'auprc': 0.6371826449695985, 'loss_val': 1.0170153751646693, 'psi': 0.626654181892015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=60 psi=0.672 u=0.2816 p_local=0.1786 f1=0.645 auprc=0.713 bytes=45018
[S14] START round=59 head_norm_before_train=1.954850 cos_to_last_merge=0.8118 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.812
[S14] round=59 local utility u=0.061613 metrics={'f1_val': 0.9967718237913845, 'auprc': 0.9986501647527026, 'loss_val': 0.02981855467298585, 'psi': 0.9975231601759118}-{'f1_val': 0.9816855291397041, 'auprc': 0.9986582216353594, 'loss_val': 0.06255052308043912, 'psi': 0.9884746061379662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] r=60 psi=0.998 u=0.0616 p_local=0.0570 f1=0.997 auprc=0.999 bytes=41402
[S15] START round=59 head_norm_before_train=1.557078 cos_to_last_merge=0.9513 (last merge round=33)
[S15] round=59 local utility u=0.399272 metrics={'f1_val': 0.8556112026164048, 'auprc': 0.9922261813880284, 'loss_val': 0.22546858384088925, 'psi': 0.9102571941250542}-{'f1_val': 0.7667735233112958, 'auprc': 0.9816754891512066, 'loss_val': 0.45933477986598353, 'psi': 0.8527343096472602}
[S15] not sending this round → trigger blocked (psi=0.910)
[S15] r=60 psi=0.910 u=0.3993 p_local=0.2886 f1=0.856 auprc=0.992 bytes=41372
[S16] START round=59 head_norm_before_train=2.107524 cos_to_last_merge=0.9981 (last merge round=41)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9916400854499015, 'auprc': 0.9861346527181943, 'loss_val': 0.043666099691526725, 'psi': 0.9894379123572186}-{'f1_val': 0.9924927623194406, 'auprc': 0.9869164695206655, 'loss_val': 0.04012380510821904, 'psi': 0.9902622451999306}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.989 u=0.0000 p_local=0.2293 f1=0.992 auprc=0.986 bytes=41352
[S17] START round=59 head_norm_before_train=1.868511 cos_to_last_merge=0.9900 (last merge round=39)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.5908538812193833, 'auprc': 0.8506093622096691, 'loss_val': 1.2575885082096037, 'psi': 0.6947560736154976}-{'f1_val': 0.6097607851258124, 'auprc': 0.865095986592745, 'loss_val': 1.167789803221836, 'psi': 0.7118948657125854}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.695 u=0.0000 p_local=0.3115 f1=0.591 auprc=0.851 bytes=41405
[S2] START round=60 head_norm_before_train=2.086746 (no previous merge yet)
[S2] round=60 local utility u=0.709971 metrics={'f1_val': 0.828686658196353, 'auprc': 0.7529701433584542, 'loss_val': 0.47041593337164483, 'psi': 0.7984000522611935}-{'f1_val': 0.6862510927766377, 'auprc': 0.8161321665651409, 'loss_val': 1.2252298727909108, 'psi': 0.7382035222920389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=60 head_norm_before_train=2.176176 cos_to_last_merge=0.9755 (last merge round=37)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.839436355671238, 'auprc': 0.9894082371368527, 'loss_val': 0.28633968610929605, 'psi': 0.8994251082574838}-{'f1_val': 0.9611152572344858, 'auprc': 0.9995449534733445, 'loss_val': 0.15228428028335933, 'psi': 0.9764871357300293}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.992284 (no previous merge yet)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9495474153482093, 'auprc': 0.9521528421102756, 'loss_val': 0.3145745357373455, 'psi': 0.9505895860530358}-{'f1_val': 0.9530896230550198, 'auprc': 0.9602208642963458, 'loss_val': 0.30811700120949825, 'psi': 0.9559421195515502}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.899714 cos_to_last_merge=0.7249 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.725
[S5] round=60 local utility u=0.020007 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.99426605882194, 'loss_val': 0.023219107566218134, 'psi': 0.9957276046158505}-{'f1_val': 0.9982421168594536, 'auprc': 0.9992090949477311, 'loss_val': 0.08730249292531833, 'psi': 0.9986289080947646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=60 head_norm_before_train=1.883657 cos_to_last_merge=0.9750 (last merge round=40)
[S6] round=60 local utility u=0.746375 metrics={'f1_val': 0.84112509782507, 'auprc': 0.9637672269014983, 'loss_val': 0.4954358515968867, 'psi': 0.8901819494556413}-{'f1_val': 0.6679310528380986, 'auprc': 0.928569991274433, 'loss_val': 0.8434308155672233, 'psi': 0.7721866282126324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=60 head_norm_before_train=2.138559 cos_to_last_merge=0.9959 (last merge round=35)
[S7] round=60 local utility u=0.975870 metrics={'f1_val': 0.8478554967465343, 'auprc': 0.8633245340209973, 'loss_val': 0.27303310116983937, 'psi': 0.8540431116563194}-{'f1_val': 0.6370682756874881, 'auprc': 0.8035226683122557, 'loss_val': 0.7806447061083892, 'psi': 0.7036500327373951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=60 head_norm_before_train=1.566906 cos_to_last_merge=0.9884 (last merge round=40)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.8985808284659436, 'auprc': 0.9984720620535656, 'loss_val': 0.17707200342233217, 'psi': 0.9385373219009925}-{'f1_val': 0.9900973316212444, 'auprc': 0.9989908289966196, 'loss_val': 0.044788484337955035, 'psi': 0.9936547305713945}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.302722 (no previous merge yet)
[S9] round=60 local utility u=0.001600 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9999675450354678, 'loss_val': 0.0162082275179294, 'psi': 0.9979812251938338}-{'f1_val': 0.9964066858194072, 'auprc': 0.9999699687267187, 'loss_val': 0.01791312301677131, 'psi': 0.9978319989823318}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=60 head_norm_before_train=2.183631 (no previous merge yet)
[S10] round=60 local utility u=0.000030 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956842134295745, 'loss_val': 0.02540030668338198, 'psi': 0.9953863887834546}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956818016170977, 'loss_val': 0.02545325348249933, 'psi': 0.9953854240584639}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=60 head_norm_before_train=1.767263 cos_to_last_merge=0.9548 (last merge round=39)
[S11] round=60 local utility u=0.000452 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964650530571162, 'loss_val': 0.025389473216944236, 'psi': 0.996266226170832}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964801690258517, 'loss_val': 0.02633809214810678, 'psi': 0.9962722725583263}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=60 head_norm_before_train=1.792113 cos_to_last_merge=0.9836 (last merge round=35)
[S13] round=60 local utility u=0.112274 metrics={'f1_val': 0.7231264904400976, 'auprc': 0.682221317812755, 'loss_val': 0.9854270312264872, 'psi': 0.7067644213891605}-{'f1_val': 0.6452970662281625, 'auprc': 0.7131845337867189, 'loss_val': 0.8358890608813357, 'psi': 0.6724520532515851}
[S13] not sending this round → trigger blocked (psi=0.707)
[S14] START round=60 head_norm_before_train=1.958856 cos_to_last_merge=0.8114 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.811
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.937945536540357, 'auprc': 0.9971936862942029, 'loss_val': 0.13470818412823488, 'psi': 0.9616447964418954}-{'f1_val': 0.9967718237913845, 'auprc': 0.9986501647527026, 'loss_val': 0.02981855467298585, 'psi': 0.9975231601759118}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.564027 cos_to_last_merge=0.9506 (last merge round=33)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.6988431085509774, 'auprc': 0.9569916697636958, 'loss_val': 0.5798661606369659, 'psi': 0.8021025330360647}-{'f1_val': 0.8556112026164048, 'auprc': 0.9922261813880284, 'loss_val': 0.22546858384088925, 'psi': 0.9102571941250542}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.112718 cos_to_last_merge=0.9980 (last merge round=41)
[S16] round=60 local utility u=0.019890 metrics={'f1_val': 0.9927577691791041, 'auprc': 0.993411829481571, 'loss_val': 0.03242383878738981, 'psi': 0.9930193933000908}-{'f1_val': 0.9916400854499015, 'auprc': 0.9861346527181943, 'loss_val': 0.043666099691526725, 'psi': 0.9894379123572186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=60 head_norm_before_train=1.877193 cos_to_last_merge=0.9895 (last merge round=39)
[S17] round=60 local utility u=0.579756 metrics={'f1_val': 0.7149908298886412, 'auprc': 0.8824517530020679, 'loss_val': 0.9384246762851858, 'psi': 0.7819751991340118}-{'f1_val': 0.5908538812193833, 'auprc': 0.8506093622096691, 'loss_val': 1.2575885082096037, 'psi': 0.6947560736154976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=61 head_norm_before_train=2.093784 (no previous merge yet)
[S2] round=61 local utility u=0.272700 metrics={'f1_val': 0.8281469497925584, 'auprc': 0.9350330639396254, 'loss_val': 0.4679655324797121, 'psi': 0.8709013954513851}-{'f1_val': 0.828686658196353, 'auprc': 0.7529701433584542, 'loss_val': 0.47041593337164483, 'psi': 0.7984000522611935}
[S2] not sending this round → trigger blocked (psi=0.871)
[S3] START round=61 head_norm_before_train=2.187951 cos_to_last_merge=0.9749 (last merge round=37)
[S3] round=61 local utility u=0.576996 metrics={'f1_val': 0.9878900958715815, 'auprc': 0.9990116822198997, 'loss_val': 0.05188118698819162, 'psi': 0.9923387304109087}-{'f1_val': 0.839436355671238, 'auprc': 0.9894082371368527, 'loss_val': 0.28633968610929605, 'psi': 0.8994251082574838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=61 head_norm_before_train=1.997613 (no previous merge yet)
[S4] round=61 local utility u=0.019201 metrics={'f1_val': 0.952342664209086, 'auprc': 0.9568387210045838, 'loss_val': 0.30700164061747126, 'psi': 0.954141086927285}-{'f1_val': 0.9495474153482093, 'auprc': 0.9521528421102756, 'loss_val': 0.3145745357373455, 'psi': 0.9505895860530358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=61 head_norm_before_train=1.904715 cos_to_last_merge=0.7245 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.725
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9929490228781596, 'loss_val': 0.025147170346907645, 'psi': 0.9949798963293979}-{'f1_val': 0.9967019684784577, 'auprc': 0.99426605882194, 'loss_val': 0.023219107566218134, 'psi': 0.9957276046158505}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.894839 cos_to_last_merge=0.9738 (last merge round=40)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.6139148735327832, 'auprc': 0.7286763125645292, 'loss_val': 1.239114107273371, 'psi': 0.6598194491454816}-{'f1_val': 0.84112509782507, 'auprc': 0.9637672269014983, 'loss_val': 0.4954358515968867, 'psi': 0.8901819494556413}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=2.149297 cos_to_last_merge=0.9955 (last merge round=35)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6585581394341999, 'auprc': 0.8154306413214407, 'loss_val': 0.4929679567578102, 'psi': 0.7213071401890963}-{'f1_val': 0.8478554967465343, 'auprc': 0.8633245340209973, 'loss_val': 0.27303310116983937, 'psi': 0.8540431116563194}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.576186 cos_to_last_merge=0.9879 (last merge round=40)
[S8] round=61 local utility u=0.339327 metrics={'f1_val': 0.9910687793414171, 'auprc': 0.9980878046697462, 'loss_val': 0.052192285285595094, 'psi': 0.9938763894727487}-{'f1_val': 0.8985808284659436, 'auprc': 0.9984720620535656, 'loss_val': 0.17707200342233217, 'psi': 0.9385373219009925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=61 head_norm_before_train=2.307367 (no previous merge yet)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9988355455795442, 'loss_val': 0.02076703064623437, 'psi': 0.9968800535623266}-{'f1_val': 0.9966570119660778, 'auprc': 0.9999675450354678, 'loss_val': 0.0162082275179294, 'psi': 0.9979812251938338}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.186827 (no previous merge yet)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959382319080269, 'loss_val': 0.02506230574757034, 'psi': 0.9953562046822564}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956842134295745, 'loss_val': 0.02540030668338198, 'psi': 0.9953863887834546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.777918 cos_to_last_merge=0.9538 (last merge round=39)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.8337501050944033, 'auprc': 0.994024638267085, 'loss_val': 0.24202062896186885, 'psi': 0.897859918363476}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964650530571162, 'loss_val': 0.025389473216944236, 'psi': 0.996266226170832}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.798123 cos_to_last_merge=0.9830 (last merge round=35)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.7020841115668414, 'auprc': 0.6411747223723817, 'loss_val': 1.044922419708612, 'psi': 0.6777203558890574}-{'f1_val': 0.7231264904400976, 'auprc': 0.682221317812755, 'loss_val': 0.9854270312264872, 'psi': 0.7067644213891605}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.962939 cos_to_last_merge=0.8112 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.811
[S14] round=61 local utility u=0.031566 metrics={'f1_val': 0.9443697209338645, 'auprc': 0.9966872225994994, 'loss_val': 0.10860166486721054, 'psi': 0.9652967216001185}-{'f1_val': 0.937945536540357, 'auprc': 0.9971936862942029, 'loss_val': 0.13470818412823488, 'psi': 0.9616447964418954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=61 head_norm_before_train=1.573283 cos_to_last_merge=0.9496 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=61 local utility u=0.052839 metrics={'f1_val': 0.701587230439763, 'auprc': 0.9734464042212894, 'loss_val': 0.5400166067476255, 'psi': 0.8103308999523735}-{'f1_val': 0.6988431085509774, 'auprc': 0.9569916697636958, 'loss_val': 0.5798661606369659, 'psi': 0.8021025330360647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=61 head_norm_before_train=2.115888 cos_to_last_merge=0.9976 (last merge round=41)
[S16] round=61 local utility u=0.005110 metrics={'f1_val': 0.9927306099290307, 'auprc': 0.9967540089678442, 'loss_val': 0.03206675122706747, 'psi': 0.9943399695445561}-{'f1_val': 0.9927577691791041, 'auprc': 0.993411829481571, 'loss_val': 0.03242383878738981, 'psi': 0.9930193933000908}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=61 head_norm_before_train=1.887285 cos_to_last_merge=0.9891 (last merge round=39)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.38445397396931363, 'auprc': 0.5572904977324639, 'loss_val': 2.3827340142110303, 'psi': 0.4535885834745737}-{'f1_val': 0.7149908298886412, 'auprc': 0.8824517530020679, 'loss_val': 0.9384246762851858, 'psi': 0.7819751991340118}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.098202 (no previous merge yet)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.4738926811661161, 'auprc': 0.737914251706359, 'loss_val': 1.3308528282217207, 'psi': 0.5795013093822132}-{'f1_val': 0.8281469497925584, 'auprc': 0.9350330639396254, 'loss_val': 0.4679655324797121, 'psi': 0.8709013954513851}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.198414 cos_to_last_merge=0.9744 (last merge round=37)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9756659458306347, 'auprc': 0.9984997655296262, 'loss_val': 0.06927542518720275, 'psi': 0.9847994737102314}-{'f1_val': 0.9878900958715815, 'auprc': 0.9990116822198997, 'loss_val': 0.05188118698819162, 'psi': 0.9923387304109087}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=2.003364 (no previous merge yet)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9466413410553612, 'auprc': 0.941385371387017, 'loss_val': 0.3170919138555604, 'psi': 0.9445389531880235}-{'f1_val': 0.952342664209086, 'auprc': 0.9568387210045838, 'loss_val': 0.30700164061747126, 'psi': 0.954141086927285}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.908482 cos_to_last_merge=0.7241 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.724
[S5] round=62 local utility u=0.007784 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9992420341578861, 'loss_val': 0.03287261801544927, 'psi': 0.997938548829793}-{'f1_val': 0.9963338119635569, 'auprc': 0.9929490228781596, 'loss_val': 0.025147170346907645, 'psi': 0.9949798963293979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=62 head_norm_before_train=1.903660 cos_to_last_merge=0.9728 (last merge round=40)
[S6] round=62 local utility u=1.000000 metrics={'f1_val': 0.9158081329401191, 'auprc': 0.9859789867534885, 'loss_val': 0.18907554181045413, 'psi': 0.9438764744654669}-{'f1_val': 0.6139148735327832, 'auprc': 0.7286763125645292, 'loss_val': 1.239114107273371, 'psi': 0.6598194491454816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=62 head_norm_before_train=2.153222 cos_to_last_merge=0.9953 (last merge round=35)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.6322539220992331, 'auprc': 0.7976816073672588, 'loss_val': 0.8528461660473137, 'psi': 0.6984249962064434}-{'f1_val': 0.6585581394341999, 'auprc': 0.8154306413214407, 'loss_val': 0.4929679567578102, 'psi': 0.7213071401890963}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=1.584956 cos_to_last_merge=0.9874 (last merge round=40)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9726896672672091, 'auprc': 0.9987491317852158, 'loss_val': 0.06490517567116669, 'psi': 0.9831134530744118}-{'f1_val': 0.9910687793414171, 'auprc': 0.9980878046697462, 'loss_val': 0.052192285285595094, 'psi': 0.9938763894727487}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.314544 (no previous merge yet)
[S9] round=62 local utility u=0.007156 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999399955481784, 'loss_val': 0.01627299420076903, 'psi': 0.9979723053076062}-{'f1_val': 0.9955763922175147, 'auprc': 0.9988355455795442, 'loss_val': 0.02076703064623437, 'psi': 0.9968800535623266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=62 head_norm_before_train=2.189286 (no previous merge yet)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9962907727965409, 'loss_val': 0.025169545327122962, 'psi': 0.9953654746502398}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959382319080269, 'loss_val': 0.02506230574757034, 'psi': 0.9953562046822564}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.787010 cos_to_last_merge=0.9529 (last merge round=39)
[S11] round=62 local utility u=0.598959 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9966220594645272, 'loss_val': 0.026319903698755653, 'psi': 0.9963413086322581}-{'f1_val': 0.8337501050944033, 'auprc': 0.994024638267085, 'loss_val': 0.24202062896186885, 'psi': 0.897859918363476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=62 head_norm_before_train=1.804760 cos_to_last_merge=0.9825 (last merge round=35)
[S13] round=62 local utility u=0.306065 metrics={'f1_val': 0.6993513856451689, 'auprc': 0.7419968535105576, 'loss_val': 0.7188623847062093, 'psi': 0.7164095727913243}-{'f1_val': 0.7020841115668414, 'auprc': 0.6411747223723817, 'loss_val': 1.044922419708612, 'psi': 0.6777203558890574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=62 head_norm_before_train=1.967246 cos_to_last_merge=0.8105 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.810
[S14] round=62 local utility u=0.205018 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9988959893977392, 'loss_val': 0.020796670717558086, 'psi': 0.9977407907650855}-{'f1_val': 0.9443697209338645, 'auprc': 0.9966872225994994, 'loss_val': 0.10860166486721054, 'psi': 0.9652967216001185}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=62 head_norm_before_train=1.584880 cos_to_last_merge=0.9485 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9858302353912051, 'loss_val': 0.5785903265537001, 'psi': 0.8148836047774826}-{'f1_val': 0.701587230439763, 'auprc': 0.9734464042212894, 'loss_val': 0.5400166067476255, 'psi': 0.8103308999523735}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=2.119856 cos_to_last_merge=0.9973 (last merge round=41)
[S16] round=62 local utility u=0.003483 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9982956619151659, 'loss_val': 0.03220301153672728, 'psi': 0.9952044442560799}-{'f1_val': 0.9927306099290307, 'auprc': 0.9967540089678442, 'loss_val': 0.03206675122706747, 'psi': 0.9943399695445561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=62 head_norm_before_train=1.897071 cos_to_last_merge=0.9887 (last merge round=39)
[S17] round=62 local utility u=0.442827 metrics={'f1_val': 0.4173608277854644, 'auprc': 0.6705305467340316, 'loss_val': 2.0342405810722926, 'psi': 0.5186287153648912}-{'f1_val': 0.38445397396931363, 'auprc': 0.5572904977324639, 'loss_val': 2.3827340142110303, 'psi': 0.4535885834745737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=63 head_norm_before_train=2.099885 (no previous merge yet)
[S2] round=63 local utility u=1.000000 metrics={'f1_val': 0.7742488662498903, 'auprc': 0.9842165093432045, 'loss_val': 0.49506808815028946, 'psi': 0.858235923487216}-{'f1_val': 0.4738926811661161, 'auprc': 0.737914251706359, 'loss_val': 1.3308528282217207, 'psi': 0.5795013093822132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=63 head_norm_before_train=2.208752 cos_to_last_merge=0.9738 (last merge round=37)
[S3] round=63 local utility u=0.051745 metrics={'f1_val': 0.9884479319431156, 'auprc': 0.998747205272016, 'loss_val': 0.04321953252498999, 'psi': 0.9925676412746758}-{'f1_val': 0.9756659458306347, 'auprc': 0.9984997655296262, 'loss_val': 0.06927542518720275, 'psi': 0.9847994737102314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=63 head_norm_before_train=2.006322 (no previous merge yet)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9392881213909177, 'auprc': 0.9307008160613446, 'loss_val': 0.3258849266373762, 'psi': 0.9358531992590884}-{'f1_val': 0.9466413410553612, 'auprc': 0.941385371387017, 'loss_val': 0.3170919138555604, 'psi': 0.9445389531880235}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.908365 cos_to_last_merge=0.7239 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.724
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9920249461517957, 'loss_val': 0.029566481950565687, 'psi': 0.9946102656388524}-{'f1_val': 0.9970695586110643, 'auprc': 0.9992420341578861, 'loss_val': 0.03287261801544927, 'psi': 0.997938548829793}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.909978 cos_to_last_merge=0.9721 (last merge round=40)
[S6] round=63 local utility u=0.082086 metrics={'f1_val': 0.9468977587442, 'auprc': 0.9781069337809232, 'loss_val': 0.18782495892486853, 'psi': 0.9593814287588893}-{'f1_val': 0.9158081329401191, 'auprc': 0.9859789867534885, 'loss_val': 0.18907554181045413, 'psi': 0.9438764744654669}
[S6] not sending this round → trigger blocked (psi=0.959)
[S7] START round=63 head_norm_before_train=2.155039 cos_to_last_merge=0.9951 (last merge round=35)
[S7] round=63 local utility u=0.035349 metrics={'f1_val': 0.6252033886291801, 'auprc': 0.7999574415962446, 'loss_val': 0.7466721705676032, 'psi': 0.6951050098160059}-{'f1_val': 0.6322539220992331, 'auprc': 0.7976816073672588, 'loss_val': 0.8528461660473137, 'psi': 0.6984249962064434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=63 head_norm_before_train=1.592003 cos_to_last_merge=0.9871 (last merge round=40)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9667165533899338, 'auprc': 0.9986364099588428, 'loss_val': 0.08232792582099524, 'psi': 0.9794844960174974}-{'f1_val': 0.9726896672672091, 'auprc': 0.9987491317852158, 'loss_val': 0.06490517567116669, 'psi': 0.9831134530744118}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=2.323129 (no previous merge yet)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9998876646082291, 'loss_val': 0.016194008772420217, 'psi': 0.9979492730229383}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999399955481784, 'loss_val': 0.01627299420076903, 'psi': 0.9979723053076062}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.193668 (no previous merge yet)
[S10] round=63 local utility u=0.001231 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963017143825599, 'loss_val': 0.02537528442694118, 'psi': 0.9956333891646487}-{'f1_val': 0.9947486092193725, 'auprc': 0.9962907727965409, 'loss_val': 0.025169545327122962, 'psi': 0.9953654746502398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=63 head_norm_before_train=1.795961 cos_to_last_merge=0.9521 (last merge round=39)
[S11] round=63 local utility u=0.004350 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976507317432503, 'loss_val': 0.023064050576168726, 'psi': 0.9969884954054539}-{'f1_val': 0.9961541414107454, 'auprc': 0.9966220594645272, 'loss_val': 0.026319903698755653, 'psi': 0.9963413086322581}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=63 head_norm_before_train=1.814879 cos_to_last_merge=0.9816 (last merge round=35)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.7087703056091859, 'auprc': 0.6673319438510038, 'loss_val': 0.9750903356225402, 'psi': 0.692194960905913}-{'f1_val': 0.6993513856451689, 'auprc': 0.7419968535105576, 'loss_val': 0.7188623847062093, 'psi': 0.7164095727913243}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=1.971496 cos_to_last_merge=0.8099 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.810
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9989207725281686, 'loss_val': 0.022262314814930254, 'psi': 0.9975045357815262}-{'f1_val': 0.9969706583433163, 'auprc': 0.9988959893977392, 'loss_val': 0.020796670717558086, 'psi': 0.9977407907650855}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.594916 cos_to_last_merge=0.9474 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=63 local utility u=0.827227 metrics={'f1_val': 0.9020989036040933, 'auprc': 0.9892179330355492, 'loss_val': 0.14137848174637618, 'psi': 0.9369465153766756}-{'f1_val': 0.7009191843683342, 'auprc': 0.9858302353912051, 'loss_val': 0.5785903265537001, 'psi': 0.8148836047774826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=63 head_norm_before_train=2.121166 cos_to_last_merge=0.9972 (last merge round=41)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.997905979378724, 'loss_val': 0.03198943746062113, 'psi': 0.9950485712415031}-{'f1_val': 0.9931436324833557, 'auprc': 0.9982956619151659, 'loss_val': 0.03220301153672728, 'psi': 0.9952044442560799}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.904851 cos_to_last_merge=0.9884 (last merge round=39)
[S17] round=63 local utility u=1.000000 metrics={'f1_val': 0.873506215857111, 'auprc': 0.9287685071136654, 'loss_val': 0.5299151773225819, 'psi': 0.8956111323597327}-{'f1_val': 0.4173608277854644, 'auprc': 0.6705305467340316, 'loss_val': 2.0342405810722926, 'psi': 0.5186287153648912}
[S17] not sending this round → trigger blocked (psi=0.896)
[S2] START round=64 head_norm_before_train=2.103580 (no previous merge yet)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.571203709544954, 'auprc': 0.7318403259255429, 'loss_val': 1.2288491842581968, 'psi': 0.6354583560971896}-{'f1_val': 0.7742488662498903, 'auprc': 0.9842165093432045, 'loss_val': 0.49506808815028946, 'psi': 0.858235923487216}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.219613 cos_to_last_merge=0.9732 (last merge round=37)
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.8786347904958026, 'auprc': 0.973961600110022, 'loss_val': 0.29859855124546403, 'psi': 0.9167655143414903}-{'f1_val': 0.9884479319431156, 'auprc': 0.998747205272016, 'loss_val': 0.04321953252498999, 'psi': 0.9925676412746758}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=2.005574 (no previous merge yet)
[S4] round=64 local utility u=0.042301 metrics={'f1_val': 0.9452154343707755, 'auprc': 0.9427513936204427, 'loss_val': 0.31299848138958775, 'psi': 0.9442298180706423}-{'f1_val': 0.9392881213909177, 'auprc': 0.9307008160613446, 'loss_val': 0.3258849266373762, 'psi': 0.9358531992590884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=64 head_norm_before_train=1.910004 cos_to_last_merge=0.7232 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.723
[S5] round=64 local utility u=0.015760 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9990492341544244, 'loss_val': 0.021328411652333363, 'psi': 0.9976408747488443}-{'f1_val': 0.9963338119635569, 'auprc': 0.9920249461517957, 'loss_val': 0.029566481950565687, 'psi': 0.9946102656388524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=64 head_norm_before_train=1.915107 cos_to_last_merge=0.9716 (last merge round=40)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6159965470624807, 'auprc': 0.6965065281108265, 'loss_val': 1.3150632099022612, 'psi': 0.6482005394818191}-{'f1_val': 0.9468977587442, 'auprc': 0.9781069337809232, 'loss_val': 0.18782495892486853, 'psi': 0.9593814287588893}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=2.156379 cos_to_last_merge=0.9950 (last merge round=35)
[S7] round=64 local utility u=0.250386 metrics={'f1_val': 0.657511661210399, 'auprc': 0.81590750342012, 'loss_val': 0.48760006915285325, 'psi': 0.7208699980942874}-{'f1_val': 0.6252033886291801, 'auprc': 0.7999574415962446, 'loss_val': 0.7466721705676032, 'psi': 0.6951050098160059}
[S7] not sending this round → trigger blocked (psi=0.721)
[S8] START round=64 head_norm_before_train=1.596554 cos_to_last_merge=0.9869 (last merge round=40)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.7251615275346577, 'auprc': 0.9857185722903694, 'loss_val': 0.2285675597345091, 'psi': 0.8293843454369423}-{'f1_val': 0.9667165533899338, 'auprc': 0.9986364099588428, 'loss_val': 0.08232792582099524, 'psi': 0.9794844960174974}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.328652 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977124099338252, 'loss_val': 0.015543673294161021, 'psi': 0.9973467114808158}-{'f1_val': 0.9966570119660778, 'auprc': 0.9998876646082291, 'loss_val': 0.016194008772420217, 'psi': 0.9979492730229383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.199005 (no previous merge yet)
[S10] round=64 local utility u=0.000516 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9970358765328331, 'loss_val': 0.025227453373170488, 'psi': 0.9957952625321789}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963017143825599, 'loss_val': 0.02537528442694118, 'psi': 0.9956333891646487}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=64 head_norm_before_train=1.804267 cos_to_last_merge=0.9513 (last merge round=39)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978823040437554, 'loss_val': 0.024383170943154987, 'psi': 0.9970811243256559}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976507317432503, 'loss_val': 0.023064050576168726, 'psi': 0.9969884954054539}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.822883 cos_to_last_merge=0.9809 (last merge round=35)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7162907793400871, 'auprc': 0.6596513377903458, 'loss_val': 1.1135436111843258, 'psi': 0.6936350027201905}-{'f1_val': 0.7087703056091859, 'auprc': 0.6673319438510038, 'loss_val': 0.9750903356225402, 'psi': 0.692194960905913}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.976626 cos_to_last_merge=0.8094 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=64 local utility u=0.001550 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9989283634630647, 'loss_val': 0.020504965221608835, 'psi': 0.9976396498895092}-{'f1_val': 0.9965603779504312, 'auprc': 0.9989207725281686, 'loss_val': 0.022262314814930254, 'psi': 0.9975045357815262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=64 head_norm_before_train=1.604426 cos_to_last_merge=0.9464 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.8672868945432426, 'auprc': 0.9909929461557812, 'loss_val': 0.19104983721073082, 'psi': 0.916769315188258}-{'f1_val': 0.9020989036040933, 'auprc': 0.9892179330355492, 'loss_val': 0.14137848174637618, 'psi': 0.9369465153766756}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.124620 cos_to_last_merge=0.9971 (last merge round=41)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.997447913754939, 'loss_val': 0.03197188590524393, 'psi': 0.9948653449919891}-{'f1_val': 0.9931436324833557, 'auprc': 0.997905979378724, 'loss_val': 0.03198943746062113, 'psi': 0.9950485712415031}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.910084 cos_to_last_merge=0.9885 (last merge round=39)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.43599033596117465, 'auprc': 0.7590676175695124, 'loss_val': 1.8519444581063051, 'psi': 0.5652212486045097}-{'f1_val': 0.873506215857111, 'auprc': 0.9287685071136654, 'loss_val': 0.5299151773225819, 'psi': 0.8956111323597327}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.109435 (no previous merge yet)
[S2] round=65 local utility u=1.000000 metrics={'f1_val': 0.8191163619008859, 'auprc': 0.9577187436963457, 'loss_val': 0.4850540506087071, 'psi': 0.8745573146190698}-{'f1_val': 0.571203709544954, 'auprc': 0.7318403259255429, 'loss_val': 1.2288491842581968, 'psi': 0.6354583560971896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=65 head_norm_before_train=2.229445 cos_to_last_merge=0.9728 (last merge round=37)
[S3] round=65 local utility u=0.523488 metrics={'f1_val': 0.9960018563793124, 'auprc': 0.9990884137028146, 'loss_val': 0.03120533915143265, 'psi': 0.9972364793087133}-{'f1_val': 0.8786347904958026, 'auprc': 0.973961600110022, 'loss_val': 0.29859855124546403, 'psi': 0.9167655143414903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=65 head_norm_before_train=2.004314 (no previous merge yet)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9456684689984688, 'auprc': 0.9409651321335646, 'loss_val': 0.3169097168877168, 'psi': 0.9437871342525072}-{'f1_val': 0.9452154343707755, 'auprc': 0.9427513936204427, 'loss_val': 0.31299848138958775, 'psi': 0.9442298180706423}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.915940 cos_to_last_merge=0.7225 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.723
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9950009765419795, 'loss_val': 0.022179624953999614, 'psi': 0.9960215717038664}-{'f1_val': 0.9967019684784577, 'auprc': 0.9990492341544244, 'loss_val': 0.021328411652333363, 'psi': 0.9976408747488443}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.918618 cos_to_last_merge=0.9714 (last merge round=40)
[S6] round=65 local utility u=1.000000 metrics={'f1_val': 0.9417811056749309, 'auprc': 0.9829697604243358, 'loss_val': 0.17474749150906085, 'psi': 0.9582565675746929}-{'f1_val': 0.6159965470624807, 'auprc': 0.6965065281108265, 'loss_val': 1.3150632099022612, 'psi': 0.6482005394818191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=65 head_norm_before_train=2.160875 cos_to_last_merge=0.9948 (last merge round=35)
[S7] round=65 local utility u=0.003915 metrics={'f1_val': 0.659931750750006, 'auprc': 0.8124288593916531, 'loss_val': 0.4838541453285096, 'psi': 0.7209305942066648}-{'f1_val': 0.657511661210399, 'auprc': 0.81590750342012, 'loss_val': 0.48760006915285325, 'psi': 0.7208699980942874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=65 head_norm_before_train=1.602897 cos_to_last_merge=0.9866 (last merge round=40)
[S8] round=65 local utility u=0.881216 metrics={'f1_val': 0.9831872218856248, 'auprc': 0.9988960083537446, 'loss_val': 0.05382260103815634, 'psi': 0.9894707364728726}-{'f1_val': 0.7251615275346577, 'auprc': 0.9857185722903694, 'loss_val': 0.2285675597345091, 'psi': 0.8293843454369423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=65 head_norm_before_train=2.336649 (no previous merge yet)
[S9] round=65 local utility u=0.003196 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998627221212488, 'loss_val': 0.015586241514095255, 'psi': 0.9982051185720375}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977124099338252, 'loss_val': 0.015543673294161021, 'psi': 0.9973467114808158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=65 head_norm_before_train=2.201735 (no previous merge yet)
[S10] round=65 local utility u=0.000576 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9973894262613455, 'loss_val': 0.02513613112687445, 'psi': 0.9959366824235839}-{'f1_val': 0.9949681865317428, 'auprc': 0.9970358765328331, 'loss_val': 0.025227453373170488, 'psi': 0.9957952625321789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=65 head_norm_before_train=1.812763 cos_to_last_merge=0.9504 (last merge round=39)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9963127491784886, 'loss_val': 0.02285180396427663, 'psi': 0.9964533023795492}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978823040437554, 'loss_val': 0.024383170943154987, 'psi': 0.9970811243256559}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.830922 cos_to_last_merge=0.9802 (last merge round=35)
[S13] round=65 local utility u=0.095912 metrics={'f1_val': 0.6941800174317734, 'auprc': 0.7182951018800607, 'loss_val': 0.9649855115295991, 'psi': 0.7038260512110883}-{'f1_val': 0.7162907793400871, 'auprc': 0.6596513377903458, 'loss_val': 1.1135436111843258, 'psi': 0.6936350027201905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=65 head_norm_before_train=1.983192 cos_to_last_merge=0.8090 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.8787250043060142, 'auprc': 0.9985491058480218, 'loss_val': 0.4224672241513401, 'psi': 0.9266546449228172}-{'f1_val': 0.9967805075071389, 'auprc': 0.9989283634630647, 'loss_val': 0.020504965221608835, 'psi': 0.9976396498895092}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.612372 cos_to_last_merge=0.9456 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.7739895729005469, 'auprc': 0.9890849793398258, 'loss_val': 0.4562170541306694, 'psi': 0.8600277354762584}-{'f1_val': 0.8672868945432426, 'auprc': 0.9909929461557812, 'loss_val': 0.19104983721073082, 'psi': 0.916769315188258}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.129781 cos_to_last_merge=0.9970 (last merge round=41)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9143458360416177, 'auprc': 0.9924918931499583, 'loss_val': 0.24073479804127018, 'psi': 0.945604258884954}-{'f1_val': 0.9931436324833557, 'auprc': 0.997447913754939, 'loss_val': 0.03197188590524393, 'psi': 0.9948653449919891}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.914796 cos_to_last_merge=0.9882 (last merge round=39)
[S17] round=65 local utility u=0.477599 metrics={'f1_val': 0.5221376887457061, 'auprc': 0.8021949784633504, 'loss_val': 1.543013425767505, 'psi': 0.6341606046327638}-{'f1_val': 0.43599033596117465, 'auprc': 0.7590676175695124, 'loss_val': 1.8519444581063051, 'psi': 0.5652212486045097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=66 head_norm_before_train=2.113434 (no previous merge yet)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.8317779327057064, 'auprc': 0.7964997852200371, 'loss_val': 0.4692360139309155, 'psi': 0.8176666737114386}-{'f1_val': 0.8191163619008859, 'auprc': 0.9577187436963457, 'loss_val': 0.4850540506087071, 'psi': 0.8745573146190698}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.239249 cos_to_last_merge=0.9723 (last merge round=37)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.9343877879323572, 'auprc': 0.9935958039074498, 'loss_val': 0.22390673936842065, 'psi': 0.9580709943223943}-{'f1_val': 0.9960018563793124, 'auprc': 0.9990884137028146, 'loss_val': 0.03120533915143265, 'psi': 0.9972364793087133}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.006178 (no previous merge yet)
[S4] round=66 local utility u=0.034954 metrics={'f1_val': 0.9504028934315358, 'auprc': 0.9554797082895425, 'loss_val': 0.3189524793553, 'psi': 0.9524336193747385}-{'f1_val': 0.9456684689984688, 'auprc': 0.9409651321335646, 'loss_val': 0.3169097168877168, 'psi': 0.9437871342525072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=66 head_norm_before_train=1.915572 cos_to_last_merge=0.7220 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.722
[S5] round=66 local utility u=0.006330 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9988625291986143, 'loss_val': 0.021104630107734376, 'psi': 0.9975661927665203}-{'f1_val': 0.9967019684784577, 'auprc': 0.9950009765419795, 'loss_val': 0.022179624953999614, 'psi': 0.9960215717038664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=66 head_norm_before_train=1.919002 cos_to_last_merge=0.9712 (last merge round=40)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.9264702987812201, 'auprc': 0.974075337493232, 'loss_val': 0.22471632664704547, 'psi': 0.9455123142660249}-{'f1_val': 0.9417811056749309, 'auprc': 0.9829697604243358, 'loss_val': 0.17474749150906085, 'psi': 0.9582565675746929}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=2.164907 cos_to_last_merge=0.9946 (last merge round=35)
[S7] round=66 local utility u=0.016171 metrics={'f1_val': 0.6677013802910343, 'auprc': 0.8110264791832826, 'loss_val': 0.4939219150654129, 'psi': 0.7250314198479337}-{'f1_val': 0.659931750750006, 'auprc': 0.8124288593916531, 'loss_val': 0.4838541453285096, 'psi': 0.7209305942066648}
[S7] not sending this round → trigger blocked (psi=0.725)
[S8] START round=66 head_norm_before_train=1.609221 cos_to_last_merge=0.9863 (last merge round=40)
[S8] round=66 local utility u=0.018333 metrics={'f1_val': 0.9877803895057649, 'auprc': 0.998978123595504, 'loss_val': 0.04496101524885587, 'psi': 0.9922594831416605}-{'f1_val': 0.9831872218856248, 'auprc': 0.9988960083537446, 'loss_val': 0.05382260103815634, 'psi': 0.9894707364728726}
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] START round=66 head_norm_before_train=2.343729 (no previous merge yet)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9998728016518731, 'loss_val': 0.01580364002944854, 'psi': 0.998041772894367}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998627221212488, 'loss_val': 0.015586241514095255, 'psi': 0.9982051185720375}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.203864 (no previous merge yet)
[S10] round=66 local utility u=0.000012 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9973992322034896, 'loss_val': 0.025141250160887668, 'psi': 0.9959406048004416}-{'f1_val': 0.9949681865317428, 'auprc': 0.9973894262613455, 'loss_val': 0.02513613112687445, 'psi': 0.9959366824235839}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=66 head_norm_before_train=1.820942 cos_to_last_merge=0.9496 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.950
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9009003514145086, 'auprc': 0.9903676125132601, 'loss_val': 0.43354790590151066, 'psi': 0.9366872558540092}-{'f1_val': 0.9965470045135896, 'auprc': 0.9963127491784886, 'loss_val': 0.02285180396427663, 'psi': 0.9964533023795492}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.838512 cos_to_last_merge=0.9795 (last merge round=35)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6369776252853957, 'auprc': 0.6353532164059978, 'loss_val': 1.055215470189901, 'psi': 0.6363278617336365}-{'f1_val': 0.6941800174317734, 'auprc': 0.7182951018800607, 'loss_val': 0.9649855115295991, 'psi': 0.7038260512110883}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=1.988284 cos_to_last_merge=0.8088 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=66 local utility u=0.554815 metrics={'f1_val': 0.9967506042112828, 'auprc': 0.9990010557957796, 'loss_val': 0.02234620837273366, 'psi': 0.9976507848450815}-{'f1_val': 0.8787250043060142, 'auprc': 0.9985491058480218, 'loss_val': 0.4224672241513401, 'psi': 0.9266546449228172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=66 head_norm_before_train=1.620255 cos_to_last_merge=0.9449 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=66 local utility u=0.820020 metrics={'f1_val': 0.9835497343425732, 'auprc': 0.9961976838625987, 'loss_val': 0.09487705095818214, 'psi': 0.9886089141505834}-{'f1_val': 0.7739895729005469, 'auprc': 0.9890849793398258, 'loss_val': 0.4562170541306694, 'psi': 0.8600277354762584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=66 head_norm_before_train=2.131933 cos_to_last_merge=0.9969 (last merge round=41)
[S16] round=66 local utility u=0.347454 metrics={'f1_val': 0.9933629324616476, 'auprc': 0.9962683656651197, 'loss_val': 0.03125893924538011, 'psi': 0.9945251057430364}-{'f1_val': 0.9143458360416177, 'auprc': 0.9924918931499583, 'loss_val': 0.24073479804127018, 'psi': 0.945604258884954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=66 head_norm_before_train=1.921343 cos_to_last_merge=0.9879 (last merge round=39)
[S17] round=66 local utility u=0.134801 metrics={'f1_val': 0.5428549819760388, 'auprc': 0.8169641132068148, 'loss_val': 1.4420230253394122, 'psi': 0.6524986344683492}-{'f1_val': 0.5221376887457061, 'auprc': 0.8021949784633504, 'loss_val': 1.543013425767505, 'psi': 0.6341606046327638}
[S17] not sending this round → trigger blocked (psi=0.652)
[S2] START round=67 head_norm_before_train=2.116600 (no previous merge yet)
[S2] round=67 local utility u=0.090926 metrics={'f1_val': 0.828669014000204, 'auprc': 0.8635625046957761, 'loss_val': 0.4699186057664673, 'psi': 0.8426264102784329}-{'f1_val': 0.8317779327057064, 'auprc': 0.7964997852200371, 'loss_val': 0.4692360139309155, 'psi': 0.8176666737114386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=67 head_norm_before_train=2.247103 cos_to_last_merge=0.9719 (last merge round=37)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9093592972077492, 'auprc': 0.9981905218648638, 'loss_val': 0.1422225422561258, 'psi': 0.9448917870705951}-{'f1_val': 0.9343877879323572, 'auprc': 0.9935958039074498, 'loss_val': 0.22390673936842065, 'psi': 0.9580709943223943}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.003430 (no previous merge yet)
[S4] round=67 local utility u=0.043375 metrics={'f1_val': 0.955205195568675, 'auprc': 0.9697495878699687, 'loss_val': 0.30382647037671057, 'psi': 0.9610229524891925}-{'f1_val': 0.9504028934315358, 'auprc': 0.9554797082895425, 'loss_val': 0.3189524793553, 'psi': 0.9524336193747385}
[S4] not sending this round → trigger blocked (psi=0.961)
[S5] START round=67 head_norm_before_train=1.924388 cos_to_last_merge=0.7210 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.721
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9963760469397522, 'loss_val': 0.02118816679034282, 'psi': 0.9965715998629755}-{'f1_val': 0.9967019684784577, 'auprc': 0.9988625291986143, 'loss_val': 0.021104630107734376, 'psi': 0.9975661927665203}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.922914 cos_to_last_merge=0.9708 (last merge round=40)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.5747714008228051, 'auprc': 0.7275922465200946, 'loss_val': 1.2740836728882166, 'psi': 0.6358997391017209}-{'f1_val': 0.9264702987812201, 'auprc': 0.974075337493232, 'loss_val': 0.22471632664704547, 'psi': 0.9455123142660249}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=2.169231 cos_to_last_merge=0.9943 (last merge round=35)
[S7] round=67 local utility u=1.000000 metrics={'f1_val': 0.9073952227393336, 'auprc': 0.9727909657440894, 'loss_val': 0.19049125230677674, 'psi': 0.9335535199412359}-{'f1_val': 0.6677013802910343, 'auprc': 0.8110264791832826, 'loss_val': 0.4939219150654129, 'psi': 0.7250314198479337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=67 head_norm_before_train=1.616413 cos_to_last_merge=0.9859 (last merge round=40)
[S8] round=67 local utility u=0.019916 metrics={'f1_val': 0.993122746315827, 'auprc': 0.998945579017027, 'loss_val': 0.03708648221382345, 'psi': 0.995451879396307}-{'f1_val': 0.9877803895057649, 'auprc': 0.998978123595504, 'loss_val': 0.04496101524885587, 'psi': 0.9922594831416605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=67 head_norm_before_train=2.349110 (no previous merge yet)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9991544848671805, 'loss_val': 0.018961840512860203, 'psi': 0.9970076292773811}-{'f1_val': 0.9968210870560296, 'auprc': 0.9998728016518731, 'loss_val': 0.01580364002944854, 'psi': 0.998041772894367}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.208098 (no previous merge yet)
[S10] round=67 local utility u=0.000625 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9973804062097653, 'loss_val': 0.025152092181666825, 'psi': 0.9960648658955309}-{'f1_val': 0.9949681865317428, 'auprc': 0.9973992322034896, 'loss_val': 0.025141250160887668, 'psi': 0.9959406048004416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=67 head_norm_before_train=1.828020 cos_to_last_merge=0.9489 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=67 local utility u=0.088220 metrics={'f1_val': 0.8788858856486306, 'auprc': 0.9938874611337573, 'loss_val': 0.13558002880229103, 'psi': 0.9248865158426812}-{'f1_val': 0.9009003514145086, 'auprc': 0.9903676125132601, 'loss_val': 0.43354790590151066, 'psi': 0.9366872558540092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=67 head_norm_before_train=1.846454 cos_to_last_merge=0.9788 (last merge round=35)
[S13] round=67 local utility u=0.390791 metrics={'f1_val': 0.7270994916741995, 'auprc': 0.6774216507276447, 'loss_val': 0.9405690315469069, 'psi': 0.7072283552955776}-{'f1_val': 0.6369776252853957, 'auprc': 0.6353532164059978, 'loss_val': 1.055215470189901, 'psi': 0.6363278617336365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=67 head_norm_before_train=1.990360 cos_to_last_merge=0.8086 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9448178242661007, 'auprc': 0.9974124925645903, 'loss_val': 0.10204421220094295, 'psi': 0.9658556915854966}-{'f1_val': 0.9967506042112828, 'auprc': 0.9990010557957796, 'loss_val': 0.02234620837273366, 'psi': 0.9976507848450815}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.629449 cos_to_last_merge=0.9440 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.7739895729005469, 'auprc': 0.9891925615349899, 'loss_val': 0.46194503884677685, 'psi': 0.8600707683543242}-{'f1_val': 0.9835497343425732, 'auprc': 0.9961976838625987, 'loss_val': 0.09487705095818214, 'psi': 0.9886089141505834}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=2.133321 cos_to_last_merge=0.9969 (last merge round=41)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.988866199116393, 'auprc': 0.9865498345114758, 'loss_val': 0.050577889384642825, 'psi': 0.9879396532744261}-{'f1_val': 0.9933629324616476, 'auprc': 0.9962683656651197, 'loss_val': 0.03125893924538011, 'psi': 0.9945251057430364}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=1.927378 cos_to_last_merge=0.9876 (last merge round=39)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.4435176686097919, 'auprc': 0.7494057625084266, 'loss_val': 1.847752190553577, 'psi': 0.5658729061692458}-{'f1_val': 0.5428549819760388, 'auprc': 0.8169641132068148, 'loss_val': 1.4420230253394122, 'psi': 0.6524986344683492}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=2.116770 (no previous merge yet)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.6379941752614506, 'auprc': 0.749710554772598, 'loss_val': 1.5696060232857503, 'psi': 0.6826807270659095}-{'f1_val': 0.828669014000204, 'auprc': 0.8635625046957761, 'loss_val': 0.4699186057664673, 'psi': 0.8426264102784329}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.252948 cos_to_last_merge=0.9717 (last merge round=37)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.8394168805149659, 'auprc': 0.9982191143012195, 'loss_val': 0.25512539982706417, 'psi': 0.9029377740294673}-{'f1_val': 0.9093592972077492, 'auprc': 0.9981905218648638, 'loss_val': 0.1422225422561258, 'psi': 0.9448917870705951}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.997522 (no previous merge yet)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9474750078894565, 'auprc': 0.9494615793864094, 'loss_val': 0.32700060807918363, 'psi': 0.9482696364882377}-{'f1_val': 0.955205195568675, 'auprc': 0.9697495878699687, 'loss_val': 0.30382647037671057, 'psi': 0.9610229524891925}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.934537 cos_to_last_merge=0.7204 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.720
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935723816186627, 'loss_val': 0.02109687235500834, 'psi': 0.9954501337345396}-{'f1_val': 0.9967019684784577, 'auprc': 0.9963760469397522, 'loss_val': 0.02118816679034282, 'psi': 0.9965715998629755}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.926225 cos_to_last_merge=0.9705 (last merge round=40)
[S6] round=68 local utility u=1.000000 metrics={'f1_val': 0.8067575695091395, 'auprc': 0.9682432820694251, 'loss_val': 0.5049771690580884, 'psi': 0.8713518545332537}-{'f1_val': 0.5747714008228051, 'auprc': 0.7275922465200946, 'loss_val': 1.2740836728882166, 'psi': 0.6358997391017209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=68 head_norm_before_train=2.172347 cos_to_last_merge=0.9942 (last merge round=35)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.6775137011189541, 'auprc': 0.8310474360216233, 'loss_val': 0.3768109825515907, 'psi': 0.7389271950800218}-{'f1_val': 0.9073952227393336, 'auprc': 0.9727909657440894, 'loss_val': 0.19049125230677674, 'psi': 0.9335535199412359}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.624663 cos_to_last_merge=0.9855 (last merge round=40)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9850518562300145, 'auprc': 0.9987829455965894, 'loss_val': 0.048136870174047094, 'psi': 0.9905442919766445}-{'f1_val': 0.993122746315827, 'auprc': 0.998945579017027, 'loss_val': 0.03708648221382345, 'psi': 0.995451879396307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.349449 (no previous merge yet)
[S9] round=68 local utility u=0.005233 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999722090087896, 'loss_val': 0.0174542587570804, 'psi': 0.9979851906918507}-{'f1_val': 0.9955763922175147, 'auprc': 0.9991544848671805, 'loss_val': 0.018961840512860203, 'psi': 0.9970076292773811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=68 head_norm_before_train=2.211293 (no previous merge yet)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9970494780916087, 'loss_val': 0.025107336806964375, 'psi': 0.9959324946482684}-{'f1_val': 0.9951878390193748, 'auprc': 0.9973804062097653, 'loss_val': 0.025152092181666825, 'psi': 0.9960648658955309}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.833523 cos_to_last_merge=0.9484 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=68 local utility u=0.042726 metrics={'f1_val': 0.8915895962723444, 'auprc': 0.9939429945543252, 'loss_val': 0.1265178852832008, 'psi': 0.9325309555851367}-{'f1_val': 0.8788858856486306, 'auprc': 0.9938874611337573, 'loss_val': 0.13558002880229103, 'psi': 0.9248865158426812}
[S11] not sending this round → trigger blocked (psi=0.933)
[S13] START round=68 head_norm_before_train=1.851669 cos_to_last_merge=0.9783 (last merge round=35)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6479863406751681, 'auprc': 0.6563118555619419, 'loss_val': 1.1602657329050359, 'psi': 0.6513165466298776}-{'f1_val': 0.7270994916741995, 'auprc': 0.6774216507276447, 'loss_val': 0.9405690315469069, 'psi': 0.7072283552955776}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.991180 cos_to_last_merge=0.8082 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.808
[S14] round=68 local utility u=0.200521 metrics={'f1_val': 0.9975726192007187, 'auprc': 0.9989735192012202, 'loss_val': 0.022213220392504094, 'psi': 0.9981329792009194}-{'f1_val': 0.9448178242661007, 'auprc': 0.9974124925645903, 'loss_val': 0.10204421220094295, 'psi': 0.9658556915854966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=68 head_norm_before_train=1.638145 cos_to_last_merge=0.9431 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.7726778602151064, 'auprc': 0.9905259700594946, 'loss_val': 0.49389737592469074, 'psi': 0.8598171041528617}-{'f1_val': 0.7739895729005469, 'auprc': 0.9891925615349899, 'loss_val': 0.46194503884677685, 'psi': 0.8600707683543242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.134508 cos_to_last_merge=0.9968 (last merge round=41)
[S16] round=68 local utility u=0.030660 metrics={'f1_val': 0.9933459260524393, 'auprc': 0.991955477756787, 'loss_val': 0.03235248456109147, 'psi': 0.9927897467341784}-{'f1_val': 0.988866199116393, 'auprc': 0.9865498345114758, 'loss_val': 0.050577889384642825, 'psi': 0.9879396532744261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=68 head_norm_before_train=1.933017 cos_to_last_merge=0.9873 (last merge round=39)
[S17] round=68 local utility u=1.000000 metrics={'f1_val': 0.7285026779817625, 'auprc': 0.9016792685612565, 'loss_val': 0.9248501992224315, 'psi': 0.7977733142135601}-{'f1_val': 0.4435176686097919, 'auprc': 0.7494057625084266, 'loss_val': 1.847752190553577, 'psi': 0.5658729061692458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=69 head_norm_before_train=2.117654 (no previous merge yet)
[S2] round=69 local utility u=0.657436 metrics={'f1_val': 0.7263678352675399, 'auprc': 0.7715443952224279, 'loss_val': 0.8504778390160627, 'psi': 0.744438459249495}-{'f1_val': 0.6379941752614506, 'auprc': 0.749710554772598, 'loss_val': 1.5696060232857503, 'psi': 0.6826807270659095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=69 head_norm_before_train=2.261217 cos_to_last_merge=0.9713 (last merge round=37)
[S3] round=69 local utility u=0.159104 metrics={'f1_val': 0.8795793423030626, 'auprc': 0.9980352173001015, 'loss_val': 0.17734074122852928, 'psi': 0.9269616923018782}-{'f1_val': 0.8394168805149659, 'auprc': 0.9982191143012195, 'loss_val': 0.25512539982706417, 'psi': 0.9029377740294673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=69 head_norm_before_train=1.996020 (no previous merge yet)
[S4] round=69 local utility u=0.039694 metrics={'f1_val': 0.9529070212573668, 'auprc': 0.9600690450076611, 'loss_val': 0.31202793743338375, 'psi': 0.9557718307574845}-{'f1_val': 0.9474750078894565, 'auprc': 0.9494615793864094, 'loss_val': 0.32700060807918363, 'psi': 0.9482696364882377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=69 head_norm_before_train=1.944443 cos_to_last_merge=0.7194 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=69 local utility u=0.006858 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.99733112915415, 'loss_val': 0.020862285214260846, 'psi': 0.9971741868282986}-{'f1_val': 0.9967019684784577, 'auprc': 0.9935723816186627, 'loss_val': 0.02109687235500834, 'psi': 0.9954501337345396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=69 head_norm_before_train=1.928079 cos_to_last_merge=0.9704 (last merge round=40)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7415060522458288, 'auprc': 0.9541060417606799, 'loss_val': 0.6753397321689768, 'psi': 0.8265460480517692}-{'f1_val': 0.8067575695091395, 'auprc': 0.9682432820694251, 'loss_val': 0.5049771690580884, 'psi': 0.8713518545332537}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=2.175501 cos_to_last_merge=0.9940 (last merge round=35)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.6545226202022816, 'auprc': 0.8044293486395606, 'loss_val': 0.5563550121132032, 'psi': 0.7144853115771932}-{'f1_val': 0.6775137011189541, 'auprc': 0.8310474360216233, 'loss_val': 0.3768109825515907, 'psi': 0.7389271950800218}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.634068 cos_to_last_merge=0.9850 (last merge round=40)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9710166554689531, 'auprc': 0.9984571512672872, 'loss_val': 0.06785335716415407, 'psi': 0.9819928537882867}-{'f1_val': 0.9850518562300145, 'auprc': 0.9987829455965894, 'loss_val': 0.048136870174047094, 'psi': 0.9905442919766445}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.349774 (no previous merge yet)
[S9] round=69 local utility u=0.003957 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998877596932713, 'loss_val': 0.014406710323780242, 'psi': 0.998463394331355}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999722090087896, 'loss_val': 0.0174542587570804, 'psi': 0.9979851906918507}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=69 head_norm_before_train=2.213009 (no previous merge yet)
[S10] round=69 local utility u=0.000032 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974164217669743, 'loss_val': 0.024827093810925117, 'psi': 0.9959474806258355}-{'f1_val': 0.9951878390193748, 'auprc': 0.9970494780916087, 'loss_val': 0.025107336806964375, 'psi': 0.9959324946482684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=69 head_norm_before_train=1.839304 cos_to_last_merge=0.9478 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.8556827865984079, 'auprc': 0.9943507110148246, 'loss_val': 0.16858331712129374, 'psi': 0.9111499563649746}-{'f1_val': 0.8915895962723444, 'auprc': 0.9939429945543252, 'loss_val': 0.1265178852832008, 'psi': 0.9325309555851367}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.858413 cos_to_last_merge=0.9777 (last merge round=35)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6239063070068875, 'auprc': 0.6258230972575771, 'loss_val': 1.2220651026293243, 'psi': 0.6246730231071633}-{'f1_val': 0.6479863406751681, 'auprc': 0.6563118555619419, 'loss_val': 1.1602657329050359, 'psi': 0.6513165466298776}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=1.995778 cos_to_last_merge=0.8079 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.808
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.933787510394962, 'auprc': 0.9986447747849732, 'loss_val': 0.16701646604814555, 'psi': 0.9597304161509665}-{'f1_val': 0.9975726192007187, 'auprc': 0.9989735192012202, 'loss_val': 0.022213220392504094, 'psi': 0.9981329792009194}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.647295 cos_to_last_merge=0.9422 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=69 local utility u=0.904222 metrics={'f1_val': 0.9958486957917267, 'auprc': 0.9920732751745086, 'loss_val': 0.02912112105556885, 'psi': 0.9943385275448395}-{'f1_val': 0.7726778602151064, 'auprc': 0.9905259700594946, 'loss_val': 0.49389737592469074, 'psi': 0.8598171041528617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=69 head_norm_before_train=2.139282 cos_to_last_merge=0.9968 (last merge round=41)
[S16] round=69 local utility u=0.005254 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9966730440737117, 'loss_val': 0.03478287161257973, 'psi': 0.9945553971194981}-{'f1_val': 0.9933459260524393, 'auprc': 0.991955477756787, 'loss_val': 0.03235248456109147, 'psi': 0.9927897467341784}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=69 head_norm_before_train=1.938233 cos_to_last_merge=0.9871 (last merge round=39)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6820426218296785, 'auprc': 0.9100949237589154, 'loss_val': 1.0218303914702798, 'psi': 0.7732635426013732}-{'f1_val': 0.7285026779817625, 'auprc': 0.9016792685612565, 'loss_val': 0.9248501992224315, 'psi': 0.7977733142135601}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.121721 (no previous merge yet)
[S2] round=70 local utility u=0.623317 metrics={'f1_val': 0.8245775048020035, 'auprc': 0.8680177454229827, 'loss_val': 0.48252288819735367, 'psi': 0.8419536010503952}-{'f1_val': 0.7263678352675399, 'auprc': 0.7715443952224279, 'loss_val': 0.8504778390160627, 'psi': 0.744438459249495}
[S2] not sending this round → trigger blocked (psi=0.842)
[S3] START round=70 head_norm_before_train=2.271084 cos_to_last_merge=0.9709 (last merge round=37)
[S3] round=70 local utility u=0.393067 metrics={'f1_val': 0.9881874584154944, 'auprc': 0.9986839027411712, 'loss_val': 0.0448005078982657, 'psi': 0.992386036145765}-{'f1_val': 0.8795793423030626, 'auprc': 0.9980352173001015, 'loss_val': 0.17734074122852928, 'psi': 0.9269616923018782}
[S3] not sending this round → trigger blocked (psi=0.992)
[S4] START round=70 head_norm_before_train=1.990566 (no previous merge yet)
[S4] round=70 local utility u=0.007296 metrics={'f1_val': 0.9533448714248326, 'auprc': 0.9630651332943148, 'loss_val': 0.3090508072727248, 'psi': 0.9572329761726255}-{'f1_val': 0.9529070212573668, 'auprc': 0.9600690450076611, 'loss_val': 0.31202793743338375, 'psi': 0.9557718307574845}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=70 head_norm_before_train=1.948503 cos_to_last_merge=0.7188 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9930400732397875, 'loss_val': 0.02111745588643856, 'psi': 0.9952372103829896}-{'f1_val': 0.9970695586110643, 'auprc': 0.99733112915415, 'loss_val': 0.020862285214260846, 'psi': 0.9971741868282986}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.934312 cos_to_last_merge=0.9699 (last merge round=40)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6155924582515968, 'auprc': 0.9122336090616195, 'loss_val': 1.0943963400953611, 'psi': 0.7342489185756058}-{'f1_val': 0.7415060522458288, 'auprc': 0.9541060417606799, 'loss_val': 0.6753397321689768, 'psi': 0.8265460480517692}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=2.182335 cos_to_last_merge=0.9937 (last merge round=35)
[S7] round=70 local utility u=0.930774 metrics={'f1_val': 0.8356953704871861, 'auprc': 0.9382750140154277, 'loss_val': 0.1833802207292437, 'psi': 0.8767272278984828}-{'f1_val': 0.6545226202022816, 'auprc': 0.8044293486395606, 'loss_val': 0.5563550121132032, 'psi': 0.7144853115771932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=70 head_norm_before_train=1.640709 cos_to_last_merge=0.9846 (last merge round=40)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.7139293602936292, 'auprc': 0.9811760962463332, 'loss_val': 0.6011508608634597, 'psi': 0.8208280546747109}-{'f1_val': 0.9710166554689531, 'auprc': 0.9984571512672872, 'loss_val': 0.06785335716415407, 'psi': 0.9819928537882867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.357059 (no previous merge yet)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998671692533332, 'loss_val': 0.014350782508821906, 'psi': 0.9984551581553798}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998877596932713, 'loss_val': 0.014406710323780242, 'psi': 0.998463394331355}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.217029 (no previous merge yet)
[S10] round=70 local utility u=0.000049 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974160126478541, 'loss_val': 0.024727380442617047, 'psi': 0.9959473169781874}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974164217669743, 'loss_val': 0.024827093810925117, 'psi': 0.9959474806258355}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=70 head_norm_before_train=1.845289 cos_to_last_merge=0.9473 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=70 local utility u=0.486633 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9958453469950679, 'loss_val': 0.04262869900219459, 'psi': 0.9960306236444744}-{'f1_val': 0.8556827865984079, 'auprc': 0.9943507110148246, 'loss_val': 0.16858331712129374, 'psi': 0.9111499563649746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=70 head_norm_before_train=1.865504 cos_to_last_merge=0.9770 (last merge round=35)
[S13] round=70 local utility u=0.622256 metrics={'f1_val': 0.7292698196319147, 'auprc': 0.6966767016843186, 'loss_val': 0.8222944603629442, 'psi': 0.7162325724528763}-{'f1_val': 0.6239063070068875, 'auprc': 0.6258230972575771, 'loss_val': 1.2220651026293243, 'psi': 0.6246730231071633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=70 head_norm_before_train=1.995947 cos_to_last_merge=0.8074 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.807
[S14] round=70 local utility u=0.095467 metrics={'f1_val': 0.952264969780188, 'auprc': 0.9986479387132275, 'loss_val': 0.08695669435243886, 'psi': 0.9708181573534038}-{'f1_val': 0.933787510394962, 'auprc': 0.9986447747849732, 'loss_val': 0.16701646604814555, 'psi': 0.9597304161509665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=70 head_norm_before_train=1.657139 cos_to_last_merge=0.9412 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.7708081149951782, 'auprc': 0.9887125131064405, 'loss_val': 0.5208392128389469, 'psi': 0.8579698742396831}-{'f1_val': 0.9958486957917267, 'auprc': 0.9920732751745086, 'loss_val': 0.02912112105556885, 'psi': 0.9943385275448395}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=2.142483 cos_to_last_merge=0.9965 (last merge round=41)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9929001652683519, 'auprc': 0.9961287867674593, 'loss_val': 0.034505376349529604, 'psi': 0.9941916138679949}-{'f1_val': 0.9931436324833557, 'auprc': 0.9966730440737117, 'loss_val': 0.03478287161257973, 'psi': 0.9945553971194981}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=1.943712 cos_to_last_merge=0.9868 (last merge round=39)
[S17] round=70 local utility u=0.649103 metrics={'f1_val': 0.8269763164185508, 'auprc': 0.9280988385444899, 'loss_val': 0.647237506852469, 'psi': 0.8674253252689265}-{'f1_val': 0.6820426218296785, 'auprc': 0.9100949237589154, 'loss_val': 1.0218303914702798, 'psi': 0.7732635426013732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=71 head_norm_before_train=2.127271 (no previous merge yet)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7128628913591548, 'auprc': 0.7608992022537846, 'loss_val': 1.0123577755387088, 'psi': 0.7320774157170067}-{'f1_val': 0.8245775048020035, 'auprc': 0.8680177454229827, 'loss_val': 0.48252288819735367, 'psi': 0.8419536010503952}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.281191 cos_to_last_merge=0.9704 (last merge round=37)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8793580039235706, 'auprc': 0.9978089824427645, 'loss_val': 0.18343533756683675, 'psi': 0.926738395331248}-{'f1_val': 0.9881874584154944, 'auprc': 0.9986839027411712, 'loss_val': 0.0448005078982657, 'psi': 0.992386036145765}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.989508 (no previous merge yet)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.948074102302141, 'auprc': 0.9574084189190265, 'loss_val': 0.31886665624068333, 'psi': 0.9518078289488952}-{'f1_val': 0.9533448714248326, 'auprc': 0.9630651332943148, 'loss_val': 0.3090508072727248, 'psi': 0.9572329761726255}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.953520 cos_to_last_merge=0.7182 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=71 local utility u=0.005241 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9961406614297637, 'loss_val': 0.01993793012089892, 'psi': 0.99647744565898}-{'f1_val': 0.9967019684784577, 'auprc': 0.9930400732397875, 'loss_val': 0.02111745588643856, 'psi': 0.9952372103829896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=71 head_norm_before_train=1.937925 cos_to_last_merge=0.9689 (last merge round=40)
[S6] round=71 local utility u=0.664069 metrics={'f1_val': 0.7352632420070023, 'auprc': 0.9540625549333045, 'loss_val': 0.6097690841149374, 'psi': 0.8227829671775232}-{'f1_val': 0.6155924582515968, 'auprc': 0.9122336090616195, 'loss_val': 1.0943963400953611, 'psi': 0.7342489185756058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=71 head_norm_before_train=2.188505 cos_to_last_merge=0.9935 (last merge round=35)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6400603300408115, 'auprc': 0.8038780691908765, 'loss_val': 0.5956769305333871, 'psi': 0.7055874257008374}-{'f1_val': 0.8356953704871861, 'auprc': 0.9382750140154277, 'loss_val': 0.1833802207292437, 'psi': 0.8767272278984828}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.645201 cos_to_last_merge=0.9844 (last merge round=40)
[S8] round=71 local utility u=1.000000 metrics={'f1_val': 0.9832928559309241, 'auprc': 0.9968206795562703, 'loss_val': 0.0504787957710745, 'psi': 0.9887039853810625}-{'f1_val': 0.7139293602936292, 'auprc': 0.9811760962463332, 'loss_val': 0.6011508608634597, 'psi': 0.8208280546747109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=71 head_norm_before_train=2.365208 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998459696038671, 'loss_val': 0.0156670888982373, 'psi': 0.9977010052797906}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998671692533332, 'loss_val': 0.014350782508821906, 'psi': 0.9984551581553798}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.222404 (no previous merge yet)
[S10] round=71 local utility u=0.000030 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9970541187839578, 'loss_val': 0.024899338244468, 'psi': 0.9959343509252079}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974160126478541, 'loss_val': 0.024727380442617047, 'psi': 0.9959473169781874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=71 head_norm_before_train=1.851870 cos_to_last_merge=0.9466 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=71 local utility u=0.009099 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9960771598195185, 'loss_val': 0.02500276577454452, 'psi': 0.996111068875793}-{'f1_val': 0.9961541414107454, 'auprc': 0.9958453469950679, 'loss_val': 0.04262869900219459, 'psi': 0.9960306236444744}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=71 head_norm_before_train=1.871148 cos_to_last_merge=0.9765 (last merge round=35)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.7262327483698716, 'auprc': 0.6492589335364021, 'loss_val': 1.098602652067215, 'psi': 0.6954432224364838}-{'f1_val': 0.7292698196319147, 'auprc': 0.6966767016843186, 'loss_val': 0.8222944603629442, 'psi': 0.7162325724528763}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=2.000710 cos_to_last_merge=0.8069 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.807
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.8801860082524962, 'auprc': 0.9925541827052736, 'loss_val': 0.5636712341143508, 'psi': 0.9251332780336071}-{'f1_val': 0.952264969780188, 'auprc': 0.9986479387132275, 'loss_val': 0.08695669435243886, 'psi': 0.9708181573534038}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.667055 cos_to_last_merge=0.9403 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8919716054725617, 'loss_val': 0.6645247304681439, 'psi': 0.7772495197697007}-{'f1_val': 0.7708081149951782, 'auprc': 0.9887125131064405, 'loss_val': 0.5208392128389469, 'psi': 0.8579698742396831}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=2.144464 cos_to_last_merge=0.9962 (last merge round=41)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9929499089596623, 'auprc': 0.9938885680782343, 'loss_val': 0.030310697292077055, 'psi': 0.9933253726070911}-{'f1_val': 0.9929001652683519, 'auprc': 0.9961287867674593, 'loss_val': 0.034505376349529604, 'psi': 0.9941916138679949}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.950424 cos_to_last_merge=0.9865 (last merge round=39)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.7818348538024591, 'auprc': 0.8996685704820038, 'loss_val': 0.7859416448461671, 'psi': 0.8289683404742769}-{'f1_val': 0.8269763164185508, 'auprc': 0.9280988385444899, 'loss_val': 0.647237506852469, 'psi': 0.8674253252689265}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.132674 (no previous merge yet)
[S2] round=72 local utility u=0.265548 metrics={'f1_val': 0.7515497038920173, 'auprc': 0.7555121388928658, 'loss_val': 0.6972218983060382, 'psi': 0.7531346778923567}-{'f1_val': 0.7128628913591548, 'auprc': 0.7608992022537846, 'loss_val': 1.0123577755387088, 'psi': 0.7320774157170067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=72 head_norm_before_train=2.290299 cos_to_last_merge=0.9699 (last merge round=37)
[S3] round=72 local utility u=0.135379 metrics={'f1_val': 0.9410040235215229, 'auprc': 0.9827114446921852, 'loss_val': 0.23726077682472138, 'psi': 0.9576869919897878}-{'f1_val': 0.8793580039235706, 'auprc': 0.9978089824427645, 'loss_val': 0.18343533756683675, 'psi': 0.926738395331248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=72 head_norm_before_train=1.993910 (no previous merge yet)
[S4] round=72 local utility u=0.016326 metrics={'f1_val': 0.9544231506290692, 'auprc': 0.9545233512121267, 'loss_val': 0.31565460359135966, 'psi': 0.9544632308622922}-{'f1_val': 0.948074102302141, 'auprc': 0.9574084189190265, 'loss_val': 0.31886665624068333, 'psi': 0.9518078289488952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=72 head_norm_before_train=1.962090 cos_to_last_merge=0.7175 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.717
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9958406008839329, 'loss_val': 0.02104461878282593, 'psi': 0.9963574214406478}-{'f1_val': 0.9967019684784577, 'auprc': 0.9961406614297637, 'loss_val': 0.01993793012089892, 'psi': 0.99647744565898}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.941710 cos_to_last_merge=0.9681 (last merge round=40)
[S6] round=72 local utility u=0.253526 metrics={'f1_val': 0.794701474497366, 'auprc': 0.9652864841687823, 'loss_val': 0.49301885867629786, 'psi': 0.8629354783659324}-{'f1_val': 0.7352632420070023, 'auprc': 0.9540625549333045, 'loss_val': 0.6097690841149374, 'psi': 0.8227829671775232}
[S6] not sending this round → trigger blocked (psi=0.863)
[S7] START round=72 head_norm_before_train=2.191126 cos_to_last_merge=0.9934 (last merge round=35)
[S7] round=72 local utility u=0.304030 metrics={'f1_val': 0.6945293040484009, 'auprc': 0.8301791431813811, 'loss_val': 0.39333466226366676, 'psi': 0.748789239701593}-{'f1_val': 0.6400603300408115, 'auprc': 0.8038780691908765, 'loss_val': 0.5956769305333871, 'psi': 0.7055874257008374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=72 head_norm_before_train=1.649162 cos_to_last_merge=0.9842 (last merge round=40)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9719769161339837, 'auprc': 0.9954440885696072, 'loss_val': 0.06622633654581275, 'psi': 0.9813637851082331}-{'f1_val': 0.9832928559309241, 'auprc': 0.9968206795562703, 'loss_val': 0.0504787957710745, 'psi': 0.9887039853810625}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.373701 (no previous merge yet)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9950183367404014, 'auprc': 0.9998327183169751, 'loss_val': 0.0195786321810525, 'psi': 0.9969440893710309}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998459696038671, 'loss_val': 0.0156670888982373, 'psi': 0.9977010052797906}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.228292 (no previous merge yet)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9971509372390235, 'loss_val': 0.024877478812698396, 'psi': 0.9958412868146551}-{'f1_val': 0.9951878390193748, 'auprc': 0.9970541187839578, 'loss_val': 0.024899338244468, 'psi': 0.9959343509252079}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=1.856976 cos_to_last_merge=0.9462 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=72 local utility u=0.001338 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962811632378004, 'loss_val': 0.02293792837463709, 'psi': 0.9961926702431058}-{'f1_val': 0.9961336749133093, 'auprc': 0.9960771598195185, 'loss_val': 0.02500276577454452, 'psi': 0.996111068875793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=72 head_norm_before_train=1.876915 cos_to_last_merge=0.9760 (last merge round=35)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6088321979383822, 'auprc': 0.6285635739665347, 'loss_val': 1.2881598226638808, 'psi': 0.6167247483496432}-{'f1_val': 0.7262327483698716, 'auprc': 0.6492589335364021, 'loss_val': 1.098602652067215, 'psi': 0.6954432224364838}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.007592 cos_to_last_merge=0.8064 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.806
[S14] round=72 local utility u=0.274396 metrics={'f1_val': 0.9135486168075614, 'auprc': 0.9990294175895342, 'loss_val': 0.23448023297314902, 'psi': 0.9477409371203505}-{'f1_val': 0.8801860082524962, 'auprc': 0.9925541827052736, 'loss_val': 0.5636712341143508, 'psi': 0.9251332780336071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=72 head_norm_before_train=1.677176 cos_to_last_merge=0.9393 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8355001304387015, 'loss_val': 0.6896369904736148, 'psi': 0.7546609297561566}-{'f1_val': 0.7007681293011265, 'auprc': 0.8919716054725617, 'loss_val': 0.6645247304681439, 'psi': 0.7772495197697007}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=2.143849 cos_to_last_merge=0.9960 (last merge round=41)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9934416310264214, 'auprc': 0.9878779805735018, 'loss_val': 0.03276754091065358, 'psi': 0.9912161708452536}-{'f1_val': 0.9929499089596623, 'auprc': 0.9938885680782343, 'loss_val': 0.030310697292077055, 'psi': 0.9933253726070911}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.957041 cos_to_last_merge=0.9861 (last merge round=39)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.5854526534745474, 'auprc': 0.8084751739549934, 'loss_val': 1.6912813568742011, 'psi': 0.6746616616667258}-{'f1_val': 0.7818348538024591, 'auprc': 0.8996685704820038, 'loss_val': 0.7859416448461671, 'psi': 0.8289683404742769}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.136769 (no previous merge yet)
[S2] round=73 local utility u=0.512709 metrics={'f1_val': 0.8289299416659172, 'auprc': 0.8592356735551445, 'loss_val': 0.44725550768542455, 'psi': 0.841052234421608}-{'f1_val': 0.7515497038920173, 'auprc': 0.7555121388928658, 'loss_val': 0.6972218983060382, 'psi': 0.7531346778923567}
[S2] not sending this round → trigger blocked (psi=0.841)
[S3] START round=73 head_norm_before_train=2.299287 cos_to_last_merge=0.9694 (last merge round=37)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.66227613435526, 'auprc': 0.997588389387665, 'loss_val': 0.547877797766404, 'psi': 0.796401036368222}-{'f1_val': 0.9410040235215229, 'auprc': 0.9827114446921852, 'loss_val': 0.23726077682472138, 'psi': 0.9576869919897878}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.993647 (no previous merge yet)
[S4] round=73 local utility u=0.024314 metrics={'f1_val': 0.9561840030576445, 'auprc': 0.9650750763057765, 'loss_val': 0.3092461227844921, 'psi': 0.9597404323568972}-{'f1_val': 0.9544231506290692, 'auprc': 0.9545233512121267, 'loss_val': 0.31565460359135966, 'psi': 0.9544632308622922}
[S4] not sending this round → trigger blocked (psi=0.960)
[S5] START round=73 head_norm_before_train=1.961963 cos_to_last_merge=0.7172 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.717
[S5] round=73 local utility u=0.003323 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994780452292642, 'loss_val': 0.025311126778706266, 'psi': 0.9978123991787803}-{'f1_val': 0.9967019684784577, 'auprc': 0.9958406008839329, 'loss_val': 0.02104461878282593, 'psi': 0.9963574214406478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=73 head_norm_before_train=1.949025 cos_to_last_merge=0.9671 (last merge round=40)
[S6] round=73 local utility u=0.038567 metrics={'f1_val': 0.8116955356066304, 'auprc': 0.9639619846925283, 'loss_val': 0.5138752637186134, 'psi': 0.8726021152409895}-{'f1_val': 0.794701474497366, 'auprc': 0.9652864841687823, 'loss_val': 0.49301885867629786, 'psi': 0.8629354783659324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=73 head_norm_before_train=2.194133 cos_to_last_merge=0.9932 (last merge round=35)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6798902498708514, 'auprc': 0.8199911940209752, 'loss_val': 0.5005354823025079, 'psi': 0.735930627530901}-{'f1_val': 0.6945293040484009, 'auprc': 0.8301791431813811, 'loss_val': 0.39333466226366676, 'psi': 0.748789239701593}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=1.654690 cos_to_last_merge=0.9840 (last merge round=40)
[S8] round=73 local utility u=0.015028 metrics={'f1_val': 0.9811793992884775, 'auprc': 0.9909336868560322, 'loss_val': 0.07785324700580545, 'psi': 0.9850811143154994}-{'f1_val': 0.9719769161339837, 'auprc': 0.9954440885696072, 'loss_val': 0.06622633654581275, 'psi': 0.9813637851082331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=73 head_norm_before_train=2.380157 (no previous merge yet)
[S9] round=73 local utility u=0.008464 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999833094826754, 'loss_val': 0.01515995961258444, 'psi': 0.9981949854379872}-{'f1_val': 0.9950183367404014, 'auprc': 0.9998327183169751, 'loss_val': 0.0195786321810525, 'psi': 0.9969440893710309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=73 head_norm_before_train=2.234482 (no previous merge yet)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9970766648743222, 'loss_val': 0.02488656210379456, 'psi': 0.9958115778687746}-{'f1_val': 0.9949681865317428, 'auprc': 0.9971509372390235, 'loss_val': 0.024877478812698396, 'psi': 0.9958412868146551}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.863194 cos_to_last_merge=0.9456 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=73 local utility u=0.000634 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965974638079284, 'loss_val': 0.022618400661787358, 'psi': 0.9963191904711569}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962811632378004, 'loss_val': 0.02293792837463709, 'psi': 0.9961926702431058}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=73 head_norm_before_train=1.880700 cos_to_last_merge=0.9757 (last merge round=35)
[S13] round=73 local utility u=0.673261 metrics={'f1_val': 0.670130802946123, 'auprc': 0.8094790401545634, 'loss_val': 0.8521756679136276, 'psi': 0.7258700978294992}-{'f1_val': 0.6088321979383822, 'auprc': 0.6285635739665347, 'loss_val': 1.2881598226638808, 'psi': 0.6167247483496432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=73 head_norm_before_train=2.013808 cos_to_last_merge=0.8057 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.806
[S14] round=73 local utility u=0.360762 metrics={'f1_val': 0.9980128044262995, 'auprc': 0.9989857771933875, 'loss_val': 0.01960988461664606, 'psi': 0.9984019935331347}-{'f1_val': 0.9135486168075614, 'auprc': 0.9990294175895342, 'loss_val': 0.23448023297314902, 'psi': 0.9477409371203505}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=73 head_norm_before_train=1.686290 cos_to_last_merge=0.9385 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=73 local utility u=1.000000 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9920669783058621, 'loss_val': 0.0293278388760291, 'psi': 0.9943773859019475}-{'f1_val': 0.7007681293011265, 'auprc': 0.8355001304387015, 'loss_val': 0.6896369904736148, 'psi': 0.7546609297561566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=73 head_norm_before_train=2.146629 cos_to_last_merge=0.9959 (last merge round=41)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9464146109870902, 'auprc': 0.9872179055646619, 'loss_val': 0.21519095710182612, 'psi': 0.962735928818119}-{'f1_val': 0.9934416310264214, 'auprc': 0.9878779805735018, 'loss_val': 0.03276754091065358, 'psi': 0.9912161708452536}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.963575 cos_to_last_merge=0.9857 (last merge round=39)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.5482067975275011, 'auprc': 0.7966547134299435, 'loss_val': 1.8176575776539792, 'psi': 0.6475859638884781}-{'f1_val': 0.5854526534745474, 'auprc': 0.8084751739549934, 'loss_val': 1.6912813568742011, 'psi': 0.6746616616667258}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.139449 (no previous merge yet)
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.8029851297405685, 'auprc': 0.8540045976323202, 'loss_val': 0.5584431094815113, 'psi': 0.8233929168972691}-{'f1_val': 0.8289299416659172, 'auprc': 0.8592356735551445, 'loss_val': 0.44725550768542455, 'psi': 0.841052234421608}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.307291 cos_to_last_merge=0.9691 (last merge round=37)
[S3] round=74 local utility u=1.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9994716134311934, 'loss_val': 0.15032345408346437, 'psi': 0.9764577997131688}-{'f1_val': 0.66227613435526, 'auprc': 0.997588389387665, 'loss_val': 0.547877797766404, 'psi': 0.796401036368222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=74 head_norm_before_train=1.994063 (no previous merge yet)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9372933980174324, 'auprc': 0.9440931698487538, 'loss_val': 0.3412381220801573, 'psi': 0.940013306749961}-{'f1_val': 0.9561840030576445, 'auprc': 0.9650750763057765, 'loss_val': 0.3092461227844921, 'psi': 0.9597404323568972}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.966255 cos_to_last_merge=0.7164 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.716
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.992522723690596, 'loss_val': 0.020947764679834502, 'psi': 0.995030270563313}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994780452292642, 'loss_val': 0.025311126778706266, 'psi': 0.9978123991787803}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.954324 cos_to_last_merge=0.9659 (last merge round=40)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.7019733828733029, 'auprc': 0.9468216563931241, 'loss_val': 0.7977844086838094, 'psi': 0.7999126922812314}-{'f1_val': 0.8116955356066304, 'auprc': 0.9639619846925283, 'loss_val': 0.5138752637186134, 'psi': 0.8726021152409895}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=2.199291 cos_to_last_merge=0.9928 (last merge round=35)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6416387051940453, 'auprc': 0.8067356673949604, 'loss_val': 0.5697788330292269, 'psi': 0.7076774900744114}-{'f1_val': 0.6798902498708514, 'auprc': 0.8199911940209752, 'loss_val': 0.5005354823025079, 'psi': 0.735930627530901}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.660405 cos_to_last_merge=0.9838 (last merge round=40)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.8808282787526129, 'auprc': 0.995180665790653, 'loss_val': 0.20621957690507225, 'psi': 0.9265692335678289}-{'f1_val': 0.9811793992884775, 'auprc': 0.9909336868560322, 'loss_val': 0.07785324700580545, 'psi': 0.9850811143154994}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.386506 (no previous merge yet)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9962380931774885, 'auprc': 0.999884629158454, 'loss_val': 0.016962554372326105, 'psi': 0.9976967075698746}-{'f1_val': 0.9971029125121428, 'auprc': 0.999833094826754, 'loss_val': 0.01515995961258444, 'psi': 0.9981949854379872}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.240647 (no previous merge yet)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.997077561349264, 'loss_val': 0.024904919824395577, 'psi': 0.9958119364587512}-{'f1_val': 0.9949681865317428, 'auprc': 0.9970766648743222, 'loss_val': 0.02488656210379456, 'psi': 0.9958115778687746}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.869851 cos_to_last_merge=0.9449 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9963895881604737, 'loss_val': 0.0406454970597093, 'psi': 0.9962483201106367}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965974638079284, 'loss_val': 0.022618400661787358, 'psi': 0.9963191904711569}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.883702 cos_to_last_merge=0.9755 (last merge round=35)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6600304733250657, 'auprc': 0.6570389067741745, 'loss_val': 1.1908304125792322, 'psi': 0.6588338467047092}-{'f1_val': 0.670130802946123, 'auprc': 0.8094790401545634, 'loss_val': 0.8521756679136276, 'psi': 0.7258700978294992}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.018343 cos_to_last_merge=0.8051 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.805
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9821513763166602, 'auprc': 0.9989603055729692, 'loss_val': 0.039991265283843405, 'psi': 0.9888749480191837}-{'f1_val': 0.9980128044262995, 'auprc': 0.9989857771933875, 'loss_val': 0.01960988461664606, 'psi': 0.9984019935331347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.694549 cos_to_last_merge=0.9377 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.7563652343037198, 'auprc': 0.9713541068796218, 'loss_val': 0.5761200535671047, 'psi': 0.8423607833340806}-{'f1_val': 0.9959176576326709, 'auprc': 0.9920669783058621, 'loss_val': 0.0293278388760291, 'psi': 0.9943773859019475}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.151816 cos_to_last_merge=0.9959 (last merge round=41)
[S16] round=74 local utility u=0.059549 metrics={'f1_val': 0.948286653500489, 'auprc': 0.9917052071863819, 'loss_val': 0.12078643090747451, 'psi': 0.9656540749748461}-{'f1_val': 0.9464146109870902, 'auprc': 0.9872179055646619, 'loss_val': 0.21519095710182612, 'psi': 0.962735928818119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=74 head_norm_before_train=1.968933 cos_to_last_merge=0.9854 (last merge round=39)
[S17] round=74 local utility u=0.345000 metrics={'f1_val': 0.5698847130153034, 'auprc': 0.8447273627399567, 'loss_val': 1.4019422172421119, 'psi': 0.6798217729051648}-{'f1_val': 0.5482067975275011, 'auprc': 0.7966547134299435, 'loss_val': 1.8176575776539792, 'psi': 0.6475859638884781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=75 head_norm_before_train=2.142308 (no previous merge yet)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7750672500164058, 'auprc': 0.7463246064103577, 'loss_val': 0.6404069858383633, 'psi': 0.7635701925739866}-{'f1_val': 0.8029851297405685, 'auprc': 0.8540045976323202, 'loss_val': 0.5584431094815113, 'psi': 0.8233929168972691}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.315255 cos_to_last_merge=0.9686 (last merge round=37)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.99326429890249, 'loss_val': 0.16068831426878452, 'psi': 0.9739507708006683}-{'f1_val': 0.9611152572344858, 'auprc': 0.9994716134311934, 'loss_val': 0.15032345408346437, 'psi': 0.9764577997131688}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.997304 (no previous merge yet)
[S4] round=75 local utility u=0.045573 metrics={'f1_val': 0.9439409057635668, 'auprc': 0.9567107322337426, 'loss_val': 0.32782947366776444, 'psi': 0.9490488363516371}-{'f1_val': 0.9372933980174324, 'auprc': 0.9440931698487538, 'loss_val': 0.3412381220801573, 'psi': 0.940013306749961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=75 head_norm_before_train=1.969521 cos_to_last_merge=0.7158 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.716
[S5] round=75 local utility u=0.010626 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9995964675095632, 'loss_val': 0.023123295504433993, 'psi': 0.9980803221704639}-{'f1_val': 0.9967019684784577, 'auprc': 0.992522723690596, 'loss_val': 0.020947764679834502, 'psi': 0.995030270563313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=75 head_norm_before_train=1.960993 cos_to_last_merge=0.9649 (last merge round=40)
[S6] round=75 local utility u=0.086165 metrics={'f1_val': 0.701032967334479, 'auprc': 0.9540440141624554, 'loss_val': 0.6414786109704689, 'psi': 0.8022373860656695}-{'f1_val': 0.7019733828733029, 'auprc': 0.9468216563931241, 'loss_val': 0.7977844086838094, 'psi': 0.7999126922812314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=75 head_norm_before_train=2.201152 cos_to_last_merge=0.9927 (last merge round=35)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6280102329718231, 'auprc': 0.7973739359388426, 'loss_val': 0.7684281071701901, 'psi': 0.6957557141586309}-{'f1_val': 0.6416387051940453, 'auprc': 0.8067356673949604, 'loss_val': 0.5697788330292269, 'psi': 0.7076774900744114}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=1.664173 cos_to_last_merge=0.9839 (last merge round=40)
[S8] round=75 local utility u=0.421186 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9983770444290085, 'loss_val': 0.04063461086801122, 'psi': 0.9945675238735546}-{'f1_val': 0.8808282787526129, 'auprc': 0.995180665790653, 'loss_val': 0.20621957690507225, 'psi': 0.9265692335678289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=75 head_norm_before_train=2.392066 (no previous merge yet)
[S9] round=75 local utility u=0.000963 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988053846008469, 'loss_val': 0.016987715445710903, 'psi': 0.9977839013476244}-{'f1_val': 0.9962380931774885, 'auprc': 0.999884629158454, 'loss_val': 0.016962554372326105, 'psi': 0.9976967075698746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=75 head_norm_before_train=2.246906 (no previous merge yet)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9970480636511917, 'loss_val': 0.02496456607397434, 'psi': 0.9958001373795224}-{'f1_val': 0.9949681865317428, 'auprc': 0.997077561349264, 'loss_val': 0.024904919824395577, 'psi': 0.9958119364587512}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.876193 cos_to_last_merge=0.9444 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9589610276262541, 'auprc': 0.9962411199408525, 'loss_val': 0.08076608035281016, 'psi': 0.9738730645520934}-{'f1_val': 0.9961541414107454, 'auprc': 0.9963895881604737, 'loss_val': 0.0406454970597093, 'psi': 0.9962483201106367}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.886573 cos_to_last_merge=0.9753 (last merge round=35)
[S13] round=75 local utility u=0.393953 metrics={'f1_val': 0.6983673976903515, 'auprc': 0.7465330492203182, 'loss_val': 0.9014283767486765, 'psi': 0.7176336583023382}-{'f1_val': 0.6600304733250657, 'auprc': 0.6570389067741745, 'loss_val': 1.1908304125792322, 'psi': 0.6588338467047092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=75 head_norm_before_train=2.021967 cos_to_last_merge=0.8049 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.805
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9153639216851782, 'auprc': 0.9986408069624813, 'loss_val': 0.2126260950562226, 'psi': 0.9486746757960994}-{'f1_val': 0.9821513763166602, 'auprc': 0.9989603055729692, 'loss_val': 0.039991265283843405, 'psi': 0.9888749480191837}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=1.703642 cos_to_last_merge=0.9369 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.6992011057686094, 'loss_val': 0.725387005997553, 'psi': 0.7002319529284443}-{'f1_val': 0.7563652343037198, 'auprc': 0.9713541068796218, 'loss_val': 0.5761200535671047, 'psi': 0.8423607833340806}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.158273 cos_to_last_merge=0.9958 (last merge round=41)
[S16] round=75 local utility u=0.174415 metrics={'f1_val': 0.9916352299253898, 'auprc': 0.9942526800151452, 'loss_val': 0.039690400888697276, 'psi': 0.992682209961292}-{'f1_val': 0.948286653500489, 'auprc': 0.9917052071863819, 'loss_val': 0.12078643090747451, 'psi': 0.9656540749748461}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=75 head_norm_before_train=1.973933 cos_to_last_merge=0.9851 (last merge round=39)
[S17] round=75 local utility u=1.000000 metrics={'f1_val': 0.8083274102367228, 'auprc': 0.922500739845509, 'loss_val': 0.7369810594309042, 'psi': 0.8539967420802372}-{'f1_val': 0.5698847130153034, 'auprc': 0.8447273627399567, 'loss_val': 1.4019422172421119, 'psi': 0.6798217729051648}
[S17] not sending this round → trigger blocked (psi=0.854)
[S2] START round=76 head_norm_before_train=2.146906 (no previous merge yet)
[S2] round=76 local utility u=0.390734 metrics={'f1_val': 0.7575328416304465, 'auprc': 0.9887094236015632, 'loss_val': 0.4808874751772113, 'psi': 0.8500034744188931}-{'f1_val': 0.7750672500164058, 'auprc': 0.7463246064103577, 'loss_val': 0.6404069858383633, 'psi': 0.7635701925739866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=76 head_norm_before_train=2.323446 cos_to_last_merge=0.9682 (last merge round=37)
[S3] round=76 local utility u=0.125602 metrics={'f1_val': 0.9833168046634339, 'auprc': 0.9984106510408726, 'loss_val': 0.05837402497196199, 'psi': 0.9893543432144094}-{'f1_val': 0.9610750853994537, 'auprc': 0.99326429890249, 'loss_val': 0.16068831426878452, 'psi': 0.9739507708006683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=76 head_norm_before_train=2.001226 (no previous merge yet)
[S4] round=76 local utility u=0.067811 metrics={'f1_val': 0.9567334322373482, 'auprc': 0.9704408619109085, 'loss_val': 0.3101527144246691, 'psi': 0.9622164041067722}-{'f1_val': 0.9439409057635668, 'auprc': 0.9567107322337426, 'loss_val': 0.32782947366776444, 'psi': 0.9490488363516371}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=76 head_norm_before_train=1.979451 cos_to_last_merge=0.7150 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.715
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9987595276339784, 'loss_val': 0.01983156314708441, 'psi': 0.9975249921406659}-{'f1_val': 0.9970695586110643, 'auprc': 0.9995964675095632, 'loss_val': 0.023123295504433993, 'psi': 0.9980803221704639}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.967246 cos_to_last_merge=0.9641 (last merge round=40)
[S6] round=76 local utility u=0.273155 metrics={'f1_val': 0.7855098026636003, 'auprc': 0.9500792145658226, 'loss_val': 0.5901360005069888, 'psi': 0.8513375674244892}-{'f1_val': 0.701032967334479, 'auprc': 0.9540440141624554, 'loss_val': 0.6414786109704689, 'psi': 0.8022373860656695}
[S6] not sending this round → trigger blocked (psi=0.851)
[S7] START round=76 head_norm_before_train=2.205386 cos_to_last_merge=0.9925 (last merge round=35)
[S7] round=76 local utility u=0.277497 metrics={'f1_val': 0.6709240255515467, 'auprc': 0.8060099799562673, 'loss_val': 0.4968259440445246, 'psi': 0.724958407313435}-{'f1_val': 0.6280102329718231, 'auprc': 0.7973739359388426, 'loss_val': 0.7684281071701901, 'psi': 0.6957557141586309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=76 head_norm_before_train=1.667173 cos_to_last_merge=0.9838 (last merge round=40)
[S8] round=76 local utility u=0.007450 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9990253804967264, 'loss_val': 0.03352412749326693, 'psi': 0.995411226890363}-{'f1_val': 0.992027843503252, 'auprc': 0.9983770444290085, 'loss_val': 0.04063461086801122, 'psi': 0.9945675238735546}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=76 head_norm_before_train=2.393206 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9999710897416975, 'loss_val': 0.026624635407736554, 'psi': 0.9944817372083452}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988053846008469, 'loss_val': 0.016987715445710903, 'psi': 0.9977839013476244}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.249708 (no previous merge yet)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966657069900463, 'loss_val': 0.024996887697851765, 'psi': 0.9956471947150642}-{'f1_val': 0.9949681865317428, 'auprc': 0.9970480636511917, 'loss_val': 0.02496456607397434, 'psi': 0.9958001373795224}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.881933 cos_to_last_merge=0.9438 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=76 local utility u=0.127886 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962502657243247, 'loss_val': 0.04805833005507295, 'psi': 0.9961803112377154}-{'f1_val': 0.9589610276262541, 'auprc': 0.9962411199408525, 'loss_val': 0.08076608035281016, 'psi': 0.9738730645520934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=76 head_norm_before_train=1.889391 cos_to_last_merge=0.9750 (last merge round=35)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6577885508211951, 'auprc': 0.6986455979116051, 'loss_val': 1.020817751427608, 'psi': 0.6741313696573591}-{'f1_val': 0.6983673976903515, 'auprc': 0.7465330492203182, 'loss_val': 0.9014283767486765, 'psi': 0.7176336583023382}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.026982 cos_to_last_merge=0.8048 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.805
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.840660023352231, 'auprc': 0.9974676715958596, 'loss_val': 0.44898912851199124, 'psi': 0.9033830826496825}-{'f1_val': 0.9153639216851782, 'auprc': 0.9986408069624813, 'loss_val': 0.2126260950562226, 'psi': 0.9486746757960994}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.712702 cos_to_last_merge=0.9361 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=76 local utility u=1.000000 metrics={'f1_val': 0.9712884821058432, 'auprc': 0.994679146323718, 'loss_val': 0.06808566404010657, 'psi': 0.9806447477929932}-{'f1_val': 0.7009191843683342, 'auprc': 0.6992011057686094, 'loss_val': 0.725387005997553, 'psi': 0.7002319529284443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=76 head_norm_before_train=2.156943 cos_to_last_merge=0.9954 (last merge round=41)
[S16] round=76 local utility u=0.007203 metrics={'f1_val': 0.9924861793138609, 'auprc': 0.9960334812868525, 'loss_val': 0.035732274374456766, 'psi': 0.9939051001030575}-{'f1_val': 0.9916352299253898, 'auprc': 0.9942526800151452, 'loss_val': 0.039690400888697276, 'psi': 0.992682209961292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=76 head_norm_before_train=1.980603 cos_to_last_merge=0.9848 (last merge round=39)
[S17] round=76 local utility u=0.444464 metrics={'f1_val': 0.9075039537264407, 'auprc': 0.9364054577716543, 'loss_val': 0.4848267301167168, 'psi': 0.9190645553445261}-{'f1_val': 0.8083274102367228, 'auprc': 0.922500739845509, 'loss_val': 0.7369810594309042, 'psi': 0.8539967420802372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=77 head_norm_before_train=2.151420 (no previous merge yet)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.6721890089800467, 'auprc': 0.7489832707495829, 'loss_val': 0.652940361637637, 'psi': 0.7029067136878612}-{'f1_val': 0.7575328416304465, 'auprc': 0.9887094236015632, 'loss_val': 0.4808874751772113, 'psi': 0.8500034744188931}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.330286 cos_to_last_merge=0.9679 (last merge round=37)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.8921014721566505, 'auprc': 0.9980445677499727, 'loss_val': 0.155508029388074, 'psi': 0.9344787103939793}-{'f1_val': 0.9833168046634339, 'auprc': 0.9984106510408726, 'loss_val': 0.05837402497196199, 'psi': 0.9893543432144094}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.001087 (no previous merge yet)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.950802673505502, 'auprc': 0.9598287745079864, 'loss_val': 0.32831393071330783, 'psi': 0.9544131139064957}-{'f1_val': 0.9567334322373482, 'auprc': 0.9704408619109085, 'loss_val': 0.3101527144246691, 'psi': 0.9622164041067722}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.990907 cos_to_last_merge=0.7141 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.714
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9925367424577958, 'loss_val': 0.020060209645813235, 'psi': 0.9950358780701929}-{'f1_val': 0.9967019684784577, 'auprc': 0.9987595276339784, 'loss_val': 0.01983156314708441, 'psi': 0.9975249921406659}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.975313 cos_to_last_merge=0.9633 (last merge round=40)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6241953551590441, 'auprc': 0.9172479732522171, 'loss_val': 1.1045612004181917, 'psi': 0.7414164023963132}-{'f1_val': 0.7855098026636003, 'auprc': 0.9500792145658226, 'loss_val': 0.5901360005069888, 'psi': 0.8513375674244892}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=2.208153 cos_to_last_merge=0.9925 (last merge round=35)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.6547710619929228, 'auprc': 0.8068086294527738, 'loss_val': 0.4925717522995162, 'psi': 0.7155860889768632}-{'f1_val': 0.6709240255515467, 'auprc': 0.8060099799562673, 'loss_val': 0.4968259440445246, 'psi': 0.724958407313435}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.669776 cos_to_last_merge=0.9836 (last merge round=40)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9990004953460746, 'loss_val': 0.04162772442051612, 'psi': 0.9920962692435786}-{'f1_val': 0.9930017911527874, 'auprc': 0.9990253804967264, 'loss_val': 0.03352412749326693, 'psi': 0.995411226890363}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=2.399720 (no previous merge yet)
[S9] round=77 local utility u=0.003303 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9999625535197536, 'loss_val': 0.022525206213571375, 'psi': 0.9947315095447918}-{'f1_val': 0.9908221688527771, 'auprc': 0.9999710897416975, 'loss_val': 0.026624635407736554, 'psi': 0.9944817372083452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=77 head_norm_before_train=2.251512 (no previous merge yet)
[S10] round=77 local utility u=0.000276 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9968383859514893, 'loss_val': 0.024962683397722125, 'psi': 0.9957162662996415}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966657069900463, 'loss_val': 0.024996887697851765, 'psi': 0.9956471947150642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=77 head_norm_before_train=1.888267 cos_to_last_merge=0.9433 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.795813929227936, 'auprc': 0.9941183004034649, 'loss_val': 0.4244261629013839, 'psi': 0.8751356776981476}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962502657243247, 'loss_val': 0.04805833005507295, 'psi': 0.9961803112377154}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.892845 cos_to_last_merge=0.9747 (last merge round=35)
[S13] round=77 local utility u=0.005366 metrics={'f1_val': 0.6734265624048236, 'auprc': 0.6807625670194626, 'loss_val': 1.0502648758318798, 'psi': 0.6763609642506792}-{'f1_val': 0.6577885508211951, 'auprc': 0.6986455979116051, 'loss_val': 1.020817751427608, 'psi': 0.6741313696573591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=77 head_norm_before_train=2.033565 cos_to_last_merge=0.8046 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.805
[S14] round=77 local utility u=0.056200 metrics={'f1_val': 0.8632911634523305, 'auprc': 0.9945874010616137, 'loss_val': 0.463735101349565, 'psi': 0.9158096584960438}-{'f1_val': 0.840660023352231, 'auprc': 0.9974676715958596, 'loss_val': 0.44898912851199124, 'psi': 0.9033830826496825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=77 head_norm_before_train=1.719750 cos_to_last_merge=0.9354 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.8853305888022236, 'auprc': 0.9953331467279978, 'loss_val': 0.2018381846842258, 'psi': 0.9293316119725332}-{'f1_val': 0.9712884821058432, 'auprc': 0.994679146323718, 'loss_val': 0.06808566404010657, 'psi': 0.9806447477929932}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.158296 cos_to_last_merge=0.9951 (last merge round=41)
[S16] round=77 local utility u=0.003156 metrics={'f1_val': 0.9935848434976069, 'auprc': 0.9952134699168201, 'loss_val': 0.03355138543483897, 'psi': 0.9942362940652922}-{'f1_val': 0.9924861793138609, 'auprc': 0.9960334812868525, 'loss_val': 0.035732274374456766, 'psi': 0.9939051001030575}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=77 head_norm_before_train=1.988059 cos_to_last_merge=0.9844 (last merge round=39)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8264035870585381, 'auprc': 0.9080825791488514, 'loss_val': 0.6970081471026291, 'psi': 0.8590751838946634}-{'f1_val': 0.9075039537264407, 'auprc': 0.9364054577716543, 'loss_val': 0.4848267301167168, 'psi': 0.9190645553445261}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.155505 (no previous merge yet)
[S2] round=78 local utility u=0.531475 metrics={'f1_val': 0.7116279932759947, 'auprc': 0.9781989751352558, 'loss_val': 0.5142715261088131, 'psi': 0.8182563860196992}-{'f1_val': 0.6721890089800467, 'auprc': 0.7489832707495829, 'loss_val': 0.652940361637637, 'psi': 0.7029067136878612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=78 head_norm_before_train=2.336137 cos_to_last_merge=0.9677 (last merge round=37)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.8627706215238391, 'auprc': 0.9633217632652652, 'loss_val': 0.3319732171686944, 'psi': 0.9029910782204095}-{'f1_val': 0.8921014721566505, 'auprc': 0.9980445677499727, 'loss_val': 0.155508029388074, 'psi': 0.9344787103939793}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.004832 (no previous merge yet)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9418247844872967, 'auprc': 0.9490206617191412, 'loss_val': 0.33877827780393116, 'psi': 0.9447031353800345}-{'f1_val': 0.950802673505502, 'auprc': 0.9598287745079864, 'loss_val': 0.32831393071330783, 'psi': 0.9544131139064957}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.998394 cos_to_last_merge=0.7132 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.713
[S5] round=78 local utility u=0.008734 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9980910495700213, 'loss_val': 0.01925559568451915, 'psi': 0.9972576009150831}-{'f1_val': 0.9967019684784577, 'auprc': 0.9925367424577958, 'loss_val': 0.020060209645813235, 'psi': 0.9950358780701929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=78 head_norm_before_train=1.983124 cos_to_last_merge=0.9625 (last merge round=40)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.636365020984882, 'auprc': 0.8589415741449848, 'loss_val': 1.1371294218944856, 'psi': 0.7253956422489232}-{'f1_val': 0.6241953551590441, 'auprc': 0.9172479732522171, 'loss_val': 1.1045612004181917, 'psi': 0.7414164023963132}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=2.211971 cos_to_last_merge=0.9923 (last merge round=35)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.6247629178601012, 'auprc': 0.7926093788875899, 'loss_val': 0.8497501017090807, 'psi': 0.6919015022710966}-{'f1_val': 0.6547710619929228, 'auprc': 0.8068086294527738, 'loss_val': 0.4925717522995162, 'psi': 0.7155860889768632}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.673736 cos_to_last_merge=0.9835 (last merge round=40)
[S8] round=78 local utility u=0.004855 metrics={'f1_val': 0.9891320513908246, 'auprc': 0.9987517532929853, 'loss_val': 0.04100254319325381, 'psi': 0.9929799321516888}-{'f1_val': 0.9874934518419147, 'auprc': 0.9990004953460746, 'loss_val': 0.04162772442051612, 'psi': 0.9920962692435786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=78 head_norm_before_train=2.402926 (no previous merge yet)
[S9] round=78 local utility u=0.023038 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999175065116163, 'loss_val': 0.013932851022176094, 'psi': 0.9984752930586931}-{'f1_val': 0.9912441468948172, 'auprc': 0.9999625535197536, 'loss_val': 0.022525206213571375, 'psi': 0.9947315095447918}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=78 head_norm_before_train=2.255306 (no previous merge yet)
[S10] round=78 local utility u=0.000334 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966023911707225, 'loss_val': 0.024904469795074786, 'psi': 0.9957536598799138}-{'f1_val': 0.9949681865317428, 'auprc': 0.9968383859514893, 'loss_val': 0.024962683397722125, 'psi': 0.9957162662996415}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=78 head_norm_before_train=1.892694 cos_to_last_merge=0.9429 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=78 local utility u=0.755545 metrics={'f1_val': 0.9868497328079426, 'auprc': 0.9963594596320234, 'loss_val': 0.06627486996960574, 'psi': 0.990653623537575}-{'f1_val': 0.795813929227936, 'auprc': 0.9941183004034649, 'loss_val': 0.4244261629013839, 'psi': 0.8751356776981476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=78 head_norm_before_train=1.896504 cos_to_last_merge=0.9744 (last merge round=35)
[S13] round=78 local utility u=0.256603 metrics={'f1_val': 0.6752545433653676, 'auprc': 0.7949189028453707, 'loss_val': 0.8904958681090112, 'psi': 0.7231202871573688}-{'f1_val': 0.6734265624048236, 'auprc': 0.6807625670194626, 'loss_val': 1.0502648758318798, 'psi': 0.6763609642506792}
[S13] not sending this round → trigger blocked (psi=0.723)
[S14] START round=78 head_norm_before_train=2.038222 cos_to_last_merge=0.8044 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.804
[S14] round=78 local utility u=0.126927 metrics={'f1_val': 0.8833349913432925, 'auprc': 0.997456470401528, 'loss_val': 0.3387517239189289, 'psi': 0.9289835829665867}-{'f1_val': 0.8632911634523305, 'auprc': 0.9945874010616137, 'loss_val': 0.463735101349565, 'psi': 0.9158096584960438}
[S14] not sending this round → trigger blocked (psi=0.929)
[S15] START round=78 head_norm_before_train=1.725017 cos_to_last_merge=0.9349 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.801451807050808, 'loss_val': 0.7277835206148807, 'psi': 0.7410416004009992}-{'f1_val': 0.8853305888022236, 'auprc': 0.9953331467279978, 'loss_val': 0.2018381846842258, 'psi': 0.9293316119725332}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.161479 cos_to_last_merge=0.9950 (last merge round=41)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9936272149550213, 'auprc': 0.9938598875700693, 'loss_val': 0.032792795538003044, 'psi': 0.9937202840010405}-{'f1_val': 0.9935848434976069, 'auprc': 0.9952134699168201, 'loss_val': 0.03355138543483897, 'psi': 0.9942362940652922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.994476 cos_to_last_merge=0.9841 (last merge round=39)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.5981478491675489, 'auprc': 0.8674362807938767, 'loss_val': 1.4511355430985007, 'psi': 0.70586322181808}-{'f1_val': 0.8264035870585381, 'auprc': 0.9080825791488514, 'loss_val': 0.6970081471026291, 'psi': 0.8590751838946634}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.159490 (no previous merge yet)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.6207832813259517, 'auprc': 0.8077237691751828, 'loss_val': 1.7793701357613056, 'psi': 0.6955594764656442}-{'f1_val': 0.7116279932759947, 'auprc': 0.9781989751352558, 'loss_val': 0.5142715261088131, 'psi': 0.8182563860196992}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.696 u=0.0000 p_local=0.2139 f1=0.621 auprc=0.808 bytes=57531
[S3] START round=79 head_norm_before_train=2.341863 cos_to_last_merge=0.9674 (last merge round=37)
[S3] round=79 local utility u=0.553823 metrics={'f1_val': 0.9850004517558806, 'auprc': 0.9984477967102889, 'loss_val': 0.06308424324130596, 'psi': 0.990379389737644}-{'f1_val': 0.8627706215238391, 'auprc': 0.9633217632652652, 'loss_val': 0.3319732171686944, 'psi': 0.9029910782204095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S3] r=80 psi=0.990 u=0.5538 p_local=0.2167 f1=0.985 auprc=0.998 bytes=55703
[S4] START round=79 head_norm_before_train=2.009665 (no previous merge yet)
[S4] round=79 local utility u=0.033216 metrics={'f1_val': 0.9468641297875829, 'auprc': 0.9606910819258427, 'loss_val': 0.33759270023807647, 'psi': 0.9523949106428868}-{'f1_val': 0.9418247844872967, 'auprc': 0.9490206617191412, 'loss_val': 0.33877827780393116, 'psi': 0.9447031353800345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=80 psi=0.952 u=0.0332 p_local=0.0219 f1=0.947 auprc=0.961 bytes=52194
[S5] START round=79 head_norm_before_train=2.000308 cos_to_last_merge=0.7129 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.713
[S5] round=79 local utility u=0.001944 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9992058847759498, 'loss_val': 0.018711866550942074, 'psi': 0.9977035349974546}-{'f1_val': 0.9967019684784577, 'auprc': 0.9980910495700213, 'loss_val': 0.01925559568451915, 'psi': 0.9972576009150831}
[S5] not sending this round → trigger blocked (psi=0.998)
[S5] r=80 psi=0.998 u=0.0019 p_local=0.0040 f1=0.997 auprc=0.999 bytes=59414
[S6] START round=79 head_norm_before_train=1.990644 cos_to_last_merge=0.9619 (last merge round=40)
[S6] round=79 local utility u=0.702649 metrics={'f1_val': 0.7551708745565422, 'auprc': 0.9475363275032123, 'loss_val': 0.7104501676241999, 'psi': 0.8321170557352102}-{'f1_val': 0.636365020984882, 'auprc': 0.8589415741449848, 'loss_val': 1.1371294218944856, 'psi': 0.7253956422489232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=80 psi=0.832 u=0.7026 p_local=0.2459 f1=0.755 auprc=0.948 bytes=55774
[S7] START round=79 head_norm_before_train=2.215869 cos_to_last_merge=0.9921 (last merge round=35)
[S7] round=79 local utility u=0.063373 metrics={'f1_val': 0.6398876276078385, 'auprc': 0.7936303861698365, 'loss_val': 0.8168163700449653, 'psi': 0.7013847310326378}-{'f1_val': 0.6247629178601012, 'auprc': 0.7926093788875899, 'loss_val': 0.8497501017090807, 'psi': 0.6919015022710966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=80 psi=0.701 u=0.0634 p_local=0.0985 f1=0.640 auprc=0.794 bytes=55703
[S8] START round=79 head_norm_before_train=1.679079 cos_to_last_merge=0.9833 (last merge round=40)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9677026295930813, 'auprc': 0.9957596174431125, 'loss_val': 0.07734793096503438, 'psi': 0.9789254247330939}-{'f1_val': 0.9891320513908246, 'auprc': 0.9987517532929853, 'loss_val': 0.04100254319325381, 'psi': 0.9929799321516888}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.979 u=0.0000 p_local=0.0802 f1=0.968 auprc=0.996 bytes=57474
[S9] START round=79 head_norm_before_train=2.409213 (no previous merge yet)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999178973749038, 'loss_val': 0.014587708836314073, 'psi': 0.998475449404008}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999175065116163, 'loss_val': 0.013932851022176094, 'psi': 0.9984752930586931}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.998 u=0.0000 p_local=0.0049 f1=0.998 auprc=1.000 bytes=62916
[S10] START round=79 head_norm_before_train=2.260159 (no previous merge yet)
[S10] round=79 local utility u=0.000028 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.997028749745426, 'loss_val': 0.024810143556131196, 'psi': 0.9957924118172161}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966023911707225, 'loss_val': 0.024904469795074786, 'psi': 0.9957536598799138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.997 bytes=62858
[S11] START round=79 head_norm_before_train=1.897106 cos_to_last_merge=0.9425 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=79 local utility u=0.051908 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9971849600643843, 'loss_val': 0.02076082339660685, 'psi': 0.9965664688722009}-{'f1_val': 0.9868497328079426, 'auprc': 0.9963594596320234, 'loss_val': 0.06627486996960574, 'psi': 0.990653623537575}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=80 psi=0.997 u=0.0519 p_local=0.1628 f1=0.996 auprc=0.997 bytes=50396
[S13] START round=79 head_norm_before_train=1.904736 cos_to_last_merge=0.9736 (last merge round=35)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.644756207722633, 'auprc': 0.6336466144688201, 'loss_val': 1.3068589889015794, 'psi': 0.6403123704211078}-{'f1_val': 0.6752545433653676, 'auprc': 0.7949189028453707, 'loss_val': 0.8904958681090112, 'psi': 0.7231202871573688}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.640 u=0.0000 p_local=0.1360 f1=0.645 auprc=0.634 bytes=57629
[S14] START round=79 head_norm_before_train=2.045469 cos_to_last_merge=0.8041 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.804
[S14] round=79 local utility u=0.424256 metrics={'f1_val': 0.9763941528977533, 'auprc': 0.9989867623734219, 'loss_val': 0.0531851453222941, 'psi': 0.9854311966880207}-{'f1_val': 0.8833349913432925, 'auprc': 0.997456470401528, 'loss_val': 0.3387517239189289, 'psi': 0.9289835829665867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S14] r=80 psi=0.985 u=0.4243 p_local=0.1566 f1=0.976 auprc=0.999 bytes=55812
[S15] START round=79 head_norm_before_train=1.730338 cos_to_last_merge=0.9343 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=79 local utility u=1.000000 metrics={'f1_val': 0.9919025792053318, 'auprc': 0.9939810522924832, 'loss_val': 0.03947540867209912, 'psi': 0.9927339684401923}-{'f1_val': 0.7007681293011265, 'auprc': 0.801451807050808, 'loss_val': 0.7277835206148807, 'psi': 0.7410416004009992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] r=80 psi=0.993 u=1.0000 p_local=0.3914 f1=0.992 auprc=0.994 bytes=53980
[S16] START round=79 head_norm_before_train=2.163208 cos_to_last_merge=0.9949 (last merge round=41)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.8749454366715353, 'auprc': 0.9818622408023396, 'loss_val': 0.5251970633723978, 'psi': 0.9177121583238571}-{'f1_val': 0.9936272149550213, 'auprc': 0.9938598875700693, 'loss_val': 0.032792795538003044, 'psi': 0.9937202840010405}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.918 u=0.0000 p_local=0.0265 f1=0.875 auprc=0.982 bytes=52152
[S17] START round=79 head_norm_before_train=1.999485 cos_to_last_merge=0.9839 (last merge round=39)
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.5151525658036744, 'auprc': 0.8412835491227764, 'loss_val': 1.8197939933077147, 'psi': 0.6456049591313152}-{'f1_val': 0.5981478491675489, 'auprc': 0.8674362807938767, 'loss_val': 1.4511355430985007, 'psi': 0.70586322181808}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.646 u=0.0000 p_local=0.2032 f1=0.515 auprc=0.841 bytes=54007
[S2] START round=80 head_norm_before_train=2.164780 (no previous merge yet)
[S2] round=80 local utility u=1.000000 metrics={'f1_val': 0.8171818387665205, 'auprc': 0.7482697705908586, 'loss_val': 0.4666960000569784, 'psi': 0.7896170114962557}-{'f1_val': 0.6207832813259517, 'auprc': 0.8077237691751828, 'loss_val': 1.7793701357613056, 'psi': 0.6955594764656442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=80 head_norm_before_train=2.345913 cos_to_last_merge=0.9673 (last merge round=37)
[S3] round=80 local utility u=0.047433 metrics={'f1_val': 0.9965361921728806, 'auprc': 0.9986561483242283, 'loss_val': 0.03805751057433967, 'psi': 0.9973841746334197}-{'f1_val': 0.9850004517558806, 'auprc': 0.9984477967102889, 'loss_val': 0.06308424324130596, 'psi': 0.990379389737644}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=80 head_norm_before_train=2.013511 (no previous merge yet)
[S4] round=80 local utility u=0.057571 metrics={'f1_val': 0.9543974690739441, 'auprc': 0.9750782299499836, 'loss_val': 0.3108116432820391, 'psi': 0.9626697734243599}-{'f1_val': 0.9468641297875829, 'auprc': 0.9606910819258427, 'loss_val': 0.33759270023807647, 'psi': 0.9523949106428868}
[S4] not sending this round → trigger blocked (psi=0.963)
[S5] START round=80 head_norm_before_train=2.002984 cos_to_last_merge=0.7124 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.712
[S5] round=80 local utility u=0.001482 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999157206162433, 'loss_val': 0.02008209675430442, 'psi': 0.998208023413136}-{'f1_val': 0.9967019684784577, 'auprc': 0.9992058847759498, 'loss_val': 0.018711866550942074, 'psi': 0.9977035349974546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=80 head_norm_before_train=1.995350 cos_to_last_merge=0.9616 (last merge round=40)
[S6] round=80 local utility u=0.164237 metrics={'f1_val': 0.7927308615628001, 'auprc': 0.9479871492992928, 'loss_val': 0.6086876054074526, 'psi': 0.8548333766573972}-{'f1_val': 0.7551708745565422, 'auprc': 0.9475363275032123, 'loss_val': 0.7104501676241999, 'psi': 0.8321170557352102}
[S6] not sending this round → trigger blocked (psi=0.855)
[S7] START round=80 head_norm_before_train=2.218916 cos_to_last_merge=0.9919 (last merge round=35)
[S7] round=80 local utility u=0.837391 metrics={'f1_val': 0.7631527550891222, 'auprc': 0.9015790882533395, 'loss_val': 0.20547031541569416, 'psi': 0.8185232883548091}-{'f1_val': 0.6398876276078385, 'auprc': 0.7936303861698365, 'loss_val': 0.8168163700449653, 'psi': 0.7013847310326378}
[S7] not sending this round → trigger blocked (psi=0.819)
[S8] START round=80 head_norm_before_train=1.685114 cos_to_last_merge=0.9830 (last merge round=40)
[S8] round=80 local utility u=0.077044 metrics={'f1_val': 0.9861132963230042, 'auprc': 0.9990251703633942, 'loss_val': 0.043521400030951424, 'psi': 0.9912780459391601}-{'f1_val': 0.9677026295930813, 'auprc': 0.9957596174431125, 'loss_val': 0.07734793096503438, 'psi': 0.9789254247330939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=80 head_norm_before_train=2.413568 (no previous merge yet)
[S9] round=80 local utility u=0.000226 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.999815254786089, 'loss_val': 0.013827771298871128, 'psi': 0.9984343923684822}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999178973749038, 'loss_val': 0.014587708836314073, 'psi': 0.998475449404008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=80 head_norm_before_train=2.265371 (no previous merge yet)
[S10] round=80 local utility u=0.000109 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9971360688677132, 'loss_val': 0.02491414691367888, 'psi': 0.995835339466131}-{'f1_val': 0.9949681865317428, 'auprc': 0.997028749745426, 'loss_val': 0.024810143556131196, 'psi': 0.9957924118172161}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=80 head_norm_before_train=1.902789 cos_to_last_merge=0.9419 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=80 local utility u=0.002132 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976571463438866, 'loss_val': 0.02027086207382835, 'psi': 0.9969910612457084}-{'f1_val': 0.9961541414107454, 'auprc': 0.9971849600643843, 'loss_val': 0.02076082339660685, 'psi': 0.9965664688722009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=80 head_norm_before_train=1.910685 cos_to_last_merge=0.9731 (last merge round=35)
[S13] round=80 local utility u=0.396117 metrics={'f1_val': 0.6457757680154828, 'auprc': 0.8008519690236238, 'loss_val': 1.0223591332210495, 'psi': 0.7078062484187391}-{'f1_val': 0.644756207722633, 'auprc': 0.6336466144688201, 'loss_val': 1.3068589889015794, 'psi': 0.6403123704211078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=80 head_norm_before_train=2.052760 cos_to_last_merge=0.8039 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.804
[S14] round=80 local utility u=0.004736 metrics={'f1_val': 0.9773152623547885, 'auprc': 0.9989808608488109, 'loss_val': 0.04922157537216499, 'psi': 0.9859815017523975}-{'f1_val': 0.9763941528977533, 'auprc': 0.9989867623734219, 'loss_val': 0.0531851453222941, 'psi': 0.9854311966880207}
[S14] not sending this round → trigger blocked (psi=0.986)
[S15] START round=80 head_norm_before_train=1.735853 cos_to_last_merge=0.9339 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9907610463147891, 'auprc': 0.9954965309316077, 'loss_val': 0.04682253153547834, 'psi': 0.9926552401615165}-{'f1_val': 0.9919025792053318, 'auprc': 0.9939810522924832, 'loss_val': 0.03947540867209912, 'psi': 0.9927339684401923}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.167316 cos_to_last_merge=0.9948 (last merge round=41)
[S16] round=80 local utility u=0.261480 metrics={'f1_val': 0.9236119428582137, 'auprc': 0.987336318848003, 'loss_val': 0.3106583565851421, 'psi': 0.9491016932541294}-{'f1_val': 0.8749454366715353, 'auprc': 0.9818622408023396, 'loss_val': 0.5251970633723978, 'psi': 0.9177121583238571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=80 head_norm_before_train=2.005342 cos_to_last_merge=0.9836 (last merge round=39)
[S17] round=80 local utility u=0.721164 metrics={'f1_val': 0.6457596171048727, 'auprc': 0.8785959810606915, 'loss_val': 1.2730447847326618, 'psi': 0.7388941626872002}-{'f1_val': 0.5151525658036744, 'auprc': 0.8412835491227764, 'loss_val': 1.8197939933077147, 'psi': 0.6456049591313152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=81 head_norm_before_train=2.168466 (no previous merge yet)
[S2] round=81 local utility u=0.349573 metrics={'f1_val': 0.8201866538419436, 'auprc': 0.970285306531486, 'loss_val': 0.4516253008364955, 'psi': 0.8802261149177606}-{'f1_val': 0.8171818387665205, 'auprc': 0.7482697705908586, 'loss_val': 0.4666960000569784, 'psi': 0.7896170114962557}
[S2] not sending this round → trigger blocked (psi=0.880)
[S3] START round=81 head_norm_before_train=2.351099 cos_to_last_merge=0.9671 (last merge round=37)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.9633927491268464, 'auprc': 0.9960977133441552, 'loss_val': 0.1268772696721029, 'psi': 0.9764747348137699}-{'f1_val': 0.9965361921728806, 'auprc': 0.9986561483242283, 'loss_val': 0.03805751057433967, 'psi': 0.9973841746334197}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=2.010875 (no previous merge yet)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9523903957241894, 'auprc': 0.9690189640394693, 'loss_val': 0.31978977664285996, 'psi': 0.9590418230503013}-{'f1_val': 0.9543974690739441, 'auprc': 0.9750782299499836, 'loss_val': 0.3108116432820391, 'psi': 0.9626697734243599}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.013282 cos_to_last_merge=0.7115 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.711
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9990367243149316, 'loss_val': 0.019551243465504426, 'psi': 0.9976358708130473}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999157206162433, 'loss_val': 0.02008209675430442, 'psi': 0.998208023413136}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.998851 cos_to_last_merge=0.9605 (last merge round=40)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6389396746152474, 'auprc': 0.9224053679948262, 'loss_val': 1.0732047904934, 'psi': 0.7523259519670789}-{'f1_val': 0.7927308615628001, 'auprc': 0.9479871492992928, 'loss_val': 0.6086876054074526, 'psi': 0.8548333766573972}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=2.225709 cos_to_last_merge=0.9915 (last merge round=35)
[S7] round=81 local utility u=0.306761 metrics={'f1_val': 0.8508194269660586, 'auprc': 0.9217828552281734, 'loss_val': 0.17855967345813054, 'psi': 0.8792047982709045}-{'f1_val': 0.7631527550891222, 'auprc': 0.9015790882533395, 'loss_val': 0.20547031541569416, 'psi': 0.8185232883548091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=81 head_norm_before_train=1.690929 cos_to_last_merge=0.9827 (last merge round=40)
[S8] round=81 local utility u=0.019364 metrics={'f1_val': 0.9911824325629198, 'auprc': 0.9993540614252876, 'loss_val': 0.03619558181831788, 'psi': 0.994451084107867}-{'f1_val': 0.9861132963230042, 'auprc': 0.9990251703633942, 'loss_val': 0.043521400030951424, 'psi': 0.9912780459391601}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=81 head_norm_before_train=2.419775 (no previous merge yet)
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989618104538711, 'loss_val': 0.01749578750175121, 'psi': 0.9978464716888341}-{'f1_val': 0.9975138174234109, 'auprc': 0.999815254786089, 'loss_val': 0.013827771298871128, 'psi': 0.9984343923684822}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.268553 (no previous merge yet)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9967663653568368, 'loss_val': 0.02508217757261012, 'psi': 0.9956874580617805}-{'f1_val': 0.9949681865317428, 'auprc': 0.9971360688677132, 'loss_val': 0.02491414691367888, 'psi': 0.995835339466131}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.908961 cos_to_last_merge=0.9414 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=81 local utility u=0.000245 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977403447334829, 'loss_val': 0.020031438653860117, 'psi': 0.9970243406015469}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976571463438866, 'loss_val': 0.02027086207382835, 'psi': 0.9969910612457084}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=81 head_norm_before_train=1.914142 cos_to_last_merge=0.9728 (last merge round=35)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6382785053934519, 'auprc': 0.6514096148354602, 'loss_val': 1.1590111254749023, 'psi': 0.6435309491702552}-{'f1_val': 0.6457757680154828, 'auprc': 0.8008519690236238, 'loss_val': 1.0223591332210495, 'psi': 0.7078062484187391}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.057368 cos_to_last_merge=0.8035 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=81 local utility u=0.064327 metrics={'f1_val': 0.9950858601261725, 'auprc': 0.9989914320926695, 'loss_val': 0.027223174469241485, 'psi': 0.9966480889127713}-{'f1_val': 0.9773152623547885, 'auprc': 0.9989808608488109, 'loss_val': 0.04922157537216499, 'psi': 0.9859815017523975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=81 head_norm_before_train=1.741813 cos_to_last_merge=0.9333 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9097824759407235, 'auprc': 0.9955295796503016, 'loss_val': 0.16995239874507345, 'psi': 0.9440813174245547}-{'f1_val': 0.9907610463147891, 'auprc': 0.9954965309316077, 'loss_val': 0.04682253153547834, 'psi': 0.9926552401615165}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.169951 cos_to_last_merge=0.9945 (last merge round=41)
[S16] round=81 local utility u=0.357545 metrics={'f1_val': 0.9924861793138609, 'auprc': 0.9963541106973477, 'loss_val': 0.03586685236834326, 'psi': 0.9940333518672556}-{'f1_val': 0.9236119428582137, 'auprc': 0.987336318848003, 'loss_val': 0.3106583565851421, 'psi': 0.9491016932541294}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=81 head_norm_before_train=2.011664 cos_to_last_merge=0.9833 (last merge round=39)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.5340484190973286, 'auprc': 0.8570816025127473, 'loss_val': 1.6664433515776023, 'psi': 0.6632616924634961}-{'f1_val': 0.6457596171048727, 'auprc': 0.8785959810606915, 'loss_val': 1.2730447847326618, 'psi': 0.7388941626872002}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.170480 (no previous merge yet)
[S2] round=82 local utility u=0.004981 metrics={'f1_val': 0.8152929879385243, 'auprc': 0.9819226030350645, 'loss_val': 0.4472123755214535, 'psi': 0.8819448339771404}-{'f1_val': 0.8201866538419436, 'auprc': 0.970285306531486, 'loss_val': 0.4516253008364955, 'psi': 0.8802261149177606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=82 head_norm_before_train=2.357524 cos_to_last_merge=0.9668 (last merge round=37)
[S3] round=82 local utility u=0.068452 metrics={'f1_val': 0.9758313685171578, 'auprc': 0.9984289008149779, 'loss_val': 0.07159832859238212, 'psi': 0.9848703814362858}-{'f1_val': 0.9633927491268464, 'auprc': 0.9960977133441552, 'loss_val': 0.1268772696721029, 'psi': 0.9764747348137699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=82 head_norm_before_train=2.010838 (no previous merge yet)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9515952472812302, 'auprc': 0.9626702039725167, 'loss_val': 0.324153685275742, 'psi': 0.9560252299577447}-{'f1_val': 0.9523903957241894, 'auprc': 0.9690189640394693, 'loss_val': 0.31978977664285996, 'psi': 0.9590418230503013}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=2.024003 cos_to_last_merge=0.7106 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.711
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9767531426946713, 'auprc': 0.9918220998398231, 'loss_val': 0.04631813487034622, 'psi': 0.982780725552732}-{'f1_val': 0.9967019684784577, 'auprc': 0.9990367243149316, 'loss_val': 0.019551243465504426, 'psi': 0.9976358708130473}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.005707 cos_to_last_merge=0.9595 (last merge round=40)
[S6] round=82 local utility u=0.772786 metrics={'f1_val': 0.8004115345224332, 'auprc': 0.9516947881495406, 'loss_val': 0.5843327996106968, 'psi': 0.8609248359732762}-{'f1_val': 0.6389396746152474, 'auprc': 0.9224053679948262, 'loss_val': 1.0732047904934, 'psi': 0.7523259519670789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=82 head_norm_before_train=2.228298 cos_to_last_merge=0.9914 (last merge round=35)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6740086789702691, 'auprc': 0.8176088971906699, 'loss_val': 0.535425426530361, 'psi': 0.7314487662584294}-{'f1_val': 0.8508194269660586, 'auprc': 0.9217828552281734, 'loss_val': 0.17855967345813054, 'psi': 0.8792047982709045}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.696676 cos_to_last_merge=0.9824 (last merge round=40)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9843467557835309, 'auprc': 0.9991006998524606, 'loss_val': 0.04636025229284599, 'psi': 0.9902483334111029}-{'f1_val': 0.9911824325629198, 'auprc': 0.9993540614252876, 'loss_val': 0.03619558181831788, 'psi': 0.994451084107867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.422186 (no previous merge yet)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999627520373392, 'loss_val': 0.017448841819183717, 'psi': 0.9977477182531793}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989618104538711, 'loss_val': 0.01749578750175121, 'psi': 0.9978464716888341}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.269668 (no previous merge yet)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966427842790969, 'loss_val': 0.0251470637216982, 'psi': 0.9956380256306845}-{'f1_val': 0.9949681865317428, 'auprc': 0.9967663653568368, 'loss_val': 0.02508217757261012, 'psi': 0.9956874580617805}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=1.915105 cos_to_last_merge=0.9408 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9948839047212569, 'auprc': 0.9978284801648377, 'loss_val': 0.024131309627022843, 'psi': 0.9960617348986893}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977403447334829, 'loss_val': 0.020031438653860117, 'psi': 0.9970243406015469}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.917812 cos_to_last_merge=0.9725 (last merge round=35)
[S13] round=82 local utility u=0.269736 metrics={'f1_val': 0.7094079176101591, 'auprc': 0.6952302741169509, 'loss_val': 1.1777767792860847, 'psi': 0.7037368602128758}-{'f1_val': 0.6382785053934519, 'auprc': 0.6514096148354602, 'loss_val': 1.1590111254749023, 'psi': 0.6435309491702552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=82 head_norm_before_train=2.062848 cos_to_last_merge=0.8029 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=82 local utility u=0.005055 metrics={'f1_val': 0.9961266616845554, 'auprc': 0.9989957908022415, 'loss_val': 0.023370908264429162, 'psi': 0.99727431333163}-{'f1_val': 0.9950858601261725, 'auprc': 0.9989914320926695, 'loss_val': 0.027223174469241485, 'psi': 0.9966480889127713}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=82 head_norm_before_train=1.748524 cos_to_last_merge=0.9328 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.7784993420697626, 'auprc': 0.99214253914031, 'loss_val': 0.4947790360545726, 'psi': 0.8639566208979815}-{'f1_val': 0.9097824759407235, 'auprc': 0.9955295796503016, 'loss_val': 0.16995239874507345, 'psi': 0.9440813174245547}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.170904 cos_to_last_merge=0.9938 (last merge round=41)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9626363778216269, 'auprc': 0.9937500673056303, 'loss_val': 0.09399607144158248, 'psi': 0.9750818536152283}-{'f1_val': 0.9924861793138609, 'auprc': 0.9963541106973477, 'loss_val': 0.03586685236834326, 'psi': 0.9940333518672556}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.017499 cos_to_last_merge=0.9829 (last merge round=39)
[S17] round=82 local utility u=0.783301 metrics={'f1_val': 0.687168383899442, 'auprc': 0.886828951613434, 'loss_val': 1.1078031367127017, 'psi': 0.7670326109850388}-{'f1_val': 0.5340484190973286, 'auprc': 0.8570816025127473, 'loss_val': 1.6664433515776023, 'psi': 0.6632616924634961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=83 head_norm_before_train=2.172922 (no previous merge yet)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.8320388603714196, 'auprc': 0.7633209143883342, 'loss_val': 0.43418478948058287, 'psi': 0.8045516819781855}-{'f1_val': 0.8152929879385243, 'auprc': 0.9819226030350645, 'loss_val': 0.4472123755214535, 'psi': 0.8819448339771404}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.364389 cos_to_last_merge=0.9665 (last merge round=37)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.8679362473271092, 'auprc': 0.9982230929278044, 'loss_val': 0.22140789395849197, 'psi': 0.9200509855673873}-{'f1_val': 0.9758313685171578, 'auprc': 0.9984289008149779, 'loss_val': 0.07159832859238212, 'psi': 0.9848703814362858}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.015679 (no previous merge yet)
[S4] round=83 local utility u=0.021526 metrics={'f1_val': 0.9535281602638028, 'auprc': 0.9708805163643749, 'loss_val': 0.3173302196547187, 'psi': 0.9604691027040316}-{'f1_val': 0.9515952472812302, 'auprc': 0.9626702039725167, 'loss_val': 0.324153685275742, 'psi': 0.9560252299577447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=83 head_norm_before_train=2.028306 cos_to_last_merge=0.7101 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.710
[S5] round=83 local utility u=0.084873 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998176424717375, 'loss_val': 0.020251979409327627, 'psi': 0.9979482380757696}-{'f1_val': 0.9767531426946713, 'auprc': 0.9918220998398231, 'loss_val': 0.04631813487034622, 'psi': 0.982780725552732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=83 head_norm_before_train=2.013863 cos_to_last_merge=0.9587 (last merge round=40)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7677606311124267, 'auprc': 0.9484288497194718, 'loss_val': 0.6646420483756114, 'psi': 0.8400279185552447}-{'f1_val': 0.8004115345224332, 'auprc': 0.9516947881495406, 'loss_val': 0.5843327996106968, 'psi': 0.8609248359732762}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=2.229912 cos_to_last_merge=0.9912 (last merge round=35)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6483830624471082, 'auprc': 0.8064297886092474, 'loss_val': 0.550001498455894, 'psi': 0.7116017529119639}-{'f1_val': 0.6740086789702691, 'auprc': 0.8176088971906699, 'loss_val': 0.535425426530361, 'psi': 0.7314487662584294}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.702278 cos_to_last_merge=0.9822 (last merge round=40)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9798117476688298, 'auprc': 0.9989839945501603, 'loss_val': 0.05326982603842133, 'psi': 0.9874806464213621}-{'f1_val': 0.9843467557835309, 'auprc': 0.9991006998524606, 'loss_val': 0.04636025229284599, 'psi': 0.9902483334111029}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.424022 (no previous merge yet)
[S9] round=83 local utility u=0.003974 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.999818097300507, 'loss_val': 0.01404109499607345, 'psi': 0.9981872686437407}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999627520373392, 'loss_val': 0.017448841819183717, 'psi': 0.9977477182531793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=83 head_norm_before_train=2.272887 (no previous merge yet)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965763989484854, 'loss_val': 0.02517714921708831, 'psi': 0.9956114714984399}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966427842790969, 'loss_val': 0.0251470637216982, 'psi': 0.9956380256306845}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.920773 cos_to_last_merge=0.9403 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=83 local utility u=0.004474 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9971547654201924, 'loss_val': 0.021690070920211035, 'psi': 0.9966450066493935}-{'f1_val': 0.9948839047212569, 'auprc': 0.9978284801648377, 'loss_val': 0.024131309627022843, 'psi': 0.9960617348986893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=83 head_norm_before_train=1.921372 cos_to_last_merge=0.9722 (last merge round=35)
[S13] round=83 local utility u=0.084235 metrics={'f1_val': 0.7295299718948167, 'auprc': 0.705188034845862, 'loss_val': 1.159913024830349, 'psi': 0.7197931970752349}-{'f1_val': 0.7094079176101591, 'auprc': 0.6952302741169509, 'loss_val': 1.1777767792860847, 'psi': 0.7037368602128758}
[S13] not sending this round → trigger blocked (psi=0.720)
[S14] START round=83 head_norm_before_train=2.067942 cos_to_last_merge=0.8025 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.930143594533109, 'auprc': 0.9239334957494403, 'loss_val': 0.255188334657079, 'psi': 0.9276595550196416}-{'f1_val': 0.9961266616845554, 'auprc': 0.9989957908022415, 'loss_val': 0.023370908264429162, 'psi': 0.99727431333163}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=1.755080 cos_to_last_merge=0.9322 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.7012365946827287, 'auprc': 0.9032234614660125, 'loss_val': 0.6950477898813074, 'psi': 0.7820313413960422}-{'f1_val': 0.7784993420697626, 'auprc': 0.99214253914031, 'loss_val': 0.4947790360545726, 'psi': 0.8639566208979815}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.173890 cos_to_last_merge=0.9934 (last merge round=41)
[S16] round=83 local utility u=0.108358 metrics={'f1_val': 0.9906131372307868, 'auprc': 0.9956437028486933, 'loss_val': 0.050821783280722184, 'psi': 0.9926253634779494}-{'f1_val': 0.9626363778216269, 'auprc': 0.9937500673056303, 'loss_val': 0.09399607144158248, 'psi': 0.9750818536152283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=83 head_norm_before_train=2.023988 cos_to_last_merge=0.9826 (last merge round=39)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.6430874140153984, 'auprc': 0.8919397215866074, 'loss_val': 1.3258612581420872, 'psi': 0.742628337043882}-{'f1_val': 0.687168383899442, 'auprc': 0.886828951613434, 'loss_val': 1.1078031367127017, 'psi': 0.7670326109850388}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.177643 (no previous merge yet)
[S2] round=84 local utility u=0.306435 metrics={'f1_val': 0.8281469497925584, 'auprc': 0.9721426016062218, 'loss_val': 0.4244275552961547, 'psi': 0.8857452105180237}-{'f1_val': 0.8320388603714196, 'auprc': 0.7633209143883342, 'loss_val': 0.43418478948058287, 'psi': 0.8045516819781855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=84 head_norm_before_train=2.366544 cos_to_last_merge=0.9663 (last merge round=37)
[S3] round=84 local utility u=0.068773 metrics={'f1_val': 0.9020113256586275, 'auprc': 0.9887422162349062, 'loss_val': 0.2598706086041579, 'psi': 0.936703681889139}-{'f1_val': 0.8679362473271092, 'auprc': 0.9982230929278044, 'loss_val': 0.22140789395849197, 'psi': 0.9200509855673873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=84 head_norm_before_train=2.024613 (no previous merge yet)
[S4] round=84 local utility u=0.010267 metrics={'f1_val': 0.953925930306382, 'auprc': 0.9748052248658874, 'loss_val': 0.31095753692525663, 'psi': 0.962277648130184}-{'f1_val': 0.9535281602638028, 'auprc': 0.9708805163643749, 'loss_val': 0.3173302196547187, 'psi': 0.9604691027040316}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=84 head_norm_before_train=2.031547 cos_to_last_merge=0.7101 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.710
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9982871329332602, 'loss_val': 0.01866582145990484, 'psi': 0.9973360342603788}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998176424717375, 'loss_val': 0.020251979409327627, 'psi': 0.9979482380757696}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.020833 cos_to_last_merge=0.9572 (last merge round=40)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.7275788331453846, 'auprc': 0.9075989911129517, 'loss_val': 0.9103983701891558, 'psi': 0.7995868963324115}-{'f1_val': 0.7677606311124267, 'auprc': 0.9484288497194718, 'loss_val': 0.6646420483756114, 'psi': 0.8400279185552447}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=2.232966 cos_to_last_merge=0.9912 (last merge round=35)
[S7] round=84 local utility u=0.214370 metrics={'f1_val': 0.6848092730133863, 'auprc': 0.833090468551072, 'loss_val': 0.41980178849717137, 'psi': 0.7441217512284606}-{'f1_val': 0.6483830624471082, 'auprc': 0.8064297886092474, 'loss_val': 0.550001498455894, 'psi': 0.7116017529119639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=84 head_norm_before_train=1.708151 cos_to_last_merge=0.9819 (last merge round=40)
[S8] round=84 local utility u=0.027391 metrics={'f1_val': 0.9869825725025211, 'auprc': 0.9990320472794869, 'loss_val': 0.04165725363210844, 'psi': 0.9918023624133074}-{'f1_val': 0.9798117476688298, 'auprc': 0.9989839945501603, 'loss_val': 0.05326982603842133, 'psi': 0.9874806464213621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=84 head_norm_before_train=2.427121 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998724446050767, 'loss_val': 0.014974556584407378, 'psi': 0.9982107253493164}-{'f1_val': 0.9971000495392299, 'auprc': 0.999818097300507, 'loss_val': 0.01404109499607345, 'psi': 0.9981872686437407}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.277347 (no previous merge yet)
[S10] round=84 local utility u=0.000691 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965877841399557, 'loss_val': 0.025147467016318873, 'psi': 0.9957478170676071}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965763989484854, 'loss_val': 0.02517714921708831, 'psi': 0.9956114714984399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=84 head_norm_before_train=1.926667 cos_to_last_merge=0.9398 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=84 local utility u=0.002657 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9977310951606433, 'loss_val': 0.019678924301978963, 'psi': 0.9970329204479855}-{'f1_val': 0.996305167468861, 'auprc': 0.9971547654201924, 'loss_val': 0.021690070920211035, 'psi': 0.9966450066493935}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=84 head_norm_before_train=1.925385 cos_to_last_merge=0.9719 (last merge round=35)
[S13] round=84 local utility u=0.364296 metrics={'f1_val': 0.7442614005792291, 'auprc': 0.7956126271868815, 'loss_val': 0.7909827298540136, 'psi': 0.76480189122229}-{'f1_val': 0.7295299718948167, 'auprc': 0.705188034845862, 'loss_val': 1.159913024830349, 'psi': 0.7197931970752349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=84 head_norm_before_train=2.069959 cos_to_last_merge=0.8020 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.802
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.816411787259629, 'auprc': 0.9398062041324473, 'loss_val': 0.7741996278071496, 'psi': 0.8657695540087563}-{'f1_val': 0.930143594533109, 'auprc': 0.9239334957494403, 'loss_val': 0.255188334657079, 'psi': 0.9276595550196416}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=1.761607 cos_to_last_merge=0.9317 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.6956960304919546, 'auprc': 0.8519119217994149, 'loss_val': 0.750994869466214, 'psi': 0.7581823870149387}-{'f1_val': 0.7012365946827287, 'auprc': 0.9032234614660125, 'loss_val': 0.6950477898813074, 'psi': 0.7820313413960422}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.179037 cos_to_last_merge=0.9932 (last merge round=41)
[S16] round=84 local utility u=0.006118 metrics={'f1_val': 0.992760919414728, 'auprc': 0.9900177456239603, 'loss_val': 0.03459405116275627, 'psi': 0.9916636498984209}-{'f1_val': 0.9906131372307868, 'auprc': 0.9956437028486933, 'loss_val': 0.050821783280722184, 'psi': 0.9926253634779494}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=84 head_norm_before_train=2.030094 cos_to_last_merge=0.9822 (last merge round=39)
[S17] round=84 local utility u=0.205431 metrics={'f1_val': 0.6802207084926344, 'auprc': 0.8986750678330113, 'loss_val': 1.1580053412654583, 'psi': 0.7676024522287852}-{'f1_val': 0.6430874140153984, 'auprc': 0.8919397215866074, 'loss_val': 1.3258612581420872, 'psi': 0.742628337043882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=85 head_norm_before_train=2.181265 (no previous merge yet)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.8328103916484413, 'auprc': 0.779971929396726, 'loss_val': 0.4054295193226904, 'psi': 0.8116750067477552}-{'f1_val': 0.8281469497925584, 'auprc': 0.9721426016062218, 'loss_val': 0.4244275552961547, 'psi': 0.8857452105180237}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.370312 cos_to_last_merge=0.9660 (last merge round=37)
[S3] round=85 local utility u=0.343706 metrics={'f1_val': 0.9797327613879772, 'auprc': 0.9986064743884878, 'loss_val': 0.06838044935735474, 'psi': 0.9872822465881814}-{'f1_val': 0.9020113256586275, 'auprc': 0.9887422162349062, 'loss_val': 0.2598706086041579, 'psi': 0.936703681889139}
[S3] not sending this round → trigger blocked (psi=0.987)
[S4] START round=85 head_norm_before_train=2.035762 (no previous merge yet)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9529283632766373, 'auprc': 0.9652854557886011, 'loss_val': 0.3227936380800344, 'psi': 0.9578712002814228}-{'f1_val': 0.953925930306382, 'auprc': 0.9748052248658874, 'loss_val': 0.31095753692525663, 'psi': 0.962277648130184}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=2.035802 cos_to_last_merge=0.7098 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.710
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952389039542883, 'loss_val': 0.01870170216337326, 'psi': 0.9961167426687899}-{'f1_val': 0.9967019684784577, 'auprc': 0.9982871329332602, 'loss_val': 0.01866582145990484, 'psi': 0.9973360342603788}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.029382 cos_to_last_merge=0.9559 (last merge round=40)
[S6] round=85 local utility u=0.487282 metrics={'f1_val': 0.820082810630694, 'auprc': 0.952989688061148, 'loss_val': 0.6270297531122344, 'psi': 0.8732455616028756}-{'f1_val': 0.7275788331453846, 'auprc': 0.9075989911129517, 'loss_val': 0.9103983701891558, 'psi': 0.7995868963324115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=85 head_norm_before_train=2.238391 cos_to_last_merge=0.9909 (last merge round=35)
[S7] round=85 local utility u=0.084750 metrics={'f1_val': 0.686587430655433, 'auprc': 0.8597108007114705, 'loss_val': 0.34083228876010285, 'psi': 0.7558367786778482}-{'f1_val': 0.6848092730133863, 'auprc': 0.833090468551072, 'loss_val': 0.41980178849717137, 'psi': 0.7441217512284606}
[S7] not sending this round → trigger blocked (psi=0.756)
[S8] START round=85 head_norm_before_train=1.713686 cos_to_last_merge=0.9816 (last merge round=40)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.8877867395683279, 'auprc': 0.9986818225209064, 'loss_val': 0.20369498876307576, 'psi': 0.9321447727493594}-{'f1_val': 0.9869825725025211, 'auprc': 0.9990320472794869, 'loss_val': 0.04165725363210844, 'psi': 0.9918023624133074}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=2.430485 (no previous merge yet)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998036122824381, 'loss_val': 0.015015264797650078, 'psi': 0.9976840623512189}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998724446050767, 'loss_val': 0.014974556584407378, 'psi': 0.9982107253493164}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.282556 (no previous merge yet)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965860269481418, 'loss_val': 0.02491239986345939, 'psi': 0.9956153226983024}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965877841399557, 'loss_val': 0.025147467016318873, 'psi': 0.9957478170676071}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=1.931972 cos_to_last_merge=0.9393 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9965167252514544, 'loss_val': 0.021531562443140983, 'psi': 0.996299174947029}-{'f1_val': 0.996567470639547, 'auprc': 0.9977310951606433, 'loss_val': 0.019678924301978963, 'psi': 0.9970329204479855}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.929624 cos_to_last_merge=0.9715 (last merge round=35)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.7228039320555735, 'auprc': 0.7683577150025965, 'loss_val': 0.8394529111321268, 'psi': 0.7410254452343827}-{'f1_val': 0.7442614005792291, 'auprc': 0.7956126271868815, 'loss_val': 0.7909827298540136, 'psi': 0.76480189122229}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.071816 cos_to_last_merge=0.8017 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.802
[S14] round=85 local utility u=0.818066 metrics={'f1_val': 0.9496680192774801, 'auprc': 0.9990128715310167, 'loss_val': 0.11522541727510281, 'psi': 0.9694059601788948}-{'f1_val': 0.816411787259629, 'auprc': 0.9398062041324473, 'loss_val': 0.7741996278071496, 'psi': 0.8657695540087563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=85 head_norm_before_train=1.768246 cos_to_last_merge=0.9311 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=85 local utility u=0.211244 metrics={'f1_val': 0.70196819164474, 'auprc': 0.9583318397444432, 'loss_val': 0.685399435032729, 'psi': 0.8045136508846213}-{'f1_val': 0.6956960304919546, 'auprc': 0.8519119217994149, 'loss_val': 0.750994869466214, 'psi': 0.7581823870149387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=85 head_norm_before_train=2.184076 cos_to_last_merge=0.9932 (last merge round=41)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.993203446784355, 'auprc': 0.9875669628715108, 'loss_val': 0.03650756575898822, 'psi': 0.9909488532192173}-{'f1_val': 0.992760919414728, 'auprc': 0.9900177456239603, 'loss_val': 0.03459405116275627, 'psi': 0.9916636498984209}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.036767 cos_to_last_merge=0.9818 (last merge round=39)
[S17] round=85 local utility u=0.632062 metrics={'f1_val': 0.8283982682178189, 'auprc': 0.8785033819132534, 'loss_val': 0.7224317514209422, 'psi': 0.8484403136959927}-{'f1_val': 0.6802207084926344, 'auprc': 0.8986750678330113, 'loss_val': 1.1580053412654583, 'psi': 0.7676024522287852}
[S17] not sending this round → trigger blocked (psi=0.848)
[S2] START round=86 head_norm_before_train=2.184654 (no previous merge yet)
[S2] round=86 local utility u=0.274639 metrics={'f1_val': 0.8273624748225058, 'auprc': 0.9842665738129782, 'loss_val': 0.43634721853975467, 'psi': 0.8901241144186948}-{'f1_val': 0.8328103916484413, 'auprc': 0.779971929396726, 'loss_val': 0.4054295193226904, 'psi': 0.8116750067477552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=86 head_norm_before_train=2.376807 cos_to_last_merge=0.9657 (last merge round=37)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9982394454025626, 'loss_val': 0.17629135554624056, 'psi': 0.9757935435437632}-{'f1_val': 0.9797327613879772, 'auprc': 0.9986064743884878, 'loss_val': 0.06838044935735474, 'psi': 0.9872822465881814}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=2.045767 (no previous merge yet)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9535631868880031, 'auprc': 0.9624465560764183, 'loss_val': 0.3261786189138455, 'psi': 0.9571165345633692}-{'f1_val': 0.9529283632766373, 'auprc': 0.9652854557886011, 'loss_val': 0.3227936380800344, 'psi': 0.9578712002814228}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=2.036525 cos_to_last_merge=0.7094 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.709
[S5] round=86 local utility u=0.007259 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998091953844355, 'loss_val': 0.01789364698252561, 'psi': 0.9979448592408489}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952389039542883, 'loss_val': 0.01870170216337326, 'psi': 0.9961167426687899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=86 head_norm_before_train=2.034613 cos_to_last_merge=0.9553 (last merge round=40)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.6173157662398044, 'auprc': 0.8553070812882743, 'loss_val': 1.2654763708568582, 'psi': 0.7125122922591924}-{'f1_val': 0.820082810630694, 'auprc': 0.952989688061148, 'loss_val': 0.6270297531122344, 'psi': 0.8732455616028756}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=2.240954 cos_to_last_merge=0.9907 (last merge round=35)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6620281584773854, 'auprc': 0.801660763828274, 'loss_val': 0.7498806471539186, 'psi': 0.7178812006177409}-{'f1_val': 0.686587430655433, 'auprc': 0.8597108007114705, 'loss_val': 0.34083228876010285, 'psi': 0.7558367786778482}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.720603 cos_to_last_merge=0.9811 (last merge round=40)
[S8] round=86 local utility u=0.401377 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9992642599476739, 'loss_val': 0.03251214404943762, 'psi': 0.9953600404021451}-{'f1_val': 0.8877867395683279, 'auprc': 0.9986818225209064, 'loss_val': 0.20369498876307576, 'psi': 0.9321447727493594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=86 head_norm_before_train=2.434874 (no previous merge yet)
[S9] round=86 local utility u=0.004275 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.999804603692391, 'loss_val': 0.013924918970624596, 'psi': 0.9984301319310029}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998036122824381, 'loss_val': 0.015015264797650078, 'psi': 0.9976840623512189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=86 head_norm_before_train=2.282730 (no previous merge yet)
[S10] round=86 local utility u=0.000071 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965930124517318, 'loss_val': 0.024791437629391275, 'psi': 0.9956181168997384}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965860269481418, 'loss_val': 0.02491239986345939, 'psi': 0.9956153226983024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=86 head_norm_before_train=1.935115 cos_to_last_merge=0.9391 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9947012080834785, 'loss_val': 0.0386559444145269, 'psi': 0.9955729680798386}-{'f1_val': 0.9961541414107454, 'auprc': 0.9965167252514544, 'loss_val': 0.021531562443140983, 'psi': 0.996299174947029}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.932894 cos_to_last_merge=0.9712 (last merge round=35)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6051940490649246, 'auprc': 0.6496459357051273, 'loss_val': 1.498066341977568, 'psi': 0.6229748037210057}-{'f1_val': 0.7228039320555735, 'auprc': 0.7683577150025965, 'loss_val': 0.8394529111321268, 'psi': 0.7410254452343827}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.077031 cos_to_last_merge=0.8014 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.801
[S14] round=86 local utility u=0.130078 metrics={'f1_val': 0.9810444928728177, 'auprc': 0.9973157530361916, 'loss_val': 0.038237384085861144, 'psi': 0.9875529969381673}-{'f1_val': 0.9496680192774801, 'auprc': 0.9990128715310167, 'loss_val': 0.11522541727510281, 'psi': 0.9694059601788948}
[S14] not sending this round → trigger blocked (psi=0.988)
[S15] START round=86 head_norm_before_train=1.772921 cos_to_last_merge=0.9305 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=86 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9918527526661274, 'loss_val': 0.024416079447312677, 'psi': 0.9945405475757355}-{'f1_val': 0.70196819164474, 'auprc': 0.9583318397444432, 'loss_val': 0.685399435032729, 'psi': 0.8045136508846213}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=86 head_norm_before_train=2.189005 cos_to_last_merge=0.9932 (last merge round=41)
[S16] round=86 local utility u=0.006464 metrics={'f1_val': 0.9920518180007764, 'auprc': 0.9964497518038117, 'loss_val': 0.04331843227040494, 'psi': 0.9938109915219905}-{'f1_val': 0.993203446784355, 'auprc': 0.9875669628715108, 'loss_val': 0.03650756575898822, 'psi': 0.9909488532192173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=86 head_norm_before_train=2.042488 cos_to_last_merge=0.9816 (last merge round=39)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.6212881243316911, 'auprc': 0.8769116908091545, 'loss_val': 1.49896655249803, 'psi': 0.7235375509226765}-{'f1_val': 0.8283982682178189, 'auprc': 0.8785033819132534, 'loss_val': 0.7224317514209422, 'psi': 0.8484403136959927}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.188323 (no previous merge yet)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.8081218713299467, 'auprc': 0.8621159057992782, 'loss_val': 0.4979328503986792, 'psi': 0.8297194851176793}-{'f1_val': 0.8273624748225058, 'auprc': 0.9842665738129782, 'loss_val': 0.43634721853975467, 'psi': 0.8901241144186948}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.383522 cos_to_last_merge=0.9653 (last merge round=37)
[S3] round=87 local utility u=0.189649 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9991485951561248, 'loss_val': 0.01645482160095711, 'psi': 0.9978306681348037}-{'f1_val': 0.9608296089712303, 'auprc': 0.9982394454025626, 'loss_val': 0.17629135554624056, 'psi': 0.9757935435437632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=87 head_norm_before_train=2.049634 (no previous merge yet)
[S4] round=87 local utility u=0.009854 metrics={'f1_val': 0.9545942926063459, 'auprc': 0.9667297144542026, 'loss_val': 0.32550637955648765, 'psi': 0.9594484613454886}-{'f1_val': 0.9535631868880031, 'auprc': 0.9624465560764183, 'loss_val': 0.3261786189138455, 'psi': 0.9571165345633692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=87 head_norm_before_train=2.042022 cos_to_last_merge=0.7088 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.709
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.995507783372634, 'loss_val': 0.018201298627343803, 'psi': 0.9962242944361281}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998091953844355, 'loss_val': 0.01789364698252561, 'psi': 0.9979448592408489}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.036571 cos_to_last_merge=0.9551 (last merge round=40)
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.8289775491770742, 'auprc': 0.9682845127001364, 'loss_val': 0.36832356616458084, 'psi': 0.8847003345862992}-{'f1_val': 0.6173157662398044, 'auprc': 0.8553070812882743, 'loss_val': 1.2654763708568582, 'psi': 0.7125122922591924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=87 head_norm_before_train=2.242434 cos_to_last_merge=0.9905 (last merge round=35)
[S7] round=87 local utility u=0.158001 metrics={'f1_val': 0.6585249654750724, 'auprc': 0.8194660188096428, 'loss_val': 0.4662744686455898, 'psi': 0.7229013868089006}-{'f1_val': 0.6620281584773854, 'auprc': 0.801660763828274, 'loss_val': 0.7498806471539186, 'psi': 0.7178812006177409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=87 head_norm_before_train=1.726585 cos_to_last_merge=0.9808 (last merge round=40)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9990871610101416, 'loss_val': 0.037497302364150456, 'psi': 0.9934458109213393}-{'f1_val': 0.9927572273717925, 'auprc': 0.9992642599476739, 'loss_val': 0.03251214404943762, 'psi': 0.9953600404021451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.439891 (no previous merge yet)
[S9] round=87 local utility u=0.000028 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998197977850356, 'loss_val': 0.013913842206237812, 'psi': 0.9984362095680608}-{'f1_val': 0.9975138174234109, 'auprc': 0.999804603692391, 'loss_val': 0.013924918970624596, 'psi': 0.9984301319310029}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=87 head_norm_before_train=2.285614 (no previous merge yet)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965851193127689, 'loss_val': 0.024833974765754614, 'psi': 0.9956149596441533}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965930124517318, 'loss_val': 0.024791437629391275, 'psi': 0.9956181168997384}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=1.937289 cos_to_last_merge=0.9390 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9855739616101489, 'auprc': 0.9945906062293282, 'loss_val': 0.06974064212343373, 'psi': 0.9891806194578205}-{'f1_val': 0.9961541414107454, 'auprc': 0.9947012080834785, 'loss_val': 0.0386559444145269, 'psi': 0.9955729680798386}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.939466 cos_to_last_merge=0.9707 (last merge round=35)
[S13] round=87 local utility u=0.765221 metrics={'f1_val': 0.7441515366118606, 'auprc': 0.7295804909079051, 'loss_val': 1.0411719339479149, 'psi': 0.7383231183302784}-{'f1_val': 0.6051940490649246, 'auprc': 0.6496459357051273, 'loss_val': 1.498066341977568, 'psi': 0.6229748037210057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=87 head_norm_before_train=2.082208 cos_to_last_merge=0.8009 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.801
[S14] round=87 local utility u=0.060730 metrics={'f1_val': 0.9975496976416445, 'auprc': 0.9990059428557352, 'loss_val': 0.020878605892876285, 'psi': 0.9981321957272807}-{'f1_val': 0.9810444928728177, 'auprc': 0.9973157530361916, 'loss_val': 0.038237384085861144, 'psi': 0.9875529969381673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=87 head_norm_before_train=1.778674 cos_to_last_merge=0.9299 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.7493589949739539, 'auprc': 0.9890955608246188, 'loss_val': 0.5894666704590266, 'psi': 0.8452536213142199}-{'f1_val': 0.9963324108488076, 'auprc': 0.9918527526661274, 'loss_val': 0.024416079447312677, 'psi': 0.9945405475757355}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=2.192589 cos_to_last_merge=0.9928 (last merge round=41)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.8702946810235902, 'auprc': 0.9900029453588043, 'loss_val': 0.7198770444079577, 'psi': 0.9181779867576758}-{'f1_val': 0.9920518180007764, 'auprc': 0.9964497518038117, 'loss_val': 0.04331843227040494, 'psi': 0.9938109915219905}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.047584 cos_to_last_merge=0.9813 (last merge round=39)
[S17] round=87 local utility u=0.116412 metrics={'f1_val': 0.63673740064062, 'auprc': 0.8830837393587845, 'loss_val': 1.3773534055004761, 'psi': 0.7352759361278858}-{'f1_val': 0.6212881243316911, 'auprc': 0.8769116908091545, 'loss_val': 1.49896655249803, 'psi': 0.7235375509226765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=88 head_norm_before_train=2.194171 (no previous merge yet)
[S2] round=88 local utility u=0.227839 metrics={'f1_val': 0.8291907064485643, 'auprc': 0.9480268616492972, 'loss_val': 0.4264013836869063, 'psi': 0.8767251685288575}-{'f1_val': 0.8081218713299467, 'auprc': 0.8621159057992782, 'loss_val': 0.4979328503986792, 'psi': 0.8297194851176793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=88 head_norm_before_train=2.390168 cos_to_last_merge=0.9649 (last merge round=37)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9309998755549336, 'auprc': 0.9984059418697315, 'loss_val': 0.18517736005129232, 'psi': 0.9579623020808528}-{'f1_val': 0.9969520501205896, 'auprc': 0.9991485951561248, 'loss_val': 0.01645482160095711, 'psi': 0.9978306681348037}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.047281 (no previous merge yet)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9526968335882997, 'auprc': 0.9694193683770689, 'loss_val': 0.3276549254195385, 'psi': 0.9593858475038073}-{'f1_val': 0.9545942926063459, 'auprc': 0.9667297144542026, 'loss_val': 0.32550637955648765, 'psi': 0.9594484613454886}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=2.048201 cos_to_last_merge=0.7081 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.708
[S5] round=88 local utility u=0.006752 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9997941646528108, 'loss_val': 0.019762038404656727, 'psi': 0.9981594010277629}-{'f1_val': 0.9967019684784577, 'auprc': 0.995507783372634, 'loss_val': 0.018201298627343803, 'psi': 0.9962242944361281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=88 head_norm_before_train=2.037430 cos_to_last_merge=0.9549 (last merge round=40)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.7841572587515464, 'auprc': 0.9576557782154181, 'loss_val': 0.6895508728217301, 'psi': 0.853556666537095}-{'f1_val': 0.8289775491770742, 'auprc': 0.9682845127001364, 'loss_val': 0.36832356616458084, 'psi': 0.8847003345862992}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=2.242875 cos_to_last_merge=0.9905 (last merge round=35)
[S7] round=88 local utility u=0.305851 metrics={'f1_val': 0.7040535041372711, 'auprc': 0.8695981328044302, 'loss_val': 0.27814073295768854, 'psi': 0.7702713556041347}-{'f1_val': 0.6585249654750724, 'auprc': 0.8194660188096428, 'loss_val': 0.4662744686455898, 'psi': 0.7229013868089006}
[S7] not sending this round → trigger blocked (psi=0.770)
[S8] START round=88 head_norm_before_train=1.731825 cos_to_last_merge=0.9805 (last merge round=40)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.9961456310336725, 'loss_val': 0.0380146787181195, 'psi': 0.9924852264029643}-{'f1_val': 0.9896849108621378, 'auprc': 0.9990871610101416, 'loss_val': 0.037497302364150456, 'psi': 0.9934458109213393}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.441879 (no previous merge yet)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999764104437198, 'loss_val': 0.01722218442297276, 'psi': 0.998233412099108}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998197977850356, 'loss_val': 0.013913842206237812, 'psi': 0.9984362095680608}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.289828 (no previous merge yet)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965921827702063, 'loss_val': 0.0248864074271434, 'psi': 0.9956177850271282}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965851193127689, 'loss_val': 0.024833974765754614, 'psi': 0.9956149596441533}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.940679 cos_to_last_merge=0.9387 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.8397185561337105, 'auprc': 0.9947546466230797, 'loss_val': 0.2229839542608424, 'psi': 0.9017329923294581}-{'f1_val': 0.9855739616101489, 'auprc': 0.9945906062293282, 'loss_val': 0.06974064212343373, 'psi': 0.9891806194578205}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.943409 cos_to_last_merge=0.9703 (last merge round=35)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.673496683954042, 'auprc': 0.6867349680859138, 'loss_val': 1.1004960695257366, 'psi': 0.6787919976067908}-{'f1_val': 0.7441515366118606, 'auprc': 0.7295804909079051, 'loss_val': 1.0411719339479149, 'psi': 0.7383231183302784}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.082677 cos_to_last_merge=0.8005 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.801
[S14] round=88 local utility u=0.002470 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9990265367064631, 'loss_val': 0.018643074588846117, 'psi': 0.9984046352565279}-{'f1_val': 0.9975496976416445, 'auprc': 0.9990059428557352, 'loss_val': 0.020878605892876285, 'psi': 0.9981321957272807}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=88 head_norm_before_train=1.784680 cos_to_last_merge=0.9294 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=88 local utility u=1.000000 metrics={'f1_val': 0.9947578113099733, 'auprc': 0.9938289542721792, 'loss_val': 0.02994995380744271, 'psi': 0.9943862684948557}-{'f1_val': 0.7493589949739539, 'auprc': 0.9890955608246188, 'loss_val': 0.5894666704590266, 'psi': 0.8452536213142199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=88 head_norm_before_train=2.196701 cos_to_last_merge=0.9926 (last merge round=41)
[S16] round=88 local utility u=0.717899 metrics={'f1_val': 0.9930784482674505, 'auprc': 0.9948604921405657, 'loss_val': 0.035354916595044465, 'psi': 0.9937912658166965}-{'f1_val': 0.8702946810235902, 'auprc': 0.9900029453588043, 'loss_val': 0.7198770444079577, 'psi': 0.9181779867576758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=88 head_norm_before_train=2.053158 cos_to_last_merge=0.9810 (last merge round=39)
[S17] round=88 local utility u=0.178085 metrics={'f1_val': 0.6672109421625699, 'auprc': 0.887977844206051, 'loss_val': 1.2187077775421709, 'psi': 0.7555177029799623}-{'f1_val': 0.63673740064062, 'auprc': 0.8830837393587845, 'loss_val': 1.3773534055004761, 'psi': 0.7352759361278858}
[S17] not sending this round → trigger blocked (psi=0.756)
[S2] START round=89 head_norm_before_train=2.199472 (no previous merge yet)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7665483194256182, 'auprc': 0.9914161305829745, 'loss_val': 0.4676717106592582, 'psi': 0.8564954438885607}-{'f1_val': 0.8291907064485643, 'auprc': 0.9480268616492972, 'loss_val': 0.4264013836869063, 'psi': 0.8767251685288575}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.393777 cos_to_last_merge=0.9649 (last merge round=37)
[S3] round=89 local utility u=0.084678 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9968454993473864, 'loss_val': 0.19030413053742318, 'psi': 0.9752544944521291}-{'f1_val': 0.9309998755549336, 'auprc': 0.9984059418697315, 'loss_val': 0.18517736005129232, 'psi': 0.9579623020808528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=89 head_norm_before_train=2.050606 (no previous merge yet)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9540774525292007, 'auprc': 0.9668934790798186, 'loss_val': 0.3291829836231467, 'psi': 0.9592038631494478}-{'f1_val': 0.9526968335882997, 'auprc': 0.9694193683770689, 'loss_val': 0.3276549254195385, 'psi': 0.9593858475038073}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.057665 cos_to_last_merge=0.7075 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.708
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9977245837014116, 'loss_val': 0.018282391387238833, 'psi': 0.9971110145676392}-{'f1_val': 0.9970695586110643, 'auprc': 0.9997941646528108, 'loss_val': 0.019762038404656727, 'psi': 0.9981594010277629}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.041991 cos_to_last_merge=0.9546 (last merge round=40)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.7154132367463764, 'auprc': 0.9033705902213649, 'loss_val': 1.0040096873270046, 'psi': 0.7905961781363717}-{'f1_val': 0.7841572587515464, 'auprc': 0.9576557782154181, 'loss_val': 0.6895508728217301, 'psi': 0.853556666537095}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=2.246583 cos_to_last_merge=0.9903 (last merge round=35)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.6175151287789837, 'auprc': 0.7910819683885266, 'loss_val': 1.029940529915929, 'psi': 0.6869418646228009}-{'f1_val': 0.7040535041372711, 'auprc': 0.8695981328044302, 'loss_val': 0.27814073295768854, 'psi': 0.7702713556041347}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.735257 cos_to_last_merge=0.9803 (last merge round=40)
[S8] round=89 local utility u=0.003745 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9989508627959279, 'loss_val': 0.036780924247698014, 'psi': 0.993391291635654}-{'f1_val': 0.9900449566491589, 'auprc': 0.9961456310336725, 'loss_val': 0.0380146787181195, 'psi': 0.9924852264029643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=89 head_norm_before_train=2.444618 (no previous merge yet)
[S9] round=89 local utility u=0.000603 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999763266799025, 'loss_val': 0.01620574795240124, 'psi': 0.9982522781792467}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999764104437198, 'loss_val': 0.01722218442297276, 'psi': 0.998233412099108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=89 head_norm_before_train=2.291875 (no previous merge yet)
[S10] round=89 local utility u=0.000013 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966070665772073, 'loss_val': 0.024904920106297183, 'psi': 0.9956237385499287}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965921827702063, 'loss_val': 0.0248864074271434, 'psi': 0.9956177850271282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=89 head_norm_before_train=1.945114 cos_to_last_merge=0.9383 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=89 local utility u=0.575062 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9974381910440071, 'loss_val': 0.01952480737417923, 'psi': 0.9966677612640501}-{'f1_val': 0.8397185561337105, 'auprc': 0.9947546466230797, 'loss_val': 0.2229839542608424, 'psi': 0.9017329923294581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=89 head_norm_before_train=1.948705 cos_to_last_merge=0.9698 (last merge round=35)
[S13] round=89 local utility u=0.099372 metrics={'f1_val': 0.733136840196464, 'auprc': 0.6882861303418397, 'loss_val': 1.2642471851469754, 'psi': 0.7151965562546143}-{'f1_val': 0.673496683954042, 'auprc': 0.6867349680859138, 'loss_val': 1.1004960695257366, 'psi': 0.6787919976067908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=89 head_norm_before_train=2.085247 cos_to_last_merge=0.8004 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9393189219353049, 'auprc': 0.961043907115027, 'loss_val': 0.17845554980735887, 'psi': 0.9480089160071937}-{'f1_val': 0.9979900342899044, 'auprc': 0.9990265367064631, 'loss_val': 0.018643074588846117, 'psi': 0.9984046352565279}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=1.790157 cos_to_last_merge=0.9289 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.9371745680211624, 'auprc': 0.9956294207243561, 'loss_val': 0.12378469263706166, 'psi': 0.96055650910244}-{'f1_val': 0.9947578113099733, 'auprc': 0.9938289542721792, 'loss_val': 0.02994995380744271, 'psi': 0.9943862684948557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=2.201523 cos_to_last_merge=0.9925 (last merge round=41)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9931718136311698, 'auprc': 0.991418026572679, 'loss_val': 0.030501781124629354, 'psi': 0.9924702988077735}-{'f1_val': 0.9930784482674505, 'auprc': 0.9948604921405657, 'loss_val': 0.035354916595044465, 'psi': 0.9937912658166965}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.056922 cos_to_last_merge=0.9809 (last merge round=39)
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.6650276565457378, 'auprc': 0.8881495897689841, 'loss_val': 1.23275334884732, 'psi': 0.7542764298350363}-{'f1_val': 0.6672109421625699, 'auprc': 0.887977844206051, 'loss_val': 1.2187077775421709, 'psi': 0.7555177029799623}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.204412 (no previous merge yet)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.8328103916484413, 'auprc': 0.7537945909044297, 'loss_val': 0.4258115449969345, 'psi': 0.8012040713508366}-{'f1_val': 0.7665483194256182, 'auprc': 0.9914161305829745, 'loss_val': 0.4676717106592582, 'psi': 0.8564954438885607}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.390064 cos_to_last_merge=0.9651 (last merge round=37)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8913103744185937, 'auprc': 0.9981531387517997, 'loss_val': 0.15665516253214035, 'psi': 0.9340474801518761}-{'f1_val': 0.9608604911886242, 'auprc': 0.9968454993473864, 'loss_val': 0.19030413053742318, 'psi': 0.9752544944521291}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=2.056438 (no previous merge yet)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9523536098456132, 'auprc': 0.9608349894283589, 'loss_val': 0.3306942147775313, 'psi': 0.9557461616787115}-{'f1_val': 0.9540774525292007, 'auprc': 0.9668934790798186, 'loss_val': 0.3291829836231467, 'psi': 0.9592038631494478}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=2.063256 cos_to_last_merge=0.7072 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.707
[S5] round=90 local utility u=0.003343 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998378789482328, 'loss_val': 0.017937271064634237, 'psi': 0.9979563326663677}-{'f1_val': 0.9967019684784577, 'auprc': 0.9977245837014116, 'loss_val': 0.018282391387238833, 'psi': 0.9971110145676392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=90 head_norm_before_train=2.049277 cos_to_last_merge=0.9542 (last merge round=40)
[S6] round=90 local utility u=0.621225 metrics={'f1_val': 0.8402596427248188, 'auprc': 0.9313104822769364, 'loss_val': 0.5944576399439523, 'psi': 0.8766799785456658}-{'f1_val': 0.7154132367463764, 'auprc': 0.9033705902213649, 'loss_val': 1.0040096873270046, 'psi': 0.7905961781363717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=90 head_norm_before_train=2.251119 cos_to_last_merge=0.9901 (last merge round=35)
[S7] round=90 local utility u=0.351724 metrics={'f1_val': 0.6533525417940884, 'auprc': 0.8026342847050841, 'loss_val': 0.5761733929078805, 'psi': 0.7130652389584867}-{'f1_val': 0.6175151287789837, 'auprc': 0.7910819683885266, 'loss_val': 1.029940529915929, 'psi': 0.6869418646228009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=90 head_norm_before_train=1.741179 cos_to_last_merge=0.9800 (last merge round=40)
[S8] round=90 local utility u=0.016522 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9988722372905828, 'loss_val': 0.0307271278264063, 'psi': 0.9960824770874556}-{'f1_val': 0.9896849108621378, 'auprc': 0.9989508627959279, 'loss_val': 0.036780924247698014, 'psi': 0.993391291635654}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=90 head_norm_before_train=2.453934 (no previous merge yet)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998544238552072, 'loss_val': 0.014092994246560638, 'psi': 0.9977043869803266}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999763266799025, 'loss_val': 0.01620574795240124, 'psi': 0.9982522781792467}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.293738 (no previous merge yet)
[S10] round=90 local utility u=0.000023 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966149160075772, 'loss_val': 0.02488274987148621, 'psi': 0.9956268783220765}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966070665772073, 'loss_val': 0.024904920106297183, 'psi': 0.9956237385499287}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=90 head_norm_before_train=1.950292 cos_to_last_merge=0.9379 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=90 local utility u=0.002537 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982872600182866, 'loss_val': 0.019478156899524462, 'psi': 0.9972553863910429}-{'f1_val': 0.9961541414107454, 'auprc': 0.9974381910440071, 'loss_val': 0.01952480737417923, 'psi': 0.9966677612640501}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=90 head_norm_before_train=1.952338 cos_to_last_merge=0.9695 (last merge round=35)
[S13] round=90 local utility u=0.253783 metrics={'f1_val': 0.756685138756526, 'auprc': 0.7253711944256923, 'loss_val': 1.0092264930200634, 'psi': 0.7441595610241925}-{'f1_val': 0.733136840196464, 'auprc': 0.6882861303418397, 'loss_val': 1.2642471851469754, 'psi': 0.7151965562546143}
[S13] not sending this round → trigger blocked (psi=0.744)
[S14] START round=90 head_norm_before_train=2.089130 cos_to_last_merge=0.8004 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9347692789129906, 'auprc': 0.9418202416064807, 'loss_val': 0.21927874456889584, 'psi': 0.9375896639903867}-{'f1_val': 0.9393189219353049, 'auprc': 0.961043907115027, 'loss_val': 0.17845554980735887, 'psi': 0.9480089160071937}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=1.795509 cos_to_last_merge=0.9284 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.6989952668838513, 'auprc': 0.6927542771546069, 'loss_val': 0.785651691223369, 'psi': 0.6964988709921536}-{'f1_val': 0.9371745680211624, 'auprc': 0.9956294207243561, 'loss_val': 0.12378469263706166, 'psi': 0.96055650910244}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.205950 cos_to_last_merge=0.9925 (last merge round=41)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9474732263449347, 'auprc': 0.9828865611315214, 'loss_val': 0.18416399911758816, 'psi': 0.9616385602595694}-{'f1_val': 0.9931718136311698, 'auprc': 0.991418026572679, 'loss_val': 0.030501781124629354, 'psi': 0.9924702988077735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.061499 cos_to_last_merge=0.9806 (last merge round=39)
[S17] round=90 local utility u=0.065208 metrics={'f1_val': 0.6780939357350944, 'auprc': 0.8924823446371867, 'loss_val': 1.1937334976739844, 'psi': 0.7638492992959313}-{'f1_val': 0.6650276565457378, 'auprc': 0.8881495897689841, 'loss_val': 1.23275334884732, 'psi': 0.7542764298350363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=91 head_norm_before_train=2.209960 (no previous merge yet)
[S2] round=91 local utility u=0.326471 metrics={'f1_val': 0.8240598922179079, 'auprc': 0.993447214206377, 'loss_val': 0.43932408973696624, 'psi': 0.8918148210132956}-{'f1_val': 0.8328103916484413, 'auprc': 0.7537945909044297, 'loss_val': 0.4258115449969345, 'psi': 0.8012040713508366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=91 head_norm_before_train=2.391078 cos_to_last_merge=0.9650 (last merge round=37)
[S3] round=91 local utility u=0.184763 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9924428449293181, 'loss_val': 0.18368478101991928, 'psi': 0.9731319670164355}-{'f1_val': 0.8913103744185937, 'auprc': 0.9981531387517997, 'loss_val': 0.15665516253214035, 'psi': 0.9340474801518761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=91 head_norm_before_train=2.057488 (no previous merge yet)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.94758681501146, 'auprc': 0.9606221911113408, 'loss_val': 0.3281659336437341, 'psi': 0.9528009654514125}-{'f1_val': 0.9523536098456132, 'auprc': 0.9608349894283589, 'loss_val': 0.3306942147775313, 'psi': 0.9557461616787115}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=2.070229 cos_to_last_merge=0.7070 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.707
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9997764868012253, 'loss_val': 0.02555846044940934, 'psi': 0.9981523298871288}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998378789482328, 'loss_val': 0.017937271064634237, 'psi': 0.9979563326663677}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.053807 cos_to_last_merge=0.9538 (last merge round=40)
[S6] round=91 local utility u=0.023013 metrics={'f1_val': 0.8256819763719184, 'auprc': 0.9488983284150204, 'loss_val': 0.5137296410007584, 'psi': 0.8749685171891592}-{'f1_val': 0.8402596427248188, 'auprc': 0.9313104822769364, 'loss_val': 0.5944576399439523, 'psi': 0.8766799785456658}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=91 head_norm_before_train=2.253311 cos_to_last_merge=0.9901 (last merge round=35)
[S7] round=91 local utility u=0.006722 metrics={'f1_val': 0.6609311887753533, 'auprc': 0.8026104699456904, 'loss_val': 0.6081290689015243, 'psi': 0.7176029012434881}-{'f1_val': 0.6533525417940884, 'auprc': 0.8026342847050841, 'loss_val': 0.5761733929078805, 'psi': 0.7130652389584867}
[S7] not sending this round → trigger blocked (psi=0.718)
[S8] START round=91 head_norm_before_train=1.747488 cos_to_last_merge=0.9796 (last merge round=40)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9990361755702493, 'loss_val': 0.03190928628437683, 'psi': 0.9948671192654192}-{'f1_val': 0.9942226369520374, 'auprc': 0.9988722372905828, 'loss_val': 0.0307271278264063, 'psi': 0.9960824770874556}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.463099 (no previous merge yet)
[S9] round=91 local utility u=0.000070 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999836535832826, 'loss_val': 0.01389871373560403, 'psi': 0.997697231771374}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998544238552072, 'loss_val': 0.014092994246560638, 'psi': 0.9977043869803266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=91 head_norm_before_train=2.297679 (no previous merge yet)
[S10] round=91 local utility u=0.000011 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966092916698525, 'loss_val': 0.0248437870233463, 'psi': 0.9956246285869867}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966149160075772, 'loss_val': 0.02488274987148621, 'psi': 0.9956268783220765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=91 head_norm_before_train=1.955801 cos_to_last_merge=0.9374 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.993205633992707, 'auprc': 0.9980518228911595, 'loss_val': 0.02912805658007642, 'psi': 0.995144109552088}-{'f1_val': 0.996567470639547, 'auprc': 0.9982872600182866, 'loss_val': 0.019478156899524462, 'psi': 0.9972553863910429}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.957301 cos_to_last_merge=0.9690 (last merge round=35)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6852244530628251, 'auprc': 0.6940528150375467, 'loss_val': 1.1201276571517955, 'psi': 0.6887557978527137}-{'f1_val': 0.756685138756526, 'auprc': 0.7253711944256923, 'loss_val': 1.0092264930200634, 'psi': 0.7441595610241925}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.094140 cos_to_last_merge=0.8004 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9307732527730411, 'auprc': 0.932276715475734, 'loss_val': 0.24137326144666338, 'psi': 0.9313746378541183}-{'f1_val': 0.9347692789129906, 'auprc': 0.9418202416064807, 'loss_val': 0.21927874456889584, 'psi': 0.9375896639903867}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=1.800849 cos_to_last_merge=0.9280 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=91 local utility u=0.693392 metrics={'f1_val': 0.7638535402018108, 'auprc': 0.9689713962610831, 'loss_val': 0.616667844036955, 'psi': 0.8459006826255198}-{'f1_val': 0.6989952668838513, 'auprc': 0.6927542771546069, 'loss_val': 0.785651691223369, 'psi': 0.6964988709921536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=91 head_norm_before_train=2.210545 cos_to_last_merge=0.9926 (last merge round=41)
[S16] round=91 local utility u=0.222729 metrics={'f1_val': 0.9931718136311698, 'auprc': 0.9896960705182285, 'loss_val': 0.03332541125792224, 'psi': 0.9917815163859933}-{'f1_val': 0.9474732263449347, 'auprc': 0.9828865611315214, 'loss_val': 0.18416399911758816, 'psi': 0.9616385602595694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=91 head_norm_before_train=2.067012 cos_to_last_merge=0.9803 (last merge round=39)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.6566772451664306, 'auprc': 0.8813380758199625, 'loss_val': 1.2703627786794411, 'psi': 0.7465415774278433}-{'f1_val': 0.6780939357350944, 'auprc': 0.8924823446371867, 'loss_val': 1.1937334976739844, 'psi': 0.7638492992959313}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.213636 (no previous merge yet)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8315258271881565, 'auprc': 0.9216241713654464, 'loss_val': 0.43831033117955526, 'psi': 0.8675651648590725}-{'f1_val': 0.8240598922179079, 'auprc': 0.993447214206377, 'loss_val': 0.43932408973696624, 'psi': 0.8918148210132956}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.395434 cos_to_last_merge=0.9648 (last merge round=37)
[S3] round=92 local utility u=0.201398 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9988433910268862, 'loss_val': 0.02379327159197705, 'psi': 0.998062567389711}-{'f1_val': 0.9602580484078469, 'auprc': 0.9924428449293181, 'loss_val': 0.18368478101991928, 'psi': 0.9731319670164355}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=92 head_norm_before_train=2.055948 (no previous merge yet)
[S4] round=92 local utility u=0.053067 metrics={'f1_val': 0.9550800217806715, 'auprc': 0.9744544269788453, 'loss_val': 0.3084877758058276, 'psi': 0.9628297838599411}-{'f1_val': 0.94758681501146, 'auprc': 0.9606221911113408, 'loss_val': 0.3281659336437341, 'psi': 0.9528009654514125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=92 head_norm_before_train=2.080949 cos_to_last_merge=0.7062 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.706
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9997664693292442, 'loss_val': 0.038186895299875546, 'psi': 0.9984117610973329}-{'f1_val': 0.9970695586110643, 'auprc': 0.9997764868012253, 'loss_val': 0.02555846044940934, 'psi': 0.9981523298871288}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.061055 cos_to_last_merge=0.9533 (last merge round=40)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7152865738583959, 'auprc': 0.8934407632927603, 'loss_val': 0.9294183012231544, 'psi': 0.7865482496321416}-{'f1_val': 0.8256819763719184, 'auprc': 0.9488983284150204, 'loss_val': 0.5137296410007584, 'psi': 0.8749685171891592}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=2.254565 cos_to_last_merge=0.9899 (last merge round=35)
[S7] round=92 local utility u=0.618066 metrics={'f1_val': 0.7291723908926281, 'auprc': 0.9478907205904189, 'loss_val': 0.21728473442792742, 'psi': 0.8166597227717445}-{'f1_val': 0.6609311887753533, 'auprc': 0.8026104699456904, 'loss_val': 0.6081290689015243, 'psi': 0.7176029012434881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=92 head_norm_before_train=1.753766 cos_to_last_merge=0.9792 (last merge round=40)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.971684560730762, 'auprc': 0.9944717768554825, 'loss_val': 0.06887754645900118, 'psi': 0.9807994471806503}-{'f1_val': 0.9920877483955324, 'auprc': 0.9990361755702493, 'loss_val': 0.03190928628437683, 'psi': 0.9948671192654192}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.468484 (no previous merge yet)
[S9] round=92 local utility u=0.003885 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998376579778725, 'loss_val': 0.013588194502436538, 'psi': 0.9984433536451955}-{'f1_val': 0.9962710290637395, 'auprc': 0.999836535832826, 'loss_val': 0.01389871373560403, 'psi': 0.997697231771374}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=92 head_norm_before_train=2.302718 (no previous merge yet)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9966065342897487, 'loss_val': 0.024976379012856584, 'psi': 0.995491779247523}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966092916698525, 'loss_val': 0.0248437870233463, 'psi': 0.9956246285869867}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=1.959828 cos_to_last_merge=0.9371 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=92 local utility u=0.014237 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979915721172734, 'loss_val': 0.020522095742609905, 'psi': 0.9971248315550632}-{'f1_val': 0.993205633992707, 'auprc': 0.9980518228911595, 'loss_val': 0.02912805658007642, 'psi': 0.995144109552088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=92 head_norm_before_train=1.964265 cos_to_last_merge=0.9684 (last merge round=35)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6288999018056589, 'auprc': 0.6591758588415105, 'loss_val': 1.3509370987407887, 'psi': 0.6410102846199996}-{'f1_val': 0.6852244530628251, 'auprc': 0.6940528150375467, 'loss_val': 1.1201276571517955, 'psi': 0.6887557978527137}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.099108 cos_to_last_merge=0.8003 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=92 local utility u=0.131388 metrics={'f1_val': 0.9384479591173225, 'auprc': 0.9835023088302671, 'loss_val': 0.17832166346786732, 'psi': 0.9564696990025003}-{'f1_val': 0.9307732527730411, 'auprc': 0.932276715475734, 'loss_val': 0.24137326144666338, 'psi': 0.9313746378541183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=92 head_norm_before_train=1.805105 cos_to_last_merge=0.9276 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=92 local utility u=0.807187 metrics={'f1_val': 0.9357534448119964, 'auprc': 0.9955190507902144, 'loss_val': 0.11333682704464752, 'psi': 0.9596596872032837}-{'f1_val': 0.7638535402018108, 'auprc': 0.9689713962610831, 'loss_val': 0.616667844036955, 'psi': 0.8459006826255198}
[S15] not sending this round → trigger blocked (psi=0.960)
[S16] START round=92 head_norm_before_train=2.214357 cos_to_last_merge=0.9926 (last merge round=41)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9920196277539046, 'auprc': 0.9922384570826981, 'loss_val': 0.036076120681130794, 'psi': 0.9921071594854219}-{'f1_val': 0.9931718136311698, 'auprc': 0.9896960705182285, 'loss_val': 0.03332541125792224, 'psi': 0.9917815163859933}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.073137 cos_to_last_merge=0.9800 (last merge round=39)
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.6329442133382227, 'auprc': 0.87631255338625, 'loss_val': 1.3993416195853687, 'psi': 0.7302915493574336}-{'f1_val': 0.6566772451664306, 'auprc': 0.8813380758199625, 'loss_val': 1.2703627786794411, 'psi': 0.7465415774278433}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.218298 (no previous merge yet)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.8287670887369908, 'auprc': 0.8780779436777537, 'loss_val': 0.4568880974825481, 'psi': 0.848491430713296}-{'f1_val': 0.8315258271881565, 'auprc': 0.9216241713654464, 'loss_val': 0.43831033117955526, 'psi': 0.8675651648590725}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.401781 cos_to_last_merge=0.9645 (last merge round=37)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9977296996041486, 'loss_val': 0.17801591035659933, 'psi': 0.9757610341823508}-{'f1_val': 0.997542018298261, 'auprc': 0.9988433910268862, 'loss_val': 0.02379327159197705, 'psi': 0.998062567389711}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=2.057097 (no previous merge yet)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9516970151507356, 'auprc': 0.9552501704040157, 'loss_val': 0.32444761408037, 'psi': 0.9531182772520477}-{'f1_val': 0.9550800217806715, 'auprc': 0.9744544269788453, 'loss_val': 0.3084877758058276, 'psi': 0.9628297838599411}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=2.086057 cos_to_last_merge=0.7056 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.706
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.817285571034429, 'auprc': 0.9715488316486341, 'loss_val': 0.334678267483262, 'psi': 0.8789908752801111}-{'f1_val': 0.9975086222760589, 'auprc': 0.9997664693292442, 'loss_val': 0.038186895299875546, 'psi': 0.9984117610973329}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.068918 cos_to_last_merge=0.9529 (last merge round=40)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.6148114294091225, 'auprc': 0.7428689930950396, 'loss_val': 1.3119833223477093, 'psi': 0.6660344548834893}-{'f1_val': 0.7152865738583959, 'auprc': 0.8934407632927603, 'loss_val': 0.9294183012231544, 'psi': 0.7865482496321416}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=2.254941 cos_to_last_merge=0.9898 (last merge round=35)
[S7] round=93 local utility u=0.901931 metrics={'f1_val': 0.9942504127957335, 'auprc': 0.9894243379345321, 'loss_val': 0.1284925025698759, 'psi': 0.9923199828512529}-{'f1_val': 0.7291723908926281, 'auprc': 0.9478907205904189, 'loss_val': 0.21728473442792742, 'psi': 0.8166597227717445}
[S7] not sending this round → trigger blocked (psi=0.992)
[S8] START round=93 head_norm_before_train=1.759049 cos_to_last_merge=0.9789 (last merge round=40)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9343876767203945, 'auprc': 0.9928930722470397, 'loss_val': 0.14588198308777328, 'psi': 0.9577898349310525}-{'f1_val': 0.971684560730762, 'auprc': 0.9944717768554825, 'loss_val': 0.06887754645900118, 'psi': 0.9807994471806503}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.474032 (no previous merge yet)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998384906556066, 'loss_val': 0.014097434225807504, 'psi': 0.9981971437695283}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998376579778725, 'loss_val': 0.013588194502436538, 'psi': 0.9984433536451955}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.303803 (no previous merge yet)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9966399337390481, 'loss_val': 0.025096293555008965, 'psi': 0.9953734375746559}-{'f1_val': 0.9947486092193725, 'auprc': 0.9966065342897487, 'loss_val': 0.024976379012856584, 'psi': 0.995491779247523}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.964426 cos_to_last_merge=0.9368 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.996790843491449, 'loss_val': 0.01920920801234229, 'psi': 0.9966568197803078}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979915721172734, 'loss_val': 0.020522095742609905, 'psi': 0.9971248315550632}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.972940 cos_to_last_merge=0.9677 (last merge round=35)
[S13] round=93 local utility u=0.480446 metrics={'f1_val': 0.7284188280317414, 'auprc': 0.7119246917100229, 'loss_val': 1.1454054253437838, 'psi': 0.721821173503054}-{'f1_val': 0.6288999018056589, 'auprc': 0.6591758588415105, 'loss_val': 1.3509370987407887, 'psi': 0.6410102846199996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=93 head_norm_before_train=2.104400 cos_to_last_merge=0.8003 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=93 local utility u=0.281400 metrics={'f1_val': 0.9977705276331279, 'auprc': 0.9990654455057009, 'loss_val': 0.018147226268677184, 'psi': 0.9982884947821571}-{'f1_val': 0.9384479591173225, 'auprc': 0.9835023088302671, 'loss_val': 0.17832166346786732, 'psi': 0.9564696990025003}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=93 head_norm_before_train=1.809771 cos_to_last_merge=0.9272 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9076989378653021, 'auprc': 0.9927674940956466, 'loss_val': 0.16217124190793777, 'psi': 0.9417263603574398}-{'f1_val': 0.9357534448119964, 'auprc': 0.9955190507902144, 'loss_val': 0.11333682704464752, 'psi': 0.9596596872032837}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.217122 cos_to_last_merge=0.9924 (last merge round=41)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.8658225042084542, 'auprc': 0.9881187656121628, 'loss_val': 0.777347137632264, 'psi': 0.9147410087699377}-{'f1_val': 0.9920196277539046, 'auprc': 0.9922384570826981, 'loss_val': 0.036076120681130794, 'psi': 0.9921071594854219}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.077965 cos_to_last_merge=0.9798 (last merge round=39)
[S17] round=93 local utility u=0.289404 metrics={'f1_val': 0.6997735972637198, 'auprc': 0.8711503414168895, 'loss_val': 1.2060235645170085, 'psi': 0.7683242949249878}-{'f1_val': 0.6329442133382227, 'auprc': 0.87631255338625, 'loss_val': 1.3993416195853687, 'psi': 0.7302915493574336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=94 head_norm_before_train=2.222912 (no previous merge yet)
[S2] round=94 local utility u=0.047373 metrics={'f1_val': 0.7902590482743054, 'auprc': 0.9943662145921568, 'loss_val': 0.479959407496495, 'psi': 0.871901914801446}-{'f1_val': 0.8287670887369908, 'auprc': 0.8780779436777537, 'loss_val': 0.4568880974825481, 'psi': 0.848491430713296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=94 head_norm_before_train=2.406648 cos_to_last_merge=0.9643 (last merge round=37)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.8443544274097302, 'auprc': 0.9980146770141267, 'loss_val': 0.2162766557577636, 'psi': 0.9058185272514888}-{'f1_val': 0.9611152572344858, 'auprc': 0.9977296996041486, 'loss_val': 0.17801591035659933, 'psi': 0.9757610341823508}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=2.058762 (no previous merge yet)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9422221535061351, 'auprc': 0.9496560139393306, 'loss_val': 0.3330605895623171, 'psi': 0.9451956976794134}-{'f1_val': 0.9516970151507356, 'auprc': 0.9552501704040157, 'loss_val': 0.32444761408037, 'psi': 0.9531182772520477}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=2.082703 cos_to_last_merge=0.7055 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.706
[S5] round=94 local utility u=0.730534 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9996711124748043, 'loss_val': 0.03888397223196603, 'psi': 0.998330395701517}-{'f1_val': 0.817285571034429, 'auprc': 0.9715488316486341, 'loss_val': 0.334678267483262, 'psi': 0.8789908752801111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=94 head_norm_before_train=2.073922 cos_to_last_merge=0.9527 (last merge round=40)
[S6] round=94 local utility u=0.494362 metrics={'f1_val': 0.6682709677250313, 'auprc': 0.8902997116456928, 'loss_val': 1.0863080339375457, 'psi': 0.7570824652932959}-{'f1_val': 0.6148114294091225, 'auprc': 0.7428689930950396, 'loss_val': 1.3119833223477093, 'psi': 0.6660344548834893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=94 head_norm_before_train=2.253699 cos_to_last_merge=0.9898 (last merge round=35)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6755967983414755, 'auprc': 0.8367774355936031, 'loss_val': 0.3943590506288268, 'psi': 0.7400690532423264}-{'f1_val': 0.9942504127957335, 'auprc': 0.9894243379345321, 'loss_val': 0.1284925025698759, 'psi': 0.9923199828512529}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=1.762629 cos_to_last_merge=0.9786 (last merge round=40)
[S8] round=94 local utility u=0.244155 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9992944122958842, 'loss_val': 0.0306537162028282, 'psi': 0.995738151182763}-{'f1_val': 0.9343876767203945, 'auprc': 0.9928930722470397, 'loss_val': 0.14588198308777328, 'psi': 0.9577898349310525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=94 head_norm_before_train=2.479757 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9998695304640774, 'loss_val': 0.02220960623267945, 'psi': 0.995451953983154}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998384906556066, 'loss_val': 0.014097434225807504, 'psi': 0.9981971437695283}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.306617 (no previous merge yet)
[S10] round=94 local utility u=0.000593 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9965887089281035, 'loss_val': 0.025073971834183955, 'psi': 0.9954846491028648}-{'f1_val': 0.9945291067983943, 'auprc': 0.9966399337390481, 'loss_val': 0.025096293555008965, 'psi': 0.9953734375746559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=94 head_norm_before_train=1.968390 cos_to_last_merge=0.9364 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9960225940954845, 'loss_val': 0.019577727830275313, 'psi': 0.996101522484641}-{'f1_val': 0.996567470639547, 'auprc': 0.996790843491449, 'loss_val': 0.01920920801234229, 'psi': 0.9966568197803078}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.978428 cos_to_last_merge=0.9672 (last merge round=35)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6012244553318508, 'auprc': 0.6175412060306522, 'loss_val': 1.5439195470877392, 'psi': 0.6077511556113714}-{'f1_val': 0.7284188280317414, 'auprc': 0.7119246917100229, 'loss_val': 1.1454054253437838, 'psi': 0.721821173503054}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.108148 cos_to_last_merge=0.8003 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9309352841665263, 'auprc': 0.9268984323627663, 'loss_val': 0.23798800052228702, 'psi': 0.9293205434450222}-{'f1_val': 0.9977705276331279, 'auprc': 0.9990654455057009, 'loss_val': 0.018147226268677184, 'psi': 0.9982884947821571}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=1.815446 cos_to_last_merge=0.9267 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=94 local utility u=0.338553 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9949169981165101, 'loss_val': 0.023314316415038217, 'psi': 0.9957662457558886}-{'f1_val': 0.9076989378653021, 'auprc': 0.9927674940956466, 'loss_val': 0.16217124190793777, 'psi': 0.9417263603574398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=94 head_norm_before_train=2.219579 cos_to_last_merge=0.9920 (last merge round=41)
[S16] round=94 local utility u=0.184938 metrics={'f1_val': 0.8829045883032942, 'auprc': 0.9893135969478895, 'loss_val': 0.5135476029210216, 'psi': 0.9254681917611323}-{'f1_val': 0.8658225042084542, 'auprc': 0.9881187656121628, 'loss_val': 0.777347137632264, 'psi': 0.9147410087699377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=94 head_norm_before_train=2.083397 cos_to_last_merge=0.9795 (last merge round=39)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.5797705508286547, 'auprc': 0.8507763090980843, 'loss_val': 1.768877406600553, 'psi': 0.6881728541364265}-{'f1_val': 0.6997735972637198, 'auprc': 0.8711503414168895, 'loss_val': 1.2060235645170085, 'psi': 0.7683242949249878}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.227590 (no previous merge yet)
[S2] round=95 local utility u=0.058600 metrics={'f1_val': 0.8266748147386177, 'auprc': 0.9430538003011419, 'loss_val': 0.42731705853415186, 'psi': 0.8732264089636275}-{'f1_val': 0.7902590482743054, 'auprc': 0.9943662145921568, 'loss_val': 0.479959407496495, 'psi': 0.871901914801446}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=95 head_norm_before_train=2.410344 cos_to_last_merge=0.9642 (last merge round=37)
[S3] round=95 local utility u=0.380013 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9990872950757747, 'loss_val': 0.1597930903573037, 'psi': 0.9762799692699822}-{'f1_val': 0.8443544274097302, 'auprc': 0.9980146770141267, 'loss_val': 0.2162766557577636, 'psi': 0.9058185272514888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=95 head_norm_before_train=2.053979 (no previous merge yet)
[S4] round=95 local utility u=0.053786 metrics={'f1_val': 0.9499256302025685, 'auprc': 0.9651672694572209, 'loss_val': 0.31824396234833, 'psi': 0.9560222859044294}-{'f1_val': 0.9422221535061351, 'auprc': 0.9496560139393306, 'loss_val': 0.3330605895623171, 'psi': 0.9451956976794134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=95 head_norm_before_train=2.071881 cos_to_last_merge=0.7055 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.706
[S5] round=95 local utility u=0.002740 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9961708225848176, 'loss_val': 0.018495070582390482, 'psi': 0.9964895101210016}-{'f1_val': 0.9974365845193254, 'auprc': 0.9996711124748043, 'loss_val': 0.03888397223196603, 'psi': 0.998330395701517}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=95 head_norm_before_train=2.079904 cos_to_last_merge=0.9524 (last merge round=40)
[S6] round=95 local utility u=0.871811 metrics={'f1_val': 0.8387575016604634, 'auprc': 0.9519137113143988, 'loss_val': 0.5504471703914652, 'psi': 0.8840199855220375}-{'f1_val': 0.6682709677250313, 'auprc': 0.8902997116456928, 'loss_val': 1.0863080339375457, 'psi': 0.7570824652932959}
[S6] not sending this round → trigger blocked (psi=0.884)
[S7] START round=95 head_norm_before_train=2.254138 cos_to_last_merge=0.9896 (last merge round=35)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.663303667042993, 'auprc': 0.808554308731963, 'loss_val': 0.5004227782903647, 'psi': 0.721403923718581}-{'f1_val': 0.6755967983414755, 'auprc': 0.8367774355936031, 'loss_val': 0.3943590506288268, 'psi': 0.7400690532423264}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=1.767157 cos_to_last_merge=0.9783 (last merge round=40)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9993258127628594, 'loss_val': 0.031034882925910848, 'psi': 0.9955313997968163}-{'f1_val': 0.9933673104406822, 'auprc': 0.9992944122958842, 'loss_val': 0.0306537162028282, 'psi': 0.995738151182763}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.482349 (no previous merge yet)
[S9] round=95 local utility u=0.016288 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999716009217615, 'loss_val': 0.016748568627499665, 'psi': 0.9981481511943318}-{'f1_val': 0.9925069029958717, 'auprc': 0.9998695304640774, 'loss_val': 0.02220960623267945, 'psi': 0.995451953983154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=95 head_norm_before_train=2.311101 (no previous merge yet)
[S10] round=95 local utility u=0.000628 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965972721551611, 'loss_val': 0.025160898330015537, 'psi': 0.9956198207811102}-{'f1_val': 0.9947486092193725, 'auprc': 0.9965887089281035, 'loss_val': 0.025073971834183955, 'psi': 0.9954846491028648}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=95 head_norm_before_train=1.972664 cos_to_last_merge=0.9360 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.991853200973469, 'auprc': 0.9951262244022311, 'loss_val': 0.03149592787078033, 'psi': 0.9931624103449739}-{'f1_val': 0.9961541414107454, 'auprc': 0.9960225940954845, 'loss_val': 0.019577727830275313, 'psi': 0.996101522484641}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.981880 cos_to_last_merge=0.9668 (last merge round=35)
[S13] round=95 local utility u=0.899306 metrics={'f1_val': 0.7285775773123732, 'auprc': 0.785788434520875, 'loss_val': 1.0141669991878055, 'psi': 0.751461920195774}-{'f1_val': 0.6012244553318508, 'auprc': 0.6175412060306522, 'loss_val': 1.5439195470877392, 'psi': 0.6077511556113714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=95 head_norm_before_train=2.105638 cos_to_last_merge=0.7999 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=95 local utility u=0.335755 metrics={'f1_val': 0.9764329280166866, 'auprc': 0.999037527397113, 'loss_val': 0.0558815113449817, 'psi': 0.9854747677688571}-{'f1_val': 0.9309352841665263, 'auprc': 0.9268984323627663, 'loss_val': 0.23798800052228702, 'psi': 0.9293205434450222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=95 head_norm_before_train=1.821941 cos_to_last_merge=0.9262 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9514893693240515, 'auprc': 0.9937222413464742, 'loss_val': 0.09096860063137145, 'psi': 0.9683825181330206}-{'f1_val': 0.9963324108488076, 'auprc': 0.9949169981165101, 'loss_val': 0.023314316415038217, 'psi': 0.9957662457558886}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.223529 cos_to_last_merge=0.9919 (last merge round=41)
[S16] round=95 local utility u=0.568919 metrics={'f1_val': 0.9929849735688417, 'auprc': 0.9917537170019259, 'loss_val': 0.043511777271958055, 'psi': 0.9924924709420755}-{'f1_val': 0.8829045883032942, 'auprc': 0.9893135969478895, 'loss_val': 0.5135476029210216, 'psi': 0.9254681917611323}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=95 head_norm_before_train=2.087051 cos_to_last_merge=0.9792 (last merge round=39)
[S17] round=95 local utility u=0.806651 metrics={'f1_val': 0.7292393452030024, 'auprc': 0.8676679207750415, 'loss_val': 1.103062995538575, 'psi': 0.784610775431818}-{'f1_val': 0.5797705508286547, 'auprc': 0.8507763090980843, 'loss_val': 1.768877406600553, 'psi': 0.6881728541364265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=96 head_norm_before_train=2.227700 (no previous merge yet)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.6947020215110096, 'auprc': 0.8575813851591249, 'loss_val': 1.2143890999075526, 'psi': 0.7598537669702556}-{'f1_val': 0.8266748147386177, 'auprc': 0.9430538003011419, 'loss_val': 0.42731705853415186, 'psi': 0.8732264089636275}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.416629 cos_to_last_merge=0.9639 (last merge round=37)
[S3] round=96 local utility u=0.008174 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9993170745958769, 'loss_val': 0.1438957848671463, 'psi': 0.9763479805016169}-{'f1_val': 0.9610750853994537, 'auprc': 0.9990872950757747, 'loss_val': 0.1597930903573037, 'psi': 0.9762799692699822}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=96 head_norm_before_train=2.036872 (no previous merge yet)
[S4] round=96 local utility u=0.029499 metrics={'f1_val': 0.9550905094106797, 'auprc': 0.9716314625428257, 'loss_val': 0.3096278513780039, 'psi': 0.9617068906635381}-{'f1_val': 0.9499256302025685, 'auprc': 0.9651672694572209, 'loss_val': 0.31824396234833, 'psi': 0.9560222859044294}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=96 head_norm_before_train=2.070225 cos_to_last_merge=0.7056 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.706
[S5] round=96 local utility u=0.003652 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9997686334079829, 'loss_val': 0.024189775592923655, 'psi': 0.9981491885298318}-{'f1_val': 0.9967019684784577, 'auprc': 0.9961708225848176, 'loss_val': 0.018495070582390482, 'psi': 0.9964895101210016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=96 head_norm_before_train=2.083991 cos_to_last_merge=0.9521 (last merge round=40)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.7944056140858299, 'auprc': 0.9449966036582069, 'loss_val': 0.7217448248087612, 'psi': 0.8546420099147807}-{'f1_val': 0.8387575016604634, 'auprc': 0.9519137113143988, 'loss_val': 0.5504471703914652, 'psi': 0.8840199855220375}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.262339 cos_to_last_merge=0.9894 (last merge round=35)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.6161113823579883, 'auprc': 0.776249571940147, 'loss_val': 1.1413719174726618, 'psi': 0.6801666581908519}-{'f1_val': 0.663303667042993, 'auprc': 0.808554308731963, 'loss_val': 0.5004227782903647, 'psi': 0.721403923718581}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=1.772338 cos_to_last_merge=0.9781 (last merge round=40)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9991876549767116, 'loss_val': 0.03191713735327795, 'psi': 0.9948917680926359}-{'f1_val': 0.9930017911527874, 'auprc': 0.9993258127628594, 'loss_val': 0.031034882925910848, 'psi': 0.9955313997968163}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.479270 (no previous merge yet)
[S9] round=96 local utility u=0.000117 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9999689195263761, 'loss_val': 0.01476962497589809, 'psi': 0.9979990403336756}-{'f1_val': 0.9971029125121428, 'auprc': 0.999716009217615, 'loss_val': 0.016748568627499665, 'psi': 0.9981481511943318}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=96 head_norm_before_train=2.312053 (no previous merge yet)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9965896702868208, 'loss_val': 0.025203353049668753, 'psi': 0.9954850336463519}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965972721551611, 'loss_val': 0.025160898330015537, 'psi': 0.9956198207811102}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.977620 cos_to_last_merge=0.9356 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=96 local utility u=0.019450 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9955899542559746, 'loss_val': 0.019792425605174604, 'psi': 0.995928466548837}-{'f1_val': 0.991853200973469, 'auprc': 0.9951262244022311, 'loss_val': 0.03149592787078033, 'psi': 0.9931624103449739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=96 head_norm_before_train=1.985852 cos_to_last_merge=0.9664 (last merge round=35)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.718743348372186, 'auprc': 0.6822573083697365, 'loss_val': 1.2758247993365508, 'psi': 0.7041489323712062}-{'f1_val': 0.7285775773123732, 'auprc': 0.785788434520875, 'loss_val': 1.0141669991878055, 'psi': 0.751461920195774}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.106564 cos_to_last_merge=0.7997 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=96 local utility u=0.078976 metrics={'f1_val': 0.9971390833387653, 'auprc': 0.9990457530191231, 'loss_val': 0.0221907932242497, 'psi': 0.9979017512109085}-{'f1_val': 0.9764329280166866, 'auprc': 0.999037527397113, 'loss_val': 0.0558815113449817, 'psi': 0.9854747677688571}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=96 head_norm_before_train=1.828011 cos_to_last_merge=0.9257 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.711395919197787, 'auprc': 0.9428009109050847, 'loss_val': 0.6798147083683312, 'psi': 0.8039579158807061}-{'f1_val': 0.9514893693240515, 'auprc': 0.9937222413464742, 'loss_val': 0.09096860063137145, 'psi': 0.9683825181330206}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.222598 cos_to_last_merge=0.9919 (last merge round=41)
[S16] round=96 local utility u=0.007102 metrics={'f1_val': 0.9940395958389625, 'auprc': 0.991078321963097, 'loss_val': 0.033610035347714895, 'psi': 0.9928550862886163}-{'f1_val': 0.9929849735688417, 'auprc': 0.9917537170019259, 'loss_val': 0.043511777271958055, 'psi': 0.9924924709420755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=96 head_norm_before_train=2.090057 cos_to_last_merge=0.9791 (last merge round=39)
[S17] round=96 local utility u=0.433737 metrics={'f1_val': 0.8150659097823154, 'auprc': 0.8845970441769674, 'loss_val': 0.8013348104003183, 'psi': 0.8428783635401762}-{'f1_val': 0.7292393452030024, 'auprc': 0.8676679207750415, 'loss_val': 1.103062995538575, 'psi': 0.784610775431818}
[S17] not sending this round → trigger blocked (psi=0.843)
[S2] START round=97 head_norm_before_train=2.228639 (no previous merge yet)
[S2] round=97 local utility u=0.939676 metrics={'f1_val': 0.8272848111314572, 'auprc': 0.9487838737846386, 'loss_val': 0.404140430712595, 'psi': 0.8758844361927298}-{'f1_val': 0.6947020215110096, 'auprc': 0.8575813851591249, 'loss_val': 1.2143890999075526, 'psi': 0.7598537669702556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=97 head_norm_before_train=2.423417 cos_to_last_merge=0.9635 (last merge round=37)
[S3] round=97 local utility u=0.147773 metrics={'f1_val': 0.9948742836727336, 'auprc': 0.9986905677888834, 'loss_val': 0.049505294946822286, 'psi': 0.9964007973191935}-{'f1_val': 0.9610352511054436, 'auprc': 0.9993170745958769, 'loss_val': 0.1438957848671463, 'psi': 0.9763479805016169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=97 head_norm_before_train=2.027232 (no previous merge yet)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9530464554767766, 'auprc': 0.9688655983217255, 'loss_val': 0.31392020424241845, 'psi': 0.9593741126147561}-{'f1_val': 0.9550905094106797, 'auprc': 0.9716314625428257, 'loss_val': 0.3096278513780039, 'psi': 0.9617068906635381}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.075499 cos_to_last_merge=0.7053 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.705
[S5] round=97 local utility u=0.000552 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9992642539774876, 'loss_val': 0.01936741573949663, 'psi': 0.9977268826780696}-{'f1_val': 0.9970695586110643, 'auprc': 0.9997686334079829, 'loss_val': 0.024189775592923655, 'psi': 0.9981491885298318}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=97 head_norm_before_train=2.088697 cos_to_last_merge=0.9518 (last merge round=40)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6159965470624807, 'auprc': 0.7092830668958808, 'loss_val': 1.559463807757903, 'psi': 0.6533111549958408}-{'f1_val': 0.7944056140858299, 'auprc': 0.9449966036582069, 'loss_val': 0.7217448248087612, 'psi': 0.8546420099147807}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=2.268259 cos_to_last_merge=0.9890 (last merge round=35)
[S7] round=97 local utility u=0.407047 metrics={'f1_val': 0.6495080992909581, 'auprc': 0.8038497846936369, 'loss_val': 0.6104591857451825, 'psi': 0.7112447734520296}-{'f1_val': 0.6161113823579883, 'auprc': 0.776249571940147, 'loss_val': 1.1413719174726618, 'psi': 0.6801666581908519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=97 head_norm_before_train=1.778225 cos_to_last_merge=0.9778 (last merge round=40)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9898527714347872, 'auprc': 0.9991611840403045, 'loss_val': 0.035757717461844446, 'psi': 0.9935761364769942}-{'f1_val': 0.992027843503252, 'auprc': 0.9991876549767116, 'loss_val': 0.03191713735327795, 'psi': 0.9948917680926359}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.483289 (no previous merge yet)
[S9] round=97 local utility u=0.002908 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998367484801393, 'loss_val': 0.013524661332917921, 'psi': 0.9984429898461022}-{'f1_val': 0.9966857875385419, 'auprc': 0.9999689195263761, 'loss_val': 0.01476962497589809, 'psi': 0.9979990403336756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=97 head_norm_before_train=2.315027 (no previous merge yet)
[S10] round=97 local utility u=0.000021 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9965881285678627, 'loss_val': 0.025157125521227546, 'psi': 0.9954844169587687}-{'f1_val': 0.9947486092193725, 'auprc': 0.9965896702868208, 'loss_val': 0.025203353049668753, 'psi': 0.9954850336463519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=97 head_norm_before_train=1.982619 cos_to_last_merge=0.9351 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9948130167723754, 'loss_val': 0.020482931614673495, 'psi': 0.9956176915553974}-{'f1_val': 0.9961541414107454, 'auprc': 0.9955899542559746, 'loss_val': 0.019792425605174604, 'psi': 0.995928466548837}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.990692 cos_to_last_merge=0.9659 (last merge round=35)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6766206491810046, 'auprc': 0.7182264183142686, 'loss_val': 1.4291390996658104, 'psi': 0.6932629568343103}-{'f1_val': 0.718743348372186, 'auprc': 0.6822573083697365, 'loss_val': 1.2758247993365508, 'psi': 0.7041489323712062}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.109606 cos_to_last_merge=0.7996 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.800
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9781951167977854, 'auprc': 0.998656277928905, 'loss_val': 0.052569871254571826, 'psi': 0.9863795812502332}-{'f1_val': 0.9971390833387653, 'auprc': 0.9990457530191231, 'loss_val': 0.0221907932242497, 'psi': 0.9979017512109085}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=1.833814 cos_to_last_merge=0.9253 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.7031633787565537, 'auprc': 0.9188433922781853, 'loss_val': 0.7015931429318116, 'psi': 0.7894353841652063}-{'f1_val': 0.711395919197787, 'auprc': 0.9428009109050847, 'loss_val': 0.6798147083683312, 'psi': 0.8039579158807061}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.225793 cos_to_last_merge=0.9919 (last merge round=41)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9935848434976069, 'auprc': 0.9904533398503736, 'loss_val': 0.03350642498573049, 'psi': 0.9923322420387136}-{'f1_val': 0.9940395958389625, 'auprc': 0.991078321963097, 'loss_val': 0.033610035347714895, 'psi': 0.9928550862886163}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.094134 cos_to_last_merge=0.9788 (last merge round=39)
[S17] round=97 local utility u=0.013868 metrics={'f1_val': 0.8152807623120077, 'auprc': 0.894639644258666, 'loss_val': 0.8050150523019993, 'psi': 0.8470243150906711}-{'f1_val': 0.8150659097823154, 'auprc': 0.8845970441769674, 'loss_val': 0.8013348104003183, 'psi': 0.8428783635401762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=98 head_norm_before_train=2.233211 (no previous merge yet)
[S2] round=98 local utility u=0.053819 metrics={'f1_val': 0.8266964042642333, 'auprc': 0.9918239824339965, 'loss_val': 0.42209218602180937, 'psi': 0.8927474355321385}-{'f1_val': 0.8272848111314572, 'auprc': 0.9487838737846386, 'loss_val': 0.404140430712595, 'psi': 0.8758844361927298}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=98 head_norm_before_train=2.426055 cos_to_last_merge=0.9637 (last merge round=37)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.977025322024825, 'loss_val': 0.23080306477189236, 'psi': 0.9669649578546382}-{'f1_val': 0.9948742836727336, 'auprc': 0.9986905677888834, 'loss_val': 0.049505294946822286, 'psi': 0.9964007973191935}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.027647 (no previous merge yet)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9458241082976914, 'auprc': 0.9630916740127192, 'loss_val': 0.3230092808174743, 'psi': 0.9527311345837025}-{'f1_val': 0.9530464554767766, 'auprc': 0.9688655983217255, 'loss_val': 0.31392020424241845, 'psi': 0.9593741126147561}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.084414 cos_to_last_merge=0.7046 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.705
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9988269005702981, 'loss_val': 0.018101958364847622, 'psi': 0.9975519413151939}-{'f1_val': 0.9967019684784577, 'auprc': 0.9992642539774876, 'loss_val': 0.01936741573949663, 'psi': 0.9977268826780696}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.091188 cos_to_last_merge=0.9512 (last merge round=40)
[S6] round=98 local utility u=1.000000 metrics={'f1_val': 0.9414052962562562, 'auprc': 0.9812181752992418, 'loss_val': 0.1734560390559478, 'psi': 0.9573304478734505}-{'f1_val': 0.6159965470624807, 'auprc': 0.7092830668958808, 'loss_val': 1.559463807757903, 'psi': 0.6533111549958408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=98 head_norm_before_train=2.268691 cos_to_last_merge=0.9890 (last merge round=35)
[S7] round=98 local utility u=0.596363 metrics={'f1_val': 0.7348754849270586, 'auprc': 0.9160785168357483, 'loss_val': 0.26662330569863596, 'psi': 0.8073566976905344}-{'f1_val': 0.6495080992909581, 'auprc': 0.8038497846936369, 'loss_val': 0.6104591857451825, 'psi': 0.7112447734520296}
[S7] not sending this round → trigger blocked (psi=0.807)
[S8] START round=98 head_norm_before_train=1.784002 cos_to_last_merge=0.9774 (last merge round=40)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9128770155758325, 'auprc': 0.9929479986276029, 'loss_val': 0.1743972596683761, 'psi': 0.9449054087965406}-{'f1_val': 0.9898527714347872, 'auprc': 0.9991611840403045, 'loss_val': 0.035757717461844446, 'psi': 0.9935761364769942}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.489758 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998196768352137, 'loss_val': 0.014517765151562778, 'psi': 0.9981896182413712}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998367484801393, 'loss_val': 0.013524661332917921, 'psi': 0.9984429898461022}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.319729 (no previous merge yet)
[S10] round=98 local utility u=0.000041 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9965867582224167, 'loss_val': 0.025070625735018476, 'psi': 0.9954838688205903}-{'f1_val': 0.9947486092193725, 'auprc': 0.9965881285678627, 'loss_val': 0.025157125521227546, 'psi': 0.9954844169587687}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=98 head_norm_before_train=1.985561 cos_to_last_merge=0.9349 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.8263586916842541, 'auprc': 0.9930028569378362, 'loss_val': 0.23648976363450433, 'psi': 0.893016357785687}-{'f1_val': 0.9961541414107454, 'auprc': 0.9948130167723754, 'loss_val': 0.020482931614673495, 'psi': 0.9956176915553974}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.994749 cos_to_last_merge=0.9656 (last merge round=35)
[S13] round=98 local utility u=0.316711 metrics={'f1_val': 0.7050984091491648, 'auprc': 0.7431126978509351, 'loss_val': 1.0412431903942931, 'psi': 0.7203041246298729}-{'f1_val': 0.6766206491810046, 'auprc': 0.7182264183142686, 'loss_val': 1.4291390996658104, 'psi': 0.6932629568343103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=98 head_norm_before_train=2.113231 cos_to_last_merge=0.7993 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.799
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9355437946340048, 'auprc': 0.9479240018544258, 'loss_val': 0.20198383869687433, 'psi': 0.9404958775221732}-{'f1_val': 0.9781951167977854, 'auprc': 0.998656277928905, 'loss_val': 0.052569871254571826, 'psi': 0.9863795812502332}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=1.839817 cos_to_last_merge=0.9249 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=98 local utility u=0.483786 metrics={'f1_val': 0.7927479757591226, 'auprc': 0.9919575979521473, 'loss_val': 0.49087148790689916, 'psi': 0.8724318246363325}-{'f1_val': 0.7031633787565537, 'auprc': 0.9188433922781853, 'loss_val': 0.7015931429318116, 'psi': 0.7894353841652063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=98 head_norm_before_train=2.231596 cos_to_last_merge=0.9920 (last merge round=41)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9914423990784755, 'auprc': 0.9859198496728856, 'loss_val': 0.04343870777914654, 'psi': 0.9892333793162396}-{'f1_val': 0.9935848434976069, 'auprc': 0.9904533398503736, 'loss_val': 0.03350642498573049, 'psi': 0.9923322420387136}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.099069 cos_to_last_merge=0.9785 (last merge round=39)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.5226551408611193, 'auprc': 0.8558952618090098, 'loss_val': 1.9089809505867184, 'psi': 0.6559511892402755}-{'f1_val': 0.8152807623120077, 'auprc': 0.894639644258666, 'loss_val': 0.8050150523019993, 'psi': 0.8470243150906711}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.237808 (no previous merge yet)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.79248677819342, 'auprc': 0.8718740285241545, 'loss_val': 0.5925816165663843, 'psi': 0.8242416783257138}-{'f1_val': 0.8266964042642333, 'auprc': 0.9918239824339965, 'loss_val': 0.42209218602180937, 'psi': 0.8927474355321385}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.824 u=0.0000 p_local=0.1635 f1=0.792 auprc=0.872 bytes=71903
[S3] START round=99 head_norm_before_train=2.431378 cos_to_last_merge=0.9635 (last merge round=37)
[S3] round=99 local utility u=0.083936 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9982776107856509, 'loss_val': 0.13289728224712485, 'psi': 0.9760867208441704}-{'f1_val': 0.9602580484078469, 'auprc': 0.977025322024825, 'loss_val': 0.23080306477189236, 'psi': 0.9669649578546382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] r=100 psi=0.976 u=0.0839 p_local=0.0932 f1=0.961 auprc=0.998 bytes=70084
[S4] START round=99 head_norm_before_train=2.035442 (no previous merge yet)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9416877201292732, 'auprc': 0.9504959869262757, 'loss_val': 0.3268999203708696, 'psi': 0.9452110268480742}-{'f1_val': 0.9458241082976914, 'auprc': 0.9630916740127192, 'loss_val': 0.3230092808174743, 'psi': 0.9527311345837025}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.945 u=0.0000 p_local=0.0104 f1=0.942 auprc=0.950 bytes=59400
[S5] START round=99 head_norm_before_train=2.087155 cos_to_last_merge=0.7049 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.705
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.8373369232081183, 'auprc': 0.9738486525393635, 'loss_val': 0.2895713948268425, 'psi': 0.8919416149406164}-{'f1_val': 0.9967019684784577, 'auprc': 0.9988269005702981, 'loss_val': 0.018101958364847622, 'psi': 0.9975519413151939}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.892 u=0.0000 p_local=0.0494 f1=0.837 auprc=0.974 bytes=72027
[S6] START round=99 head_norm_before_train=2.091506 cos_to_last_merge=0.9509 (last merge round=40)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.8239997837684117, 'auprc': 0.9703015674034947, 'loss_val': 0.44988799291011633, 'psi': 0.882520497222445}-{'f1_val': 0.9414052962562562, 'auprc': 0.9812181752992418, 'loss_val': 0.1734560390559478, 'psi': 0.9573304478734505}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.883 u=0.0000 p_local=0.3061 f1=0.824 auprc=0.970 bytes=66580
[S7] START round=99 head_norm_before_train=2.272392 cos_to_last_merge=0.9888 (last merge round=35)
[S7] round=99 local utility u=0.821657 metrics={'f1_val': 0.961668301083064, 'auprc': 0.982770259123015, 'loss_val': 0.1841422989356672, 'psi': 0.9701090842990444}-{'f1_val': 0.7348754849270586, 'auprc': 0.9160785168357483, 'loss_val': 0.26662330569863596, 'psi': 0.8073566976905344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] r=100 psi=0.970 u=0.8217 p_local=0.4091 f1=0.962 auprc=0.983 bytes=68290
[S8] START round=99 head_norm_before_train=1.786110 cos_to_last_merge=0.9773 (last merge round=40)
[S8] round=99 local utility u=0.284064 metrics={'f1_val': 0.9846990546707569, 'auprc': 0.995933641046468, 'loss_val': 0.04615855980490573, 'psi': 0.9891928892210413}-{'f1_val': 0.9128770155758325, 'auprc': 0.9929479986276029, 'loss_val': 0.1743972596683761, 'psi': 0.9449054087965406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=100 psi=0.989 u=0.2841 p_local=0.0792 f1=0.985 auprc=0.996 bytes=68238
[S9] START round=99 head_norm_before_train=2.496143 (no previous merge yet)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999676059399075, 'loss_val': 0.015578876914588412, 'psi': 0.9982487898832487}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998196768352137, 'loss_val': 0.014517765151562778, 'psi': 0.9981896182413712}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.998 u=0.0000 p_local=0.0020 f1=0.997 auprc=1.000 bytes=75485
[S10] START round=99 head_norm_before_train=2.325244 (no previous merge yet)
[S10] round=99 local utility u=0.000722 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966077375595507, 'loss_val': 0.02500603838096859, 'psi': 0.9956240069428659}-{'f1_val': 0.9947486092193725, 'auprc': 0.9965867582224167, 'loss_val': 0.025070625735018476, 'psi': 0.9954838688205903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] r=100 psi=0.996 u=0.0007 p_local=0.0003 f1=0.995 auprc=0.997 bytes=75432
[S11] START round=99 head_norm_before_train=1.987142 cos_to_last_merge=0.9348 (last merge round=39)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=99 local utility u=0.529792 metrics={'f1_val': 0.9758491163936589, 'auprc': 0.9934593141483784, 'loss_val': 0.07521752650270605, 'psi': 0.9828931954955467}-{'f1_val': 0.8263586916842541, 'auprc': 0.9930028569378362, 'loss_val': 0.23648976363450433, 'psi': 0.893016357785687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S11] r=100 psi=0.983 u=0.5298 p_local=0.1229 f1=0.976 auprc=0.993 bytes=61214
[S13] START round=99 head_norm_before_train=1.996721 cos_to_last_merge=0.9654 (last merge round=35)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6315603415316515, 'auprc': 0.6772411653699401, 'loss_val': 1.3027756293087205, 'psi': 0.6498326710669668}-{'f1_val': 0.7050984091491648, 'auprc': 0.7431126978509351, 'loss_val': 1.0412431903942931, 'psi': 0.7203041246298729}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.650 u=0.0000 p_local=0.1760 f1=0.632 auprc=0.677 bytes=72027
[S14] START round=99 head_norm_before_train=2.118953 cos_to_last_merge=0.7991 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.799
[S14] round=99 local utility u=0.354077 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9990306493017886, 'loss_val': 0.019346630586561057, 'psi': 0.9981581845986662}-{'f1_val': 0.9355437946340048, 'auprc': 0.9479240018544258, 'loss_val': 0.20198383869687433, 'psi': 0.9404958775221732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] r=100 psi=0.998 u=0.3541 p_local=0.1382 f1=0.998 auprc=0.999 bytes=66617
[S15] START round=99 head_norm_before_train=1.845774 cos_to_last_merge=0.9244 (last merge round=33)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=99 local utility u=0.615840 metrics={'f1_val': 0.9334940817576319, 'auprc': 0.9958366956180762, 'loss_val': 0.11530464202781568, 'psi': 0.9584311273018096}-{'f1_val': 0.7927479757591226, 'auprc': 0.9919575979521473, 'loss_val': 0.49087148790689916, 'psi': 0.8724318246363325}
[S15] not sending this round → trigger blocked (psi=0.958)
[S15] r=100 psi=0.958 u=0.6158 p_local=0.3144 f1=0.933 auprc=0.996 bytes=63010
[S16] START round=99 head_norm_before_train=2.237714 cos_to_last_merge=0.9921 (last merge round=41)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9077135340494387, 'auprc': 0.9798689596477137, 'loss_val': 0.4331498009722593, 'psi': 0.9365757042887486}-{'f1_val': 0.9914423990784755, 'auprc': 0.9859198496728856, 'loss_val': 0.04343870777914654, 'psi': 0.9892333793162396}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.937 u=0.0000 p_local=0.0823 f1=0.908 auprc=0.980 bytes=64732
[S17] START round=99 head_norm_before_train=2.103616 cos_to_last_merge=0.9782 (last merge round=39)
[S17] round=99 local utility u=1.000000 metrics={'f1_val': 0.7441978113335326, 'auprc': 0.8762854308332888, 'loss_val': 1.064244223532088, 'psi': 0.797032859133435}-{'f1_val': 0.5226551408611193, 'auprc': 0.8558952618090098, 'loss_val': 1.9089809505867184, 'psi': 0.6559511892402755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=100 psi=0.797 u=1.0000 p_local=0.3488 f1=0.744 auprc=0.876 bytes=70219
[runner] rounds complete.
[runner] all agents stopped.
